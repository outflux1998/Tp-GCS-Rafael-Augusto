<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.mixture.tests.test_gaussian_mixture Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1mixture.html">mixture</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1mixture_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html">test_gaussian_mixture</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sklearn.mixture.tests.test_gaussian_mixture Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture_1_1_random_data.html">RandomData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5ee1e6402f1809fb8cc2797786fc9051" id="r_a5ee1e6402f1809fb8cc2797786fc9051"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a5ee1e6402f1809fb8cc2797786fc9051">generate_data</a> (n_samples, n_features, weights, means, precisions, covariance_type)</td></tr>
<tr class="separator:a5ee1e6402f1809fb8cc2797786fc9051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a24e6de394e3a3f2c65e125c7716962" id="r_a3a24e6de394e3a3f2c65e125c7716962"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a3a24e6de394e3a3f2c65e125c7716962">test_gaussian_mixture_attributes</a> ()</td></tr>
<tr class="separator:a3a24e6de394e3a3f2c65e125c7716962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd5208c4681d45c009580d663644d3ff" id="r_abd5208c4681d45c009580d663644d3ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#abd5208c4681d45c009580d663644d3ff">test_check_weights</a> ()</td></tr>
<tr class="separator:abd5208c4681d45c009580d663644d3ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5b7158c279462c02c82cb07c14b323b" id="r_af5b7158c279462c02c82cb07c14b323b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#af5b7158c279462c02c82cb07c14b323b">test_check_means</a> ()</td></tr>
<tr class="separator:af5b7158c279462c02c82cb07c14b323b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2652becf2a4db38107285335e78649e0" id="r_a2652becf2a4db38107285335e78649e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a2652becf2a4db38107285335e78649e0">test_check_precisions</a> ()</td></tr>
<tr class="separator:a2652becf2a4db38107285335e78649e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342c7067bb86f36a1b0ecc81c4f0fd89" id="r_a342c7067bb86f36a1b0ecc81c4f0fd89"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a342c7067bb86f36a1b0ecc81c4f0fd89">test_suffstat_sk_full</a> ()</td></tr>
<tr class="separator:a342c7067bb86f36a1b0ecc81c4f0fd89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24b837a59d0ea5fba6b04c01b519fff" id="r_ad24b837a59d0ea5fba6b04c01b519fff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#ad24b837a59d0ea5fba6b04c01b519fff">test_suffstat_sk_tied</a> ()</td></tr>
<tr class="separator:ad24b837a59d0ea5fba6b04c01b519fff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa854747fdfe2105e21d6f94195739bad" id="r_aa854747fdfe2105e21d6f94195739bad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#aa854747fdfe2105e21d6f94195739bad">test_suffstat_sk_diag</a> ()</td></tr>
<tr class="separator:aa854747fdfe2105e21d6f94195739bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a345b32cd2f4de10e143707c50f38e295" id="r_a345b32cd2f4de10e143707c50f38e295"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a345b32cd2f4de10e143707c50f38e295">test_gaussian_suffstat_sk_spherical</a> ()</td></tr>
<tr class="separator:a345b32cd2f4de10e143707c50f38e295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6d01814b96bcc67798535855a990458" id="r_aa6d01814b96bcc67798535855a990458"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#aa6d01814b96bcc67798535855a990458">test_compute_log_det_cholesky</a> ()</td></tr>
<tr class="separator:aa6d01814b96bcc67798535855a990458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af52edbb9bb85f67b9cf6cb6d682d432c" id="r_af52edbb9bb85f67b9cf6cb6d682d432c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#af52edbb9bb85f67b9cf6cb6d682d432c">_naive_lmvnpdf_diag</a> (X, means, covars)</td></tr>
<tr class="separator:af52edbb9bb85f67b9cf6cb6d682d432c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a991c19c74e81df9bcfdacb4daecdab5c" id="r_a991c19c74e81df9bcfdacb4daecdab5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a991c19c74e81df9bcfdacb4daecdab5c">test_gaussian_mixture_log_probabilities</a> ()</td></tr>
<tr class="separator:a991c19c74e81df9bcfdacb4daecdab5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9df6161a4c5195452f373645a4cbfd00" id="r_a9df6161a4c5195452f373645a4cbfd00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a9df6161a4c5195452f373645a4cbfd00">test_gaussian_mixture_estimate_log_prob_resp</a> ()</td></tr>
<tr class="separator:a9df6161a4c5195452f373645a4cbfd00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18602e5fa2952c0d0bf487c8fad2290f" id="r_a18602e5fa2952c0d0bf487c8fad2290f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a18602e5fa2952c0d0bf487c8fad2290f">test_gaussian_mixture_predict_predict_proba</a> ()</td></tr>
<tr class="separator:a18602e5fa2952c0d0bf487c8fad2290f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac565549ac336fb89a8fb9b84739db69a" id="r_ac565549ac336fb89a8fb9b84739db69a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#ac565549ac336fb89a8fb9b84739db69a">test_gaussian_mixture_fit_predict</a> (seed, max_iter, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>)</td></tr>
<tr class="separator:ac565549ac336fb89a8fb9b84739db69a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abafdcf96d09f967e6ac96af72b083b83" id="r_abafdcf96d09f967e6ac96af72b083b83"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#abafdcf96d09f967e6ac96af72b083b83">test_gaussian_mixture_fit_predict_n_init</a> ()</td></tr>
<tr class="separator:abafdcf96d09f967e6ac96af72b083b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e277510446954c0767ee44d6e4eeab" id="r_ae5e277510446954c0767ee44d6e4eeab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#ae5e277510446954c0767ee44d6e4eeab">test_gaussian_mixture_fit</a> ()</td></tr>
<tr class="separator:ae5e277510446954c0767ee44d6e4eeab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25c4f7ed4376c08c0100e5578a2bbb22" id="r_a25c4f7ed4376c08c0100e5578a2bbb22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a25c4f7ed4376c08c0100e5578a2bbb22">test_gaussian_mixture_fit_best_params</a> ()</td></tr>
<tr class="separator:a25c4f7ed4376c08c0100e5578a2bbb22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1de300d93940a2ef861e3d8125ee1e59" id="r_a1de300d93940a2ef861e3d8125ee1e59"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a1de300d93940a2ef861e3d8125ee1e59">test_gaussian_mixture_fit_convergence_warning</a> ()</td></tr>
<tr class="separator:a1de300d93940a2ef861e3d8125ee1e59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a903e262ad1fa3ad9bd972faeedd96175" id="r_a903e262ad1fa3ad9bd972faeedd96175"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a903e262ad1fa3ad9bd972faeedd96175">test_multiple_init</a> ()</td></tr>
<tr class="separator:a903e262ad1fa3ad9bd972faeedd96175"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae67305f11088548035a48b7551b24ddd" id="r_ae67305f11088548035a48b7551b24ddd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#ae67305f11088548035a48b7551b24ddd">test_gaussian_mixture_n_parameters</a> ()</td></tr>
<tr class="separator:ae67305f11088548035a48b7551b24ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a043ef72bc1cb62947b90517cfff6e7ee" id="r_a043ef72bc1cb62947b90517cfff6e7ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a043ef72bc1cb62947b90517cfff6e7ee">test_bic_1d_1component</a> ()</td></tr>
<tr class="separator:a043ef72bc1cb62947b90517cfff6e7ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4330716dbc66d2f73d659ed3126bd09" id="r_ac4330716dbc66d2f73d659ed3126bd09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#ac4330716dbc66d2f73d659ed3126bd09">test_gaussian_mixture_aic_bic</a> ()</td></tr>
<tr class="separator:ac4330716dbc66d2f73d659ed3126bd09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80820496836931133fb6689e42f796bc" id="r_a80820496836931133fb6689e42f796bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a80820496836931133fb6689e42f796bc">test_gaussian_mixture_verbose</a> ()</td></tr>
<tr class="separator:a80820496836931133fb6689e42f796bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b527ead4ff5593acb4275a9ba965c94" id="r_a3b527ead4ff5593acb4275a9ba965c94"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a3b527ead4ff5593acb4275a9ba965c94">test_warm_start</a> (seed)</td></tr>
<tr class="separator:a3b527ead4ff5593acb4275a9ba965c94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bc1caebfe05c75636e6063878051779" id="r_a4bc1caebfe05c75636e6063878051779"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a4bc1caebfe05c75636e6063878051779">test_convergence_detected_with_warm_start</a> ()</td></tr>
<tr class="separator:a4bc1caebfe05c75636e6063878051779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab92e7e8c87793da47c3e9de8003930b0" id="r_ab92e7e8c87793da47c3e9de8003930b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#ab92e7e8c87793da47c3e9de8003930b0">test_score</a> ()</td></tr>
<tr class="separator:ab92e7e8c87793da47c3e9de8003930b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac982217038f15e9bd35e94aecc384efc" id="r_ac982217038f15e9bd35e94aecc384efc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#ac982217038f15e9bd35e94aecc384efc">test_score_samples</a> ()</td></tr>
<tr class="separator:ac982217038f15e9bd35e94aecc384efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa31360ec50e390654b345b5d3343c3dc" id="r_aa31360ec50e390654b345b5d3343c3dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#aa31360ec50e390654b345b5d3343c3dc">test_monotonic_likelihood</a> ()</td></tr>
<tr class="separator:aa31360ec50e390654b345b5d3343c3dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a973c32008ee1de69d453c6d9bb8390fc" id="r_a973c32008ee1de69d453c6d9bb8390fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a973c32008ee1de69d453c6d9bb8390fc">test_regularisation</a> ()</td></tr>
<tr class="separator:a973c32008ee1de69d453c6d9bb8390fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad347a1c97c43db1a0bcda116a80c795" id="r_aad347a1c97c43db1a0bcda116a80c795"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#aad347a1c97c43db1a0bcda116a80c795">test_property</a> ()</td></tr>
<tr class="separator:aad347a1c97c43db1a0bcda116a80c795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c11da58ff195af60f215fdd1ff9634b" id="r_a1c11da58ff195af60f215fdd1ff9634b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a1c11da58ff195af60f215fdd1ff9634b">test_sample</a> ()</td></tr>
<tr class="separator:a1c11da58ff195af60f215fdd1ff9634b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54cb5cd52e3fd6c40985b956912195b9" id="r_a54cb5cd52e3fd6c40985b956912195b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a54cb5cd52e3fd6c40985b956912195b9">test_init</a> ()</td></tr>
<tr class="separator:a54cb5cd52e3fd6c40985b956912195b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a004ddf433b7a514325b8ba406efffc15" id="r_a004ddf433b7a514325b8ba406efffc15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a004ddf433b7a514325b8ba406efffc15">test_gaussian_mixture_setting_best_params</a> ()</td></tr>
<tr class="separator:a004ddf433b7a514325b8ba406efffc15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bc7e0b9ac89b961f525d9eabe3d4661" id="r_a1bc7e0b9ac89b961f525d9eabe3d4661"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a1bc7e0b9ac89b961f525d9eabe3d4661">test_init_means_not_duplicated</a> (init_params, global_random_seed)</td></tr>
<tr class="separator:a1bc7e0b9ac89b961f525d9eabe3d4661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac050340b2f26c48a630bec3c1f077ed8" id="r_ac050340b2f26c48a630bec3c1f077ed8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#ac050340b2f26c48a630bec3c1f077ed8">test_means_for_all_inits</a> (init_params, global_random_seed)</td></tr>
<tr class="separator:ac050340b2f26c48a630bec3c1f077ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a165e2339e2dccd428fe9a62a88c8a28c" id="r_a165e2339e2dccd428fe9a62a88c8a28c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a165e2339e2dccd428fe9a62a88c8a28c">test_max_iter_zero</a> ()</td></tr>
<tr class="separator:a165e2339e2dccd428fe9a62a88c8a28c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bb45b50cf764aaf4461c639105eeffd" id="r_a1bb45b50cf764aaf4461c639105eeffd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#a1bb45b50cf764aaf4461c639105eeffd">test_gaussian_mixture_precisions_init_diag</a> ()</td></tr>
<tr class="separator:a1bb45b50cf764aaf4461c639105eeffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73d2a795e8ed615ccb721a289bffa8b" id="r_aa73d2a795e8ed615ccb721a289bffa8b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#aa73d2a795e8ed615ccb721a289bffa8b">test_gaussian_mixture_single_component_stable</a> ()</td></tr>
<tr class="separator:aa73d2a795e8ed615ccb721a289bffa8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa429913e739405b9fde00b90a3df70d0" id="r_aa429913e739405b9fde00b90a3df70d0"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1mixture_1_1tests_1_1test__gaussian__mixture.html#aa429913e739405b9fde00b90a3df70d0">COVARIANCE_TYPE</a> = [&quot;full&quot;, &quot;tied&quot;, &quot;diag&quot;, &quot;spherical&quot;]</td></tr>
<tr class="separator:aa429913e739405b9fde00b90a3df70d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="af52edbb9bb85f67b9cf6cb6d682d432c" name="af52edbb9bb85f67b9cf6cb6d682d432c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af52edbb9bb85f67b9cf6cb6d682d432c">&#9670;&#160;</a></span>_naive_lmvnpdf_diag()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture._naive_lmvnpdf_diag </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>means</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>covars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  425</span><span class="keyword">def </span>_naive_lmvnpdf_diag(X, means, covars):</div>
<div class="line"><span class="lineno">  426</span>    resp = np.empty((len(X), len(means)))</div>
<div class="line"><span class="lineno">  427</span>    stds = np.sqrt(covars)</div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">for</span> i, (mean, std) <span class="keywordflow">in</span> enumerate(zip(means, stds)):</div>
<div class="line"><span class="lineno">  429</span>        resp[:, i] = stats.norm.logpdf(X, mean, std).sum(axis=1)</div>
<div class="line"><span class="lineno">  430</span>    <span class="keywordflow">return</span> resp</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ee1e6402f1809fb8cc2797786fc9051" name="a5ee1e6402f1809fb8cc2797786fc9051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ee1e6402f1809fb8cc2797786fc9051">&#9670;&#160;</a></span>generate_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.generate_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>means</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precisions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>covariance_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   42</span><span class="keyword">def </span>generate_data(n_samples, n_features, weights, means, precisions, covariance_type):</div>
<div class="line"><span class="lineno">   43</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    X = []</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">if</span> covariance_type == <span class="stringliteral">&quot;spherical&quot;</span>:</div>
<div class="line"><span class="lineno">   47</span>        <span class="keywordflow">for</span> _, (w, m, c) <span class="keywordflow">in</span> enumerate(zip(weights, means, precisions[<span class="stringliteral">&quot;spherical&quot;</span>])):</div>
<div class="line"><span class="lineno">   48</span>            X.append(</div>
<div class="line"><span class="lineno">   49</span>                rng.multivariate_normal(</div>
<div class="line"><span class="lineno">   50</span>                    m, c * np.eye(n_features), int(np.round(w * n_samples))</div>
<div class="line"><span class="lineno">   51</span>                )</div>
<div class="line"><span class="lineno">   52</span>            )</div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordflow">if</span> covariance_type == <span class="stringliteral">&quot;diag&quot;</span>:</div>
<div class="line"><span class="lineno">   54</span>        <span class="keywordflow">for</span> _, (w, m, c) <span class="keywordflow">in</span> enumerate(zip(weights, means, precisions[<span class="stringliteral">&quot;diag&quot;</span>])):</div>
<div class="line"><span class="lineno">   55</span>            X.append(</div>
<div class="line"><span class="lineno">   56</span>                rng.multivariate_normal(m, np.diag(c), int(np.round(w * n_samples)))</div>
<div class="line"><span class="lineno">   57</span>            )</div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">if</span> covariance_type == <span class="stringliteral">&quot;tied&quot;</span>:</div>
<div class="line"><span class="lineno">   59</span>        <span class="keywordflow">for</span> _, (w, m) <span class="keywordflow">in</span> enumerate(zip(weights, means)):</div>
<div class="line"><span class="lineno">   60</span>            X.append(</div>
<div class="line"><span class="lineno">   61</span>                rng.multivariate_normal(</div>
<div class="line"><span class="lineno">   62</span>                    m, precisions[<span class="stringliteral">&quot;tied&quot;</span>], int(np.round(w * n_samples))</div>
<div class="line"><span class="lineno">   63</span>                )</div>
<div class="line"><span class="lineno">   64</span>            )</div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">if</span> covariance_type == <span class="stringliteral">&quot;full&quot;</span>:</div>
<div class="line"><span class="lineno">   66</span>        <span class="keywordflow">for</span> _, (w, m, c) <span class="keywordflow">in</span> enumerate(zip(weights, means, precisions[<span class="stringliteral">&quot;full&quot;</span>])):</div>
<div class="line"><span class="lineno">   67</span>            X.append(rng.multivariate_normal(m, c, int(np.round(w * n_samples))))</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    X = np.vstack(X)</div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">return</span> X</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a043ef72bc1cb62947b90517cfff6e7ee" name="a043ef72bc1cb62947b90517cfff6e7ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a043ef72bc1cb62947b90517cfff6e7ee">&#9670;&#160;</a></span>test_bic_1d_1component()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_bic_1d_1component </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  730</span><span class="keyword">def </span>test_bic_1d_1component():</div>
<div class="line"><span class="lineno">  731</span>    <span class="comment"># Test all of the covariance_types return the same BIC score for</span></div>
<div class="line"><span class="lineno">  732</span>    <span class="comment"># 1-dimensional, 1 component fits.</span></div>
<div class="line"><span class="lineno">  733</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  734</span>    n_samples, n_dim, n_components = 100, 1, 1</div>
<div class="line"><span class="lineno">  735</span>    X = rng.randn(n_samples, n_dim)</div>
<div class="line"><span class="lineno">  736</span>    bic_full = (</div>
<div class="line"><span class="lineno">  737</span>        GaussianMixture(</div>
<div class="line"><span class="lineno">  738</span>            n_components=n_components, covariance_type=<span class="stringliteral">&quot;full&quot;</span>, random_state=rng</div>
<div class="line"><span class="lineno">  739</span>        )</div>
<div class="line"><span class="lineno">  740</span>        .fit(X)</div>
<div class="line"><span class="lineno">  741</span>        .bic(X)</div>
<div class="line"><span class="lineno">  742</span>    )</div>
<div class="line"><span class="lineno">  743</span>    <span class="keywordflow">for</span> covariance_type <span class="keywordflow">in</span> [<span class="stringliteral">&quot;tied&quot;</span>, <span class="stringliteral">&quot;diag&quot;</span>, <span class="stringliteral">&quot;spherical&quot;</span>]:</div>
<div class="line"><span class="lineno">  744</span>        bic = (</div>
<div class="line"><span class="lineno">  745</span>            GaussianMixture(</div>
<div class="line"><span class="lineno">  746</span>                n_components=n_components,</div>
<div class="line"><span class="lineno">  747</span>                covariance_type=covariance_type,</div>
<div class="line"><span class="lineno">  748</span>                random_state=rng,</div>
<div class="line"><span class="lineno">  749</span>            )</div>
<div class="line"><span class="lineno">  750</span>            .fit(X)</div>
<div class="line"><span class="lineno">  751</span>            .bic(X)</div>
<div class="line"><span class="lineno">  752</span>        )</div>
<div class="line"><span class="lineno">  753</span>        assert_almost_equal(bic_full, bic)</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af5b7158c279462c02c82cb07c14b323b" name="af5b7158c279462c02c82cb07c14b323b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5b7158c279462c02c82cb07c14b323b">&#9670;&#160;</a></span>test_check_means()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_check_means </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  201</span><span class="keyword">def </span>test_check_means():</div>
<div class="line"><span class="lineno">  202</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  203</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    n_components, n_features = rand_data.n_components, rand_data.n_features</div>
<div class="line"><span class="lineno">  206</span>    X = rand_data.X[<span class="stringliteral">&quot;full&quot;</span>]</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>    g = GaussianMixture(n_components=n_components)</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>    <span class="comment"># Check means bad shape</span></div>
<div class="line"><span class="lineno">  211</span>    means_bad_shape = rng.rand(n_components + 1, n_features)</div>
<div class="line"><span class="lineno">  212</span>    g.means_init = means_bad_shape</div>
<div class="line"><span class="lineno">  213</span>    msg = <span class="stringliteral">&quot;The parameter &#39;means&#39; should have the shape of &quot;</span></div>
<div class="line"><span class="lineno">  214</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  215</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>    <span class="comment"># Check good means matrix</span></div>
<div class="line"><span class="lineno">  218</span>    means = rand_data.means</div>
<div class="line"><span class="lineno">  219</span>    g.means_init = means</div>
<div class="line"><span class="lineno">  220</span>    g.fit(X)</div>
<div class="line"><span class="lineno">  221</span>    assert_array_equal(means, g.means_init)</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2652becf2a4db38107285335e78649e0" name="a2652becf2a4db38107285335e78649e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2652becf2a4db38107285335e78649e0">&#9670;&#160;</a></span>test_check_precisions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_check_precisions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  224</span><span class="keyword">def </span>test_check_precisions():</div>
<div class="line"><span class="lineno">  225</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  226</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>    n_components, n_features = rand_data.n_components, rand_data.n_features</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="comment"># Define the bad precisions for each covariance_type</span></div>
<div class="line"><span class="lineno">  231</span>    precisions_bad_shape = {</div>
<div class="line"><span class="lineno">  232</span>        <span class="stringliteral">&quot;full&quot;</span>: np.ones((n_components + 1, n_features, n_features)),</div>
<div class="line"><span class="lineno">  233</span>        <span class="stringliteral">&quot;tied&quot;</span>: np.ones((n_features + 1, n_features + 1)),</div>
<div class="line"><span class="lineno">  234</span>        <span class="stringliteral">&quot;diag&quot;</span>: np.ones((n_components + 1, n_features)),</div>
<div class="line"><span class="lineno">  235</span>        <span class="stringliteral">&quot;spherical&quot;</span>: np.ones((n_components + 1)),</div>
<div class="line"><span class="lineno">  236</span>    }</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    <span class="comment"># Define not positive-definite precisions</span></div>
<div class="line"><span class="lineno">  239</span>    precisions_not_pos = np.ones((n_components, n_features, n_features))</div>
<div class="line"><span class="lineno">  240</span>    precisions_not_pos[0] = np.eye(n_features)</div>
<div class="line"><span class="lineno">  241</span>    precisions_not_pos[0, 0, 0] = -1.0</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>    precisions_not_positive = {</div>
<div class="line"><span class="lineno">  244</span>        <span class="stringliteral">&quot;full&quot;</span>: precisions_not_pos,</div>
<div class="line"><span class="lineno">  245</span>        <span class="stringliteral">&quot;tied&quot;</span>: precisions_not_pos[0],</div>
<div class="line"><span class="lineno">  246</span>        <span class="stringliteral">&quot;diag&quot;</span>: np.full((n_components, n_features), -1.0),</div>
<div class="line"><span class="lineno">  247</span>        <span class="stringliteral">&quot;spherical&quot;</span>: np.full(n_components, -1.0),</div>
<div class="line"><span class="lineno">  248</span>    }</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    not_positive_errors = {</div>
<div class="line"><span class="lineno">  251</span>        <span class="stringliteral">&quot;full&quot;</span>: <span class="stringliteral">&quot;symmetric, positive-definite&quot;</span>,</div>
<div class="line"><span class="lineno">  252</span>        <span class="stringliteral">&quot;tied&quot;</span>: <span class="stringliteral">&quot;symmetric, positive-definite&quot;</span>,</div>
<div class="line"><span class="lineno">  253</span>        <span class="stringliteral">&quot;diag&quot;</span>: <span class="stringliteral">&quot;positive&quot;</span>,</div>
<div class="line"><span class="lineno">  254</span>        <span class="stringliteral">&quot;spherical&quot;</span>: <span class="stringliteral">&quot;positive&quot;</span>,</div>
<div class="line"><span class="lineno">  255</span>    }</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  258</span>        X = RandomData(rng).X[covar_type]</div>
<div class="line"><span class="lineno">  259</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  260</span>            n_components=n_components, covariance_type=covar_type, random_state=rng</div>
<div class="line"><span class="lineno">  261</span>        )</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>        <span class="comment"># Check precisions with bad shapes</span></div>
<div class="line"><span class="lineno">  264</span>        g.precisions_init = precisions_bad_shape[covar_type]</div>
<div class="line"><span class="lineno">  265</span>        msg = f<span class="stringliteral">&quot;The parameter &#39;{covar_type} precision&#39; should have the shape of&quot;</span></div>
<div class="line"><span class="lineno">  266</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  267</span>            g.fit(X)</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>        <span class="comment"># Check not positive precisions</span></div>
<div class="line"><span class="lineno">  270</span>        g.precisions_init = precisions_not_positive[covar_type]</div>
<div class="line"><span class="lineno">  271</span>        msg = f<span class="stringliteral">&quot;&#39;{covar_type} precision&#39; should be {not_positive_errors[covar_type]}&quot;</span></div>
<div class="line"><span class="lineno">  272</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  273</span>            g.fit(X)</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>        <span class="comment"># Check the correct init of precisions_init</span></div>
<div class="line"><span class="lineno">  276</span>        g.precisions_init = rand_data.precisions[covar_type]</div>
<div class="line"><span class="lineno">  277</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  278</span>        assert_array_equal(rand_data.precisions[covar_type], g.precisions_init)</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abd5208c4681d45c009580d663644d3ff" name="abd5208c4681d45c009580d663644d3ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd5208c4681d45c009580d663644d3ff">&#9670;&#160;</a></span>test_check_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_check_weights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  153</span><span class="keyword">def </span>test_check_weights():</div>
<div class="line"><span class="lineno">  154</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  155</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  158</span>    X = rand_data.X[<span class="stringliteral">&quot;full&quot;</span>]</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    g = GaussianMixture(n_components=n_components)</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># Check bad shape</span></div>
<div class="line"><span class="lineno">  163</span>    weights_bad_shape = rng.rand(n_components, 1)</div>
<div class="line"><span class="lineno">  164</span>    g.weights_init = weights_bad_shape</div>
<div class="line"><span class="lineno">  165</span>    msg = re.escape(</div>
<div class="line"><span class="lineno">  166</span>        <span class="stringliteral">&quot;The parameter &#39;weights&#39; should have the shape of &quot;</span></div>
<div class="line"><span class="lineno">  167</span>        f<span class="stringliteral">&quot;({n_components},), but got {str(weights_bad_shape.shape)}&quot;</span></div>
<div class="line"><span class="lineno">  168</span>    )</div>
<div class="line"><span class="lineno">  169</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  170</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="comment"># Check bad range</span></div>
<div class="line"><span class="lineno">  173</span>    weights_bad_range = rng.rand(n_components) + 1</div>
<div class="line"><span class="lineno">  174</span>    g.weights_init = weights_bad_range</div>
<div class="line"><span class="lineno">  175</span>    msg = re.escape(</div>
<div class="line"><span class="lineno">  176</span>        <span class="stringliteral">&quot;The parameter &#39;weights&#39; should be in the range [0, 1], but got&quot;</span></div>
<div class="line"><span class="lineno">  177</span>        f<span class="stringliteral">&quot; max value {np.min(weights_bad_range):.5f}, &quot;</span></div>
<div class="line"><span class="lineno">  178</span>        f<span class="stringliteral">&quot;min value {np.max(weights_bad_range):.5f}&quot;</span></div>
<div class="line"><span class="lineno">  179</span>    )</div>
<div class="line"><span class="lineno">  180</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  181</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="comment"># Check bad normalization</span></div>
<div class="line"><span class="lineno">  184</span>    weights_bad_norm = rng.rand(n_components)</div>
<div class="line"><span class="lineno">  185</span>    weights_bad_norm = weights_bad_norm / (weights_bad_norm.sum() + 1)</div>
<div class="line"><span class="lineno">  186</span>    g.weights_init = weights_bad_norm</div>
<div class="line"><span class="lineno">  187</span>    msg = re.escape(</div>
<div class="line"><span class="lineno">  188</span>        <span class="stringliteral">&quot;The parameter &#39;weights&#39; should be normalized, &quot;</span></div>
<div class="line"><span class="lineno">  189</span>        f<span class="stringliteral">&quot;but got sum(weights) = {np.sum(weights_bad_norm):.5f}&quot;</span></div>
<div class="line"><span class="lineno">  190</span>    )</div>
<div class="line"><span class="lineno">  191</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  192</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>    <span class="comment"># Check good weights matrix</span></div>
<div class="line"><span class="lineno">  195</span>    weights = rand_data.weights</div>
<div class="line"><span class="lineno">  196</span>    g = GaussianMixture(weights_init=weights, n_components=n_components)</div>
<div class="line"><span class="lineno">  197</span>    g.fit(X)</div>
<div class="line"><span class="lineno">  198</span>    assert_array_equal(weights, g.weights_init)</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6d01814b96bcc67798535855a990458" name="aa6d01814b96bcc67798535855a990458"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6d01814b96bcc67798535855a990458">&#9670;&#160;</a></span>test_compute_log_det_cholesky()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_compute_log_det_cholesky </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  400</span><span class="keyword">def </span>test_compute_log_det_cholesky():</div>
<div class="line"><span class="lineno">  401</span>    n_features = 2</div>
<div class="line"><span class="lineno">  402</span>    rand_data = RandomData(np.random.RandomState(0))</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  405</span>        covariance = rand_data.covariances[covar_type]</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>        <span class="keywordflow">if</span> covar_type == <span class="stringliteral">&quot;full&quot;</span>:</div>
<div class="line"><span class="lineno">  408</span>            predected_det = np.array([linalg.det(cov) <span class="keywordflow">for</span> cov <span class="keywordflow">in</span> covariance])</div>
<div class="line"><span class="lineno">  409</span>        <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;tied&quot;</span>:</div>
<div class="line"><span class="lineno">  410</span>            predected_det = linalg.det(covariance)</div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;diag&quot;</span>:</div>
<div class="line"><span class="lineno">  412</span>            predected_det = np.array([np.prod(cov) <span class="keywordflow">for</span> cov <span class="keywordflow">in</span> covariance])</div>
<div class="line"><span class="lineno">  413</span>        <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;spherical&quot;</span>:</div>
<div class="line"><span class="lineno">  414</span>            predected_det = covariance**n_features</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>        <span class="comment"># We compute the cholesky decomposition of the covariance matrix</span></div>
<div class="line"><span class="lineno">  417</span>        expected_det = _compute_log_det_cholesky(</div>
<div class="line"><span class="lineno">  418</span>            _compute_precision_cholesky(covariance, covar_type),</div>
<div class="line"><span class="lineno">  419</span>            covar_type,</div>
<div class="line"><span class="lineno">  420</span>            n_features=n_features,</div>
<div class="line"><span class="lineno">  421</span>        )</div>
<div class="line"><span class="lineno">  422</span>        assert_array_almost_equal(expected_det, -0.5 * np.log(predected_det))</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bc1caebfe05c75636e6063878051779" name="a4bc1caebfe05c75636e6063878051779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bc1caebfe05c75636e6063878051779">&#9670;&#160;</a></span>test_convergence_detected_with_warm_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_convergence_detected_with_warm_start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  881</span><span class="keyword">def </span>test_convergence_detected_with_warm_start():</div>
<div class="line"><span class="lineno">  882</span>    <span class="comment"># We check that convergence is detected when warm_start=True</span></div>
<div class="line"><span class="lineno">  883</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  884</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  885</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  886</span>    X = rand_data.X[<span class="stringliteral">&quot;full&quot;</span>]</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>    <span class="keywordflow">for</span> max_iter <span class="keywordflow">in</span> (1, 2, 50):</div>
<div class="line"><span class="lineno">  889</span>        gmm = GaussianMixture(</div>
<div class="line"><span class="lineno">  890</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  891</span>            warm_start=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  892</span>            max_iter=max_iter,</div>
<div class="line"><span class="lineno">  893</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  894</span>        )</div>
<div class="line"><span class="lineno">  895</span>        <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(100):</div>
<div class="line"><span class="lineno">  896</span>            gmm.fit(X)</div>
<div class="line"><span class="lineno">  897</span>            <span class="keywordflow">if</span> gmm.converged_:</div>
<div class="line"><span class="lineno">  898</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  899</span>        <span class="keyword">assert</span> gmm.converged_</div>
<div class="line"><span class="lineno">  900</span>        <span class="keyword">assert</span> max_iter &gt;= gmm.n_iter_</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4330716dbc66d2f73d659ed3126bd09" name="ac4330716dbc66d2f73d659ed3126bd09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4330716dbc66d2f73d659ed3126bd09">&#9670;&#160;</a></span>test_gaussian_mixture_aic_bic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_aic_bic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  756</span><span class="keyword">def </span>test_gaussian_mixture_aic_bic():</div>
<div class="line"><span class="lineno">  757</span>    <span class="comment"># Test the aic and bic criteria</span></div>
<div class="line"><span class="lineno">  758</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  759</span>    n_samples, n_features, n_components = 50, 3, 2</div>
<div class="line"><span class="lineno">  760</span>    X = rng.randn(n_samples, n_features)</div>
<div class="line"><span class="lineno">  761</span>    <span class="comment"># standard gaussian entropy</span></div>
<div class="line"><span class="lineno">  762</span>    sgh = 0.5 * (</div>
<div class="line"><span class="lineno">  763</span>        fast_logdet(np.cov(X.T, bias=1)) + n_features * (1 + np.log(2 * np.pi))</div>
<div class="line"><span class="lineno">  764</span>    )</div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordflow">for</span> cv_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  766</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  767</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  768</span>            covariance_type=cv_type,</div>
<div class="line"><span class="lineno">  769</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  770</span>            max_iter=200,</div>
<div class="line"><span class="lineno">  771</span>        )</div>
<div class="line"><span class="lineno">  772</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  773</span>        aic = 2 * n_samples * sgh + 2 * g._n_parameters()</div>
<div class="line"><span class="lineno">  774</span>        bic = 2 * n_samples * sgh + np.log(n_samples) * g._n_parameters()</div>
<div class="line"><span class="lineno">  775</span>        bound = n_features / np.sqrt(n_samples)</div>
<div class="line"><span class="lineno">  776</span>        <span class="keyword">assert</span> (g.aic(X) - aic) / n_samples &lt; bound</div>
<div class="line"><span class="lineno">  777</span>        <span class="keyword">assert</span> (g.bic(X) - bic) / n_samples &lt; bound</div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a24e6de394e3a3f2c65e125c7716962" name="a3a24e6de394e3a3f2c65e125c7716962"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a24e6de394e3a3f2c65e125c7716962">&#9670;&#160;</a></span>test_gaussian_mixture_attributes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_attributes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  126</span><span class="keyword">def </span>test_gaussian_mixture_attributes():</div>
<div class="line"><span class="lineno">  127</span>    <span class="comment"># test bad parameters</span></div>
<div class="line"><span class="lineno">  128</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  129</span>    X = rng.rand(10, 2)</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="comment"># test good parameters</span></div>
<div class="line"><span class="lineno">  132</span>    n_components, tol, n_init, max_iter, reg_covar = 2, 1e-4, 3, 30, 1e-1</div>
<div class="line"><span class="lineno">  133</span>    covariance_type, init_params = <span class="stringliteral">&quot;full&quot;</span>, <span class="stringliteral">&quot;random&quot;</span></div>
<div class="line"><span class="lineno">  134</span>    gmm = GaussianMixture(</div>
<div class="line"><span class="lineno">  135</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  136</span>        tol=tol,</div>
<div class="line"><span class="lineno">  137</span>        n_init=n_init,</div>
<div class="line"><span class="lineno">  138</span>        max_iter=max_iter,</div>
<div class="line"><span class="lineno">  139</span>        reg_covar=reg_covar,</div>
<div class="line"><span class="lineno">  140</span>        covariance_type=covariance_type,</div>
<div class="line"><span class="lineno">  141</span>        init_params=init_params,</div>
<div class="line"><span class="lineno">  142</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <span class="keyword">assert</span> gmm.n_components == n_components</div>
<div class="line"><span class="lineno">  145</span>    <span class="keyword">assert</span> gmm.covariance_type == covariance_type</div>
<div class="line"><span class="lineno">  146</span>    <span class="keyword">assert</span> gmm.tol == tol</div>
<div class="line"><span class="lineno">  147</span>    <span class="keyword">assert</span> gmm.reg_covar == reg_covar</div>
<div class="line"><span class="lineno">  148</span>    <span class="keyword">assert</span> gmm.max_iter == max_iter</div>
<div class="line"><span class="lineno">  149</span>    <span class="keyword">assert</span> gmm.n_init == n_init</div>
<div class="line"><span class="lineno">  150</span>    <span class="keyword">assert</span> gmm.init_params == init_params</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9df6161a4c5195452f373645a4cbfd00" name="a9df6161a4c5195452f373645a4cbfd00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9df6161a4c5195452f373645a4cbfd00">&#9670;&#160;</a></span>test_gaussian_mixture_estimate_log_prob_resp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_estimate_log_prob_resp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  481</span><span class="keyword">def </span>test_gaussian_mixture_estimate_log_prob_resp():</div>
<div class="line"><span class="lineno">  482</span>    <span class="comment"># test whether responsibilities are normalized</span></div>
<div class="line"><span class="lineno">  483</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  484</span>    rand_data = RandomData(rng, scale=5)</div>
<div class="line"><span class="lineno">  485</span>    n_samples = rand_data.n_samples</div>
<div class="line"><span class="lineno">  486</span>    n_features = rand_data.n_features</div>
<div class="line"><span class="lineno">  487</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  491</span>        weights = rand_data.weights</div>
<div class="line"><span class="lineno">  492</span>        means = rand_data.means</div>
<div class="line"><span class="lineno">  493</span>        precisions = rand_data.precisions[covar_type]</div>
<div class="line"><span class="lineno">  494</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  495</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  496</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  497</span>            weights_init=weights,</div>
<div class="line"><span class="lineno">  498</span>            means_init=means,</div>
<div class="line"><span class="lineno">  499</span>            precisions_init=precisions,</div>
<div class="line"><span class="lineno">  500</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  501</span>        )</div>
<div class="line"><span class="lineno">  502</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  503</span>        resp = g.predict_proba(X)</div>
<div class="line"><span class="lineno">  504</span>        assert_array_almost_equal(resp.sum(axis=1), np.ones(n_samples))</div>
<div class="line"><span class="lineno">  505</span>        assert_array_equal(g.weights_init, weights)</div>
<div class="line"><span class="lineno">  506</span>        assert_array_equal(g.means_init, means)</div>
<div class="line"><span class="lineno">  507</span>        assert_array_equal(g.precisions_init, precisions)</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5e277510446954c0767ee44d6e4eeab" name="ae5e277510446954c0767ee44d6e4eeab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e277510446954c0767ee44d6e4eeab">&#9670;&#160;</a></span>test_gaussian_mixture_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_fit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  584</span><span class="keyword">def </span>test_gaussian_mixture_fit():</div>
<div class="line"><span class="lineno">  585</span>    <span class="comment"># recover the ground truth</span></div>
<div class="line"><span class="lineno">  586</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  587</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  588</span>    n_features = rand_data.n_features</div>
<div class="line"><span class="lineno">  589</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  592</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  593</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  594</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  595</span>            n_init=20,</div>
<div class="line"><span class="lineno">  596</span>            reg_covar=0,</div>
<div class="line"><span class="lineno">  597</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  598</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  599</span>        )</div>
<div class="line"><span class="lineno">  600</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>        <span class="comment"># needs more data to pass the test with rtol=1e-7</span></div>
<div class="line"><span class="lineno">  603</span>        assert_allclose(</div>
<div class="line"><span class="lineno">  604</span>            np.sort(g.weights_), np.sort(rand_data.weights), rtol=0.1, atol=1e-2</div>
<div class="line"><span class="lineno">  605</span>        )</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>        arg_idx1 = g.means_[:, 0].argsort()</div>
<div class="line"><span class="lineno">  608</span>        arg_idx2 = rand_data.means[:, 0].argsort()</div>
<div class="line"><span class="lineno">  609</span>        assert_allclose(</div>
<div class="line"><span class="lineno">  610</span>            g.means_[arg_idx1], rand_data.means[arg_idx2], rtol=0.1, atol=1e-2</div>
<div class="line"><span class="lineno">  611</span>        )</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">if</span> covar_type == <span class="stringliteral">&quot;full&quot;</span>:</div>
<div class="line"><span class="lineno">  614</span>            prec_pred = g.precisions_</div>
<div class="line"><span class="lineno">  615</span>            prec_test = rand_data.precisions[<span class="stringliteral">&quot;full&quot;</span>]</div>
<div class="line"><span class="lineno">  616</span>        <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;tied&quot;</span>:</div>
<div class="line"><span class="lineno">  617</span>            prec_pred = np.array([g.precisions_] * n_components)</div>
<div class="line"><span class="lineno">  618</span>            prec_test = np.array([rand_data.precisions[<span class="stringliteral">&quot;tied&quot;</span>]] * n_components)</div>
<div class="line"><span class="lineno">  619</span>        <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;spherical&quot;</span>:</div>
<div class="line"><span class="lineno">  620</span>            prec_pred = np.array([np.eye(n_features) * c <span class="keywordflow">for</span> c <span class="keywordflow">in</span> g.precisions_])</div>
<div class="line"><span class="lineno">  621</span>            prec_test = np.array(</div>
<div class="line"><span class="lineno">  622</span>                [np.eye(n_features) * c <span class="keywordflow">for</span> c <span class="keywordflow">in</span> rand_data.precisions[<span class="stringliteral">&quot;spherical&quot;</span>]]</div>
<div class="line"><span class="lineno">  623</span>            )</div>
<div class="line"><span class="lineno">  624</span>        <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;diag&quot;</span>:</div>
<div class="line"><span class="lineno">  625</span>            prec_pred = np.array([np.diag(d) <span class="keywordflow">for</span> d <span class="keywordflow">in</span> g.precisions_])</div>
<div class="line"><span class="lineno">  626</span>            prec_test = np.array([np.diag(d) <span class="keywordflow">for</span> d <span class="keywordflow">in</span> rand_data.precisions[<span class="stringliteral">&quot;diag&quot;</span>]])</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>        arg_idx1 = np.trace(prec_pred, axis1=1, axis2=2).argsort()</div>
<div class="line"><span class="lineno">  629</span>        arg_idx2 = np.trace(prec_test, axis1=1, axis2=2).argsort()</div>
<div class="line"><span class="lineno">  630</span>        <span class="keywordflow">for</span> k, h <span class="keywordflow">in</span> zip(arg_idx1, arg_idx2):</div>
<div class="line"><span class="lineno">  631</span>            ecov = EmpiricalCovariance()</div>
<div class="line"><span class="lineno">  632</span>            ecov.covariance_ = prec_test[h]</div>
<div class="line"><span class="lineno">  633</span>            <span class="comment"># the accuracy depends on the number of data and randomness, rng</span></div>
<div class="line"><span class="lineno">  634</span>            assert_allclose(ecov.error_norm(prec_pred[k]), 0, atol=0.15)</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a25c4f7ed4376c08c0100e5578a2bbb22" name="a25c4f7ed4376c08c0100e5578a2bbb22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25c4f7ed4376c08c0100e5578a2bbb22">&#9670;&#160;</a></span>test_gaussian_mixture_fit_best_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_fit_best_params </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  637</span><span class="keyword">def </span>test_gaussian_mixture_fit_best_params():</div>
<div class="line"><span class="lineno">  638</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  639</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  640</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  641</span>    n_init = 10</div>
<div class="line"><span class="lineno">  642</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  643</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  644</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  645</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  646</span>            n_init=1,</div>
<div class="line"><span class="lineno">  647</span>            reg_covar=0,</div>
<div class="line"><span class="lineno">  648</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  649</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  650</span>        )</div>
<div class="line"><span class="lineno">  651</span>        ll = []</div>
<div class="line"><span class="lineno">  652</span>        <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(n_init):</div>
<div class="line"><span class="lineno">  653</span>            g.fit(X)</div>
<div class="line"><span class="lineno">  654</span>            ll.append(g.score(X))</div>
<div class="line"><span class="lineno">  655</span>        ll = np.array(ll)</div>
<div class="line"><span class="lineno">  656</span>        g_best = GaussianMixture(</div>
<div class="line"><span class="lineno">  657</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  658</span>            n_init=n_init,</div>
<div class="line"><span class="lineno">  659</span>            reg_covar=0,</div>
<div class="line"><span class="lineno">  660</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  661</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  662</span>        )</div>
<div class="line"><span class="lineno">  663</span>        g_best.fit(X)</div>
<div class="line"><span class="lineno">  664</span>        assert_almost_equal(ll.min(), g_best.score(X))</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1de300d93940a2ef861e3d8125ee1e59" name="a1de300d93940a2ef861e3d8125ee1e59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1de300d93940a2ef861e3d8125ee1e59">&#9670;&#160;</a></span>test_gaussian_mixture_fit_convergence_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_fit_convergence_warning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  667</span><span class="keyword">def </span>test_gaussian_mixture_fit_convergence_warning():</div>
<div class="line"><span class="lineno">  668</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  669</span>    rand_data = RandomData(rng, scale=1)</div>
<div class="line"><span class="lineno">  670</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  671</span>    max_iter = 1</div>
<div class="line"><span class="lineno">  672</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  673</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  674</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  675</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  676</span>            n_init=1,</div>
<div class="line"><span class="lineno">  677</span>            max_iter=max_iter,</div>
<div class="line"><span class="lineno">  678</span>            reg_covar=0,</div>
<div class="line"><span class="lineno">  679</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  680</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  681</span>        )</div>
<div class="line"><span class="lineno">  682</span>        msg = (</div>
<div class="line"><span class="lineno">  683</span>            f<span class="stringliteral">&quot;Initialization {max_iter} did not converge. Try different init &quot;</span></div>
<div class="line"><span class="lineno">  684</span>            <span class="stringliteral">&quot;parameters, or increase max_iter, tol or check for degenerate&quot;</span></div>
<div class="line"><span class="lineno">  685</span>            <span class="stringliteral">&quot; data.&quot;</span></div>
<div class="line"><span class="lineno">  686</span>        )</div>
<div class="line"><span class="lineno">  687</span>        <span class="keyword">with</span> pytest.warns(ConvergenceWarning, match=msg):</div>
<div class="line"><span class="lineno">  688</span>            g.fit(X)</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac565549ac336fb89a8fb9b84739db69a" name="ac565549ac336fb89a8fb9b84739db69a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac565549ac336fb89a8fb9b84739db69a">&#9670;&#160;</a></span>test_gaussian_mixture_fit_predict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_fit_predict </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  550</span><span class="keyword">def </span>test_gaussian_mixture_fit_predict(seed, max_iter, tol):</div>
<div class="line"><span class="lineno">  551</span>    rng = np.random.RandomState(seed)</div>
<div class="line"><span class="lineno">  552</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  554</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  555</span>        Y = rand_data.Y</div>
<div class="line"><span class="lineno">  556</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  557</span>            n_components=rand_data.n_components,</div>
<div class="line"><span class="lineno">  558</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  559</span>            weights_init=rand_data.weights,</div>
<div class="line"><span class="lineno">  560</span>            means_init=rand_data.means,</div>
<div class="line"><span class="lineno">  561</span>            precisions_init=rand_data.precisions[covar_type],</div>
<div class="line"><span class="lineno">  562</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  563</span>            max_iter=max_iter,</div>
<div class="line"><span class="lineno">  564</span>            tol=tol,</div>
<div class="line"><span class="lineno">  565</span>        )</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>        <span class="comment"># check if fit_predict(X) is equivalent to fit(X).predict(X)</span></div>
<div class="line"><span class="lineno">  568</span>        f = copy.deepcopy(g)</div>
<div class="line"><span class="lineno">  569</span>        Y_pred1 = f.fit(X).predict(X)</div>
<div class="line"><span class="lineno">  570</span>        Y_pred2 = g.fit_predict(X)</div>
<div class="line"><span class="lineno">  571</span>        assert_array_equal(Y_pred1, Y_pred2)</div>
<div class="line"><span class="lineno">  572</span>        <span class="keyword">assert</span> adjusted_rand_score(Y, Y_pred2) &gt; 0.95</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abafdcf96d09f967e6ac96af72b083b83" name="abafdcf96d09f967e6ac96af72b083b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abafdcf96d09f967e6ac96af72b083b83">&#9670;&#160;</a></span>test_gaussian_mixture_fit_predict_n_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_fit_predict_n_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  575</span><span class="keyword">def </span>test_gaussian_mixture_fit_predict_n_init():</div>
<div class="line"><span class="lineno">  576</span>    <span class="comment"># Check that fit_predict is equivalent to fit.predict, when n_init &gt; 1</span></div>
<div class="line"><span class="lineno">  577</span>    X = np.random.RandomState(0).randn(1000, 5)</div>
<div class="line"><span class="lineno">  578</span>    gm = GaussianMixture(n_components=5, n_init=5, random_state=0)</div>
<div class="line"><span class="lineno">  579</span>    y_pred1 = gm.fit_predict(X)</div>
<div class="line"><span class="lineno">  580</span>    y_pred2 = gm.predict(X)</div>
<div class="line"><span class="lineno">  581</span>    assert_array_equal(y_pred1, y_pred2)</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a991c19c74e81df9bcfdacb4daecdab5c" name="a991c19c74e81df9bcfdacb4daecdab5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a991c19c74e81df9bcfdacb4daecdab5c">&#9670;&#160;</a></span>test_gaussian_mixture_log_probabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_log_probabilities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  433</span><span class="keyword">def </span>test_gaussian_mixture_log_probabilities():</div>
<div class="line"><span class="lineno">  434</span>    <span class="keyword">from</span> <a class="code hl_namespace" href="namespacesklearn_1_1mixture_1_1__gaussian__mixture.html">sklearn.mixture._gaussian_mixture</a> <span class="keyword">import</span> _estimate_log_gaussian_prob</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    <span class="comment"># test against with _naive_lmvnpdf_diag</span></div>
<div class="line"><span class="lineno">  437</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  438</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  439</span>    n_samples = 500</div>
<div class="line"><span class="lineno">  440</span>    n_features = rand_data.n_features</div>
<div class="line"><span class="lineno">  441</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    means = rand_data.means</div>
<div class="line"><span class="lineno">  444</span>    covars_diag = rng.rand(n_components, n_features)</div>
<div class="line"><span class="lineno">  445</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno">  446</span>    log_prob_naive = _naive_lmvnpdf_diag(X, means, covars_diag)</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>    <span class="comment"># full covariances</span></div>
<div class="line"><span class="lineno">  449</span>    precs_full = np.array([np.diag(1.0 / np.sqrt(x)) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> covars_diag])</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    log_prob = _estimate_log_gaussian_prob(X, means, precs_full, <span class="stringliteral">&quot;full&quot;</span>)</div>
<div class="line"><span class="lineno">  452</span>    assert_array_almost_equal(log_prob, log_prob_naive)</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    <span class="comment"># diag covariances</span></div>
<div class="line"><span class="lineno">  455</span>    precs_chol_diag = 1.0 / np.sqrt(covars_diag)</div>
<div class="line"><span class="lineno">  456</span>    log_prob = _estimate_log_gaussian_prob(X, means, precs_chol_diag, <span class="stringliteral">&quot;diag&quot;</span>)</div>
<div class="line"><span class="lineno">  457</span>    assert_array_almost_equal(log_prob, log_prob_naive)</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>    <span class="comment"># tied</span></div>
<div class="line"><span class="lineno">  460</span>    covars_tied = np.array([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> covars_diag]).mean(axis=0)</div>
<div class="line"><span class="lineno">  461</span>    precs_tied = np.diag(np.sqrt(1.0 / covars_tied))</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    log_prob_naive = _naive_lmvnpdf_diag(X, means, [covars_tied] * n_components)</div>
<div class="line"><span class="lineno">  464</span>    log_prob = _estimate_log_gaussian_prob(X, means, precs_tied, <span class="stringliteral">&quot;tied&quot;</span>)</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>    assert_array_almost_equal(log_prob, log_prob_naive)</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>    <span class="comment"># spherical</span></div>
<div class="line"><span class="lineno">  469</span>    covars_spherical = covars_diag.mean(axis=1)</div>
<div class="line"><span class="lineno">  470</span>    precs_spherical = 1.0 / np.sqrt(covars_diag.mean(axis=1))</div>
<div class="line"><span class="lineno">  471</span>    log_prob_naive = _naive_lmvnpdf_diag(</div>
<div class="line"><span class="lineno">  472</span>        X, means, [[k] * n_features <span class="keywordflow">for</span> k <span class="keywordflow">in</span> covars_spherical]</div>
<div class="line"><span class="lineno">  473</span>    )</div>
<div class="line"><span class="lineno">  474</span>    log_prob = _estimate_log_gaussian_prob(X, means, precs_spherical, <span class="stringliteral">&quot;spherical&quot;</span>)</div>
<div class="line"><span class="lineno">  475</span>    assert_array_almost_equal(log_prob, log_prob_naive)</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span><span class="comment"># skip tests on weighted_log_probabilities, log_weights</span></div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="ttc" id="anamespacesklearn_1_1mixture_1_1__gaussian__mixture_html"><div class="ttname"><a href="namespacesklearn_1_1mixture_1_1__gaussian__mixture.html">sklearn.mixture._gaussian_mixture</a></div><div class="ttdef"><b>Definition</b> _gaussian_mixture.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae67305f11088548035a48b7551b24ddd" name="ae67305f11088548035a48b7551b24ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae67305f11088548035a48b7551b24ddd">&#9670;&#160;</a></span>test_gaussian_mixture_n_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_n_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  717</span><span class="keyword">def </span>test_gaussian_mixture_n_parameters():</div>
<div class="line"><span class="lineno">  718</span>    <span class="comment"># Test that the right number of parameters is estimated</span></div>
<div class="line"><span class="lineno">  719</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  720</span>    n_samples, n_features, n_components = 50, 5, 2</div>
<div class="line"><span class="lineno">  721</span>    X = rng.randn(n_samples, n_features)</div>
<div class="line"><span class="lineno">  722</span>    n_params = {<span class="stringliteral">&quot;spherical&quot;</span>: 13, <span class="stringliteral">&quot;diag&quot;</span>: 21, <span class="stringliteral">&quot;tied&quot;</span>: 26, <span class="stringliteral">&quot;full&quot;</span>: 41}</div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">for</span> cv_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  724</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  725</span>            n_components=n_components, covariance_type=cv_type, random_state=rng</div>
<div class="line"><span class="lineno">  726</span>        ).fit(X)</div>
<div class="line"><span class="lineno">  727</span>        <span class="keyword">assert</span> g._n_parameters() == n_params[cv_type]</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1bb45b50cf764aaf4461c639105eeffd" name="a1bb45b50cf764aaf4461c639105eeffd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bb45b50cf764aaf4461c639105eeffd">&#9670;&#160;</a></span>test_gaussian_mixture_precisions_init_diag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_precisions_init_diag </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that we properly initialize `precision_cholesky_` when we manually
provide the precision matrix.

In this regard, we check the consistency between estimating the precision
matrix and providing the same precision matrix as initialization. It should
lead to the same results with the same number of iterations.

If the initialization is wrong then the number of iterations will increase.

Non-regression test for:
https://github.com/scikit-learn/scikit-learn/issues/16944
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1268</span><span class="keyword">def </span>test_gaussian_mixture_precisions_init_diag():</div>
<div class="line"><span class="lineno"> 1269</span>    <span class="stringliteral">&quot;&quot;&quot;Check that we properly initialize `precision_cholesky_` when we manually</span></div>
<div class="line"><span class="lineno"> 1270</span><span class="stringliteral">    provide the precision matrix.</span></div>
<div class="line"><span class="lineno"> 1271</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1272</span><span class="stringliteral">    In this regard, we check the consistency between estimating the precision</span></div>
<div class="line"><span class="lineno"> 1273</span><span class="stringliteral">    matrix and providing the same precision matrix as initialization. It should</span></div>
<div class="line"><span class="lineno"> 1274</span><span class="stringliteral">    lead to the same results with the same number of iterations.</span></div>
<div class="line"><span class="lineno"> 1275</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1276</span><span class="stringliteral">    If the initialization is wrong then the number of iterations will increase.</span></div>
<div class="line"><span class="lineno"> 1277</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1278</span><span class="stringliteral">    Non-regression test for:</span></div>
<div class="line"><span class="lineno"> 1279</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/16944</span></div>
<div class="line"><span class="lineno"> 1280</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1281</span>    <span class="comment"># generate a toy dataset</span></div>
<div class="line"><span class="lineno"> 1282</span>    n_samples = 300</div>
<div class="line"><span class="lineno"> 1283</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1284</span>    shifted_gaussian = rng.randn(n_samples, 2) + np.array([20, 20])</div>
<div class="line"><span class="lineno"> 1285</span>    C = np.array([[0.0, -0.7], [3.5, 0.7]])</div>
<div class="line"><span class="lineno"> 1286</span>    stretched_gaussian = np.dot(rng.randn(n_samples, 2), C)</div>
<div class="line"><span class="lineno"> 1287</span>    X = np.vstack([shifted_gaussian, stretched_gaussian])</div>
<div class="line"><span class="lineno"> 1288</span> </div>
<div class="line"><span class="lineno"> 1289</span>    <span class="comment"># common parameters to check the consistency of precision initialization</span></div>
<div class="line"><span class="lineno"> 1290</span>    n_components, covariance_type, reg_covar, random_state = 2, <span class="stringliteral">&quot;diag&quot;</span>, 1e-6, 0</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>    <span class="comment"># execute the manual initialization to compute the precision matrix:</span></div>
<div class="line"><span class="lineno"> 1293</span>    <span class="comment"># - run KMeans to have an initial guess</span></div>
<div class="line"><span class="lineno"> 1294</span>    <span class="comment"># - estimate the covariance</span></div>
<div class="line"><span class="lineno"> 1295</span>    <span class="comment"># - compute the precision matrix from the estimated covariance</span></div>
<div class="line"><span class="lineno"> 1296</span>    resp = np.zeros((X.shape[0], n_components))</div>
<div class="line"><span class="lineno"> 1297</span>    label = (</div>
<div class="line"><span class="lineno"> 1298</span>        KMeans(n_clusters=n_components, n_init=1, random_state=random_state)</div>
<div class="line"><span class="lineno"> 1299</span>        .fit(X)</div>
<div class="line"><span class="lineno"> 1300</span>        .labels_</div>
<div class="line"><span class="lineno"> 1301</span>    )</div>
<div class="line"><span class="lineno"> 1302</span>    resp[np.arange(X.shape[0]), label] = 1</div>
<div class="line"><span class="lineno"> 1303</span>    _, _, covariance = _estimate_gaussian_parameters(</div>
<div class="line"><span class="lineno"> 1304</span>        X, resp, reg_covar=reg_covar, covariance_type=covariance_type</div>
<div class="line"><span class="lineno"> 1305</span>    )</div>
<div class="line"><span class="lineno"> 1306</span>    precisions_init = 1 / covariance</div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span>    gm_with_init = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1309</span>        n_components=n_components,</div>
<div class="line"><span class="lineno"> 1310</span>        covariance_type=covariance_type,</div>
<div class="line"><span class="lineno"> 1311</span>        reg_covar=reg_covar,</div>
<div class="line"><span class="lineno"> 1312</span>        precisions_init=precisions_init,</div>
<div class="line"><span class="lineno"> 1313</span>        random_state=random_state,</div>
<div class="line"><span class="lineno"> 1314</span>    ).fit(X)</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>    gm_without_init = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1317</span>        n_components=n_components,</div>
<div class="line"><span class="lineno"> 1318</span>        covariance_type=covariance_type,</div>
<div class="line"><span class="lineno"> 1319</span>        reg_covar=reg_covar,</div>
<div class="line"><span class="lineno"> 1320</span>        random_state=random_state,</div>
<div class="line"><span class="lineno"> 1321</span>    ).fit(X)</div>
<div class="line"><span class="lineno"> 1322</span> </div>
<div class="line"><span class="lineno"> 1323</span>    <span class="keyword">assert</span> gm_without_init.n_iter_ == gm_with_init.n_iter_</div>
<div class="line"><span class="lineno"> 1324</span>    assert_allclose(</div>
<div class="line"><span class="lineno"> 1325</span>        gm_with_init.precisions_cholesky_, gm_without_init.precisions_cholesky_</div>
<div class="line"><span class="lineno"> 1326</span>    )</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a18602e5fa2952c0d0bf487c8fad2290f" name="a18602e5fa2952c0d0bf487c8fad2290f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18602e5fa2952c0d0bf487c8fad2290f">&#9670;&#160;</a></span>test_gaussian_mixture_predict_predict_proba()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_predict_predict_proba </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  510</span><span class="keyword">def </span>test_gaussian_mixture_predict_predict_proba():</div>
<div class="line"><span class="lineno">  511</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  512</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  514</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  515</span>        Y = rand_data.Y</div>
<div class="line"><span class="lineno">  516</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  517</span>            n_components=rand_data.n_components,</div>
<div class="line"><span class="lineno">  518</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  519</span>            weights_init=rand_data.weights,</div>
<div class="line"><span class="lineno">  520</span>            means_init=rand_data.means,</div>
<div class="line"><span class="lineno">  521</span>            precisions_init=rand_data.precisions[covar_type],</div>
<div class="line"><span class="lineno">  522</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  523</span>        )</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>        <span class="comment"># Check a warning message arrive if we don&#39;t do fit</span></div>
<div class="line"><span class="lineno">  526</span>        msg = (</div>
<div class="line"><span class="lineno">  527</span>            <span class="stringliteral">&quot;This GaussianMixture instance is not fitted yet. Call &#39;fit&#39; &quot;</span></div>
<div class="line"><span class="lineno">  528</span>            <span class="stringliteral">&quot;with appropriate arguments before using this estimator.&quot;</span></div>
<div class="line"><span class="lineno">  529</span>        )</div>
<div class="line"><span class="lineno">  530</span>        <span class="keyword">with</span> pytest.raises(NotFittedError, match=msg):</div>
<div class="line"><span class="lineno">  531</span>            g.predict(X)</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>        g.fit(X)</div>
<div class="line"><span class="lineno">  534</span>        Y_pred = g.predict(X)</div>
<div class="line"><span class="lineno">  535</span>        Y_pred_proba = g.predict_proba(X).argmax(axis=1)</div>
<div class="line"><span class="lineno">  536</span>        assert_array_equal(Y_pred, Y_pred_proba)</div>
<div class="line"><span class="lineno">  537</span>        <span class="keyword">assert</span> adjusted_rand_score(Y, Y_pred) &gt; 0.95</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:.*did not converge.*&quot;)</span></div>
<div class="line"><span class="lineno">  541</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  542</span>    <span class="stringliteral">&quot;seed, max_iter, tol&quot;</span>,</div>
<div class="line"><span class="lineno">  543</span>    [</div>
<div class="line"><span class="lineno">  544</span>        (0, 2, 1e-7),  <span class="comment"># strict non-convergence</span></div>
<div class="line"><span class="lineno">  545</span>        (1, 2, 1e-1),  <span class="comment"># loose non-convergence</span></div>
<div class="line"><span class="lineno">  546</span>        (3, 300, 1e-7),  <span class="comment"># strict convergence</span></div>
<div class="line"><span class="lineno">  547</span>        (4, 300, 1e-1),  <span class="comment"># loose convergence</span></div>
<div class="line"><span class="lineno">  548</span>    ],</div>
<div class="line"><span class="lineno">  549</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a004ddf433b7a514325b8ba406efffc15" name="a004ddf433b7a514325b8ba406efffc15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a004ddf433b7a514325b8ba406efffc15">&#9670;&#160;</a></span>test_gaussian_mixture_setting_best_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_setting_best_params </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">`GaussianMixture`'s best_parameters, `n_iter_` and `lower_bound_`
must be set appropriately in the case of divergence.

Non-regression test for:
https://github.com/scikit-learn/scikit-learn/issues/18216
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1138</span><span class="keyword">def </span>test_gaussian_mixture_setting_best_params():</div>
<div class="line"><span class="lineno"> 1139</span>    <span class="stringliteral">&quot;&quot;&quot;`GaussianMixture`&#39;s best_parameters, `n_iter_` and `lower_bound_`</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="stringliteral">    must be set appropriately in the case of divergence.</span></div>
<div class="line"><span class="lineno"> 1141</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1142</span><span class="stringliteral">    Non-regression test for:</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/18216</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1145</span>    rnd = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1146</span>    n_samples = 30</div>
<div class="line"><span class="lineno"> 1147</span>    X = rnd.uniform(size=(n_samples, 3))</div>
<div class="line"><span class="lineno"> 1148</span> </div>
<div class="line"><span class="lineno"> 1149</span>    <span class="comment"># following initialization parameters were found to lead to divergence</span></div>
<div class="line"><span class="lineno"> 1150</span>    means_init = np.array(</div>
<div class="line"><span class="lineno"> 1151</span>        [</div>
<div class="line"><span class="lineno"> 1152</span>            [0.670637869618158, 0.21038256107384043, 0.12892629765485303],</div>
<div class="line"><span class="lineno"> 1153</span>            [0.09394051075844147, 0.5759464955561779, 0.929296197576212],</div>
<div class="line"><span class="lineno"> 1154</span>            [0.5033230372781258, 0.9569852381759425, 0.08654043447295741],</div>
<div class="line"><span class="lineno"> 1155</span>            [0.18578301420435747, 0.5531158970919143, 0.19388943970532435],</div>
<div class="line"><span class="lineno"> 1156</span>            [0.4548589928173794, 0.35182513658825276, 0.568146063202464],</div>
<div class="line"><span class="lineno"> 1157</span>            [0.609279894978321, 0.7929063819678847, 0.9620097270828052],</div>
<div class="line"><span class="lineno"> 1158</span>        ]</div>
<div class="line"><span class="lineno"> 1159</span>    )</div>
<div class="line"><span class="lineno"> 1160</span>    precisions_init = np.array(</div>
<div class="line"><span class="lineno"> 1161</span>        [</div>
<div class="line"><span class="lineno"> 1162</span>            999999.999604483,</div>
<div class="line"><span class="lineno"> 1163</span>            999999.9990869573,</div>
<div class="line"><span class="lineno"> 1164</span>            553.7603944542167,</div>
<div class="line"><span class="lineno"> 1165</span>            204.78596008931834,</div>
<div class="line"><span class="lineno"> 1166</span>            15.867423501783637,</div>
<div class="line"><span class="lineno"> 1167</span>            85.4595728389735,</div>
<div class="line"><span class="lineno"> 1168</span>        ]</div>
<div class="line"><span class="lineno"> 1169</span>    )</div>
<div class="line"><span class="lineno"> 1170</span>    weights_init = [</div>
<div class="line"><span class="lineno"> 1171</span>        0.03333333333333341,</div>
<div class="line"><span class="lineno"> 1172</span>        0.03333333333333341,</div>
<div class="line"><span class="lineno"> 1173</span>        0.06666666666666674,</div>
<div class="line"><span class="lineno"> 1174</span>        0.06666666666666674,</div>
<div class="line"><span class="lineno"> 1175</span>        0.7000000000000001,</div>
<div class="line"><span class="lineno"> 1176</span>        0.10000000000000007,</div>
<div class="line"><span class="lineno"> 1177</span>    ]</div>
<div class="line"><span class="lineno"> 1178</span> </div>
<div class="line"><span class="lineno"> 1179</span>    gmm = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1180</span>        covariance_type=<span class="stringliteral">&quot;spherical&quot;</span>,</div>
<div class="line"><span class="lineno"> 1181</span>        reg_covar=0,</div>
<div class="line"><span class="lineno"> 1182</span>        means_init=means_init,</div>
<div class="line"><span class="lineno"> 1183</span>        weights_init=weights_init,</div>
<div class="line"><span class="lineno"> 1184</span>        random_state=rnd,</div>
<div class="line"><span class="lineno"> 1185</span>        n_components=len(weights_init),</div>
<div class="line"><span class="lineno"> 1186</span>        precisions_init=precisions_init,</div>
<div class="line"><span class="lineno"> 1187</span>        max_iter=1,</div>
<div class="line"><span class="lineno"> 1188</span>    )</div>
<div class="line"><span class="lineno"> 1189</span>    <span class="comment"># ensure that no error is thrown during fit</span></div>
<div class="line"><span class="lineno"> 1190</span>    gmm.fit(X)</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>    <span class="comment"># check that the fit did not converge</span></div>
<div class="line"><span class="lineno"> 1193</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> gmm.converged_</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>    <span class="comment"># check that parameters are set for gmm</span></div>
<div class="line"><span class="lineno"> 1196</span>    <span class="keywordflow">for</span> attr <span class="keywordflow">in</span> [</div>
<div class="line"><span class="lineno"> 1197</span>        <span class="stringliteral">&quot;weights_&quot;</span>,</div>
<div class="line"><span class="lineno"> 1198</span>        <span class="stringliteral">&quot;means_&quot;</span>,</div>
<div class="line"><span class="lineno"> 1199</span>        <span class="stringliteral">&quot;covariances_&quot;</span>,</div>
<div class="line"><span class="lineno"> 1200</span>        <span class="stringliteral">&quot;precisions_cholesky_&quot;</span>,</div>
<div class="line"><span class="lineno"> 1201</span>        <span class="stringliteral">&quot;n_iter_&quot;</span>,</div>
<div class="line"><span class="lineno"> 1202</span>        <span class="stringliteral">&quot;lower_bound_&quot;</span>,</div>
<div class="line"><span class="lineno"> 1203</span>    ]:</div>
<div class="line"><span class="lineno"> 1204</span>        <span class="keyword">assert</span> hasattr(gmm, attr)</div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1208</span>    <span class="stringliteral">&quot;init_params&quot;</span>, [<span class="stringliteral">&quot;random&quot;</span>, <span class="stringliteral">&quot;random_from_data&quot;</span>, <span class="stringliteral">&quot;k-means++&quot;</span>, <span class="stringliteral">&quot;kmeans&quot;</span>]</div>
<div class="line"><span class="lineno"> 1209</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa73d2a795e8ed615ccb721a289bffa8b" name="aa73d2a795e8ed615ccb721a289bffa8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa73d2a795e8ed615ccb721a289bffa8b">&#9670;&#160;</a></span>test_gaussian_mixture_single_component_stable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_single_component_stable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Non-regression test for #23032 ensuring 1-component GM works on only a
few samples.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1329</span><span class="keyword">def </span>test_gaussian_mixture_single_component_stable():</div>
<div class="line"><span class="lineno"> 1330</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1331</span><span class="stringliteral">    Non-regression test for #23032 ensuring 1-component GM works on only a</span></div>
<div class="line"><span class="lineno"> 1332</span><span class="stringliteral">    few samples.</span></div>
<div class="line"><span class="lineno"> 1333</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1334</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1335</span>    X = rng.multivariate_normal(np.zeros(2), np.identity(2), size=3)</div>
<div class="line"><span class="lineno"> 1336</span>    gm = GaussianMixture(n_components=1)</div>
<div class="line"><span class="lineno"> 1337</span>    gm.fit(X).sample()</div>
</div><!-- fragment -->
</div>
</div>
<a id="a80820496836931133fb6689e42f796bc" name="a80820496836931133fb6689e42f796bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80820496836931133fb6689e42f796bc">&#9670;&#160;</a></span>test_gaussian_mixture_verbose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_mixture_verbose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  780</span><span class="keyword">def </span>test_gaussian_mixture_verbose():</div>
<div class="line"><span class="lineno">  781</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  782</span>    rand_data = RandomData(rng)</div>
<div class="line"><span class="lineno">  783</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  785</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  786</span>        g = GaussianMixture(</div>
<div class="line"><span class="lineno">  787</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  788</span>            n_init=1,</div>
<div class="line"><span class="lineno">  789</span>            reg_covar=0,</div>
<div class="line"><span class="lineno">  790</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  791</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  792</span>            verbose=1,</div>
<div class="line"><span class="lineno">  793</span>        )</div>
<div class="line"><span class="lineno">  794</span>        h = GaussianMixture(</div>
<div class="line"><span class="lineno">  795</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  796</span>            n_init=1,</div>
<div class="line"><span class="lineno">  797</span>            reg_covar=0,</div>
<div class="line"><span class="lineno">  798</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  799</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  800</span>            verbose=2,</div>
<div class="line"><span class="lineno">  801</span>        )</div>
<div class="line"><span class="lineno">  802</span>        old_stdout = sys.stdout</div>
<div class="line"><span class="lineno">  803</span>        sys.stdout = StringIO()</div>
<div class="line"><span class="lineno">  804</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  805</span>            g.fit(X)</div>
<div class="line"><span class="lineno">  806</span>            h.fit(X)</div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  808</span>            sys.stdout = old_stdout</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:.*did not converge.*&quot;)</span></div>
<div class="line"><span class="lineno">  812</span><span class="preprocessor">@pytest.mark.parametrize(&quot;seed&quot;, (0, 1, 2)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a345b32cd2f4de10e143707c50f38e295" name="a345b32cd2f4de10e143707c50f38e295"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a345b32cd2f4de10e143707c50f38e295">&#9670;&#160;</a></span>test_gaussian_suffstat_sk_spherical()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_gaussian_suffstat_sk_spherical </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  378</span><span class="keyword">def </span>test_gaussian_suffstat_sk_spherical():</div>
<div class="line"><span class="lineno">  379</span>    <span class="comment"># computing spherical covariance equals to the variance of one-dimension</span></div>
<div class="line"><span class="lineno">  380</span>    <span class="comment"># data after flattening, n_components=1</span></div>
<div class="line"><span class="lineno">  381</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  382</span>    n_samples, n_features = 500, 2</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno">  385</span>    X = X - X.mean()</div>
<div class="line"><span class="lineno">  386</span>    resp = np.ones((n_samples, 1))</div>
<div class="line"><span class="lineno">  387</span>    nk = np.array([n_samples])</div>
<div class="line"><span class="lineno">  388</span>    xk = X.mean()</div>
<div class="line"><span class="lineno">  389</span>    covars_pred_spherical = _estimate_gaussian_covariances_spherical(resp, X, nk, xk, 0)</div>
<div class="line"><span class="lineno">  390</span>    covars_pred_spherical2 = np.dot(X.flatten().T, X.flatten()) / (</div>
<div class="line"><span class="lineno">  391</span>        n_features * n_samples</div>
<div class="line"><span class="lineno">  392</span>    )</div>
<div class="line"><span class="lineno">  393</span>    assert_almost_equal(covars_pred_spherical, covars_pred_spherical2)</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    <span class="comment"># check the precision computation</span></div>
<div class="line"><span class="lineno">  396</span>    precs_chol_pred = _compute_precision_cholesky(covars_pred_spherical, <span class="stringliteral">&quot;spherical&quot;</span>)</div>
<div class="line"><span class="lineno">  397</span>    assert_almost_equal(covars_pred_spherical, 1.0 / precs_chol_pred**2)</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a54cb5cd52e3fd6c40985b956912195b9" name="a54cb5cd52e3fd6c40985b956912195b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54cb5cd52e3fd6c40985b956912195b9">&#9670;&#160;</a></span>test_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1119</span><span class="keyword">def </span>test_init():</div>
<div class="line"><span class="lineno"> 1120</span>    <span class="comment"># We check that by increasing the n_init number we have a better solution</span></div>
<div class="line"><span class="lineno"> 1121</span>    <span class="keywordflow">for</span> random_state <span class="keywordflow">in</span> range(15):</div>
<div class="line"><span class="lineno"> 1122</span>        rand_data = RandomData(</div>
<div class="line"><span class="lineno"> 1123</span>            np.random.RandomState(random_state), n_samples=50, scale=1</div>
<div class="line"><span class="lineno"> 1124</span>        )</div>
<div class="line"><span class="lineno"> 1125</span>        n_components = rand_data.n_components</div>
<div class="line"><span class="lineno"> 1126</span>        X = rand_data.X[<span class="stringliteral">&quot;full&quot;</span>]</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>        gmm1 = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1129</span>            n_components=n_components, n_init=1, max_iter=1, random_state=random_state</div>
<div class="line"><span class="lineno"> 1130</span>        ).fit(X)</div>
<div class="line"><span class="lineno"> 1131</span>        gmm2 = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1132</span>            n_components=n_components, n_init=10, max_iter=1, random_state=random_state</div>
<div class="line"><span class="lineno"> 1133</span>        ).fit(X)</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>        <span class="keyword">assert</span> gmm2.lower_bound_ &gt;= gmm1.lower_bound_</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1bc7e0b9ac89b961f525d9eabe3d4661" name="a1bc7e0b9ac89b961f525d9eabe3d4661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bc7e0b9ac89b961f525d9eabe3d4661">&#9670;&#160;</a></span>test_init_means_not_duplicated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_init_means_not_duplicated </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1210</span><span class="keyword">def </span>test_init_means_not_duplicated(init_params, global_random_seed):</div>
<div class="line"><span class="lineno"> 1211</span>    <span class="comment"># Check that all initialisations provide not duplicated starting means</span></div>
<div class="line"><span class="lineno"> 1212</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno"> 1213</span>    rand_data = RandomData(rng, scale=5)</div>
<div class="line"><span class="lineno"> 1214</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno"> 1215</span>    X = rand_data.X[<span class="stringliteral">&quot;full&quot;</span>]</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>    gmm = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1218</span>        n_components=n_components, init_params=init_params, random_state=rng, max_iter=0</div>
<div class="line"><span class="lineno"> 1219</span>    )</div>
<div class="line"><span class="lineno"> 1220</span>    gmm.fit(X)</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>    means = gmm.means_</div>
<div class="line"><span class="lineno"> 1223</span>    <span class="keywordflow">for</span> i_mean, j_mean <span class="keywordflow">in</span> itertools.combinations(means, r=2):</div>
<div class="line"><span class="lineno"> 1224</span>        <span class="keyword">assert</span> <span class="keywordflow">not</span> np.allclose(i_mean, j_mean)</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span> </div>
<div class="line"><span class="lineno"> 1227</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1228</span>    <span class="stringliteral">&quot;init_params&quot;</span>, [<span class="stringliteral">&quot;random&quot;</span>, <span class="stringliteral">&quot;random_from_data&quot;</span>, <span class="stringliteral">&quot;k-means++&quot;</span>, <span class="stringliteral">&quot;kmeans&quot;</span>]</div>
<div class="line"><span class="lineno"> 1229</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a165e2339e2dccd428fe9a62a88c8a28c" name="a165e2339e2dccd428fe9a62a88c8a28c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a165e2339e2dccd428fe9a62a88c8a28c">&#9670;&#160;</a></span>test_max_iter_zero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_max_iter_zero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1248</span><span class="keyword">def </span>test_max_iter_zero():</div>
<div class="line"><span class="lineno"> 1249</span>    <span class="comment"># Check that max_iter=0 returns initialisation as expected</span></div>
<div class="line"><span class="lineno"> 1250</span>    <span class="comment"># Pick arbitrary initial means and check equal to max_iter=0</span></div>
<div class="line"><span class="lineno"> 1251</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1252</span>    rand_data = RandomData(rng, scale=5)</div>
<div class="line"><span class="lineno"> 1253</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno"> 1254</span>    X = rand_data.X[<span class="stringliteral">&quot;full&quot;</span>]</div>
<div class="line"><span class="lineno"> 1255</span>    means_init = [[20, 30], [30, 25]]</div>
<div class="line"><span class="lineno"> 1256</span>    gmm = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1257</span>        n_components=n_components,</div>
<div class="line"><span class="lineno"> 1258</span>        random_state=rng,</div>
<div class="line"><span class="lineno"> 1259</span>        means_init=means_init,</div>
<div class="line"><span class="lineno"> 1260</span>        tol=1e-06,</div>
<div class="line"><span class="lineno"> 1261</span>        max_iter=0,</div>
<div class="line"><span class="lineno"> 1262</span>    )</div>
<div class="line"><span class="lineno"> 1263</span>    gmm.fit(X)</div>
<div class="line"><span class="lineno"> 1264</span> </div>
<div class="line"><span class="lineno"> 1265</span>    assert_allclose(gmm.means_, means_init)</div>
<div class="line"><span class="lineno"> 1266</span> </div>
<div class="line"><span class="lineno"> 1267</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac050340b2f26c48a630bec3c1f077ed8" name="ac050340b2f26c48a630bec3c1f077ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac050340b2f26c48a630bec3c1f077ed8">&#9670;&#160;</a></span>test_means_for_all_inits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_means_for_all_inits </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1230</span><span class="keyword">def </span>test_means_for_all_inits(init_params, global_random_seed):</div>
<div class="line"><span class="lineno"> 1231</span>    <span class="comment"># Check fitted means properties for all initializations</span></div>
<div class="line"><span class="lineno"> 1232</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno"> 1233</span>    rand_data = RandomData(rng, scale=5)</div>
<div class="line"><span class="lineno"> 1234</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno"> 1235</span>    X = rand_data.X[<span class="stringliteral">&quot;full&quot;</span>]</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>    gmm = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1238</span>        n_components=n_components, init_params=init_params, random_state=rng</div>
<div class="line"><span class="lineno"> 1239</span>    )</div>
<div class="line"><span class="lineno"> 1240</span>    gmm.fit(X)</div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span>    <span class="keyword">assert</span> gmm.means_.shape == (n_components, X.shape[1])</div>
<div class="line"><span class="lineno"> 1243</span>    <span class="keyword">assert</span> np.all(X.min(axis=0) &lt;= gmm.means_)</div>
<div class="line"><span class="lineno"> 1244</span>    <span class="keyword">assert</span> np.all(gmm.means_ &lt;= X.max(axis=0))</div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keyword">assert</span> gmm.converged_</div>
<div class="line"><span class="lineno"> 1246</span> </div>
<div class="line"><span class="lineno"> 1247</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa31360ec50e390654b345b5d3343c3dc" name="aa31360ec50e390654b345b5d3343c3dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa31360ec50e390654b345b5d3343c3dc">&#9670;&#160;</a></span>test_monotonic_likelihood()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_monotonic_likelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  971</span><span class="keyword">def </span>test_monotonic_likelihood():</div>
<div class="line"><span class="lineno">  972</span>    <span class="comment"># We check that each step of the EM without regularization improve</span></div>
<div class="line"><span class="lineno">  973</span>    <span class="comment"># monotonically the training set likelihood</span></div>
<div class="line"><span class="lineno">  974</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  975</span>    rand_data = RandomData(rng, scale=7)</div>
<div class="line"><span class="lineno">  976</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  979</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  980</span>        gmm = GaussianMixture(</div>
<div class="line"><span class="lineno">  981</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  982</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  983</span>            reg_covar=0,</div>
<div class="line"><span class="lineno">  984</span>            warm_start=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  985</span>            max_iter=1,</div>
<div class="line"><span class="lineno">  986</span>            random_state=rng,</div>
<div class="line"><span class="lineno">  987</span>            tol=1e-7,</div>
<div class="line"><span class="lineno">  988</span>        )</div>
<div class="line"><span class="lineno">  989</span>        current_log_likelihood = -np.infty</div>
<div class="line"><span class="lineno">  990</span>        <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  991</span>            warnings.simplefilter(<span class="stringliteral">&quot;ignore&quot;</span>, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  992</span>            <span class="comment"># Do one training iteration at a time so we can make sure that the</span></div>
<div class="line"><span class="lineno">  993</span>            <span class="comment"># training log likelihood increases after each iteration.</span></div>
<div class="line"><span class="lineno">  994</span>            <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(600):</div>
<div class="line"><span class="lineno">  995</span>                prev_log_likelihood = current_log_likelihood</div>
<div class="line"><span class="lineno">  996</span>                current_log_likelihood = gmm.fit(X).score(X)</div>
<div class="line"><span class="lineno">  997</span>                <span class="keyword">assert</span> current_log_likelihood &gt;= prev_log_likelihood</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>                <span class="keywordflow">if</span> gmm.converged_:</div>
<div class="line"><span class="lineno"> 1000</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1001</span> </div>
<div class="line"><span class="lineno"> 1002</span>            <span class="keyword">assert</span> gmm.converged_</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a903e262ad1fa3ad9bd972faeedd96175" name="a903e262ad1fa3ad9bd972faeedd96175"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a903e262ad1fa3ad9bd972faeedd96175">&#9670;&#160;</a></span>test_multiple_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_multiple_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  691</span><span class="keyword">def </span>test_multiple_init():</div>
<div class="line"><span class="lineno">  692</span>    <span class="comment"># Test that multiple inits does not much worse than a single one</span></div>
<div class="line"><span class="lineno">  693</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  694</span>    n_samples, n_features, n_components = 50, 5, 2</div>
<div class="line"><span class="lineno">  695</span>    X = rng.randn(n_samples, n_features)</div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">for</span> cv_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno">  697</span>        train1 = (</div>
<div class="line"><span class="lineno">  698</span>            GaussianMixture(</div>
<div class="line"><span class="lineno">  699</span>                n_components=n_components, covariance_type=cv_type, random_state=0</div>
<div class="line"><span class="lineno">  700</span>            )</div>
<div class="line"><span class="lineno">  701</span>            .fit(X)</div>
<div class="line"><span class="lineno">  702</span>            .score(X)</div>
<div class="line"><span class="lineno">  703</span>        )</div>
<div class="line"><span class="lineno">  704</span>        train2 = (</div>
<div class="line"><span class="lineno">  705</span>            GaussianMixture(</div>
<div class="line"><span class="lineno">  706</span>                n_components=n_components,</div>
<div class="line"><span class="lineno">  707</span>                covariance_type=cv_type,</div>
<div class="line"><span class="lineno">  708</span>                random_state=0,</div>
<div class="line"><span class="lineno">  709</span>                n_init=5,</div>
<div class="line"><span class="lineno">  710</span>            )</div>
<div class="line"><span class="lineno">  711</span>            .fit(X)</div>
<div class="line"><span class="lineno">  712</span>            .score(X)</div>
<div class="line"><span class="lineno">  713</span>        )</div>
<div class="line"><span class="lineno">  714</span>        <span class="keyword">assert</span> train2 &gt;= train1</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aad347a1c97c43db1a0bcda116a80c795" name="aad347a1c97c43db1a0bcda116a80c795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad347a1c97c43db1a0bcda116a80c795">&#9670;&#160;</a></span>test_property()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_property </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1037</span><span class="keyword">def </span>test_property():</div>
<div class="line"><span class="lineno"> 1038</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1039</span>    rand_data = RandomData(rng, scale=7)</div>
<div class="line"><span class="lineno"> 1040</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno"> 1043</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno"> 1044</span>        gmm = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1045</span>            n_components=n_components,</div>
<div class="line"><span class="lineno"> 1046</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno"> 1047</span>            random_state=rng,</div>
<div class="line"><span class="lineno"> 1048</span>            n_init=5,</div>
<div class="line"><span class="lineno"> 1049</span>        )</div>
<div class="line"><span class="lineno"> 1050</span>        gmm.fit(X)</div>
<div class="line"><span class="lineno"> 1051</span>        <span class="keywordflow">if</span> covar_type == <span class="stringliteral">&quot;full&quot;</span>:</div>
<div class="line"><span class="lineno"> 1052</span>            <span class="keywordflow">for</span> prec, covar <span class="keywordflow">in</span> zip(gmm.precisions_, gmm.covariances_):</div>
<div class="line"><span class="lineno"> 1053</span> </div>
<div class="line"><span class="lineno"> 1054</span>                assert_array_almost_equal(linalg.inv(prec), covar)</div>
<div class="line"><span class="lineno"> 1055</span>        <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;tied&quot;</span>:</div>
<div class="line"><span class="lineno"> 1056</span>            assert_array_almost_equal(linalg.inv(gmm.precisions_), gmm.covariances_)</div>
<div class="line"><span class="lineno"> 1057</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1058</span>            assert_array_almost_equal(gmm.precisions_, 1.0 / gmm.covariances_)</div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a973c32008ee1de69d453c6d9bb8390fc" name="a973c32008ee1de69d453c6d9bb8390fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a973c32008ee1de69d453c6d9bb8390fc">&#9670;&#160;</a></span>test_regularisation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_regularisation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1005</span><span class="keyword">def </span>test_regularisation():</div>
<div class="line"><span class="lineno"> 1006</span>    <span class="comment"># We train the GaussianMixture on degenerate data by defining two clusters</span></div>
<div class="line"><span class="lineno"> 1007</span>    <span class="comment"># of a 0 covariance.</span></div>
<div class="line"><span class="lineno"> 1008</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1009</span>    n_samples, n_features = 10, 5</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>    X = np.vstack(</div>
<div class="line"><span class="lineno"> 1012</span>        (np.ones((n_samples // 2, n_features)), np.zeros((n_samples // 2, n_features)))</div>
<div class="line"><span class="lineno"> 1013</span>    )</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno"> 1016</span>        gmm = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1017</span>            n_components=n_samples,</div>
<div class="line"><span class="lineno"> 1018</span>            reg_covar=0,</div>
<div class="line"><span class="lineno"> 1019</span>            covariance_type=covar_type,</div>
<div class="line"><span class="lineno"> 1020</span>            random_state=rng,</div>
<div class="line"><span class="lineno"> 1021</span>        )</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>        <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno"> 1024</span>            warnings.simplefilter(<span class="stringliteral">&quot;ignore&quot;</span>, RuntimeWarning)</div>
<div class="line"><span class="lineno"> 1025</span>            msg = re.escape(</div>
<div class="line"><span class="lineno"> 1026</span>                <span class="stringliteral">&quot;Fitting the mixture model failed because some components have&quot;</span></div>
<div class="line"><span class="lineno"> 1027</span>                <span class="stringliteral">&quot; ill-defined empirical covariance (for instance caused by &quot;</span></div>
<div class="line"><span class="lineno"> 1028</span>                <span class="stringliteral">&quot;singleton or collapsed samples). Try to decrease the number &quot;</span></div>
<div class="line"><span class="lineno"> 1029</span>                <span class="stringliteral">&quot;of components, or increase reg_covar.&quot;</span></div>
<div class="line"><span class="lineno"> 1030</span>            )</div>
<div class="line"><span class="lineno"> 1031</span>            <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno"> 1032</span>                gmm.fit(X)</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>            gmm.set_params(reg_covar=1e-6).fit(X)</div>
<div class="line"><span class="lineno"> 1035</span> </div>
<div class="line"><span class="lineno"> 1036</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c11da58ff195af60f215fdd1ff9634b" name="a1c11da58ff195af60f215fdd1ff9634b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c11da58ff195af60f215fdd1ff9634b">&#9670;&#160;</a></span>test_sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_sample </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1061</span><span class="keyword">def </span>test_sample():</div>
<div class="line"><span class="lineno"> 1062</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1063</span>    rand_data = RandomData(rng, scale=7, n_components=3)</div>
<div class="line"><span class="lineno"> 1064</span>    n_features, n_components = rand_data.n_features, rand_data.n_components</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>    <span class="keywordflow">for</span> covar_type <span class="keywordflow">in</span> COVARIANCE_TYPE:</div>
<div class="line"><span class="lineno"> 1067</span>        X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>        gmm = GaussianMixture(</div>
<div class="line"><span class="lineno"> 1070</span>            n_components=n_components, covariance_type=covar_type, random_state=rng</div>
<div class="line"><span class="lineno"> 1071</span>        )</div>
<div class="line"><span class="lineno"> 1072</span>        <span class="comment"># To sample we need that GaussianMixture is fitted</span></div>
<div class="line"><span class="lineno"> 1073</span>        msg = <span class="stringliteral">&quot;This GaussianMixture instance is not fitted&quot;</span></div>
<div class="line"><span class="lineno"> 1074</span>        <span class="keyword">with</span> pytest.raises(NotFittedError, match=msg):</div>
<div class="line"><span class="lineno"> 1075</span>            gmm.sample(0)</div>
<div class="line"><span class="lineno"> 1076</span>        gmm.fit(X)</div>
<div class="line"><span class="lineno"> 1077</span> </div>
<div class="line"><span class="lineno"> 1078</span>        msg = <span class="stringliteral">&quot;Invalid value for &#39;n_samples&#39;&quot;</span></div>
<div class="line"><span class="lineno"> 1079</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno"> 1080</span>            gmm.sample(0)</div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span>        <span class="comment"># Just to make sure the class samples correctly</span></div>
<div class="line"><span class="lineno"> 1083</span>        n_samples = 20000</div>
<div class="line"><span class="lineno"> 1084</span>        X_s, y_s = gmm.sample(n_samples)</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>        <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(n_components):</div>
<div class="line"><span class="lineno"> 1087</span>            <span class="keywordflow">if</span> covar_type == <span class="stringliteral">&quot;full&quot;</span>:</div>
<div class="line"><span class="lineno"> 1088</span>                assert_array_almost_equal(</div>
<div class="line"><span class="lineno"> 1089</span>                    gmm.covariances_[k], np.cov(X_s[y_s == k].T), decimal=1</div>
<div class="line"><span class="lineno"> 1090</span>                )</div>
<div class="line"><span class="lineno"> 1091</span>            <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;tied&quot;</span>:</div>
<div class="line"><span class="lineno"> 1092</span>                assert_array_almost_equal(</div>
<div class="line"><span class="lineno"> 1093</span>                    gmm.covariances_, np.cov(X_s[y_s == k].T), decimal=1</div>
<div class="line"><span class="lineno"> 1094</span>                )</div>
<div class="line"><span class="lineno"> 1095</span>            <span class="keywordflow">elif</span> covar_type == <span class="stringliteral">&quot;diag&quot;</span>:</div>
<div class="line"><span class="lineno"> 1096</span>                assert_array_almost_equal(</div>
<div class="line"><span class="lineno"> 1097</span>                    gmm.covariances_[k], np.diag(np.cov(X_s[y_s == k].T)), decimal=1</div>
<div class="line"><span class="lineno"> 1098</span>                )</div>
<div class="line"><span class="lineno"> 1099</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1100</span>                assert_array_almost_equal(</div>
<div class="line"><span class="lineno"> 1101</span>                    gmm.covariances_[k],</div>
<div class="line"><span class="lineno"> 1102</span>                    np.var(X_s[y_s == k] - gmm.means_[k]),</div>
<div class="line"><span class="lineno"> 1103</span>                    decimal=1,</div>
<div class="line"><span class="lineno"> 1104</span>                )</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>        means_s = np.array([np.mean(X_s[y_s == k], 0) <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(n_components)])</div>
<div class="line"><span class="lineno"> 1107</span>        assert_array_almost_equal(gmm.means_, means_s, decimal=1)</div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>        <span class="comment"># Check shapes of sampled data, see</span></div>
<div class="line"><span class="lineno"> 1110</span>        <span class="comment"># https://github.com/scikit-learn/scikit-learn/issues/7701</span></div>
<div class="line"><span class="lineno"> 1111</span>        <span class="keyword">assert</span> X_s.shape == (n_samples, n_features)</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>        <span class="keywordflow">for</span> sample_size <span class="keywordflow">in</span> range(1, 100):</div>
<div class="line"><span class="lineno"> 1114</span>            X_s, _ = gmm.sample(sample_size)</div>
<div class="line"><span class="lineno"> 1115</span>            <span class="keyword">assert</span> X_s.shape == (sample_size, n_features)</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span><span class="preprocessor">@ignore_warnings(category=ConvergenceWarning)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab92e7e8c87793da47c3e9de8003930b0" name="ab92e7e8c87793da47c3e9de8003930b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab92e7e8c87793da47c3e9de8003930b0">&#9670;&#160;</a></span>test_score()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_score </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  903</span><span class="keyword">def </span>test_score():</div>
<div class="line"><span class="lineno">  904</span>    covar_type = <span class="stringliteral">&quot;full&quot;</span></div>
<div class="line"><span class="lineno">  905</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  906</span>    rand_data = RandomData(rng, scale=7)</div>
<div class="line"><span class="lineno">  907</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  908</span>    X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>    <span class="comment"># Check the error message if we don&#39;t call fit</span></div>
<div class="line"><span class="lineno">  911</span>    gmm1 = GaussianMixture(</div>
<div class="line"><span class="lineno">  912</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  913</span>        n_init=1,</div>
<div class="line"><span class="lineno">  914</span>        max_iter=1,</div>
<div class="line"><span class="lineno">  915</span>        reg_covar=0,</div>
<div class="line"><span class="lineno">  916</span>        random_state=rng,</div>
<div class="line"><span class="lineno">  917</span>        covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  918</span>    )</div>
<div class="line"><span class="lineno">  919</span>    msg = (</div>
<div class="line"><span class="lineno">  920</span>        <span class="stringliteral">&quot;This GaussianMixture instance is not fitted yet. Call &#39;fit&#39; with &quot;</span></div>
<div class="line"><span class="lineno">  921</span>        <span class="stringliteral">&quot;appropriate arguments before using this estimator.&quot;</span></div>
<div class="line"><span class="lineno">  922</span>    )</div>
<div class="line"><span class="lineno">  923</span>    <span class="keyword">with</span> pytest.raises(NotFittedError, match=msg):</div>
<div class="line"><span class="lineno">  924</span>        gmm1.score(X)</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span>    <span class="comment"># Check score value</span></div>
<div class="line"><span class="lineno">  927</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  928</span>        warnings.simplefilter(<span class="stringliteral">&quot;ignore&quot;</span>, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  929</span>        gmm1.fit(X)</div>
<div class="line"><span class="lineno">  930</span>    gmm_score = gmm1.score(X)</div>
<div class="line"><span class="lineno">  931</span>    gmm_score_proba = gmm1.score_samples(X).mean()</div>
<div class="line"><span class="lineno">  932</span>    assert_almost_equal(gmm_score, gmm_score_proba)</div>
<div class="line"><span class="lineno">  933</span> </div>
<div class="line"><span class="lineno">  934</span>    <span class="comment"># Check if the score increase</span></div>
<div class="line"><span class="lineno">  935</span>    gmm2 = GaussianMixture(</div>
<div class="line"><span class="lineno">  936</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  937</span>        n_init=1,</div>
<div class="line"><span class="lineno">  938</span>        reg_covar=0,</div>
<div class="line"><span class="lineno">  939</span>        random_state=rng,</div>
<div class="line"><span class="lineno">  940</span>        covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  941</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  942</span>    <span class="keyword">assert</span> gmm2.score(X) &gt; gmm1.score(X)</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac982217038f15e9bd35e94aecc384efc" name="ac982217038f15e9bd35e94aecc384efc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac982217038f15e9bd35e94aecc384efc">&#9670;&#160;</a></span>test_score_samples()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_score_samples </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  945</span><span class="keyword">def </span>test_score_samples():</div>
<div class="line"><span class="lineno">  946</span>    covar_type = <span class="stringliteral">&quot;full&quot;</span></div>
<div class="line"><span class="lineno">  947</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  948</span>    rand_data = RandomData(rng, scale=7)</div>
<div class="line"><span class="lineno">  949</span>    n_components = rand_data.n_components</div>
<div class="line"><span class="lineno">  950</span>    X = rand_data.X[covar_type]</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>    <span class="comment"># Check the error message if we don&#39;t call fit</span></div>
<div class="line"><span class="lineno">  953</span>    gmm = GaussianMixture(</div>
<div class="line"><span class="lineno">  954</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  955</span>        n_init=1,</div>
<div class="line"><span class="lineno">  956</span>        reg_covar=0,</div>
<div class="line"><span class="lineno">  957</span>        random_state=rng,</div>
<div class="line"><span class="lineno">  958</span>        covariance_type=covar_type,</div>
<div class="line"><span class="lineno">  959</span>    )</div>
<div class="line"><span class="lineno">  960</span>    msg = (</div>
<div class="line"><span class="lineno">  961</span>        <span class="stringliteral">&quot;This GaussianMixture instance is not fitted yet. Call &#39;fit&#39; with &quot;</span></div>
<div class="line"><span class="lineno">  962</span>        <span class="stringliteral">&quot;appropriate arguments before using this estimator.&quot;</span></div>
<div class="line"><span class="lineno">  963</span>    )</div>
<div class="line"><span class="lineno">  964</span>    <span class="keyword">with</span> pytest.raises(NotFittedError, match=msg):</div>
<div class="line"><span class="lineno">  965</span>        gmm.score_samples(X)</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>    gmm_score_samples = gmm.fit(X).score_samples(X)</div>
<div class="line"><span class="lineno">  968</span>    <span class="keyword">assert</span> gmm_score_samples.shape[0] == rand_data.n_samples</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa854747fdfe2105e21d6f94195739bad" name="aa854747fdfe2105e21d6f94195739bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa854747fdfe2105e21d6f94195739bad">&#9670;&#160;</a></span>test_suffstat_sk_diag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_suffstat_sk_diag </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  353</span><span class="keyword">def </span>test_suffstat_sk_diag():</div>
<div class="line"><span class="lineno">  354</span>    <span class="comment"># test against &#39;full&#39; case</span></div>
<div class="line"><span class="lineno">  355</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  356</span>    n_samples, n_features, n_components = 500, 2, 2</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    resp = rng.rand(n_samples, n_components)</div>
<div class="line"><span class="lineno">  359</span>    resp = resp / resp.sum(axis=1)[:, np.newaxis]</div>
<div class="line"><span class="lineno">  360</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno">  361</span>    nk = resp.sum(axis=0)</div>
<div class="line"><span class="lineno">  362</span>    xk = np.dot(resp.T, X) / nk[:, np.newaxis]</div>
<div class="line"><span class="lineno">  363</span>    covars_pred_full = _estimate_gaussian_covariances_full(resp, X, nk, xk, 0)</div>
<div class="line"><span class="lineno">  364</span>    covars_pred_diag = _estimate_gaussian_covariances_diag(resp, X, nk, xk, 0)</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    ecov = EmpiricalCovariance()</div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">for</span> cov_full, cov_diag <span class="keywordflow">in</span> zip(covars_pred_full, covars_pred_diag):</div>
<div class="line"><span class="lineno">  368</span>        ecov.covariance_ = np.diag(np.diag(cov_full))</div>
<div class="line"><span class="lineno">  369</span>        cov_diag = np.diag(cov_diag)</div>
<div class="line"><span class="lineno">  370</span>        assert_almost_equal(ecov.error_norm(cov_diag, norm=<span class="stringliteral">&quot;frobenius&quot;</span>), 0)</div>
<div class="line"><span class="lineno">  371</span>        assert_almost_equal(ecov.error_norm(cov_diag, norm=<span class="stringliteral">&quot;spectral&quot;</span>), 0)</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    <span class="comment"># check the precision computation</span></div>
<div class="line"><span class="lineno">  374</span>    precs_chol_pred = _compute_precision_cholesky(covars_pred_diag, <span class="stringliteral">&quot;diag&quot;</span>)</div>
<div class="line"><span class="lineno">  375</span>    assert_almost_equal(covars_pred_diag, 1.0 / precs_chol_pred**2)</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a342c7067bb86f36a1b0ecc81c4f0fd89" name="a342c7067bb86f36a1b0ecc81c4f0fd89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342c7067bb86f36a1b0ecc81c4f0fd89">&#9670;&#160;</a></span>test_suffstat_sk_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_suffstat_sk_full </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  281</span><span class="keyword">def </span>test_suffstat_sk_full():</div>
<div class="line"><span class="lineno">  282</span>    <span class="comment"># compare the precision matrix compute from the</span></div>
<div class="line"><span class="lineno">  283</span>    <span class="comment"># EmpiricalCovariance.covariance fitted on X*sqrt(resp)</span></div>
<div class="line"><span class="lineno">  284</span>    <span class="comment"># with _sufficient_sk_full, n_components=1</span></div>
<div class="line"><span class="lineno">  285</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  286</span>    n_samples, n_features = 500, 2</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="comment"># special case 1, assuming data is &quot;centered&quot;</span></div>
<div class="line"><span class="lineno">  289</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno">  290</span>    resp = rng.rand(n_samples, 1)</div>
<div class="line"><span class="lineno">  291</span>    X_resp = np.sqrt(resp) * X</div>
<div class="line"><span class="lineno">  292</span>    nk = np.array([n_samples])</div>
<div class="line"><span class="lineno">  293</span>    xk = np.zeros((1, n_features))</div>
<div class="line"><span class="lineno">  294</span>    covars_pred = _estimate_gaussian_covariances_full(resp, X, nk, xk, 0)</div>
<div class="line"><span class="lineno">  295</span>    ecov = EmpiricalCovariance(assume_centered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  296</span>    ecov.fit(X_resp)</div>
<div class="line"><span class="lineno">  297</span>    assert_almost_equal(ecov.error_norm(covars_pred[0], norm=<span class="stringliteral">&quot;frobenius&quot;</span>), 0)</div>
<div class="line"><span class="lineno">  298</span>    assert_almost_equal(ecov.error_norm(covars_pred[0], norm=<span class="stringliteral">&quot;spectral&quot;</span>), 0)</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="comment"># check the precision computation</span></div>
<div class="line"><span class="lineno">  301</span>    precs_chol_pred = _compute_precision_cholesky(covars_pred, <span class="stringliteral">&quot;full&quot;</span>)</div>
<div class="line"><span class="lineno">  302</span>    precs_pred = np.array([np.dot(prec, prec.T) <span class="keywordflow">for</span> prec <span class="keywordflow">in</span> precs_chol_pred])</div>
<div class="line"><span class="lineno">  303</span>    precs_est = np.array([linalg.inv(cov) <span class="keywordflow">for</span> cov <span class="keywordflow">in</span> covars_pred])</div>
<div class="line"><span class="lineno">  304</span>    assert_array_almost_equal(precs_est, precs_pred)</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    <span class="comment"># special case 2, assuming resp are all ones</span></div>
<div class="line"><span class="lineno">  307</span>    resp = np.ones((n_samples, 1))</div>
<div class="line"><span class="lineno">  308</span>    nk = np.array([n_samples])</div>
<div class="line"><span class="lineno">  309</span>    xk = X.mean(axis=0).reshape((1, -1))</div>
<div class="line"><span class="lineno">  310</span>    covars_pred = _estimate_gaussian_covariances_full(resp, X, nk, xk, 0)</div>
<div class="line"><span class="lineno">  311</span>    ecov = EmpiricalCovariance(assume_centered=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  312</span>    ecov.fit(X)</div>
<div class="line"><span class="lineno">  313</span>    assert_almost_equal(ecov.error_norm(covars_pred[0], norm=<span class="stringliteral">&quot;frobenius&quot;</span>), 0)</div>
<div class="line"><span class="lineno">  314</span>    assert_almost_equal(ecov.error_norm(covars_pred[0], norm=<span class="stringliteral">&quot;spectral&quot;</span>), 0)</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    <span class="comment"># check the precision computation</span></div>
<div class="line"><span class="lineno">  317</span>    precs_chol_pred = _compute_precision_cholesky(covars_pred, <span class="stringliteral">&quot;full&quot;</span>)</div>
<div class="line"><span class="lineno">  318</span>    precs_pred = np.array([np.dot(prec, prec.T) <span class="keywordflow">for</span> prec <span class="keywordflow">in</span> precs_chol_pred])</div>
<div class="line"><span class="lineno">  319</span>    precs_est = np.array([linalg.inv(cov) <span class="keywordflow">for</span> cov <span class="keywordflow">in</span> covars_pred])</div>
<div class="line"><span class="lineno">  320</span>    assert_array_almost_equal(precs_est, precs_pred)</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad24b837a59d0ea5fba6b04c01b519fff" name="ad24b837a59d0ea5fba6b04c01b519fff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24b837a59d0ea5fba6b04c01b519fff">&#9670;&#160;</a></span>test_suffstat_sk_tied()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_suffstat_sk_tied </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  323</span><span class="keyword">def </span>test_suffstat_sk_tied():</div>
<div class="line"><span class="lineno">  324</span>    <span class="comment"># use equation Nk * Sk / N = S_tied</span></div>
<div class="line"><span class="lineno">  325</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  326</span>    n_samples, n_features, n_components = 500, 2, 2</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    resp = rng.rand(n_samples, n_components)</div>
<div class="line"><span class="lineno">  329</span>    resp = resp / resp.sum(axis=1)[:, np.newaxis]</div>
<div class="line"><span class="lineno">  330</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno">  331</span>    nk = resp.sum(axis=0)</div>
<div class="line"><span class="lineno">  332</span>    xk = np.dot(resp.T, X) / nk[:, np.newaxis]</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    covars_pred_full = _estimate_gaussian_covariances_full(resp, X, nk, xk, 0)</div>
<div class="line"><span class="lineno">  335</span>    covars_pred_full = (</div>
<div class="line"><span class="lineno">  336</span>        np.sum(nk[:, np.newaxis, np.newaxis] * covars_pred_full, 0) / n_samples</div>
<div class="line"><span class="lineno">  337</span>    )</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    covars_pred_tied = _estimate_gaussian_covariances_tied(resp, X, nk, xk, 0)</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    ecov = EmpiricalCovariance()</div>
<div class="line"><span class="lineno">  342</span>    ecov.covariance_ = covars_pred_full</div>
<div class="line"><span class="lineno">  343</span>    assert_almost_equal(ecov.error_norm(covars_pred_tied, norm=<span class="stringliteral">&quot;frobenius&quot;</span>), 0)</div>
<div class="line"><span class="lineno">  344</span>    assert_almost_equal(ecov.error_norm(covars_pred_tied, norm=<span class="stringliteral">&quot;spectral&quot;</span>), 0)</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    <span class="comment"># check the precision computation</span></div>
<div class="line"><span class="lineno">  347</span>    precs_chol_pred = _compute_precision_cholesky(covars_pred_tied, <span class="stringliteral">&quot;tied&quot;</span>)</div>
<div class="line"><span class="lineno">  348</span>    precs_pred = np.dot(precs_chol_pred, precs_chol_pred.T)</div>
<div class="line"><span class="lineno">  349</span>    precs_est = linalg.inv(covars_pred_tied)</div>
<div class="line"><span class="lineno">  350</span>    assert_array_almost_equal(precs_est, precs_pred)</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b527ead4ff5593acb4275a9ba965c94" name="a3b527ead4ff5593acb4275a9ba965c94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b527ead4ff5593acb4275a9ba965c94">&#9670;&#160;</a></span>test_warm_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.mixture.tests.test_gaussian_mixture.test_warm_start </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  813</span><span class="keyword">def </span>test_warm_start(seed):</div>
<div class="line"><span class="lineno">  814</span>    random_state = seed</div>
<div class="line"><span class="lineno">  815</span>    rng = np.random.RandomState(random_state)</div>
<div class="line"><span class="lineno">  816</span>    n_samples, n_features, n_components = 500, 2, 2</div>
<div class="line"><span class="lineno">  817</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    <span class="comment"># Assert the warm_start give the same result for the same number of iter</span></div>
<div class="line"><span class="lineno">  820</span>    g = GaussianMixture(</div>
<div class="line"><span class="lineno">  821</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  822</span>        n_init=1,</div>
<div class="line"><span class="lineno">  823</span>        max_iter=2,</div>
<div class="line"><span class="lineno">  824</span>        reg_covar=0,</div>
<div class="line"><span class="lineno">  825</span>        random_state=random_state,</div>
<div class="line"><span class="lineno">  826</span>        warm_start=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  827</span>    )</div>
<div class="line"><span class="lineno">  828</span>    h = GaussianMixture(</div>
<div class="line"><span class="lineno">  829</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  830</span>        n_init=1,</div>
<div class="line"><span class="lineno">  831</span>        max_iter=1,</div>
<div class="line"><span class="lineno">  832</span>        reg_covar=0,</div>
<div class="line"><span class="lineno">  833</span>        random_state=random_state,</div>
<div class="line"><span class="lineno">  834</span>        warm_start=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  835</span>    )</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>    g.fit(X)</div>
<div class="line"><span class="lineno">  838</span>    score1 = h.fit(X).score(X)</div>
<div class="line"><span class="lineno">  839</span>    score2 = h.fit(X).score(X)</div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>    assert_almost_equal(g.weights_, h.weights_)</div>
<div class="line"><span class="lineno">  842</span>    assert_almost_equal(g.means_, h.means_)</div>
<div class="line"><span class="lineno">  843</span>    assert_almost_equal(g.precisions_, h.precisions_)</div>
<div class="line"><span class="lineno">  844</span>    <span class="keyword">assert</span> score2 &gt; score1</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>    <span class="comment"># Assert that by using warm_start we can converge to a good solution</span></div>
<div class="line"><span class="lineno">  847</span>    g = GaussianMixture(</div>
<div class="line"><span class="lineno">  848</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  849</span>        n_init=1,</div>
<div class="line"><span class="lineno">  850</span>        max_iter=5,</div>
<div class="line"><span class="lineno">  851</span>        reg_covar=0,</div>
<div class="line"><span class="lineno">  852</span>        random_state=random_state,</div>
<div class="line"><span class="lineno">  853</span>        warm_start=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  854</span>        tol=1e-6,</div>
<div class="line"><span class="lineno">  855</span>    )</div>
<div class="line"><span class="lineno">  856</span>    h = GaussianMixture(</div>
<div class="line"><span class="lineno">  857</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  858</span>        n_init=1,</div>
<div class="line"><span class="lineno">  859</span>        max_iter=5,</div>
<div class="line"><span class="lineno">  860</span>        reg_covar=0,</div>
<div class="line"><span class="lineno">  861</span>        random_state=random_state,</div>
<div class="line"><span class="lineno">  862</span>        warm_start=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  863</span>        tol=1e-6,</div>
<div class="line"><span class="lineno">  864</span>    )</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>    g.fit(X)</div>
<div class="line"><span class="lineno">  867</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> g.converged_</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>    h.fit(X)</div>
<div class="line"><span class="lineno">  870</span>    <span class="comment"># depending on the data there is large variability in the number of</span></div>
<div class="line"><span class="lineno">  871</span>    <span class="comment"># refit necessary to converge due to the complete randomness of the</span></div>
<div class="line"><span class="lineno">  872</span>    <span class="comment"># data</span></div>
<div class="line"><span class="lineno">  873</span>    <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(1000):</div>
<div class="line"><span class="lineno">  874</span>        h.fit(X)</div>
<div class="line"><span class="lineno">  875</span>        <span class="keywordflow">if</span> h.converged_:</div>
<div class="line"><span class="lineno">  876</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  877</span>    <span class="keyword">assert</span> h.converged_</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span><span class="preprocessor">@ignore_warnings(category=ConvergenceWarning)</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa429913e739405b9fde00b90a3df70d0" name="aa429913e739405b9fde00b90a3df70d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa429913e739405b9fde00b90a3df70d0">&#9670;&#160;</a></span>COVARIANCE_TYPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list sklearn.mixture.tests.test_gaussian_mixture.COVARIANCE_TYPE = [&quot;full&quot;, &quot;tied&quot;, &quot;diag&quot;, &quot;spherical&quot;]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
