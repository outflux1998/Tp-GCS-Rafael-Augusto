<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.linalg._special_matrices Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1linalg.html">linalg</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html">_special_matrices</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.linalg._special_matrices Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adbf1d041cdb29a518a9cc4156563d9fb" id="r_adbf1d041cdb29a518a9cc4156563d9fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#adbf1d041cdb29a518a9cc4156563d9fb">tri</a> (N, M=None, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>=0, dtype=None)</td></tr>
<tr class="separator:adbf1d041cdb29a518a9cc4156563d9fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e9df53d999e3af2182cfee51b697af2" id="r_a5e9df53d999e3af2182cfee51b697af2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#a5e9df53d999e3af2182cfee51b697af2">tril</a> (m, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>=0)</td></tr>
<tr class="separator:a5e9df53d999e3af2182cfee51b697af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9793e4c7a01acf622dbf785e15cc45" id="r_aef9793e4c7a01acf622dbf785e15cc45"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#aef9793e4c7a01acf622dbf785e15cc45">triu</a> (m, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>=0)</td></tr>
<tr class="separator:aef9793e4c7a01acf622dbf785e15cc45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804e14de09dc0496e3975329dd059e83" id="r_a804e14de09dc0496e3975329dd059e83"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#a804e14de09dc0496e3975329dd059e83">toeplitz</a> (c, <a class="el" href="__lapack__subroutines_8h.html#a952912404e837594f7cbfb183beeacd4">r</a>=None)</td></tr>
<tr class="separator:a804e14de09dc0496e3975329dd059e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabf57b3b4da0f845cd257df63f01512f" id="r_aabf57b3b4da0f845cd257df63f01512f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#aabf57b3b4da0f845cd257df63f01512f">circulant</a> (c)</td></tr>
<tr class="separator:aabf57b3b4da0f845cd257df63f01512f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad74cc1ad8af780ae9c873aaae9c577a6" id="r_ad74cc1ad8af780ae9c873aaae9c577a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#ad74cc1ad8af780ae9c873aaae9c577a6">hankel</a> (c, <a class="el" href="__lapack__subroutines_8h.html#a952912404e837594f7cbfb183beeacd4">r</a>=None)</td></tr>
<tr class="separator:ad74cc1ad8af780ae9c873aaae9c577a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5bf88c8cf8014413ffbf3f2e86169f8" id="r_aa5bf88c8cf8014413ffbf3f2e86169f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#aa5bf88c8cf8014413ffbf3f2e86169f8">hadamard</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, dtype=int)</td></tr>
<tr class="separator:aa5bf88c8cf8014413ffbf3f2e86169f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0a31d0a2fb9751f80187a3c496246f0" id="r_ac0a31d0a2fb9751f80187a3c496246f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#ac0a31d0a2fb9751f80187a3c496246f0">leslie</a> (<a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, s)</td></tr>
<tr class="separator:ac0a31d0a2fb9751f80187a3c496246f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a873011de8094c873bd302bfe61ea9284" id="r_a873011de8094c873bd302bfe61ea9284"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#a873011de8094c873bd302bfe61ea9284">kron</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b)</td></tr>
<tr class="separator:a873011de8094c873bd302bfe61ea9284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae014151e4a6a5a1fb0d0607d52ac78c2" id="r_ae014151e4a6a5a1fb0d0607d52ac78c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#ae014151e4a6a5a1fb0d0607d52ac78c2">block_diag</a> (*arrs)</td></tr>
<tr class="separator:ae014151e4a6a5a1fb0d0607d52ac78c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56554fbd9a385c9283f65d2368fb5fb1" id="r_a56554fbd9a385c9283f65d2368fb5fb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#a56554fbd9a385c9283f65d2368fb5fb1">companion</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>)</td></tr>
<tr class="separator:a56554fbd9a385c9283f65d2368fb5fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e2a4b3eb8c15fde671fab5cbc3ca325" id="r_a4e2a4b3eb8c15fde671fab5cbc3ca325"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#a4e2a4b3eb8c15fde671fab5cbc3ca325">helmert</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, full=False)</td></tr>
<tr class="separator:a4e2a4b3eb8c15fde671fab5cbc3ca325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f43ed3f392fe5f54db7950ca4cae260" id="r_a6f43ed3f392fe5f54db7950ca4cae260"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#a6f43ed3f392fe5f54db7950ca4cae260">hilbert</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a6f43ed3f392fe5f54db7950ca4cae260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97248ada231330c917b2d3acbef12d03" id="r_a97248ada231330c917b2d3acbef12d03"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#a97248ada231330c917b2d3acbef12d03">invhilbert</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, exact=False)</td></tr>
<tr class="separator:a97248ada231330c917b2d3acbef12d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac723ea273038dbe546e0fe83a0b9ae47" id="r_ac723ea273038dbe546e0fe83a0b9ae47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#ac723ea273038dbe546e0fe83a0b9ae47">pascal</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, kind='symmetric', exact=True)</td></tr>
<tr class="separator:ac723ea273038dbe546e0fe83a0b9ae47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aada832342bbbbf86f533f48f5030588a" id="r_aada832342bbbbf86f533f48f5030588a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#aada832342bbbbf86f533f48f5030588a">invpascal</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, kind='symmetric', exact=True)</td></tr>
<tr class="separator:aada832342bbbbf86f533f48f5030588a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb9a544b2373654620e827cac72cfc18" id="r_acb9a544b2373654620e827cac72cfc18"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#acb9a544b2373654620e827cac72cfc18">dft</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, scale=None)</td></tr>
<tr class="separator:acb9a544b2373654620e827cac72cfc18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af943019b59847395f467aa5c98213d6f" id="r_af943019b59847395f467aa5c98213d6f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#af943019b59847395f467aa5c98213d6f">fiedler</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>)</td></tr>
<tr class="separator:af943019b59847395f467aa5c98213d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c98e61199e669c788530b558fae0a2a" id="r_a9c98e61199e669c788530b558fae0a2a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#a9c98e61199e669c788530b558fae0a2a">fiedler_companion</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>)</td></tr>
<tr class="separator:a9c98e61199e669c788530b558fae0a2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa91257164f7d4cd44eef8c748791d4c2" id="r_aa91257164f7d4cd44eef8c748791d4c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__special__matrices.html#aa91257164f7d4cd44eef8c748791d4c2">convolution_matrix</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, mode='full')</td></tr>
<tr class="separator:aa91257164f7d4cd44eef8c748791d4c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae014151e4a6a5a1fb0d0607d52ac78c2" name="ae014151e4a6a5a1fb0d0607d52ac78c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae014151e4a6a5a1fb0d0607d52ac78c2">&#9670;&#160;</a></span>block_diag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.block_diag </td>
          <td>(</td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>arrs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a block diagonal matrix from provided arrays.

Given the inputs `A`, `B` and `C`, the output will have these
arrays arranged on the diagonal::

    [[A, 0, 0],
     [0, B, 0],
     [0, 0, C]]

Parameters
----------
A, B, C, ... : array_like, up to 2-D
    Input arrays.  A 1-D array or array_like sequence of length `n` is
    treated as a 2-D array with shape ``(1,n)``.

Returns
-------
D : ndarray
    Array with `A`, `B`, `C`, ... on the diagonal. `D` has the
    same dtype as `A`.

Notes
-----
If all the input arrays are square, the output is known as a
block diagonal matrix.

Empty sequences (i.e., array-likes of zero size) will not be ignored.
Noteworthy, both [] and [[]] are treated as matrices with shape ``(1,0)``.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import block_diag
&gt;&gt;&gt; A = [[1, 0],
...      [0, 1]]
&gt;&gt;&gt; B = [[3, 4, 5],
...      [6, 7, 8]]
&gt;&gt;&gt; C = [[7]]
&gt;&gt;&gt; P = np.zeros((2, 0), dtype='int32')
&gt;&gt;&gt; block_diag(A, B, C)
array([[1, 0, 0, 0, 0, 0],
       [0, 1, 0, 0, 0, 0],
       [0, 0, 3, 4, 5, 0],
       [0, 0, 6, 7, 8, 0],
       [0, 0, 0, 0, 0, 7]])
&gt;&gt;&gt; block_diag(A, P, B, C)
array([[1, 0, 0, 0, 0, 0],
       [0, 1, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0],
       [0, 0, 3, 4, 5, 0],
       [0, 0, 6, 7, 8, 0],
       [0, 0, 0, 0, 0, 7]])
&gt;&gt;&gt; block_diag(1.0, [2, 3], [[4, 5], [6, 7]])
array([[ 1.,  0.,  0.,  0.,  0.],
       [ 0.,  2.,  3.,  0.,  0.],
       [ 0.,  0.,  0.,  4.,  5.],
       [ 0.,  0.,  0.,  6.,  7.]])</pre> <div class="fragment"><div class="line"><span class="lineno">  470</span><span class="keyword">def </span>block_diag(*arrs):</div>
<div class="line"><span class="lineno">  471</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral">    Create a block diagonal matrix from provided arrays.</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">    Given the inputs `A`, `B` and `C`, the output will have these</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">    arrays arranged on the diagonal::</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">        [[A, 0, 0],</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">         [0, B, 0],</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">         [0, 0, C]]</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">    A, B, C, ... : array_like, up to 2-D</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">        Input arrays.  A 1-D array or array_like sequence of length `n` is</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">        treated as a 2-D array with shape ``(1,n)``.</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">    D : ndarray</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">        Array with `A`, `B`, `C`, ... on the diagonal. `D` has the</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">        same dtype as `A`.</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">    If all the input arrays are square, the output is known as a</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">    block diagonal matrix.</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">    Empty sequences (i.e., array-likes of zero size) will not be ignored.</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">    Noteworthy, both [] and [[]] are treated as matrices with shape ``(1,0)``.</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import block_diag</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">    &gt;&gt;&gt; A = [[1, 0],</span></div>
<div class="line"><span class="lineno">  505</span><span class="stringliteral">    ...      [0, 1]]</span></div>
<div class="line"><span class="lineno">  506</span><span class="stringliteral">    &gt;&gt;&gt; B = [[3, 4, 5],</span></div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral">    ...      [6, 7, 8]]</span></div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral">    &gt;&gt;&gt; C = [[7]]</span></div>
<div class="line"><span class="lineno">  509</span><span class="stringliteral">    &gt;&gt;&gt; P = np.zeros((2, 0), dtype=&#39;int32&#39;)</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">    &gt;&gt;&gt; block_diag(A, B, C)</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">    array([[1, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">           [0, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">           [0, 0, 3, 4, 5, 0],</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">           [0, 0, 6, 7, 8, 0],</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">           [0, 0, 0, 0, 0, 7]])</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">    &gt;&gt;&gt; block_diag(A, P, B, C)</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">    array([[1, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">           [0, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">           [0, 0, 3, 4, 5, 0],</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">           [0, 0, 6, 7, 8, 0],</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">           [0, 0, 0, 0, 0, 7]])</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">    &gt;&gt;&gt; block_diag(1.0, [2, 3], [[4, 5], [6, 7]])</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">    array([[ 1.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">           [ 0.,  2.,  3.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">           [ 0.,  0.,  0.,  4.,  5.],</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">           [ 0.,  0.,  0.,  6.,  7.]])</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">if</span> arrs == ():</div>
<div class="line"><span class="lineno">  532</span>        arrs = ([],)</div>
<div class="line"><span class="lineno">  533</span>    arrs = [np.atleast_2d(a) <span class="keywordflow">for</span> a <span class="keywordflow">in</span> arrs]</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>    bad_args = [k <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(len(arrs)) <span class="keywordflow">if</span> arrs[k].ndim &gt; 2]</div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordflow">if</span> bad_args:</div>
<div class="line"><span class="lineno">  537</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;arguments in the following positions have dimension &quot;</span></div>
<div class="line"><span class="lineno">  538</span>                         <span class="stringliteral">&quot;greater than 2: %s&quot;</span> % bad_args)</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    shapes = np.array([a.shape <span class="keywordflow">for</span> a <span class="keywordflow">in</span> arrs])</div>
<div class="line"><span class="lineno">  541</span>    out_dtype = np.find_common_type([arr.dtype <span class="keywordflow">for</span> arr <span class="keywordflow">in</span> arrs], [])</div>
<div class="line"><span class="lineno">  542</span>    out = np.zeros(np.sum(shapes, axis=0), dtype=out_dtype)</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    r, c = 0, 0</div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">for</span> i, (rr, cc) <span class="keywordflow">in</span> enumerate(shapes):</div>
<div class="line"><span class="lineno">  546</span>        out[r:r + rr, c:c + cc] = arrs[i]</div>
<div class="line"><span class="lineno">  547</span>        r += rr</div>
<div class="line"><span class="lineno">  548</span>        c += cc</div>
<div class="line"><span class="lineno">  549</span>    <span class="keywordflow">return</span> out</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aabf57b3b4da0f845cd257df63f01512f" name="aabf57b3b4da0f845cd257df63f01512f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabf57b3b4da0f845cd257df63f01512f">&#9670;&#160;</a></span>circulant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.circulant </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct a circulant matrix.

Parameters
----------
c : (N,) array_like
    1-D array, the first column of the matrix.

Returns
-------
A : (N, N) ndarray
    A circulant matrix whose first column is `c`.

See Also
--------
toeplitz : Toeplitz matrix
hankel : Hankel matrix
solve_circulant : Solve a circulant system.

Notes
-----
.. versionadded:: 0.8.0

Examples
--------
&gt;&gt;&gt; from scipy.linalg import circulant
&gt;&gt;&gt; circulant([1, 2, 3])
array([[1, 3, 2],
       [2, 1, 3],
       [3, 2, 1]])</pre> <div class="fragment"><div class="line"><span class="lineno">  202</span><span class="keyword">def </span>circulant(c):</div>
<div class="line"><span class="lineno">  203</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    Construct a circulant matrix.</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">    c : (N,) array_like</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">        1-D array, the first column of the matrix.</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    A : (N, N) ndarray</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">        A circulant matrix whose first column is `c`.</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">    toeplitz : Toeplitz matrix</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    hankel : Hankel matrix</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    solve_circulant : Solve a circulant system.</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">    .. versionadded:: 0.8.0</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import circulant</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">    &gt;&gt;&gt; circulant([1, 2, 3])</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    array([[1, 3, 2],</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">           [2, 1, 3],</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">           [3, 2, 1]])</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  235</span>    c = np.asarray(c).ravel()</div>
<div class="line"><span class="lineno">  236</span>    <span class="comment"># Form an extended array that could be strided to give circulant version</span></div>
<div class="line"><span class="lineno">  237</span>    c_ext = np.concatenate((c[::-1], c[:0:-1]))</div>
<div class="line"><span class="lineno">  238</span>    L = len(c)</div>
<div class="line"><span class="lineno">  239</span>    n = c_ext.strides[0]</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">return</span> as_strided(c_ext[L-1:], shape=(L, L), strides=(-n, n)).copy()</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a56554fbd9a385c9283f65d2368fb5fb1" name="a56554fbd9a385c9283f65d2368fb5fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56554fbd9a385c9283f65d2368fb5fb1">&#9670;&#160;</a></span>companion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.companion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a companion matrix.

Create the companion matrix [1]_ associated with the polynomial whose
coefficients are given in `a`.

Parameters
----------
a : (N,) array_like
    1-D array of polynomial coefficients. The length of `a` must be
    at least two, and ``a[0]`` must not be zero.

Returns
-------
c : (N-1, N-1) ndarray
    The first row of `c` is ``-a[1:]/a[0]``, and the first
    sub-diagonal is all ones.  The data-type of the array is the same
    as the data-type of ``1.0*a[0]``.

Raises
------
ValueError
    If any of the following are true: a) ``a.ndim != 1``;
    b) ``a.size &lt; 2``; c) ``a[0] == 0``.

Notes
-----
.. versionadded:: 0.8.0

References
----------
.. [1] R. A. Horn &amp; C. R. Johnson, *Matrix Analysis*.  Cambridge, UK:
    Cambridge University Press, 1999, pp. 146-7.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import companion
&gt;&gt;&gt; companion([1, -10, 31, -30])
array([[ 10., -31.,  30.],
       [  1.,   0.,   0.],
       [  0.,   1.,   0.]])</pre> <div class="fragment"><div class="line"><span class="lineno">  552</span><span class="keyword">def </span>companion(a):</div>
<div class="line"><span class="lineno">  553</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">    Create a companion matrix.</span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">    Create the companion matrix [1]_ associated with the polynomial whose</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">    coefficients are given in `a`.</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">    a : (N,) array_like</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">        1-D array of polynomial coefficients. The length of `a` must be</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">        at least two, and ``a[0]`` must not be zero.</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">    c : (N-1, N-1) ndarray</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">        The first row of `c` is ``-a[1:]/a[0]``, and the first</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">        sub-diagonal is all ones.  The data-type of the array is the same</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">        as the data-type of ``1.0*a[0]``.</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">    ValueError</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">        If any of the following are true: a) ``a.ndim != 1``;</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">        b) ``a.size &lt; 2``; c) ``a[0] == 0``.</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">    .. versionadded:: 0.8.0</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">    .. [1] R. A. Horn &amp; C. R. Johnson, *Matrix Analysis*.  Cambridge, UK:</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">        Cambridge University Press, 1999, pp. 146-7.</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import companion</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">    &gt;&gt;&gt; companion([1, -10, 31, -30])</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral">    array([[ 10., -31.,  30.],</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">           [  1.,   0.,   0.],</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral">           [  0.,   1.,   0.]])</span></div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  596</span>    a = np.atleast_1d(a)</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>    <span class="keywordflow">if</span> a.ndim != 1:</div>
<div class="line"><span class="lineno">  599</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Incorrect shape for `a`.  `a` must be &quot;</span></div>
<div class="line"><span class="lineno">  600</span>                         <span class="stringliteral">&quot;one-dimensional.&quot;</span>)</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>    <span class="keywordflow">if</span> a.size &lt; 2:</div>
<div class="line"><span class="lineno">  603</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The length of `a` must be at least 2.&quot;</span>)</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>    <span class="keywordflow">if</span> a[0] == 0:</div>
<div class="line"><span class="lineno">  606</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The first coefficient in `a` must not be zero.&quot;</span>)</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>    first_row = -a[1:] / (1.0 * a[0])</div>
<div class="line"><span class="lineno">  609</span>    n = a.size</div>
<div class="line"><span class="lineno">  610</span>    c = np.zeros((n - 1, n - 1), dtype=first_row.dtype)</div>
<div class="line"><span class="lineno">  611</span>    c[0] = first_row</div>
<div class="line"><span class="lineno">  612</span>    c[list(range(1, n - 1)), list(range(0, n - 2))] = 1</div>
<div class="line"><span class="lineno">  613</span>    <span class="keywordflow">return</span> c</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa91257164f7d4cd44eef8c748791d4c2" name="aa91257164f7d4cd44eef8c748791d4c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa91257164f7d4cd44eef8c748791d4c2">&#9670;&#160;</a></span>convolution_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.convolution_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>'full'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct a convolution matrix.

Constructs the Toeplitz matrix representing one-dimensional
convolution [1]_.  See the notes below for details.

Parameters
----------
a : (m,) array_like
    The 1-D array to convolve.
n : int
    The number of columns in the resulting matrix.  It gives the length
    of the input to be convolved with `a`.  This is analogous to the
    length of `v` in ``numpy.convolve(a, v)``.
mode : str
    This is analogous to `mode` in ``numpy.convolve(v, a, mode)``.
    It must be one of ('full', 'valid', 'same').
    See below for how `mode` determines the shape of the result.

Returns
-------
A : (k, n) ndarray
    The convolution matrix whose row count `k` depends on `mode`::

        =======  =========================
         mode    k
        =======  =========================
        'full'   m + n -1
        'same'   max(m, n)
        'valid'  max(m, n) - min(m, n) + 1
        =======  =========================

See Also
--------
toeplitz : Toeplitz matrix

Notes
-----
The code::

    A = convolution_matrix(a, n, mode)

creates a Toeplitz matrix `A` such that ``A @ v`` is equivalent to
using ``convolve(a, v, mode)``.  The returned array always has `n`
columns.  The number of rows depends on the specified `mode`, as
explained above.

In the default 'full' mode, the entries of `A` are given by::

    A[i, j] == (a[i-j] if (0 &lt;= (i-j) &lt; m) else 0)

where ``m = len(a)``.  Suppose, for example, the input array is
``[x, y, z]``.  The convolution matrix has the form::

    [x, 0, 0, ..., 0, 0]
    [y, x, 0, ..., 0, 0]
    [z, y, x, ..., 0, 0]
    ...
    [0, 0, 0, ..., x, 0]
    [0, 0, 0, ..., y, x]
    [0, 0, 0, ..., z, y]
    [0, 0, 0, ..., 0, z]

In 'valid' mode, the entries of `A` are given by::

    A[i, j] == (a[i-j+m-1] if (0 &lt;= (i-j+m-1) &lt; m) else 0)

This corresponds to a matrix whose rows are the subset of those from
the 'full' case where all the coefficients in `a` are contained in the
row.  For input ``[x, y, z]``, this array looks like::

    [z, y, x, 0, 0, ..., 0, 0, 0]
    [0, z, y, x, 0, ..., 0, 0, 0]
    [0, 0, z, y, x, ..., 0, 0, 0]
    ...
    [0, 0, 0, 0, 0, ..., x, 0, 0]
    [0, 0, 0, 0, 0, ..., y, x, 0]
    [0, 0, 0, 0, 0, ..., z, y, x]

In the 'same' mode, the entries of `A` are given by::

    d = (m - 1) // 2
    A[i, j] == (a[i-j+d] if (0 &lt;= (i-j+d) &lt; m) else 0)

The typical application of the 'same' mode is when one has a signal of
length `n` (with `n` greater than ``len(a)``), and the desired output
is a filtered signal that is still of length `n`.

For input ``[x, y, z]``, this array looks like::

    [y, x, 0, 0, ..., 0, 0, 0]
    [z, y, x, 0, ..., 0, 0, 0]
    [0, z, y, x, ..., 0, 0, 0]
    [0, 0, z, y, ..., 0, 0, 0]
    ...
    [0, 0, 0, 0, ..., y, x, 0]
    [0, 0, 0, 0, ..., z, y, x]
    [0, 0, 0, 0, ..., 0, z, y]

.. versionadded:: 1.5.0

References
----------
.. [1] "Convolution", https://en.wikipedia.org/wiki/Convolution

Examples
--------
&gt;&gt;&gt; from scipy.linalg import convolution_matrix
&gt;&gt;&gt; A = convolution_matrix([-1, 4, -2], 5, mode='same')
&gt;&gt;&gt; A
array([[ 4, -1,  0,  0,  0],
       [-2,  4, -1,  0,  0],
       [ 0, -2,  4, -1,  0],
       [ 0,  0, -2,  4, -1],
       [ 0,  0,  0, -2,  4]])

Compare multiplication by `A` with the use of `numpy.convolve`.

&gt;&gt;&gt; x = np.array([1, 2, 0, -3, 0.5])
&gt;&gt;&gt; A @ x
array([  2. ,   6. ,  -1. , -12.5,   8. ])

Verify that ``A @ x`` produced the same result as applying the
convolution function.

&gt;&gt;&gt; np.convolve([-1, 4, -2], x, mode='same')
array([  2. ,   6. ,  -1. , -12.5,   8. ])

For comparison to the case ``mode='same'`` shown above, here are the
matrices produced by ``mode='full'`` and ``mode='valid'`` for the
same coefficients and size.

&gt;&gt;&gt; convolution_matrix([-1, 4, -2], 5, mode='full')
array([[-1,  0,  0,  0,  0],
       [ 4, -1,  0,  0,  0],
       [-2,  4, -1,  0,  0],
       [ 0, -2,  4, -1,  0],
       [ 0,  0, -2,  4, -1],
       [ 0,  0,  0, -2,  4],
       [ 0,  0,  0,  0, -2]])

&gt;&gt;&gt; convolution_matrix([-1, 4, -2], 5, mode='valid')
array([[-2,  4, -1,  0,  0],
       [ 0, -2,  4, -1,  0],
       [ 0,  0, -2,  4, -1]])
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1195</span><span class="keyword">def </span>convolution_matrix(a, n, mode=&#39;full&#39;):</div>
<div class="line"><span class="lineno"> 1196</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1197</span><span class="stringliteral">    Construct a convolution matrix.</span></div>
<div class="line"><span class="lineno"> 1198</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1199</span><span class="stringliteral">    Constructs the Toeplitz matrix representing one-dimensional</span></div>
<div class="line"><span class="lineno"> 1200</span><span class="stringliteral">    convolution [1]_.  See the notes below for details.</span></div>
<div class="line"><span class="lineno"> 1201</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1202</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">    a : (m,) array_like</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral">        The 1-D array to convolve.</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="stringliteral">        The number of columns in the resulting matrix.  It gives the length</span></div>
<div class="line"><span class="lineno"> 1208</span><span class="stringliteral">        of the input to be convolved with `a`.  This is analogous to the</span></div>
<div class="line"><span class="lineno"> 1209</span><span class="stringliteral">        length of `v` in ``numpy.convolve(a, v)``.</span></div>
<div class="line"><span class="lineno"> 1210</span><span class="stringliteral">    mode : str</span></div>
<div class="line"><span class="lineno"> 1211</span><span class="stringliteral">        This is analogous to `mode` in ``numpy.convolve(v, a, mode)``.</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="stringliteral">        It must be one of (&#39;full&#39;, &#39;valid&#39;, &#39;same&#39;).</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="stringliteral">        See below for how `mode` determines the shape of the result.</span></div>
<div class="line"><span class="lineno"> 1214</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1215</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1216</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1217</span><span class="stringliteral">    A : (k, n) ndarray</span></div>
<div class="line"><span class="lineno"> 1218</span><span class="stringliteral">        The convolution matrix whose row count `k` depends on `mode`::</span></div>
<div class="line"><span class="lineno"> 1219</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1220</span><span class="stringliteral">            =======  =========================</span></div>
<div class="line"><span class="lineno"> 1221</span><span class="stringliteral">             mode    k</span></div>
<div class="line"><span class="lineno"> 1222</span><span class="stringliteral">            =======  =========================</span></div>
<div class="line"><span class="lineno"> 1223</span><span class="stringliteral">            &#39;full&#39;   m + n -1</span></div>
<div class="line"><span class="lineno"> 1224</span><span class="stringliteral">            &#39;same&#39;   max(m, n)</span></div>
<div class="line"><span class="lineno"> 1225</span><span class="stringliteral">            &#39;valid&#39;  max(m, n) - min(m, n) + 1</span></div>
<div class="line"><span class="lineno"> 1226</span><span class="stringliteral">            =======  =========================</span></div>
<div class="line"><span class="lineno"> 1227</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1228</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1229</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1230</span><span class="stringliteral">    toeplitz : Toeplitz matrix</span></div>
<div class="line"><span class="lineno"> 1231</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1232</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1233</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1234</span><span class="stringliteral">    The code::</span></div>
<div class="line"><span class="lineno"> 1235</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1236</span><span class="stringliteral">        A = convolution_matrix(a, n, mode)</span></div>
<div class="line"><span class="lineno"> 1237</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1238</span><span class="stringliteral">    creates a Toeplitz matrix `A` such that ``A @ v`` is equivalent to</span></div>
<div class="line"><span class="lineno"> 1239</span><span class="stringliteral">    using ``convolve(a, v, mode)``.  The returned array always has `n`</span></div>
<div class="line"><span class="lineno"> 1240</span><span class="stringliteral">    columns.  The number of rows depends on the specified `mode`, as</span></div>
<div class="line"><span class="lineno"> 1241</span><span class="stringliteral">    explained above.</span></div>
<div class="line"><span class="lineno"> 1242</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1243</span><span class="stringliteral">    In the default &#39;full&#39; mode, the entries of `A` are given by::</span></div>
<div class="line"><span class="lineno"> 1244</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1245</span><span class="stringliteral">        A[i, j] == (a[i-j] if (0 &lt;= (i-j) &lt; m) else 0)</span></div>
<div class="line"><span class="lineno"> 1246</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1247</span><span class="stringliteral">    where ``m = len(a)``.  Suppose, for example, the input array is</span></div>
<div class="line"><span class="lineno"> 1248</span><span class="stringliteral">    ``[x, y, z]``.  The convolution matrix has the form::</span></div>
<div class="line"><span class="lineno"> 1249</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1250</span><span class="stringliteral">        [x, 0, 0, ..., 0, 0]</span></div>
<div class="line"><span class="lineno"> 1251</span><span class="stringliteral">        [y, x, 0, ..., 0, 0]</span></div>
<div class="line"><span class="lineno"> 1252</span><span class="stringliteral">        [z, y, x, ..., 0, 0]</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral">        ...</span></div>
<div class="line"><span class="lineno"> 1254</span><span class="stringliteral">        [0, 0, 0, ..., x, 0]</span></div>
<div class="line"><span class="lineno"> 1255</span><span class="stringliteral">        [0, 0, 0, ..., y, x]</span></div>
<div class="line"><span class="lineno"> 1256</span><span class="stringliteral">        [0, 0, 0, ..., z, y]</span></div>
<div class="line"><span class="lineno"> 1257</span><span class="stringliteral">        [0, 0, 0, ..., 0, z]</span></div>
<div class="line"><span class="lineno"> 1258</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1259</span><span class="stringliteral">    In &#39;valid&#39; mode, the entries of `A` are given by::</span></div>
<div class="line"><span class="lineno"> 1260</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1261</span><span class="stringliteral">        A[i, j] == (a[i-j+m-1] if (0 &lt;= (i-j+m-1) &lt; m) else 0)</span></div>
<div class="line"><span class="lineno"> 1262</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1263</span><span class="stringliteral">    This corresponds to a matrix whose rows are the subset of those from</span></div>
<div class="line"><span class="lineno"> 1264</span><span class="stringliteral">    the &#39;full&#39; case where all the coefficients in `a` are contained in the</span></div>
<div class="line"><span class="lineno"> 1265</span><span class="stringliteral">    row.  For input ``[x, y, z]``, this array looks like::</span></div>
<div class="line"><span class="lineno"> 1266</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1267</span><span class="stringliteral">        [z, y, x, 0, 0, ..., 0, 0, 0]</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="stringliteral">        [0, z, y, x, 0, ..., 0, 0, 0]</span></div>
<div class="line"><span class="lineno"> 1269</span><span class="stringliteral">        [0, 0, z, y, x, ..., 0, 0, 0]</span></div>
<div class="line"><span class="lineno"> 1270</span><span class="stringliteral">        ...</span></div>
<div class="line"><span class="lineno"> 1271</span><span class="stringliteral">        [0, 0, 0, 0, 0, ..., x, 0, 0]</span></div>
<div class="line"><span class="lineno"> 1272</span><span class="stringliteral">        [0, 0, 0, 0, 0, ..., y, x, 0]</span></div>
<div class="line"><span class="lineno"> 1273</span><span class="stringliteral">        [0, 0, 0, 0, 0, ..., z, y, x]</span></div>
<div class="line"><span class="lineno"> 1274</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1275</span><span class="stringliteral">    In the &#39;same&#39; mode, the entries of `A` are given by::</span></div>
<div class="line"><span class="lineno"> 1276</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1277</span><span class="stringliteral">        d = (m - 1) // 2</span></div>
<div class="line"><span class="lineno"> 1278</span><span class="stringliteral">        A[i, j] == (a[i-j+d] if (0 &lt;= (i-j+d) &lt; m) else 0)</span></div>
<div class="line"><span class="lineno"> 1279</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1280</span><span class="stringliteral">    The typical application of the &#39;same&#39; mode is when one has a signal of</span></div>
<div class="line"><span class="lineno"> 1281</span><span class="stringliteral">    length `n` (with `n` greater than ``len(a)``), and the desired output</span></div>
<div class="line"><span class="lineno"> 1282</span><span class="stringliteral">    is a filtered signal that is still of length `n`.</span></div>
<div class="line"><span class="lineno"> 1283</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1284</span><span class="stringliteral">    For input ``[x, y, z]``, this array looks like::</span></div>
<div class="line"><span class="lineno"> 1285</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1286</span><span class="stringliteral">        [y, x, 0, 0, ..., 0, 0, 0]</span></div>
<div class="line"><span class="lineno"> 1287</span><span class="stringliteral">        [z, y, x, 0, ..., 0, 0, 0]</span></div>
<div class="line"><span class="lineno"> 1288</span><span class="stringliteral">        [0, z, y, x, ..., 0, 0, 0]</span></div>
<div class="line"><span class="lineno"> 1289</span><span class="stringliteral">        [0, 0, z, y, ..., 0, 0, 0]</span></div>
<div class="line"><span class="lineno"> 1290</span><span class="stringliteral">        ...</span></div>
<div class="line"><span class="lineno"> 1291</span><span class="stringliteral">        [0, 0, 0, 0, ..., y, x, 0]</span></div>
<div class="line"><span class="lineno"> 1292</span><span class="stringliteral">        [0, 0, 0, 0, ..., z, y, x]</span></div>
<div class="line"><span class="lineno"> 1293</span><span class="stringliteral">        [0, 0, 0, 0, ..., 0, z, y]</span></div>
<div class="line"><span class="lineno"> 1294</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1295</span><span class="stringliteral">    .. versionadded:: 1.5.0</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1297</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1298</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1299</span><span class="stringliteral">    .. [1] &quot;Convolution&quot;, https://en.wikipedia.org/wiki/Convolution</span></div>
<div class="line"><span class="lineno"> 1300</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1301</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1302</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1303</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import convolution_matrix</span></div>
<div class="line"><span class="lineno"> 1304</span><span class="stringliteral">    &gt;&gt;&gt; A = convolution_matrix([-1, 4, -2], 5, mode=&#39;same&#39;)</span></div>
<div class="line"><span class="lineno"> 1305</span><span class="stringliteral">    &gt;&gt;&gt; A</span></div>
<div class="line"><span class="lineno"> 1306</span><span class="stringliteral">    array([[ 4, -1,  0,  0,  0],</span></div>
<div class="line"><span class="lineno"> 1307</span><span class="stringliteral">           [-2,  4, -1,  0,  0],</span></div>
<div class="line"><span class="lineno"> 1308</span><span class="stringliteral">           [ 0, -2,  4, -1,  0],</span></div>
<div class="line"><span class="lineno"> 1309</span><span class="stringliteral">           [ 0,  0, -2,  4, -1],</span></div>
<div class="line"><span class="lineno"> 1310</span><span class="stringliteral">           [ 0,  0,  0, -2,  4]])</span></div>
<div class="line"><span class="lineno"> 1311</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1312</span><span class="stringliteral">    Compare multiplication by `A` with the use of `numpy.convolve`.</span></div>
<div class="line"><span class="lineno"> 1313</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1314</span><span class="stringliteral">    &gt;&gt;&gt; x = np.array([1, 2, 0, -3, 0.5])</span></div>
<div class="line"><span class="lineno"> 1315</span><span class="stringliteral">    &gt;&gt;&gt; A @ x</span></div>
<div class="line"><span class="lineno"> 1316</span><span class="stringliteral">    array([  2. ,   6. ,  -1. , -12.5,   8. ])</span></div>
<div class="line"><span class="lineno"> 1317</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1318</span><span class="stringliteral">    Verify that ``A @ x`` produced the same result as applying the</span></div>
<div class="line"><span class="lineno"> 1319</span><span class="stringliteral">    convolution function.</span></div>
<div class="line"><span class="lineno"> 1320</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1321</span><span class="stringliteral">    &gt;&gt;&gt; np.convolve([-1, 4, -2], x, mode=&#39;same&#39;)</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="stringliteral">    array([  2. ,   6. ,  -1. , -12.5,   8. ])</span></div>
<div class="line"><span class="lineno"> 1323</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1324</span><span class="stringliteral">    For comparison to the case ``mode=&#39;same&#39;`` shown above, here are the</span></div>
<div class="line"><span class="lineno"> 1325</span><span class="stringliteral">    matrices produced by ``mode=&#39;full&#39;`` and ``mode=&#39;valid&#39;`` for the</span></div>
<div class="line"><span class="lineno"> 1326</span><span class="stringliteral">    same coefficients and size.</span></div>
<div class="line"><span class="lineno"> 1327</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1328</span><span class="stringliteral">    &gt;&gt;&gt; convolution_matrix([-1, 4, -2], 5, mode=&#39;full&#39;)</span></div>
<div class="line"><span class="lineno"> 1329</span><span class="stringliteral">    array([[-1,  0,  0,  0,  0],</span></div>
<div class="line"><span class="lineno"> 1330</span><span class="stringliteral">           [ 4, -1,  0,  0,  0],</span></div>
<div class="line"><span class="lineno"> 1331</span><span class="stringliteral">           [-2,  4, -1,  0,  0],</span></div>
<div class="line"><span class="lineno"> 1332</span><span class="stringliteral">           [ 0, -2,  4, -1,  0],</span></div>
<div class="line"><span class="lineno"> 1333</span><span class="stringliteral">           [ 0,  0, -2,  4, -1],</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="stringliteral">           [ 0,  0,  0, -2,  4],</span></div>
<div class="line"><span class="lineno"> 1335</span><span class="stringliteral">           [ 0,  0,  0,  0, -2]])</span></div>
<div class="line"><span class="lineno"> 1336</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1337</span><span class="stringliteral">    &gt;&gt;&gt; convolution_matrix([-1, 4, -2], 5, mode=&#39;valid&#39;)</span></div>
<div class="line"><span class="lineno"> 1338</span><span class="stringliteral">    array([[-2,  4, -1,  0,  0],</span></div>
<div class="line"><span class="lineno"> 1339</span><span class="stringliteral">           [ 0, -2,  4, -1,  0],</span></div>
<div class="line"><span class="lineno"> 1340</span><span class="stringliteral">           [ 0,  0, -2,  4, -1]])</span></div>
<div class="line"><span class="lineno"> 1341</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1342</span>    <span class="keywordflow">if</span> n &lt;= 0:</div>
<div class="line"><span class="lineno"> 1343</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;n must be a positive integer.&#39;</span>)</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>    a = np.asarray(a)</div>
<div class="line"><span class="lineno"> 1346</span>    <span class="keywordflow">if</span> a.ndim != 1:</div>
<div class="line"><span class="lineno"> 1347</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;convolution_matrix expects a one-dimensional &#39;</span></div>
<div class="line"><span class="lineno"> 1348</span>                         <span class="stringliteral">&#39;array as input&#39;</span>)</div>
<div class="line"><span class="lineno"> 1349</span>    <span class="keywordflow">if</span> a.size == 0:</div>
<div class="line"><span class="lineno"> 1350</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;len(a) must be at least 1.&#39;</span>)</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>    <span class="keywordflow">if</span> mode <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&#39;full&#39;</span>, <span class="stringliteral">&#39;valid&#39;</span>, <span class="stringliteral">&#39;same&#39;</span>):</div>
<div class="line"><span class="lineno"> 1353</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno"> 1354</span>            <span class="stringliteral">&quot;&#39;mode&#39; argument must be one of (&#39;full&#39;, &#39;valid&#39;, &#39;same&#39;)&quot;</span>)</div>
<div class="line"><span class="lineno"> 1355</span> </div>
<div class="line"><span class="lineno"> 1356</span>    <span class="comment"># create zero padded versions of the array</span></div>
<div class="line"><span class="lineno"> 1357</span>    az = np.pad(a, (0, n-1), <span class="stringliteral">&#39;constant&#39;</span>)</div>
<div class="line"><span class="lineno"> 1358</span>    raz = np.pad(a[::-1], (0, n-1), <span class="stringliteral">&#39;constant&#39;</span>)</div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span>    <span class="keywordflow">if</span> mode == <span class="stringliteral">&#39;same&#39;</span>:</div>
<div class="line"><span class="lineno"> 1361</span>        trim = min(n, len(a)) - 1</div>
<div class="line"><span class="lineno"> 1362</span>        tb = trim//2</div>
<div class="line"><span class="lineno"> 1363</span>        te = trim - tb</div>
<div class="line"><span class="lineno"> 1364</span>        col0 = az[tb:len(az)-te]</div>
<div class="line"><span class="lineno"> 1365</span>        row0 = raz[-n-tb:len(raz)-tb]</div>
<div class="line"><span class="lineno"> 1366</span>    <span class="keywordflow">elif</span> mode == <span class="stringliteral">&#39;valid&#39;</span>:</div>
<div class="line"><span class="lineno"> 1367</span>        tb = min(n, len(a)) - 1</div>
<div class="line"><span class="lineno"> 1368</span>        te = tb</div>
<div class="line"><span class="lineno"> 1369</span>        col0 = az[tb:len(az)-te]</div>
<div class="line"><span class="lineno"> 1370</span>        row0 = raz[-n-tb:len(raz)-tb]</div>
<div class="line"><span class="lineno"> 1371</span>    <span class="keywordflow">else</span>:  <span class="comment"># &#39;full&#39;</span></div>
<div class="line"><span class="lineno"> 1372</span>        col0 = az</div>
<div class="line"><span class="lineno"> 1373</span>        row0 = raz[-n:]</div>
<div class="line"><span class="lineno"> 1374</span>    <span class="keywordflow">return</span> toeplitz(col0, row0)</div>
</div><!-- fragment -->
</div>
</div>
<a id="acb9a544b2373654620e827cac72cfc18" name="acb9a544b2373654620e827cac72cfc18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb9a544b2373654620e827cac72cfc18">&#9670;&#160;</a></span>dft()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.dft </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scale</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Discrete Fourier transform matrix.

Create the matrix that computes the discrete Fourier transform of a
sequence [1]_. The nth primitive root of unity used to generate the
matrix is exp(-2*pi*i/n), where i = sqrt(-1).

Parameters
----------
n : int
    Size the matrix to create.
scale : str, optional
    Must be None, 'sqrtn', or 'n'.
    If `scale` is 'sqrtn', the matrix is divided by `sqrt(n)`.
    If `scale` is 'n', the matrix is divided by `n`.
    If `scale` is None (the default), the matrix is not normalized, and the
    return value is simply the Vandermonde matrix of the roots of unity.

Returns
-------
m : (n, n) ndarray
    The DFT matrix.

Notes
-----
When `scale` is None, multiplying a vector by the matrix returned by
`dft` is mathematically equivalent to (but much less efficient than)
the calculation performed by `scipy.fft.fft`.

.. versionadded:: 0.14.0

References
----------
.. [1] "DFT matrix", https://en.wikipedia.org/wiki/DFT_matrix

Examples
--------
&gt;&gt;&gt; from scipy.linalg import dft
&gt;&gt;&gt; np.set_printoptions(precision=2, suppress=True)  # for compact output
&gt;&gt;&gt; m = dft(5)
&gt;&gt;&gt; m
array([[ 1.  +0.j  ,  1.  +0.j  ,  1.  +0.j  ,  1.  +0.j  ,  1.  +0.j  ],
       [ 1.  +0.j  ,  0.31-0.95j, -0.81-0.59j, -0.81+0.59j,  0.31+0.95j],
       [ 1.  +0.j  , -0.81-0.59j,  0.31+0.95j,  0.31-0.95j, -0.81+0.59j],
       [ 1.  +0.j  , -0.81+0.59j,  0.31-0.95j,  0.31+0.95j, -0.81-0.59j],
       [ 1.  +0.j  ,  0.31+0.95j, -0.81+0.59j, -0.81-0.59j,  0.31-0.95j]])
&gt;&gt;&gt; x = np.array([1, 2, 3, 0, 3])
&gt;&gt;&gt; m @ x  # Compute the DFT of x
array([ 9.  +0.j  ,  0.12-0.81j, -2.12+3.44j, -2.12-3.44j,  0.12+0.81j])

Verify that ``m @ x`` is the same as ``fft(x)``.

&gt;&gt;&gt; from scipy.fft import fft
&gt;&gt;&gt; fft(x)     # Same result as m @ x
array([ 9.  +0.j  ,  0.12-0.81j, -2.12+3.44j, -2.12-3.44j,  0.12+0.81j])
</pre> <div class="fragment"><div class="line"><span class="lineno">  972</span><span class="keyword">def </span>dft(n, scale=None):</div>
<div class="line"><span class="lineno">  973</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">    Discrete Fourier transform matrix.</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">    Create the matrix that computes the discrete Fourier transform of a</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">    sequence [1]_. The nth primitive root of unity used to generate the</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">    matrix is exp(-2*pi*i/n), where i = sqrt(-1).</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">        Size the matrix to create.</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">    scale : str, optional</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">        Must be None, &#39;sqrtn&#39;, or &#39;n&#39;.</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral">        If `scale` is &#39;sqrtn&#39;, the matrix is divided by `sqrt(n)`.</span></div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">        If `scale` is &#39;n&#39;, the matrix is divided by `n`.</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">        If `scale` is None (the default), the matrix is not normalized, and the</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">        return value is simply the Vandermonde matrix of the roots of unity.</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">    m : (n, n) ndarray</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">        The DFT matrix.</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">    When `scale` is None, multiplying a vector by the matrix returned by</span></div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">    `dft` is mathematically equivalent to (but much less efficient than)</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">    the calculation performed by `scipy.fft.fft`.</span></div>
<div class="line"><span class="lineno"> 1001</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1002</span><span class="stringliteral">    .. versionadded:: 0.14.0</span></div>
<div class="line"><span class="lineno"> 1003</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1004</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1006</span><span class="stringliteral">    .. [1] &quot;DFT matrix&quot;, https://en.wikipedia.org/wiki/DFT_matrix</span></div>
<div class="line"><span class="lineno"> 1007</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1008</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1009</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1010</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import dft</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral">    &gt;&gt;&gt; np.set_printoptions(precision=2, suppress=True)  # for compact output</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral">    &gt;&gt;&gt; m = dft(5)</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral">    &gt;&gt;&gt; m</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">    array([[ 1.  +0.j  ,  1.  +0.j  ,  1.  +0.j  ,  1.  +0.j  ,  1.  +0.j  ],</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="stringliteral">           [ 1.  +0.j  ,  0.31-0.95j, -0.81-0.59j, -0.81+0.59j,  0.31+0.95j],</span></div>
<div class="line"><span class="lineno"> 1016</span><span class="stringliteral">           [ 1.  +0.j  , -0.81-0.59j,  0.31+0.95j,  0.31-0.95j, -0.81+0.59j],</span></div>
<div class="line"><span class="lineno"> 1017</span><span class="stringliteral">           [ 1.  +0.j  , -0.81+0.59j,  0.31-0.95j,  0.31+0.95j, -0.81-0.59j],</span></div>
<div class="line"><span class="lineno"> 1018</span><span class="stringliteral">           [ 1.  +0.j  ,  0.31+0.95j, -0.81+0.59j, -0.81-0.59j,  0.31-0.95j]])</span></div>
<div class="line"><span class="lineno"> 1019</span><span class="stringliteral">    &gt;&gt;&gt; x = np.array([1, 2, 3, 0, 3])</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral">    &gt;&gt;&gt; m @ x  # Compute the DFT of x</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral">    array([ 9.  +0.j  ,  0.12-0.81j, -2.12+3.44j, -2.12-3.44j,  0.12+0.81j])</span></div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral">    Verify that ``m @ x`` is the same as ``fft(x)``.</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.fft import fft</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="stringliteral">    &gt;&gt;&gt; fft(x)     # Same result as m @ x</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="stringliteral">    array([ 9.  +0.j  ,  0.12-0.81j, -2.12+3.44j, -2.12-3.44j,  0.12+0.81j])</span></div>
<div class="line"><span class="lineno"> 1028</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keywordflow">if</span> scale <span class="keywordflow">not</span> <span class="keywordflow">in</span> [<span class="keywordtype">None</span>, <span class="stringliteral">&#39;sqrtn&#39;</span>, <span class="stringliteral">&#39;n&#39;</span>]:</div>
<div class="line"><span class="lineno"> 1030</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;scale must be None, &#39;sqrtn&#39;, or &#39;n&#39;; &quot;</span></div>
<div class="line"><span class="lineno"> 1031</span>                         <span class="stringliteral">&quot;%r is not valid.&quot;</span> % (scale,))</div>
<div class="line"><span class="lineno"> 1032</span> </div>
<div class="line"><span class="lineno"> 1033</span>    omegas = np.exp(-2j * np.pi * np.arange(n) / n).reshape(-1, 1)</div>
<div class="line"><span class="lineno"> 1034</span>    m = omegas ** np.arange(n)</div>
<div class="line"><span class="lineno"> 1035</span>    <span class="keywordflow">if</span> scale == <span class="stringliteral">&#39;sqrtn&#39;</span>:</div>
<div class="line"><span class="lineno"> 1036</span>        m /= math.sqrt(n)</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">elif</span> scale == <span class="stringliteral">&#39;n&#39;</span>:</div>
<div class="line"><span class="lineno"> 1038</span>        m /= n</div>
<div class="line"><span class="lineno"> 1039</span>    <span class="keywordflow">return</span> m</div>
<div class="line"><span class="lineno"> 1040</span> </div>
<div class="line"><span class="lineno"> 1041</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af943019b59847395f467aa5c98213d6f" name="af943019b59847395f467aa5c98213d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af943019b59847395f467aa5c98213d6f">&#9670;&#160;</a></span>fiedler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.fiedler </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns a symmetric Fiedler matrix

Given an sequence of numbers `a`, Fiedler matrices have the structure
``F[i, j] = np.abs(a[i] - a[j])``, and hence zero diagonals and nonnegative
entries. A Fiedler matrix has a dominant positive eigenvalue and other
eigenvalues are negative. Although not valid generally, for certain inputs,
the inverse and the determinant can be derived explicitly as given in [1]_.

Parameters
----------
a : (n,) array_like
    coefficient array

Returns
-------
F : (n, n) ndarray

See Also
--------
circulant, toeplitz

Notes
-----

.. versionadded:: 1.3.0

References
----------
.. [1] J. Todd, "Basic Numerical Mathematics: Vol.2 : Numerical Algebra",
    1977, Birkhauser, :doi:`10.1007/978-3-0348-7286-7`

Examples
--------
&gt;&gt;&gt; from scipy.linalg import det, inv, fiedler
&gt;&gt;&gt; a = [1, 4, 12, 45, 77]
&gt;&gt;&gt; n = len(a)
&gt;&gt;&gt; A = fiedler(a)
&gt;&gt;&gt; A
array([[ 0,  3, 11, 44, 76],
       [ 3,  0,  8, 41, 73],
       [11,  8,  0, 33, 65],
       [44, 41, 33,  0, 32],
       [76, 73, 65, 32,  0]])

The explicit formulas for determinant and inverse seem to hold only for
monotonically increasing/decreasing arrays. Note the tridiagonal structure
and the corners.

&gt;&gt;&gt; Ai = inv(A)
&gt;&gt;&gt; Ai[np.abs(Ai) &lt; 1e-12] = 0.  # cleanup the numerical noise for display
&gt;&gt;&gt; Ai
array([[-0.16008772,  0.16666667,  0.        ,  0.        ,  0.00657895],
       [ 0.16666667, -0.22916667,  0.0625    ,  0.        ,  0.        ],
       [ 0.        ,  0.0625    , -0.07765152,  0.01515152,  0.        ],
       [ 0.        ,  0.        ,  0.01515152, -0.03077652,  0.015625  ],
       [ 0.00657895,  0.        ,  0.        ,  0.015625  , -0.00904605]])
&gt;&gt;&gt; det(A)
15409151.999999998
&gt;&gt;&gt; (-1)**(n-1) * 2**(n-2) * np.diff(a).prod() * (a[-1] - a[0])
15409152</pre> <div class="fragment"><div class="line"><span class="lineno"> 1042</span><span class="keyword">def </span>fiedler(a):</div>
<div class="line"><span class="lineno"> 1043</span>    <span class="stringliteral">&quot;&quot;&quot;Returns a symmetric Fiedler matrix</span></div>
<div class="line"><span class="lineno"> 1044</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1045</span><span class="stringliteral">    Given an sequence of numbers `a`, Fiedler matrices have the structure</span></div>
<div class="line"><span class="lineno"> 1046</span><span class="stringliteral">    ``F[i, j] = np.abs(a[i] - a[j])``, and hence zero diagonals and nonnegative</span></div>
<div class="line"><span class="lineno"> 1047</span><span class="stringliteral">    entries. A Fiedler matrix has a dominant positive eigenvalue and other</span></div>
<div class="line"><span class="lineno"> 1048</span><span class="stringliteral">    eigenvalues are negative. Although not valid generally, for certain inputs,</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral">    the inverse and the determinant can be derived explicitly as given in [1]_.</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">    a : (n,) array_like</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">        coefficient array</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">    F : (n, n) ndarray</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">    circulant, toeplitz</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1067</span><span class="stringliteral">    .. versionadded:: 1.3.0</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1069</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="stringliteral">    .. [1] J. Todd, &quot;Basic Numerical Mathematics: Vol.2 : Numerical Algebra&quot;,</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="stringliteral">        1977, Birkhauser, :doi:`10.1007/978-3-0348-7286-7`</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import det, inv, fiedler</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral">    &gt;&gt;&gt; a = [1, 4, 12, 45, 77]</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">    &gt;&gt;&gt; n = len(a)</span></div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral">    &gt;&gt;&gt; A = fiedler(a)</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">    &gt;&gt;&gt; A</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">    array([[ 0,  3, 11, 44, 76],</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">           [ 3,  0,  8, 41, 73],</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral">           [11,  8,  0, 33, 65],</span></div>
<div class="line"><span class="lineno"> 1084</span><span class="stringliteral">           [44, 41, 33,  0, 32],</span></div>
<div class="line"><span class="lineno"> 1085</span><span class="stringliteral">           [76, 73, 65, 32,  0]])</span></div>
<div class="line"><span class="lineno"> 1086</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1087</span><span class="stringliteral">    The explicit formulas for determinant and inverse seem to hold only for</span></div>
<div class="line"><span class="lineno"> 1088</span><span class="stringliteral">    monotonically increasing/decreasing arrays. Note the tridiagonal structure</span></div>
<div class="line"><span class="lineno"> 1089</span><span class="stringliteral">    and the corners.</span></div>
<div class="line"><span class="lineno"> 1090</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1091</span><span class="stringliteral">    &gt;&gt;&gt; Ai = inv(A)</span></div>
<div class="line"><span class="lineno"> 1092</span><span class="stringliteral">    &gt;&gt;&gt; Ai[np.abs(Ai) &lt; 1e-12] = 0.  # cleanup the numerical noise for display</span></div>
<div class="line"><span class="lineno"> 1093</span><span class="stringliteral">    &gt;&gt;&gt; Ai</span></div>
<div class="line"><span class="lineno"> 1094</span><span class="stringliteral">    array([[-0.16008772,  0.16666667,  0.        ,  0.        ,  0.00657895],</span></div>
<div class="line"><span class="lineno"> 1095</span><span class="stringliteral">           [ 0.16666667, -0.22916667,  0.0625    ,  0.        ,  0.        ],</span></div>
<div class="line"><span class="lineno"> 1096</span><span class="stringliteral">           [ 0.        ,  0.0625    , -0.07765152,  0.01515152,  0.        ],</span></div>
<div class="line"><span class="lineno"> 1097</span><span class="stringliteral">           [ 0.        ,  0.        ,  0.01515152, -0.03077652,  0.015625  ],</span></div>
<div class="line"><span class="lineno"> 1098</span><span class="stringliteral">           [ 0.00657895,  0.        ,  0.        ,  0.015625  , -0.00904605]])</span></div>
<div class="line"><span class="lineno"> 1099</span><span class="stringliteral">    &gt;&gt;&gt; det(A)</span></div>
<div class="line"><span class="lineno"> 1100</span><span class="stringliteral">    15409151.999999998</span></div>
<div class="line"><span class="lineno"> 1101</span><span class="stringliteral">    &gt;&gt;&gt; (-1)**(n-1) * 2**(n-2) * np.diff(a).prod() * (a[-1] - a[0])</span></div>
<div class="line"><span class="lineno"> 1102</span><span class="stringliteral">    15409152</span></div>
<div class="line"><span class="lineno"> 1103</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1104</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1105</span>    a = np.atleast_1d(a)</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>    <span class="keywordflow">if</span> a.ndim != 1:</div>
<div class="line"><span class="lineno"> 1108</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Input &#39;a&#39; must be a 1D array.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1109</span> </div>
<div class="line"><span class="lineno"> 1110</span>    <span class="keywordflow">if</span> a.size == 0:</div>
<div class="line"><span class="lineno"> 1111</span>        <span class="keywordflow">return</span> np.array([], dtype=float)</div>
<div class="line"><span class="lineno"> 1112</span>    <span class="keywordflow">elif</span> a.size == 1:</div>
<div class="line"><span class="lineno"> 1113</span>        <span class="keywordflow">return</span> np.array([[0.]])</div>
<div class="line"><span class="lineno"> 1114</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1115</span>        <span class="keywordflow">return</span> np.abs(a[:, <span class="keywordtype">None</span>] - a)</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c98e61199e669c788530b558fae0a2a" name="a9c98e61199e669c788530b558fae0a2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c98e61199e669c788530b558fae0a2a">&#9670;&#160;</a></span>fiedler_companion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.fiedler_companion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment"> Returns a Fiedler companion matrix

Given a polynomial coefficient array ``a``, this function forms a
pentadiagonal matrix with a special structure whose eigenvalues coincides
with the roots of ``a``.

Parameters
----------
a : (N,) array_like
    1-D array of polynomial coefficients in descending order with a nonzero
    leading coefficient. For ``N &lt; 2``, an empty array is returned.

Returns
-------
c : (N-1, N-1) ndarray
    Resulting companion matrix

Notes
-----
Similar to `companion` the leading coefficient should be nonzero. In the case
the leading coefficient is not 1, other coefficients are rescaled before
the array generation. To avoid numerical issues, it is best to provide a
monic polynomial.

.. versionadded:: 1.3.0

See Also
--------
companion

References
----------
.. [1] M. Fiedler, " A note on companion matrices", Linear Algebra and its
    Applications, 2003, :doi:`10.1016/S0024-3795(03)00548-2`

Examples
--------
&gt;&gt;&gt; from scipy.linalg import fiedler_companion, eigvals
&gt;&gt;&gt; p = np.poly(np.arange(1, 9, 2))  # [1., -16., 86., -176., 105.]
&gt;&gt;&gt; fc = fiedler_companion(p)
&gt;&gt;&gt; fc
array([[  16.,  -86.,    1.,    0.],
       [   1.,    0.,    0.,    0.],
       [   0.,  176.,    0., -105.],
       [   0.,    1.,    0.,    0.]])
&gt;&gt;&gt; eigvals(fc)
array([7.+0.j, 5.+0.j, 3.+0.j, 1.+0.j])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1118</span><span class="keyword">def </span>fiedler_companion(a):</div>
<div class="line"><span class="lineno"> 1119</span>    <span class="stringliteral">&quot;&quot;&quot; Returns a Fiedler companion matrix</span></div>
<div class="line"><span class="lineno"> 1120</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1121</span><span class="stringliteral">    Given a polynomial coefficient array ``a``, this function forms a</span></div>
<div class="line"><span class="lineno"> 1122</span><span class="stringliteral">    pentadiagonal matrix with a special structure whose eigenvalues coincides</span></div>
<div class="line"><span class="lineno"> 1123</span><span class="stringliteral">    with the roots of ``a``.</span></div>
<div class="line"><span class="lineno"> 1124</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1125</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1126</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1127</span><span class="stringliteral">    a : (N,) array_like</span></div>
<div class="line"><span class="lineno"> 1128</span><span class="stringliteral">        1-D array of polynomial coefficients in descending order with a nonzero</span></div>
<div class="line"><span class="lineno"> 1129</span><span class="stringliteral">        leading coefficient. For ``N &lt; 2``, an empty array is returned.</span></div>
<div class="line"><span class="lineno"> 1130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1131</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1132</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1133</span><span class="stringliteral">    c : (N-1, N-1) ndarray</span></div>
<div class="line"><span class="lineno"> 1134</span><span class="stringliteral">        Resulting companion matrix</span></div>
<div class="line"><span class="lineno"> 1135</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1136</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1137</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1138</span><span class="stringliteral">    Similar to `companion` the leading coefficient should be nonzero. In the case</span></div>
<div class="line"><span class="lineno"> 1139</span><span class="stringliteral">    the leading coefficient is not 1, other coefficients are rescaled before</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="stringliteral">    the array generation. To avoid numerical issues, it is best to provide a</span></div>
<div class="line"><span class="lineno"> 1141</span><span class="stringliteral">    monic polynomial.</span></div>
<div class="line"><span class="lineno"> 1142</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1143</span><span class="stringliteral">    .. versionadded:: 1.3.0</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1145</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1146</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1147</span><span class="stringliteral">    companion</span></div>
<div class="line"><span class="lineno"> 1148</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1149</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1150</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1151</span><span class="stringliteral">    .. [1] M. Fiedler, &quot; A note on companion matrices&quot;, Linear Algebra and its</span></div>
<div class="line"><span class="lineno"> 1152</span><span class="stringliteral">        Applications, 2003, :doi:`10.1016/S0024-3795(03)00548-2`</span></div>
<div class="line"><span class="lineno"> 1153</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1154</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1155</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1156</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import fiedler_companion, eigvals</span></div>
<div class="line"><span class="lineno"> 1157</span><span class="stringliteral">    &gt;&gt;&gt; p = np.poly(np.arange(1, 9, 2))  # [1., -16., 86., -176., 105.]</span></div>
<div class="line"><span class="lineno"> 1158</span><span class="stringliteral">    &gt;&gt;&gt; fc = fiedler_companion(p)</span></div>
<div class="line"><span class="lineno"> 1159</span><span class="stringliteral">    &gt;&gt;&gt; fc</span></div>
<div class="line"><span class="lineno"> 1160</span><span class="stringliteral">    array([[  16.,  -86.,    1.,    0.],</span></div>
<div class="line"><span class="lineno"> 1161</span><span class="stringliteral">           [   1.,    0.,    0.,    0.],</span></div>
<div class="line"><span class="lineno"> 1162</span><span class="stringliteral">           [   0.,  176.,    0., -105.],</span></div>
<div class="line"><span class="lineno"> 1163</span><span class="stringliteral">           [   0.,    1.,    0.,    0.]])</span></div>
<div class="line"><span class="lineno"> 1164</span><span class="stringliteral">    &gt;&gt;&gt; eigvals(fc)</span></div>
<div class="line"><span class="lineno"> 1165</span><span class="stringliteral">    array([7.+0.j, 5.+0.j, 3.+0.j, 1.+0.j])</span></div>
<div class="line"><span class="lineno"> 1166</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1167</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1168</span>    a = np.atleast_1d(a)</div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span>    <span class="keywordflow">if</span> a.ndim != 1:</div>
<div class="line"><span class="lineno"> 1171</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Input &#39;a&#39; must be a 1-D array.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1172</span> </div>
<div class="line"><span class="lineno"> 1173</span>    <span class="keywordflow">if</span> a.size &lt;= 2:</div>
<div class="line"><span class="lineno"> 1174</span>        <span class="keywordflow">if</span> a.size == 2:</div>
<div class="line"><span class="lineno"> 1175</span>            <span class="keywordflow">return</span> np.array([[-(a/a[0])[-1]]])</div>
<div class="line"><span class="lineno"> 1176</span>        <span class="keywordflow">return</span> np.array([], dtype=a.dtype)</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>    <span class="keywordflow">if</span> a[0] == 0.:</div>
<div class="line"><span class="lineno"> 1179</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Leading coefficient is zero.&#39;</span>)</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>    a = a/a[0]</div>
<div class="line"><span class="lineno"> 1182</span>    n = a.size - 1</div>
<div class="line"><span class="lineno"> 1183</span>    c = np.zeros((n, n), dtype=a.dtype)</div>
<div class="line"><span class="lineno"> 1184</span>    <span class="comment"># subdiagonals</span></div>
<div class="line"><span class="lineno"> 1185</span>    c[range(3, n, 2), range(1, n-2, 2)] = 1.</div>
<div class="line"><span class="lineno"> 1186</span>    c[range(2, n, 2), range(1, n-1, 2)] = -a[3::2]</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="comment"># superdiagonals</span></div>
<div class="line"><span class="lineno"> 1188</span>    c[range(0, n-2, 2), range(2, n, 2)] = 1.</div>
<div class="line"><span class="lineno"> 1189</span>    c[range(0, n-1, 2), range(1, n, 2)] = -a[2::2]</div>
<div class="line"><span class="lineno"> 1190</span>    c[[0, 1], 0] = [-a[1], 1]</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>    <span class="keywordflow">return</span> c</div>
<div class="line"><span class="lineno"> 1193</span> </div>
<div class="line"><span class="lineno"> 1194</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5bf88c8cf8014413ffbf3f2e86169f8" name="aa5bf88c8cf8014413ffbf3f2e86169f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5bf88c8cf8014413ffbf3f2e86169f8">&#9670;&#160;</a></span>hadamard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.hadamard </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em> = <code>int</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct an Hadamard matrix.

Constructs an n-by-n Hadamard matrix, using Sylvester's
construction. `n` must be a power of 2.

Parameters
----------
n : int
    The order of the matrix. `n` must be a power of 2.
dtype : dtype, optional
    The data type of the array to be constructed.

Returns
-------
H : (n, n) ndarray
    The Hadamard matrix.

Notes
-----
.. versionadded:: 0.8.0

Examples
--------
&gt;&gt;&gt; from scipy.linalg import hadamard
&gt;&gt;&gt; hadamard(2, dtype=complex)
array([[ 1.+0.j,  1.+0.j],
       [ 1.+0.j, -1.-0.j]])
&gt;&gt;&gt; hadamard(4)
array([[ 1,  1,  1,  1],
       [ 1, -1,  1, -1],
       [ 1,  1, -1, -1],
       [ 1, -1, -1,  1]])</pre> <div class="fragment"><div class="line"><span class="lineno">  300</span><span class="keyword">def </span>hadamard(n, dtype=int):</div>
<div class="line"><span class="lineno">  301</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">    Construct an Hadamard matrix.</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">    Constructs an n-by-n Hadamard matrix, using Sylvester&#39;s</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">    construction. `n` must be a power of 2.</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">        The order of the matrix. `n` must be a power of 2.</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">    dtype : dtype, optional</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">        The data type of the array to be constructed.</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    H : (n, n) ndarray</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">        The Hadamard matrix.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    .. versionadded:: 0.8.0</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import hadamard</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">    &gt;&gt;&gt; hadamard(2, dtype=complex)</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">    array([[ 1.+0.j,  1.+0.j],</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">           [ 1.+0.j, -1.-0.j]])</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">    &gt;&gt;&gt; hadamard(4)</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    array([[ 1,  1,  1,  1],</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">           [ 1, -1,  1, -1],</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">           [ 1,  1, -1, -1],</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">           [ 1, -1, -1,  1]])</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>    <span class="comment"># This function is a slightly modified version of the</span></div>
<div class="line"><span class="lineno">  338</span>    <span class="comment"># function contributed by Ivo in ticket #675.</span></div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">if</span> n &lt; 1:</div>
<div class="line"><span class="lineno">  341</span>        lg2 = 0</div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  343</span>        lg2 = int(math.log(n, 2))</div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">if</span> 2 ** lg2 != n:</div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;n must be an positive integer, and n must be &quot;</span></div>
<div class="line"><span class="lineno">  346</span>                         <span class="stringliteral">&quot;a power of 2&quot;</span>)</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    H = np.array([[1]], dtype=dtype)</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>    <span class="comment"># Sylvester&#39;s construction</span></div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, lg2):</div>
<div class="line"><span class="lineno">  352</span>        H = np.vstack((np.hstack((H, H)), np.hstack((H, -H))))</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">return</span> H</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad74cc1ad8af780ae9c873aaae9c577a6" name="ad74cc1ad8af780ae9c873aaae9c577a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad74cc1ad8af780ae9c873aaae9c577a6">&#9670;&#160;</a></span>hankel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.hankel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct a Hankel matrix.

The Hankel matrix has constant anti-diagonals, with `c` as its
first column and `r` as its last row. If `r` is not given, then
`r = zeros_like(c)` is assumed.

Parameters
----------
c : array_like
    First column of the matrix. Whatever the actual shape of `c`, it
    will be converted to a 1-D array.
r : array_like, optional
    Last row of the matrix. If None, ``r = zeros_like(c)`` is assumed.
    r[0] is ignored; the last row of the returned matrix is
    ``[c[-1], r[1:]]``. Whatever the actual shape of `r`, it will be
    converted to a 1-D array.

Returns
-------
A : (len(c), len(r)) ndarray
    The Hankel matrix. Dtype is the same as ``(c[0] + r[0]).dtype``.

See Also
--------
toeplitz : Toeplitz matrix
circulant : circulant matrix

Examples
--------
&gt;&gt;&gt; from scipy.linalg import hankel
&gt;&gt;&gt; hankel([1, 17, 99])
array([[ 1, 17, 99],
       [17, 99,  0],
       [99,  0,  0]])
&gt;&gt;&gt; hankel([1,2,3,4], [4,7,7,8,9])
array([[1, 2, 3, 4, 7],
       [2, 3, 4, 7, 7],
       [3, 4, 7, 7, 8],
       [4, 7, 7, 8, 9]])</pre> <div class="fragment"><div class="line"><span class="lineno">  243</span><span class="keyword">def </span>hankel(c, r=None):</div>
<div class="line"><span class="lineno">  244</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    Construct a Hankel matrix.</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    The Hankel matrix has constant anti-diagonals, with `c` as its</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    first column and `r` as its last row. If `r` is not given, then</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    `r = zeros_like(c)` is assumed.</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    c : array_like</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">        First column of the matrix. Whatever the actual shape of `c`, it</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">        will be converted to a 1-D array.</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    r : array_like, optional</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">        Last row of the matrix. If None, ``r = zeros_like(c)`` is assumed.</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">        r[0] is ignored; the last row of the returned matrix is</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">        ``[c[-1], r[1:]]``. Whatever the actual shape of `r`, it will be</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">        converted to a 1-D array.</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    A : (len(c), len(r)) ndarray</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">        The Hankel matrix. Dtype is the same as ``(c[0] + r[0]).dtype``.</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    toeplitz : Toeplitz matrix</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    circulant : circulant matrix</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import hankel</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    &gt;&gt;&gt; hankel([1, 17, 99])</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    array([[ 1, 17, 99],</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">           [17, 99,  0],</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">           [99,  0,  0]])</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">    &gt;&gt;&gt; hankel([1,2,3,4], [4,7,7,8,9])</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">    array([[1, 2, 3, 4, 7],</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">           [2, 3, 4, 7, 7],</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">           [3, 4, 7, 7, 8],</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">           [4, 7, 7, 8, 9]])</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  286</span>    c = np.asarray(c).ravel()</div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">if</span> r <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  288</span>        r = np.zeros_like(c)</div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  290</span>        r = np.asarray(r).ravel()</div>
<div class="line"><span class="lineno">  291</span>    <span class="comment"># Form a 1-D array of values to be used in the matrix, containing `c`</span></div>
<div class="line"><span class="lineno">  292</span>    <span class="comment"># followed by r[1:].</span></div>
<div class="line"><span class="lineno">  293</span>    vals = np.concatenate((c, r[1:]))</div>
<div class="line"><span class="lineno">  294</span>    <span class="comment"># Stride on concatenated array to get hankel matrix</span></div>
<div class="line"><span class="lineno">  295</span>    out_shp = len(c), len(r)</div>
<div class="line"><span class="lineno">  296</span>    n = vals.strides[0]</div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordflow">return</span> as_strided(vals, shape=out_shp, strides=(n, n)).copy()</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e2a4b3eb8c15fde671fab5cbc3ca325" name="a4e2a4b3eb8c15fde671fab5cbc3ca325"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e2a4b3eb8c15fde671fab5cbc3ca325">&#9670;&#160;</a></span>helmert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.helmert </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create an Helmert matrix of order `n`.

This has applications in statistics, compositional or simplicial analysis,
and in Aitchison geometry.

Parameters
----------
n : int
    The size of the array to create.
full : bool, optional
    If True the (n, n) ndarray will be returned.
    Otherwise the submatrix that does not include the first
    row will be returned.
    Default: False.

Returns
-------
M : ndarray
    The Helmert matrix.
    The shape is (n, n) or (n-1, n) depending on the `full` argument.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import helmert
&gt;&gt;&gt; helmert(5, full=True)
array([[ 0.4472136 ,  0.4472136 ,  0.4472136 ,  0.4472136 ,  0.4472136 ],
       [ 0.70710678, -0.70710678,  0.        ,  0.        ,  0.        ],
       [ 0.40824829,  0.40824829, -0.81649658,  0.        ,  0.        ],
       [ 0.28867513,  0.28867513,  0.28867513, -0.8660254 ,  0.        ],
       [ 0.2236068 ,  0.2236068 ,  0.2236068 ,  0.2236068 , -0.89442719]])</pre> <div class="fragment"><div class="line"><span class="lineno">  616</span><span class="keyword">def </span>helmert(n, full=False):</div>
<div class="line"><span class="lineno">  617</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">    Create an Helmert matrix of order `n`.</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral">    This has applications in statistics, compositional or simplicial analysis,</span></div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral">    and in Aitchison geometry.</span></div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">        The size of the array to create.</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">    full : bool, optional</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">        If True the (n, n) ndarray will be returned.</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral">        Otherwise the submatrix that does not include the first</span></div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">        row will be returned.</span></div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral">        Default: False.</span></div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  633</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  634</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  635</span><span class="stringliteral">    M : ndarray</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral">        The Helmert matrix.</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">        The shape is (n, n) or (n-1, n) depending on the `full` argument.</span></div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import helmert</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">    &gt;&gt;&gt; helmert(5, full=True)</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral">    array([[ 0.4472136 ,  0.4472136 ,  0.4472136 ,  0.4472136 ,  0.4472136 ],</span></div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral">           [ 0.70710678, -0.70710678,  0.        ,  0.        ,  0.        ],</span></div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">           [ 0.40824829,  0.40824829, -0.81649658,  0.        ,  0.        ],</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">           [ 0.28867513,  0.28867513,  0.28867513, -0.8660254 ,  0.        ],</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral">           [ 0.2236068 ,  0.2236068 ,  0.2236068 ,  0.2236068 , -0.89442719]])</span></div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  650</span>    H = np.tril(np.ones((n, n)), -1) - np.diag(np.arange(n))</div>
<div class="line"><span class="lineno">  651</span>    d = np.arange(n) * np.arange(1, n+1)</div>
<div class="line"><span class="lineno">  652</span>    H[0] = 1</div>
<div class="line"><span class="lineno">  653</span>    d[0] = n</div>
<div class="line"><span class="lineno">  654</span>    H_full = H / np.sqrt(d)[:, np.newaxis]</div>
<div class="line"><span class="lineno">  655</span>    <span class="keywordflow">if</span> full:</div>
<div class="line"><span class="lineno">  656</span>        <span class="keywordflow">return</span> H_full</div>
<div class="line"><span class="lineno">  657</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">return</span> H_full[1:]</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f43ed3f392fe5f54db7950ca4cae260" name="a6f43ed3f392fe5f54db7950ca4cae260"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f43ed3f392fe5f54db7950ca4cae260">&#9670;&#160;</a></span>hilbert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.hilbert </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a Hilbert matrix of order `n`.

Returns the `n` by `n` array with entries `h[i,j] = 1 / (i + j + 1)`.

Parameters
----------
n : int
    The size of the array to create.

Returns
-------
h : (n, n) ndarray
    The Hilbert matrix.

See Also
--------
invhilbert : Compute the inverse of a Hilbert matrix.

Notes
-----
.. versionadded:: 0.10.0

Examples
--------
&gt;&gt;&gt; from scipy.linalg import hilbert
&gt;&gt;&gt; hilbert(3)
array([[ 1.        ,  0.5       ,  0.33333333],
       [ 0.5       ,  0.33333333,  0.25      ],
       [ 0.33333333,  0.25      ,  0.2       ]])</pre> <div class="fragment"><div class="line"><span class="lineno">  661</span><span class="keyword">def </span>hilbert(n):</div>
<div class="line"><span class="lineno">  662</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">    Create a Hilbert matrix of order `n`.</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">    Returns the `n` by `n` array with entries `h[i,j] = 1 / (i + j + 1)`.</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral">        The size of the array to create.</span></div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">    h : (n, n) ndarray</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral">        The Hilbert matrix.</span></div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">    invhilbert : Compute the inverse of a Hilbert matrix.</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">    .. versionadded:: 0.10.0</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import hilbert</span></div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral">    &gt;&gt;&gt; hilbert(3)</span></div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral">    array([[ 1.        ,  0.5       ,  0.33333333],</span></div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral">           [ 0.5       ,  0.33333333,  0.25      ],</span></div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral">           [ 0.33333333,  0.25      ,  0.2       ]])</span></div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  694</span>    values = 1.0 / (1.0 + np.arange(2 * n - 1))</div>
<div class="line"><span class="lineno">  695</span>    h = hankel(values[:n], r=values[n - 1:])</div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">return</span> h</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a97248ada231330c917b2d3acbef12d03" name="a97248ada231330c917b2d3acbef12d03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97248ada231330c917b2d3acbef12d03">&#9670;&#160;</a></span>invhilbert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.invhilbert </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exact</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the inverse of the Hilbert matrix of order `n`.

The entries in the inverse of a Hilbert matrix are integers. When `n`
is greater than 14, some entries in the inverse exceed the upper limit
of 64 bit integers. The `exact` argument provides two options for
dealing with these large integers.

Parameters
----------
n : int
    The order of the Hilbert matrix.
exact : bool, optional
    If False, the data type of the array that is returned is np.float64,
    and the array is an approximation of the inverse.
    If True, the array is the exact integer inverse array. To represent
    the exact inverse when n &gt; 14, the returned array is an object array
    of long integers. For n &lt;= 14, the exact inverse is returned as an
    array with data type np.int64.

Returns
-------
invh : (n, n) ndarray
    The data type of the array is np.float64 if `exact` is False.
    If `exact` is True, the data type is either np.int64 (for n &lt;= 14)
    or object (for n &gt; 14). In the latter case, the objects in the
    array will be long integers.

See Also
--------
hilbert : Create a Hilbert matrix.

Notes
-----
.. versionadded:: 0.10.0

Examples
--------
&gt;&gt;&gt; from scipy.linalg import invhilbert
&gt;&gt;&gt; invhilbert(4)
array([[   16.,  -120.,   240.,  -140.],
       [ -120.,  1200., -2700.,  1680.],
       [  240., -2700.,  6480., -4200.],
       [ -140.,  1680., -4200.,  2800.]])
&gt;&gt;&gt; invhilbert(4, exact=True)
array([[   16,  -120,   240,  -140],
       [ -120,  1200, -2700,  1680],
       [  240, -2700,  6480, -4200],
       [ -140,  1680, -4200,  2800]], dtype=int64)
&gt;&gt;&gt; invhilbert(16)[7,7]
4.2475099528537506e+19
&gt;&gt;&gt; invhilbert(16, exact=True)[7,7]
42475099528537378560</pre> <div class="fragment"><div class="line"><span class="lineno">  699</span><span class="keyword">def </span>invhilbert(n, exact=False):</div>
<div class="line"><span class="lineno">  700</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">    Compute the inverse of the Hilbert matrix of order `n`.</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">    The entries in the inverse of a Hilbert matrix are integers. When `n`</span></div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral">    is greater than 14, some entries in the inverse exceed the upper limit</span></div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral">    of 64 bit integers. The `exact` argument provides two options for</span></div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral">    dealing with these large integers.</span></div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  708</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  709</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral">        The order of the Hilbert matrix.</span></div>
<div class="line"><span class="lineno">  712</span><span class="stringliteral">    exact : bool, optional</span></div>
<div class="line"><span class="lineno">  713</span><span class="stringliteral">        If False, the data type of the array that is returned is np.float64,</span></div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">        and the array is an approximation of the inverse.</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral">        If True, the array is the exact integer inverse array. To represent</span></div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">        the exact inverse when n &gt; 14, the returned array is an object array</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">        of long integers. For n &lt;= 14, the exact inverse is returned as an</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">        array with data type np.int64.</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">    invh : (n, n) ndarray</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">        The data type of the array is np.float64 if `exact` is False.</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral">        If `exact` is True, the data type is either np.int64 (for n &lt;= 14)</span></div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">        or object (for n &gt; 14). In the latter case, the objects in the</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">        array will be long integers.</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral">    hilbert : Create a Hilbert matrix.</span></div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">    .. versionadded:: 0.10.0</span></div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import invhilbert</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">    &gt;&gt;&gt; invhilbert(4)</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">    array([[   16.,  -120.,   240.,  -140.],</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">           [ -120.,  1200., -2700.,  1680.],</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">           [  240., -2700.,  6480., -4200.],</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">           [ -140.,  1680., -4200.,  2800.]])</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">    &gt;&gt;&gt; invhilbert(4, exact=True)</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral">    array([[   16,  -120,   240,  -140],</span></div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">           [ -120,  1200, -2700,  1680],</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral">           [  240, -2700,  6480, -4200],</span></div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">           [ -140,  1680, -4200,  2800]], dtype=int64)</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral">    &gt;&gt;&gt; invhilbert(16)[7,7]</span></div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral">    4.2475099528537506e+19</span></div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral">    &gt;&gt;&gt; invhilbert(16, exact=True)[7,7]</span></div>
<div class="line"><span class="lineno">  752</span><span class="stringliteral">    42475099528537378560</span></div>
<div class="line"><span class="lineno">  753</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  754</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  755</span>    <span class="keyword">from</span> <a class="code hl_namespace" href="namespacescipy_1_1special.html">scipy.special</a> <span class="keyword">import</span> comb</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">if</span> exact:</div>
<div class="line"><span class="lineno">  757</span>        <span class="keywordflow">if</span> n &gt; 14:</div>
<div class="line"><span class="lineno">  758</span>            dtype = object</div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  760</span>            dtype = np.int64</div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  762</span>        dtype = np.float64</div>
<div class="line"><span class="lineno">  763</span>    invh = np.empty((n, n), dtype=dtype)</div>
<div class="line"><span class="lineno">  764</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n):</div>
<div class="line"><span class="lineno">  765</span>        <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(0, i + 1):</div>
<div class="line"><span class="lineno">  766</span>            s = i + j</div>
<div class="line"><span class="lineno">  767</span>            invh[i, j] = ((-1) ** s * (s + 1) *</div>
<div class="line"><span class="lineno">  768</span>                          comb(n + i, n - j - 1, exact) *</div>
<div class="line"><span class="lineno">  769</span>                          comb(n + j, n - i - 1, exact) *</div>
<div class="line"><span class="lineno">  770</span>                          comb(s, i, exact) ** 2)</div>
<div class="line"><span class="lineno">  771</span>            <span class="keywordflow">if</span> i != j:</div>
<div class="line"><span class="lineno">  772</span>                invh[j, i] = invh[i, j]</div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordflow">return</span> invh</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="ttc" id="anamespacescipy_1_1special_html"><div class="ttname"><a href="namespacescipy_1_1special.html">scipy.special</a></div><div class="ttdef"><b>Definition</b> __init__.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aada832342bbbbf86f533f48f5030588a" name="aada832342bbbbf86f533f48f5030588a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aada832342bbbbf86f533f48f5030588a">&#9670;&#160;</a></span>invpascal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.invpascal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kind</em> = <code>'symmetric'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exact</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the inverse of the n x n Pascal matrix.

The Pascal matrix is a matrix containing the binomial coefficients as
its elements.

Parameters
----------
n : int
    The size of the matrix to create; that is, the result is an n x n
    matrix.
kind : str, optional
    Must be one of 'symmetric', 'lower', or 'upper'.
    Default is 'symmetric'.
exact : bool, optional
    If `exact` is True, the result is either an array of type
    ``numpy.int64`` (if `n` &lt;= 35) or an object array of Python integers.
    If `exact` is False, the coefficients in the matrix are computed using
    `scipy.special.comb` with `exact=False`. The result will be a floating
    point array, and for large `n`, the values in the array will not be the
    exact coefficients.

Returns
-------
invp : (n, n) ndarray
    The inverse of the Pascal matrix.

See Also
--------
pascal

Notes
-----

.. versionadded:: 0.16.0

References
----------
.. [1] "Pascal matrix", https://en.wikipedia.org/wiki/Pascal_matrix
.. [2] Cohen, A. M., "The inverse of a Pascal matrix", Mathematical
       Gazette, 59(408), pp. 111-112, 1975.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import invpascal, pascal
&gt;&gt;&gt; invp = invpascal(5)
&gt;&gt;&gt; invp
array([[  5, -10,  10,  -5,   1],
       [-10,  30, -35,  19,  -4],
       [ 10, -35,  46, -27,   6],
       [ -5,  19, -27,  17,  -4],
       [  1,  -4,   6,  -4,   1]])

&gt;&gt;&gt; p = pascal(5)
&gt;&gt;&gt; p.dot(invp)
array([[ 1.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  0.],
       [ 0.,  0.,  0.,  0.,  1.]])

An example of the use of `kind` and `exact`:

&gt;&gt;&gt; invpascal(5, kind='lower', exact=False)
array([[ 1., -0.,  0., -0.,  0.],
       [-1.,  1., -0.,  0., -0.],
       [ 1., -2.,  1., -0.,  0.],
       [-1.,  3., -3.,  1., -0.],
       [ 1., -4.,  6., -4.,  1.]])</pre> <div class="fragment"><div class="line"><span class="lineno">  862</span><span class="keyword">def </span>invpascal(n, kind=&#39;symmetric&#39;, exact=True):</div>
<div class="line"><span class="lineno">  863</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  864</span><span class="stringliteral">    Returns the inverse of the n x n Pascal matrix.</span></div>
<div class="line"><span class="lineno">  865</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  866</span><span class="stringliteral">    The Pascal matrix is a matrix containing the binomial coefficients as</span></div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">    its elements.</span></div>
<div class="line"><span class="lineno">  868</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  869</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  870</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  871</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral">        The size of the matrix to create; that is, the result is an n x n</span></div>
<div class="line"><span class="lineno">  873</span><span class="stringliteral">        matrix.</span></div>
<div class="line"><span class="lineno">  874</span><span class="stringliteral">    kind : str, optional</span></div>
<div class="line"><span class="lineno">  875</span><span class="stringliteral">        Must be one of &#39;symmetric&#39;, &#39;lower&#39;, or &#39;upper&#39;.</span></div>
<div class="line"><span class="lineno">  876</span><span class="stringliteral">        Default is &#39;symmetric&#39;.</span></div>
<div class="line"><span class="lineno">  877</span><span class="stringliteral">    exact : bool, optional</span></div>
<div class="line"><span class="lineno">  878</span><span class="stringliteral">        If `exact` is True, the result is either an array of type</span></div>
<div class="line"><span class="lineno">  879</span><span class="stringliteral">        ``numpy.int64`` (if `n` &lt;= 35) or an object array of Python integers.</span></div>
<div class="line"><span class="lineno">  880</span><span class="stringliteral">        If `exact` is False, the coefficients in the matrix are computed using</span></div>
<div class="line"><span class="lineno">  881</span><span class="stringliteral">        `scipy.special.comb` with `exact=False`. The result will be a floating</span></div>
<div class="line"><span class="lineno">  882</span><span class="stringliteral">        point array, and for large `n`, the values in the array will not be the</span></div>
<div class="line"><span class="lineno">  883</span><span class="stringliteral">        exact coefficients.</span></div>
<div class="line"><span class="lineno">  884</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  885</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  886</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  887</span><span class="stringliteral">    invp : (n, n) ndarray</span></div>
<div class="line"><span class="lineno">  888</span><span class="stringliteral">        The inverse of the Pascal matrix.</span></div>
<div class="line"><span class="lineno">  889</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  890</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  891</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral">    pascal</span></div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">    .. versionadded:: 0.16.0</span></div>
<div class="line"><span class="lineno">  898</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">    .. [1] &quot;Pascal matrix&quot;, https://en.wikipedia.org/wiki/Pascal_matrix</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">    .. [2] Cohen, A. M., &quot;The inverse of a Pascal matrix&quot;, Mathematical</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral">           Gazette, 59(408), pp. 111-112, 1975.</span></div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import invpascal, pascal</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">    &gt;&gt;&gt; invp = invpascal(5)</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral">    &gt;&gt;&gt; invp</span></div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">    array([[  5, -10,  10,  -5,   1],</span></div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral">           [-10,  30, -35,  19,  -4],</span></div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">           [ 10, -35,  46, -27,   6],</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral">           [ -5,  19, -27,  17,  -4],</span></div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">           [  1,  -4,   6,  -4,   1]])</span></div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral">    &gt;&gt;&gt; p = pascal(5)</span></div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">    &gt;&gt;&gt; p.dot(invp)</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">    array([[ 1.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">           [ 0.,  1.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral">           [ 0.,  0.,  0.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  1.]])</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral">    An example of the use of `kind` and `exact`:</span></div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">    &gt;&gt;&gt; invpascal(5, kind=&#39;lower&#39;, exact=False)</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">    array([[ 1., -0.,  0., -0.,  0.],</span></div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral">           [-1.,  1., -0.,  0., -0.],</span></div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral">           [ 1., -2.,  1., -0.,  0.],</span></div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral">           [-1.,  3., -3.,  1., -0.],</span></div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral">           [ 1., -4.,  6., -4.,  1.]])</span></div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  934</span>    <span class="keyword">from</span> <a class="code hl_namespace" href="namespacescipy_1_1special.html">scipy.special</a> <span class="keyword">import</span> comb</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>    <span class="keywordflow">if</span> kind <span class="keywordflow">not</span> <span class="keywordflow">in</span> [<span class="stringliteral">&#39;symmetric&#39;</span>, <span class="stringliteral">&#39;lower&#39;</span>, <span class="stringliteral">&#39;upper&#39;</span>]:</div>
<div class="line"><span class="lineno">  937</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;kind&#39; must be &#39;symmetric&#39;, &#39;lower&#39; or &#39;upper&#39;.&quot;</span>)</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>    <span class="keywordflow">if</span> kind == <span class="stringliteral">&#39;symmetric&#39;</span>:</div>
<div class="line"><span class="lineno">  940</span>        <span class="keywordflow">if</span> exact:</div>
<div class="line"><span class="lineno">  941</span>            <span class="keywordflow">if</span> n &gt; 34:</div>
<div class="line"><span class="lineno">  942</span>                dt = object</div>
<div class="line"><span class="lineno">  943</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  944</span>                dt = np.int64</div>
<div class="line"><span class="lineno">  945</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  946</span>            dt = np.float64</div>
<div class="line"><span class="lineno">  947</span>        invp = np.empty((n, n), dtype=dt)</div>
<div class="line"><span class="lineno">  948</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n):</div>
<div class="line"><span class="lineno">  949</span>            <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(0, i + 1):</div>
<div class="line"><span class="lineno">  950</span>                v = 0</div>
<div class="line"><span class="lineno">  951</span>                <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(n - i):</div>
<div class="line"><span class="lineno">  952</span>                    v += comb(i + k, k, exact=exact) * comb(i + k, i + k - j,</div>
<div class="line"><span class="lineno">  953</span>                                                            exact=exact)</div>
<div class="line"><span class="lineno">  954</span>                invp[i, j] = (-1)**(i - j) * v</div>
<div class="line"><span class="lineno">  955</span>                <span class="keywordflow">if</span> i != j:</div>
<div class="line"><span class="lineno">  956</span>                    invp[j, i] = invp[i, j]</div>
<div class="line"><span class="lineno">  957</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  958</span>        <span class="comment"># For the &#39;lower&#39; and &#39;upper&#39; cases, we computer the inverse by</span></div>
<div class="line"><span class="lineno">  959</span>        <span class="comment"># changing the sign of every other diagonal of the pascal matrix.</span></div>
<div class="line"><span class="lineno">  960</span>        invp = pascal(n, kind=kind, exact=exact)</div>
<div class="line"><span class="lineno">  961</span>        <span class="keywordflow">if</span> invp.dtype == np.uint64:</div>
<div class="line"><span class="lineno">  962</span>            <span class="comment"># This cast from np.uint64 to int64 OK, because if `kind` is not</span></div>
<div class="line"><span class="lineno">  963</span>            <span class="comment"># &quot;symmetric&quot;, the values in invp are all much less than 2**63.</span></div>
<div class="line"><span class="lineno">  964</span>            invp = invp.view(np.int64)</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>        <span class="comment"># The toeplitz matrix has alternating bands of 1 and -1.</span></div>
<div class="line"><span class="lineno">  967</span>        invp *= toeplitz((-1)**np.arange(n)).astype(invp.dtype)</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>    <span class="keywordflow">return</span> invp</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a873011de8094c873bd302bfe61ea9284" name="a873011de8094c873bd302bfe61ea9284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a873011de8094c873bd302bfe61ea9284">&#9670;&#160;</a></span>kron()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.kron </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Kronecker product.

The result is the block matrix::

    a[0,0]*b    a[0,1]*b  ... a[0,-1]*b
    a[1,0]*b    a[1,1]*b  ... a[1,-1]*b
    ...
    a[-1,0]*b   a[-1,1]*b ... a[-1,-1]*b

Parameters
----------
a : (M, N) ndarray
    Input array
b : (P, Q) ndarray
    Input array

Returns
-------
A : (M*P, N*Q) ndarray
    Kronecker product of `a` and `b`.

Examples
--------
&gt;&gt;&gt; from numpy import array
&gt;&gt;&gt; from scipy.linalg import kron
&gt;&gt;&gt; kron(array([[1,2],[3,4]]), array([[1,1,1]]))
array([[1, 1, 1, 2, 2, 2],
       [3, 3, 3, 4, 4, 4]])</pre> <div class="fragment"><div class="line"><span class="lineno">  429</span><span class="keyword">def </span>kron(a, b):</div>
<div class="line"><span class="lineno">  430</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">    Kronecker product.</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    The result is the block matrix::</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">        a[0,0]*b    a[0,1]*b  ... a[0,-1]*b</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">        a[1,0]*b    a[1,1]*b  ... a[1,-1]*b</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">        ...</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">        a[-1,0]*b   a[-1,1]*b ... a[-1,-1]*b</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    a : (M, N) ndarray</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">        Input array</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">    b : (P, Q) ndarray</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">        Input array</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral">    A : (M*P, N*Q) ndarray</span></div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">        Kronecker product of `a` and `b`.</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral">    &gt;&gt;&gt; from numpy import array</span></div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import kron</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral">    &gt;&gt;&gt; kron(array([[1,2],[3,4]]), array([[1,1,1]]))</span></div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">    array([[1, 1, 1, 2, 2, 2],</span></div>
<div class="line"><span class="lineno">  458</span><span class="stringliteral">           [3, 3, 3, 4, 4, 4]])</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> a.flags[<span class="stringliteral">&#39;CONTIGUOUS&#39;</span>]:</div>
<div class="line"><span class="lineno">  462</span>        a = np.reshape(a, a.shape)</div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> b.flags[<span class="stringliteral">&#39;CONTIGUOUS&#39;</span>]:</div>
<div class="line"><span class="lineno">  464</span>        b = np.reshape(b, b.shape)</div>
<div class="line"><span class="lineno">  465</span>    o = np.outer(a, b)</div>
<div class="line"><span class="lineno">  466</span>    o = o.reshape(a.shape + b.shape)</div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">return</span> np.concatenate(np.concatenate(o, axis=1), axis=1)</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0a31d0a2fb9751f80187a3c496246f0" name="ac0a31d0a2fb9751f80187a3c496246f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0a31d0a2fb9751f80187a3c496246f0">&#9670;&#160;</a></span>leslie()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.leslie </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a Leslie matrix.

Given the length n array of fecundity coefficients `f` and the length
n-1 array of survival coefficients `s`, return the associated Leslie
matrix.

Parameters
----------
f : (N,) array_like
    The "fecundity" coefficients.
s : (N-1,) array_like
    The "survival" coefficients, has to be 1-D.  The length of `s`
    must be one less than the length of `f`, and it must be at least 1.

Returns
-------
L : (N, N) ndarray
    The array is zero except for the first row,
    which is `f`, and the first sub-diagonal, which is `s`.
    The data-type of the array will be the data-type of ``f[0]+s[0]``.

Notes
-----
.. versionadded:: 0.8.0

The Leslie matrix is used to model discrete-time, age-structured
population growth [1]_ [2]_. In a population with `n` age classes, two sets
of parameters define a Leslie matrix: the `n` "fecundity coefficients",
which give the number of offspring per-capita produced by each age
class, and the `n` - 1 "survival coefficients", which give the
per-capita survival rate of each age class.

References
----------
.. [1] P. H. Leslie, On the use of matrices in certain population
       mathematics, Biometrika, Vol. 33, No. 3, 183--212 (Nov. 1945)
.. [2] P. H. Leslie, Some further notes on the use of matrices in
       population mathematics, Biometrika, Vol. 35, No. 3/4, 213--245
       (Dec. 1948)

Examples
--------
&gt;&gt;&gt; from scipy.linalg import leslie
&gt;&gt;&gt; leslie([0.1, 2.0, 1.0, 0.1], [0.2, 0.8, 0.7])
array([[ 0.1,  2. ,  1. ,  0.1],
       [ 0.2,  0. ,  0. ,  0. ],
       [ 0. ,  0.8,  0. ,  0. ],
       [ 0. ,  0. ,  0.7,  0. ]])</pre> <div class="fragment"><div class="line"><span class="lineno">  357</span><span class="keyword">def </span>leslie(f, s):</div>
<div class="line"><span class="lineno">  358</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    Create a Leslie matrix.</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">    Given the length n array of fecundity coefficients `f` and the length</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">    n-1 array of survival coefficients `s`, return the associated Leslie</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">    matrix.</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    f : (N,) array_like</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">        The &quot;fecundity&quot; coefficients.</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">    s : (N-1,) array_like</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">        The &quot;survival&quot; coefficients, has to be 1-D.  The length of `s`</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">        must be one less than the length of `f`, and it must be at least 1.</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">    L : (N, N) ndarray</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">        The array is zero except for the first row,</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">        which is `f`, and the first sub-diagonal, which is `s`.</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">        The data-type of the array will be the data-type of ``f[0]+s[0]``.</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">    .. versionadded:: 0.8.0</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">    The Leslie matrix is used to model discrete-time, age-structured</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">    population growth [1]_ [2]_. In a population with `n` age classes, two sets</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">    of parameters define a Leslie matrix: the `n` &quot;fecundity coefficients&quot;,</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">    which give the number of offspring per-capita produced by each age</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">    class, and the `n` - 1 &quot;survival coefficients&quot;, which give the</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">    per-capita survival rate of each age class.</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    .. [1] P. H. Leslie, On the use of matrices in certain population</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">           mathematics, Biometrika, Vol. 33, No. 3, 183--212 (Nov. 1945)</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    .. [2] P. H. Leslie, Some further notes on the use of matrices in</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">           population mathematics, Biometrika, Vol. 35, No. 3/4, 213--245</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">           (Dec. 1948)</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import leslie</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">    &gt;&gt;&gt; leslie([0.1, 2.0, 1.0, 0.1], [0.2, 0.8, 0.7])</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">    array([[ 0.1,  2. ,  1. ,  0.1],</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">           [ 0.2,  0. ,  0. ,  0. ],</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">           [ 0. ,  0.8,  0. ,  0. ],</span></div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral">           [ 0. ,  0. ,  0.7,  0. ]])</span></div>
<div class="line"><span class="lineno">  407</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  408</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  409</span>    f = np.atleast_1d(f)</div>
<div class="line"><span class="lineno">  410</span>    s = np.atleast_1d(s)</div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordflow">if</span> f.ndim != 1:</div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Incorrect shape for f.  f must be 1D&quot;</span>)</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">if</span> s.ndim != 1:</div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Incorrect shape for s.  s must be 1D&quot;</span>)</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">if</span> f.size != s.size + 1:</div>
<div class="line"><span class="lineno">  416</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Incorrect lengths for f and s.  The length&quot;</span></div>
<div class="line"><span class="lineno">  417</span>                         <span class="stringliteral">&quot; of s must be one less than the length of f.&quot;</span>)</div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">if</span> s.size == 0:</div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The length of s must be at least 1.&quot;</span>)</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>    tmp = f[0] + s[0]</div>
<div class="line"><span class="lineno">  422</span>    n = f.size</div>
<div class="line"><span class="lineno">  423</span>    a = np.zeros((n, n), dtype=tmp.dtype)</div>
<div class="line"><span class="lineno">  424</span>    a[0] = f</div>
<div class="line"><span class="lineno">  425</span>    a[list(range(1, n)), list(range(0, n - 1))] = s</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">return</span> a</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac723ea273038dbe546e0fe83a0b9ae47" name="ac723ea273038dbe546e0fe83a0b9ae47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac723ea273038dbe546e0fe83a0b9ae47">&#9670;&#160;</a></span>pascal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.pascal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kind</em> = <code>'symmetric'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exact</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the n x n Pascal matrix.

The Pascal matrix is a matrix containing the binomial coefficients as
its elements.

Parameters
----------
n : int
    The size of the matrix to create; that is, the result is an n x n
    matrix.
kind : str, optional
    Must be one of 'symmetric', 'lower', or 'upper'.
    Default is 'symmetric'.
exact : bool, optional
    If `exact` is True, the result is either an array of type
    numpy.uint64 (if n &lt; 35) or an object array of Python long integers.
    If `exact` is False, the coefficients in the matrix are computed using
    `scipy.special.comb` with `exact=False`. The result will be a floating
    point array, and the values in the array will not be the exact
    coefficients, but this version is much faster than `exact=True`.

Returns
-------
p : (n, n) ndarray
    The Pascal matrix.

See Also
--------
invpascal

Notes
-----
See https://en.wikipedia.org/wiki/Pascal_matrix for more information
about Pascal matrices.

.. versionadded:: 0.11.0

Examples
--------
&gt;&gt;&gt; from scipy.linalg import pascal
&gt;&gt;&gt; pascal(4)
array([[ 1,  1,  1,  1],
       [ 1,  2,  3,  4],
       [ 1,  3,  6, 10],
       [ 1,  4, 10, 20]], dtype=uint64)
&gt;&gt;&gt; pascal(4, kind='lower')
array([[1, 0, 0, 0],
       [1, 1, 0, 0],
       [1, 2, 1, 0],
       [1, 3, 3, 1]], dtype=uint64)
&gt;&gt;&gt; pascal(50)[-1, -1]
25477612258980856902730428600
&gt;&gt;&gt; from scipy.special import comb
&gt;&gt;&gt; comb(98, 49, exact=True)
25477612258980856902730428600</pre> <div class="fragment"><div class="line"><span class="lineno">  776</span><span class="keyword">def </span>pascal(n, kind=&#39;symmetric&#39;, exact=True):</div>
<div class="line"><span class="lineno">  777</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  778</span><span class="stringliteral">    Returns the n x n Pascal matrix.</span></div>
<div class="line"><span class="lineno">  779</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  780</span><span class="stringliteral">    The Pascal matrix is a matrix containing the binomial coefficients as</span></div>
<div class="line"><span class="lineno">  781</span><span class="stringliteral">    its elements.</span></div>
<div class="line"><span class="lineno">  782</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  783</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  784</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  785</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  786</span><span class="stringliteral">        The size of the matrix to create; that is, the result is an n x n</span></div>
<div class="line"><span class="lineno">  787</span><span class="stringliteral">        matrix.</span></div>
<div class="line"><span class="lineno">  788</span><span class="stringliteral">    kind : str, optional</span></div>
<div class="line"><span class="lineno">  789</span><span class="stringliteral">        Must be one of &#39;symmetric&#39;, &#39;lower&#39;, or &#39;upper&#39;.</span></div>
<div class="line"><span class="lineno">  790</span><span class="stringliteral">        Default is &#39;symmetric&#39;.</span></div>
<div class="line"><span class="lineno">  791</span><span class="stringliteral">    exact : bool, optional</span></div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral">        If `exact` is True, the result is either an array of type</span></div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">        numpy.uint64 (if n &lt; 35) or an object array of Python long integers.</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral">        If `exact` is False, the coefficients in the matrix are computed using</span></div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral">        `scipy.special.comb` with `exact=False`. The result will be a floating</span></div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">        point array, and the values in the array will not be the exact</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">        coefficients, but this version is much faster than `exact=True`.</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  799</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  800</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  801</span><span class="stringliteral">    p : (n, n) ndarray</span></div>
<div class="line"><span class="lineno">  802</span><span class="stringliteral">        The Pascal matrix.</span></div>
<div class="line"><span class="lineno">  803</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  804</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  805</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  806</span><span class="stringliteral">    invpascal</span></div>
<div class="line"><span class="lineno">  807</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  808</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  809</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  810</span><span class="stringliteral">    See https://en.wikipedia.org/wiki/Pascal_matrix for more information</span></div>
<div class="line"><span class="lineno">  811</span><span class="stringliteral">    about Pascal matrices.</span></div>
<div class="line"><span class="lineno">  812</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  813</span><span class="stringliteral">    .. versionadded:: 0.11.0</span></div>
<div class="line"><span class="lineno">  814</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import pascal</span></div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">    &gt;&gt;&gt; pascal(4)</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral">    array([[ 1,  1,  1,  1],</span></div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral">           [ 1,  2,  3,  4],</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">           [ 1,  3,  6, 10],</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">           [ 1,  4, 10, 20]], dtype=uint64)</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">    &gt;&gt;&gt; pascal(4, kind=&#39;lower&#39;)</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">    array([[1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">           [1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  826</span><span class="stringliteral">           [1, 2, 1, 0],</span></div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral">           [1, 3, 3, 1]], dtype=uint64)</span></div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral">    &gt;&gt;&gt; pascal(50)[-1, -1]</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">    25477612258980856902730428600</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.special import comb</span></div>
<div class="line"><span class="lineno">  831</span><span class="stringliteral">    &gt;&gt;&gt; comb(98, 49, exact=True)</span></div>
<div class="line"><span class="lineno">  832</span><span class="stringliteral">    25477612258980856902730428600</span></div>
<div class="line"><span class="lineno">  833</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  834</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>    <span class="keyword">from</span> <a class="code hl_namespace" href="namespacescipy_1_1special.html">scipy.special</a> <span class="keyword">import</span> comb</div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">if</span> kind <span class="keywordflow">not</span> <span class="keywordflow">in</span> [<span class="stringliteral">&#39;symmetric&#39;</span>, <span class="stringliteral">&#39;lower&#39;</span>, <span class="stringliteral">&#39;upper&#39;</span>]:</div>
<div class="line"><span class="lineno">  838</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;kind must be &#39;symmetric&#39;, &#39;lower&#39;, or &#39;upper&#39;&quot;</span>)</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">if</span> exact:</div>
<div class="line"><span class="lineno">  841</span>        <span class="keywordflow">if</span> n &gt;= 35:</div>
<div class="line"><span class="lineno">  842</span>            L_n = np.empty((n, n), dtype=object)</div>
<div class="line"><span class="lineno">  843</span>            L_n.fill(0)</div>
<div class="line"><span class="lineno">  844</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  845</span>            L_n = np.zeros((n, n), dtype=np.uint64)</div>
<div class="line"><span class="lineno">  846</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n):</div>
<div class="line"><span class="lineno">  847</span>            <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(i + 1):</div>
<div class="line"><span class="lineno">  848</span>                L_n[i, j] = comb(i, j, exact=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  849</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  850</span>        L_n = comb(*np.ogrid[:n, :n])</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>    <span class="keywordflow">if</span> kind == <span class="stringliteral">&#39;lower&#39;</span>:</div>
<div class="line"><span class="lineno">  853</span>        p = L_n</div>
<div class="line"><span class="lineno">  854</span>    <span class="keywordflow">elif</span> kind == <span class="stringliteral">&#39;upper&#39;</span>:</div>
<div class="line"><span class="lineno">  855</span>        p = L_n.T</div>
<div class="line"><span class="lineno">  856</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  857</span>        p = np.dot(L_n, L_n.T)</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordflow">return</span> p</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a804e14de09dc0496e3975329dd059e83" name="a804e14de09dc0496e3975329dd059e83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804e14de09dc0496e3975329dd059e83">&#9670;&#160;</a></span>toeplitz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.toeplitz </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct a Toeplitz matrix.

The Toeplitz matrix has constant diagonals, with c as its first column
and r as its first row. If r is not given, ``r == conjugate(c)`` is
assumed.

Parameters
----------
c : array_like
    First column of the matrix.  Whatever the actual shape of `c`, it
    will be converted to a 1-D array.
r : array_like, optional
    First row of the matrix. If None, ``r = conjugate(c)`` is assumed;
    in this case, if c[0] is real, the result is a Hermitian matrix.
    r[0] is ignored; the first row of the returned matrix is
    ``[c[0], r[1:]]``.  Whatever the actual shape of `r`, it will be
    converted to a 1-D array.

Returns
-------
A : (len(c), len(r)) ndarray
    The Toeplitz matrix. Dtype is the same as ``(c[0] + r[0]).dtype``.

See Also
--------
circulant : circulant matrix
hankel : Hankel matrix
solve_toeplitz : Solve a Toeplitz system.

Notes
-----
The behavior when `c` or `r` is a scalar, or when `c` is complex and
`r` is None, was changed in version 0.8.0. The behavior in previous
versions was undocumented and is no longer supported.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import toeplitz
&gt;&gt;&gt; toeplitz([1,2,3], [1,4,5,6])
array([[1, 4, 5, 6],
       [2, 1, 4, 5],
       [3, 2, 1, 4]])
&gt;&gt;&gt; toeplitz([1.0, 2+3j, 4-1j])
array([[ 1.+0.j,  2.-3.j,  4.+1.j],
       [ 2.+3.j,  1.+0.j,  2.-3.j],
       [ 4.-1.j,  2.+3.j,  1.+0.j]])</pre> <div class="fragment"><div class="line"><span class="lineno">  139</span><span class="keyword">def </span>toeplitz(c, r=None):</div>
<div class="line"><span class="lineno">  140</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    Construct a Toeplitz matrix.</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    The Toeplitz matrix has constant diagonals, with c as its first column</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    and r as its first row. If r is not given, ``r == conjugate(c)`` is</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    assumed.</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    c : array_like</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        First column of the matrix.  Whatever the actual shape of `c`, it</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">        will be converted to a 1-D array.</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    r : array_like, optional</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">        First row of the matrix. If None, ``r = conjugate(c)`` is assumed;</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">        in this case, if c[0] is real, the result is a Hermitian matrix.</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">        r[0] is ignored; the first row of the returned matrix is</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">        ``[c[0], r[1:]]``.  Whatever the actual shape of `r`, it will be</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">        converted to a 1-D array.</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    A : (len(c), len(r)) ndarray</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">        The Toeplitz matrix. Dtype is the same as ``(c[0] + r[0]).dtype``.</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">    circulant : circulant matrix</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">    hankel : Hankel matrix</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">    solve_toeplitz : Solve a Toeplitz system.</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">    The behavior when `c` or `r` is a scalar, or when `c` is complex and</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">    `r` is None, was changed in version 0.8.0. The behavior in previous</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">    versions was undocumented and is no longer supported.</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import toeplitz</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">    &gt;&gt;&gt; toeplitz([1,2,3], [1,4,5,6])</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    array([[1, 4, 5, 6],</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">           [2, 1, 4, 5],</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">           [3, 2, 1, 4]])</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">    &gt;&gt;&gt; toeplitz([1.0, 2+3j, 4-1j])</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    array([[ 1.+0.j,  2.-3.j,  4.+1.j],</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">           [ 2.+3.j,  1.+0.j,  2.-3.j],</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">           [ 4.-1.j,  2.+3.j,  1.+0.j]])</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  189</span>    c = np.asarray(c).ravel()</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">if</span> r <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  191</span>        r = c.conjugate()</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  193</span>        r = np.asarray(r).ravel()</div>
<div class="line"><span class="lineno">  194</span>    <span class="comment"># Form a 1-D array containing a reversed c followed by r[1:] that could be</span></div>
<div class="line"><span class="lineno">  195</span>    <span class="comment"># strided to give us toeplitz matrix.</span></div>
<div class="line"><span class="lineno">  196</span>    vals = np.concatenate((c[::-1], r[1:]))</div>
<div class="line"><span class="lineno">  197</span>    out_shp = len(c), len(r)</div>
<div class="line"><span class="lineno">  198</span>    n = vals.strides[0]</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">return</span> as_strided(vals[len(c)-1:], shape=out_shp, strides=(-n, n)).copy()</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adbf1d041cdb29a518a9cc4156563d9fb" name="adbf1d041cdb29a518a9cc4156563d9fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbf1d041cdb29a518a9cc4156563d9fb">&#9670;&#160;</a></span>tri()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.tri </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>M</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct (N, M) matrix filled with ones at and below the kth diagonal.

The matrix has A[i,j] == 1 for j &lt;= i + k

Parameters
----------
N : int
    The size of the first dimension of the matrix.
M : int or None, optional
    The size of the second dimension of the matrix. If `M` is None,
    `M = N` is assumed.
k : int, optional
    Number of subdiagonal below which matrix is filled with ones.
    `k` = 0 is the main diagonal, `k` &lt; 0 subdiagonal and `k` &gt; 0
    superdiagonal.
dtype : dtype, optional
    Data type of the matrix.

Returns
-------
tri : (N, M) ndarray
    Tri matrix.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import tri
&gt;&gt;&gt; tri(3, 5, 2, dtype=int)
array([[1, 1, 1, 0, 0],
       [1, 1, 1, 1, 0],
       [1, 1, 1, 1, 1]])
&gt;&gt;&gt; tri(3, 5, -1, dtype=int)
array([[0, 0, 0, 0, 0],
       [1, 0, 0, 0, 0],
       [1, 1, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno">   20</span><span class="keyword">def </span>tri(N, M=None, k=0, dtype=None):</div>
<div class="line"><span class="lineno">   21</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral">    Construct (N, M) matrix filled with ones at and below the kth diagonal.</span></div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   24</span><span class="stringliteral">    The matrix has A[i,j] == 1 for j &lt;= i + k</span></div>
<div class="line"><span class="lineno">   25</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">        The size of the first dimension of the matrix.</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    M : int or None, optional</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">        The size of the second dimension of the matrix. If `M` is None,</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">        `M = N` is assumed.</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral">    k : int, optional</span></div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">        Number of subdiagonal below which matrix is filled with ones.</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">        `k` = 0 is the main diagonal, `k` &lt; 0 subdiagonal and `k` &gt; 0</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">        superdiagonal.</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    dtype : dtype, optional</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">        Data type of the matrix.</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">    tri : (N, M) ndarray</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">        Tri matrix.</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import tri</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    &gt;&gt;&gt; tri(3, 5, 2, dtype=int)</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    array([[1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">           [1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">           [1, 1, 1, 1, 1]])</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    &gt;&gt;&gt; tri(3, 5, -1, dtype=int)</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">           [1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">           [1, 1, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">if</span> M <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   59</span>        M = N</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">if</span> isinstance(M, str):</div>
<div class="line"><span class="lineno">   61</span>        <span class="comment"># pearu: any objections to remove this feature?</span></div>
<div class="line"><span class="lineno">   62</span>        <span class="comment">#       As tri(N,&#39;d&#39;) is equivalent to tri(N,dtype=&#39;d&#39;)</span></div>
<div class="line"><span class="lineno">   63</span>        dtype = M</div>
<div class="line"><span class="lineno">   64</span>        M = N</div>
<div class="line"><span class="lineno">   65</span>    m = np.greater_equal.outer(np.arange(k, N+k), np.arange(M))</div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">if</span> dtype <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">return</span> m</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   69</span>        <span class="keywordflow">return</span> m.astype(dtype)</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e9df53d999e3af2182cfee51b697af2" name="a5e9df53d999e3af2182cfee51b697af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e9df53d999e3af2182cfee51b697af2">&#9670;&#160;</a></span>tril()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.tril </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make a copy of a matrix with elements above the kth diagonal zeroed.

Parameters
----------
m : array_like
    Matrix whose elements to return
k : int, optional
    Diagonal above which to zero elements.
    `k` == 0 is the main diagonal, `k` &lt; 0 subdiagonal and
    `k` &gt; 0 superdiagonal.

Returns
-------
tril : ndarray
    Return is the same shape and type as `m`.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import tril
&gt;&gt;&gt; tril([[1,2,3],[4,5,6],[7,8,9],[10,11,12]], -1)
array([[ 0,  0,  0],
       [ 4,  0,  0],
       [ 7,  8,  0],
       [10, 11, 12]])</pre> <div class="fragment"><div class="line"><span class="lineno">   72</span><span class="keyword">def </span>tril(m, k=0):</div>
<div class="line"><span class="lineno">   73</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">    Make a copy of a matrix with elements above the kth diagonal zeroed.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">    m : array_like</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">        Matrix whose elements to return</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    k : int, optional</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">        Diagonal above which to zero elements.</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">        `k` == 0 is the main diagonal, `k` &lt; 0 subdiagonal and</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">        `k` &gt; 0 superdiagonal.</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">    tril : ndarray</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">        Return is the same shape and type as `m`.</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import tril</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    &gt;&gt;&gt; tril([[1,2,3],[4,5,6],[7,8,9],[10,11,12]], -1)</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    array([[ 0,  0,  0],</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">           [ 4,  0,  0],</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">           [ 7,  8,  0],</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">           [10, 11, 12]])</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  100</span>    m = np.asarray(m)</div>
<div class="line"><span class="lineno">  101</span>    out = tri(m.shape[0], m.shape[1], k=k, dtype=m.dtype.char) * m</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">return</span> out</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aef9793e4c7a01acf622dbf785e15cc45" name="aef9793e4c7a01acf622dbf785e15cc45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef9793e4c7a01acf622dbf785e15cc45">&#9670;&#160;</a></span>triu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._special_matrices.triu </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make a copy of a matrix with elements below the kth diagonal zeroed.

Parameters
----------
m : array_like
    Matrix whose elements to return
k : int, optional
    Diagonal below which to zero elements.
    `k` == 0 is the main diagonal, `k` &lt; 0 subdiagonal and
    `k` &gt; 0 superdiagonal.

Returns
-------
triu : ndarray
    Return matrix with zeroed elements below the kth diagonal and has
    same shape and type as `m`.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import triu
&gt;&gt;&gt; triu([[1,2,3],[4,5,6],[7,8,9],[10,11,12]], -1)
array([[ 1,  2,  3],
       [ 4,  5,  6],
       [ 0,  8,  9],
       [ 0,  0, 12]])</pre> <div class="fragment"><div class="line"><span class="lineno">  105</span><span class="keyword">def </span>triu(m, k=0):</div>
<div class="line"><span class="lineno">  106</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    Make a copy of a matrix with elements below the kth diagonal zeroed.</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">    m : array_like</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">        Matrix whose elements to return</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    k : int, optional</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">        Diagonal below which to zero elements.</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">        `k` == 0 is the main diagonal, `k` &lt; 0 subdiagonal and</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">        `k` &gt; 0 superdiagonal.</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    triu : ndarray</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">        Return matrix with zeroed elements below the kth diagonal and has</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">        same shape and type as `m`.</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import triu</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    &gt;&gt;&gt; triu([[1,2,3],[4,5,6],[7,8,9],[10,11,12]], -1)</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    array([[ 1,  2,  3],</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">           [ 4,  5,  6],</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">           [ 0,  8,  9],</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">           [ 0,  0, 12]])</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  134</span>    m = np.asarray(m)</div>
<div class="line"><span class="lineno">  135</span>    out = (1 - tri(m.shape[0], m.shape[1], k - 1, m.dtype.char)) * m</div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordflow">return</span> out</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
