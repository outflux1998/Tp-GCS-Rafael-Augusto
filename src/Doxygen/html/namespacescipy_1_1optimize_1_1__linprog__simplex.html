<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._linprog_simplex Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__simplex.html">_linprog_simplex</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._linprog_simplex Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aba6b18052ebfd1a832e2c9339f7d8a99" id="r_aba6b18052ebfd1a832e2c9339f7d8a99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__simplex.html#aba6b18052ebfd1a832e2c9339f7d8a99">_pivot_col</a> (T, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-9, bland=False)</td></tr>
<tr class="separator:aba6b18052ebfd1a832e2c9339f7d8a99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a553695a9730b61be2d460bbceba39" id="r_ae6a553695a9730b61be2d460bbceba39"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__simplex.html#ae6a553695a9730b61be2d460bbceba39">_pivot_row</a> (T, basis, pivcol, phase, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-9, bland=False)</td></tr>
<tr class="separator:ae6a553695a9730b61be2d460bbceba39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a451a316e3cf19e7ba8fdd115fbe3c224" id="r_a451a316e3cf19e7ba8fdd115fbe3c224"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__simplex.html#a451a316e3cf19e7ba8fdd115fbe3c224">_apply_pivot</a> (T, basis, pivrow, pivcol, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-9)</td></tr>
<tr class="separator:a451a316e3cf19e7ba8fdd115fbe3c224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a0d3370a00881877837fe411378baf1" id="r_a0a0d3370a00881877837fe411378baf1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__simplex.html#a0a0d3370a00881877837fe411378baf1">_solve_simplex</a> (T, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, basis, callback, postsolve_args, maxiter=1000, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-9, phase=2, bland=False, nit0=0)</td></tr>
<tr class="separator:a0a0d3370a00881877837fe411378baf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04dd95e8296519f04725974a0844cf15" id="r_a04dd95e8296519f04725974a0844cf15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__simplex.html#a04dd95e8296519f04725974a0844cf15">_linprog_simplex</a> (c, c0, A, b, callback, postsolve_args, maxiter=1000, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-9, disp=False, bland=False, **unknown_options)</td></tr>
<tr class="separator:a04dd95e8296519f04725974a0844cf15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Simplex method for  linear programming

The *simplex* method uses a traditional, full-tableau implementation of
Dantzig's simplex algorithm [1]_, [2]_ (*not* the Nelder-Mead simplex).
This algorithm is included for backwards compatibility and educational
purposes.

    .. versionadded:: 0.15.0

Warnings
--------

The simplex method may encounter numerical difficulties when pivot
values are close to the specified tolerance. If encountered try
remove any redundant constraints, change the pivot strategy to Bland's
rule or increase the tolerance value.

Alternatively, more robust methods maybe be used. See
:ref:`'interior-point' &lt;optimize.linprog-interior-point&gt;` and
:ref:`'revised simplex' &lt;optimize.linprog-revised_simplex&gt;`.

References
----------
.. [1] Dantzig, George B., Linear programming and extensions. Rand
       Corporation Research Study Princeton Univ. Press, Princeton, NJ,
       1963
.. [2] Hillier, S.H. and Lieberman, G.J. (1995), "Introduction to
       Mathematical Programming", McGraw-Hill, Chapter 4.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a451a316e3cf19e7ba8fdd115fbe3c224" name="a451a316e3cf19e7ba8fdd115fbe3c224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a451a316e3cf19e7ba8fdd115fbe3c224">&#9670;&#160;</a></span>_apply_pivot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_simplex._apply_pivot </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pivrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pivcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Pivot the simplex tableau inplace on the element given by (pivrow, pivol).
The entering variable corresponds to the column given by pivcol forcing
the variable basis[pivrow] to leave the basis.

Parameters
----------
T : 2-D array
    A 2-D array representing the simplex tableau, T, corresponding to the
    linear programming problem. It should have the form:

    [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
     [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
     .
     .
     .
     [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
     [c[0],   c[1], ...,   c[n_total],    0]]

    for a Phase 2 problem, or the form:

    [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
     [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
     .
     .
     .
     [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
     [c[0],   c[1], ...,   c[n_total],   0],
     [c'[0],  c'[1], ...,  c'[n_total],  0]]

     for a Phase 1 problem (a problem in which a basic feasible solution is
     sought prior to maximizing the actual objective. ``T`` is modified in
     place by ``_solve_simplex``.
basis : 1-D array
    An array of the indices of the basic variables, such that basis[i]
    contains the column corresponding to the basic variable for row i.
    Basis is modified in place by _apply_pivot.
pivrow : int
    Row index of the pivot.
pivcol : int
    Column index of the pivot.
</pre> <div class="fragment"><div class="line"><span class="lineno">  169</span><span class="keyword">def </span>_apply_pivot(T, basis, pivrow, pivcol, tol=1e-9):</div>
<div class="line"><span class="lineno">  170</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">    Pivot the simplex tableau inplace on the element given by (pivrow, pivol).</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">    The entering variable corresponds to the column given by pivcol forcing</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">    the variable basis[pivrow] to leave the basis.</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">    T : 2-D array</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">        A 2-D array representing the simplex tableau, T, corresponding to the</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">        linear programming problem. It should have the form:</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">         [c[0],   c[1], ...,   c[n_total],    0]]</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">        for a Phase 2 problem, or the form:</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">         [c[0],   c[1], ...,   c[n_total],   0],</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">         [c&#39;[0],  c&#39;[1], ...,  c&#39;[n_total],  0]]</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">         for a Phase 1 problem (a problem in which a basic feasible solution is</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">         sought prior to maximizing the actual objective. ``T`` is modified in</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">         place by ``_solve_simplex``.</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">    basis : 1-D array</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">        An array of the indices of the basic variables, such that basis[i]</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">        contains the column corresponding to the basic variable for row i.</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">        Basis is modified in place by _apply_pivot.</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    pivrow : int</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">        Row index of the pivot.</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    pivcol : int</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">        Column index of the pivot.</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  212</span>    basis[pivrow] = pivcol</div>
<div class="line"><span class="lineno">  213</span>    pivval = T[pivrow, pivcol]</div>
<div class="line"><span class="lineno">  214</span>    T[pivrow] = T[pivrow] / pivval</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">for</span> irow <span class="keywordflow">in</span> range(T.shape[0]):</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">if</span> irow != pivrow:</div>
<div class="line"><span class="lineno">  217</span>            T[irow] = T[irow] - T[pivrow] * T[irow, pivcol]</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>    <span class="comment"># The selected pivot should never lead to a pivot value less than the tol.</span></div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">if</span> np.isclose(pivval, tol, atol=0, rtol=1e4):</div>
<div class="line"><span class="lineno">  221</span>        message = (</div>
<div class="line"><span class="lineno">  222</span>            <span class="stringliteral">&quot;The pivot operation produces a pivot value of:{0: .1e}, &quot;</span></div>
<div class="line"><span class="lineno">  223</span>            <span class="stringliteral">&quot;which is only slightly greater than the specified &quot;</span></div>
<div class="line"><span class="lineno">  224</span>            <span class="stringliteral">&quot;tolerance{1: .1e}. This may lead to issues regarding the &quot;</span></div>
<div class="line"><span class="lineno">  225</span>            <span class="stringliteral">&quot;numerical stability of the simplex method. &quot;</span></div>
<div class="line"><span class="lineno">  226</span>            <span class="stringliteral">&quot;Removing redundant constraints, changing the pivot strategy &quot;</span></div>
<div class="line"><span class="lineno">  227</span>            <span class="stringliteral">&quot;via Bland&#39;s rule or increasing the tolerance may &quot;</span></div>
<div class="line"><span class="lineno">  228</span>            <span class="stringliteral">&quot;help reduce the issue.&quot;</span>.format(pivval, tol))</div>
<div class="line"><span class="lineno">  229</span>        warn(message, OptimizeWarning, stacklevel=5)</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a04dd95e8296519f04725974a0844cf15" name="a04dd95e8296519f04725974a0844cf15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04dd95e8296519f04725974a0844cf15">&#9670;&#160;</a></span>_linprog_simplex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_simplex._linprog_simplex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bland</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimize a linear objective function subject to linear equality and
non-negativity constraints using the two phase simplex method.
Linear programming is intended to solve problems of the following form:

Minimize::

    c @ x

Subject to::

    A @ x == b
        x &gt;= 0

User-facing documentation is in _linprog_doc.py.

Parameters
----------
c : 1-D array
    Coefficients of the linear objective function to be minimized.
c0 : float
    Constant term in objective function due to fixed (and eliminated)
    variables. (Purely for display.)
A : 2-D array
    2-D array such that ``A @ x``, gives the values of the equality
    constraints at ``x``.
b : 1-D array
    1-D array of values representing the right hand side of each equality
    constraint (row) in ``A``.
callback : callable, optional
    If a callback function is provided, it will be called within each
    iteration of the algorithm. The callback function must accept a single
    `scipy.optimize.OptimizeResult` consisting of the following fields:

        x : 1-D array
            Current solution vector
        fun : float
            Current value of the objective function
        success : bool
            True when an algorithm has completed successfully.
        slack : 1-D array
            The values of the slack variables. Each slack variable
            corresponds to an inequality constraint. If the slack is zero,
            the corresponding constraint is active.
        con : 1-D array
            The (nominally zero) residuals of the equality constraints,
            that is, ``b - A_eq @ x``
        phase : int
            The phase of the algorithm being executed.
        status : int
            An integer representing the status of the optimization::

                 0 : Algorithm proceeding nominally
                 1 : Iteration limit reached
                 2 : Problem appears to be infeasible
                 3 : Problem appears to be unbounded
                 4 : Serious numerical difficulties encountered
        nit : int
            The number of iterations performed.
        message : str
            A string descriptor of the exit status of the optimization.
postsolve_args : tuple
    Data needed by _postsolve to convert the solution to the standard-form
    problem into the solution to the original problem.

Options
-------
maxiter : int
   The maximum number of iterations to perform.
disp : bool
    If True, print exit status message to sys.stdout
tol : float
    The tolerance which determines when a solution is "close enough" to
    zero in Phase 1 to be considered a basic feasible solution or close
    enough to positive to serve as an optimal solution.
bland : bool
    If True, use Bland's anti-cycling rule [3]_ to choose pivots to
    prevent cycling. If False, choose pivots which should lead to a
    converged solution more quickly. The latter method is subject to
    cycling (non-convergence) in rare instances.
unknown_options : dict
    Optional arguments not used by this particular solver. If
    `unknown_options` is non-empty a warning is issued listing all
    unused options.

Returns
-------
x : 1-D array
    Solution vector.
status : int
    An integer representing the exit status of the optimization::

     0 : Optimization terminated successfully
     1 : Iteration limit reached
     2 : Problem appears to be infeasible
     3 : Problem appears to be unbounded
     4 : Serious numerical difficulties encountered

message : str
    A string descriptor of the exit status of the optimization.
iteration : int
    The number of iterations taken to solve the problem.

References
----------
.. [1] Dantzig, George B., Linear programming and extensions. Rand
       Corporation Research Study Princeton Univ. Press, Princeton, NJ,
       1963
.. [2] Hillier, S.H. and Lieberman, G.J. (1995), "Introduction to
       Mathematical Programming", McGraw-Hill, Chapter 4.
.. [3] Bland, Robert G. New finite pivoting rules for the simplex method.
       Mathematics of Operations Research (2), 1977: pp. 103-107.


Notes
-----
The expected problem formulation differs between the top level ``linprog``
module and the method specific solvers. The method specific solvers expect a
problem in standard form:

Minimize::

    c @ x

Subject to::

    A @ x == b
        x &gt;= 0

Whereas the top level ``linprog`` module expects a problem of form:

Minimize::

    c @ x

Subject to::

    A_ub @ x &lt;= b_ub
    A_eq @ x == b_eq
     lb &lt;= x &lt;= ub

where ``lb = 0`` and ``ub = None`` unless set in ``bounds``.

The original problem contains equality, upper-bound and variable constraints
whereas the method specific solver requires equality constraints and
variable non-negativity.

``linprog`` module converts the original problem to standard form by
converting the simple bounds to upper bound constraints, introducing
non-negative slack variables for inequality constraints, and expressing
unbounded variables as the difference between two non-negative variables.
</pre> <div class="fragment"><div class="line"><span class="lineno">  440</span>                     **unknown_options):</div>
<div class="line"><span class="lineno">  441</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    Minimize a linear objective function subject to linear equality and</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">    non-negativity constraints using the two phase simplex method.</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">    Linear programming is intended to solve problems of the following form:</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">        A @ x == b</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral">            x &gt;= 0</span></div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">    User-facing documentation is in _linprog_doc.py.</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  458</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral">    c : 1-D array</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">        Coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral">    c0 : float</span></div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">        Constant term in objective function due to fixed (and eliminated)</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral">        variables. (Purely for display.)</span></div>
<div class="line"><span class="lineno">  464</span><span class="stringliteral">    A : 2-D array</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral">        2-D array such that ``A @ x``, gives the values of the equality</span></div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">        constraints at ``x``.</span></div>
<div class="line"><span class="lineno">  467</span><span class="stringliteral">    b : 1-D array</span></div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral">        1-D array of values representing the right hand side of each equality</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">        constraint (row) in ``A``.</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">        If a callback function is provided, it will be called within each</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral">        iteration of the algorithm. The callback function must accept a single</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">        `scipy.optimize.OptimizeResult` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">            x : 1-D array</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">                Current solution vector</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">            fun : float</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">                Current value of the objective function</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">            success : bool</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">                True when an algorithm has completed successfully.</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">            slack : 1-D array</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">                The values of the slack variables. Each slack variable</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">                corresponds to an inequality constraint. If the slack is zero,</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">                the corresponding constraint is active.</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">            con : 1-D array</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">                The (nominally zero) residuals of the equality constraints,</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">                that is, ``b - A_eq @ x``</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">            phase : int</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">                The phase of the algorithm being executed.</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">            status : int</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">                An integer representing the status of the optimization::</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">                     0 : Algorithm proceeding nominally</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">                     1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">                     2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">                     3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral">                     4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">            nit : int</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">                The number of iterations performed.</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">            message : str</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">                A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">    postsolve_args : tuple</span></div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">        Data needed by _postsolve to convert the solution to the standard-form</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">        problem into the solution to the original problem.</span></div>
<div class="line"><span class="lineno">  505</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  506</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno">  509</span><span class="stringliteral">       The maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">    disp : bool</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">        If True, print exit status message to sys.stdout</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">        The tolerance which determines when a solution is &quot;close enough&quot; to</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">        zero in Phase 1 to be considered a basic feasible solution or close</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">        enough to positive to serve as an optimal solution.</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">    bland : bool</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">        If True, use Bland&#39;s anti-cycling rule [3]_ to choose pivots to</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">        prevent cycling. If False, choose pivots which should lead to a</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">        converged solution more quickly. The latter method is subject to</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">        cycling (non-convergence) in rare instances.</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">    unknown_options : dict</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">        Optional arguments not used by this particular solver. If</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">        `unknown_options` is non-empty a warning is issued listing all</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">        unused options.</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">    x : 1-D array</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">        Solution vector.</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">         0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">         1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral">         2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">         3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral">         4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral">        A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">    iteration : int</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">        The number of iterations taken to solve the problem.</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">    .. [1] Dantzig, George B., Linear programming and extensions. Rand</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">           Corporation Research Study Princeton Univ. Press, Princeton, NJ,</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">           1963</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">    .. [2] Hillier, S.H. and Lieberman, G.J. (1995), &quot;Introduction to</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">           Mathematical Programming&quot;, McGraw-Hill, Chapter 4.</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">    .. [3] Bland, Robert G. New finite pivoting rules for the simplex method.</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">           Mathematics of Operations Research (2), 1977: pp. 103-107.</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">    The expected problem formulation differs between the top level ``linprog``</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">    module and the method specific solvers. The method specific solvers expect a</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">    problem in standard form:</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">        A @ x == b</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">            x &gt;= 0</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">    Whereas the top level ``linprog`` module expects a problem of form:</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">        A_ub @ x &lt;= b_ub</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">        A_eq @ x == b_eq</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">         lb &lt;= x &lt;= ub</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">    where ``lb = 0`` and ``ub = None`` unless set in ``bounds``.</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">    The original problem contains equality, upper-bound and variable constraints</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">    whereas the method specific solver requires equality constraints and</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">    variable non-negativity.</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">    ``linprog`` module converts the original problem to standard form by</span></div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">    converting the simple bounds to upper bound constraints, introducing</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">    non-negative slack variables for inequality constraints, and expressing</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral">    unbounded variables as the difference between two non-negative variables.</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  593</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>    status = 0</div>
<div class="line"><span class="lineno">  596</span>    messages = {0: <span class="stringliteral">&quot;Optimization terminated successfully.&quot;</span>,</div>
<div class="line"><span class="lineno">  597</span>                1: <span class="stringliteral">&quot;Iteration limit reached.&quot;</span>,</div>
<div class="line"><span class="lineno">  598</span>                2: <span class="stringliteral">&quot;Optimization failed. Unable to find a feasible&quot;</span></div>
<div class="line"><span class="lineno">  599</span>                   <span class="stringliteral">&quot; starting point.&quot;</span>,</div>
<div class="line"><span class="lineno">  600</span>                3: <span class="stringliteral">&quot;Optimization failed. The problem appears to be unbounded.&quot;</span>,</div>
<div class="line"><span class="lineno">  601</span>                4: <span class="stringliteral">&quot;Optimization failed. Singular matrix encountered.&quot;</span>}</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    n, m = A.shape</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>    <span class="comment"># All constraints must have b &gt;= 0.</span></div>
<div class="line"><span class="lineno">  606</span>    is_negative_constraint = np.less(b, 0)</div>
<div class="line"><span class="lineno">  607</span>    A[is_negative_constraint] *= -1</div>
<div class="line"><span class="lineno">  608</span>    b[is_negative_constraint] *= -1</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>    <span class="comment"># As all constraints are equality constraints the artificial variables</span></div>
<div class="line"><span class="lineno">  611</span>    <span class="comment"># will also be basic variables.</span></div>
<div class="line"><span class="lineno">  612</span>    av = np.arange(n) + m</div>
<div class="line"><span class="lineno">  613</span>    basis = av.copy()</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    <span class="comment"># Format the phase one tableau by adding artificial variables and stacking</span></div>
<div class="line"><span class="lineno">  616</span>    <span class="comment"># the constraints, the objective row and pseudo-objective row.</span></div>
<div class="line"><span class="lineno">  617</span>    row_constraints = np.hstack((A, np.eye(n), b[:, np.newaxis]))</div>
<div class="line"><span class="lineno">  618</span>    row_objective = np.hstack((c, np.zeros(n), c0))</div>
<div class="line"><span class="lineno">  619</span>    row_pseudo_objective = -row_constraints.sum(axis=0)</div>
<div class="line"><span class="lineno">  620</span>    row_pseudo_objective[av] = 0</div>
<div class="line"><span class="lineno">  621</span>    T = np.vstack((row_constraints, row_objective, row_pseudo_objective))</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    nit1, status = _solve_simplex(T, n, basis, callback=callback,</div>
<div class="line"><span class="lineno">  624</span>                                  postsolve_args=postsolve_args,</div>
<div class="line"><span class="lineno">  625</span>                                  maxiter=maxiter, tol=tol, phase=1,</div>
<div class="line"><span class="lineno">  626</span>                                  bland=bland</div>
<div class="line"><span class="lineno">  627</span>                                  )</div>
<div class="line"><span class="lineno">  628</span>    <span class="comment"># if pseudo objective is zero, remove the last row from the tableau and</span></div>
<div class="line"><span class="lineno">  629</span>    <span class="comment"># proceed to phase 2</span></div>
<div class="line"><span class="lineno">  630</span>    nit2 = nit1</div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordflow">if</span> abs(T[-1, -1]) &lt; tol:</div>
<div class="line"><span class="lineno">  632</span>        <span class="comment"># Remove the pseudo-objective row from the tableau</span></div>
<div class="line"><span class="lineno">  633</span>        T = T[:-1, :]</div>
<div class="line"><span class="lineno">  634</span>        <span class="comment"># Remove the artificial variable columns from the tableau</span></div>
<div class="line"><span class="lineno">  635</span>        T = np.delete(T, av, 1)</div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  637</span>        <span class="comment"># Failure to find a feasible starting point</span></div>
<div class="line"><span class="lineno">  638</span>        status = 2</div>
<div class="line"><span class="lineno">  639</span>        messages[status] = (</div>
<div class="line"><span class="lineno">  640</span>            <span class="stringliteral">&quot;Phase 1 of the simplex method failed to find a feasible &quot;</span></div>
<div class="line"><span class="lineno">  641</span>            <span class="stringliteral">&quot;solution. The pseudo-objective function evaluates to {0:.1e} &quot;</span></div>
<div class="line"><span class="lineno">  642</span>            <span class="stringliteral">&quot;which exceeds the required tolerance of {1} for a solution to be &quot;</span></div>
<div class="line"><span class="lineno">  643</span>            <span class="stringliteral">&quot;considered &#39;close enough&#39; to zero to be a basic solution. &quot;</span></div>
<div class="line"><span class="lineno">  644</span>            <span class="stringliteral">&quot;Consider increasing the tolerance to be greater than {0:.1e}. &quot;</span></div>
<div class="line"><span class="lineno">  645</span>            <span class="stringliteral">&quot;If this tolerance is unacceptably  large the problem may be &quot;</span></div>
<div class="line"><span class="lineno">  646</span>            <span class="stringliteral">&quot;infeasible.&quot;</span>.format(abs(T[-1, -1]), tol)</div>
<div class="line"><span class="lineno">  647</span>        )</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>    <span class="keywordflow">if</span> status == 0:</div>
<div class="line"><span class="lineno">  650</span>        <span class="comment"># Phase 2</span></div>
<div class="line"><span class="lineno">  651</span>        nit2, status = _solve_simplex(T, n, basis, callback=callback,</div>
<div class="line"><span class="lineno">  652</span>                                      postsolve_args=postsolve_args,</div>
<div class="line"><span class="lineno">  653</span>                                      maxiter=maxiter, tol=tol, phase=2,</div>
<div class="line"><span class="lineno">  654</span>                                      bland=bland, nit0=nit1</div>
<div class="line"><span class="lineno">  655</span>                                      )</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    solution = np.zeros(n + m)</div>
<div class="line"><span class="lineno">  658</span>    solution[basis[:n]] = T[:n, -1]</div>
<div class="line"><span class="lineno">  659</span>    x = solution[:m]</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordflow">return</span> x, status, messages[status], int(nit2)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba6b18052ebfd1a832e2c9339f7d8a99" name="aba6b18052ebfd1a832e2c9339f7d8a99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba6b18052ebfd1a832e2c9339f7d8a99">&#9670;&#160;</a></span>_pivot_col()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_simplex._pivot_col </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bland</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given a linear programming simplex tableau, determine the column
of the variable to enter the basis.

Parameters
----------
T : 2-D array
    A 2-D array representing the simplex tableau, T, corresponding to the
    linear programming problem. It should have the form:

    [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
     [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
     .
     .
     .
     [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
     [c[0],   c[1], ...,   c[n_total],    0]]

    for a Phase 2 problem, or the form:

    [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
     [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
     .
     .
     .
     [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
     [c[0],   c[1], ...,   c[n_total],   0],
     [c'[0],  c'[1], ...,  c'[n_total],  0]]

     for a Phase 1 problem (a problem in which a basic feasible solution is
     sought prior to maximizing the actual objective. ``T`` is modified in
     place by ``_solve_simplex``.
tol : float
    Elements in the objective row larger than -tol will not be considered
    for pivoting. Nominally this value is zero, but numerical issues
    cause a tolerance about zero to be necessary.
bland : bool
    If True, use Bland's rule for selection of the column (select the
    first column with a negative coefficient in the objective row,
    regardless of magnitude).

Returns
-------
status: bool
    True if a suitable pivot column was found, otherwise False.
    A return of False indicates that the linear programming simplex
    algorithm is complete.
col: int
    The index of the column of the pivot element.
    If status is False, col will be returned as nan.
</pre> <div class="fragment"><div class="line"><span class="lineno">   37</span><span class="keyword">def </span>_pivot_col(T, tol=1e-9, bland=False):</div>
<div class="line"><span class="lineno">   38</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">    Given a linear programming simplex tableau, determine the column</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">    of the variable to enter the basis.</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    T : 2-D array</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">        A 2-D array representing the simplex tableau, T, corresponding to the</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">        linear programming problem. It should have the form:</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">         [c[0],   c[1], ...,   c[n_total],    0]]</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">        for a Phase 2 problem, or the form:</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">         [c[0],   c[1], ...,   c[n_total],   0],</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">         [c&#39;[0],  c&#39;[1], ...,  c&#39;[n_total],  0]]</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">         for a Phase 1 problem (a problem in which a basic feasible solution is</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">         sought prior to maximizing the actual objective. ``T`` is modified in</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">         place by ``_solve_simplex``.</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">        Elements in the objective row larger than -tol will not be considered</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">        for pivoting. Nominally this value is zero, but numerical issues</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        cause a tolerance about zero to be necessary.</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">    bland : bool</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        If True, use Bland&#39;s rule for selection of the column (select the</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        first column with a negative coefficient in the objective row,</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">        regardless of magnitude).</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    status: bool</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">        True if a suitable pivot column was found, otherwise False.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">        A return of False indicates that the linear programming simplex</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">        algorithm is complete.</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">    col: int</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        The index of the column of the pivot element.</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        If status is False, col will be returned as nan.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   89</span>    ma = np.ma.masked_where(T[-1, :-1] &gt;= -tol, T[-1, :-1], copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">if</span> ma.count() == 0:</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">return</span> <span class="keyword">False</span>, np.nan</div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">if</span> bland:</div>
<div class="line"><span class="lineno">   93</span>        <span class="comment"># ma.mask is sometimes 0d</span></div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">return</span> <span class="keyword">True</span>, np.nonzero(np.logical_not(np.atleast_1d(ma.mask)))[0][0]</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordflow">return</span> <span class="keyword">True</span>, np.ma.nonzero(ma == ma.min())[0][0]</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6a553695a9730b61be2d460bbceba39" name="ae6a553695a9730b61be2d460bbceba39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6a553695a9730b61be2d460bbceba39">&#9670;&#160;</a></span>_pivot_row()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_simplex._pivot_row </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pivcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bland</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given a linear programming simplex tableau, determine the row for the
pivot operation.

Parameters
----------
T : 2-D array
    A 2-D array representing the simplex tableau, T, corresponding to the
    linear programming problem. It should have the form:

    [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
     [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
     .
     .
     .
     [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
     [c[0],   c[1], ...,   c[n_total],    0]]

    for a Phase 2 problem, or the form:

    [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
     [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
     .
     .
     .
     [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
     [c[0],   c[1], ...,   c[n_total],   0],
     [c'[0],  c'[1], ...,  c'[n_total],  0]]

     for a Phase 1 problem (a Problem in which a basic feasible solution is
     sought prior to maximizing the actual objective. ``T`` is modified in
     place by ``_solve_simplex``.
basis : array
    A list of the current basic variables.
pivcol : int
    The index of the pivot column.
phase : int
    The phase of the simplex algorithm (1 or 2).
tol : float
    Elements in the pivot column smaller than tol will not be considered
    for pivoting. Nominally this value is zero, but numerical issues
    cause a tolerance about zero to be necessary.
bland : bool
    If True, use Bland's rule for selection of the row (if more than one
    row can be used, choose the one with the lowest variable index).

Returns
-------
status: bool
    True if a suitable pivot row was found, otherwise False. A return
    of False indicates that the linear programming problem is unbounded.
row: int
    The index of the row of the pivot element. If status is False, row
    will be returned as nan.
</pre> <div class="fragment"><div class="line"><span class="lineno">   98</span><span class="keyword">def </span>_pivot_row(T, basis, pivcol, phase, tol=1e-9, bland=False):</div>
<div class="line"><span class="lineno">   99</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">    Given a linear programming simplex tableau, determine the row for the</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    pivot operation.</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">    T : 2-D array</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">        A 2-D array representing the simplex tableau, T, corresponding to the</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">        linear programming problem. It should have the form:</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">         [c[0],   c[1], ...,   c[n_total],    0]]</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">        for a Phase 2 problem, or the form:</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">         [c[0],   c[1], ...,   c[n_total],   0],</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">         [c&#39;[0],  c&#39;[1], ...,  c&#39;[n_total],  0]]</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">         for a Phase 1 problem (a Problem in which a basic feasible solution is</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">         sought prior to maximizing the actual objective. ``T`` is modified in</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">         place by ``_solve_simplex``.</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    basis : array</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">        A list of the current basic variables.</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    pivcol : int</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">        The index of the pivot column.</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    phase : int</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">        The phase of the simplex algorithm (1 or 2).</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        Elements in the pivot column smaller than tol will not be considered</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">        for pivoting. Nominally this value is zero, but numerical issues</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">        cause a tolerance about zero to be necessary.</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    bland : bool</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">        If True, use Bland&#39;s rule for selection of the row (if more than one</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">        row can be used, choose the one with the lowest variable index).</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    status: bool</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">        True if a suitable pivot row was found, otherwise False. A return</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">        of False indicates that the linear programming problem is unbounded.</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">    row: int</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">        The index of the row of the pivot element. If status is False, row</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">        will be returned as nan.</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">if</span> phase == 1:</div>
<div class="line"><span class="lineno">  155</span>        k = 2</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  157</span>        k = 1</div>
<div class="line"><span class="lineno">  158</span>    ma = np.ma.masked_where(T[:-k, pivcol] &lt;= tol, T[:-k, pivcol], copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">if</span> ma.count() == 0:</div>
<div class="line"><span class="lineno">  160</span>        <span class="keywordflow">return</span> <span class="keyword">False</span>, np.nan</div>
<div class="line"><span class="lineno">  161</span>    mb = np.ma.masked_where(T[:-k, pivcol] &lt;= tol, T[:-k, -1], copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  162</span>    q = mb / ma</div>
<div class="line"><span class="lineno">  163</span>    min_rows = np.ma.nonzero(q == q.min())[0]</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">if</span> bland:</div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">return</span> <span class="keyword">True</span>, min_rows[np.argmin(np.take(basis, min_rows))]</div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordflow">return</span> <span class="keyword">True</span>, min_rows[0]</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a0d3370a00881877837fe411378baf1" name="a0a0d3370a00881877837fe411378baf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a0d3370a00881877837fe411378baf1">&#9670;&#160;</a></span>_solve_simplex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_simplex._solve_simplex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>phase</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bland</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nit0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Solve a linear programming problem in "standard form" using the Simplex
Method. Linear Programming is intended to solve the following problem form:

Minimize::

    c @ x

Subject to::

    A @ x == b
        x &gt;= 0

Parameters
----------
T : 2-D array
    A 2-D array representing the simplex tableau, T, corresponding to the
    linear programming problem. It should have the form:

    [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
     [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
     .
     .
     .
     [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
     [c[0],   c[1], ...,   c[n_total],    0]]

    for a Phase 2 problem, or the form:

    [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
     [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
     .
     .
     .
     [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
     [c[0],   c[1], ...,   c[n_total],   0],
     [c'[0],  c'[1], ...,  c'[n_total],  0]]

     for a Phase 1 problem (a problem in which a basic feasible solution is
     sought prior to maximizing the actual objective. ``T`` is modified in
     place by ``_solve_simplex``.
n : int
    The number of true variables in the problem.
basis : 1-D array
    An array of the indices of the basic variables, such that basis[i]
    contains the column corresponding to the basic variable for row i.
    Basis is modified in place by _solve_simplex
callback : callable, optional
    If a callback function is provided, it will be called within each
    iteration of the algorithm. The callback must accept a
    `scipy.optimize.OptimizeResult` consisting of the following fields:

        x : 1-D array
            Current solution vector
        fun : float
            Current value of the objective function
        success : bool
            True only when a phase has completed successfully. This
            will be False for most iterations.
        slack : 1-D array
            The values of the slack variables. Each slack variable
            corresponds to an inequality constraint. If the slack is zero,
            the corresponding constraint is active.
        con : 1-D array
            The (nominally zero) residuals of the equality constraints,
            that is, ``b - A_eq @ x``
        phase : int
            The phase of the optimization being executed. In phase 1 a basic
            feasible solution is sought and the T has an additional row
            representing an alternate objective function.
        status : int
            An integer representing the exit status of the optimization::

                 0 : Optimization terminated successfully
                 1 : Iteration limit reached
                 2 : Problem appears to be infeasible
                 3 : Problem appears to be unbounded
                 4 : Serious numerical difficulties encountered

        nit : int
            The number of iterations performed.
        message : str
            A string descriptor of the exit status of the optimization.
postsolve_args : tuple
    Data needed by _postsolve to convert the solution to the standard-form
    problem into the solution to the original problem.
maxiter : int
    The maximum number of iterations to perform before aborting the
    optimization.
tol : float
    The tolerance which determines when a solution is "close enough" to
    zero in Phase 1 to be considered a basic feasible solution or close
    enough to positive to serve as an optimal solution.
phase : int
    The phase of the optimization being executed. In phase 1 a basic
    feasible solution is sought and the T has an additional row
    representing an alternate objective function.
bland : bool
    If True, choose pivots using Bland's rule [3]_. In problems which
    fail to converge due to cycling, using Bland's rule can provide
    convergence at the expense of a less optimal path about the simplex.
nit0 : int
    The initial iteration number used to keep an accurate iteration total
    in a two-phase problem.

Returns
-------
nit : int
    The number of iterations. Used to keep an accurate iteration total
    in the two-phase problem.
status : int
    An integer representing the exit status of the optimization::

     0 : Optimization terminated successfully
     1 : Iteration limit reached
     2 : Problem appears to be infeasible
     3 : Problem appears to be unbounded
     4 : Serious numerical difficulties encountered</pre> <div class="fragment"><div class="line"><span class="lineno">  234</span>                   ):</div>
<div class="line"><span class="lineno">  235</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">    Solve a linear programming problem in &quot;standard form&quot; using the Simplex</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">    Method. Linear Programming is intended to solve the following problem form:</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">        A @ x == b</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">            x &gt;= 0</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">    T : 2-D array</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">        A 2-D array representing the simplex tableau, T, corresponding to the</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">        linear programming problem. It should have the form:</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">         [c[0],   c[1], ...,   c[n_total],    0]]</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">        for a Phase 2 problem, or the form:</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">         .</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">         [c[0],   c[1], ...,   c[n_total],   0],</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">         [c&#39;[0],  c&#39;[1], ...,  c&#39;[n_total],  0]]</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">         for a Phase 1 problem (a problem in which a basic feasible solution is</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">         sought prior to maximizing the actual objective. ``T`` is modified in</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">         place by ``_solve_simplex``.</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">        The number of true variables in the problem.</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    basis : 1-D array</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">        An array of the indices of the basic variables, such that basis[i]</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">        contains the column corresponding to the basic variable for row i.</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">        Basis is modified in place by _solve_simplex</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">        If a callback function is provided, it will be called within each</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">        iteration of the algorithm. The callback must accept a</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">        `scipy.optimize.OptimizeResult` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">            x : 1-D array</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">                Current solution vector</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">            fun : float</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">                Current value of the objective function</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">            success : bool</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">                True only when a phase has completed successfully. This</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">                will be False for most iterations.</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">            slack : 1-D array</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">                The values of the slack variables. Each slack variable</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">                corresponds to an inequality constraint. If the slack is zero,</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">                the corresponding constraint is active.</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">            con : 1-D array</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">                The (nominally zero) residuals of the equality constraints,</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">                that is, ``b - A_eq @ x``</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">            phase : int</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">                The phase of the optimization being executed. In phase 1 a basic</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">                feasible solution is sought and the T has an additional row</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">                representing an alternate objective function.</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">            status : int</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">                An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">                     0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">                     1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">                     2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">                     3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">                     4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">            nit : int</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">                The number of iterations performed.</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">            message : str</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">                A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">    postsolve_args : tuple</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">        Data needed by _postsolve to convert the solution to the standard-form</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        problem into the solution to the original problem.</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">        The maximum number of iterations to perform before aborting the</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">        optimization.</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">        The tolerance which determines when a solution is &quot;close enough&quot; to</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">        zero in Phase 1 to be considered a basic feasible solution or close</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        enough to positive to serve as an optimal solution.</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">    phase : int</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">        The phase of the optimization being executed. In phase 1 a basic</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">        feasible solution is sought and the T has an additional row</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">        representing an alternate objective function.</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    bland : bool</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">        If True, choose pivots using Bland&#39;s rule [3]_. In problems which</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">        fail to converge due to cycling, using Bland&#39;s rule can provide</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">        convergence at the expense of a less optimal path about the simplex.</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    nit0 : int</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">        The initial iteration number used to keep an accurate iteration total</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">        in a two-phase problem.</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    nit : int</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">        The number of iterations. Used to keep an accurate iteration total</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">        in the two-phase problem.</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">         0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">         1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">         2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">         3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">         4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  355</span>    nit = nit0</div>
<div class="line"><span class="lineno">  356</span>    status = 0</div>
<div class="line"><span class="lineno">  357</span>    message = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><span class="lineno">  358</span>    complete = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">if</span> phase == 1:</div>
<div class="line"><span class="lineno">  361</span>        m = T.shape[1]-2</div>
<div class="line"><span class="lineno">  362</span>    <span class="keywordflow">elif</span> phase == 2:</div>
<div class="line"><span class="lineno">  363</span>        m = T.shape[1]-1</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Argument &#39;phase&#39; to _solve_simplex must be 1 or 2&quot;</span>)</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">if</span> phase == 2:</div>
<div class="line"><span class="lineno">  368</span>        <span class="comment"># Check if any artificial variables are still in the basis.</span></div>
<div class="line"><span class="lineno">  369</span>        <span class="comment"># If yes, check if any coefficients from this row and a column</span></div>
<div class="line"><span class="lineno">  370</span>        <span class="comment"># corresponding to one of the non-artificial variable is non-zero.</span></div>
<div class="line"><span class="lineno">  371</span>        <span class="comment"># If found, pivot at this term. If not, start phase 2.</span></div>
<div class="line"><span class="lineno">  372</span>        <span class="comment"># Do this for all artificial variables in the basis.</span></div>
<div class="line"><span class="lineno">  373</span>        <span class="comment"># Ref: &quot;An Introduction to Linear Programming and Game Theory&quot;</span></div>
<div class="line"><span class="lineno">  374</span>        <span class="comment"># by Paul R. Thie, Gerard E. Keough, 3rd Ed,</span></div>
<div class="line"><span class="lineno">  375</span>        <span class="comment"># Chapter 3.7 Redundant Systems (pag 102)</span></div>
<div class="line"><span class="lineno">  376</span>        <span class="keywordflow">for</span> pivrow <span class="keywordflow">in</span> [row <span class="keywordflow">for</span> row <span class="keywordflow">in</span> range(basis.size)</div>
<div class="line"><span class="lineno">  377</span>                       <span class="keywordflow">if</span> basis[row] &gt; T.shape[1] - 2]:</div>
<div class="line"><span class="lineno">  378</span>            non_zero_row = [col <span class="keywordflow">for</span> col <span class="keywordflow">in</span> range(T.shape[1] - 1)</div>
<div class="line"><span class="lineno">  379</span>                            <span class="keywordflow">if</span> abs(T[pivrow, col]) &gt; tol]</div>
<div class="line"><span class="lineno">  380</span>            <span class="keywordflow">if</span> len(non_zero_row) &gt; 0:</div>
<div class="line"><span class="lineno">  381</span>                pivcol = non_zero_row[0]</div>
<div class="line"><span class="lineno">  382</span>                _apply_pivot(T, basis, pivrow, pivcol, tol)</div>
<div class="line"><span class="lineno">  383</span>                nit += 1</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    <span class="keywordflow">if</span> len(basis[:m]) == 0:</div>
<div class="line"><span class="lineno">  386</span>        solution = np.empty(T.shape[1] - 1, dtype=np.float64)</div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  388</span>        solution = np.empty(max(T.shape[1] - 1, max(basis[:m]) + 1),</div>
<div class="line"><span class="lineno">  389</span>                            dtype=np.float64)</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">while</span> <span class="keywordflow">not</span> complete:</div>
<div class="line"><span class="lineno">  392</span>        <span class="comment"># Find the pivot column</span></div>
<div class="line"><span class="lineno">  393</span>        pivcol_found, pivcol = _pivot_col(T, tol, bland)</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> pivcol_found:</div>
<div class="line"><span class="lineno">  395</span>            pivcol = np.nan</div>
<div class="line"><span class="lineno">  396</span>            pivrow = np.nan</div>
<div class="line"><span class="lineno">  397</span>            status = 0</div>
<div class="line"><span class="lineno">  398</span>            complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  399</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  400</span>            <span class="comment"># Find the pivot row</span></div>
<div class="line"><span class="lineno">  401</span>            pivrow_found, pivrow = _pivot_row(T, basis, pivcol, phase, tol, bland)</div>
<div class="line"><span class="lineno">  402</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> pivrow_found:</div>
<div class="line"><span class="lineno">  403</span>                status = 3</div>
<div class="line"><span class="lineno">  404</span>                complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  407</span>            solution[:] = 0</div>
<div class="line"><span class="lineno">  408</span>            solution[basis[:n]] = T[:n, -1]</div>
<div class="line"><span class="lineno">  409</span>            x = solution[:m]</div>
<div class="line"><span class="lineno">  410</span>            x, fun, slack, con = _postsolve(</div>
<div class="line"><span class="lineno">  411</span>                x, postsolve_args</div>
<div class="line"><span class="lineno">  412</span>            )</div>
<div class="line"><span class="lineno">  413</span>            res = OptimizeResult({</div>
<div class="line"><span class="lineno">  414</span>                <span class="stringliteral">&#39;x&#39;</span>: x,</div>
<div class="line"><span class="lineno">  415</span>                <span class="stringliteral">&#39;fun&#39;</span>: fun,</div>
<div class="line"><span class="lineno">  416</span>                <span class="stringliteral">&#39;slack&#39;</span>: slack,</div>
<div class="line"><span class="lineno">  417</span>                <span class="stringliteral">&#39;con&#39;</span>: con,</div>
<div class="line"><span class="lineno">  418</span>                <span class="stringliteral">&#39;status&#39;</span>: status,</div>
<div class="line"><span class="lineno">  419</span>                <span class="stringliteral">&#39;message&#39;</span>: message,</div>
<div class="line"><span class="lineno">  420</span>                <span class="stringliteral">&#39;nit&#39;</span>: nit,</div>
<div class="line"><span class="lineno">  421</span>                <span class="stringliteral">&#39;success&#39;</span>: status == 0 <span class="keywordflow">and</span> complete,</div>
<div class="line"><span class="lineno">  422</span>                <span class="stringliteral">&#39;phase&#39;</span>: phase,</div>
<div class="line"><span class="lineno">  423</span>                <span class="stringliteral">&#39;complete&#39;</span>: complete,</div>
<div class="line"><span class="lineno">  424</span>                })</div>
<div class="line"><span class="lineno">  425</span>            callback(res)</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> complete:</div>
<div class="line"><span class="lineno">  428</span>            <span class="keywordflow">if</span> nit &gt;= maxiter:</div>
<div class="line"><span class="lineno">  429</span>                <span class="comment"># Iteration limit exceeded</span></div>
<div class="line"><span class="lineno">  430</span>                status = 1</div>
<div class="line"><span class="lineno">  431</span>                complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  432</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  433</span>                _apply_pivot(T, basis, pivrow, pivcol, tol)</div>
<div class="line"><span class="lineno">  434</span>                nit += 1</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">return</span> nit, status</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
