<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: fontTools.varLib Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacefont_tools.html">fontTools</a></li><li class="navelem"><a class="el" href="namespacefont_tools_1_1var_lib.html">varLib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">fontTools.varLib Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1____main____" id="r_namespacefont_tools_1_1var_lib_1_1____main____"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1____main____.html">__main__</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1builder" id="r_namespacefont_tools_1_1var_lib_1_1builder"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1builder.html">builder</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1cff" id="r_namespacefont_tools_1_1var_lib_1_1cff"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1cff.html">cff</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1errors" id="r_namespacefont_tools_1_1var_lib_1_1errors"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1errors.html">errors</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1feature_vars" id="r_namespacefont_tools_1_1var_lib_1_1feature_vars"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1feature_vars.html">featureVars</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1instancer" id="r_namespacefont_tools_1_1var_lib_1_1instancer"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer.html">instancer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1interpolatable" id="r_namespacefont_tools_1_1var_lib_1_1interpolatable"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1interpolatable.html">interpolatable</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1interpolate__layout" id="r_namespacefont_tools_1_1var_lib_1_1interpolate__layout"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1interpolate__layout.html">interpolate_layout</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1iup" id="r_namespacefont_tools_1_1var_lib_1_1iup"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1iup.html">iup</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1merger" id="r_namespacefont_tools_1_1var_lib_1_1merger"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1merger.html">merger</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1models" id="r_namespacefont_tools_1_1var_lib_1_1models"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1models.html">models</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1mutator" id="r_namespacefont_tools_1_1var_lib_1_1mutator"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1mutator.html">mutator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1mvar" id="r_namespacefont_tools_1_1var_lib_1_1mvar"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1mvar.html">mvar</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1plot" id="r_namespacefont_tools_1_1var_lib_1_1plot"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1plot.html">plot</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1stat" id="r_namespacefont_tools_1_1var_lib_1_1stat"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1stat.html">stat</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacefont_tools_1_1var_lib_1_1var_store" id="r_namespacefont_tools_1_1var_lib_1_1var_store"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1var_store.html">varStore</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfont_tools_1_1var_lib_1_1_master_finder.html">MasterFinder</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af95eff32b397dd71eb463f7be147a011" id="r_af95eff32b397dd71eb463f7be147a011"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#af95eff32b397dd71eb463f7be147a011">_add_fvar</a> (font, axes, List[<a class="el" href="classfont_tools_1_1designspace_lib_1_1_instance_descriptor.html">InstanceDescriptor</a>] instances)</td></tr>
<tr class="separator:af95eff32b397dd71eb463f7be147a011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a413f58549921f773085c1a20cf75b02e" id="r_a413f58549921f773085c1a20cf75b02e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a413f58549921f773085c1a20cf75b02e">_add_avar</a> (font, axes)</td></tr>
<tr class="separator:a413f58549921f773085c1a20cf75b02e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34d499c45c2894093ac97181df6f619e" id="r_a34d499c45c2894093ac97181df6f619e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a34d499c45c2894093ac97181df6f619e">_add_stat</a> (font)</td></tr>
<tr class="separator:a34d499c45c2894093ac97181df6f619e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58541b97bdb217fcee6b06cfeb955c46" id="r_a58541b97bdb217fcee6b06cfeb955c46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a58541b97bdb217fcee6b06cfeb955c46">_add_gvar</a> (font, masterModel, master_ttfs, tolerance=0.5, optimize=True)</td></tr>
<tr class="separator:a58541b97bdb217fcee6b06cfeb955c46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a526f4ec0e198703c9b8823cddd9b2bc9" id="r_a526f4ec0e198703c9b8823cddd9b2bc9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a526f4ec0e198703c9b8823cddd9b2bc9">_remove_TTHinting</a> (font)</td></tr>
<tr class="separator:a526f4ec0e198703c9b8823cddd9b2bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e4120aa9b071ece050dd8b308f5fe6a" id="r_a9e4120aa9b071ece050dd8b308f5fe6a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a9e4120aa9b071ece050dd8b308f5fe6a">_merge_TTHinting</a> (font, masterModel, master_ttfs)</td></tr>
<tr class="separator:a9e4120aa9b071ece050dd8b308f5fe6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf63b8c59b4a27e36409e4056fe67cd1" id="r_aaf63b8c59b4a27e36409e4056fe67cd1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#aaf63b8c59b4a27e36409e4056fe67cd1">_add_HVAR</a> (font, masterModel, master_ttfs, axisTags)</td></tr>
<tr class="separator:aaf63b8c59b4a27e36409e4056fe67cd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c2c249b47478ed37728980c176b1af3" id="r_a6c2c249b47478ed37728980c176b1af3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a6c2c249b47478ed37728980c176b1af3">_add_VVAR</a> (font, masterModel, master_ttfs, axisTags)</td></tr>
<tr class="separator:a6c2c249b47478ed37728980c176b1af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3521642acbdf77b75e2685aadb061af7" id="r_a3521642acbdf77b75e2685aadb061af7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a3521642acbdf77b75e2685aadb061af7">_add_VHVAR</a> (font, masterModel, master_ttfs, axisTags, tableFields)</td></tr>
<tr class="separator:a3521642acbdf77b75e2685aadb061af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae236a172e1f1a4fe47645ec18626c9ad" id="r_ae236a172e1f1a4fe47645ec18626c9ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#ae236a172e1f1a4fe47645ec18626c9ad">_get_advance_metrics</a> (font, masterModel, master_ttfs, axisTags, glyphOrder, advMetricses, vOrigMetricses=None)</td></tr>
<tr class="separator:ae236a172e1f1a4fe47645ec18626c9ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03ec2aafc8b20dc708835afa69db8f27" id="r_a03ec2aafc8b20dc708835afa69db8f27"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a03ec2aafc8b20dc708835afa69db8f27">_add_MVAR</a> (font, masterModel, master_ttfs, axisTags)</td></tr>
<tr class="separator:a03ec2aafc8b20dc708835afa69db8f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e1c9aa9390759c2ddd546e79c6c5b33" id="r_a5e1c9aa9390759c2ddd546e79c6c5b33"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a5e1c9aa9390759c2ddd546e79c6c5b33">_add_BASE</a> (font, masterModel, master_ttfs, axisTags)</td></tr>
<tr class="separator:a5e1c9aa9390759c2ddd546e79c6c5b33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac9f371412903f9d55222ca4eebad96" id="r_aaac9f371412903f9d55222ca4eebad96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#aaac9f371412903f9d55222ca4eebad96">_merge_OTL</a> (font, model, master_fonts, axisTags)</td></tr>
<tr class="separator:aaac9f371412903f9d55222ca4eebad96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0c9a15259bef2ff640bb20894b6239" id="r_aec0c9a15259bef2ff640bb20894b6239"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#aec0c9a15259bef2ff640bb20894b6239">_add_GSUB_feature_variations</a> (font, axes, internal_axis_supports, rules, featureTag)</td></tr>
<tr class="separator:aec0c9a15259bef2ff640bb20894b6239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a995573b54b0401a25cfba272d67f326e" id="r_a995573b54b0401a25cfba272d67f326e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a995573b54b0401a25cfba272d67f326e">_add_CFF2</a> (varFont, model, master_fonts)</td></tr>
<tr class="separator:a995573b54b0401a25cfba272d67f326e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26ec87199bf9f1f9fa622e5377d17fd0" id="r_a26ec87199bf9f1f9fa622e5377d17fd0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a26ec87199bf9f1f9fa622e5377d17fd0">_add_COLR</a> (font, model, master_fonts, axisTags, colr_layer_reuse=True)</td></tr>
<tr class="separator:a26ec87199bf9f1f9fa622e5377d17fd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8beeec8d4c664ba72016188aca89d22" id="r_af8beeec8d4c664ba72016188aca89d22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#af8beeec8d4c664ba72016188aca89d22">load_designspace</a> (designspace)</td></tr>
<tr class="separator:af8beeec8d4c664ba72016188aca89d22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12bca1b4bbeb0c1739b80190ba645535" id="r_a12bca1b4bbeb0c1739b80190ba645535"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a12bca1b4bbeb0c1739b80190ba645535">set_default_weight_width_slant</a> (font, location)</td></tr>
<tr class="separator:a12bca1b4bbeb0c1739b80190ba645535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e62848333335c9aea72c7b01ed30998" id="r_a2e62848333335c9aea72c7b01ed30998"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a2e62848333335c9aea72c7b01ed30998">build_many</a> (<a class="el" href="classfont_tools_1_1designspace_lib_1_1_design_space_document.html">DesignSpaceDocument</a> designspace, master_finder=<a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a> s:s, exclude=[], optimize=True, skip_vf=<a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a> vf_name:False, colr_layer_reuse=True)</td></tr>
<tr class="separator:a2e62848333335c9aea72c7b01ed30998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0729a75ad14ffc81feb6461163eba4a7" id="r_a0729a75ad14ffc81feb6461163eba4a7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a0729a75ad14ffc81feb6461163eba4a7">build</a> (designspace, master_finder=<a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a> s:s, exclude=[], optimize=True, colr_layer_reuse=True)</td></tr>
<tr class="separator:a0729a75ad14ffc81feb6461163eba4a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a460771810b56b6fe74fcc65cc7256b88" id="r_a460771810b56b6fe74fcc65cc7256b88"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a460771810b56b6fe74fcc65cc7256b88">_open_font</a> (path, master_finder=<a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a> s:s)</td></tr>
<tr class="separator:a460771810b56b6fe74fcc65cc7256b88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34a477fddcac07168c499fd5e7f95091" id="r_a34a477fddcac07168c499fd5e7f95091"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a34a477fddcac07168c499fd5e7f95091">load_masters</a> (designspace, master_finder=<a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a> s:s)</td></tr>
<tr class="separator:a34a477fddcac07168c499fd5e7f95091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5a405453c333e5a693d79b2c93c0e2c" id="r_af5a405453c333e5a693d79b2c93c0e2c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#af5a405453c333e5a693d79b2c93c0e2c">main</a> (args=None)</td></tr>
<tr class="separator:af5a405453c333e5a693d79b2c93c0e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae5b52324625c4fe615f18aa0f32ae5be" id="r_ae5b52324625c4fe615f18aa0f32ae5be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#ae5b52324625c4fe615f18aa0f32ae5be">log</a> = logging.getLogger(&quot;fontTools.varLib&quot;)</td></tr>
<tr class="separator:ae5b52324625c4fe615f18aa0f32ae5be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475959f611f8e49643a0789aa515c113" id="r_a475959f611f8e49643a0789aa515c113"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a475959f611f8e49643a0789aa515c113">FEAVAR_FEATURETAG_LIB_KEY</a> = &quot;com.github.fonttools.varLib.featureVarsFeatureTag&quot;</td></tr>
<tr class="separator:a475959f611f8e49643a0789aa515c113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac89262188713d0562018946c1b57fb2d" id="r_ac89262188713d0562018946c1b57fb2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#ac89262188713d0562018946c1b57fb2d">_MasterData</a> = namedtuple('_MasterData', ['glyf', 'hMetrics', 'vMetrics'])</td></tr>
<tr class="separator:ac89262188713d0562018946c1b57fb2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92098c701c16e706448c6b4e9297af00" id="r_a92098c701c16e706448c6b4e9297af00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a92098c701c16e706448c6b4e9297af00">_MetricsFields</a></td></tr>
<tr class="separator:a92098c701c16e706448c6b4e9297af00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6efbe7a5cfccd358dc024169d258bcb1" id="r_a6efbe7a5cfccd358dc024169d258bcb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a6efbe7a5cfccd358dc024169d258bcb1">HVAR_FIELDS</a></td></tr>
<tr class="separator:a6efbe7a5cfccd358dc024169d258bcb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf710f32faed7b910325ba44ec32ffcf" id="r_acf710f32faed7b910325ba44ec32ffcf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#acf710f32faed7b910325ba44ec32ffcf">VVAR_FIELDS</a></td></tr>
<tr class="separator:acf710f32faed7b910325ba44ec32ffcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a132f85d68de07143aaf704f9ee1fa00a" id="r_a132f85d68de07143aaf704f9ee1fa00a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#a132f85d68de07143aaf704f9ee1fa00a">_DesignSpaceData</a></td></tr>
<tr class="separator:a132f85d68de07143aaf704f9ee1fa00a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf55875644812f7928ea3e71f8f2e404" id="r_aaf55875644812f7928ea3e71f8f2e404"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib.html#aaf55875644812f7928ea3e71f8f2e404">WDTH_VALUE_TO_OS2_WIDTH_CLASS</a></td></tr>
<tr class="separator:aaf55875644812f7928ea3e71f8f2e404"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Module for dealing with 'gvar'-style font variations, also known as run-time
interpolation.

The ideas here are very similar to MutatorMath.  There is even code to read
MutatorMath .designspace files in the varLib.designspace module.

For now, if you run this file on a designspace file, it tries to find
ttf-interpolatable files for the masters and build a variable-font from
them.  Such ttf-interpolatable and designspace files can be generated from
a Glyphs source, eg., using noto-source as an example:

    $ fontmake -o ttf-interpolatable -g NotoSansArabic-MM.glyphs

Then you can make a variable-font this way:

    $ fonttools varLib master_ufo/NotoSansArabic.designspace

API *will* change in near future.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a413f58549921f773085c1a20cf75b02e" name="a413f58549921f773085c1a20cf75b02e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a413f58549921f773085c1a20cf75b02e">&#9670;&#160;</a></span>_add_avar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_avar </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">    Add 'avar' table to font.

    axes is an ordered dictionary of AxisDescriptor objects.</pre> <div class="fragment"><div class="line"><span class="lineno">  120</span><span class="keyword">def </span>_add_avar(font, axes):</div>
<div class="line"><span class="lineno">  121</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    Add &#39;avar&#39; table to font.</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    axes is an ordered dictionary of AxisDescriptor objects.</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="keyword">assert</span> axes</div>
<div class="line"><span class="lineno">  128</span>    <span class="keyword">assert</span> isinstance(axes, OrderedDict)</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    log.info(<span class="stringliteral">&quot;Generating avar&quot;</span>)</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    avar = newTable(<span class="stringliteral">&#39;avar&#39;</span>)</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    interesting = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">for</span> axis <span class="keywordflow">in</span> axes.values():</div>
<div class="line"><span class="lineno">  136</span>        <span class="comment"># Currently, some rasterizers require that the default value maps</span></div>
<div class="line"><span class="lineno">  137</span>        <span class="comment"># (-1 to -1, 0 to 0, and 1 to 1) be present for all the segment</span></div>
<div class="line"><span class="lineno">  138</span>        <span class="comment"># maps, even when the default normalization mapping for the axis</span></div>
<div class="line"><span class="lineno">  139</span>        <span class="comment"># was not modified.</span></div>
<div class="line"><span class="lineno">  140</span>        <span class="comment"># https://github.com/googlei18n/fontmake/issues/295</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="comment"># https://github.com/fonttools/fonttools/issues/1011</span></div>
<div class="line"><span class="lineno">  142</span>        <span class="comment"># TODO(anthrotype) revert this (and 19c4b37) when issue is fixed</span></div>
<div class="line"><span class="lineno">  143</span>        curve = avar.segments[axis.tag] = {-1.0: -1.0, 0.0: 0.0, 1.0: 1.0}</div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> axis.map:</div>
<div class="line"><span class="lineno">  145</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>        items = sorted(axis.map)</div>
<div class="line"><span class="lineno">  148</span>        keys = [item[0] <span class="keywordflow">for</span> item <span class="keywordflow">in</span> items]</div>
<div class="line"><span class="lineno">  149</span>        vals = [item[1] <span class="keywordflow">for</span> item <span class="keywordflow">in</span> items]</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>        <span class="comment"># Current avar requirements.  We don&#39;t have to enforce</span></div>
<div class="line"><span class="lineno">  152</span>        <span class="comment"># these on the designer and can deduce some ourselves,</span></div>
<div class="line"><span class="lineno">  153</span>        <span class="comment"># but for now just enforce them.</span></div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">if</span> axis.minimum != min(keys):</div>
<div class="line"><span class="lineno">  155</span>            <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  156</span>                f<span class="stringliteral">&quot;Axis &#39;{axis.name}&#39;: there must be a mapping for the axis minimum &quot;</span></div>
<div class="line"><span class="lineno">  157</span>                f<span class="stringliteral">&quot;value {axis.minimum} and it must be the lowest input mapping value.&quot;</span></div>
<div class="line"><span class="lineno">  158</span>            )</div>
<div class="line"><span class="lineno">  159</span>        <span class="keywordflow">if</span> axis.maximum != max(keys):</div>
<div class="line"><span class="lineno">  160</span>            <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  161</span>                f<span class="stringliteral">&quot;Axis &#39;{axis.name}&#39;: there must be a mapping for the axis maximum &quot;</span></div>
<div class="line"><span class="lineno">  162</span>                f<span class="stringliteral">&quot;value {axis.maximum} and it must be the highest input mapping value.&quot;</span></div>
<div class="line"><span class="lineno">  163</span>            )</div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">if</span> axis.default <span class="keywordflow">not</span> <span class="keywordflow">in</span> keys:</div>
<div class="line"><span class="lineno">  165</span>            <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  166</span>                f<span class="stringliteral">&quot;Axis &#39;{axis.name}&#39;: there must be a mapping for the axis default &quot;</span></div>
<div class="line"><span class="lineno">  167</span>                f<span class="stringliteral">&quot;value {axis.default}.&quot;</span></div>
<div class="line"><span class="lineno">  168</span>            )</div>
<div class="line"><span class="lineno">  169</span>        <span class="comment"># No duplicate input values (output values can be &gt;= their preceeding value).</span></div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">if</span> len(set(keys)) != len(keys):</div>
<div class="line"><span class="lineno">  171</span>            <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  172</span>                f<span class="stringliteral">&quot;Axis &#39;{axis.name}&#39;: All axis mapping input=&#39;...&#39; values must be &quot;</span></div>
<div class="line"><span class="lineno">  173</span>                <span class="stringliteral">&quot;unique, but we found duplicates.&quot;</span></div>
<div class="line"><span class="lineno">  174</span>            )</div>
<div class="line"><span class="lineno">  175</span>        <span class="comment"># Ascending values</span></div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">if</span> sorted(vals) != vals:</div>
<div class="line"><span class="lineno">  177</span>            <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  178</span>                f<span class="stringliteral">&quot;Axis &#39;{axis.name}&#39;: mapping output values must be in ascending order.&quot;</span></div>
<div class="line"><span class="lineno">  179</span>            )</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>        keys_triple = (axis.minimum, axis.default, axis.maximum)</div>
<div class="line"><span class="lineno">  182</span>        vals_triple = tuple(axis.map_forward(v) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> keys_triple)</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>        keys = [models.normalizeValue(v, keys_triple) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> keys]</div>
<div class="line"><span class="lineno">  185</span>        vals = [models.normalizeValue(v, vals_triple) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> vals]</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>        <span class="keywordflow">if</span> all(k == v <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> zip(keys, vals)):</div>
<div class="line"><span class="lineno">  188</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  189</span>        interesting = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>        curve.update(zip(keys, vals))</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>        <span class="keyword">assert</span> 0.0 <span class="keywordflow">in</span> curve <span class="keywordflow">and</span> curve[0.0] == 0.0</div>
<div class="line"><span class="lineno">  194</span>        <span class="keyword">assert</span> -1.0 <span class="keywordflow">not</span> <span class="keywordflow">in</span> curve <span class="keywordflow">or</span> curve[-1.0] == -1.0</div>
<div class="line"><span class="lineno">  195</span>        <span class="keyword">assert</span> +1.0 <span class="keywordflow">not</span> <span class="keywordflow">in</span> curve <span class="keywordflow">or</span> curve[+1.0] == +1.0</div>
<div class="line"><span class="lineno">  196</span>        <span class="comment"># curve.update({-1.0: -1.0, 0.0: 0.0, 1.0: 1.0})</span></div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    <span class="keyword">assert</span> <span class="stringliteral">&quot;avar&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> font</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> interesting:</div>
<div class="line"><span class="lineno">  200</span>        log.info(<span class="stringliteral">&quot;No need for avar&quot;</span>)</div>
<div class="line"><span class="lineno">  201</span>        avar = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  203</span>        font[<span class="stringliteral">&#39;avar&#39;</span>] = avar</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">return</span> avar</div>
<div class="line"><span class="lineno">  206</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e1c9aa9390759c2ddd546e79c6c5b33" name="a5e1c9aa9390759c2ddd546e79c6c5b33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e1c9aa9390759c2ddd546e79c6c5b33">&#9670;&#160;</a></span>_add_BASE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_BASE </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masterModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_ttfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisTags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  603</span><span class="keyword">def </span>_add_BASE(font, masterModel, master_ttfs, axisTags):</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>    log.info(<span class="stringliteral">&quot;Generating BASE&quot;</span>)</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>    merger = VariationMerger(masterModel, axisTags, font)</div>
<div class="line"><span class="lineno">  608</span>    merger.mergeTables(font, master_ttfs, [<span class="stringliteral">&#39;BASE&#39;</span>])</div>
<div class="line"><span class="lineno">  609</span>    store = merger.store_builder.finish()</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> store:</div>
<div class="line"><span class="lineno">  612</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  613</span>    base = font[<span class="stringliteral">&#39;BASE&#39;</span>].table</div>
<div class="line"><span class="lineno">  614</span>    <span class="keyword">assert</span> base.Version == 0x00010000</div>
<div class="line"><span class="lineno">  615</span>    base.Version = 0x00010001</div>
<div class="line"><span class="lineno">  616</span>    base.VarStore = store</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a995573b54b0401a25cfba272d67f326e" name="a995573b54b0401a25cfba272d67f326e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a995573b54b0401a25cfba272d67f326e">&#9670;&#160;</a></span>_add_CFF2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_CFF2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>varFont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_fonts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  705</span><span class="keyword">def </span>_add_CFF2(varFont, model, master_fonts):</div>
<div class="line"><span class="lineno">  706</span>    <span class="keyword">from</span> .cff <span class="keyword">import</span> merge_region_fonts</div>
<div class="line"><span class="lineno">  707</span>    glyphOrder = varFont.getGlyphOrder()</div>
<div class="line"><span class="lineno">  708</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;CFF2&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> varFont:</div>
<div class="line"><span class="lineno">  709</span>        <span class="keyword">from</span> .cff <span class="keyword">import</span> convertCFFtoCFF2</div>
<div class="line"><span class="lineno">  710</span>        convertCFFtoCFF2(varFont)</div>
<div class="line"><span class="lineno">  711</span>    ordered_fonts_list = model.reorderMasters(master_fonts, model.reverseMapping)</div>
<div class="line"><span class="lineno">  712</span>    <span class="comment"># re-ordering the master list simplifies building the CFF2 data item lists.</span></div>
<div class="line"><span class="lineno">  713</span>    merge_region_fonts(varFont, model, ordered_fonts_list, glyphOrder)</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a26ec87199bf9f1f9fa622e5377d17fd0" name="a26ec87199bf9f1f9fa622e5377d17fd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26ec87199bf9f1f9fa622e5377d17fd0">&#9670;&#160;</a></span>_add_COLR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_COLR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_fonts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisTags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>colr_layer_reuse</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  716</span><span class="keyword">def </span>_add_COLR(font, model, master_fonts, axisTags, colr_layer_reuse=True):</div>
<div class="line"><span class="lineno">  717</span>    merger = COLRVariationMerger(model, axisTags, font, allowLayerReuse=colr_layer_reuse)</div>
<div class="line"><span class="lineno">  718</span>    merger.mergeTables(font, master_fonts)</div>
<div class="line"><span class="lineno">  719</span>    store = merger.store_builder.finish()</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>    colr = font[<span class="stringliteral">&quot;COLR&quot;</span>].table</div>
<div class="line"><span class="lineno">  722</span>    <span class="keywordflow">if</span> store:</div>
<div class="line"><span class="lineno">  723</span>        mapping = store.optimize()</div>
<div class="line"><span class="lineno">  724</span>        colr.VarStore = store</div>
<div class="line"><span class="lineno">  725</span>        <span class="comment"># don&#39;t add DeltaSetIndexMap for identity mapping</span></div>
<div class="line"><span class="lineno">  726</span>        colr.VarIndexMap = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  727</span>        varIdxes = [mapping[v] <span class="keywordflow">for</span> v <span class="keywordflow">in</span> merger.varIdxes]</div>
<div class="line"><span class="lineno">  728</span>        <span class="keywordflow">if</span> any(i != varIdxes[i] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(varIdxes))):</div>
<div class="line"><span class="lineno">  729</span>            colr.VarIndexMap = builder.buildDeltaSetIndexMap(varIdxes)</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af95eff32b397dd71eb463f7be147a011" name="af95eff32b397dd71eb463f7be147a011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af95eff32b397dd71eb463f7be147a011">&#9670;&#160;</a></span>_add_fvar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_fvar </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[<a class="el" href="classfont_tools_1_1designspace_lib_1_1_instance_descriptor.html">InstanceDescriptor</a>]&#160;</td>
          <td class="paramname"><em>instances</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">    Add 'fvar' table to font.

    axes is an ordered dictionary of DesignspaceAxis objects.

    instances is list of dictionary objects with 'location', 'stylename',
    and possibly 'postscriptfontname' entries.</pre> <div class="fragment"><div class="line"><span class="lineno">   61</span><span class="keyword">def </span>_add_fvar(font, axes, instances: List[InstanceDescriptor]):</div>
<div class="line"><span class="lineno">   62</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    Add &#39;fvar&#39; table to font.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">    axes is an ordered dictionary of DesignspaceAxis objects.</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    instances is list of dictionary objects with &#39;location&#39;, &#39;stylename&#39;,</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">    and possibly &#39;postscriptfontname&#39; entries.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <span class="keyword">assert</span> axes</div>
<div class="line"><span class="lineno">   72</span>    <span class="keyword">assert</span> isinstance(axes, OrderedDict)</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    log.info(<span class="stringliteral">&quot;Generating fvar&quot;</span>)</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    fvar = newTable(<span class="stringliteral">&#39;fvar&#39;</span>)</div>
<div class="line"><span class="lineno">   77</span>    nameTable = font[<span class="stringliteral">&#39;name&#39;</span>]</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">for</span> a <span class="keywordflow">in</span> axes.values():</div>
<div class="line"><span class="lineno">   80</span>        axis = Axis()</div>
<div class="line"><span class="lineno">   81</span>        axis.axisTag = Tag(a.tag)</div>
<div class="line"><span class="lineno">   82</span>        <span class="comment"># TODO Skip axes that have no variation.</span></div>
<div class="line"><span class="lineno">   83</span>        axis.minValue, axis.defaultValue, axis.maxValue = a.minimum, a.default, a.maximum</div>
<div class="line"><span class="lineno">   84</span>        axis.axisNameID = nameTable.addMultilingualName(a.labelNames, font, minNameID=256)</div>
<div class="line"><span class="lineno">   85</span>        axis.flags = int(a.hidden)</div>
<div class="line"><span class="lineno">   86</span>        fvar.axes.append(axis)</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    <span class="keywordflow">for</span> instance <span class="keywordflow">in</span> instances:</div>
<div class="line"><span class="lineno">   89</span>        <span class="comment"># Filter out discrete axis locations</span></div>
<div class="line"><span class="lineno">   90</span>        coordinates = {name: value <span class="keywordflow">for</span> name, value <span class="keywordflow">in</span> instance.location.items() <span class="keywordflow">if</span> name <span class="keywordflow">in</span> axes}</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;en&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> instance.localisedStyleName:</div>
<div class="line"><span class="lineno">   93</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> instance.styleName:</div>
<div class="line"><span class="lineno">   94</span>                <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">   95</span>                    f<span class="stringliteral">&quot;Instance at location &#39;{coordinates}&#39; must have a default English &quot;</span></div>
<div class="line"><span class="lineno">   96</span>                    <span class="stringliteral">&quot;style name (&#39;stylename&#39; attribute on the instance element or a &quot;</span></div>
<div class="line"><span class="lineno">   97</span>                    <span class="stringliteral">&quot;stylename element with an &#39;xml:lang=\&quot;en\&quot;&#39; attribute).&quot;</span></div>
<div class="line"><span class="lineno">   98</span>                )</div>
<div class="line"><span class="lineno">   99</span>            localisedStyleName = dict(instance.localisedStyleName)</div>
<div class="line"><span class="lineno">  100</span>            localisedStyleName[<span class="stringliteral">&quot;en&quot;</span>] = tostr(instance.styleName)</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  102</span>            localisedStyleName = instance.localisedStyleName</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>        psname = instance.postScriptFontName</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>        inst = NamedInstance()</div>
<div class="line"><span class="lineno">  107</span>        inst.subfamilyNameID = nameTable.addMultilingualName(localisedStyleName)</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">if</span> psname <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  109</span>            psname = tostr(psname)</div>
<div class="line"><span class="lineno">  110</span>            inst.postscriptNameID = nameTable.addName(psname)</div>
<div class="line"><span class="lineno">  111</span>        inst.coordinates = {axes[k].tag:axes[k].map_backward(v) <span class="keywordflow">for</span> k,v <span class="keywordflow">in</span> coordinates.items()}</div>
<div class="line"><span class="lineno">  112</span>        <span class="comment">#inst.coordinates = {axes[k].tag:v for k,v in coordinates.items()}</span></div>
<div class="line"><span class="lineno">  113</span>        fvar.instances.append(inst)</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <span class="keyword">assert</span> <span class="stringliteral">&quot;fvar&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> font</div>
<div class="line"><span class="lineno">  116</span>    font[<span class="stringliteral">&#39;fvar&#39;</span>] = fvar</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">return</span> fvar</div>
<div class="line"><span class="lineno">  119</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aec0c9a15259bef2ff640bb20894b6239" name="aec0c9a15259bef2ff640bb20894b6239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec0c9a15259bef2ff640bb20894b6239">&#9670;&#160;</a></span>_add_GSUB_feature_variations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_GSUB_feature_variations </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>internal_axis_supports</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>featureTag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  651</span><span class="keyword">def </span>_add_GSUB_feature_variations(font, axes, internal_axis_supports, rules, featureTag):</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>    <span class="keyword">def </span>normalize(name, value):</div>
<div class="line"><span class="lineno">  654</span>        <span class="keywordflow">return</span> models.normalizeLocation(</div>
<div class="line"><span class="lineno">  655</span>            {name: value}, internal_axis_supports</div>
<div class="line"><span class="lineno">  656</span>        )[name]</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>    log.info(<span class="stringliteral">&quot;Generating GSUB FeatureVariations&quot;</span>)</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    axis_tags = {name: axis.tag <span class="keywordflow">for</span> name, axis <span class="keywordflow">in</span> axes.items()}</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>    conditional_subs = []</div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">for</span> rule <span class="keywordflow">in</span> rules:</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>        region = []</div>
<div class="line"><span class="lineno">  666</span>        <span class="keywordflow">for</span> conditions <span class="keywordflow">in</span> rule.conditionSets:</div>
<div class="line"><span class="lineno">  667</span>            space = {}</div>
<div class="line"><span class="lineno">  668</span>            <span class="keywordflow">for</span> condition <span class="keywordflow">in</span> conditions:</div>
<div class="line"><span class="lineno">  669</span>                axis_name = condition[<span class="stringliteral">&quot;name&quot;</span>]</div>
<div class="line"><span class="lineno">  670</span>                <span class="keywordflow">if</span> condition[<span class="stringliteral">&quot;minimum&quot;</span>] <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  671</span>                    minimum = normalize(axis_name, condition[<span class="stringliteral">&quot;minimum&quot;</span>])</div>
<div class="line"><span class="lineno">  672</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  673</span>                    minimum = -1.0</div>
<div class="line"><span class="lineno">  674</span>                <span class="keywordflow">if</span> condition[<span class="stringliteral">&quot;maximum&quot;</span>] <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  675</span>                    maximum = normalize(axis_name, condition[<span class="stringliteral">&quot;maximum&quot;</span>])</div>
<div class="line"><span class="lineno">  676</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  677</span>                    maximum = 1.0</div>
<div class="line"><span class="lineno">  678</span>                tag = axis_tags[axis_name]</div>
<div class="line"><span class="lineno">  679</span>                space[tag] = (minimum, maximum)</div>
<div class="line"><span class="lineno">  680</span>            region.append(space)</div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>        subs = {k: v <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> rule.subs}</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>        conditional_subs.append((region, subs))</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    addFeatureVariations(font, conditional_subs, featureTag)</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a58541b97bdb217fcee6b06cfeb955c46" name="a58541b97bdb217fcee6b06cfeb955c46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58541b97bdb217fcee6b06cfeb955c46">&#9670;&#160;</a></span>_add_gvar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_gvar </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masterModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_ttfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tolerance</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>optimize</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  222</span><span class="keyword">def </span>_add_gvar(font, masterModel, master_ttfs, tolerance=0.5, optimize=True):</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">if</span> tolerance &lt; 0:</div>
<div class="line"><span class="lineno">  224</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`tolerance` must be a positive number.&quot;</span>)</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    log.info(<span class="stringliteral">&quot;Generating gvar&quot;</span>)</div>
<div class="line"><span class="lineno">  227</span>    <span class="keyword">assert</span> <span class="stringliteral">&quot;gvar&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> font</div>
<div class="line"><span class="lineno">  228</span>    gvar = font[<span class="stringliteral">&quot;gvar&quot;</span>] = newTable(<span class="stringliteral">&#39;gvar&#39;</span>)</div>
<div class="line"><span class="lineno">  229</span>    glyf = font[<span class="stringliteral">&#39;glyf&#39;</span>]</div>
<div class="line"><span class="lineno">  230</span>    defaultMasterIndex = masterModel.reverseMapping[0]</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    master_datas = [_MasterData(m[<span class="stringliteral">&#39;glyf&#39;</span>],</div>
<div class="line"><span class="lineno">  233</span>                    m[<span class="stringliteral">&#39;hmtx&#39;</span>].metrics,</div>
<div class="line"><span class="lineno">  234</span>                    getattr(m.get(<span class="stringliteral">&#39;vmtx&#39;</span>), <span class="stringliteral">&#39;metrics&#39;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  235</span>            <span class="keywordflow">for</span> m <span class="keywordflow">in</span> master_ttfs]</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">for</span> glyph <span class="keywordflow">in</span> font.getGlyphOrder():</div>
<div class="line"><span class="lineno">  238</span>        log.debug(<span class="stringliteral">&quot;building gvar for glyph &#39;%s&#39;&quot;</span>, glyph)</div>
<div class="line"><span class="lineno">  239</span>        isComposite = glyf[glyph].isComposite()</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>        allData = [</div>
<div class="line"><span class="lineno">  242</span>            m.glyf._getCoordinatesAndControls(glyph, m.hMetrics, m.vMetrics)</div>
<div class="line"><span class="lineno">  243</span>            <span class="keywordflow">for</span> m <span class="keywordflow">in</span> master_datas</div>
<div class="line"><span class="lineno">  244</span>        ]</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>        <span class="keywordflow">if</span> allData[defaultMasterIndex][1].numberOfContours != 0:</div>
<div class="line"><span class="lineno">  247</span>            <span class="comment"># If the default master is not empty, interpret empty non-default masters</span></div>
<div class="line"><span class="lineno">  248</span>            <span class="comment"># as missing glyphs from a sparse master</span></div>
<div class="line"><span class="lineno">  249</span>            allData = [</div>
<div class="line"><span class="lineno">  250</span>                d <span class="keywordflow">if</span> d <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> d[1].numberOfContours != 0 <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  251</span>                <span class="keywordflow">for</span> d <span class="keywordflow">in</span> allData</div>
<div class="line"><span class="lineno">  252</span>            ]</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>        model, allData = masterModel.getSubModel(allData)</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>        allCoords = [d[0] <span class="keywordflow">for</span> d <span class="keywordflow">in</span> allData]</div>
<div class="line"><span class="lineno">  257</span>        allControls = [d[1] <span class="keywordflow">for</span> d <span class="keywordflow">in</span> allData]</div>
<div class="line"><span class="lineno">  258</span>        control = allControls[0]</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> models.allEqual(allControls):</div>
<div class="line"><span class="lineno">  260</span>            log.warning(<span class="stringliteral">&quot;glyph %s has incompatible masters; skipping&quot;</span> % glyph)</div>
<div class="line"><span class="lineno">  261</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  262</span>        del allControls</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>        <span class="comment"># Update gvar</span></div>
<div class="line"><span class="lineno">  265</span>        gvar.variations[glyph] = []</div>
<div class="line"><span class="lineno">  266</span>        deltas = model.getDeltas(allCoords, round=partial(GlyphCoordinates.__round__, round=round))</div>
<div class="line"><span class="lineno">  267</span>        supports = model.supports</div>
<div class="line"><span class="lineno">  268</span>        <span class="keyword">assert</span> len(deltas) == len(supports)</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>        <span class="comment"># Prepare for IUP optimization</span></div>
<div class="line"><span class="lineno">  271</span>        origCoords = deltas[0]</div>
<div class="line"><span class="lineno">  272</span>        endPts = control.endPts</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>        <span class="keywordflow">for</span> i,(delta,support) <span class="keywordflow">in</span> enumerate(zip(deltas[1:], supports[1:])):</div>
<div class="line"><span class="lineno">  275</span>            <span class="keywordflow">if</span> all(v == 0 <span class="keywordflow">for</span> v <span class="keywordflow">in</span> delta.array) <span class="keywordflow">and</span> <span class="keywordflow">not</span> isComposite:</div>
<div class="line"><span class="lineno">  276</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  277</span>            var = TupleVariation(support, delta)</div>
<div class="line"><span class="lineno">  278</span>            <span class="keywordflow">if</span> optimize:</div>
<div class="line"><span class="lineno">  279</span>                delta_opt = iup_delta_optimize(delta, origCoords, endPts, tolerance=tolerance)</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>                <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> delta_opt:</div>
<div class="line"><span class="lineno">  282</span>                    <span class="stringliteral">&quot;&quot;&quot;In composite glyphs, there should be one 0 entry</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">                    to make sure the gvar entry is written to the font.</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">                    This is to work around an issue with macOS 10.14 and can be</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">                    removed once the behaviour of macOS is changed.</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">                    https://github.com/fonttools/fonttools/issues/1381</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">                    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  290</span>                    <span class="keywordflow">if</span> all(d <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">for</span> d <span class="keywordflow">in</span> delta_opt):</div>
<div class="line"><span class="lineno">  291</span>                        delta_opt = [(0, 0)] + [<span class="keywordtype">None</span>] * (len(delta_opt) - 1)</div>
<div class="line"><span class="lineno">  292</span>                    <span class="comment"># Use &quot;optimized&quot; version only if smaller...</span></div>
<div class="line"><span class="lineno">  293</span>                    var_opt = TupleVariation(support, delta_opt)</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>                    axis_tags = sorted(support.keys()) <span class="comment"># Shouldn&#39;t matter that this is different from fvar...?</span></div>
<div class="line"><span class="lineno">  296</span>                    tupleData, auxData = var.compile(axis_tags)</div>
<div class="line"><span class="lineno">  297</span>                    unoptimized_len = len(tupleData) + len(auxData)</div>
<div class="line"><span class="lineno">  298</span>                    tupleData, auxData = var_opt.compile(axis_tags)</div>
<div class="line"><span class="lineno">  299</span>                    optimized_len = len(tupleData) + len(auxData)</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>                    <span class="keywordflow">if</span> optimized_len &lt; unoptimized_len:</div>
<div class="line"><span class="lineno">  302</span>                        var = var_opt</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>            gvar.variations[glyph].append(var)</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf63b8c59b4a27e36409e4056fe67cd1" name="aaf63b8c59b4a27e36409e4056fe67cd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf63b8c59b4a27e36409e4056fe67cd1">&#9670;&#160;</a></span>_add_HVAR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_HVAR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masterModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_ttfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisTags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  395</span><span class="keyword">def </span>_add_HVAR(font, masterModel, master_ttfs, axisTags):</div>
<div class="line"><span class="lineno">  396</span>    _add_VHVAR(font, masterModel, master_ttfs, axisTags, HVAR_FIELDS)</div>
<div class="line"><span class="lineno">  397</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a03ec2aafc8b20dc708835afa69db8f27" name="a03ec2aafc8b20dc708835afa69db8f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03ec2aafc8b20dc708835afa69db8f27">&#9670;&#160;</a></span>_add_MVAR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_MVAR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masterModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_ttfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisTags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  524</span><span class="keyword">def </span>_add_MVAR(font, masterModel, master_ttfs, axisTags):</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>    log.info(<span class="stringliteral">&quot;Generating MVAR&quot;</span>)</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>    store_builder = varStore.OnlineVarStoreBuilder(axisTags)</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    records = []</div>
<div class="line"><span class="lineno">  531</span>    lastTableTag = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  532</span>    fontTable = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  533</span>    tables = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  534</span>    <span class="comment"># HACK: we need to special-case post.underlineThickness and .underlinePosition</span></div>
<div class="line"><span class="lineno">  535</span>    <span class="comment"># and unilaterally/arbitrarily define a sentinel value to distinguish the case</span></div>
<div class="line"><span class="lineno">  536</span>    <span class="comment"># when a post table is present in a given master simply because that&#39;s where</span></div>
<div class="line"><span class="lineno">  537</span>    <span class="comment"># the glyph names in TrueType must be stored, but the underline values are not</span></div>
<div class="line"><span class="lineno">  538</span>    <span class="comment"># meant to be used for building MVAR&#39;s deltas. The value of -0x8000 (-36768)</span></div>
<div class="line"><span class="lineno">  539</span>    <span class="comment"># the minimum FWord (int16) value, was chosen for its unlikelyhood to appear</span></div>
<div class="line"><span class="lineno">  540</span>    <span class="comment"># in real-world underline position/thickness values.</span></div>
<div class="line"><span class="lineno">  541</span>    specialTags = {<span class="stringliteral">&quot;unds&quot;</span>: -0x8000, <span class="stringliteral">&quot;undo&quot;</span>: -0x8000}</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordflow">for</span> tag, (tableTag, itemName) <span class="keywordflow">in</span> sorted(MVAR_ENTRIES.items(), key=<span class="keyword">lambda</span> kv: kv[1]):</div>
<div class="line"><span class="lineno">  544</span>        <span class="comment"># For each tag, fetch the associated table from all fonts (or not when we are</span></div>
<div class="line"><span class="lineno">  545</span>        <span class="comment"># still looking at a tag from the same tables) and set up the variation model</span></div>
<div class="line"><span class="lineno">  546</span>        <span class="comment"># for them.</span></div>
<div class="line"><span class="lineno">  547</span>        <span class="keywordflow">if</span> tableTag != lastTableTag:</div>
<div class="line"><span class="lineno">  548</span>            tables = fontTable = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  549</span>            <span class="keywordflow">if</span> tableTag <span class="keywordflow">in</span> font:</div>
<div class="line"><span class="lineno">  550</span>                fontTable = font[tableTag]</div>
<div class="line"><span class="lineno">  551</span>                tables = []</div>
<div class="line"><span class="lineno">  552</span>                <span class="keywordflow">for</span> master <span class="keywordflow">in</span> master_ttfs:</div>
<div class="line"><span class="lineno">  553</span>                    <span class="keywordflow">if</span> tableTag <span class="keywordflow">not</span> <span class="keywordflow">in</span> master <span class="keywordflow">or</span> (</div>
<div class="line"><span class="lineno">  554</span>                        tag <span class="keywordflow">in</span> specialTags</div>
<div class="line"><span class="lineno">  555</span>                        <span class="keywordflow">and</span> getattr(master[tableTag], itemName) == specialTags[tag]</div>
<div class="line"><span class="lineno">  556</span>                    ):</div>
<div class="line"><span class="lineno">  557</span>                        tables.append(<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  558</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  559</span>                        tables.append(master[tableTag])</div>
<div class="line"><span class="lineno">  560</span>                model, tables = masterModel.getSubModel(tables)</div>
<div class="line"><span class="lineno">  561</span>                store_builder.setModel(model)</div>
<div class="line"><span class="lineno">  562</span>            lastTableTag = tableTag</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>        <span class="keywordflow">if</span> tables <span class="keywordflow">is</span> <span class="keywordtype">None</span>:  <span class="comment"># Tag not applicable to the master font.</span></div>
<div class="line"><span class="lineno">  565</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>        <span class="comment"># TODO support gasp entries</span></div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>        master_values = [getattr(table, itemName) <span class="keywordflow">for</span> table <span class="keywordflow">in</span> tables]</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">if</span> models.allEqual(master_values):</div>
<div class="line"><span class="lineno">  571</span>            base, varIdx = master_values[0], <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  572</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  573</span>            base, varIdx = store_builder.storeMasters(master_values)</div>
<div class="line"><span class="lineno">  574</span>        setattr(fontTable, itemName, base)</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>        <span class="keywordflow">if</span> varIdx <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  577</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  578</span>        log.info(<span class="stringliteral">&#39;  %s: %s.%s   %s&#39;</span>, tag, tableTag, itemName, master_values)</div>
<div class="line"><span class="lineno">  579</span>        rec = ot.MetricsValueRecord()</div>
<div class="line"><span class="lineno">  580</span>        rec.ValueTag = tag</div>
<div class="line"><span class="lineno">  581</span>        rec.VarIdx = varIdx</div>
<div class="line"><span class="lineno">  582</span>        records.append(rec)</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    <span class="keyword">assert</span> <span class="stringliteral">&quot;MVAR&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> font</div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordflow">if</span> records:</div>
<div class="line"><span class="lineno">  586</span>        store = store_builder.finish()</div>
<div class="line"><span class="lineno">  587</span>        <span class="comment"># Optimize</span></div>
<div class="line"><span class="lineno">  588</span>        mapping = store.optimize()</div>
<div class="line"><span class="lineno">  589</span>        <span class="keywordflow">for</span> rec <span class="keywordflow">in</span> records:</div>
<div class="line"><span class="lineno">  590</span>            rec.VarIdx = mapping[rec.VarIdx]</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>        MVAR = font[<span class="stringliteral">&quot;MVAR&quot;</span>] = newTable(<span class="stringliteral">&#39;MVAR&#39;</span>)</div>
<div class="line"><span class="lineno">  593</span>        mvar = MVAR.table = ot.MVAR()</div>
<div class="line"><span class="lineno">  594</span>        mvar.Version = 0x00010000</div>
<div class="line"><span class="lineno">  595</span>        mvar.Reserved = 0</div>
<div class="line"><span class="lineno">  596</span>        mvar.VarStore = store</div>
<div class="line"><span class="lineno">  597</span>        <span class="comment"># XXX these should not be hard-coded but computed automatically</span></div>
<div class="line"><span class="lineno">  598</span>        mvar.ValueRecordSize = 8</div>
<div class="line"><span class="lineno">  599</span>        mvar.ValueRecordCount = len(records)</div>
<div class="line"><span class="lineno">  600</span>        mvar.ValueRecord = sorted(records, key=<span class="keyword">lambda</span> r: r.ValueTag)</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a34d499c45c2894093ac97181df6f619e" name="a34d499c45c2894093ac97181df6f619e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34d499c45c2894093ac97181df6f619e">&#9670;&#160;</a></span>_add_stat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_stat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  207</span><span class="keyword">def </span>_add_stat(font):</div>
<div class="line"><span class="lineno">  208</span>    <span class="comment"># Note: this function only gets called by old code that calls `build()`</span></div>
<div class="line"><span class="lineno">  209</span>    <span class="comment"># directly. Newer code that wants to benefit from STAT data from the</span></div>
<div class="line"><span class="lineno">  210</span>    <span class="comment"># designspace should call `build_many()`</span></div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;STAT&quot;</span> <span class="keywordflow">in</span> font:</div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <span class="keyword">from</span> ..otlLib.builder <span class="keyword">import</span> buildStatTable</div>
<div class="line"><span class="lineno">  216</span>    fvarTable = font[<span class="stringliteral">&#39;fvar&#39;</span>]</div>
<div class="line"><span class="lineno">  217</span>    axes = [dict(tag=a.axisTag, name=a.axisNameID) <span class="keywordflow">for</span> a <span class="keywordflow">in</span> fvarTable.axes]</div>
<div class="line"><span class="lineno">  218</span>    buildStatTable(font, axes)</div>
<div class="line"><span class="lineno">  219</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3521642acbdf77b75e2685aadb061af7" name="a3521642acbdf77b75e2685aadb061af7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3521642acbdf77b75e2685aadb061af7">&#9670;&#160;</a></span>_add_VHVAR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_VHVAR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masterModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_ttfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisTags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tableFields</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  401</span><span class="keyword">def </span>_add_VHVAR(font, masterModel, master_ttfs, axisTags, tableFields):</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>    tableTag = tableFields.tableTag</div>
<div class="line"><span class="lineno">  404</span>    <span class="keyword">assert</span> tableTag <span class="keywordflow">not</span> <span class="keywordflow">in</span> font</div>
<div class="line"><span class="lineno">  405</span>    log.info(<span class="stringliteral">&quot;Generating &quot;</span> + tableTag)</div>
<div class="line"><span class="lineno">  406</span>    VHVAR = newTable(tableTag)</div>
<div class="line"><span class="lineno">  407</span>    tableClass = getattr(ot, tableTag)</div>
<div class="line"><span class="lineno">  408</span>    vhvar = VHVAR.table = tableClass()</div>
<div class="line"><span class="lineno">  409</span>    vhvar.Version = 0x00010000</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    glyphOrder = font.getGlyphOrder()</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    <span class="comment"># Build list of source font advance widths for each glyph</span></div>
<div class="line"><span class="lineno">  414</span>    metricsTag = tableFields.metricsTag</div>
<div class="line"><span class="lineno">  415</span>    advMetricses = [m[metricsTag].metrics <span class="keywordflow">for</span> m <span class="keywordflow">in</span> master_ttfs]</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="comment"># Build list of source font vertical origin coords for each glyph</span></div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">if</span> tableTag == <span class="stringliteral">&#39;VVAR&#39;</span> <span class="keywordflow">and</span> <span class="stringliteral">&#39;VORG&#39;</span> <span class="keywordflow">in</span> master_ttfs[0]:</div>
<div class="line"><span class="lineno">  419</span>        vOrigMetricses = [m[<span class="stringliteral">&#39;VORG&#39;</span>].VOriginRecords <span class="keywordflow">for</span> m <span class="keywordflow">in</span> master_ttfs]</div>
<div class="line"><span class="lineno">  420</span>        defaultYOrigs = [m[<span class="stringliteral">&#39;VORG&#39;</span>].defaultVertOriginY <span class="keywordflow">for</span> m <span class="keywordflow">in</span> master_ttfs]</div>
<div class="line"><span class="lineno">  421</span>        vOrigMetricses = list(zip(vOrigMetricses, defaultYOrigs))</div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  423</span>        vOrigMetricses = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    metricsStore, advanceMapping, vOrigMapping = _get_advance_metrics(font,</div>
<div class="line"><span class="lineno">  426</span>        masterModel, master_ttfs, axisTags, glyphOrder, advMetricses,</div>
<div class="line"><span class="lineno">  427</span>        vOrigMetricses)</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    vhvar.VarStore = metricsStore</div>
<div class="line"><span class="lineno">  430</span>    <span class="keywordflow">if</span> advanceMapping <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  431</span>        setattr(vhvar, tableFields.advMapping, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  433</span>        setattr(vhvar, tableFields.advMapping, advanceMapping)</div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordflow">if</span> vOrigMapping <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  435</span>        setattr(vhvar, tableFields.vOrigMapping, vOrigMapping)</div>
<div class="line"><span class="lineno">  436</span>    setattr(vhvar, tableFields.sb1, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  437</span>    setattr(vhvar, tableFields.sb2, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>    font[tableTag] = VHVAR</div>
<div class="line"><span class="lineno">  440</span>    <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  441</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c2c249b47478ed37728980c176b1af3" name="a6c2c249b47478ed37728980c176b1af3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c2c249b47478ed37728980c176b1af3">&#9670;&#160;</a></span>_add_VVAR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._add_VVAR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masterModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_ttfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisTags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  398</span><span class="keyword">def </span>_add_VVAR(font, masterModel, master_ttfs, axisTags):</div>
<div class="line"><span class="lineno">  399</span>    _add_VHVAR(font, masterModel, master_ttfs, axisTags, VVAR_FIELDS)</div>
<div class="line"><span class="lineno">  400</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae236a172e1f1a4fe47645ec18626c9ad" name="ae236a172e1f1a4fe47645ec18626c9ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae236a172e1f1a4fe47645ec18626c9ad">&#9670;&#160;</a></span>_get_advance_metrics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._get_advance_metrics </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masterModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_ttfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisTags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>glyphOrder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>advMetricses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vOrigMetricses</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  443</span>        axisTags, glyphOrder, advMetricses, vOrigMetricses=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    vhAdvanceDeltasAndSupports = {}</div>
<div class="line"><span class="lineno">  446</span>    vOrigDeltasAndSupports = {}</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">for</span> glyph <span class="keywordflow">in</span> glyphOrder:</div>
<div class="line"><span class="lineno">  448</span>        vhAdvances = [metrics[glyph][0] <span class="keywordflow">if</span> glyph <span class="keywordflow">in</span> metrics <span class="keywordflow">else</span> <span class="keywordtype">None</span> <span class="keywordflow">for</span> metrics <span class="keywordflow">in</span> advMetricses]</div>
<div class="line"><span class="lineno">  449</span>        vhAdvanceDeltasAndSupports[glyph] = masterModel.getDeltasAndSupports(vhAdvances, round=round)</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    singleModel = models.allEqual(id(v[1]) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> vhAdvanceDeltasAndSupports.values())</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">if</span> vOrigMetricses:</div>
<div class="line"><span class="lineno">  454</span>        singleModel = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  455</span>        <span class="keywordflow">for</span> glyph <span class="keywordflow">in</span> glyphOrder:</div>
<div class="line"><span class="lineno">  456</span>            <span class="comment"># We need to supply a vOrigs tuple with non-None default values</span></div>
<div class="line"><span class="lineno">  457</span>            <span class="comment"># for each glyph. vOrigMetricses contains values only for those</span></div>
<div class="line"><span class="lineno">  458</span>            <span class="comment"># glyphs which have a non-default vOrig.</span></div>
<div class="line"><span class="lineno">  459</span>            vOrigs = [metrics[glyph] <span class="keywordflow">if</span> glyph <span class="keywordflow">in</span> metrics <span class="keywordflow">else</span> defaultVOrig</div>
<div class="line"><span class="lineno">  460</span>                <span class="keywordflow">for</span> metrics, defaultVOrig <span class="keywordflow">in</span> vOrigMetricses]</div>
<div class="line"><span class="lineno">  461</span>            vOrigDeltasAndSupports[glyph] = masterModel.getDeltasAndSupports(vOrigs, round=round)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    directStore = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordflow">if</span> singleModel:</div>
<div class="line"><span class="lineno">  465</span>        <span class="comment"># Build direct mapping</span></div>
<div class="line"><span class="lineno">  466</span>        supports = next(<a class="code hl_variable" href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a>(vhAdvanceDeltasAndSupports.values()))[1][1:]</div>
<div class="line"><span class="lineno">  467</span>        varTupleList = builder.buildVarRegionList(supports, axisTags)</div>
<div class="line"><span class="lineno">  468</span>        varTupleIndexes = list(range(len(supports)))</div>
<div class="line"><span class="lineno">  469</span>        varData = builder.buildVarData(varTupleIndexes, [], optimize=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  470</span>        <span class="keywordflow">for</span> glyphName <span class="keywordflow">in</span> glyphOrder:</div>
<div class="line"><span class="lineno">  471</span>            varData.addItem(vhAdvanceDeltasAndSupports[glyphName][0], round=noRound)</div>
<div class="line"><span class="lineno">  472</span>        varData.optimize()</div>
<div class="line"><span class="lineno">  473</span>        directStore = builder.buildVarStore(varTupleList, [varData])</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="comment"># Build optimized indirect mapping</span></div>
<div class="line"><span class="lineno">  476</span>    storeBuilder = varStore.OnlineVarStoreBuilder(axisTags)</div>
<div class="line"><span class="lineno">  477</span>    advMapping = {}</div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordflow">for</span> glyphName <span class="keywordflow">in</span> glyphOrder:</div>
<div class="line"><span class="lineno">  479</span>        deltas, supports = vhAdvanceDeltasAndSupports[glyphName]</div>
<div class="line"><span class="lineno">  480</span>        storeBuilder.setSupports(supports)</div>
<div class="line"><span class="lineno">  481</span>        advMapping[glyphName] = storeBuilder.storeDeltas(deltas, round=noRound)</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">if</span> vOrigMetricses:</div>
<div class="line"><span class="lineno">  484</span>        vOrigMap = {}</div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">for</span> glyphName <span class="keywordflow">in</span> glyphOrder:</div>
<div class="line"><span class="lineno">  486</span>            deltas, supports = vOrigDeltasAndSupports[glyphName]</div>
<div class="line"><span class="lineno">  487</span>            storeBuilder.setSupports(supports)</div>
<div class="line"><span class="lineno">  488</span>            vOrigMap[glyphName] = storeBuilder.storeDeltas(deltas, round=noRound)</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>    indirectStore = storeBuilder.finish()</div>
<div class="line"><span class="lineno">  491</span>    mapping2 = indirectStore.optimize(use_NO_VARIATION_INDEX=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  492</span>    advMapping = [mapping2[advMapping[g]] <span class="keywordflow">for</span> g <span class="keywordflow">in</span> glyphOrder]</div>
<div class="line"><span class="lineno">  493</span>    advanceMapping = builder.buildVarIdxMap(advMapping, glyphOrder)</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">if</span> vOrigMetricses:</div>
<div class="line"><span class="lineno">  496</span>        vOrigMap = [mapping2[vOrigMap[g]] <span class="keywordflow">for</span> g <span class="keywordflow">in</span> glyphOrder]</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>    useDirect = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  499</span>    vOrigMapping = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordflow">if</span> directStore:</div>
<div class="line"><span class="lineno">  501</span>        <span class="comment"># Compile both, see which is more compact</span></div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>        writer = OTTableWriter()</div>
<div class="line"><span class="lineno">  504</span>        directStore.compile(writer, font)</div>
<div class="line"><span class="lineno">  505</span>        directSize = len(writer.getAllData())</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>        writer = OTTableWriter()</div>
<div class="line"><span class="lineno">  508</span>        indirectStore.compile(writer, font)</div>
<div class="line"><span class="lineno">  509</span>        advanceMapping.compile(writer, font)</div>
<div class="line"><span class="lineno">  510</span>        indirectSize = len(writer.getAllData())</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>        useDirect = directSize &lt; indirectSize</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">if</span> useDirect:</div>
<div class="line"><span class="lineno">  515</span>        metricsStore = directStore</div>
<div class="line"><span class="lineno">  516</span>        advanceMapping = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  517</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  518</span>        metricsStore = indirectStore</div>
<div class="line"><span class="lineno">  519</span>        <span class="keywordflow">if</span> vOrigMetricses:</div>
<div class="line"><span class="lineno">  520</span>            vOrigMapping = builder.buildVarIdxMap(vOrigMap, glyphOrder)</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">return</span> metricsStore, advanceMapping, vOrigMapping</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_a60590d91febfcb54d88443940cd5f23e"><div class="ttname"><a href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a></div><div class="ttdeci">void int double int double double double double int int * iter</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:623</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaac9f371412903f9d55222ca4eebad96" name="aaac9f371412903f9d55222ca4eebad96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaac9f371412903f9d55222ca4eebad96">&#9670;&#160;</a></span>_merge_OTL()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._merge_OTL </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_fonts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisTags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  619</span><span class="keyword">def </span>_merge_OTL(font, model, master_fonts, axisTags):</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    log.info(<span class="stringliteral">&quot;Merging OpenType Layout tables&quot;</span>)</div>
<div class="line"><span class="lineno">  622</span>    merger = VariationMerger(model, axisTags, font)</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    merger.mergeTables(font, master_fonts, [<span class="stringliteral">&#39;GSUB&#39;</span>, <span class="stringliteral">&#39;GDEF&#39;</span>, <span class="stringliteral">&#39;GPOS&#39;</span>])</div>
<div class="line"><span class="lineno">  625</span>    store = merger.store_builder.finish()</div>
<div class="line"><span class="lineno">  626</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> store:</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  628</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  629</span>        GDEF = font[<span class="stringliteral">&#39;GDEF&#39;</span>].table</div>
<div class="line"><span class="lineno">  630</span>        <span class="keyword">assert</span> GDEF.Version &lt;= 0x00010002</div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordflow">except</span> KeyError:</div>
<div class="line"><span class="lineno">  632</span>        font[<span class="stringliteral">&#39;GDEF&#39;</span>] = newTable(<span class="stringliteral">&#39;GDEF&#39;</span>)</div>
<div class="line"><span class="lineno">  633</span>        GDEFTable = font[<span class="stringliteral">&quot;GDEF&quot;</span>] = newTable(<span class="stringliteral">&#39;GDEF&#39;</span>)</div>
<div class="line"><span class="lineno">  634</span>        GDEF = GDEFTable.table = ot.GDEF()</div>
<div class="line"><span class="lineno">  635</span>        GDEF.GlyphClassDef = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  636</span>        GDEF.AttachList = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  637</span>        GDEF.LigCaretList = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  638</span>        GDEF.MarkAttachClassDef = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  639</span>        GDEF.MarkGlyphSetsDef = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>    GDEF.Version = 0x00010003</div>
<div class="line"><span class="lineno">  642</span>    GDEF.VarStore = store</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>    <span class="comment"># Optimize</span></div>
<div class="line"><span class="lineno">  645</span>    varidx_map = store.optimize()</div>
<div class="line"><span class="lineno">  646</span>    GDEF.remap_device_varidxes(varidx_map)</div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;GPOS&#39;</span> <span class="keywordflow">in</span> font:</div>
<div class="line"><span class="lineno">  648</span>        font[<span class="stringliteral">&#39;GPOS&#39;</span>].table.remap_device_varidxes(varidx_map)</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e4120aa9b071ece050dd8b308f5fe6a" name="a9e4120aa9b071ece050dd8b308f5fe6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e4120aa9b071ece050dd8b308f5fe6a">&#9670;&#160;</a></span>_merge_TTHinting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._merge_TTHinting </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masterModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_ttfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  318</span><span class="keyword">def </span>_merge_TTHinting(font, masterModel, master_ttfs):</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>    log.info(<span class="stringliteral">&quot;Merging TT hinting&quot;</span>)</div>
<div class="line"><span class="lineno">  321</span>    <span class="keyword">assert</span> <span class="stringliteral">&quot;cvar&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> font</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="comment"># Check that the existing hinting is compatible</span></div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>    <span class="comment"># fpgm and prep table</span></div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">for</span> tag <span class="keywordflow">in</span> (<span class="stringliteral">&quot;fpgm&quot;</span>, <span class="stringliteral">&quot;prep&quot;</span>):</div>
<div class="line"><span class="lineno">  328</span>        all_pgms = [m[tag].program <span class="keywordflow">for</span> m <span class="keywordflow">in</span> master_ttfs <span class="keywordflow">if</span> tag <span class="keywordflow">in</span> m]</div>
<div class="line"><span class="lineno">  329</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> all_pgms:</div>
<div class="line"><span class="lineno">  330</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  331</span>        font_pgm = getattr(font.get(tag), <span class="stringliteral">&#39;program&#39;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  332</span>        <span class="keywordflow">if</span> any(pgm != font_pgm <span class="keywordflow">for</span> pgm <span class="keywordflow">in</span> all_pgms):</div>
<div class="line"><span class="lineno">  333</span>            log.warning(<span class="stringliteral">&quot;Masters have incompatible %s tables, hinting is discarded.&quot;</span> % tag)</div>
<div class="line"><span class="lineno">  334</span>            _remove_TTHinting(font)</div>
<div class="line"><span class="lineno">  335</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>    <span class="comment"># glyf table</span></div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    font_glyf = font[<span class="stringliteral">&#39;glyf&#39;</span>]</div>
<div class="line"><span class="lineno">  340</span>    master_glyfs = [m[<span class="stringliteral">&#39;glyf&#39;</span>] <span class="keywordflow">for</span> m <span class="keywordflow">in</span> master_ttfs]</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">for</span> name, glyph <span class="keywordflow">in</span> font_glyf.glyphs.items():</div>
<div class="line"><span class="lineno">  342</span>        all_pgms = [</div>
<div class="line"><span class="lineno">  343</span>            getattr(glyf.get(name), <span class="stringliteral">&#39;program&#39;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  344</span>            <span class="keywordflow">for</span> glyf <span class="keywordflow">in</span> master_glyfs</div>
<div class="line"><span class="lineno">  345</span>        ]</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> any(all_pgms):</div>
<div class="line"><span class="lineno">  347</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  348</span>        glyph.expand(font_glyf)</div>
<div class="line"><span class="lineno">  349</span>        font_pgm = getattr(glyph, <span class="stringliteral">&#39;program&#39;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  350</span>        <span class="keywordflow">if</span> any(pgm != font_pgm <span class="keywordflow">for</span> pgm <span class="keywordflow">in</span> all_pgms <span class="keywordflow">if</span> pgm):</div>
<div class="line"><span class="lineno">  351</span>            log.warning(<span class="stringliteral">&quot;Masters have incompatible glyph programs in glyph &#39;%s&#39;, hinting is discarded.&quot;</span> % name)</div>
<div class="line"><span class="lineno">  352</span>            <span class="comment"># TODO Only drop hinting from this glyph.</span></div>
<div class="line"><span class="lineno">  353</span>            _remove_TTHinting(font)</div>
<div class="line"><span class="lineno">  354</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <span class="comment"># cvt table</span></div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    all_cvs = [Vector(m[<span class="stringliteral">&quot;cvt &quot;</span>].values) <span class="keywordflow">if</span> <span class="stringliteral">&#39;cvt &#39;</span> <span class="keywordflow">in</span> m <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  359</span>           <span class="keywordflow">for</span> m <span class="keywordflow">in</span> master_ttfs]</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>    nonNone_cvs = models.nonNone(all_cvs)</div>
<div class="line"><span class="lineno">  362</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> nonNone_cvs:</div>
<div class="line"><span class="lineno">  363</span>        <span class="comment"># There is no cvt table to make a cvar table from, we&#39;re done here.</span></div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> models.allEqual(len(c) <span class="keywordflow">for</span> c <span class="keywordflow">in</span> nonNone_cvs):</div>
<div class="line"><span class="lineno">  367</span>        log.warning(<span class="stringliteral">&quot;Masters have incompatible cvt tables, hinting is discarded.&quot;</span>)</div>
<div class="line"><span class="lineno">  368</span>        _remove_TTHinting(font)</div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    variations = []</div>
<div class="line"><span class="lineno">  372</span>    deltas, supports = masterModel.getDeltasAndSupports(all_cvs, round=round) <span class="comment"># builtin round calls into Vector.__round__, which uses builtin round as we like</span></div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordflow">for</span> i,(delta,support) <span class="keywordflow">in</span> enumerate(zip(deltas[1:], supports[1:])):</div>
<div class="line"><span class="lineno">  374</span>        <span class="keywordflow">if</span> all(v == 0 <span class="keywordflow">for</span> v <span class="keywordflow">in</span> delta):</div>
<div class="line"><span class="lineno">  375</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  376</span>        var = TupleVariation(support, delta)</div>
<div class="line"><span class="lineno">  377</span>        variations.append(var)</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    <span class="comment"># We can build the cvar table now.</span></div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">if</span> variations:</div>
<div class="line"><span class="lineno">  381</span>        cvar = font[<span class="stringliteral">&quot;cvar&quot;</span>] = newTable(<span class="stringliteral">&#39;cvar&#39;</span>)</div>
<div class="line"><span class="lineno">  382</span>        cvar.version = 1</div>
<div class="line"><span class="lineno">  383</span>        cvar.variations = variations</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a460771810b56b6fe74fcc65cc7256b88" name="a460771810b56b6fe74fcc65cc7256b88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a460771810b56b6fe74fcc65cc7256b88">&#9670;&#160;</a></span>_open_font()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._open_font </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_finder</em> = <code><a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a>&#160;s:&#160;s</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1025</span><span class="keyword">def </span>_open_font(path, master_finder=lambda s: s):</div>
<div class="line"><span class="lineno"> 1026</span>    <span class="comment"># load TTFont masters from given &#39;path&#39;: this can be either a .TTX or an</span></div>
<div class="line"><span class="lineno"> 1027</span>    <span class="comment"># OpenType binary font; or if neither of these, try use the &#39;master_finder&#39;</span></div>
<div class="line"><span class="lineno"> 1028</span>    <span class="comment"># callable to resolve the path to a valid .TTX or OpenType font binary.</span></div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keyword">from</span> <a class="code hl_namespace" href="namespacefont_tools_1_1ttx.html">fontTools.ttx</a> <span class="keyword">import</span> guessFileType</div>
<div class="line"><span class="lineno"> 1030</span> </div>
<div class="line"><span class="lineno"> 1031</span>    master_path = os.path.normpath(path)</div>
<div class="line"><span class="lineno"> 1032</span>    tp = guessFileType(master_path)</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="keywordflow">if</span> tp <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1034</span>        <span class="comment"># not an OpenType binary/ttx, fall back to the master finder.</span></div>
<div class="line"><span class="lineno"> 1035</span>        master_path = master_finder(master_path)</div>
<div class="line"><span class="lineno"> 1036</span>        tp = guessFileType(master_path)</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">if</span> tp <span class="keywordflow">in</span> (<span class="stringliteral">&quot;TTX&quot;</span>, <span class="stringliteral">&quot;OTX&quot;</span>):</div>
<div class="line"><span class="lineno"> 1038</span>        font = TTFont()</div>
<div class="line"><span class="lineno"> 1039</span>        font.importXML(master_path)</div>
<div class="line"><span class="lineno"> 1040</span>    <span class="keywordflow">elif</span> tp <span class="keywordflow">in</span> (<span class="stringliteral">&quot;TTF&quot;</span>, <span class="stringliteral">&quot;OTF&quot;</span>, <span class="stringliteral">&quot;WOFF&quot;</span>, <span class="stringliteral">&quot;WOFF2&quot;</span>):</div>
<div class="line"><span class="lineno"> 1041</span>        font = TTFont(master_path)</div>
<div class="line"><span class="lineno"> 1042</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1043</span>        <span class="keywordflow">raise</span> VarLibValidationError(<span class="stringliteral">&quot;Invalid master path: %r&quot;</span> % master_path)</div>
<div class="line"><span class="lineno"> 1044</span>    <span class="keywordflow">return</span> font</div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="ttc" id="anamespacefont_tools_1_1ttx_html"><div class="ttname"><a href="namespacefont_tools_1_1ttx.html">fontTools.ttx</a></div><div class="ttdef"><b>Definition</b> ttx.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a526f4ec0e198703c9b8823cddd9b2bc9" name="a526f4ec0e198703c9b8823cddd9b2bc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a526f4ec0e198703c9b8823cddd9b2bc9">&#9670;&#160;</a></span>_remove_TTHinting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._remove_TTHinting </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  307</span><span class="keyword">def </span>_remove_TTHinting(font):</div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">for</span> tag <span class="keywordflow">in</span> (<span class="stringliteral">&quot;cvar&quot;</span>, <span class="stringliteral">&quot;cvt &quot;</span>, <span class="stringliteral">&quot;fpgm&quot;</span>, <span class="stringliteral">&quot;prep&quot;</span>):</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">if</span> tag <span class="keywordflow">in</span> font:</div>
<div class="line"><span class="lineno">  310</span>            del font[tag]</div>
<div class="line"><span class="lineno">  311</span>    maxp = font[<span class="stringliteral">&#39;maxp&#39;</span>]</div>
<div class="line"><span class="lineno">  312</span>    <span class="keywordflow">for</span> attr <span class="keywordflow">in</span> (<span class="stringliteral">&quot;maxTwilightPoints&quot;</span>, <span class="stringliteral">&quot;maxStorage&quot;</span>, <span class="stringliteral">&quot;maxFunctionDefs&quot;</span>, <span class="stringliteral">&quot;maxInstructionDefs&quot;</span>, <span class="stringliteral">&quot;maxStackElements&quot;</span>, <span class="stringliteral">&quot;maxSizeOfInstructions&quot;</span>):</div>
<div class="line"><span class="lineno">  313</span>        setattr(maxp, attr, 0)</div>
<div class="line"><span class="lineno">  314</span>    maxp.maxZones = 1</div>
<div class="line"><span class="lineno">  315</span>    font[<span class="stringliteral">&quot;glyf&quot;</span>].removeHinting()</div>
<div class="line"><span class="lineno">  316</span>    <span class="comment"># TODO: Modify gasp table to deactivate gridfitting for all ranges?</span></div>
<div class="line"><span class="lineno">  317</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0729a75ad14ffc81feb6461163eba4a7" name="a0729a75ad14ffc81feb6461163eba4a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0729a75ad14ffc81feb6461163eba4a7">&#9670;&#160;</a></span>build()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.build </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>designspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_finder</em> = <code><a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a>&#160;s:s</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exclude</em> = <code>[]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>optimize</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>colr_layer_reuse</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Build variation font from a designspace file.

    If master_finder is set, it should be a callable that takes master
    filename as found in designspace file and map it to master font
    binary as to be opened (eg. .ttf or .otf).</pre> <div class="fragment"><div class="line"><span class="lineno">  932</span>):</div>
<div class="line"><span class="lineno">  933</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral">    Build variation font from a designspace file.</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">    If master_finder is set, it should be a callable that takes master</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">    filename as found in designspace file and map it to master font</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral">    binary as to be opened (eg. .ttf or .otf).</span></div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  940</span>    <span class="keywordflow">if</span> hasattr(designspace, <span class="stringliteral">&quot;sources&quot;</span>):  <span class="comment"># Assume a DesignspaceDocument</span></div>
<div class="line"><span class="lineno">  941</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  942</span>    <span class="keywordflow">else</span>:  <span class="comment"># Assume a file path</span></div>
<div class="line"><span class="lineno">  943</span>        designspace = DesignSpaceDocument.fromfile(designspace)</div>
<div class="line"><span class="lineno">  944</span> </div>
<div class="line"><span class="lineno">  945</span>    ds = load_designspace(designspace)</div>
<div class="line"><span class="lineno">  946</span>    log.info(<span class="stringliteral">&quot;Building variable font&quot;</span>)</div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>    log.info(<span class="stringliteral">&quot;Loading master fonts&quot;</span>)</div>
<div class="line"><span class="lineno">  949</span>    master_fonts = load_masters(designspace, master_finder)</div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>    <span class="comment"># TODO: &#39;master_ttfs&#39; is unused except for return value, remove later</span></div>
<div class="line"><span class="lineno">  952</span>    master_ttfs = []</div>
<div class="line"><span class="lineno">  953</span>    <span class="keywordflow">for</span> master <span class="keywordflow">in</span> master_fonts:</div>
<div class="line"><span class="lineno">  954</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  955</span>            master_ttfs.append(master.reader.file.name)</div>
<div class="line"><span class="lineno">  956</span>        <span class="keywordflow">except</span> AttributeError:</div>
<div class="line"><span class="lineno">  957</span>            master_ttfs.append(<span class="keywordtype">None</span>)  <span class="comment"># in-memory fonts have no path</span></div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span>    <span class="comment"># Copy the base master to work from it</span></div>
<div class="line"><span class="lineno">  960</span>    vf = deepcopy(master_fonts[ds.base_idx])</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>    <span class="comment"># TODO append masters as named-instances as well; needs .designspace change.</span></div>
<div class="line"><span class="lineno">  963</span>    fvar = _add_fvar(vf, ds.axes, ds.instances)</div>
<div class="line"><span class="lineno">  964</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;STAT&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude:</div>
<div class="line"><span class="lineno">  965</span>        _add_stat(vf)</div>
<div class="line"><span class="lineno">  966</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;avar&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude:</div>
<div class="line"><span class="lineno">  967</span>        _add_avar(vf, ds.axes)</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>    <span class="comment"># Map from axis names to axis tags...</span></div>
<div class="line"><span class="lineno">  970</span>    normalized_master_locs = [</div>
<div class="line"><span class="lineno">  971</span>        {ds.axes[k].tag: v <span class="keywordflow">for</span> k,v <span class="keywordflow">in</span> loc.items()} <span class="keywordflow">for</span> loc <span class="keywordflow">in</span> ds.normalized_master_locs</div>
<div class="line"><span class="lineno">  972</span>    ]</div>
<div class="line"><span class="lineno">  973</span>    <span class="comment"># From here on, we use fvar axes only</span></div>
<div class="line"><span class="lineno">  974</span>    axisTags = [axis.axisTag <span class="keywordflow">for</span> axis <span class="keywordflow">in</span> fvar.axes]</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>    <span class="comment"># Assume single-model for now.</span></div>
<div class="line"><span class="lineno">  977</span>    model = models.VariationModel(normalized_master_locs, axisOrder=axisTags)</div>
<div class="line"><span class="lineno">  978</span>    <span class="keyword">assert</span> 0 == model.mapping[ds.base_idx]</div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>    log.info(<span class="stringliteral">&quot;Building variations tables&quot;</span>)</div>
<div class="line"><span class="lineno">  981</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;BASE&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude <span class="keywordflow">and</span> <span class="stringliteral">&#39;BASE&#39;</span> <span class="keywordflow">in</span> vf:</div>
<div class="line"><span class="lineno">  982</span>        _add_BASE(vf, model, master_fonts, axisTags)</div>
<div class="line"><span class="lineno">  983</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;MVAR&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude:</div>
<div class="line"><span class="lineno">  984</span>        _add_MVAR(vf, model, master_fonts, axisTags)</div>
<div class="line"><span class="lineno">  985</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;HVAR&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude:</div>
<div class="line"><span class="lineno">  986</span>        _add_HVAR(vf, model, master_fonts, axisTags)</div>
<div class="line"><span class="lineno">  987</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;VVAR&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude <span class="keywordflow">and</span> <span class="stringliteral">&#39;vmtx&#39;</span> <span class="keywordflow">in</span> vf:</div>
<div class="line"><span class="lineno">  988</span>        _add_VVAR(vf, model, master_fonts, axisTags)</div>
<div class="line"><span class="lineno">  989</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;GDEF&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude <span class="keywordflow">or</span> <span class="stringliteral">&#39;GPOS&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude:</div>
<div class="line"><span class="lineno">  990</span>        _merge_OTL(vf, model, master_fonts, axisTags)</div>
<div class="line"><span class="lineno">  991</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;gvar&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude <span class="keywordflow">and</span> <span class="stringliteral">&#39;glyf&#39;</span> <span class="keywordflow">in</span> vf:</div>
<div class="line"><span class="lineno">  992</span>        _add_gvar(vf, model, master_fonts, optimize=optimize)</div>
<div class="line"><span class="lineno">  993</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;cvar&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude <span class="keywordflow">and</span> <span class="stringliteral">&#39;glyf&#39;</span> <span class="keywordflow">in</span> vf:</div>
<div class="line"><span class="lineno">  994</span>        _merge_TTHinting(vf, model, master_fonts)</div>
<div class="line"><span class="lineno">  995</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;GSUB&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude <span class="keywordflow">and</span> ds.rules:</div>
<div class="line"><span class="lineno">  996</span>        featureTag = ds.lib.get(</div>
<div class="line"><span class="lineno">  997</span>            FEAVAR_FEATURETAG_LIB_KEY,</div>
<div class="line"><span class="lineno">  998</span>            <span class="stringliteral">&quot;rclt&quot;</span> <span class="keywordflow">if</span> ds.rulesProcessingLast <span class="keywordflow">else</span> <span class="stringliteral">&quot;rvrn&quot;</span></div>
<div class="line"><span class="lineno">  999</span>        )</div>
<div class="line"><span class="lineno"> 1000</span>        _add_GSUB_feature_variations(vf, ds.axes, ds.internal_axis_supports, ds.rules, featureTag)</div>
<div class="line"><span class="lineno"> 1001</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;CFF2&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude <span class="keywordflow">and</span> (<span class="stringliteral">&#39;CFF &#39;</span> <span class="keywordflow">in</span> vf <span class="keywordflow">or</span> <span class="stringliteral">&#39;CFF2&#39;</span> <span class="keywordflow">in</span> vf):</div>
<div class="line"><span class="lineno"> 1002</span>        _add_CFF2(vf, model, master_fonts)</div>
<div class="line"><span class="lineno"> 1003</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;post&quot;</span> <span class="keywordflow">in</span> vf:</div>
<div class="line"><span class="lineno"> 1004</span>            <span class="comment"># set &#39;post&#39; to format 2 to keep the glyph names dropped from CFF2</span></div>
<div class="line"><span class="lineno"> 1005</span>            post = vf[<span class="stringliteral">&quot;post&quot;</span>]</div>
<div class="line"><span class="lineno"> 1006</span>            <span class="keywordflow">if</span> post.formatType != 2.0:</div>
<div class="line"><span class="lineno"> 1007</span>                post.formatType = 2.0</div>
<div class="line"><span class="lineno"> 1008</span>                post.extraNames = []</div>
<div class="line"><span class="lineno"> 1009</span>                post.mapping = {}</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;COLR&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude <span class="keywordflow">and</span> <span class="stringliteral">&#39;COLR&#39;</span> <span class="keywordflow">in</span> vf <span class="keywordflow">and</span> vf[<span class="stringliteral">&#39;COLR&#39;</span>].version &gt; 0:</div>
<div class="line"><span class="lineno"> 1011</span>        _add_COLR(vf, model, master_fonts, axisTags, colr_layer_reuse)</div>
<div class="line"><span class="lineno"> 1012</span> </div>
<div class="line"><span class="lineno"> 1013</span>    set_default_weight_width_slant(</div>
<div class="line"><span class="lineno"> 1014</span>        vf, location={axis.axisTag: axis.defaultValue <span class="keywordflow">for</span> axis <span class="keywordflow">in</span> vf[<span class="stringliteral">&quot;fvar&quot;</span>].axes}</div>
<div class="line"><span class="lineno"> 1015</span>    )</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>    <span class="keywordflow">for</span> tag <span class="keywordflow">in</span> exclude:</div>
<div class="line"><span class="lineno"> 1018</span>        <span class="keywordflow">if</span> tag <span class="keywordflow">in</span> vf:</div>
<div class="line"><span class="lineno"> 1019</span>            del vf[tag]</div>
<div class="line"><span class="lineno"> 1020</span> </div>
<div class="line"><span class="lineno"> 1021</span>    <span class="comment"># TODO: Only return vf for 4.0+, the rest is unused.</span></div>
<div class="line"><span class="lineno"> 1022</span>    <span class="keywordflow">return</span> vf, model, master_ttfs</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e62848333335c9aea72c7b01ed30998" name="a2e62848333335c9aea72c7b01ed30998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e62848333335c9aea72c7b01ed30998">&#9670;&#160;</a></span>build_many()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.build_many </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfont_tools_1_1designspace_lib_1_1_design_space_document.html">DesignSpaceDocument</a>&#160;</td>
          <td class="paramname"><em>designspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_finder</em> = <code><a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a>&#160;s:s</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exclude</em> = <code>[]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>optimize</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>skip_vf</em> = <code><a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a>&#160;vf_name:&#160;False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>colr_layer_reuse</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Build variable fonts from a designspace file, version 5 which can define
    several VFs, or version 4 which has implicitly one VF covering the whole doc.

    If master_finder is set, it should be a callable that takes master
    filename as found in designspace file and map it to master font
    binary as to be opened (eg. .ttf or .otf).

    skip_vf can be used to skip building some of the variable fonts defined in
    the input designspace. It's a predicate that takes as argument the name
    of the variable font and returns `bool`.

    Always returns a Dict[str, TTFont] keyed by VariableFontDescriptor.name</pre> <div class="fragment"><div class="line"><span class="lineno">  893</span>):</div>
<div class="line"><span class="lineno">  894</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">    Build variable fonts from a designspace file, version 5 which can define</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral">    several VFs, or version 4 which has implicitly one VF covering the whole doc.</span></div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  898</span><span class="stringliteral">    If master_finder is set, it should be a callable that takes master</span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral">    filename as found in designspace file and map it to master font</span></div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral">    binary as to be opened (eg. .ttf or .otf).</span></div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">    skip_vf can be used to skip building some of the variable fonts defined in</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral">    the input designspace. It&#39;s a predicate that takes as argument the name</span></div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">    of the variable font and returns `bool`.</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">    Always returns a Dict[str, TTFont] keyed by VariableFontDescriptor.name</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  908</span>    res = {}</div>
<div class="line"><span class="lineno">  909</span>    <span class="keywordflow">for</span> _location, subDoc <span class="keywordflow">in</span> splitInterpolable(designspace):</div>
<div class="line"><span class="lineno">  910</span>        <span class="keywordflow">for</span> name, vfDoc <span class="keywordflow">in</span> splitVariableFonts(subDoc):</div>
<div class="line"><span class="lineno">  911</span>            <span class="keywordflow">if</span> skip_vf(name):</div>
<div class="line"><span class="lineno">  912</span>                log.debug(f<span class="stringliteral">&quot;Skipping variable TTF font: {name}&quot;</span>)</div>
<div class="line"><span class="lineno">  913</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  914</span>            vf = build(</div>
<div class="line"><span class="lineno">  915</span>                vfDoc,</div>
<div class="line"><span class="lineno">  916</span>                master_finder,</div>
<div class="line"><span class="lineno">  917</span>                exclude=list(exclude) + [<span class="stringliteral">&quot;STAT&quot;</span>],</div>
<div class="line"><span class="lineno">  918</span>                optimize=optimize,</div>
<div class="line"><span class="lineno">  919</span>                colr_layer_reuse=colr_layer_reuse,</div>
<div class="line"><span class="lineno">  920</span>            )[0]</div>
<div class="line"><span class="lineno">  921</span>            <span class="keywordflow">if</span> <span class="stringliteral">&quot;STAT&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude:</div>
<div class="line"><span class="lineno">  922</span>                buildVFStatTable(vf, designspace, name)</div>
<div class="line"><span class="lineno">  923</span>            res[name] = vf</div>
<div class="line"><span class="lineno">  924</span>    <span class="keywordflow">return</span> res</div>
<div class="line"><span class="lineno">  925</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af8beeec8d4c664ba72016188aca89d22" name="af8beeec8d4c664ba72016188aca89d22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8beeec8d4c664ba72016188aca89d22">&#9670;&#160;</a></span>load_designspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.load_designspace </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>designspace</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  732</span><span class="keyword">def </span>load_designspace(designspace):</div>
<div class="line"><span class="lineno">  733</span>    <span class="comment"># TODO: remove this and always assume &#39;designspace&#39; is a DesignSpaceDocument,</span></div>
<div class="line"><span class="lineno">  734</span>    <span class="comment"># never a file path, as that&#39;s already handled by caller</span></div>
<div class="line"><span class="lineno">  735</span>    <span class="keywordflow">if</span> hasattr(designspace, <span class="stringliteral">&quot;sources&quot;</span>):  <span class="comment"># Assume a DesignspaceDocument</span></div>
<div class="line"><span class="lineno">  736</span>        ds = designspace</div>
<div class="line"><span class="lineno">  737</span>    <span class="keywordflow">else</span>:  <span class="comment"># Assume a file path</span></div>
<div class="line"><span class="lineno">  738</span>        ds = DesignSpaceDocument.fromfile(designspace)</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    masters = ds.sources</div>
<div class="line"><span class="lineno">  741</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> masters:</div>
<div class="line"><span class="lineno">  742</span>        <span class="keywordflow">raise</span> VarLibValidationError(<span class="stringliteral">&quot;Designspace must have at least one source.&quot;</span>)</div>
<div class="line"><span class="lineno">  743</span>    instances = ds.instances</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="comment"># TODO: Use fontTools.designspaceLib.tagForAxisName instead.</span></div>
<div class="line"><span class="lineno">  746</span>    standard_axis_map = OrderedDict([</div>
<div class="line"><span class="lineno">  747</span>        (<span class="stringliteral">&#39;weight&#39;</span>,  (<span class="stringliteral">&#39;wght&#39;</span>, {<span class="stringliteral">&#39;en&#39;</span>: <span class="stringliteral">u&#39;Weight&#39;</span>})),</div>
<div class="line"><span class="lineno">  748</span>        (<span class="stringliteral">&#39;width&#39;</span>,   (<span class="stringliteral">&#39;wdth&#39;</span>, {<span class="stringliteral">&#39;en&#39;</span>: <span class="stringliteral">u&#39;Width&#39;</span>})),</div>
<div class="line"><span class="lineno">  749</span>        (<span class="stringliteral">&#39;slant&#39;</span>,   (<span class="stringliteral">&#39;slnt&#39;</span>, {<span class="stringliteral">&#39;en&#39;</span>: <span class="stringliteral">u&#39;Slant&#39;</span>})),</div>
<div class="line"><span class="lineno">  750</span>        (<span class="stringliteral">&#39;optical&#39;</span>, (<span class="stringliteral">&#39;opsz&#39;</span>, {<span class="stringliteral">&#39;en&#39;</span>: <span class="stringliteral">u&#39;Optical Size&#39;</span>})),</div>
<div class="line"><span class="lineno">  751</span>        (<span class="stringliteral">&#39;italic&#39;</span>,  (<span class="stringliteral">&#39;ital&#39;</span>, {<span class="stringliteral">&#39;en&#39;</span>: <span class="stringliteral">u&#39;Italic&#39;</span>})),</div>
<div class="line"><span class="lineno">  752</span>        ])</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    <span class="comment"># Setup axes</span></div>
<div class="line"><span class="lineno">  755</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> ds.axes:</div>
<div class="line"><span class="lineno">  756</span>        <span class="keywordflow">raise</span> VarLibValidationError(f<span class="stringliteral">&quot;Designspace must have at least one axis.&quot;</span>)</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>    axes = OrderedDict()</div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordflow">for</span> axis_index, axis <span class="keywordflow">in</span> enumerate(ds.axes):</div>
<div class="line"><span class="lineno">  760</span>        axis_name = axis.name</div>
<div class="line"><span class="lineno">  761</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> axis_name:</div>
<div class="line"><span class="lineno">  762</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> axis.tag:</div>
<div class="line"><span class="lineno">  763</span>                <span class="keywordflow">raise</span> VarLibValidationError(f<span class="stringliteral">&quot;Axis at index {axis_index} needs a tag.&quot;</span>)</div>
<div class="line"><span class="lineno">  764</span>            axis_name = axis.name = axis.tag</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>        <span class="keywordflow">if</span> axis_name <span class="keywordflow">in</span> standard_axis_map:</div>
<div class="line"><span class="lineno">  767</span>            <span class="keywordflow">if</span> axis.tag <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  768</span>                axis.tag = standard_axis_map[axis_name][0]</div>
<div class="line"><span class="lineno">  769</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> axis.labelNames:</div>
<div class="line"><span class="lineno">  770</span>                axis.labelNames.update(standard_axis_map[axis_name][1])</div>
<div class="line"><span class="lineno">  771</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  772</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> axis.tag:</div>
<div class="line"><span class="lineno">  773</span>                <span class="keywordflow">raise</span> VarLibValidationError(f<span class="stringliteral">&quot;Axis at index {axis_index} needs a tag.&quot;</span>)</div>
<div class="line"><span class="lineno">  774</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> axis.labelNames:</div>
<div class="line"><span class="lineno">  775</span>                axis.labelNames[<span class="stringliteral">&quot;en&quot;</span>] = tostr(axis_name)</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>        axes[axis_name] = axis</div>
<div class="line"><span class="lineno">  778</span>    log.info(<span class="stringliteral">&quot;Axes:\n%s&quot;</span>, pformat([axis.asdict() <span class="keywordflow">for</span> axis <span class="keywordflow">in</span> axes.values()]))</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>    <span class="comment"># Check all master and instance locations are valid and fill in defaults</span></div>
<div class="line"><span class="lineno">  781</span>    <span class="keywordflow">for</span> obj <span class="keywordflow">in</span> masters+instances:</div>
<div class="line"><span class="lineno">  782</span>        obj_name = obj.name <span class="keywordflow">or</span> obj.styleName <span class="keywordflow">or</span> <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><span class="lineno">  783</span>        loc = obj.getFullDesignLocation(ds)</div>
<div class="line"><span class="lineno">  784</span>        obj.designLocation = loc</div>
<div class="line"><span class="lineno">  785</span>        <span class="keywordflow">if</span> loc <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  786</span>            <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  787</span>                f<span class="stringliteral">&quot;Source or instance &#39;{obj_name}&#39; has no location.&quot;</span></div>
<div class="line"><span class="lineno">  788</span>            )</div>
<div class="line"><span class="lineno">  789</span>        <span class="keywordflow">for</span> axis_name <span class="keywordflow">in</span> loc.keys():</div>
<div class="line"><span class="lineno">  790</span>            <span class="keywordflow">if</span> axis_name <span class="keywordflow">not</span> <span class="keywordflow">in</span> axes:</div>
<div class="line"><span class="lineno">  791</span>                <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  792</span>                    f<span class="stringliteral">&quot;Location axis &#39;{axis_name}&#39; unknown for &#39;{obj_name}&#39;.&quot;</span></div>
<div class="line"><span class="lineno">  793</span>                )</div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordflow">for</span> axis_name,axis <span class="keywordflow">in</span> axes.items():</div>
<div class="line"><span class="lineno">  795</span>            v = axis.map_backward(loc[axis_name])</div>
<div class="line"><span class="lineno">  796</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> (axis.minimum &lt;= v &lt;= axis.maximum):</div>
<div class="line"><span class="lineno">  797</span>                <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  798</span>                    f<span class="stringliteral">&quot;Source or instance &#39;{obj_name}&#39; has out-of-range location &quot;</span></div>
<div class="line"><span class="lineno">  799</span>                    f<span class="stringliteral">&quot;for axis &#39;{axis_name}&#39;: is mapped to {v} but must be in &quot;</span></div>
<div class="line"><span class="lineno">  800</span>                    f<span class="stringliteral">&quot;mapped range [{axis.minimum}..{axis.maximum}] (NOTE: all &quot;</span></div>
<div class="line"><span class="lineno">  801</span>                    <span class="stringliteral">&quot;values are in user-space).&quot;</span></div>
<div class="line"><span class="lineno">  802</span>                )</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    <span class="comment"># Normalize master locations</span></div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>    internal_master_locs = [o.getFullDesignLocation(ds) <span class="keywordflow">for</span> o <span class="keywordflow">in</span> masters]</div>
<div class="line"><span class="lineno">  807</span>    log.info(<span class="stringliteral">&quot;Internal master locations:\n%s&quot;</span>, pformat(internal_master_locs))</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>    <span class="comment"># TODO This mapping should ideally be moved closer to logic in _add_fvar/avar</span></div>
<div class="line"><span class="lineno">  810</span>    internal_axis_supports = {}</div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">for</span> axis <span class="keywordflow">in</span> axes.values():</div>
<div class="line"><span class="lineno">  812</span>        triple = (axis.minimum, axis.default, axis.maximum)</div>
<div class="line"><span class="lineno">  813</span>        internal_axis_supports[axis.name] = [axis.map_forward(v) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> triple]</div>
<div class="line"><span class="lineno">  814</span>    log.info(<span class="stringliteral">&quot;Internal axis supports:\n%s&quot;</span>, pformat(internal_axis_supports))</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>    normalized_master_locs = [models.normalizeLocation(m, internal_axis_supports) <span class="keywordflow">for</span> m <span class="keywordflow">in</span> internal_master_locs]</div>
<div class="line"><span class="lineno">  817</span>    log.info(<span class="stringliteral">&quot;Normalized master locations:\n%s&quot;</span>, pformat(normalized_master_locs))</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    <span class="comment"># Find base master</span></div>
<div class="line"><span class="lineno">  820</span>    base_idx = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  821</span>    <span class="keywordflow">for</span> i,m <span class="keywordflow">in</span> enumerate(normalized_master_locs):</div>
<div class="line"><span class="lineno">  822</span>        <span class="keywordflow">if</span> all(v == 0 <span class="keywordflow">for</span> v <span class="keywordflow">in</span> m.values()):</div>
<div class="line"><span class="lineno">  823</span>            <span class="keywordflow">if</span> base_idx <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  824</span>                <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  825</span>                    <span class="stringliteral">&quot;More than one base master found in Designspace.&quot;</span></div>
<div class="line"><span class="lineno">  826</span>                )</div>
<div class="line"><span class="lineno">  827</span>            base_idx = i</div>
<div class="line"><span class="lineno">  828</span>    <span class="keywordflow">if</span> base_idx <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  829</span>        <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno">  830</span>            <span class="stringliteral">&quot;Base master not found; no master at default location?&quot;</span></div>
<div class="line"><span class="lineno">  831</span>        )</div>
<div class="line"><span class="lineno">  832</span>    log.info(<span class="stringliteral">&quot;Index of base master: %s&quot;</span>, base_idx)</div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span>    <span class="keywordflow">return</span> _DesignSpaceData(</div>
<div class="line"><span class="lineno">  835</span>        axes,</div>
<div class="line"><span class="lineno">  836</span>        internal_axis_supports,</div>
<div class="line"><span class="lineno">  837</span>        base_idx,</div>
<div class="line"><span class="lineno">  838</span>        normalized_master_locs,</div>
<div class="line"><span class="lineno">  839</span>        masters,</div>
<div class="line"><span class="lineno">  840</span>        instances,</div>
<div class="line"><span class="lineno">  841</span>        ds.rules,</div>
<div class="line"><span class="lineno">  842</span>        ds.rulesProcessingLast,</div>
<div class="line"><span class="lineno">  843</span>        ds.lib,</div>
<div class="line"><span class="lineno">  844</span>    )</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span><span class="comment"># https://docs.microsoft.com/en-us/typography/opentype/spec/os2#uswidthclass</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a34a477fddcac07168c499fd5e7f95091" name="a34a477fddcac07168c499fd5e7f95091"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34a477fddcac07168c499fd5e7f95091">&#9670;&#160;</a></span>load_masters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.load_masters </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>designspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>master_finder</em> = <code><a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a>&#160;s:&#160;s</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Ensure that all SourceDescriptor.font attributes have an appropriate TTFont
    object loaded, or else open TTFont objects from the SourceDescriptor.path
    attributes.

    The paths can point to either an OpenType font, a TTX file, or a UFO. In the
    latter case, use the provided master_finder callable to map from UFO paths to
    the respective master font binaries (e.g. .ttf, .otf or .ttx).

    Return list of master TTFont objects in the same order they are listed in the
    DesignSpaceDocument.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1047</span><span class="keyword">def </span>load_masters(designspace, master_finder=lambda s: s):</div>
<div class="line"><span class="lineno"> 1048</span>    <span class="stringliteral">&quot;&quot;&quot;Ensure that all SourceDescriptor.font attributes have an appropriate TTFont</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral">    object loaded, or else open TTFont objects from the SourceDescriptor.path</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral">    attributes.</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">    The paths can point to either an OpenType font, a TTX file, or a UFO. In the</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">    latter case, use the provided master_finder callable to map from UFO paths to</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">    the respective master font binaries (e.g. .ttf, .otf or .ttx).</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">    Return list of master TTFont objects in the same order they are listed in the</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral">    DesignSpaceDocument.</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1059</span>    <span class="keywordflow">for</span> master <span class="keywordflow">in</span> designspace.sources:</div>
<div class="line"><span class="lineno"> 1060</span>        <span class="comment"># If a SourceDescriptor has a layer name, demand that the compiled TTFont</span></div>
<div class="line"><span class="lineno"> 1061</span>        <span class="comment"># be supplied by the caller. This spares us from modifying MasterFinder.</span></div>
<div class="line"><span class="lineno"> 1062</span>        <span class="keywordflow">if</span> master.layerName <span class="keywordflow">and</span> master.font <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1063</span>            <span class="keywordflow">raise</span> VarLibValidationError(</div>
<div class="line"><span class="lineno"> 1064</span>                f<span class="stringliteral">&quot;Designspace source &#39;{master.name or &#39;&lt;Unknown&gt;&#39;}&#39; specified a &quot;</span></div>
<div class="line"><span class="lineno"> 1065</span>                <span class="stringliteral">&quot;layer name but lacks the required TTFont object in the &#39;font&#39; &quot;</span></div>
<div class="line"><span class="lineno"> 1066</span>                <span class="stringliteral">&quot;attribute.&quot;</span></div>
<div class="line"><span class="lineno"> 1067</span>            )</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordflow">return</span> designspace.loadSourceFonts(_open_font, master_finder=master_finder)</div>
<div class="line"><span class="lineno"> 1070</span> </div>
<div class="line"><span class="lineno"> 1071</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af5a405453c333e5a693d79b2c93c0e2c" name="af5a405453c333e5a693d79b2c93c0e2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5a405453c333e5a693d79b2c93c0e2c">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.main </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>None</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Build a variable font from a designspace file and masters</pre> <div class="fragment"><div class="line"><span class="lineno"> 1091</span><span class="keyword">def </span>main(args=None):</div>
<div class="line"><span class="lineno"> 1092</span>    <span class="stringliteral">&quot;&quot;&quot;Build a variable font from a designspace file and masters&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1093</span>    <span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser</div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keyword">from</span> fontTools <span class="keyword">import</span> configLogger</div>
<div class="line"><span class="lineno"> 1095</span> </div>
<div class="line"><span class="lineno"> 1096</span>    parser = ArgumentParser(prog=<span class="stringliteral">&#39;varLib&#39;</span>, description = main.__doc__)</div>
<div class="line"><span class="lineno"> 1097</span>    parser.add_argument(<span class="stringliteral">&#39;designspace&#39;</span>)</div>
<div class="line"><span class="lineno"> 1098</span>    parser.add_argument(</div>
<div class="line"><span class="lineno"> 1099</span>        <span class="stringliteral">&#39;-o&#39;</span>,</div>
<div class="line"><span class="lineno"> 1100</span>        metavar=<span class="stringliteral">&#39;OUTPUTFILE&#39;</span>,</div>
<div class="line"><span class="lineno"> 1101</span>        dest=<span class="stringliteral">&#39;outfile&#39;</span>,</div>
<div class="line"><span class="lineno"> 1102</span>        default=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno"> 1103</span>        help=<span class="stringliteral">&#39;output file&#39;</span></div>
<div class="line"><span class="lineno"> 1104</span>    )</div>
<div class="line"><span class="lineno"> 1105</span>    parser.add_argument(</div>
<div class="line"><span class="lineno"> 1106</span>        <span class="stringliteral">&#39;-x&#39;</span>,</div>
<div class="line"><span class="lineno"> 1107</span>        metavar=<span class="stringliteral">&#39;TAG&#39;</span>,</div>
<div class="line"><span class="lineno"> 1108</span>        dest=<span class="stringliteral">&#39;exclude&#39;</span>,</div>
<div class="line"><span class="lineno"> 1109</span>        action=<span class="stringliteral">&#39;append&#39;</span>,</div>
<div class="line"><span class="lineno"> 1110</span>        default=[],</div>
<div class="line"><span class="lineno"> 1111</span>        help=<span class="stringliteral">&#39;exclude table&#39;</span></div>
<div class="line"><span class="lineno"> 1112</span>    )</div>
<div class="line"><span class="lineno"> 1113</span>    parser.add_argument(</div>
<div class="line"><span class="lineno"> 1114</span>        <span class="stringliteral">&#39;--disable-iup&#39;</span>,</div>
<div class="line"><span class="lineno"> 1115</span>        dest=<span class="stringliteral">&#39;optimize&#39;</span>,</div>
<div class="line"><span class="lineno"> 1116</span>        action=<span class="stringliteral">&#39;store_false&#39;</span>,</div>
<div class="line"><span class="lineno"> 1117</span>        help=<span class="stringliteral">&#39;do not perform IUP optimization&#39;</span></div>
<div class="line"><span class="lineno"> 1118</span>    )</div>
<div class="line"><span class="lineno"> 1119</span>    parser.add_argument(</div>
<div class="line"><span class="lineno"> 1120</span>        <span class="stringliteral">&#39;--no-colr-layer-reuse&#39;</span>,</div>
<div class="line"><span class="lineno"> 1121</span>        dest=<span class="stringliteral">&#39;colr_layer_reuse&#39;</span>,</div>
<div class="line"><span class="lineno"> 1122</span>        action=<span class="stringliteral">&#39;store_false&#39;</span>,</div>
<div class="line"><span class="lineno"> 1123</span>        help=<span class="stringliteral">&#39;do not rebuild variable COLR table to optimize COLR layer reuse&#39;</span>,</div>
<div class="line"><span class="lineno"> 1124</span>    )</div>
<div class="line"><span class="lineno"> 1125</span>    parser.add_argument(</div>
<div class="line"><span class="lineno"> 1126</span>        <span class="stringliteral">&#39;--master-finder&#39;</span>,</div>
<div class="line"><span class="lineno"> 1127</span>        default=<span class="stringliteral">&#39;master_ttf_interpolatable/{stem}.ttf&#39;</span>,</div>
<div class="line"><span class="lineno"> 1128</span>        help=(</div>
<div class="line"><span class="lineno"> 1129</span>            <span class="stringliteral">&#39;templated string used for finding binary font &#39;</span></div>
<div class="line"><span class="lineno"> 1130</span>            <span class="stringliteral">&#39;files given the source file names defined in the &#39;</span></div>
<div class="line"><span class="lineno"> 1131</span>            <span class="stringliteral">&#39;designspace document. The following special strings &#39;</span></div>
<div class="line"><span class="lineno"> 1132</span>            <span class="stringliteral">&#39;are defined: {fullname} is the absolute source file &#39;</span></div>
<div class="line"><span class="lineno"> 1133</span>            <span class="stringliteral">&#39;name; {basename} is the file name without its &#39;</span></div>
<div class="line"><span class="lineno"> 1134</span>            <span class="stringliteral">&#39;directory; {stem} is the basename without the file &#39;</span></div>
<div class="line"><span class="lineno"> 1135</span>            <span class="stringliteral">&#39;extension; {ext} is the source file extension; &#39;</span></div>
<div class="line"><span class="lineno"> 1136</span>            <span class="stringliteral">&#39;{dirname} is the directory of the absolute file &#39;</span></div>
<div class="line"><span class="lineno"> 1137</span>            <span class="stringliteral">&#39;name. The default value is &quot;%(default)s&quot;.&#39;</span></div>
<div class="line"><span class="lineno"> 1138</span>        )</div>
<div class="line"><span class="lineno"> 1139</span>    )</div>
<div class="line"><span class="lineno"> 1140</span>    logging_group = parser.add_mutually_exclusive_group(required=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1141</span>    logging_group.add_argument(</div>
<div class="line"><span class="lineno"> 1142</span>        <span class="stringliteral">&quot;-v&quot;</span>, <span class="stringliteral">&quot;--verbose&quot;</span>,</div>
<div class="line"><span class="lineno"> 1143</span>                action=<span class="stringliteral">&quot;store_true&quot;</span>,</div>
<div class="line"><span class="lineno"> 1144</span>                help=<span class="stringliteral">&quot;Run more verbosely.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1145</span>    logging_group.add_argument(</div>
<div class="line"><span class="lineno"> 1146</span>        <span class="stringliteral">&quot;-q&quot;</span>, <span class="stringliteral">&quot;--quiet&quot;</span>,</div>
<div class="line"><span class="lineno"> 1147</span>                action=<span class="stringliteral">&quot;store_true&quot;</span>,</div>
<div class="line"><span class="lineno"> 1148</span>                help=<span class="stringliteral">&quot;Turn verbosity off.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1149</span>    options = parser.parse_args(args)</div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span>    configLogger(level=(</div>
<div class="line"><span class="lineno"> 1152</span>        <span class="stringliteral">&quot;DEBUG&quot;</span> <span class="keywordflow">if</span> options.verbose <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1153</span>        <span class="stringliteral">&quot;ERROR&quot;</span> <span class="keywordflow">if</span> options.quiet <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1154</span>        <span class="stringliteral">&quot;INFO&quot;</span>))</div>
<div class="line"><span class="lineno"> 1155</span> </div>
<div class="line"><span class="lineno"> 1156</span>    designspace_filename = options.designspace</div>
<div class="line"><span class="lineno"> 1157</span>    finder = MasterFinder(options.master_finder)</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>    vf, _, _ = build(</div>
<div class="line"><span class="lineno"> 1160</span>        designspace_filename,</div>
<div class="line"><span class="lineno"> 1161</span>        finder,</div>
<div class="line"><span class="lineno"> 1162</span>        exclude=options.exclude,</div>
<div class="line"><span class="lineno"> 1163</span>        optimize=options.optimize,</div>
<div class="line"><span class="lineno"> 1164</span>        colr_layer_reuse=options.colr_layer_reuse,</div>
<div class="line"><span class="lineno"> 1165</span>    )</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>    outfile = options.outfile</div>
<div class="line"><span class="lineno"> 1168</span>    <span class="keywordflow">if</span> outfile <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1169</span>        ext = <span class="stringliteral">&quot;otf&quot;</span> <span class="keywordflow">if</span> vf.sfntVersion == <span class="stringliteral">&quot;OTTO&quot;</span> <span class="keywordflow">else</span> <span class="stringliteral">&quot;ttf&quot;</span></div>
<div class="line"><span class="lineno"> 1170</span>        outfile = os.path.splitext(designspace_filename)[0] + <span class="stringliteral">&#39;-VF.&#39;</span> + ext</div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>    log.info(<span class="stringliteral">&quot;Saving variation font %s&quot;</span>, outfile)</div>
<div class="line"><span class="lineno"> 1173</span>    vf.save(outfile)</div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a12bca1b4bbeb0c1739b80190ba645535" name="a12bca1b4bbeb0c1739b80190ba645535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12bca1b4bbeb0c1739b80190ba645535">&#9670;&#160;</a></span>set_default_weight_width_slant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.set_default_weight_width_slant </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>location</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  861</span><span class="keyword">def </span>set_default_weight_width_slant(font, location):</div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;OS/2&quot;</span> <span class="keywordflow">in</span> font:</div>
<div class="line"><span class="lineno">  863</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;wght&quot;</span> <span class="keywordflow">in</span> location:</div>
<div class="line"><span class="lineno">  864</span>            weight_class = otRound(max(1, min(location[<span class="stringliteral">&quot;wght&quot;</span>], 1000)))</div>
<div class="line"><span class="lineno">  865</span>            <span class="keywordflow">if</span> font[<span class="stringliteral">&quot;OS/2&quot;</span>].usWeightClass != weight_class:</div>
<div class="line"><span class="lineno">  866</span>                log.info(<span class="stringliteral">&quot;Setting OS/2.usWeightClass = %s&quot;</span>, weight_class)</div>
<div class="line"><span class="lineno">  867</span>                font[<span class="stringliteral">&quot;OS/2&quot;</span>].usWeightClass = weight_class</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;wdth&quot;</span> <span class="keywordflow">in</span> location:</div>
<div class="line"><span class="lineno">  870</span>            <span class="comment"># map &#39;wdth&#39; axis (50..200) to OS/2.usWidthClass (1..9), rounding to closest</span></div>
<div class="line"><span class="lineno">  871</span>            widthValue = min(max(location[<span class="stringliteral">&quot;wdth&quot;</span>], 50), 200)</div>
<div class="line"><span class="lineno">  872</span>            widthClass = otRound(</div>
<div class="line"><span class="lineno">  873</span>                models.piecewiseLinearMap(widthValue, WDTH_VALUE_TO_OS2_WIDTH_CLASS)</div>
<div class="line"><span class="lineno">  874</span>            )</div>
<div class="line"><span class="lineno">  875</span>            <span class="keywordflow">if</span> font[<span class="stringliteral">&quot;OS/2&quot;</span>].usWidthClass != widthClass:</div>
<div class="line"><span class="lineno">  876</span>                log.info(<span class="stringliteral">&quot;Setting OS/2.usWidthClass = %s&quot;</span>, widthClass)</div>
<div class="line"><span class="lineno">  877</span>                font[<span class="stringliteral">&quot;OS/2&quot;</span>].usWidthClass = widthClass</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;slnt&quot;</span> <span class="keywordflow">in</span> location <span class="keywordflow">and</span> <span class="stringliteral">&quot;post&quot;</span> <span class="keywordflow">in</span> font:</div>
<div class="line"><span class="lineno">  880</span>        italicAngle = max(-90, min(location[<span class="stringliteral">&quot;slnt&quot;</span>], 90))</div>
<div class="line"><span class="lineno">  881</span>        <span class="keywordflow">if</span> font[<span class="stringliteral">&quot;post&quot;</span>].italicAngle != italicAngle:</div>
<div class="line"><span class="lineno">  882</span>            log.info(<span class="stringliteral">&quot;Setting post.italicAngle = %s&quot;</span>, italicAngle)</div>
<div class="line"><span class="lineno">  883</span>            font[<span class="stringliteral">&quot;post&quot;</span>].italicAngle = italicAngle</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a132f85d68de07143aaf704f9ee1fa00a" name="a132f85d68de07143aaf704f9ee1fa00a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a132f85d68de07143aaf704f9ee1fa00a">&#9670;&#160;</a></span>_DesignSpaceData</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._DesignSpaceData</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  namedtuple(</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&quot;_DesignSpaceData&quot;</span>,</div>
<div class="line"><span class="lineno">    3</span>    [</div>
<div class="line"><span class="lineno">    4</span>        <span class="stringliteral">&quot;axes&quot;</span>,</div>
<div class="line"><span class="lineno">    5</span>        <span class="stringliteral">&quot;internal_axis_supports&quot;</span>,</div>
<div class="line"><span class="lineno">    6</span>        <span class="stringliteral">&quot;base_idx&quot;</span>,</div>
<div class="line"><span class="lineno">    7</span>        <span class="stringliteral">&quot;normalized_master_locs&quot;</span>,</div>
<div class="line"><span class="lineno">    8</span>        <span class="stringliteral">&quot;masters&quot;</span>,</div>
<div class="line"><span class="lineno">    9</span>        <span class="stringliteral">&quot;instances&quot;</span>,</div>
<div class="line"><span class="lineno">   10</span>        <span class="stringliteral">&quot;rules&quot;</span>,</div>
<div class="line"><span class="lineno">   11</span>        <span class="stringliteral">&quot;rulesProcessingLast&quot;</span>,</div>
<div class="line"><span class="lineno">   12</span>        <span class="stringliteral">&quot;lib&quot;</span>,</div>
<div class="line"><span class="lineno">   13</span>    ],</div>
<div class="line"><span class="lineno">   14</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac89262188713d0562018946c1b57fb2d" name="ac89262188713d0562018946c1b57fb2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac89262188713d0562018946c1b57fb2d">&#9670;&#160;</a></span>_MasterData</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._MasterData = namedtuple('_MasterData', ['glyf', 'hMetrics', 'vMetrics'])</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a92098c701c16e706448c6b4e9297af00" name="a92098c701c16e706448c6b4e9297af00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92098c701c16e706448c6b4e9297af00">&#9670;&#160;</a></span>_MetricsFields</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib._MetricsFields</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  namedtuple(<span class="stringliteral">&#39;_MetricsFields&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>    [<span class="stringliteral">&#39;tableTag&#39;</span>, <span class="stringliteral">&#39;metricsTag&#39;</span>, <span class="stringliteral">&#39;sb1&#39;</span>, <span class="stringliteral">&#39;sb2&#39;</span>, <span class="stringliteral">&#39;advMapping&#39;</span>, <span class="stringliteral">&#39;vOrigMapping&#39;</span>])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a475959f611f8e49643a0789aa515c113" name="a475959f611f8e49643a0789aa515c113"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a475959f611f8e49643a0789aa515c113">&#9670;&#160;</a></span>FEAVAR_FEATURETAG_LIB_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str fontTools.varLib.FEAVAR_FEATURETAG_LIB_KEY = &quot;com.github.fonttools.varLib.featureVarsFeatureTag&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6efbe7a5cfccd358dc024169d258bcb1" name="a6efbe7a5cfccd358dc024169d258bcb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6efbe7a5cfccd358dc024169d258bcb1">&#9670;&#160;</a></span>HVAR_FIELDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.HVAR_FIELDS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  _MetricsFields(tableTag=<span class="stringliteral">&#39;HVAR&#39;</span>, metricsTag=<span class="stringliteral">&#39;hmtx&#39;</span>, sb1=<span class="stringliteral">&#39;LsbMap&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>    sb2=<span class="stringliteral">&#39;RsbMap&#39;</span>, advMapping=<span class="stringliteral">&#39;AdvWidthMap&#39;</span>, vOrigMapping=<span class="keywordtype">None</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5b52324625c4fe615f18aa0f32ae5be" name="ae5b52324625c4fe615f18aa0f32ae5be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5b52324625c4fe615f18aa0f32ae5be">&#9670;&#160;</a></span>log</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.log = logging.getLogger(&quot;fontTools.varLib&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acf710f32faed7b910325ba44ec32ffcf" name="acf710f32faed7b910325ba44ec32ffcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf710f32faed7b910325ba44ec32ffcf">&#9670;&#160;</a></span>VVAR_FIELDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.VVAR_FIELDS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  _MetricsFields(tableTag=<span class="stringliteral">&#39;VVAR&#39;</span>, metricsTag=<span class="stringliteral">&#39;vmtx&#39;</span>, sb1=<span class="stringliteral">&#39;TsbMap&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>    sb2=<span class="stringliteral">&#39;BsbMap&#39;</span>, advMapping=<span class="stringliteral">&#39;AdvHeightMap&#39;</span>, vOrigMapping=<span class="stringliteral">&#39;VOrgMap&#39;</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf55875644812f7928ea3e71f8f2e404" name="aaf55875644812f7928ea3e71f8f2e404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf55875644812f7928ea3e71f8f2e404">&#9670;&#160;</a></span>WDTH_VALUE_TO_OS2_WIDTH_CLASS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict fontTools.varLib.WDTH_VALUE_TO_OS2_WIDTH_CLASS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {</div>
<div class="line"><span class="lineno">    2</span>    50: 1,</div>
<div class="line"><span class="lineno">    3</span>    62.5: 2,</div>
<div class="line"><span class="lineno">    4</span>    75: 3,</div>
<div class="line"><span class="lineno">    5</span>    87.5: 4,</div>
<div class="line"><span class="lineno">    6</span>    100: 5,</div>
<div class="line"><span class="lineno">    7</span>    112.5: 6,</div>
<div class="line"><span class="lineno">    8</span>    125: 7,</div>
<div class="line"><span class="lineno">    9</span>    150: 8,</div>
<div class="line"><span class="lineno">   10</span>    200: 9,</div>
<div class="line"><span class="lineno">   11</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
