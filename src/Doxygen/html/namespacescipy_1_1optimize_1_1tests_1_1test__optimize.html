<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize.tests.test_optimize Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html">test_optimize</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize.tests.test_optimize Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_check_optimize.html">CheckOptimize</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_check_optimize_parameterized.html">CheckOptimizeParameterized</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_function_with_gradient.html">FunctionWithGradient</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_brute.html">TestBrute</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_global_optimization.html">TestGlobalOptimization</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_iteration_limits.html">TestIterationLimits</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_l_b_f_g_s_b_bounds.html">TestLBFGSBBounds</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_newton_cg.html">TestNewtonCg</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_optimize_no_wrapper_disp.html">TestOptimizeNoWrapperDisp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_optimize_no_wrapper_no_disp.html">TestOptimizeNoWrapperNoDisp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_optimize_result_attributes.html">TestOptimizeResultAttributes</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_optimize_scalar.html">TestOptimizeScalar</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_optimize_simple.html">TestOptimizeSimple</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_optimize_wrapper_disp.html">TestOptimizeWrapperDisp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_optimize_wrapper_no_disp.html">TestOptimizeWrapperNoDisp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__optimize_1_1_test_rosen.html">TestRosen</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae844ac1e585d5f5c5fee15c1092a0af2" id="r_ae844ac1e585d5f5c5fee15c1092a0af2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ae844ac1e585d5f5c5fee15c1092a0af2">test_check_grad</a> ()</td></tr>
<tr class="separator:ae844ac1e585d5f5c5fee15c1092a0af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf3efa5d323302be96fb2f278f333f70" id="r_adf3efa5d323302be96fb2f278f333f70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#adf3efa5d323302be96fb2f278f333f70">test_maxfev_test</a> ()</td></tr>
<tr class="separator:adf3efa5d323302be96fb2f278f333f70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9d78c512ac78839fbb3d31c0577c41b" id="r_aa9d78c512ac78839fbb3d31c0577c41b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#aa9d78c512ac78839fbb3d31c0577c41b">test_wrap_scalar_function_with_validation</a> ()</td></tr>
<tr class="separator:aa9d78c512ac78839fbb3d31c0577c41b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76e47863cfbce4b15cc26d26c2d0e6d8" id="r_a76e47863cfbce4b15cc26d26c2d0e6d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a76e47863cfbce4b15cc26d26c2d0e6d8">test_obj_func_returns_scalar</a> ()</td></tr>
<tr class="separator:a76e47863cfbce4b15cc26d26c2d0e6d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae403b686f601b3a845d658b58ff6b234" id="r_ae403b686f601b3a845d658b58ff6b234"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ae403b686f601b3a845d658b58ff6b234">test_neldermead_iteration_num</a> ()</td></tr>
<tr class="separator:ae403b686f601b3a845d658b58ff6b234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedf7ab0bcddbfe2390cd789b41bee335" id="r_aedf7ab0bcddbfe2390cd789b41bee335"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#aedf7ab0bcddbfe2390cd789b41bee335">test_neldermead_xatol_fatol</a> ()</td></tr>
<tr class="separator:aedf7ab0bcddbfe2390cd789b41bee335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb05f9af666ee7eb0bf0d195f80875d2" id="r_abb05f9af666ee7eb0bf0d195f80875d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#abb05f9af666ee7eb0bf0d195f80875d2">test_neldermead_adaptive</a> ()</td></tr>
<tr class="separator:abb05f9af666ee7eb0bf0d195f80875d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d04d96f95ecefac06b610679496cc2" id="r_ac9d04d96f95ecefac06b610679496cc2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ac9d04d96f95ecefac06b610679496cc2">test_bounded_powell_outsidebounds</a> ()</td></tr>
<tr class="separator:ac9d04d96f95ecefac06b610679496cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9793b8fe47f9fe1eef420f9141d31694" id="r_a9793b8fe47f9fe1eef420f9141d31694"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a9793b8fe47f9fe1eef420f9141d31694">test_bounded_powell_vs_powell</a> ()</td></tr>
<tr class="separator:a9793b8fe47f9fe1eef420f9141d31694"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad08b2bb8f10178ac52f0b94790ee3c62" id="r_ad08b2bb8f10178ac52f0b94790ee3c62"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ad08b2bb8f10178ac52f0b94790ee3c62">test_onesided_bounded_powell_stability</a> ()</td></tr>
<tr class="separator:ad08b2bb8f10178ac52f0b94790ee3c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7c8ad6ab55604fd2180d288ce3d8d9" id="r_aca7c8ad6ab55604fd2180d288ce3d8d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#aca7c8ad6ab55604fd2180d288ce3d8d9">test_minimize_with_scalar</a> (method)</td></tr>
<tr class="separator:aca7c8ad6ab55604fd2180d288ce3d8d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a894fddbdb4fc86b7350df79320e694ae" id="r_a894fddbdb4fc86b7350df79320e694ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a894fddbdb4fc86b7350df79320e694ae">test_brent_negative_tolerance</a> ()</td></tr>
<tr class="separator:a894fddbdb4fc86b7350df79320e694ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9efa9b3494413a735c7455664279c080" id="r_a9efa9b3494413a735c7455664279c080"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a9efa9b3494413a735c7455664279c080">test_line_for_search</a> ()</td></tr>
<tr class="separator:a9efa9b3494413a735c7455664279c080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ce8397ef914692942dc3b18c903e38f" id="r_a7ce8397ef914692942dc3b18c903e38f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a7ce8397ef914692942dc3b18c903e38f">test_linesearch_powell</a> ()</td></tr>
<tr class="separator:a7ce8397ef914692942dc3b18c903e38f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5eed140de3ab6e56a6e0a2dfd5d8b60" id="r_ac5eed140de3ab6e56a6e0a2dfd5d8b60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ac5eed140de3ab6e56a6e0a2dfd5d8b60">test_linesearch_powell_bounded</a> ()</td></tr>
<tr class="separator:ac5eed140de3ab6e56a6e0a2dfd5d8b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d0e6a927123c63cc9d631d0f4bfbc4a" id="r_a7d0e6a927123c63cc9d631d0f4bfbc4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a7d0e6a927123c63cc9d631d0f4bfbc4a">test_powell_limits</a> ()</td></tr>
<tr class="separator:a7d0e6a927123c63cc9d631d0f4bfbc4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48c5f6b4b45f667b6946f25a3a50239" id="r_ad48c5f6b4b45f667b6946f25a3a50239"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ad48c5f6b4b45f667b6946f25a3a50239">himmelblau</a> (p)</td></tr>
<tr class="separator:ad48c5f6b4b45f667b6946f25a3a50239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad968b12dbd7f8cb80c874c9f8f76e763" id="r_ad968b12dbd7f8cb80c874c9f8f76e763"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ad968b12dbd7f8cb80c874c9f8f76e763">himmelblau_grad</a> (p)</td></tr>
<tr class="separator:ad968b12dbd7f8cb80c874c9f8f76e763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d0bf00bccf12917897d65f8d13985d" id="r_a55d0bf00bccf12917897d65f8d13985d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a55d0bf00bccf12917897d65f8d13985d">himmelblau_hess</a> (p)</td></tr>
<tr class="separator:a55d0bf00bccf12917897d65f8d13985d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabd65cd2b64086a99720f3feb6a04328" id="r_aabd65cd2b64086a99720f3feb6a04328"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#aabd65cd2b64086a99720f3feb6a04328">test_minimize_multiple_constraints</a> ()</td></tr>
<tr class="separator:aabd65cd2b64086a99720f3feb6a04328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd4f71a7670bae536e7cd47973390f99" id="r_acd4f71a7670bae536e7cd47973390f99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#acd4f71a7670bae536e7cd47973390f99">f1</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, *params)</td></tr>
<tr class="separator:acd4f71a7670bae536e7cd47973390f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a442e28cf3481d65366ba24413af6bff4" id="r_a442e28cf3481d65366ba24413af6bff4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a442e28cf3481d65366ba24413af6bff4">f2</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, *params)</td></tr>
<tr class="separator:a442e28cf3481d65366ba24413af6bff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718d344badfa07a15db2ecfd2e16fc98" id="r_a718d344badfa07a15db2ecfd2e16fc98"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a718d344badfa07a15db2ecfd2e16fc98">f3</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, *params)</td></tr>
<tr class="separator:a718d344badfa07a15db2ecfd2e16fc98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae14ba7bceae73ddb6eb21dee7d0e7edc" id="r_ae14ba7bceae73ddb6eb21dee7d0e7edc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ae14ba7bceae73ddb6eb21dee7d0e7edc">brute_func</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, *params)</td></tr>
<tr class="separator:ae14ba7bceae73ddb6eb21dee7d0e7edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac18dac61a7f85556633d7ffe9cf7a502" id="r_ac18dac61a7f85556633d7ffe9cf7a502"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ac18dac61a7f85556633d7ffe9cf7a502">test_cobyla_threadsafe</a> ()</td></tr>
<tr class="separator:ac18dac61a7f85556633d7ffe9cf7a502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6efbe43d9febe32ba40d28d7adb77458" id="r_a6efbe43d9febe32ba40d28d7adb77458"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a6efbe43d9febe32ba40d28d7adb77458">test_result_x_shape_when_len_x_is_one</a> ()</td></tr>
<tr class="separator:a6efbe43d9febe32ba40d28d7adb77458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a714d76a8700d1131b3ee6cff6751a4d0" id="r_a714d76a8700d1131b3ee6cff6751a4d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a714d76a8700d1131b3ee6cff6751a4d0">function_with_gradient</a> ()</td></tr>
<tr class="separator:a714d76a8700d1131b3ee6cff6751a4d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae099b3064f7fba6520ac622bd5c967af" id="r_ae099b3064f7fba6520ac622bd5c967af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ae099b3064f7fba6520ac622bd5c967af">test_memoize_jac_function_before_gradient</a> (<a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a714d76a8700d1131b3ee6cff6751a4d0">function_with_gradient</a>)</td></tr>
<tr class="separator:ae099b3064f7fba6520ac622bd5c967af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e0786cdffd2e96f9b91fdb32de7de15" id="r_a0e0786cdffd2e96f9b91fdb32de7de15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a0e0786cdffd2e96f9b91fdb32de7de15">test_memoize_jac_gradient_before_function</a> (<a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a714d76a8700d1131b3ee6cff6751a4d0">function_with_gradient</a>)</td></tr>
<tr class="separator:a0e0786cdffd2e96f9b91fdb32de7de15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab557ceba04b1f0811859b14925d36bd6" id="r_ab557ceba04b1f0811859b14925d36bd6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ab557ceba04b1f0811859b14925d36bd6">test_memoize_jac_with_bfgs</a> (<a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a714d76a8700d1131b3ee6cff6751a4d0">function_with_gradient</a>)</td></tr>
<tr class="separator:ab557ceba04b1f0811859b14925d36bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79dbb358812b42c2a9cbf874bb71ac51" id="r_a79dbb358812b42c2a9cbf874bb71ac51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a79dbb358812b42c2a9cbf874bb71ac51">test_gh12696</a> ()</td></tr>
<tr class="separator:a79dbb358812b42c2a9cbf874bb71ac51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af030db106844e022c198a815e9b894ec" id="r_af030db106844e022c198a815e9b894ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#af030db106844e022c198a815e9b894ec">setup_test_equal_bounds</a> ()</td></tr>
<tr class="separator:af030db106844e022c198a815e9b894ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a900060b50515a745b130a06ab0239b05" id="r_a900060b50515a745b130a06ab0239b05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a900060b50515a745b130a06ab0239b05">test_equal_bounds</a> (method, kwds, bound_type, constraints, callback)</td></tr>
<tr class="separator:a900060b50515a745b130a06ab0239b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa075409f0589e57073625375a69e6d92" id="r_aa075409f0589e57073625375a69e6d92"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#aa075409f0589e57073625375a69e6d92">test_all_bounds_equal</a> (method)</td></tr>
<tr class="separator:aa075409f0589e57073625375a69e6d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af039bc3b47f7963be2d10ce066324de3" id="r_af039bc3b47f7963be2d10ce066324de3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#af039bc3b47f7963be2d10ce066324de3">test_eb_constraints</a> ()</td></tr>
<tr class="separator:af039bc3b47f7963be2d10ce066324de3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad15ddec1844467dc55d69d4ba6f7a188" id="r_ad15ddec1844467dc55d69d4ba6f7a188"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#ad15ddec1844467dc55d69d4ba6f7a188">test_show_options</a> ()</td></tr>
<tr class="separator:ad15ddec1844467dc55d69d4ba6f7a188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a135354aebb30bc7050cc5d1027149dcc" id="r_a135354aebb30bc7050cc5d1027149dcc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a135354aebb30bc7050cc5d1027149dcc">test_bounds_with_list</a> ()</td></tr>
<tr class="separator:a135354aebb30bc7050cc5d1027149dcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe6a1009453d8fd954cb1067c2e2b96" id="r_adbe6a1009453d8fd954cb1067c2e2b96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#adbe6a1009453d8fd954cb1067c2e2b96">test_x_overwritten_user_function</a> ()</td></tr>
<tr class="separator:adbe6a1009453d8fd954cb1067c2e2b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b741021f18ee8cb4bd22e33567124f0" id="r_a3b741021f18ee8cb4bd22e33567124f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a3b741021f18ee8cb4bd22e33567124f0">test_approx_fprime</a> ()</td></tr>
<tr class="separator:a3b741021f18ee8cb4bd22e33567124f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a215723b89ff7d8b789690f71188313bc" id="r_a215723b89ff7d8b789690f71188313bc"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a215723b89ff7d8b789690f71188313bc">himmelblau_x0</a> = [-0.27, -0.9]</td></tr>
<tr class="separator:a215723b89ff7d8b789690f71188313bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c01899302856eae1ef9ad4e6950cd10" id="r_a7c01899302856eae1ef9ad4e6950cd10"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a7c01899302856eae1ef9ad4e6950cd10">himmelblau_xopt</a> = [3, 2]</td></tr>
<tr class="separator:a7c01899302856eae1ef9ad4e6950cd10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee8e157c1e5422ce8dea7a123041135" id="r_aeee8e157c1e5422ce8dea7a123041135"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#aeee8e157c1e5422ce8dea7a123041135">himmelblau_min</a> = 0.0</td></tr>
<tr class="separator:aeee8e157c1e5422ce8dea7a123041135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bd8a943280e172b38d5327ffc96af12" id="r_a3bd8a943280e172b38d5327ffc96af12"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#a3bd8a943280e172b38d5327ffc96af12">eb_data</a> = <a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#af030db106844e022c198a815e9b894ec">setup_test_equal_bounds</a>()</td></tr>
<tr class="separator:a3bd8a943280e172b38d5327ffc96af12"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Unit tests for optimization routines from optimize.py

Authors:
   Ed Schofield, Nov 2005
   Andrew Straw, April 2008

To run it in its simplest form::
  nosetests test_optimize.py</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ae14ba7bceae73ddb6eb21dee7d0e7edc" name="ae14ba7bceae73ddb6eb21dee7d0e7edc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae14ba7bceae73ddb6eb21dee7d0e7edc">&#9670;&#160;</a></span>brute_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.brute_func </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2162</span><span class="keyword">def </span>brute_func(z, *params):</div>
<div class="line"><span class="lineno"> 2163</span>    <span class="keywordflow">return</span> f1(z, *params) + f2(z, *params) + f3(z, *params)</div>
<div class="line"><span class="lineno"> 2164</span> </div>
<div class="line"><span class="lineno"> 2165</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acd4f71a7670bae536e7cd47973390f99" name="acd4f71a7670bae536e7cd47973390f99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd4f71a7670bae536e7cd47973390f99">&#9670;&#160;</a></span>f1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.f1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2144</span><span class="keyword">def </span>f1(z, *params):</div>
<div class="line"><span class="lineno"> 2145</span>    x, y = z</div>
<div class="line"><span class="lineno"> 2146</span>    a, b, c, d, e, f, g, h, i, j, k, l, scale = params</div>
<div class="line"><span class="lineno"> 2147</span>    <span class="keywordflow">return</span> (a * x**2 + b * x * y + c * y**2 + d*x + e*y + f)</div>
<div class="line"><span class="lineno"> 2148</span> </div>
<div class="line"><span class="lineno"> 2149</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a442e28cf3481d65366ba24413af6bff4" name="a442e28cf3481d65366ba24413af6bff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a442e28cf3481d65366ba24413af6bff4">&#9670;&#160;</a></span>f2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.f2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2150</span><span class="keyword">def </span>f2(z, *params):</div>
<div class="line"><span class="lineno"> 2151</span>    x, y = z</div>
<div class="line"><span class="lineno"> 2152</span>    a, b, c, d, e, f, g, h, i, j, k, l, scale = params</div>
<div class="line"><span class="lineno"> 2153</span>    <span class="keywordflow">return</span> (-g*np.exp(-((x-h)**2 + (y-i)**2) / scale))</div>
<div class="line"><span class="lineno"> 2154</span> </div>
<div class="line"><span class="lineno"> 2155</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a718d344badfa07a15db2ecfd2e16fc98" name="a718d344badfa07a15db2ecfd2e16fc98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a718d344badfa07a15db2ecfd2e16fc98">&#9670;&#160;</a></span>f3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.f3 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2156</span><span class="keyword">def </span>f3(z, *params):</div>
<div class="line"><span class="lineno"> 2157</span>    x, y = z</div>
<div class="line"><span class="lineno"> 2158</span>    a, b, c, d, e, f, g, h, i, j, k, l, scale = params</div>
<div class="line"><span class="lineno"> 2159</span>    <span class="keywordflow">return</span> (-j*np.exp(-((x-k)**2 + (y-l)**2) / scale))</div>
<div class="line"><span class="lineno"> 2160</span> </div>
<div class="line"><span class="lineno"> 2161</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a714d76a8700d1131b3ee6cff6751a4d0" name="a714d76a8700d1131b3ee6cff6751a4d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a714d76a8700d1131b3ee6cff6751a4d0">&#9670;&#160;</a></span>function_with_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.function_with_gradient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2367</span><span class="keyword">def </span>function_with_gradient():</div>
<div class="line"><span class="lineno"> 2368</span>    <span class="keywordflow">return</span> FunctionWithGradient()</div>
<div class="line"><span class="lineno"> 2369</span> </div>
<div class="line"><span class="lineno"> 2370</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad48c5f6b4b45f667b6946f25a3a50239" name="ad48c5f6b4b45f667b6946f25a3a50239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad48c5f6b4b45f667b6946f25a3a50239">&#9670;&#160;</a></span>himmelblau()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.himmelblau </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">R^2 -&gt; R^1 test function for optimization. The function has four local
minima where himmelblau(xopt) == 0.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2061</span><span class="keyword">def </span>himmelblau(p):</div>
<div class="line"><span class="lineno"> 2062</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2063</span><span class="stringliteral">    R^2 -&gt; R^1 test function for optimization. The function has four local</span></div>
<div class="line"><span class="lineno"> 2064</span><span class="stringliteral">    minima where himmelblau(xopt) == 0.</span></div>
<div class="line"><span class="lineno"> 2065</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2066</span>    x, y = p</div>
<div class="line"><span class="lineno"> 2067</span>    a = x*x + y - 11</div>
<div class="line"><span class="lineno"> 2068</span>    b = x + y*y - 7</div>
<div class="line"><span class="lineno"> 2069</span>    <span class="keywordflow">return</span> a*a + b*b</div>
<div class="line"><span class="lineno"> 2070</span> </div>
<div class="line"><span class="lineno"> 2071</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad968b12dbd7f8cb80c874c9f8f76e763" name="ad968b12dbd7f8cb80c874c9f8f76e763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad968b12dbd7f8cb80c874c9f8f76e763">&#9670;&#160;</a></span>himmelblau_grad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.himmelblau_grad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2072</span><span class="keyword">def </span>himmelblau_grad(p):</div>
<div class="line"><span class="lineno"> 2073</span>    x, y = p</div>
<div class="line"><span class="lineno"> 2074</span>    <span class="keywordflow">return</span> np.array([4*x**3 + 4*x*y - 42*x + 2*y**2 - 14,</div>
<div class="line"><span class="lineno"> 2075</span>                     2*x**2 + 4*x*y + 4*y**3 - 26*y - 22])</div>
<div class="line"><span class="lineno"> 2076</span> </div>
<div class="line"><span class="lineno"> 2077</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a55d0bf00bccf12917897d65f8d13985d" name="a55d0bf00bccf12917897d65f8d13985d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55d0bf00bccf12917897d65f8d13985d">&#9670;&#160;</a></span>himmelblau_hess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.himmelblau_hess </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2078</span><span class="keyword">def </span>himmelblau_hess(p):</div>
<div class="line"><span class="lineno"> 2079</span>    x, y = p</div>
<div class="line"><span class="lineno"> 2080</span>    <span class="keywordflow">return</span> np.array([[12*x**2 + 4*y - 42, 4*x + 4*y],</div>
<div class="line"><span class="lineno"> 2081</span>                     [4*x + 4*y, 4*x + 12*y**2 - 26]])</div>
<div class="line"><span class="lineno"> 2082</span> </div>
<div class="line"><span class="lineno"> 2083</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af030db106844e022c198a815e9b894ec" name="af030db106844e022c198a815e9b894ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af030db106844e022c198a815e9b894ec">&#9670;&#160;</a></span>setup_test_equal_bounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.setup_test_equal_bounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2439</span><span class="keyword">def </span>setup_test_equal_bounds():</div>
<div class="line"><span class="lineno"> 2440</span> </div>
<div class="line"><span class="lineno"> 2441</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno"> 2442</span>    x0 = np.random.rand(4)</div>
<div class="line"><span class="lineno"> 2443</span>    lb = np.array([0, 2, -1, -1.0])</div>
<div class="line"><span class="lineno"> 2444</span>    ub = np.array([3, 2, 2, -1.0])</div>
<div class="line"><span class="lineno"> 2445</span>    i_eb = (lb == ub)</div>
<div class="line"><span class="lineno"> 2446</span> </div>
<div class="line"><span class="lineno"> 2447</span>    <span class="keyword">def </span>check_x(x, check_size=True, check_values=True):</div>
<div class="line"><span class="lineno"> 2448</span>        <span class="keywordflow">if</span> check_size:</div>
<div class="line"><span class="lineno"> 2449</span>            <span class="keyword">assert</span> x.size == 4</div>
<div class="line"><span class="lineno"> 2450</span>        <span class="keywordflow">if</span> check_values:</div>
<div class="line"><span class="lineno"> 2451</span>            assert_allclose(x[i_eb], lb[i_eb])</div>
<div class="line"><span class="lineno"> 2452</span> </div>
<div class="line"><span class="lineno"> 2453</span>    <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x):</div>
<div class="line"><span class="lineno"> 2454</span>        check_x(x)</div>
<div class="line"><span class="lineno"> 2455</span>        <span class="keywordflow">return</span> optimize.rosen(x)</div>
<div class="line"><span class="lineno"> 2456</span> </div>
<div class="line"><span class="lineno"> 2457</span>    <span class="keyword">def </span>grad(x):</div>
<div class="line"><span class="lineno"> 2458</span>        check_x(x)</div>
<div class="line"><span class="lineno"> 2459</span>        <span class="keywordflow">return</span> optimize.rosen_der(x)</div>
<div class="line"><span class="lineno"> 2460</span> </div>
<div class="line"><span class="lineno"> 2461</span>    <span class="keyword">def </span>callback(x, *args):</div>
<div class="line"><span class="lineno"> 2462</span>        check_x(x)</div>
<div class="line"><span class="lineno"> 2463</span> </div>
<div class="line"><span class="lineno"> 2464</span>    <span class="keyword">def </span>constraint1(x):</div>
<div class="line"><span class="lineno"> 2465</span>        check_x(x, check_values=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 2466</span>        <span class="keywordflow">return</span> x[0:1] - 1</div>
<div class="line"><span class="lineno"> 2467</span> </div>
<div class="line"><span class="lineno"> 2468</span>    <span class="keyword">def </span>jacobian1(x):</div>
<div class="line"><span class="lineno"> 2469</span>        check_x(x, check_values=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 2470</span>        dc = np.zeros_like(x)</div>
<div class="line"><span class="lineno"> 2471</span>        dc[0] = 1</div>
<div class="line"><span class="lineno"> 2472</span>        <span class="keywordflow">return</span> dc</div>
<div class="line"><span class="lineno"> 2473</span> </div>
<div class="line"><span class="lineno"> 2474</span>    <span class="keyword">def </span>constraint2(x):</div>
<div class="line"><span class="lineno"> 2475</span>        check_x(x, check_values=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 2476</span>        <span class="keywordflow">return</span> x[2:3] - 0.5</div>
<div class="line"><span class="lineno"> 2477</span> </div>
<div class="line"><span class="lineno"> 2478</span>    <span class="keyword">def </span>jacobian2(x):</div>
<div class="line"><span class="lineno"> 2479</span>        check_x(x, check_values=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 2480</span>        dc = np.zeros_like(x)</div>
<div class="line"><span class="lineno"> 2481</span>        dc[2] = 1</div>
<div class="line"><span class="lineno"> 2482</span>        <span class="keywordflow">return</span> dc</div>
<div class="line"><span class="lineno"> 2483</span> </div>
<div class="line"><span class="lineno"> 2484</span>    c1a = NonlinearConstraint(constraint1, -np.inf, 0)</div>
<div class="line"><span class="lineno"> 2485</span>    c1b = NonlinearConstraint(constraint1, -np.inf, 0, jacobian1)</div>
<div class="line"><span class="lineno"> 2486</span>    c2a = NonlinearConstraint(constraint2, -np.inf, 0)</div>
<div class="line"><span class="lineno"> 2487</span>    c2b = NonlinearConstraint(constraint2, -np.inf, 0, jacobian2)</div>
<div class="line"><span class="lineno"> 2488</span> </div>
<div class="line"><span class="lineno"> 2489</span>    <span class="comment"># test using the three methods that accept bounds, use derivatives, and</span></div>
<div class="line"><span class="lineno"> 2490</span>    <span class="comment"># have some trouble when bounds fix variables</span></div>
<div class="line"><span class="lineno"> 2491</span>    methods = (<span class="stringliteral">&#39;L-BFGS-B&#39;</span>, <span class="stringliteral">&#39;SLSQP&#39;</span>, <span class="stringliteral">&#39;TNC&#39;</span>)</div>
<div class="line"><span class="lineno"> 2492</span> </div>
<div class="line"><span class="lineno"> 2493</span>    <span class="comment"># test w/out gradient, w/ gradient, and w/ combined objective/gradient</span></div>
<div class="line"><span class="lineno"> 2494</span>    kwds = ({<span class="stringliteral">&quot;fun&quot;</span>: func, <span class="stringliteral">&quot;jac&quot;</span>: <span class="keyword">False</span>},</div>
<div class="line"><span class="lineno"> 2495</span>            {<span class="stringliteral">&quot;fun&quot;</span>: func, <span class="stringliteral">&quot;jac&quot;</span>: grad},</div>
<div class="line"><span class="lineno"> 2496</span>            {<span class="stringliteral">&quot;fun&quot;</span>: (<span class="keyword">lambda</span> x: (<a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x), grad(x))),</div>
<div class="line"><span class="lineno"> 2497</span>             <span class="stringliteral">&quot;jac&quot;</span>: <span class="keyword">True</span>})</div>
<div class="line"><span class="lineno"> 2498</span> </div>
<div class="line"><span class="lineno"> 2499</span>    <span class="comment"># test with both old- and new-style bounds</span></div>
<div class="line"><span class="lineno"> 2500</span>    bound_types = (<span class="keyword">lambda</span> lb, ub: list(zip(lb, ub)),</div>
<div class="line"><span class="lineno"> 2501</span>                   Bounds)</div>
<div class="line"><span class="lineno"> 2502</span> </div>
<div class="line"><span class="lineno"> 2503</span>    <span class="comment"># Test for many combinations of constraints w/ and w/out jacobian</span></div>
<div class="line"><span class="lineno"> 2504</span>    <span class="comment"># Pairs in format: (test constraints, reference constraints)</span></div>
<div class="line"><span class="lineno"> 2505</span>    <span class="comment"># (always use analytical jacobian in reference)</span></div>
<div class="line"><span class="lineno"> 2506</span>    constraints = ((<span class="keywordtype">None</span>, <span class="keywordtype">None</span>), ([], []),</div>
<div class="line"><span class="lineno"> 2507</span>                   (c1a, c1b), (c2b, c2b),</div>
<div class="line"><span class="lineno"> 2508</span>                   ([c1b], [c1b]), ([c2a], [c2b]),</div>
<div class="line"><span class="lineno"> 2509</span>                   ([c1a, c2a], [c1b, c2b]),</div>
<div class="line"><span class="lineno"> 2510</span>                   ([c1a, c2b], [c1b, c2b]),</div>
<div class="line"><span class="lineno"> 2511</span>                   ([c1b, c2b], [c1b, c2b]))</div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>    <span class="comment"># test with and without callback function</span></div>
<div class="line"><span class="lineno"> 2514</span>    callbacks = (<span class="keywordtype">None</span>, callback)</div>
<div class="line"><span class="lineno"> 2515</span> </div>
<div class="line"><span class="lineno"> 2516</span>    data = {<span class="stringliteral">&quot;methods&quot;</span>: methods, <span class="stringliteral">&quot;kwds&quot;</span>: kwds, <span class="stringliteral">&quot;bound_types&quot;</span>: bound_types,</div>
<div class="line"><span class="lineno"> 2517</span>            <span class="stringliteral">&quot;constraints&quot;</span>: constraints, <span class="stringliteral">&quot;callbacks&quot;</span>: callbacks,</div>
<div class="line"><span class="lineno"> 2518</span>            <span class="stringliteral">&quot;lb&quot;</span>: lb, <span class="stringliteral">&quot;ub&quot;</span>: ub, <span class="stringliteral">&quot;x0&quot;</span>: x0, <span class="stringliteral">&quot;i_eb&quot;</span>: i_eb}</div>
<div class="line"><span class="lineno"> 2519</span> </div>
<div class="line"><span class="lineno"> 2520</span>    <span class="keywordflow">return</span> data</div>
<div class="line"><span class="lineno"> 2521</span> </div>
<div class="line"><span class="lineno"> 2522</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa075409f0589e57073625375a69e6d92" name="aa075409f0589e57073625375a69e6d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa075409f0589e57073625375a69e6d92">&#9670;&#160;</a></span>test_all_bounds_equal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_all_bounds_equal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2596</span><span class="keyword">def </span>test_all_bounds_equal(method):</div>
<div class="line"><span class="lineno"> 2597</span>    <span class="comment"># this only tests methods that have parameters factored out when lb==ub</span></div>
<div class="line"><span class="lineno"> 2598</span>    <span class="comment"># it does not test other methods that work with bounds</span></div>
<div class="line"><span class="lineno"> 2599</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x, p1=1):</div>
<div class="line"><span class="lineno"> 2600</span>        <span class="keywordflow">return</span> np.linalg.norm(x) + p1</div>
<div class="line"><span class="lineno"> 2601</span> </div>
<div class="line"><span class="lineno"> 2602</span>    bounds = [(1, 1), (2, 2)]</div>
<div class="line"><span class="lineno"> 2603</span>    x0 = (1.0, 3.0)</div>
<div class="line"><span class="lineno"> 2604</span>    res = optimize.minimize(f, x0, bounds=bounds, method=method)</div>
<div class="line"><span class="lineno"> 2605</span>    <span class="keyword">assert</span> res.success</div>
<div class="line"><span class="lineno"> 2606</span>    assert_allclose(res.fun, <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>([1.0, 2.0]))</div>
<div class="line"><span class="lineno"> 2607</span>    <span class="keyword">assert</span> res.nfev == 1</div>
<div class="line"><span class="lineno"> 2608</span>    <span class="keyword">assert</span> res.message == <span class="stringliteral">&#39;All independent variables were fixed by bounds.&#39;</span></div>
<div class="line"><span class="lineno"> 2609</span> </div>
<div class="line"><span class="lineno"> 2610</span>    args = (2,)</div>
<div class="line"><span class="lineno"> 2611</span>    res = optimize.minimize(f, x0, bounds=bounds, method=method, args=args)</div>
<div class="line"><span class="lineno"> 2612</span>    <span class="keyword">assert</span> res.success</div>
<div class="line"><span class="lineno"> 2613</span>    assert_allclose(res.fun, <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>([1.0, 2.0], 2))</div>
<div class="line"><span class="lineno"> 2614</span> </div>
<div class="line"><span class="lineno"> 2615</span>    <span class="keywordflow">if</span> method.upper() == <span class="stringliteral">&#39;SLSQP&#39;</span>:</div>
<div class="line"><span class="lineno"> 2616</span>        <span class="keyword">def </span>con(x):</div>
<div class="line"><span class="lineno"> 2617</span>            <span class="keywordflow">return</span> np.sum(x)</div>
<div class="line"><span class="lineno"> 2618</span>        nlc = NonlinearConstraint(con, -np.inf, 0.0)</div>
<div class="line"><span class="lineno"> 2619</span>        res = optimize.minimize(</div>
<div class="line"><span class="lineno"> 2620</span>            f, x0, bounds=bounds, method=method, constraints=[nlc]</div>
<div class="line"><span class="lineno"> 2621</span>        )</div>
<div class="line"><span class="lineno"> 2622</span>        <span class="keyword">assert</span> res.success <span class="keywordflow">is</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 2623</span>        assert_allclose(res.fun, <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>([1.0, 2.0]))</div>
<div class="line"><span class="lineno"> 2624</span>        <span class="keyword">assert</span> res.nfev == 1</div>
<div class="line"><span class="lineno"> 2625</span>        message = <span class="stringliteral">&quot;All independent variables were fixed by bounds, but&quot;</span></div>
<div class="line"><span class="lineno"> 2626</span>        <span class="keyword">assert</span> res.message.startswith(message)</div>
<div class="line"><span class="lineno"> 2627</span> </div>
<div class="line"><span class="lineno"> 2628</span>        nlc = NonlinearConstraint(con, -np.inf, 4)</div>
<div class="line"><span class="lineno"> 2629</span>        res = optimize.minimize(</div>
<div class="line"><span class="lineno"> 2630</span>            f, x0, bounds=bounds, method=method, constraints=[nlc]</div>
<div class="line"><span class="lineno"> 2631</span>        )</div>
<div class="line"><span class="lineno"> 2632</span>        <span class="keyword">assert</span> res.success <span class="keywordflow">is</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 2633</span>        assert_allclose(res.fun, <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>([1.0, 2.0]))</div>
<div class="line"><span class="lineno"> 2634</span>        <span class="keyword">assert</span> res.nfev == 1</div>
<div class="line"><span class="lineno"> 2635</span>        message = <span class="stringliteral">&quot;All independent variables were fixed by bounds at values&quot;</span></div>
<div class="line"><span class="lineno"> 2636</span>        <span class="keyword">assert</span> res.message.startswith(message)</div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b741021f18ee8cb4bd22e33567124f0" name="a3b741021f18ee8cb4bd22e33567124f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b741021f18ee8cb4bd22e33567124f0">&#9670;&#160;</a></span>test_approx_fprime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_approx_fprime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2757</span><span class="keyword">def </span>test_approx_fprime():</div>
<div class="line"><span class="lineno"> 2758</span>    <span class="comment"># check that approx_fprime (serviced by approx_derivative) works for</span></div>
<div class="line"><span class="lineno"> 2759</span>    <span class="comment"># jac and hess</span></div>
<div class="line"><span class="lineno"> 2760</span>    g = optimize.approx_fprime(himmelblau_x0, himmelblau)</div>
<div class="line"><span class="lineno"> 2761</span>    assert_allclose(g, himmelblau_grad(himmelblau_x0), rtol=5e-6)</div>
<div class="line"><span class="lineno"> 2762</span> </div>
<div class="line"><span class="lineno"> 2763</span>    h = optimize.approx_fprime(himmelblau_x0, himmelblau_grad)</div>
<div class="line"><span class="lineno"> 2764</span>    assert_allclose(h, himmelblau_hess(himmelblau_x0), rtol=5e-6)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9d04d96f95ecefac06b610679496cc2" name="ac9d04d96f95ecefac06b610679496cc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9d04d96f95ecefac06b610679496cc2">&#9670;&#160;</a></span>test_bounded_powell_outsidebounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_bounded_powell_outsidebounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  613</span><span class="keyword">def </span>test_bounded_powell_outsidebounds():</div>
<div class="line"><span class="lineno">  614</span>    <span class="comment"># With the bounded Powell method if you start outside the bounds the final</span></div>
<div class="line"><span class="lineno">  615</span>    <span class="comment"># should still be within the bounds (provided that the user doesn&#39;t make a</span></div>
<div class="line"><span class="lineno">  616</span>    <span class="comment"># bad choice for the `direc` argument).</span></div>
<div class="line"><span class="lineno">  617</span>    func = <span class="keyword">lambda</span> x: np.sum(x**2)</div>
<div class="line"><span class="lineno">  618</span>    bounds = (-1, 1), (-1, 1), (-1, 1)</div>
<div class="line"><span class="lineno">  619</span>    x0 = [-4, .5, -.8]</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    <span class="comment"># we&#39;re starting outside the bounds, so we should get a warning</span></div>
<div class="line"><span class="lineno">  622</span>    <span class="keyword">with</span> assert_warns(optimize.OptimizeWarning):</div>
<div class="line"><span class="lineno">  623</span>        res = optimize.minimize(func, x0, bounds=bounds, method=<span class="stringliteral">&quot;Powell&quot;</span>)</div>
<div class="line"><span class="lineno">  624</span>    assert_allclose(res.x, np.array([0.] * len(x0)), atol=1e-6)</div>
<div class="line"><span class="lineno">  625</span>    assert_equal(res.success, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  626</span>    assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>    <span class="comment"># However, now if we change the `direc` argument such that the</span></div>
<div class="line"><span class="lineno">  629</span>    <span class="comment"># set of vectors does not span the parameter space, then we may</span></div>
<div class="line"><span class="lineno">  630</span>    <span class="comment"># not end up back within the bounds. Here we see that the first</span></div>
<div class="line"><span class="lineno">  631</span>    <span class="comment"># parameter cannot be updated!</span></div>
<div class="line"><span class="lineno">  632</span>    direc = [[0, 0, 0], [0, 1, 0], [0, 0, 1]]</div>
<div class="line"><span class="lineno">  633</span>    <span class="comment"># we&#39;re starting outside the bounds, so we should get a warning</span></div>
<div class="line"><span class="lineno">  634</span>    <span class="keyword">with</span> assert_warns(optimize.OptimizeWarning):</div>
<div class="line"><span class="lineno">  635</span>        res = optimize.minimize(func, x0,</div>
<div class="line"><span class="lineno">  636</span>                                bounds=bounds, method=<span class="stringliteral">&quot;Powell&quot;</span>,</div>
<div class="line"><span class="lineno">  637</span>                                options={<span class="stringliteral">&#39;direc&#39;</span>: direc})</div>
<div class="line"><span class="lineno">  638</span>    assert_allclose(res.x, np.array([-4., 0, 0]), atol=1e-6)</div>
<div class="line"><span class="lineno">  639</span>    assert_equal(res.success, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  640</span>    assert_equal(res.status, 4)</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9793b8fe47f9fe1eef420f9141d31694" name="a9793b8fe47f9fe1eef420f9141d31694"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9793b8fe47f9fe1eef420f9141d31694">&#9670;&#160;</a></span>test_bounded_powell_vs_powell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_bounded_powell_vs_powell </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  643</span><span class="keyword">def </span>test_bounded_powell_vs_powell():</div>
<div class="line"><span class="lineno">  644</span>    <span class="comment"># here we test an example where the bounded Powell method</span></div>
<div class="line"><span class="lineno">  645</span>    <span class="comment"># will return a different result than the standard Powell</span></div>
<div class="line"><span class="lineno">  646</span>    <span class="comment"># method.</span></div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>    <span class="comment"># first we test a simple example where the minimum is at</span></div>
<div class="line"><span class="lineno">  649</span>    <span class="comment"># the origin and the minimum that is within the bounds is</span></div>
<div class="line"><span class="lineno">  650</span>    <span class="comment"># larger than the minimum at the origin.</span></div>
<div class="line"><span class="lineno">  651</span>    func = <span class="keyword">lambda</span> x: np.sum(x**2)</div>
<div class="line"><span class="lineno">  652</span>    bounds = (-5, -1), (-10, -0.1), (1, 9.2), (-4, 7.6), (-15.9, -2)</div>
<div class="line"><span class="lineno">  653</span>    x0 = [-2.1, -5.2, 1.9, 0, -2]</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>    options = {<span class="stringliteral">&#39;ftol&#39;</span>: 1e-10, <span class="stringliteral">&#39;xtol&#39;</span>: 1e-10}</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    res_powell = optimize.minimize(func, x0, method=<span class="stringliteral">&quot;Powell&quot;</span>, options=options)</div>
<div class="line"><span class="lineno">  658</span>    assert_allclose(res_powell.x, 0., atol=1e-6)</div>
<div class="line"><span class="lineno">  659</span>    assert_allclose(res_powell.fun, 0., atol=1e-6)</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>    res_bounded_powell = optimize.minimize(func, x0, options=options,</div>
<div class="line"><span class="lineno">  662</span>                                           bounds=bounds,</div>
<div class="line"><span class="lineno">  663</span>                                           method=<span class="stringliteral">&quot;Powell&quot;</span>)</div>
<div class="line"><span class="lineno">  664</span>    p = np.array([-1, -0.1, 1, 0, -2])</div>
<div class="line"><span class="lineno">  665</span>    assert_allclose(res_bounded_powell.x, p, atol=1e-6)</div>
<div class="line"><span class="lineno">  666</span>    assert_allclose(res_bounded_powell.fun, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p), atol=1e-6)</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    <span class="comment"># now we test bounded Powell but with a mix of inf bounds.</span></div>
<div class="line"><span class="lineno">  669</span>    bounds = (<span class="keywordtype">None</span>, -1), (-np.inf, -.1), (1, np.inf), (-4, <span class="keywordtype">None</span>), (-15.9, -2)</div>
<div class="line"><span class="lineno">  670</span>    res_bounded_powell = optimize.minimize(func, x0, options=options,</div>
<div class="line"><span class="lineno">  671</span>                                           bounds=bounds,</div>
<div class="line"><span class="lineno">  672</span>                                           method=<span class="stringliteral">&quot;Powell&quot;</span>)</div>
<div class="line"><span class="lineno">  673</span>    p = np.array([-1, -0.1, 1, 0, -2])</div>
<div class="line"><span class="lineno">  674</span>    assert_allclose(res_bounded_powell.x, p, atol=1e-6)</div>
<div class="line"><span class="lineno">  675</span>    assert_allclose(res_bounded_powell.fun, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p), atol=1e-6)</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>    <span class="comment"># next we test an example where the global minimum is within</span></div>
<div class="line"><span class="lineno">  678</span>    <span class="comment"># the bounds, but the bounded Powell method performs better</span></div>
<div class="line"><span class="lineno">  679</span>    <span class="comment"># than the standard Powell method.</span></div>
<div class="line"><span class="lineno">  680</span>    <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x):</div>
<div class="line"><span class="lineno">  681</span>        t = np.sin(-x[0]) * np.cos(x[1]) * np.sin(-x[0] * x[1]) * np.cos(x[1])</div>
<div class="line"><span class="lineno">  682</span>        t -= np.cos(np.sin(x[1] * x[2]) * np.cos(x[2]))</div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordflow">return</span> t**2</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>    bounds = [(-2, 5)] * 3</div>
<div class="line"><span class="lineno">  686</span>    x0 = [-0.5, -0.5, -0.5]</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span>    res_powell = optimize.minimize(func, x0, method=<span class="stringliteral">&quot;Powell&quot;</span>)</div>
<div class="line"><span class="lineno">  689</span>    res_bounded_powell = optimize.minimize(func, x0,</div>
<div class="line"><span class="lineno">  690</span>                                           bounds=bounds,</div>
<div class="line"><span class="lineno">  691</span>                                           method=<span class="stringliteral">&quot;Powell&quot;</span>)</div>
<div class="line"><span class="lineno">  692</span>    assert_allclose(res_powell.fun, 0.007136253919761627, atol=1e-6)</div>
<div class="line"><span class="lineno">  693</span>    assert_allclose(res_bounded_powell.fun, 0, atol=1e-6)</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>    <span class="comment"># next we test the previous example where the we provide Powell</span></div>
<div class="line"><span class="lineno">  696</span>    <span class="comment"># with (-inf, inf) bounds, and compare it to providing Powell</span></div>
<div class="line"><span class="lineno">  697</span>    <span class="comment"># with no bounds. They should end up the same.</span></div>
<div class="line"><span class="lineno">  698</span>    bounds = [(-np.inf, np.inf)] * 3</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>    res_bounded_powell = optimize.minimize(func, x0,</div>
<div class="line"><span class="lineno">  701</span>                                           bounds=bounds,</div>
<div class="line"><span class="lineno">  702</span>                                           method=<span class="stringliteral">&quot;Powell&quot;</span>)</div>
<div class="line"><span class="lineno">  703</span>    assert_allclose(res_powell.fun, res_bounded_powell.fun, atol=1e-6)</div>
<div class="line"><span class="lineno">  704</span>    assert_allclose(res_powell.nfev, res_bounded_powell.nfev, atol=1e-6)</div>
<div class="line"><span class="lineno">  705</span>    assert_allclose(res_powell.x, res_bounded_powell.x, atol=1e-6)</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="comment"># now test when x0 starts outside of the bounds.</span></div>
<div class="line"><span class="lineno">  708</span>    x0 = [45.46254415, -26.52351498, 31.74830248]</div>
<div class="line"><span class="lineno">  709</span>    bounds = [(-2, 5)] * 3</div>
<div class="line"><span class="lineno">  710</span>    <span class="comment"># we&#39;re starting outside the bounds, so we should get a warning</span></div>
<div class="line"><span class="lineno">  711</span>    <span class="keyword">with</span> assert_warns(optimize.OptimizeWarning):</div>
<div class="line"><span class="lineno">  712</span>        res_bounded_powell = optimize.minimize(func, x0,</div>
<div class="line"><span class="lineno">  713</span>                                               bounds=bounds,</div>
<div class="line"><span class="lineno">  714</span>                                               method=<span class="stringliteral">&quot;Powell&quot;</span>)</div>
<div class="line"><span class="lineno">  715</span>    assert_allclose(res_bounded_powell.fun, 0, atol=1e-6)</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a135354aebb30bc7050cc5d1027149dcc" name="a135354aebb30bc7050cc5d1027149dcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a135354aebb30bc7050cc5d1027149dcc">&#9670;&#160;</a></span>test_bounds_with_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_bounds_with_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2686</span><span class="keyword">def </span>test_bounds_with_list():</div>
<div class="line"><span class="lineno"> 2687</span>    <span class="comment"># gh13501. Bounds created with lists weren&#39;t working for Powell.</span></div>
<div class="line"><span class="lineno"> 2688</span>    bounds = optimize.Bounds(lb=[5., 5.], ub=[10., 10.])</div>
<div class="line"><span class="lineno"> 2689</span>    optimize.minimize(</div>
<div class="line"><span class="lineno"> 2690</span>        optimize.rosen, x0=np.array([9, 9]), method=<span class="stringliteral">&#39;Powell&#39;</span>, bounds=bounds</div>
<div class="line"><span class="lineno"> 2691</span>    )</div>
<div class="line"><span class="lineno"> 2692</span> </div>
<div class="line"><span class="lineno"> 2693</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a894fddbdb4fc86b7350df79320e694ae" name="a894fddbdb4fc86b7350df79320e694ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a894fddbdb4fc86b7350df79320e694ae">&#9670;&#160;</a></span>test_brent_negative_tolerance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_brent_negative_tolerance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1766</span><span class="keyword">def </span>test_brent_negative_tolerance():</div>
<div class="line"><span class="lineno"> 1767</span>    assert_raises(ValueError, optimize.brent, np.cos, tol=-.01)</div>
<div class="line"><span class="lineno"> 1768</span> </div>
<div class="line"><span class="lineno"> 1769</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae844ac1e585d5f5c5fee15c1092a0af2" name="ae844ac1e585d5f5c5fee15c1092a0af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae844ac1e585d5f5c5fee15c1092a0af2">&#9670;&#160;</a></span>test_check_grad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_check_grad </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   33</span><span class="keyword">def </span>test_check_grad():</div>
<div class="line"><span class="lineno">   34</span>    <span class="comment"># Verify if check_grad is able to estimate the derivative of the</span></div>
<div class="line"><span class="lineno">   35</span>    <span class="comment"># logistic function.</span></div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>    <span class="keyword">def </span>logit(x):</div>
<div class="line"><span class="lineno">   38</span>        <span class="keywordflow">return</span> 1 / (1 + np.exp(-x))</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    <span class="keyword">def </span>der_logit(x):</div>
<div class="line"><span class="lineno">   41</span>        <span class="keywordflow">return</span> np.exp(-x) / (1 + np.exp(-x))**2</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    x0 = np.array([1.5])</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    r = optimize.check_grad(logit, der_logit, x0)</div>
<div class="line"><span class="lineno">   46</span>    assert_almost_equal(r, 0)</div>
<div class="line"><span class="lineno">   47</span>    r = optimize.check_grad(logit, der_logit, x0,</div>
<div class="line"><span class="lineno">   48</span>                            direction=<span class="stringliteral">&#39;random&#39;</span>, seed=1234)</div>
<div class="line"><span class="lineno">   49</span>    assert_almost_equal(r, 0)</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    r = optimize.check_grad(logit, der_logit, x0, epsilon=1e-6)</div>
<div class="line"><span class="lineno">   52</span>    assert_almost_equal(r, 0)</div>
<div class="line"><span class="lineno">   53</span>    r = optimize.check_grad(logit, der_logit, x0, epsilon=1e-6,</div>
<div class="line"><span class="lineno">   54</span>                            direction=<span class="stringliteral">&#39;random&#39;</span>, seed=1234)</div>
<div class="line"><span class="lineno">   55</span>    assert_almost_equal(r, 0)</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="comment"># Check if the epsilon parameter is being considered.</span></div>
<div class="line"><span class="lineno">   58</span>    r = abs(optimize.check_grad(logit, der_logit, x0, epsilon=1e-1) - 0)</div>
<div class="line"><span class="lineno">   59</span>    <span class="keyword">assert</span> r &gt; 1e-7</div>
<div class="line"><span class="lineno">   60</span>    r = abs(optimize.check_grad(logit, der_logit, x0, epsilon=1e-1,</div>
<div class="line"><span class="lineno">   61</span>                                direction=<span class="stringliteral">&#39;random&#39;</span>, seed=1234) - 0)</div>
<div class="line"><span class="lineno">   62</span>    <span class="keyword">assert</span> r &gt; 1e-7</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>    <span class="keyword">def </span>x_sinx(x):</div>
<div class="line"><span class="lineno">   65</span>        <span class="keywordflow">return</span> (x*np.sin(x)).sum()</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    <span class="keyword">def </span>der_x_sinx(x):</div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">return</span> np.sin(x) + x*np.cos(x)</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    x0 = np.arange(0, 2, 0.2)</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    r = optimize.check_grad(x_sinx, der_x_sinx, x0,</div>
<div class="line"><span class="lineno">   73</span>                            direction=<span class="stringliteral">&#39;random&#39;</span>, seed=1234)</div>
<div class="line"><span class="lineno">   74</span>    assert_almost_equal(r, 0)</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    assert_raises(ValueError, optimize.check_grad,</div>
<div class="line"><span class="lineno">   77</span>                  x_sinx, der_x_sinx, x0,</div>
<div class="line"><span class="lineno">   78</span>                  direction=<span class="stringliteral">&#39;random_projection&#39;</span>, seed=1234)</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    <span class="comment"># checking can be done for derivatives of vector valued functions</span></div>
<div class="line"><span class="lineno">   81</span>    r = optimize.check_grad(himmelblau_grad, himmelblau_hess, himmelblau_x0,</div>
<div class="line"><span class="lineno">   82</span>                            direction=<span class="stringliteral">&#39;all&#39;</span>, seed=1234)</div>
<div class="line"><span class="lineno">   83</span>    <span class="keyword">assert</span> r &lt; 5e-7</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac18dac61a7f85556633d7ffe9cf7a502" name="ac18dac61a7f85556633d7ffe9cf7a502"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac18dac61a7f85556633d7ffe9cf7a502">&#9670;&#160;</a></span>test_cobyla_threadsafe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_cobyla_threadsafe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2232</span><span class="keyword">def </span>test_cobyla_threadsafe():</div>
<div class="line"><span class="lineno"> 2233</span> </div>
<div class="line"><span class="lineno"> 2234</span>    <span class="comment"># Verify that cobyla is threadsafe. Will segfault if it is not.</span></div>
<div class="line"><span class="lineno"> 2235</span> </div>
<div class="line"><span class="lineno"> 2236</span>    <span class="keyword">import</span> concurrent.futures</div>
<div class="line"><span class="lineno"> 2237</span>    <span class="keyword">import</span> time</div>
<div class="line"><span class="lineno"> 2238</span> </div>
<div class="line"><span class="lineno"> 2239</span>    <span class="keyword">def </span>objective1(x):</div>
<div class="line"><span class="lineno"> 2240</span>        time.sleep(0.1)</div>
<div class="line"><span class="lineno"> 2241</span>        <span class="keywordflow">return</span> x[0]**2</div>
<div class="line"><span class="lineno"> 2242</span> </div>
<div class="line"><span class="lineno"> 2243</span>    <span class="keyword">def </span>objective2(x):</div>
<div class="line"><span class="lineno"> 2244</span>        time.sleep(0.1)</div>
<div class="line"><span class="lineno"> 2245</span>        <span class="keywordflow">return</span> (x[0]-1)**2</div>
<div class="line"><span class="lineno"> 2246</span> </div>
<div class="line"><span class="lineno"> 2247</span>    min_method = <span class="stringliteral">&quot;COBYLA&quot;</span></div>
<div class="line"><span class="lineno"> 2248</span> </div>
<div class="line"><span class="lineno"> 2249</span>    <span class="keyword">def </span>minimizer1():</div>
<div class="line"><span class="lineno"> 2250</span>        <span class="keywordflow">return</span> optimize.minimize(objective1,</div>
<div class="line"><span class="lineno"> 2251</span>                                      [0.0],</div>
<div class="line"><span class="lineno"> 2252</span>                                      method=min_method)</div>
<div class="line"><span class="lineno"> 2253</span> </div>
<div class="line"><span class="lineno"> 2254</span>    <span class="keyword">def </span>minimizer2():</div>
<div class="line"><span class="lineno"> 2255</span>        <span class="keywordflow">return</span> optimize.minimize(objective2,</div>
<div class="line"><span class="lineno"> 2256</span>                                      [0.0],</div>
<div class="line"><span class="lineno"> 2257</span>                                      method=min_method)</div>
<div class="line"><span class="lineno"> 2258</span> </div>
<div class="line"><span class="lineno"> 2259</span>    <span class="keyword">with</span> concurrent.futures.ThreadPoolExecutor() <span class="keyword">as</span> pool:</div>
<div class="line"><span class="lineno"> 2260</span>        tasks = []</div>
<div class="line"><span class="lineno"> 2261</span>        tasks.append(pool.submit(minimizer1))</div>
<div class="line"><span class="lineno"> 2262</span>        tasks.append(pool.submit(minimizer2))</div>
<div class="line"><span class="lineno"> 2263</span>        <span class="keywordflow">for</span> t <span class="keywordflow">in</span> tasks:</div>
<div class="line"><span class="lineno"> 2264</span>            res = t.result()</div>
<div class="line"><span class="lineno"> 2265</span> </div>
<div class="line"><span class="lineno"> 2266</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af039bc3b47f7963be2d10ce066324de3" name="af039bc3b47f7963be2d10ce066324de3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af039bc3b47f7963be2d10ce066324de3">&#9670;&#160;</a></span>test_eb_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_eb_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2639</span><span class="keyword">def </span>test_eb_constraints():</div>
<div class="line"><span class="lineno"> 2640</span>    <span class="comment"># make sure constraint functions aren&#39;t overwritten when equal bounds</span></div>
<div class="line"><span class="lineno"> 2641</span>    <span class="comment"># are employed, and a parameter is factored out. GH14859</span></div>
<div class="line"><span class="lineno"> 2642</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x):</div>
<div class="line"><span class="lineno"> 2643</span>        <span class="keywordflow">return</span> x[0]**3 + x[1]**2 + x[2]*x[3]</div>
<div class="line"><span class="lineno"> 2644</span> </div>
<div class="line"><span class="lineno"> 2645</span>    <span class="keyword">def </span>cfun(x):</div>
<div class="line"><span class="lineno"> 2646</span>        <span class="keywordflow">return</span> x[0] + x[1] + x[2] + x[3] - 40</div>
<div class="line"><span class="lineno"> 2647</span> </div>
<div class="line"><span class="lineno"> 2648</span>    constraints = [{<span class="stringliteral">&#39;type&#39;</span>: <span class="stringliteral">&#39;ineq&#39;</span>, <span class="stringliteral">&#39;fun&#39;</span>: cfun}]</div>
<div class="line"><span class="lineno"> 2649</span> </div>
<div class="line"><span class="lineno"> 2650</span>    bounds = [(0, 20)] * 4</div>
<div class="line"><span class="lineno"> 2651</span>    bounds[1] = (5, 5)</div>
<div class="line"><span class="lineno"> 2652</span>    optimize.minimize(</div>
<div class="line"><span class="lineno"> 2653</span>        f,</div>
<div class="line"><span class="lineno"> 2654</span>        x0=[1, 2, 3, 4],</div>
<div class="line"><span class="lineno"> 2655</span>        method=<span class="stringliteral">&#39;SLSQP&#39;</span>,</div>
<div class="line"><span class="lineno"> 2656</span>        bounds=bounds,</div>
<div class="line"><span class="lineno"> 2657</span>        constraints=constraints,</div>
<div class="line"><span class="lineno"> 2658</span>    )</div>
<div class="line"><span class="lineno"> 2659</span>    <span class="keyword">assert</span> constraints[0][<span class="stringliteral">&#39;fun&#39;</span>] == cfun</div>
<div class="line"><span class="lineno"> 2660</span> </div>
<div class="line"><span class="lineno"> 2661</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a900060b50515a745b130a06ab0239b05" name="a900060b50515a745b130a06ab0239b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a900060b50515a745b130a06ab0239b05">&#9670;&#160;</a></span>test_equal_bounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_equal_bounds </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bound_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constraints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Tests that minimizers still work if (bounds.lb == bounds.ub).any()
gh12502 - Divide by zero in Jacobian numerical differentiation when
equality bounds constraints are used
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2533</span><span class="keyword">def </span>test_equal_bounds(method, kwds, bound_type, constraints, callback):</div>
<div class="line"><span class="lineno"> 2534</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2535</span><span class="stringliteral">    Tests that minimizers still work if (bounds.lb == bounds.ub).any()</span></div>
<div class="line"><span class="lineno"> 2536</span><span class="stringliteral">    gh12502 - Divide by zero in Jacobian numerical differentiation when</span></div>
<div class="line"><span class="lineno"> 2537</span><span class="stringliteral">    equality bounds constraints are used</span></div>
<div class="line"><span class="lineno"> 2538</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2539</span>    <span class="comment"># GH-15051; slightly more skips than necessary; hopefully fixed by GH-14882</span></div>
<div class="line"><span class="lineno"> 2540</span>    <span class="keywordflow">if</span> (platform.machine() == <span class="stringliteral">&#39;aarch64&#39;</span> <span class="keywordflow">and</span> method == <span class="stringliteral">&quot;TNC&quot;</span></div>
<div class="line"><span class="lineno"> 2541</span>            <span class="keywordflow">and</span> kwds[<span class="stringliteral">&quot;jac&quot;</span>] <span class="keywordflow">is</span> <span class="keyword">False</span> <span class="keywordflow">and</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2542</span>        pytest.skip(<span class="stringliteral">&#39;Tolerance violation on aarch&#39;</span>)</div>
<div class="line"><span class="lineno"> 2543</span> </div>
<div class="line"><span class="lineno"> 2544</span>    lb, ub = eb_data[<span class="stringliteral">&quot;lb&quot;</span>], eb_data[<span class="stringliteral">&quot;ub&quot;</span>]</div>
<div class="line"><span class="lineno"> 2545</span>    x0, i_eb = eb_data[<span class="stringliteral">&quot;x0&quot;</span>], eb_data[<span class="stringliteral">&quot;i_eb&quot;</span>]</div>
<div class="line"><span class="lineno"> 2546</span> </div>
<div class="line"><span class="lineno"> 2547</span>    test_constraints, reference_constraints = constraints</div>
<div class="line"><span class="lineno"> 2548</span>    <span class="keywordflow">if</span> test_constraints <span class="keywordflow">and</span> <span class="keywordflow">not</span> method == <span class="stringliteral">&#39;SLSQP&#39;</span>:</div>
<div class="line"><span class="lineno"> 2549</span>        pytest.skip(<span class="stringliteral">&#39;Only SLSQP supports nonlinear constraints&#39;</span>)</div>
<div class="line"><span class="lineno"> 2550</span>    <span class="comment"># reference constraints always have analytical jacobian</span></div>
<div class="line"><span class="lineno"> 2551</span>    <span class="comment"># if test constraints are not the same, we&#39;ll need finite differences</span></div>
<div class="line"><span class="lineno"> 2552</span>    fd_needed = (test_constraints != reference_constraints)</div>
<div class="line"><span class="lineno"> 2553</span> </div>
<div class="line"><span class="lineno"> 2554</span>    bounds = bound_type(lb, ub)  <span class="comment"># old- or new-style</span></div>
<div class="line"><span class="lineno"> 2555</span> </div>
<div class="line"><span class="lineno"> 2556</span>    kwds.update({<span class="stringliteral">&quot;x0&quot;</span>: x0, <span class="stringliteral">&quot;method&quot;</span>: method, <span class="stringliteral">&quot;bounds&quot;</span>: bounds,</div>
<div class="line"><span class="lineno"> 2557</span>                 <span class="stringliteral">&quot;constraints&quot;</span>: test_constraints, <span class="stringliteral">&quot;callback&quot;</span>: callback})</div>
<div class="line"><span class="lineno"> 2558</span>    res = optimize.minimize(**kwds)</div>
<div class="line"><span class="lineno"> 2559</span> </div>
<div class="line"><span class="lineno"> 2560</span>    expected = optimize.minimize(optimize.rosen, x0, method=method,</div>
<div class="line"><span class="lineno"> 2561</span>                                 jac=optimize.rosen_der, bounds=bounds,</div>
<div class="line"><span class="lineno"> 2562</span>                                 constraints=reference_constraints)</div>
<div class="line"><span class="lineno"> 2563</span> </div>
<div class="line"><span class="lineno"> 2564</span>    <span class="comment"># compare the output of a solution with FD vs that of an analytic grad</span></div>
<div class="line"><span class="lineno"> 2565</span>    <span class="keyword">assert</span> res.success</div>
<div class="line"><span class="lineno"> 2566</span>    assert_allclose(res.fun, expected.fun, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 2567</span>    assert_allclose(res.x, expected.x, rtol=5e-4)</div>
<div class="line"><span class="lineno"> 2568</span> </div>
<div class="line"><span class="lineno"> 2569</span>    <span class="keywordflow">if</span> fd_needed <span class="keywordflow">or</span> kwds[<span class="stringliteral">&#39;jac&#39;</span>] <span class="keywordflow">is</span> <span class="keyword">False</span>:</div>
<div class="line"><span class="lineno"> 2570</span>        expected.jac[i_eb] = np.nan</div>
<div class="line"><span class="lineno"> 2571</span>    <span class="keyword">assert</span> res.jac.shape[0] == 4</div>
<div class="line"><span class="lineno"> 2572</span>    assert_allclose(res.jac[i_eb], expected.jac[i_eb], rtol=1e-6)</div>
<div class="line"><span class="lineno"> 2573</span> </div>
<div class="line"><span class="lineno"> 2574</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (kwds[<span class="stringliteral">&#39;jac&#39;</span>] <span class="keywordflow">or</span> test_constraints <span class="keywordflow">or</span> isinstance(bounds, Bounds)):</div>
<div class="line"><span class="lineno"> 2575</span>        <span class="comment"># compare the output to an equivalent FD minimization that doesn&#39;t</span></div>
<div class="line"><span class="lineno"> 2576</span>        <span class="comment"># need factorization</span></div>
<div class="line"><span class="lineno"> 2577</span>        <span class="keyword">def </span>fun(x):</div>
<div class="line"><span class="lineno"> 2578</span>            new_x = np.array([np.nan, 2, np.nan, -1])</div>
<div class="line"><span class="lineno"> 2579</span>            new_x[[0, 2]] = x</div>
<div class="line"><span class="lineno"> 2580</span>            <span class="keywordflow">return</span> optimize.rosen(new_x)</div>
<div class="line"><span class="lineno"> 2581</span> </div>
<div class="line"><span class="lineno"> 2582</span>        fd_res = optimize.minimize(fun,</div>
<div class="line"><span class="lineno"> 2583</span>                                   x0[[0, 2]],</div>
<div class="line"><span class="lineno"> 2584</span>                                   method=method,</div>
<div class="line"><span class="lineno"> 2585</span>                                   bounds=bounds[::2])</div>
<div class="line"><span class="lineno"> 2586</span>        assert_allclose(res.fun, fd_res.fun)</div>
<div class="line"><span class="lineno"> 2587</span>        <span class="comment"># TODO this test should really be equivalent to factorized version</span></div>
<div class="line"><span class="lineno"> 2588</span>        <span class="comment"># above, down to res.nfev. However, testing found that when TNC is</span></div>
<div class="line"><span class="lineno"> 2589</span>        <span class="comment"># called with or without a callback the output is different. The two</span></div>
<div class="line"><span class="lineno"> 2590</span>        <span class="comment"># should be the same! This indicates that the TNC callback may be</span></div>
<div class="line"><span class="lineno"> 2591</span>        <span class="comment"># mutating something when it should&#39;t.</span></div>
<div class="line"><span class="lineno"> 2592</span>        assert_allclose(res.x[[0, 2]], fd_res.x, rtol=2e-6)</div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span> </div>
<div class="line"><span class="lineno"> 2595</span><span class="preprocessor">@pytest.mark.parametrize(&#39;method&#39;, eb_data[&quot;methods&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a79dbb358812b42c2a9cbf874bb71ac51" name="a79dbb358812b42c2a9cbf874bb71ac51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79dbb358812b42c2a9cbf874bb71ac51">&#9670;&#160;</a></span>test_gh12696()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_gh12696 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2430</span><span class="keyword">def </span>test_gh12696():</div>
<div class="line"><span class="lineno"> 2431</span>    <span class="comment"># Test that optimize doesn&#39;t throw warning gh-12696</span></div>
<div class="line"><span class="lineno"> 2432</span>    <span class="keyword">with</span> assert_no_warnings():</div>
<div class="line"><span class="lineno"> 2433</span>        optimize.fminbound(</div>
<div class="line"><span class="lineno"> 2434</span>            <span class="keyword">lambda</span> x: np.array([x**2]), -np.pi, np.pi, disp=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 2435</span> </div>
<div class="line"><span class="lineno"> 2436</span> </div>
<div class="line"><span class="lineno"> 2437</span><span class="comment"># --- Test minimize with equal upper and lower bounds --- #</span></div>
<div class="line"><span class="lineno"> 2438</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9efa9b3494413a735c7455664279c080" name="a9efa9b3494413a735c7455664279c080"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9efa9b3494413a735c7455664279c080">&#9670;&#160;</a></span>test_line_for_search()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_line_for_search </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1814</span><span class="keyword">def </span>test_line_for_search():</div>
<div class="line"><span class="lineno"> 1815</span>    <span class="comment"># _line_for_search is only used in _linesearch_powell, which is also</span></div>
<div class="line"><span class="lineno"> 1816</span>    <span class="comment"># tested below. Thus there are more tests of _line_for_search in the</span></div>
<div class="line"><span class="lineno"> 1817</span>    <span class="comment"># test_linesearch_powell_bounded function.</span></div>
<div class="line"><span class="lineno"> 1818</span> </div>
<div class="line"><span class="lineno"> 1819</span>    line_for_search = optimize._optimize._line_for_search</div>
<div class="line"><span class="lineno"> 1820</span>    <span class="comment"># args are x0, alpha, lower_bound, upper_bound</span></div>
<div class="line"><span class="lineno"> 1821</span>    <span class="comment"># returns lmin, lmax</span></div>
<div class="line"><span class="lineno"> 1822</span> </div>
<div class="line"><span class="lineno"> 1823</span>    lower_bound = np.array([-5.3, -1, -1.5, -3])</div>
<div class="line"><span class="lineno"> 1824</span>    upper_bound = np.array([1.9, 1, 2.8, 3])</div>
<div class="line"><span class="lineno"> 1825</span> </div>
<div class="line"><span class="lineno"> 1826</span>    <span class="comment"># test when starting in the bounds</span></div>
<div class="line"><span class="lineno"> 1827</span>    x0 = np.array([0., 0, 0, 0])</div>
<div class="line"><span class="lineno"> 1828</span>    <span class="comment"># and when starting outside of the bounds</span></div>
<div class="line"><span class="lineno"> 1829</span>    x1 = np.array([0., 2, -3, 0])</div>
<div class="line"><span class="lineno"> 1830</span> </div>
<div class="line"><span class="lineno"> 1831</span>    all_tests = (</div>
<div class="line"><span class="lineno"> 1832</span>        (x0, np.array([1., 0, 0, 0]), -5.3, 1.9),</div>
<div class="line"><span class="lineno"> 1833</span>        (x0, np.array([0., 1, 0, 0]), -1, 1),</div>
<div class="line"><span class="lineno"> 1834</span>        (x0, np.array([0., 0, 1, 0]), -1.5, 2.8),</div>
<div class="line"><span class="lineno"> 1835</span>        (x0, np.array([0., 0, 0, 1]), -3, 3),</div>
<div class="line"><span class="lineno"> 1836</span>        (x0, np.array([1., 1, 0, 0]), -1, 1),</div>
<div class="line"><span class="lineno"> 1837</span>        (x0, np.array([1., 0, -1, 2]), -1.5, 1.5),</div>
<div class="line"><span class="lineno"> 1838</span>        (x0, np.array([2., 0, -1, 2]), -1.5, 0.95),</div>
<div class="line"><span class="lineno"> 1839</span>        (x1, np.array([1., 0, 0, 0]), -5.3, 1.9),</div>
<div class="line"><span class="lineno"> 1840</span>        (x1, np.array([0., 1, 0, 0]), -3, -1),</div>
<div class="line"><span class="lineno"> 1841</span>        (x1, np.array([0., 0, 1, 0]), 1.5, 5.8),</div>
<div class="line"><span class="lineno"> 1842</span>        (x1, np.array([0., 0, 0, 1]), -3, 3),</div>
<div class="line"><span class="lineno"> 1843</span>        (x1, np.array([1., 1, 0, 0]), -3, -1),</div>
<div class="line"><span class="lineno"> 1844</span>        (x1, np.array([1., 0, -1, 0]), -5.3, -1.5),</div>
<div class="line"><span class="lineno"> 1845</span>    )</div>
<div class="line"><span class="lineno"> 1846</span> </div>
<div class="line"><span class="lineno"> 1847</span>    <span class="keywordflow">for</span> x, alpha, lmin, lmax <span class="keywordflow">in</span> all_tests:</div>
<div class="line"><span class="lineno"> 1848</span>        mi, ma = line_for_search(x, alpha, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno"> 1849</span>        assert_allclose(mi, lmin, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1850</span>        assert_allclose(ma, lmax, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1851</span> </div>
<div class="line"><span class="lineno"> 1852</span>    <span class="comment"># now with infinite bounds</span></div>
<div class="line"><span class="lineno"> 1853</span>    lower_bound = np.array([-np.inf, -1, -np.inf, -3])</div>
<div class="line"><span class="lineno"> 1854</span>    upper_bound = np.array([np.inf, 1, 2.8, np.inf])</div>
<div class="line"><span class="lineno"> 1855</span> </div>
<div class="line"><span class="lineno"> 1856</span>    all_tests = (</div>
<div class="line"><span class="lineno"> 1857</span>        (x0, np.array([1., 0, 0, 0]), -np.inf, np.inf),</div>
<div class="line"><span class="lineno"> 1858</span>        (x0, np.array([0., 1, 0, 0]), -1, 1),</div>
<div class="line"><span class="lineno"> 1859</span>        (x0, np.array([0., 0, 1, 0]), -np.inf, 2.8),</div>
<div class="line"><span class="lineno"> 1860</span>        (x0, np.array([0., 0, 0, 1]), -3, np.inf),</div>
<div class="line"><span class="lineno"> 1861</span>        (x0, np.array([1., 1, 0, 0]), -1, 1),</div>
<div class="line"><span class="lineno"> 1862</span>        (x0, np.array([1., 0, -1, 2]), -1.5, np.inf),</div>
<div class="line"><span class="lineno"> 1863</span>        (x1, np.array([1., 0, 0, 0]), -np.inf, np.inf),</div>
<div class="line"><span class="lineno"> 1864</span>        (x1, np.array([0., 1, 0, 0]), -3, -1),</div>
<div class="line"><span class="lineno"> 1865</span>        (x1, np.array([0., 0, 1, 0]), -np.inf, 5.8),</div>
<div class="line"><span class="lineno"> 1866</span>        (x1, np.array([0., 0, 0, 1]), -3, np.inf),</div>
<div class="line"><span class="lineno"> 1867</span>        (x1, np.array([1., 1, 0, 0]), -3, -1),</div>
<div class="line"><span class="lineno"> 1868</span>        (x1, np.array([1., 0, -1, 0]), -5.8, np.inf),</div>
<div class="line"><span class="lineno"> 1869</span>    )</div>
<div class="line"><span class="lineno"> 1870</span> </div>
<div class="line"><span class="lineno"> 1871</span>    <span class="keywordflow">for</span> x, alpha, lmin, lmax <span class="keywordflow">in</span> all_tests:</div>
<div class="line"><span class="lineno"> 1872</span>        mi, ma = line_for_search(x, alpha, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno"> 1873</span>        assert_allclose(mi, lmin, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1874</span>        assert_allclose(ma, lmax, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1875</span> </div>
<div class="line"><span class="lineno"> 1876</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ce8397ef914692942dc3b18c903e38f" name="a7ce8397ef914692942dc3b18c903e38f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce8397ef914692942dc3b18c903e38f">&#9670;&#160;</a></span>test_linesearch_powell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_linesearch_powell </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1877</span><span class="keyword">def </span>test_linesearch_powell():</div>
<div class="line"><span class="lineno"> 1878</span>    <span class="comment"># helper function in optimize.py, not a public function.</span></div>
<div class="line"><span class="lineno"> 1879</span>    linesearch_powell = optimize._optimize._linesearch_powell</div>
<div class="line"><span class="lineno"> 1880</span>    <span class="comment"># args are func, p, xi, fval, lower_bound=None, upper_bound=None, tol=1e-3</span></div>
<div class="line"><span class="lineno"> 1881</span>    <span class="comment"># returns new_fval, p + direction, direction</span></div>
<div class="line"><span class="lineno"> 1882</span>    func = <span class="keyword">lambda</span> x: np.sum((x - np.array([-1., 2., 1.5, -.4]))**2)</div>
<div class="line"><span class="lineno"> 1883</span>    p0 = np.array([0., 0, 0, 0])</div>
<div class="line"><span class="lineno"> 1884</span>    fval = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p0)</div>
<div class="line"><span class="lineno"> 1885</span>    lower_bound = np.array([-np.inf] * 4)</div>
<div class="line"><span class="lineno"> 1886</span>    upper_bound = np.array([np.inf] * 4)</div>
<div class="line"><span class="lineno"> 1887</span> </div>
<div class="line"><span class="lineno"> 1888</span>    all_tests = (</div>
<div class="line"><span class="lineno"> 1889</span>        (np.array([1., 0, 0, 0]), -1),</div>
<div class="line"><span class="lineno"> 1890</span>        (np.array([0., 1, 0, 0]), 2),</div>
<div class="line"><span class="lineno"> 1891</span>        (np.array([0., 0, 1, 0]), 1.5),</div>
<div class="line"><span class="lineno"> 1892</span>        (np.array([0., 0, 0, 1]), -.4),</div>
<div class="line"><span class="lineno"> 1893</span>        (np.array([-1., 0, 1, 0]), 1.25),</div>
<div class="line"><span class="lineno"> 1894</span>        (np.array([0., 0, 1, 1]), .55),</div>
<div class="line"><span class="lineno"> 1895</span>        (np.array([2., 0, -1, 1]), -.65),</div>
<div class="line"><span class="lineno"> 1896</span>    )</div>
<div class="line"><span class="lineno"> 1897</span> </div>
<div class="line"><span class="lineno"> 1898</span>    <span class="keywordflow">for</span> xi, l <span class="keywordflow">in</span> all_tests:</div>
<div class="line"><span class="lineno"> 1899</span>        f, p, direction = linesearch_powell(func, p0, xi,</div>
<div class="line"><span class="lineno"> 1900</span>                                            fval=fval, tol=1e-5)</div>
<div class="line"><span class="lineno"> 1901</span>        assert_allclose(f, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(l * xi), atol=1e-6)</div>
<div class="line"><span class="lineno"> 1902</span>        assert_allclose(p, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1903</span>        assert_allclose(direction, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1904</span> </div>
<div class="line"><span class="lineno"> 1905</span>        f, p, direction = linesearch_powell(func, p0, xi, tol=1e-5,</div>
<div class="line"><span class="lineno"> 1906</span>                                            lower_bound=lower_bound,</div>
<div class="line"><span class="lineno"> 1907</span>                                            upper_bound=upper_bound,</div>
<div class="line"><span class="lineno"> 1908</span>                                            fval=fval)</div>
<div class="line"><span class="lineno"> 1909</span>        assert_allclose(f, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(l * xi), atol=1e-6)</div>
<div class="line"><span class="lineno"> 1910</span>        assert_allclose(p, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1911</span>        assert_allclose(direction, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1912</span> </div>
<div class="line"><span class="lineno"> 1913</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5eed140de3ab6e56a6e0a2dfd5d8b60" name="ac5eed140de3ab6e56a6e0a2dfd5d8b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5eed140de3ab6e56a6e0a2dfd5d8b60">&#9670;&#160;</a></span>test_linesearch_powell_bounded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_linesearch_powell_bounded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1914</span><span class="keyword">def </span>test_linesearch_powell_bounded():</div>
<div class="line"><span class="lineno"> 1915</span>    <span class="comment"># helper function in optimize.py, not a public function.</span></div>
<div class="line"><span class="lineno"> 1916</span>    linesearch_powell = optimize._optimize._linesearch_powell</div>
<div class="line"><span class="lineno"> 1917</span>    <span class="comment"># args are func, p, xi, fval, lower_bound=None, upper_bound=None, tol=1e-3</span></div>
<div class="line"><span class="lineno"> 1918</span>    <span class="comment"># returns new_fval, p+direction, direction</span></div>
<div class="line"><span class="lineno"> 1919</span>    func = <span class="keyword">lambda</span> x: np.sum((x-np.array([-1., 2., 1.5, -.4]))**2)</div>
<div class="line"><span class="lineno"> 1920</span>    p0 = np.array([0., 0, 0, 0])</div>
<div class="line"><span class="lineno"> 1921</span>    fval = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p0)</div>
<div class="line"><span class="lineno"> 1922</span> </div>
<div class="line"><span class="lineno"> 1923</span>    <span class="comment"># first choose bounds such that the same tests from</span></div>
<div class="line"><span class="lineno"> 1924</span>    <span class="comment"># test_linesearch_powell should pass.</span></div>
<div class="line"><span class="lineno"> 1925</span>    lower_bound = np.array([-2.]*4)</div>
<div class="line"><span class="lineno"> 1926</span>    upper_bound = np.array([2.]*4)</div>
<div class="line"><span class="lineno"> 1927</span> </div>
<div class="line"><span class="lineno"> 1928</span>    all_tests = (</div>
<div class="line"><span class="lineno"> 1929</span>        (np.array([1., 0, 0, 0]), -1),</div>
<div class="line"><span class="lineno"> 1930</span>        (np.array([0., 1, 0, 0]), 2),</div>
<div class="line"><span class="lineno"> 1931</span>        (np.array([0., 0, 1, 0]), 1.5),</div>
<div class="line"><span class="lineno"> 1932</span>        (np.array([0., 0, 0, 1]), -.4),</div>
<div class="line"><span class="lineno"> 1933</span>        (np.array([-1., 0, 1, 0]), 1.25),</div>
<div class="line"><span class="lineno"> 1934</span>        (np.array([0., 0, 1, 1]), .55),</div>
<div class="line"><span class="lineno"> 1935</span>        (np.array([2., 0, -1, 1]), -.65),</div>
<div class="line"><span class="lineno"> 1936</span>    )</div>
<div class="line"><span class="lineno"> 1937</span> </div>
<div class="line"><span class="lineno"> 1938</span>    <span class="keywordflow">for</span> xi, l <span class="keywordflow">in</span> all_tests:</div>
<div class="line"><span class="lineno"> 1939</span>        f, p, direction = linesearch_powell(func, p0, xi, tol=1e-5,</div>
<div class="line"><span class="lineno"> 1940</span>                                            lower_bound=lower_bound,</div>
<div class="line"><span class="lineno"> 1941</span>                                            upper_bound=upper_bound,</div>
<div class="line"><span class="lineno"> 1942</span>                                            fval=fval)</div>
<div class="line"><span class="lineno"> 1943</span>        assert_allclose(f, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(l * xi), atol=1e-6)</div>
<div class="line"><span class="lineno"> 1944</span>        assert_allclose(p, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1945</span>        assert_allclose(direction, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1946</span> </div>
<div class="line"><span class="lineno"> 1947</span>    <span class="comment"># now choose bounds such that unbounded vs bounded gives different results</span></div>
<div class="line"><span class="lineno"> 1948</span>    lower_bound = np.array([-.3]*3 + [-1])</div>
<div class="line"><span class="lineno"> 1949</span>    upper_bound = np.array([.45]*3 + [.9])</div>
<div class="line"><span class="lineno"> 1950</span> </div>
<div class="line"><span class="lineno"> 1951</span>    all_tests = (</div>
<div class="line"><span class="lineno"> 1952</span>        (np.array([1., 0, 0, 0]), -.3),</div>
<div class="line"><span class="lineno"> 1953</span>        (np.array([0., 1, 0, 0]), .45),</div>
<div class="line"><span class="lineno"> 1954</span>        (np.array([0., 0, 1, 0]), .45),</div>
<div class="line"><span class="lineno"> 1955</span>        (np.array([0., 0, 0, 1]), -.4),</div>
<div class="line"><span class="lineno"> 1956</span>        (np.array([-1., 0, 1, 0]), .3),</div>
<div class="line"><span class="lineno"> 1957</span>        (np.array([0., 0, 1, 1]), .45),</div>
<div class="line"><span class="lineno"> 1958</span>        (np.array([2., 0, -1, 1]), -.15),</div>
<div class="line"><span class="lineno"> 1959</span>    )</div>
<div class="line"><span class="lineno"> 1960</span> </div>
<div class="line"><span class="lineno"> 1961</span>    <span class="keywordflow">for</span> xi, l <span class="keywordflow">in</span> all_tests:</div>
<div class="line"><span class="lineno"> 1962</span>        f, p, direction = linesearch_powell(func, p0, xi, tol=1e-5,</div>
<div class="line"><span class="lineno"> 1963</span>                                            lower_bound=lower_bound,</div>
<div class="line"><span class="lineno"> 1964</span>                                            upper_bound=upper_bound,</div>
<div class="line"><span class="lineno"> 1965</span>                                            fval=fval)</div>
<div class="line"><span class="lineno"> 1966</span>        assert_allclose(f, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(l * xi), atol=1e-6)</div>
<div class="line"><span class="lineno"> 1967</span>        assert_allclose(p, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1968</span>        assert_allclose(direction, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1969</span> </div>
<div class="line"><span class="lineno"> 1970</span>    <span class="comment"># now choose as above but start outside the bounds</span></div>
<div class="line"><span class="lineno"> 1971</span>    p0 = np.array([-1., 0, 0, 2])</div>
<div class="line"><span class="lineno"> 1972</span>    fval = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p0)</div>
<div class="line"><span class="lineno"> 1973</span> </div>
<div class="line"><span class="lineno"> 1974</span>    all_tests = (</div>
<div class="line"><span class="lineno"> 1975</span>        (np.array([1., 0, 0, 0]), .7),</div>
<div class="line"><span class="lineno"> 1976</span>        (np.array([0., 1, 0, 0]), .45),</div>
<div class="line"><span class="lineno"> 1977</span>        (np.array([0., 0, 1, 0]), .45),</div>
<div class="line"><span class="lineno"> 1978</span>        (np.array([0., 0, 0, 1]), -2.4),</div>
<div class="line"><span class="lineno"> 1979</span>    )</div>
<div class="line"><span class="lineno"> 1980</span> </div>
<div class="line"><span class="lineno"> 1981</span>    <span class="keywordflow">for</span> xi, l <span class="keywordflow">in</span> all_tests:</div>
<div class="line"><span class="lineno"> 1982</span>        f, p, direction = linesearch_powell(func, p0, xi, tol=1e-5,</div>
<div class="line"><span class="lineno"> 1983</span>                                            lower_bound=lower_bound,</div>
<div class="line"><span class="lineno"> 1984</span>                                            upper_bound=upper_bound,</div>
<div class="line"><span class="lineno"> 1985</span>                                            fval=fval)</div>
<div class="line"><span class="lineno"> 1986</span>        assert_allclose(f, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p0 + l * xi), atol=1e-6)</div>
<div class="line"><span class="lineno"> 1987</span>        assert_allclose(p, p0 + l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1988</span>        assert_allclose(direction, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 1989</span> </div>
<div class="line"><span class="lineno"> 1990</span>    <span class="comment"># now mix in inf</span></div>
<div class="line"><span class="lineno"> 1991</span>    p0 = np.array([0., 0, 0, 0])</div>
<div class="line"><span class="lineno"> 1992</span>    fval = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p0)</div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span>    <span class="comment"># now choose bounds that mix inf</span></div>
<div class="line"><span class="lineno"> 1995</span>    lower_bound = np.array([-.3, -np.inf, -np.inf, -1])</div>
<div class="line"><span class="lineno"> 1996</span>    upper_bound = np.array([np.inf, .45, np.inf, .9])</div>
<div class="line"><span class="lineno"> 1997</span> </div>
<div class="line"><span class="lineno"> 1998</span>    all_tests = (</div>
<div class="line"><span class="lineno"> 1999</span>        (np.array([1., 0, 0, 0]), -.3),</div>
<div class="line"><span class="lineno"> 2000</span>        (np.array([0., 1, 0, 0]), .45),</div>
<div class="line"><span class="lineno"> 2001</span>        (np.array([0., 0, 1, 0]), 1.5),</div>
<div class="line"><span class="lineno"> 2002</span>        (np.array([0., 0, 0, 1]), -.4),</div>
<div class="line"><span class="lineno"> 2003</span>        (np.array([-1., 0, 1, 0]), .3),</div>
<div class="line"><span class="lineno"> 2004</span>        (np.array([0., 0, 1, 1]), .55),</div>
<div class="line"><span class="lineno"> 2005</span>        (np.array([2., 0, -1, 1]), -.15),</div>
<div class="line"><span class="lineno"> 2006</span>    )</div>
<div class="line"><span class="lineno"> 2007</span> </div>
<div class="line"><span class="lineno"> 2008</span>    <span class="keywordflow">for</span> xi, l <span class="keywordflow">in</span> all_tests:</div>
<div class="line"><span class="lineno"> 2009</span>        f, p, direction = linesearch_powell(func, p0, xi, tol=1e-5,</div>
<div class="line"><span class="lineno"> 2010</span>                                            lower_bound=lower_bound,</div>
<div class="line"><span class="lineno"> 2011</span>                                            upper_bound=upper_bound,</div>
<div class="line"><span class="lineno"> 2012</span>                                            fval=fval)</div>
<div class="line"><span class="lineno"> 2013</span>        assert_allclose(f, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(l * xi), atol=1e-6)</div>
<div class="line"><span class="lineno"> 2014</span>        assert_allclose(p, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 2015</span>        assert_allclose(direction, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 2016</span> </div>
<div class="line"><span class="lineno"> 2017</span>    <span class="comment"># now choose as above but start outside the bounds</span></div>
<div class="line"><span class="lineno"> 2018</span>    p0 = np.array([-1., 0, 0, 2])</div>
<div class="line"><span class="lineno"> 2019</span>    fval = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p0)</div>
<div class="line"><span class="lineno"> 2020</span> </div>
<div class="line"><span class="lineno"> 2021</span>    all_tests = (</div>
<div class="line"><span class="lineno"> 2022</span>        (np.array([1., 0, 0, 0]), .7),</div>
<div class="line"><span class="lineno"> 2023</span>        (np.array([0., 1, 0, 0]), .45),</div>
<div class="line"><span class="lineno"> 2024</span>        (np.array([0., 0, 1, 0]), 1.5),</div>
<div class="line"><span class="lineno"> 2025</span>        (np.array([0., 0, 0, 1]), -2.4),</div>
<div class="line"><span class="lineno"> 2026</span>    )</div>
<div class="line"><span class="lineno"> 2027</span> </div>
<div class="line"><span class="lineno"> 2028</span>    <span class="keywordflow">for</span> xi, l <span class="keywordflow">in</span> all_tests:</div>
<div class="line"><span class="lineno"> 2029</span>        f, p, direction = linesearch_powell(func, p0, xi, tol=1e-5,</div>
<div class="line"><span class="lineno"> 2030</span>                                            lower_bound=lower_bound,</div>
<div class="line"><span class="lineno"> 2031</span>                                            upper_bound=upper_bound,</div>
<div class="line"><span class="lineno"> 2032</span>                                            fval=fval)</div>
<div class="line"><span class="lineno"> 2033</span>        assert_allclose(f, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p0 + l * xi), atol=1e-6)</div>
<div class="line"><span class="lineno"> 2034</span>        assert_allclose(p, p0 + l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 2035</span>        assert_allclose(direction, l * xi, atol=1e-6)</div>
<div class="line"><span class="lineno"> 2036</span> </div>
<div class="line"><span class="lineno"> 2037</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adf3efa5d323302be96fb2f278f333f70" name="adf3efa5d323302be96fb2f278f333f70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf3efa5d323302be96fb2f278f333f70">&#9670;&#160;</a></span>test_maxfev_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_maxfev_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  534</span><span class="keyword">def </span>test_maxfev_test():</div>
<div class="line"><span class="lineno">  535</span>    rng = np.random.default_rng(271707100830272976862395227613146332411)</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>    <span class="keyword">def </span>cost(x):</div>
<div class="line"><span class="lineno">  538</span>        <span class="keywordflow">return</span> rng.random(1) * 1000  <span class="comment"># never converged problem</span></div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <span class="keywordflow">for</span> imaxfev <span class="keywordflow">in</span> [1, 10, 50]:</div>
<div class="line"><span class="lineno">  541</span>        <span class="comment"># &quot;TNC&quot; and &quot;L-BFGS-B&quot; also supports max function evaluation, but</span></div>
<div class="line"><span class="lineno">  542</span>        <span class="comment"># these may violate the limit because of evaluating gradients</span></div>
<div class="line"><span class="lineno">  543</span>        <span class="comment"># by numerical differentiation. See the discussion in PR #14805.</span></div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;Powell&#39;</span>, <span class="stringliteral">&#39;Nelder-Mead&#39;</span>]:</div>
<div class="line"><span class="lineno">  545</span>            result = optimize.minimize(cost, rng.random(10),</div>
<div class="line"><span class="lineno">  546</span>                                       method=method,</div>
<div class="line"><span class="lineno">  547</span>                                       options={<span class="stringliteral">&#39;maxfev&#39;</span>: imaxfev})</div>
<div class="line"><span class="lineno">  548</span>            <span class="keyword">assert</span> result[<span class="stringliteral">&quot;nfev&quot;</span>] == imaxfev</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae099b3064f7fba6520ac622bd5c967af" name="ae099b3064f7fba6520ac622bd5c967af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae099b3064f7fba6520ac622bd5c967af">&#9670;&#160;</a></span>test_memoize_jac_function_before_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_memoize_jac_function_before_gradient </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function_with_gradient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2371</span><span class="keyword">def </span>test_memoize_jac_function_before_gradient(function_with_gradient):</div>
<div class="line"><span class="lineno"> 2372</span>    memoized_function = MemoizeJac(function_with_gradient)</div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span>    x0 = np.array([1.0, 2.0])</div>
<div class="line"><span class="lineno"> 2375</span>    assert_allclose(memoized_function(x0), 5.0)</div>
<div class="line"><span class="lineno"> 2376</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 1</div>
<div class="line"><span class="lineno"> 2377</span> </div>
<div class="line"><span class="lineno"> 2378</span>    assert_allclose(memoized_function.derivative(x0), 2 * x0)</div>
<div class="line"><span class="lineno"> 2379</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 1, \</div>
<div class="line"><span class="lineno"> 2380</span>        <span class="stringliteral">&quot;function is not recomputed &quot;</span> \</div>
<div class="line"><span class="lineno"> 2381</span>        <span class="stringliteral">&quot;if gradient is requested after function value&quot;</span></div>
<div class="line"><span class="lineno"> 2382</span> </div>
<div class="line"><span class="lineno"> 2383</span>    assert_allclose(</div>
<div class="line"><span class="lineno"> 2384</span>        memoized_function(2 * x0), 20.0,</div>
<div class="line"><span class="lineno"> 2385</span>        err_msg=<span class="stringliteral">&quot;different input triggers new computation&quot;</span>)</div>
<div class="line"><span class="lineno"> 2386</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 2, \</div>
<div class="line"><span class="lineno"> 2387</span>        <span class="stringliteral">&quot;different input triggers new computation&quot;</span></div>
<div class="line"><span class="lineno"> 2388</span> </div>
<div class="line"><span class="lineno"> 2389</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e0786cdffd2e96f9b91fdb32de7de15" name="a0e0786cdffd2e96f9b91fdb32de7de15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e0786cdffd2e96f9b91fdb32de7de15">&#9670;&#160;</a></span>test_memoize_jac_gradient_before_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_memoize_jac_gradient_before_function </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function_with_gradient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2390</span><span class="keyword">def </span>test_memoize_jac_gradient_before_function(function_with_gradient):</div>
<div class="line"><span class="lineno"> 2391</span>    memoized_function = MemoizeJac(function_with_gradient)</div>
<div class="line"><span class="lineno"> 2392</span> </div>
<div class="line"><span class="lineno"> 2393</span>    x0 = np.array([1.0, 2.0])</div>
<div class="line"><span class="lineno"> 2394</span>    assert_allclose(memoized_function.derivative(x0), 2 * x0)</div>
<div class="line"><span class="lineno"> 2395</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 1</div>
<div class="line"><span class="lineno"> 2396</span> </div>
<div class="line"><span class="lineno"> 2397</span>    assert_allclose(memoized_function(x0), 5.0)</div>
<div class="line"><span class="lineno"> 2398</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 1, \</div>
<div class="line"><span class="lineno"> 2399</span>        <span class="stringliteral">&quot;function is not recomputed &quot;</span> \</div>
<div class="line"><span class="lineno"> 2400</span>        <span class="stringliteral">&quot;if function value is requested after gradient&quot;</span></div>
<div class="line"><span class="lineno"> 2401</span> </div>
<div class="line"><span class="lineno"> 2402</span>    assert_allclose(</div>
<div class="line"><span class="lineno"> 2403</span>        memoized_function.derivative(2 * x0), 4 * x0,</div>
<div class="line"><span class="lineno"> 2404</span>        err_msg=<span class="stringliteral">&quot;different input triggers new computation&quot;</span>)</div>
<div class="line"><span class="lineno"> 2405</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 2, \</div>
<div class="line"><span class="lineno"> 2406</span>        <span class="stringliteral">&quot;different input triggers new computation&quot;</span></div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab557ceba04b1f0811859b14925d36bd6" name="ab557ceba04b1f0811859b14925d36bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab557ceba04b1f0811859b14925d36bd6">&#9670;&#160;</a></span>test_memoize_jac_with_bfgs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_memoize_jac_with_bfgs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function_with_gradient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment"> Tests that using MemoizedJac in combination with ScalarFunction
    and BFGS does not lead to repeated function evaluations.
    Tests changes made in response to GH11868.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2409</span><span class="keyword">def </span>test_memoize_jac_with_bfgs(function_with_gradient):</div>
<div class="line"><span class="lineno"> 2410</span>    <span class="stringliteral">&quot;&quot;&quot; Tests that using MemoizedJac in combination with ScalarFunction</span></div>
<div class="line"><span class="lineno"> 2411</span><span class="stringliteral">        and BFGS does not lead to repeated function evaluations.</span></div>
<div class="line"><span class="lineno"> 2412</span><span class="stringliteral">        Tests changes made in response to GH11868.</span></div>
<div class="line"><span class="lineno"> 2413</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2414</span>    memoized_function = MemoizeJac(function_with_gradient)</div>
<div class="line"><span class="lineno"> 2415</span>    jac = memoized_function.derivative</div>
<div class="line"><span class="lineno"> 2416</span>    hess = optimize.BFGS()</div>
<div class="line"><span class="lineno"> 2417</span> </div>
<div class="line"><span class="lineno"> 2418</span>    x0 = np.array([1.0, 0.5])</div>
<div class="line"><span class="lineno"> 2419</span>    scalar_function = ScalarFunction(</div>
<div class="line"><span class="lineno"> 2420</span>        memoized_function, x0, (), jac, hess, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 2421</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 1</div>
<div class="line"><span class="lineno"> 2422</span> </div>
<div class="line"><span class="lineno"> 2423</span>    scalar_function.fun(x0 + 0.1)</div>
<div class="line"><span class="lineno"> 2424</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 2</div>
<div class="line"><span class="lineno"> 2425</span> </div>
<div class="line"><span class="lineno"> 2426</span>    scalar_function.fun(x0 + 0.2)</div>
<div class="line"><span class="lineno"> 2427</span>    <span class="keyword">assert</span> function_with_gradient.number_of_calls == 3</div>
<div class="line"><span class="lineno"> 2428</span> </div>
<div class="line"><span class="lineno"> 2429</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aabd65cd2b64086a99720f3feb6a04328" name="aabd65cd2b64086a99720f3feb6a04328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabd65cd2b64086a99720f3feb6a04328">&#9670;&#160;</a></span>test_minimize_multiple_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_minimize_multiple_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2089</span><span class="keyword">def </span>test_minimize_multiple_constraints():</div>
<div class="line"><span class="lineno"> 2090</span>    <span class="comment"># Regression test for gh-4240.</span></div>
<div class="line"><span class="lineno"> 2091</span>    <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x):</div>
<div class="line"><span class="lineno"> 2092</span>        <span class="keywordflow">return</span> np.array([25 - 0.2 * x[0] - 0.4 * x[1] - 0.33 * x[2]])</div>
<div class="line"><span class="lineno"> 2093</span> </div>
<div class="line"><span class="lineno"> 2094</span>    <span class="keyword">def </span><a class="code hl_function" href="iso_fortran_env_map_8f90.html#a85105fb2eeb2b42472f472a00dfcf818">func1</a>(x):</div>
<div class="line"><span class="lineno"> 2095</span>        <span class="keywordflow">return</span> np.array([x[1]])</div>
<div class="line"><span class="lineno"> 2096</span> </div>
<div class="line"><span class="lineno"> 2097</span>    <span class="keyword">def </span>func2(x):</div>
<div class="line"><span class="lineno"> 2098</span>        <span class="keywordflow">return</span> np.array([x[2]])</div>
<div class="line"><span class="lineno"> 2099</span> </div>
<div class="line"><span class="lineno"> 2100</span>    cons = ({<span class="stringliteral">&#39;type&#39;</span>: <span class="stringliteral">&#39;ineq&#39;</span>, <span class="stringliteral">&#39;fun&#39;</span>: func},</div>
<div class="line"><span class="lineno"> 2101</span>            {<span class="stringliteral">&#39;type&#39;</span>: <span class="stringliteral">&#39;ineq&#39;</span>, <span class="stringliteral">&#39;fun&#39;</span>: func1},</div>
<div class="line"><span class="lineno"> 2102</span>            {<span class="stringliteral">&#39;type&#39;</span>: <span class="stringliteral">&#39;ineq&#39;</span>, <span class="stringliteral">&#39;fun&#39;</span>: func2})</div>
<div class="line"><span class="lineno"> 2103</span> </div>
<div class="line"><span class="lineno"> 2104</span>    f = <span class="keyword">lambda</span> x: -1 * (x[0] + x[1] + x[2])</div>
<div class="line"><span class="lineno"> 2105</span> </div>
<div class="line"><span class="lineno"> 2106</span>    res = optimize.minimize(f, [0, 0, 0], method=<span class="stringliteral">&#39;SLSQP&#39;</span>, constraints=cons)</div>
<div class="line"><span class="lineno"> 2107</span>    assert_allclose(res.x, [125, 0, 0], atol=1e-10)</div>
<div class="line"><span class="lineno"> 2108</span> </div>
<div class="line"><span class="lineno"> 2109</span> </div>
<div class="ttc" id="aiso_fortran_env_map_8f90_html_a85105fb2eeb2b42472f472a00dfcf818"><div class="ttname"><a href="iso_fortran_env_map_8f90.html#a85105fb2eeb2b42472f472a00dfcf818">func1</a></div><div class="ttdeci">subroutine func1(n, x, res)</div><div class="ttdef"><b>Definition</b> isoFortranEnvMap.f90:2</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca7c8ad6ab55604fd2180d288ce3d8d9" name="aca7c8ad6ab55604fd2180d288ce3d8d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca7c8ad6ab55604fd2180d288ce3d8d9">&#9670;&#160;</a></span>test_minimize_with_scalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_minimize_with_scalar </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1483</span><span class="keyword">def </span>test_minimize_with_scalar(method):</div>
<div class="line"><span class="lineno"> 1484</span>    <span class="comment"># checks that minimize works with a scalar being provided to it.</span></div>
<div class="line"><span class="lineno"> 1485</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x):</div>
<div class="line"><span class="lineno"> 1486</span>        <span class="keywordflow">return</span> np.sum(x ** 2)</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>    res = optimize.minimize(f, 17, bounds=[(-100, 100)], method=method)</div>
<div class="line"><span class="lineno"> 1489</span>    <span class="keyword">assert</span> res.success</div>
<div class="line"><span class="lineno"> 1490</span>    assert_allclose(res.x, [0.0], atol=1e-5)</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abb05f9af666ee7eb0bf0d195f80875d2" name="abb05f9af666ee7eb0bf0d195f80875d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb05f9af666ee7eb0bf0d195f80875d2">&#9670;&#160;</a></span>test_neldermead_adaptive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_neldermead_adaptive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  599</span><span class="keyword">def </span>test_neldermead_adaptive():</div>
<div class="line"><span class="lineno">  600</span>    func = <span class="keyword">lambda</span> x: np.sum(x**2)</div>
<div class="line"><span class="lineno">  601</span>    p0 = [0.15746215, 0.48087031, 0.44519198, 0.4223638, 0.61505159,</div>
<div class="line"><span class="lineno">  602</span>          0.32308456, 0.9692297, 0.4471682, 0.77411992, 0.80441652,</div>
<div class="line"><span class="lineno">  603</span>          0.35994957, 0.75487856, 0.99973421, 0.65063887, 0.09626474]</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>    res = optimize.minimize(func, p0, method=<span class="stringliteral">&#39;Nelder-Mead&#39;</span>)</div>
<div class="line"><span class="lineno">  606</span>    assert_equal(res.success, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>    res = optimize.minimize(func, p0, method=<span class="stringliteral">&#39;Nelder-Mead&#39;</span>,</div>
<div class="line"><span class="lineno">  609</span>                            options={<span class="stringliteral">&#39;adaptive&#39;</span>: <span class="keyword">True</span>})</div>
<div class="line"><span class="lineno">  610</span>    assert_equal(res.success, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae403b686f601b3a845d658b58ff6b234" name="ae403b686f601b3a845d658b58ff6b234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae403b686f601b3a845d658b58ff6b234">&#9670;&#160;</a></span>test_neldermead_iteration_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_neldermead_iteration_num </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  583</span><span class="keyword">def </span>test_neldermead_iteration_num():</div>
<div class="line"><span class="lineno">  584</span>    x0 = np.array([1.3, 0.7, 0.8, 1.9, 1.2])</div>
<div class="line"><span class="lineno">  585</span>    res = optimize._minimize._minimize_neldermead(optimize.rosen, x0,</div>
<div class="line"><span class="lineno">  586</span>                                                  xatol=1e-8)</div>
<div class="line"><span class="lineno">  587</span>    <span class="keyword">assert</span> res.nit &lt;= 339</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aedf7ab0bcddbfe2390cd789b41bee335" name="aedf7ab0bcddbfe2390cd789b41bee335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedf7ab0bcddbfe2390cd789b41bee335">&#9670;&#160;</a></span>test_neldermead_xatol_fatol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_neldermead_xatol_fatol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  590</span><span class="keyword">def </span>test_neldermead_xatol_fatol():</div>
<div class="line"><span class="lineno">  591</span>    <span class="comment"># gh4484</span></div>
<div class="line"><span class="lineno">  592</span>    <span class="comment"># test we can call with fatol, xatol specified</span></div>
<div class="line"><span class="lineno">  593</span>    func = <span class="keyword">lambda</span> x: x[0]**2 + x[1]**2</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>    optimize._minimize._minimize_neldermead(func, [1, 1], maxiter=2,</div>
<div class="line"><span class="lineno">  596</span>                                            xatol=1e-3, fatol=1e-3)</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a76e47863cfbce4b15cc26d26c2d0e6d8" name="a76e47863cfbce4b15cc26d26c2d0e6d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76e47863cfbce4b15cc26d26c2d0e6d8">&#9670;&#160;</a></span>test_obj_func_returns_scalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_obj_func_returns_scalar </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  575</span><span class="keyword">def </span>test_obj_func_returns_scalar():</div>
<div class="line"><span class="lineno">  576</span>    match = (<span class="stringliteral">&quot;The user-provided &quot;</span></div>
<div class="line"><span class="lineno">  577</span>             <span class="stringliteral">&quot;objective function must &quot;</span></div>
<div class="line"><span class="lineno">  578</span>             <span class="stringliteral">&quot;return a scalar value.&quot;</span>)</div>
<div class="line"><span class="lineno">  579</span>    <span class="keyword">with</span> assert_raises(ValueError, match=match):</div>
<div class="line"><span class="lineno">  580</span>        optimize.minimize(<span class="keyword">lambda</span> x: x, np.array([1, 1]), method=<span class="stringliteral">&#39;BFGS&#39;</span>)</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad08b2bb8f10178ac52f0b94790ee3c62" name="ad08b2bb8f10178ac52f0b94790ee3c62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad08b2bb8f10178ac52f0b94790ee3c62">&#9670;&#160;</a></span>test_onesided_bounded_powell_stability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_onesided_bounded_powell_stability </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  718</span><span class="keyword">def </span>test_onesided_bounded_powell_stability():</div>
<div class="line"><span class="lineno">  719</span>    <span class="comment"># When the Powell method is bounded on only one side, a</span></div>
<div class="line"><span class="lineno">  720</span>    <span class="comment"># np.tan transform is done in order to convert it into a</span></div>
<div class="line"><span class="lineno">  721</span>    <span class="comment"># completely bounded problem. Here we do some simple tests</span></div>
<div class="line"><span class="lineno">  722</span>    <span class="comment"># of one-sided bounded Powell where the optimal solutions</span></div>
<div class="line"><span class="lineno">  723</span>    <span class="comment"># are large to test the stability of the transformation.</span></div>
<div class="line"><span class="lineno">  724</span>    kwargs = {<span class="stringliteral">&#39;method&#39;</span>: <span class="stringliteral">&#39;Powell&#39;</span>,</div>
<div class="line"><span class="lineno">  725</span>              <span class="stringliteral">&#39;bounds&#39;</span>: [(-np.inf, 1e6)] * 3,</div>
<div class="line"><span class="lineno">  726</span>              <span class="stringliteral">&#39;options&#39;</span>: {<span class="stringliteral">&#39;ftol&#39;</span>: 1e-8, <span class="stringliteral">&#39;xtol&#39;</span>: 1e-8}}</div>
<div class="line"><span class="lineno">  727</span>    x0 = [1, 1, 1]</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="comment"># df/dx is constant.</span></div>
<div class="line"><span class="lineno">  730</span>    f = <span class="keyword">lambda</span> x: -np.sum(x)</div>
<div class="line"><span class="lineno">  731</span>    res = optimize.minimize(f, x0, **kwargs)</div>
<div class="line"><span class="lineno">  732</span>    assert_allclose(res.fun, -3e6, atol=1e-4)</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>    <span class="comment"># df/dx gets smaller and smaller.</span></div>
<div class="line"><span class="lineno">  735</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x):</div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordflow">return</span> -np.abs(np.sum(x)) ** (0.1) * (1 <span class="keywordflow">if</span> np.all(x &gt; 0) <span class="keywordflow">else</span> -1)</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>    res = optimize.minimize(f, x0, **kwargs)</div>
<div class="line"><span class="lineno">  739</span>    assert_allclose(res.fun, -(3e6) ** (0.1))</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>    <span class="comment"># df/dx gets larger and larger.</span></div>
<div class="line"><span class="lineno">  742</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x):</div>
<div class="line"><span class="lineno">  743</span>        <span class="keywordflow">return</span> -np.abs(np.sum(x)) ** 10 * (1 <span class="keywordflow">if</span> np.all(x &gt; 0) <span class="keywordflow">else</span> -1)</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    res = optimize.minimize(f, x0, **kwargs)</div>
<div class="line"><span class="lineno">  746</span>    assert_allclose(res.fun, -(3e6) ** 10, rtol=1e-7)</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>    <span class="comment"># df/dx gets larger for some of the variables and smaller for others.</span></div>
<div class="line"><span class="lineno">  749</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x):</div>
<div class="line"><span class="lineno">  750</span>        t = -np.abs(np.sum(x[:2])) ** 5 - np.abs(np.sum(x[2:])) ** (0.1)</div>
<div class="line"><span class="lineno">  751</span>        t *= (1 <span class="keywordflow">if</span> np.all(x &gt; 0) <span class="keywordflow">else</span> -1)</div>
<div class="line"><span class="lineno">  752</span>        <span class="keywordflow">return</span> t</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    kwargs[<span class="stringliteral">&#39;bounds&#39;</span>] = [(-np.inf, 1e3)] * 3</div>
<div class="line"><span class="lineno">  755</span>    res = optimize.minimize(f, x0, **kwargs)</div>
<div class="line"><span class="lineno">  756</span>    assert_allclose(res.fun, -(2e3) ** 5 - (1e6) ** (0.1), rtol=1e-7)</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d0e6a927123c63cc9d631d0f4bfbc4a" name="a7d0e6a927123c63cc9d631d0f4bfbc4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d0e6a927123c63cc9d631d0f4bfbc4a">&#9670;&#160;</a></span>test_powell_limits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_powell_limits </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2038</span><span class="keyword">def </span>test_powell_limits():</div>
<div class="line"><span class="lineno"> 2039</span>    <span class="comment"># gh15342 - powell was going outside bounds for some function evaluations.</span></div>
<div class="line"><span class="lineno"> 2040</span>    bounds = optimize.Bounds([0, 0], [0.6, 20])</div>
<div class="line"><span class="lineno"> 2041</span> </div>
<div class="line"><span class="lineno"> 2042</span>    <span class="keyword">def </span>fun(x):</div>
<div class="line"><span class="lineno"> 2043</span>        a, b = x</div>
<div class="line"><span class="lineno"> 2044</span>        <span class="keyword">assert</span> (x &gt;= bounds.lb).all() <span class="keywordflow">and</span> (x &lt;= bounds.ub).all()</div>
<div class="line"><span class="lineno"> 2045</span>        <span class="keywordflow">return</span> a ** 2 + b ** 2</div>
<div class="line"><span class="lineno"> 2046</span> </div>
<div class="line"><span class="lineno"> 2047</span>    optimize.minimize(fun, x0=[0.6, 20], method=<span class="stringliteral">&#39;Powell&#39;</span>, bounds=bounds)</div>
<div class="line"><span class="lineno"> 2048</span> </div>
<div class="line"><span class="lineno"> 2049</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6efbe43d9febe32ba40d28d7adb77458" name="a6efbe43d9febe32ba40d28d7adb77458"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6efbe43d9febe32ba40d28d7adb77458">&#9670;&#160;</a></span>test_result_x_shape_when_len_x_is_one()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_result_x_shape_when_len_x_is_one </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2332</span><span class="keyword">def </span>test_result_x_shape_when_len_x_is_one():</div>
<div class="line"><span class="lineno"> 2333</span>    <span class="keyword">def </span>fun(x):</div>
<div class="line"><span class="lineno"> 2334</span>        <span class="keywordflow">return</span> x * x</div>
<div class="line"><span class="lineno"> 2335</span> </div>
<div class="line"><span class="lineno"> 2336</span>    <span class="keyword">def </span>jac(x):</div>
<div class="line"><span class="lineno"> 2337</span>        <span class="keywordflow">return</span> 2. * x</div>
<div class="line"><span class="lineno"> 2338</span> </div>
<div class="line"><span class="lineno"> 2339</span>    <span class="keyword">def </span>hess(x):</div>
<div class="line"><span class="lineno"> 2340</span>        <span class="keywordflow">return</span> np.array([[2.]])</div>
<div class="line"><span class="lineno"> 2341</span> </div>
<div class="line"><span class="lineno"> 2342</span>    methods = [<span class="stringliteral">&#39;Nelder-Mead&#39;</span>, <span class="stringliteral">&#39;Powell&#39;</span>, <span class="stringliteral">&#39;CG&#39;</span>, <span class="stringliteral">&#39;BFGS&#39;</span>, <span class="stringliteral">&#39;L-BFGS-B&#39;</span>, <span class="stringliteral">&#39;TNC&#39;</span>,</div>
<div class="line"><span class="lineno"> 2343</span>               <span class="stringliteral">&#39;COBYLA&#39;</span>, <span class="stringliteral">&#39;SLSQP&#39;</span>]</div>
<div class="line"><span class="lineno"> 2344</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> methods:</div>
<div class="line"><span class="lineno"> 2345</span>        res = optimize.minimize(fun, np.array([0.1]), method=method)</div>
<div class="line"><span class="lineno"> 2346</span>        <span class="keyword">assert</span> res.x.shape == (1,)</div>
<div class="line"><span class="lineno"> 2347</span> </div>
<div class="line"><span class="lineno"> 2348</span>    <span class="comment"># use jac + hess</span></div>
<div class="line"><span class="lineno"> 2349</span>    methods = [<span class="stringliteral">&#39;trust-constr&#39;</span>, <span class="stringliteral">&#39;dogleg&#39;</span>, <span class="stringliteral">&#39;trust-ncg&#39;</span>, <span class="stringliteral">&#39;trust-exact&#39;</span>,</div>
<div class="line"><span class="lineno"> 2350</span>               <span class="stringliteral">&#39;trust-krylov&#39;</span>, <span class="stringliteral">&#39;Newton-CG&#39;</span>]</div>
<div class="line"><span class="lineno"> 2351</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> methods:</div>
<div class="line"><span class="lineno"> 2352</span>        res = optimize.minimize(fun, np.array([0.1]), method=method, jac=jac,</div>
<div class="line"><span class="lineno"> 2353</span>                                hess=hess)</div>
<div class="line"><span class="lineno"> 2354</span>        <span class="keyword">assert</span> res.x.shape == (1,)</div>
<div class="line"><span class="lineno"> 2355</span> </div>
<div class="line"><span class="lineno"> 2356</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad15ddec1844467dc55d69d4ba6f7a188" name="ad15ddec1844467dc55d69d4ba6f7a188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad15ddec1844467dc55d69d4ba6f7a188">&#9670;&#160;</a></span>test_show_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_show_options </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2662</span><span class="keyword">def </span>test_show_options():</div>
<div class="line"><span class="lineno"> 2663</span>    solver_methods = {</div>
<div class="line"><span class="lineno"> 2664</span>        <span class="stringliteral">&#39;minimize&#39;</span>: MINIMIZE_METHODS,</div>
<div class="line"><span class="lineno"> 2665</span>        <span class="stringliteral">&#39;minimize_scalar&#39;</span>: MINIMIZE_SCALAR_METHODS,</div>
<div class="line"><span class="lineno"> 2666</span>        <span class="stringliteral">&#39;root&#39;</span>: ROOT_METHODS,</div>
<div class="line"><span class="lineno"> 2667</span>        <span class="stringliteral">&#39;root_scalar&#39;</span>: ROOT_SCALAR_METHODS,</div>
<div class="line"><span class="lineno"> 2668</span>        <span class="stringliteral">&#39;linprog&#39;</span>: LINPROG_METHODS,</div>
<div class="line"><span class="lineno"> 2669</span>        <span class="stringliteral">&#39;quadratic_assignment&#39;</span>: QUADRATIC_ASSIGNMENT_METHODS,</div>
<div class="line"><span class="lineno"> 2670</span>    }</div>
<div class="line"><span class="lineno"> 2671</span>    <span class="keywordflow">for</span> solver, methods <span class="keywordflow">in</span> solver_methods.items():</div>
<div class="line"><span class="lineno"> 2672</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> methods:</div>
<div class="line"><span class="lineno"> 2673</span>            <span class="comment"># testing that `show_options` works without error</span></div>
<div class="line"><span class="lineno"> 2674</span>            show_options(solver, method)</div>
<div class="line"><span class="lineno"> 2675</span> </div>
<div class="line"><span class="lineno"> 2676</span>    unknown_solver_method = {</div>
<div class="line"><span class="lineno"> 2677</span>        <span class="stringliteral">&#39;minimize&#39;</span>: <span class="stringliteral">&quot;ekki&quot;</span>,  <span class="comment"># unknown method</span></div>
<div class="line"><span class="lineno"> 2678</span>        <span class="stringliteral">&#39;maximize&#39;</span>: <span class="stringliteral">&quot;cg&quot;</span>,  <span class="comment"># unknown solver</span></div>
<div class="line"><span class="lineno"> 2679</span>        <span class="stringliteral">&#39;maximize_scalar&#39;</span>: <span class="stringliteral">&quot;ekki&quot;</span>,  <span class="comment"># unknown solver and method</span></div>
<div class="line"><span class="lineno"> 2680</span>    }</div>
<div class="line"><span class="lineno"> 2681</span>    <span class="keywordflow">for</span> solver, method <span class="keywordflow">in</span> unknown_solver_method.items():</div>
<div class="line"><span class="lineno"> 2682</span>        <span class="comment"># testing that `show_options` raises ValueError</span></div>
<div class="line"><span class="lineno"> 2683</span>        assert_raises(ValueError, show_options, solver, method)</div>
<div class="line"><span class="lineno"> 2684</span> </div>
<div class="line"><span class="lineno"> 2685</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9d78c512ac78839fbb3d31c0577c41b" name="aa9d78c512ac78839fbb3d31c0577c41b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9d78c512ac78839fbb3d31c0577c41b">&#9670;&#160;</a></span>test_wrap_scalar_function_with_validation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_wrap_scalar_function_with_validation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  551</span><span class="keyword">def </span>test_wrap_scalar_function_with_validation():</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>    <span class="keyword">def </span>func_(x):</div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>    fcalls, func = optimize._optimize.\</div>
<div class="line"><span class="lineno">  557</span>        _wrap_scalar_function_maxfun_validation(func_, np.asarray(1), 5)</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(5):</div>
<div class="line"><span class="lineno">  560</span>        <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(np.asarray(i))</div>
<div class="line"><span class="lineno">  561</span>        <span class="keyword">assert</span> fcalls[0] == i+1</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>    msg = <span class="stringliteral">&quot;Too many function calls&quot;</span></div>
<div class="line"><span class="lineno">  564</span>    <span class="keyword">with</span> assert_raises(optimize._optimize._MaxFuncCallError, match=msg):</div>
<div class="line"><span class="lineno">  565</span>        <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(np.asarray(i))  <span class="comment"># exceeded maximum function call</span></div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>    fcalls, func = optimize._optimize.\</div>
<div class="line"><span class="lineno">  568</span>        _wrap_scalar_function_maxfun_validation(func_, np.asarray(1), 5)</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>    msg = <span class="stringliteral">&quot;The user-provided objective function must return a scalar value.&quot;</span></div>
<div class="line"><span class="lineno">  571</span>    <span class="keyword">with</span> assert_raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  572</span>        <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(np.array([1, 1]))</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adbe6a1009453d8fd954cb1067c2e2b96" name="adbe6a1009453d8fd954cb1067c2e2b96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe6a1009453d8fd954cb1067c2e2b96">&#9670;&#160;</a></span>test_x_overwritten_user_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.test_x_overwritten_user_function </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2694</span><span class="keyword">def </span>test_x_overwritten_user_function():</div>
<div class="line"><span class="lineno"> 2695</span>    <span class="comment"># if the user overwrites the x-array in the user function it&#39;s likely</span></div>
<div class="line"><span class="lineno"> 2696</span>    <span class="comment"># that the minimizer stops working properly.</span></div>
<div class="line"><span class="lineno"> 2697</span>    <span class="comment"># gh13740</span></div>
<div class="line"><span class="lineno"> 2698</span>    <span class="keyword">def </span>fquad(x):</div>
<div class="line"><span class="lineno"> 2699</span>        a = np.arange(np.size(x))</div>
<div class="line"><span class="lineno"> 2700</span>        x -= a</div>
<div class="line"><span class="lineno"> 2701</span>        x *= x</div>
<div class="line"><span class="lineno"> 2702</span>        <span class="keywordflow">return</span> np.sum(x)</div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>    <span class="keyword">def </span>fquad_jac(x):</div>
<div class="line"><span class="lineno"> 2705</span>        a = np.arange(np.size(x))</div>
<div class="line"><span class="lineno"> 2706</span>        x *= 2</div>
<div class="line"><span class="lineno"> 2707</span>        x -= 2 * a</div>
<div class="line"><span class="lineno"> 2708</span>        <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno"> 2709</span> </div>
<div class="line"><span class="lineno"> 2710</span>    fquad_hess = <span class="keyword">lambda</span> x: np.eye(np.size(x)) * 2.0</div>
<div class="line"><span class="lineno"> 2711</span> </div>
<div class="line"><span class="lineno"> 2712</span>    meth_jac = [</div>
<div class="line"><span class="lineno"> 2713</span>        <span class="stringliteral">&#39;newton-cg&#39;</span>, <span class="stringliteral">&#39;dogleg&#39;</span>, <span class="stringliteral">&#39;trust-ncg&#39;</span>, <span class="stringliteral">&#39;trust-exact&#39;</span>,</div>
<div class="line"><span class="lineno"> 2714</span>        <span class="stringliteral">&#39;trust-krylov&#39;</span>, <span class="stringliteral">&#39;trust-constr&#39;</span></div>
<div class="line"><span class="lineno"> 2715</span>    ]</div>
<div class="line"><span class="lineno"> 2716</span>    meth_hess = [</div>
<div class="line"><span class="lineno"> 2717</span>        <span class="stringliteral">&#39;dogleg&#39;</span>, <span class="stringliteral">&#39;trust-ncg&#39;</span>, <span class="stringliteral">&#39;trust-exact&#39;</span>, <span class="stringliteral">&#39;trust-krylov&#39;</span>, <span class="stringliteral">&#39;trust-constr&#39;</span></div>
<div class="line"><span class="lineno"> 2718</span>    ]</div>
<div class="line"><span class="lineno"> 2719</span> </div>
<div class="line"><span class="lineno"> 2720</span>    x0 = np.ones(5) * 1.5</div>
<div class="line"><span class="lineno"> 2721</span> </div>
<div class="line"><span class="lineno"> 2722</span>    <span class="keywordflow">for</span> meth <span class="keywordflow">in</span> MINIMIZE_METHODS:</div>
<div class="line"><span class="lineno"> 2723</span>        jac = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2724</span>        hess = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2725</span>        <span class="keywordflow">if</span> meth <span class="keywordflow">in</span> meth_jac:</div>
<div class="line"><span class="lineno"> 2726</span>            jac = fquad_jac</div>
<div class="line"><span class="lineno"> 2727</span>        <span class="keywordflow">if</span> meth <span class="keywordflow">in</span> meth_hess:</div>
<div class="line"><span class="lineno"> 2728</span>            hess = fquad_hess</div>
<div class="line"><span class="lineno"> 2729</span>        res = optimize.minimize(fquad, x0, method=meth, jac=jac, hess=hess)</div>
<div class="line"><span class="lineno"> 2730</span>        assert_allclose(res.x, np.arange(np.size(x0)), atol=2e-4)</div>
<div class="line"><span class="lineno"> 2731</span> </div>
<div class="line"><span class="lineno"> 2732</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3bd8a943280e172b38d5327ffc96af12" name="a3bd8a943280e172b38d5327ffc96af12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bd8a943280e172b38d5327ffc96af12">&#9670;&#160;</a></span>eb_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_optimize.eb_data = <a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__optimize.html#af030db106844e022c198a815e9b894ec">setup_test_equal_bounds</a>()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeee8e157c1e5422ce8dea7a123041135" name="aeee8e157c1e5422ce8dea7a123041135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeee8e157c1e5422ce8dea7a123041135">&#9670;&#160;</a></span>himmelblau_min</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float scipy.optimize.tests.test_optimize.himmelblau_min = 0.0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a215723b89ff7d8b789690f71188313bc" name="a215723b89ff7d8b789690f71188313bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a215723b89ff7d8b789690f71188313bc">&#9670;&#160;</a></span>himmelblau_x0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.optimize.tests.test_optimize.himmelblau_x0 = [-0.27, -0.9]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c01899302856eae1ef9ad4e6950cd10" name="a7c01899302856eae1ef9ad4e6950cd10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c01899302856eae1ef9ad4e6950cd10">&#9670;&#160;</a></span>himmelblau_xopt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.optimize.tests.test_optimize.himmelblau_xopt = [3, 2]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
