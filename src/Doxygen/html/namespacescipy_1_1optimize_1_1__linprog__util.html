<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._linprog_util Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html">_linprog_util</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._linprog_util Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a895f9d1b2240fb0555cf851caa1153dc" id="r_a895f9d1b2240fb0555cf851caa1153dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a895f9d1b2240fb0555cf851caa1153dc">_check_sparse_inputs</a> (options, meth, A_ub, A_eq)</td></tr>
<tr class="separator:a895f9d1b2240fb0555cf851caa1153dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10eb88e6534414fe4f7d34a49e1f91c7" id="r_a10eb88e6534414fe4f7d34a49e1f91c7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a10eb88e6534414fe4f7d34a49e1f91c7">_format_A_constraints</a> (A, n_x, sparse_lhs=False)</td></tr>
<tr class="separator:a10eb88e6534414fe4f7d34a49e1f91c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ead4fa230618132574536a85fe00fd" id="r_ae1ead4fa230618132574536a85fe00fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#ae1ead4fa230618132574536a85fe00fd">_format_b_constraints</a> (b)</td></tr>
<tr class="separator:ae1ead4fa230618132574536a85fe00fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6439e50c2bc9939f1e51de0d941ec36" id="r_ac6439e50c2bc9939f1e51de0d941ec36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#ac6439e50c2bc9939f1e51de0d941ec36">_clean_inputs</a> (lp)</td></tr>
<tr class="separator:ac6439e50c2bc9939f1e51de0d941ec36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34319685367e29a2c1c8327d86e79964" id="r_a34319685367e29a2c1c8327d86e79964"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a34319685367e29a2c1c8327d86e79964">_presolve</a> (lp, rr, rr_method, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-9)</td></tr>
<tr class="separator:a34319685367e29a2c1c8327d86e79964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f945fa0aa12349fde56d7a1f25d13e5" id="r_a9f945fa0aa12349fde56d7a1f25d13e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a9f945fa0aa12349fde56d7a1f25d13e5">_parse_linprog</a> (lp, options, meth)</td></tr>
<tr class="separator:a9f945fa0aa12349fde56d7a1f25d13e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e4f11973243bfc39a853898c6f2900a" id="r_a2e4f11973243bfc39a853898c6f2900a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a2e4f11973243bfc39a853898c6f2900a">_get_Abc</a> (lp, c0)</td></tr>
<tr class="separator:a2e4f11973243bfc39a853898c6f2900a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55bc22e9bb6c5b9dd4c62a0a7dc5cedb" id="r_a55bc22e9bb6c5b9dd4c62a0a7dc5cedb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a55bc22e9bb6c5b9dd4c62a0a7dc5cedb">_round_to_power_of_two</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>)</td></tr>
<tr class="separator:a55bc22e9bb6c5b9dd4c62a0a7dc5cedb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcb4eeb0e277c0fb3938bc43eb48ce7c" id="r_adcb4eeb0e277c0fb3938bc43eb48ce7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#adcb4eeb0e277c0fb3938bc43eb48ce7c">_autoscale</a> (A, b, c, x0)</td></tr>
<tr class="separator:adcb4eeb0e277c0fb3938bc43eb48ce7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6f8c9ceb59b192885e431e6f8149ff3" id="r_ac6f8c9ceb59b192885e431e6f8149ff3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#ac6f8c9ceb59b192885e431e6f8149ff3">_unscale</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, C, b_scale)</td></tr>
<tr class="separator:ac6f8c9ceb59b192885e431e6f8149ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a002e810ab33e22362a9d0cc253d76674" id="r_a002e810ab33e22362a9d0cc253d76674"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a002e810ab33e22362a9d0cc253d76674">_display_summary</a> (message, status, fun, iteration)</td></tr>
<tr class="separator:a002e810ab33e22362a9d0cc253d76674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af918b96db6f51f4487c5db1b75976053" id="r_af918b96db6f51f4487c5db1b75976053"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#af918b96db6f51f4487c5db1b75976053">_postsolve</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, postsolve_args, complete=False)</td></tr>
<tr class="separator:af918b96db6f51f4487c5db1b75976053"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ba5d138c44d439803c99588e238dfa8" id="r_a0ba5d138c44d439803c99588e238dfa8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a0ba5d138c44d439803c99588e238dfa8">_check_result</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, fun, status, slack, con, bounds, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>, message)</td></tr>
<tr class="separator:a0ba5d138c44d439803c99588e238dfa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a808d02fa01f0c96f42ef31e290a7f486" id="r_a808d02fa01f0c96f42ef31e290a7f486"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__util.html#a808d02fa01f0c96f42ef31e290a7f486">_LPProblem</a></td></tr>
<tr class="separator:a808d02fa01f0c96f42ef31e290a7f486"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Method agnostic utility functions for linear progamming
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="adcb4eeb0e277c0fb3938bc43eb48ce7c" name="adcb4eeb0e277c0fb3938bc43eb48ce7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcb4eeb0e277c0fb3938bc43eb48ce7c">&#9670;&#160;</a></span>_autoscale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._autoscale </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Scales the problem according to equilibration from [12].
Also normalizes the right hand side vector by its maximum element.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1213</span><span class="keyword">def </span>_autoscale(A, b, c, x0):</div>
<div class="line"><span class="lineno"> 1214</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1215</span><span class="stringliteral">    Scales the problem according to equilibration from [12].</span></div>
<div class="line"><span class="lineno"> 1216</span><span class="stringliteral">    Also normalizes the right hand side vector by its maximum element.</span></div>
<div class="line"><span class="lineno"> 1217</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1218</span>    m, n = A.shape</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>    C = 1</div>
<div class="line"><span class="lineno"> 1221</span>    R = 1</div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span>    <span class="keywordflow">if</span> A.size &gt; 0:</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span>        R = np.max(np.abs(A), axis=1)</div>
<div class="line"><span class="lineno"> 1226</span>        <span class="keywordflow">if</span> sps.issparse(A):</div>
<div class="line"><span class="lineno"> 1227</span>            R = R.toarray().flatten()</div>
<div class="line"><span class="lineno"> 1228</span>        R[R == 0] = 1</div>
<div class="line"><span class="lineno"> 1229</span>        R = 1/_round_to_power_of_two(R)</div>
<div class="line"><span class="lineno"> 1230</span>        A = sps.diags(R)*A <span class="keywordflow">if</span> sps.issparse(A) <span class="keywordflow">else</span> A*R.reshape(m, 1)</div>
<div class="line"><span class="lineno"> 1231</span>        b = b*R</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span>        C = np.max(np.abs(A), axis=0)</div>
<div class="line"><span class="lineno"> 1234</span>        <span class="keywordflow">if</span> sps.issparse(A):</div>
<div class="line"><span class="lineno"> 1235</span>            C = C.toarray().flatten()</div>
<div class="line"><span class="lineno"> 1236</span>        C[C == 0] = 1</div>
<div class="line"><span class="lineno"> 1237</span>        C = 1/_round_to_power_of_two(C)</div>
<div class="line"><span class="lineno"> 1238</span>        A = A*sps.diags(C) <span class="keywordflow">if</span> sps.issparse(A) <span class="keywordflow">else</span> A*C</div>
<div class="line"><span class="lineno"> 1239</span>        c = c*C</div>
<div class="line"><span class="lineno"> 1240</span> </div>
<div class="line"><span class="lineno"> 1241</span>    b_scale = np.max(np.abs(b)) <span class="keywordflow">if</span> b.size &gt; 0 <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno"> 1242</span>    <span class="keywordflow">if</span> b_scale == 0:</div>
<div class="line"><span class="lineno"> 1243</span>        b_scale = 1.</div>
<div class="line"><span class="lineno"> 1244</span>    b = b/b_scale</div>
<div class="line"><span class="lineno"> 1245</span> </div>
<div class="line"><span class="lineno"> 1246</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1247</span>        x0 = x0/b_scale*(1/C)</div>
<div class="line"><span class="lineno"> 1248</span>    <span class="keywordflow">return</span> A, b, c, x0, C, b_scale</div>
<div class="line"><span class="lineno"> 1249</span> </div>
<div class="line"><span class="lineno"> 1250</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ba5d138c44d439803c99588e238dfa8" name="a0ba5d138c44d439803c99588e238dfa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ba5d138c44d439803c99588e238dfa8">&#9670;&#160;</a></span>_check_result()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._check_result </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>slack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Check the validity of the provided solution.

A valid (optimal) solution satisfies all bounds, all slack variables are
negative and all equality constraint residuals are strictly non-zero.
Further, the lower-bounds, upper-bounds, slack and residuals contain
no nan values.

Parameters
----------
x : 1-D array
    Solution vector to original linear programming problem
fun: float
    optimal objective value for original problem
status : int
    An integer representing the exit status of the optimization::

         0 : Optimization terminated successfully
         1 : Iteration limit reached
         2 : Problem appears to be infeasible
         3 : Problem appears to be unbounded
         4 : Serious numerical difficulties encountered

slack : 1-D array
    The (non-negative) slack in the upper bound constraints, that is,
    ``b_ub - A_ub @ x``
con : 1-D array
    The (nominally zero) residuals of the equality constraints, that is,
    ``b - A_eq @ x``
bounds : 2D array
    The bounds on the original variables ``x``
message : str
    A string descriptor of the exit status of the optimization.
tol : float
    Termination tolerance; see [1]_ Section 4.5.

Returns
-------
status : int
    An integer representing the exit status of the optimization::

         0 : Optimization terminated successfully
         1 : Iteration limit reached
         2 : Problem appears to be infeasible
         3 : Problem appears to be unbounded
         4 : Serious numerical difficulties encountered

message : str
    A string descriptor of the exit status of the optimization.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1397</span><span class="keyword">def </span>_check_result(x, fun, status, slack, con, bounds, tol, message):</div>
<div class="line"><span class="lineno"> 1398</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1399</span><span class="stringliteral">    Check the validity of the provided solution.</span></div>
<div class="line"><span class="lineno"> 1400</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1401</span><span class="stringliteral">    A valid (optimal) solution satisfies all bounds, all slack variables are</span></div>
<div class="line"><span class="lineno"> 1402</span><span class="stringliteral">    negative and all equality constraint residuals are strictly non-zero.</span></div>
<div class="line"><span class="lineno"> 1403</span><span class="stringliteral">    Further, the lower-bounds, upper-bounds, slack and residuals contain</span></div>
<div class="line"><span class="lineno"> 1404</span><span class="stringliteral">    no nan values.</span></div>
<div class="line"><span class="lineno"> 1405</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1406</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1407</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1408</span><span class="stringliteral">    x : 1-D array</span></div>
<div class="line"><span class="lineno"> 1409</span><span class="stringliteral">        Solution vector to original linear programming problem</span></div>
<div class="line"><span class="lineno"> 1410</span><span class="stringliteral">    fun: float</span></div>
<div class="line"><span class="lineno"> 1411</span><span class="stringliteral">        optimal objective value for original problem</span></div>
<div class="line"><span class="lineno"> 1412</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno"> 1413</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno"> 1414</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1415</span><span class="stringliteral">             0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno"> 1416</span><span class="stringliteral">             1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno"> 1417</span><span class="stringliteral">             2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno"> 1418</span><span class="stringliteral">             3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno"> 1419</span><span class="stringliteral">             4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno"> 1420</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1421</span><span class="stringliteral">    slack : 1-D array</span></div>
<div class="line"><span class="lineno"> 1422</span><span class="stringliteral">        The (non-negative) slack in the upper bound constraints, that is,</span></div>
<div class="line"><span class="lineno"> 1423</span><span class="stringliteral">        ``b_ub - A_ub @ x``</span></div>
<div class="line"><span class="lineno"> 1424</span><span class="stringliteral">    con : 1-D array</span></div>
<div class="line"><span class="lineno"> 1425</span><span class="stringliteral">        The (nominally zero) residuals of the equality constraints, that is,</span></div>
<div class="line"><span class="lineno"> 1426</span><span class="stringliteral">        ``b - A_eq @ x``</span></div>
<div class="line"><span class="lineno"> 1427</span><span class="stringliteral">    bounds : 2D array</span></div>
<div class="line"><span class="lineno"> 1428</span><span class="stringliteral">        The bounds on the original variables ``x``</span></div>
<div class="line"><span class="lineno"> 1429</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno"> 1430</span><span class="stringliteral">        A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno"> 1431</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno"> 1432</span><span class="stringliteral">        Termination tolerance; see [1]_ Section 4.5.</span></div>
<div class="line"><span class="lineno"> 1433</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1434</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1435</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1436</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno"> 1437</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno"> 1438</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1439</span><span class="stringliteral">             0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno"> 1440</span><span class="stringliteral">             1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno"> 1441</span><span class="stringliteral">             2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno"> 1442</span><span class="stringliteral">             3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno"> 1443</span><span class="stringliteral">             4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno"> 1444</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1445</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno"> 1446</span><span class="stringliteral">        A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno"> 1447</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1448</span>    <span class="comment"># Somewhat arbitrary</span></div>
<div class="line"><span class="lineno"> 1449</span>    tol = np.sqrt(tol) * 10</div>
<div class="line"><span class="lineno"> 1450</span> </div>
<div class="line"><span class="lineno"> 1451</span>    <span class="keywordflow">if</span> x <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1452</span>        <span class="comment"># HiGHS does not provide x if infeasible/unbounded</span></div>
<div class="line"><span class="lineno"> 1453</span>        <span class="keywordflow">if</span> status == 0:  <span class="comment"># Observed with HiGHS Simplex Primal</span></div>
<div class="line"><span class="lineno"> 1454</span>            status = 4</div>
<div class="line"><span class="lineno"> 1455</span>            message = (<span class="stringliteral">&quot;The solver did not provide a solution nor did it &quot;</span></div>
<div class="line"><span class="lineno"> 1456</span>                       <span class="stringliteral">&quot;report a failure. Please submit a bug report.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1457</span>        <span class="keywordflow">return</span> status, message</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>    contains_nans = (</div>
<div class="line"><span class="lineno"> 1460</span>        np.isnan(x).any()</div>
<div class="line"><span class="lineno"> 1461</span>        <span class="keywordflow">or</span> np.isnan(fun)</div>
<div class="line"><span class="lineno"> 1462</span>        <span class="keywordflow">or</span> np.isnan(slack).any()</div>
<div class="line"><span class="lineno"> 1463</span>        <span class="keywordflow">or</span> np.isnan(con).any()</div>
<div class="line"><span class="lineno"> 1464</span>    )</div>
<div class="line"><span class="lineno"> 1465</span> </div>
<div class="line"><span class="lineno"> 1466</span>    <span class="keywordflow">if</span> contains_nans:</div>
<div class="line"><span class="lineno"> 1467</span>        is_feasible = <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1468</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1469</span>        invalid_bounds = (x &lt; bounds[:, 0] - tol).any() <span class="keywordflow">or</span> (x &gt; bounds[:, 1] + tol).any()</div>
<div class="line"><span class="lineno"> 1470</span>        invalid_slack = status != 3 <span class="keywordflow">and</span> (slack &lt; -tol).any()</div>
<div class="line"><span class="lineno"> 1471</span>        invalid_con = status != 3 <span class="keywordflow">and</span> (np.abs(con) &gt; tol).any()</div>
<div class="line"><span class="lineno"> 1472</span>        is_feasible = <span class="keywordflow">not</span> (invalid_bounds <span class="keywordflow">or</span> invalid_slack <span class="keywordflow">or</span> invalid_con)</div>
<div class="line"><span class="lineno"> 1473</span> </div>
<div class="line"><span class="lineno"> 1474</span>    <span class="keywordflow">if</span> status == 0 <span class="keywordflow">and</span> <span class="keywordflow">not</span> is_feasible:</div>
<div class="line"><span class="lineno"> 1475</span>        status = 4</div>
<div class="line"><span class="lineno"> 1476</span>        message = (<span class="stringliteral">&quot;The solution does not satisfy the constraints within the &quot;</span></div>
<div class="line"><span class="lineno"> 1477</span>                   <span class="stringliteral">&quot;required tolerance of &quot;</span> + <span class="stringliteral">&quot;{:.2E}&quot;</span>.format(tol) + <span class="stringliteral">&quot;, yet &quot;</span></div>
<div class="line"><span class="lineno"> 1478</span>                   <span class="stringliteral">&quot;no errors were raised and there is no certificate of &quot;</span></div>
<div class="line"><span class="lineno"> 1479</span>                   <span class="stringliteral">&quot;infeasibility or unboundedness. Check whether &quot;</span></div>
<div class="line"><span class="lineno"> 1480</span>                   <span class="stringliteral">&quot;the slack and constraint residuals are acceptable; &quot;</span></div>
<div class="line"><span class="lineno"> 1481</span>                   <span class="stringliteral">&quot;if not, consider enabling presolve, adjusting the &quot;</span></div>
<div class="line"><span class="lineno"> 1482</span>                   <span class="stringliteral">&quot;tolerance option(s), and/or using a different method. &quot;</span></div>
<div class="line"><span class="lineno"> 1483</span>                   <span class="stringliteral">&quot;Please consider submitting a bug report.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1484</span>    <span class="keywordflow">elif</span> status == 2 <span class="keywordflow">and</span> is_feasible:</div>
<div class="line"><span class="lineno"> 1485</span>        <span class="comment"># Occurs if the simplex method exits after phase one with a very</span></div>
<div class="line"><span class="lineno"> 1486</span>        <span class="comment"># nearly basic feasible solution. Postsolving can make the solution</span></div>
<div class="line"><span class="lineno"> 1487</span>        <span class="comment"># basic, however, this solution is NOT optimal</span></div>
<div class="line"><span class="lineno"> 1488</span>        status = 4</div>
<div class="line"><span class="lineno"> 1489</span>        message = (<span class="stringliteral">&quot;The solution is feasible, but the solver did not report &quot;</span></div>
<div class="line"><span class="lineno"> 1490</span>                   <span class="stringliteral">&quot;that the solution was optimal. Please try a different &quot;</span></div>
<div class="line"><span class="lineno"> 1491</span>                   <span class="stringliteral">&quot;method.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1492</span> </div>
<div class="line"><span class="lineno"> 1493</span>    <span class="keywordflow">return</span> status, message</div>
</div><!-- fragment -->
</div>
</div>
<a id="a895f9d1b2240fb0555cf851caa1153dc" name="a895f9d1b2240fb0555cf851caa1153dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a895f9d1b2240fb0555cf851caa1153dc">&#9670;&#160;</a></span>_check_sparse_inputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._check_sparse_inputs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>meth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A_ub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A_eq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Check the provided ``A_ub`` and ``A_eq`` matrices conform to the specified
optional sparsity variables.

Parameters
----------
A_ub : 2-D array, optional
    2-D array such that ``A_ub @ x`` gives the values of the upper-bound
    inequality constraints at ``x``.
A_eq : 2-D array, optional
    2-D array such that ``A_eq @ x`` gives the values of the equality
    constraints at ``x``.
options : dict
    A dictionary of solver options. All methods accept the following
    generic options:

        maxiter : int
            Maximum number of iterations to perform.
        disp : bool
            Set to True to print convergence messages.

    For method-specific options, see :func:`show_options('linprog')`.
method : str, optional
    The algorithm used to solve the standard form problem.

Returns
-------
A_ub : 2-D array, optional
    2-D array such that ``A_ub @ x`` gives the values of the upper-bound
    inequality constraints at ``x``.
A_eq : 2-D array, optional
    2-D array such that ``A_eq @ x`` gives the values of the equality
    constraints at ``x``.
options : dict
    A dictionary of solver options. All methods accept the following
    generic options:

        maxiter : int
            Maximum number of iterations to perform.
        disp : bool
            Set to True to print convergence messages.

    For method-specific options, see :func:`show_options('linprog')`.
</pre> <div class="fragment"><div class="line"><span class="lineno">   69</span><span class="keyword">def </span>_check_sparse_inputs(options, meth, A_ub, A_eq):</div>
<div class="line"><span class="lineno">   70</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    Check the provided ``A_ub`` and ``A_eq`` matrices conform to the specified</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    optional sparsity variables.</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">    A_ub : 2-D array, optional</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">        2-D array such that ``A_ub @ x`` gives the values of the upper-bound</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        inequality constraints at ``x``.</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    A_eq : 2-D array, optional</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">        2-D array such that ``A_eq @ x`` gives the values of the equality</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">        constraints at ``x``.</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    options : dict</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">        A dictionary of solver options. All methods accept the following</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">        generic options:</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">            maxiter : int</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">                Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">            disp : bool</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">                Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">        For method-specific options, see :func:`show_options(&#39;linprog&#39;)`.</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    method : str, optional</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">        The algorithm used to solve the standard form problem.</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    A_ub : 2-D array, optional</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">        2-D array such that ``A_ub @ x`` gives the values of the upper-bound</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">        inequality constraints at ``x``.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">    A_eq : 2-D array, optional</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">        2-D array such that ``A_eq @ x`` gives the values of the equality</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">        constraints at ``x``.</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    options : dict</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">        A dictionary of solver options. All methods accept the following</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">        generic options:</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">            maxiter : int</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">                Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">            disp : bool</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">                Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">        For method-specific options, see :func:`show_options(&#39;linprog&#39;)`.</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  114</span>    <span class="comment"># This is an undocumented option for unit testing sparse presolve</span></div>
<div class="line"><span class="lineno">  115</span>    _sparse_presolve = options.pop(<span class="stringliteral">&#39;_sparse_presolve&#39;</span>, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">if</span> _sparse_presolve <span class="keywordflow">and</span> A_eq <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  117</span>        A_eq = sps.coo_matrix(A_eq)</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">if</span> _sparse_presolve <span class="keywordflow">and</span> A_ub <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  119</span>        A_ub = sps.coo_matrix(A_ub)</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    sparse_constraint = sps.issparse(A_eq) <span class="keywordflow">or</span> sps.issparse(A_ub)</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    preferred_methods = {<span class="stringliteral">&quot;highs&quot;</span>, <span class="stringliteral">&quot;highs-ds&quot;</span>, <span class="stringliteral">&quot;highs-ipm&quot;</span>}</div>
<div class="line"><span class="lineno">  124</span>    dense_methods = {<span class="stringliteral">&quot;simplex&quot;</span>, <span class="stringliteral">&quot;revised simplex&quot;</span>}</div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">if</span> meth <span class="keywordflow">in</span> dense_methods <span class="keywordflow">and</span> sparse_constraint:</div>
<div class="line"><span class="lineno">  126</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Method &#39;{meth}&#39; does not support sparse &quot;</span></div>
<div class="line"><span class="lineno">  127</span>                         <span class="stringliteral">&quot;constraint matrices. Please consider using one of &quot;</span></div>
<div class="line"><span class="lineno">  128</span>                         f<span class="stringliteral">&quot;{preferred_methods}.&quot;</span>)</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    sparse = options.get(<span class="stringliteral">&#39;sparse&#39;</span>, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> sparse <span class="keywordflow">and</span> sparse_constraint <span class="keywordflow">and</span> meth == <span class="stringliteral">&#39;interior-point&#39;</span>:</div>
<div class="line"><span class="lineno">  132</span>        options[<span class="stringliteral">&#39;sparse&#39;</span>] = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  133</span>        warn(<span class="stringliteral">&quot;Sparse constraint matrix detected; setting &#39;sparse&#39;:True.&quot;</span>,</div>
<div class="line"><span class="lineno">  134</span>             OptimizeWarning, stacklevel=4)</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">return</span> options, A_ub, A_eq</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6439e50c2bc9939f1e51de0d941ec36" name="ac6439e50c2bc9939f1e51de0d941ec36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6439e50c2bc9939f1e51de0d941ec36">&#9670;&#160;</a></span>_clean_inputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._clean_inputs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given user inputs for a linear programming problem, return the
objective vector, upper bound constraints, equality constraints,
and simple bounds in a preferred format.

Parameters
----------
lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:

    c : 1D array
        The coefficients of the linear objective function to be minimized.
    A_ub : 2D array, optional
        The inequality constraint matrix. Each row of ``A_ub`` specifies the
        coefficients of a linear inequality constraint on ``x``.
    b_ub : 1D array, optional
        The inequality constraint vector. Each element represents an
        upper bound on the corresponding value of ``A_ub @ x``.
    A_eq : 2D array, optional
        The equality constraint matrix. Each row of ``A_eq`` specifies the
        coefficients of a linear equality constraint on ``x``.
    b_eq : 1D array, optional
        The equality constraint vector. Each element of ``A_eq @ x`` must equal
        the corresponding element of ``b_eq``.
    bounds : various valid formats, optional
        The bounds of ``x``, as ``min`` and ``max`` pairs.
        If bounds are specified for all N variables separately, valid formats are:
        * a 2D array (2 x N or N x 2);
        * a sequence of N sequences, each with 2 values.
        If all variables have the same bounds, a single pair of values can
        be specified. Valid formats are:
        * a sequence with 2 scalar values;
        * a sequence with a single element containing 2 scalar values.
        If all variables have a lower bound of 0 and no upper bound, the bounds
        parameter can be omitted (or given as None).
    x0 : 1D array, optional
        Guess values of the decision variables, which will be refined by
        the optimization algorithm. This argument is currently used only by the
        'revised simplex' method, and can only be used if `x0` represents a
        basic feasible solution.

Returns
-------
lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:

    c : 1D array
        The coefficients of the linear objective function to be minimized.
    A_ub : 2D array, optional
        The inequality constraint matrix. Each row of ``A_ub`` specifies the
        coefficients of a linear inequality constraint on ``x``.
    b_ub : 1D array, optional
        The inequality constraint vector. Each element represents an
        upper bound on the corresponding value of ``A_ub @ x``.
    A_eq : 2D array, optional
        The equality constraint matrix. Each row of ``A_eq`` specifies the
        coefficients of a linear equality constraint on ``x``.
    b_eq : 1D array, optional
        The equality constraint vector. Each element of ``A_eq @ x`` must equal
        the corresponding element of ``b_eq``.
    bounds : 2D array
        The bounds of ``x``, as ``min`` and ``max`` pairs, one for each of the N
        elements of ``x``. The N x 2 array contains lower bounds in the first
        column and upper bounds in the 2nd. Unbounded variables have lower
        bound -np.inf and/or upper bound np.inf.
    x0 : 1D array, optional
        Guess values of the decision variables, which will be refined by
        the optimization algorithm. This argument is currently used only by the
        'revised simplex' method, and can only be used if `x0` represents a
        basic feasible solution.</pre> <div class="fragment"><div class="line"><span class="lineno">  191</span><span class="keyword">def </span>_clean_inputs(lp):</div>
<div class="line"><span class="lineno">  192</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    Given user inputs for a linear programming problem, return the</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    objective vector, upper bound constraints, equality constraints,</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    and simple bounds in a preferred format.</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">        c : 1D array</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">            The coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">        A_ub : 2D array, optional</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">            The inequality constraint matrix. Each row of ``A_ub`` specifies the</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">            coefficients of a linear inequality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">        b_ub : 1D array, optional</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">            The inequality constraint vector. Each element represents an</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">            upper bound on the corresponding value of ``A_ub @ x``.</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">        A_eq : 2D array, optional</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">            The equality constraint matrix. Each row of ``A_eq`` specifies the</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">            coefficients of a linear equality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">        b_eq : 1D array, optional</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">            The equality constraint vector. Each element of ``A_eq @ x`` must equal</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">            the corresponding element of ``b_eq``.</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">        bounds : various valid formats, optional</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">            The bounds of ``x``, as ``min`` and ``max`` pairs.</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">            If bounds are specified for all N variables separately, valid formats are:</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">            * a 2D array (2 x N or N x 2);</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">            * a sequence of N sequences, each with 2 values.</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">            If all variables have the same bounds, a single pair of values can</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">            be specified. Valid formats are:</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">            * a sequence with 2 scalar values;</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">            * a sequence with a single element containing 2 scalar values.</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">            If all variables have a lower bound of 0 and no upper bound, the bounds</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">            parameter can be omitted (or given as None).</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">        x0 : 1D array, optional</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">            Guess values of the decision variables, which will be refined by</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">            the optimization algorithm. This argument is currently used only by the</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">            &#39;revised simplex&#39; method, and can only be used if `x0` represents a</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">            basic feasible solution.</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">    lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">        c : 1D array</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">            The coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">        A_ub : 2D array, optional</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">            The inequality constraint matrix. Each row of ``A_ub`` specifies the</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral">            coefficients of a linear inequality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">        b_ub : 1D array, optional</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">            The inequality constraint vector. Each element represents an</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">            upper bound on the corresponding value of ``A_ub @ x``.</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">        A_eq : 2D array, optional</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">            The equality constraint matrix. Each row of ``A_eq`` specifies the</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">            coefficients of a linear equality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">        b_eq : 1D array, optional</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">            The equality constraint vector. Each element of ``A_eq @ x`` must equal</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">            the corresponding element of ``b_eq``.</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">        bounds : 2D array</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">            The bounds of ``x``, as ``min`` and ``max`` pairs, one for each of the N</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">            elements of ``x``. The N x 2 array contains lower bounds in the first</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">            column and upper bounds in the 2nd. Unbounded variables have lower</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">            bound -np.inf and/or upper bound np.inf.</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">        x0 : 1D array, optional</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">            Guess values of the decision variables, which will be refined by</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">            the optimization algorithm. This argument is currently used only by the</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">            &#39;revised simplex&#39; method, and can only be used if `x0` represents a</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">            basic feasible solution.</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  262</span>    c, A_ub, b_ub, A_eq, b_eq, bounds, x0, integrality = lp</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">if</span> c <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">raise</span> TypeError</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  268</span>        c = np.array(c, dtype=np.float64, copy=<span class="keyword">True</span>).squeeze()</div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  270</span>        <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  271</span>            <span class="stringliteral">&quot;Invalid input for linprog: c must be a 1-D array of numerical &quot;</span></div>
<div class="line"><span class="lineno">  272</span>            <span class="stringliteral">&quot;coefficients&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  274</span>        <span class="comment"># If c is a single value, convert it to a 1-D array.</span></div>
<div class="line"><span class="lineno">  275</span>        <span class="keywordflow">if</span> c.size == 1:</div>
<div class="line"><span class="lineno">  276</span>            c = c.reshape((-1))</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>        n_x = len(c)</div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">if</span> n_x == 0 <span class="keywordflow">or</span> len(c.shape) != 1:</div>
<div class="line"><span class="lineno">  280</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  281</span>                <span class="stringliteral">&quot;Invalid input for linprog: c must be a 1-D array and must &quot;</span></div>
<div class="line"><span class="lineno">  282</span>                <span class="stringliteral">&quot;not have more than one non-singleton dimension&quot;</span>)</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">if</span> not(np.isfinite(c).all()):</div>
<div class="line"><span class="lineno">  284</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  285</span>                <span class="stringliteral">&quot;Invalid input for linprog: c must not contain values &quot;</span></div>
<div class="line"><span class="lineno">  286</span>                <span class="stringliteral">&quot;inf, nan, or None&quot;</span>)</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    sparse_lhs = sps.issparse(A_eq) <span class="keywordflow">or</span> sps.issparse(A_ub)</div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  290</span>        A_ub = _format_A_constraints(A_ub, n_x, sparse_lhs=sparse_lhs)</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  293</span>            <span class="stringliteral">&quot;Invalid input for linprog: A_ub must be a 2-D array &quot;</span></div>
<div class="line"><span class="lineno">  294</span>            <span class="stringliteral">&quot;of numerical values&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  296</span>        n_ub = A_ub.shape[0]</div>
<div class="line"><span class="lineno">  297</span>        <span class="keywordflow">if</span> len(A_ub.shape) != 2 <span class="keywordflow">or</span> A_ub.shape[1] != n_x:</div>
<div class="line"><span class="lineno">  298</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  299</span>                <span class="stringliteral">&quot;Invalid input for linprog: A_ub must have exactly two &quot;</span></div>
<div class="line"><span class="lineno">  300</span>                <span class="stringliteral">&quot;dimensions, and the number of columns in A_ub must be &quot;</span></div>
<div class="line"><span class="lineno">  301</span>                <span class="stringliteral">&quot;equal to the size of c&quot;</span>)</div>
<div class="line"><span class="lineno">  302</span>        <span class="keywordflow">if</span> (sps.issparse(A_ub) <span class="keywordflow">and</span> <span class="keywordflow">not</span> np.isfinite(A_ub.data).all()</div>
<div class="line"><span class="lineno">  303</span>                <span class="keywordflow">or</span> <span class="keywordflow">not</span> sps.issparse(A_ub) <span class="keywordflow">and</span> <span class="keywordflow">not</span> np.isfinite(A_ub).all()):</div>
<div class="line"><span class="lineno">  304</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  305</span>                <span class="stringliteral">&quot;Invalid input for linprog: A_ub must not contain values &quot;</span></div>
<div class="line"><span class="lineno">  306</span>                <span class="stringliteral">&quot;inf, nan, or None&quot;</span>)</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  309</span>        b_ub = _format_b_constraints(b_ub)</div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  312</span>            <span class="stringliteral">&quot;Invalid input for linprog: b_ub must be a 1-D array of &quot;</span></div>
<div class="line"><span class="lineno">  313</span>            <span class="stringliteral">&quot;numerical values, each representing the upper bound of an &quot;</span></div>
<div class="line"><span class="lineno">  314</span>            <span class="stringliteral">&quot;inequality constraint (row) in A_ub&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordflow">if</span> b_ub.shape != (n_ub,):</div>
<div class="line"><span class="lineno">  317</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  318</span>                <span class="stringliteral">&quot;Invalid input for linprog: b_ub must be a 1-D array; b_ub &quot;</span></div>
<div class="line"><span class="lineno">  319</span>                <span class="stringliteral">&quot;must not have more than one non-singleton dimension and &quot;</span></div>
<div class="line"><span class="lineno">  320</span>                <span class="stringliteral">&quot;the number of rows in A_ub must equal the number of values &quot;</span></div>
<div class="line"><span class="lineno">  321</span>                <span class="stringliteral">&quot;in b_ub&quot;</span>)</div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">if</span> not(np.isfinite(b_ub).all()):</div>
<div class="line"><span class="lineno">  323</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  324</span>                <span class="stringliteral">&quot;Invalid input for linprog: b_ub must not contain values &quot;</span></div>
<div class="line"><span class="lineno">  325</span>                <span class="stringliteral">&quot;inf, nan, or None&quot;</span>)</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  328</span>        A_eq = _format_A_constraints(A_eq, n_x, sparse_lhs=sparse_lhs)</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  331</span>            <span class="stringliteral">&quot;Invalid input for linprog: A_eq must be a 2-D array &quot;</span></div>
<div class="line"><span class="lineno">  332</span>            <span class="stringliteral">&quot;of numerical values&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  334</span>        n_eq = A_eq.shape[0]</div>
<div class="line"><span class="lineno">  335</span>        <span class="keywordflow">if</span> len(A_eq.shape) != 2 <span class="keywordflow">or</span> A_eq.shape[1] != n_x:</div>
<div class="line"><span class="lineno">  336</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  337</span>                <span class="stringliteral">&quot;Invalid input for linprog: A_eq must have exactly two &quot;</span></div>
<div class="line"><span class="lineno">  338</span>                <span class="stringliteral">&quot;dimensions, and the number of columns in A_eq must be &quot;</span></div>
<div class="line"><span class="lineno">  339</span>                <span class="stringliteral">&quot;equal to the size of c&quot;</span>)</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">if</span> (sps.issparse(A_eq) <span class="keywordflow">and</span> <span class="keywordflow">not</span> np.isfinite(A_eq.data).all()</div>
<div class="line"><span class="lineno">  342</span>                <span class="keywordflow">or</span> <span class="keywordflow">not</span> sps.issparse(A_eq) <span class="keywordflow">and</span> <span class="keywordflow">not</span> np.isfinite(A_eq).all()):</div>
<div class="line"><span class="lineno">  343</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  344</span>                <span class="stringliteral">&quot;Invalid input for linprog: A_eq must not contain values &quot;</span></div>
<div class="line"><span class="lineno">  345</span>                <span class="stringliteral">&quot;inf, nan, or None&quot;</span>)</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  348</span>        b_eq = _format_b_constraints(b_eq)</div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  350</span>        <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  351</span>            <span class="stringliteral">&quot;Invalid input for linprog: b_eq must be a dense, 1-D array of &quot;</span></div>
<div class="line"><span class="lineno">  352</span>            <span class="stringliteral">&quot;numerical values, each representing the right hand side of an &quot;</span></div>
<div class="line"><span class="lineno">  353</span>            <span class="stringliteral">&quot;equality constraint (row) in A_eq&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">if</span> b_eq.shape != (n_eq,):</div>
<div class="line"><span class="lineno">  356</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  357</span>                <span class="stringliteral">&quot;Invalid input for linprog: b_eq must be a 1-D array; b_eq &quot;</span></div>
<div class="line"><span class="lineno">  358</span>                <span class="stringliteral">&quot;must not have more than one non-singleton dimension and &quot;</span></div>
<div class="line"><span class="lineno">  359</span>                <span class="stringliteral">&quot;the number of rows in A_eq must equal the number of values &quot;</span></div>
<div class="line"><span class="lineno">  360</span>                <span class="stringliteral">&quot;in b_eq&quot;</span>)</div>
<div class="line"><span class="lineno">  361</span>        <span class="keywordflow">if</span> not(np.isfinite(b_eq).all()):</div>
<div class="line"><span class="lineno">  362</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  363</span>                <span class="stringliteral">&quot;Invalid input for linprog: b_eq must not contain values &quot;</span></div>
<div class="line"><span class="lineno">  364</span>                <span class="stringliteral">&quot;inf, nan, or None&quot;</span>)</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <span class="comment"># x0 gives a (optional) starting solution to the solver. If x0 is None,</span></div>
<div class="line"><span class="lineno">  367</span>    <span class="comment"># skip the checks. Initial solution will be generated automatically.</span></div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  370</span>            x0 = np.array(x0, dtype=float, copy=<span class="keyword">True</span>).squeeze()</div>
<div class="line"><span class="lineno">  371</span>        <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  372</span>            <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  373</span>                <span class="stringliteral">&quot;Invalid input for linprog: x0 must be a 1-D array of &quot;</span></div>
<div class="line"><span class="lineno">  374</span>                <span class="stringliteral">&quot;numerical coefficients&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  375</span>        <span class="keywordflow">if</span> x0.ndim == 0:</div>
<div class="line"><span class="lineno">  376</span>            x0 = x0.reshape((-1))</div>
<div class="line"><span class="lineno">  377</span>        <span class="keywordflow">if</span> len(x0) == 0 <span class="keywordflow">or</span> x0.ndim != 1:</div>
<div class="line"><span class="lineno">  378</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  379</span>                <span class="stringliteral">&quot;Invalid input for linprog: x0 should be a 1-D array; it &quot;</span></div>
<div class="line"><span class="lineno">  380</span>                <span class="stringliteral">&quot;must not have more than one non-singleton dimension&quot;</span>)</div>
<div class="line"><span class="lineno">  381</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> x0.size == c.size:</div>
<div class="line"><span class="lineno">  382</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  383</span>                <span class="stringliteral">&quot;Invalid input for linprog: x0 and c should contain the &quot;</span></div>
<div class="line"><span class="lineno">  384</span>                <span class="stringliteral">&quot;same number of elements&quot;</span>)</div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isfinite(x0).all():</div>
<div class="line"><span class="lineno">  386</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  387</span>                <span class="stringliteral">&quot;Invalid input for linprog: x0 must not contain values &quot;</span></div>
<div class="line"><span class="lineno">  388</span>                <span class="stringliteral">&quot;inf, nan, or None&quot;</span>)</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="comment"># Bounds can be one of these formats:</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="comment"># (1) a 2-D array or sequence, with shape N x 2</span></div>
<div class="line"><span class="lineno">  392</span>    <span class="comment"># (2) a 1-D or 2-D sequence or array with 2 scalars</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="comment"># (3) None (or an empty sequence or array)</span></div>
<div class="line"><span class="lineno">  394</span>    <span class="comment"># Unspecified bounds can be represented by None or (-)np.inf.</span></div>
<div class="line"><span class="lineno">  395</span>    <span class="comment"># All formats are converted into a N x 2 np.array with (-)np.inf where</span></div>
<div class="line"><span class="lineno">  396</span>    <span class="comment"># bounds are unspecified.</span></div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    <span class="comment"># Prepare clean bounds array</span></div>
<div class="line"><span class="lineno">  399</span>    bounds_clean = np.zeros((n_x, 2), dtype=float)</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    <span class="comment"># Convert to a numpy array.</span></div>
<div class="line"><span class="lineno">  402</span>    <span class="comment"># np.array(..,dtype=float) raises an error if dimensions are inconsistent</span></div>
<div class="line"><span class="lineno">  403</span>    <span class="comment"># or if there are invalid data types in bounds. Just add a linprog prefix</span></div>
<div class="line"><span class="lineno">  404</span>    <span class="comment"># to the error and re-raise.</span></div>
<div class="line"><span class="lineno">  405</span>    <span class="comment"># Creating at least a 2-D array simplifies the cases to distinguish below.</span></div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">or</span> np.array_equal(bounds, []) <span class="keywordflow">or</span> np.array_equal(bounds, [[]]):</div>
<div class="line"><span class="lineno">  407</span>        bounds = (0, np.inf)</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  409</span>        bounds_conv = np.atleast_2d(np.array(bounds, dtype=float))</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  412</span>            <span class="stringliteral">&quot;Invalid input for linprog: unable to interpret bounds, &quot;</span></div>
<div class="line"><span class="lineno">  413</span>            <span class="stringliteral">&quot;check values and dimensions: &quot;</span> + e.args[0]) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">except</span> TypeError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  416</span>            <span class="stringliteral">&quot;Invalid input for linprog: unable to interpret bounds, &quot;</span></div>
<div class="line"><span class="lineno">  417</span>            <span class="stringliteral">&quot;check values and dimensions: &quot;</span> + e.args[0]) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    <span class="comment"># Check bounds options</span></div>
<div class="line"><span class="lineno">  420</span>    bsh = bounds_conv.shape</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">if</span> len(bsh) &gt; 2:</div>
<div class="line"><span class="lineno">  422</span>        <span class="comment"># Do not try to handle multidimensional bounds input</span></div>
<div class="line"><span class="lineno">  423</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  424</span>            <span class="stringliteral">&quot;Invalid input for linprog: provide a 2-D array for bounds, &quot;</span></div>
<div class="line"><span class="lineno">  425</span>            <span class="stringliteral">&quot;not a {:d}-D array.&quot;</span>.format(len(bsh)))</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">elif</span> np.all(bsh == (n_x, 2)):</div>
<div class="line"><span class="lineno">  427</span>        <span class="comment"># Regular N x 2 array</span></div>
<div class="line"><span class="lineno">  428</span>        bounds_clean = bounds_conv</div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordflow">elif</span> (np.all(bsh == (2, 1)) <span class="keywordflow">or</span> np.all(bsh == (1, 2))):</div>
<div class="line"><span class="lineno">  430</span>        <span class="comment"># 2 values: interpret as overall lower and upper bound</span></div>
<div class="line"><span class="lineno">  431</span>        bounds_flat = bounds_conv.flatten()</div>
<div class="line"><span class="lineno">  432</span>        bounds_clean[:, 0] = bounds_flat[0]</div>
<div class="line"><span class="lineno">  433</span>        bounds_clean[:, 1] = bounds_flat[1]</div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordflow">elif</span> np.all(bsh == (2, n_x)):</div>
<div class="line"><span class="lineno">  435</span>        <span class="comment"># Reject a 2 x N array</span></div>
<div class="line"><span class="lineno">  436</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  437</span>            <span class="stringliteral">&quot;Invalid input for linprog: provide a {:d} x 2 array for bounds, &quot;</span></div>
<div class="line"><span class="lineno">  438</span>            <span class="stringliteral">&quot;not a 2 x {:d} array.&quot;</span>.format(n_x, n_x))</div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  440</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  441</span>            <span class="stringliteral">&quot;Invalid input for linprog: unable to interpret bounds with this &quot;</span></div>
<div class="line"><span class="lineno">  442</span>            <span class="stringliteral">&quot;dimension tuple: {0}.&quot;</span>.format(bsh))</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>    <span class="comment"># The process above creates nan-s where the input specified None</span></div>
<div class="line"><span class="lineno">  445</span>    <span class="comment"># Convert the nan-s in the 1st column to -np.inf and in the 2nd column</span></div>
<div class="line"><span class="lineno">  446</span>    <span class="comment"># to np.inf</span></div>
<div class="line"><span class="lineno">  447</span>    i_none = np.isnan(bounds_clean[:, 0])</div>
<div class="line"><span class="lineno">  448</span>    bounds_clean[i_none, 0] = -np.inf</div>
<div class="line"><span class="lineno">  449</span>    i_none = np.isnan(bounds_clean[:, 1])</div>
<div class="line"><span class="lineno">  450</span>    bounds_clean[i_none, 1] = np.inf</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>    <span class="keywordflow">return</span> _LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds_clean, x0, integrality)</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a002e810ab33e22362a9d0cc253d76674" name="a002e810ab33e22362a9d0cc253d76674"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a002e810ab33e22362a9d0cc253d76674">&#9670;&#160;</a></span>_display_summary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._display_summary </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Print the termination summary of the linear program

Parameters
----------
message : str
        A string descriptor of the exit status of the optimization.
status : int
    An integer representing the exit status of the optimization::

            0 : Optimization terminated successfully
            1 : Iteration limit reached
            2 : Problem appears to be infeasible
            3 : Problem appears to be unbounded
            4 : Serious numerical difficulties encountered

fun : float
    Value of the objective function.
iteration : iteration
    The number of iterations performed.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1266</span><span class="keyword">def </span>_display_summary(message, status, fun, iteration):</div>
<div class="line"><span class="lineno"> 1267</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="stringliteral">    Print the termination summary of the linear program</span></div>
<div class="line"><span class="lineno"> 1269</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1270</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1271</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1272</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno"> 1273</span><span class="stringliteral">            A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno"> 1274</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno"> 1275</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno"> 1276</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1277</span><span class="stringliteral">                0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno"> 1278</span><span class="stringliteral">                1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno"> 1279</span><span class="stringliteral">                2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno"> 1280</span><span class="stringliteral">                3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno"> 1281</span><span class="stringliteral">                4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno"> 1282</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1283</span><span class="stringliteral">    fun : float</span></div>
<div class="line"><span class="lineno"> 1284</span><span class="stringliteral">        Value of the objective function.</span></div>
<div class="line"><span class="lineno"> 1285</span><span class="stringliteral">    iteration : iteration</span></div>
<div class="line"><span class="lineno"> 1286</span><span class="stringliteral">        The number of iterations performed.</span></div>
<div class="line"><span class="lineno"> 1287</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1288</span>    print(message)</div>
<div class="line"><span class="lineno"> 1289</span>    <span class="keywordflow">if</span> status <span class="keywordflow">in</span> (0, 1):</div>
<div class="line"><span class="lineno"> 1290</span>        print(<span class="stringliteral">&quot;         Current function value: {0: &lt;12.6f}&quot;</span>.format(fun))</div>
<div class="line"><span class="lineno"> 1291</span>    print(<span class="stringliteral">&quot;         Iterations: {0:d}&quot;</span>.format(iteration))</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a10eb88e6534414fe4f7d34a49e1f91c7" name="a10eb88e6534414fe4f7d34a49e1f91c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10eb88e6534414fe4f7d34a49e1f91c7">&#9670;&#160;</a></span>_format_A_constraints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._format_A_constraints </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparse_lhs</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Format the left hand side of the constraints to a 2-D array

Parameters
----------
A : 2-D array
    2-D array such that ``A @ x`` gives the values of the upper-bound
    (in)equality constraints at ``x``.
n_x : int
    The number of variables in the linear programming problem.
sparse_lhs : bool
    Whether either of `A_ub` or `A_eq` are sparse. If true return a
    coo_matrix instead of a numpy array.

Returns
-------
np.ndarray or sparse.coo_matrix
    2-D array such that ``A @ x`` gives the values of the upper-bound
    (in)equality constraints at ``x``.</pre> <div class="fragment"><div class="line"><span class="lineno">  138</span><span class="keyword">def </span>_format_A_constraints(A, n_x, sparse_lhs=False):</div>
<div class="line"><span class="lineno">  139</span>    <span class="stringliteral">&quot;&quot;&quot;Format the left hand side of the constraints to a 2-D array</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    A : 2-D array</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        2-D array such that ``A @ x`` gives the values of the upper-bound</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">        (in)equality constraints at ``x``.</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    n_x : int</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">        The number of variables in the linear programming problem.</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    sparse_lhs : bool</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">        Whether either of `A_ub` or `A_eq` are sparse. If true return a</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        coo_matrix instead of a numpy array.</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    np.ndarray or sparse.coo_matrix</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">        2-D array such that ``A @ x`` gives the values of the upper-bound</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">        (in)equality constraints at ``x``.</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">if</span> sparse_lhs:</div>
<div class="line"><span class="lineno">  160</span>        <span class="keywordflow">return</span> sps.coo_matrix(</div>
<div class="line"><span class="lineno">  161</span>            (0, n_x) <span class="keywordflow">if</span> A <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> A, dtype=float, copy=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  162</span>        )</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">elif</span> A <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">return</span> np.zeros((0, n_x), dtype=float)</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  166</span>        <span class="keywordflow">return</span> np.array(A, dtype=float, copy=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1ead4fa230618132574536a85fe00fd" name="ae1ead4fa230618132574536a85fe00fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ead4fa230618132574536a85fe00fd">&#9670;&#160;</a></span>_format_b_constraints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._format_b_constraints </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Format the upper bounds of the constraints to a 1-D array

Parameters
----------
b : 1-D array
    1-D array of values representing the upper-bound of each (in)equality
    constraint (row) in ``A``.

Returns
-------
1-D np.array
    1-D array of values representing the upper-bound of each (in)equality
    constraint (row) in ``A``.</pre> <div class="fragment"><div class="line"><span class="lineno">  169</span><span class="keyword">def </span>_format_b_constraints(b):</div>
<div class="line"><span class="lineno">  170</span>    <span class="stringliteral">&quot;&quot;&quot;Format the upper bounds of the constraints to a 1-D array</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">    b : 1-D array</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">        1-D array of values representing the upper-bound of each (in)equality</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">        constraint (row) in ``A``.</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    1-D np.array</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">        1-D array of values representing the upper-bound of each (in)equality</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">        constraint (row) in ``A``.</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">if</span> b <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  186</span>        <span class="keywordflow">return</span> np.array([], dtype=float)</div>
<div class="line"><span class="lineno">  187</span>    b = np.array(b, dtype=float, copy=<span class="keyword">True</span>).squeeze()</div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">return</span> b <span class="keywordflow">if</span> b.size != 1 <span class="keywordflow">else</span> b.reshape((-1))</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e4f11973243bfc39a853898c6f2900a" name="a2e4f11973243bfc39a853898c6f2900a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e4f11973243bfc39a853898c6f2900a">&#9670;&#160;</a></span>_get_Abc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._get_Abc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given a linear programming problem of the form:

Minimize::

    c @ x

Subject to::

    A_ub @ x &lt;= b_ub
    A_eq @ x == b_eq
     lb &lt;= x &lt;= ub

where ``lb = 0`` and ``ub = None`` unless set in ``bounds``.

Return the problem in standard form:

Minimize::

    c @ x

Subject to::

    A @ x == b
        x &gt;= 0

by adding slack variables and making variable substitutions as necessary.

Parameters
----------
lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:

    c : 1D array
        The coefficients of the linear objective function to be minimized.
    A_ub : 2D array, optional
        The inequality constraint matrix. Each row of ``A_ub`` specifies the
        coefficients of a linear inequality constraint on ``x``.
    b_ub : 1D array, optional
        The inequality constraint vector. Each element represents an
        upper bound on the corresponding value of ``A_ub @ x``.
    A_eq : 2D array, optional
        The equality constraint matrix. Each row of ``A_eq`` specifies the
        coefficients of a linear equality constraint on ``x``.
    b_eq : 1D array, optional
        The equality constraint vector. Each element of ``A_eq @ x`` must equal
        the corresponding element of ``b_eq``.
    bounds : 2D array
        The bounds of ``x``, lower bounds in the 1st column, upper
        bounds in the 2nd column. The bounds are possibly tightened
        by the presolve procedure.
    x0 : 1D array, optional
        Guess values of the decision variables, which will be refined by
        the optimization algorithm. This argument is currently used only by the
        'revised simplex' method, and can only be used if `x0` represents a
        basic feasible solution.

c0 : float
    Constant term in objective function due to fixed (and eliminated)
    variables.

Returns
-------
A : 2-D array
    2-D array such that ``A`` @ ``x``, gives the values of the equality
    constraints at ``x``.
b : 1-D array
    1-D array of values representing the RHS of each equality constraint
    (row) in A (for standard form problem).
c : 1-D array
    Coefficients of the linear objective function to be minimized (for
    standard form problem).
c0 : float
    Constant term in objective function due to fixed (and eliminated)
    variables.
x0 : 1-D array
    Starting values of the independent variables, which will be refined by
    the optimization algorithm

References
----------
.. [9] Bertsimas, Dimitris, and J. Tsitsiklis. "Introduction to linear
       programming." Athena Scientific 1 (1997): 997.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1008</span><span class="keyword">def </span>_get_Abc(lp, c0):</div>
<div class="line"><span class="lineno"> 1009</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1010</span><span class="stringliteral">    Given a linear programming problem of the form:</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1016</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno"> 1017</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1018</span><span class="stringliteral">        A_ub @ x &lt;= b_ub</span></div>
<div class="line"><span class="lineno"> 1019</span><span class="stringliteral">        A_eq @ x == b_eq</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral">         lb &lt;= x &lt;= ub</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral">    where ``lb = 0`` and ``ub = None`` unless set in ``bounds``.</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral">    Return the problem in standard form:</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1026</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1028</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno"> 1029</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1030</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno"> 1031</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1032</span><span class="stringliteral">        A @ x == b</span></div>
<div class="line"><span class="lineno"> 1033</span><span class="stringliteral">            x &gt;= 0</span></div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral">    by adding slack variables and making variable substitutions as necessary.</span></div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1039</span><span class="stringliteral">    lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:</span></div>
<div class="line"><span class="lineno"> 1040</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1041</span><span class="stringliteral">        c : 1D array</span></div>
<div class="line"><span class="lineno"> 1042</span><span class="stringliteral">            The coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno"> 1043</span><span class="stringliteral">        A_ub : 2D array, optional</span></div>
<div class="line"><span class="lineno"> 1044</span><span class="stringliteral">            The inequality constraint matrix. Each row of ``A_ub`` specifies the</span></div>
<div class="line"><span class="lineno"> 1045</span><span class="stringliteral">            coefficients of a linear inequality constraint on ``x``.</span></div>
<div class="line"><span class="lineno"> 1046</span><span class="stringliteral">        b_ub : 1D array, optional</span></div>
<div class="line"><span class="lineno"> 1047</span><span class="stringliteral">            The inequality constraint vector. Each element represents an</span></div>
<div class="line"><span class="lineno"> 1048</span><span class="stringliteral">            upper bound on the corresponding value of ``A_ub @ x``.</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral">        A_eq : 2D array, optional</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral">            The equality constraint matrix. Each row of ``A_eq`` specifies the</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">            coefficients of a linear equality constraint on ``x``.</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">        b_eq : 1D array, optional</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">            The equality constraint vector. Each element of ``A_eq @ x`` must equal</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">            the corresponding element of ``b_eq``.</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral">        bounds : 2D array</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">            The bounds of ``x``, lower bounds in the 1st column, upper</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral">            bounds in the 2nd column. The bounds are possibly tightened</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">            by the presolve procedure.</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral">        x0 : 1D array, optional</span></div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral">            Guess values of the decision variables, which will be refined by</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral">            the optimization algorithm. This argument is currently used only by the</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">            &#39;revised simplex&#39; method, and can only be used if `x0` represents a</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral">            basic feasible solution.</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral">    c0 : float</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="stringliteral">        Constant term in objective function due to fixed (and eliminated)</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="stringliteral">        variables.</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1069</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="stringliteral">    A : 2-D array</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="stringliteral">        2-D array such that ``A`` @ ``x``, gives the values of the equality</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="stringliteral">        constraints at ``x``.</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral">    b : 1-D array</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">        1-D array of values representing the RHS of each equality constraint</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">        (row) in A (for standard form problem).</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral">    c : 1-D array</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">        Coefficients of the linear objective function to be minimized (for</span></div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral">        standard form problem).</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">    c0 : float</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">        Constant term in objective function due to fixed (and eliminated)</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">        variables.</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral">    x0 : 1-D array</span></div>
<div class="line"><span class="lineno"> 1084</span><span class="stringliteral">        Starting values of the independent variables, which will be refined by</span></div>
<div class="line"><span class="lineno"> 1085</span><span class="stringliteral">        the optimization algorithm</span></div>
<div class="line"><span class="lineno"> 1086</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1087</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1088</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1089</span><span class="stringliteral">    .. [9] Bertsimas, Dimitris, and J. Tsitsiklis. &quot;Introduction to linear</span></div>
<div class="line"><span class="lineno"> 1090</span><span class="stringliteral">           programming.&quot; Athena Scientific 1 (1997): 997.</span></div>
<div class="line"><span class="lineno"> 1091</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1092</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1093</span>    c, A_ub, b_ub, A_eq, b_eq, bounds, x0, integrality = lp</div>
<div class="line"><span class="lineno"> 1094</span> </div>
<div class="line"><span class="lineno"> 1095</span>    <span class="keywordflow">if</span> sps.issparse(A_eq):</div>
<div class="line"><span class="lineno"> 1096</span>        sparse = <span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 1097</span>        A_eq = sps.csr_matrix(A_eq)</div>
<div class="line"><span class="lineno"> 1098</span>        A_ub = sps.csr_matrix(A_ub)</div>
<div class="line"><span class="lineno"> 1099</span> </div>
<div class="line"><span class="lineno"> 1100</span>        <span class="keyword">def </span>hstack(blocks):</div>
<div class="line"><span class="lineno"> 1101</span>            <span class="keywordflow">return</span> sps.hstack(blocks, format=<span class="stringliteral">&quot;csr&quot;</span>)</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span>        <span class="keyword">def </span>vstack(blocks):</div>
<div class="line"><span class="lineno"> 1104</span>            <span class="keywordflow">return</span> sps.vstack(blocks, format=<span class="stringliteral">&quot;csr&quot;</span>)</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>        zeros = sps.csr_matrix</div>
<div class="line"><span class="lineno"> 1107</span>        eye = sps.eye</div>
<div class="line"><span class="lineno"> 1108</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1109</span>        sparse = <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1110</span>        hstack = np.hstack</div>
<div class="line"><span class="lineno"> 1111</span>        vstack = np.vstack</div>
<div class="line"><span class="lineno"> 1112</span>        zeros = np.zeros</div>
<div class="line"><span class="lineno"> 1113</span>        eye = np.eye</div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>    <span class="comment"># Variables lbs and ubs (see below) may be changed, which feeds back into</span></div>
<div class="line"><span class="lineno"> 1116</span>    <span class="comment"># bounds, so copy.</span></div>
<div class="line"><span class="lineno"> 1117</span>    bounds = np.array(bounds, copy=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1118</span> </div>
<div class="line"><span class="lineno"> 1119</span>    <span class="comment"># modify problem such that all variables have only non-negativity bounds</span></div>
<div class="line"><span class="lineno"> 1120</span>    lbs = bounds[:, 0]</div>
<div class="line"><span class="lineno"> 1121</span>    ubs = bounds[:, 1]</div>
<div class="line"><span class="lineno"> 1122</span>    m_ub, n_ub = A_ub.shape</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>    lb_none = np.equal(lbs, -np.inf)</div>
<div class="line"><span class="lineno"> 1125</span>    ub_none = np.equal(ubs, np.inf)</div>
<div class="line"><span class="lineno"> 1126</span>    lb_some = np.logical_not(lb_none)</div>
<div class="line"><span class="lineno"> 1127</span>    ub_some = np.logical_not(ub_none)</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment"># unbounded below: substitute xi = -xi&#39; (unbounded above)</span></div>
<div class="line"><span class="lineno"> 1130</span>    <span class="comment"># if -inf &lt;= xi &lt;= ub, then -ub &lt;= -xi &lt;= inf, so swap and invert bounds</span></div>
<div class="line"><span class="lineno"> 1131</span>    l_nolb_someub = np.logical_and(lb_none, ub_some)</div>
<div class="line"><span class="lineno"> 1132</span>    i_nolb = np.nonzero(l_nolb_someub)[0]</div>
<div class="line"><span class="lineno"> 1133</span>    lbs[l_nolb_someub], ubs[l_nolb_someub] = (</div>
<div class="line"><span class="lineno"> 1134</span>        -ubs[l_nolb_someub], -lbs[l_nolb_someub])</div>
<div class="line"><span class="lineno"> 1135</span>    lb_none = np.equal(lbs, -np.inf)</div>
<div class="line"><span class="lineno"> 1136</span>    ub_none = np.equal(ubs, np.inf)</div>
<div class="line"><span class="lineno"> 1137</span>    lb_some = np.logical_not(lb_none)</div>
<div class="line"><span class="lineno"> 1138</span>    ub_some = np.logical_not(ub_none)</div>
<div class="line"><span class="lineno"> 1139</span>    c[i_nolb] *= -1</div>
<div class="line"><span class="lineno"> 1140</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1141</span>        x0[i_nolb] *= -1</div>
<div class="line"><span class="lineno"> 1142</span>    <span class="keywordflow">if</span> len(i_nolb) &gt; 0:</div>
<div class="line"><span class="lineno"> 1143</span>        <span class="keywordflow">if</span> A_ub.shape[0] &gt; 0:  <span class="comment"># sometimes needed for sparse arrays... weird</span></div>
<div class="line"><span class="lineno"> 1144</span>            A_ub[:, i_nolb] *= -1</div>
<div class="line"><span class="lineno"> 1145</span>        <span class="keywordflow">if</span> A_eq.shape[0] &gt; 0:</div>
<div class="line"><span class="lineno"> 1146</span>            A_eq[:, i_nolb] *= -1</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>    <span class="comment"># upper bound: add inequality constraint</span></div>
<div class="line"><span class="lineno"> 1149</span>    i_newub, = ub_some.nonzero()</div>
<div class="line"><span class="lineno"> 1150</span>    ub_newub = ubs[ub_some]</div>
<div class="line"><span class="lineno"> 1151</span>    n_bounds = len(i_newub)</div>
<div class="line"><span class="lineno"> 1152</span>    <span class="keywordflow">if</span> n_bounds &gt; 0:</div>
<div class="line"><span class="lineno"> 1153</span>        shape = (n_bounds, A_ub.shape[1])</div>
<div class="line"><span class="lineno"> 1154</span>        <span class="keywordflow">if</span> sparse:</div>
<div class="line"><span class="lineno"> 1155</span>            idxs = (np.arange(n_bounds), i_newub)</div>
<div class="line"><span class="lineno"> 1156</span>            A_ub = vstack((A_ub, sps.csr_matrix((np.ones(n_bounds), idxs),</div>
<div class="line"><span class="lineno"> 1157</span>                                                shape=shape)))</div>
<div class="line"><span class="lineno"> 1158</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1159</span>            A_ub = vstack((A_ub, np.zeros(shape)))</div>
<div class="line"><span class="lineno"> 1160</span>            A_ub[np.arange(m_ub, A_ub.shape[0]), i_newub] = 1</div>
<div class="line"><span class="lineno"> 1161</span>        b_ub = np.concatenate((b_ub, np.zeros(n_bounds)))</div>
<div class="line"><span class="lineno"> 1162</span>        b_ub[m_ub:] = ub_newub</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>    A1 = vstack((A_ub, A_eq))</div>
<div class="line"><span class="lineno"> 1165</span>    b = np.concatenate((b_ub, b_eq))</div>
<div class="line"><span class="lineno"> 1166</span>    c = np.concatenate((c, np.zeros((A_ub.shape[0],))))</div>
<div class="line"><span class="lineno"> 1167</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1168</span>        x0 = np.concatenate((x0, np.zeros((A_ub.shape[0],))))</div>
<div class="line"><span class="lineno"> 1169</span>    <span class="comment"># unbounded: substitute xi = xi+ + xi-</span></div>
<div class="line"><span class="lineno"> 1170</span>    l_free = np.logical_and(lb_none, ub_none)</div>
<div class="line"><span class="lineno"> 1171</span>    i_free = np.nonzero(l_free)[0]</div>
<div class="line"><span class="lineno"> 1172</span>    n_free = len(i_free)</div>
<div class="line"><span class="lineno"> 1173</span>    c = np.concatenate((c, np.zeros(n_free)))</div>
<div class="line"><span class="lineno"> 1174</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1175</span>        x0 = np.concatenate((x0, np.zeros(n_free)))</div>
<div class="line"><span class="lineno"> 1176</span>    A1 = hstack((A1[:, :n_ub], -A1[:, i_free]))</div>
<div class="line"><span class="lineno"> 1177</span>    c[n_ub:n_ub+n_free] = -c[i_free]</div>
<div class="line"><span class="lineno"> 1178</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1179</span>        i_free_neg = x0[i_free] &lt; 0</div>
<div class="line"><span class="lineno"> 1180</span>        x0[np.arange(n_ub, A1.shape[1])[i_free_neg]] = -x0[i_free[i_free_neg]]</div>
<div class="line"><span class="lineno"> 1181</span>        x0[i_free[i_free_neg]] = 0</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>    <span class="comment"># add slack variables</span></div>
<div class="line"><span class="lineno"> 1184</span>    A2 = vstack([eye(A_ub.shape[0]), zeros((A_eq.shape[0], A_ub.shape[0]))])</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>    A = hstack([A1, A2])</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span>    <span class="comment"># lower bound: substitute xi = xi&#39; + lb</span></div>
<div class="line"><span class="lineno"> 1189</span>    <span class="comment"># now there is a constant term in objective</span></div>
<div class="line"><span class="lineno"> 1190</span>    i_shift = np.nonzero(lb_some)[0]</div>
<div class="line"><span class="lineno"> 1191</span>    lb_shift = lbs[lb_some].astype(float)</div>
<div class="line"><span class="lineno"> 1192</span>    c0 += np.sum(lb_shift * c[i_shift])</div>
<div class="line"><span class="lineno"> 1193</span>    <span class="keywordflow">if</span> sparse:</div>
<div class="line"><span class="lineno"> 1194</span>        b = b.reshape(-1, 1)</div>
<div class="line"><span class="lineno"> 1195</span>        A = A.tocsc()</div>
<div class="line"><span class="lineno"> 1196</span>        b -= (A[:, i_shift] * sps.diags(lb_shift)).sum(axis=1)</div>
<div class="line"><span class="lineno"> 1197</span>        b = b.ravel()</div>
<div class="line"><span class="lineno"> 1198</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1199</span>        b -= (A[:, i_shift] * lb_shift).sum(axis=1)</div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1201</span>        x0[i_shift] -= lb_shift</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span>    <span class="keywordflow">return</span> A, b, c, c0, x0</div>
<div class="line"><span class="lineno"> 1204</span> </div>
<div class="line"><span class="lineno"> 1205</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f945fa0aa12349fde56d7a1f25d13e5" name="a9f945fa0aa12349fde56d7a1f25d13e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f945fa0aa12349fde56d7a1f25d13e5">&#9670;&#160;</a></span>_parse_linprog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._parse_linprog </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>meth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Parse the provided linear programming problem

``_parse_linprog`` employs two main steps ``_check_sparse_inputs`` and
``_clean_inputs``. ``_check_sparse_inputs`` checks for sparsity in the
provided constraints (``A_ub`` and ``A_eq) and if these match the provided
sparsity optional values.

``_clean inputs`` checks of the provided inputs. If no violations are
identified the objective vector, upper bound constraints, equality
constraints, and simple bounds are returned in the expected format.

Parameters
----------
lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:

    c : 1D array
        The coefficients of the linear objective function to be minimized.
    A_ub : 2D array, optional
        The inequality constraint matrix. Each row of ``A_ub`` specifies the
        coefficients of a linear inequality constraint on ``x``.
    b_ub : 1D array, optional
        The inequality constraint vector. Each element represents an
        upper bound on the corresponding value of ``A_ub @ x``.
    A_eq : 2D array, optional
        The equality constraint matrix. Each row of ``A_eq`` specifies the
        coefficients of a linear equality constraint on ``x``.
    b_eq : 1D array, optional
        The equality constraint vector. Each element of ``A_eq @ x`` must equal
        the corresponding element of ``b_eq``.
    bounds : various valid formats, optional
        The bounds of ``x``, as ``min`` and ``max`` pairs.
        If bounds are specified for all N variables separately, valid formats are:
        * a 2D array (2 x N or N x 2);
        * a sequence of N sequences, each with 2 values.
        If all variables have the same bounds, a single pair of values can
        be specified. Valid formats are:
        * a sequence with 2 scalar values;
        * a sequence with a single element containing 2 scalar values.
        If all variables have a lower bound of 0 and no upper bound, the bounds
        parameter can be omitted (or given as None).
    x0 : 1D array, optional
        Guess values of the decision variables, which will be refined by
        the optimization algorithm. This argument is currently used only by the
        'revised simplex' method, and can only be used if `x0` represents a
        basic feasible solution.

options : dict
    A dictionary of solver options. All methods accept the following
    generic options:

        maxiter : int
            Maximum number of iterations to perform.
        disp : bool
            Set to True to print convergence messages.

    For method-specific options, see :func:`show_options('linprog')`.

Returns
-------
lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:

    c : 1D array
        The coefficients of the linear objective function to be minimized.
    A_ub : 2D array, optional
        The inequality constraint matrix. Each row of ``A_ub`` specifies the
        coefficients of a linear inequality constraint on ``x``.
    b_ub : 1D array, optional
        The inequality constraint vector. Each element represents an
        upper bound on the corresponding value of ``A_ub @ x``.
    A_eq : 2D array, optional
        The equality constraint matrix. Each row of ``A_eq`` specifies the
        coefficients of a linear equality constraint on ``x``.
    b_eq : 1D array, optional
        The equality constraint vector. Each element of ``A_eq @ x`` must equal
        the corresponding element of ``b_eq``.
    bounds : 2D array
        The bounds of ``x``, as ``min`` and ``max`` pairs, one for each of the N
        elements of ``x``. The N x 2 array contains lower bounds in the first
        column and upper bounds in the 2nd. Unbounded variables have lower
        bound -np.inf and/or upper bound np.inf.
    x0 : 1D array, optional
        Guess values of the decision variables, which will be refined by
        the optimization algorithm. This argument is currently used only by the
        'revised simplex' method, and can only be used if `x0` represents a
        basic feasible solution.

options : dict, optional
    A dictionary of solver options. All methods accept the following
    generic options:

        maxiter : int
            Maximum number of iterations to perform.
        disp : bool
            Set to True to print convergence messages.

    For method-specific options, see :func:`show_options('linprog')`.</pre> <div class="fragment"><div class="line"><span class="lineno">  897</span><span class="keyword">def </span>_parse_linprog(lp, options, meth):</div>
<div class="line"><span class="lineno">  898</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral">    Parse the provided linear programming problem</span></div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">    ``_parse_linprog`` employs two main steps ``_check_sparse_inputs`` and</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">    ``_clean_inputs``. ``_check_sparse_inputs`` checks for sparsity in the</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral">    provided constraints (``A_ub`` and ``A_eq) and if these match the provided</span></div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">    sparsity optional values.</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">    ``_clean inputs`` checks of the provided inputs. If no violations are</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">    identified the objective vector, upper bound constraints, equality</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">    constraints, and simple bounds are returned in the expected format.</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">    lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">        c : 1D array</span></div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral">            The coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral">        A_ub : 2D array, optional</span></div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">            The inequality constraint matrix. Each row of ``A_ub`` specifies the</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">            coefficients of a linear inequality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">        b_ub : 1D array, optional</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral">            The inequality constraint vector. Each element represents an</span></div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral">            upper bound on the corresponding value of ``A_ub @ x``.</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">        A_eq : 2D array, optional</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral">            The equality constraint matrix. Each row of ``A_eq`` specifies the</span></div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral">            coefficients of a linear equality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral">        b_eq : 1D array, optional</span></div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">            The equality constraint vector. Each element of ``A_eq @ x`` must equal</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">            the corresponding element of ``b_eq``.</span></div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral">        bounds : various valid formats, optional</span></div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral">            The bounds of ``x``, as ``min`` and ``max`` pairs.</span></div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral">            If bounds are specified for all N variables separately, valid formats are:</span></div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral">            * a 2D array (2 x N or N x 2);</span></div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral">            * a sequence of N sequences, each with 2 values.</span></div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral">            If all variables have the same bounds, a single pair of values can</span></div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral">            be specified. Valid formats are:</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral">            * a sequence with 2 scalar values;</span></div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">            * a sequence with a single element containing 2 scalar values.</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">            If all variables have a lower bound of 0 and no upper bound, the bounds</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral">            parameter can be omitted (or given as None).</span></div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">        x0 : 1D array, optional</span></div>
<div class="line"><span class="lineno">  940</span><span class="stringliteral">            Guess values of the decision variables, which will be refined by</span></div>
<div class="line"><span class="lineno">  941</span><span class="stringliteral">            the optimization algorithm. This argument is currently used only by the</span></div>
<div class="line"><span class="lineno">  942</span><span class="stringliteral">            &#39;revised simplex&#39; method, and can only be used if `x0` represents a</span></div>
<div class="line"><span class="lineno">  943</span><span class="stringliteral">            basic feasible solution.</span></div>
<div class="line"><span class="lineno">  944</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  945</span><span class="stringliteral">    options : dict</span></div>
<div class="line"><span class="lineno">  946</span><span class="stringliteral">        A dictionary of solver options. All methods accept the following</span></div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral">        generic options:</span></div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">            maxiter : int</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">                Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">            disp : bool</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">                Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">        For method-specific options, see :func:`show_options(&#39;linprog&#39;)`.</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">    lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">        c : 1D array</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">            The coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">        A_ub : 2D array, optional</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">            The inequality constraint matrix. Each row of ``A_ub`` specifies the</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral">            coefficients of a linear inequality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral">        b_ub : 1D array, optional</span></div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">            The inequality constraint vector. Each element represents an</span></div>
<div class="line"><span class="lineno">  967</span><span class="stringliteral">            upper bound on the corresponding value of ``A_ub @ x``.</span></div>
<div class="line"><span class="lineno">  968</span><span class="stringliteral">        A_eq : 2D array, optional</span></div>
<div class="line"><span class="lineno">  969</span><span class="stringliteral">            The equality constraint matrix. Each row of ``A_eq`` specifies the</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral">            coefficients of a linear equality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral">        b_eq : 1D array, optional</span></div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral">            The equality constraint vector. Each element of ``A_eq @ x`` must equal</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">            the corresponding element of ``b_eq``.</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">        bounds : 2D array</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">            The bounds of ``x``, as ``min`` and ``max`` pairs, one for each of the N</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">            elements of ``x``. The N x 2 array contains lower bounds in the first</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">            column and upper bounds in the 2nd. Unbounded variables have lower</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">            bound -np.inf and/or upper bound np.inf.</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">        x0 : 1D array, optional</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">            Guess values of the decision variables, which will be refined by</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">            the optimization algorithm. This argument is currently used only by the</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">            &#39;revised simplex&#39; method, and can only be used if `x0` represents a</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">            basic feasible solution.</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">    options : dict, optional</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral">        A dictionary of solver options. All methods accept the following</span></div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">        generic options:</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">            maxiter : int</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">                Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral">            disp : bool</span></div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">                Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">        For method-specific options, see :func:`show_options(&#39;linprog&#39;)`.</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  997</span>    <span class="keywordflow">if</span> options <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  998</span>        options = {}</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>    solver_options = {k: v <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> options.items()}</div>
<div class="line"><span class="lineno"> 1001</span>    solver_options, A_ub, A_eq = _check_sparse_inputs(solver_options, meth,</div>
<div class="line"><span class="lineno"> 1002</span>                                                      lp.A_ub, lp.A_eq)</div>
<div class="line"><span class="lineno"> 1003</span>    <span class="comment"># Convert lists to numpy arrays, etc...</span></div>
<div class="line"><span class="lineno"> 1004</span>    lp = _clean_inputs(lp._replace(A_ub=A_ub, A_eq=A_eq))</div>
<div class="line"><span class="lineno"> 1005</span>    <span class="keywordflow">return</span> lp, solver_options</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af918b96db6f51f4487c5db1b75976053" name="af918b96db6f51f4487c5db1b75976053"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af918b96db6f51f4487c5db1b75976053">&#9670;&#160;</a></span>_postsolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._postsolve </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>complete</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given solution x to presolved, standard form linear program x, add
fixed variables back into the problem and undo the variable substitutions
to get solution to original linear program. Also, calculate the objective
function value, slack in original upper bound constraints, and residuals
in original equality constraints.

Parameters
----------
x : 1-D array
    Solution vector to the standard-form problem.
postsolve_args : tuple
    Data needed by _postsolve to convert the solution to the standard-form
    problem into the solution to the original problem, including:

lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:

    c : 1D array
        The coefficients of the linear objective function to be minimized.
    A_ub : 2D array, optional
        The inequality constraint matrix. Each row of ``A_ub`` specifies the
        coefficients of a linear inequality constraint on ``x``.
    b_ub : 1D array, optional
        The inequality constraint vector. Each element represents an
        upper bound on the corresponding value of ``A_ub @ x``.
    A_eq : 2D array, optional
        The equality constraint matrix. Each row of ``A_eq`` specifies the
        coefficients of a linear equality constraint on ``x``.
    b_eq : 1D array, optional
        The equality constraint vector. Each element of ``A_eq @ x`` must equal
        the corresponding element of ``b_eq``.
    bounds : 2D array
        The bounds of ``x``, lower bounds in the 1st column, upper
        bounds in the 2nd column. The bounds are possibly tightened
        by the presolve procedure.
    x0 : 1D array, optional
        Guess values of the decision variables, which will be refined by
        the optimization algorithm. This argument is currently used only by the
        'revised simplex' method, and can only be used if `x0` represents a
        basic feasible solution.

revstack: list of functions
    the functions in the list reverse the operations of _presolve()
    the function signature is x_org = f(x_mod), where x_mod is the result
    of a presolve step and x_org the value at the start of the step
complete : bool
    Whether the solution is was determined in presolve (``True`` if so)

Returns
-------
x : 1-D array
    Solution vector to original linear programming problem
fun: float
    optimal objective value for original problem
slack : 1-D array
    The (non-negative) slack in the upper bound constraints, that is,
    ``b_ub - A_ub @ x``
con : 1-D array
    The (nominally zero) residuals of the equality constraints, that is,
    ``b - A_eq @ x``
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1294</span><span class="keyword">def </span>_postsolve(x, postsolve_args, complete=False):</div>
<div class="line"><span class="lineno"> 1295</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="stringliteral">    Given solution x to presolved, standard form linear program x, add</span></div>
<div class="line"><span class="lineno"> 1297</span><span class="stringliteral">    fixed variables back into the problem and undo the variable substitutions</span></div>
<div class="line"><span class="lineno"> 1298</span><span class="stringliteral">    to get solution to original linear program. Also, calculate the objective</span></div>
<div class="line"><span class="lineno"> 1299</span><span class="stringliteral">    function value, slack in original upper bound constraints, and residuals</span></div>
<div class="line"><span class="lineno"> 1300</span><span class="stringliteral">    in original equality constraints.</span></div>
<div class="line"><span class="lineno"> 1301</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1302</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1303</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1304</span><span class="stringliteral">    x : 1-D array</span></div>
<div class="line"><span class="lineno"> 1305</span><span class="stringliteral">        Solution vector to the standard-form problem.</span></div>
<div class="line"><span class="lineno"> 1306</span><span class="stringliteral">    postsolve_args : tuple</span></div>
<div class="line"><span class="lineno"> 1307</span><span class="stringliteral">        Data needed by _postsolve to convert the solution to the standard-form</span></div>
<div class="line"><span class="lineno"> 1308</span><span class="stringliteral">        problem into the solution to the original problem, including:</span></div>
<div class="line"><span class="lineno"> 1309</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1310</span><span class="stringliteral">    lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:</span></div>
<div class="line"><span class="lineno"> 1311</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1312</span><span class="stringliteral">        c : 1D array</span></div>
<div class="line"><span class="lineno"> 1313</span><span class="stringliteral">            The coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno"> 1314</span><span class="stringliteral">        A_ub : 2D array, optional</span></div>
<div class="line"><span class="lineno"> 1315</span><span class="stringliteral">            The inequality constraint matrix. Each row of ``A_ub`` specifies the</span></div>
<div class="line"><span class="lineno"> 1316</span><span class="stringliteral">            coefficients of a linear inequality constraint on ``x``.</span></div>
<div class="line"><span class="lineno"> 1317</span><span class="stringliteral">        b_ub : 1D array, optional</span></div>
<div class="line"><span class="lineno"> 1318</span><span class="stringliteral">            The inequality constraint vector. Each element represents an</span></div>
<div class="line"><span class="lineno"> 1319</span><span class="stringliteral">            upper bound on the corresponding value of ``A_ub @ x``.</span></div>
<div class="line"><span class="lineno"> 1320</span><span class="stringliteral">        A_eq : 2D array, optional</span></div>
<div class="line"><span class="lineno"> 1321</span><span class="stringliteral">            The equality constraint matrix. Each row of ``A_eq`` specifies the</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="stringliteral">            coefficients of a linear equality constraint on ``x``.</span></div>
<div class="line"><span class="lineno"> 1323</span><span class="stringliteral">        b_eq : 1D array, optional</span></div>
<div class="line"><span class="lineno"> 1324</span><span class="stringliteral">            The equality constraint vector. Each element of ``A_eq @ x`` must equal</span></div>
<div class="line"><span class="lineno"> 1325</span><span class="stringliteral">            the corresponding element of ``b_eq``.</span></div>
<div class="line"><span class="lineno"> 1326</span><span class="stringliteral">        bounds : 2D array</span></div>
<div class="line"><span class="lineno"> 1327</span><span class="stringliteral">            The bounds of ``x``, lower bounds in the 1st column, upper</span></div>
<div class="line"><span class="lineno"> 1328</span><span class="stringliteral">            bounds in the 2nd column. The bounds are possibly tightened</span></div>
<div class="line"><span class="lineno"> 1329</span><span class="stringliteral">            by the presolve procedure.</span></div>
<div class="line"><span class="lineno"> 1330</span><span class="stringliteral">        x0 : 1D array, optional</span></div>
<div class="line"><span class="lineno"> 1331</span><span class="stringliteral">            Guess values of the decision variables, which will be refined by</span></div>
<div class="line"><span class="lineno"> 1332</span><span class="stringliteral">            the optimization algorithm. This argument is currently used only by the</span></div>
<div class="line"><span class="lineno"> 1333</span><span class="stringliteral">            &#39;revised simplex&#39; method, and can only be used if `x0` represents a</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="stringliteral">            basic feasible solution.</span></div>
<div class="line"><span class="lineno"> 1335</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1336</span><span class="stringliteral">    revstack: list of functions</span></div>
<div class="line"><span class="lineno"> 1337</span><span class="stringliteral">        the functions in the list reverse the operations of _presolve()</span></div>
<div class="line"><span class="lineno"> 1338</span><span class="stringliteral">        the function signature is x_org = f(x_mod), where x_mod is the result</span></div>
<div class="line"><span class="lineno"> 1339</span><span class="stringliteral">        of a presolve step and x_org the value at the start of the step</span></div>
<div class="line"><span class="lineno"> 1340</span><span class="stringliteral">    complete : bool</span></div>
<div class="line"><span class="lineno"> 1341</span><span class="stringliteral">        Whether the solution is was determined in presolve (``True`` if so)</span></div>
<div class="line"><span class="lineno"> 1342</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1343</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1344</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1345</span><span class="stringliteral">    x : 1-D array</span></div>
<div class="line"><span class="lineno"> 1346</span><span class="stringliteral">        Solution vector to original linear programming problem</span></div>
<div class="line"><span class="lineno"> 1347</span><span class="stringliteral">    fun: float</span></div>
<div class="line"><span class="lineno"> 1348</span><span class="stringliteral">        optimal objective value for original problem</span></div>
<div class="line"><span class="lineno"> 1349</span><span class="stringliteral">    slack : 1-D array</span></div>
<div class="line"><span class="lineno"> 1350</span><span class="stringliteral">        The (non-negative) slack in the upper bound constraints, that is,</span></div>
<div class="line"><span class="lineno"> 1351</span><span class="stringliteral">        ``b_ub - A_ub @ x``</span></div>
<div class="line"><span class="lineno"> 1352</span><span class="stringliteral">    con : 1-D array</span></div>
<div class="line"><span class="lineno"> 1353</span><span class="stringliteral">        The (nominally zero) residuals of the equality constraints, that is,</span></div>
<div class="line"><span class="lineno"> 1354</span><span class="stringliteral">        ``b - A_eq @ x``</span></div>
<div class="line"><span class="lineno"> 1355</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1356</span>    <span class="comment"># note that all the inputs are the ORIGINAL, unmodified versions</span></div>
<div class="line"><span class="lineno"> 1357</span>    <span class="comment"># no rows, columns have been removed</span></div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span>    c, A_ub, b_ub, A_eq, b_eq, bounds, x0, integrality = postsolve_args[0]</div>
<div class="line"><span class="lineno"> 1360</span>    revstack, C, b_scale = postsolve_args[1:]</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>    x = _unscale(x, C, b_scale)</div>
<div class="line"><span class="lineno"> 1363</span> </div>
<div class="line"><span class="lineno"> 1364</span>    <span class="comment"># Undo variable substitutions of _get_Abc()</span></div>
<div class="line"><span class="lineno"> 1365</span>    <span class="comment"># if &quot;complete&quot;, problem was solved in presolve; don&#39;t do anything here</span></div>
<div class="line"><span class="lineno"> 1366</span>    n_x = bounds.shape[0]</div>
<div class="line"><span class="lineno"> 1367</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> complete <span class="keywordflow">and</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:  <span class="comment"># bounds are never none, probably</span></div>
<div class="line"><span class="lineno"> 1368</span>        n_unbounded = 0</div>
<div class="line"><span class="lineno"> 1369</span>        <span class="keywordflow">for</span> i, bi <span class="keywordflow">in</span> enumerate(bounds):</div>
<div class="line"><span class="lineno"> 1370</span>            lbi = bi[0]</div>
<div class="line"><span class="lineno"> 1371</span>            ubi = bi[1]</div>
<div class="line"><span class="lineno"> 1372</span>            <span class="keywordflow">if</span> lbi == -np.inf <span class="keywordflow">and</span> ubi == np.inf:</div>
<div class="line"><span class="lineno"> 1373</span>                n_unbounded += 1</div>
<div class="line"><span class="lineno"> 1374</span>                x[i] = x[i] - x[n_x + n_unbounded - 1]</div>
<div class="line"><span class="lineno"> 1375</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1376</span>                <span class="keywordflow">if</span> lbi == -np.inf:</div>
<div class="line"><span class="lineno"> 1377</span>                    x[i] = ubi - x[i]</div>
<div class="line"><span class="lineno"> 1378</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1379</span>                    x[i] += lbi</div>
<div class="line"><span class="lineno"> 1380</span>    <span class="comment"># all the rest of the variables were artificial</span></div>
<div class="line"><span class="lineno"> 1381</span>    x = x[:n_x]</div>
<div class="line"><span class="lineno"> 1382</span> </div>
<div class="line"><span class="lineno"> 1383</span>    <span class="comment"># If there were variables removed from the problem, add them back into the</span></div>
<div class="line"><span class="lineno"> 1384</span>    <span class="comment"># solution vector</span></div>
<div class="line"><span class="lineno"> 1385</span>    <span class="comment"># Apply the functions in revstack (reverse direction)</span></div>
<div class="line"><span class="lineno"> 1386</span>    <span class="keywordflow">for</span> rev <span class="keywordflow">in</span> reversed(revstack):</div>
<div class="line"><span class="lineno"> 1387</span>        x = rev(x)</div>
<div class="line"><span class="lineno"> 1388</span> </div>
<div class="line"><span class="lineno"> 1389</span>    fun = x.dot(c)</div>
<div class="line"><span class="lineno"> 1390</span>    slack = b_ub - A_ub.dot(x)  <span class="comment"># report slack for ORIGINAL UB constraints</span></div>
<div class="line"><span class="lineno"> 1391</span>    <span class="comment"># report residuals of ORIGINAL EQ constraints</span></div>
<div class="line"><span class="lineno"> 1392</span>    con = b_eq - A_eq.dot(x)</div>
<div class="line"><span class="lineno"> 1393</span> </div>
<div class="line"><span class="lineno"> 1394</span>    <span class="keywordflow">return</span> x, fun, slack, con</div>
<div class="line"><span class="lineno"> 1395</span> </div>
<div class="line"><span class="lineno"> 1396</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a34319685367e29a2c1c8327d86e79964" name="a34319685367e29a2c1c8327d86e79964"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34319685367e29a2c1c8327d86e79964">&#9670;&#160;</a></span>_presolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._presolve </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rr_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-9</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given inputs for a linear programming problem in preferred format,
presolve the problem: identify trivial infeasibilities, redundancies,
and unboundedness, tighten bounds where possible, and eliminate fixed
variables.

Parameters
----------
lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:

    c : 1D array
        The coefficients of the linear objective function to be minimized.
    A_ub : 2D array, optional
        The inequality constraint matrix. Each row of ``A_ub`` specifies the
        coefficients of a linear inequality constraint on ``x``.
    b_ub : 1D array, optional
        The inequality constraint vector. Each element represents an
        upper bound on the corresponding value of ``A_ub @ x``.
    A_eq : 2D array, optional
        The equality constraint matrix. Each row of ``A_eq`` specifies the
        coefficients of a linear equality constraint on ``x``.
    b_eq : 1D array, optional
        The equality constraint vector. Each element of ``A_eq @ x`` must equal
        the corresponding element of ``b_eq``.
    bounds : 2D array
        The bounds of ``x``, as ``min`` and ``max`` pairs, one for each of the N
        elements of ``x``. The N x 2 array contains lower bounds in the first
        column and upper bounds in the 2nd. Unbounded variables have lower
        bound -np.inf and/or upper bound np.inf.
    x0 : 1D array, optional
        Guess values of the decision variables, which will be refined by
        the optimization algorithm. This argument is currently used only by the
        'revised simplex' method, and can only be used if `x0` represents a
        basic feasible solution.

rr : bool
    If ``True`` attempts to eliminate any redundant rows in ``A_eq``.
    Set False if ``A_eq`` is known to be of full row rank, or if you are
    looking for a potential speedup (at the expense of reliability).
rr_method : string
    Method used to identify and remove redundant rows from the
    equality constraint matrix after presolve.
tol : float
    The tolerance which determines when a solution is "close enough" to
    zero in Phase 1 to be considered a basic feasible solution or close
    enough to positive to serve as an optimal solution.

Returns
-------
lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:

    c : 1D array
        The coefficients of the linear objective function to be minimized.
    A_ub : 2D array, optional
        The inequality constraint matrix. Each row of ``A_ub`` specifies the
        coefficients of a linear inequality constraint on ``x``.
    b_ub : 1D array, optional
        The inequality constraint vector. Each element represents an
        upper bound on the corresponding value of ``A_ub @ x``.
    A_eq : 2D array, optional
        The equality constraint matrix. Each row of ``A_eq`` specifies the
        coefficients of a linear equality constraint on ``x``.
    b_eq : 1D array, optional
        The equality constraint vector. Each element of ``A_eq @ x`` must equal
        the corresponding element of ``b_eq``.
    bounds : 2D array
        The bounds of ``x``, as ``min`` and ``max`` pairs, possibly tightened.
    x0 : 1D array, optional
        Guess values of the decision variables, which will be refined by
        the optimization algorithm. This argument is currently used only by the
        'revised simplex' method, and can only be used if `x0` represents a
        basic feasible solution.

c0 : 1D array
    Constant term in objective function due to fixed (and eliminated)
    variables.
x : 1D array
    Solution vector (when the solution is trivial and can be determined
    in presolve)
revstack: list of functions
    the functions in the list reverse the operations of _presolve()
    the function signature is x_org = f(x_mod), where x_mod is the result
    of a presolve step and x_org the value at the start of the step
    (currently, the revstack contains only one function)
complete: bool
    Whether the solution is complete (solved or determined to be infeasible
    or unbounded in presolve)
status : int
    An integer representing the exit status of the optimization::

     0 : Optimization terminated successfully
     1 : Iteration limit reached
     2 : Problem appears to be infeasible
     3 : Problem appears to be unbounded
     4 : Serious numerical difficulties encountered

message : str
    A string descriptor of the exit status of the optimization.

References
----------
.. [5] Andersen, Erling D. "Finding all linearly dependent rows in
       large-scale linear programming." Optimization Methods and Software
       6.3 (1995): 219-227.
.. [8] Andersen, Erling D., and Knud D. Andersen. "Presolving in linear
       programming." Mathematical Programming 71.2 (1995): 221-245.</pre> <div class="fragment"><div class="line"><span class="lineno">  455</span><span class="keyword">def </span>_presolve(lp, rr, rr_method, tol=1e-9):</div>
<div class="line"><span class="lineno">  456</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">    Given inputs for a linear programming problem in preferred format,</span></div>
<div class="line"><span class="lineno">  458</span><span class="stringliteral">    presolve the problem: identify trivial infeasibilities, redundancies,</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral">    and unboundedness, tighten bounds where possible, and eliminate fixed</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">    variables.</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  464</span><span class="stringliteral">    lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">        c : 1D array</span></div>
<div class="line"><span class="lineno">  467</span><span class="stringliteral">            The coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral">        A_ub : 2D array, optional</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">            The inequality constraint matrix. Each row of ``A_ub`` specifies the</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral">            coefficients of a linear inequality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">        b_ub : 1D array, optional</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral">            The inequality constraint vector. Each element represents an</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">            upper bound on the corresponding value of ``A_ub @ x``.</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">        A_eq : 2D array, optional</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">            The equality constraint matrix. Each row of ``A_eq`` specifies the</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">            coefficients of a linear equality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">        b_eq : 1D array, optional</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">            The equality constraint vector. Each element of ``A_eq @ x`` must equal</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">            the corresponding element of ``b_eq``.</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">        bounds : 2D array</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">            The bounds of ``x``, as ``min`` and ``max`` pairs, one for each of the N</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">            elements of ``x``. The N x 2 array contains lower bounds in the first</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">            column and upper bounds in the 2nd. Unbounded variables have lower</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">            bound -np.inf and/or upper bound np.inf.</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">        x0 : 1D array, optional</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">            Guess values of the decision variables, which will be refined by</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">            the optimization algorithm. This argument is currently used only by the</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">            &#39;revised simplex&#39; method, and can only be used if `x0` represents a</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">            basic feasible solution.</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">    rr : bool</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">        If ``True`` attempts to eliminate any redundant rows in ``A_eq``.</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">        Set False if ``A_eq`` is known to be of full row rank, or if you are</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">        looking for a potential speedup (at the expense of reliability).</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">    rr_method : string</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">        Method used to identify and remove redundant rows from the</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral">        equality constraint matrix after presolve.</span></div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">        The tolerance which determines when a solution is &quot;close enough&quot; to</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">        zero in Phase 1 to be considered a basic feasible solution or close</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">        enough to positive to serve as an optimal solution.</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  505</span><span class="stringliteral">    lp : A `scipy.optimize._linprog_util._LPProblem` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  506</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral">        c : 1D array</span></div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral">            The coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  509</span><span class="stringliteral">        A_ub : 2D array, optional</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">            The inequality constraint matrix. Each row of ``A_ub`` specifies the</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">            coefficients of a linear inequality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">        b_ub : 1D array, optional</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">            The inequality constraint vector. Each element represents an</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">            upper bound on the corresponding value of ``A_ub @ x``.</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">        A_eq : 2D array, optional</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">            The equality constraint matrix. Each row of ``A_eq`` specifies the</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">            coefficients of a linear equality constraint on ``x``.</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">        b_eq : 1D array, optional</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">            The equality constraint vector. Each element of ``A_eq @ x`` must equal</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">            the corresponding element of ``b_eq``.</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">        bounds : 2D array</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">            The bounds of ``x``, as ``min`` and ``max`` pairs, possibly tightened.</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">        x0 : 1D array, optional</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">            Guess values of the decision variables, which will be refined by</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">            the optimization algorithm. This argument is currently used only by the</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">            &#39;revised simplex&#39; method, and can only be used if `x0` represents a</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">            basic feasible solution.</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">    c0 : 1D array</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">        Constant term in objective function due to fixed (and eliminated)</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">        variables.</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">    x : 1D array</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">        Solution vector (when the solution is trivial and can be determined</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">        in presolve)</span></div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral">    revstack: list of functions</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">        the functions in the list reverse the operations of _presolve()</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral">        the function signature is x_org = f(x_mod), where x_mod is the result</span></div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral">        of a presolve step and x_org the value at the start of the step</span></div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">        (currently, the revstack contains only one function)</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral">    complete: bool</span></div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">        Whether the solution is complete (solved or determined to be infeasible</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">        or unbounded in presolve)</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">         0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">         1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">         2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">         3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">         4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral">        A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">    .. [5] Andersen, Erling D. &quot;Finding all linearly dependent rows in</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">           large-scale linear programming.&quot; Optimization Methods and Software</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">           6.3 (1995): 219-227.</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">    .. [8] Andersen, Erling D., and Knud D. Andersen. &quot;Presolving in linear</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">           programming.&quot; Mathematical Programming 71.2 (1995): 221-245.</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  564</span>    <span class="comment"># ideas from Reference [5] by Andersen and Andersen</span></div>
<div class="line"><span class="lineno">  565</span>    <span class="comment"># however, unlike the reference, this is performed before converting</span></div>
<div class="line"><span class="lineno">  566</span>    <span class="comment"># problem to standard form</span></div>
<div class="line"><span class="lineno">  567</span>    <span class="comment"># There are a few advantages:</span></div>
<div class="line"><span class="lineno">  568</span>    <span class="comment">#  * artificial variables have not been added, so matrices are smaller</span></div>
<div class="line"><span class="lineno">  569</span>    <span class="comment">#  * bounds have not been converted to constraints yet. (It is better to</span></div>
<div class="line"><span class="lineno">  570</span>    <span class="comment">#    do that after presolve because presolve may adjust the simple bounds.)</span></div>
<div class="line"><span class="lineno">  571</span>    <span class="comment"># There are many improvements that can be made, namely:</span></div>
<div class="line"><span class="lineno">  572</span>    <span class="comment">#  * implement remaining checks from [5]</span></div>
<div class="line"><span class="lineno">  573</span>    <span class="comment">#  * loop presolve until no additional changes are made</span></div>
<div class="line"><span class="lineno">  574</span>    <span class="comment">#  * implement additional efficiency improvements in redundancy removal [2]</span></div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>    c, A_ub, b_ub, A_eq, b_eq, bounds, x0, _ = lp</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>    revstack = []               <span class="comment"># record of variables eliminated from problem</span></div>
<div class="line"><span class="lineno">  579</span>    <span class="comment"># constant term in cost function may be added if variables are eliminated</span></div>
<div class="line"><span class="lineno">  580</span>    c0 = 0</div>
<div class="line"><span class="lineno">  581</span>    complete = <span class="keyword">False</span>        <span class="comment"># complete is True if detected infeasible/unbounded</span></div>
<div class="line"><span class="lineno">  582</span>    x = np.zeros(c.shape)   <span class="comment"># this is solution vector if completed in presolve</span></div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    status = 0              <span class="comment"># all OK unless determined otherwise</span></div>
<div class="line"><span class="lineno">  585</span>    message = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    <span class="comment"># Lower and upper bounds. Copy to prevent feedback.</span></div>
<div class="line"><span class="lineno">  588</span>    lb = bounds[:, 0].copy()</div>
<div class="line"><span class="lineno">  589</span>    ub = bounds[:, 1].copy()</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>    m_eq, n = A_eq.shape</div>
<div class="line"><span class="lineno">  592</span>    m_ub, n = A_ub.shape</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">if</span> (rr_method <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  595</span>            <span class="keywordflow">and</span> rr_method.lower() <span class="keywordflow">not</span> <span class="keywordflow">in</span> {<span class="stringliteral">&quot;svd&quot;</span>, <span class="stringliteral">&quot;pivot&quot;</span>, <span class="stringliteral">&quot;id&quot;</span>}):</div>
<div class="line"><span class="lineno">  596</span>        message = (<span class="stringliteral">&quot;&#39;&quot;</span> + str(rr_method) + <span class="stringliteral">&quot;&#39; is not a valid option &quot;</span></div>
<div class="line"><span class="lineno">  597</span>                   <span class="stringliteral">&quot;for redundancy removal. Valid options are &#39;SVD&#39;, &quot;</span></div>
<div class="line"><span class="lineno">  598</span>                   <span class="stringliteral">&quot;&#39;pivot&#39;, and &#39;ID&#39;.&quot;</span>)</div>
<div class="line"><span class="lineno">  599</span>        <span class="keywordflow">raise</span> ValueError(message)</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    <span class="keywordflow">if</span> sps.issparse(A_eq):</div>
<div class="line"><span class="lineno">  602</span>        A_eq = A_eq.tocsr()</div>
<div class="line"><span class="lineno">  603</span>        A_ub = A_ub.tocsr()</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>        <span class="keyword">def </span>where(A):</div>
<div class="line"><span class="lineno">  606</span>            <span class="keywordflow">return</span> A.nonzero()</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>        vstack = sps.vstack</div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  610</span>        where = np.where</div>
<div class="line"><span class="lineno">  611</span>        vstack = np.vstack</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    <span class="comment"># upper bounds &gt; lower bounds</span></div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordflow">if</span> np.any(ub &lt; lb) <span class="keywordflow">or</span> np.any(lb == np.inf) <span class="keywordflow">or</span> np.any(ub == -np.inf):</div>
<div class="line"><span class="lineno">  615</span>        status = 2</div>
<div class="line"><span class="lineno">  616</span>        message = (<span class="stringliteral">&quot;The problem is (trivially) infeasible since one &quot;</span></div>
<div class="line"><span class="lineno">  617</span>                   <span class="stringliteral">&quot;or more upper bounds are smaller than the corresponding &quot;</span></div>
<div class="line"><span class="lineno">  618</span>                   <span class="stringliteral">&quot;lower bounds, a lower bound is np.inf or an upper bound &quot;</span></div>
<div class="line"><span class="lineno">  619</span>                   <span class="stringliteral">&quot;is -np.inf.&quot;</span>)</div>
<div class="line"><span class="lineno">  620</span>        complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  621</span>        <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  622</span>                c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    <span class="comment"># zero row in equality constraints</span></div>
<div class="line"><span class="lineno">  625</span>    zero_row = np.array(np.sum(A_eq != 0, axis=1) == 0).flatten()</div>
<div class="line"><span class="lineno">  626</span>    <span class="keywordflow">if</span> np.any(zero_row):</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordflow">if</span> np.any(</div>
<div class="line"><span class="lineno">  628</span>            np.logical_and(</div>
<div class="line"><span class="lineno">  629</span>                zero_row,</div>
<div class="line"><span class="lineno">  630</span>                np.abs(b_eq) &gt; tol)):  <span class="comment"># test_zero_row_1</span></div>
<div class="line"><span class="lineno">  631</span>            <span class="comment"># infeasible if RHS is not zero</span></div>
<div class="line"><span class="lineno">  632</span>            status = 2</div>
<div class="line"><span class="lineno">  633</span>            message = (<span class="stringliteral">&quot;The problem is (trivially) infeasible due to a row &quot;</span></div>
<div class="line"><span class="lineno">  634</span>                       <span class="stringliteral">&quot;of zeros in the equality constraint matrix with a &quot;</span></div>
<div class="line"><span class="lineno">  635</span>                       <span class="stringliteral">&quot;nonzero corresponding constraint value.&quot;</span>)</div>
<div class="line"><span class="lineno">  636</span>            complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  637</span>            <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  638</span>                    c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  639</span>        <span class="keywordflow">else</span>:  <span class="comment"># test_zero_row_2</span></div>
<div class="line"><span class="lineno">  640</span>            <span class="comment"># if RHS is zero, we can eliminate this equation entirely</span></div>
<div class="line"><span class="lineno">  641</span>            A_eq = A_eq[np.logical_not(zero_row), :]</div>
<div class="line"><span class="lineno">  642</span>            b_eq = b_eq[np.logical_not(zero_row)]</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>    <span class="comment"># zero row in inequality constraints</span></div>
<div class="line"><span class="lineno">  645</span>    zero_row = np.array(np.sum(A_ub != 0, axis=1) == 0).flatten()</div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">if</span> np.any(zero_row):</div>
<div class="line"><span class="lineno">  647</span>        <span class="keywordflow">if</span> np.any(np.logical_and(zero_row, b_ub &lt; -tol)):  <span class="comment"># test_zero_row_1</span></div>
<div class="line"><span class="lineno">  648</span>            <span class="comment"># infeasible if RHS is less than zero (because LHS is zero)</span></div>
<div class="line"><span class="lineno">  649</span>            status = 2</div>
<div class="line"><span class="lineno">  650</span>            message = (<span class="stringliteral">&quot;The problem is (trivially) infeasible due to a row &quot;</span></div>
<div class="line"><span class="lineno">  651</span>                       <span class="stringliteral">&quot;of zeros in the equality constraint matrix with a &quot;</span></div>
<div class="line"><span class="lineno">  652</span>                       <span class="stringliteral">&quot;nonzero corresponding  constraint value.&quot;</span>)</div>
<div class="line"><span class="lineno">  653</span>            complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  654</span>            <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  655</span>                    c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  656</span>        <span class="keywordflow">else</span>:  <span class="comment"># test_zero_row_2</span></div>
<div class="line"><span class="lineno">  657</span>            <span class="comment"># if LHS is &gt;= 0, we can eliminate this constraint entirely</span></div>
<div class="line"><span class="lineno">  658</span>            A_ub = A_ub[np.logical_not(zero_row), :]</div>
<div class="line"><span class="lineno">  659</span>            b_ub = b_ub[np.logical_not(zero_row)]</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>    <span class="comment"># zero column in (both) constraints</span></div>
<div class="line"><span class="lineno">  662</span>    <span class="comment"># this indicates that a variable isn&#39;t constrained and can be removed</span></div>
<div class="line"><span class="lineno">  663</span>    A = vstack((A_eq, A_ub))</div>
<div class="line"><span class="lineno">  664</span>    <span class="keywordflow">if</span> A.shape[0] &gt; 0:</div>
<div class="line"><span class="lineno">  665</span>        zero_col = np.array(np.sum(A != 0, axis=0) == 0).flatten()</div>
<div class="line"><span class="lineno">  666</span>        <span class="comment"># variable will be at upper or lower bound, depending on objective</span></div>
<div class="line"><span class="lineno">  667</span>        x[np.logical_and(zero_col, c &lt; 0)] = ub[</div>
<div class="line"><span class="lineno">  668</span>            np.logical_and(zero_col, c &lt; 0)]</div>
<div class="line"><span class="lineno">  669</span>        x[np.logical_and(zero_col, c &gt; 0)] = lb[</div>
<div class="line"><span class="lineno">  670</span>            np.logical_and(zero_col, c &gt; 0)]</div>
<div class="line"><span class="lineno">  671</span>        <span class="keywordflow">if</span> np.any(np.isinf(x)):  <span class="comment"># if an unconstrained variable has no bound</span></div>
<div class="line"><span class="lineno">  672</span>            status = 3</div>
<div class="line"><span class="lineno">  673</span>            message = (<span class="stringliteral">&quot;If feasible, the problem is (trivially) unbounded &quot;</span></div>
<div class="line"><span class="lineno">  674</span>                       <span class="stringliteral">&quot;due  to a zero column in the constraint matrices. If &quot;</span></div>
<div class="line"><span class="lineno">  675</span>                       <span class="stringliteral">&quot;you wish to check whether the problem is infeasible, &quot;</span></div>
<div class="line"><span class="lineno">  676</span>                       <span class="stringliteral">&quot;turn presolve off.&quot;</span>)</div>
<div class="line"><span class="lineno">  677</span>            complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  678</span>            <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  679</span>                    c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  680</span>        <span class="comment"># variables will equal upper/lower bounds will be removed later</span></div>
<div class="line"><span class="lineno">  681</span>        lb[np.logical_and(zero_col, c &lt; 0)] = ub[</div>
<div class="line"><span class="lineno">  682</span>            np.logical_and(zero_col, c &lt; 0)]</div>
<div class="line"><span class="lineno">  683</span>        ub[np.logical_and(zero_col, c &gt; 0)] = lb[</div>
<div class="line"><span class="lineno">  684</span>            np.logical_and(zero_col, c &gt; 0)]</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    <span class="comment"># row singleton in equality constraints</span></div>
<div class="line"><span class="lineno">  687</span>    <span class="comment"># this fixes a variable and removes the constraint</span></div>
<div class="line"><span class="lineno">  688</span>    singleton_row = np.array(np.sum(A_eq != 0, axis=1) == 1).flatten()</div>
<div class="line"><span class="lineno">  689</span>    rows = where(singleton_row)[0]</div>
<div class="line"><span class="lineno">  690</span>    cols = where(A_eq[rows, :])[1]</div>
<div class="line"><span class="lineno">  691</span>    <span class="keywordflow">if</span> len(rows) &gt; 0:</div>
<div class="line"><span class="lineno">  692</span>        <span class="keywordflow">for</span> row, col <span class="keywordflow">in</span> zip(rows, cols):</div>
<div class="line"><span class="lineno">  693</span>            val = b_eq[row] / A_eq[row, col]</div>
<div class="line"><span class="lineno">  694</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> lb[col] - tol &lt;= val &lt;= ub[col] + tol:</div>
<div class="line"><span class="lineno">  695</span>                <span class="comment"># infeasible if fixed value is not within bounds</span></div>
<div class="line"><span class="lineno">  696</span>                status = 2</div>
<div class="line"><span class="lineno">  697</span>                message = (<span class="stringliteral">&quot;The problem is (trivially) infeasible because a &quot;</span></div>
<div class="line"><span class="lineno">  698</span>                           <span class="stringliteral">&quot;singleton row in the equality constraints is &quot;</span></div>
<div class="line"><span class="lineno">  699</span>                           <span class="stringliteral">&quot;inconsistent with the bounds.&quot;</span>)</div>
<div class="line"><span class="lineno">  700</span>                complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  701</span>                <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  702</span>                        c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  703</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  704</span>                <span class="comment"># sets upper and lower bounds at that fixed value - variable</span></div>
<div class="line"><span class="lineno">  705</span>                <span class="comment"># will be removed later</span></div>
<div class="line"><span class="lineno">  706</span>                lb[col] = val</div>
<div class="line"><span class="lineno">  707</span>                ub[col] = val</div>
<div class="line"><span class="lineno">  708</span>        A_eq = A_eq[np.logical_not(singleton_row), :]</div>
<div class="line"><span class="lineno">  709</span>        b_eq = b_eq[np.logical_not(singleton_row)]</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>    <span class="comment"># row singleton in inequality constraints</span></div>
<div class="line"><span class="lineno">  712</span>    <span class="comment"># this indicates a simple bound and the constraint can be removed</span></div>
<div class="line"><span class="lineno">  713</span>    <span class="comment"># simple bounds may be adjusted here</span></div>
<div class="line"><span class="lineno">  714</span>    <span class="comment"># After all of the simple bound information is combined here, get_Abc will</span></div>
<div class="line"><span class="lineno">  715</span>    <span class="comment"># turn the simple bounds into constraints</span></div>
<div class="line"><span class="lineno">  716</span>    singleton_row = np.array(np.sum(A_ub != 0, axis=1) == 1).flatten()</div>
<div class="line"><span class="lineno">  717</span>    cols = where(A_ub[singleton_row, :])[1]</div>
<div class="line"><span class="lineno">  718</span>    rows = where(singleton_row)[0]</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> len(rows) &gt; 0:</div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">for</span> row, col <span class="keywordflow">in</span> zip(rows, cols):</div>
<div class="line"><span class="lineno">  721</span>            val = b_ub[row] / A_ub[row, col]</div>
<div class="line"><span class="lineno">  722</span>            <span class="keywordflow">if</span> A_ub[row, col] &gt; 0:  <span class="comment"># upper bound</span></div>
<div class="line"><span class="lineno">  723</span>                <span class="keywordflow">if</span> val &lt; lb[col] - tol:  <span class="comment"># infeasible</span></div>
<div class="line"><span class="lineno">  724</span>                    complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  725</span>                <span class="keywordflow">elif</span> val &lt; ub[col]:  <span class="comment"># new upper bound</span></div>
<div class="line"><span class="lineno">  726</span>                    ub[col] = val</div>
<div class="line"><span class="lineno">  727</span>            <span class="keywordflow">else</span>:  <span class="comment"># lower bound</span></div>
<div class="line"><span class="lineno">  728</span>                <span class="keywordflow">if</span> val &gt; ub[col] + tol:  <span class="comment"># infeasible</span></div>
<div class="line"><span class="lineno">  729</span>                    complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  730</span>                <span class="keywordflow">elif</span> val &gt; lb[col]:  <span class="comment"># new lower bound</span></div>
<div class="line"><span class="lineno">  731</span>                    lb[col] = val</div>
<div class="line"><span class="lineno">  732</span>            <span class="keywordflow">if</span> complete:</div>
<div class="line"><span class="lineno">  733</span>                status = 2</div>
<div class="line"><span class="lineno">  734</span>                message = (<span class="stringliteral">&quot;The problem is (trivially) infeasible because a &quot;</span></div>
<div class="line"><span class="lineno">  735</span>                           <span class="stringliteral">&quot;singleton row in the upper bound constraints is &quot;</span></div>
<div class="line"><span class="lineno">  736</span>                           <span class="stringliteral">&quot;inconsistent with the bounds.&quot;</span>)</div>
<div class="line"><span class="lineno">  737</span>                <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  738</span>                        c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  739</span>        A_ub = A_ub[np.logical_not(singleton_row), :]</div>
<div class="line"><span class="lineno">  740</span>        b_ub = b_ub[np.logical_not(singleton_row)]</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>    <span class="comment"># identical bounds indicate that variable can be removed</span></div>
<div class="line"><span class="lineno">  743</span>    i_f = np.abs(lb - ub) &lt; tol   <span class="comment"># indices of &quot;fixed&quot; variables</span></div>
<div class="line"><span class="lineno">  744</span>    i_nf = np.logical_not(i_f)  <span class="comment"># indices of &quot;not fixed&quot; variables</span></div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>    <span class="comment"># test_bounds_equal_but_infeasible</span></div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordflow">if</span> np.all(i_f):  <span class="comment"># if bounds define solution, check for consistency</span></div>
<div class="line"><span class="lineno">  748</span>        residual = b_eq - A_eq.dot(lb)</div>
<div class="line"><span class="lineno">  749</span>        slack = b_ub - A_ub.dot(lb)</div>
<div class="line"><span class="lineno">  750</span>        <span class="keywordflow">if</span> ((A_ub.size &gt; 0 <span class="keywordflow">and</span> np.any(slack &lt; 0)) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  751</span>                (A_eq.size &gt; 0 <span class="keywordflow">and</span> <span class="keywordflow">not</span> np.allclose(residual, 0))):</div>
<div class="line"><span class="lineno">  752</span>            status = 2</div>
<div class="line"><span class="lineno">  753</span>            message = (<span class="stringliteral">&quot;The problem is (trivially) infeasible because the &quot;</span></div>
<div class="line"><span class="lineno">  754</span>                       <span class="stringliteral">&quot;bounds fix all variables to values inconsistent with &quot;</span></div>
<div class="line"><span class="lineno">  755</span>                       <span class="stringliteral">&quot;the constraints&quot;</span>)</div>
<div class="line"><span class="lineno">  756</span>            complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  757</span>            <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  758</span>                    c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>    ub_mod = ub</div>
<div class="line"><span class="lineno">  761</span>    lb_mod = lb</div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordflow">if</span> np.any(i_f):</div>
<div class="line"><span class="lineno">  763</span>        c0 += c[i_f].dot(lb[i_f])</div>
<div class="line"><span class="lineno">  764</span>        b_eq = b_eq - A_eq[:, i_f].dot(lb[i_f])</div>
<div class="line"><span class="lineno">  765</span>        b_ub = b_ub - A_ub[:, i_f].dot(lb[i_f])</div>
<div class="line"><span class="lineno">  766</span>        c = c[i_nf]</div>
<div class="line"><span class="lineno">  767</span>        x_undo = lb[i_f]  <span class="comment"># not x[i_f], x is just zeroes</span></div>
<div class="line"><span class="lineno">  768</span>        x = x[i_nf]</div>
<div class="line"><span class="lineno">  769</span>        <span class="comment"># user guess x0 stays separate from presolve solution x</span></div>
<div class="line"><span class="lineno">  770</span>        <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  771</span>            x0 = x0[i_nf]</div>
<div class="line"><span class="lineno">  772</span>        A_eq = A_eq[:, i_nf]</div>
<div class="line"><span class="lineno">  773</span>        A_ub = A_ub[:, i_nf]</div>
<div class="line"><span class="lineno">  774</span>        <span class="comment"># modify bounds</span></div>
<div class="line"><span class="lineno">  775</span>        lb_mod = lb[i_nf]</div>
<div class="line"><span class="lineno">  776</span>        ub_mod = ub[i_nf]</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>        <span class="keyword">def </span>rev(x_mod):</div>
<div class="line"><span class="lineno">  779</span>            <span class="comment"># Function to restore x: insert x_undo into x_mod.</span></div>
<div class="line"><span class="lineno">  780</span>            <span class="comment"># When elements have been removed at positions k1, k2, k3, ...</span></div>
<div class="line"><span class="lineno">  781</span>            <span class="comment"># then these must be replaced at (after) positions k1-1, k2-2,</span></div>
<div class="line"><span class="lineno">  782</span>            <span class="comment"># k3-3, ... in the modified array to recreate the original</span></div>
<div class="line"><span class="lineno">  783</span>            i = np.flatnonzero(i_f)</div>
<div class="line"><span class="lineno">  784</span>            <span class="comment"># Number of variables to restore</span></div>
<div class="line"><span class="lineno">  785</span>            N = len(i)</div>
<div class="line"><span class="lineno">  786</span>            index_offset = np.arange(N)</div>
<div class="line"><span class="lineno">  787</span>            <span class="comment"># Create insert indices</span></div>
<div class="line"><span class="lineno">  788</span>            insert_indices = i - index_offset</div>
<div class="line"><span class="lineno">  789</span>            x_rev = np.insert(x_mod.astype(float), insert_indices, x_undo)</div>
<div class="line"><span class="lineno">  790</span>            <span class="keywordflow">return</span> x_rev</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>        <span class="comment"># Use revstack as a list of functions, currently just this one.</span></div>
<div class="line"><span class="lineno">  793</span>        revstack.append(rev)</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>    <span class="comment"># no constraints indicates that problem is trivial</span></div>
<div class="line"><span class="lineno">  796</span>    <span class="keywordflow">if</span> A_eq.size == 0 <span class="keywordflow">and</span> A_ub.size == 0:</div>
<div class="line"><span class="lineno">  797</span>        b_eq = np.array([])</div>
<div class="line"><span class="lineno">  798</span>        b_ub = np.array([])</div>
<div class="line"><span class="lineno">  799</span>        <span class="comment"># test_empty_constraint_1</span></div>
<div class="line"><span class="lineno">  800</span>        <span class="keywordflow">if</span> c.size == 0:</div>
<div class="line"><span class="lineno">  801</span>            status = 0</div>
<div class="line"><span class="lineno">  802</span>            message = (<span class="stringliteral">&quot;The solution was determined in presolve as there are &quot;</span></div>
<div class="line"><span class="lineno">  803</span>                       <span class="stringliteral">&quot;no non-trivial constraints.&quot;</span>)</div>
<div class="line"><span class="lineno">  804</span>        <span class="keywordflow">elif</span> (np.any(np.logical_and(c &lt; 0, ub_mod == np.inf)) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  805</span>              np.any(np.logical_and(c &gt; 0, lb_mod == -np.inf))):</div>
<div class="line"><span class="lineno">  806</span>            <span class="comment"># test_no_constraints()</span></div>
<div class="line"><span class="lineno">  807</span>            <span class="comment"># test_unbounded_no_nontrivial_constraints_1</span></div>
<div class="line"><span class="lineno">  808</span>            <span class="comment"># test_unbounded_no_nontrivial_constraints_2</span></div>
<div class="line"><span class="lineno">  809</span>            status = 3</div>
<div class="line"><span class="lineno">  810</span>            message = (<span class="stringliteral">&quot;The problem is (trivially) unbounded &quot;</span></div>
<div class="line"><span class="lineno">  811</span>                       <span class="stringliteral">&quot;because there are no non-trivial constraints and &quot;</span></div>
<div class="line"><span class="lineno">  812</span>                       <span class="stringliteral">&quot;a) at least one decision variable is unbounded &quot;</span></div>
<div class="line"><span class="lineno">  813</span>                       <span class="stringliteral">&quot;above and its corresponding cost is negative, or &quot;</span></div>
<div class="line"><span class="lineno">  814</span>                       <span class="stringliteral">&quot;b) at least one decision variable is unbounded below &quot;</span></div>
<div class="line"><span class="lineno">  815</span>                       <span class="stringliteral">&quot;and its corresponding cost is positive. &quot;</span>)</div>
<div class="line"><span class="lineno">  816</span>        <span class="keywordflow">else</span>:  <span class="comment"># test_empty_constraint_2</span></div>
<div class="line"><span class="lineno">  817</span>            status = 0</div>
<div class="line"><span class="lineno">  818</span>            message = (<span class="stringliteral">&quot;The solution was determined in presolve as there are &quot;</span></div>
<div class="line"><span class="lineno">  819</span>                       <span class="stringliteral">&quot;no non-trivial constraints.&quot;</span>)</div>
<div class="line"><span class="lineno">  820</span>        complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  821</span>        x[c &lt; 0] = ub_mod[c &lt; 0]</div>
<div class="line"><span class="lineno">  822</span>        x[c &gt; 0] = lb_mod[c &gt; 0]</div>
<div class="line"><span class="lineno">  823</span>        <span class="comment"># where c is zero, set x to a finite bound or zero</span></div>
<div class="line"><span class="lineno">  824</span>        x_zero_c = ub_mod[c == 0]</div>
<div class="line"><span class="lineno">  825</span>        x_zero_c[np.isinf(x_zero_c)] = ub_mod[c == 0][np.isinf(x_zero_c)]</div>
<div class="line"><span class="lineno">  826</span>        x_zero_c[np.isinf(x_zero_c)] = 0</div>
<div class="line"><span class="lineno">  827</span>        x[c == 0] = x_zero_c</div>
<div class="line"><span class="lineno">  828</span>        <span class="comment"># if this is not the last step of presolve, should convert bounds back</span></div>
<div class="line"><span class="lineno">  829</span>        <span class="comment"># to array and return here</span></div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>    <span class="comment"># Convert modified lb and ub back into N x 2 bounds</span></div>
<div class="line"><span class="lineno">  832</span>    bounds = np.hstack((lb_mod[:, np.newaxis], ub_mod[:, np.newaxis]))</div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span>    <span class="comment"># remove redundant (linearly dependent) rows from equality constraints</span></div>
<div class="line"><span class="lineno">  835</span>    n_rows_A = A_eq.shape[0]</div>
<div class="line"><span class="lineno">  836</span>    redundancy_warning = (<span class="stringliteral">&quot;A_eq does not appear to be of full row rank. To &quot;</span></div>
<div class="line"><span class="lineno">  837</span>                          <span class="stringliteral">&quot;improve performance, check the problem formulation &quot;</span></div>
<div class="line"><span class="lineno">  838</span>                          <span class="stringliteral">&quot;for redundant equality constraints.&quot;</span>)</div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">if</span> (sps.issparse(A_eq)):</div>
<div class="line"><span class="lineno">  840</span>        <span class="keywordflow">if</span> rr <span class="keywordflow">and</span> A_eq.size &gt; 0:  <span class="comment"># TODO: Fast sparse rank check?</span></div>
<div class="line"><span class="lineno">  841</span>            rr_res = _remove_redundancy_pivot_sparse(A_eq, b_eq)</div>
<div class="line"><span class="lineno">  842</span>            A_eq, b_eq, status, message = rr_res</div>
<div class="line"><span class="lineno">  843</span>            <span class="keywordflow">if</span> A_eq.shape[0] &lt; n_rows_A:</div>
<div class="line"><span class="lineno">  844</span>                warn(redundancy_warning, OptimizeWarning, stacklevel=1)</div>
<div class="line"><span class="lineno">  845</span>            <span class="keywordflow">if</span> status != 0:</div>
<div class="line"><span class="lineno">  846</span>                complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  847</span>        <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  848</span>                c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  849</span> </div>
<div class="line"><span class="lineno">  850</span>    <span class="comment"># This is a wild guess for which redundancy removal algorithm will be</span></div>
<div class="line"><span class="lineno">  851</span>    <span class="comment"># faster. More testing would be good.</span></div>
<div class="line"><span class="lineno">  852</span>    small_nullspace = 5</div>
<div class="line"><span class="lineno">  853</span>    <span class="keywordflow">if</span> rr <span class="keywordflow">and</span> A_eq.size &gt; 0:</div>
<div class="line"><span class="lineno">  854</span>        <span class="keywordflow">try</span>:  <span class="comment"># TODO: use results of first SVD in _remove_redundancy_svd</span></div>
<div class="line"><span class="lineno">  855</span>            rank = np.linalg.matrix_rank(A_eq)</div>
<div class="line"><span class="lineno">  856</span>        <span class="comment"># oh well, we&#39;ll have to go with _remove_redundancy_pivot_dense</span></div>
<div class="line"><span class="lineno">  857</span>        <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno">  858</span>            rank = 0</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordflow">if</span> rr <span class="keywordflow">and</span> A_eq.size &gt; 0 <span class="keywordflow">and</span> rank &lt; A_eq.shape[0]:</div>
<div class="line"><span class="lineno">  860</span>        warn(redundancy_warning, OptimizeWarning, stacklevel=3)</div>
<div class="line"><span class="lineno">  861</span>        dim_row_nullspace = A_eq.shape[0]-rank</div>
<div class="line"><span class="lineno">  862</span>        <span class="keywordflow">if</span> rr_method <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  863</span>            <span class="keywordflow">if</span> dim_row_nullspace &lt;= small_nullspace:</div>
<div class="line"><span class="lineno">  864</span>                rr_res = _remove_redundancy_svd(A_eq, b_eq)</div>
<div class="line"><span class="lineno">  865</span>                A_eq, b_eq, status, message = rr_res</div>
<div class="line"><span class="lineno">  866</span>            <span class="keywordflow">if</span> dim_row_nullspace &gt; small_nullspace <span class="keywordflow">or</span> status == 4:</div>
<div class="line"><span class="lineno">  867</span>                rr_res = _remove_redundancy_pivot_dense(A_eq, b_eq)</div>
<div class="line"><span class="lineno">  868</span>                A_eq, b_eq, status, message = rr_res</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  871</span>            rr_method = rr_method.lower()</div>
<div class="line"><span class="lineno">  872</span>            <span class="keywordflow">if</span> rr_method == <span class="stringliteral">&quot;svd&quot;</span>:</div>
<div class="line"><span class="lineno">  873</span>                rr_res = _remove_redundancy_svd(A_eq, b_eq)</div>
<div class="line"><span class="lineno">  874</span>                A_eq, b_eq, status, message = rr_res</div>
<div class="line"><span class="lineno">  875</span>            <span class="keywordflow">elif</span> rr_method == <span class="stringliteral">&quot;pivot&quot;</span>:</div>
<div class="line"><span class="lineno">  876</span>                rr_res = _remove_redundancy_pivot_dense(A_eq, b_eq)</div>
<div class="line"><span class="lineno">  877</span>                A_eq, b_eq, status, message = rr_res</div>
<div class="line"><span class="lineno">  878</span>            <span class="keywordflow">elif</span> rr_method == <span class="stringliteral">&quot;id&quot;</span>:</div>
<div class="line"><span class="lineno">  879</span>                rr_res = _remove_redundancy_id(A_eq, b_eq, rank)</div>
<div class="line"><span class="lineno">  880</span>                A_eq, b_eq, status, message = rr_res</div>
<div class="line"><span class="lineno">  881</span>            <span class="keywordflow">else</span>:  <span class="comment"># shouldn&#39;t get here; option validity checked above</span></div>
<div class="line"><span class="lineno">  882</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  883</span>        <span class="keywordflow">if</span> A_eq.shape[0] &lt; rank:</div>
<div class="line"><span class="lineno">  884</span>            message = (<span class="stringliteral">&quot;Due to numerical issues, redundant equality &quot;</span></div>
<div class="line"><span class="lineno">  885</span>                       <span class="stringliteral">&quot;constraints could not be removed automatically. &quot;</span></div>
<div class="line"><span class="lineno">  886</span>                       <span class="stringliteral">&quot;Try providing your constraint matrices as sparse &quot;</span></div>
<div class="line"><span class="lineno">  887</span>                       <span class="stringliteral">&quot;matrices to activate sparse presolve, try turning &quot;</span></div>
<div class="line"><span class="lineno">  888</span>                       <span class="stringliteral">&quot;off redundancy removal, or try turning off presolve &quot;</span></div>
<div class="line"><span class="lineno">  889</span>                       <span class="stringliteral">&quot;altogether.&quot;</span>)</div>
<div class="line"><span class="lineno">  890</span>            status = 4</div>
<div class="line"><span class="lineno">  891</span>        <span class="keywordflow">if</span> status != 0:</div>
<div class="line"><span class="lineno">  892</span>            complete = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  893</span>    <span class="keywordflow">return</span> (_LPProblem(c, A_ub, b_ub, A_eq, b_eq, bounds, x0),</div>
<div class="line"><span class="lineno">  894</span>            c0, x, revstack, complete, status, message)</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a55bc22e9bb6c5b9dd4c62a0a7dc5cedb" name="a55bc22e9bb6c5b9dd4c62a0a7dc5cedb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55bc22e9bb6c5b9dd4c62a0a7dc5cedb">&#9670;&#160;</a></span>_round_to_power_of_two()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._round_to_power_of_two </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Round elements of the array to the nearest power of two.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1206</span><span class="keyword">def </span>_round_to_power_of_two(x):</div>
<div class="line"><span class="lineno"> 1207</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1208</span><span class="stringliteral">    Round elements of the array to the nearest power of two.</span></div>
<div class="line"><span class="lineno"> 1209</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1210</span>    <span class="keywordflow">return</span> 2**np.around(np.log2(x))</div>
<div class="line"><span class="lineno"> 1211</span> </div>
<div class="line"><span class="lineno"> 1212</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6f8c9ceb59b192885e431e6f8149ff3" name="ac6f8c9ceb59b192885e431e6f8149ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6f8c9ceb59b192885e431e6f8149ff3">&#9670;&#160;</a></span>_unscale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._unscale </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b_scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Converts solution to _autoscale problem -&gt; solution to original problem.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1251</span><span class="keyword">def </span>_unscale(x, C, b_scale):</div>
<div class="line"><span class="lineno"> 1252</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral">    Converts solution to _autoscale problem -&gt; solution to original problem.</span></div>
<div class="line"><span class="lineno"> 1254</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1255</span> </div>
<div class="line"><span class="lineno"> 1256</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1257</span>        n = len(C)</div>
<div class="line"><span class="lineno"> 1258</span>        <span class="comment"># fails if sparse or scalar; that&#39;s OK.</span></div>
<div class="line"><span class="lineno"> 1259</span>        <span class="comment"># this is only needed for original simplex (never sparse)</span></div>
<div class="line"><span class="lineno"> 1260</span>    <span class="keywordflow">except</span> TypeError:</div>
<div class="line"><span class="lineno"> 1261</span>        n = len(x)</div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>    <span class="keywordflow">return</span> x[:n]*b_scale*C</div>
<div class="line"><span class="lineno"> 1264</span> </div>
<div class="line"><span class="lineno"> 1265</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a808d02fa01f0c96f42ef31e290a7f486" name="a808d02fa01f0c96f42ef31e290a7f486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a808d02fa01f0c96f42ef31e290a7f486">&#9670;&#160;</a></span>_LPProblem</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_util._LPProblem</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  namedtuple(<span class="stringliteral">&#39;_LPProblem&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>                        <span class="stringliteral">&#39;c A_ub b_ub A_eq b_eq bounds x0 integrality&#39;</span>)</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
