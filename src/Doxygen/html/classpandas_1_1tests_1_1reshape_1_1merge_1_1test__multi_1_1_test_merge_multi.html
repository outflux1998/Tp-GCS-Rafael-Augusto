<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.tests.reshape.merge.test_multi.TestMergeMulti Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape.html">reshape</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge.html">merge</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__multi.html">test_multi</a></li><li class="navelem"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html">TestMergeMulti</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">pandas.tests.reshape.merge.test_multi.TestMergeMulti Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a07cf19e03b6676c5deb8408395611e46" id="r_a07cf19e03b6676c5deb8408395611e46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a07cf19e03b6676c5deb8408395611e46">test_merge_on_multikey</a> (self, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__multi.html#a4abb52e89ab9cb930ceb73d69ed3409b">left</a>, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__multi.html#afc05bbc2f6871ada1407be484b653579">right</a>, join_type)</td></tr>
<tr class="separator:a07cf19e03b6676c5deb8408395611e46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc18588301989ab90a182c6ed8db3487" id="r_abc18588301989ab90a182c6ed8db3487"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#abc18588301989ab90a182c6ed8db3487">test_left_join_multi_index</a> (self, sort)</td></tr>
<tr class="separator:abc18588301989ab90a182c6ed8db3487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfc71f27987493fc883539f6b37b8ef4" id="r_adfc71f27987493fc883539f6b37b8ef4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#adfc71f27987493fc883539f6b37b8ef4">test_merge_right_vs_left</a> (self, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__multi.html#a4abb52e89ab9cb930ceb73d69ed3409b">left</a>, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__multi.html#afc05bbc2f6871ada1407be484b653579">right</a>, sort)</td></tr>
<tr class="separator:adfc71f27987493fc883539f6b37b8ef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afca1f5457aaf4fc89430d8ad4cbdf094" id="r_afca1f5457aaf4fc89430d8ad4cbdf094"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#afca1f5457aaf4fc89430d8ad4cbdf094">test_merge_multiple_cols_with_mixed_cols_index</a> (self)</td></tr>
<tr class="separator:afca1f5457aaf4fc89430d8ad4cbdf094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2166c5fec3fe628a645ab82d353f9412" id="r_a2166c5fec3fe628a645ab82d353f9412"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a2166c5fec3fe628a645ab82d353f9412">test_compress_group_combinations</a> (self)</td></tr>
<tr class="separator:a2166c5fec3fe628a645ab82d353f9412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56f8e67aae003d4e4841719f83f22cf8" id="r_a56f8e67aae003d4e4841719f83f22cf8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a56f8e67aae003d4e4841719f83f22cf8">test_left_join_index_preserve_order</a> (self)</td></tr>
<tr class="separator:a56f8e67aae003d4e4841719f83f22cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15b40cfa320a23a01bee6f914c1d54b" id="r_af15b40cfa320a23a01bee6f914c1d54b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#af15b40cfa320a23a01bee6f914c1d54b">test_left_join_index_multi_match_multiindex</a> (self)</td></tr>
<tr class="separator:af15b40cfa320a23a01bee6f914c1d54b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543cb2cdcece8b1ce7f1d0675cb91031" id="r_a543cb2cdcece8b1ce7f1d0675cb91031"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a543cb2cdcece8b1ce7f1d0675cb91031">test_left_join_index_multi_match</a> (self)</td></tr>
<tr class="separator:a543cb2cdcece8b1ce7f1d0675cb91031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ad7ea3ec265a99d66d954f15e7ae69" id="r_ae9ad7ea3ec265a99d66d954f15e7ae69"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#ae9ad7ea3ec265a99d66d954f15e7ae69">test_left_merge_na_buglet</a> (self)</td></tr>
<tr class="separator:ae9ad7ea3ec265a99d66d954f15e7ae69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04a22f52f280abb684cc41a73e188d01" id="r_a04a22f52f280abb684cc41a73e188d01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a04a22f52f280abb684cc41a73e188d01">test_merge_na_keys</a> (self)</td></tr>
<tr class="separator:a04a22f52f280abb684cc41a73e188d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0050d55daa4efa8ec38abea9544908f1" id="r_a0050d55daa4efa8ec38abea9544908f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a0050d55daa4efa8ec38abea9544908f1">test_merge_datetime_index</a> (self, klass)</td></tr>
<tr class="separator:a0050d55daa4efa8ec38abea9544908f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52496277d8ed927e357de8dc54754e08" id="r_a52496277d8ed927e357de8dc54754e08"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a52496277d8ed927e357de8dc54754e08">test_merge_datetime_multi_index_empty_df</a> (self, merge_type)</td></tr>
<tr class="separator:a52496277d8ed927e357de8dc54754e08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca3a6b1f5667f61561a645d2fda3e30" id="r_a2ca3a6b1f5667f61561a645d2fda3e30"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a2ca3a6b1f5667f61561a645d2fda3e30">household</a> (self)</td></tr>
<tr class="separator:a2ca3a6b1f5667f61561a645d2fda3e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a459b5a8f7dcc84bcd2442f4e641610ee" id="r_a459b5a8f7dcc84bcd2442f4e641610ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a459b5a8f7dcc84bcd2442f4e641610ee">portfolio</a> (self)</td></tr>
<tr class="separator:a459b5a8f7dcc84bcd2442f4e641610ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada675e9598f518f1cc9cf8238f841ba6" id="r_ada675e9598f518f1cc9cf8238f841ba6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#ada675e9598f518f1cc9cf8238f841ba6">expected</a> (self)</td></tr>
<tr class="separator:ada675e9598f518f1cc9cf8238f841ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a036902cacf019b1e891afcd07a6d9971" id="r_a036902cacf019b1e891afcd07a6d9971"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a036902cacf019b1e891afcd07a6d9971">test_join_multi_levels</a> (self, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a459b5a8f7dcc84bcd2442f4e641610ee">portfolio</a>, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a2ca3a6b1f5667f61561a645d2fda3e30">household</a>, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#ada675e9598f518f1cc9cf8238f841ba6">expected</a>)</td></tr>
<tr class="separator:a036902cacf019b1e891afcd07a6d9971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ed359cf96fdf761d710d57b7cda795f" id="r_a5ed359cf96fdf761d710d57b7cda795f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a5ed359cf96fdf761d710d57b7cda795f">test_join_multi_levels_merge_equivalence</a> (self, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a459b5a8f7dcc84bcd2442f4e641610ee">portfolio</a>, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a2ca3a6b1f5667f61561a645d2fda3e30">household</a>, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#ada675e9598f518f1cc9cf8238f841ba6">expected</a>)</td></tr>
<tr class="separator:a5ed359cf96fdf761d710d57b7cda795f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd79e97473d89e241177b1b653c13dd" id="r_a9bd79e97473d89e241177b1b653c13dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a9bd79e97473d89e241177b1b653c13dd">test_join_multi_levels_outer</a> (self, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a459b5a8f7dcc84bcd2442f4e641610ee">portfolio</a>, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a2ca3a6b1f5667f61561a645d2fda3e30">household</a>, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#ada675e9598f518f1cc9cf8238f841ba6">expected</a>)</td></tr>
<tr class="separator:a9bd79e97473d89e241177b1b653c13dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e4cbe4a4aca3603cd906f410afbd77" id="r_a99e4cbe4a4aca3603cd906f410afbd77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a99e4cbe4a4aca3603cd906f410afbd77">test_join_multi_levels_invalid</a> (self, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a459b5a8f7dcc84bcd2442f4e641610ee">portfolio</a>, <a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#a2ca3a6b1f5667f61561a645d2fda3e30">household</a>)</td></tr>
<tr class="separator:a99e4cbe4a4aca3603cd906f410afbd77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2beda743094b00f83c1df6eb1c5e46a" id="r_ab2beda743094b00f83c1df6eb1c5e46a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__multi_1_1_test_merge_multi.html#ab2beda743094b00f83c1df6eb1c5e46a">test_join_multi_levels2</a> (self)</td></tr>
<tr class="separator:ab2beda743094b00f83c1df6eb1c5e46a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ada675e9598f518f1cc9cf8238f841ba6" name="ada675e9598f518f1cc9cf8238f841ba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada675e9598f518f1cc9cf8238f841ba6">&#9670;&#160;</a></span>expected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.expected </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  545</span>    <span class="keyword">def </span>expected(self):</div>
<div class="line"><span class="lineno">  546</span>        expected = (</div>
<div class="line"><span class="lineno">  547</span>            DataFrame(</div>
<div class="line"><span class="lineno">  548</span>                {</div>
<div class="line"><span class="lineno">  549</span>                    <span class="stringliteral">&quot;male&quot;</span>: [0, 1, 1, 0, 0, 0],</div>
<div class="line"><span class="lineno">  550</span>                    <span class="stringliteral">&quot;wealth&quot;</span>: [</div>
<div class="line"><span class="lineno">  551</span>                        196087.3,</div>
<div class="line"><span class="lineno">  552</span>                        316478.7,</div>
<div class="line"><span class="lineno">  553</span>                        316478.7,</div>
<div class="line"><span class="lineno">  554</span>                        294750.0,</div>
<div class="line"><span class="lineno">  555</span>                        294750.0,</div>
<div class="line"><span class="lineno">  556</span>                        294750.0,</div>
<div class="line"><span class="lineno">  557</span>                    ],</div>
<div class="line"><span class="lineno">  558</span>                    <span class="stringliteral">&quot;name&quot;</span>: [</div>
<div class="line"><span class="lineno">  559</span>                        <span class="stringliteral">&quot;ABN Amro&quot;</span>,</div>
<div class="line"><span class="lineno">  560</span>                        <span class="stringliteral">&quot;Robeco&quot;</span>,</div>
<div class="line"><span class="lineno">  561</span>                        <span class="stringliteral">&quot;Royal Dutch Shell&quot;</span>,</div>
<div class="line"><span class="lineno">  562</span>                        <span class="stringliteral">&quot;Royal Dutch Shell&quot;</span>,</div>
<div class="line"><span class="lineno">  563</span>                        <span class="stringliteral">&quot;AAB Eastern Europe Equity Fund&quot;</span>,</div>
<div class="line"><span class="lineno">  564</span>                        <span class="stringliteral">&quot;Postbank BioTech Fonds&quot;</span>,</div>
<div class="line"><span class="lineno">  565</span>                    ],</div>
<div class="line"><span class="lineno">  566</span>                    <span class="stringliteral">&quot;share&quot;</span>: [1.00, 0.40, 0.60, 0.15, 0.60, 0.25],</div>
<div class="line"><span class="lineno">  567</span>                    <span class="stringliteral">&quot;household_id&quot;</span>: [1, 2, 2, 3, 3, 3],</div>
<div class="line"><span class="lineno">  568</span>                    <span class="stringliteral">&quot;asset_id&quot;</span>: [</div>
<div class="line"><span class="lineno">  569</span>                        <span class="stringliteral">&quot;nl0000301109&quot;</span>,</div>
<div class="line"><span class="lineno">  570</span>                        <span class="stringliteral">&quot;nl0000289783&quot;</span>,</div>
<div class="line"><span class="lineno">  571</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  572</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  573</span>                        <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  574</span>                        <span class="stringliteral">&quot;nl0000289965&quot;</span>,</div>
<div class="line"><span class="lineno">  575</span>                    ],</div>
<div class="line"><span class="lineno">  576</span>                }</div>
<div class="line"><span class="lineno">  577</span>            )</div>
<div class="line"><span class="lineno">  578</span>            .set_index([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>])</div>
<div class="line"><span class="lineno">  579</span>            .reindex(columns=[<span class="stringliteral">&quot;male&quot;</span>, <span class="stringliteral">&quot;wealth&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;share&quot;</span>])</div>
<div class="line"><span class="lineno">  580</span>        )</div>
<div class="line"><span class="lineno">  581</span>        <span class="keywordflow">return</span> expected</div>
<div class="line"><span class="lineno">  582</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ca3a6b1f5667f61561a645d2fda3e30" name="a2ca3a6b1f5667f61561a645d2fda3e30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ca3a6b1f5667f61561a645d2fda3e30">&#9670;&#160;</a></span>household()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.household </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  504</span>    <span class="keyword">def </span>household(self):</div>
<div class="line"><span class="lineno">  505</span>        household = DataFrame(</div>
<div class="line"><span class="lineno">  506</span>            {</div>
<div class="line"><span class="lineno">  507</span>                <span class="stringliteral">&quot;household_id&quot;</span>: [1, 2, 3],</div>
<div class="line"><span class="lineno">  508</span>                <span class="stringliteral">&quot;male&quot;</span>: [0, 1, 0],</div>
<div class="line"><span class="lineno">  509</span>                <span class="stringliteral">&quot;wealth&quot;</span>: [196087.3, 316478.7, 294750],</div>
<div class="line"><span class="lineno">  510</span>            },</div>
<div class="line"><span class="lineno">  511</span>            columns=[<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;male&quot;</span>, <span class="stringliteral">&quot;wealth&quot;</span>],</div>
<div class="line"><span class="lineno">  512</span>        ).set_index(<span class="stringliteral">&quot;household_id&quot;</span>)</div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">return</span> household</div>
<div class="line"><span class="lineno">  514</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a459b5a8f7dcc84bcd2442f4e641610ee" name="a459b5a8f7dcc84bcd2442f4e641610ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a459b5a8f7dcc84bcd2442f4e641610ee">&#9670;&#160;</a></span>portfolio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.portfolio </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  516</span>    <span class="keyword">def </span>portfolio(self):</div>
<div class="line"><span class="lineno">  517</span>        portfolio = DataFrame(</div>
<div class="line"><span class="lineno">  518</span>            {</div>
<div class="line"><span class="lineno">  519</span>                <span class="stringliteral">&quot;household_id&quot;</span>: [1, 2, 2, 3, 3, 3, 4],</div>
<div class="line"><span class="lineno">  520</span>                <span class="stringliteral">&quot;asset_id&quot;</span>: [</div>
<div class="line"><span class="lineno">  521</span>                    <span class="stringliteral">&quot;nl0000301109&quot;</span>,</div>
<div class="line"><span class="lineno">  522</span>                    <span class="stringliteral">&quot;nl0000289783&quot;</span>,</div>
<div class="line"><span class="lineno">  523</span>                    <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  524</span>                    <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  525</span>                    <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  526</span>                    <span class="stringliteral">&quot;nl0000289965&quot;</span>,</div>
<div class="line"><span class="lineno">  527</span>                    np.nan,</div>
<div class="line"><span class="lineno">  528</span>                ],</div>
<div class="line"><span class="lineno">  529</span>                <span class="stringliteral">&quot;name&quot;</span>: [</div>
<div class="line"><span class="lineno">  530</span>                    <span class="stringliteral">&quot;ABN Amro&quot;</span>,</div>
<div class="line"><span class="lineno">  531</span>                    <span class="stringliteral">&quot;Robeco&quot;</span>,</div>
<div class="line"><span class="lineno">  532</span>                    <span class="stringliteral">&quot;Royal Dutch Shell&quot;</span>,</div>
<div class="line"><span class="lineno">  533</span>                    <span class="stringliteral">&quot;Royal Dutch Shell&quot;</span>,</div>
<div class="line"><span class="lineno">  534</span>                    <span class="stringliteral">&quot;AAB Eastern Europe Equity Fund&quot;</span>,</div>
<div class="line"><span class="lineno">  535</span>                    <span class="stringliteral">&quot;Postbank BioTech Fonds&quot;</span>,</div>
<div class="line"><span class="lineno">  536</span>                    np.nan,</div>
<div class="line"><span class="lineno">  537</span>                ],</div>
<div class="line"><span class="lineno">  538</span>                <span class="stringliteral">&quot;share&quot;</span>: [1.0, 0.4, 0.6, 0.15, 0.6, 0.25, 1.0],</div>
<div class="line"><span class="lineno">  539</span>            },</div>
<div class="line"><span class="lineno">  540</span>            columns=[<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;share&quot;</span>],</div>
<div class="line"><span class="lineno">  541</span>        ).set_index([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>])</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">return</span> portfolio</div>
<div class="line"><span class="lineno">  543</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2166c5fec3fe628a645ab82d353f9412" name="a2166c5fec3fe628a645ab82d353f9412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2166c5fec3fe628a645ab82d353f9412">&#9670;&#160;</a></span>test_compress_group_combinations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_compress_group_combinations </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  186</span>    <span class="keyword">def </span>test_compress_group_combinations(self):</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>        <span class="comment"># ~ 40000000 possible unique groups</span></div>
<div class="line"><span class="lineno">  189</span>        key1 = tm.rands_array(10, 10000)</div>
<div class="line"><span class="lineno">  190</span>        key1 = np.tile(key1, 2)</div>
<div class="line"><span class="lineno">  191</span>        key2 = key1[::-1]</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>        df = DataFrame({<span class="stringliteral">&quot;key1&quot;</span>: key1, <span class="stringliteral">&quot;key2&quot;</span>: key2, <span class="stringliteral">&quot;value1&quot;</span>: np.random.randn(20000)})</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>        df2 = DataFrame(</div>
<div class="line"><span class="lineno">  196</span>            {<span class="stringliteral">&quot;key1&quot;</span>: key1[::2], <span class="stringliteral">&quot;key2&quot;</span>: key2[::2], <span class="stringliteral">&quot;value2&quot;</span>: np.random.randn(10000)}</div>
<div class="line"><span class="lineno">  197</span>        )</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>        <span class="comment"># just to hit the label compression code path</span></div>
<div class="line"><span class="lineno">  200</span>        merge(df, df2, how=<span class="stringliteral">&quot;outer&quot;</span>)</div>
<div class="line"><span class="lineno">  201</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a036902cacf019b1e891afcd07a6d9971" name="a036902cacf019b1e891afcd07a6d9971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a036902cacf019b1e891afcd07a6d9971">&#9670;&#160;</a></span>test_join_multi_levels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_join_multi_levels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>portfolio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>household</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  583</span>    <span class="keyword">def </span>test_join_multi_levels(self, portfolio, household, expected):</div>
<div class="line"><span class="lineno">  584</span>        portfolio = portfolio.copy()</div>
<div class="line"><span class="lineno">  585</span>        household = household.copy()</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>        <span class="comment"># GH 3662</span></div>
<div class="line"><span class="lineno">  588</span>        <span class="comment"># merge multi-levels</span></div>
<div class="line"><span class="lineno">  589</span>        result = household.join(portfolio, how=<span class="stringliteral">&quot;inner&quot;</span>)</div>
<div class="line"><span class="lineno">  590</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  591</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2beda743094b00f83c1df6eb1c5e46a" name="ab2beda743094b00f83c1df6eb1c5e46a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2beda743094b00f83c1df6eb1c5e46a">&#9670;&#160;</a></span>test_join_multi_levels2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_join_multi_levels2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  645</span>    <span class="keyword">def </span>test_join_multi_levels2(self):</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>        <span class="comment"># some more advanced merges</span></div>
<div class="line"><span class="lineno">  648</span>        <span class="comment"># GH6360</span></div>
<div class="line"><span class="lineno">  649</span>        household = DataFrame(</div>
<div class="line"><span class="lineno">  650</span>            {</div>
<div class="line"><span class="lineno">  651</span>                <span class="stringliteral">&quot;household_id&quot;</span>: [1, 2, 2, 3, 3, 3, 4],</div>
<div class="line"><span class="lineno">  652</span>                <span class="stringliteral">&quot;asset_id&quot;</span>: [</div>
<div class="line"><span class="lineno">  653</span>                    <span class="stringliteral">&quot;nl0000301109&quot;</span>,</div>
<div class="line"><span class="lineno">  654</span>                    <span class="stringliteral">&quot;nl0000301109&quot;</span>,</div>
<div class="line"><span class="lineno">  655</span>                    <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  656</span>                    <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  657</span>                    <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  658</span>                    <span class="stringliteral">&quot;nl0000289965&quot;</span>,</div>
<div class="line"><span class="lineno">  659</span>                    np.nan,</div>
<div class="line"><span class="lineno">  660</span>                ],</div>
<div class="line"><span class="lineno">  661</span>                <span class="stringliteral">&quot;share&quot;</span>: [1.0, 0.4, 0.6, 0.15, 0.6, 0.25, 1.0],</div>
<div class="line"><span class="lineno">  662</span>            },</div>
<div class="line"><span class="lineno">  663</span>            columns=[<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>, <span class="stringliteral">&quot;share&quot;</span>],</div>
<div class="line"><span class="lineno">  664</span>        ).set_index([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>])</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>        log_return = DataFrame(</div>
<div class="line"><span class="lineno">  667</span>            {</div>
<div class="line"><span class="lineno">  668</span>                <span class="stringliteral">&quot;asset_id&quot;</span>: [</div>
<div class="line"><span class="lineno">  669</span>                    <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  670</span>                    <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  671</span>                    <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  672</span>                    <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  673</span>                    <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  674</span>                ],</div>
<div class="line"><span class="lineno">  675</span>                <span class="stringliteral">&quot;t&quot;</span>: [233, 234, 235, 180, 181],</div>
<div class="line"><span class="lineno">  676</span>                <span class="stringliteral">&quot;log_return&quot;</span>: [</div>
<div class="line"><span class="lineno">  677</span>                    0.09604978,</div>
<div class="line"><span class="lineno">  678</span>                    -0.06524096,</div>
<div class="line"><span class="lineno">  679</span>                    0.03532373,</div>
<div class="line"><span class="lineno">  680</span>                    0.03025441,</div>
<div class="line"><span class="lineno">  681</span>                    0.036997,</div>
<div class="line"><span class="lineno">  682</span>                ],</div>
<div class="line"><span class="lineno">  683</span>            }</div>
<div class="line"><span class="lineno">  684</span>        ).set_index([<span class="stringliteral">&quot;asset_id&quot;</span>, <span class="stringliteral">&quot;t&quot;</span>])</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>        expected = (</div>
<div class="line"><span class="lineno">  687</span>            DataFrame(</div>
<div class="line"><span class="lineno">  688</span>                {</div>
<div class="line"><span class="lineno">  689</span>                    <span class="stringliteral">&quot;household_id&quot;</span>: [2, 2, 2, 3, 3, 3, 3, 3],</div>
<div class="line"><span class="lineno">  690</span>                    <span class="stringliteral">&quot;asset_id&quot;</span>: [</div>
<div class="line"><span class="lineno">  691</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  692</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  693</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  694</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  695</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  696</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  697</span>                        <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  698</span>                        <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  699</span>                    ],</div>
<div class="line"><span class="lineno">  700</span>                    <span class="stringliteral">&quot;t&quot;</span>: [233, 234, 235, 233, 234, 235, 180, 181],</div>
<div class="line"><span class="lineno">  701</span>                    <span class="stringliteral">&quot;share&quot;</span>: [0.6, 0.6, 0.6, 0.15, 0.15, 0.15, 0.6, 0.6],</div>
<div class="line"><span class="lineno">  702</span>                    <span class="stringliteral">&quot;log_return&quot;</span>: [</div>
<div class="line"><span class="lineno">  703</span>                        0.09604978,</div>
<div class="line"><span class="lineno">  704</span>                        -0.06524096,</div>
<div class="line"><span class="lineno">  705</span>                        0.03532373,</div>
<div class="line"><span class="lineno">  706</span>                        0.09604978,</div>
<div class="line"><span class="lineno">  707</span>                        -0.06524096,</div>
<div class="line"><span class="lineno">  708</span>                        0.03532373,</div>
<div class="line"><span class="lineno">  709</span>                        0.03025441,</div>
<div class="line"><span class="lineno">  710</span>                        0.036997,</div>
<div class="line"><span class="lineno">  711</span>                    ],</div>
<div class="line"><span class="lineno">  712</span>                }</div>
<div class="line"><span class="lineno">  713</span>            )</div>
<div class="line"><span class="lineno">  714</span>            .set_index([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>, <span class="stringliteral">&quot;t&quot;</span>])</div>
<div class="line"><span class="lineno">  715</span>            .reindex(columns=[<span class="stringliteral">&quot;share&quot;</span>, <span class="stringliteral">&quot;log_return&quot;</span>])</div>
<div class="line"><span class="lineno">  716</span>        )</div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>        <span class="comment"># this is the equivalency</span></div>
<div class="line"><span class="lineno">  719</span>        result = merge(</div>
<div class="line"><span class="lineno">  720</span>            household.reset_index(),</div>
<div class="line"><span class="lineno">  721</span>            log_return.reset_index(),</div>
<div class="line"><span class="lineno">  722</span>            on=[<span class="stringliteral">&quot;asset_id&quot;</span>],</div>
<div class="line"><span class="lineno">  723</span>            how=<span class="stringliteral">&quot;inner&quot;</span>,</div>
<div class="line"><span class="lineno">  724</span>        ).set_index([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>, <span class="stringliteral">&quot;t&quot;</span>])</div>
<div class="line"><span class="lineno">  725</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>        expected = (</div>
<div class="line"><span class="lineno">  728</span>            DataFrame(</div>
<div class="line"><span class="lineno">  729</span>                {</div>
<div class="line"><span class="lineno">  730</span>                    <span class="stringliteral">&quot;household_id&quot;</span>: [1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4],</div>
<div class="line"><span class="lineno">  731</span>                    <span class="stringliteral">&quot;asset_id&quot;</span>: [</div>
<div class="line"><span class="lineno">  732</span>                        <span class="stringliteral">&quot;nl0000301109&quot;</span>,</div>
<div class="line"><span class="lineno">  733</span>                        <span class="stringliteral">&quot;nl0000301109&quot;</span>,</div>
<div class="line"><span class="lineno">  734</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  735</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  736</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  737</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  738</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  739</span>                        <span class="stringliteral">&quot;gb00b03mlx29&quot;</span>,</div>
<div class="line"><span class="lineno">  740</span>                        <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  741</span>                        <span class="stringliteral">&quot;lu0197800237&quot;</span>,</div>
<div class="line"><span class="lineno">  742</span>                        <span class="stringliteral">&quot;nl0000289965&quot;</span>,</div>
<div class="line"><span class="lineno">  743</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  744</span>                    ],</div>
<div class="line"><span class="lineno">  745</span>                    <span class="stringliteral">&quot;t&quot;</span>: [</div>
<div class="line"><span class="lineno">  746</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  747</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  748</span>                        233,</div>
<div class="line"><span class="lineno">  749</span>                        234,</div>
<div class="line"><span class="lineno">  750</span>                        235,</div>
<div class="line"><span class="lineno">  751</span>                        233,</div>
<div class="line"><span class="lineno">  752</span>                        234,</div>
<div class="line"><span class="lineno">  753</span>                        235,</div>
<div class="line"><span class="lineno">  754</span>                        180,</div>
<div class="line"><span class="lineno">  755</span>                        181,</div>
<div class="line"><span class="lineno">  756</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  757</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  758</span>                    ],</div>
<div class="line"><span class="lineno">  759</span>                    <span class="stringliteral">&quot;share&quot;</span>: [</div>
<div class="line"><span class="lineno">  760</span>                        1.0,</div>
<div class="line"><span class="lineno">  761</span>                        0.4,</div>
<div class="line"><span class="lineno">  762</span>                        0.6,</div>
<div class="line"><span class="lineno">  763</span>                        0.6,</div>
<div class="line"><span class="lineno">  764</span>                        0.6,</div>
<div class="line"><span class="lineno">  765</span>                        0.15,</div>
<div class="line"><span class="lineno">  766</span>                        0.15,</div>
<div class="line"><span class="lineno">  767</span>                        0.15,</div>
<div class="line"><span class="lineno">  768</span>                        0.6,</div>
<div class="line"><span class="lineno">  769</span>                        0.6,</div>
<div class="line"><span class="lineno">  770</span>                        0.25,</div>
<div class="line"><span class="lineno">  771</span>                        1.0,</div>
<div class="line"><span class="lineno">  772</span>                    ],</div>
<div class="line"><span class="lineno">  773</span>                    <span class="stringliteral">&quot;log_return&quot;</span>: [</div>
<div class="line"><span class="lineno">  774</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  775</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  776</span>                        0.09604978,</div>
<div class="line"><span class="lineno">  777</span>                        -0.06524096,</div>
<div class="line"><span class="lineno">  778</span>                        0.03532373,</div>
<div class="line"><span class="lineno">  779</span>                        0.09604978,</div>
<div class="line"><span class="lineno">  780</span>                        -0.06524096,</div>
<div class="line"><span class="lineno">  781</span>                        0.03532373,</div>
<div class="line"><span class="lineno">  782</span>                        0.03025441,</div>
<div class="line"><span class="lineno">  783</span>                        0.036997,</div>
<div class="line"><span class="lineno">  784</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  785</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  786</span>                    ],</div>
<div class="line"><span class="lineno">  787</span>                }</div>
<div class="line"><span class="lineno">  788</span>            )</div>
<div class="line"><span class="lineno">  789</span>            .set_index([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>, <span class="stringliteral">&quot;t&quot;</span>])</div>
<div class="line"><span class="lineno">  790</span>            .reindex(columns=[<span class="stringliteral">&quot;share&quot;</span>, <span class="stringliteral">&quot;log_return&quot;</span>])</div>
<div class="line"><span class="lineno">  791</span>        )</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>        result = merge(</div>
<div class="line"><span class="lineno">  794</span>            household.reset_index(),</div>
<div class="line"><span class="lineno">  795</span>            log_return.reset_index(),</div>
<div class="line"><span class="lineno">  796</span>            on=[<span class="stringliteral">&quot;asset_id&quot;</span>],</div>
<div class="line"><span class="lineno">  797</span>            how=<span class="stringliteral">&quot;outer&quot;</span>,</div>
<div class="line"><span class="lineno">  798</span>        ).set_index([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>, <span class="stringliteral">&quot;t&quot;</span>])</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a99e4cbe4a4aca3603cd906f410afbd77" name="a99e4cbe4a4aca3603cd906f410afbd77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99e4cbe4a4aca3603cd906f410afbd77">&#9670;&#160;</a></span>test_join_multi_levels_invalid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_join_multi_levels_invalid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>portfolio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>household</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  627</span>    <span class="keyword">def </span>test_join_multi_levels_invalid(self, portfolio, household):</div>
<div class="line"><span class="lineno">  628</span>        portfolio = portfolio.copy()</div>
<div class="line"><span class="lineno">  629</span>        household = household.copy()</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>        <span class="comment"># invalid cases</span></div>
<div class="line"><span class="lineno">  632</span>        household.index.name = <span class="stringliteral">&quot;foo&quot;</span></div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>        <span class="keyword">with</span> pytest.raises(</div>
<div class="line"><span class="lineno">  635</span>            ValueError, match=<span class="stringliteral">&quot;cannot join with no overlapping index names&quot;</span></div>
<div class="line"><span class="lineno">  636</span>        ):</div>
<div class="line"><span class="lineno">  637</span>            household.join(portfolio, how=<span class="stringliteral">&quot;inner&quot;</span>)</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>        portfolio2 = portfolio.copy()</div>
<div class="line"><span class="lineno">  640</span>        portfolio2.index.set_names([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>])</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;columns overlap but no suffix specified&quot;</span>):</div>
<div class="line"><span class="lineno">  643</span>            portfolio2.join(portfolio, how=<span class="stringliteral">&quot;inner&quot;</span>)</div>
<div class="line"><span class="lineno">  644</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ed359cf96fdf761d710d57b7cda795f" name="a5ed359cf96fdf761d710d57b7cda795f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ed359cf96fdf761d710d57b7cda795f">&#9670;&#160;</a></span>test_join_multi_levels_merge_equivalence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_join_multi_levels_merge_equivalence </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>portfolio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>household</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  592</span>    <span class="keyword">def </span>test_join_multi_levels_merge_equivalence(self, portfolio, household, expected):</div>
<div class="line"><span class="lineno">  593</span>        portfolio = portfolio.copy()</div>
<div class="line"><span class="lineno">  594</span>        household = household.copy()</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>        <span class="comment"># equivalency</span></div>
<div class="line"><span class="lineno">  597</span>        result = merge(</div>
<div class="line"><span class="lineno">  598</span>            household.reset_index(),</div>
<div class="line"><span class="lineno">  599</span>            portfolio.reset_index(),</div>
<div class="line"><span class="lineno">  600</span>            on=[<span class="stringliteral">&quot;household_id&quot;</span>],</div>
<div class="line"><span class="lineno">  601</span>            how=<span class="stringliteral">&quot;inner&quot;</span>,</div>
<div class="line"><span class="lineno">  602</span>        ).set_index([<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>])</div>
<div class="line"><span class="lineno">  603</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  604</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bd79e97473d89e241177b1b653c13dd" name="a9bd79e97473d89e241177b1b653c13dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bd79e97473d89e241177b1b653c13dd">&#9670;&#160;</a></span>test_join_multi_levels_outer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_join_multi_levels_outer </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>portfolio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>household</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  605</span>    <span class="keyword">def </span>test_join_multi_levels_outer(self, portfolio, household, expected):</div>
<div class="line"><span class="lineno">  606</span>        portfolio = portfolio.copy()</div>
<div class="line"><span class="lineno">  607</span>        household = household.copy()</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>        result = household.join(portfolio, how=<span class="stringliteral">&quot;outer&quot;</span>)</div>
<div class="line"><span class="lineno">  610</span>        expected = concat(</div>
<div class="line"><span class="lineno">  611</span>            [</div>
<div class="line"><span class="lineno">  612</span>                expected,</div>
<div class="line"><span class="lineno">  613</span>                (</div>
<div class="line"><span class="lineno">  614</span>                    DataFrame(</div>
<div class="line"><span class="lineno">  615</span>                        {<span class="stringliteral">&quot;share&quot;</span>: [1.00]},</div>
<div class="line"><span class="lineno">  616</span>                        index=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno">  617</span>                            [(4, np.nan)], names=[<span class="stringliteral">&quot;household_id&quot;</span>, <span class="stringliteral">&quot;asset_id&quot;</span>]</div>
<div class="line"><span class="lineno">  618</span>                        ),</div>
<div class="line"><span class="lineno">  619</span>                    )</div>
<div class="line"><span class="lineno">  620</span>                ),</div>
<div class="line"><span class="lineno">  621</span>            ],</div>
<div class="line"><span class="lineno">  622</span>            axis=0,</div>
<div class="line"><span class="lineno">  623</span>            sort=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  624</span>        ).reindex(columns=expected.columns)</div>
<div class="line"><span class="lineno">  625</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  626</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a543cb2cdcece8b1ce7f1d0675cb91031" name="a543cb2cdcece8b1ce7f1d0675cb91031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a543cb2cdcece8b1ce7f1d0675cb91031">&#9670;&#160;</a></span>test_left_join_index_multi_match()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_left_join_index_multi_match </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  326</span>    <span class="keyword">def </span>test_left_join_index_multi_match(self):</div>
<div class="line"><span class="lineno">  327</span>        left = DataFrame(</div>
<div class="line"><span class="lineno">  328</span>            [[<span class="stringliteral">&quot;c&quot;</span>, 0], [<span class="stringliteral">&quot;b&quot;</span>, 1], [<span class="stringliteral">&quot;a&quot;</span>, 2], [<span class="stringliteral">&quot;b&quot;</span>, 3]],</div>
<div class="line"><span class="lineno">  329</span>            columns=[<span class="stringliteral">&quot;tag&quot;</span>, <span class="stringliteral">&quot;val&quot;</span>],</div>
<div class="line"><span class="lineno">  330</span>            index=[2, 0, 1, 3],</div>
<div class="line"><span class="lineno">  331</span>        )</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>        right = DataFrame(</div>
<div class="line"><span class="lineno">  334</span>            [</div>
<div class="line"><span class="lineno">  335</span>                [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;v&quot;</span>],</div>
<div class="line"><span class="lineno">  336</span>                [<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>],</div>
<div class="line"><span class="lineno">  337</span>                [<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>],</div>
<div class="line"><span class="lineno">  338</span>                [<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>],</div>
<div class="line"><span class="lineno">  339</span>                [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>],</div>
<div class="line"><span class="lineno">  340</span>                [<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>],</div>
<div class="line"><span class="lineno">  341</span>                [<span class="stringliteral">&quot;e&quot;</span>, <span class="stringliteral">&quot;q&quot;</span>],</div>
<div class="line"><span class="lineno">  342</span>                [<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;s&quot;</span>],</div>
<div class="line"><span class="lineno">  343</span>            ],</div>
<div class="line"><span class="lineno">  344</span>            columns=[<span class="stringliteral">&quot;tag&quot;</span>, <span class="stringliteral">&quot;char&quot;</span>],</div>
<div class="line"><span class="lineno">  345</span>        ).set_index(<span class="stringliteral">&quot;tag&quot;</span>)</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>        result = left.join(right, on=<span class="stringliteral">&quot;tag&quot;</span>, how=<span class="stringliteral">&quot;left&quot;</span>)</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno">  350</span>            [</div>
<div class="line"><span class="lineno">  351</span>                [<span class="stringliteral">&quot;c&quot;</span>, 0, <span class="stringliteral">&quot;w&quot;</span>],</div>
<div class="line"><span class="lineno">  352</span>                [<span class="stringliteral">&quot;c&quot;</span>, 0, <span class="stringliteral">&quot;x&quot;</span>],</div>
<div class="line"><span class="lineno">  353</span>                [<span class="stringliteral">&quot;c&quot;</span>, 0, <span class="stringliteral">&quot;r&quot;</span>],</div>
<div class="line"><span class="lineno">  354</span>                [<span class="stringliteral">&quot;c&quot;</span>, 0, <span class="stringliteral">&quot;s&quot;</span>],</div>
<div class="line"><span class="lineno">  355</span>                [<span class="stringliteral">&quot;b&quot;</span>, 1, np.nan],</div>
<div class="line"><span class="lineno">  356</span>                [<span class="stringliteral">&quot;a&quot;</span>, 2, <span class="stringliteral">&quot;v&quot;</span>],</div>
<div class="line"><span class="lineno">  357</span>                [<span class="stringliteral">&quot;a&quot;</span>, 2, <span class="stringliteral">&quot;z&quot;</span>],</div>
<div class="line"><span class="lineno">  358</span>                [<span class="stringliteral">&quot;b&quot;</span>, 3, np.nan],</div>
<div class="line"><span class="lineno">  359</span>            ],</div>
<div class="line"><span class="lineno">  360</span>            columns=[<span class="stringliteral">&quot;tag&quot;</span>, <span class="stringliteral">&quot;val&quot;</span>, <span class="stringliteral">&quot;char&quot;</span>],</div>
<div class="line"><span class="lineno">  361</span>            index=[2, 2, 2, 2, 0, 1, 1, 3],</div>
<div class="line"><span class="lineno">  362</span>        )</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>        result = left.join(right, on=<span class="stringliteral">&quot;tag&quot;</span>, how=<span class="stringliteral">&quot;left&quot;</span>, sort=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  367</span>        expected2 = expected.sort_values(<span class="stringliteral">&quot;tag&quot;</span>, kind=<span class="stringliteral">&quot;mergesort&quot;</span>)</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>        tm.assert_frame_equal(result, expected2)</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>        <span class="comment"># GH7331 - maintain left frame order in left merge</span></div>
<div class="line"><span class="lineno">  372</span>        result = merge(left, right.reset_index(), how=<span class="stringliteral">&quot;left&quot;</span>, on=<span class="stringliteral">&quot;tag&quot;</span>)</div>
<div class="line"><span class="lineno">  373</span>        expected.index = np.arange(len(expected))</div>
<div class="line"><span class="lineno">  374</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  375</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af15b40cfa320a23a01bee6f914c1d54b" name="af15b40cfa320a23a01bee6f914c1d54b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af15b40cfa320a23a01bee6f914c1d54b">&#9670;&#160;</a></span>test_left_join_index_multi_match_multiindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_left_join_index_multi_match_multiindex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  257</span>    <span class="keyword">def </span>test_left_join_index_multi_match_multiindex(self):</div>
<div class="line"><span class="lineno">  258</span>        left = DataFrame(</div>
<div class="line"><span class="lineno">  259</span>            [</div>
<div class="line"><span class="lineno">  260</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>],</div>
<div class="line"><span class="lineno">  261</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>],</div>
<div class="line"><span class="lineno">  262</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;h&quot;</span>],</div>
<div class="line"><span class="lineno">  263</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>],</div>
<div class="line"><span class="lineno">  264</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>],</div>
<div class="line"><span class="lineno">  265</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>],</div>
<div class="line"><span class="lineno">  266</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;f&quot;</span>],</div>
<div class="line"><span class="lineno">  267</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;g&quot;</span>],</div>
<div class="line"><span class="lineno">  268</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;j&quot;</span>],</div>
<div class="line"><span class="lineno">  269</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>],</div>
<div class="line"><span class="lineno">  270</span>            ],</div>
<div class="line"><span class="lineno">  271</span>            columns=[<span class="stringliteral">&quot;cola&quot;</span>, <span class="stringliteral">&quot;colb&quot;</span>, <span class="stringliteral">&quot;colc&quot;</span>, <span class="stringliteral">&quot;tag&quot;</span>],</div>
<div class="line"><span class="lineno">  272</span>            index=[3, 2, 0, 1, 7, 6, 4, 5, 9, 8],</div>
<div class="line"><span class="lineno">  273</span>        )</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>        right = DataFrame(</div>
<div class="line"><span class="lineno">  276</span>            [</div>
<div class="line"><span class="lineno">  277</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, 0],</div>
<div class="line"><span class="lineno">  278</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, 3],</div>
<div class="line"><span class="lineno">  279</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, 8],</div>
<div class="line"><span class="lineno">  280</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, 1],</div>
<div class="line"><span class="lineno">  281</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, 4],</div>
<div class="line"><span class="lineno">  282</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, 5],</div>
<div class="line"><span class="lineno">  283</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, 6],</div>
<div class="line"><span class="lineno">  284</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, 9],</div>
<div class="line"><span class="lineno">  285</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, -6],</div>
<div class="line"><span class="lineno">  286</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, -9],</div>
<div class="line"><span class="lineno">  287</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, 7],</div>
<div class="line"><span class="lineno">  288</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>, 2],</div>
<div class="line"><span class="lineno">  289</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>, -1],</div>
<div class="line"><span class="lineno">  290</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, -3],</div>
<div class="line"><span class="lineno">  291</span>            ],</div>
<div class="line"><span class="lineno">  292</span>            columns=[<span class="stringliteral">&quot;col1&quot;</span>, <span class="stringliteral">&quot;col2&quot;</span>, <span class="stringliteral">&quot;col3&quot;</span>, <span class="stringliteral">&quot;val&quot;</span>],</div>
<div class="line"><span class="lineno">  293</span>        ).set_index([<span class="stringliteral">&quot;col1&quot;</span>, <span class="stringliteral">&quot;col2&quot;</span>, <span class="stringliteral">&quot;col3&quot;</span>])</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>        result = left.join(right, on=[<span class="stringliteral">&quot;cola&quot;</span>, <span class="stringliteral">&quot;colb&quot;</span>, <span class="stringliteral">&quot;colc&quot;</span>], how=<span class="stringliteral">&quot;left&quot;</span>)</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno">  298</span>            [</div>
<div class="line"><span class="lineno">  299</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, 6],</div>
<div class="line"><span class="lineno">  300</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, 9],</div>
<div class="line"><span class="lineno">  301</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  302</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;h&quot;</span>, -3],</div>
<div class="line"><span class="lineno">  303</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>, 2],</div>
<div class="line"><span class="lineno">  304</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>, -1],</div>
<div class="line"><span class="lineno">  305</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  306</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, 1],</div>
<div class="line"><span class="lineno">  307</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, 4],</div>
<div class="line"><span class="lineno">  308</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;f&quot;</span>, 3],</div>
<div class="line"><span class="lineno">  309</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;f&quot;</span>, 8],</div>
<div class="line"><span class="lineno">  310</span>                [<span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;g&quot;</span>, 0],</div>
<div class="line"><span class="lineno">  311</span>                [<span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;j&quot;</span>, 7],</div>
<div class="line"><span class="lineno">  312</span>                [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, 5],</div>
<div class="line"><span class="lineno">  313</span>            ],</div>
<div class="line"><span class="lineno">  314</span>            columns=[<span class="stringliteral">&quot;cola&quot;</span>, <span class="stringliteral">&quot;colb&quot;</span>, <span class="stringliteral">&quot;colc&quot;</span>, <span class="stringliteral">&quot;tag&quot;</span>, <span class="stringliteral">&quot;val&quot;</span>],</div>
<div class="line"><span class="lineno">  315</span>            index=[3, 3, 2, 0, 1, 1, 7, 6, 6, 4, 4, 5, 9, 8],</div>
<div class="line"><span class="lineno">  316</span>        )</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>        result = left.join(right, on=[<span class="stringliteral">&quot;cola&quot;</span>, <span class="stringliteral">&quot;colb&quot;</span>, <span class="stringliteral">&quot;colc&quot;</span>], how=<span class="stringliteral">&quot;left&quot;</span>, sort=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>        expected = expected.sort_values([<span class="stringliteral">&quot;cola&quot;</span>, <span class="stringliteral">&quot;colb&quot;</span>, <span class="stringliteral">&quot;colc&quot;</span>], kind=<span class="stringliteral">&quot;mergesort&quot;</span>)</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  325</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a56f8e67aae003d4e4841719f83f22cf8" name="a56f8e67aae003d4e4841719f83f22cf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56f8e67aae003d4e4841719f83f22cf8">&#9670;&#160;</a></span>test_left_join_index_preserve_order()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_left_join_index_preserve_order </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  202</span>    <span class="keyword">def </span>test_left_join_index_preserve_order(self):</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>        on_cols = [<span class="stringliteral">&quot;k1&quot;</span>, <span class="stringliteral">&quot;k2&quot;</span>]</div>
<div class="line"><span class="lineno">  205</span>        left = DataFrame(</div>
<div class="line"><span class="lineno">  206</span>            {</div>
<div class="line"><span class="lineno">  207</span>                <span class="stringliteral">&quot;k1&quot;</span>: [0, 1, 2] * 8,</div>
<div class="line"><span class="lineno">  208</span>                <span class="stringliteral">&quot;k2&quot;</span>: [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>] * 12,</div>
<div class="line"><span class="lineno">  209</span>                <span class="stringliteral">&quot;v&quot;</span>: np.array(np.arange(24), dtype=np.int64),</div>
<div class="line"><span class="lineno">  210</span>            }</div>
<div class="line"><span class="lineno">  211</span>        )</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>        index = MultiIndex.from_tuples([(2, <span class="stringliteral">&quot;bar&quot;</span>), (1, <span class="stringliteral">&quot;foo&quot;</span>)])</div>
<div class="line"><span class="lineno">  214</span>        right = DataFrame({<span class="stringliteral">&quot;v2&quot;</span>: [5, 7]}, index=index)</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>        result = left.join(right, on=on_cols)</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>        expected = left.copy()</div>
<div class="line"><span class="lineno">  219</span>        expected[<span class="stringliteral">&quot;v2&quot;</span>] = np.nan</div>
<div class="line"><span class="lineno">  220</span>        expected.loc[(expected.k1 == 2) &amp; (expected.k2 == <span class="stringliteral">&quot;bar&quot;</span>), <span class="stringliteral">&quot;v2&quot;</span>] = 5</div>
<div class="line"><span class="lineno">  221</span>        expected.loc[(expected.k1 == 1) &amp; (expected.k2 == <span class="stringliteral">&quot;foo&quot;</span>), <span class="stringliteral">&quot;v2&quot;</span>] = 7</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>        result.sort_values(on_cols, kind=<span class="stringliteral">&quot;mergesort&quot;</span>, inplace=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  226</span>        expected = left.join(right, on=on_cols, sort=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>        <span class="comment"># test join with multi dtypes blocks</span></div>
<div class="line"><span class="lineno">  231</span>        left = DataFrame(</div>
<div class="line"><span class="lineno">  232</span>            {</div>
<div class="line"><span class="lineno">  233</span>                <span class="stringliteral">&quot;k1&quot;</span>: [0, 1, 2] * 8,</div>
<div class="line"><span class="lineno">  234</span>                <span class="stringliteral">&quot;k2&quot;</span>: [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>] * 12,</div>
<div class="line"><span class="lineno">  235</span>                <span class="stringliteral">&quot;k3&quot;</span>: np.array([0, 1, 2] * 8, dtype=np.float32),</div>
<div class="line"><span class="lineno">  236</span>                <span class="stringliteral">&quot;v&quot;</span>: np.array(np.arange(24), dtype=np.int32),</div>
<div class="line"><span class="lineno">  237</span>            }</div>
<div class="line"><span class="lineno">  238</span>        )</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>        index = MultiIndex.from_tuples([(2, <span class="stringliteral">&quot;bar&quot;</span>), (1, <span class="stringliteral">&quot;foo&quot;</span>)])</div>
<div class="line"><span class="lineno">  241</span>        right = DataFrame({<span class="stringliteral">&quot;v2&quot;</span>: [5, 7]}, index=index)</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>        result = left.join(right, on=on_cols)</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>        expected = left.copy()</div>
<div class="line"><span class="lineno">  246</span>        expected[<span class="stringliteral">&quot;v2&quot;</span>] = np.nan</div>
<div class="line"><span class="lineno">  247</span>        expected.loc[(expected.k1 == 2) &amp; (expected.k2 == <span class="stringliteral">&quot;bar&quot;</span>), <span class="stringliteral">&quot;v2&quot;</span>] = 5</div>
<div class="line"><span class="lineno">  248</span>        expected.loc[(expected.k1 == 1) &amp; (expected.k2 == <span class="stringliteral">&quot;foo&quot;</span>), <span class="stringliteral">&quot;v2&quot;</span>] = 7</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>        result = result.sort_values(on_cols, kind=<span class="stringliteral">&quot;mergesort&quot;</span>)</div>
<div class="line"><span class="lineno">  253</span>        expected = left.join(right, on=on_cols, sort=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  256</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abc18588301989ab90a182c6ed8db3487" name="abc18588301989ab90a182c6ed8db3487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc18588301989ab90a182c6ed8db3487">&#9670;&#160;</a></span>test_left_join_multi_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_left_join_multi_index </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   96</span>    <span class="keyword">def </span>test_left_join_multi_index(self, sort):</div>
<div class="line"><span class="lineno">   97</span>        icols = [<span class="stringliteral">&quot;1st&quot;</span>, <span class="stringliteral">&quot;2nd&quot;</span>, <span class="stringliteral">&quot;3rd&quot;</span>]</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>        <span class="keyword">def </span>bind_cols(df):</div>
<div class="line"><span class="lineno">  100</span>            iord = <span class="keyword">lambda</span> a: 0 <span class="keywordflow">if</span> a != a <span class="keywordflow">else</span> ord(a)</div>
<div class="line"><span class="lineno">  101</span>            f = <span class="keyword">lambda</span> ts: ts.map(iord) - ord(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  102</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(df[<span class="stringliteral">&quot;1st&quot;</span>]) + <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(df[<span class="stringliteral">&quot;3rd&quot;</span>]) * 1e2 + df[<span class="stringliteral">&quot;2nd&quot;</span>].fillna(0) * 1e4</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>        <span class="keyword">def </span>run_asserts(left, right, sort):</div>
<div class="line"><span class="lineno">  105</span>            res = left.join(right, on=icols, how=<span class="stringliteral">&quot;left&quot;</span>, sort=sort)</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>            <span class="keyword">assert</span> len(left) &lt; len(res) + 1</div>
<div class="line"><span class="lineno">  108</span>            <span class="keyword">assert</span> <span class="keywordflow">not</span> res[<span class="stringliteral">&quot;4th&quot;</span>].isna().any()</div>
<div class="line"><span class="lineno">  109</span>            <span class="keyword">assert</span> <span class="keywordflow">not</span> res[<span class="stringliteral">&quot;5th&quot;</span>].isna().any()</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>            tm.assert_series_equal(res[<span class="stringliteral">&quot;4th&quot;</span>], -res[<span class="stringliteral">&quot;5th&quot;</span>], check_names=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  112</span>            result = bind_cols(res.iloc[:, :-2])</div>
<div class="line"><span class="lineno">  113</span>            tm.assert_series_equal(res[<span class="stringliteral">&quot;4th&quot;</span>], result, check_names=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  114</span>            <span class="keyword">assert</span> result.name <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>            <span class="keywordflow">if</span> sort:</div>
<div class="line"><span class="lineno">  117</span>                tm.assert_frame_equal(res, res.sort_values(icols, kind=<span class="stringliteral">&quot;mergesort&quot;</span>))</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>            out = merge(left, right.reset_index(), on=icols, sort=sort, how=<span class="stringliteral">&quot;left&quot;</span>)</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>            res.index = np.arange(len(res))</div>
<div class="line"><span class="lineno">  122</span>            tm.assert_frame_equal(out, res)</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>        lc = list(map(chr, np.arange(ord(<span class="stringliteral">&quot;a&quot;</span>), ord(<span class="stringliteral">&quot;z&quot;</span>) + 1)))</div>
<div class="line"><span class="lineno">  125</span>        left = DataFrame(np.random.choice(lc, (5000, 2)), columns=[<span class="stringliteral">&quot;1st&quot;</span>, <span class="stringliteral">&quot;3rd&quot;</span>])</div>
<div class="line"><span class="lineno">  126</span>        left.insert(1, <span class="stringliteral">&quot;2nd&quot;</span>, np.random.randint(0, 1000, len(left)))</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>        i = np.random.permutation(len(left))</div>
<div class="line"><span class="lineno">  129</span>        right = left.iloc[i].copy()</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>        left[<span class="stringliteral">&quot;4th&quot;</span>] = bind_cols(left)</div>
<div class="line"><span class="lineno">  132</span>        right[<span class="stringliteral">&quot;5th&quot;</span>] = -bind_cols(right)</div>
<div class="line"><span class="lineno">  133</span>        right.set_index(icols, inplace=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>        run_asserts(left, right, sort)</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>        <span class="comment"># inject some nulls</span></div>
<div class="line"><span class="lineno">  138</span>        left.loc[1::23, <span class="stringliteral">&quot;1st&quot;</span>] = np.nan</div>
<div class="line"><span class="lineno">  139</span>        left.loc[2::37, <span class="stringliteral">&quot;2nd&quot;</span>] = np.nan</div>
<div class="line"><span class="lineno">  140</span>        left.loc[3::43, <span class="stringliteral">&quot;3rd&quot;</span>] = np.nan</div>
<div class="line"><span class="lineno">  141</span>        left[<span class="stringliteral">&quot;4th&quot;</span>] = bind_cols(left)</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>        i = np.random.permutation(len(left))</div>
<div class="line"><span class="lineno">  144</span>        right = left.iloc[i, :-1]</div>
<div class="line"><span class="lineno">  145</span>        right[<span class="stringliteral">&quot;5th&quot;</span>] = -bind_cols(right)</div>
<div class="line"><span class="lineno">  146</span>        right.set_index(icols, inplace=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>        run_asserts(left, right, sort)</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9ad7ea3ec265a99d66d954f15e7ae69" name="ae9ad7ea3ec265a99d66d954f15e7ae69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ad7ea3ec265a99d66d954f15e7ae69">&#9670;&#160;</a></span>test_left_merge_na_buglet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_left_merge_na_buglet </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  376</span>    <span class="keyword">def </span>test_left_merge_na_buglet(self):</div>
<div class="line"><span class="lineno">  377</span>        left = DataFrame(</div>
<div class="line"><span class="lineno">  378</span>            {</div>
<div class="line"><span class="lineno">  379</span>                <span class="stringliteral">&quot;id&quot;</span>: list(<span class="stringliteral">&quot;abcde&quot;</span>),</div>
<div class="line"><span class="lineno">  380</span>                <span class="stringliteral">&quot;v1&quot;</span>: np.random.randn(5),</div>
<div class="line"><span class="lineno">  381</span>                <span class="stringliteral">&quot;v2&quot;</span>: np.random.randn(5),</div>
<div class="line"><span class="lineno">  382</span>                <span class="stringliteral">&quot;dummy&quot;</span>: list(<span class="stringliteral">&quot;abcde&quot;</span>),</div>
<div class="line"><span class="lineno">  383</span>                <span class="stringliteral">&quot;v3&quot;</span>: np.random.randn(5),</div>
<div class="line"><span class="lineno">  384</span>            },</div>
<div class="line"><span class="lineno">  385</span>            columns=[<span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;v1&quot;</span>, <span class="stringliteral">&quot;v2&quot;</span>, <span class="stringliteral">&quot;dummy&quot;</span>, <span class="stringliteral">&quot;v3&quot;</span>],</div>
<div class="line"><span class="lineno">  386</span>        )</div>
<div class="line"><span class="lineno">  387</span>        right = DataFrame(</div>
<div class="line"><span class="lineno">  388</span>            {</div>
<div class="line"><span class="lineno">  389</span>                <span class="stringliteral">&quot;id&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, np.nan, np.nan, np.nan],</div>
<div class="line"><span class="lineno">  390</span>                <span class="stringliteral">&quot;sv3&quot;</span>: [1.234, 5.678, np.nan, np.nan, np.nan],</div>
<div class="line"><span class="lineno">  391</span>            }</div>
<div class="line"><span class="lineno">  392</span>        )</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>        result = merge(left, right, on=<span class="stringliteral">&quot;id&quot;</span>, how=<span class="stringliteral">&quot;left&quot;</span>)</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>        rdf = right.drop([<span class="stringliteral">&quot;id&quot;</span>], axis=1)</div>
<div class="line"><span class="lineno">  397</span>        expected = left.join(rdf)</div>
<div class="line"><span class="lineno">  398</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  399</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0050d55daa4efa8ec38abea9544908f1" name="a0050d55daa4efa8ec38abea9544908f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0050d55daa4efa8ec38abea9544908f1">&#9670;&#160;</a></span>test_merge_datetime_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_merge_datetime_index </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>klass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  433</span>    <span class="keyword">def </span>test_merge_datetime_index(self, klass):</div>
<div class="line"><span class="lineno">  434</span>        <span class="comment"># see gh-19038</span></div>
<div class="line"><span class="lineno">  435</span>        df = DataFrame(</div>
<div class="line"><span class="lineno">  436</span>            [1, 2, 3], [<span class="stringliteral">&quot;2016-01-01&quot;</span>, <span class="stringliteral">&quot;2017-01-01&quot;</span>, <span class="stringliteral">&quot;2018-01-01&quot;</span>], columns=[<span class="stringliteral">&quot;a&quot;</span>]</div>
<div class="line"><span class="lineno">  437</span>        )</div>
<div class="line"><span class="lineno">  438</span>        df.index = pd.to_datetime(df.index)</div>
<div class="line"><span class="lineno">  439</span>        on_vector = df.index.year</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>        <span class="keywordflow">if</span> klass <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  442</span>            on_vector = klass(on_vector)</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>        expected = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 2, 3], <span class="stringliteral">&quot;key_1&quot;</span>: [2016, 2017, 2018]})</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>        result = df.merge(df, on=[<span class="stringliteral">&quot;a&quot;</span>, on_vector], how=<span class="stringliteral">&quot;inner&quot;</span>)</div>
<div class="line"><span class="lineno">  447</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno">  450</span>            {<span class="stringliteral">&quot;key_0&quot;</span>: [2016, 2017, 2018], <span class="stringliteral">&quot;a_x&quot;</span>: [1, 2, 3], <span class="stringliteral">&quot;a_y&quot;</span>: [1, 2, 3]}</div>
<div class="line"><span class="lineno">  451</span>        )</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>        result = df.merge(df, on=[df.index.year], how=<span class="stringliteral">&quot;inner&quot;</span>)</div>
<div class="line"><span class="lineno">  454</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  455</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a52496277d8ed927e357de8dc54754e08" name="a52496277d8ed927e357de8dc54754e08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52496277d8ed927e357de8dc54754e08">&#9670;&#160;</a></span>test_merge_datetime_multi_index_empty_df()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_merge_datetime_multi_index_empty_df </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>merge_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  457</span>    <span class="keyword">def </span>test_merge_datetime_multi_index_empty_df(self, merge_type):</div>
<div class="line"><span class="lineno">  458</span>        <span class="comment"># see gh-36895</span></div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>        left = DataFrame(</div>
<div class="line"><span class="lineno">  461</span>            data={</div>
<div class="line"><span class="lineno">  462</span>                <span class="stringliteral">&quot;data&quot;</span>: [1.5, 1.5],</div>
<div class="line"><span class="lineno">  463</span>            },</div>
<div class="line"><span class="lineno">  464</span>            index=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno">  465</span>                [[Timestamp(<span class="stringliteral">&quot;1950-01-01&quot;</span>), <span class="stringliteral">&quot;A&quot;</span>], [Timestamp(<span class="stringliteral">&quot;1950-01-02&quot;</span>), <span class="stringliteral">&quot;B&quot;</span>]],</div>
<div class="line"><span class="lineno">  466</span>                names=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;panel&quot;</span>],</div>
<div class="line"><span class="lineno">  467</span>            ),</div>
<div class="line"><span class="lineno">  468</span>        )</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>        right = DataFrame(</div>
<div class="line"><span class="lineno">  471</span>            index=MultiIndex.from_tuples([], names=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;panel&quot;</span>]), columns=[<span class="stringliteral">&quot;state&quot;</span>]</div>
<div class="line"><span class="lineno">  472</span>        )</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>        expected_index = MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno">  475</span>            [[Timestamp(<span class="stringliteral">&quot;1950-01-01&quot;</span>), <span class="stringliteral">&quot;A&quot;</span>], [Timestamp(<span class="stringliteral">&quot;1950-01-02&quot;</span>), <span class="stringliteral">&quot;B&quot;</span>]],</div>
<div class="line"><span class="lineno">  476</span>            names=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;panel&quot;</span>],</div>
<div class="line"><span class="lineno">  477</span>        )</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">if</span> merge_type == <span class="stringliteral">&quot;left&quot;</span>:</div>
<div class="line"><span class="lineno">  480</span>            expected = DataFrame(</div>
<div class="line"><span class="lineno">  481</span>                data={</div>
<div class="line"><span class="lineno">  482</span>                    <span class="stringliteral">&quot;data&quot;</span>: [1.5, 1.5],</div>
<div class="line"><span class="lineno">  483</span>                    <span class="stringliteral">&quot;state&quot;</span>: [<span class="keywordtype">None</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  484</span>                },</div>
<div class="line"><span class="lineno">  485</span>                index=expected_index,</div>
<div class="line"><span class="lineno">  486</span>            )</div>
<div class="line"><span class="lineno">  487</span>            results_merge = left.merge(right, how=<span class="stringliteral">&quot;left&quot;</span>, on=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;panel&quot;</span>])</div>
<div class="line"><span class="lineno">  488</span>            results_join = left.join(right, how=<span class="stringliteral">&quot;left&quot;</span>)</div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  490</span>            expected = DataFrame(</div>
<div class="line"><span class="lineno">  491</span>                data={</div>
<div class="line"><span class="lineno">  492</span>                    <span class="stringliteral">&quot;state&quot;</span>: [<span class="keywordtype">None</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  493</span>                    <span class="stringliteral">&quot;data&quot;</span>: [1.5, 1.5],</div>
<div class="line"><span class="lineno">  494</span>                },</div>
<div class="line"><span class="lineno">  495</span>                index=expected_index,</div>
<div class="line"><span class="lineno">  496</span>            )</div>
<div class="line"><span class="lineno">  497</span>            results_merge = right.merge(left, how=<span class="stringliteral">&quot;right&quot;</span>, on=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;panel&quot;</span>])</div>
<div class="line"><span class="lineno">  498</span>            results_join = right.join(left, how=<span class="stringliteral">&quot;right&quot;</span>)</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>        tm.assert_frame_equal(results_merge, expected)</div>
<div class="line"><span class="lineno">  501</span>        tm.assert_frame_equal(results_join, expected)</div>
<div class="line"><span class="lineno">  502</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afca1f5457aaf4fc89430d8ad4cbdf094" name="afca1f5457aaf4fc89430d8ad4cbdf094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afca1f5457aaf4fc89430d8ad4cbdf094">&#9670;&#160;</a></span>test_merge_multiple_cols_with_mixed_cols_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_merge_multiple_cols_with_mixed_cols_index </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  167</span>    <span class="keyword">def </span>test_merge_multiple_cols_with_mixed_cols_index(self):</div>
<div class="line"><span class="lineno">  168</span>        <span class="comment"># GH29522</span></div>
<div class="line"><span class="lineno">  169</span>        s = Series(</div>
<div class="line"><span class="lineno">  170</span>            range(6),</div>
<div class="line"><span class="lineno">  171</span>            MultiIndex.from_product([[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], [1, 2, 3]], names=[<span class="stringliteral">&quot;lev1&quot;</span>, <span class="stringliteral">&quot;lev2&quot;</span>]),</div>
<div class="line"><span class="lineno">  172</span>            name=<span class="stringliteral">&quot;Amount&quot;</span>,</div>
<div class="line"><span class="lineno">  173</span>        )</div>
<div class="line"><span class="lineno">  174</span>        df = DataFrame({<span class="stringliteral">&quot;lev1&quot;</span>: list(<span class="stringliteral">&quot;AAABBB&quot;</span>), <span class="stringliteral">&quot;lev2&quot;</span>: [1, 2, 3, 1, 2, 3], <span class="stringliteral">&quot;col&quot;</span>: 0})</div>
<div class="line"><span class="lineno">  175</span>        result = merge(df, s.reset_index(), on=[<span class="stringliteral">&quot;lev1&quot;</span>, <span class="stringliteral">&quot;lev2&quot;</span>])</div>
<div class="line"><span class="lineno">  176</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno">  177</span>            {</div>
<div class="line"><span class="lineno">  178</span>                <span class="stringliteral">&quot;lev1&quot;</span>: list(<span class="stringliteral">&quot;AAABBB&quot;</span>),</div>
<div class="line"><span class="lineno">  179</span>                <span class="stringliteral">&quot;lev2&quot;</span>: [1, 2, 3, 1, 2, 3],</div>
<div class="line"><span class="lineno">  180</span>                <span class="stringliteral">&quot;col&quot;</span>: [0] * 6,</div>
<div class="line"><span class="lineno">  181</span>                <span class="stringliteral">&quot;Amount&quot;</span>: range(6),</div>
<div class="line"><span class="lineno">  182</span>            }</div>
<div class="line"><span class="lineno">  183</span>        )</div>
<div class="line"><span class="lineno">  184</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  185</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a04a22f52f280abb684cc41a73e188d01" name="a04a22f52f280abb684cc41a73e188d01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04a22f52f280abb684cc41a73e188d01">&#9670;&#160;</a></span>test_merge_na_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_merge_na_keys </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  400</span>    <span class="keyword">def </span>test_merge_na_keys(self):</div>
<div class="line"><span class="lineno">  401</span>        data = [</div>
<div class="line"><span class="lineno">  402</span>            [1950, <span class="stringliteral">&quot;A&quot;</span>, 1.5],</div>
<div class="line"><span class="lineno">  403</span>            [1950, <span class="stringliteral">&quot;B&quot;</span>, 1.5],</div>
<div class="line"><span class="lineno">  404</span>            [1955, <span class="stringliteral">&quot;B&quot;</span>, 1.5],</div>
<div class="line"><span class="lineno">  405</span>            [1960, <span class="stringliteral">&quot;B&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  406</span>            [1970, <span class="stringliteral">&quot;B&quot;</span>, 4.0],</div>
<div class="line"><span class="lineno">  407</span>            [1950, <span class="stringliteral">&quot;C&quot;</span>, 4.0],</div>
<div class="line"><span class="lineno">  408</span>            [1960, <span class="stringliteral">&quot;C&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  409</span>            [1965, <span class="stringliteral">&quot;C&quot;</span>, 3.0],</div>
<div class="line"><span class="lineno">  410</span>            [1970, <span class="stringliteral">&quot;C&quot;</span>, 4.0],</div>
<div class="line"><span class="lineno">  411</span>        ]</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>        frame = DataFrame(data, columns=[<span class="stringliteral">&quot;year&quot;</span>, <span class="stringliteral">&quot;panel&quot;</span>, <span class="stringliteral">&quot;data&quot;</span>])</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>        other_data = [</div>
<div class="line"><span class="lineno">  416</span>            [1960, <span class="stringliteral">&quot;A&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  417</span>            [1970, <span class="stringliteral">&quot;A&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  418</span>            [1955, <span class="stringliteral">&quot;A&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  419</span>            [1965, <span class="stringliteral">&quot;A&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  420</span>            [1965, <span class="stringliteral">&quot;B&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  421</span>            [1955, <span class="stringliteral">&quot;C&quot;</span>, np.nan],</div>
<div class="line"><span class="lineno">  422</span>        ]</div>
<div class="line"><span class="lineno">  423</span>        other = DataFrame(other_data, columns=[<span class="stringliteral">&quot;year&quot;</span>, <span class="stringliteral">&quot;panel&quot;</span>, <span class="stringliteral">&quot;data&quot;</span>])</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>        result = frame.merge(other, how=<span class="stringliteral">&quot;outer&quot;</span>)</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>        expected = frame.fillna(-999).merge(other.fillna(-999), how=<span class="stringliteral">&quot;outer&quot;</span>)</div>
<div class="line"><span class="lineno">  428</span>        expected = expected.replace(-999, np.nan)</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  431</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a07cf19e03b6676c5deb8408395611e46" name="a07cf19e03b6676c5deb8408395611e46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07cf19e03b6676c5deb8408395611e46">&#9670;&#160;</a></span>test_merge_on_multikey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_merge_on_multikey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>join_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   77</span>    <span class="keyword">def </span>test_merge_on_multikey(self, left, right, join_type):</div>
<div class="line"><span class="lineno">   78</span>        on_cols = [<span class="stringliteral">&quot;key1&quot;</span>, <span class="stringliteral">&quot;key2&quot;</span>]</div>
<div class="line"><span class="lineno">   79</span>        result = left.join(right, on=on_cols, how=join_type).reset_index(drop=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>        expected = merge(left, right.reset_index(), on=on_cols, how=join_type)</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>        result = left.join(right, on=on_cols, how=join_type, sort=<span class="keyword">True</span>).reset_index(</div>
<div class="line"><span class="lineno">   86</span>            drop=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">   87</span>        )</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>        expected = merge(</div>
<div class="line"><span class="lineno">   90</span>            left, right.reset_index(), on=on_cols, how=join_type, sort=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">   91</span>        )</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">   94</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adfc71f27987493fc883539f6b37b8ef4" name="adfc71f27987493fc883539f6b37b8ef4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfc71f27987493fc883539f6b37b8ef4">&#9670;&#160;</a></span>test_merge_right_vs_left()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_multi.TestMergeMulti.test_merge_right_vs_left </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  151</span>    <span class="keyword">def </span>test_merge_right_vs_left(self, left, right, sort):</div>
<div class="line"><span class="lineno">  152</span>        <span class="comment"># compare left vs right merge with multikey</span></div>
<div class="line"><span class="lineno">  153</span>        on_cols = [<span class="stringliteral">&quot;key1&quot;</span>, <span class="stringliteral">&quot;key2&quot;</span>]</div>
<div class="line"><span class="lineno">  154</span>        merged_left_right = left.merge(</div>
<div class="line"><span class="lineno">  155</span>            right, left_on=on_cols, right_index=<span class="keyword">True</span>, how=<span class="stringliteral">&quot;left&quot;</span>, sort=sort</div>
<div class="line"><span class="lineno">  156</span>        )</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>        merge_right_left = right.merge(</div>
<div class="line"><span class="lineno">  159</span>            left, right_on=on_cols, left_index=<span class="keyword">True</span>, how=<span class="stringliteral">&quot;right&quot;</span>, sort=sort</div>
<div class="line"><span class="lineno">  160</span>        )</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>        <span class="comment"># Reorder columns</span></div>
<div class="line"><span class="lineno">  163</span>        merge_right_left = merge_right_left[merged_left_right.columns]</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>        tm.assert_frame_equal(merged_left_right, merge_right_left)</div>
<div class="line"><span class="lineno">  166</span> </div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/pandas/tests/reshape/merge/<a class="el" href="test__multi_8py.html">test_multi.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
