<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.tests.groupby.aggregate.test_aggregate Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1groupby.html">groupby</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate.html">aggregate</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html">test_aggregate</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">pandas.tests.groupby.aggregate.test_aggregate Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate_1_1_test_lambda_mangling.html">TestLambdaMangling</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate_1_1_test_named_aggregation_data_frame.html">TestNamedAggregationDataFrame</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate_1_1_test_named_aggregation_series.html">TestNamedAggregationSeries</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a44b5ae729f702bdce8ebb2d67e4637b3" id="r_a44b5ae729f702bdce8ebb2d67e4637b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a44b5ae729f702bdce8ebb2d67e4637b3">test_groupby_agg_no_extra_calls</a> ()</td></tr>
<tr class="separator:a44b5ae729f702bdce8ebb2d67e4637b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70db2cac10b7e4f0822ff09cf26fcf05" id="r_a70db2cac10b7e4f0822ff09cf26fcf05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a70db2cac10b7e4f0822ff09cf26fcf05">test_agg_regression1</a> (tsframe)</td></tr>
<tr class="separator:a70db2cac10b7e4f0822ff09cf26fcf05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74e0cd2770dc5f030f70b29beb6a107e" id="r_a74e0cd2770dc5f030f70b29beb6a107e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a74e0cd2770dc5f030f70b29beb6a107e">test_agg_must_agg</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:a74e0cd2770dc5f030f70b29beb6a107e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7ba7dc980cb241f861e4fc086ccfbcc" id="r_aa7ba7dc980cb241f861e4fc086ccfbcc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#aa7ba7dc980cb241f861e4fc086ccfbcc">test_agg_ser_multi_key</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:aa7ba7dc980cb241f861e4fc086ccfbcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a757f191eca37f31b12a5172b46badae4" id="r_a757f191eca37f31b12a5172b46badae4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a757f191eca37f31b12a5172b46badae4">test_groupby_aggregation_mixed_dtype</a> ()</td></tr>
<tr class="separator:a757f191eca37f31b12a5172b46badae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7357ebe100b0ae6889b64735603665b7" id="r_a7357ebe100b0ae6889b64735603665b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a7357ebe100b0ae6889b64735603665b7">test_groupby_aggregation_multi_level_column</a> ()</td></tr>
<tr class="separator:a7357ebe100b0ae6889b64735603665b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6657179c98ded72ee1224caf92dc5f12" id="r_a6657179c98ded72ee1224caf92dc5f12"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a6657179c98ded72ee1224caf92dc5f12">test_agg_apply_corner</a> (<a class="el" href="return__character_2foo77_8f.html#a0c928a851187b93eecc7b1066de4df74">ts</a>, tsframe)</td></tr>
<tr class="separator:a6657179c98ded72ee1224caf92dc5f12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dc8e3eb3104c6922a64de05b613f5f0" id="r_a1dc8e3eb3104c6922a64de05b613f5f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a1dc8e3eb3104c6922a64de05b613f5f0">test_agg_grouping_is_list_tuple</a> (<a class="el" href="return__character_2foo77_8f.html#a0c928a851187b93eecc7b1066de4df74">ts</a>)</td></tr>
<tr class="separator:a1dc8e3eb3104c6922a64de05b613f5f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1545e653acbb6db6e6b81600bc13bf1" id="r_ac1545e653acbb6db6e6b81600bc13bf1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ac1545e653acbb6db6e6b81600bc13bf1">test_agg_python_multiindex</a> (mframe)</td></tr>
<tr class="separator:ac1545e653acbb6db6e6b81600bc13bf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7db97bd970ff666b715619792b9d3f71" id="r_a7db97bd970ff666b715619792b9d3f71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a7db97bd970ff666b715619792b9d3f71">test_aggregate_str_func</a> (tsframe, groupbyfunc)</td></tr>
<tr class="separator:a7db97bd970ff666b715619792b9d3f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e389852d8fa86372d87d4cb36df6f92" id="r_a8e389852d8fa86372d87d4cb36df6f92"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a8e389852d8fa86372d87d4cb36df6f92">test_agg_str_with_kwarg_axis_1_raises</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>, reduction_func)</td></tr>
<tr class="separator:a8e389852d8fa86372d87d4cb36df6f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab831d1af24479b123aea767219639939" id="r_ab831d1af24479b123aea767219639939"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ab831d1af24479b123aea767219639939">test_multiindex_groupby_mixed_cols_axis1</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, expected, dtype, result_dtype_dict)</td></tr>
<tr class="separator:ab831d1af24479b123aea767219639939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af481ddc767a7d956ab068c96ae5f239b" id="r_af481ddc767a7d956ab068c96ae5f239b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#af481ddc767a7d956ab068c96ae5f239b">test_groupby_mixed_cols_axis1</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, expected_data, result_dtype_dict)</td></tr>
<tr class="separator:af481ddc767a7d956ab068c96ae5f239b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9235133b40fcfe815a66e812477034d8" id="r_a9235133b40fcfe815a66e812477034d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a9235133b40fcfe815a66e812477034d8">test_aggregate_item_by_item</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:a9235133b40fcfe815a66e812477034d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48148c85f329daecd4a5119d3e3c476c" id="r_a48148c85f329daecd4a5119d3e3c476c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a48148c85f329daecd4a5119d3e3c476c">test_wrap_agg_out</a> (three_group)</td></tr>
<tr class="separator:a48148c85f329daecd4a5119d3e3c476c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3ab97da4df31c68312163843476c203" id="r_ad3ab97da4df31c68312163843476c203"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ad3ab97da4df31c68312163843476c203">test_agg_multiple_functions_maintain_order</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:ad3ab97da4df31c68312163843476c203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1516984be110f1f6cc8d2bf77d5043e" id="r_aa1516984be110f1f6cc8d2bf77d5043e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#aa1516984be110f1f6cc8d2bf77d5043e">test_agg_multiple_functions_same_name</a> ()</td></tr>
<tr class="separator:aa1516984be110f1f6cc8d2bf77d5043e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0c5f9ef6cb73d75c2a3690f67bf098" id="r_a3d0c5f9ef6cb73d75c2a3690f67bf098"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a3d0c5f9ef6cb73d75c2a3690f67bf098">test_agg_multiple_functions_same_name_with_ohlc_present</a> ()</td></tr>
<tr class="separator:a3d0c5f9ef6cb73d75c2a3690f67bf098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9da1c54e6ac6604aeec92d8978697431" id="r_a9da1c54e6ac6604aeec92d8978697431"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a9da1c54e6ac6604aeec92d8978697431">test_multiple_functions_tuples_and_non_tuples</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:a9da1c54e6ac6604aeec92d8978697431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b9b1132df43bd0c1346bd8e3c21601" id="r_a65b9b1132df43bd0c1346bd8e3c21601"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a65b9b1132df43bd0c1346bd8e3c21601">test_more_flexible_frame_multi_function</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:a65b9b1132df43bd0c1346bd8e3c21601"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace79eed5815a8432011b80a0a9209372" id="r_ace79eed5815a8432011b80a0a9209372"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ace79eed5815a8432011b80a0a9209372">test_multi_function_flexible_mix</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:ace79eed5815a8432011b80a0a9209372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43dd145993d9344c20e9f4765693d23a" id="r_a43dd145993d9344c20e9f4765693d23a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a43dd145993d9344c20e9f4765693d23a">test_groupby_agg_coercing_bools</a> ()</td></tr>
<tr class="separator:a43dd145993d9344c20e9f4765693d23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9a7b35cf6c8ba3e7e0be70db57d18c6" id="r_ae9a7b35cf6c8ba3e7e0be70db57d18c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ae9a7b35cf6c8ba3e7e0be70db57d18c6">test_bool_agg_dtype</a> (op)</td></tr>
<tr class="separator:ae9a7b35cf6c8ba3e7e0be70db57d18c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad47e25f83e1465c0c62742a1e612fef9" id="r_ad47e25f83e1465c0c62742a1e612fef9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ad47e25f83e1465c0c62742a1e612fef9">test_callable_result_dtype_frame</a> (keys, agg_index, input_dtype, result_dtype, method)</td></tr>
<tr class="separator:ad47e25f83e1465c0c62742a1e612fef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90eef84f0dfe263774c22b7b5ee26add" id="r_a90eef84f0dfe263774c22b7b5ee26add"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a90eef84f0dfe263774c22b7b5ee26add">test_callable_result_dtype_series</a> (keys, agg_index, input, dtype, method)</td></tr>
<tr class="separator:a90eef84f0dfe263774c22b7b5ee26add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a077a7714e36b835c30cdf56fdef0e5f3" id="r_a077a7714e36b835c30cdf56fdef0e5f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a077a7714e36b835c30cdf56fdef0e5f3">test_order_aggregate_multiple_funcs</a> ()</td></tr>
<tr class="separator:a077a7714e36b835c30cdf56fdef0e5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97643da2cce2e22d4bcbf9b041a991c" id="r_ac97643da2cce2e22d4bcbf9b041a991c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ac97643da2cce2e22d4bcbf9b041a991c">test_ohlc_ea_dtypes</a> (any_numeric_ea_dtype)</td></tr>
<tr class="separator:ac97643da2cce2e22d4bcbf9b041a991c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4e7b9ff0e2de07abba94b00409eb59" id="r_a2f4e7b9ff0e2de07abba94b00409eb59"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a2f4e7b9ff0e2de07abba94b00409eb59">test_uint64_type_handling</a> (dtype, how)</td></tr>
<tr class="separator:a2f4e7b9ff0e2de07abba94b00409eb59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3515b429ab9e74fca59fc32555ffbd8e" id="r_a3515b429ab9e74fca59fc32555ffbd8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a3515b429ab9e74fca59fc32555ffbd8e">test_func_duplicates_raises</a> ()</td></tr>
<tr class="separator:a3515b429ab9e74fca59fc32555ffbd8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2c0b024999fc9d978b67e4beba33a1" id="r_a5a2c0b024999fc9d978b67e4beba33a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a5a2c0b024999fc9d978b67e4beba33a1">test_agg_index_has_complex_internals</a> (index)</td></tr>
<tr class="separator:a5a2c0b024999fc9d978b67e4beba33a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6672b418bbaae00af51f0046197f028" id="r_ae6672b418bbaae00af51f0046197f028"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ae6672b418bbaae00af51f0046197f028">test_agg_split_block</a> ()</td></tr>
<tr class="separator:ae6672b418bbaae00af51f0046197f028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcfa2dbcacafee31efab7d997500fef2" id="r_abcfa2dbcacafee31efab7d997500fef2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#abcfa2dbcacafee31efab7d997500fef2">test_agg_split_object_part_datetime</a> ()</td></tr>
<tr class="separator:abcfa2dbcacafee31efab7d997500fef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb0127d4ddc04337638a423ca8be193" id="r_a9fb0127d4ddc04337638a423ca8be193"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a9fb0127d4ddc04337638a423ca8be193">test_agg_relabel_multiindex_column</a> (agg_col1, agg_col2, agg_col3, agg_result1, agg_result2, agg_result3)</td></tr>
<tr class="separator:a9fb0127d4ddc04337638a423ca8be193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35782584728f9b51bdf9356f8dbb3c8a" id="r_a35782584728f9b51bdf9356f8dbb3c8a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a35782584728f9b51bdf9356f8dbb3c8a">test_agg_relabel_multiindex_raises_not_exist</a> ()</td></tr>
<tr class="separator:a35782584728f9b51bdf9356f8dbb3c8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46e775e04637e96d323824888f0d23d4" id="r_a46e775e04637e96d323824888f0d23d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a46e775e04637e96d323824888f0d23d4">test_agg_relabel_multiindex_duplicates</a> ()</td></tr>
<tr class="separator:a46e775e04637e96d323824888f0d23d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32b8a1410ec6f509468b3fc0ac482e41" id="r_a32b8a1410ec6f509468b3fc0ac482e41"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a32b8a1410ec6f509468b3fc0ac482e41">test_groupby_aggregate_empty_key</a> (kwargs)</td></tr>
<tr class="separator:a32b8a1410ec6f509468b3fc0ac482e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a699a2874139a277391138df8c88cbd29" id="r_a699a2874139a277391138df8c88cbd29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a699a2874139a277391138df8c88cbd29">test_groupby_aggregate_empty_key_empty_return</a> ()</td></tr>
<tr class="separator:a699a2874139a277391138df8c88cbd29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1f31e1828ef0f1e220e6a70fc381c77" id="r_af1f31e1828ef0f1e220e6a70fc381c77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#af1f31e1828ef0f1e220e6a70fc381c77">test_groupby_aggregate_empty_with_multiindex_frame</a> ()</td></tr>
<tr class="separator:af1f31e1828ef0f1e220e6a70fc381c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38a39e879d0e30c322f912f69065dcd7" id="r_a38a39e879d0e30c322f912f69065dcd7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a38a39e879d0e30c322f912f69065dcd7">test_grouby_agg_loses_results_with_as_index_false_relabel</a> ()</td></tr>
<tr class="separator:a38a39e879d0e30c322f912f69065dcd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b369fef790ead788fcd09abb8826e50" id="r_a2b369fef790ead788fcd09abb8826e50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a2b369fef790ead788fcd09abb8826e50">test_grouby_agg_loses_results_with_as_index_false_relabel_multiindex</a> ()</td></tr>
<tr class="separator:a2b369fef790ead788fcd09abb8826e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d49bb52eef72a2aed1e1f24132fef3" id="r_a40d49bb52eef72a2aed1e1f24132fef3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a40d49bb52eef72a2aed1e1f24132fef3">test_multiindex_custom_func</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:a40d49bb52eef72a2aed1e1f24132fef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd0fb6b09a17ac022d8176b2db74798f" id="r_acd0fb6b09a17ac022d8176b2db74798f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#acd0fb6b09a17ac022d8176b2db74798f">myfunc</a> (s)</td></tr>
<tr class="separator:acd0fb6b09a17ac022d8176b2db74798f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a276c0df199f3f40aefc234fe848dcbcf" id="r_a276c0df199f3f40aefc234fe848dcbcf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a276c0df199f3f40aefc234fe848dcbcf">test_lambda_named_agg</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:a276c0df199f3f40aefc234fe848dcbcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a354d0a7d28ebc3bcc7bb05b9b87be" id="r_a59a354d0a7d28ebc3bcc7bb05b9b87be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a59a354d0a7d28ebc3bcc7bb05b9b87be">test_aggregate_mixed_types</a> ()</td></tr>
<tr class="separator:a59a354d0a7d28ebc3bcc7bb05b9b87be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e9f63ac30d47c6be6edaafaa0900d2" id="r_a90e9f63ac30d47c6be6edaafaa0900d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a90e9f63ac30d47c6be6edaafaa0900d2">test_aggregate_udf_na_extension_type</a> ()</td></tr>
<tr class="separator:a90e9f63ac30d47c6be6edaafaa0900d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dcf0b313d8e4c7ad22fbaddd658b114" id="r_a7dcf0b313d8e4c7ad22fbaddd658b114"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a7dcf0b313d8e4c7ad22fbaddd658b114">test_groupby_get_by_index</a> ()</td></tr>
<tr class="separator:a7dcf0b313d8e4c7ad22fbaddd658b114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77ac852bd3ab2d1367a51d45ed155c3e" id="r_a77ac852bd3ab2d1367a51d45ed155c3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a77ac852bd3ab2d1367a51d45ed155c3e">test_groupby_single_agg_cat_cols</a> (grp_col_dict, exp_data)</td></tr>
<tr class="separator:a77ac852bd3ab2d1367a51d45ed155c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad18376b8c9aad5ef317cd455e2f74032" id="r_ad18376b8c9aad5ef317cd455e2f74032"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ad18376b8c9aad5ef317cd455e2f74032">test_groupby_combined_aggs_cat_cols</a> (grp_col_dict, exp_data)</td></tr>
<tr class="separator:ad18376b8c9aad5ef317cd455e2f74032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24a6f297debbe869946704801e78641" id="r_ae24a6f297debbe869946704801e78641"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ae24a6f297debbe869946704801e78641">test_nonagg_agg</a> ()</td></tr>
<tr class="separator:ae24a6f297debbe869946704801e78641"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9c7a25fbf2af54bc96fe51a1bbcac39" id="r_af9c7a25fbf2af54bc96fe51a1bbcac39"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#af9c7a25fbf2af54bc96fe51a1bbcac39">test_aggregate_datetime_objects</a> ()</td></tr>
<tr class="separator:af9c7a25fbf2af54bc96fe51a1bbcac39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2724fa0fefe010d3e8c7c89608235dd" id="r_af2724fa0fefe010d3e8c7c89608235dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#af2724fa0fefe010d3e8c7c89608235dd">test_groupby_index_object_dtype</a> ()</td></tr>
<tr class="separator:af2724fa0fefe010d3e8c7c89608235dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4914248c269101c7c6e46c7edee3e8" id="r_aef4914248c269101c7c6e46c7edee3e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#aef4914248c269101c7c6e46c7edee3e8">test_timeseries_groupby_agg</a> ()</td></tr>
<tr class="separator:aef4914248c269101c7c6e46c7edee3e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c78a80a2463161b8578806dae8673e" id="r_a40c78a80a2463161b8578806dae8673e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a40c78a80a2463161b8578806dae8673e">test_groupby_aggregate_directory</a> (reduction_func)</td></tr>
<tr class="separator:a40c78a80a2463161b8578806dae8673e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad32a9d9fe2922c09231c2b2283933ab5" id="r_ad32a9d9fe2922c09231c2b2283933ab5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ad32a9d9fe2922c09231c2b2283933ab5">test_group_mean_timedelta_nat</a> ()</td></tr>
<tr class="separator:ad32a9d9fe2922c09231c2b2283933ab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb011e026a8214df332eb581e128804" id="r_a2cb011e026a8214df332eb581e128804"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a2cb011e026a8214df332eb581e128804">test_group_mean_datetime64_nat</a> (input_data, expected_output)</td></tr>
<tr class="separator:a2cb011e026a8214df332eb581e128804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44daac97611e3c52556e023f66207966" id="r_a44daac97611e3c52556e023f66207966"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a44daac97611e3c52556e023f66207966">test_groupby_complex</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, output)</td></tr>
<tr class="separator:a44daac97611e3c52556e023f66207966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de67bd1ace82f7151e54b5cc15628cb" id="r_a8de67bd1ace82f7151e54b5cc15628cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a8de67bd1ace82f7151e54b5cc15628cb">test_groupby_complex_raises</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:a8de67bd1ace82f7151e54b5cc15628cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a7f985ed1f79b13afae305fb588ed7" id="r_ae5a7f985ed1f79b13afae305fb588ed7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#ae5a7f985ed1f79b13afae305fb588ed7">test_multi_axis_1_raises</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:ae5a7f985ed1f79b13afae305fb588ed7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c5c27219ee07bfbe54cde01bd9c9e3d" id="r_a7c5c27219ee07bfbe54cde01bd9c9e3d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1aggregate_1_1test__aggregate.html#a7c5c27219ee07bfbe54cde01bd9c9e3d">test_agg_of_mode_list</a> (test, constant)</td></tr>
<tr class="separator:a7c5c27219ee07bfbe54cde01bd9c9e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">test .agg behavior / note that .apply is tested generally in test_groupby.py
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="acd0fb6b09a17ac022d8176b2db74798f" name="acd0fb6b09a17ac022d8176b2db74798f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd0fb6b09a17ac022d8176b2db74798f">&#9670;&#160;</a></span>myfunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.myfunc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1005</span><span class="keyword">def </span>myfunc(s):</div>
<div class="line"><span class="lineno"> 1006</span>    <span class="keywordflow">return</span> np.percentile(s, q=0.90)</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span><span class="preprocessor">@pytest.mark.parametrize(&quot;func&quot;, [lambda s: np.percentile(s, q=0.90)</span>, myfunc])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6657179c98ded72ee1224caf92dc5f12" name="a6657179c98ded72ee1224caf92dc5f12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6657179c98ded72ee1224caf92dc5f12">&#9670;&#160;</a></span>test_agg_apply_corner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_apply_corner </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tsframe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  135</span><span class="keyword">def </span>test_agg_apply_corner(ts, tsframe):</div>
<div class="line"><span class="lineno">  136</span>    <span class="comment"># nothing to group, all NA</span></div>
<div class="line"><span class="lineno">  137</span>    grouped = ts.groupby(ts * np.nan, group_keys=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  138</span>    <span class="keyword">assert</span> ts.dtype == np.float64</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <span class="comment"># groupby float64 values results in Float64Index</span></div>
<div class="line"><span class="lineno">  141</span>    exp = Series([], dtype=np.float64, index=Index([], dtype=np.float64))</div>
<div class="line"><span class="lineno">  142</span>    tm.assert_series_equal(grouped.sum(), exp)</div>
<div class="line"><span class="lineno">  143</span>    tm.assert_series_equal(grouped.agg(np.sum), exp)</div>
<div class="line"><span class="lineno">  144</span>    tm.assert_series_equal(grouped.apply(np.sum), exp, check_index_type=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment"># DataFrame</span></div>
<div class="line"><span class="lineno">  147</span>    grouped = tsframe.groupby(tsframe[<span class="stringliteral">&quot;A&quot;</span>] * np.nan, group_keys=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  148</span>    exp_df = DataFrame(</div>
<div class="line"><span class="lineno">  149</span>        columns=tsframe.columns,</div>
<div class="line"><span class="lineno">  150</span>        dtype=float,</div>
<div class="line"><span class="lineno">  151</span>        index=Index([], name=<span class="stringliteral">&quot;A&quot;</span>, dtype=np.float64),</div>
<div class="line"><span class="lineno">  152</span>    )</div>
<div class="line"><span class="lineno">  153</span>    tm.assert_frame_equal(grouped.sum(), exp_df)</div>
<div class="line"><span class="lineno">  154</span>    tm.assert_frame_equal(grouped.agg(np.sum), exp_df)</div>
<div class="line"><span class="lineno">  155</span>    tm.assert_frame_equal(grouped.apply(np.sum), exp_df)</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dc8e3eb3104c6922a64de05b613f5f0" name="a1dc8e3eb3104c6922a64de05b613f5f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dc8e3eb3104c6922a64de05b613f5f0">&#9670;&#160;</a></span>test_agg_grouping_is_list_tuple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_grouping_is_list_tuple </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  158</span><span class="keyword">def </span>test_agg_grouping_is_list_tuple(ts):</div>
<div class="line"><span class="lineno">  159</span>    df = tm.makeTimeDataFrame()</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>    grouped = df.groupby(<span class="keyword">lambda</span> x: x.year)</div>
<div class="line"><span class="lineno">  162</span>    grouper = grouped.grouper.groupings[0].grouping_vector</div>
<div class="line"><span class="lineno">  163</span>    grouped.grouper.groupings[0] = Grouping(ts.index, list(grouper))</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    result = grouped.agg(np.mean)</div>
<div class="line"><span class="lineno">  166</span>    expected = grouped.mean()</div>
<div class="line"><span class="lineno">  167</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    grouped.grouper.groupings[0] = Grouping(ts.index, tuple(grouper))</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    result = grouped.agg(np.mean)</div>
<div class="line"><span class="lineno">  172</span>    expected = grouped.mean()</div>
<div class="line"><span class="lineno">  173</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a2c0b024999fc9d978b67e4beba33a1" name="a5a2c0b024999fc9d978b67e4beba33a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a2c0b024999fc9d978b67e4beba33a1">&#9670;&#160;</a></span>test_agg_index_has_complex_internals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_index_has_complex_internals </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  614</span><span class="keyword">def </span>test_agg_index_has_complex_internals(index):</div>
<div class="line"><span class="lineno">  615</span>    <span class="comment"># GH 31223</span></div>
<div class="line"><span class="lineno">  616</span>    df = DataFrame({<span class="stringliteral">&quot;group&quot;</span>: [1, 1, 2], <span class="stringliteral">&quot;value&quot;</span>: [0, 1, 0]}, index=index)</div>
<div class="line"><span class="lineno">  617</span>    result = df.groupby(<span class="stringliteral">&quot;group&quot;</span>).agg({<span class="stringliteral">&quot;value&quot;</span>: Series.nunique})</div>
<div class="line"><span class="lineno">  618</span>    expected = DataFrame({<span class="stringliteral">&quot;group&quot;</span>: [1, 2], <span class="stringliteral">&quot;value&quot;</span>: [2, 1]}).set_index(<span class="stringliteral">&quot;group&quot;</span>)</div>
<div class="line"><span class="lineno">  619</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3ab97da4df31c68312163843476c203" name="ad3ab97da4df31c68312163843476c203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3ab97da4df31c68312163843476c203">&#9670;&#160;</a></span>test_agg_multiple_functions_maintain_order()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_multiple_functions_maintain_order </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  321</span><span class="keyword">def </span>test_agg_multiple_functions_maintain_order(df):</div>
<div class="line"><span class="lineno">  322</span>    <span class="comment"># GH #610</span></div>
<div class="line"><span class="lineno">  323</span>    funcs = [(<span class="stringliteral">&quot;mean&quot;</span>, np.mean), (<span class="stringliteral">&quot;max&quot;</span>, np.max), (<span class="stringliteral">&quot;min&quot;</span>, np.min)]</div>
<div class="line"><span class="lineno">  324</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)[<span class="stringliteral">&quot;C&quot;</span>].agg(funcs)</div>
<div class="line"><span class="lineno">  325</span>    exp_cols = Index([<span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>])</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    tm.assert_index_equal(result.columns, exp_cols)</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1516984be110f1f6cc8d2bf77d5043e" name="aa1516984be110f1f6cc8d2bf77d5043e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1516984be110f1f6cc8d2bf77d5043e">&#9670;&#160;</a></span>test_agg_multiple_functions_same_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_multiple_functions_same_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  330</span><span class="keyword">def </span>test_agg_multiple_functions_same_name():</div>
<div class="line"><span class="lineno">  331</span>    <span class="comment"># GH 30880</span></div>
<div class="line"><span class="lineno">  332</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  333</span>        np.random.randn(1000, 3),</div>
<div class="line"><span class="lineno">  334</span>        index=pd.date_range(<span class="stringliteral">&quot;1/1/2012&quot;</span>, freq=<span class="stringliteral">&quot;S&quot;</span>, periods=1000),</div>
<div class="line"><span class="lineno">  335</span>        columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>],</div>
<div class="line"><span class="lineno">  336</span>    )</div>
<div class="line"><span class="lineno">  337</span>    result = df.resample(<span class="stringliteral">&quot;3T&quot;</span>).agg(</div>
<div class="line"><span class="lineno">  338</span>        {<span class="stringliteral">&quot;A&quot;</span>: [partial(np.quantile, q=0.9999), partial(np.quantile, q=0.1111)]}</div>
<div class="line"><span class="lineno">  339</span>    )</div>
<div class="line"><span class="lineno">  340</span>    expected_index = pd.date_range(<span class="stringliteral">&quot;1/1/2012&quot;</span>, freq=<span class="stringliteral">&quot;3T&quot;</span>, periods=6)</div>
<div class="line"><span class="lineno">  341</span>    expected_columns = MultiIndex.from_tuples([(<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;quantile&quot;</span>), (<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;quantile&quot;</span>)])</div>
<div class="line"><span class="lineno">  342</span>    expected_values = np.array(</div>
<div class="line"><span class="lineno">  343</span>        [df.resample(<span class="stringliteral">&quot;3T&quot;</span>).A.quantile(q=q).values <span class="keywordflow">for</span> q <span class="keywordflow">in</span> [0.9999, 0.1111]]</div>
<div class="line"><span class="lineno">  344</span>    ).T</div>
<div class="line"><span class="lineno">  345</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  346</span>        expected_values, columns=expected_columns, index=expected_index</div>
<div class="line"><span class="lineno">  347</span>    )</div>
<div class="line"><span class="lineno">  348</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d0c5f9ef6cb73d75c2a3690f67bf098" name="a3d0c5f9ef6cb73d75c2a3690f67bf098"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d0c5f9ef6cb73d75c2a3690f67bf098">&#9670;&#160;</a></span>test_agg_multiple_functions_same_name_with_ohlc_present()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_multiple_functions_same_name_with_ohlc_present </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  351</span><span class="keyword">def </span>test_agg_multiple_functions_same_name_with_ohlc_present():</div>
<div class="line"><span class="lineno">  352</span>    <span class="comment"># GH 30880</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="comment"># ohlc expands dimensions, so different test to the above is required.</span></div>
<div class="line"><span class="lineno">  354</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  355</span>        np.random.randn(1000, 3),</div>
<div class="line"><span class="lineno">  356</span>        index=pd.date_range(<span class="stringliteral">&quot;1/1/2012&quot;</span>, freq=<span class="stringliteral">&quot;S&quot;</span>, periods=1000, name=<span class="stringliteral">&quot;dti&quot;</span>),</div>
<div class="line"><span class="lineno">  357</span>        columns=Index([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>], name=<span class="stringliteral">&quot;alpha&quot;</span>),</div>
<div class="line"><span class="lineno">  358</span>    )</div>
<div class="line"><span class="lineno">  359</span>    result = df.resample(<span class="stringliteral">&quot;3T&quot;</span>).agg(</div>
<div class="line"><span class="lineno">  360</span>        {<span class="stringliteral">&quot;A&quot;</span>: [<span class="stringliteral">&quot;ohlc&quot;</span>, partial(np.quantile, q=0.9999), partial(np.quantile, q=0.1111)]}</div>
<div class="line"><span class="lineno">  361</span>    )</div>
<div class="line"><span class="lineno">  362</span>    expected_index = pd.date_range(<span class="stringliteral">&quot;1/1/2012&quot;</span>, freq=<span class="stringliteral">&quot;3T&quot;</span>, periods=6, name=<span class="stringliteral">&quot;dti&quot;</span>)</div>
<div class="line"><span class="lineno">  363</span>    expected_columns = MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno">  364</span>        [</div>
<div class="line"><span class="lineno">  365</span>            (<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;ohlc&quot;</span>, <span class="stringliteral">&quot;open&quot;</span>),</div>
<div class="line"><span class="lineno">  366</span>            (<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;ohlc&quot;</span>, <span class="stringliteral">&quot;high&quot;</span>),</div>
<div class="line"><span class="lineno">  367</span>            (<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;ohlc&quot;</span>, <span class="stringliteral">&quot;low&quot;</span>),</div>
<div class="line"><span class="lineno">  368</span>            (<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;ohlc&quot;</span>, <span class="stringliteral">&quot;close&quot;</span>),</div>
<div class="line"><span class="lineno">  369</span>            (<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;quantile&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>),</div>
<div class="line"><span class="lineno">  370</span>            (<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;quantile&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>),</div>
<div class="line"><span class="lineno">  371</span>        ],</div>
<div class="line"><span class="lineno">  372</span>        names=[<span class="stringliteral">&quot;alpha&quot;</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  373</span>    )</div>
<div class="line"><span class="lineno">  374</span>    non_ohlc_expected_values = np.array(</div>
<div class="line"><span class="lineno">  375</span>        [df.resample(<span class="stringliteral">&quot;3T&quot;</span>).A.quantile(q=q).values <span class="keywordflow">for</span> q <span class="keywordflow">in</span> [0.9999, 0.1111]]</div>
<div class="line"><span class="lineno">  376</span>    ).T</div>
<div class="line"><span class="lineno">  377</span>    expected_values = np.hstack([df.resample(<span class="stringliteral">&quot;3T&quot;</span>).A.ohlc(), non_ohlc_expected_values])</div>
<div class="line"><span class="lineno">  378</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  379</span>        expected_values, columns=expected_columns, index=expected_index</div>
<div class="line"><span class="lineno">  380</span>    )</div>
<div class="line"><span class="lineno">  381</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a74e0cd2770dc5f030f70b29beb6a107e" name="a74e0cd2770dc5f030f70b29beb6a107e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74e0cd2770dc5f030f70b29beb6a107e">&#9670;&#160;</a></span>test_agg_must_agg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_must_agg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   48</span><span class="keyword">def </span>test_agg_must_agg(df):</div>
<div class="line"><span class="lineno">   49</span>    grouped = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)[<span class="stringliteral">&quot;C&quot;</span>]</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    msg = <span class="stringliteral">&quot;Must produce aggregated value&quot;</span></div>
<div class="line"><span class="lineno">   52</span>    <span class="keyword">with</span> pytest.raises(Exception, match=msg):</div>
<div class="line"><span class="lineno">   53</span>        grouped.agg(<span class="keyword">lambda</span> x: x.describe())</div>
<div class="line"><span class="lineno">   54</span>    <span class="keyword">with</span> pytest.raises(Exception, match=msg):</div>
<div class="line"><span class="lineno">   55</span>        grouped.agg(<span class="keyword">lambda</span> x: x.index[:2])</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c5c27219ee07bfbe54cde01bd9c9e3d" name="a7c5c27219ee07bfbe54cde01bd9c9e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c5c27219ee07bfbe54cde01bd9c9e3d">&#9670;&#160;</a></span>test_agg_of_mode_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_of_mode_list </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1447</span><span class="keyword">def </span>test_agg_of_mode_list(test, constant):</div>
<div class="line"><span class="lineno"> 1448</span>    <span class="comment"># GH#25581</span></div>
<div class="line"><span class="lineno"> 1449</span>    df1 = DataFrame(test)</div>
<div class="line"><span class="lineno"> 1450</span>    result = df1.groupby(0).agg(Series.mode)</div>
<div class="line"><span class="lineno"> 1451</span>    <span class="comment"># Mode usually only returns 1 value, but can return a list in the case of a tie.</span></div>
<div class="line"><span class="lineno"> 1452</span> </div>
<div class="line"><span class="lineno"> 1453</span>    expected = DataFrame(constant)</div>
<div class="line"><span class="lineno"> 1454</span>    expected = expected.set_index(0)</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>    tm.assert_frame_equal(result, expected)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1545e653acbb6db6e6b81600bc13bf1" name="ac1545e653acbb6db6e6b81600bc13bf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1545e653acbb6db6e6b81600bc13bf1">&#9670;&#160;</a></span>test_agg_python_multiindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_python_multiindex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mframe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  176</span><span class="keyword">def </span>test_agg_python_multiindex(mframe):</div>
<div class="line"><span class="lineno">  177</span>    grouped = mframe.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>])</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    result = grouped.agg(np.mean)</div>
<div class="line"><span class="lineno">  180</span>    expected = grouped.mean()</div>
<div class="line"><span class="lineno">  181</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  185</span>    <span class="stringliteral">&quot;groupbyfunc&quot;</span>, [<span class="keyword">lambda</span> x: x.weekday(), [<span class="keyword">lambda</span> x: x.month, <span class="keyword">lambda</span> x: x.weekday()]]</div>
<div class="line"><span class="lineno">  186</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a70db2cac10b7e4f0822ff09cf26fcf05" name="a70db2cac10b7e4f0822ff09cf26fcf05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70db2cac10b7e4f0822ff09cf26fcf05">&#9670;&#160;</a></span>test_agg_regression1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_regression1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tsframe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   41</span><span class="keyword">def </span>test_agg_regression1(tsframe):</div>
<div class="line"><span class="lineno">   42</span>    grouped = tsframe.groupby([<span class="keyword">lambda</span> x: x.year, <span class="keyword">lambda</span> x: x.month])</div>
<div class="line"><span class="lineno">   43</span>    result = grouped.agg(np.mean)</div>
<div class="line"><span class="lineno">   44</span>    expected = grouped.mean()</div>
<div class="line"><span class="lineno">   45</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fb0127d4ddc04337638a423ca8be193" name="a9fb0127d4ddc04337638a423ca8be193"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb0127d4ddc04337638a423ca8be193">&#9670;&#160;</a></span>test_agg_relabel_multiindex_column()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_relabel_multiindex_column </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>agg_col1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>agg_col2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>agg_col3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>agg_result1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>agg_result2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>agg_result3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  867</span>):</div>
<div class="line"><span class="lineno">  868</span>    <span class="comment"># GH 29422, add tests for multiindex column cases</span></div>
<div class="line"><span class="lineno">  869</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  870</span>        {<span class="stringliteral">&quot;group&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], <span class="stringliteral">&quot;A&quot;</span>: [0, 1, 2, 3], <span class="stringliteral">&quot;B&quot;</span>: [5, 6, 7, 8]}</div>
<div class="line"><span class="lineno">  871</span>    )</div>
<div class="line"><span class="lineno">  872</span>    df.columns = MultiIndex.from_tuples([(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>), (<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>), (<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>)])</div>
<div class="line"><span class="lineno">  873</span>    idx = Index([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], name=(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>))</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>    result = df.groupby((<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>)).agg(a_max=((<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>), <span class="stringliteral">&quot;max&quot;</span>))</div>
<div class="line"><span class="lineno">  876</span>    expected = DataFrame({<span class="stringliteral">&quot;a_max&quot;</span>: [1, 3]}, index=idx)</div>
<div class="line"><span class="lineno">  877</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>    result = df.groupby((<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>)).agg(</div>
<div class="line"><span class="lineno">  880</span>        col_1=agg_col1, col_2=agg_col2, col_3=agg_col3</div>
<div class="line"><span class="lineno">  881</span>    )</div>
<div class="line"><span class="lineno">  882</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  883</span>        {<span class="stringliteral">&quot;col_1&quot;</span>: agg_result1, <span class="stringliteral">&quot;col_2&quot;</span>: agg_result2, <span class="stringliteral">&quot;col_3&quot;</span>: agg_result3}, index=idx</div>
<div class="line"><span class="lineno">  884</span>    )</div>
<div class="line"><span class="lineno">  885</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a46e775e04637e96d323824888f0d23d4" name="a46e775e04637e96d323824888f0d23d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46e775e04637e96d323824888f0d23d4">&#9670;&#160;</a></span>test_agg_relabel_multiindex_duplicates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_relabel_multiindex_duplicates </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  899</span><span class="keyword">def </span>test_agg_relabel_multiindex_duplicates():</div>
<div class="line"><span class="lineno">  900</span>    <span class="comment"># GH29422, add test for raises scenario when getting duplicates</span></div>
<div class="line"><span class="lineno">  901</span>    <span class="comment"># GH28426, after this change, duplicates should also work if the relabelling is</span></div>
<div class="line"><span class="lineno">  902</span>    <span class="comment"># different</span></div>
<div class="line"><span class="lineno">  903</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  904</span>        {<span class="stringliteral">&quot;group&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], <span class="stringliteral">&quot;A&quot;</span>: [0, 1, 2, 3], <span class="stringliteral">&quot;B&quot;</span>: [5, 6, 7, 8]}</div>
<div class="line"><span class="lineno">  905</span>    )</div>
<div class="line"><span class="lineno">  906</span>    df.columns = MultiIndex.from_tuples([(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>), (<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>), (<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>)])</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>    result = df.groupby((<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>)).agg(</div>
<div class="line"><span class="lineno">  909</span>        a=((<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>), <span class="stringliteral">&quot;min&quot;</span>), b=((<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>), <span class="stringliteral">&quot;min&quot;</span>)</div>
<div class="line"><span class="lineno">  910</span>    )</div>
<div class="line"><span class="lineno">  911</span>    idx = Index([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], name=(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>))</div>
<div class="line"><span class="lineno">  912</span>    expected = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [0, 2], <span class="stringliteral">&quot;b&quot;</span>: [0, 2]}, index=idx)</div>
<div class="line"><span class="lineno">  913</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kwargs&quot;, [{&quot;c&quot;: [&quot;min&quot;]}, {&quot;b&quot;: [], &quot;c&quot;: [&quot;min&quot;]}])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35782584728f9b51bdf9356f8dbb3c8a" name="a35782584728f9b51bdf9356f8dbb3c8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35782584728f9b51bdf9356f8dbb3c8a">&#9670;&#160;</a></span>test_agg_relabel_multiindex_raises_not_exist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_relabel_multiindex_raises_not_exist </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  888</span><span class="keyword">def </span>test_agg_relabel_multiindex_raises_not_exist():</div>
<div class="line"><span class="lineno">  889</span>    <span class="comment"># GH 29422, add test for raises scenario when aggregate column does not exist</span></div>
<div class="line"><span class="lineno">  890</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  891</span>        {<span class="stringliteral">&quot;group&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], <span class="stringliteral">&quot;A&quot;</span>: [0, 1, 2, 3], <span class="stringliteral">&quot;B&quot;</span>: [5, 6, 7, 8]}</div>
<div class="line"><span class="lineno">  892</span>    )</div>
<div class="line"><span class="lineno">  893</span>    df.columns = MultiIndex.from_tuples([(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>), (<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>), (<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>)])</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>    <span class="keyword">with</span> pytest.raises(KeyError, match=<span class="stringliteral">&quot;do not exist&quot;</span>):</div>
<div class="line"><span class="lineno">  896</span>        df.groupby((<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;group&quot;</span>)).agg(a=((<span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>), <span class="stringliteral">&quot;max&quot;</span>))</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7ba7dc980cb241f861e4fc086ccfbcc" name="aa7ba7dc980cb241f861e4fc086ccfbcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7ba7dc980cb241f861e4fc086ccfbcc">&#9670;&#160;</a></span>test_agg_ser_multi_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_ser_multi_key </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   58</span><span class="keyword">def </span>test_agg_ser_multi_key(df):</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    f = <span class="keyword">lambda</span> x: x.sum()</div>
<div class="line"><span class="lineno">   61</span>    results = df.C.groupby([df.A, df.B]).aggregate(f)</div>
<div class="line"><span class="lineno">   62</span>    expected = df.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>]).sum()[<span class="stringliteral">&quot;C&quot;</span>]</div>
<div class="line"><span class="lineno">   63</span>    tm.assert_series_equal(results, expected)</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6672b418bbaae00af51f0046197f028" name="ae6672b418bbaae00af51f0046197f028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6672b418bbaae00af51f0046197f028">&#9670;&#160;</a></span>test_agg_split_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_split_block </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  622</span><span class="keyword">def </span>test_agg_split_block():</div>
<div class="line"><span class="lineno">  623</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/31522</span></div>
<div class="line"><span class="lineno">  624</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  625</span>        {</div>
<div class="line"><span class="lineno">  626</span>            <span class="stringliteral">&quot;key1&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>],</div>
<div class="line"><span class="lineno">  627</span>            <span class="stringliteral">&quot;key2&quot;</span>: [<span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>, <span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>, <span class="stringliteral">&quot;one&quot;</span>],</div>
<div class="line"><span class="lineno">  628</span>            <span class="stringliteral">&quot;key3&quot;</span>: [<span class="stringliteral">&quot;three&quot;</span>, <span class="stringliteral">&quot;three&quot;</span>, <span class="stringliteral">&quot;three&quot;</span>, <span class="stringliteral">&quot;six&quot;</span>, <span class="stringliteral">&quot;six&quot;</span>],</div>
<div class="line"><span class="lineno">  629</span>        }</div>
<div class="line"><span class="lineno">  630</span>    )</div>
<div class="line"><span class="lineno">  631</span>    result = df.groupby(<span class="stringliteral">&quot;key1&quot;</span>).min()</div>
<div class="line"><span class="lineno">  632</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  633</span>        {<span class="stringliteral">&quot;key2&quot;</span>: [<span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;one&quot;</span>], <span class="stringliteral">&quot;key3&quot;</span>: [<span class="stringliteral">&quot;six&quot;</span>, <span class="stringliteral">&quot;six&quot;</span>]},</div>
<div class="line"><span class="lineno">  634</span>        index=Index([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], name=<span class="stringliteral">&quot;key1&quot;</span>),</div>
<div class="line"><span class="lineno">  635</span>    )</div>
<div class="line"><span class="lineno">  636</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abcfa2dbcacafee31efab7d997500fef2" name="abcfa2dbcacafee31efab7d997500fef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcfa2dbcacafee31efab7d997500fef2">&#9670;&#160;</a></span>test_agg_split_object_part_datetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_split_object_part_datetime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  639</span><span class="keyword">def </span>test_agg_split_object_part_datetime():</div>
<div class="line"><span class="lineno">  640</span>    <span class="comment"># https://github.com/pandas-dev/pandas/pull/31616</span></div>
<div class="line"><span class="lineno">  641</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  642</span>        {</div>
<div class="line"><span class="lineno">  643</span>            <span class="stringliteral">&quot;A&quot;</span>: pd.date_range(<span class="stringliteral">&quot;2000&quot;</span>, periods=4),</div>
<div class="line"><span class="lineno">  644</span>            <span class="stringliteral">&quot;B&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>],</div>
<div class="line"><span class="lineno">  645</span>            <span class="stringliteral">&quot;C&quot;</span>: [1, 2, 3, 4],</div>
<div class="line"><span class="lineno">  646</span>            <span class="stringliteral">&quot;D&quot;</span>: [<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>],</div>
<div class="line"><span class="lineno">  647</span>            <span class="stringliteral">&quot;E&quot;</span>: pd.date_range(<span class="stringliteral">&quot;2000&quot;</span>, periods=4),</div>
<div class="line"><span class="lineno">  648</span>            <span class="stringliteral">&quot;F&quot;</span>: [1, 2, 3, 4],</div>
<div class="line"><span class="lineno">  649</span>        }</div>
<div class="line"><span class="lineno">  650</span>    ).astype(object)</div>
<div class="line"><span class="lineno">  651</span>    result = df.groupby([0, 0, 0, 0]).min()</div>
<div class="line"><span class="lineno">  652</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  653</span>        {</div>
<div class="line"><span class="lineno">  654</span>            <span class="stringliteral">&quot;A&quot;</span>: [pd.Timestamp(<span class="stringliteral">&quot;2000&quot;</span>)],</div>
<div class="line"><span class="lineno">  655</span>            <span class="stringliteral">&quot;B&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>],</div>
<div class="line"><span class="lineno">  656</span>            <span class="stringliteral">&quot;C&quot;</span>: [1],</div>
<div class="line"><span class="lineno">  657</span>            <span class="stringliteral">&quot;D&quot;</span>: [<span class="stringliteral">&quot;b&quot;</span>],</div>
<div class="line"><span class="lineno">  658</span>            <span class="stringliteral">&quot;E&quot;</span>: [pd.Timestamp(<span class="stringliteral">&quot;2000&quot;</span>)],</div>
<div class="line"><span class="lineno">  659</span>            <span class="stringliteral">&quot;F&quot;</span>: [1],</div>
<div class="line"><span class="lineno">  660</span>        }</div>
<div class="line"><span class="lineno">  661</span>    )</div>
<div class="line"><span class="lineno">  662</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e389852d8fa86372d87d4cb36df6f92" name="a8e389852d8fa86372d87d4cb36df6f92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e389852d8fa86372d87d4cb36df6f92">&#9670;&#160;</a></span>test_agg_str_with_kwarg_axis_1_raises()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_agg_str_with_kwarg_axis_1_raises </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reduction_func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  213</span><span class="keyword">def </span>test_agg_str_with_kwarg_axis_1_raises(df, reduction_func):</div>
<div class="line"><span class="lineno">  214</span>    gb = df.groupby(level=0)</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">if</span> reduction_func <span class="keywordflow">in</span> (<span class="stringliteral">&quot;idxmax&quot;</span>, <span class="stringliteral">&quot;idxmin&quot;</span>):</div>
<div class="line"><span class="lineno">  216</span>        error = TypeError</div>
<div class="line"><span class="lineno">  217</span>        msg = <span class="stringliteral">&quot;reduction operation &#39;.*&#39; not allowed for this dtype&quot;</span></div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  219</span>        error = ValueError</div>
<div class="line"><span class="lineno">  220</span>        msg = f<span class="stringliteral">&quot;Operation {reduction_func} does not support axis=1&quot;</span></div>
<div class="line"><span class="lineno">  221</span>    <span class="keyword">with</span> pytest.raises(error, match=msg):</div>
<div class="line"><span class="lineno">  222</span>        gb.agg(reduction_func, axis=1)</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  226</span>    <span class="stringliteral">&quot;func, expected, dtype, result_dtype_dict&quot;</span>,</div>
<div class="line"><span class="lineno">  227</span>    [</div>
<div class="line"><span class="lineno">  228</span>        (<span class="stringliteral">&quot;sum&quot;</span>, [5, 7, 9], <span class="stringliteral">&quot;int64&quot;</span>, {}),</div>
<div class="line"><span class="lineno">  229</span>        (<span class="stringliteral">&quot;std&quot;</span>, [4.5**0.5] * 3, int, {<span class="stringliteral">&quot;i&quot;</span>: float, <span class="stringliteral">&quot;j&quot;</span>: float, <span class="stringliteral">&quot;k&quot;</span>: float}),</div>
<div class="line"><span class="lineno">  230</span>        (<span class="stringliteral">&quot;var&quot;</span>, [4.5] * 3, int, {<span class="stringliteral">&quot;i&quot;</span>: float, <span class="stringliteral">&quot;j&quot;</span>: float, <span class="stringliteral">&quot;k&quot;</span>: float}),</div>
<div class="line"><span class="lineno">  231</span>        (<span class="stringliteral">&quot;sum&quot;</span>, [5, 7, 9], <span class="stringliteral">&quot;Int64&quot;</span>, {<span class="stringliteral">&quot;j&quot;</span>: <span class="stringliteral">&quot;int64&quot;</span>}),</div>
<div class="line"><span class="lineno">  232</span>        (<span class="stringliteral">&quot;std&quot;</span>, [4.5**0.5] * 3, <span class="stringliteral">&quot;Int64&quot;</span>, {<span class="stringliteral">&quot;i&quot;</span>: float, <span class="stringliteral">&quot;j&quot;</span>: float, <span class="stringliteral">&quot;k&quot;</span>: float}),</div>
<div class="line"><span class="lineno">  233</span>        (<span class="stringliteral">&quot;var&quot;</span>, [4.5] * 3, <span class="stringliteral">&quot;Int64&quot;</span>, {<span class="stringliteral">&quot;i&quot;</span>: <span class="stringliteral">&quot;float64&quot;</span>, <span class="stringliteral">&quot;j&quot;</span>: <span class="stringliteral">&quot;float64&quot;</span>, <span class="stringliteral">&quot;k&quot;</span>: <span class="stringliteral">&quot;float64&quot;</span>}),</div>
<div class="line"><span class="lineno">  234</span>    ],</div>
<div class="line"><span class="lineno">  235</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af9c7a25fbf2af54bc96fe51a1bbcac39" name="af9c7a25fbf2af54bc96fe51a1bbcac39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9c7a25fbf2af54bc96fe51a1bbcac39">&#9670;&#160;</a></span>test_aggregate_datetime_objects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_aggregate_datetime_objects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1299</span><span class="keyword">def </span>test_aggregate_datetime_objects():</div>
<div class="line"><span class="lineno"> 1300</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/36003</span></div>
<div class="line"><span class="lineno"> 1301</span>    <span class="comment"># ensure we don&#39;t raise an error but keep object dtype for out-of-bounds</span></div>
<div class="line"><span class="lineno"> 1302</span>    <span class="comment"># datetimes</span></div>
<div class="line"><span class="lineno"> 1303</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1304</span>        {</div>
<div class="line"><span class="lineno"> 1305</span>            <span class="stringliteral">&quot;A&quot;</span>: [<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>],</div>
<div class="line"><span class="lineno"> 1306</span>            <span class="stringliteral">&quot;B&quot;</span>: [</div>
<div class="line"><span class="lineno"> 1307</span>                datetime.datetime(2005, 1, 1, 10, 30, 23, 540000),</div>
<div class="line"><span class="lineno"> 1308</span>                datetime.datetime(3005, 1, 1, 10, 30, 23, 540000),</div>
<div class="line"><span class="lineno"> 1309</span>            ],</div>
<div class="line"><span class="lineno"> 1310</span>        }</div>
<div class="line"><span class="lineno"> 1311</span>    )</div>
<div class="line"><span class="lineno"> 1312</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).B.max()</div>
<div class="line"><span class="lineno"> 1313</span>    expected = df.set_index(<span class="stringliteral">&quot;A&quot;</span>)[<span class="stringliteral">&quot;B&quot;</span>]</div>
<div class="line"><span class="lineno"> 1314</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9235133b40fcfe815a66e812477034d8" name="a9235133b40fcfe815a66e812477034d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9235133b40fcfe815a66e812477034d8">&#9670;&#160;</a></span>test_aggregate_item_by_item()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_aggregate_item_by_item </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  281</span><span class="keyword">def </span>test_aggregate_item_by_item(df):</div>
<div class="line"><span class="lineno">  282</span>    grouped = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    aggfun = <span class="keyword">lambda</span> ser: ser.size</div>
<div class="line"><span class="lineno">  285</span>    result = grouped.agg(aggfun)</div>
<div class="line"><span class="lineno">  286</span>    foo = (df.A == <span class="stringliteral">&quot;foo&quot;</span>).sum()</div>
<div class="line"><span class="lineno">  287</span>    bar = (df.A == <span class="stringliteral">&quot;bar&quot;</span>).sum()</div>
<div class="line"><span class="lineno">  288</span>    K = len(result.columns)</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="comment"># GH5782</span></div>
<div class="line"><span class="lineno">  291</span>    exp = Series(np.array([foo] * K), index=list(<span class="stringliteral">&quot;BCD&quot;</span>), name=<span class="stringliteral">&quot;foo&quot;</span>)</div>
<div class="line"><span class="lineno">  292</span>    tm.assert_series_equal(result.xs(<span class="stringliteral">&quot;foo&quot;</span>), exp)</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    exp = Series(np.array([bar] * K), index=list(<span class="stringliteral">&quot;BCD&quot;</span>), name=<span class="stringliteral">&quot;bar&quot;</span>)</div>
<div class="line"><span class="lineno">  295</span>    tm.assert_almost_equal(result.xs(<span class="stringliteral">&quot;bar&quot;</span>), exp)</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="keyword">def </span>aggfun(ser):</div>
<div class="line"><span class="lineno">  298</span>        <span class="keywordflow">return</span> ser.size</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    result = DataFrame().groupby(df.A).agg(aggfun)</div>
<div class="line"><span class="lineno">  301</span>    <span class="keyword">assert</span> isinstance(result, DataFrame)</div>
<div class="line"><span class="lineno">  302</span>    <span class="keyword">assert</span> len(result) == 0</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a59a354d0a7d28ebc3bcc7bb05b9b87be" name="a59a354d0a7d28ebc3bcc7bb05b9b87be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a354d0a7d28ebc3bcc7bb05b9b87be">&#9670;&#160;</a></span>test_aggregate_mixed_types()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_aggregate_mixed_types </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1032</span><span class="keyword">def </span>test_aggregate_mixed_types():</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="comment"># GH 16916</span></div>
<div class="line"><span class="lineno"> 1034</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1035</span>        data=np.array([0] * 9).reshape(3, 3), columns=list(<span class="stringliteral">&quot;XYZ&quot;</span>), index=list(<span class="stringliteral">&quot;abc&quot;</span>)</div>
<div class="line"><span class="lineno"> 1036</span>    )</div>
<div class="line"><span class="lineno"> 1037</span>    df[<span class="stringliteral">&quot;grouping&quot;</span>] = [<span class="stringliteral">&quot;group 1&quot;</span>, <span class="stringliteral">&quot;group 1&quot;</span>, 2]</div>
<div class="line"><span class="lineno"> 1038</span>    result = df.groupby(<span class="stringliteral">&quot;grouping&quot;</span>).aggregate(<span class="keyword">lambda</span> x: x.tolist())</div>
<div class="line"><span class="lineno"> 1039</span>    expected_data = [[[0], [0], [0]], [[0, 0], [0, 0], [0, 0]]]</div>
<div class="line"><span class="lineno"> 1040</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1041</span>        expected_data,</div>
<div class="line"><span class="lineno"> 1042</span>        index=Index([2, <span class="stringliteral">&quot;group 1&quot;</span>], dtype=<span class="stringliteral">&quot;object&quot;</span>, name=<span class="stringliteral">&quot;grouping&quot;</span>),</div>
<div class="line"><span class="lineno"> 1043</span>        columns=Index([<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;Z&quot;</span>], dtype=<span class="stringliteral">&quot;object&quot;</span>),</div>
<div class="line"><span class="lineno"> 1044</span>    )</div>
<div class="line"><span class="lineno"> 1045</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span><span class="preprocessor">@pytest.mark.xfail(reason=&quot;Not implemented;see GH 31256&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7db97bd970ff666b715619792b9d3f71" name="a7db97bd970ff666b715619792b9d3f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7db97bd970ff666b715619792b9d3f71">&#9670;&#160;</a></span>test_aggregate_str_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_aggregate_str_func </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tsframe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groupbyfunc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  187</span><span class="keyword">def </span>test_aggregate_str_func(tsframe, groupbyfunc):</div>
<div class="line"><span class="lineno">  188</span>    grouped = tsframe.groupby(groupbyfunc)</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <span class="comment"># single series</span></div>
<div class="line"><span class="lineno">  191</span>    result = grouped[<span class="stringliteral">&quot;A&quot;</span>].agg(<span class="stringliteral">&quot;std&quot;</span>)</div>
<div class="line"><span class="lineno">  192</span>    expected = grouped[<span class="stringliteral">&quot;A&quot;</span>].std()</div>
<div class="line"><span class="lineno">  193</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    <span class="comment"># group frame by function name</span></div>
<div class="line"><span class="lineno">  196</span>    result = grouped.aggregate(<span class="stringliteral">&quot;var&quot;</span>)</div>
<div class="line"><span class="lineno">  197</span>    expected = grouped.var()</div>
<div class="line"><span class="lineno">  198</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    <span class="comment"># group frame by function dict</span></div>
<div class="line"><span class="lineno">  201</span>    result = grouped.agg({<span class="stringliteral">&quot;A&quot;</span>: <span class="stringliteral">&quot;var&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>: <span class="stringliteral">&quot;std&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>: <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>: <span class="stringliteral">&quot;sem&quot;</span>})</div>
<div class="line"><span class="lineno">  202</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  203</span>        {</div>
<div class="line"><span class="lineno">  204</span>            <span class="stringliteral">&quot;A&quot;</span>: grouped[<span class="stringliteral">&quot;A&quot;</span>].var(),</div>
<div class="line"><span class="lineno">  205</span>            <span class="stringliteral">&quot;B&quot;</span>: grouped[<span class="stringliteral">&quot;B&quot;</span>].std(),</div>
<div class="line"><span class="lineno">  206</span>            <span class="stringliteral">&quot;C&quot;</span>: grouped[<span class="stringliteral">&quot;C&quot;</span>].mean(),</div>
<div class="line"><span class="lineno">  207</span>            <span class="stringliteral">&quot;D&quot;</span>: grouped[<span class="stringliteral">&quot;D&quot;</span>].sem(),</div>
<div class="line"><span class="lineno">  208</span>        }</div>
<div class="line"><span class="lineno">  209</span>    )</div>
<div class="line"><span class="lineno">  210</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a90e9f63ac30d47c6be6edaafaa0900d2" name="a90e9f63ac30d47c6be6edaafaa0900d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90e9f63ac30d47c6be6edaafaa0900d2">&#9670;&#160;</a></span>test_aggregate_udf_na_extension_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_aggregate_udf_na_extension_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1049</span><span class="keyword">def </span>test_aggregate_udf_na_extension_type():</div>
<div class="line"><span class="lineno"> 1050</span>    <span class="comment"># https://github.com/pandas-dev/pandas/pull/31359</span></div>
<div class="line"><span class="lineno"> 1051</span>    <span class="comment"># This is currently failing to cast back to Int64Dtype.</span></div>
<div class="line"><span class="lineno"> 1052</span>    <span class="comment"># The presence of the NA causes two problems</span></div>
<div class="line"><span class="lineno"> 1053</span>    <span class="comment"># 1. NA is not an instance of Int64Dtype.type (numpy.int64)</span></div>
<div class="line"><span class="lineno"> 1054</span>    <span class="comment"># 2. The presence of an NA forces object type, so the non-NA values is</span></div>
<div class="line"><span class="lineno"> 1055</span>    <span class="comment">#    a Python int rather than a NumPy int64. Python ints aren&#39;t</span></div>
<div class="line"><span class="lineno"> 1056</span>    <span class="comment">#    instances of numpy.int64.</span></div>
<div class="line"><span class="lineno"> 1057</span>    <span class="keyword">def </span>aggfunc(x):</div>
<div class="line"><span class="lineno"> 1058</span>        <span class="keywordflow">if</span> all(x &gt; 2):</div>
<div class="line"><span class="lineno"> 1059</span>            <span class="keywordflow">return</span> 1</div>
<div class="line"><span class="lineno"> 1060</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1061</span>            <span class="keywordflow">return</span> pd.NA</div>
<div class="line"><span class="lineno"> 1062</span> </div>
<div class="line"><span class="lineno"> 1063</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: pd.array([1, 2, 3])})</div>
<div class="line"><span class="lineno"> 1064</span>    result = df.groupby([1, 1, 2]).agg(aggfunc)</div>
<div class="line"><span class="lineno"> 1065</span>    expected = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: pd.array([1, pd.NA], dtype=<span class="stringliteral">&quot;Int64&quot;</span>)}, index=[1, 2])</div>
<div class="line"><span class="lineno"> 1066</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9a7b35cf6c8ba3e7e0be70db57d18c6" name="ae9a7b35cf6c8ba3e7e0be70db57d18c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9a7b35cf6c8ba3e7e0be70db57d18c6">&#9670;&#160;</a></span>test_bool_agg_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_bool_agg_dtype </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  491</span><span class="keyword">def </span>test_bool_agg_dtype(op):</div>
<div class="line"><span class="lineno">  492</span>    <span class="comment"># GH 7001</span></div>
<div class="line"><span class="lineno">  493</span>    <span class="comment"># Bool sum aggregations result in int</span></div>
<div class="line"><span class="lineno">  494</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1], <span class="stringliteral">&quot;b&quot;</span>: [<span class="keyword">False</span>, <span class="keyword">True</span>]})</div>
<div class="line"><span class="lineno">  495</span>    s = df.set_index(<span class="stringliteral">&quot;a&quot;</span>)[<span class="stringliteral">&quot;b&quot;</span>]</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    result = op(df.groupby(<span class="stringliteral">&quot;a&quot;</span>))[<span class="stringliteral">&quot;b&quot;</span>].dtype</div>
<div class="line"><span class="lineno">  498</span>    <span class="keyword">assert</span> is_integer_dtype(result)</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>    result = op(s.groupby(<span class="stringliteral">&quot;a&quot;</span>)).dtype</div>
<div class="line"><span class="lineno">  501</span>    <span class="keyword">assert</span> is_integer_dtype(result)</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  505</span>    <span class="stringliteral">&quot;keys, agg_index&quot;</span>,</div>
<div class="line"><span class="lineno">  506</span>    [</div>
<div class="line"><span class="lineno">  507</span>        ([<span class="stringliteral">&quot;a&quot;</span>], Index([1], name=<span class="stringliteral">&quot;a&quot;</span>)),</div>
<div class="line"><span class="lineno">  508</span>        ([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], MultiIndex([[1], [2]], [[0], [0]], names=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>])),</div>
<div class="line"><span class="lineno">  509</span>    ],</div>
<div class="line"><span class="lineno">  510</span>)</div>
<div class="line"><span class="lineno">  511</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  512</span>    <span class="stringliteral">&quot;input_dtype&quot;</span>, [<span class="stringliteral">&quot;bool&quot;</span>, <span class="stringliteral">&quot;int32&quot;</span>, <span class="stringliteral">&quot;int64&quot;</span>, <span class="stringliteral">&quot;float32&quot;</span>, <span class="stringliteral">&quot;float64&quot;</span>]</div>
<div class="line"><span class="lineno">  513</span>)</div>
<div class="line"><span class="lineno">  514</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  515</span>    <span class="stringliteral">&quot;result_dtype&quot;</span>, [<span class="stringliteral">&quot;bool&quot;</span>, <span class="stringliteral">&quot;int32&quot;</span>, <span class="stringliteral">&quot;int64&quot;</span>, <span class="stringliteral">&quot;float32&quot;</span>, <span class="stringliteral">&quot;float64&quot;</span>]</div>
<div class="line"><span class="lineno">  516</span>)</div>
<div class="line"><span class="lineno">  517</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;apply&quot;, &quot;aggregate&quot;, &quot;transform&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad47e25f83e1465c0c62742a1e612fef9" name="ad47e25f83e1465c0c62742a1e612fef9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad47e25f83e1465c0c62742a1e612fef9">&#9670;&#160;</a></span>test_callable_result_dtype_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_callable_result_dtype_frame </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>agg_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  520</span>):</div>
<div class="line"><span class="lineno">  521</span>    <span class="comment"># GH 21240</span></div>
<div class="line"><span class="lineno">  522</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1], <span class="stringliteral">&quot;b&quot;</span>: [2], <span class="stringliteral">&quot;c&quot;</span>: [<span class="keyword">True</span>]})</div>
<div class="line"><span class="lineno">  523</span>    df[<span class="stringliteral">&quot;c&quot;</span>] = df[<span class="stringliteral">&quot;c&quot;</span>].astype(input_dtype)</div>
<div class="line"><span class="lineno">  524</span>    op = getattr(df.groupby(keys)[[<span class="stringliteral">&quot;c&quot;</span>]], method)</div>
<div class="line"><span class="lineno">  525</span>    result = op(<span class="keyword">lambda</span> x: x.astype(result_dtype).iloc[0])</div>
<div class="line"><span class="lineno">  526</span>    expected_index = pd.RangeIndex(0, 1) <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;transform&quot;</span> <span class="keywordflow">else</span> agg_index</div>
<div class="line"><span class="lineno">  527</span>    expected = DataFrame({<span class="stringliteral">&quot;c&quot;</span>: [df[<span class="stringliteral">&quot;c&quot;</span>].iloc[0]]}, index=expected_index).astype(</div>
<div class="line"><span class="lineno">  528</span>        result_dtype</div>
<div class="line"><span class="lineno">  529</span>    )</div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;apply&quot;</span>:</div>
<div class="line"><span class="lineno">  531</span>        expected.columns.names = [0]</div>
<div class="line"><span class="lineno">  532</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  536</span>    <span class="stringliteral">&quot;keys, agg_index&quot;</span>,</div>
<div class="line"><span class="lineno">  537</span>    [</div>
<div class="line"><span class="lineno">  538</span>        ([<span class="stringliteral">&quot;a&quot;</span>], Index([1], name=<span class="stringliteral">&quot;a&quot;</span>)),</div>
<div class="line"><span class="lineno">  539</span>        ([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], MultiIndex([[1], [2]], [[0], [0]], names=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>])),</div>
<div class="line"><span class="lineno">  540</span>    ],</div>
<div class="line"><span class="lineno">  541</span>)</div>
<div class="line"><span class="lineno">  542</span><span class="preprocessor">@pytest.mark.parametrize(&quot;input&quot;, [True, 1, 1.0])</span></div>
<div class="line"><span class="lineno">  543</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [bool, int, float])</span></div>
<div class="line"><span class="lineno">  544</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;apply&quot;, &quot;aggregate&quot;, &quot;transform&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90eef84f0dfe263774c22b7b5ee26add" name="a90eef84f0dfe263774c22b7b5ee26add"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90eef84f0dfe263774c22b7b5ee26add">&#9670;&#160;</a></span>test_callable_result_dtype_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_callable_result_dtype_series </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>agg_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  545</span><span class="keyword">def </span>test_callable_result_dtype_series(keys, agg_index, input, dtype, method):</div>
<div class="line"><span class="lineno">  546</span>    <span class="comment"># GH 21240</span></div>
<div class="line"><span class="lineno">  547</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1], <span class="stringliteral">&quot;b&quot;</span>: [2], <span class="stringliteral">&quot;c&quot;</span>: [input]})</div>
<div class="line"><span class="lineno">  548</span>    op = getattr(df.groupby(keys)[<span class="stringliteral">&quot;c&quot;</span>], method)</div>
<div class="line"><span class="lineno">  549</span>    result = op(<span class="keyword">lambda</span> x: x.astype(dtype).iloc[0])</div>
<div class="line"><span class="lineno">  550</span>    expected_index = pd.RangeIndex(0, 1) <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;transform&quot;</span> <span class="keywordflow">else</span> agg_index</div>
<div class="line"><span class="lineno">  551</span>    expected = Series([df[<span class="stringliteral">&quot;c&quot;</span>].iloc[0]], index=expected_index, name=<span class="stringliteral">&quot;c&quot;</span>).astype(dtype)</div>
<div class="line"><span class="lineno">  552</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3515b429ab9e74fca59fc32555ffbd8e" name="a3515b429ab9e74fca59fc32555ffbd8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3515b429ab9e74fca59fc32555ffbd8e">&#9670;&#160;</a></span>test_func_duplicates_raises()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_func_duplicates_raises </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  597</span><span class="keyword">def </span>test_func_duplicates_raises():</div>
<div class="line"><span class="lineno">  598</span>    <span class="comment"># GH28426</span></div>
<div class="line"><span class="lineno">  599</span>    msg = <span class="stringliteral">&quot;Function names&quot;</span></div>
<div class="line"><span class="lineno">  600</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [0, 0, 1, 1], <span class="stringliteral">&quot;B&quot;</span>: [1, 2, 3, 4]})</div>
<div class="line"><span class="lineno">  601</span>    <span class="keyword">with</span> pytest.raises(SpecificationError, match=msg):</div>
<div class="line"><span class="lineno">  602</span>        df.groupby(<span class="stringliteral">&quot;A&quot;</span>).agg([<span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>])</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  606</span>    <span class="stringliteral">&quot;index&quot;</span>,</div>
<div class="line"><span class="lineno">  607</span>    [</div>
<div class="line"><span class="lineno">  608</span>        pd.CategoricalIndex(list(<span class="stringliteral">&quot;abc&quot;</span>)),</div>
<div class="line"><span class="lineno">  609</span>        pd.interval_range(0, 3),</div>
<div class="line"><span class="lineno">  610</span>        pd.period_range(<span class="stringliteral">&quot;2020&quot;</span>, periods=3, freq=<span class="stringliteral">&quot;D&quot;</span>),</div>
<div class="line"><span class="lineno">  611</span>        MultiIndex.from_tuples([(<span class="stringliteral">&quot;a&quot;</span>, 0), (<span class="stringliteral">&quot;a&quot;</span>, 1), (<span class="stringliteral">&quot;b&quot;</span>, 0)]),</div>
<div class="line"><span class="lineno">  612</span>    ],</div>
<div class="line"><span class="lineno">  613</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a38a39e879d0e30c322f912f69065dcd7" name="a38a39e879d0e30c322f912f69065dcd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38a39e879d0e30c322f912f69065dcd7">&#9670;&#160;</a></span>test_grouby_agg_loses_results_with_as_index_false_relabel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_grouby_agg_loses_results_with_as_index_false_relabel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  947</span><span class="keyword">def </span>test_grouby_agg_loses_results_with_as_index_false_relabel():</div>
<div class="line"><span class="lineno">  948</span>    <span class="comment"># GH 32240: When the aggregate function relabels column names and</span></div>
<div class="line"><span class="lineno">  949</span>    <span class="comment"># as_index=False is specified, the results are dropped.</span></div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  952</span>        {<span class="stringliteral">&quot;key&quot;</span>: [<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>], <span class="stringliteral">&quot;val&quot;</span>: [1.0, 0.8, 2.0, 3.0, 3.6, 0.75]}</div>
<div class="line"><span class="lineno">  953</span>    )</div>
<div class="line"><span class="lineno">  954</span> </div>
<div class="line"><span class="lineno">  955</span>    grouped = df.groupby(<span class="stringliteral">&quot;key&quot;</span>, as_index=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  956</span>    result = grouped.agg(min_val=pd.NamedAgg(column=<span class="stringliteral">&quot;val&quot;</span>, aggfunc=<span class="stringliteral">&quot;min&quot;</span>))</div>
<div class="line"><span class="lineno">  957</span>    expected = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>], <span class="stringliteral">&quot;min_val&quot;</span>: [1.0, 0.8, 0.75]})</div>
<div class="line"><span class="lineno">  958</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b369fef790ead788fcd09abb8826e50" name="a2b369fef790ead788fcd09abb8826e50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b369fef790ead788fcd09abb8826e50">&#9670;&#160;</a></span>test_grouby_agg_loses_results_with_as_index_false_relabel_multiindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_grouby_agg_loses_results_with_as_index_false_relabel_multiindex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  961</span><span class="keyword">def </span>test_grouby_agg_loses_results_with_as_index_false_relabel_multiindex():</div>
<div class="line"><span class="lineno">  962</span>    <span class="comment"># GH 32240: When the aggregate function relabels column names and</span></div>
<div class="line"><span class="lineno">  963</span>    <span class="comment"># as_index=False is specified, the results are dropped. Check if</span></div>
<div class="line"><span class="lineno">  964</span>    <span class="comment"># multiindex is returned in the right order</span></div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  967</span>        {</div>
<div class="line"><span class="lineno">  968</span>            <span class="stringliteral">&quot;key&quot;</span>: [<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>],</div>
<div class="line"><span class="lineno">  969</span>            <span class="stringliteral">&quot;key1&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>],</div>
<div class="line"><span class="lineno">  970</span>            <span class="stringliteral">&quot;val&quot;</span>: [1.0, 0.8, 2.0, 3.0, 3.6, 0.75],</div>
<div class="line"><span class="lineno">  971</span>        }</div>
<div class="line"><span class="lineno">  972</span>    )</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>    grouped = df.groupby([<span class="stringliteral">&quot;key&quot;</span>, <span class="stringliteral">&quot;key1&quot;</span>], as_index=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  975</span>    result = grouped.agg(min_val=pd.NamedAgg(column=<span class="stringliteral">&quot;val&quot;</span>, aggfunc=<span class="stringliteral">&quot;min&quot;</span>))</div>
<div class="line"><span class="lineno">  976</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  977</span>        {<span class="stringliteral">&quot;key&quot;</span>: [<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>], <span class="stringliteral">&quot;key1&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], <span class="stringliteral">&quot;min_val&quot;</span>: [1.0, 0.75, 0.8]}</div>
<div class="line"><span class="lineno">  978</span>    )</div>
<div class="line"><span class="lineno">  979</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span> </div>
<div class="line"><span class="lineno">  982</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  983</span>    <span class="stringliteral">&quot;func&quot;</span>, [<span class="keyword">lambda</span> s: s.mean(), <span class="keyword">lambda</span> s: np.mean(s), <span class="keyword">lambda</span> s: np.nanmean(s)]</div>
<div class="line"><span class="lineno">  984</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cb011e026a8214df332eb581e128804" name="a2cb011e026a8214df332eb581e128804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb011e026a8214df332eb581e128804">&#9670;&#160;</a></span>test_group_mean_datetime64_nat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_group_mean_datetime64_nat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1394</span><span class="keyword">def </span>test_group_mean_datetime64_nat(input_data, expected_output):</div>
<div class="line"><span class="lineno"> 1395</span>    <span class="comment"># GH43132</span></div>
<div class="line"><span class="lineno"> 1396</span>    data = to_datetime(Series(input_data))</div>
<div class="line"><span class="lineno"> 1397</span>    expected = to_datetime(Series(expected_output))</div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span>    result = data.groupby([0, 0, 0]).mean()</div>
<div class="line"><span class="lineno"> 1400</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span> </div>
<div class="line"><span class="lineno"> 1403</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1404</span>    <span class="stringliteral">&quot;func, output&quot;</span>, [(<span class="stringliteral">&quot;mean&quot;</span>, [8 + 18j, 10 + 22j]), (<span class="stringliteral">&quot;sum&quot;</span>, [40 + 90j, 50 + 110j])]</div>
<div class="line"><span class="lineno"> 1405</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad32a9d9fe2922c09231c2b2283933ab5" name="ad32a9d9fe2922c09231c2b2283933ab5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad32a9d9fe2922c09231c2b2283933ab5">&#9670;&#160;</a></span>test_group_mean_timedelta_nat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_group_mean_timedelta_nat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1371</span><span class="keyword">def </span>test_group_mean_timedelta_nat():</div>
<div class="line"><span class="lineno"> 1372</span>    <span class="comment"># GH43132</span></div>
<div class="line"><span class="lineno"> 1373</span>    data = Series([<span class="stringliteral">&quot;1 day&quot;</span>, <span class="stringliteral">&quot;3 days&quot;</span>, <span class="stringliteral">&quot;NaT&quot;</span>], dtype=<span class="stringliteral">&quot;timedelta64[ns]&quot;</span>)</div>
<div class="line"><span class="lineno"> 1374</span>    expected = Series([<span class="stringliteral">&quot;2 days&quot;</span>], dtype=<span class="stringliteral">&quot;timedelta64[ns]&quot;</span>)</div>
<div class="line"><span class="lineno"> 1375</span> </div>
<div class="line"><span class="lineno"> 1376</span>    result = data.groupby([0, 0, 0]).mean()</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1379</span> </div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1382</span>    <span class="stringliteral">&quot;input_data, expected_output&quot;</span>,</div>
<div class="line"><span class="lineno"> 1383</span>    [</div>
<div class="line"><span class="lineno"> 1384</span>        (  <span class="comment"># no timezone</span></div>
<div class="line"><span class="lineno"> 1385</span>            [<span class="stringliteral">&quot;2021-01-01T00:00&quot;</span>, <span class="stringliteral">&quot;NaT&quot;</span>, <span class="stringliteral">&quot;2021-01-01T02:00&quot;</span>],</div>
<div class="line"><span class="lineno"> 1386</span>            [<span class="stringliteral">&quot;2021-01-01T01:00&quot;</span>],</div>
<div class="line"><span class="lineno"> 1387</span>        ),</div>
<div class="line"><span class="lineno"> 1388</span>        (  <span class="comment"># timezone</span></div>
<div class="line"><span class="lineno"> 1389</span>            [<span class="stringliteral">&quot;2021-01-01T00:00-0100&quot;</span>, <span class="stringliteral">&quot;NaT&quot;</span>, <span class="stringliteral">&quot;2021-01-01T02:00-0100&quot;</span>],</div>
<div class="line"><span class="lineno"> 1390</span>            [<span class="stringliteral">&quot;2021-01-01T01:00-0100&quot;</span>],</div>
<div class="line"><span class="lineno"> 1391</span>        ),</div>
<div class="line"><span class="lineno"> 1392</span>    ],</div>
<div class="line"><span class="lineno"> 1393</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a43dd145993d9344c20e9f4765693d23a" name="a43dd145993d9344c20e9f4765693d23a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43dd145993d9344c20e9f4765693d23a">&#9670;&#160;</a></span>test_groupby_agg_coercing_bools()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_agg_coercing_bools </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  464</span><span class="keyword">def </span>test_groupby_agg_coercing_bools():</div>
<div class="line"><span class="lineno">  465</span>    <span class="comment"># issue 14873</span></div>
<div class="line"><span class="lineno">  466</span>    dat = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2, 2], <span class="stringliteral">&quot;b&quot;</span>: [0, 1, 2, 3], <span class="stringliteral">&quot;c&quot;</span>: [<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, 1, 1]})</div>
<div class="line"><span class="lineno">  467</span>    gp = dat.groupby(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    index = Index([1, 2], name=<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    result = gp[<span class="stringliteral">&quot;b&quot;</span>].aggregate(<span class="keyword">lambda</span> x: (x != 0).all())</div>
<div class="line"><span class="lineno">  472</span>    expected = Series([<span class="keyword">False</span>, <span class="keyword">True</span>], index=index, name=<span class="stringliteral">&quot;b&quot;</span>)</div>
<div class="line"><span class="lineno">  473</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    result = gp[<span class="stringliteral">&quot;c&quot;</span>].aggregate(<span class="keyword">lambda</span> x: x.isnull().all())</div>
<div class="line"><span class="lineno">  476</span>    expected = Series([<span class="keyword">True</span>, <span class="keyword">False</span>], index=index, name=<span class="stringliteral">&quot;c&quot;</span>)</div>
<div class="line"><span class="lineno">  477</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  481</span>    <span class="stringliteral">&quot;op&quot;</span>,</div>
<div class="line"><span class="lineno">  482</span>    [</div>
<div class="line"><span class="lineno">  483</span>        <span class="keyword">lambda</span> x: x.sum(),</div>
<div class="line"><span class="lineno">  484</span>        <span class="keyword">lambda</span> x: x.cumsum(),</div>
<div class="line"><span class="lineno">  485</span>        <span class="keyword">lambda</span> x: x.transform(<span class="stringliteral">&quot;sum&quot;</span>),</div>
<div class="line"><span class="lineno">  486</span>        <span class="keyword">lambda</span> x: x.transform(<span class="stringliteral">&quot;cumsum&quot;</span>),</div>
<div class="line"><span class="lineno">  487</span>        <span class="keyword">lambda</span> x: x.agg(<span class="stringliteral">&quot;sum&quot;</span>),</div>
<div class="line"><span class="lineno">  488</span>        <span class="keyword">lambda</span> x: x.agg(<span class="stringliteral">&quot;cumsum&quot;</span>),</div>
<div class="line"><span class="lineno">  489</span>    ],</div>
<div class="line"><span class="lineno">  490</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a44b5ae729f702bdce8ebb2d67e4637b3" name="a44b5ae729f702bdce8ebb2d67e4637b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44b5ae729f702bdce8ebb2d67e4637b3">&#9670;&#160;</a></span>test_groupby_agg_no_extra_calls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_agg_no_extra_calls </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   29</span><span class="keyword">def </span>test_groupby_agg_no_extra_calls():</div>
<div class="line"><span class="lineno">   30</span>    <span class="comment"># GH#31760</span></div>
<div class="line"><span class="lineno">   31</span>    df = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], <span class="stringliteral">&quot;value&quot;</span>: [1, 2, 3, 4]})</div>
<div class="line"><span class="lineno">   32</span>    gb = df.groupby(<span class="stringliteral">&quot;key&quot;</span>)[<span class="stringliteral">&quot;value&quot;</span>]</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>    <span class="keyword">def </span>dummy_func(x):</div>
<div class="line"><span class="lineno">   35</span>        <span class="keyword">assert</span> len(x) != 0</div>
<div class="line"><span class="lineno">   36</span>        <span class="keywordflow">return</span> x.sum()</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>    gb.agg(dummy_func)</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a40c78a80a2463161b8578806dae8673e" name="a40c78a80a2463161b8578806dae8673e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40c78a80a2463161b8578806dae8673e">&#9670;&#160;</a></span>test_groupby_aggregate_directory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_aggregate_directory </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reduction_func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1347</span><span class="keyword">def </span>test_groupby_aggregate_directory(reduction_func):</div>
<div class="line"><span class="lineno"> 1348</span>    <span class="comment"># GH#32793</span></div>
<div class="line"><span class="lineno"> 1349</span>    <span class="keywordflow">if</span> reduction_func <span class="keywordflow">in</span> [<span class="stringliteral">&quot;corrwith&quot;</span>, <span class="stringliteral">&quot;nth&quot;</span>]:</div>
<div class="line"><span class="lineno"> 1350</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1351</span>    warn = FutureWarning <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;mad&quot;</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>    obj = DataFrame([[0, 1], [0, np.nan]])</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keyword">with</span> tm.assert_produces_warning(warn, match=<span class="stringliteral">&quot;The &#39;mad&#39; method is deprecated&quot;</span>):</div>
<div class="line"><span class="lineno"> 1356</span>        result_reduced_series = obj.groupby(0).agg(reduction_func)</div>
<div class="line"><span class="lineno"> 1357</span>        result_reduced_frame = obj.groupby(0).agg({1: reduction_func})</div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span>    <span class="keywordflow">if</span> reduction_func <span class="keywordflow">in</span> [<span class="stringliteral">&quot;size&quot;</span>, <span class="stringliteral">&quot;ngroup&quot;</span>]:</div>
<div class="line"><span class="lineno"> 1360</span>        <span class="comment"># names are different: None / 1</span></div>
<div class="line"><span class="lineno"> 1361</span>        tm.assert_series_equal(</div>
<div class="line"><span class="lineno"> 1362</span>            result_reduced_series, result_reduced_frame[1], check_names=<span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1363</span>        )</div>
<div class="line"><span class="lineno"> 1364</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1365</span>        tm.assert_frame_equal(result_reduced_series, result_reduced_frame)</div>
<div class="line"><span class="lineno"> 1366</span>        tm.assert_series_equal(</div>
<div class="line"><span class="lineno"> 1367</span>            result_reduced_series.dtypes, result_reduced_frame.dtypes</div>
<div class="line"><span class="lineno"> 1368</span>        )</div>
<div class="line"><span class="lineno"> 1369</span> </div>
<div class="line"><span class="lineno"> 1370</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a32b8a1410ec6f509468b3fc0ac482e41" name="a32b8a1410ec6f509468b3fc0ac482e41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32b8a1410ec6f509468b3fc0ac482e41">&#9670;&#160;</a></span>test_groupby_aggregate_empty_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_aggregate_empty_key </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  917</span><span class="keyword">def </span>test_groupby_aggregate_empty_key(kwargs):</div>
<div class="line"><span class="lineno">  918</span>    <span class="comment"># GH: 32580</span></div>
<div class="line"><span class="lineno">  919</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2], <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 3], <span class="stringliteral">&quot;c&quot;</span>: [1, 2, 4]})</div>
<div class="line"><span class="lineno">  920</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>).agg(kwargs)</div>
<div class="line"><span class="lineno">  921</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  922</span>        [1, 4],</div>
<div class="line"><span class="lineno">  923</span>        index=Index([1, 2], dtype=<span class="stringliteral">&quot;int64&quot;</span>, name=<span class="stringliteral">&quot;a&quot;</span>),</div>
<div class="line"><span class="lineno">  924</span>        columns=MultiIndex.from_tuples([[<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>]]),</div>
<div class="line"><span class="lineno">  925</span>    )</div>
<div class="line"><span class="lineno">  926</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a699a2874139a277391138df8c88cbd29" name="a699a2874139a277391138df8c88cbd29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a699a2874139a277391138df8c88cbd29">&#9670;&#160;</a></span>test_groupby_aggregate_empty_key_empty_return()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_aggregate_empty_key_empty_return </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  929</span><span class="keyword">def </span>test_groupby_aggregate_empty_key_empty_return():</div>
<div class="line"><span class="lineno">  930</span>    <span class="comment"># GH: 32580 Check if everything works, when return is empty</span></div>
<div class="line"><span class="lineno">  931</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2], <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 3], <span class="stringliteral">&quot;c&quot;</span>: [1, 2, 4]})</div>
<div class="line"><span class="lineno">  932</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>).agg({<span class="stringliteral">&quot;b&quot;</span>: []})</div>
<div class="line"><span class="lineno">  933</span>    expected = DataFrame(columns=MultiIndex(levels=[[<span class="stringliteral">&quot;b&quot;</span>], []], codes=[[], []]))</div>
<div class="line"><span class="lineno">  934</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af1f31e1828ef0f1e220e6a70fc381c77" name="af1f31e1828ef0f1e220e6a70fc381c77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1f31e1828ef0f1e220e6a70fc381c77">&#9670;&#160;</a></span>test_groupby_aggregate_empty_with_multiindex_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_aggregate_empty_with_multiindex_frame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  937</span><span class="keyword">def </span>test_groupby_aggregate_empty_with_multiindex_frame():</div>
<div class="line"><span class="lineno">  938</span>    <span class="comment"># GH 39178</span></div>
<div class="line"><span class="lineno">  939</span>    df = DataFrame(columns=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>])</div>
<div class="line"><span class="lineno">  940</span>    result = df.groupby([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], group_keys=<span class="keyword">False</span>).agg(d=(<span class="stringliteral">&quot;c&quot;</span>, list))</div>
<div class="line"><span class="lineno">  941</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  942</span>        columns=[<span class="stringliteral">&quot;d&quot;</span>], index=MultiIndex([[], []], [[], []], names=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>])</div>
<div class="line"><span class="lineno">  943</span>    )</div>
<div class="line"><span class="lineno">  944</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a757f191eca37f31b12a5172b46badae4" name="a757f191eca37f31b12a5172b46badae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a757f191eca37f31b12a5172b46badae4">&#9670;&#160;</a></span>test_groupby_aggregation_mixed_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_aggregation_mixed_dtype </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   66</span><span class="keyword">def </span>test_groupby_aggregation_mixed_dtype():</div>
<div class="line"><span class="lineno">   67</span>    <span class="comment"># GH 6212</span></div>
<div class="line"><span class="lineno">   68</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">   69</span>        {</div>
<div class="line"><span class="lineno">   70</span>            <span class="stringliteral">&quot;v1&quot;</span>: [5, 5, 7, np.nan, 3, 3, 4, 1],</div>
<div class="line"><span class="lineno">   71</span>            <span class="stringliteral">&quot;v2&quot;</span>: [55, 55, 77, np.nan, 33, 33, 44, 11],</div>
<div class="line"><span class="lineno">   72</span>        },</div>
<div class="line"><span class="lineno">   73</span>        index=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno">   74</span>            [</div>
<div class="line"><span class="lineno">   75</span>                (1, 95),</div>
<div class="line"><span class="lineno">   76</span>                (1, 99),</div>
<div class="line"><span class="lineno">   77</span>                (2, 95),</div>
<div class="line"><span class="lineno">   78</span>                (2, 99),</div>
<div class="line"><span class="lineno">   79</span>                (<span class="stringliteral">&quot;big&quot;</span>, <span class="stringliteral">&quot;damp&quot;</span>),</div>
<div class="line"><span class="lineno">   80</span>                (<span class="stringliteral">&quot;blue&quot;</span>, <span class="stringliteral">&quot;dry&quot;</span>),</div>
<div class="line"><span class="lineno">   81</span>                (<span class="stringliteral">&quot;red&quot;</span>, <span class="stringliteral">&quot;red&quot;</span>),</div>
<div class="line"><span class="lineno">   82</span>                (<span class="stringliteral">&quot;red&quot;</span>, <span class="stringliteral">&quot;wet&quot;</span>),</div>
<div class="line"><span class="lineno">   83</span>            ],</div>
<div class="line"><span class="lineno">   84</span>            names=[<span class="stringliteral">&quot;by1&quot;</span>, <span class="stringliteral">&quot;by2&quot;</span>],</div>
<div class="line"><span class="lineno">   85</span>        ),</div>
<div class="line"><span class="lineno">   86</span>    )</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">   89</span>        {</div>
<div class="line"><span class="lineno">   90</span>            <span class="stringliteral">&quot;v1&quot;</span>: [1, 3, 5, 7, 8, 3, 5, np.nan, 4, 5, 7, 9],</div>
<div class="line"><span class="lineno">   91</span>            <span class="stringliteral">&quot;v2&quot;</span>: [11, 33, 55, 77, 88, 33, 55, np.nan, 44, 55, 77, 99],</div>
<div class="line"><span class="lineno">   92</span>            <span class="stringliteral">&quot;by1&quot;</span>: [<span class="stringliteral">&quot;red&quot;</span>, <span class="stringliteral">&quot;blue&quot;</span>, 1, 2, np.nan, <span class="stringliteral">&quot;big&quot;</span>, 1, 2, <span class="stringliteral">&quot;red&quot;</span>, 1, np.nan, 12],</div>
<div class="line"><span class="lineno">   93</span>            <span class="stringliteral">&quot;by2&quot;</span>: [</div>
<div class="line"><span class="lineno">   94</span>                <span class="stringliteral">&quot;wet&quot;</span>,</div>
<div class="line"><span class="lineno">   95</span>                <span class="stringliteral">&quot;dry&quot;</span>,</div>
<div class="line"><span class="lineno">   96</span>                99,</div>
<div class="line"><span class="lineno">   97</span>                95,</div>
<div class="line"><span class="lineno">   98</span>                np.nan,</div>
<div class="line"><span class="lineno">   99</span>                <span class="stringliteral">&quot;damp&quot;</span>,</div>
<div class="line"><span class="lineno">  100</span>                95,</div>
<div class="line"><span class="lineno">  101</span>                99,</div>
<div class="line"><span class="lineno">  102</span>                <span class="stringliteral">&quot;red&quot;</span>,</div>
<div class="line"><span class="lineno">  103</span>                99,</div>
<div class="line"><span class="lineno">  104</span>                np.nan,</div>
<div class="line"><span class="lineno">  105</span>                np.nan,</div>
<div class="line"><span class="lineno">  106</span>            ],</div>
<div class="line"><span class="lineno">  107</span>        }</div>
<div class="line"><span class="lineno">  108</span>    )</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    g = df.groupby([<span class="stringliteral">&quot;by1&quot;</span>, <span class="stringliteral">&quot;by2&quot;</span>])</div>
<div class="line"><span class="lineno">  111</span>    result = g[[<span class="stringliteral">&quot;v1&quot;</span>, <span class="stringliteral">&quot;v2&quot;</span>]].mean()</div>
<div class="line"><span class="lineno">  112</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7357ebe100b0ae6889b64735603665b7" name="a7357ebe100b0ae6889b64735603665b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7357ebe100b0ae6889b64735603665b7">&#9670;&#160;</a></span>test_groupby_aggregation_multi_level_column()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_aggregation_multi_level_column </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  115</span><span class="keyword">def </span>test_groupby_aggregation_multi_level_column():</div>
<div class="line"><span class="lineno">  116</span>    <span class="comment"># GH 29772</span></div>
<div class="line"><span class="lineno">  117</span>    lst = [</div>
<div class="line"><span class="lineno">  118</span>        [<span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">False</span>],</div>
<div class="line"><span class="lineno">  119</span>        [<span class="keyword">True</span>, <span class="keyword">False</span>, np.nan, <span class="keyword">False</span>],</div>
<div class="line"><span class="lineno">  120</span>        [<span class="keyword">True</span>, <span class="keyword">True</span>, np.nan, <span class="keyword">False</span>],</div>
<div class="line"><span class="lineno">  121</span>        [<span class="keyword">True</span>, <span class="keyword">True</span>, np.nan, <span class="keyword">False</span>],</div>
<div class="line"><span class="lineno">  122</span>    ]</div>
<div class="line"><span class="lineno">  123</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  124</span>        data=lst,</div>
<div class="line"><span class="lineno">  125</span>        columns=MultiIndex.from_tuples([(<span class="stringliteral">&quot;A&quot;</span>, 0), (<span class="stringliteral">&quot;A&quot;</span>, 1), (<span class="stringliteral">&quot;B&quot;</span>, 0), (<span class="stringliteral">&quot;B&quot;</span>, 1)]),</div>
<div class="line"><span class="lineno">  126</span>    )</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    gb = df.groupby(level=1, axis=1)</div>
<div class="line"><span class="lineno">  129</span>    result = gb.sum(numeric_only=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  130</span>    expected = DataFrame({0: [2.0, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>], 1: [1, 0, 1, 1]})</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad18376b8c9aad5ef317cd455e2f74032" name="ad18376b8c9aad5ef317cd455e2f74032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad18376b8c9aad5ef317cd455e2f74032">&#9670;&#160;</a></span>test_groupby_combined_aggs_cat_cols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_combined_aggs_cat_cols </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>grp_col_dict</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exp_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1245</span><span class="keyword">def </span>test_groupby_combined_aggs_cat_cols(grp_col_dict, exp_data):</div>
<div class="line"><span class="lineno"> 1246</span>    <span class="comment"># test combined aggregations on ordered categorical cols GH27800</span></div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>    <span class="comment"># create the result dataframe</span></div>
<div class="line"><span class="lineno"> 1249</span>    input_df = DataFrame(</div>
<div class="line"><span class="lineno"> 1250</span>        {</div>
<div class="line"><span class="lineno"> 1251</span>            <span class="stringliteral">&quot;nr&quot;</span>: [1, 2, 3, 4, 5, 6, 7, 8],</div>
<div class="line"><span class="lineno"> 1252</span>            <span class="stringliteral">&quot;cat_ord&quot;</span>: list(<span class="stringliteral">&quot;aabbccdd&quot;</span>),</div>
<div class="line"><span class="lineno"> 1253</span>            <span class="stringliteral">&quot;cat&quot;</span>: list(<span class="stringliteral">&quot;aaaabbbb&quot;</span>),</div>
<div class="line"><span class="lineno"> 1254</span>        }</div>
<div class="line"><span class="lineno"> 1255</span>    )</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>    input_df = input_df.astype({<span class="stringliteral">&quot;cat&quot;</span>: <span class="stringliteral">&quot;category&quot;</span>, <span class="stringliteral">&quot;cat_ord&quot;</span>: <span class="stringliteral">&quot;category&quot;</span>})</div>
<div class="line"><span class="lineno"> 1258</span>    input_df[<span class="stringliteral">&quot;cat_ord&quot;</span>] = input_df[<span class="stringliteral">&quot;cat_ord&quot;</span>].cat.as_ordered()</div>
<div class="line"><span class="lineno"> 1259</span>    result_df = input_df.groupby(<span class="stringliteral">&quot;cat&quot;</span>).agg(grp_col_dict)</div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span>    <span class="comment"># create expected dataframe</span></div>
<div class="line"><span class="lineno"> 1262</span>    cat_index = pd.CategoricalIndex(</div>
<div class="line"><span class="lineno"> 1263</span>        [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], ordered=<span class="keyword">False</span>, name=<span class="stringliteral">&quot;cat&quot;</span>, dtype=<span class="stringliteral">&quot;category&quot;</span></div>
<div class="line"><span class="lineno"> 1264</span>    )</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>    <span class="comment"># unpack the grp_col_dict to create the multi-index tuple</span></div>
<div class="line"><span class="lineno"> 1267</span>    <span class="comment"># this tuple will be used to create the expected dataframe index</span></div>
<div class="line"><span class="lineno"> 1268</span>    multi_index_list = []</div>
<div class="line"><span class="lineno"> 1269</span>    <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> grp_col_dict.items():</div>
<div class="line"><span class="lineno"> 1270</span>        <span class="keywordflow">if</span> isinstance(v, list):</div>
<div class="line"><span class="lineno"> 1271</span>            <span class="keywordflow">for</span> value <span class="keywordflow">in</span> v:</div>
<div class="line"><span class="lineno"> 1272</span>                multi_index_list.append([k, value])</div>
<div class="line"><span class="lineno"> 1273</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1274</span>            multi_index_list.append([k, v])</div>
<div class="line"><span class="lineno"> 1275</span>    multi_index = MultiIndex.from_tuples(tuple(multi_index_list))</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>    expected_df = DataFrame(data=exp_data, columns=multi_index, index=cat_index)</div>
<div class="line"><span class="lineno"> 1278</span>    <span class="keywordflow">for</span> col <span class="keywordflow">in</span> expected_df.columns:</div>
<div class="line"><span class="lineno"> 1279</span>        <span class="keywordflow">if</span> isinstance(col, tuple) <span class="keywordflow">and</span> <span class="stringliteral">&quot;cat_ord&quot;</span> <span class="keywordflow">in</span> col:</div>
<div class="line"><span class="lineno"> 1280</span>            <span class="comment"># ordered categorical should be preserved</span></div>
<div class="line"><span class="lineno"> 1281</span>            expected_df[col] = expected_df[col].astype(input_df[<span class="stringliteral">&quot;cat_ord&quot;</span>].dtype)</div>
<div class="line"><span class="lineno"> 1282</span> </div>
<div class="line"><span class="lineno"> 1283</span>    tm.assert_frame_equal(result_df, expected_df)</div>
<div class="line"><span class="lineno"> 1284</span> </div>
<div class="line"><span class="lineno"> 1285</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a44daac97611e3c52556e023f66207966" name="a44daac97611e3c52556e023f66207966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44daac97611e3c52556e023f66207966">&#9670;&#160;</a></span>test_groupby_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_complex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1406</span><span class="keyword">def </span>test_groupby_complex(func, output):</div>
<div class="line"><span class="lineno"> 1407</span>    <span class="comment"># GH#43701</span></div>
<div class="line"><span class="lineno"> 1408</span>    data = Series(np.arange(20).reshape(10, 2).dot([1, 2j]))</div>
<div class="line"><span class="lineno"> 1409</span>    result = data.groupby(data.index % 2).agg(func)</div>
<div class="line"><span class="lineno"> 1410</span>    expected = Series(output)</div>
<div class="line"><span class="lineno"> 1411</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span> </div>
<div class="line"><span class="lineno"> 1414</span><span class="preprocessor">@pytest.mark.parametrize(&quot;func&quot;, [&quot;min&quot;, &quot;max&quot;, &quot;var&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8de67bd1ace82f7151e54b5cc15628cb" name="a8de67bd1ace82f7151e54b5cc15628cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8de67bd1ace82f7151e54b5cc15628cb">&#9670;&#160;</a></span>test_groupby_complex_raises()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_complex_raises </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1415</span><span class="keyword">def </span>test_groupby_complex_raises(func):</div>
<div class="line"><span class="lineno"> 1416</span>    <span class="comment"># GH#43701</span></div>
<div class="line"><span class="lineno"> 1417</span>    data = Series(np.arange(20).reshape(10, 2).dot([1, 2j]))</div>
<div class="line"><span class="lineno"> 1418</span>    msg = <span class="stringliteral">&quot;No matching signature found&quot;</span></div>
<div class="line"><span class="lineno"> 1419</span>    <span class="keyword">with</span> pytest.raises(TypeError, match=msg):</div>
<div class="line"><span class="lineno"> 1420</span>        data.groupby(data.index % 2).agg(func)</div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span> </div>
<div class="line"><span class="lineno"> 1423</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1424</span>    <span class="stringliteral">&quot;func&quot;</span>, [[<span class="stringliteral">&quot;min&quot;</span>], [<span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>], {<span class="stringliteral">&quot;b&quot;</span>: <span class="stringliteral">&quot;sum&quot;</span>}, {<span class="stringliteral">&quot;b&quot;</span>: <span class="stringliteral">&quot;prod&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>: <span class="stringliteral">&quot;median&quot;</span>}]</div>
<div class="line"><span class="lineno"> 1425</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7dcf0b313d8e4c7ad22fbaddd658b114" name="a7dcf0b313d8e4c7ad22fbaddd658b114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dcf0b313d8e4c7ad22fbaddd658b114">&#9670;&#160;</a></span>test_groupby_get_by_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_get_by_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1190</span><span class="keyword">def </span>test_groupby_get_by_index():</div>
<div class="line"><span class="lineno"> 1191</span>    <span class="comment"># GH 33439</span></div>
<div class="line"><span class="lineno"> 1192</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [<span class="stringliteral">&quot;S&quot;</span>, <span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;W&quot;</span>], <span class="stringliteral">&quot;B&quot;</span>: [1.0, 1.0, 2.0]})</div>
<div class="line"><span class="lineno"> 1193</span>    res = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).agg({<span class="stringliteral">&quot;B&quot;</span>: <span class="keyword">lambda</span> x: x.get(x.index[-1])})</div>
<div class="line"><span class="lineno"> 1194</span>    expected = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [<span class="stringliteral">&quot;S&quot;</span>, <span class="stringliteral">&quot;W&quot;</span>], <span class="stringliteral">&quot;B&quot;</span>: [1.0, 2.0]}).set_index(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno"> 1195</span>    tm.assert_frame_equal(res, expected)</div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1199</span>    <span class="stringliteral">&quot;grp_col_dict, exp_data&quot;</span>,</div>
<div class="line"><span class="lineno"> 1200</span>    [</div>
<div class="line"><span class="lineno"> 1201</span>        ({<span class="stringliteral">&quot;nr&quot;</span>: <span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;cat_ord&quot;</span>: <span class="stringliteral">&quot;min&quot;</span>}, {<span class="stringliteral">&quot;nr&quot;</span>: [1, 5], <span class="stringliteral">&quot;cat_ord&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]}),</div>
<div class="line"><span class="lineno"> 1202</span>        ({<span class="stringliteral">&quot;cat_ord&quot;</span>: <span class="stringliteral">&quot;min&quot;</span>}, {<span class="stringliteral">&quot;cat_ord&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]}),</div>
<div class="line"><span class="lineno"> 1203</span>        ({<span class="stringliteral">&quot;nr&quot;</span>: <span class="stringliteral">&quot;min&quot;</span>}, {<span class="stringliteral">&quot;nr&quot;</span>: [1, 5]}),</div>
<div class="line"><span class="lineno"> 1204</span>    ],</div>
<div class="line"><span class="lineno"> 1205</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2724fa0fefe010d3e8c7c89608235dd" name="af2724fa0fefe010d3e8c7c89608235dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2724fa0fefe010d3e8c7c89608235dd">&#9670;&#160;</a></span>test_groupby_index_object_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_index_object_dtype </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1317</span><span class="keyword">def </span>test_groupby_index_object_dtype():</div>
<div class="line"><span class="lineno"> 1318</span>    <span class="comment"># GH 40014</span></div>
<div class="line"><span class="lineno"> 1319</span>    df = DataFrame({<span class="stringliteral">&quot;c0&quot;</span>: [<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>], <span class="stringliteral">&quot;c1&quot;</span>: [<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>], <span class="stringliteral">&quot;p&quot;</span>: [0, 1, 2]})</div>
<div class="line"><span class="lineno"> 1320</span>    df.index = df.index.astype(<span class="stringliteral">&quot;O&quot;</span>)</div>
<div class="line"><span class="lineno"> 1321</span>    grouped = df.groupby([<span class="stringliteral">&quot;c0&quot;</span>, <span class="stringliteral">&quot;c1&quot;</span>])</div>
<div class="line"><span class="lineno"> 1322</span>    res = grouped.p.agg(<span class="keyword">lambda</span> x: all(x &gt; 0))</div>
<div class="line"><span class="lineno"> 1323</span>    <span class="comment"># Check that providing a user-defined function in agg()</span></div>
<div class="line"><span class="lineno"> 1324</span>    <span class="comment"># produces the correct index shape when using an object-typed index.</span></div>
<div class="line"><span class="lineno"> 1325</span>    expected_index = MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno"> 1326</span>        [(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>), (<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>)], names=(<span class="stringliteral">&quot;c0&quot;</span>, <span class="stringliteral">&quot;c1&quot;</span>)</div>
<div class="line"><span class="lineno"> 1327</span>    )</div>
<div class="line"><span class="lineno"> 1328</span>    expected = Series([<span class="keyword">False</span>, <span class="keyword">True</span>], index=expected_index, name=<span class="stringliteral">&quot;p&quot;</span>)</div>
<div class="line"><span class="lineno"> 1329</span>    tm.assert_series_equal(res, expected)</div>
<div class="line"><span class="lineno"> 1330</span> </div>
<div class="line"><span class="lineno"> 1331</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af481ddc767a7d956ab068c96ae5f239b" name="af481ddc767a7d956ab068c96ae5f239b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af481ddc767a7d956ab068c96ae5f239b">&#9670;&#160;</a></span>test_groupby_mixed_cols_axis1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_mixed_cols_axis1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result_dtype_dict</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  261</span><span class="keyword">def </span>test_groupby_mixed_cols_axis1(func, expected_data, result_dtype_dict):</div>
<div class="line"><span class="lineno">  262</span>    <span class="comment"># GH#43209</span></div>
<div class="line"><span class="lineno">  263</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  264</span>        np.arange(12).reshape(3, 4),</div>
<div class="line"><span class="lineno">  265</span>        index=Index([0, 1, 0], name=<span class="stringliteral">&quot;y&quot;</span>),</div>
<div class="line"><span class="lineno">  266</span>        columns=Index([10, 20, 10, 20], name=<span class="stringliteral">&quot;x&quot;</span>),</div>
<div class="line"><span class="lineno">  267</span>        dtype=<span class="stringliteral">&quot;int64&quot;</span>,</div>
<div class="line"><span class="lineno">  268</span>    ).astype({10: <span class="stringliteral">&quot;Int64&quot;</span>})</div>
<div class="line"><span class="lineno">  269</span>    warn = FutureWarning <span class="keywordflow">if</span> func == <span class="stringliteral">&quot;std&quot;</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  270</span>    msg = <span class="stringliteral">&quot;The default value of numeric_only&quot;</span></div>
<div class="line"><span class="lineno">  271</span>    <span class="keyword">with</span> tm.assert_produces_warning(warn, match=msg):</div>
<div class="line"><span class="lineno">  272</span>        result = df.groupby(<span class="stringliteral">&quot;x&quot;</span>, axis=1).agg(func)</div>
<div class="line"><span class="lineno">  273</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  274</span>        data=expected_data,</div>
<div class="line"><span class="lineno">  275</span>        index=Index([0, 1, 0], name=<span class="stringliteral">&quot;y&quot;</span>),</div>
<div class="line"><span class="lineno">  276</span>        columns=Index([10, 20], name=<span class="stringliteral">&quot;x&quot;</span>),</div>
<div class="line"><span class="lineno">  277</span>    ).astype(result_dtype_dict)</div>
<div class="line"><span class="lineno">  278</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a77ac852bd3ab2d1367a51d45ed155c3e" name="a77ac852bd3ab2d1367a51d45ed155c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77ac852bd3ab2d1367a51d45ed155c3e">&#9670;&#160;</a></span>test_groupby_single_agg_cat_cols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_groupby_single_agg_cat_cols </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>grp_col_dict</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exp_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1206</span><span class="keyword">def </span>test_groupby_single_agg_cat_cols(grp_col_dict, exp_data):</div>
<div class="line"><span class="lineno"> 1207</span>    <span class="comment"># test single aggregations on ordered categorical cols GHGH27800</span></div>
<div class="line"><span class="lineno"> 1208</span> </div>
<div class="line"><span class="lineno"> 1209</span>    <span class="comment"># create the result dataframe</span></div>
<div class="line"><span class="lineno"> 1210</span>    input_df = DataFrame(</div>
<div class="line"><span class="lineno"> 1211</span>        {</div>
<div class="line"><span class="lineno"> 1212</span>            <span class="stringliteral">&quot;nr&quot;</span>: [1, 2, 3, 4, 5, 6, 7, 8],</div>
<div class="line"><span class="lineno"> 1213</span>            <span class="stringliteral">&quot;cat_ord&quot;</span>: list(<span class="stringliteral">&quot;aabbccdd&quot;</span>),</div>
<div class="line"><span class="lineno"> 1214</span>            <span class="stringliteral">&quot;cat&quot;</span>: list(<span class="stringliteral">&quot;aaaabbbb&quot;</span>),</div>
<div class="line"><span class="lineno"> 1215</span>        }</div>
<div class="line"><span class="lineno"> 1216</span>    )</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>    input_df = input_df.astype({<span class="stringliteral">&quot;cat&quot;</span>: <span class="stringliteral">&quot;category&quot;</span>, <span class="stringliteral">&quot;cat_ord&quot;</span>: <span class="stringliteral">&quot;category&quot;</span>})</div>
<div class="line"><span class="lineno"> 1219</span>    input_df[<span class="stringliteral">&quot;cat_ord&quot;</span>] = input_df[<span class="stringliteral">&quot;cat_ord&quot;</span>].cat.as_ordered()</div>
<div class="line"><span class="lineno"> 1220</span>    result_df = input_df.groupby(<span class="stringliteral">&quot;cat&quot;</span>).agg(grp_col_dict)</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>    <span class="comment"># create expected dataframe</span></div>
<div class="line"><span class="lineno"> 1223</span>    cat_index = pd.CategoricalIndex(</div>
<div class="line"><span class="lineno"> 1224</span>        [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], ordered=<span class="keyword">False</span>, name=<span class="stringliteral">&quot;cat&quot;</span>, dtype=<span class="stringliteral">&quot;category&quot;</span></div>
<div class="line"><span class="lineno"> 1225</span>    )</div>
<div class="line"><span class="lineno"> 1226</span> </div>
<div class="line"><span class="lineno"> 1227</span>    expected_df = DataFrame(data=exp_data, index=cat_index)</div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;cat_ord&quot;</span> <span class="keywordflow">in</span> expected_df:</div>
<div class="line"><span class="lineno"> 1230</span>        <span class="comment"># ordered categorical columns should be preserved</span></div>
<div class="line"><span class="lineno"> 1231</span>        dtype = input_df[<span class="stringliteral">&quot;cat_ord&quot;</span>].dtype</div>
<div class="line"><span class="lineno"> 1232</span>        expected_df[<span class="stringliteral">&quot;cat_ord&quot;</span>] = expected_df[<span class="stringliteral">&quot;cat_ord&quot;</span>].astype(dtype)</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>    tm.assert_frame_equal(result_df, expected_df)</div>
<div class="line"><span class="lineno"> 1235</span> </div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1238</span>    <span class="stringliteral">&quot;grp_col_dict, exp_data&quot;</span>,</div>
<div class="line"><span class="lineno"> 1239</span>    [</div>
<div class="line"><span class="lineno"> 1240</span>        ({<span class="stringliteral">&quot;nr&quot;</span>: [<span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>], <span class="stringliteral">&quot;cat_ord&quot;</span>: <span class="stringliteral">&quot;min&quot;</span>}, [(1, 4, <span class="stringliteral">&quot;a&quot;</span>), (5, 8, <span class="stringliteral">&quot;c&quot;</span>)]),</div>
<div class="line"><span class="lineno"> 1241</span>        ({<span class="stringliteral">&quot;nr&quot;</span>: <span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;cat_ord&quot;</span>: [<span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>]}, [(1, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>), (5, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>)]),</div>
<div class="line"><span class="lineno"> 1242</span>        ({<span class="stringliteral">&quot;cat_ord&quot;</span>: [<span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>]}, [(<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>), (<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>)]),</div>
<div class="line"><span class="lineno"> 1243</span>    ],</div>
<div class="line"><span class="lineno"> 1244</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a276c0df199f3f40aefc234fe848dcbcf" name="a276c0df199f3f40aefc234fe848dcbcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a276c0df199f3f40aefc234fe848dcbcf">&#9670;&#160;</a></span>test_lambda_named_agg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_lambda_named_agg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1010</span><span class="keyword">def </span>test_lambda_named_agg(func):</div>
<div class="line"><span class="lineno"> 1011</span>    <span class="comment"># see gh-28467</span></div>
<div class="line"><span class="lineno"> 1012</span>    animals = DataFrame(</div>
<div class="line"><span class="lineno"> 1013</span>        {</div>
<div class="line"><span class="lineno"> 1014</span>            <span class="stringliteral">&quot;kind&quot;</span>: [<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;dog&quot;</span>, <span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;dog&quot;</span>],</div>
<div class="line"><span class="lineno"> 1015</span>            <span class="stringliteral">&quot;height&quot;</span>: [9.1, 6.0, 9.5, 34.0],</div>
<div class="line"><span class="lineno"> 1016</span>            <span class="stringliteral">&quot;weight&quot;</span>: [7.9, 7.5, 9.9, 198.0],</div>
<div class="line"><span class="lineno"> 1017</span>        }</div>
<div class="line"><span class="lineno"> 1018</span>    )</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>    result = animals.groupby(<span class="stringliteral">&quot;kind&quot;</span>).agg(</div>
<div class="line"><span class="lineno"> 1021</span>        mean_height=(<span class="stringliteral">&quot;height&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>), perc90=(<span class="stringliteral">&quot;height&quot;</span>, func)</div>
<div class="line"><span class="lineno"> 1022</span>    )</div>
<div class="line"><span class="lineno"> 1023</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1024</span>        [[9.3, 9.1036], [20.0, 6.252]],</div>
<div class="line"><span class="lineno"> 1025</span>        columns=[<span class="stringliteral">&quot;mean_height&quot;</span>, <span class="stringliteral">&quot;perc90&quot;</span>],</div>
<div class="line"><span class="lineno"> 1026</span>        index=Index([<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;dog&quot;</span>], name=<span class="stringliteral">&quot;kind&quot;</span>),</div>
<div class="line"><span class="lineno"> 1027</span>    )</div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1030</span> </div>
<div class="line"><span class="lineno"> 1031</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a65b9b1132df43bd0c1346bd8e3c21601" name="a65b9b1132df43bd0c1346bd8e3c21601"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65b9b1132df43bd0c1346bd8e3c21601">&#9670;&#160;</a></span>test_more_flexible_frame_multi_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_more_flexible_frame_multi_function </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  404</span><span class="keyword">def </span>test_more_flexible_frame_multi_function(df):</div>
<div class="line"><span class="lineno">  405</span>    grouped = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    exmean = grouped.agg({<span class="stringliteral">&quot;C&quot;</span>: np.mean, <span class="stringliteral">&quot;D&quot;</span>: np.mean})</div>
<div class="line"><span class="lineno">  408</span>    exstd = grouped.agg({<span class="stringliteral">&quot;C&quot;</span>: np.std, <span class="stringliteral">&quot;D&quot;</span>: np.std})</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>    expected = concat([exmean, exstd], keys=[<span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;std&quot;</span>], axis=1)</div>
<div class="line"><span class="lineno">  411</span>    expected = expected.swaplevel(0, 1, axis=1).sort_index(level=0, axis=1)</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    d = {<span class="stringliteral">&quot;C&quot;</span>: [np.mean, np.std], <span class="stringliteral">&quot;D&quot;</span>: [np.mean, np.std]}</div>
<div class="line"><span class="lineno">  414</span>    result = grouped.aggregate(d)</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    <span class="comment"># be careful</span></div>
<div class="line"><span class="lineno">  419</span>    result = grouped.aggregate({<span class="stringliteral">&quot;C&quot;</span>: np.mean, <span class="stringliteral">&quot;D&quot;</span>: [np.mean, np.std]})</div>
<div class="line"><span class="lineno">  420</span>    expected = grouped.aggregate({<span class="stringliteral">&quot;C&quot;</span>: np.mean, <span class="stringliteral">&quot;D&quot;</span>: [np.mean, np.std]})</div>
<div class="line"><span class="lineno">  421</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    <span class="keyword">def </span><a class="code hl_namespace" href="namespacefoo.html">foo</a>(x):</div>
<div class="line"><span class="lineno">  424</span>        <span class="keywordflow">return</span> np.mean(x)</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <span class="keyword">def </span>bar(x):</div>
<div class="line"><span class="lineno">  427</span>        <span class="keywordflow">return</span> np.std(x, ddof=1)</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    <span class="comment"># this uses column selection &amp; renaming</span></div>
<div class="line"><span class="lineno">  430</span>    msg = <span class="stringliteral">r&quot;nested renamer is not supported&quot;</span></div>
<div class="line"><span class="lineno">  431</span>    <span class="keyword">with</span> pytest.raises(SpecificationError, match=msg):</div>
<div class="line"><span class="lineno">  432</span>        d = {<span class="stringliteral">&quot;C&quot;</span>: np.mean, <span class="stringliteral">&quot;D&quot;</span>: {<span class="stringliteral">&quot;foo&quot;</span>: np.mean, <span class="stringliteral">&quot;bar&quot;</span>: np.std}}</div>
<div class="line"><span class="lineno">  433</span>        grouped.aggregate(d)</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    <span class="comment"># But without renaming, these functions are OK</span></div>
<div class="line"><span class="lineno">  436</span>    d = {<span class="stringliteral">&quot;C&quot;</span>: [np.mean], <span class="stringliteral">&quot;D&quot;</span>: [foo, bar]}</div>
<div class="line"><span class="lineno">  437</span>    grouped.aggregate(d)</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="ttc" id="anamespacefoo_html"><div class="ttname"><a href="namespacefoo.html">foo</a></div><div class="ttdef"><b>Definition</b> accesstype.f90:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5a7f985ed1f79b13afae305fb588ed7" name="ae5a7f985ed1f79b13afae305fb588ed7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a7f985ed1f79b13afae305fb588ed7">&#9670;&#160;</a></span>test_multi_axis_1_raises()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_multi_axis_1_raises </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1426</span><span class="keyword">def </span>test_multi_axis_1_raises(func):</div>
<div class="line"><span class="lineno"> 1427</span>    <span class="comment"># GH#46995</span></div>
<div class="line"><span class="lineno"> 1428</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2], <span class="stringliteral">&quot;b&quot;</span>: [3, 4, 5], <span class="stringliteral">&quot;c&quot;</span>: [6, 7, 8]})</div>
<div class="line"><span class="lineno"> 1429</span>    gb = df.groupby(<span class="stringliteral">&quot;a&quot;</span>, axis=1)</div>
<div class="line"><span class="lineno"> 1430</span>    <span class="keyword">with</span> pytest.raises(NotImplementedError, match=<span class="stringliteral">&quot;axis other than 0 is not supported&quot;</span>):</div>
<div class="line"><span class="lineno"> 1431</span>        gb.agg(func)</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1435</span>    <span class="stringliteral">&quot;test, constant&quot;</span>,</div>
<div class="line"><span class="lineno"> 1436</span>    [</div>
<div class="line"><span class="lineno"> 1437</span>        ([[20, <span class="stringliteral">&quot;A&quot;</span>], [20, <span class="stringliteral">&quot;B&quot;</span>], [10, <span class="stringliteral">&quot;C&quot;</span>]], {0: [10, 20], 1: [<span class="stringliteral">&quot;C&quot;</span>, [<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>]]}),</div>
<div class="line"><span class="lineno"> 1438</span>        ([[20, <span class="stringliteral">&quot;A&quot;</span>], [20, <span class="stringliteral">&quot;B&quot;</span>], [30, <span class="stringliteral">&quot;C&quot;</span>]], {0: [20, 30], 1: [[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], <span class="stringliteral">&quot;C&quot;</span>]}),</div>
<div class="line"><span class="lineno"> 1439</span>        ([[<span class="stringliteral">&quot;a&quot;</span>, 1], [<span class="stringliteral">&quot;a&quot;</span>, 1], [<span class="stringliteral">&quot;b&quot;</span>, 2], [<span class="stringliteral">&quot;b&quot;</span>, 3]], {0: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], 1: [1, [2, 3]]}),</div>
<div class="line"><span class="lineno"> 1440</span>        pytest.param(</div>
<div class="line"><span class="lineno"> 1441</span>            [[<span class="stringliteral">&quot;a&quot;</span>, 1], [<span class="stringliteral">&quot;a&quot;</span>, 2], [<span class="stringliteral">&quot;b&quot;</span>, 3], [<span class="stringliteral">&quot;b&quot;</span>, 3]],</div>
<div class="line"><span class="lineno"> 1442</span>            {0: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], 1: [[1, 2], 3]},</div>
<div class="line"><span class="lineno"> 1443</span>            marks=pytest.mark.xfail,</div>
<div class="line"><span class="lineno"> 1444</span>        ),</div>
<div class="line"><span class="lineno"> 1445</span>    ],</div>
<div class="line"><span class="lineno"> 1446</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace79eed5815a8432011b80a0a9209372" name="ace79eed5815a8432011b80a0a9209372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace79eed5815a8432011b80a0a9209372">&#9670;&#160;</a></span>test_multi_function_flexible_mix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_multi_function_flexible_mix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  440</span><span class="keyword">def </span>test_multi_function_flexible_mix(df):</div>
<div class="line"><span class="lineno">  441</span>    <span class="comment"># GH #1268</span></div>
<div class="line"><span class="lineno">  442</span>    grouped = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>    <span class="comment"># Expected</span></div>
<div class="line"><span class="lineno">  445</span>    d = {<span class="stringliteral">&quot;C&quot;</span>: {<span class="stringliteral">&quot;foo&quot;</span>: <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>: <span class="stringliteral">&quot;std&quot;</span>}, <span class="stringliteral">&quot;D&quot;</span>: {<span class="stringliteral">&quot;sum&quot;</span>: <span class="stringliteral">&quot;sum&quot;</span>}}</div>
<div class="line"><span class="lineno">  446</span>    <span class="comment"># this uses column selection &amp; renaming</span></div>
<div class="line"><span class="lineno">  447</span>    msg = <span class="stringliteral">r&quot;nested renamer is not supported&quot;</span></div>
<div class="line"><span class="lineno">  448</span>    <span class="keyword">with</span> pytest.raises(SpecificationError, match=msg):</div>
<div class="line"><span class="lineno">  449</span>        grouped.aggregate(d)</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <span class="comment"># Test 1</span></div>
<div class="line"><span class="lineno">  452</span>    d = {<span class="stringliteral">&quot;C&quot;</span>: {<span class="stringliteral">&quot;foo&quot;</span>: <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>: <span class="stringliteral">&quot;std&quot;</span>}, <span class="stringliteral">&quot;D&quot;</span>: <span class="stringliteral">&quot;sum&quot;</span>}</div>
<div class="line"><span class="lineno">  453</span>    <span class="comment"># this uses column selection &amp; renaming</span></div>
<div class="line"><span class="lineno">  454</span>    <span class="keyword">with</span> pytest.raises(SpecificationError, match=msg):</div>
<div class="line"><span class="lineno">  455</span>        grouped.aggregate(d)</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    <span class="comment"># Test 2</span></div>
<div class="line"><span class="lineno">  458</span>    d = {<span class="stringliteral">&quot;C&quot;</span>: {<span class="stringliteral">&quot;foo&quot;</span>: <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>: <span class="stringliteral">&quot;std&quot;</span>}, <span class="stringliteral">&quot;D&quot;</span>: <span class="stringliteral">&quot;sum&quot;</span>}</div>
<div class="line"><span class="lineno">  459</span>    <span class="comment"># this uses column selection &amp; renaming</span></div>
<div class="line"><span class="lineno">  460</span>    <span class="keyword">with</span> pytest.raises(SpecificationError, match=msg):</div>
<div class="line"><span class="lineno">  461</span>        grouped.aggregate(d)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a40d49bb52eef72a2aed1e1f24132fef3" name="a40d49bb52eef72a2aed1e1f24132fef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d49bb52eef72a2aed1e1f24132fef3">&#9670;&#160;</a></span>test_multiindex_custom_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_multiindex_custom_func </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  985</span><span class="keyword">def </span>test_multiindex_custom_func(func):</div>
<div class="line"><span class="lineno">  986</span>    <span class="comment"># GH 31777</span></div>
<div class="line"><span class="lineno">  987</span>    data = [[1, 4, 2], [5, 7, 1]]</div>
<div class="line"><span class="lineno">  988</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  989</span>        data,</div>
<div class="line"><span class="lineno">  990</span>        columns=MultiIndex.from_arrays(</div>
<div class="line"><span class="lineno">  991</span>            [[1, 1, 2], [3, 4, 3]], names=[<span class="stringliteral">&quot;Sisko&quot;</span>, <span class="stringliteral">&quot;Janeway&quot;</span>]</div>
<div class="line"><span class="lineno">  992</span>        ),</div>
<div class="line"><span class="lineno">  993</span>    )</div>
<div class="line"><span class="lineno">  994</span>    result = df.groupby(np.array([0, 1])).agg(func)</div>
<div class="line"><span class="lineno">  995</span>    expected_dict = {</div>
<div class="line"><span class="lineno">  996</span>        (1, 3): {0: 1.0, 1: 5.0},</div>
<div class="line"><span class="lineno">  997</span>        (1, 4): {0: 4.0, 1: 7.0},</div>
<div class="line"><span class="lineno">  998</span>        (2, 3): {0: 2.0, 1: 1.0},</div>
<div class="line"><span class="lineno">  999</span>    }</div>
<div class="line"><span class="lineno"> 1000</span>    expected = DataFrame(expected_dict)</div>
<div class="line"><span class="lineno"> 1001</span>    expected.columns = df.columns</div>
<div class="line"><span class="lineno"> 1002</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab831d1af24479b123aea767219639939" name="ab831d1af24479b123aea767219639939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab831d1af24479b123aea767219639939">&#9670;&#160;</a></span>test_multiindex_groupby_mixed_cols_axis1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_multiindex_groupby_mixed_cols_axis1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result_dtype_dict</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  236</span><span class="keyword">def </span>test_multiindex_groupby_mixed_cols_axis1(func, expected, dtype, result_dtype_dict):</div>
<div class="line"><span class="lineno">  237</span>    <span class="comment"># GH#43209</span></div>
<div class="line"><span class="lineno">  238</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  239</span>        [[1, 2, 3, 4, 5, 6]] * 3,</div>
<div class="line"><span class="lineno">  240</span>        columns=MultiIndex.from_product([[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], [<span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;j&quot;</span>, <span class="stringliteral">&quot;k&quot;</span>]]),</div>
<div class="line"><span class="lineno">  241</span>    ).astype({(<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;j&quot;</span>): dtype, (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;j&quot;</span>): dtype})</div>
<div class="line"><span class="lineno">  242</span>    warn = FutureWarning <span class="keywordflow">if</span> func == <span class="stringliteral">&quot;std&quot;</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  243</span>    msg = <span class="stringliteral">&quot;The default value of numeric_only&quot;</span></div>
<div class="line"><span class="lineno">  244</span>    <span class="keyword">with</span> tm.assert_produces_warning(warn, match=msg):</div>
<div class="line"><span class="lineno">  245</span>        result = df.groupby(level=1, axis=1).agg(func)</div>
<div class="line"><span class="lineno">  246</span>    expected = DataFrame([expected] * 3, columns=[<span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;j&quot;</span>, <span class="stringliteral">&quot;k&quot;</span>]).astype(</div>
<div class="line"><span class="lineno">  247</span>        result_dtype_dict</div>
<div class="line"><span class="lineno">  248</span>    )</div>
<div class="line"><span class="lineno">  249</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  253</span>    <span class="stringliteral">&quot;func, expected_data, result_dtype_dict&quot;</span>,</div>
<div class="line"><span class="lineno">  254</span>    [</div>
<div class="line"><span class="lineno">  255</span>        (<span class="stringliteral">&quot;sum&quot;</span>, [[2, 4], [10, 12], [18, 20]], {10: <span class="stringliteral">&quot;int64&quot;</span>, 20: <span class="stringliteral">&quot;int64&quot;</span>}),</div>
<div class="line"><span class="lineno">  256</span>        <span class="comment"># std should ideally return Int64 / Float64 #43330</span></div>
<div class="line"><span class="lineno">  257</span>        (<span class="stringliteral">&quot;std&quot;</span>, [[2**0.5] * 2] * 3, <span class="stringliteral">&quot;float64&quot;</span>),</div>
<div class="line"><span class="lineno">  258</span>        (<span class="stringliteral">&quot;var&quot;</span>, [[2] * 2] * 3, {10: <span class="stringliteral">&quot;float64&quot;</span>, 20: <span class="stringliteral">&quot;float64&quot;</span>}),</div>
<div class="line"><span class="lineno">  259</span>    ],</div>
<div class="line"><span class="lineno">  260</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9da1c54e6ac6604aeec92d8978697431" name="a9da1c54e6ac6604aeec92d8978697431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9da1c54e6ac6604aeec92d8978697431">&#9670;&#160;</a></span>test_multiple_functions_tuples_and_non_tuples()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_multiple_functions_tuples_and_non_tuples </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  384</span><span class="keyword">def </span>test_multiple_functions_tuples_and_non_tuples(df):</div>
<div class="line"><span class="lineno">  385</span>    <span class="comment"># #1359</span></div>
<div class="line"><span class="lineno">  386</span>    funcs = [(<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>), <span class="stringliteral">&quot;std&quot;</span>]</div>
<div class="line"><span class="lineno">  387</span>    ex_funcs = [(<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>), (<span class="stringliteral">&quot;std&quot;</span>, <span class="stringliteral">&quot;std&quot;</span>)]</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)[<span class="stringliteral">&quot;C&quot;</span>].agg(funcs)</div>
<div class="line"><span class="lineno">  390</span>    expected = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)[<span class="stringliteral">&quot;C&quot;</span>].agg(ex_funcs)</div>
<div class="line"><span class="lineno">  391</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>    <span class="keyword">with</span> tm.assert_produces_warning(</div>
<div class="line"><span class="lineno">  394</span>        FutureWarning, match=<span class="stringliteral">r&quot;\[&#39;B&#39;\] did not aggregate successfully&quot;</span></div>
<div class="line"><span class="lineno">  395</span>    ):</div>
<div class="line"><span class="lineno">  396</span>        result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).agg(funcs)</div>
<div class="line"><span class="lineno">  397</span>    <span class="keyword">with</span> tm.assert_produces_warning(</div>
<div class="line"><span class="lineno">  398</span>        FutureWarning, match=<span class="stringliteral">r&quot;\[&#39;B&#39;\] did not aggregate successfully&quot;</span></div>
<div class="line"><span class="lineno">  399</span>    ):</div>
<div class="line"><span class="lineno">  400</span>        expected = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).agg(ex_funcs)</div>
<div class="line"><span class="lineno">  401</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae24a6f297debbe869946704801e78641" name="ae24a6f297debbe869946704801e78641"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae24a6f297debbe869946704801e78641">&#9670;&#160;</a></span>test_nonagg_agg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_nonagg_agg </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1286</span><span class="keyword">def </span>test_nonagg_agg():</div>
<div class="line"><span class="lineno"> 1287</span>    <span class="comment"># GH 35490 - Single/Multiple agg of non-agg function give same results</span></div>
<div class="line"><span class="lineno"> 1288</span>    <span class="comment"># TODO: agg should raise for functions that don&#39;t aggregate</span></div>
<div class="line"><span class="lineno"> 1289</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2, 2], <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 2, 1]})</div>
<div class="line"><span class="lineno"> 1290</span>    g = df.groupby(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>    result = g.agg([<span class="stringliteral">&quot;cumsum&quot;</span>])</div>
<div class="line"><span class="lineno"> 1293</span>    result.columns = result.columns.droplevel(-1)</div>
<div class="line"><span class="lineno"> 1294</span>    expected = g.agg(<span class="stringliteral">&quot;cumsum&quot;</span>)</div>
<div class="line"><span class="lineno"> 1295</span> </div>
<div class="line"><span class="lineno"> 1296</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1297</span> </div>
<div class="line"><span class="lineno"> 1298</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac97643da2cce2e22d4bcbf9b041a991c" name="ac97643da2cce2e22d4bcbf9b041a991c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac97643da2cce2e22d4bcbf9b041a991c">&#9670;&#160;</a></span>test_ohlc_ea_dtypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_ohlc_ea_dtypes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>any_numeric_ea_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  567</span><span class="keyword">def </span>test_ohlc_ea_dtypes(any_numeric_ea_dtype):</div>
<div class="line"><span class="lineno">  568</span>    <span class="comment"># GH#37493</span></div>
<div class="line"><span class="lineno">  569</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  570</span>        {<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2, 3, 4, 4], <span class="stringliteral">&quot;b&quot;</span>: [22, 11, pd.NA, 10, 20, pd.NA]},</div>
<div class="line"><span class="lineno">  571</span>        dtype=any_numeric_ea_dtype,</div>
<div class="line"><span class="lineno">  572</span>    )</div>
<div class="line"><span class="lineno">  573</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>).ohlc()</div>
<div class="line"><span class="lineno">  574</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  575</span>        [[22, 22, 11, 11], [pd.NA] * 4, [10] * 4, [20] * 4],</div>
<div class="line"><span class="lineno">  576</span>        columns=MultiIndex.from_product([[<span class="stringliteral">&quot;b&quot;</span>], [<span class="stringliteral">&quot;open&quot;</span>, <span class="stringliteral">&quot;high&quot;</span>, <span class="stringliteral">&quot;low&quot;</span>, <span class="stringliteral">&quot;close&quot;</span>]]),</div>
<div class="line"><span class="lineno">  577</span>        index=Index([1, 2, 3, 4], dtype=any_numeric_ea_dtype, name=<span class="stringliteral">&quot;a&quot;</span>),</div>
<div class="line"><span class="lineno">  578</span>        dtype=any_numeric_ea_dtype,</div>
<div class="line"><span class="lineno">  579</span>    )</div>
<div class="line"><span class="lineno">  580</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [np.int64, np.uint64])</span></div>
<div class="line"><span class="lineno">  584</span><span class="preprocessor">@pytest.mark.parametrize(&quot;how&quot;, [&quot;first&quot;, &quot;last&quot;, &quot;min&quot;, &quot;max&quot;, &quot;mean&quot;, &quot;median&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a077a7714e36b835c30cdf56fdef0e5f3" name="a077a7714e36b835c30cdf56fdef0e5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a077a7714e36b835c30cdf56fdef0e5f3">&#9670;&#160;</a></span>test_order_aggregate_multiple_funcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_order_aggregate_multiple_funcs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  555</span><span class="keyword">def </span>test_order_aggregate_multiple_funcs():</div>
<div class="line"><span class="lineno">  556</span>    <span class="comment"># GH 25692</span></div>
<div class="line"><span class="lineno">  557</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [1, 1, 2, 2], <span class="stringliteral">&quot;B&quot;</span>: [1, 2, 3, 4]})</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    res = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).agg([<span class="stringliteral">&quot;sum&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;ohlc&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>])</div>
<div class="line"><span class="lineno">  560</span>    result = res.columns.levels[1]</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>    expected = Index([<span class="stringliteral">&quot;sum&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;ohlc&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>])</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    tm.assert_index_equal(result, expected)</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aef4914248c269101c7c6e46c7edee3e8" name="aef4914248c269101c7c6e46c7edee3e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4914248c269101c7c6e46c7edee3e8">&#9670;&#160;</a></span>test_timeseries_groupby_agg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_timeseries_groupby_agg </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1332</span><span class="keyword">def </span>test_timeseries_groupby_agg():</div>
<div class="line"><span class="lineno"> 1333</span>    <span class="comment"># GH#43290</span></div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>    <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(ser):</div>
<div class="line"><span class="lineno"> 1336</span>        <span class="keywordflow">if</span> ser.isna().all():</div>
<div class="line"><span class="lineno"> 1337</span>            <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1338</span>        <span class="keywordflow">return</span> np.sum(ser)</div>
<div class="line"><span class="lineno"> 1339</span> </div>
<div class="line"><span class="lineno"> 1340</span>    df = DataFrame([1.0], index=[pd.Timestamp(<span class="stringliteral">&quot;2018-01-16 00:00:00+00:00&quot;</span>)])</div>
<div class="line"><span class="lineno"> 1341</span>    res = df.groupby(<span class="keyword">lambda</span> x: 1).agg(func)</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>    expected = DataFrame([[1.0]], index=[1])</div>
<div class="line"><span class="lineno"> 1344</span>    tm.assert_frame_equal(res, expected)</div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f4e7b9ff0e2de07abba94b00409eb59" name="a2f4e7b9ff0e2de07abba94b00409eb59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f4e7b9ff0e2de07abba94b00409eb59">&#9670;&#160;</a></span>test_uint64_type_handling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_uint64_type_handling </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>how</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  585</span><span class="keyword">def </span>test_uint64_type_handling(dtype, how):</div>
<div class="line"><span class="lineno">  586</span>    <span class="comment"># GH 26310</span></div>
<div class="line"><span class="lineno">  587</span>    df = DataFrame({<span class="stringliteral">&quot;x&quot;</span>: 6903052872240755750, <span class="stringliteral">&quot;y&quot;</span>: [1, 2]})</div>
<div class="line"><span class="lineno">  588</span>    expected = df.groupby(<span class="stringliteral">&quot;y&quot;</span>).agg({<span class="stringliteral">&quot;x&quot;</span>: how})</div>
<div class="line"><span class="lineno">  589</span>    df.x = df.x.astype(dtype)</div>
<div class="line"><span class="lineno">  590</span>    result = df.groupby(<span class="stringliteral">&quot;y&quot;</span>).agg({<span class="stringliteral">&quot;x&quot;</span>: how})</div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordflow">if</span> how <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;median&quot;</span>):</div>
<div class="line"><span class="lineno">  592</span>        <span class="comment"># mean and median always result in floats</span></div>
<div class="line"><span class="lineno">  593</span>        result.x = result.x.astype(np.int64)</div>
<div class="line"><span class="lineno">  594</span>    tm.assert_frame_equal(result, expected, check_exact=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a48148c85f329daecd4a5119d3e3c476c" name="a48148c85f329daecd4a5119d3e3c476c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48148c85f329daecd4a5119d3e3c476c">&#9670;&#160;</a></span>test_wrap_agg_out()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.aggregate.test_aggregate.test_wrap_agg_out </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>three_group</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  305</span><span class="keyword">def </span>test_wrap_agg_out(three_group):</div>
<div class="line"><span class="lineno">  306</span>    grouped = three_group.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>])</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(ser):</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">if</span> ser.dtype == object:</div>
<div class="line"><span class="lineno">  310</span>            <span class="keywordflow">raise</span> TypeError</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  312</span>            <span class="keywordflow">return</span> ser.sum()</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    <span class="keyword">with</span> tm.assert_produces_warning(FutureWarning, match=<span class="stringliteral">&quot;Dropping invalid columns&quot;</span>):</div>
<div class="line"><span class="lineno">  315</span>        result = grouped.aggregate(func)</div>
<div class="line"><span class="lineno">  316</span>    exp_grouped = three_group.loc[:, three_group.columns != <span class="stringliteral">&quot;C&quot;</span>]</div>
<div class="line"><span class="lineno">  317</span>    expected = exp_grouped.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>]).aggregate(func)</div>
<div class="line"><span class="lineno">  318</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
