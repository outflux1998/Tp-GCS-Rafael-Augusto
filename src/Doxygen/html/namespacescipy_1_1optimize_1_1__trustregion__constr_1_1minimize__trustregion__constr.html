<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._trustregion_constr.minimize_trustregion_constr Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__trustregion__constr.html">_trustregion_constr</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__trustregion__constr_1_1minimize__trustregion__constr.html">minimize_trustregion_constr</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._trustregion_constr.minimize_trustregion_constr Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__trustregion__constr_1_1minimize__trustregion__constr_1_1_hessian_linear_operator.html">HessianLinearOperator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__trustregion__constr_1_1minimize__trustregion__constr_1_1_lagrangian_hessian.html">LagrangianHessian</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af01858cec62fc8614c2ea0b33498f1d1" id="r_af01858cec62fc8614c2ea0b33498f1d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__trustregion__constr_1_1minimize__trustregion__constr.html#af01858cec62fc8614c2ea0b33498f1d1">update_state_sqp</a> (state, <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, last_iteration_failed, objective, prepared_constraints, start_time, tr_radius, constr_penalty, cg_info)</td></tr>
<tr class="separator:af01858cec62fc8614c2ea0b33498f1d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b7c8df292dcaffa9a28b6d4c3e3ddd1" id="r_a6b7c8df292dcaffa9a28b6d4c3e3ddd1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__trustregion__constr_1_1minimize__trustregion__constr.html#a6b7c8df292dcaffa9a28b6d4c3e3ddd1">update_state_ip</a> (state, <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, last_iteration_failed, objective, prepared_constraints, start_time, tr_radius, constr_penalty, cg_info, barrier_parameter, barrier_tolerance)</td></tr>
<tr class="separator:a6b7c8df292dcaffa9a28b6d4c3e3ddd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82cc749eafe159a942bb11eeee7962b2" id="r_a82cc749eafe159a942bb11eeee7962b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__trustregion__constr_1_1minimize__trustregion__constr.html#a82cc749eafe159a942bb11eeee7962b2">_minimize_trustregion_constr</a> (fun, x0, args, grad, hess, hessp, bounds, constraints, xtol=1e-8, gtol=1e-8, barrier_tol=1e-8, sparse_jacobian=None, callback=None, maxiter=1000, verbose=0, finite_diff_rel_step=None, initial_constr_penalty=1.0, initial_tr_radius=1.0, initial_barrier_parameter=0.1, initial_barrier_tolerance=0.1, factorization_method=None, disp=False)</td></tr>
<tr class="separator:a82cc749eafe159a942bb11eeee7962b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4ed886d824357dd1b7a5f6e84a0e6a9b" id="r_a4ed886d824357dd1b7a5f6e84a0e6a9b"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__trustregion__constr_1_1minimize__trustregion__constr.html#a4ed886d824357dd1b7a5f6e84a0e6a9b">TERMINATION_MESSAGES</a></td></tr>
<tr class="separator:a4ed886d824357dd1b7a5f6e84a0e6a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a82cc749eafe159a942bb11eeee7962b2" name="a82cc749eafe159a942bb11eeee7962b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82cc749eafe159a942bb11eeee7962b2">&#9670;&#160;</a></span>_minimize_trustregion_constr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._trustregion_constr.minimize_trustregion_constr._minimize_trustregion_constr </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hessp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constraints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gtol</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>barrier_tol</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparse_jacobian</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>finite_diff_rel_step</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>initial_constr_penalty</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>initial_tr_radius</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>initial_barrier_parameter</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>initial_barrier_tolerance</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>factorization_method</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimize a scalar function subject to constraints.

Parameters
----------
gtol : float, optional
    Tolerance for termination by the norm of the Lagrangian gradient.
    The algorithm will terminate when both the infinity norm (i.e., max
    abs value) of the Lagrangian gradient and the constraint violation
    are smaller than ``gtol``. Default is 1e-8.
xtol : float, optional
    Tolerance for termination by the change of the independent variable.
    The algorithm will terminate when ``tr_radius &lt; xtol``, where
    ``tr_radius`` is the radius of the trust region used in the algorithm.
    Default is 1e-8.
barrier_tol : float, optional
    Threshold on the barrier parameter for the algorithm termination.
    When inequality constraints are present, the algorithm will terminate
    only when the barrier parameter is less than `barrier_tol`.
    Default is 1e-8.
sparse_jacobian : {bool, None}, optional
    Determines how to represent Jacobians of the constraints. If bool,
    then Jacobians of all the constraints will be converted to the
    corresponding format. If None (default), then Jacobians won't be
    converted, but the algorithm can proceed only if they all have the
    same format.
initial_tr_radius: float, optional
    Initial trust radius. The trust radius gives the maximum distance
    between solution points in consecutive iterations. It reflects the
    trust the algorithm puts in the local approximation of the optimization
    problem. For an accurate local approximation the trust-region should be
    large and for an  approximation valid only close to the current point it
    should be a small one. The trust radius is automatically updated throughout
    the optimization process, with ``initial_tr_radius`` being its initial value.
    Default is 1 (recommended in [1]_, p. 19).
initial_constr_penalty : float, optional
    Initial constraints penalty parameter. The penalty parameter is used for
    balancing the requirements of decreasing the objective function
    and satisfying the constraints. It is used for defining the merit function:
    ``merit_function(x) = fun(x) + constr_penalty * constr_norm_l2(x)``,
    where ``constr_norm_l2(x)`` is the l2 norm of a vector containing all
    the constraints. The merit function is used for accepting or rejecting
    trial points and ``constr_penalty`` weights the two conflicting goals
    of reducing objective function and constraints. The penalty is automatically
    updated throughout the optimization  process, with
    ``initial_constr_penalty`` being its  initial value. Default is 1
    (recommended in [1]_, p 19).
initial_barrier_parameter, initial_barrier_tolerance: float, optional
    Initial barrier parameter and initial tolerance for the barrier subproblem.
    Both are used only when inequality constraints are present. For dealing with
    optimization problems ``min_x f(x)`` subject to inequality constraints
    ``c(x) &lt;= 0`` the algorithm introduces slack variables, solving the problem
    ``min_(x,s) f(x) + barrier_parameter*sum(ln(s))`` subject to the equality
    constraints  ``c(x) + s = 0`` instead of the original problem. This subproblem
    is solved for decreasing values of ``barrier_parameter`` and with decreasing
    tolerances for the termination, starting with ``initial_barrier_parameter``
    for the barrier parameter and ``initial_barrier_tolerance`` for the
    barrier tolerance. Default is 0.1 for both values (recommended in [1]_ p. 19).
    Also note that ``barrier_parameter`` and ``barrier_tolerance`` are updated
    with the same prefactor.
factorization_method : string or None, optional
    Method to factorize the Jacobian of the constraints. Use None (default)
    for the auto selection or one of:

        - 'NormalEquation' (requires scikit-sparse)
        - 'AugmentedSystem'
        - 'QRFactorization'
        - 'SVDFactorization'

    The methods 'NormalEquation' and 'AugmentedSystem' can be used only
    with sparse constraints. The projections required by the algorithm
    will be computed using, respectively, the the normal equation  and the
    augmented system approaches explained in [1]_. 'NormalEquation'
    computes the Cholesky factorization of ``A A.T`` and 'AugmentedSystem'
    performs the LU factorization of an augmented system. They usually
    provide similar results. 'AugmentedSystem' is used by default for
    sparse matrices.

    The methods 'QRFactorization' and 'SVDFactorization' can be used
    only with dense constraints. They compute the required projections
    using, respectively, QR and SVD factorizations. The 'SVDFactorization'
    method can cope with Jacobian matrices with deficient row rank and will
    be used whenever other factorization methods fail (which may imply the
    conversion of sparse matrices to a dense format when required).
    By default, 'QRFactorization' is used for dense matrices.
finite_diff_rel_step : None or array_like, optional
    Relative step size for the finite difference approximation.
maxiter : int, optional
    Maximum number of algorithm iterations. Default is 1000.
verbose : {0, 1, 2}, optional
    Level of algorithm's verbosity:

        * 0 (default) : work silently.
        * 1 : display a termination report.
        * 2 : display progress during iterations.
        * 3 : display progress during iterations (more complete report).

disp : bool, optional
    If True (default), then `verbose` will be set to 1 if it was 0.

Returns
-------
`OptimizeResult` with the fields documented below. Note the following:

    1. All values corresponding to the constraints are ordered as they
       were passed to the solver. And values corresponding to `bounds`
       constraints are put *after* other constraints.
    2. All numbers of function, Jacobian or Hessian evaluations correspond
       to numbers of actual Python function calls. It means, for example,
       that if a Jacobian is estimated by finite differences, then the
       number of Jacobian evaluations will be zero and the number of
       function evaluations will be incremented by all calls during the
       finite difference estimation.

x : ndarray, shape (n,)
    Solution found.
optimality : float
    Infinity norm of the Lagrangian gradient at the solution.
constr_violation : float
    Maximum constraint violation at the solution.
fun : float
    Objective function at the solution.
grad : ndarray, shape (n,)
    Gradient of the objective function at the solution.
lagrangian_grad : ndarray, shape (n,)
    Gradient of the Lagrangian function at the solution.
nit : int
    Total number of iterations.
nfev : integer
    Number of the objective function evaluations.
njev : integer
    Number of the objective function gradient evaluations.
nhev : integer
    Number of the objective function Hessian evaluations.
cg_niter : int
    Total number of the conjugate gradient method iterations.
method : {'equality_constrained_sqp', 'tr_interior_point'}
    Optimization method used.
constr : list of ndarray
    List of constraint values at the solution.
jac : list of {ndarray, sparse matrix}
    List of the Jacobian matrices of the constraints at the solution.
v : list of ndarray
    List of the Lagrange multipliers for the constraints at the solution.
    For an inequality constraint a positive multiplier means that the upper
    bound is active, a negative multiplier means that the lower bound is
    active and if a multiplier is zero it means the constraint is not
    active.
constr_nfev : list of int
    Number of constraint evaluations for each of the constraints.
constr_njev : list of int
    Number of Jacobian matrix evaluations for each of the constraints.
constr_nhev : list of int
    Number of Hessian evaluations for each of the constraints.
tr_radius : float
    Radius of the trust region at the last iteration.
constr_penalty : float
    Penalty parameter at the last iteration, see `initial_constr_penalty`.
barrier_tolerance : float
    Tolerance for the barrier subproblem at the last iteration.
    Only for problems with inequality constraints.
barrier_parameter : float
    Barrier parameter at the last iteration. Only for problems
    with inequality constraints.
execution_time : float
    Total execution time.
message : str
    Termination message.
status : {0, 1, 2, 3}
    Termination status:

        * 0 : The maximum number of function evaluations is exceeded.
        * 1 : `gtol` termination condition is satisfied.
        * 2 : `xtol` termination condition is satisfied.
        * 3 : `callback` function requested termination.

cg_stop_cond : int
    Reason for CG subproblem termination at the last iteration:

        * 0 : CG subproblem not evaluated.
        * 1 : Iteration limit was reached.
        * 2 : Reached the trust-region boundary.
        * 3 : Negative curvature detected.
        * 4 : Tolerance was satisfied.

References
----------
.. [1] Conn, A. R., Gould, N. I., &amp; Toint, P. L.
       Trust region methods. 2000. Siam. pp. 19.
</pre> <div class="fragment"><div class="line"><span class="lineno">  125</span>                                 disp=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  126</span>    <span class="stringliteral">&quot;&quot;&quot;Minimize a scalar function subject to constraints.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">    gtol : float, optional</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">        Tolerance for termination by the norm of the Lagrangian gradient.</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">        The algorithm will terminate when both the infinity norm (i.e., max</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">        abs value) of the Lagrangian gradient and the constraint violation</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">        are smaller than ``gtol``. Default is 1e-8.</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    xtol : float, optional</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">        Tolerance for termination by the change of the independent variable.</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">        The algorithm will terminate when ``tr_radius &lt; xtol``, where</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        ``tr_radius`` is the radius of the trust region used in the algorithm.</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">        Default is 1e-8.</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    barrier_tol : float, optional</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">        Threshold on the barrier parameter for the algorithm termination.</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">        When inequality constraints are present, the algorithm will terminate</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">        only when the barrier parameter is less than `barrier_tol`.</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        Default is 1e-8.</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    sparse_jacobian : {bool, None}, optional</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">        Determines how to represent Jacobians of the constraints. If bool,</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">        then Jacobians of all the constraints will be converted to the</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">        corresponding format. If None (default), then Jacobians won&#39;t be</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">        converted, but the algorithm can proceed only if they all have the</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        same format.</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    initial_tr_radius: float, optional</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">        Initial trust radius. The trust radius gives the maximum distance</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">        between solution points in consecutive iterations. It reflects the</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">        trust the algorithm puts in the local approximation of the optimization</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">        problem. For an accurate local approximation the trust-region should be</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">        large and for an  approximation valid only close to the current point it</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">        should be a small one. The trust radius is automatically updated throughout</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">        the optimization process, with ``initial_tr_radius`` being its initial value.</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">        Default is 1 (recommended in [1]_, p. 19).</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">    initial_constr_penalty : float, optional</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">        Initial constraints penalty parameter. The penalty parameter is used for</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">        balancing the requirements of decreasing the objective function</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">        and satisfying the constraints. It is used for defining the merit function:</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">        ``merit_function(x) = fun(x) + constr_penalty * constr_norm_l2(x)``,</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">        where ``constr_norm_l2(x)`` is the l2 norm of a vector containing all</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">        the constraints. The merit function is used for accepting or rejecting</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">        trial points and ``constr_penalty`` weights the two conflicting goals</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">        of reducing objective function and constraints. The penalty is automatically</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">        updated throughout the optimization  process, with</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">        ``initial_constr_penalty`` being its  initial value. Default is 1</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">        (recommended in [1]_, p 19).</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">    initial_barrier_parameter, initial_barrier_tolerance: float, optional</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">        Initial barrier parameter and initial tolerance for the barrier subproblem.</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">        Both are used only when inequality constraints are present. For dealing with</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">        optimization problems ``min_x f(x)`` subject to inequality constraints</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">        ``c(x) &lt;= 0`` the algorithm introduces slack variables, solving the problem</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">        ``min_(x,s) f(x) + barrier_parameter*sum(ln(s))`` subject to the equality</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">        constraints  ``c(x) + s = 0`` instead of the original problem. This subproblem</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">        is solved for decreasing values of ``barrier_parameter`` and with decreasing</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">        tolerances for the termination, starting with ``initial_barrier_parameter``</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">        for the barrier parameter and ``initial_barrier_tolerance`` for the</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">        barrier tolerance. Default is 0.1 for both values (recommended in [1]_ p. 19).</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">        Also note that ``barrier_parameter`` and ``barrier_tolerance`` are updated</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">        with the same prefactor.</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">    factorization_method : string or None, optional</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">        Method to factorize the Jacobian of the constraints. Use None (default)</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">        for the auto selection or one of:</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">            - &#39;NormalEquation&#39; (requires scikit-sparse)</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">            - &#39;AugmentedSystem&#39;</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">            - &#39;QRFactorization&#39;</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">            - &#39;SVDFactorization&#39;</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">        The methods &#39;NormalEquation&#39; and &#39;AugmentedSystem&#39; can be used only</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">        with sparse constraints. The projections required by the algorithm</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">        will be computed using, respectively, the the normal equation  and the</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">        augmented system approaches explained in [1]_. &#39;NormalEquation&#39;</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">        computes the Cholesky factorization of ``A A.T`` and &#39;AugmentedSystem&#39;</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">        performs the LU factorization of an augmented system. They usually</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">        provide similar results. &#39;AugmentedSystem&#39; is used by default for</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">        sparse matrices.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">        The methods &#39;QRFactorization&#39; and &#39;SVDFactorization&#39; can be used</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">        only with dense constraints. They compute the required projections</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">        using, respectively, QR and SVD factorizations. The &#39;SVDFactorization&#39;</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">        method can cope with Jacobian matrices with deficient row rank and will</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">        be used whenever other factorization methods fail (which may imply the</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">        conversion of sparse matrices to a dense format when required).</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">        By default, &#39;QRFactorization&#39; is used for dense matrices.</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    finite_diff_rel_step : None or array_like, optional</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">        Relative step size for the finite difference approximation.</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">        Maximum number of algorithm iterations. Default is 1000.</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">    verbose : {0, 1, 2}, optional</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">        Level of algorithm&#39;s verbosity:</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">            * 0 (default) : work silently.</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">            * 1 : display a termination report.</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">            * 2 : display progress during iterations.</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">            * 3 : display progress during iterations (more complete report).</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    disp : bool, optional</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">        If True (default), then `verbose` will be set to 1 if it was 0.</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    `OptimizeResult` with the fields documented below. Note the following:</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">        1. All values corresponding to the constraints are ordered as they</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">           were passed to the solver. And values corresponding to `bounds`</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">           constraints are put *after* other constraints.</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">        2. All numbers of function, Jacobian or Hessian evaluations correspond</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">           to numbers of actual Python function calls. It means, for example,</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">           that if a Jacobian is estimated by finite differences, then the</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">           number of Jacobian evaluations will be zero and the number of</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">           function evaluations will be incremented by all calls during the</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">           finite difference estimation.</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">    x : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral">        Solution found.</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    optimality : float</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">        Infinity norm of the Lagrangian gradient at the solution.</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    constr_violation : float</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">        Maximum constraint violation at the solution.</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    fun : float</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">        Objective function at the solution.</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    grad : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">        Gradient of the objective function at the solution.</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    lagrangian_grad : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">        Gradient of the Lagrangian function at the solution.</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    nit : int</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">        Total number of iterations.</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    nfev : integer</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">        Number of the objective function evaluations.</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">    njev : integer</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">        Number of the objective function gradient evaluations.</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    nhev : integer</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">        Number of the objective function Hessian evaluations.</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">    cg_niter : int</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">        Total number of the conjugate gradient method iterations.</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    method : {&#39;equality_constrained_sqp&#39;, &#39;tr_interior_point&#39;}</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">        Optimization method used.</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">    constr : list of ndarray</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">        List of constraint values at the solution.</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    jac : list of {ndarray, sparse matrix}</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">        List of the Jacobian matrices of the constraints at the solution.</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    v : list of ndarray</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">        List of the Lagrange multipliers for the constraints at the solution.</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">        For an inequality constraint a positive multiplier means that the upper</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">        bound is active, a negative multiplier means that the lower bound is</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">        active and if a multiplier is zero it means the constraint is not</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">        active.</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    constr_nfev : list of int</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">        Number of constraint evaluations for each of the constraints.</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    constr_njev : list of int</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">        Number of Jacobian matrix evaluations for each of the constraints.</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    constr_nhev : list of int</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">        Number of Hessian evaluations for each of the constraints.</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">    tr_radius : float</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">        Radius of the trust region at the last iteration.</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">    constr_penalty : float</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">        Penalty parameter at the last iteration, see `initial_constr_penalty`.</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">    barrier_tolerance : float</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">        Tolerance for the barrier subproblem at the last iteration.</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">        Only for problems with inequality constraints.</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">    barrier_parameter : float</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">        Barrier parameter at the last iteration. Only for problems</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">        with inequality constraints.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">    execution_time : float</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">        Total execution time.</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">        Termination message.</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">    status : {0, 1, 2, 3}</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">        Termination status:</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">            * 0 : The maximum number of function evaluations is exceeded.</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">            * 1 : `gtol` termination condition is satisfied.</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">            * 2 : `xtol` termination condition is satisfied.</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">            * 3 : `callback` function requested termination.</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">    cg_stop_cond : int</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">        Reason for CG subproblem termination at the last iteration:</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">            * 0 : CG subproblem not evaluated.</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">            * 1 : Iteration limit was reached.</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">            * 2 : Reached the trust-region boundary.</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">            * 3 : Negative curvature detected.</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">            * 4 : Tolerance was satisfied.</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">    .. [1] Conn, A. R., Gould, N. I., &amp; Toint, P. L.</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">           Trust region methods. 2000. Siam. pp. 19.</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  315</span>    x0 = np.atleast_1d(x0).astype(float)</div>
<div class="line"><span class="lineno">  316</span>    n_vars = np.size(x0)</div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">if</span> hess <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  318</span>        <span class="keywordflow">if</span> callable(hessp):</div>
<div class="line"><span class="lineno">  319</span>            hess = HessianLinearOperator(hessp, n_vars)</div>
<div class="line"><span class="lineno">  320</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  321</span>            hess = BFGS()</div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordflow">if</span> disp <span class="keywordflow">and</span> verbose == 0:</div>
<div class="line"><span class="lineno">  323</span>        verbose = 1</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  326</span>        finite_diff_bounds = strict_bounds(bounds.lb, bounds.ub,</div>
<div class="line"><span class="lineno">  327</span>                                           bounds.keep_feasible, n_vars)</div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  329</span>        finite_diff_bounds = (-np.inf, np.inf)</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    <span class="comment"># Define Objective Function</span></div>
<div class="line"><span class="lineno">  332</span>    objective = ScalarFunction(fun, x0, args, grad, hess,</div>
<div class="line"><span class="lineno">  333</span>                               finite_diff_rel_step, finite_diff_bounds)</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    <span class="comment"># Put constraints in list format when needed.</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">if</span> isinstance(constraints, (NonlinearConstraint, LinearConstraint)):</div>
<div class="line"><span class="lineno">  337</span>        constraints = [constraints]</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    <span class="comment"># Prepare constraints.</span></div>
<div class="line"><span class="lineno">  340</span>    prepared_constraints = [</div>
<div class="line"><span class="lineno">  341</span>        PreparedConstraint(c, x0, sparse_jacobian, finite_diff_bounds)</div>
<div class="line"><span class="lineno">  342</span>        <span class="keywordflow">for</span> c <span class="keywordflow">in</span> constraints]</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>    <span class="comment"># Check that all constraints are either sparse or dense.</span></div>
<div class="line"><span class="lineno">  345</span>    n_sparse = sum(c.fun.sparse_jacobian <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints)</div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span> 0 &lt; n_sparse &lt; len(prepared_constraints):</div>
<div class="line"><span class="lineno">  347</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;All constraints must have the same kind of the &quot;</span></div>
<div class="line"><span class="lineno">  348</span>                         <span class="stringliteral">&quot;Jacobian --- either all sparse or all dense. &quot;</span></div>
<div class="line"><span class="lineno">  349</span>                         <span class="stringliteral">&quot;You can set the sparsity globally by setting &quot;</span></div>
<div class="line"><span class="lineno">  350</span>                         <span class="stringliteral">&quot;`sparse_jacobian` to either True of False.&quot;</span>)</div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">if</span> prepared_constraints:</div>
<div class="line"><span class="lineno">  352</span>        sparse_jacobian = n_sparse &gt; 0</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">if</span> sparse_jacobian <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  356</span>            sparse_jacobian = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  357</span>        prepared_constraints.append(PreparedConstraint(bounds, x0,</div>
<div class="line"><span class="lineno">  358</span>                                                       sparse_jacobian))</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    <span class="comment"># Concatenate initial constraints to the canonical form.</span></div>
<div class="line"><span class="lineno">  361</span>    c_eq0, c_ineq0, J_eq0, J_ineq0 = initial_constraints_as_canonical(</div>
<div class="line"><span class="lineno">  362</span>        n_vars, prepared_constraints, sparse_jacobian)</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>    <span class="comment"># Prepare all canonical constraints and concatenate it into one.</span></div>
<div class="line"><span class="lineno">  365</span>    canonical_all = [CanonicalConstraint.from_PreparedConstraint(c)</div>
<div class="line"><span class="lineno">  366</span>                     <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints]</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">if</span> len(canonical_all) == 0:</div>
<div class="line"><span class="lineno">  369</span>        canonical = CanonicalConstraint.empty(n_vars)</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">elif</span> len(canonical_all) == 1:</div>
<div class="line"><span class="lineno">  371</span>        canonical = canonical_all[0]</div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  373</span>        canonical = CanonicalConstraint.concatenate(canonical_all,</div>
<div class="line"><span class="lineno">  374</span>                                                    sparse_jacobian)</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    <span class="comment"># Generate the Hessian of the Lagrangian.</span></div>
<div class="line"><span class="lineno">  377</span>    lagrangian_hess = LagrangianHessian(n_vars, objective.hess, canonical.hess)</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    <span class="comment"># Choose appropriate method</span></div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">if</span> canonical.n_ineq == 0:</div>
<div class="line"><span class="lineno">  381</span>        method = <span class="stringliteral">&#39;equality_constrained_sqp&#39;</span></div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  383</span>        method = <span class="stringliteral">&#39;tr_interior_point&#39;</span></div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    <span class="comment"># Construct OptimizeResult</span></div>
<div class="line"><span class="lineno">  386</span>    state = OptimizeResult(</div>
<div class="line"><span class="lineno">  387</span>        nit=0, nfev=0, njev=0, nhev=0,</div>
<div class="line"><span class="lineno">  388</span>        cg_niter=0, cg_stop_cond=0,</div>
<div class="line"><span class="lineno">  389</span>        fun=objective.f, grad=objective.g,</div>
<div class="line"><span class="lineno">  390</span>        lagrangian_grad=np.copy(objective.g),</div>
<div class="line"><span class="lineno">  391</span>        constr=[c.fun.f <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints],</div>
<div class="line"><span class="lineno">  392</span>        jac=[c.fun.J <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints],</div>
<div class="line"><span class="lineno">  393</span>        constr_nfev=[0 <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints],</div>
<div class="line"><span class="lineno">  394</span>        constr_njev=[0 <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints],</div>
<div class="line"><span class="lineno">  395</span>        constr_nhev=[0 <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints],</div>
<div class="line"><span class="lineno">  396</span>        v=[c.fun.v <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints],</div>
<div class="line"><span class="lineno">  397</span>        method=method)</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>    <span class="comment"># Start counting</span></div>
<div class="line"><span class="lineno">  400</span>    start_time = time.time()</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>    <span class="comment"># Define stop criteria</span></div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;equality_constrained_sqp&#39;</span>:</div>
<div class="line"><span class="lineno">  404</span>        <span class="keyword">def </span>stop_criteria(state, x, last_iteration_failed,</div>
<div class="line"><span class="lineno">  405</span>                          optimality, constr_violation,</div>
<div class="line"><span class="lineno">  406</span>                          tr_radius, constr_penalty, cg_info):</div>
<div class="line"><span class="lineno">  407</span>            state = update_state_sqp(state, x, last_iteration_failed,</div>
<div class="line"><span class="lineno">  408</span>                                     objective, prepared_constraints,</div>
<div class="line"><span class="lineno">  409</span>                                     start_time, tr_radius, constr_penalty,</div>
<div class="line"><span class="lineno">  410</span>                                     cg_info)</div>
<div class="line"><span class="lineno">  411</span>            <span class="keywordflow">if</span> verbose == 2:</div>
<div class="line"><span class="lineno">  412</span>                BasicReport.print_iteration(state.nit,</div>
<div class="line"><span class="lineno">  413</span>                                            state.nfev,</div>
<div class="line"><span class="lineno">  414</span>                                            state.cg_niter,</div>
<div class="line"><span class="lineno">  415</span>                                            state.fun,</div>
<div class="line"><span class="lineno">  416</span>                                            state.tr_radius,</div>
<div class="line"><span class="lineno">  417</span>                                            state.optimality,</div>
<div class="line"><span class="lineno">  418</span>                                            state.constr_violation)</div>
<div class="line"><span class="lineno">  419</span>            <span class="keywordflow">elif</span> verbose &gt; 2:</div>
<div class="line"><span class="lineno">  420</span>                SQPReport.print_iteration(state.nit,</div>
<div class="line"><span class="lineno">  421</span>                                          state.nfev,</div>
<div class="line"><span class="lineno">  422</span>                                          state.cg_niter,</div>
<div class="line"><span class="lineno">  423</span>                                          state.fun,</div>
<div class="line"><span class="lineno">  424</span>                                          state.tr_radius,</div>
<div class="line"><span class="lineno">  425</span>                                          state.optimality,</div>
<div class="line"><span class="lineno">  426</span>                                          state.constr_violation,</div>
<div class="line"><span class="lineno">  427</span>                                          state.constr_penalty,</div>
<div class="line"><span class="lineno">  428</span>                                          state.cg_stop_cond)</div>
<div class="line"><span class="lineno">  429</span>            state.status = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  430</span>            state.niter = state.nit  <span class="comment"># Alias for callback (backward-compatibility)</span></div>
<div class="line"><span class="lineno">  431</span>            <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> callback(np.copy(state.x), state):</div>
<div class="line"><span class="lineno">  432</span>                state.status = 3</div>
<div class="line"><span class="lineno">  433</span>            <span class="keywordflow">elif</span> state.optimality &lt; gtol <span class="keywordflow">and</span> state.constr_violation &lt; gtol:</div>
<div class="line"><span class="lineno">  434</span>                state.status = 1</div>
<div class="line"><span class="lineno">  435</span>            <span class="keywordflow">elif</span> state.tr_radius &lt; xtol:</div>
<div class="line"><span class="lineno">  436</span>                state.status = 2</div>
<div class="line"><span class="lineno">  437</span>            <span class="keywordflow">elif</span> state.nit &gt;= maxiter:</div>
<div class="line"><span class="lineno">  438</span>                state.status = 0</div>
<div class="line"><span class="lineno">  439</span>            <span class="keywordflow">return</span> state.status <span class="keywordflow">in</span> (0, 1, 2, 3)</div>
<div class="line"><span class="lineno">  440</span>    <span class="keywordflow">elif</span> method == <span class="stringliteral">&#39;tr_interior_point&#39;</span>:</div>
<div class="line"><span class="lineno">  441</span>        <span class="keyword">def </span>stop_criteria(state, x, last_iteration_failed, tr_radius,</div>
<div class="line"><span class="lineno">  442</span>                          constr_penalty, cg_info, barrier_parameter,</div>
<div class="line"><span class="lineno">  443</span>                          barrier_tolerance):</div>
<div class="line"><span class="lineno">  444</span>            state = update_state_ip(state, x, last_iteration_failed,</div>
<div class="line"><span class="lineno">  445</span>                                    objective, prepared_constraints,</div>
<div class="line"><span class="lineno">  446</span>                                    start_time, tr_radius, constr_penalty,</div>
<div class="line"><span class="lineno">  447</span>                                    cg_info, barrier_parameter, barrier_tolerance)</div>
<div class="line"><span class="lineno">  448</span>            <span class="keywordflow">if</span> verbose == 2:</div>
<div class="line"><span class="lineno">  449</span>                BasicReport.print_iteration(state.nit,</div>
<div class="line"><span class="lineno">  450</span>                                            state.nfev,</div>
<div class="line"><span class="lineno">  451</span>                                            state.cg_niter,</div>
<div class="line"><span class="lineno">  452</span>                                            state.fun,</div>
<div class="line"><span class="lineno">  453</span>                                            state.tr_radius,</div>
<div class="line"><span class="lineno">  454</span>                                            state.optimality,</div>
<div class="line"><span class="lineno">  455</span>                                            state.constr_violation)</div>
<div class="line"><span class="lineno">  456</span>            <span class="keywordflow">elif</span> verbose &gt; 2:</div>
<div class="line"><span class="lineno">  457</span>                IPReport.print_iteration(state.nit,</div>
<div class="line"><span class="lineno">  458</span>                                         state.nfev,</div>
<div class="line"><span class="lineno">  459</span>                                         state.cg_niter,</div>
<div class="line"><span class="lineno">  460</span>                                         state.fun,</div>
<div class="line"><span class="lineno">  461</span>                                         state.tr_radius,</div>
<div class="line"><span class="lineno">  462</span>                                         state.optimality,</div>
<div class="line"><span class="lineno">  463</span>                                         state.constr_violation,</div>
<div class="line"><span class="lineno">  464</span>                                         state.constr_penalty,</div>
<div class="line"><span class="lineno">  465</span>                                         state.barrier_parameter,</div>
<div class="line"><span class="lineno">  466</span>                                         state.cg_stop_cond)</div>
<div class="line"><span class="lineno">  467</span>            state.status = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  468</span>            state.niter = state.nit  <span class="comment"># Alias for callback (backward compatibility)</span></div>
<div class="line"><span class="lineno">  469</span>            <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> callback(np.copy(state.x), state):</div>
<div class="line"><span class="lineno">  470</span>                state.status = 3</div>
<div class="line"><span class="lineno">  471</span>            <span class="keywordflow">elif</span> state.optimality &lt; gtol <span class="keywordflow">and</span> state.constr_violation &lt; gtol:</div>
<div class="line"><span class="lineno">  472</span>                state.status = 1</div>
<div class="line"><span class="lineno">  473</span>            <span class="keywordflow">elif</span> (state.tr_radius &lt; xtol</div>
<div class="line"><span class="lineno">  474</span>                  <span class="keywordflow">and</span> state.barrier_parameter &lt; barrier_tol):</div>
<div class="line"><span class="lineno">  475</span>                state.status = 2</div>
<div class="line"><span class="lineno">  476</span>            <span class="keywordflow">elif</span> state.nit &gt;= maxiter:</div>
<div class="line"><span class="lineno">  477</span>                state.status = 0</div>
<div class="line"><span class="lineno">  478</span>            <span class="keywordflow">return</span> state.status <span class="keywordflow">in</span> (0, 1, 2, 3)</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">if</span> verbose == 2:</div>
<div class="line"><span class="lineno">  481</span>        BasicReport.print_header()</div>
<div class="line"><span class="lineno">  482</span>    <span class="keywordflow">elif</span> verbose &gt; 2:</div>
<div class="line"><span class="lineno">  483</span>        <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;equality_constrained_sqp&#39;</span>:</div>
<div class="line"><span class="lineno">  484</span>            SQPReport.print_header()</div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">elif</span> method == <span class="stringliteral">&#39;tr_interior_point&#39;</span>:</div>
<div class="line"><span class="lineno">  486</span>            IPReport.print_header()</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    <span class="comment"># Call inferior function to do the optimization</span></div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;equality_constrained_sqp&#39;</span>:</div>
<div class="line"><span class="lineno">  490</span>        <span class="keyword">def </span>fun_and_constr(x):</div>
<div class="line"><span class="lineno">  491</span>            f = objective.fun(x)</div>
<div class="line"><span class="lineno">  492</span>            c_eq, _ = canonical.fun(x)</div>
<div class="line"><span class="lineno">  493</span>            <span class="keywordflow">return</span> f, c_eq</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>        <span class="keyword">def </span>grad_and_jac(x):</div>
<div class="line"><span class="lineno">  496</span>            g = objective.grad(x)</div>
<div class="line"><span class="lineno">  497</span>            J_eq, _ = canonical.jac(x)</div>
<div class="line"><span class="lineno">  498</span>            <span class="keywordflow">return</span> g, J_eq</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>        _, result = equality_constrained_sqp(</div>
<div class="line"><span class="lineno">  501</span>            fun_and_constr, grad_and_jac, lagrangian_hess,</div>
<div class="line"><span class="lineno">  502</span>            x0, objective.f, objective.g,</div>
<div class="line"><span class="lineno">  503</span>            c_eq0, J_eq0,</div>
<div class="line"><span class="lineno">  504</span>            stop_criteria, state,</div>
<div class="line"><span class="lineno">  505</span>            initial_constr_penalty, initial_tr_radius,</div>
<div class="line"><span class="lineno">  506</span>            factorization_method)</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>    <span class="keywordflow">elif</span> method == <span class="stringliteral">&#39;tr_interior_point&#39;</span>:</div>
<div class="line"><span class="lineno">  509</span>        _, result = tr_interior_point(</div>
<div class="line"><span class="lineno">  510</span>            objective.fun, objective.grad, lagrangian_hess,</div>
<div class="line"><span class="lineno">  511</span>            n_vars, canonical.n_ineq, canonical.n_eq,</div>
<div class="line"><span class="lineno">  512</span>            canonical.fun, canonical.jac,</div>
<div class="line"><span class="lineno">  513</span>            x0, objective.f, objective.g,</div>
<div class="line"><span class="lineno">  514</span>            c_ineq0, J_ineq0, c_eq0, J_eq0,</div>
<div class="line"><span class="lineno">  515</span>            stop_criteria,</div>
<div class="line"><span class="lineno">  516</span>            canonical.keep_feasible,</div>
<div class="line"><span class="lineno">  517</span>            xtol, state, initial_barrier_parameter,</div>
<div class="line"><span class="lineno">  518</span>            initial_barrier_tolerance,</div>
<div class="line"><span class="lineno">  519</span>            initial_constr_penalty, initial_tr_radius,</div>
<div class="line"><span class="lineno">  520</span>            factorization_method)</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="comment"># Status 3 occurs when the callback function requests termination,</span></div>
<div class="line"><span class="lineno">  523</span>    <span class="comment"># this is assumed to not be a success.</span></div>
<div class="line"><span class="lineno">  524</span>    result.success = <span class="keyword">True</span> <span class="keywordflow">if</span> result.status <span class="keywordflow">in</span> (1, 2) <span class="keywordflow">else</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  525</span>    result.message = TERMINATION_MESSAGES[result.status]</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>    <span class="comment"># Alias (for backward compatibility with 1.1.0)</span></div>
<div class="line"><span class="lineno">  528</span>    result.niter = result.nit</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordflow">if</span> verbose == 2:</div>
<div class="line"><span class="lineno">  531</span>        BasicReport.print_footer()</div>
<div class="line"><span class="lineno">  532</span>    <span class="keywordflow">elif</span> verbose &gt; 2:</div>
<div class="line"><span class="lineno">  533</span>        <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;equality_constrained_sqp&#39;</span>:</div>
<div class="line"><span class="lineno">  534</span>            SQPReport.print_footer()</div>
<div class="line"><span class="lineno">  535</span>        <span class="keywordflow">elif</span> method == <span class="stringliteral">&#39;tr_interior_point&#39;</span>:</div>
<div class="line"><span class="lineno">  536</span>            IPReport.print_footer()</div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">if</span> verbose &gt;= 1:</div>
<div class="line"><span class="lineno">  538</span>        print(result.message)</div>
<div class="line"><span class="lineno">  539</span>        print(<span class="stringliteral">&quot;Number of iterations: {}, function evaluations: {}, &quot;</span></div>
<div class="line"><span class="lineno">  540</span>              <span class="stringliteral">&quot;CG iterations: {}, optimality: {:.2e}, &quot;</span></div>
<div class="line"><span class="lineno">  541</span>              <span class="stringliteral">&quot;constraint violation: {:.2e}, execution time: {:4.2} s.&quot;</span></div>
<div class="line"><span class="lineno">  542</span>              .format(result.nit, result.nfev, result.cg_niter,</div>
<div class="line"><span class="lineno">  543</span>                      result.optimality, result.constr_violation,</div>
<div class="line"><span class="lineno">  544</span>                      result.execution_time))</div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">return</span> result</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b7c8df292dcaffa9a28b6d4c3e3ddd1" name="a6b7c8df292dcaffa9a28b6d4c3e3ddd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b7c8df292dcaffa9a28b6d4c3e3ddd1">&#9670;&#160;</a></span>update_state_ip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._trustregion_constr.minimize_trustregion_constr.update_state_ip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>last_iteration_failed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>objective</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>prepared_constraints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>start_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tr_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constr_penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cg_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>barrier_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>barrier_tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  105</span>                    barrier_parameter, barrier_tolerance):</div>
<div class="line"><span class="lineno">  106</span>    state = update_state_sqp(state, x, last_iteration_failed, objective,</div>
<div class="line"><span class="lineno">  107</span>                             prepared_constraints, start_time, tr_radius,</div>
<div class="line"><span class="lineno">  108</span>                             constr_penalty, cg_info)</div>
<div class="line"><span class="lineno">  109</span>    state.barrier_parameter = barrier_parameter</div>
<div class="line"><span class="lineno">  110</span>    state.barrier_tolerance = barrier_tolerance</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">return</span> state</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af01858cec62fc8614c2ea0b33498f1d1" name="af01858cec62fc8614c2ea0b33498f1d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af01858cec62fc8614c2ea0b33498f1d1">&#9670;&#160;</a></span>update_state_sqp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._trustregion_constr.minimize_trustregion_constr.update_state_sqp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>last_iteration_failed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>objective</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>prepared_constraints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>start_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tr_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constr_penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cg_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   60</span>                     start_time, tr_radius, constr_penalty, cg_info):</div>
<div class="line"><span class="lineno">   61</span>    state.nit += 1</div>
<div class="line"><span class="lineno">   62</span>    state.nfev = objective.nfev</div>
<div class="line"><span class="lineno">   63</span>    state.njev = objective.ngev</div>
<div class="line"><span class="lineno">   64</span>    state.nhev = objective.nhev</div>
<div class="line"><span class="lineno">   65</span>    state.constr_nfev = [c.fun.nfev <span class="keywordflow">if</span> isinstance(c.fun, VectorFunction) <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">   66</span>                         <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints]</div>
<div class="line"><span class="lineno">   67</span>    state.constr_njev = [c.fun.njev <span class="keywordflow">if</span> isinstance(c.fun, VectorFunction) <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">   68</span>                         <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints]</div>
<div class="line"><span class="lineno">   69</span>    state.constr_nhev = [c.fun.nhev <span class="keywordflow">if</span> isinstance(c.fun, VectorFunction) <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">   70</span>                         <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints]</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> last_iteration_failed:</div>
<div class="line"><span class="lineno">   73</span>        state.x = x</div>
<div class="line"><span class="lineno">   74</span>        state.fun = objective.f</div>
<div class="line"><span class="lineno">   75</span>        state.grad = objective.g</div>
<div class="line"><span class="lineno">   76</span>        state.v = [c.fun.v <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints]</div>
<div class="line"><span class="lineno">   77</span>        state.constr = [c.fun.f <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints]</div>
<div class="line"><span class="lineno">   78</span>        state.jac = [c.fun.J <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints]</div>
<div class="line"><span class="lineno">   79</span>        <span class="comment"># Compute Lagrangian Gradient</span></div>
<div class="line"><span class="lineno">   80</span>        state.lagrangian_grad = np.copy(state.grad)</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">for</span> c <span class="keywordflow">in</span> prepared_constraints:</div>
<div class="line"><span class="lineno">   82</span>            state.lagrangian_grad += c.fun.J.T.dot(c.fun.v)</div>
<div class="line"><span class="lineno">   83</span>        state.optimality = np.linalg.norm(state.lagrangian_grad, np.inf)</div>
<div class="line"><span class="lineno">   84</span>        <span class="comment"># Compute maximum constraint violation</span></div>
<div class="line"><span class="lineno">   85</span>        state.constr_violation = 0</div>
<div class="line"><span class="lineno">   86</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(prepared_constraints)):</div>
<div class="line"><span class="lineno">   87</span>            lb, ub = prepared_constraints[i].bounds</div>
<div class="line"><span class="lineno">   88</span>            c = state.constr[i]</div>
<div class="line"><span class="lineno">   89</span>            state.constr_violation = np.max([state.constr_violation,</div>
<div class="line"><span class="lineno">   90</span>                                             np.max(lb - c),</div>
<div class="line"><span class="lineno">   91</span>                                             np.max(c - ub)])</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    state.execution_time = time.time() - start_time</div>
<div class="line"><span class="lineno">   94</span>    state.tr_radius = tr_radius</div>
<div class="line"><span class="lineno">   95</span>    state.constr_penalty = constr_penalty</div>
<div class="line"><span class="lineno">   96</span>    state.cg_niter += cg_info[<span class="stringliteral">&quot;niter&quot;</span>]</div>
<div class="line"><span class="lineno">   97</span>    state.cg_stop_cond = cg_info[<span class="stringliteral">&quot;stop_cond&quot;</span>]</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">return</span> state</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4ed886d824357dd1b7a5f6e84a0e6a9b" name="a4ed886d824357dd1b7a5f6e84a0e6a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ed886d824357dd1b7a5f6e84a0e6a9b">&#9670;&#160;</a></span>TERMINATION_MESSAGES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.optimize._trustregion_constr.minimize_trustregion_constr.TERMINATION_MESSAGES</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {</div>
<div class="line"><span class="lineno">    2</span>    0: <span class="stringliteral">&quot;The maximum number of function evaluations is exceeded.&quot;</span>,</div>
<div class="line"><span class="lineno">    3</span>    1: <span class="stringliteral">&quot;`gtol` termination condition is satisfied.&quot;</span>,</div>
<div class="line"><span class="lineno">    4</span>    2: <span class="stringliteral">&quot;`xtol` termination condition is satisfied.&quot;</span>,</div>
<div class="line"><span class="lineno">    5</span>    3: <span class="stringliteral">&quot;`callback` function requested termination.&quot;</span></div>
<div class="line"><span class="lineno">    6</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
