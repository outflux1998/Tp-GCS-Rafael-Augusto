<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.stats._axis_nan_policy Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html">_axis_nan_policy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats._axis_nan_policy Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a89e494de0b496475abc5a61879248a16" id="r_a89e494de0b496475abc5a61879248a16"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a89e494de0b496475abc5a61879248a16">_broadcast_arrays</a> (arrays, axis=None)</td></tr>
<tr class="separator:a89e494de0b496475abc5a61879248a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0a62b35345335d55cbbe337fb320970" id="r_af0a62b35345335d55cbbe337fb320970"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#af0a62b35345335d55cbbe337fb320970">_broadcast_array_shapes</a> (arrays, axis=None)</td></tr>
<tr class="separator:af0a62b35345335d55cbbe337fb320970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa6969676e34ffa788718ba26e0f1b60" id="r_aaa6969676e34ffa788718ba26e0f1b60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#aaa6969676e34ffa788718ba26e0f1b60">_broadcast_shapes</a> (shapes, axis=None)</td></tr>
<tr class="separator:aaa6969676e34ffa788718ba26e0f1b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade8fb852e65ea5c5d8b41044359a677f" id="r_ade8fb852e65ea5c5d8b41044359a677f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#ade8fb852e65ea5c5d8b41044359a677f">_broadcast_array_shapes_remove_axis</a> (arrays, axis=None)</td></tr>
<tr class="separator:ade8fb852e65ea5c5d8b41044359a677f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab89c66ac1e9485e26caf6681f7e23152" id="r_ab89c66ac1e9485e26caf6681f7e23152"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#ab89c66ac1e9485e26caf6681f7e23152">_broadcast_shapes_remove_axis</a> (shapes, axis=None)</td></tr>
<tr class="separator:ab89c66ac1e9485e26caf6681f7e23152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d99a33288ac385cc9eb24cd6bf565c3" id="r_a4d99a33288ac385cc9eb24cd6bf565c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a4d99a33288ac385cc9eb24cd6bf565c3">_broadcast_concatenate</a> (arrays, axis)</td></tr>
<tr class="separator:a4d99a33288ac385cc9eb24cd6bf565c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af02c21ccaff61a6ec1501dd8507cccdd" id="r_af02c21ccaff61a6ec1501dd8507cccdd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#af02c21ccaff61a6ec1501dd8507cccdd">_remove_nans</a> (samples, paired)</td></tr>
<tr class="separator:af02c21ccaff61a6ec1501dd8507cccdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae29c046c8264f4ebfabe4b8c90313120" id="r_ae29c046c8264f4ebfabe4b8c90313120"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#ae29c046c8264f4ebfabe4b8c90313120">_remove_sentinel</a> (samples, paired, sentinel)</td></tr>
<tr class="separator:ae29c046c8264f4ebfabe4b8c90313120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b509cebb650b60e754fc5dd1ddb7b4a" id="r_a7b509cebb650b60e754fc5dd1ddb7b4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a7b509cebb650b60e754fc5dd1ddb7b4a">_masked_arrays_2_sentinel_arrays</a> (samples)</td></tr>
<tr class="separator:a7b509cebb650b60e754fc5dd1ddb7b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00b11a58d2389a452bd7b68c42b1d083" id="r_a00b11a58d2389a452bd7b68c42b1d083"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a00b11a58d2389a452bd7b68c42b1d083">_check_empty_inputs</a> (samples, axis)</td></tr>
<tr class="separator:a00b11a58d2389a452bd7b68c42b1d083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d796e7e4d1ea818f24f2c45ac1a39e4" id="r_a4d796e7e4d1ea818f24f2c45ac1a39e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a4d796e7e4d1ea818f24f2c45ac1a39e4">_add_reduced_axes</a> (res, reduced_axes, keepdims)</td></tr>
<tr class="separator:a4d796e7e4d1ea818f24f2c45ac1a39e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08d64cb207f1654bbedec5141fe52362" id="r_a08d64cb207f1654bbedec5141fe52362"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a08d64cb207f1654bbedec5141fe52362">_get_axis_params</a> (default_axis=0, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a856ab5bd3b45710bd8dabb2dacead7cb">_name</a>=<a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a856ab5bd3b45710bd8dabb2dacead7cb">_name</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a886bfe8d10cff88e7470159b1bc2ff29">_desc</a>=<a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a886bfe8d10cff88e7470159b1bc2ff29">_desc</a>)</td></tr>
<tr class="separator:a08d64cb207f1654bbedec5141fe52362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14c66eb16682b0206a41af37169b1562" id="r_a14c66eb16682b0206a41af37169b1562"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a14c66eb16682b0206a41af37169b1562">_axis_nan_policy_factory</a> (tuple_to_result, default_axis=0, n_samples=1, paired=False, result_to_tuple=None, too_small=0, n_outputs=2, kwd_samples=[])</td></tr>
<tr class="separator:a14c66eb16682b0206a41af37169b1562"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a856ab5bd3b45710bd8dabb2dacead7cb" id="r_a856ab5bd3b45710bd8dabb2dacead7cb"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a856ab5bd3b45710bd8dabb2dacead7cb">_name</a> = 'axis'</td></tr>
<tr class="separator:a856ab5bd3b45710bd8dabb2dacead7cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886bfe8d10cff88e7470159b1bc2ff29" id="r_a886bfe8d10cff88e7470159b1bc2ff29"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a886bfe8d10cff88e7470159b1bc2ff29">_desc</a></td></tr>
<tr class="separator:a886bfe8d10cff88e7470159b1bc2ff29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f8876eaf588af9e1a8944d7fc0d8351" id="r_a1f8876eaf588af9e1a8944d7fc0d8351"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a1f8876eaf588af9e1a8944d7fc0d8351">_type</a> = &quot;{'propagate', 'omit', 'raise'}&quot;</td></tr>
<tr class="separator:a1f8876eaf588af9e1a8944d7fc0d8351"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0c505796b77da16bf18b71afe66ead9" id="r_ad0c505796b77da16bf18b71afe66ead9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#ad0c505796b77da16bf18b71afe66ead9">_nan_policy_parameter_doc</a> = Parameter(<a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a856ab5bd3b45710bd8dabb2dacead7cb">_name</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a1f8876eaf588af9e1a8944d7fc0d8351">_type</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a886bfe8d10cff88e7470159b1bc2ff29">_desc</a>)</td></tr>
<tr class="separator:ad0c505796b77da16bf18b71afe66ead9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55519bc578f48f6b8dbc870c5481ad07" id="r_a55519bc578f48f6b8dbc870c5481ad07"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a55519bc578f48f6b8dbc870c5481ad07">_nan_policy_parameter</a></td></tr>
<tr class="separator:a55519bc578f48f6b8dbc870c5481ad07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6be8ae57ffbbd985d0da47249ad70d5" id="r_ad6be8ae57ffbbd985d0da47249ad70d5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#ad6be8ae57ffbbd985d0da47249ad70d5">_keepdims_parameter_doc</a> = Parameter(<a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a856ab5bd3b45710bd8dabb2dacead7cb">_name</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a1f8876eaf588af9e1a8944d7fc0d8351">_type</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a886bfe8d10cff88e7470159b1bc2ff29">_desc</a>)</td></tr>
<tr class="separator:ad6be8ae57ffbbd985d0da47249ad70d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa977b84df95dce8a403b2a656da430e3" id="r_aa977b84df95dce8a403b2a656da430e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#aa977b84df95dce8a403b2a656da430e3">_keepdims_parameter</a></td></tr>
<tr class="separator:aa977b84df95dce8a403b2a656da430e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6734aa5b8b7ff26bc251535928f9d28c" id="r_a6734aa5b8b7ff26bc251535928f9d28c"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a6734aa5b8b7ff26bc251535928f9d28c">_standard_note_addition</a></td></tr>
<tr class="separator:a6734aa5b8b7ff26bc251535928f9d28c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4d796e7e4d1ea818f24f2c45ac1a39e4" name="a4d796e7e4d1ea818f24f2c45ac1a39e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d796e7e4d1ea818f24f2c45ac1a39e4">&#9670;&#160;</a></span>_add_reduced_axes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._add_reduced_axes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reduced_axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keepdims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Add reduced axes back to all the arrays in the result object
if keepdims = True.
</pre> <div class="fragment"><div class="line"><span class="lineno">  241</span><span class="keyword">def </span>_add_reduced_axes(res, reduced_axes, keepdims):</div>
<div class="line"><span class="lineno">  242</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    Add reduced axes back to all the arrays in the result object</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    if keepdims = True.</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordflow">return</span> ([np.expand_dims(output, reduced_axes) <span class="keywordflow">for</span> output <span class="keywordflow">in</span> res]</div>
<div class="line"><span class="lineno">  247</span>            <span class="keywordflow">if</span> keepdims <span class="keywordflow">else</span> res)</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span><span class="comment"># Standard docstring / signature entries for `axis`, `nan_policy`, `keepdims`</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14c66eb16682b0206a41af37169b1562" name="a14c66eb16682b0206a41af37169b1562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14c66eb16682b0206a41af37169b1562">&#9670;&#160;</a></span>_axis_nan_policy_factory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._axis_nan_policy_factory </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tuple_to_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>default_axis</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_samples</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>paired</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result_to_tuple</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>too_small</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_outputs</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwd_samples</em> = <code>[]</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Factory for a wrapper that adds axis/nan_policy params to a function.

Parameters
----------
tuple_to_result : callable
    Callable that returns an object of the type returned by the function
    being wrapped (e.g. the namedtuple or dataclass returned by a
    statistical test) provided the separate components (e.g. statistic,
    pvalue).
default_axis : int, default: 0
    The default value of the axis argument. Standard is 0 except when
    backwards compatibility demands otherwise (e.g. `None`).
n_samples : int or callable, default: 1
    The number of data samples accepted by the function
    (e.g. `mannwhitneyu`), a callable that accepts a dictionary of
    parameters passed into the function and returns the number of data
    samples (e.g. `wilcoxon`), or `None` to indicate an arbitrary number
    of samples (e.g. `kruskal`).
paired : {False, True}
    Whether the function being wrapped treats the samples as paired (i.e.
    corresponding elements of each sample should be considered as different
    components of the same sample.)
result_to_tuple : callable, optional
    Function that unpacks the results of the function being wrapped into
    a tuple. This is essentially the inverse of `tuple_to_result`. Default
    is `None`, which is appropriate for statistical tests that return a
    statistic, pvalue tuple (rather than, e.g., a non-iterable datalass).
too_small : int, default: 0
    The largest unnacceptably small sample for the function being wrapped.
    For example, some functions require samples of size two or more or they
    raise an error. This argument prevents the error from being raised when
    input is not 1D and instead places a NaN in the corresponding element
    of the result.
n_outputs : int or callable, default: 2
    The number of outputs produced by the function given 1d sample(s). For
    example, hypothesis tests that return a namedtuple or result object
    with attributes ``statistic`` and ``pvalue`` use the default
    ``n_outputs=2``; summary statistics with scalar output use
    ``n_outputs=1``. Alternatively, may be a callable that accepts a
    dictionary of arguments passed into the wrapped function and returns
    the number of outputs corresponding with those arguments.
kwd_samples : sequence, default: []
    The names of keyword parameters that should be treated as samples. For
    example, `gmean` accepts as its first argument a sample `a` but
    also `weights` as a fourth, optional keyword argument. In this case, we
    use `n_samples=1` and kwd_samples=['weights'].
</pre> <div class="fragment"><div class="line"><span class="lineno">  312</span>                             n_outputs=2, kwd_samples=[]):</div>
<div class="line"><span class="lineno">  313</span>    <span class="stringliteral">&quot;&quot;&quot;Factory for a wrapper that adds axis/nan_policy params to a function.</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">    tuple_to_result : callable</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">        Callable that returns an object of the type returned by the function</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">        being wrapped (e.g. the namedtuple or dataclass returned by a</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        statistical test) provided the separate components (e.g. statistic,</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">        pvalue).</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">    default_axis : int, default: 0</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">        The default value of the axis argument. Standard is 0 except when</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        backwards compatibility demands otherwise (e.g. `None`).</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    n_samples : int or callable, default: 1</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">        The number of data samples accepted by the function</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        (e.g. `mannwhitneyu`), a callable that accepts a dictionary of</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">        parameters passed into the function and returns the number of data</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">        samples (e.g. `wilcoxon`), or `None` to indicate an arbitrary number</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">        of samples (e.g. `kruskal`).</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    paired : {False, True}</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">        Whether the function being wrapped treats the samples as paired (i.e.</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">        corresponding elements of each sample should be considered as different</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">        components of the same sample.)</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    result_to_tuple : callable, optional</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">        Function that unpacks the results of the function being wrapped into</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">        a tuple. This is essentially the inverse of `tuple_to_result`. Default</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">        is `None`, which is appropriate for statistical tests that return a</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">        statistic, pvalue tuple (rather than, e.g., a non-iterable datalass).</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    too_small : int, default: 0</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">        The largest unnacceptably small sample for the function being wrapped.</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">        For example, some functions require samples of size two or more or they</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">        raise an error. This argument prevents the error from being raised when</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">        input is not 1D and instead places a NaN in the corresponding element</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">        of the result.</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    n_outputs : int or callable, default: 2</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">        The number of outputs produced by the function given 1d sample(s). For</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">        example, hypothesis tests that return a namedtuple or result object</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">        with attributes ``statistic`` and ``pvalue`` use the default</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">        ``n_outputs=2``; summary statistics with scalar output use</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">        ``n_outputs=1``. Alternatively, may be a callable that accepts a</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">        dictionary of arguments passed into the wrapped function and returns</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">        the number of outputs corresponding with those arguments.</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">    kwd_samples : sequence, default: []</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">        The names of keyword parameters that should be treated as samples. For</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">        example, `gmean` accepts as its first argument a sample `a` but</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">        also `weights` as a fourth, optional keyword argument. In this case, we</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">        use `n_samples=1` and kwd_samples=[&#39;weights&#39;].</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">if</span> result_to_tuple <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  362</span>        <span class="keyword">def </span>result_to_tuple(res):</div>
<div class="line"><span class="lineno">  363</span>            <span class="keywordflow">return</span> res</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    <span class="keyword">def </span>is_too_small(samples):</div>
<div class="line"><span class="lineno">  366</span>        <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples:</div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">if</span> len(sample) &lt;= too_small:</div>
<div class="line"><span class="lineno">  368</span>                <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    <span class="keyword">def </span>axis_nan_policy_decorator(hypotest_fun_in):</div>
<div class="line"><span class="lineno">  372</span>        <span class="preprocessor">@wraps(hypotest_fun_in)</span></div>
<div class="line"><span class="lineno">  373</span>        <span class="keyword">def </span>axis_nan_policy_wrapper(*args, _no_deco=False, **kwds):</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>            <span class="keywordflow">if</span> _no_deco:  <span class="comment"># for testing, decorator does nothing</span></div>
<div class="line"><span class="lineno">  376</span>                <span class="keywordflow">return</span> hypotest_fun_in(*args, **kwds)</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>            <span class="comment"># We need to be flexible about whether position or keyword</span></div>
<div class="line"><span class="lineno">  379</span>            <span class="comment"># arguments are used, but we need to make sure users don&#39;t pass</span></div>
<div class="line"><span class="lineno">  380</span>            <span class="comment"># both for the same parameter. To complicate matters, some</span></div>
<div class="line"><span class="lineno">  381</span>            <span class="comment"># functions accept samples with *args, and some functions already</span></div>
<div class="line"><span class="lineno">  382</span>            <span class="comment"># accept `axis` and `nan_policy` as positional arguments.</span></div>
<div class="line"><span class="lineno">  383</span>            <span class="comment"># The strategy is to make sure that there is no duplication</span></div>
<div class="line"><span class="lineno">  384</span>            <span class="comment"># between `args` and `kwds`, combine the two into `kwds`, then</span></div>
<div class="line"><span class="lineno">  385</span>            <span class="comment"># the samples, `nan_policy`, and `axis` from `kwds`, as they are</span></div>
<div class="line"><span class="lineno">  386</span>            <span class="comment"># dealt with separately.</span></div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>            <span class="comment"># Check for intersection between positional and keyword args</span></div>
<div class="line"><span class="lineno">  389</span>            params = list(inspect.signature(hypotest_fun_in).parameters)</div>
<div class="line"><span class="lineno">  390</span>            <span class="keywordflow">if</span> n_samples <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  391</span>                <span class="comment"># Give unique names to each positional sample argument</span></div>
<div class="line"><span class="lineno">  392</span>                <span class="comment"># Note that *args can&#39;t be provided as a keyword argument</span></div>
<div class="line"><span class="lineno">  393</span>                params = [f<span class="stringliteral">&quot;arg{i}&quot;</span> <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(args))] + params[1:]</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>            d_args = dict(zip(params, args))</div>
<div class="line"><span class="lineno">  396</span>            intersection = set(d_args) &amp; set(kwds)</div>
<div class="line"><span class="lineno">  397</span>            <span class="keywordflow">if</span> intersection:</div>
<div class="line"><span class="lineno">  398</span>                message = (f<span class="stringliteral">&quot;{hypotest_fun_in.__name__}() got multiple values &quot;</span></div>
<div class="line"><span class="lineno">  399</span>                           f<span class="stringliteral">&quot;for argument &#39;{list(intersection)[0]}&#39;&quot;</span>)</div>
<div class="line"><span class="lineno">  400</span>                <span class="keywordflow">raise</span> TypeError(message)</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>            <span class="comment"># Consolidate other positional and keyword args into `kwds`</span></div>
<div class="line"><span class="lineno">  403</span>            kwds.update(d_args)</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>            <span class="comment"># rename avoids UnboundLocalError</span></div>
<div class="line"><span class="lineno">  406</span>            <span class="keywordflow">if</span> callable(n_samples):</div>
<div class="line"><span class="lineno">  407</span>                <span class="comment"># Future refactoring idea: no need for callable n_samples.</span></div>
<div class="line"><span class="lineno">  408</span>                <span class="comment"># Just replace `n_samples` and `kwd_samples` with a single</span></div>
<div class="line"><span class="lineno">  409</span>                <span class="comment"># list of the names of all samples, and treat all of them</span></div>
<div class="line"><span class="lineno">  410</span>                <span class="comment"># as `kwd_samples` are treated below.</span></div>
<div class="line"><span class="lineno">  411</span>                n_samp = n_samples(kwds)</div>
<div class="line"><span class="lineno">  412</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  413</span>                n_samp = n_samples <span class="keywordflow">or</span> len(args)</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>            <span class="comment"># get the number of outputs</span></div>
<div class="line"><span class="lineno">  416</span>            n_out = n_outputs  <span class="comment"># rename to avoid UnboundLocalError</span></div>
<div class="line"><span class="lineno">  417</span>            <span class="keywordflow">if</span> callable(n_out):</div>
<div class="line"><span class="lineno">  418</span>                n_out = n_out(kwds)</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>            <span class="comment"># If necessary, rearrange function signature: accept other samples</span></div>
<div class="line"><span class="lineno">  421</span>            <span class="comment"># as positional args right after the first n_samp args</span></div>
<div class="line"><span class="lineno">  422</span>            kwd_samp = [name <span class="keywordflow">for</span> name <span class="keywordflow">in</span> kwd_samples</div>
<div class="line"><span class="lineno">  423</span>                        <span class="keywordflow">if</span> kwds.get(name, <span class="keywordtype">None</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  424</span>            n_kwd_samp = len(kwd_samp)</div>
<div class="line"><span class="lineno">  425</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> kwd_samp:</div>
<div class="line"><span class="lineno">  426</span>                hypotest_fun_out = hypotest_fun_in</div>
<div class="line"><span class="lineno">  427</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  428</span>                <span class="keyword">def </span>hypotest_fun_out(*samples, **kwds):</div>
<div class="line"><span class="lineno">  429</span>                    new_kwds = dict(zip(kwd_samp, samples[n_samp:]))</div>
<div class="line"><span class="lineno">  430</span>                    kwds.update(new_kwds)</div>
<div class="line"><span class="lineno">  431</span>                    <span class="keywordflow">return</span> hypotest_fun_in(*samples[:n_samp], **kwds)</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>            <span class="comment"># Extract the things we need here</span></div>
<div class="line"><span class="lineno">  434</span>            samples = [np.atleast_1d(kwds.pop(param))</div>
<div class="line"><span class="lineno">  435</span>                       <span class="keywordflow">for</span> param <span class="keywordflow">in</span> (params[:n_samp] + kwd_samp)]</div>
<div class="line"><span class="lineno">  436</span>            vectorized = <span class="keyword">True</span> <span class="keywordflow">if</span> <span class="stringliteral">&#39;axis&#39;</span> <span class="keywordflow">in</span> params <span class="keywordflow">else</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  437</span>            axis = kwds.pop(<span class="stringliteral">&#39;axis&#39;</span>, default_axis)</div>
<div class="line"><span class="lineno">  438</span>            nan_policy = kwds.pop(<span class="stringliteral">&#39;nan_policy&#39;</span>, <span class="stringliteral">&#39;propagate&#39;</span>)</div>
<div class="line"><span class="lineno">  439</span>            keepdims = kwds.pop(<span class="stringliteral">&quot;keepdims&quot;</span>, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  440</span>            del args  <span class="comment"># avoid the possibility of passing both `args` and `kwds`</span></div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>            <span class="comment"># convert masked arrays to regular arrays with sentinel values</span></div>
<div class="line"><span class="lineno">  443</span>            samples, sentinel = _masked_arrays_2_sentinel_arrays(samples)</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>            <span class="comment"># standardize to always work along last axis</span></div>
<div class="line"><span class="lineno">  446</span>            reduced_axes = axis</div>
<div class="line"><span class="lineno">  447</span>            <span class="keywordflow">if</span> axis <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  448</span>                <span class="keywordflow">if</span> samples:</div>
<div class="line"><span class="lineno">  449</span>                    <span class="comment"># when axis=None, take the maximum of all dimensions since</span></div>
<div class="line"><span class="lineno">  450</span>                    <span class="comment"># all the dimensions are reduced.</span></div>
<div class="line"><span class="lineno">  451</span>                    n_dims = np.max([sample.ndim <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples])</div>
<div class="line"><span class="lineno">  452</span>                    reduced_axes = tuple(range(n_dims))</div>
<div class="line"><span class="lineno">  453</span>                samples = [sample.ravel() <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples]</div>
<div class="line"><span class="lineno">  454</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  455</span>                samples = _broadcast_arrays(samples, axis=axis)</div>
<div class="line"><span class="lineno">  456</span>                axis = np.atleast_1d(axis)</div>
<div class="line"><span class="lineno">  457</span>                n_axes = len(axis)</div>
<div class="line"><span class="lineno">  458</span>                <span class="comment"># move all axes in `axis` to the end to be raveled</span></div>
<div class="line"><span class="lineno">  459</span>                samples = [np.moveaxis(sample, axis, range(-len(axis), 0))</div>
<div class="line"><span class="lineno">  460</span>                           <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples]</div>
<div class="line"><span class="lineno">  461</span>                shapes = [sample.shape <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples]</div>
<div class="line"><span class="lineno">  462</span>                <span class="comment"># New shape is unchanged for all axes _not_ in `axis`</span></div>
<div class="line"><span class="lineno">  463</span>                <span class="comment"># At the end, we append the product of the shapes of the axes</span></div>
<div class="line"><span class="lineno">  464</span>                <span class="comment"># in `axis`. Appending -1 doesn&#39;t work for zero-size arrays!</span></div>
<div class="line"><span class="lineno">  465</span>                new_shapes = [shape[:-n_axes] + (np.prod(shape[-n_axes:]),)</div>
<div class="line"><span class="lineno">  466</span>                              <span class="keywordflow">for</span> shape <span class="keywordflow">in</span> shapes]</div>
<div class="line"><span class="lineno">  467</span>                samples = [sample.reshape(new_shape)</div>
<div class="line"><span class="lineno">  468</span>                           <span class="keywordflow">for</span> sample, new_shape <span class="keywordflow">in</span> zip(samples, new_shapes)]</div>
<div class="line"><span class="lineno">  469</span>            axis = -1  <span class="comment"># work over the last axis</span></div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>            <span class="comment"># if axis is not needed, just handle nan_policy and return</span></div>
<div class="line"><span class="lineno">  472</span>            ndims = np.array([sample.ndim <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples])</div>
<div class="line"><span class="lineno">  473</span>            <span class="keywordflow">if</span> np.all(ndims &lt;= 1):</div>
<div class="line"><span class="lineno">  474</span>                <span class="comment"># Addresses nan_policy == &quot;raise&quot;</span></div>
<div class="line"><span class="lineno">  475</span>                contains_nans = []</div>
<div class="line"><span class="lineno">  476</span>                <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples:</div>
<div class="line"><span class="lineno">  477</span>                    contains_nan, _ = (</div>
<div class="line"><span class="lineno">  478</span>                        <a class="code hl_function" href="namespacescipy_1_1stats_1_1__stats__py.html#a58e2338e05cdf4c8ce6c4a992fa0e557">scipy.stats._stats_py._contains_nan</a>(sample, nan_policy))</div>
<div class="line"><span class="lineno">  479</span>                    contains_nans.append(contains_nan)</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>                <span class="comment"># Addresses nan_policy == &quot;propagate&quot;</span></div>
<div class="line"><span class="lineno">  482</span>                <span class="comment"># Consider adding option to let function propagate nans, but</span></div>
<div class="line"><span class="lineno">  483</span>                <span class="comment"># currently the hypothesis tests this is applied to do not</span></div>
<div class="line"><span class="lineno">  484</span>                <span class="comment"># propagate nans in a sensible way</span></div>
<div class="line"><span class="lineno">  485</span>                <span class="keywordflow">if</span> any(contains_nans) <span class="keywordflow">and</span> nan_policy == <span class="stringliteral">&#39;propagate&#39;</span>:</div>
<div class="line"><span class="lineno">  486</span>                    res = np.full(n_out, np.nan)</div>
<div class="line"><span class="lineno">  487</span>                    res = _add_reduced_axes(res, reduced_axes, keepdims)</div>
<div class="line"><span class="lineno">  488</span>                    <span class="keywordflow">return</span> tuple_to_result(*res)</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>                <span class="comment"># Addresses nan_policy == &quot;omit&quot;</span></div>
<div class="line"><span class="lineno">  491</span>                <span class="keywordflow">if</span> any(contains_nans) <span class="keywordflow">and</span> nan_policy == <span class="stringliteral">&#39;omit&#39;</span>:</div>
<div class="line"><span class="lineno">  492</span>                    <span class="comment"># consider passing in contains_nans</span></div>
<div class="line"><span class="lineno">  493</span>                    samples = _remove_nans(samples, paired)</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>                <span class="comment"># ideally, this is what the behavior would be:</span></div>
<div class="line"><span class="lineno">  496</span>                <span class="comment"># if is_too_small(samples):</span></div>
<div class="line"><span class="lineno">  497</span>                <span class="comment">#     return tuple_to_result(np.nan, np.nan)</span></div>
<div class="line"><span class="lineno">  498</span>                <span class="comment"># but some existing functions raise exceptions, and changing</span></div>
<div class="line"><span class="lineno">  499</span>                <span class="comment"># behavior of those would break backward compatibility.</span></div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>                <span class="keywordflow">if</span> sentinel:</div>
<div class="line"><span class="lineno">  502</span>                    samples = _remove_sentinel(samples, paired, sentinel)</div>
<div class="line"><span class="lineno">  503</span>                res = hypotest_fun_out(*samples, **kwds)</div>
<div class="line"><span class="lineno">  504</span>                res = result_to_tuple(res)</div>
<div class="line"><span class="lineno">  505</span>                res = _add_reduced_axes(res, reduced_axes, keepdims)</div>
<div class="line"><span class="lineno">  506</span>                <span class="keywordflow">return</span> tuple_to_result(*res)</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>            <span class="comment"># check for empty input</span></div>
<div class="line"><span class="lineno">  509</span>            <span class="comment"># ideally, move this to the top, but some existing functions raise</span></div>
<div class="line"><span class="lineno">  510</span>            <span class="comment"># exceptions for empty input, so overriding it would break</span></div>
<div class="line"><span class="lineno">  511</span>            <span class="comment"># backward compatibility.</span></div>
<div class="line"><span class="lineno">  512</span>            empty_output = _check_empty_inputs(samples, axis)</div>
<div class="line"><span class="lineno">  513</span>            <span class="keywordflow">if</span> empty_output <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  514</span>                res = [empty_output.copy() <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n_out)]</div>
<div class="line"><span class="lineno">  515</span>                res = _add_reduced_axes(res, reduced_axes, keepdims)</div>
<div class="line"><span class="lineno">  516</span>                <span class="keywordflow">return</span> tuple_to_result(*res)</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>            <span class="comment"># otherwise, concatenate all samples along axis, remembering where</span></div>
<div class="line"><span class="lineno">  519</span>            <span class="comment"># each separate sample begins</span></div>
<div class="line"><span class="lineno">  520</span>            lengths = np.array([sample.shape[axis] <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples])</div>
<div class="line"><span class="lineno">  521</span>            split_indices = np.cumsum(lengths)</div>
<div class="line"><span class="lineno">  522</span>            x = _broadcast_concatenate(samples, axis)</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>            <span class="comment"># Addresses nan_policy == &quot;raise&quot;</span></div>
<div class="line"><span class="lineno">  525</span>            contains_nan, _ = (</div>
<div class="line"><span class="lineno">  526</span>                <a class="code hl_function" href="namespacescipy_1_1stats_1_1__stats__py.html#a58e2338e05cdf4c8ce6c4a992fa0e557">scipy.stats._stats_py._contains_nan</a>(x, nan_policy))</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>            <span class="keywordflow">if</span> vectorized <span class="keywordflow">and</span> <span class="keywordflow">not</span> contains_nan <span class="keywordflow">and</span> <span class="keywordflow">not</span> sentinel:</div>
<div class="line"><span class="lineno">  529</span>                res = hypotest_fun_out(*samples, axis=axis, **kwds)</div>
<div class="line"><span class="lineno">  530</span>                res = result_to_tuple(res)</div>
<div class="line"><span class="lineno">  531</span>                res = _add_reduced_axes(res, reduced_axes, keepdims)</div>
<div class="line"><span class="lineno">  532</span>                <span class="keywordflow">return</span> tuple_to_result(*res)</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>            <span class="comment"># Addresses nan_policy == &quot;omit&quot;</span></div>
<div class="line"><span class="lineno">  535</span>            <span class="keywordflow">if</span> contains_nan <span class="keywordflow">and</span> nan_policy == <span class="stringliteral">&#39;omit&#39;</span>:</div>
<div class="line"><span class="lineno">  536</span>                <span class="keyword">def </span>hypotest_fun(x):</div>
<div class="line"><span class="lineno">  537</span>                    samples = np.split(x, split_indices)[:n_samp+n_kwd_samp]</div>
<div class="line"><span class="lineno">  538</span>                    samples = _remove_nans(samples, paired)</div>
<div class="line"><span class="lineno">  539</span>                    <span class="keywordflow">if</span> sentinel:</div>
<div class="line"><span class="lineno">  540</span>                        samples = _remove_sentinel(samples, paired, sentinel)</div>
<div class="line"><span class="lineno">  541</span>                    <span class="keywordflow">if</span> is_too_small(samples):</div>
<div class="line"><span class="lineno">  542</span>                        <span class="keywordflow">return</span> np.full(n_out, np.nan)</div>
<div class="line"><span class="lineno">  543</span>                    <span class="keywordflow">return</span> result_to_tuple(hypotest_fun_out(*samples, **kwds))</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>            <span class="comment"># Addresses nan_policy == &quot;propagate&quot;</span></div>
<div class="line"><span class="lineno">  546</span>            <span class="keywordflow">elif</span> contains_nan <span class="keywordflow">and</span> nan_policy == <span class="stringliteral">&#39;propagate&#39;</span>:</div>
<div class="line"><span class="lineno">  547</span>                <span class="keyword">def </span>hypotest_fun(x):</div>
<div class="line"><span class="lineno">  548</span>                    <span class="keywordflow">if</span> np.isnan(x).any():</div>
<div class="line"><span class="lineno">  549</span>                        <span class="keywordflow">return</span> np.full(n_out, np.nan)</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>                    samples = np.split(x, split_indices)[:n_samp+n_kwd_samp]</div>
<div class="line"><span class="lineno">  552</span>                    <span class="keywordflow">if</span> sentinel:</div>
<div class="line"><span class="lineno">  553</span>                        samples = _remove_sentinel(samples, paired, sentinel)</div>
<div class="line"><span class="lineno">  554</span>                    <span class="keywordflow">if</span> is_too_small(samples):</div>
<div class="line"><span class="lineno">  555</span>                        <span class="keywordflow">return</span> np.full(n_out, np.nan)</div>
<div class="line"><span class="lineno">  556</span>                    <span class="keywordflow">return</span> result_to_tuple(hypotest_fun_out(*samples, **kwds))</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  559</span>                <span class="keyword">def </span>hypotest_fun(x):</div>
<div class="line"><span class="lineno">  560</span>                    samples = np.split(x, split_indices)[:n_samp+n_kwd_samp]</div>
<div class="line"><span class="lineno">  561</span>                    <span class="keywordflow">if</span> sentinel:</div>
<div class="line"><span class="lineno">  562</span>                        samples = _remove_sentinel(samples, paired, sentinel)</div>
<div class="line"><span class="lineno">  563</span>                    <span class="keywordflow">if</span> is_too_small(samples):</div>
<div class="line"><span class="lineno">  564</span>                        <span class="keywordflow">return</span> np.full(n_out, np.nan)</div>
<div class="line"><span class="lineno">  565</span>                    <span class="keywordflow">return</span> result_to_tuple(hypotest_fun_out(*samples, **kwds))</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>            x = np.moveaxis(x, axis, 0)</div>
<div class="line"><span class="lineno">  568</span>            res = np.apply_along_axis(hypotest_fun, axis=0, arr=x)</div>
<div class="line"><span class="lineno">  569</span>            res = _add_reduced_axes(res, reduced_axes, keepdims)</div>
<div class="line"><span class="lineno">  570</span>            <span class="keywordflow">return</span> tuple_to_result(*res)</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>        _axis_parameter_doc, _axis_parameter = _get_axis_params(default_axis)</div>
<div class="line"><span class="lineno">  573</span>        doc = FunctionDoc(axis_nan_policy_wrapper)</div>
<div class="line"><span class="lineno">  574</span>        parameter_names = [param.name <span class="keywordflow">for</span> param <span class="keywordflow">in</span> doc[<span class="stringliteral">&#39;Parameters&#39;</span>]]</div>
<div class="line"><span class="lineno">  575</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;axis&#39;</span> <span class="keywordflow">in</span> parameter_names:</div>
<div class="line"><span class="lineno">  576</span>            doc[<span class="stringliteral">&#39;Parameters&#39;</span>][parameter_names.index(<span class="stringliteral">&#39;axis&#39;</span>)] = (</div>
<div class="line"><span class="lineno">  577</span>                _axis_parameter_doc)</div>
<div class="line"><span class="lineno">  578</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  579</span>            doc[<span class="stringliteral">&#39;Parameters&#39;</span>].append(_axis_parameter_doc)</div>
<div class="line"><span class="lineno">  580</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;nan_policy&#39;</span> <span class="keywordflow">in</span> parameter_names:</div>
<div class="line"><span class="lineno">  581</span>            doc[<span class="stringliteral">&#39;Parameters&#39;</span>][parameter_names.index(<span class="stringliteral">&#39;nan_policy&#39;</span>)] = (</div>
<div class="line"><span class="lineno">  582</span>                _nan_policy_parameter_doc)</div>
<div class="line"><span class="lineno">  583</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  584</span>            doc[<span class="stringliteral">&#39;Parameters&#39;</span>].append(_nan_policy_parameter_doc)</div>
<div class="line"><span class="lineno">  585</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;keepdims&#39;</span> <span class="keywordflow">in</span> parameter_names:</div>
<div class="line"><span class="lineno">  586</span>            doc[<span class="stringliteral">&#39;Parameters&#39;</span>][parameter_names.index(<span class="stringliteral">&#39;keepdims&#39;</span>)] = (</div>
<div class="line"><span class="lineno">  587</span>                _keepdims_parameter_doc)</div>
<div class="line"><span class="lineno">  588</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  589</span>            doc[<span class="stringliteral">&#39;Parameters&#39;</span>].append(_keepdims_parameter_doc)</div>
<div class="line"><span class="lineno">  590</span>        doc[<span class="stringliteral">&#39;Notes&#39;</span>] += _standard_note_addition</div>
<div class="line"><span class="lineno">  591</span>        doc = str(doc).split(<span class="stringliteral">&quot;\n&quot;</span>, 1)[1]  <span class="comment"># remove signature</span></div>
<div class="line"><span class="lineno">  592</span>        axis_nan_policy_wrapper.__doc__ = str(doc)</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>        sig = inspect.signature(axis_nan_policy_wrapper)</div>
<div class="line"><span class="lineno">  595</span>        parameters = sig.parameters</div>
<div class="line"><span class="lineno">  596</span>        parameter_list = list(parameters.values())</div>
<div class="line"><span class="lineno">  597</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;axis&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> parameters:</div>
<div class="line"><span class="lineno">  598</span>            parameter_list.append(_axis_parameter)</div>
<div class="line"><span class="lineno">  599</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;nan_policy&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> parameters:</div>
<div class="line"><span class="lineno">  600</span>            parameter_list.append(_nan_policy_parameter)</div>
<div class="line"><span class="lineno">  601</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;keepdims&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> parameters:</div>
<div class="line"><span class="lineno">  602</span>            parameter_list.append(_keepdims_parameter)</div>
<div class="line"><span class="lineno">  603</span>        sig = sig.replace(parameters=parameter_list)</div>
<div class="line"><span class="lineno">  604</span>        axis_nan_policy_wrapper.__signature__ = sig</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>        <span class="keywordflow">return</span> axis_nan_policy_wrapper</div>
<div class="line"><span class="lineno">  607</span>    <span class="keywordflow">return</span> axis_nan_policy_decorator</div>
<div class="ttc" id="anamespacescipy_1_1stats_1_1__stats__py_html_a58e2338e05cdf4c8ce6c4a992fa0e557"><div class="ttname"><a href="namespacescipy_1_1stats_1_1__stats__py.html#a58e2338e05cdf4c8ce6c4a992fa0e557">scipy.stats._stats_py._contains_nan</a></div><div class="ttdeci">_contains_nan(a, nan_policy='propagate', use_summation=True)</div><div class="ttdef"><b>Definition</b> _stats_py.py:86</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0a62b35345335d55cbbe337fb320970" name="af0a62b35345335d55cbbe337fb320970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0a62b35345335d55cbbe337fb320970">&#9670;&#160;</a></span>_broadcast_array_shapes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._broadcast_array_shapes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arrays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Broadcast shapes of arrays, ignoring incompatibility of specified axes
</pre> <div class="fragment"><div class="line"><span class="lineno">   26</span><span class="keyword">def </span>_broadcast_array_shapes(arrays, axis=None):</div>
<div class="line"><span class="lineno">   27</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">    Broadcast shapes of arrays, ignoring incompatibility of specified axes</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   30</span>    shapes = [np.asarray(arr).shape <span class="keywordflow">for</span> arr <span class="keywordflow">in</span> arrays]</div>
<div class="line"><span class="lineno">   31</span>    <span class="keywordflow">return</span> _broadcast_shapes(shapes, axis)</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ade8fb852e65ea5c5d8b41044359a677f" name="ade8fb852e65ea5c5d8b41044359a677f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade8fb852e65ea5c5d8b41044359a677f">&#9670;&#160;</a></span>_broadcast_array_shapes_remove_axis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._broadcast_array_shapes_remove_axis </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arrays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Broadcast shapes of arrays, dropping specified axes

Given a sequence of arrays `arrays` and an integer or tuple `axis`, find
the shape of the broadcast result after consuming/dropping `axis`.
In other words, return output shape of a typical hypothesis test on
`arrays` vectorized along `axis`.

Examples
--------
&gt;&gt;&gt; a = np.zeros((5, 2, 1))
&gt;&gt;&gt; b = np.zeros((9, 3))
&gt;&gt;&gt; _broadcast_array_shapes((a, b), 1)
(5, 3)
</pre> <div class="fragment"><div class="line"><span class="lineno">   94</span><span class="keyword">def </span>_broadcast_array_shapes_remove_axis(arrays, axis=None):</div>
<div class="line"><span class="lineno">   95</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    Broadcast shapes of arrays, dropping specified axes</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    Given a sequence of arrays `arrays` and an integer or tuple `axis`, find</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    the shape of the broadcast result after consuming/dropping `axis`.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">    In other words, return output shape of a typical hypothesis test on</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    `arrays` vectorized along `axis`.</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((5, 2, 1))</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    &gt;&gt;&gt; b = np.zeros((9, 3))</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    &gt;&gt;&gt; _broadcast_array_shapes((a, b), 1)</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">    (5, 3)</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  110</span>    <span class="comment"># Note that here, `axis=None` means do not consume/drop any axes - _not_</span></div>
<div class="line"><span class="lineno">  111</span>    <span class="comment"># ravel arrays before broadcasting.</span></div>
<div class="line"><span class="lineno">  112</span>    shapes = [arr.shape <span class="keywordflow">for</span> arr <span class="keywordflow">in</span> arrays]</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">return</span> _broadcast_shapes_remove_axis(shapes, axis)</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a89e494de0b496475abc5a61879248a16" name="a89e494de0b496475abc5a61879248a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89e494de0b496475abc5a61879248a16">&#9670;&#160;</a></span>_broadcast_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._broadcast_arrays </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arrays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Broadcast shapes of arrays, ignoring incompatibility of specified axes
</pre> <div class="fragment"><div class="line"><span class="lineno">   15</span><span class="keyword">def </span>_broadcast_arrays(arrays, axis=None):</div>
<div class="line"><span class="lineno">   16</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   17</span><span class="stringliteral">    Broadcast shapes of arrays, ignoring incompatibility of specified axes</span></div>
<div class="line"><span class="lineno">   18</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   19</span>    new_shapes = _broadcast_array_shapes(arrays, axis=axis)</div>
<div class="line"><span class="lineno">   20</span>    <span class="keywordflow">if</span> axis <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   21</span>        new_shapes = [new_shapes]*len(arrays)</div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">return</span> [np.broadcast_to(array, new_shape)</div>
<div class="line"><span class="lineno">   23</span>            <span class="keywordflow">for</span> array, new_shape <span class="keywordflow">in</span> zip(arrays, new_shapes)]</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d99a33288ac385cc9eb24cd6bf565c3" name="a4d99a33288ac385cc9eb24cd6bf565c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d99a33288ac385cc9eb24cd6bf565c3">&#9670;&#160;</a></span>_broadcast_concatenate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._broadcast_concatenate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arrays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Concatenate arrays along an axis with broadcasting.</pre> <div class="fragment"><div class="line"><span class="lineno">  130</span><span class="keyword">def </span>_broadcast_concatenate(arrays, axis):</div>
<div class="line"><span class="lineno">  131</span>    <span class="stringliteral">&quot;&quot;&quot;Concatenate arrays along an axis with broadcasting.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  132</span>    arrays = _broadcast_arrays(arrays, axis)</div>
<div class="line"><span class="lineno">  133</span>    res = np.concatenate(arrays, axis=axis)</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">return</span> res</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span><span class="comment"># TODO: add support for `axis` tuples</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa6969676e34ffa788718ba26e0f1b60" name="aaa6969676e34ffa788718ba26e0f1b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa6969676e34ffa788718ba26e0f1b60">&#9670;&#160;</a></span>_broadcast_shapes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._broadcast_shapes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shapes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Broadcast shapes, ignoring incompatibility of specified axes
</pre> <div class="fragment"><div class="line"><span class="lineno">   34</span><span class="keyword">def </span>_broadcast_shapes(shapes, axis=None):</div>
<div class="line"><span class="lineno">   35</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    Broadcast shapes, ignoring incompatibility of specified axes</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> shapes:</div>
<div class="line"><span class="lineno">   39</span>        <span class="keywordflow">return</span> shapes</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    <span class="comment"># input validation</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">if</span> axis <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   43</span>        axis = np.atleast_1d(axis)</div>
<div class="line"><span class="lineno">   44</span>        axis_int = axis.astype(int)</div>
<div class="line"><span class="lineno">   45</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.array_equal(axis_int, axis):</div>
<div class="line"><span class="lineno">   46</span>            <span class="keywordflow">raise</span> np.AxisError(<span class="stringliteral">&#39;`axis` must be an integer, a &#39;</span></div>
<div class="line"><span class="lineno">   47</span>                               <span class="stringliteral">&#39;tuple of integers, or `None`.&#39;</span>)</div>
<div class="line"><span class="lineno">   48</span>        axis = axis_int</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span>    <span class="comment"># First, ensure all shapes have same number of dimensions by prepending 1s.</span></div>
<div class="line"><span class="lineno">   51</span>    n_dims = max([len(shape) <span class="keywordflow">for</span> shape <span class="keywordflow">in</span> shapes])</div>
<div class="line"><span class="lineno">   52</span>    new_shapes = np.ones((len(shapes), n_dims), dtype=int)</div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordflow">for</span> row, shape <span class="keywordflow">in</span> zip(new_shapes, shapes):</div>
<div class="line"><span class="lineno">   54</span>        row[len(row)-len(shape):] = shape  <span class="comment"># can&#39;t use negative indices (-0:)</span></div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="comment"># Remove the shape elements of the axes to be ignored, but remember them.</span></div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">if</span> axis <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   58</span>        axis[axis &lt; 0] = n_dims + axis[axis &lt; 0]</div>
<div class="line"><span class="lineno">   59</span>        axis = np.sort(axis)</div>
<div class="line"><span class="lineno">   60</span>        <span class="keywordflow">if</span> axis[-1] &gt;= n_dims <span class="keywordflow">or</span> axis[0] &lt; 0:</div>
<div class="line"><span class="lineno">   61</span>            message = (f<span class="stringliteral">&quot;`axis` is out of bounds &quot;</span></div>
<div class="line"><span class="lineno">   62</span>                       f<span class="stringliteral">&quot;for array of dimension {n_dims}&quot;</span>)</div>
<div class="line"><span class="lineno">   63</span>            <span class="keywordflow">raise</span> np.AxisError(message)</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>        <span class="keywordflow">if</span> len(np.unique(axis)) != len(axis):</div>
<div class="line"><span class="lineno">   66</span>            <span class="keywordflow">raise</span> np.AxisError(<span class="stringliteral">&quot;`axis` must contain only distinct elements&quot;</span>)</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>        removed_shapes = new_shapes[:, axis]</div>
<div class="line"><span class="lineno">   69</span>        new_shapes = np.delete(new_shapes, axis, axis=1)</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <span class="comment"># If arrays are broadcastable, shape elements that are 1 may be replaced</span></div>
<div class="line"><span class="lineno">   72</span>    <span class="comment"># with a corresponding non-1 shape element. Assuming arrays are</span></div>
<div class="line"><span class="lineno">   73</span>    <span class="comment"># broadcastable, that final shape element can be found with:</span></div>
<div class="line"><span class="lineno">   74</span>    new_shape = np.max(new_shapes, axis=0)</div>
<div class="line"><span class="lineno">   75</span>    <span class="comment"># except in case of an empty array:</span></div>
<div class="line"><span class="lineno">   76</span>    new_shape *= new_shapes.all(axis=0)</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    <span class="comment"># Among all arrays, there can only be one unique non-1 shape element.</span></div>
<div class="line"><span class="lineno">   79</span>    <span class="comment"># Therefore, if any non-1 shape element does not match what we found</span></div>
<div class="line"><span class="lineno">   80</span>    <span class="comment"># above, the arrays must not be broadcastable after all.</span></div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">if</span> np.any(~((new_shapes == 1) | (new_shapes == new_shape))):</div>
<div class="line"><span class="lineno">   82</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Array shapes are incompatible for broadcasting.&quot;</span>)</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">if</span> axis <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   85</span>        <span class="comment"># Add back the shape elements that were ignored</span></div>
<div class="line"><span class="lineno">   86</span>        new_axis = axis - np.arange(len(axis))</div>
<div class="line"><span class="lineno">   87</span>        new_shapes = [tuple(np.insert(new_shape, new_axis, removed_shape))</div>
<div class="line"><span class="lineno">   88</span>                      <span class="keywordflow">for</span> removed_shape <span class="keywordflow">in</span> removed_shapes]</div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">return</span> new_shapes</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">return</span> tuple(new_shape)</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab89c66ac1e9485e26caf6681f7e23152" name="ab89c66ac1e9485e26caf6681f7e23152"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab89c66ac1e9485e26caf6681f7e23152">&#9670;&#160;</a></span>_broadcast_shapes_remove_axis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._broadcast_shapes_remove_axis </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shapes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Broadcast shapes, dropping specified axes

Same as _broadcast_array_shapes, but given a sequence
of array shapes `shapes` instead of the arrays themselves.
</pre> <div class="fragment"><div class="line"><span class="lineno">  116</span><span class="keyword">def </span>_broadcast_shapes_remove_axis(shapes, axis=None):</div>
<div class="line"><span class="lineno">  117</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">    Broadcast shapes, dropping specified axes</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    Same as _broadcast_array_shapes, but given a sequence</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    of array shapes `shapes` instead of the arrays themselves.</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  123</span>    shapes = _broadcast_shapes(shapes, axis)</div>
<div class="line"><span class="lineno">  124</span>    shape = shapes[0]</div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">if</span> axis <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  126</span>        shape = np.delete(shape, axis)</div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">return</span> tuple(shape)</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a00b11a58d2389a452bd7b68c42b1d083" name="a00b11a58d2389a452bd7b68c42b1d083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00b11a58d2389a452bd7b68c42b1d083">&#9670;&#160;</a></span>_check_empty_inputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._check_empty_inputs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Check for empty sample; return appropriate output for a vectorized hypotest
</pre> <div class="fragment"><div class="line"><span class="lineno">  227</span><span class="keyword">def </span>_check_empty_inputs(samples, axis):</div>
<div class="line"><span class="lineno">  228</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">    Check for empty sample; return appropriate output for a vectorized hypotest</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># if none of the samples are empty, we need to perform the test</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> any((sample.size == 0 <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples)):</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  234</span>    <span class="comment"># otherwise, the statistic and p-value will be either empty arrays or</span></div>
<div class="line"><span class="lineno">  235</span>    <span class="comment"># arrays with NaNs. Produce the appropriate array and return it.</span></div>
<div class="line"><span class="lineno">  236</span>    output_shape = _broadcast_array_shapes_remove_axis(samples, axis)</div>
<div class="line"><span class="lineno">  237</span>    output = np.ones(output_shape) * np.nan</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">return</span> output</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a08d64cb207f1654bbedec5141fe52362" name="a08d64cb207f1654bbedec5141fe52362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08d64cb207f1654bbedec5141fe52362">&#9670;&#160;</a></span>_get_axis_params()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._get_axis_params </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>default_axis</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>_name</em> = <code><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a856ab5bd3b45710bd8dabb2dacead7cb">_name</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>_desc</em> = <code><a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a886bfe8d10cff88e7470159b1bc2ff29">_desc</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  260</span><span class="keyword">def </span>_get_axis_params(default_axis=0, _name=_name, _desc=_desc):  <span class="comment"># bind NOW</span></div>
<div class="line"><span class="lineno">  261</span>    _type = f<span class="stringliteral">&quot;int or None, default: {default_axis}&quot;</span></div>
<div class="line"><span class="lineno">  262</span>    _axis_parameter_doc = Parameter(_name, _type, _desc)</div>
<div class="line"><span class="lineno">  263</span>    _axis_parameter = inspect.Parameter(_name,</div>
<div class="line"><span class="lineno">  264</span>                                        inspect.Parameter.KEYWORD_ONLY,</div>
<div class="line"><span class="lineno">  265</span>                                        default=default_axis)</div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">return</span> _axis_parameter_doc, _axis_parameter</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b509cebb650b60e754fc5dd1ddb7b4a" name="a7b509cebb650b60e754fc5dd1ddb7b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b509cebb650b60e754fc5dd1ddb7b4a">&#9670;&#160;</a></span>_masked_arrays_2_sentinel_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._masked_arrays_2_sentinel_arrays </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  171</span><span class="keyword">def </span>_masked_arrays_2_sentinel_arrays(samples):</div>
<div class="line"><span class="lineno">  172</span>    <span class="comment"># masked arrays in `samples` are converted to regular arrays, and values</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="comment"># corresponding with masked elements are replaced with a sentinel value</span></div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    <span class="comment"># return without modifying arrays if none have a mask</span></div>
<div class="line"><span class="lineno">  176</span>    has_mask = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples:</div>
<div class="line"><span class="lineno">  178</span>        mask = getattr(sample, <span class="stringliteral">&#39;mask&#39;</span>, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  179</span>        has_mask = has_mask <span class="keywordflow">or</span> np.any(mask)</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> has_mask:</div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">return</span> samples, <span class="keywordtype">None</span>  <span class="comment"># None means there is no sentinel value</span></div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="comment"># Choose a sentinel value. We can&#39;t use `np.nan`, because sentinel (masked)</span></div>
<div class="line"><span class="lineno">  184</span>    <span class="comment"># values are always omitted, but there are different nan policies.</span></div>
<div class="line"><span class="lineno">  185</span>    dtype = np.result_type(*samples)</div>
<div class="line"><span class="lineno">  186</span>    dtype = dtype <span class="keywordflow">if</span> np.issubdtype(dtype, np.number) <span class="keywordflow">else</span> np.float64</div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(samples)):</div>
<div class="line"><span class="lineno">  188</span>        <span class="comment"># Things get more complicated if the arrays are of different types.</span></div>
<div class="line"><span class="lineno">  189</span>        <span class="comment"># We could have different sentinel values for each array, but</span></div>
<div class="line"><span class="lineno">  190</span>        <span class="comment"># the purpose of this code is convenience, not efficiency.</span></div>
<div class="line"><span class="lineno">  191</span>        samples[i] = samples[i].astype(dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    inexact = np.issubdtype(dtype, np.inexact)</div>
<div class="line"><span class="lineno">  194</span>    info = np.finfo <span class="keywordflow">if</span> inexact <span class="keywordflow">else</span> np.iinfo</div>
<div class="line"><span class="lineno">  195</span>    max_possible, min_possible = info(dtype).max, info(dtype).min</div>
<div class="line"><span class="lineno">  196</span>    nextafter = np.nextafter <span class="keywordflow">if</span> inexact <span class="keywordflow">else</span> (<span class="keyword">lambda</span> x, _: x - 1)</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    sentinel = max_possible</div>
<div class="line"><span class="lineno">  199</span>    <span class="comment"># For simplicity, min_possible/np.infs are not candidate sentinel values</span></div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">while</span> sentinel &gt; min_possible:</div>
<div class="line"><span class="lineno">  201</span>        <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples:</div>
<div class="line"><span class="lineno">  202</span>            <span class="keywordflow">if</span> np.any(sample == sentinel):  <span class="comment"># choose a new sentinel value</span></div>
<div class="line"><span class="lineno">  203</span>                sentinel = nextafter(sentinel, -np.inf)</div>
<div class="line"><span class="lineno">  204</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordflow">else</span>:  <span class="comment"># when sentinel value is OK, break the while loop</span></div>
<div class="line"><span class="lineno">  206</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  208</span>        message = (<span class="stringliteral">&quot;This function replaces masked elements with sentinel &quot;</span></div>
<div class="line"><span class="lineno">  209</span>                   <span class="stringliteral">&quot;values, but the data contains all distinct values of this &quot;</span></div>
<div class="line"><span class="lineno">  210</span>                   <span class="stringliteral">&quot;data type. Consider promoting the dtype to `np.float64`.&quot;</span>)</div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">raise</span> ValueError(message)</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="comment"># replace masked elements with sentinel value</span></div>
<div class="line"><span class="lineno">  214</span>    out_samples = []</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples:</div>
<div class="line"><span class="lineno">  216</span>        mask = getattr(sample, <span class="stringliteral">&#39;mask&#39;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordflow">if</span> mask <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:  <span class="comment"># turn all masked arrays into sentinel arrays</span></div>
<div class="line"><span class="lineno">  218</span>            mask = np.broadcast_to(mask, sample.shape)</div>
<div class="line"><span class="lineno">  219</span>            sample = sample.data.copy() <span class="keywordflow">if</span> np.any(mask) <span class="keywordflow">else</span> sample.data</div>
<div class="line"><span class="lineno">  220</span>            sample = np.asarray(sample)  <span class="comment"># `sample.data` could be a memoryview?</span></div>
<div class="line"><span class="lineno">  221</span>            sample[mask] = sentinel</div>
<div class="line"><span class="lineno">  222</span>        out_samples.append(sample)</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">return</span> out_samples, sentinel</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af02c21ccaff61a6ec1501dd8507cccdd" name="af02c21ccaff61a6ec1501dd8507cccdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af02c21ccaff61a6ec1501dd8507cccdd">&#9670;&#160;</a></span>_remove_nans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._remove_nans </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>paired</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  138</span><span class="keyword">def </span>_remove_nans(samples, paired):</div>
<div class="line"><span class="lineno">  139</span>    <span class="stringliteral">&quot;Remove nans from paired or unpaired 1D samples&quot;</span></div>
<div class="line"><span class="lineno">  140</span>    <span class="comment"># potential optimization: don&#39;t copy arrays that don&#39;t contain nans</span></div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> paired:</div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">return</span> [sample[~np.isnan(sample)] <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples]</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <span class="comment"># for paired samples, we need to remove the whole pair when any part</span></div>
<div class="line"><span class="lineno">  145</span>    <span class="comment"># has a nan</span></div>
<div class="line"><span class="lineno">  146</span>    nans = np.isnan(samples[0])</div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples[1:]:</div>
<div class="line"><span class="lineno">  148</span>        nans = nans | np.isnan(sample)</div>
<div class="line"><span class="lineno">  149</span>    not_nans = ~nans</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">return</span> [sample[not_nans] <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples]</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae29c046c8264f4ebfabe4b8c90313120" name="ae29c046c8264f4ebfabe4b8c90313120"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae29c046c8264f4ebfabe4b8c90313120">&#9670;&#160;</a></span>_remove_sentinel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._remove_sentinel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>paired</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sentinel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  153</span><span class="keyword">def </span>_remove_sentinel(samples, paired, sentinel):</div>
<div class="line"><span class="lineno">  154</span>    <span class="stringliteral">&quot;Remove sentinel values from paired or unpaired 1D samples&quot;</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="comment"># could consolidate with `_remove_nans`, but it&#39;s not quite as simple as</span></div>
<div class="line"><span class="lineno">  156</span>    <span class="comment"># passing `sentinel=np.nan` because `(np.nan == np.nan) is False`</span></div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <span class="comment"># potential optimization: don&#39;t copy arrays that don&#39;t contain sentinel</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> paired:</div>
<div class="line"><span class="lineno">  160</span>        <span class="keywordflow">return</span> [sample[sample != sentinel] <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples]</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># for paired samples, we need to remove the whole pair when any part</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="comment"># has a nan</span></div>
<div class="line"><span class="lineno">  164</span>    sentinels = (samples[0] == sentinel)</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples[1:]:</div>
<div class="line"><span class="lineno">  166</span>        sentinels = sentinels | (sample == sentinel)</div>
<div class="line"><span class="lineno">  167</span>    not_sentinels = ~sentinels</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">return</span> [sample[not_sentinels] <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> samples]</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a886bfe8d10cff88e7470159b1bc2ff29" name="a886bfe8d10cff88e7470159b1bc2ff29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886bfe8d10cff88e7470159b1bc2ff29">&#9670;&#160;</a></span>_desc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tuple scipy.stats._axis_nan_policy._desc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    </div>
<div class="line"><span class="lineno">    3</span>    .split(<span class="stringliteral">&#39;\n&#39;</span>))</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa977b84df95dce8a403b2a656da430e3" name="aa977b84df95dce8a403b2a656da430e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa977b84df95dce8a403b2a656da430e3">&#9670;&#160;</a></span>_keepdims_parameter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._keepdims_parameter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  inspect.Parameter(_name,</div>
<div class="line"><span class="lineno">    2</span>                                        inspect.Parameter.KEYWORD_ONLY,</div>
<div class="line"><span class="lineno">    3</span>                                        default=<span class="keyword">False</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6be8ae57ffbbd985d0da47249ad70d5" name="ad6be8ae57ffbbd985d0da47249ad70d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6be8ae57ffbbd985d0da47249ad70d5">&#9670;&#160;</a></span>_keepdims_parameter_doc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._keepdims_parameter_doc = Parameter(<a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a856ab5bd3b45710bd8dabb2dacead7cb">_name</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a1f8876eaf588af9e1a8944d7fc0d8351">_type</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a886bfe8d10cff88e7470159b1bc2ff29">_desc</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a856ab5bd3b45710bd8dabb2dacead7cb" name="a856ab5bd3b45710bd8dabb2dacead7cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a856ab5bd3b45710bd8dabb2dacead7cb">&#9670;&#160;</a></span>_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str scipy.stats._axis_nan_policy._name = 'axis'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a55519bc578f48f6b8dbc870c5481ad07" name="a55519bc578f48f6b8dbc870c5481ad07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55519bc578f48f6b8dbc870c5481ad07">&#9670;&#160;</a></span>_nan_policy_parameter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._nan_policy_parameter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  inspect.Parameter(_name,</div>
<div class="line"><span class="lineno">    2</span>                                          inspect.Parameter.KEYWORD_ONLY,</div>
<div class="line"><span class="lineno">    3</span>                                          default=<span class="stringliteral">&#39;propagate&#39;</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0c505796b77da16bf18b71afe66ead9" name="ad0c505796b77da16bf18b71afe66ead9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0c505796b77da16bf18b71afe66ead9">&#9670;&#160;</a></span>_nan_policy_parameter_doc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._axis_nan_policy._nan_policy_parameter_doc = Parameter(<a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a856ab5bd3b45710bd8dabb2dacead7cb">_name</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a1f8876eaf588af9e1a8944d7fc0d8351">_type</a>, <a class="el" href="namespacescipy_1_1stats_1_1__axis__nan__policy.html#a886bfe8d10cff88e7470159b1bc2ff29">_desc</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6734aa5b8b7ff26bc251535928f9d28c" name="a6734aa5b8b7ff26bc251535928f9d28c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6734aa5b8b7ff26bc251535928f9d28c">&#9670;&#160;</a></span>_standard_note_addition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tuple scipy.stats._axis_nan_policy._standard_note_addition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    ).split(<span class="stringliteral">&#39;\n&#39;</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f8876eaf588af9e1a8944d7fc0d8351" name="a1f8876eaf588af9e1a8944d7fc0d8351"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f8876eaf588af9e1a8944d7fc0d8351">&#9670;&#160;</a></span>_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str scipy.stats._axis_nan_policy._type = &quot;{'propagate', 'omit', 'raise'}&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
