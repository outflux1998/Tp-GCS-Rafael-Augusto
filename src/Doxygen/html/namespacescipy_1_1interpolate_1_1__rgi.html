<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.interpolate._rgi Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1interpolate.html">interpolate</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1interpolate_1_1__rgi.html">_rgi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.interpolate._rgi Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__rgi_1_1_regular_grid_interpolator.html">RegularGridInterpolator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afa3d1aa1b4e6b2f055eba022572c2d43" id="r_afa3d1aa1b4e6b2f055eba022572c2d43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1interpolate_1_1__rgi.html#afa3d1aa1b4e6b2f055eba022572c2d43">_make_points_and_values_ascending</a> (points, values)</td></tr>
<tr class="separator:afa3d1aa1b4e6b2f055eba022572c2d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c4a916c1a0a3b0e6b3453b3a15d4c8" id="r_a31c4a916c1a0a3b0e6b3453b3a15d4c8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1interpolate_1_1__rgi.html#a31c4a916c1a0a3b0e6b3453b3a15d4c8">interpn</a> (points, values, xi, method=&quot;linear&quot;, bounds_error=True, fill_value=np.nan)</td></tr>
<tr class="separator:a31c4a916c1a0a3b0e6b3453b3a15d4c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="afa3d1aa1b4e6b2f055eba022572c2d43" name="afa3d1aa1b4e6b2f055eba022572c2d43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa3d1aa1b4e6b2f055eba022572c2d43">&#9670;&#160;</a></span>_make_points_and_values_ascending()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._rgi._make_points_and_values_ascending </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   13</span><span class="keyword">def </span>_make_points_and_values_ascending(points, values):</div>
<div class="line"><span class="lineno">   14</span>    <span class="comment"># create ascending points</span></div>
<div class="line"><span class="lineno">   15</span>    sorted_indexes = tuple(np.argsort(point) <span class="keywordflow">for</span> point <span class="keywordflow">in</span> points)</div>
<div class="line"><span class="lineno">   16</span>    points_asc = tuple(</div>
<div class="line"><span class="lineno">   17</span>        np.asarray(point)[sort_index] <span class="keywordflow">for</span> (point, sort_index) <span class="keywordflow">in</span></div>
<div class="line"><span class="lineno">   18</span>        zip(points, sorted_indexes))</div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span>    <span class="comment"># create ascending values</span></div>
<div class="line"><span class="lineno">   21</span>    ordered_indexes = tuple([*range(len(x))] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> sorted_indexes)</div>
<div class="line"><span class="lineno">   22</span>    ordered_indexes_array = np.array(</div>
<div class="line"><span class="lineno">   23</span>        [i.flatten() <span class="keywordflow">for</span> i <span class="keywordflow">in</span> np.meshgrid(*ordered_indexes)]).transpose()</div>
<div class="line"><span class="lineno">   24</span>    sorted_indexes_array = np.array(</div>
<div class="line"><span class="lineno">   25</span>        [i.flatten() <span class="keywordflow">for</span> i <span class="keywordflow">in</span> np.meshgrid(*sorted_indexes)]).transpose()</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>    values_asc = np.zeros_like(np.asarray(values))</div>
<div class="line"><span class="lineno">   28</span>    <span class="keywordflow">for</span> o, s <span class="keywordflow">in</span> zip(ordered_indexes_array, sorted_indexes_array):</div>
<div class="line"><span class="lineno">   29</span>        values_asc[tuple(o)] = values[tuple(s)]</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>    <span class="keywordflow">return</span> points_asc, values_asc</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a31c4a916c1a0a3b0e6b3453b3a15d4c8" name="a31c4a916c1a0a3b0e6b3453b3a15d4c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31c4a916c1a0a3b0e6b3453b3a15d4c8">&#9670;&#160;</a></span>interpn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._rgi.interpn </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>&quot;linear&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds_error</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fill_value</em> = <code>np.nan</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional interpolation on regular or rectilinear grids.

Strictly speaking, not all regular grids are supported - this function
works on *rectilinear* grids, that is, a rectangular grid with even or
uneven spacing.

Parameters
----------
points : tuple of ndarray of float, with shapes (m1, ), ..., (mn, )
    The points defining the regular grid in n dimensions. The points in
    each dimension (i.e. every elements of the points tuple) must be
    strictly ascending or descending.

values : array_like, shape (m1, ..., mn, ...)
    The data on the regular grid in n dimensions. Complex data can be
    acceptable.

xi : ndarray of shape (..., ndim)
    The coordinates to sample the gridded data at

method : str, optional
    The method of interpolation to perform. Supported are "linear" and
    "nearest", and "splinef2d". "splinef2d" is only supported for
    2-dimensional data.

bounds_error : bool, optional
    If True, when interpolated values are requested outside of the
    domain of the input data, a ValueError is raised.
    If False, then `fill_value` is used.

fill_value : number, optional
    If provided, the value to use for points outside of the
    interpolation domain. If None, values outside
    the domain are extrapolated.  Extrapolation is not supported by method
    "splinef2d".

Returns
-------
values_x : ndarray, shape xi.shape[:-1] + values.shape[ndim:]
    Interpolated values at input coordinates.

Notes
-----

.. versionadded:: 0.14

Examples
--------
Evaluate a simple example function on the points of a regular 3-D grid:

&gt;&gt;&gt; from scipy.interpolate import interpn
&gt;&gt;&gt; def value_func_3d(x, y, z):
...     return 2 * x + 3 * y - z
&gt;&gt;&gt; x = np.linspace(0, 4, 5)
&gt;&gt;&gt; y = np.linspace(0, 5, 6)
&gt;&gt;&gt; z = np.linspace(0, 6, 7)
&gt;&gt;&gt; points = (x, y, z)
&gt;&gt;&gt; values = value_func_3d(*np.meshgrid(*points, indexing='ij'))

Evaluate the interpolating function at a point

&gt;&gt;&gt; point = np.array([2.21, 3.12, 1.15])
&gt;&gt;&gt; print(interpn(points, values, point))
[12.63]

See Also
--------
NearestNDInterpolator : Nearest neighbor interpolation on unstructured
                        data in N dimensions

LinearNDInterpolator : Piecewise linear interpolant on unstructured data
                       in N dimensions

RegularGridInterpolator : interpolation on a regular or rectilinear grid
                          in arbitrary dimensions (`interpn` wraps this
                          class).

RectBivariateSpline : Bivariate spline approximation over a rectangular mesh

scipy.ndimage.map_coordinates : interpolation on grids with equal spacing
                                (suitable for e.g., N-D image resampling)</pre> <div class="fragment"><div class="line"><span class="lineno">  446</span>            fill_value=np.nan):</div>
<div class="line"><span class="lineno">  447</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral">    Multidimensional interpolation on regular or rectilinear grids.</span></div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">    Strictly speaking, not all regular grids are supported - this function</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral">    works on *rectilinear* grids, that is, a rectangular grid with even or</span></div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">    uneven spacing.</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral">    points : tuple of ndarray of float, with shapes (m1, ), ..., (mn, )</span></div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">        The points defining the regular grid in n dimensions. The points in</span></div>
<div class="line"><span class="lineno">  458</span><span class="stringliteral">        each dimension (i.e. every elements of the points tuple) must be</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral">        strictly ascending or descending.</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral">    values : array_like, shape (m1, ..., mn, ...)</span></div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">        The data on the regular grid in n dimensions. Complex data can be</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral">        acceptable.</span></div>
<div class="line"><span class="lineno">  464</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral">    xi : ndarray of shape (..., ndim)</span></div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">        The coordinates to sample the gridded data at</span></div>
<div class="line"><span class="lineno">  467</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral">    method : str, optional</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">        The method of interpolation to perform. Supported are &quot;linear&quot; and</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral">        &quot;nearest&quot;, and &quot;splinef2d&quot;. &quot;splinef2d&quot; is only supported for</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">        2-dimensional data.</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">    bounds_error : bool, optional</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">        If True, when interpolated values are requested outside of the</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">        domain of the input data, a ValueError is raised.</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">        If False, then `fill_value` is used.</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    fill_value : number, optional</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">        If provided, the value to use for points outside of the</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">        interpolation domain. If None, values outside</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">        the domain are extrapolated.  Extrapolation is not supported by method</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">        &quot;splinef2d&quot;.</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">    values_x : ndarray, shape xi.shape[:-1] + values.shape[ndim:]</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">        Interpolated values at input coordinates.</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">    .. versionadded:: 0.14</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">    Evaluate a simple example function on the points of a regular 3-D grid:</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.interpolate import interpn</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">    &gt;&gt;&gt; def value_func_3d(x, y, z):</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">    ...     return 2 * x + 3 * y - z</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">    &gt;&gt;&gt; x = np.linspace(0, 4, 5)</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">    &gt;&gt;&gt; y = np.linspace(0, 5, 6)</span></div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">    &gt;&gt;&gt; z = np.linspace(0, 6, 7)</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">    &gt;&gt;&gt; points = (x, y, z)</span></div>
<div class="line"><span class="lineno">  505</span><span class="stringliteral">    &gt;&gt;&gt; values = value_func_3d(*np.meshgrid(*points, indexing=&#39;ij&#39;))</span></div>
<div class="line"><span class="lineno">  506</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral">    Evaluate the interpolating function at a point</span></div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  509</span><span class="stringliteral">    &gt;&gt;&gt; point = np.array([2.21, 3.12, 1.15])</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">    &gt;&gt;&gt; print(interpn(points, values, point))</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">    [12.63]</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">    NearestNDInterpolator : Nearest neighbor interpolation on unstructured</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">                            data in N dimensions</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">    LinearNDInterpolator : Piecewise linear interpolant on unstructured data</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">                           in N dimensions</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">    RegularGridInterpolator : interpolation on a regular or rectilinear grid</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">                              in arbitrary dimensions (`interpn` wraps this</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">                              class).</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">    RectBivariateSpline : Bivariate spline approximation over a rectangular mesh</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    scipy.ndimage.map_coordinates : interpolation on grids with equal spacing</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">                                    (suitable for e.g., N-D image resampling)</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="comment"># sanity check &#39;method&#39; kwarg</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="keywordflow">if</span> method <span class="keywordflow">not</span> <span class="keywordflow">in</span> [<span class="stringliteral">&quot;linear&quot;</span>, <span class="stringliteral">&quot;nearest&quot;</span>, <span class="stringliteral">&quot;splinef2d&quot;</span>]:</div>
<div class="line"><span class="lineno">  533</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;interpn only understands the methods &#39;linear&#39;, &quot;</span></div>
<div class="line"><span class="lineno">  534</span>                         <span class="stringliteral">&quot;&#39;nearest&#39;, and &#39;splinef2d&#39;. You provided %s.&quot;</span> %</div>
<div class="line"><span class="lineno">  535</span>                         method)</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(values, <span class="stringliteral">&#39;ndim&#39;</span>):</div>
<div class="line"><span class="lineno">  538</span>        values = np.asarray(values)</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    ndim = values.ndim</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">if</span> ndim &gt; 2 <span class="keywordflow">and</span> method == <span class="stringliteral">&quot;splinef2d&quot;</span>:</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The method splinef2d can only be used for &quot;</span></div>
<div class="line"><span class="lineno">  543</span>                         <span class="stringliteral">&quot;2-dimensional input data&quot;</span>)</div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> bounds_error <span class="keywordflow">and</span> fill_value <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> method == <span class="stringliteral">&quot;splinef2d&quot;</span>:</div>
<div class="line"><span class="lineno">  545</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The method splinef2d does not support extrapolation.&quot;</span>)</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>    <span class="comment"># sanity check consistency of input dimensions</span></div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">if</span> len(points) &gt; ndim:</div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;There are %d point arrays, but values has %d &quot;</span></div>
<div class="line"><span class="lineno">  550</span>                         <span class="stringliteral">&quot;dimensions&quot;</span> % (len(points), ndim))</div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordflow">if</span> len(points) != ndim <span class="keywordflow">and</span> method == <span class="stringliteral">&#39;splinef2d&#39;</span>:</div>
<div class="line"><span class="lineno">  552</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The method splinef2d can only be used for &quot;</span></div>
<div class="line"><span class="lineno">  553</span>                         <span class="stringliteral">&quot;scalar data with one point per coordinate&quot;</span>)</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>    <span class="comment"># sanity check input grid</span></div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordflow">for</span> i, p <span class="keywordflow">in</span> enumerate(points):</div>
<div class="line"><span class="lineno">  557</span>        diff_p = np.diff(p)</div>
<div class="line"><span class="lineno">  558</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.all(diff_p &gt; 0.):</div>
<div class="line"><span class="lineno">  559</span>            <span class="keywordflow">if</span> np.all(diff_p &lt; 0.):</div>
<div class="line"><span class="lineno">  560</span>                <span class="comment"># input is descending, so make it ascending</span></div>
<div class="line"><span class="lineno">  561</span>                points, values = _make_points_and_values_ascending(points,</div>
<div class="line"><span class="lineno">  562</span>                                                                   values)</div>
<div class="line"><span class="lineno">  563</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  564</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The points in dimension %d must be strictly &quot;</span></div>
<div class="line"><span class="lineno">  565</span>                                 <span class="stringliteral">&quot;ascending or descending&quot;</span> % i)</div>
<div class="line"><span class="lineno">  566</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.asarray(p).ndim == 1:</div>
<div class="line"><span class="lineno">  567</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The points in dimension %d must be &quot;</span></div>
<div class="line"><span class="lineno">  568</span>                             <span class="stringliteral">&quot;1-dimensional&quot;</span> % i)</div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> values.shape[i] == len(p):</div>
<div class="line"><span class="lineno">  570</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;There are %d points and %d values in &quot;</span></div>
<div class="line"><span class="lineno">  571</span>                             <span class="stringliteral">&quot;dimension %d&quot;</span> % (len(p), values.shape[i], i))</div>
<div class="line"><span class="lineno">  572</span>    grid = tuple([np.asarray(p) <span class="keywordflow">for</span> p <span class="keywordflow">in</span> points])</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="comment"># sanity check requested xi</span></div>
<div class="line"><span class="lineno">  575</span>    xi = _ndim_coords_from_arrays(xi, ndim=len(grid))</div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">if</span> xi.shape[-1] != len(grid):</div>
<div class="line"><span class="lineno">  577</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The requested sample points xi have dimension &quot;</span></div>
<div class="line"><span class="lineno">  578</span>                         <span class="stringliteral">&quot;%d, but this RegularGridInterpolator has &quot;</span></div>
<div class="line"><span class="lineno">  579</span>                         <span class="stringliteral">&quot;dimension %d&quot;</span> % (xi.shape[-1], len(grid)))</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordflow">if</span> bounds_error:</div>
<div class="line"><span class="lineno">  582</span>        <span class="keywordflow">for</span> i, p <span class="keywordflow">in</span> enumerate(xi.T):</div>
<div class="line"><span class="lineno">  583</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.logical_and(np.all(grid[i][0] &lt;= p),</div>
<div class="line"><span class="lineno">  584</span>                                                np.all(p &lt;= grid[i][-1])):</div>
<div class="line"><span class="lineno">  585</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;One of the requested xi is out of bounds &quot;</span></div>
<div class="line"><span class="lineno">  586</span>                                <span class="stringliteral">&quot;in dimension %d&quot;</span> % i)</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    <span class="comment"># perform interpolation</span></div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;linear&quot;</span>:</div>
<div class="line"><span class="lineno">  590</span>        interp = RegularGridInterpolator(points, values, method=<span class="stringliteral">&quot;linear&quot;</span>,</div>
<div class="line"><span class="lineno">  591</span>                                         bounds_error=bounds_error,</div>
<div class="line"><span class="lineno">  592</span>                                         fill_value=fill_value)</div>
<div class="line"><span class="lineno">  593</span>        <span class="keywordflow">return</span> interp(xi)</div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">elif</span> method == <span class="stringliteral">&quot;nearest&quot;</span>:</div>
<div class="line"><span class="lineno">  595</span>        interp = RegularGridInterpolator(points, values, method=<span class="stringliteral">&quot;nearest&quot;</span>,</div>
<div class="line"><span class="lineno">  596</span>                                         bounds_error=bounds_error,</div>
<div class="line"><span class="lineno">  597</span>                                         fill_value=fill_value)</div>
<div class="line"><span class="lineno">  598</span>        <span class="keywordflow">return</span> interp(xi)</div>
<div class="line"><span class="lineno">  599</span>    <span class="keywordflow">elif</span> method == <span class="stringliteral">&quot;splinef2d&quot;</span>:</div>
<div class="line"><span class="lineno">  600</span>        xi_shape = xi.shape</div>
<div class="line"><span class="lineno">  601</span>        xi = xi.reshape(-1, xi.shape[-1])</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>        <span class="comment"># RectBivariateSpline doesn&#39;t support fill_value; we need to wrap here</span></div>
<div class="line"><span class="lineno">  604</span>        idx_valid = np.all((grid[0][0] &lt;= xi[:, 0], xi[:, 0] &lt;= grid[0][-1],</div>
<div class="line"><span class="lineno">  605</span>                            grid[1][0] &lt;= xi[:, 1], xi[:, 1] &lt;= grid[1][-1]),</div>
<div class="line"><span class="lineno">  606</span>                           axis=0)</div>
<div class="line"><span class="lineno">  607</span>        result = np.empty_like(xi[:, 0])</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>        <span class="comment"># make a copy of values for RectBivariateSpline</span></div>
<div class="line"><span class="lineno">  610</span>        interp = RectBivariateSpline(points[0], points[1], values[:])</div>
<div class="line"><span class="lineno">  611</span>        result[idx_valid] = interp.ev(xi[idx_valid, 0], xi[idx_valid, 1])</div>
<div class="line"><span class="lineno">  612</span>        result[np.logical_not(idx_valid)] = fill_value</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>        <span class="keywordflow">return</span> result.reshape(xi_shape[:-1])</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
