<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: matplotlib.sphinxext.plot_directive Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacematplotlib.html">matplotlib</a></li><li class="navelem"><a class="el" href="namespacematplotlib_1_1sphinxext.html">sphinxext</a></li><li class="navelem"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html">plot_directive</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">matplotlib.sphinxext.plot_directive Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmatplotlib_1_1sphinxext_1_1plot__directive_1_1_image_file.html">ImageFile</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmatplotlib_1_1sphinxext_1_1plot__directive_1_1_plot_directive.html">PlotDirective</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmatplotlib_1_1sphinxext_1_1plot__directive_1_1_plot_error.html">PlotError</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac4214b3ba057a2019f3fb4381c7fd459" id="r_ac4214b3ba057a2019f3fb4381c7fd459"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#ac4214b3ba057a2019f3fb4381c7fd459">_option_boolean</a> (arg)</td></tr>
<tr class="separator:ac4214b3ba057a2019f3fb4381c7fd459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7214b09828b78b09d0402213bebae101" id="r_a7214b09828b78b09d0402213bebae101"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a7214b09828b78b09d0402213bebae101">_option_context</a> (arg)</td></tr>
<tr class="separator:a7214b09828b78b09d0402213bebae101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82a456b5497cde1249a2adf751d121e8" id="r_a82a456b5497cde1249a2adf751d121e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a82a456b5497cde1249a2adf751d121e8">_option_format</a> (arg)</td></tr>
<tr class="separator:a82a456b5497cde1249a2adf751d121e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab49c875424cb9131e74fdba5a6fa171d" id="r_ab49c875424cb9131e74fdba5a6fa171d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#ab49c875424cb9131e74fdba5a6fa171d">_deprecated_option_encoding</a> (arg)</td></tr>
<tr class="separator:ab49c875424cb9131e74fdba5a6fa171d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9482790125e8fef3881b03ae1b1e6b" id="r_a3b9482790125e8fef3881b03ae1b1e6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a3b9482790125e8fef3881b03ae1b1e6b">mark_plot_labels</a> (app, document)</td></tr>
<tr class="separator:a3b9482790125e8fef3881b03ae1b1e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94826e9218ee66a647dab33d19a85c5d" id="r_a94826e9218ee66a647dab33d19a85c5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a94826e9218ee66a647dab33d19a85c5d">_copy_css_file</a> (app, exc)</td></tr>
<tr class="separator:a94826e9218ee66a647dab33d19a85c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac2ace4b138439b159c6e70ae6b29ce" id="r_abac2ace4b138439b159c6e70ae6b29ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#abac2ace4b138439b159c6e70ae6b29ce">setup</a> (app)</td></tr>
<tr class="separator:abac2ace4b138439b159c6e70ae6b29ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a7a5d2a7c4a5b8812b507ed0028f2d2" id="r_a8a7a5d2a7c4a5b8812b507ed0028f2d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a8a7a5d2a7c4a5b8812b507ed0028f2d2">contains_doctest</a> (text)</td></tr>
<tr class="separator:a8a7a5d2a7c4a5b8812b507ed0028f2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a605b931a33f4f5fe1eaecbe7cc4cb54b" id="r_a605b931a33f4f5fe1eaecbe7cc4cb54b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a605b931a33f4f5fe1eaecbe7cc4cb54b">unescape_doctest</a> (text)</td></tr>
<tr class="separator:a605b931a33f4f5fe1eaecbe7cc4cb54b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a626626b4703335b962075cc51ae4f888" id="r_a626626b4703335b962075cc51ae4f888"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a626626b4703335b962075cc51ae4f888">split_code_at_show</a> (text)</td></tr>
<tr class="separator:a626626b4703335b962075cc51ae4f888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5ecdc72e6d18e81d994b743fdd1c77" id="r_a6c5ecdc72e6d18e81d994b743fdd1c77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a6c5ecdc72e6d18e81d994b743fdd1c77">_split_code_at_show</a> (text)</td></tr>
<tr class="separator:a6c5ecdc72e6d18e81d994b743fdd1c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5bc9a74fe6742ca28cf577a0b7f1e6f" id="r_af5bc9a74fe6742ca28cf577a0b7f1e6f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#af5bc9a74fe6742ca28cf577a0b7f1e6f">out_of_date</a> (original, derived, includes=None)</td></tr>
<tr class="separator:af5bc9a74fe6742ca28cf577a0b7f1e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b415f218f38dc6119776450faf527fc" id="r_a3b415f218f38dc6119776450faf527fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a3b415f218f38dc6119776450faf527fc">run_code</a> (code, code_path, <a class="el" href="__lapack__subroutines_8h.html#ace38bc4f3f3ba577fffa106105715135">ns</a>=None, function_name=None)</td></tr>
<tr class="separator:a3b415f218f38dc6119776450faf527fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48c6462bcfffffa323ae3050d3603ed1" id="r_a48c6462bcfffffa323ae3050d3603ed1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a48c6462bcfffffa323ae3050d3603ed1">_run_code</a> (code, code_path, <a class="el" href="__lapack__subroutines_8h.html#ace38bc4f3f3ba577fffa106105715135">ns</a>=None, function_name=None)</td></tr>
<tr class="separator:a48c6462bcfffffa323ae3050d3603ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5739296eded76b077836ed59b1f62a2" id="r_af5739296eded76b077836ed59b1f62a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#af5739296eded76b077836ed59b1f62a2">clear_state</a> (plot_rcparams, close=True)</td></tr>
<tr class="separator:af5739296eded76b077836ed59b1f62a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbd6406670c452f8756093106dea8e6b" id="r_acbd6406670c452f8756093106dea8e6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#acbd6406670c452f8756093106dea8e6b">get_plot_formats</a> (config)</td></tr>
<tr class="separator:acbd6406670c452f8756093106dea8e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9a9fff1f305de0aff0a3c15b4401001" id="r_af9a9fff1f305de0aff0a3c15b4401001"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#af9a9fff1f305de0aff0a3c15b4401001">render_figures</a> (code, code_path, output_dir, output_base, context, function_name, config, context_reset=False, close_figs=False, code_includes=None)</td></tr>
<tr class="separator:af9a9fff1f305de0aff0a3c15b4401001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4116737214fcb2f018ba0cbf09a8de3" id="r_ac4116737214fcb2f018ba0cbf09a8de3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#ac4116737214fcb2f018ba0cbf09a8de3">run</a> (arguments, content, options, state_machine, state, lineno)</td></tr>
<tr class="separator:ac4116737214fcb2f018ba0cbf09a8de3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a29cfda34078bf530f231b4aba89ba25d" id="r_a29cfda34078bf530f231b4aba89ba25d"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#a29cfda34078bf530f231b4aba89ba25d">TEMPLATE</a></td></tr>
<tr class="separator:a29cfda34078bf530f231b4aba89ba25d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff99610126e8d2d5990ba60cee3af115" id="r_aff99610126e8d2d5990ba60cee3af115"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#aff99610126e8d2d5990ba60cee3af115">exception_template</a></td></tr>
<tr class="separator:aff99610126e8d2d5990ba60cee3af115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab583bdd2816385c48c3a5427630c2689" id="r_ab583bdd2816385c48c3a5427630c2689"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1sphinxext_1_1plot__directive.html#ab583bdd2816385c48c3a5427630c2689">plot_context</a> = dict()</td></tr>
<tr class="separator:ab583bdd2816385c48c3a5427630c2689"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">A directive for including a Matplotlib plot in a Sphinx document
================================================================

This is a Sphinx extension providing a reStructuredText directive
``.. plot::`` for including a plot in a Sphinx document.

In HTML output, ``.. plot::`` will include a .png file with a link
to a high-res .png and .pdf.  In LaTeX output, it will include a .pdf.

The plot content may be defined in one of three ways:

1. **A path to a source file** as the argument to the directive::

     .. plot:: path/to/plot.py

   When a path to a source file is given, the content of the
   directive may optionally contain a caption for the plot::

     .. plot:: path/to/plot.py

        The plot caption.

   Additionally, one may specify the name of a function to call (with
   no arguments) immediately after importing the module::

     .. plot:: path/to/plot.py plot_function1

2. Included as **inline content** to the directive::

     .. plot::

        import matplotlib.pyplot as plt
        plt.plot([1, 2, 3], [4, 5, 6])
        plt.title("A plotting exammple")

3. Using **doctest** syntax::

     .. plot::

        A plotting example:
        &gt;&gt;&gt; import matplotlib.pyplot as plt
        &gt;&gt;&gt; plt.plot([1, 2, 3], [4, 5, 6])

Options
-------

The ``.. plot::`` directive supports the following options:

    ``:format:`` : {'python', 'doctest'}
        The format of the input.  If unset, the format is auto-detected.

    ``:include-source:`` : bool
        Whether to display the source code. The default can be changed using
        the ``plot_include_source`` variable in :file:`conf.py` (which itself
        defaults to False).

    ``:encoding:`` : str
        If this source file is in a non-UTF8 or non-ASCII encoding, the
        encoding must be specified using the ``:encoding:`` option.  The
        encoding will not be inferred using the ``-*- coding -*-`` metacomment.

    ``:context:`` : bool or str
        If provided, the code will be run in the context of all previous plot
        directives for which the ``:context:`` option was specified.  This only
        applies to inline code plot directives, not those run from files. If
        the ``:context: reset`` option is specified, the context is reset
        for this and future plots, and previous figures are closed prior to
        running the code. ``:context: close-figs`` keeps the context but closes
        previous figures before running the code.

    ``:nofigs:`` : bool
        If specified, the code block will be run, but no figures will be
        inserted.  This is usually useful with the ``:context:`` option.

    ``:caption:`` : str
        If specified, the option's argument will be used as a caption for the
        figure. This overwrites the caption given in the content, when the plot
        is generated from a file.

Additionally, this directive supports all the options of the `image directive
&lt;https://docutils.sourceforge.io/docs/ref/rst/directives.html#image&gt;`_,
except for ``:target:`` (since plot will add its own target).  These include
``:alt:``, ``:height:``, ``:width:``, ``:scale:``, ``:align:`` and ``:class:``.

Configuration options
---------------------

The plot directive has the following configuration options:

    plot_include_source
        Default value for the include-source option (default: False).

    plot_html_show_source_link
        Whether to show a link to the source in HTML (default: True).

    plot_pre_code
        Code that should be executed before each plot. If None (the default),
        it will default to a string containing::

            import numpy as np
            from matplotlib import pyplot as plt

    plot_basedir
        Base directory, to which ``plot::`` file names are relative to.
        If None or empty (the default), file names are relative to the
        directory where the file containing the directive is.

    plot_formats
        File formats to generate (default: ['png', 'hires.png', 'pdf']).
        List of tuples or strings::

            [(suffix, dpi), suffix, ...]

        that determine the file format and the DPI. For entries whose
        DPI was omitted, sensible defaults are chosen. When passing from
        the command line through sphinx_build the list should be passed as
        suffix:dpi,suffix:dpi, ...

    plot_html_show_formats
        Whether to show links to the files in HTML (default: True).

    plot_rcparams
        A dictionary containing any non-standard rcParams that should
        be applied before each plot (default: {}).

    plot_apply_rcparams
        By default, rcParams are applied when ``:context:`` option is not used
        in a plot directive.  If set, this configuration option overrides this
        behavior and applies rcParams before each plot.

    plot_working_directory
        By default, the working directory will be changed to the directory of
        the example, so the code can get at its data files, if any.  Also its
        path will be added to `sys.path` so it can import any helper modules
        sitting beside it.  This configuration option can be used to specify
        a central directory (also added to `sys.path`) where data files and
        helper modules for all code are located.

    plot_template
        Provide a customized template for preparing restructured text.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a94826e9218ee66a647dab33d19a85c5d" name="a94826e9218ee66a647dab33d19a85c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94826e9218ee66a647dab33d19a85c5d">&#9670;&#160;</a></span>_copy_css_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive._copy_css_file </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  264</span><span class="keyword">def </span>_copy_css_file(app, exc):</div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">if</span> exc <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> app.builder.format == <span class="stringliteral">&#39;html&#39;</span>:</div>
<div class="line"><span class="lineno">  266</span>        src = cbook._get_data_path(<span class="stringliteral">&#39;plot_directive/plot_directive.css&#39;</span>)</div>
<div class="line"><span class="lineno">  267</span>        dst = app.outdir / Path(<span class="stringliteral">&#39;_static&#39;</span>)</div>
<div class="line"><span class="lineno">  268</span>        dst.mkdir(exist_ok=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  269</span>        <span class="comment"># Use copyfile because we do not want to copy src&#39;s permissions.</span></div>
<div class="line"><span class="lineno">  270</span>        shutil.copyfile(src, dst / Path(<span class="stringliteral">&#39;plot_directive.css&#39;</span>))</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab49c875424cb9131e74fdba5a6fa171d" name="ab49c875424cb9131e74fdba5a6fa171d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab49c875424cb9131e74fdba5a6fa171d">&#9670;&#160;</a></span>_deprecated_option_encoding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive._deprecated_option_encoding </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  198</span><span class="keyword">def </span>_deprecated_option_encoding(arg):</div>
<div class="line"><span class="lineno">  199</span>    _api.warn_deprecated(<span class="stringliteral">&quot;3.5&quot;</span>, name=<span class="stringliteral">&quot;encoding&quot;</span>, obj_type=<span class="stringliteral">&quot;option&quot;</span>)</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">return</span> directives.encoding(arg)</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4214b3ba057a2019f3fb4381c7fd459" name="ac4214b3ba057a2019f3fb4381c7fd459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4214b3ba057a2019f3fb4381c7fd459">&#9670;&#160;</a></span>_option_boolean()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive._option_boolean </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  176</span><span class="keyword">def </span>_option_boolean(arg):</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> arg <span class="keywordflow">or</span> <span class="keywordflow">not</span> arg.strip():</div>
<div class="line"><span class="lineno">  178</span>        <span class="comment"># no argument given, assume used as a flag</span></div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">elif</span> arg.strip().lower() <span class="keywordflow">in</span> (<span class="stringliteral">&#39;no&#39;</span>, <span class="stringliteral">&#39;0&#39;</span>, <span class="stringliteral">&#39;false&#39;</span>):</div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">elif</span> arg.strip().lower() <span class="keywordflow">in</span> (<span class="stringliteral">&#39;yes&#39;</span>, <span class="stringliteral">&#39;1&#39;</span>, <span class="stringliteral">&#39;true&#39;</span>):</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  185</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&#39;{arg!r} unknown boolean&#39;</span>)</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7214b09828b78b09d0402213bebae101" name="a7214b09828b78b09d0402213bebae101"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7214b09828b78b09d0402213bebae101">&#9670;&#160;</a></span>_option_context()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive._option_context </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  188</span><span class="keyword">def </span>_option_context(arg):</div>
<div class="line"><span class="lineno">  189</span>    <span class="keywordflow">if</span> arg <span class="keywordflow">in</span> [<span class="keywordtype">None</span>, <span class="stringliteral">&#39;reset&#39;</span>, <span class="stringliteral">&#39;close-figs&#39;</span>]:</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">return</span> arg</div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Argument should be None or &#39;reset&#39; or &#39;close-figs&#39;&quot;</span>)</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a82a456b5497cde1249a2adf751d121e8" name="a82a456b5497cde1249a2adf751d121e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82a456b5497cde1249a2adf751d121e8">&#9670;&#160;</a></span>_option_format()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive._option_format </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  194</span><span class="keyword">def </span>_option_format(arg):</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">return</span> directives.choice(arg, (<span class="stringliteral">&#39;python&#39;</span>, <span class="stringliteral">&#39;doctest&#39;</span>))</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a48c6462bcfffffa323ae3050d3603ed1" name="a48c6462bcfffffa323ae3050d3603ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48c6462bcfffffa323ae3050d3603ed1">&#9670;&#160;</a></span>_run_code()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive._run_code </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ns</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function_name</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Import a Python module from a path, and run the function given by
name, if function_name is not None.
</pre> <div class="fragment"><div class="line"><span class="lineno">  475</span><span class="keyword">def </span>_run_code(code, code_path, ns=None, function_name=None):</div>
<div class="line"><span class="lineno">  476</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">    Import a Python module from a path, and run the function given by</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    name, if function_name is not None.</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>    <span class="comment"># Change the working directory to the directory of the example, so</span></div>
<div class="line"><span class="lineno">  482</span>    <span class="comment"># it can get at its data files, if any.  Add its path to sys.path</span></div>
<div class="line"><span class="lineno">  483</span>    <span class="comment"># so it can import any helper modules sitting beside it.</span></div>
<div class="line"><span class="lineno">  484</span>    pwd = os.getcwd()</div>
<div class="line"><span class="lineno">  485</span>    <span class="keywordflow">if</span> setup.config.plot_working_directory <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  486</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  487</span>            os.chdir(setup.config.plot_working_directory)</div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">except</span> OSError <span class="keyword">as</span> err:</div>
<div class="line"><span class="lineno">  489</span>            <span class="keywordflow">raise</span> OSError(str(err) + <span class="stringliteral">&#39;\n`plot_working_directory` option in&#39;</span></div>
<div class="line"><span class="lineno">  490</span>                          <span class="stringliteral">&#39;Sphinx configuration file must be a valid &#39;</span></div>
<div class="line"><span class="lineno">  491</span>                          <span class="stringliteral">&#39;directory path&#39;</span>) <span class="keyword">from</span> err</div>
<div class="line"><span class="lineno">  492</span>        <span class="keywordflow">except</span> TypeError <span class="keyword">as</span> err:</div>
<div class="line"><span class="lineno">  493</span>            <span class="keywordflow">raise</span> TypeError(str(err) + <span class="stringliteral">&#39;\n`plot_working_directory` option in &#39;</span></div>
<div class="line"><span class="lineno">  494</span>                            <span class="stringliteral">&#39;Sphinx configuration file must be a string or &#39;</span></div>
<div class="line"><span class="lineno">  495</span>                            <span class="stringliteral">&#39;None&#39;</span>) <span class="keyword">from</span> err</div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">elif</span> code_path <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  497</span>        dirname = os.path.abspath(os.path.dirname(code_path))</div>
<div class="line"><span class="lineno">  498</span>        os.chdir(dirname)</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>    <span class="keyword">with</span> cbook._setattr_cm(</div>
<div class="line"><span class="lineno">  501</span>            sys, argv=[code_path], path=[os.getcwd(), *sys.path]), \</div>
<div class="line"><span class="lineno">  502</span>            contextlib.redirect_stdout(StringIO()):</div>
<div class="line"><span class="lineno">  503</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  504</span>            <span class="keywordflow">if</span> ns <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  505</span>                ns = {}</div>
<div class="line"><span class="lineno">  506</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> ns:</div>
<div class="line"><span class="lineno">  507</span>                <span class="keywordflow">if</span> setup.config.plot_pre_code <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  508</span>                    exec(<span class="stringliteral">&#39;import numpy as np\n&#39;</span></div>
<div class="line"><span class="lineno">  509</span>                         <span class="stringliteral">&#39;from matplotlib import pyplot as plt\n&#39;</span>, ns)</div>
<div class="line"><span class="lineno">  510</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  511</span>                    exec(str(setup.config.plot_pre_code), ns)</div>
<div class="line"><span class="lineno">  512</span>            <span class="keywordflow">if</span> <span class="stringliteral">&quot;__main__&quot;</span> <span class="keywordflow">in</span> code:</div>
<div class="line"><span class="lineno">  513</span>                ns[<span class="stringliteral">&#39;__name__&#39;</span>] = <span class="stringliteral">&#39;__main__&#39;</span></div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>            <span class="comment"># Patch out non-interactive show() to avoid triggering a warning.</span></div>
<div class="line"><span class="lineno">  516</span>            <span class="keyword">with</span> cbook._setattr_cm(FigureManagerBase, show=<span class="keyword">lambda</span> self: <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  517</span>                exec(code, ns)</div>
<div class="line"><span class="lineno">  518</span>                <span class="keywordflow">if</span> function_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  519</span>                    exec(function_name + <span class="stringliteral">&quot;()&quot;</span>, ns)</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>        <span class="keywordflow">except</span> (Exception, SystemExit) <span class="keyword">as</span> err:</div>
<div class="line"><span class="lineno">  522</span>            <span class="keywordflow">raise</span> PlotError(traceback.format_exc()) <span class="keyword">from</span> err</div>
<div class="line"><span class="lineno">  523</span>        <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  524</span>            os.chdir(pwd)</div>
<div class="line"><span class="lineno">  525</span>    <span class="keywordflow">return</span> ns</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c5ecdc72e6d18e81d994b743fdd1c77" name="a6c5ecdc72e6d18e81d994b743fdd1c77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c5ecdc72e6d18e81d994b743fdd1c77">&#9670;&#160;</a></span>_split_code_at_show()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive._split_code_at_show </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Split code at plt.show().</pre> <div class="fragment"><div class="line"><span class="lineno">  339</span><span class="keyword">def </span>_split_code_at_show(text):</div>
<div class="line"><span class="lineno">  340</span>    <span class="stringliteral">&quot;&quot;&quot;Split code at plt.show().&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  341</span>    parts = []</div>
<div class="line"><span class="lineno">  342</span>    is_doctest = contains_doctest(text)</div>
<div class="line"><span class="lineno">  343</span>    part = []</div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">for</span> line <span class="keywordflow">in</span> text.split(<span class="stringliteral">&quot;\n&quot;</span>):</div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordflow">if</span> (<span class="keywordflow">not</span> is_doctest <span class="keywordflow">and</span> line.strip() == <span class="stringliteral">&#39;plt.show()&#39;</span>) <span class="keywordflow">or</span> \</div>
<div class="line"><span class="lineno">  346</span>               (is_doctest <span class="keywordflow">and</span> line.strip() == <span class="stringliteral">&#39;&gt;&gt;&gt; plt.show()&#39;</span>):</div>
<div class="line"><span class="lineno">  347</span>            part.append(line)</div>
<div class="line"><span class="lineno">  348</span>            parts.append(<span class="stringliteral">&quot;\n&quot;</span>.join(part))</div>
<div class="line"><span class="lineno">  349</span>            part = []</div>
<div class="line"><span class="lineno">  350</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  351</span>            part.append(line)</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;\n&quot;</span>.join(part).strip():</div>
<div class="line"><span class="lineno">  353</span>        parts.append(<span class="stringliteral">&quot;\n&quot;</span>.join(part))</div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">return</span> is_doctest, parts</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span><span class="comment"># -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  358</span><span class="comment"># Template</span></div>
<div class="line"><span class="lineno">  359</span><span class="comment"># -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  360</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af5739296eded76b077836ed59b1f62a2" name="af5739296eded76b077836ed59b1f62a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5739296eded76b077836ed59b1f62a2">&#9670;&#160;</a></span>clear_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.clear_state </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot_rcparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>close</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  528</span><span class="keyword">def </span>clear_state(plot_rcparams, close=True):</div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">if</span> close:</div>
<div class="line"><span class="lineno">  530</span>        plt.close(<span class="stringliteral">&#39;all&#39;</span>)</div>
<div class="line"><span class="lineno">  531</span>    <a class="code hl_function" href="namespacematplotlib.html#a569974b607ba74631c0e24ab2a2df708">matplotlib.rc_file_defaults</a>()</div>
<div class="line"><span class="lineno">  532</span>    matplotlib.rcParams.update(plot_rcparams)</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="ttc" id="anamespacematplotlib_html_a569974b607ba74631c0e24ab2a2df708"><div class="ttname"><a href="namespacematplotlib.html#a569974b607ba74631c0e24ab2a2df708">matplotlib.rc_file_defaults</a></div><div class="ttdeci">rc_file_defaults()</div><div class="ttdef"><b>Definition</b> __init__.py:1016</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a7a5d2a7c4a5b8812b507ed0028f2d2" name="a8a7a5d2a7c4a5b8812b507ed0028f2d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a7a5d2a7c4a5b8812b507ed0028f2d2">&#9670;&#160;</a></span>contains_doctest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.contains_doctest </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  301</span><span class="keyword">def </span>contains_doctest(text):</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  303</span>        <span class="comment"># check if it&#39;s valid Python as-is</span></div>
<div class="line"><span class="lineno">  304</span>        compile(text, <span class="stringliteral">&#39;&lt;string&gt;&#39;</span>, <span class="stringliteral">&#39;exec&#39;</span>)</div>
<div class="line"><span class="lineno">  305</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">except</span> SyntaxError:</div>
<div class="line"><span class="lineno">  307</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  308</span>    r = re.compile(<span class="stringliteral">r&#39;^\s*&gt;&gt;&gt;&#39;</span>, re.M)</div>
<div class="line"><span class="lineno">  309</span>    m = r.search(text)</div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">return</span> bool(m)</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span><span class="preprocessor">@_api.deprecated(&quot;3.5&quot;, alternative=&quot;doctest.script_from_examples&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbd6406670c452f8756093106dea8e6b" name="acbd6406670c452f8756093106dea8e6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbd6406670c452f8756093106dea8e6b">&#9670;&#160;</a></span>get_plot_formats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.get_plot_formats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  535</span><span class="keyword">def </span>get_plot_formats(config):</div>
<div class="line"><span class="lineno">  536</span>    default_dpi = {<span class="stringliteral">&#39;png&#39;</span>: 80, <span class="stringliteral">&#39;hires.png&#39;</span>: 200, <span class="stringliteral">&#39;pdf&#39;</span>: 200}</div>
<div class="line"><span class="lineno">  537</span>    formats = []</div>
<div class="line"><span class="lineno">  538</span>    plot_formats = config.plot_formats</div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordflow">for</span> fmt <span class="keywordflow">in</span> plot_formats:</div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">if</span> isinstance(fmt, str):</div>
<div class="line"><span class="lineno">  541</span>            <span class="keywordflow">if</span> <span class="stringliteral">&#39;:&#39;</span> <span class="keywordflow">in</span> fmt:</div>
<div class="line"><span class="lineno">  542</span>                suffix, dpi = fmt.split(<span class="stringliteral">&#39;:&#39;</span>)</div>
<div class="line"><span class="lineno">  543</span>                formats.append((str(suffix), int(dpi)))</div>
<div class="line"><span class="lineno">  544</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  545</span>                formats.append((fmt, default_dpi.get(fmt, 80)))</div>
<div class="line"><span class="lineno">  546</span>        <span class="keywordflow">elif</span> isinstance(fmt, (tuple, list)) <span class="keywordflow">and</span> len(fmt) == 2:</div>
<div class="line"><span class="lineno">  547</span>            formats.append((str(fmt[0]), int(fmt[1])))</div>
<div class="line"><span class="lineno">  548</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  549</span>            <span class="keywordflow">raise</span> PlotError(<span class="stringliteral">&#39;invalid image format &quot;%r&quot; in plot_formats&#39;</span> % fmt)</div>
<div class="line"><span class="lineno">  550</span>    <span class="keywordflow">return</span> formats</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b9482790125e8fef3881b03ae1b1e6b" name="a3b9482790125e8fef3881b03ae1b1e6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9482790125e8fef3881b03ae1b1e6b">&#9670;&#160;</a></span>mark_plot_labels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.mark_plot_labels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>document</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">To make plots referenceable, we need to move the reference from the
"htmlonly" (or "latexonly") node to the actual figure node itself.
</pre> <div class="fragment"><div class="line"><span class="lineno">  203</span><span class="keyword">def </span>mark_plot_labels(app, document):</div>
<div class="line"><span class="lineno">  204</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    To make plots referenceable, we need to move the reference from the</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    &quot;htmlonly&quot; (or &quot;latexonly&quot;) node to the actual figure node itself.</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">for</span> name, explicit <span class="keywordflow">in</span> document.nametypes.items():</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> explicit:</div>
<div class="line"><span class="lineno">  210</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  211</span>        labelid = document.nameids[name]</div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">if</span> labelid <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  213</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  214</span>        node = document.ids[labelid]</div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">if</span> node.tagname <span class="keywordflow">in</span> (<span class="stringliteral">&#39;html_only&#39;</span>, <span class="stringliteral">&#39;latex_only&#39;</span>):</div>
<div class="line"><span class="lineno">  216</span>            <span class="keywordflow">for</span> n <span class="keywordflow">in</span> node:</div>
<div class="line"><span class="lineno">  217</span>                <span class="keywordflow">if</span> n.tagname == <span class="stringliteral">&#39;figure&#39;</span>:</div>
<div class="line"><span class="lineno">  218</span>                    sectname = name</div>
<div class="line"><span class="lineno">  219</span>                    <span class="keywordflow">for</span> c <span class="keywordflow">in</span> n:</div>
<div class="line"><span class="lineno">  220</span>                        <span class="keywordflow">if</span> c.tagname == <span class="stringliteral">&#39;caption&#39;</span>:</div>
<div class="line"><span class="lineno">  221</span>                            sectname = c.astext()</div>
<div class="line"><span class="lineno">  222</span>                            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>                    node[<span class="stringliteral">&#39;ids&#39;</span>].remove(labelid)</div>
<div class="line"><span class="lineno">  225</span>                    node[<span class="stringliteral">&#39;names&#39;</span>].remove(name)</div>
<div class="line"><span class="lineno">  226</span>                    n[<span class="stringliteral">&#39;ids&#39;</span>].append(labelid)</div>
<div class="line"><span class="lineno">  227</span>                    n[<span class="stringliteral">&#39;names&#39;</span>].append(name)</div>
<div class="line"><span class="lineno">  228</span>                    document.settings.env.labels[name] = \</div>
<div class="line"><span class="lineno">  229</span>                        document.settings.env.docname, labelid, sectname</div>
<div class="line"><span class="lineno">  230</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af5bc9a74fe6742ca28cf577a0b7f1e6f" name="af5bc9a74fe6742ca28cf577a0b7f1e6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5bc9a74fe6742ca28cf577a0b7f1e6f">&#9670;&#160;</a></span>out_of_date()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.out_of_date </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>original</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>derived</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>includes</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return whether *derived* is out-of-date relative to *original* or any of
the RST files included in it using the RST include directive (*includes*).
*derived* and *original* are full paths, and *includes* is optionally a
list of full paths which may have been included in the *original*.
</pre> <div class="fragment"><div class="line"><span class="lineno">  440</span><span class="keyword">def </span>out_of_date(original, derived, includes=None):</div>
<div class="line"><span class="lineno">  441</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    Return whether *derived* is out-of-date relative to *original* or any of</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">    the RST files included in it using the RST include directive (*includes*).</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">    *derived* and *original* are full paths, and *includes* is optionally a</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">    list of full paths which may have been included in the *original*.</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.exists(derived):</div>
<div class="line"><span class="lineno">  448</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">if</span> includes <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  451</span>        includes = []</div>
<div class="line"><span class="lineno">  452</span>    files_to_check = [original, *includes]</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    <span class="keyword">def </span>out_of_date_one(original, derived_mtime):</div>
<div class="line"><span class="lineno">  455</span>        <span class="keywordflow">return</span> (os.path.exists(original) <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  456</span>                derived_mtime &lt; os.stat(original).st_mtime)</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    derived_mtime = os.stat(derived).st_mtime</div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordflow">return</span> any(out_of_date_one(f, derived_mtime) <span class="keywordflow">for</span> f <span class="keywordflow">in</span> files_to_check)</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af9a9fff1f305de0aff0a3c15b4401001" name="af9a9fff1f305de0aff0a3c15b4401001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9a9fff1f305de0aff0a3c15b4401001">&#9670;&#160;</a></span>render_figures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.render_figures </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>context_reset</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>close_figs</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code_includes</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Run a pyplot script and save the images in *output_dir*.

Save the images under *output_dir* with file names derived from
*output_base*
</pre> <div class="fragment"><div class="line"><span class="lineno">  556</span>                   code_includes=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  557</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">    Run a pyplot script and save the images in *output_dir*.</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">    Save the images under *output_dir* with file names derived from</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">    *output_base*</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  563</span>    formats = get_plot_formats(config)</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="comment"># Try to determine if all images already exist</span></div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>    is_doctest, code_pieces = _split_code_at_show(code)</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>    <span class="comment"># Look for single-figure output files first</span></div>
<div class="line"><span class="lineno">  570</span>    all_exists = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  571</span>    img = ImageFile(output_base, output_dir)</div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">for</span> format, dpi <span class="keywordflow">in</span> formats:</div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordflow">if</span> context <span class="keywordflow">or</span> out_of_date(code_path, img.filename(format),</div>
<div class="line"><span class="lineno">  574</span>                                  includes=code_includes):</div>
<div class="line"><span class="lineno">  575</span>            all_exists = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  576</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  577</span>        img.formats.append(format)</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    <span class="keywordflow">if</span> all_exists:</div>
<div class="line"><span class="lineno">  580</span>        <span class="keywordflow">return</span> [(code, [img])]</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>    <span class="comment"># Then look for multi-figure output files</span></div>
<div class="line"><span class="lineno">  583</span>    results = []</div>
<div class="line"><span class="lineno">  584</span>    all_exists = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordflow">for</span> i, code_piece <span class="keywordflow">in</span> enumerate(code_pieces):</div>
<div class="line"><span class="lineno">  586</span>        images = []</div>
<div class="line"><span class="lineno">  587</span>        <span class="keywordflow">for</span> j <span class="keywordflow">in</span> itertools.count():</div>
<div class="line"><span class="lineno">  588</span>            <span class="keywordflow">if</span> len(code_pieces) &gt; 1:</div>
<div class="line"><span class="lineno">  589</span>                img = ImageFile(<span class="stringliteral">&#39;%s_%02d_%02d&#39;</span> % (output_base, i, j),</div>
<div class="line"><span class="lineno">  590</span>                                output_dir)</div>
<div class="line"><span class="lineno">  591</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  592</span>                img = ImageFile(<span class="stringliteral">&#39;%s_%02d&#39;</span> % (output_base, j), output_dir)</div>
<div class="line"><span class="lineno">  593</span>            <span class="keywordflow">for</span> fmt, dpi <span class="keywordflow">in</span> formats:</div>
<div class="line"><span class="lineno">  594</span>                <span class="keywordflow">if</span> context <span class="keywordflow">or</span> out_of_date(code_path, img.filename(fmt),</div>
<div class="line"><span class="lineno">  595</span>                                          includes=code_includes):</div>
<div class="line"><span class="lineno">  596</span>                    all_exists = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  597</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  598</span>                img.formats.append(fmt)</div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>            <span class="comment"># assume that if we have one, we have them all</span></div>
<div class="line"><span class="lineno">  601</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> all_exists:</div>
<div class="line"><span class="lineno">  602</span>                all_exists = (j &gt; 0)</div>
<div class="line"><span class="lineno">  603</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  604</span>            images.append(img)</div>
<div class="line"><span class="lineno">  605</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> all_exists:</div>
<div class="line"><span class="lineno">  606</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  607</span>        results.append((code_piece, images))</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">if</span> all_exists:</div>
<div class="line"><span class="lineno">  610</span>        <span class="keywordflow">return</span> results</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>    <span class="comment"># We didn&#39;t find the files, so build them</span></div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>    results = []</div>
<div class="line"><span class="lineno">  615</span>    ns = plot_context <span class="keywordflow">if</span> context <span class="keywordflow">else</span> {}</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">if</span> context_reset:</div>
<div class="line"><span class="lineno">  618</span>        clear_state(config.plot_rcparams)</div>
<div class="line"><span class="lineno">  619</span>        plot_context.clear()</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    close_figs = <span class="keywordflow">not</span> context <span class="keywordflow">or</span> close_figs</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">for</span> i, code_piece <span class="keywordflow">in</span> enumerate(code_pieces):</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> context <span class="keywordflow">or</span> config.plot_apply_rcparams:</div>
<div class="line"><span class="lineno">  626</span>            clear_state(config.plot_rcparams, close_figs)</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordflow">elif</span> close_figs:</div>
<div class="line"><span class="lineno">  628</span>            plt.close(<span class="stringliteral">&#39;all&#39;</span>)</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>        _run_code(doctest.script_from_examples(code_piece) <span class="keywordflow">if</span> is_doctest</div>
<div class="line"><span class="lineno">  631</span>                  <span class="keywordflow">else</span> code_piece,</div>
<div class="line"><span class="lineno">  632</span>                  code_path, ns, function_name)</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>        images = []</div>
<div class="line"><span class="lineno">  635</span>        fig_managers = _pylab_helpers.Gcf.get_all_fig_managers()</div>
<div class="line"><span class="lineno">  636</span>        <span class="keywordflow">for</span> j, figman <span class="keywordflow">in</span> enumerate(fig_managers):</div>
<div class="line"><span class="lineno">  637</span>            <span class="keywordflow">if</span> len(fig_managers) == 1 <span class="keywordflow">and</span> len(code_pieces) == 1:</div>
<div class="line"><span class="lineno">  638</span>                img = ImageFile(output_base, output_dir)</div>
<div class="line"><span class="lineno">  639</span>            <span class="keywordflow">elif</span> len(code_pieces) == 1:</div>
<div class="line"><span class="lineno">  640</span>                img = ImageFile(<span class="stringliteral">&quot;%s_%02d&quot;</span> % (output_base, j), output_dir)</div>
<div class="line"><span class="lineno">  641</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  642</span>                img = ImageFile(<span class="stringliteral">&quot;%s_%02d_%02d&quot;</span> % (output_base, i, j),</div>
<div class="line"><span class="lineno">  643</span>                                output_dir)</div>
<div class="line"><span class="lineno">  644</span>            images.append(img)</div>
<div class="line"><span class="lineno">  645</span>            <span class="keywordflow">for</span> fmt, dpi <span class="keywordflow">in</span> formats:</div>
<div class="line"><span class="lineno">  646</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  647</span>                    figman.canvas.figure.savefig(img.filename(fmt), dpi=dpi)</div>
<div class="line"><span class="lineno">  648</span>                <span class="keywordflow">except</span> Exception <span class="keyword">as</span> err:</div>
<div class="line"><span class="lineno">  649</span>                    <span class="keywordflow">raise</span> PlotError(traceback.format_exc()) <span class="keyword">from</span> err</div>
<div class="line"><span class="lineno">  650</span>                img.formats.append(fmt)</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>        results.append((code_piece, images))</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> context <span class="keywordflow">or</span> config.plot_apply_rcparams:</div>
<div class="line"><span class="lineno">  655</span>        clear_state(config.plot_rcparams, close=<span class="keywordflow">not</span> context)</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    <span class="keywordflow">return</span> results</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4116737214fcb2f018ba0cbf09a8de3" name="ac4116737214fcb2f018ba0cbf09a8de3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4116737214fcb2f018ba0cbf09a8de3">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.run </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arguments</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>state_machine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lineno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  660</span><span class="keyword">def </span>run(arguments, content, options, state_machine, state, lineno):</div>
<div class="line"><span class="lineno">  661</span>    document = state_machine.document</div>
<div class="line"><span class="lineno">  662</span>    config = document.settings.env.config</div>
<div class="line"><span class="lineno">  663</span>    nofigs = <span class="stringliteral">&#39;nofigs&#39;</span> <span class="keywordflow">in</span> options</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>    formats = get_plot_formats(config)</div>
<div class="line"><span class="lineno">  666</span>    default_fmt = formats[0][0]</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    options.setdefault(<span class="stringliteral">&#39;include-source&#39;</span>, config.plot_include_source)</div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;class&#39;</span> <span class="keywordflow">in</span> options:</div>
<div class="line"><span class="lineno">  670</span>        <span class="comment"># classes are parsed into a list of string, and output by simply</span></div>
<div class="line"><span class="lineno">  671</span>        <span class="comment"># printing the list, abusing the fact that RST guarantees to strip</span></div>
<div class="line"><span class="lineno">  672</span>        <span class="comment"># non-conforming characters</span></div>
<div class="line"><span class="lineno">  673</span>        options[<span class="stringliteral">&#39;class&#39;</span>] = [<span class="stringliteral">&#39;plot-directive&#39;</span>] + options[<span class="stringliteral">&#39;class&#39;</span>]</div>
<div class="line"><span class="lineno">  674</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  675</span>        options.setdefault(<span class="stringliteral">&#39;class&#39;</span>, [<span class="stringliteral">&#39;plot-directive&#39;</span>])</div>
<div class="line"><span class="lineno">  676</span>    keep_context = <span class="stringliteral">&#39;context&#39;</span> <span class="keywordflow">in</span> options</div>
<div class="line"><span class="lineno">  677</span>    context_opt = <span class="keywordtype">None</span> <span class="keywordflow">if</span> <span class="keywordflow">not</span> keep_context <span class="keywordflow">else</span> options[<span class="stringliteral">&#39;context&#39;</span>]</div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span>    rst_file = document.attributes[<span class="stringliteral">&#39;source&#39;</span>]</div>
<div class="line"><span class="lineno">  680</span>    rst_dir = os.path.dirname(rst_file)</div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordflow">if</span> len(arguments):</div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> config.plot_basedir:</div>
<div class="line"><span class="lineno">  684</span>            source_file_name = os.path.join(setup.app.builder.srcdir,</div>
<div class="line"><span class="lineno">  685</span>                                            directives.uri(arguments[0]))</div>
<div class="line"><span class="lineno">  686</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  687</span>            source_file_name = os.path.join(setup.confdir, config.plot_basedir,</div>
<div class="line"><span class="lineno">  688</span>                                            directives.uri(arguments[0]))</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>        <span class="comment"># If there is content, it will be passed as a caption.</span></div>
<div class="line"><span class="lineno">  691</span>        caption = <span class="stringliteral">&#39;\n&#39;</span>.join(content)</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>        <span class="comment"># Enforce unambiguous use of captions.</span></div>
<div class="line"><span class="lineno">  694</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;caption&quot;</span> <span class="keywordflow">in</span> options:</div>
<div class="line"><span class="lineno">  695</span>            <span class="keywordflow">if</span> caption:</div>
<div class="line"><span class="lineno">  696</span>                <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  697</span>                    <span class="stringliteral">&#39;Caption specified in both content and options.&#39;</span></div>
<div class="line"><span class="lineno">  698</span>                    <span class="stringliteral">&#39; Please remove ambiguity.&#39;</span></div>
<div class="line"><span class="lineno">  699</span>                )</div>
<div class="line"><span class="lineno">  700</span>            <span class="comment"># Use caption option</span></div>
<div class="line"><span class="lineno">  701</span>            caption = options[<span class="stringliteral">&quot;caption&quot;</span>]</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span>        <span class="comment"># If the optional function name is provided, use it</span></div>
<div class="line"><span class="lineno">  704</span>        <span class="keywordflow">if</span> len(arguments) == 2:</div>
<div class="line"><span class="lineno">  705</span>            function_name = arguments[1]</div>
<div class="line"><span class="lineno">  706</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  707</span>            function_name = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>        code = Path(source_file_name).read_text(encoding=<span class="stringliteral">&#39;utf-8&#39;</span>)</div>
<div class="line"><span class="lineno">  710</span>        output_base = os.path.basename(source_file_name)</div>
<div class="line"><span class="lineno">  711</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  712</span>        source_file_name = rst_file</div>
<div class="line"><span class="lineno">  713</span>        code = textwrap.dedent(<span class="stringliteral">&quot;\n&quot;</span>.join(map(str, content)))</div>
<div class="line"><span class="lineno">  714</span>        counter = document.attributes.get(<span class="stringliteral">&#39;_plot_counter&#39;</span>, 0) + 1</div>
<div class="line"><span class="lineno">  715</span>        document.attributes[<span class="stringliteral">&#39;_plot_counter&#39;</span>] = counter</div>
<div class="line"><span class="lineno">  716</span>        base, ext = os.path.splitext(os.path.basename(source_file_name))</div>
<div class="line"><span class="lineno">  717</span>        output_base = <span class="stringliteral">&#39;%s-%d.py&#39;</span> % (base, counter)</div>
<div class="line"><span class="lineno">  718</span>        function_name = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  719</span>        caption = options.get(<span class="stringliteral">&#39;caption&#39;</span>, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>    base, source_ext = os.path.splitext(output_base)</div>
<div class="line"><span class="lineno">  722</span>    <span class="keywordflow">if</span> source_ext <span class="keywordflow">in</span> (<span class="stringliteral">&#39;.py&#39;</span>, <span class="stringliteral">&#39;.rst&#39;</span>, <span class="stringliteral">&#39;.txt&#39;</span>):</div>
<div class="line"><span class="lineno">  723</span>        output_base = base</div>
<div class="line"><span class="lineno">  724</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  725</span>        source_ext = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>    <span class="comment"># ensure that LaTeX includegraphics doesn&#39;t choke in foo.bar.pdf filenames</span></div>
<div class="line"><span class="lineno">  728</span>    output_base = output_base.replace(<span class="stringliteral">&#39;.&#39;</span>, <span class="stringliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>    <span class="comment"># is it in doctest format?</span></div>
<div class="line"><span class="lineno">  731</span>    is_doctest = contains_doctest(code)</div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;format&#39;</span> <span class="keywordflow">in</span> options:</div>
<div class="line"><span class="lineno">  733</span>        <span class="keywordflow">if</span> options[<span class="stringliteral">&#39;format&#39;</span>] == <span class="stringliteral">&#39;python&#39;</span>:</div>
<div class="line"><span class="lineno">  734</span>            is_doctest = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  735</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  736</span>            is_doctest = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>    <span class="comment"># determine output directory name fragment</span></div>
<div class="line"><span class="lineno">  739</span>    source_rel_name = relpath(source_file_name, setup.confdir)</div>
<div class="line"><span class="lineno">  740</span>    source_rel_dir = os.path.dirname(source_rel_name).lstrip(os.path.sep)</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>    <span class="comment"># build_dir: where to place output files (temporarily)</span></div>
<div class="line"><span class="lineno">  743</span>    build_dir = os.path.join(os.path.dirname(setup.app.doctreedir),</div>
<div class="line"><span class="lineno">  744</span>                             <span class="stringliteral">&#39;plot_directive&#39;</span>,</div>
<div class="line"><span class="lineno">  745</span>                             source_rel_dir)</div>
<div class="line"><span class="lineno">  746</span>    <span class="comment"># get rid of .. in paths, also changes pathsep</span></div>
<div class="line"><span class="lineno">  747</span>    <span class="comment"># see note in Python docs for warning about symbolic links on Windows.</span></div>
<div class="line"><span class="lineno">  748</span>    <span class="comment"># need to compare source and dest paths at end</span></div>
<div class="line"><span class="lineno">  749</span>    build_dir = os.path.normpath(build_dir)</div>
<div class="line"><span class="lineno">  750</span>    os.makedirs(build_dir, exist_ok=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>    <span class="comment"># output_dir: final location in the builder&#39;s directory</span></div>
<div class="line"><span class="lineno">  753</span>    dest_dir = os.path.abspath(os.path.join(setup.app.builder.outdir,</div>
<div class="line"><span class="lineno">  754</span>                                            source_rel_dir))</div>
<div class="line"><span class="lineno">  755</span>    os.makedirs(dest_dir, exist_ok=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>    <span class="comment"># how to link to files from the RST file</span></div>
<div class="line"><span class="lineno">  758</span>    dest_dir_link = os.path.join(relpath(setup.confdir, rst_dir),</div>
<div class="line"><span class="lineno">  759</span>                                 source_rel_dir).replace(os.path.sep, <span class="stringliteral">&#39;/&#39;</span>)</div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  761</span>        build_dir_link = relpath(build_dir, rst_dir).replace(os.path.sep, <span class="stringliteral">&#39;/&#39;</span>)</div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  763</span>        <span class="comment"># on Windows, relpath raises ValueError when path and start are on</span></div>
<div class="line"><span class="lineno">  764</span>        <span class="comment"># different mounts/drives</span></div>
<div class="line"><span class="lineno">  765</span>        build_dir_link = build_dir</div>
<div class="line"><span class="lineno">  766</span>    source_link = dest_dir_link + <span class="stringliteral">&#39;/&#39;</span> + output_base + source_ext</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>    <span class="comment"># get list of included rst files so that the output is updated when any</span></div>
<div class="line"><span class="lineno">  769</span>    <span class="comment"># plots in the included files change. These attributes are modified by the</span></div>
<div class="line"><span class="lineno">  770</span>    <span class="comment"># include directive (see the docutils.parsers.rst.directives.misc module).</span></div>
<div class="line"><span class="lineno">  771</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  772</span>        source_file_includes = [os.path.join(os.getcwd(), t[0])</div>
<div class="line"><span class="lineno">  773</span>                                <span class="keywordflow">for</span> t <span class="keywordflow">in</span> state.document.include_log]</div>
<div class="line"><span class="lineno">  774</span>    <span class="keywordflow">except</span> AttributeError:</div>
<div class="line"><span class="lineno">  775</span>        <span class="comment"># the document.include_log attribute only exists in docutils &gt;=0.17,</span></div>
<div class="line"><span class="lineno">  776</span>        <span class="comment"># before that we need to inspect the state machine</span></div>
<div class="line"><span class="lineno">  777</span>        possible_sources = {os.path.join(setup.confdir, t[0])</div>
<div class="line"><span class="lineno">  778</span>                            <span class="keywordflow">for</span> t <span class="keywordflow">in</span> state_machine.input_lines.items}</div>
<div class="line"><span class="lineno">  779</span>        source_file_includes = [f <span class="keywordflow">for</span> f <span class="keywordflow">in</span> possible_sources</div>
<div class="line"><span class="lineno">  780</span>                                <span class="keywordflow">if</span> os.path.isfile(f)]</div>
<div class="line"><span class="lineno">  781</span>    <span class="comment"># remove the source file itself from the includes</span></div>
<div class="line"><span class="lineno">  782</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  783</span>        source_file_includes.remove(source_file_name)</div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  785</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    <span class="comment"># make figures</span></div>
<div class="line"><span class="lineno">  788</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  789</span>        results = render_figures(code,</div>
<div class="line"><span class="lineno">  790</span>                                 source_file_name,</div>
<div class="line"><span class="lineno">  791</span>                                 build_dir,</div>
<div class="line"><span class="lineno">  792</span>                                 output_base,</div>
<div class="line"><span class="lineno">  793</span>                                 keep_context,</div>
<div class="line"><span class="lineno">  794</span>                                 function_name,</div>
<div class="line"><span class="lineno">  795</span>                                 config,</div>
<div class="line"><span class="lineno">  796</span>                                 context_reset=context_opt == <span class="stringliteral">&#39;reset&#39;</span>,</div>
<div class="line"><span class="lineno">  797</span>                                 close_figs=context_opt == <span class="stringliteral">&#39;close-figs&#39;</span>,</div>
<div class="line"><span class="lineno">  798</span>                                 code_includes=source_file_includes)</div>
<div class="line"><span class="lineno">  799</span>        errors = []</div>
<div class="line"><span class="lineno">  800</span>    <span class="keywordflow">except</span> PlotError <span class="keyword">as</span> err:</div>
<div class="line"><span class="lineno">  801</span>        reporter = state.memo.reporter</div>
<div class="line"><span class="lineno">  802</span>        sm = reporter.system_message(</div>
<div class="line"><span class="lineno">  803</span>            2, <span class="stringliteral">&quot;Exception occurred in plotting {}\n from {}:\n{}&quot;</span>.format(</div>
<div class="line"><span class="lineno">  804</span>                output_base, source_file_name, err),</div>
<div class="line"><span class="lineno">  805</span>            line=lineno)</div>
<div class="line"><span class="lineno">  806</span>        results = [(code, [])]</div>
<div class="line"><span class="lineno">  807</span>        errors = [sm]</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>    <span class="comment"># Properly indent the caption</span></div>
<div class="line"><span class="lineno">  810</span>    caption = <span class="stringliteral">&#39;\n&#39;</span> + <span class="stringliteral">&#39;\n&#39;</span>.join(<span class="stringliteral">&#39;      &#39;</span> + line.strip()</div>
<div class="line"><span class="lineno">  811</span>                               <span class="keywordflow">for</span> line <span class="keywordflow">in</span> caption.split(<span class="stringliteral">&#39;\n&#39;</span>))</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>    <span class="comment"># generate output restructuredtext</span></div>
<div class="line"><span class="lineno">  814</span>    total_lines = []</div>
<div class="line"><span class="lineno">  815</span>    <span class="keywordflow">for</span> j, (code_piece, images) <span class="keywordflow">in</span> enumerate(results):</div>
<div class="line"><span class="lineno">  816</span>        <span class="keywordflow">if</span> options[<span class="stringliteral">&#39;include-source&#39;</span>]:</div>
<div class="line"><span class="lineno">  817</span>            <span class="keywordflow">if</span> is_doctest:</div>
<div class="line"><span class="lineno">  818</span>                lines = [<span class="stringliteral">&#39;&#39;</span>, *code_piece.splitlines()]</div>
<div class="line"><span class="lineno">  819</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  820</span>                lines = [<span class="stringliteral">&#39;.. code-block:: python&#39;</span>, <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><span class="lineno">  821</span>                         *textwrap.indent(code_piece, <span class="stringliteral">&#39;    &#39;</span>).splitlines()]</div>
<div class="line"><span class="lineno">  822</span>            source_code = <span class="stringliteral">&quot;\n&quot;</span>.join(lines)</div>
<div class="line"><span class="lineno">  823</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  824</span>            source_code = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>        <span class="keywordflow">if</span> nofigs:</div>
<div class="line"><span class="lineno">  827</span>            images = []</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>        opts = [</div>
<div class="line"><span class="lineno">  830</span>            <span class="stringliteral">&#39;:%s: %s&#39;</span> % (key, val) <span class="keywordflow">for</span> key, val <span class="keywordflow">in</span> options.items()</div>
<div class="line"><span class="lineno">  831</span>            <span class="keywordflow">if</span> key <span class="keywordflow">in</span> (<span class="stringliteral">&#39;alt&#39;</span>, <span class="stringliteral">&#39;height&#39;</span>, <span class="stringliteral">&#39;width&#39;</span>, <span class="stringliteral">&#39;scale&#39;</span>, <span class="stringliteral">&#39;align&#39;</span>, <span class="stringliteral">&#39;class&#39;</span>)]</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>        <span class="comment"># Not-None src_link signals the need for a source link in the generated</span></div>
<div class="line"><span class="lineno">  834</span>        <span class="comment"># html</span></div>
<div class="line"><span class="lineno">  835</span>        <span class="keywordflow">if</span> j == 0 <span class="keywordflow">and</span> config.plot_html_show_source_link:</div>
<div class="line"><span class="lineno">  836</span>            src_link = source_link</div>
<div class="line"><span class="lineno">  837</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  838</span>            src_link = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>        result = <a class="code hl_class" href="classjinja2_1_1environment_1_1_template.html">jinja2.Template</a>(config.plot_template <span class="keywordflow">or</span> TEMPLATE).render(</div>
<div class="line"><span class="lineno">  841</span>            default_fmt=default_fmt,</div>
<div class="line"><span class="lineno">  842</span>            dest_dir=dest_dir_link,</div>
<div class="line"><span class="lineno">  843</span>            build_dir=build_dir_link,</div>
<div class="line"><span class="lineno">  844</span>            source_link=src_link,</div>
<div class="line"><span class="lineno">  845</span>            multi_image=len(images) &gt; 1,</div>
<div class="line"><span class="lineno">  846</span>            options=opts,</div>
<div class="line"><span class="lineno">  847</span>            images=images,</div>
<div class="line"><span class="lineno">  848</span>            source_code=source_code,</div>
<div class="line"><span class="lineno">  849</span>            html_show_formats=config.plot_html_show_formats <span class="keywordflow">and</span> len(images),</div>
<div class="line"><span class="lineno">  850</span>            caption=caption)</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>        total_lines.extend(result.split(<span class="stringliteral">&quot;\n&quot;</span>))</div>
<div class="line"><span class="lineno">  853</span>        total_lines.extend(<span class="stringliteral">&quot;\n&quot;</span>)</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    <span class="keywordflow">if</span> total_lines:</div>
<div class="line"><span class="lineno">  856</span>        state_machine.insert_input(total_lines, source=source_file_name)</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>    <span class="comment"># copy image files to builder&#39;s output directory, if necessary</span></div>
<div class="line"><span class="lineno">  859</span>    Path(dest_dir).mkdir(parents=<span class="keyword">True</span>, exist_ok=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>    <span class="keywordflow">for</span> code_piece, images <span class="keywordflow">in</span> results:</div>
<div class="line"><span class="lineno">  862</span>        <span class="keywordflow">for</span> img <span class="keywordflow">in</span> images:</div>
<div class="line"><span class="lineno">  863</span>            <span class="keywordflow">for</span> fn <span class="keywordflow">in</span> img.filenames():</div>
<div class="line"><span class="lineno">  864</span>                destimg = os.path.join(dest_dir, os.path.basename(fn))</div>
<div class="line"><span class="lineno">  865</span>                <span class="keywordflow">if</span> fn != destimg:</div>
<div class="line"><span class="lineno">  866</span>                    shutil.copyfile(fn, destimg)</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>    <span class="comment"># copy script (if necessary)</span></div>
<div class="line"><span class="lineno">  869</span>    <span class="keywordflow">if</span> config.plot_html_show_source_link:</div>
<div class="line"><span class="lineno">  870</span>        Path(dest_dir, output_base + source_ext).write_text(</div>
<div class="line"><span class="lineno">  871</span>            doctest.script_from_examples(code)</div>
<div class="line"><span class="lineno">  872</span>            <span class="keywordflow">if</span> source_file_name == rst_file <span class="keywordflow">and</span> is_doctest</div>
<div class="line"><span class="lineno">  873</span>            <span class="keywordflow">else</span> code,</div>
<div class="line"><span class="lineno">  874</span>            encoding=<span class="stringliteral">&#39;utf-8&#39;</span>)</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>    <span class="keywordflow">return</span> errors</div>
<div class="ttc" id="aclassjinja2_1_1environment_1_1_template_html"><div class="ttname"><a href="classjinja2_1_1environment_1_1_template.html">jinja2.environment.Template</a></div><div class="ttdef"><b>Definition</b> environment.py:1130</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b415f218f38dc6119776450faf527fc" name="a3b415f218f38dc6119776450faf527fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b415f218f38dc6119776450faf527fc">&#9670;&#160;</a></span>run_code()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.run_code </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ns</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function_name</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Import a Python module from a path, and run the function given by
name, if function_name is not None.
</pre> <div class="fragment"><div class="line"><span class="lineno">  467</span><span class="keyword">def </span>run_code(code, code_path, ns=None, function_name=None):</div>
<div class="line"><span class="lineno">  468</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">    Import a Python module from a path, and run the function given by</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral">    name, if function_name is not None.</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  472</span>    _run_code(unescape_doctest(code), code_path, ns, function_name)</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abac2ace4b138439b159c6e70ae6b29ce" name="abac2ace4b138439b159c6e70ae6b29ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abac2ace4b138439b159c6e70ae6b29ce">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.setup </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>app</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  273</span><span class="keyword">def </span><a class="code hl_namespace" href="namespacesetup.html">setup</a>(app):</div>
<div class="line"><span class="lineno">  274</span>    setup.app = app</div>
<div class="line"><span class="lineno">  275</span>    setup.config = app.config</div>
<div class="line"><span class="lineno">  276</span>    setup.confdir = app.confdir</div>
<div class="line"><span class="lineno">  277</span>    app.add_directive(<span class="stringliteral">&#39;plot&#39;</span>, PlotDirective)</div>
<div class="line"><span class="lineno">  278</span>    app.add_config_value(<span class="stringliteral">&#39;plot_pre_code&#39;</span>, <span class="keywordtype">None</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  279</span>    app.add_config_value(<span class="stringliteral">&#39;plot_include_source&#39;</span>, <span class="keyword">False</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  280</span>    app.add_config_value(<span class="stringliteral">&#39;plot_html_show_source_link&#39;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  281</span>    app.add_config_value(<span class="stringliteral">&#39;plot_formats&#39;</span>, [<span class="stringliteral">&#39;png&#39;</span>, <span class="stringliteral">&#39;hires.png&#39;</span>, <span class="stringliteral">&#39;pdf&#39;</span>], <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  282</span>    app.add_config_value(<span class="stringliteral">&#39;plot_basedir&#39;</span>, <span class="keywordtype">None</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  283</span>    app.add_config_value(<span class="stringliteral">&#39;plot_html_show_formats&#39;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  284</span>    app.add_config_value(<span class="stringliteral">&#39;plot_rcparams&#39;</span>, {}, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  285</span>    app.add_config_value(<span class="stringliteral">&#39;plot_apply_rcparams&#39;</span>, <span class="keyword">False</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  286</span>    app.add_config_value(<span class="stringliteral">&#39;plot_working_directory&#39;</span>, <span class="keywordtype">None</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  287</span>    app.add_config_value(<span class="stringliteral">&#39;plot_template&#39;</span>, <span class="keywordtype">None</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  288</span>    app.connect(<span class="stringliteral">&#39;doctree-read&#39;</span>, mark_plot_labels)</div>
<div class="line"><span class="lineno">  289</span>    app.add_css_file(<span class="stringliteral">&#39;plot_directive.css&#39;</span>)</div>
<div class="line"><span class="lineno">  290</span>    app.connect(<span class="stringliteral">&#39;build-finished&#39;</span>, _copy_css_file)</div>
<div class="line"><span class="lineno">  291</span>    metadata = {<span class="stringliteral">&#39;parallel_read_safe&#39;</span>: <span class="keyword">True</span>, <span class="stringliteral">&#39;parallel_write_safe&#39;</span>: <span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  292</span>                <span class="stringliteral">&#39;version&#39;</span>: matplotlib.__version__}</div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">return</span> metadata</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span><span class="comment"># -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  297</span><span class="comment"># Doctest handling</span></div>
<div class="line"><span class="lineno">  298</span><span class="comment"># -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="ttc" id="anamespacesetup_html"><div class="ttname"><a href="namespacesetup.html">setup</a></div><div class="ttdef"><b>Definition</b> setup.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a626626b4703335b962075cc51ae4f888" name="a626626b4703335b962075cc51ae4f888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a626626b4703335b962075cc51ae4f888">&#9670;&#160;</a></span>split_code_at_show()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.split_code_at_show </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Split code at plt.show().</pre> <div class="fragment"><div class="line"><span class="lineno">  334</span><span class="keyword">def </span>split_code_at_show(text):</div>
<div class="line"><span class="lineno">  335</span>    <span class="stringliteral">&quot;&quot;&quot;Split code at plt.show().&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">return</span> _split_code_at_show(text)[1]</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a605b931a33f4f5fe1eaecbe7cc4cb54b" name="a605b931a33f4f5fe1eaecbe7cc4cb54b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a605b931a33f4f5fe1eaecbe7cc4cb54b">&#9670;&#160;</a></span>unescape_doctest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.unescape_doctest </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Extract code from a piece of text, which contains either Python code
or doctests.
</pre> <div class="fragment"><div class="line"><span class="lineno">  314</span><span class="keyword">def </span>unescape_doctest(text):</div>
<div class="line"><span class="lineno">  315</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    Extract code from a piece of text, which contains either Python code</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">    or doctests.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> contains_doctest(text):</div>
<div class="line"><span class="lineno">  320</span>        <span class="keywordflow">return</span> text</div>
<div class="line"><span class="lineno">  321</span>    code = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordflow">for</span> line <span class="keywordflow">in</span> text.split(<span class="stringliteral">&quot;\n&quot;</span>):</div>
<div class="line"><span class="lineno">  323</span>        m = re.match(<span class="stringliteral">r&#39;^\s*(&gt;&gt;&gt;|\.\.\.) (.*)$&#39;</span>, line)</div>
<div class="line"><span class="lineno">  324</span>        <span class="keywordflow">if</span> m:</div>
<div class="line"><span class="lineno">  325</span>            code += m.group(2) + <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="lineno">  326</span>        <span class="keywordflow">elif</span> line.strip():</div>
<div class="line"><span class="lineno">  327</span>            code += <span class="stringliteral">&quot;# &quot;</span> + line.strip() + <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="lineno">  328</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  329</span>            code += <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">return</span> code</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span><span class="preprocessor">@_api.deprecated(&quot;3.5&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aff99610126e8d2d5990ba60cee3af115" name="aff99610126e8d2d5990ba60cee3af115"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff99610126e8d2d5990ba60cee3af115">&#9670;&#160;</a></span>exception_template</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str matplotlib.sphinxext.plot_directive.exception_template</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">    2</span><span class="stringliteral">.. only:: html</span></div>
<div class="line"><span class="lineno">    3</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">    4</span><span class="stringliteral">   [`source code &lt;%(linkdir)s/%(basename)s.py&gt;`__]</span></div>
<div class="line"><span class="lineno">    5</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">    6</span><span class="stringliteral">Exception occurred rendering plot.</span></div>
<div class="line"><span class="lineno">    7</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">    8</span><span class="stringliteral">&quot;&quot;&quot;</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab583bdd2816385c48c3a5427630c2689" name="ab583bdd2816385c48c3a5427630c2689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab583bdd2816385c48c3a5427630c2689">&#9670;&#160;</a></span>plot_context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib.sphinxext.plot_directive.plot_context = dict()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a29cfda34078bf530f231b4aba89ba25d" name="a29cfda34078bf530f231b4aba89ba25d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29cfda34078bf530f231b4aba89ba25d">&#9670;&#160;</a></span>TEMPLATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str matplotlib.sphinxext.plot_directive.TEMPLATE</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
