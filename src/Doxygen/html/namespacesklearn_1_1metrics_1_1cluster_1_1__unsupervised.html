<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.metrics.cluster._unsupervised Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1metrics.html">metrics</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1metrics_1_1cluster.html">cluster</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1metrics_1_1cluster_1_1__unsupervised.html">_unsupervised</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.metrics.cluster._unsupervised Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab79971822448187f2d2d3c86eb433c60" id="r_ab79971822448187f2d2d3c86eb433c60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1cluster_1_1__unsupervised.html#ab79971822448187f2d2d3c86eb433c60">check_number_of_labels</a> (n_labels, n_samples)</td></tr>
<tr class="separator:ab79971822448187f2d2d3c86eb433c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a189f7594b3252d20e4cbd6db7d125add" id="r_a189f7594b3252d20e4cbd6db7d125add"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1cluster_1_1__unsupervised.html#a189f7594b3252d20e4cbd6db7d125add">silhouette_score</a> (X, labels, *metric=&quot;euclidean&quot;, sample_size=None, random_state=None, **kwds)</td></tr>
<tr class="separator:a189f7594b3252d20e4cbd6db7d125add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e033b7362c9d954ab9fb4904d74d07b" id="r_a7e033b7362c9d954ab9fb4904d74d07b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1cluster_1_1__unsupervised.html#a7e033b7362c9d954ab9fb4904d74d07b">_silhouette_reduce</a> (D_chunk, start, labels, label_freqs)</td></tr>
<tr class="separator:a7e033b7362c9d954ab9fb4904d74d07b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1ad799dfdd563aa62ce30c9a963cf1" id="r_a4c1ad799dfdd563aa62ce30c9a963cf1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1cluster_1_1__unsupervised.html#a4c1ad799dfdd563aa62ce30c9a963cf1">silhouette_samples</a> (X, labels, *metric=&quot;euclidean&quot;, **kwds)</td></tr>
<tr class="separator:a4c1ad799dfdd563aa62ce30c9a963cf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0fd3112bd022113f3d310d65136e62c" id="r_ad0fd3112bd022113f3d310d65136e62c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1cluster_1_1__unsupervised.html#ad0fd3112bd022113f3d310d65136e62c">calinski_harabasz_score</a> (X, labels)</td></tr>
<tr class="separator:ad0fd3112bd022113f3d310d65136e62c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d120bdf4d78a9e3b2c5bc675170aaff" id="r_a9d120bdf4d78a9e3b2c5bc675170aaff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1cluster_1_1__unsupervised.html#a9d120bdf4d78a9e3b2c5bc675170aaff">davies_bouldin_score</a> (X, labels)</td></tr>
<tr class="separator:a9d120bdf4d78a9e3b2c5bc675170aaff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Unsupervised evaluation metrics.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a7e033b7362c9d954ab9fb4904d74d07b" name="a7e033b7362c9d954ab9fb4904d74d07b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e033b7362c9d954ab9fb4904d74d07b">&#9670;&#160;</a></span>_silhouette_reduce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.cluster._unsupervised._silhouette_reduce </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>D_chunk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_freqs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Accumulate silhouette statistics for vertical chunk of X.

Parameters
----------
D_chunk : array-like of shape (n_chunk_samples, n_samples)
    Precomputed distances for a chunk.
start : int
    First index in the chunk.
labels : array-like of shape (n_samples,)
    Corresponding cluster labels, encoded as {0, ..., n_clusters-1}.
label_freqs : array-like
    Distribution of cluster labels in ``labels``.
</pre> <div class="fragment"><div class="line"><span class="lineno">  120</span><span class="keyword">def </span>_silhouette_reduce(D_chunk, start, labels, label_freqs):</div>
<div class="line"><span class="lineno">  121</span>    <span class="stringliteral">&quot;&quot;&quot;Accumulate silhouette statistics for vertical chunk of X.</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    D_chunk : array-like of shape (n_chunk_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">        Precomputed distances for a chunk.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    start : int</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">        First index in the chunk.</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    labels : array-like of shape (n_samples,)</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">        Corresponding cluster labels, encoded as {0, ..., n_clusters-1}.</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    label_freqs : array-like</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">        Distribution of cluster labels in ``labels``.</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="comment"># accumulate distances from each sample to each cluster</span></div>
<div class="line"><span class="lineno">  135</span>    clust_dists = np.zeros((len(D_chunk), len(label_freqs)), dtype=D_chunk.dtype)</div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(D_chunk)):</div>
<div class="line"><span class="lineno">  137</span>        clust_dists[i] += np.bincount(</div>
<div class="line"><span class="lineno">  138</span>            labels, weights=D_chunk[i], minlength=len(label_freqs)</div>
<div class="line"><span class="lineno">  139</span>        )</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    <span class="comment"># intra_index selects intra-cluster distances within clust_dists</span></div>
<div class="line"><span class="lineno">  142</span>    intra_index = (np.arange(len(D_chunk)), labels[start : start + len(D_chunk)])</div>
<div class="line"><span class="lineno">  143</span>    <span class="comment"># intra_clust_dists are averaged over cluster size outside this function</span></div>
<div class="line"><span class="lineno">  144</span>    intra_clust_dists = clust_dists[intra_index]</div>
<div class="line"><span class="lineno">  145</span>    <span class="comment"># of the remaining distances we normalise and extract the minimum</span></div>
<div class="line"><span class="lineno">  146</span>    clust_dists[intra_index] = np.inf</div>
<div class="line"><span class="lineno">  147</span>    clust_dists /= label_freqs</div>
<div class="line"><span class="lineno">  148</span>    inter_clust_dists = clust_dists.min(axis=1)</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">return</span> intra_clust_dists, inter_clust_dists</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0fd3112bd022113f3d310d65136e62c" name="ad0fd3112bd022113f3d310d65136e62c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0fd3112bd022113f3d310d65136e62c">&#9670;&#160;</a></span>calinski_harabasz_score()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.cluster._unsupervised.calinski_harabasz_score </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the Calinski and Harabasz score.

It is also known as the Variance Ratio Criterion.

The score is defined as ratio of the sum of between-cluster dispersion and
of within-cluster dispersion.

Read more in the :ref:`User Guide &lt;calinski_harabasz_index&gt;`.

Parameters
----------
X : array-like of shape (n_samples, n_features)
    A list of ``n_features``-dimensional data points. Each row corresponds
    to a single data point.

labels : array-like of shape (n_samples,)
    Predicted labels for each sample.

Returns
-------
score : float
    The resulting Calinski-Harabasz score.

References
----------
.. [1] `T. Calinski and J. Harabasz, 1974. "A dendrite method for cluster
   analysis". Communications in Statistics
   &lt;https://www.tandfonline.com/doi/abs/10.1080/03610927408827101&gt;`_
</pre> <div class="fragment"><div class="line"><span class="lineno">  253</span><span class="keyword">def </span>calinski_harabasz_score(X, labels):</div>
<div class="line"><span class="lineno">  254</span>    <span class="stringliteral">&quot;&quot;&quot;Compute the Calinski and Harabasz score.</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    It is also known as the Variance Ratio Criterion.</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">    The score is defined as ratio of the sum of between-cluster dispersion and</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">    of within-cluster dispersion.</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    Read more in the :ref:`User Guide &lt;calinski_harabasz_index&gt;`.</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    X : array-like of shape (n_samples, n_features)</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">        A list of ``n_features``-dimensional data points. Each row corresponds</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">        to a single data point.</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    labels : array-like of shape (n_samples,)</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">        Predicted labels for each sample.</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    score : float</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">        The resulting Calinski-Harabasz score.</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">    .. [1] `T. Calinski and J. Harabasz, 1974. &quot;A dendrite method for cluster</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">       analysis&quot;. Communications in Statistics</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">       &lt;https://www.tandfonline.com/doi/abs/10.1080/03610927408827101&gt;`_</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  283</span>    X, labels = check_X_y(X, labels)</div>
<div class="line"><span class="lineno">  284</span>    le = LabelEncoder()</div>
<div class="line"><span class="lineno">  285</span>    labels = le.fit_transform(labels)</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>    n_samples, _ = X.shape</div>
<div class="line"><span class="lineno">  288</span>    n_labels = len(le.classes_)</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    check_number_of_labels(n_labels, n_samples)</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>    extra_disp, intra_disp = 0.0, 0.0</div>
<div class="line"><span class="lineno">  293</span>    mean = np.mean(X, axis=0)</div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(n_labels):</div>
<div class="line"><span class="lineno">  295</span>        cluster_k = X[labels == k]</div>
<div class="line"><span class="lineno">  296</span>        mean_k = np.mean(cluster_k, axis=0)</div>
<div class="line"><span class="lineno">  297</span>        extra_disp += len(cluster_k) * np.sum((mean_k - mean) ** 2)</div>
<div class="line"><span class="lineno">  298</span>        intra_disp += np.sum((cluster_k - mean_k) ** 2)</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  301</span>        1.0</div>
<div class="line"><span class="lineno">  302</span>        <span class="keywordflow">if</span> intra_disp == 0.0</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">else</span> extra_disp * (n_samples - n_labels) / (intra_disp * (n_labels - 1.0))</div>
<div class="line"><span class="lineno">  304</span>    )</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab79971822448187f2d2d3c86eb433c60" name="ab79971822448187f2d2d3c86eb433c60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab79971822448187f2d2d3c86eb433c60">&#9670;&#160;</a></span>check_number_of_labels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.cluster._unsupervised.check_number_of_labels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_samples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that number of labels are valid.

Parameters
----------
n_labels : int
    Number of labels.

n_samples : int
    Number of samples.
</pre> <div class="fragment"><div class="line"><span class="lineno">   21</span><span class="keyword">def </span>check_number_of_labels(n_labels, n_samples):</div>
<div class="line"><span class="lineno">   22</span>    <span class="stringliteral">&quot;&quot;&quot;Check that number of labels are valid.</span></div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   24</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   25</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral">    n_labels : int</span></div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">        Number of labels.</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">    n_samples : int</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">        Number of samples.</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   32</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> 1 &lt; n_labels &lt; n_samples:</div>
<div class="line"><span class="lineno">   33</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">   34</span>            <span class="stringliteral">&quot;Number of labels is %d. Valid values are 2 to n_samples - 1 (inclusive)&quot;</span></div>
<div class="line"><span class="lineno">   35</span>            % n_labels</div>
<div class="line"><span class="lineno">   36</span>        )</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d120bdf4d78a9e3b2c5bc675170aaff" name="a9d120bdf4d78a9e3b2c5bc675170aaff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d120bdf4d78a9e3b2c5bc675170aaff">&#9670;&#160;</a></span>davies_bouldin_score()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.cluster._unsupervised.davies_bouldin_score </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the Davies-Bouldin score.

The score is defined as the average similarity measure of each cluster with
its most similar cluster, where similarity is the ratio of within-cluster
distances to between-cluster distances. Thus, clusters which are farther
apart and less dispersed will result in a better score.

The minimum score is zero, with lower values indicating better clustering.

Read more in the :ref:`User Guide &lt;davies-bouldin_index&gt;`.

.. versionadded:: 0.20

Parameters
----------
X : array-like of shape (n_samples, n_features)
    A list of ``n_features``-dimensional data points. Each row corresponds
    to a single data point.

labels : array-like of shape (n_samples,)
    Predicted labels for each sample.

Returns
-------
score: float
    The resulting Davies-Bouldin score.

References
----------
.. [1] Davies, David L.; Bouldin, Donald W. (1979).
   `"A Cluster Separation Measure"
   &lt;https://ieeexplore.ieee.org/document/4766909&gt;`__.
   IEEE Transactions on Pattern Analysis and Machine Intelligence.
   PAMI-1 (2): 224-227
</pre> <div class="fragment"><div class="line"><span class="lineno">  307</span><span class="keyword">def </span>davies_bouldin_score(X, labels):</div>
<div class="line"><span class="lineno">  308</span>    <span class="stringliteral">&quot;&quot;&quot;Compute the Davies-Bouldin score.</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    The score is defined as the average similarity measure of each cluster with</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">    its most similar cluster, where similarity is the ratio of within-cluster</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">    distances to between-cluster distances. Thus, clusters which are farther</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">    apart and less dispersed will result in a better score.</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">    The minimum score is zero, with lower values indicating better clustering.</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">    Read more in the :ref:`User Guide &lt;davies-bouldin_index&gt;`.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    .. versionadded:: 0.20</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    X : array-like of shape (n_samples, n_features)</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        A list of ``n_features``-dimensional data points. Each row corresponds</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">        to a single data point.</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">    labels : array-like of shape (n_samples,)</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">        Predicted labels for each sample.</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    score: float</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">        The resulting Davies-Bouldin score.</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    .. [1] Davies, David L.; Bouldin, Donald W. (1979).</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">       `&quot;A Cluster Separation Measure&quot;</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">       &lt;https://ieeexplore.ieee.org/document/4766909&gt;`__.</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">       IEEE Transactions on Pattern Analysis and Machine Intelligence.</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">       PAMI-1 (2): 224-227</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  343</span>    X, labels = check_X_y(X, labels)</div>
<div class="line"><span class="lineno">  344</span>    le = LabelEncoder()</div>
<div class="line"><span class="lineno">  345</span>    labels = le.fit_transform(labels)</div>
<div class="line"><span class="lineno">  346</span>    n_samples, _ = X.shape</div>
<div class="line"><span class="lineno">  347</span>    n_labels = len(le.classes_)</div>
<div class="line"><span class="lineno">  348</span>    check_number_of_labels(n_labels, n_samples)</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>    intra_dists = np.zeros(n_labels)</div>
<div class="line"><span class="lineno">  351</span>    centroids = np.zeros((n_labels, len(X[0])), dtype=float)</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(n_labels):</div>
<div class="line"><span class="lineno">  353</span>        cluster_k = _safe_indexing(X, labels == k)</div>
<div class="line"><span class="lineno">  354</span>        centroid = cluster_k.mean(axis=0)</div>
<div class="line"><span class="lineno">  355</span>        centroids[k] = centroid</div>
<div class="line"><span class="lineno">  356</span>        intra_dists[k] = np.average(pairwise_distances(cluster_k, [centroid]))</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    centroid_distances = pairwise_distances(centroids)</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">if</span> np.allclose(intra_dists, 0) <span class="keywordflow">or</span> np.allclose(centroid_distances, 0):</div>
<div class="line"><span class="lineno">  361</span>        <span class="keywordflow">return</span> 0.0</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    centroid_distances[centroid_distances == 0] = np.inf</div>
<div class="line"><span class="lineno">  364</span>    combined_intra_dists = intra_dists[:, <span class="keywordtype">None</span>] + intra_dists</div>
<div class="line"><span class="lineno">  365</span>    scores = np.max(combined_intra_dists / centroid_distances, axis=1)</div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">return</span> np.mean(scores)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c1ad799dfdd563aa62ce30c9a963cf1" name="a4c1ad799dfdd563aa62ce30c9a963cf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c1ad799dfdd563aa62ce30c9a963cf1">&#9670;&#160;</a></span>silhouette_samples()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.cluster._unsupervised.silhouette_samples </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>metric</em> = <code>&quot;euclidean&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the Silhouette Coefficient for each sample.

The Silhouette Coefficient is a measure of how well samples are clustered
with samples that are similar to themselves. Clustering models with a high
Silhouette Coefficient are said to be dense, where samples in the same
cluster are similar to each other, and well separated, where samples in
different clusters are not very similar to each other.

The Silhouette Coefficient is calculated using the mean intra-cluster
distance (``a``) and the mean nearest-cluster distance (``b``) for each
sample.  The Silhouette Coefficient for a sample is ``(b - a) / max(a,
b)``.
Note that Silhouette Coefficient is only defined if number of labels
is 2 ``&lt;= n_labels &lt;= n_samples - 1``.

This function returns the Silhouette Coefficient for each sample.

The best value is 1 and the worst value is -1. Values near 0 indicate
overlapping clusters.

Read more in the :ref:`User Guide &lt;silhouette_coefficient&gt;`.

Parameters
----------
X : array-like of shape (n_samples_a, n_samples_a) if metric == \
        "precomputed" or (n_samples_a, n_features) otherwise
    An array of pairwise distances between samples, or a feature array.

labels : array-like of shape (n_samples,)
    Label values for each sample.

metric : str or callable, default='euclidean'
    The metric to use when calculating distance between instances in a
    feature array. If metric is a string, it must be one of the options
    allowed by :func:`sklearn.metrics.pairwise.pairwise_distances`.
    If ``X`` is the distance array itself, use "precomputed" as the metric.
    Precomputed distance matrices must have 0 along the diagonal.

**kwds : optional keyword parameters
    Any further parameters are passed directly to the distance function.
    If using a ``scipy.spatial.distance`` metric, the parameters are still
    metric dependent. See the scipy docs for usage examples.

Returns
-------
silhouette : array-like of shape (n_samples,)
    Silhouette Coefficients for each sample.

References
----------

.. [1] `Peter J. Rousseeuw (1987). "Silhouettes: a Graphical Aid to the
   Interpretation and Validation of Cluster Analysis". Computational
   and Applied Mathematics 20: 53-65.
   &lt;https://www.sciencedirect.com/science/article/pii/0377042787901257&gt;`_

.. [2] `Wikipedia entry on the Silhouette Coefficient
   &lt;https://en.wikipedia.org/wiki/Silhouette_(clustering)&gt;`_
</pre> <div class="fragment"><div class="line"><span class="lineno">  152</span><span class="keyword">def </span>silhouette_samples(X, labels, *, metric=&quot;euclidean&quot;, **kwds):</div>
<div class="line"><span class="lineno">  153</span>    <span class="stringliteral">&quot;&quot;&quot;Compute the Silhouette Coefficient for each sample.</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">    The Silhouette Coefficient is a measure of how well samples are clustered</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    with samples that are similar to themselves. Clustering models with a high</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    Silhouette Coefficient are said to be dense, where samples in the same</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    cluster are similar to each other, and well separated, where samples in</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    different clusters are not very similar to each other.</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    The Silhouette Coefficient is calculated using the mean intra-cluster</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">    distance (``a``) and the mean nearest-cluster distance (``b``) for each</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    sample.  The Silhouette Coefficient for a sample is ``(b - a) / max(a,</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    b)``.</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">    Note that Silhouette Coefficient is only defined if number of labels</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">    is 2 ``&lt;= n_labels &lt;= n_samples - 1``.</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">    This function returns the Silhouette Coefficient for each sample.</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    The best value is 1 and the worst value is -1. Values near 0 indicate</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">    overlapping clusters.</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">    Read more in the :ref:`User Guide &lt;silhouette_coefficient&gt;`.</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">    X : array-like of shape (n_samples_a, n_samples_a) if metric == \</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">            &quot;precomputed&quot; or (n_samples_a, n_features) otherwise</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">        An array of pairwise distances between samples, or a feature array.</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">    labels : array-like of shape (n_samples,)</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">        Label values for each sample.</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    metric : str or callable, default=&#39;euclidean&#39;</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">        The metric to use when calculating distance between instances in a</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">        feature array. If metric is a string, it must be one of the options</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">        allowed by :func:`sklearn.metrics.pairwise.pairwise_distances`.</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">        If ``X`` is the distance array itself, use &quot;precomputed&quot; as the metric.</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">        Precomputed distance matrices must have 0 along the diagonal.</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    **kwds : optional keyword parameters</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">        Any further parameters are passed directly to the distance function.</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">        If using a ``scipy.spatial.distance`` metric, the parameters are still</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">        metric dependent. See the scipy docs for usage examples.</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    silhouette : array-like of shape (n_samples,)</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">        Silhouette Coefficients for each sample.</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    .. [1] `Peter J. Rousseeuw (1987). &quot;Silhouettes: a Graphical Aid to the</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">       Interpretation and Validation of Cluster Analysis&quot;. Computational</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">       and Applied Mathematics 20: 53-65.</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">       &lt;https://www.sciencedirect.com/science/article/pii/0377042787901257&gt;`_</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    .. [2] `Wikipedia entry on the Silhouette Coefficient</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">       &lt;https://en.wikipedia.org/wiki/Silhouette_(clustering)&gt;`_</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  212</span>    X, labels = check_X_y(X, labels, accept_sparse=[<span class="stringliteral">&quot;csc&quot;</span>, <span class="stringliteral">&quot;csr&quot;</span>])</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="comment"># Check for non-zero diagonal entries in precomputed distance matrix</span></div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">if</span> metric == <span class="stringliteral">&quot;precomputed&quot;</span>:</div>
<div class="line"><span class="lineno">  216</span>        error_msg = ValueError(</div>
<div class="line"><span class="lineno">  217</span>            <span class="stringliteral">&quot;The precomputed distance matrix contains non-zero &quot;</span></div>
<div class="line"><span class="lineno">  218</span>            <span class="stringliteral">&quot;elements on the diagonal. Use np.fill_diagonal(X, 0).&quot;</span></div>
<div class="line"><span class="lineno">  219</span>        )</div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">if</span> X.dtype.kind == <span class="stringliteral">&quot;f&quot;</span>:</div>
<div class="line"><span class="lineno">  221</span>            atol = np.finfo(X.dtype).eps * 100</div>
<div class="line"><span class="lineno">  222</span>            <span class="keywordflow">if</span> np.any(np.abs(np.diagonal(X)) &gt; atol):</div>
<div class="line"><span class="lineno">  223</span>                <span class="keywordflow">raise</span> ValueError(error_msg)</div>
<div class="line"><span class="lineno">  224</span>        <span class="keywordflow">elif</span> np.any(np.diagonal(X) != 0):  <span class="comment"># integral dtype</span></div>
<div class="line"><span class="lineno">  225</span>            <span class="keywordflow">raise</span> ValueError(error_msg)</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    le = LabelEncoder()</div>
<div class="line"><span class="lineno">  228</span>    labels = le.fit_transform(labels)</div>
<div class="line"><span class="lineno">  229</span>    n_samples = len(labels)</div>
<div class="line"><span class="lineno">  230</span>    label_freqs = np.bincount(labels)</div>
<div class="line"><span class="lineno">  231</span>    check_number_of_labels(len(le.classes_), n_samples)</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>    kwds[<span class="stringliteral">&quot;metric&quot;</span>] = metric</div>
<div class="line"><span class="lineno">  234</span>    reduce_func = functools.partial(</div>
<div class="line"><span class="lineno">  235</span>        _silhouette_reduce, labels=labels, label_freqs=label_freqs</div>
<div class="line"><span class="lineno">  236</span>    )</div>
<div class="line"><span class="lineno">  237</span>    results = zip(*pairwise_distances_chunked(X, reduce_func=reduce_func, **kwds))</div>
<div class="line"><span class="lineno">  238</span>    intra_clust_dists, inter_clust_dists = results</div>
<div class="line"><span class="lineno">  239</span>    intra_clust_dists = np.concatenate(intra_clust_dists)</div>
<div class="line"><span class="lineno">  240</span>    inter_clust_dists = np.concatenate(inter_clust_dists)</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>    denom = (label_freqs - 1).take(labels, mode=<span class="stringliteral">&quot;clip&quot;</span>)</div>
<div class="line"><span class="lineno">  243</span>    <span class="keyword">with</span> np.errstate(divide=<span class="stringliteral">&quot;ignore&quot;</span>, invalid=<span class="stringliteral">&quot;ignore&quot;</span>):</div>
<div class="line"><span class="lineno">  244</span>        intra_clust_dists /= denom</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    sil_samples = inter_clust_dists - intra_clust_dists</div>
<div class="line"><span class="lineno">  247</span>    <span class="keyword">with</span> np.errstate(divide=<span class="stringliteral">&quot;ignore&quot;</span>, invalid=<span class="stringliteral">&quot;ignore&quot;</span>):</div>
<div class="line"><span class="lineno">  248</span>        sil_samples /= np.maximum(intra_clust_dists, inter_clust_dists)</div>
<div class="line"><span class="lineno">  249</span>    <span class="comment"># nan values are for clusters of size 1, and should be 0</span></div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordflow">return</span> np.nan_to_num(sil_samples)</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a189f7594b3252d20e4cbd6db7d125add" name="a189f7594b3252d20e4cbd6db7d125add"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a189f7594b3252d20e4cbd6db7d125add">&#9670;&#160;</a></span>silhouette_score()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.cluster._unsupervised.silhouette_score </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>metric</em> = <code>&quot;euclidean&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sample_size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the mean Silhouette Coefficient of all samples.

The Silhouette Coefficient is calculated using the mean intra-cluster
distance (``a``) and the mean nearest-cluster distance (``b``) for each
sample.  The Silhouette Coefficient for a sample is ``(b - a) / max(a,
b)``.  To clarify, ``b`` is the distance between a sample and the nearest
cluster that the sample is not a part of.
Note that Silhouette Coefficient is only defined if number of labels
is ``2 &lt;= n_labels &lt;= n_samples - 1``.

This function returns the mean Silhouette Coefficient over all samples.
To obtain the values for each sample, use :func:`silhouette_samples`.

The best value is 1 and the worst value is -1. Values near 0 indicate
overlapping clusters. Negative values generally indicate that a sample has
been assigned to the wrong cluster, as a different cluster is more similar.

Read more in the :ref:`User Guide &lt;silhouette_coefficient&gt;`.

Parameters
----------
X : array-like of shape (n_samples_a, n_samples_a) if metric == \
        "precomputed" or (n_samples_a, n_features) otherwise
    An array of pairwise distances between samples, or a feature array.

labels : array-like of shape (n_samples,)
    Predicted labels for each sample.

metric : str or callable, default='euclidean'
    The metric to use when calculating distance between instances in a
    feature array. If metric is a string, it must be one of the options
    allowed by :func:`metrics.pairwise.pairwise_distances
    &lt;sklearn.metrics.pairwise.pairwise_distances&gt;`. If ``X`` is
    the distance array itself, use ``metric="precomputed"``.

sample_size : int, default=None
    The size of the sample to use when computing the Silhouette Coefficient
    on a random subset of the data.
    If ``sample_size is None``, no sampling is used.

random_state : int, RandomState instance or None, default=None
    Determines random number generation for selecting a subset of samples.
    Used when ``sample_size is not None``.
    Pass an int for reproducible results across multiple function calls.
    See :term:`Glossary &lt;random_state&gt;`.

**kwds : optional keyword parameters
    Any further parameters are passed directly to the distance function.
    If using a scipy.spatial.distance metric, the parameters are still
    metric dependent. See the scipy docs for usage examples.

Returns
-------
silhouette : float
    Mean Silhouette Coefficient for all samples.

References
----------

.. [1] `Peter J. Rousseeuw (1987). "Silhouettes: a Graphical Aid to the
   Interpretation and Validation of Cluster Analysis". Computational
   and Applied Mathematics 20: 53-65.
   &lt;https://www.sciencedirect.com/science/article/pii/0377042787901257&gt;`_

.. [2] `Wikipedia entry on the Silhouette Coefficient
       &lt;https://en.wikipedia.org/wiki/Silhouette_(clustering)&gt;`_
</pre> <div class="fragment"><div class="line"><span class="lineno">   41</span>):</div>
<div class="line"><span class="lineno">   42</span>    <span class="stringliteral">&quot;&quot;&quot;Compute the mean Silhouette Coefficient of all samples.</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    The Silhouette Coefficient is calculated using the mean intra-cluster</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    distance (``a``) and the mean nearest-cluster distance (``b``) for each</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    sample.  The Silhouette Coefficient for a sample is ``(b - a) / max(a,</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">    b)``.  To clarify, ``b`` is the distance between a sample and the nearest</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    cluster that the sample is not a part of.</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    Note that Silhouette Coefficient is only defined if number of labels</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    is ``2 &lt;= n_labels &lt;= n_samples - 1``.</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    This function returns the mean Silhouette Coefficient over all samples.</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">    To obtain the values for each sample, use :func:`silhouette_samples`.</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    The best value is 1 and the worst value is -1. Values near 0 indicate</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    overlapping clusters. Negative values generally indicate that a sample has</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    been assigned to the wrong cluster, as a different cluster is more similar.</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">    Read more in the :ref:`User Guide &lt;silhouette_coefficient&gt;`.</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    X : array-like of shape (n_samples_a, n_samples_a) if metric == \</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">            &quot;precomputed&quot; or (n_samples_a, n_features) otherwise</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        An array of pairwise distances between samples, or a feature array.</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    labels : array-like of shape (n_samples,)</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        Predicted labels for each sample.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">    metric : str or callable, default=&#39;euclidean&#39;</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">        The metric to use when calculating distance between instances in a</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">        feature array. If metric is a string, it must be one of the options</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        allowed by :func:`metrics.pairwise.pairwise_distances</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        &lt;sklearn.metrics.pairwise.pairwise_distances&gt;`. If ``X`` is</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        the distance array itself, use ``metric=&quot;precomputed&quot;``.</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    sample_size : int, default=None</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        The size of the sample to use when computing the Silhouette Coefficient</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">        on a random subset of the data.</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">        If ``sample_size is None``, no sampling is used.</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    random_state : int, RandomState instance or None, default=None</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">        Determines random number generation for selecting a subset of samples.</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">        Used when ``sample_size is not None``.</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        Pass an int for reproducible results across multiple function calls.</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        See :term:`Glossary &lt;random_state&gt;`.</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    **kwds : optional keyword parameters</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">        Any further parameters are passed directly to the distance function.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">        If using a scipy.spatial.distance metric, the parameters are still</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">        metric dependent. See the scipy docs for usage examples.</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    silhouette : float</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">        Mean Silhouette Coefficient for all samples.</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    .. [1] `Peter J. Rousseeuw (1987). &quot;Silhouettes: a Graphical Aid to the</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">       Interpretation and Validation of Cluster Analysis&quot;. Computational</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">       and Applied Mathematics 20: 53-65.</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">       &lt;https://www.sciencedirect.com/science/article/pii/0377042787901257&gt;`_</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    .. [2] `Wikipedia entry on the Silhouette Coefficient</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">           &lt;https://en.wikipedia.org/wiki/Silhouette_(clustering)&gt;`_</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">if</span> sample_size <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  110</span>        X, labels = check_X_y(X, labels, accept_sparse=[<span class="stringliteral">&quot;csc&quot;</span>, <span class="stringliteral">&quot;csr&quot;</span>])</div>
<div class="line"><span class="lineno">  111</span>        random_state = check_random_state(random_state)</div>
<div class="line"><span class="lineno">  112</span>        indices = random_state.permutation(X.shape[0])[:sample_size]</div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">if</span> metric == <span class="stringliteral">&quot;precomputed&quot;</span>:</div>
<div class="line"><span class="lineno">  114</span>            X, labels = X[indices].T[indices].T, labels[indices]</div>
<div class="line"><span class="lineno">  115</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  116</span>            X, labels = X[indices], labels[indices]</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">return</span> np.mean(silhouette_samples(X, labels, metric=metric, **kwds))</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
