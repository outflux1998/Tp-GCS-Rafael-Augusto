<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.gaussian_process.tests.test_gpr Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1gaussian__process.html">gaussian_process</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html">test_gpr</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sklearn.gaussian_process.tests.test_gpr Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1gaussian__process_1_1tests_1_1test__gpr_1_1_custom_kernel.html">CustomKernel</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aea798e9cdb139aa10095346d92be15e4" id="r_aea798e9cdb139aa10095346d92be15e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#aea798e9cdb139aa10095346d92be15e4">f</a> (x)</td></tr>
<tr class="separator:aea798e9cdb139aa10095346d92be15e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5fa5e676a5eb22ec21ad318ff1232b8" id="r_ac5fa5e676a5eb22ec21ad318ff1232b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#ac5fa5e676a5eb22ec21ad318ff1232b8">test_gpr_interpolation</a> (kernel)</td></tr>
<tr class="separator:ac5fa5e676a5eb22ec21ad318ff1232b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e1010cc3a603f757284fa1426b76972" id="r_a8e1010cc3a603f757284fa1426b76972"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a8e1010cc3a603f757284fa1426b76972">test_gpr_interpolation_structured</a> ()</td></tr>
<tr class="separator:a8e1010cc3a603f757284fa1426b76972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05cfeefb2975f4d7bc52fd9beeb95708" id="r_a05cfeefb2975f4d7bc52fd9beeb95708"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a05cfeefb2975f4d7bc52fd9beeb95708">test_lml_improving</a> (kernel)</td></tr>
<tr class="separator:a05cfeefb2975f4d7bc52fd9beeb95708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc3b4cfdc11790390a451583de8395e" id="r_afbc3b4cfdc11790390a451583de8395e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#afbc3b4cfdc11790390a451583de8395e">test_lml_precomputed</a> (kernel)</td></tr>
<tr class="separator:afbc3b4cfdc11790390a451583de8395e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5536e800878ac77af7c3480fd087516f" id="r_a5536e800878ac77af7c3480fd087516f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a5536e800878ac77af7c3480fd087516f">test_lml_without_cloning_kernel</a> (kernel)</td></tr>
<tr class="separator:a5536e800878ac77af7c3480fd087516f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af8a6371c33b3c5d7c545e01a171c9c" id="r_a0af8a6371c33b3c5d7c545e01a171c9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a0af8a6371c33b3c5d7c545e01a171c9c">test_converged_to_local_maximum</a> (kernel)</td></tr>
<tr class="separator:a0af8a6371c33b3c5d7c545e01a171c9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dedea94090b339adccde62e328a6d79" id="r_a8dedea94090b339adccde62e328a6d79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a8dedea94090b339adccde62e328a6d79">test_solution_inside_bounds</a> (kernel)</td></tr>
<tr class="separator:a8dedea94090b339adccde62e328a6d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdefec02fe117b87cf0aa3eefece401d" id="r_abdefec02fe117b87cf0aa3eefece401d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#abdefec02fe117b87cf0aa3eefece401d">test_lml_gradient</a> (kernel)</td></tr>
<tr class="separator:abdefec02fe117b87cf0aa3eefece401d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0901f999dc4a5d62733d0ec3bb26eb04" id="r_a0901f999dc4a5d62733d0ec3bb26eb04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a0901f999dc4a5d62733d0ec3bb26eb04">test_prior</a> (kernel)</td></tr>
<tr class="separator:a0901f999dc4a5d62733d0ec3bb26eb04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5bc76f26e46ef13a5b0d6f17b16e9b8" id="r_ab5bc76f26e46ef13a5b0d6f17b16e9b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#ab5bc76f26e46ef13a5b0d6f17b16e9b8">test_sample_statistics</a> (kernel)</td></tr>
<tr class="separator:ab5bc76f26e46ef13a5b0d6f17b16e9b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e92e7ab8188f2386f2781abbdb07fc9" id="r_a1e92e7ab8188f2386f2781abbdb07fc9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a1e92e7ab8188f2386f2781abbdb07fc9">test_no_optimizer</a> ()</td></tr>
<tr class="separator:a1e92e7ab8188f2386f2781abbdb07fc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099f3263717aa51c54c7cb16ce5b647f" id="r_a099f3263717aa51c54c7cb16ce5b647f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a099f3263717aa51c54c7cb16ce5b647f">test_predict_cov_vs_std</a> (kernel, target)</td></tr>
<tr class="separator:a099f3263717aa51c54c7cb16ce5b647f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a370ad97ee489c5e12e523d3b417dd406" id="r_a370ad97ee489c5e12e523d3b417dd406"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a370ad97ee489c5e12e523d3b417dd406">test_anisotropic_kernel</a> ()</td></tr>
<tr class="separator:a370ad97ee489c5e12e523d3b417dd406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2030c63eb05eef71535f48d2380df1d" id="r_ae2030c63eb05eef71535f48d2380df1d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#ae2030c63eb05eef71535f48d2380df1d">test_random_starts</a> ()</td></tr>
<tr class="separator:ae2030c63eb05eef71535f48d2380df1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9be9f9fe6e4a869cb320a3913f3c0d0c" id="r_a9be9f9fe6e4a869cb320a3913f3c0d0c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a9be9f9fe6e4a869cb320a3913f3c0d0c">test_y_normalization</a> (kernel)</td></tr>
<tr class="separator:a9be9f9fe6e4a869cb320a3913f3c0d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4681addac50a3dd9331ed8a9da67d95" id="r_ab4681addac50a3dd9331ed8a9da67d95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#ab4681addac50a3dd9331ed8a9da67d95">test_large_variance_y</a> ()</td></tr>
<tr class="separator:ab4681addac50a3dd9331ed8a9da67d95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbaea028410f66dfa902324ecaaeda4b" id="r_acbaea028410f66dfa902324ecaaeda4b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#acbaea028410f66dfa902324ecaaeda4b">test_y_multioutput</a> ()</td></tr>
<tr class="separator:acbaea028410f66dfa902324ecaaeda4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a846ce068ae4650fda860bd6f1600bbcb" id="r_a846ce068ae4650fda860bd6f1600bbcb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a846ce068ae4650fda860bd6f1600bbcb">test_custom_optimizer</a> (kernel)</td></tr>
<tr class="separator:a846ce068ae4650fda860bd6f1600bbcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa19ac9e102e0fa01a0c4e5024504caed" id="r_aa19ac9e102e0fa01a0c4e5024504caed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#aa19ac9e102e0fa01a0c4e5024504caed">test_gpr_correct_error_message</a> ()</td></tr>
<tr class="separator:aa19ac9e102e0fa01a0c4e5024504caed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54d2f7307f85e36793e8cd5a79d0875f" id="r_a54d2f7307f85e36793e8cd5a79d0875f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a54d2f7307f85e36793e8cd5a79d0875f">test_duplicate_input</a> (kernel)</td></tr>
<tr class="separator:a54d2f7307f85e36793e8cd5a79d0875f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858805926f178b93e369a834c3563cf7" id="r_a858805926f178b93e369a834c3563cf7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a858805926f178b93e369a834c3563cf7">test_no_fit_default_predict</a> ()</td></tr>
<tr class="separator:a858805926f178b93e369a834c3563cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a165015fabc5e7e460b5cbc8b4ceb159f" id="r_a165015fabc5e7e460b5cbc8b4ceb159f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a165015fabc5e7e460b5cbc8b4ceb159f">test_warning_bounds</a> ()</td></tr>
<tr class="separator:a165015fabc5e7e460b5cbc8b4ceb159f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cebb62fad5e459dced44a55bd4e59cc" id="r_a6cebb62fad5e459dced44a55bd4e59cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a6cebb62fad5e459dced44a55bd4e59cc">test_bound_check_fixed_hyperparameter</a> ()</td></tr>
<tr class="separator:a6cebb62fad5e459dced44a55bd4e59cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3cb3dfc90509ff667bb8b5c4e1eaf22" id="r_ad3cb3dfc90509ff667bb8b5c4e1eaf22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#ad3cb3dfc90509ff667bb8b5c4e1eaf22">test_constant_target</a> (kernel)</td></tr>
<tr class="separator:ad3cb3dfc90509ff667bb8b5c4e1eaf22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9782fe89777b5ec032262a9fb9828517" id="r_a9782fe89777b5ec032262a9fb9828517"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a9782fe89777b5ec032262a9fb9828517">test_gpr_consistency_std_cov_non_invertible_kernel</a> ()</td></tr>
<tr class="separator:a9782fe89777b5ec032262a9fb9828517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf2494662f5400f1af3780a8363f33f0" id="r_abf2494662f5400f1af3780a8363f33f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#abf2494662f5400f1af3780a8363f33f0">test_gpr_fit_error</a> (params, TypeError, err_msg)</td></tr>
<tr class="separator:abf2494662f5400f1af3780a8363f33f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed0bd563eb469d22825f50ccbe1bce8e" id="r_aed0bd563eb469d22825f50ccbe1bce8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#aed0bd563eb469d22825f50ccbe1bce8e">test_gpr_lml_error</a> ()</td></tr>
<tr class="separator:aed0bd563eb469d22825f50ccbe1bce8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcd909bd1e9b40c17c28f8333741be31" id="r_abcd909bd1e9b40c17c28f8333741be31"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#abcd909bd1e9b40c17c28f8333741be31">test_gpr_predict_error</a> ()</td></tr>
<tr class="separator:abcd909bd1e9b40c17c28f8333741be31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed6be0d95651ce006d1207f97a0ff27" id="r_a9ed6be0d95651ce006d1207f97a0ff27"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a9ed6be0d95651ce006d1207f97a0ff27">test_predict_shapes</a> (normalize_y, n_targets)</td></tr>
<tr class="separator:a9ed6be0d95651ce006d1207f97a0ff27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac56866c51a19a89629f76cebf008437c" id="r_ac56866c51a19a89629f76cebf008437c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#ac56866c51a19a89629f76cebf008437c">test_sample_y_shapes</a> (normalize_y, n_targets)</td></tr>
<tr class="separator:ac56866c51a19a89629f76cebf008437c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89439fb11833dff1a0144535d99c0f3e" id="r_a89439fb11833dff1a0144535d99c0f3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a89439fb11833dff1a0144535d99c0f3e">test_gpr_predict_input_not_modified</a> ()</td></tr>
<tr class="separator:a89439fb11833dff1a0144535d99c0f3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acd3ccad36e064ee73b9a774544bb0d06" id="r_acd3ccad36e064ee73b9a774544bb0d06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#acd3ccad36e064ee73b9a774544bb0d06">X</a> = np.atleast_2d([1.0, 3.0, 5.0, 6.0, 7.0, 8.0]).T</td></tr>
<tr class="separator:acd3ccad36e064ee73b9a774544bb0d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a02f704ef94dc77781f434b8d5a9e0" id="r_ae5a02f704ef94dc77781f434b8d5a9e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#ae5a02f704ef94dc77781f434b8d5a9e0">X2</a> = np.atleast_2d([2.0, 4.0, 5.5, 6.5, 7.5]).T</td></tr>
<tr class="separator:ae5a02f704ef94dc77781f434b8d5a9e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f004c81fc145b4a1e8f583732795f91" id="r_a7f004c81fc145b4a1e8f583732795f91"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a7f004c81fc145b4a1e8f583732795f91">y</a> = <a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#aea798e9cdb139aa10095346d92be15e4">f</a>(<a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#acd3ccad36e064ee73b9a774544bb0d06">X</a>).ravel()</td></tr>
<tr class="separator:a7f004c81fc145b4a1e8f583732795f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bc3848e2435b17817e7d8f0db74f167" id="r_a7bc3848e2435b17817e7d8f0db74f167"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a7bc3848e2435b17817e7d8f0db74f167">fixed_kernel</a> = <a class="el" href="classsklearn_1_1gaussian__process_1_1kernels_1_1_r_b_f.html">RBF</a>(length_scale=1.0, length_scale_bounds=&quot;fixed&quot;)</td></tr>
<tr class="separator:a7bc3848e2435b17817e7d8f0db74f167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86cf4c8b235bc7f768a3651b7b5ffe0e" id="r_a86cf4c8b235bc7f768a3651b7b5ffe0e"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a86cf4c8b235bc7f768a3651b7b5ffe0e">kernels</a></td></tr>
<tr class="separator:a86cf4c8b235bc7f768a3651b7b5ffe0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91a6a82bd268a91315c250b84e12a13" id="r_ad91a6a82bd268a91315c250b84e12a13"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#ad91a6a82bd268a91315c250b84e12a13">non_fixed_kernels</a> = [kernel for kernel <a class="el" href="__lapack__subroutines_8h.html#aa83d4778c28341ab79b01b2371f666fe">in</a> <a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a86cf4c8b235bc7f768a3651b7b5ffe0e">kernels</a> if kernel != <a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a7bc3848e2435b17817e7d8f0db74f167">fixed_kernel</a>]</td></tr>
<tr class="separator:ad91a6a82bd268a91315c250b84e12a13"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Testing for Gaussian process regression </pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="aea798e9cdb139aa10095346d92be15e4" name="aea798e9cdb139aa10095346d92be15e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea798e9cdb139aa10095346d92be15e4">&#9670;&#160;</a></span>f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.f </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   33</span><span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x):</div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordflow">return</span> x * np.sin(x)</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a370ad97ee489c5e12e523d3b417dd406" name="a370ad97ee489c5e12e523d3b417dd406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a370ad97ee489c5e12e523d3b417dd406">&#9670;&#160;</a></span>test_anisotropic_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_anisotropic_kernel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  208</span><span class="keyword">def </span>test_anisotropic_kernel():</div>
<div class="line"><span class="lineno">  209</span>    <span class="comment"># Test that GPR can identify meaningful anisotropic length-scales.</span></div>
<div class="line"><span class="lineno">  210</span>    <span class="comment"># We learn a function which varies in one dimension ten-times slower</span></div>
<div class="line"><span class="lineno">  211</span>    <span class="comment"># than in the other. The corresponding length-scales should differ by at</span></div>
<div class="line"><span class="lineno">  212</span>    <span class="comment"># least a factor 5</span></div>
<div class="line"><span class="lineno">  213</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  214</span>    X = rng.uniform(-1, 1, (50, 2))</div>
<div class="line"><span class="lineno">  215</span>    y = X[:, 0] + 0.1 * X[:, 1]</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>    kernel = RBF([1.0, 1.0])</div>
<div class="line"><span class="lineno">  218</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">  219</span>    <span class="keyword">assert</span> np.exp(gpr.kernel_.theta[1]) &gt; np.exp(gpr.kernel_.theta[0]) * 5</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cebb62fad5e459dced44a55bd4e59cc" name="a6cebb62fad5e459dced44a55bd4e59cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cebb62fad5e459dced44a55bd4e59cc">&#9670;&#160;</a></span>test_bound_check_fixed_hyperparameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_bound_check_fixed_hyperparameter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  547</span><span class="keyword">def </span>test_bound_check_fixed_hyperparameter():</div>
<div class="line"><span class="lineno">  548</span>    <span class="comment"># Regression test for issue #17943</span></div>
<div class="line"><span class="lineno">  549</span>    <span class="comment"># Check that having a hyperparameter with fixed bounds doesn&#39;t cause an</span></div>
<div class="line"><span class="lineno">  550</span>    <span class="comment"># error</span></div>
<div class="line"><span class="lineno">  551</span>    k1 = 50.0**2 * RBF(length_scale=50.0)  <span class="comment"># long term smooth rising trend</span></div>
<div class="line"><span class="lineno">  552</span>    k2 = ExpSineSquared(</div>
<div class="line"><span class="lineno">  553</span>        length_scale=1.0, periodicity=1.0, periodicity_bounds=<span class="stringliteral">&quot;fixed&quot;</span></div>
<div class="line"><span class="lineno">  554</span>    )  <span class="comment"># seasonal component</span></div>
<div class="line"><span class="lineno">  555</span>    kernel = k1 + k2</div>
<div class="line"><span class="lineno">  556</span>    GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3cb3dfc90509ff667bb8b5c4e1eaf22" name="ad3cb3dfc90509ff667bb8b5c4e1eaf22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3cb3dfc90509ff667bb8b5c4e1eaf22">&#9670;&#160;</a></span>test_constant_target()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_constant_target </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that the std. dev. is affected to 1 when normalizing a constant
feature.
Non-regression test for:
https://github.com/scikit-learn/scikit-learn/issues/18318
NaN where affected to the target when scaling due to null std. dev. with
constant target.
</pre> <div class="fragment"><div class="line"><span class="lineno">  560</span><span class="keyword">def </span>test_constant_target(kernel):</div>
<div class="line"><span class="lineno">  561</span>    <span class="stringliteral">&quot;&quot;&quot;Check that the std. dev. is affected to 1 when normalizing a constant</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">    feature.</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">    Non-regression test for:</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/18318</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">    NaN where affected to the target when scaling due to null std. dev. with</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">    constant target.</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  568</span>    y_constant = np.ones(X.shape[0], dtype=np.float64)</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>    gpr = GaussianProcessRegressor(kernel=kernel, normalize_y=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  571</span>    gpr.fit(X, y_constant)</div>
<div class="line"><span class="lineno">  572</span>    <span class="keyword">assert</span> gpr._y_train_std == pytest.approx(1.0)</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    y_pred, y_cov = gpr.predict(X, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  575</span>    assert_allclose(y_pred, y_constant)</div>
<div class="line"><span class="lineno">  576</span>    <span class="comment"># set atol because we compare to zero</span></div>
<div class="line"><span class="lineno">  577</span>    assert_allclose(np.diag(y_cov), 0.0, atol=1e-9)</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    <span class="comment"># Test multi-target data</span></div>
<div class="line"><span class="lineno">  580</span>    n_samples, n_targets = X.shape[0], 2</div>
<div class="line"><span class="lineno">  581</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  582</span>    y = np.concatenate(</div>
<div class="line"><span class="lineno">  583</span>        [</div>
<div class="line"><span class="lineno">  584</span>            rng.normal(size=(n_samples, 1)),  <span class="comment"># non-constant target</span></div>
<div class="line"><span class="lineno">  585</span>            np.full(shape=(n_samples, 1), fill_value=2),  <span class="comment"># constant target</span></div>
<div class="line"><span class="lineno">  586</span>        ],</div>
<div class="line"><span class="lineno">  587</span>        axis=1,</div>
<div class="line"><span class="lineno">  588</span>    )</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    gpr.fit(X, y)</div>
<div class="line"><span class="lineno">  591</span>    Y_pred, Y_cov = gpr.predict(X, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>    assert_allclose(Y_pred[:, 1], 2)</div>
<div class="line"><span class="lineno">  594</span>    assert_allclose(np.diag(Y_cov[..., 1]), 0.0, atol=1e-9)</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>    <span class="keyword">assert</span> Y_pred.shape == (n_samples, n_targets)</div>
<div class="line"><span class="lineno">  597</span>    <span class="keyword">assert</span> Y_cov.shape == (n_samples, n_samples, n_targets)</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0af8a6371c33b3c5d7c545e01a171c9c" name="a0af8a6371c33b3c5d7c545e01a171c9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af8a6371c33b3c5d7c545e01a171c9c">&#9670;&#160;</a></span>test_converged_to_local_maximum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_converged_to_local_maximum </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  115</span><span class="keyword">def </span>test_converged_to_local_maximum(kernel):</div>
<div class="line"><span class="lineno">  116</span>    <span class="comment"># Test that we are in local maximum after hyperparameter-optimization.</span></div>
<div class="line"><span class="lineno">  117</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    lml, lml_gradient = gpr.log_marginal_likelihood(gpr.kernel_.theta, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="keyword">assert</span> np.all(</div>
<div class="line"><span class="lineno">  122</span>        (np.abs(lml_gradient) &lt; 1e-4)</div>
<div class="line"><span class="lineno">  123</span>        | (gpr.kernel_.theta == gpr.kernel_.bounds[:, 0])</div>
<div class="line"><span class="lineno">  124</span>        | (gpr.kernel_.theta == gpr.kernel_.bounds[:, 1])</div>
<div class="line"><span class="lineno">  125</span>    )</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, non_fixed_kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a846ce068ae4650fda860bd6f1600bbcb" name="a846ce068ae4650fda860bd6f1600bbcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a846ce068ae4650fda860bd6f1600bbcb">&#9670;&#160;</a></span>test_custom_optimizer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_custom_optimizer </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  391</span><span class="keyword">def </span>test_custom_optimizer(kernel):</div>
<div class="line"><span class="lineno">  392</span>    <span class="comment"># Test that GPR can use externally defined optimizers.</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="comment"># Define a dummy optimizer that simply tests 50 random hyperparameters</span></div>
<div class="line"><span class="lineno">  394</span>    <span class="keyword">def </span>optimizer(obj_func, initial_theta, bounds):</div>
<div class="line"><span class="lineno">  395</span>        rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  396</span>        theta_opt, func_min = initial_theta, obj_func(</div>
<div class="line"><span class="lineno">  397</span>            initial_theta, eval_gradient=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">  398</span>        )</div>
<div class="line"><span class="lineno">  399</span>        <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(50):</div>
<div class="line"><span class="lineno">  400</span>            theta = np.atleast_1d(</div>
<div class="line"><span class="lineno">  401</span>                rng.uniform(np.maximum(-2, bounds[:, 0]), np.minimum(1, bounds[:, 1]))</div>
<div class="line"><span class="lineno">  402</span>            )</div>
<div class="line"><span class="lineno">  403</span>            f = obj_func(theta, eval_gradient=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  404</span>            <span class="keywordflow">if</span> f &lt; func_min:</div>
<div class="line"><span class="lineno">  405</span>                theta_opt, func_min = theta, f</div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">return</span> theta_opt, func_min</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>    gpr = GaussianProcessRegressor(kernel=kernel, optimizer=optimizer)</div>
<div class="line"><span class="lineno">  409</span>    gpr.fit(X, y)</div>
<div class="line"><span class="lineno">  410</span>    <span class="comment"># Checks that optimizer improved marginal likelihood</span></div>
<div class="line"><span class="lineno">  411</span>    <span class="keyword">assert</span> gpr.log_marginal_likelihood(gpr.kernel_.theta) &gt; gpr.log_marginal_likelihood(</div>
<div class="line"><span class="lineno">  412</span>        gpr.kernel.theta</div>
<div class="line"><span class="lineno">  413</span>    )</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a54d2f7307f85e36793e8cd5a79d0875f" name="a54d2f7307f85e36793e8cd5a79d0875f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54d2f7307f85e36793e8cd5a79d0875f">&#9670;&#160;</a></span>test_duplicate_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_duplicate_input </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  432</span><span class="keyword">def </span>test_duplicate_input(kernel):</div>
<div class="line"><span class="lineno">  433</span>    <span class="comment"># Test GPR can handle two different output-values for the same input.</span></div>
<div class="line"><span class="lineno">  434</span>    gpr_equal_inputs = GaussianProcessRegressor(kernel=kernel, alpha=1e-2)</div>
<div class="line"><span class="lineno">  435</span>    gpr_similar_inputs = GaussianProcessRegressor(kernel=kernel, alpha=1e-2)</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>    X_ = np.vstack((X, X[0]))</div>
<div class="line"><span class="lineno">  438</span>    y_ = np.hstack((y, y[0] + 1))</div>
<div class="line"><span class="lineno">  439</span>    gpr_equal_inputs.fit(X_, y_)</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    X_ = np.vstack((X, X[0] + 1e-15))</div>
<div class="line"><span class="lineno">  442</span>    y_ = np.hstack((y, y[0] + 1))</div>
<div class="line"><span class="lineno">  443</span>    gpr_similar_inputs.fit(X_, y_)</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    X_test = np.linspace(0, 10, 100)[:, <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  446</span>    y_pred_equal, y_std_equal = gpr_equal_inputs.predict(X_test, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  447</span>    y_pred_similar, y_std_similar = gpr_similar_inputs.predict(X_test, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    assert_almost_equal(y_pred_equal, y_pred_similar)</div>
<div class="line"><span class="lineno">  450</span>    assert_almost_equal(y_std_equal, y_std_similar)</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9782fe89777b5ec032262a9fb9828517" name="a9782fe89777b5ec032262a9fb9828517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9782fe89777b5ec032262a9fb9828517">&#9670;&#160;</a></span>test_gpr_consistency_std_cov_non_invertible_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_gpr_consistency_std_cov_non_invertible_kernel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the consistency between the returned std. dev. and the covariance.
Non-regression test for:
https://github.com/scikit-learn/scikit-learn/issues/19936
Inconsistencies were observed when the kernel cannot be inverted (or
numerically stable).
</pre> <div class="fragment"><div class="line"><span class="lineno">  600</span><span class="keyword">def </span>test_gpr_consistency_std_cov_non_invertible_kernel():</div>
<div class="line"><span class="lineno">  601</span>    <span class="stringliteral">&quot;&quot;&quot;Check the consistency between the returned std. dev. and the covariance.</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">    Non-regression test for:</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/19936</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">    Inconsistencies were observed when the kernel cannot be inverted (or</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">    numerically stable).</span></div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  607</span>    kernel = C(8.98576054e05, (1e-12, 1e12)) * RBF(</div>
<div class="line"><span class="lineno">  608</span>        [5.91326520e02, 1.32584051e03], (1e-12, 1e12)</div>
<div class="line"><span class="lineno">  609</span>    ) + WhiteKernel(noise_level=1e-5)</div>
<div class="line"><span class="lineno">  610</span>    gpr = GaussianProcessRegressor(kernel=kernel, alpha=0, optimizer=<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  611</span>    X_train = np.array(</div>
<div class="line"><span class="lineno">  612</span>        [</div>
<div class="line"><span class="lineno">  613</span>            [0.0, 0.0],</div>
<div class="line"><span class="lineno">  614</span>            [1.54919334, -0.77459667],</div>
<div class="line"><span class="lineno">  615</span>            [-1.54919334, 0.0],</div>
<div class="line"><span class="lineno">  616</span>            [0.0, -1.54919334],</div>
<div class="line"><span class="lineno">  617</span>            [0.77459667, 0.77459667],</div>
<div class="line"><span class="lineno">  618</span>            [-0.77459667, 1.54919334],</div>
<div class="line"><span class="lineno">  619</span>        ]</div>
<div class="line"><span class="lineno">  620</span>    )</div>
<div class="line"><span class="lineno">  621</span>    y_train = np.array(</div>
<div class="line"><span class="lineno">  622</span>        [</div>
<div class="line"><span class="lineno">  623</span>            [-2.14882017e-10],</div>
<div class="line"><span class="lineno">  624</span>            [-4.66975823e00],</div>
<div class="line"><span class="lineno">  625</span>            [4.01823986e00],</div>
<div class="line"><span class="lineno">  626</span>            [-1.30303674e00],</div>
<div class="line"><span class="lineno">  627</span>            [-1.35760156e00],</div>
<div class="line"><span class="lineno">  628</span>            [3.31215668e00],</div>
<div class="line"><span class="lineno">  629</span>        ]</div>
<div class="line"><span class="lineno">  630</span>    )</div>
<div class="line"><span class="lineno">  631</span>    gpr.fit(X_train, y_train)</div>
<div class="line"><span class="lineno">  632</span>    X_test = np.array(</div>
<div class="line"><span class="lineno">  633</span>        [</div>
<div class="line"><span class="lineno">  634</span>            [-1.93649167, -1.93649167],</div>
<div class="line"><span class="lineno">  635</span>            [1.93649167, -1.93649167],</div>
<div class="line"><span class="lineno">  636</span>            [-1.93649167, 1.93649167],</div>
<div class="line"><span class="lineno">  637</span>            [1.93649167, 1.93649167],</div>
<div class="line"><span class="lineno">  638</span>        ]</div>
<div class="line"><span class="lineno">  639</span>    )</div>
<div class="line"><span class="lineno">  640</span>    pred1, std = gpr.predict(X_test, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  641</span>    pred2, cov = gpr.predict(X_test, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  642</span>    assert_allclose(std, np.sqrt(np.diagonal(cov)), rtol=1e-5)</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  646</span>    <span class="stringliteral">&quot;params, TypeError, err_msg&quot;</span>,</div>
<div class="line"><span class="lineno">  647</span>    [</div>
<div class="line"><span class="lineno">  648</span>        (</div>
<div class="line"><span class="lineno">  649</span>            {<span class="stringliteral">&quot;alpha&quot;</span>: np.zeros(100)},</div>
<div class="line"><span class="lineno">  650</span>            ValueError,</div>
<div class="line"><span class="lineno">  651</span>            <span class="stringliteral">&quot;alpha must be a scalar or an array with same number of entries as y&quot;</span>,</div>
<div class="line"><span class="lineno">  652</span>        ),</div>
<div class="line"><span class="lineno">  653</span>        (</div>
<div class="line"><span class="lineno">  654</span>            {</div>
<div class="line"><span class="lineno">  655</span>                <span class="stringliteral">&quot;kernel&quot;</span>: WhiteKernel(noise_level_bounds=(-np.inf, np.inf)),</div>
<div class="line"><span class="lineno">  656</span>                <span class="stringliteral">&quot;n_restarts_optimizer&quot;</span>: 2,</div>
<div class="line"><span class="lineno">  657</span>            },</div>
<div class="line"><span class="lineno">  658</span>            ValueError,</div>
<div class="line"><span class="lineno">  659</span>            <span class="stringliteral">&quot;requires that all bounds are finite&quot;</span>,</div>
<div class="line"><span class="lineno">  660</span>        ),</div>
<div class="line"><span class="lineno">  661</span>    ],</div>
<div class="line"><span class="lineno">  662</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa19ac9e102e0fa01a0c4e5024504caed" name="aa19ac9e102e0fa01a0c4e5024504caed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa19ac9e102e0fa01a0c4e5024504caed">&#9670;&#160;</a></span>test_gpr_correct_error_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_gpr_correct_error_message </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  416</span><span class="keyword">def </span>test_gpr_correct_error_message():</div>
<div class="line"><span class="lineno">  417</span>    X = np.arange(12).reshape(6, -1)</div>
<div class="line"><span class="lineno">  418</span>    y = np.ones(6)</div>
<div class="line"><span class="lineno">  419</span>    kernel = DotProduct()</div>
<div class="line"><span class="lineno">  420</span>    gpr = GaussianProcessRegressor(kernel=kernel, alpha=0.0)</div>
<div class="line"><span class="lineno">  421</span>    message = (</div>
<div class="line"><span class="lineno">  422</span>        <span class="stringliteral">&quot;The kernel, %s, is not returning a &quot;</span></div>
<div class="line"><span class="lineno">  423</span>        <span class="stringliteral">&quot;positive definite matrix. Try gradually increasing &quot;</span></div>
<div class="line"><span class="lineno">  424</span>        <span class="stringliteral">&quot;the &#39;alpha&#39; parameter of your &quot;</span></div>
<div class="line"><span class="lineno">  425</span>        <span class="stringliteral">&quot;GaussianProcessRegressor estimator.&quot;</span> % kernel</div>
<div class="line"><span class="lineno">  426</span>    )</div>
<div class="line"><span class="lineno">  427</span>    <span class="keyword">with</span> pytest.raises(np.linalg.LinAlgError, match=re.escape(message)):</div>
<div class="line"><span class="lineno">  428</span>        gpr.fit(X, y)</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abf2494662f5400f1af3780a8363f33f0" name="abf2494662f5400f1af3780a8363f33f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf2494662f5400f1af3780a8363f33f0">&#9670;&#160;</a></span>test_gpr_fit_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_gpr_fit_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>TypeError</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>err_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that expected error are raised during fit.</pre> <div class="fragment"><div class="line"><span class="lineno">  663</span><span class="keyword">def </span>test_gpr_fit_error(params, TypeError, err_msg):</div>
<div class="line"><span class="lineno">  664</span>    <span class="stringliteral">&quot;&quot;&quot;Check that expected error are raised during fit.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  665</span>    gpr = GaussianProcessRegressor(**params)</div>
<div class="line"><span class="lineno">  666</span>    <span class="keyword">with</span> pytest.raises(TypeError, match=err_msg):</div>
<div class="line"><span class="lineno">  667</span>        gpr.fit(X, y)</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5fa5e676a5eb22ec21ad318ff1232b8" name="ac5fa5e676a5eb22ec21ad318ff1232b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5fa5e676a5eb22ec21ad318ff1232b8">&#9670;&#160;</a></span>test_gpr_interpolation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_gpr_interpolation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   56</span><span class="keyword">def </span>test_gpr_interpolation(kernel):</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">if</span> sys.maxsize &lt;= 2**32:</div>
<div class="line"><span class="lineno">   58</span>        pytest.xfail(<span class="stringliteral">&quot;This test may fail on 32 bit Python&quot;</span>)</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    <span class="comment"># Test the interpolating property for different kernels.</span></div>
<div class="line"><span class="lineno">   61</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">   62</span>    y_pred, y_cov = gpr.predict(X, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>    assert_almost_equal(y_pred, y)</div>
<div class="line"><span class="lineno">   65</span>    assert_almost_equal(np.diag(y_cov), 0.0)</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e1010cc3a603f757284fa1426b76972" name="a8e1010cc3a603f757284fa1426b76972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e1010cc3a603f757284fa1426b76972">&#9670;&#160;</a></span>test_gpr_interpolation_structured()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_gpr_interpolation_structured </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   68</span><span class="keyword">def </span>test_gpr_interpolation_structured():</div>
<div class="line"><span class="lineno">   69</span>    <span class="comment"># Test the interpolating property for different kernels.</span></div>
<div class="line"><span class="lineno">   70</span>    kernel = MiniSeqKernel(baseline_similarity_bounds=<span class="stringliteral">&quot;fixed&quot;</span>)</div>
<div class="line"><span class="lineno">   71</span>    X = [<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>]</div>
<div class="line"><span class="lineno">   72</span>    y = np.array([1, 2, 3])</div>
<div class="line"><span class="lineno">   73</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">   74</span>    y_pred, y_cov = gpr.predict(X, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    assert_almost_equal(</div>
<div class="line"><span class="lineno">   77</span>        kernel(X, eval_gradient=<span class="keyword">True</span>)[1].ravel(), (1 - np.eye(len(X))).ravel()</div>
<div class="line"><span class="lineno">   78</span>    )</div>
<div class="line"><span class="lineno">   79</span>    assert_almost_equal(y_pred, y)</div>
<div class="line"><span class="lineno">   80</span>    assert_almost_equal(np.diag(y_cov), 0.0)</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, non_fixed_kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aed0bd563eb469d22825f50ccbe1bce8e" name="aed0bd563eb469d22825f50ccbe1bce8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed0bd563eb469d22825f50ccbe1bce8e">&#9670;&#160;</a></span>test_gpr_lml_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_gpr_lml_error </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that we raise the proper error in the LML method.</pre> <div class="fragment"><div class="line"><span class="lineno">  670</span><span class="keyword">def </span>test_gpr_lml_error():</div>
<div class="line"><span class="lineno">  671</span>    <span class="stringliteral">&quot;&quot;&quot;Check that we raise the proper error in the LML method.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  672</span>    gpr = GaussianProcessRegressor(kernel=RBF()).fit(X, y)</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>    err_msg = <span class="stringliteral">&quot;Gradient can only be evaluated for theta!=None&quot;</span></div>
<div class="line"><span class="lineno">  675</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=err_msg):</div>
<div class="line"><span class="lineno">  676</span>        gpr.log_marginal_likelihood(eval_gradient=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abcd909bd1e9b40c17c28f8333741be31" name="abcd909bd1e9b40c17c28f8333741be31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcd909bd1e9b40c17c28f8333741be31">&#9670;&#160;</a></span>test_gpr_predict_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_gpr_predict_error </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that we raise the proper error during predict.</pre> <div class="fragment"><div class="line"><span class="lineno">  679</span><span class="keyword">def </span>test_gpr_predict_error():</div>
<div class="line"><span class="lineno">  680</span>    <span class="stringliteral">&quot;&quot;&quot;Check that we raise the proper error during predict.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  681</span>    gpr = GaussianProcessRegressor(kernel=RBF()).fit(X, y)</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>    err_msg = <span class="stringliteral">&quot;At most one of return_std or return_cov can be requested.&quot;</span></div>
<div class="line"><span class="lineno">  684</span>    <span class="keyword">with</span> pytest.raises(RuntimeError, match=err_msg):</div>
<div class="line"><span class="lineno">  685</span>        gpr.predict(X, return_cov=<span class="keyword">True</span>, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span><span class="preprocessor">@pytest.mark.parametrize(&quot;normalize_y&quot;, [True, False])</span></div>
<div class="line"><span class="lineno">  689</span><span class="preprocessor">@pytest.mark.parametrize(&quot;n_targets&quot;, [None, 1, 10])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a89439fb11833dff1a0144535d99c0f3e" name="a89439fb11833dff1a0144535d99c0f3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89439fb11833dff1a0144535d99c0f3e">&#9670;&#160;</a></span>test_gpr_predict_input_not_modified()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_gpr_predict_input_not_modified </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that the input X is not modified by the predict method of the
GaussianProcessRegressor when setting return_std=True.

Non-regression test for:
https://github.com/scikit-learn/scikit-learn/issues/24340
</pre> <div class="fragment"><div class="line"><span class="lineno">  787</span><span class="keyword">def </span>test_gpr_predict_input_not_modified():</div>
<div class="line"><span class="lineno">  788</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  789</span><span class="stringliteral">    Check that the input X is not modified by the predict method of the</span></div>
<div class="line"><span class="lineno">  790</span><span class="stringliteral">    GaussianProcessRegressor when setting return_std=True.</span></div>
<div class="line"><span class="lineno">  791</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral">    Non-regression test for:</span></div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/24340</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  795</span>    gpr = GaussianProcessRegressor(kernel=CustomKernel()).fit(X, y)</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    X2_copy = np.copy(X2)</div>
<div class="line"><span class="lineno">  798</span>    _, _ = gpr.predict(X2, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    assert_allclose(X2, X2_copy)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4681addac50a3dd9331ed8a9da67d95" name="ab4681addac50a3dd9331ed8a9da67d95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4681addac50a3dd9331ed8a9da67d95">&#9670;&#160;</a></span>test_large_variance_y()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_large_variance_y </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Here we test that, when noramlize_y=True, our GP can produce a
sensible fit to training data whose variance is significantly
larger than unity. This test was made in response to issue #15612.

GP predictions are verified against predictions that were made
using GPy which, here, is treated as the 'gold standard'. Note that we
only investigate the RBF kernel here, as that is what was used in the
GPy implementation.

The following code can be used to recreate the GPy data:

--------------------------------------------------------------------------
import GPy

kernel_gpy = GPy.kern.RBF(input_dim=1, lengthscale=1.)
gpy = GPy.models.GPRegression(X, np.vstack(y_large), kernel_gpy)
gpy.optimize()
y_pred_gpy, y_var_gpy = gpy.predict(X2)
y_pred_std_gpy = np.sqrt(y_var_gpy)
--------------------------------------------------------------------------
</pre> <div class="fragment"><div class="line"><span class="lineno">  289</span><span class="keyword">def </span>test_large_variance_y():</div>
<div class="line"><span class="lineno">  290</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    Here we test that, when noramlize_y=True, our GP can produce a</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    sensible fit to training data whose variance is significantly</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">    larger than unity. This test was made in response to issue #15612.</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">    GP predictions are verified against predictions that were made</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">    using GPy which, here, is treated as the &#39;gold standard&#39;. Note that we</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">    only investigate the RBF kernel here, as that is what was used in the</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">    GPy implementation.</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">    The following code can be used to recreate the GPy data:</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">    --------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">    import GPy</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">    kernel_gpy = GPy.kern.RBF(input_dim=1, lengthscale=1.)</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">    gpy = GPy.models.GPRegression(X, np.vstack(y_large), kernel_gpy)</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">    gpy.optimize()</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">    y_pred_gpy, y_var_gpy = gpy.predict(X2)</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">    y_pred_std_gpy = np.sqrt(y_var_gpy)</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    --------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    <span class="comment"># Here we utilise a larger variance version of the training data</span></div>
<div class="line"><span class="lineno">  314</span>    y_large = 10 * y</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    <span class="comment"># Standard GP with normalize_y=True</span></div>
<div class="line"><span class="lineno">  317</span>    RBF_params = {<span class="stringliteral">&quot;length_scale&quot;</span>: 1.0}</div>
<div class="line"><span class="lineno">  318</span>    kernel = RBF(**RBF_params)</div>
<div class="line"><span class="lineno">  319</span>    gpr = GaussianProcessRegressor(kernel=kernel, normalize_y=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  320</span>    gpr.fit(X, y_large)</div>
<div class="line"><span class="lineno">  321</span>    y_pred, y_pred_std = gpr.predict(X2, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="comment"># &#39;Gold standard&#39; mean predictions from GPy</span></div>
<div class="line"><span class="lineno">  324</span>    y_pred_gpy = np.array(</div>
<div class="line"><span class="lineno">  325</span>        [15.16918303, -27.98707845, -39.31636019, 14.52605515, 69.18503589]</div>
<div class="line"><span class="lineno">  326</span>    )</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <span class="comment"># &#39;Gold standard&#39; std predictions from GPy</span></div>
<div class="line"><span class="lineno">  329</span>    y_pred_std_gpy = np.array(</div>
<div class="line"><span class="lineno">  330</span>        [7.78860962, 3.83179178, 0.63149951, 0.52745188, 0.86170042]</div>
<div class="line"><span class="lineno">  331</span>    )</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    <span class="comment"># Based on numerical experiments, it&#39;s reasonable to expect our</span></div>
<div class="line"><span class="lineno">  334</span>    <span class="comment"># GP&#39;s mean predictions to get within 7% of predictions of those</span></div>
<div class="line"><span class="lineno">  335</span>    <span class="comment"># made by GPy.</span></div>
<div class="line"><span class="lineno">  336</span>    assert_allclose(y_pred, y_pred_gpy, rtol=0.07, atol=0)</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <span class="comment"># Based on numerical experiments, it&#39;s reasonable to expect our</span></div>
<div class="line"><span class="lineno">  339</span>    <span class="comment"># GP&#39;s std predictions to get within 15% of predictions of those</span></div>
<div class="line"><span class="lineno">  340</span>    <span class="comment"># made by GPy.</span></div>
<div class="line"><span class="lineno">  341</span>    assert_allclose(y_pred_std, y_pred_std_gpy, rtol=0.15, atol=0)</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abdefec02fe117b87cf0aa3eefece401d" name="abdefec02fe117b87cf0aa3eefece401d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdefec02fe117b87cf0aa3eefece401d">&#9670;&#160;</a></span>test_lml_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_lml_gradient </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  143</span><span class="keyword">def </span>test_lml_gradient(kernel):</div>
<div class="line"><span class="lineno">  144</span>    <span class="comment"># Compare analytic and numeric gradient of log marginal likelihood.</span></div>
<div class="line"><span class="lineno">  145</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    lml, lml_gradient = gpr.log_marginal_likelihood(kernel.theta, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  148</span>    lml_gradient_approx = approx_fprime(</div>
<div class="line"><span class="lineno">  149</span>        kernel.theta, <span class="keyword">lambda</span> theta: gpr.log_marginal_likelihood(theta, <span class="keyword">False</span>), 1e-10</div>
<div class="line"><span class="lineno">  150</span>    )</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    assert_almost_equal(lml_gradient, lml_gradient_approx, 3)</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05cfeefb2975f4d7bc52fd9beeb95708" name="a05cfeefb2975f4d7bc52fd9beeb95708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05cfeefb2975f4d7bc52fd9beeb95708">&#9670;&#160;</a></span>test_lml_improving()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_lml_improving </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   84</span><span class="keyword">def </span>test_lml_improving(kernel):</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> sys.maxsize &lt;= 2**32:</div>
<div class="line"><span class="lineno">   86</span>        pytest.xfail(<span class="stringliteral">&quot;This test may fail on 32 bit Python&quot;</span>)</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    <span class="comment"># Test that hyperparameter-tuning improves log-marginal likelihood.</span></div>
<div class="line"><span class="lineno">   89</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">   90</span>    <span class="keyword">assert</span> gpr.log_marginal_likelihood(gpr.kernel_.theta) &gt; gpr.log_marginal_likelihood(</div>
<div class="line"><span class="lineno">   91</span>        kernel.theta</div>
<div class="line"><span class="lineno">   92</span>    )</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afbc3b4cfdc11790390a451583de8395e" name="afbc3b4cfdc11790390a451583de8395e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbc3b4cfdc11790390a451583de8395e">&#9670;&#160;</a></span>test_lml_precomputed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_lml_precomputed </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   96</span><span class="keyword">def </span>test_lml_precomputed(kernel):</div>
<div class="line"><span class="lineno">   97</span>    <span class="comment"># Test that lml of optimized kernel is stored correctly.</span></div>
<div class="line"><span class="lineno">   98</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">   99</span>    <span class="keyword">assert</span> gpr.log_marginal_likelihood(gpr.kernel_.theta) == pytest.approx(</div>
<div class="line"><span class="lineno">  100</span>        gpr.log_marginal_likelihood()</div>
<div class="line"><span class="lineno">  101</span>    )</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5536e800878ac77af7c3480fd087516f" name="a5536e800878ac77af7c3480fd087516f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5536e800878ac77af7c3480fd087516f">&#9670;&#160;</a></span>test_lml_without_cloning_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_lml_without_cloning_kernel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  105</span><span class="keyword">def </span>test_lml_without_cloning_kernel(kernel):</div>
<div class="line"><span class="lineno">  106</span>    <span class="comment"># Test that lml of optimized kernel is stored correctly.</span></div>
<div class="line"><span class="lineno">  107</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">  108</span>    input_theta = np.ones(gpr.kernel_.theta.shape, dtype=np.float64)</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    gpr.log_marginal_likelihood(input_theta, clone_kernel=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  111</span>    assert_almost_equal(gpr.kernel_.theta, input_theta, 7)</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, non_fixed_kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a858805926f178b93e369a834c3563cf7" name="a858805926f178b93e369a834c3563cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858805926f178b93e369a834c3563cf7">&#9670;&#160;</a></span>test_no_fit_default_predict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_no_fit_default_predict </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  453</span><span class="keyword">def </span>test_no_fit_default_predict():</div>
<div class="line"><span class="lineno">  454</span>    <span class="comment"># Test that GPR predictions without fit does not break by default.</span></div>
<div class="line"><span class="lineno">  455</span>    default_kernel = C(1.0, constant_value_bounds=<span class="stringliteral">&quot;fixed&quot;</span>) * RBF(</div>
<div class="line"><span class="lineno">  456</span>        1.0, length_scale_bounds=<span class="stringliteral">&quot;fixed&quot;</span></div>
<div class="line"><span class="lineno">  457</span>    )</div>
<div class="line"><span class="lineno">  458</span>    gpr1 = GaussianProcessRegressor()</div>
<div class="line"><span class="lineno">  459</span>    _, y_std1 = gpr1.predict(X, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  460</span>    _, y_cov1 = gpr1.predict(X, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    gpr2 = GaussianProcessRegressor(kernel=default_kernel)</div>
<div class="line"><span class="lineno">  463</span>    _, y_std2 = gpr2.predict(X, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  464</span>    _, y_cov2 = gpr2.predict(X, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>    assert_array_almost_equal(y_std1, y_std2)</div>
<div class="line"><span class="lineno">  467</span>    assert_array_almost_equal(y_cov1, y_cov2)</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e92e7ab8188f2386f2781abbdb07fc9" name="a1e92e7ab8188f2386f2781abbdb07fc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e92e7ab8188f2386f2781abbdb07fc9">&#9670;&#160;</a></span>test_no_optimizer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_no_optimizer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  188</span><span class="keyword">def </span>test_no_optimizer():</div>
<div class="line"><span class="lineno">  189</span>    <span class="comment"># Test that kernel parameters are unmodified when optimizer is None.</span></div>
<div class="line"><span class="lineno">  190</span>    kernel = RBF(1.0)</div>
<div class="line"><span class="lineno">  191</span>    gpr = GaussianProcessRegressor(kernel=kernel, optimizer=<span class="keywordtype">None</span>).fit(X, y)</div>
<div class="line"><span class="lineno">  192</span>    <span class="keyword">assert</span> np.exp(gpr.kernel_.theta) == 1.0</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
<div class="line"><span class="lineno">  196</span><span class="preprocessor">@pytest.mark.parametrize(&quot;target&quot;, [y, np.ones(X.shape[0], dtype=np.float64)</span>])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a099f3263717aa51c54c7cb16ce5b647f" name="a099f3263717aa51c54c7cb16ce5b647f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a099f3263717aa51c54c7cb16ce5b647f">&#9670;&#160;</a></span>test_predict_cov_vs_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_predict_cov_vs_std </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  197</span><span class="keyword">def </span>test_predict_cov_vs_std(kernel, target):</div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordflow">if</span> sys.maxsize &lt;= 2**32:</div>
<div class="line"><span class="lineno">  199</span>        pytest.xfail(<span class="stringliteral">&quot;This test may fail on 32 bit Python&quot;</span>)</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    <span class="comment"># Test that predicted std.-dev. is consistent with cov&#39;s diagonal.</span></div>
<div class="line"><span class="lineno">  202</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">  203</span>    y_mean, y_cov = gpr.predict(X2, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  204</span>    y_mean, y_std = gpr.predict(X2, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  205</span>    assert_almost_equal(np.sqrt(np.diag(y_cov)), y_std)</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ed6be0d95651ce006d1207f97a0ff27" name="a9ed6be0d95651ce006d1207f97a0ff27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ed6be0d95651ce006d1207f97a0ff27">&#9670;&#160;</a></span>test_predict_shapes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_predict_shapes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normalize_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_targets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the shapes of y_mean, y_std, and y_cov in single-output
(n_targets=None) and multi-output settings, including the edge case when
n_targets=1, where the sklearn convention is to squeeze the predictions.

Non-regression test for:
https://github.com/scikit-learn/scikit-learn/issues/17394
https://github.com/scikit-learn/scikit-learn/issues/18065
https://github.com/scikit-learn/scikit-learn/issues/22174
</pre> <div class="fragment"><div class="line"><span class="lineno">  690</span><span class="keyword">def </span>test_predict_shapes(normalize_y, n_targets):</div>
<div class="line"><span class="lineno">  691</span>    <span class="stringliteral">&quot;&quot;&quot;Check the shapes of y_mean, y_std, and y_cov in single-output</span></div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral">    (n_targets=None) and multi-output settings, including the edge case when</span></div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral">    n_targets=1, where the sklearn convention is to squeeze the predictions.</span></div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral">    Non-regression test for:</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/17394</span></div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/18065</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/22174</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  700</span>    rng = np.random.RandomState(1234)</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>    n_features, n_samples_train, n_samples_test = 6, 9, 7</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    y_train_shape = (n_samples_train,)</div>
<div class="line"><span class="lineno">  705</span>    <span class="keywordflow">if</span> n_targets <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  706</span>        y_train_shape = y_train_shape + (n_targets,)</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>    <span class="comment"># By convention single-output data is squeezed upon prediction</span></div>
<div class="line"><span class="lineno">  709</span>    y_test_shape = (n_samples_test,)</div>
<div class="line"><span class="lineno">  710</span>    <span class="keywordflow">if</span> n_targets <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> n_targets &gt; 1:</div>
<div class="line"><span class="lineno">  711</span>        y_test_shape = y_test_shape + (n_targets,)</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>    X_train = rng.randn(n_samples_train, n_features)</div>
<div class="line"><span class="lineno">  714</span>    X_test = rng.randn(n_samples_test, n_features)</div>
<div class="line"><span class="lineno">  715</span>    y_train = rng.randn(*y_train_shape)</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>    model = GaussianProcessRegressor(normalize_y=normalize_y)</div>
<div class="line"><span class="lineno">  718</span>    model.fit(X_train, y_train)</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>    y_pred, y_std = model.predict(X_test, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  721</span>    _, y_cov = model.predict(X_test, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    <span class="keyword">assert</span> y_pred.shape == y_test_shape</div>
<div class="line"><span class="lineno">  724</span>    <span class="keyword">assert</span> y_std.shape == y_test_shape</div>
<div class="line"><span class="lineno">  725</span>    <span class="keyword">assert</span> y_cov.shape == (n_samples_test,) + y_test_shape</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span><span class="preprocessor">@pytest.mark.parametrize(&quot;normalize_y&quot;, [True, False])</span></div>
<div class="line"><span class="lineno">  729</span><span class="preprocessor">@pytest.mark.parametrize(&quot;n_targets&quot;, [None, 1, 10])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0901f999dc4a5d62733d0ec3bb26eb04" name="a0901f999dc4a5d62733d0ec3bb26eb04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0901f999dc4a5d62733d0ec3bb26eb04">&#9670;&#160;</a></span>test_prior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_prior </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  156</span><span class="keyword">def </span>test_prior(kernel):</div>
<div class="line"><span class="lineno">  157</span>    <span class="comment"># Test that GP prior has mean 0 and identical variances.</span></div>
<div class="line"><span class="lineno">  158</span>    gpr = GaussianProcessRegressor(kernel=kernel)</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    y_mean, y_cov = gpr.predict(X, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    assert_almost_equal(y_mean, 0, 5)</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">if</span> len(gpr.kernel.theta) &gt; 1:</div>
<div class="line"><span class="lineno">  164</span>        <span class="comment"># XXX: quite hacky, works only for current kernels</span></div>
<div class="line"><span class="lineno">  165</span>        assert_almost_equal(np.diag(y_cov), np.exp(kernel.theta[0]), 5)</div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  167</span>        assert_almost_equal(np.diag(y_cov), 1, 5)</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2030c63eb05eef71535f48d2380df1d" name="ae2030c63eb05eef71535f48d2380df1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2030c63eb05eef71535f48d2380df1d">&#9670;&#160;</a></span>test_random_starts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_random_starts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  222</span><span class="keyword">def </span>test_random_starts():</div>
<div class="line"><span class="lineno">  223</span>    <span class="comment"># Test that an increasing number of random-starts of GP fitting only</span></div>
<div class="line"><span class="lineno">  224</span>    <span class="comment"># increases the log marginal likelihood of the chosen theta.</span></div>
<div class="line"><span class="lineno">  225</span>    n_samples, n_features = 25, 2</div>
<div class="line"><span class="lineno">  226</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  227</span>    X = rng.randn(n_samples, n_features) * 2 - 1</div>
<div class="line"><span class="lineno">  228</span>    y = (</div>
<div class="line"><span class="lineno">  229</span>        np.sin(X).sum(axis=1)</div>
<div class="line"><span class="lineno">  230</span>        + np.sin(3 * X).sum(axis=1)</div>
<div class="line"><span class="lineno">  231</span>        + rng.normal(scale=0.1, size=n_samples)</div>
<div class="line"><span class="lineno">  232</span>    )</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    kernel = C(1.0, (1e-2, 1e2)) * RBF(</div>
<div class="line"><span class="lineno">  235</span>        length_scale=[1.0] * n_features, length_scale_bounds=[(1e-4, 1e2)] * n_features</div>
<div class="line"><span class="lineno">  236</span>    ) + WhiteKernel(noise_level=1e-5, noise_level_bounds=(1e-5, 1e1))</div>
<div class="line"><span class="lineno">  237</span>    last_lml = -np.inf</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">for</span> n_restarts_optimizer <span class="keywordflow">in</span> range(5):</div>
<div class="line"><span class="lineno">  239</span>        gp = GaussianProcessRegressor(</div>
<div class="line"><span class="lineno">  240</span>            kernel=kernel,</div>
<div class="line"><span class="lineno">  241</span>            n_restarts_optimizer=n_restarts_optimizer,</div>
<div class="line"><span class="lineno">  242</span>            random_state=0,</div>
<div class="line"><span class="lineno">  243</span>        ).fit(X, y)</div>
<div class="line"><span class="lineno">  244</span>        lml = gp.log_marginal_likelihood(gp.kernel_.theta)</div>
<div class="line"><span class="lineno">  245</span>        <span class="keyword">assert</span> lml &gt; last_lml - np.finfo(np.float32).eps</div>
<div class="line"><span class="lineno">  246</span>        last_lml = lml</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5bc76f26e46ef13a5b0d6f17b16e9b8" name="ab5bc76f26e46ef13a5b0d6f17b16e9b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5bc76f26e46ef13a5b0d6f17b16e9b8">&#9670;&#160;</a></span>test_sample_statistics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_sample_statistics </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  171</span><span class="keyword">def </span>test_sample_statistics(kernel):</div>
<div class="line"><span class="lineno">  172</span>    <span class="comment"># Test that statistics of samples drawn from GP are correct.</span></div>
<div class="line"><span class="lineno">  173</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    y_mean, y_cov = gpr.predict(X2, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    samples = gpr.sample_y(X2, 300000)</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <span class="comment"># More digits accuracy would require many more samples</span></div>
<div class="line"><span class="lineno">  180</span>    assert_almost_equal(y_mean, np.mean(samples, 1), 1)</div>
<div class="line"><span class="lineno">  181</span>    assert_almost_equal(</div>
<div class="line"><span class="lineno">  182</span>        np.diag(y_cov) / np.diag(y_cov).max(),</div>
<div class="line"><span class="lineno">  183</span>        np.var(samples, 1) / np.diag(y_cov).max(),</div>
<div class="line"><span class="lineno">  184</span>        1,</div>
<div class="line"><span class="lineno">  185</span>    )</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac56866c51a19a89629f76cebf008437c" name="ac56866c51a19a89629f76cebf008437c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56866c51a19a89629f76cebf008437c">&#9670;&#160;</a></span>test_sample_y_shapes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_sample_y_shapes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normalize_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_targets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the shapes of y_samples in single-output (n_targets=0) and
multi-output settings, including the edge case when n_targets=1, where the
sklearn convention is to squeeze the predictions.

Non-regression test for:
https://github.com/scikit-learn/scikit-learn/issues/22175
</pre> <div class="fragment"><div class="line"><span class="lineno">  730</span><span class="keyword">def </span>test_sample_y_shapes(normalize_y, n_targets):</div>
<div class="line"><span class="lineno">  731</span>    <span class="stringliteral">&quot;&quot;&quot;Check the shapes of y_samples in single-output (n_targets=0) and</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">    multi-output settings, including the edge case when n_targets=1, where the</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">    sklearn convention is to squeeze the predictions.</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">    Non-regression test for:</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/22175</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  738</span>    rng = np.random.RandomState(1234)</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    n_features, n_samples_train = 6, 9</div>
<div class="line"><span class="lineno">  741</span>    <span class="comment"># Number of spatial locations to predict at</span></div>
<div class="line"><span class="lineno">  742</span>    n_samples_X_test = 7</div>
<div class="line"><span class="lineno">  743</span>    <span class="comment"># Number of sample predictions per test point</span></div>
<div class="line"><span class="lineno">  744</span>    n_samples_y_test = 5</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>    y_train_shape = (n_samples_train,)</div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordflow">if</span> n_targets <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  748</span>        y_train_shape = y_train_shape + (n_targets,)</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    <span class="comment"># By convention single-output data is squeezed upon prediction</span></div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordflow">if</span> n_targets <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> n_targets &gt; 1:</div>
<div class="line"><span class="lineno">  752</span>        y_test_shape = (n_samples_X_test, n_targets, n_samples_y_test)</div>
<div class="line"><span class="lineno">  753</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  754</span>        y_test_shape = (n_samples_X_test, n_samples_y_test)</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>    X_train = rng.randn(n_samples_train, n_features)</div>
<div class="line"><span class="lineno">  757</span>    X_test = rng.randn(n_samples_X_test, n_features)</div>
<div class="line"><span class="lineno">  758</span>    y_train = rng.randn(*y_train_shape)</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>    model = GaussianProcessRegressor(normalize_y=normalize_y)</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    <span class="comment"># FIXME: before fitting, the estimator does not have information regarding</span></div>
<div class="line"><span class="lineno">  763</span>    <span class="comment"># the number of targets and default to 1. This is inconsistent with the shape</span></div>
<div class="line"><span class="lineno">  764</span>    <span class="comment"># provided after `fit`. This assert should be made once the following issue</span></div>
<div class="line"><span class="lineno">  765</span>    <span class="comment"># is fixed:</span></div>
<div class="line"><span class="lineno">  766</span>    <span class="comment"># https://github.com/scikit-learn/scikit-learn/issues/22430</span></div>
<div class="line"><span class="lineno">  767</span>    <span class="comment"># y_samples = model.sample_y(X_test, n_samples=n_samples_y_test)</span></div>
<div class="line"><span class="lineno">  768</span>    <span class="comment"># assert y_samples.shape == y_test_shape</span></div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>    model.fit(X_train, y_train)</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>    y_samples = model.sample_y(X_test, n_samples=n_samples_y_test)</div>
<div class="line"><span class="lineno">  773</span>    <span class="keyword">assert</span> y_samples.shape == y_test_shape</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8dedea94090b339adccde62e328a6d79" name="a8dedea94090b339adccde62e328a6d79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dedea94090b339adccde62e328a6d79">&#9670;&#160;</a></span>test_solution_inside_bounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_solution_inside_bounds </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  129</span><span class="keyword">def </span>test_solution_inside_bounds(kernel):</div>
<div class="line"><span class="lineno">  130</span>    <span class="comment"># Test that hyperparameter-optimization remains in bounds#</span></div>
<div class="line"><span class="lineno">  131</span>    gpr = GaussianProcessRegressor(kernel=kernel).fit(X, y)</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>    bounds = gpr.kernel_.bounds</div>
<div class="line"><span class="lineno">  134</span>    max_ = np.finfo(gpr.kernel_.theta.dtype).max</div>
<div class="line"><span class="lineno">  135</span>    tiny = 1e-10</div>
<div class="line"><span class="lineno">  136</span>    bounds[~np.isfinite(bounds[:, 1]), 1] = max_</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    assert_array_less(bounds[:, 0], gpr.kernel_.theta + tiny)</div>
<div class="line"><span class="lineno">  139</span>    assert_array_less(gpr.kernel_.theta, bounds[:, 1] + tiny)</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a165015fabc5e7e460b5cbc8b4ceb159f" name="a165015fabc5e7e460b5cbc8b4ceb159f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a165015fabc5e7e460b5cbc8b4ceb159f">&#9670;&#160;</a></span>test_warning_bounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_warning_bounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  470</span><span class="keyword">def </span>test_warning_bounds():</div>
<div class="line"><span class="lineno">  471</span>    kernel = RBF(length_scale_bounds=[1e-5, 1e-3])</div>
<div class="line"><span class="lineno">  472</span>    gpr = GaussianProcessRegressor(kernel=kernel)</div>
<div class="line"><span class="lineno">  473</span>    warning_message = (</div>
<div class="line"><span class="lineno">  474</span>        <span class="stringliteral">&quot;The optimal value found for dimension 0 of parameter &quot;</span></div>
<div class="line"><span class="lineno">  475</span>        <span class="stringliteral">&quot;length_scale is close to the specified upper bound &quot;</span></div>
<div class="line"><span class="lineno">  476</span>        <span class="stringliteral">&quot;0.001. Increasing the bound and calling fit again may &quot;</span></div>
<div class="line"><span class="lineno">  477</span>        <span class="stringliteral">&quot;find a better value.&quot;</span></div>
<div class="line"><span class="lineno">  478</span>    )</div>
<div class="line"><span class="lineno">  479</span>    <span class="keyword">with</span> pytest.warns(ConvergenceWarning, match=warning_message):</div>
<div class="line"><span class="lineno">  480</span>        gpr.fit(X, y)</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    kernel_sum = WhiteKernel(noise_level_bounds=[1e-5, 1e-3]) + RBF(</div>
<div class="line"><span class="lineno">  483</span>        length_scale_bounds=[1e3, 1e5]</div>
<div class="line"><span class="lineno">  484</span>    )</div>
<div class="line"><span class="lineno">  485</span>    gpr_sum = GaussianProcessRegressor(kernel=kernel_sum)</div>
<div class="line"><span class="lineno">  486</span>    <span class="keyword">with</span> warnings.catch_warnings(record=<span class="keyword">True</span>) <span class="keyword">as</span> record:</div>
<div class="line"><span class="lineno">  487</span>        warnings.simplefilter(<span class="stringliteral">&quot;always&quot;</span>)</div>
<div class="line"><span class="lineno">  488</span>        gpr_sum.fit(X, y)</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>        <span class="keyword">assert</span> len(record) == 2</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>        <span class="keyword">assert</span> issubclass(record[0].category, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  493</span>        <span class="keyword">assert</span> (</div>
<div class="line"><span class="lineno">  494</span>            record[0].message.args[0]</div>
<div class="line"><span class="lineno">  495</span>            == <span class="stringliteral">&quot;The optimal value found for &quot;</span></div>
<div class="line"><span class="lineno">  496</span>            <span class="stringliteral">&quot;dimension 0 of parameter &quot;</span></div>
<div class="line"><span class="lineno">  497</span>            <span class="stringliteral">&quot;k1__noise_level is close to the &quot;</span></div>
<div class="line"><span class="lineno">  498</span>            <span class="stringliteral">&quot;specified upper bound 0.001. &quot;</span></div>
<div class="line"><span class="lineno">  499</span>            <span class="stringliteral">&quot;Increasing the bound and calling &quot;</span></div>
<div class="line"><span class="lineno">  500</span>            <span class="stringliteral">&quot;fit again may find a better value.&quot;</span></div>
<div class="line"><span class="lineno">  501</span>        )</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>        <span class="keyword">assert</span> issubclass(record[1].category, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  504</span>        <span class="keyword">assert</span> (</div>
<div class="line"><span class="lineno">  505</span>            record[1].message.args[0]</div>
<div class="line"><span class="lineno">  506</span>            == <span class="stringliteral">&quot;The optimal value found for &quot;</span></div>
<div class="line"><span class="lineno">  507</span>            <span class="stringliteral">&quot;dimension 0 of parameter &quot;</span></div>
<div class="line"><span class="lineno">  508</span>            <span class="stringliteral">&quot;k2__length_scale is close to the &quot;</span></div>
<div class="line"><span class="lineno">  509</span>            <span class="stringliteral">&quot;specified lower bound 1000.0. &quot;</span></div>
<div class="line"><span class="lineno">  510</span>            <span class="stringliteral">&quot;Decreasing the bound and calling &quot;</span></div>
<div class="line"><span class="lineno">  511</span>            <span class="stringliteral">&quot;fit again may find a better value.&quot;</span></div>
<div class="line"><span class="lineno">  512</span>        )</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    X_tile = np.tile(X, 2)</div>
<div class="line"><span class="lineno">  515</span>    kernel_dims = RBF(length_scale=[1.0, 2.0], length_scale_bounds=[1e1, 1e2])</div>
<div class="line"><span class="lineno">  516</span>    gpr_dims = GaussianProcessRegressor(kernel=kernel_dims)</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>    <span class="keyword">with</span> warnings.catch_warnings(record=<span class="keyword">True</span>) <span class="keyword">as</span> record:</div>
<div class="line"><span class="lineno">  519</span>        warnings.simplefilter(<span class="stringliteral">&quot;always&quot;</span>)</div>
<div class="line"><span class="lineno">  520</span>        gpr_dims.fit(X_tile, y)</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>        <span class="keyword">assert</span> len(record) == 2</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>        <span class="keyword">assert</span> issubclass(record[0].category, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  525</span>        <span class="keyword">assert</span> (</div>
<div class="line"><span class="lineno">  526</span>            record[0].message.args[0]</div>
<div class="line"><span class="lineno">  527</span>            == <span class="stringliteral">&quot;The optimal value found for &quot;</span></div>
<div class="line"><span class="lineno">  528</span>            <span class="stringliteral">&quot;dimension 0 of parameter &quot;</span></div>
<div class="line"><span class="lineno">  529</span>            <span class="stringliteral">&quot;length_scale is close to the &quot;</span></div>
<div class="line"><span class="lineno">  530</span>            <span class="stringliteral">&quot;specified lower bound 10.0. &quot;</span></div>
<div class="line"><span class="lineno">  531</span>            <span class="stringliteral">&quot;Decreasing the bound and calling &quot;</span></div>
<div class="line"><span class="lineno">  532</span>            <span class="stringliteral">&quot;fit again may find a better value.&quot;</span></div>
<div class="line"><span class="lineno">  533</span>        )</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>        <span class="keyword">assert</span> issubclass(record[1].category, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  536</span>        <span class="keyword">assert</span> (</div>
<div class="line"><span class="lineno">  537</span>            record[1].message.args[0]</div>
<div class="line"><span class="lineno">  538</span>            == <span class="stringliteral">&quot;The optimal value found for &quot;</span></div>
<div class="line"><span class="lineno">  539</span>            <span class="stringliteral">&quot;dimension 1 of parameter &quot;</span></div>
<div class="line"><span class="lineno">  540</span>            <span class="stringliteral">&quot;length_scale is close to the &quot;</span></div>
<div class="line"><span class="lineno">  541</span>            <span class="stringliteral">&quot;specified lower bound 10.0. &quot;</span></div>
<div class="line"><span class="lineno">  542</span>            <span class="stringliteral">&quot;Decreasing the bound and calling &quot;</span></div>
<div class="line"><span class="lineno">  543</span>            <span class="stringliteral">&quot;fit again may find a better value.&quot;</span></div>
<div class="line"><span class="lineno">  544</span>        )</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acbaea028410f66dfa902324ecaaeda4b" name="acbaea028410f66dfa902324ecaaeda4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbaea028410f66dfa902324ecaaeda4b">&#9670;&#160;</a></span>test_y_multioutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_y_multioutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  344</span><span class="keyword">def </span>test_y_multioutput():</div>
<div class="line"><span class="lineno">  345</span>    <span class="comment"># Test that GPR can deal with multi-dimensional target values</span></div>
<div class="line"><span class="lineno">  346</span>    y_2d = np.vstack((y, y * 2)).T</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="comment"># Test for fixed kernel that first dimension of 2d GP equals the output</span></div>
<div class="line"><span class="lineno">  349</span>    <span class="comment"># of 1d GP and that second dimension is twice as large</span></div>
<div class="line"><span class="lineno">  350</span>    kernel = RBF(length_scale=1.0)</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>    gpr = GaussianProcessRegressor(kernel=kernel, optimizer=<span class="keywordtype">None</span>, normalize_y=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  353</span>    gpr.fit(X, y)</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>    gpr_2d = GaussianProcessRegressor(kernel=kernel, optimizer=<span class="keywordtype">None</span>, normalize_y=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  356</span>    gpr_2d.fit(X, y_2d)</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    y_pred_1d, y_std_1d = gpr.predict(X2, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  359</span>    y_pred_2d, y_std_2d = gpr_2d.predict(X2, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  360</span>    _, y_cov_1d = gpr.predict(X2, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  361</span>    _, y_cov_2d = gpr_2d.predict(X2, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    assert_almost_equal(y_pred_1d, y_pred_2d[:, 0])</div>
<div class="line"><span class="lineno">  364</span>    assert_almost_equal(y_pred_1d, y_pred_2d[:, 1] / 2)</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <span class="comment"># Standard deviation and covariance do not depend on output</span></div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">for</span> target <span class="keywordflow">in</span> range(y_2d.shape[1]):</div>
<div class="line"><span class="lineno">  368</span>        assert_almost_equal(y_std_1d, y_std_2d[..., target])</div>
<div class="line"><span class="lineno">  369</span>        assert_almost_equal(y_cov_1d, y_cov_2d[..., target])</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    y_sample_1d = gpr.sample_y(X2, n_samples=10)</div>
<div class="line"><span class="lineno">  372</span>    y_sample_2d = gpr_2d.sample_y(X2, n_samples=10)</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>    <span class="keyword">assert</span> y_sample_1d.shape == (5, 10)</div>
<div class="line"><span class="lineno">  375</span>    <span class="keyword">assert</span> y_sample_2d.shape == (5, 2, 10)</div>
<div class="line"><span class="lineno">  376</span>    <span class="comment"># Only the first target will be equal</span></div>
<div class="line"><span class="lineno">  377</span>    assert_almost_equal(y_sample_1d, y_sample_2d[:, 0, :])</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    <span class="comment"># Test hyperparameter optimization</span></div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">for</span> kernel <span class="keywordflow">in</span> kernels:</div>
<div class="line"><span class="lineno">  381</span>        gpr = GaussianProcessRegressor(kernel=kernel, normalize_y=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  382</span>        gpr.fit(X, y)</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>        gpr_2d = GaussianProcessRegressor(kernel=kernel, normalize_y=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  385</span>        gpr_2d.fit(X, np.vstack((y, y)).T)</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>        assert_almost_equal(gpr.kernel_.theta, gpr_2d.kernel_.theta, 4)</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span><span class="preprocessor">@pytest.mark.parametrize(&quot;kernel&quot;, non_fixed_kernels)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9be9f9fe6e4a869cb320a3913f3c0d0c" name="a9be9f9fe6e4a869cb320a3913f3c0d0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9be9f9fe6e4a869cb320a3913f3c0d0c">&#9670;&#160;</a></span>test_y_normalization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.test_y_normalization </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test normalization of the target values in GP

Fitting non-normalizing GP on normalized y and fitting normalizing GP
on unnormalized y should yield identical results. Note that, here,
'normalized y' refers to y that has been made zero mean and unit
variance.</pre> <div class="fragment"><div class="line"><span class="lineno">  250</span><span class="keyword">def </span>test_y_normalization(kernel):</div>
<div class="line"><span class="lineno">  251</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    Test normalization of the target values in GP</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">    Fitting non-normalizing GP on normalized y and fitting normalizing GP</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">    on unnormalized y should yield identical results. Note that, here,</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    &#39;normalized y&#39; refers to y that has been made zero mean and unit</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    variance.</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    y_mean = np.mean(y)</div>
<div class="line"><span class="lineno">  262</span>    y_std = np.std(y)</div>
<div class="line"><span class="lineno">  263</span>    y_norm = (y - y_mean) / y_std</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="comment"># Fit non-normalizing GP on normalized y</span></div>
<div class="line"><span class="lineno">  266</span>    gpr = GaussianProcessRegressor(kernel=kernel)</div>
<div class="line"><span class="lineno">  267</span>    gpr.fit(X, y_norm)</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    <span class="comment"># Fit normalizing GP on unnormalized y</span></div>
<div class="line"><span class="lineno">  270</span>    gpr_norm = GaussianProcessRegressor(kernel=kernel, normalize_y=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  271</span>    gpr_norm.fit(X, y)</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>    <span class="comment"># Compare predicted mean, std-devs and covariances</span></div>
<div class="line"><span class="lineno">  274</span>    y_pred, y_pred_std = gpr.predict(X2, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  275</span>    y_pred = y_pred * y_std + y_mean</div>
<div class="line"><span class="lineno">  276</span>    y_pred_std = y_pred_std * y_std</div>
<div class="line"><span class="lineno">  277</span>    y_pred_norm, y_pred_std_norm = gpr_norm.predict(X2, return_std=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>    assert_almost_equal(y_pred, y_pred_norm)</div>
<div class="line"><span class="lineno">  280</span>    assert_almost_equal(y_pred_std, y_pred_std_norm)</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    _, y_cov = gpr.predict(X2, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  283</span>    y_cov = y_cov * y_std**2</div>
<div class="line"><span class="lineno">  284</span>    _, y_cov_norm = gpr_norm.predict(X2, return_cov=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    assert_almost_equal(y_cov, y_cov_norm)</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7bc3848e2435b17817e7d8f0db74f167" name="a7bc3848e2435b17817e7d8f0db74f167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bc3848e2435b17817e7d8f0db74f167">&#9670;&#160;</a></span>fixed_kernel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.fixed_kernel = <a class="el" href="classsklearn_1_1gaussian__process_1_1kernels_1_1_r_b_f.html">RBF</a>(length_scale=1.0, length_scale_bounds=&quot;fixed&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a86cf4c8b235bc7f768a3651b7b5ffe0e" name="a86cf4c8b235bc7f768a3651b7b5ffe0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86cf4c8b235bc7f768a3651b7b5ffe0e">&#9670;&#160;</a></span>kernels</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list sklearn.gaussian_process.tests.test_gpr.kernels</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  [</div>
<div class="line"><span class="lineno">    2</span>    RBF(length_scale=1.0),</div>
<div class="line"><span class="lineno">    3</span>    fixed_kernel,</div>
<div class="line"><span class="lineno">    4</span>    RBF(length_scale=1.0, length_scale_bounds=(1e-3, 1e3)),</div>
<div class="line"><span class="lineno">    5</span>    C(1.0, (1e-2, 1e2)) * RBF(length_scale=1.0, length_scale_bounds=(1e-3, 1e3)),</div>
<div class="line"><span class="lineno">    6</span>    C(1.0, (1e-2, 1e2)) * RBF(length_scale=1.0, length_scale_bounds=(1e-3, 1e3))</div>
<div class="line"><span class="lineno">    7</span>    + C(1e-5, (1e-5, 1e2)),</div>
<div class="line"><span class="lineno">    8</span>    C(0.1, (1e-2, 1e2)) * RBF(length_scale=1.0, length_scale_bounds=(1e-3, 1e3))</div>
<div class="line"><span class="lineno">    9</span>    + C(1e-5, (1e-5, 1e2)),</div>
<div class="line"><span class="lineno">   10</span>]</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad91a6a82bd268a91315c250b84e12a13" name="ad91a6a82bd268a91315c250b84e12a13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad91a6a82bd268a91315c250b84e12a13">&#9670;&#160;</a></span>non_fixed_kernels</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list sklearn.gaussian_process.tests.test_gpr.non_fixed_kernels = [kernel for kernel <a class="el" href="__lapack__subroutines_8h.html#aa83d4778c28341ab79b01b2371f666fe">in</a> <a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a86cf4c8b235bc7f768a3651b7b5ffe0e">kernels</a> if kernel != <a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#a7bc3848e2435b17817e7d8f0db74f167">fixed_kernel</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acd3ccad36e064ee73b9a774544bb0d06" name="acd3ccad36e064ee73b9a774544bb0d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd3ccad36e064ee73b9a774544bb0d06">&#9670;&#160;</a></span>X</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.X = np.atleast_2d([1.0, 3.0, 5.0, 6.0, 7.0, 8.0]).T</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae5a02f704ef94dc77781f434b8d5a9e0" name="ae5a02f704ef94dc77781f434b8d5a9e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a02f704ef94dc77781f434b8d5a9e0">&#9670;&#160;</a></span>X2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.X2 = np.atleast_2d([2.0, 4.0, 5.5, 6.5, 7.5]).T</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7f004c81fc145b4a1e8f583732795f91" name="a7f004c81fc145b4a1e8f583732795f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f004c81fc145b4a1e8f583732795f91">&#9670;&#160;</a></span>y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.gaussian_process.tests.test_gpr.y = <a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#aea798e9cdb139aa10095346d92be15e4">f</a>(<a class="el" href="namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr.html#acd3ccad36e064ee73b9a774544bb0d06">X</a>).ravel()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
