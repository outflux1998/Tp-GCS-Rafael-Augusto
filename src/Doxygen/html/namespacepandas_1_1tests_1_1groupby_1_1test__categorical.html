<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.tests.groupby.test_categorical Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1groupby.html">groupby</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html">test_categorical</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">pandas.tests.groupby.test_categorical Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a33d3d85666ceb29f160df9625b96f63d" id="r_a33d3d85666ceb29f160df9625b96f63d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a33d3d85666ceb29f160df9625b96f63d">cartesian_product_for_groupers</a> (result, args, names, fill_value=np.NaN)</td></tr>
<tr class="separator:a33d3d85666ceb29f160df9625b96f63d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cefc60ef22172ca01cb3dacbfda227e" id="r_a5cefc60ef22172ca01cb3dacbfda227e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a5cefc60ef22172ca01cb3dacbfda227e">test_apply_use_categorical_name</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:a5cefc60ef22172ca01cb3dacbfda227e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f5366204a0c4ebe8edd0d5aa99eca90" id="r_a1f5366204a0c4ebe8edd0d5aa99eca90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a1f5366204a0c4ebe8edd0d5aa99eca90">test_basic</a> ()</td></tr>
<tr class="separator:a1f5366204a0c4ebe8edd0d5aa99eca90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5bb19b9d23b47b07e9dd74d45ff1432" id="r_af5bb19b9d23b47b07e9dd74d45ff1432"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#af5bb19b9d23b47b07e9dd74d45ff1432">test_level_get_group</a> (observed)</td></tr>
<tr class="separator:af5bb19b9d23b47b07e9dd74d45ff1432"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0e1ec770620a5aa91f3b9a0b9aeb3fe" id="r_ad0e1ec770620a5aa91f3b9a0b9aeb3fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ad0e1ec770620a5aa91f3b9a0b9aeb3fe">test_sorting_with_different_categoricals</a> ()</td></tr>
<tr class="separator:ad0e1ec770620a5aa91f3b9a0b9aeb3fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a009dd8912d36238186fa92b6714dd212" id="r_a009dd8912d36238186fa92b6714dd212"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a009dd8912d36238186fa92b6714dd212">test_apply</a> (ordered)</td></tr>
<tr class="separator:a009dd8912d36238186fa92b6714dd212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0a3a8cb1f523bbbf97781f8052e005" id="r_a3e0a3a8cb1f523bbbf97781f8052e005"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a3e0a3a8cb1f523bbbf97781f8052e005">test_observed</a> (observed)</td></tr>
<tr class="separator:a3e0a3a8cb1f523bbbf97781f8052e005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac00c999a0bd19452f4a01017298acf40" id="r_ac00c999a0bd19452f4a01017298acf40"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ac00c999a0bd19452f4a01017298acf40">test_observed_codes_remap</a> (observed)</td></tr>
<tr class="separator:ac00c999a0bd19452f4a01017298acf40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a651acff76f6bd46c59cecfb9988a7572" id="r_a651acff76f6bd46c59cecfb9988a7572"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a651acff76f6bd46c59cecfb9988a7572">test_observed_perf</a> ()</td></tr>
<tr class="separator:a651acff76f6bd46c59cecfb9988a7572"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace5e015674a783d2eebf1328264f50d7" id="r_ace5e015674a783d2eebf1328264f50d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ace5e015674a783d2eebf1328264f50d7">test_observed_groups</a> (observed)</td></tr>
<tr class="separator:ace5e015674a783d2eebf1328264f50d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd40fce37d1a21fa0dfbc86199438d41" id="r_acd40fce37d1a21fa0dfbc86199438d41"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#acd40fce37d1a21fa0dfbc86199438d41">test_observed_groups_with_nan</a> (observed)</td></tr>
<tr class="separator:acd40fce37d1a21fa0dfbc86199438d41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7188f5fd477f1e588348188c980124da" id="r_a7188f5fd477f1e588348188c980124da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a7188f5fd477f1e588348188c980124da">test_observed_nth</a> ()</td></tr>
<tr class="separator:a7188f5fd477f1e588348188c980124da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ec06518ebde8395f743adf8cf406f0" id="r_a84ec06518ebde8395f743adf8cf406f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a84ec06518ebde8395f743adf8cf406f0">test_dataframe_categorical_with_nan</a> (observed)</td></tr>
<tr class="separator:a84ec06518ebde8395f743adf8cf406f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb74b7c31f31f430470cb27077b9a50" id="r_adfb74b7c31f31f430470cb27077b9a50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#adfb74b7c31f31f430470cb27077b9a50">test_dataframe_categorical_ordered_observed_sort</a> (ordered, observed, sort)</td></tr>
<tr class="separator:adfb74b7c31f31f430470cb27077b9a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57ed46781355a4313f533f63c5221b83" id="r_a57ed46781355a4313f533f63c5221b83"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a57ed46781355a4313f533f63c5221b83">test_datetime</a> ()</td></tr>
<tr class="separator:a57ed46781355a4313f533f63c5221b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87acbc6e3a33ef8ac2635558f0f711e8" id="r_a87acbc6e3a33ef8ac2635558f0f711e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a87acbc6e3a33ef8ac2635558f0f711e8">test_categorical_index</a> ()</td></tr>
<tr class="separator:a87acbc6e3a33ef8ac2635558f0f711e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989f43179100cbb12b6452554cc9c956" id="r_a989f43179100cbb12b6452554cc9c956"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a989f43179100cbb12b6452554cc9c956">test_describe_categorical_columns</a> ()</td></tr>
<tr class="separator:a989f43179100cbb12b6452554cc9c956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff64bf024fc56b5959a45b7dceeea37" id="r_a6ff64bf024fc56b5959a45b7dceeea37"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a6ff64bf024fc56b5959a45b7dceeea37">test_unstack_categorical</a> ()</td></tr>
<tr class="separator:a6ff64bf024fc56b5959a45b7dceeea37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b64eb4f8b114126a0a6e779c9f21157" id="r_a2b64eb4f8b114126a0a6e779c9f21157"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a2b64eb4f8b114126a0a6e779c9f21157">test_bins_unequal_len</a> ()</td></tr>
<tr class="separator:a2b64eb4f8b114126a0a6e779c9f21157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bcdc6faa91b293db20c70b8049a9031" id="r_a0bcdc6faa91b293db20c70b8049a9031"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a0bcdc6faa91b293db20c70b8049a9031">test_categorical_series</a> (series, data)</td></tr>
<tr class="separator:a0bcdc6faa91b293db20c70b8049a9031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9feafef3f4f203a9a3ccb2a55fb257dc" id="r_a9feafef3f4f203a9a3ccb2a55fb257dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a9feafef3f4f203a9a3ccb2a55fb257dc">test_as_index</a> ()</td></tr>
<tr class="separator:a9feafef3f4f203a9a3ccb2a55fb257dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c1b2a415f6934d103ab3ad77f8de4a8" id="r_a0c1b2a415f6934d103ab3ad77f8de4a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a0c1b2a415f6934d103ab3ad77f8de4a8">test_preserve_categories</a> ()</td></tr>
<tr class="separator:a0c1b2a415f6934d103ab3ad77f8de4a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc6e854b74667e0b38199df19ce0a6a" id="r_a8dc6e854b74667e0b38199df19ce0a6a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a8dc6e854b74667e0b38199df19ce0a6a">test_preserve_categorical_dtype</a> ()</td></tr>
<tr class="separator:a8dc6e854b74667e0b38199df19ce0a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7abfb315e7737cb81f38329f89d72391" id="r_a7abfb315e7737cb81f38329f89d72391"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a7abfb315e7737cb81f38329f89d72391">test_preserve_on_ordered_ops</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, values)</td></tr>
<tr class="separator:a7abfb315e7737cb81f38329f89d72391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a497ad4ccb93281a0a8aa5ff062335ad5" id="r_a497ad4ccb93281a0a8aa5ff062335ad5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a497ad4ccb93281a0a8aa5ff062335ad5">test_categorical_no_compress</a> ()</td></tr>
<tr class="separator:a497ad4ccb93281a0a8aa5ff062335ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2d3f824f8f37ac3c1ca3497c577781f" id="r_ab2d3f824f8f37ac3c1ca3497c577781f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ab2d3f824f8f37ac3c1ca3497c577781f">test_groupby_empty_with_category</a> ()</td></tr>
<tr class="separator:ab2d3f824f8f37ac3c1ca3497c577781f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bf25423a6d89a225e33d8ae17cd546c" id="r_a9bf25423a6d89a225e33d8ae17cd546c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a9bf25423a6d89a225e33d8ae17cd546c">test_sort</a> ()</td></tr>
<tr class="separator:a9bf25423a6d89a225e33d8ae17cd546c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a934b831bd6c1f9a3efe509dcb0216b71" id="r_a934b831bd6c1f9a3efe509dcb0216b71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a934b831bd6c1f9a3efe509dcb0216b71">test_sort2</a> ()</td></tr>
<tr class="separator:a934b831bd6c1f9a3efe509dcb0216b71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0be7ea72d9c8f41486945eb683aad5af" id="r_a0be7ea72d9c8f41486945eb683aad5af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a0be7ea72d9c8f41486945eb683aad5af">test_sort_datetimelike</a> ()</td></tr>
<tr class="separator:a0be7ea72d9c8f41486945eb683aad5af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f9022c65a3a6d9674780406f4177e89" id="r_a4f9022c65a3a6d9674780406f4177e89"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a4f9022c65a3a6d9674780406f4177e89">test_empty_sum</a> ()</td></tr>
<tr class="separator:a4f9022c65a3a6d9674780406f4177e89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2731ed8b2547924ac5aa3c0ea2505af" id="r_ad2731ed8b2547924ac5aa3c0ea2505af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ad2731ed8b2547924ac5aa3c0ea2505af">test_empty_prod</a> ()</td></tr>
<tr class="separator:ad2731ed8b2547924ac5aa3c0ea2505af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9b75588a318852deb0d70c8fe468472" id="r_aa9b75588a318852deb0d70c8fe468472"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#aa9b75588a318852deb0d70c8fe468472">test_groupby_multiindex_categorical_datetime</a> ()</td></tr>
<tr class="separator:aa9b75588a318852deb0d70c8fe468472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28b6b82b34c3933a3d526cec84350c49" id="r_a28b6b82b34c3933a3d526cec84350c49"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a28b6b82b34c3933a3d526cec84350c49">test_groupby_agg_observed_true_single_column</a> (as_index, expected)</td></tr>
<tr class="separator:a28b6b82b34c3933a3d526cec84350c49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e09541ee3fcfa0419e15c3c0b600df9" id="r_a8e09541ee3fcfa0419e15c3c0b600df9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a8e09541ee3fcfa0419e15c3c0b600df9">test_shift</a> (fill_value)</td></tr>
<tr class="separator:a8e09541ee3fcfa0419e15c3c0b600df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2cd4acab16e9f7d9577723ac6559e8" id="r_aaa2cd4acab16e9f7d9577723ac6559e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#aaa2cd4acab16e9f7d9577723ac6559e8">df_cat</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:aaa2cd4acab16e9f7d9577723ac6559e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1d70deb8a8e9fa07abcd0ad333b81bd" id="r_ae1d70deb8a8e9fa07abcd0ad333b81bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ae1d70deb8a8e9fa07abcd0ad333b81bd">test_seriesgroupby_observed_true</a> (<a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#aaa2cd4acab16e9f7d9577723ac6559e8">df_cat</a>, operation)</td></tr>
<tr class="separator:ae1d70deb8a8e9fa07abcd0ad333b81bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6497e8cb7da8a528e1e866304a9d83dc" id="r_a6497e8cb7da8a528e1e866304a9d83dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a6497e8cb7da8a528e1e866304a9d83dc">test_seriesgroupby_observed_false_or_none</a> (<a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#aaa2cd4acab16e9f7d9577723ac6559e8">df_cat</a>, observed, operation)</td></tr>
<tr class="separator:a6497e8cb7da8a528e1e866304a9d83dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4c4bbcf51557b1ba3a771436580b603" id="r_ac4c4bbcf51557b1ba3a771436580b603"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ac4c4bbcf51557b1ba3a771436580b603">test_seriesgroupby_observed_apply_dict</a> (<a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#aaa2cd4acab16e9f7d9577723ac6559e8">df_cat</a>, observed, index, data)</td></tr>
<tr class="separator:ac4c4bbcf51557b1ba3a771436580b603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1faea3f0341c5b06ab0b2f58e032863" id="r_af1faea3f0341c5b06ab0b2f58e032863"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#af1faea3f0341c5b06ab0b2f58e032863">test_groupby_categorical_series_dataframe_consistent</a> (<a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#aaa2cd4acab16e9f7d9577723ac6559e8">df_cat</a>)</td></tr>
<tr class="separator:af1faea3f0341c5b06ab0b2f58e032863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac36ef13c1561a1f0adf8a860e4a70946" id="r_ac36ef13c1561a1f0adf8a860e4a70946"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ac36ef13c1561a1f0adf8a860e4a70946">test_groupby_categorical_axis_1</a> (code)</td></tr>
<tr class="separator:ac36ef13c1561a1f0adf8a860e4a70946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79711d702b8cf4173109841795919242" id="r_a79711d702b8cf4173109841795919242"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a79711d702b8cf4173109841795919242">test_groupby_cat_preserves_structure</a> (observed, ordered)</td></tr>
<tr class="separator:a79711d702b8cf4173109841795919242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa84d515bb545b6b5afe6413eacb0d30" id="r_afa84d515bb545b6b5afe6413eacb0d30"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#afa84d515bb545b6b5afe6413eacb0d30">test_get_nonexistent_category</a> ()</td></tr>
<tr class="separator:afa84d515bb545b6b5afe6413eacb0d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8191e226b8b0d223c04d366e3c675f7" id="r_ac8191e226b8b0d223c04d366e3c675f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ac8191e226b8b0d223c04d366e3c675f7">test_series_groupby_on_2_categoricals_unobserved</a> (reduction_func, observed, request)</td></tr>
<tr class="separator:ac8191e226b8b0d223c04d366e3c675f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7793bfa4c87dbe1da57b3506e03bdbb" id="r_ac7793bfa4c87dbe1da57b3506e03bdbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ac7793bfa4c87dbe1da57b3506e03bdbb">test_series_groupby_on_2_categoricals_unobserved_zeroes_or_nans</a> (reduction_func, request)</td></tr>
<tr class="separator:ac7793bfa4c87dbe1da57b3506e03bdbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e287177f9f1ebcb286912492e3df180" id="r_a3e287177f9f1ebcb286912492e3df180"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a3e287177f9f1ebcb286912492e3df180">test_dataframe_groupby_on_2_categoricals_when_observed_is_true</a> (reduction_func)</td></tr>
<tr class="separator:a3e287177f9f1ebcb286912492e3df180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a7ef0c3069681dd6dafd5284337e7c" id="r_aa8a7ef0c3069681dd6dafd5284337e7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#aa8a7ef0c3069681dd6dafd5284337e7c">test_dataframe_groupby_on_2_categoricals_when_observed_is_false</a> (reduction_func, observed)</td></tr>
<tr class="separator:aa8a7ef0c3069681dd6dafd5284337e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a933983a10a298109c3c0eed9f858f646" id="r_a933983a10a298109c3c0eed9f858f646"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a933983a10a298109c3c0eed9f858f646">test_series_groupby_categorical_aggregation_getitem</a> ()</td></tr>
<tr class="separator:a933983a10a298109c3c0eed9f858f646"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0a71ebd9488460225b0719bd11e710d" id="r_ad0a71ebd9488460225b0719bd11e710d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ad0a71ebd9488460225b0719bd11e710d">test_groupby_agg_categorical_columns</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, expected_values)</td></tr>
<tr class="separator:ad0a71ebd9488460225b0719bd11e710d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bb3ee7527321487db55b93d4685bd6d" id="r_a2bb3ee7527321487db55b93d4685bd6d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a2bb3ee7527321487db55b93d4685bd6d">test_groupby_agg_non_numeric</a> ()</td></tr>
<tr class="separator:a2bb3ee7527321487db55b93d4685bd6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33450c2e68f463a67a7b95e9424087d" id="r_ae33450c2e68f463a67a7b95e9424087d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ae33450c2e68f463a67a7b95e9424087d">test_groupby_first_returned_categorical_instead_of_dataframe</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:ae33450c2e68f463a67a7b95e9424087d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08a75e7e01f48dce9d532c67f47ed3f9" id="r_a08a75e7e01f48dce9d532c67f47ed3f9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a08a75e7e01f48dce9d532c67f47ed3f9">test_read_only_category_no_sort</a> ()</td></tr>
<tr class="separator:a08a75e7e01f48dce9d532c67f47ed3f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499cd38d4796d0bf4b7ee9d9c91480e8" id="r_a499cd38d4796d0bf4b7ee9d9c91480e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a499cd38d4796d0bf4b7ee9d9c91480e8">test_sorted_missing_category_values</a> ()</td></tr>
<tr class="separator:a499cd38d4796d0bf4b7ee9d9c91480e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc6dec5936b2110d5c401ee562353eb" id="r_a0cc6dec5936b2110d5c401ee562353eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a0cc6dec5936b2110d5c401ee562353eb">test_agg_cython_category_not_implemented_fallback</a> ()</td></tr>
<tr class="separator:a0cc6dec5936b2110d5c401ee562353eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39b11ee776fbe488bf532debba5208fd" id="r_a39b11ee776fbe488bf532debba5208fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a39b11ee776fbe488bf532debba5208fd">test_aggregate_categorical_with_isnan</a> ()</td></tr>
<tr class="separator:a39b11ee776fbe488bf532debba5208fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff7d6f537dd7599cb07d69a89b09742" id="r_aaff7d6f537dd7599cb07d69a89b09742"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#aaff7d6f537dd7599cb07d69a89b09742">test_categorical_transform</a> ()</td></tr>
<tr class="separator:aaff7d6f537dd7599cb07d69a89b09742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a263f35950ad7836b2f950b5200e995aa" id="r_a263f35950ad7836b2f950b5200e995aa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a263f35950ad7836b2f950b5200e995aa">test_series_groupby_first_on_categorical_col_grouped_on_2_categoricals</a> (str <a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, bool observed)</td></tr>
<tr class="separator:a263f35950ad7836b2f950b5200e995aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac21bb75e659fa7fdf84b12589af39434" id="r_ac21bb75e659fa7fdf84b12589af39434"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ac21bb75e659fa7fdf84b12589af39434">test_df_groupby_first_on_categorical_col_grouped_on_2_categoricals</a> (str <a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, bool observed)</td></tr>
<tr class="separator:ac21bb75e659fa7fdf84b12589af39434"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97119e1f2536f36b3cf417321acaa657" id="r_a97119e1f2536f36b3cf417321acaa657"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a97119e1f2536f36b3cf417321acaa657">test_groupby_categorical_indices_unused_categories</a> ()</td></tr>
<tr class="separator:a97119e1f2536f36b3cf417321acaa657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437486d624c6c6f4eda82faa1686ad9f" id="r_a437486d624c6c6f4eda82faa1686ad9f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a437486d624c6c6f4eda82faa1686ad9f">test_groupby_last_first_preserve_categoricaldtype</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:a437486d624c6c6f4eda82faa1686ad9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aaf418d98bae8c5f8d4ca41e9b03cd3" id="r_a4aaf418d98bae8c5f8d4ca41e9b03cd3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a4aaf418d98bae8c5f8d4ca41e9b03cd3">test_groupby_categorical_observed_nunique</a> ()</td></tr>
<tr class="separator:a4aaf418d98bae8c5f8d4ca41e9b03cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52eabf6de94879b207c942e59c460370" id="r_a52eabf6de94879b207c942e59c460370"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a52eabf6de94879b207c942e59c460370">test_groupby_categorical_aggregate_functions</a> ()</td></tr>
<tr class="separator:a52eabf6de94879b207c942e59c460370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4005fc9e60ed1727e244c9ef15c9519" id="r_ac4005fc9e60ed1727e244c9ef15c9519"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#ac4005fc9e60ed1727e244c9ef15c9519">test_groupby_categorical_dropna</a> (observed, dropna)</td></tr>
<tr class="separator:ac4005fc9e60ed1727e244c9ef15c9519"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a52f05bc75014f1eba8105115e9bb95af" id="r_a52f05bc75014f1eba8105115e9bb95af"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__categorical.html#a52f05bc75014f1eba8105115e9bb95af">_results_for_groupbys_with_missing_categories</a></td></tr>
<tr class="separator:a52f05bc75014f1eba8105115e9bb95af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a33d3d85666ceb29f160df9625b96f63d" name="a33d3d85666ceb29f160df9625b96f63d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33d3d85666ceb29f160df9625b96f63d">&#9670;&#160;</a></span>cartesian_product_for_groupers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.cartesian_product_for_groupers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fill_value</em> = <code>np.NaN</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reindex to a cartesian production for the groupers,
preserving the nature (Categorical) of each grouper
</pre> <div class="fragment"><div class="line"><span class="lineno">   20</span><span class="keyword">def </span>cartesian_product_for_groupers(result, args, names, fill_value=np.NaN):</div>
<div class="line"><span class="lineno">   21</span>    <span class="stringliteral">&quot;&quot;&quot;Reindex to a cartesian production for the groupers,</span></div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral">    preserving the nature (Categorical) of each grouper</span></div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(a):</div>
<div class="line"><span class="lineno">   26</span>        <span class="keywordflow">if</span> isinstance(a, (CategoricalIndex, Categorical)):</div>
<div class="line"><span class="lineno">   27</span>            categories = a.categories</div>
<div class="line"><span class="lineno">   28</span>            a = Categorical.from_codes(</div>
<div class="line"><span class="lineno">   29</span>                np.arange(len(categories)), categories=categories, ordered=a.ordered</div>
<div class="line"><span class="lineno">   30</span>            )</div>
<div class="line"><span class="lineno">   31</span>        <span class="keywordflow">return</span> a</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>    index = MultiIndex.from_product(map(f, args), names=names)</div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordflow">return</span> result.reindex(index, fill_value=fill_value).sort_index()</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa2cd4acab16e9f7d9577723ac6559e8" name="aaa2cd4acab16e9f7d9577723ac6559e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa2cd4acab16e9f7d9577723ac6559e8">&#9670;&#160;</a></span>df_cat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.df_cat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">DataFrame with multiple categorical columns and a column of integers.
Shortened so as not to contain all possible combinations of categories.
Useful for testing `observed` kwarg functionality on GroupBy objects.

Parameters
----------
df: DataFrame
    Non-categorical, longer DataFrame from another fixture, used to derive
    this one

Returns
-------
df_cat: DataFrame
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1202</span><span class="keyword">def </span>df_cat(df):</div>
<div class="line"><span class="lineno"> 1203</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">    DataFrame with multiple categorical columns and a column of integers.</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral">    Shortened so as not to contain all possible combinations of categories.</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">    Useful for testing `observed` kwarg functionality on GroupBy objects.</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1208</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1209</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1210</span><span class="stringliteral">    df: DataFrame</span></div>
<div class="line"><span class="lineno"> 1211</span><span class="stringliteral">        Non-categorical, longer DataFrame from another fixture, used to derive</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="stringliteral">        this one</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1214</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1215</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1216</span><span class="stringliteral">    df_cat: DataFrame</span></div>
<div class="line"><span class="lineno"> 1217</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1218</span>    df_cat = df.copy()[:4]  <span class="comment"># leave out some groups</span></div>
<div class="line"><span class="lineno"> 1219</span>    df_cat[<span class="stringliteral">&quot;A&quot;</span>] = df_cat[<span class="stringliteral">&quot;A&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1220</span>    df_cat[<span class="stringliteral">&quot;B&quot;</span>] = df_cat[<span class="stringliteral">&quot;B&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1221</span>    df_cat[<span class="stringliteral">&quot;C&quot;</span>] = Series([1, 2, 3, 4])</div>
<div class="line"><span class="lineno"> 1222</span>    df_cat = df_cat.drop([<span class="stringliteral">&quot;D&quot;</span>], axis=1)</div>
<div class="line"><span class="lineno"> 1223</span>    <span class="keywordflow">return</span> df_cat</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span><span class="preprocessor">@pytest.mark.parametrize(&quot;operation&quot;, [&quot;agg&quot;, &quot;apply&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0cc6dec5936b2110d5c401ee562353eb" name="a0cc6dec5936b2110d5c401ee562353eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc6dec5936b2110d5c401ee562353eb">&#9670;&#160;</a></span>test_agg_cython_category_not_implemented_fallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_agg_cython_category_not_implemented_fallback </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1616</span><span class="keyword">def </span>test_agg_cython_category_not_implemented_fallback():</div>
<div class="line"><span class="lineno"> 1617</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/31450</span></div>
<div class="line"><span class="lineno"> 1618</span>    df = DataFrame({<span class="stringliteral">&quot;col_num&quot;</span>: [1, 1, 2, 3]})</div>
<div class="line"><span class="lineno"> 1619</span>    df[<span class="stringliteral">&quot;col_cat&quot;</span>] = df[<span class="stringliteral">&quot;col_num&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>    result = df.groupby(<span class="stringliteral">&quot;col_num&quot;</span>).col_cat.first()</div>
<div class="line"><span class="lineno"> 1622</span> </div>
<div class="line"><span class="lineno"> 1623</span>    <span class="comment"># ordered categorical dtype should definitely be preserved;</span></div>
<div class="line"><span class="lineno"> 1624</span>    <span class="comment">#  this is unordered, so is less-clear case (if anything, it should raise)</span></div>
<div class="line"><span class="lineno"> 1625</span>    expected = Series(</div>
<div class="line"><span class="lineno"> 1626</span>        [1, 2, 3],</div>
<div class="line"><span class="lineno"> 1627</span>        index=Index([1, 2, 3], name=<span class="stringliteral">&quot;col_num&quot;</span>),</div>
<div class="line"><span class="lineno"> 1628</span>        name=<span class="stringliteral">&quot;col_cat&quot;</span>,</div>
<div class="line"><span class="lineno"> 1629</span>        dtype=df[<span class="stringliteral">&quot;col_cat&quot;</span>].dtype,</div>
<div class="line"><span class="lineno"> 1630</span>    )</div>
<div class="line"><span class="lineno"> 1631</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>    result = df.groupby(<span class="stringliteral">&quot;col_num&quot;</span>).agg({<span class="stringliteral">&quot;col_cat&quot;</span>: <span class="stringliteral">&quot;first&quot;</span>})</div>
<div class="line"><span class="lineno"> 1634</span>    expected = expected.to_frame()</div>
<div class="line"><span class="lineno"> 1635</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1636</span> </div>
<div class="line"><span class="lineno"> 1637</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a39b11ee776fbe488bf532debba5208fd" name="a39b11ee776fbe488bf532debba5208fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39b11ee776fbe488bf532debba5208fd">&#9670;&#160;</a></span>test_aggregate_categorical_with_isnan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_aggregate_categorical_with_isnan </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1638</span><span class="keyword">def </span>test_aggregate_categorical_with_isnan():</div>
<div class="line"><span class="lineno"> 1639</span>    <span class="comment"># GH 29837</span></div>
<div class="line"><span class="lineno"> 1640</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1641</span>        {</div>
<div class="line"><span class="lineno"> 1642</span>            <span class="stringliteral">&quot;A&quot;</span>: [1, 1, 1, 1],</div>
<div class="line"><span class="lineno"> 1643</span>            <span class="stringliteral">&quot;B&quot;</span>: [1, 2, 1, 2],</div>
<div class="line"><span class="lineno"> 1644</span>            <span class="stringliteral">&quot;numerical_col&quot;</span>: [0.1, 0.2, np.nan, 0.3],</div>
<div class="line"><span class="lineno"> 1645</span>            <span class="stringliteral">&quot;object_col&quot;</span>: [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;fee&quot;</span>],</div>
<div class="line"><span class="lineno"> 1646</span>            <span class="stringliteral">&quot;categorical_col&quot;</span>: [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;fee&quot;</span>],</div>
<div class="line"><span class="lineno"> 1647</span>        }</div>
<div class="line"><span class="lineno"> 1648</span>    )</div>
<div class="line"><span class="lineno"> 1649</span> </div>
<div class="line"><span class="lineno"> 1650</span>    df = df.astype({<span class="stringliteral">&quot;categorical_col&quot;</span>: <span class="stringliteral">&quot;category&quot;</span>})</div>
<div class="line"><span class="lineno"> 1651</span> </div>
<div class="line"><span class="lineno"> 1652</span>    result = df.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>]).agg(<span class="keyword">lambda</span> df: df.isna().sum())</div>
<div class="line"><span class="lineno"> 1653</span>    index = MultiIndex.from_arrays([[1, 1], [1, 2]], names=(<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>))</div>
<div class="line"><span class="lineno"> 1654</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1655</span>        data={</div>
<div class="line"><span class="lineno"> 1656</span>            <span class="stringliteral">&quot;numerical_col&quot;</span>: [1, 0],</div>
<div class="line"><span class="lineno"> 1657</span>            <span class="stringliteral">&quot;object_col&quot;</span>: [0, 0],</div>
<div class="line"><span class="lineno"> 1658</span>            <span class="stringliteral">&quot;categorical_col&quot;</span>: [0, 0],</div>
<div class="line"><span class="lineno"> 1659</span>        },</div>
<div class="line"><span class="lineno"> 1660</span>        index=index,</div>
<div class="line"><span class="lineno"> 1661</span>    )</div>
<div class="line"><span class="lineno"> 1662</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1663</span> </div>
<div class="line"><span class="lineno"> 1664</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a009dd8912d36238186fa92b6714dd212" name="a009dd8912d36238186fa92b6714dd212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a009dd8912d36238186fa92b6714dd212">&#9670;&#160;</a></span>test_apply()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_apply </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ordered</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  283</span><span class="keyword">def </span>test_apply(ordered):</div>
<div class="line"><span class="lineno">  284</span>    <span class="comment"># GH 10138</span></div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    dense = Categorical(list(<span class="stringliteral">&quot;abc&quot;</span>), ordered=ordered)</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="comment"># &#39;b&#39; is in the categories but not in the list</span></div>
<div class="line"><span class="lineno">  289</span>    missing = Categorical(list(<span class="stringliteral">&quot;aaa&quot;</span>), categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], ordered=ordered)</div>
<div class="line"><span class="lineno">  290</span>    values = np.arange(len(dense))</div>
<div class="line"><span class="lineno">  291</span>    df = DataFrame({<span class="stringliteral">&quot;missing&quot;</span>: missing, <span class="stringliteral">&quot;dense&quot;</span>: dense, <span class="stringliteral">&quot;values&quot;</span>: values})</div>
<div class="line"><span class="lineno">  292</span>    grouped = df.groupby([<span class="stringliteral">&quot;missing&quot;</span>, <span class="stringliteral">&quot;dense&quot;</span>], observed=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="comment"># missing category &#39;b&#39; should still exist in the output index</span></div>
<div class="line"><span class="lineno">  295</span>    idx = MultiIndex.from_arrays([missing, dense], names=[<span class="stringliteral">&quot;missing&quot;</span>, <span class="stringliteral">&quot;dense&quot;</span>])</div>
<div class="line"><span class="lineno">  296</span>    expected = DataFrame([0, 1, 2.0], index=idx, columns=[<span class="stringliteral">&quot;values&quot;</span>])</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    <span class="comment"># GH#21636 tracking down the xfail, in some builds np.mean(df.loc[[0]])</span></div>
<div class="line"><span class="lineno">  299</span>    <span class="comment">#  is coming back as Series([0., 1., 0.], index=[&quot;missing&quot;, &quot;dense&quot;, &quot;values&quot;])</span></div>
<div class="line"><span class="lineno">  300</span>    <span class="comment">#  when we expect Series(0., index=[&quot;values&quot;])</span></div>
<div class="line"><span class="lineno">  301</span>    <span class="keyword">with</span> tm.assert_produces_warning(</div>
<div class="line"><span class="lineno">  302</span>        FutureWarning, match=<span class="stringliteral">&quot;Select only valid&quot;</span>, check_stacklevel=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">  303</span>    ):</div>
<div class="line"><span class="lineno">  304</span>        result = grouped.apply(<span class="keyword">lambda</span> x: np.mean(x))</div>
<div class="line"><span class="lineno">  305</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    result = grouped.mean()</div>
<div class="line"><span class="lineno">  308</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    result = grouped.agg(np.mean)</div>
<div class="line"><span class="lineno">  311</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    <span class="comment"># but for transform we should still get back the original index</span></div>
<div class="line"><span class="lineno">  314</span>    idx = MultiIndex.from_arrays([missing, dense], names=[<span class="stringliteral">&quot;missing&quot;</span>, <span class="stringliteral">&quot;dense&quot;</span>])</div>
<div class="line"><span class="lineno">  315</span>    expected = Series(1, index=idx)</div>
<div class="line"><span class="lineno">  316</span>    result = grouped.apply(<span class="keyword">lambda</span> x: 1)</div>
<div class="line"><span class="lineno">  317</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:.*value of numeric_only.*:FutureWarning&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5cefc60ef22172ca01cb3dacbfda227e" name="a5cefc60ef22172ca01cb3dacbfda227e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cefc60ef22172ca01cb3dacbfda227e">&#9670;&#160;</a></span>test_apply_use_categorical_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_apply_use_categorical_name </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   70</span><span class="keyword">def </span>test_apply_use_categorical_name(df):</div>
<div class="line"><span class="lineno">   71</span>    cats = qcut(df.C, 4)</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keyword">def </span>get_stats(group):</div>
<div class="line"><span class="lineno">   74</span>        <span class="keywordflow">return</span> {</div>
<div class="line"><span class="lineno">   75</span>            <span class="stringliteral">&quot;min&quot;</span>: group.min(),</div>
<div class="line"><span class="lineno">   76</span>            <span class="stringliteral">&quot;max&quot;</span>: group.max(),</div>
<div class="line"><span class="lineno">   77</span>            <span class="stringliteral">&quot;count&quot;</span>: group.count(),</div>
<div class="line"><span class="lineno">   78</span>            <span class="stringliteral">&quot;mean&quot;</span>: group.mean(),</div>
<div class="line"><span class="lineno">   79</span>        }</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    result = df.groupby(cats, observed=<span class="keyword">False</span>).D.apply(get_stats)</div>
<div class="line"><span class="lineno">   82</span>    <span class="keyword">assert</span> result.index.names[0] == <span class="stringliteral">&quot;C&quot;</span></div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9feafef3f4f203a9a3ccb2a55fb257dc" name="a9feafef3f4f203a9a3ccb2a55fb257dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9feafef3f4f203a9a3ccb2a55fb257dc">&#9670;&#160;</a></span>test_as_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_as_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  712</span><span class="keyword">def </span>test_as_index():</div>
<div class="line"><span class="lineno">  713</span>    <span class="comment"># GH13204</span></div>
<div class="line"><span class="lineno">  714</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  715</span>        {</div>
<div class="line"><span class="lineno">  716</span>            <span class="stringliteral">&quot;cat&quot;</span>: Categorical([1, 2, 2], [1, 2, 3]),</div>
<div class="line"><span class="lineno">  717</span>            <span class="stringliteral">&quot;A&quot;</span>: [10, 11, 11],</div>
<div class="line"><span class="lineno">  718</span>            <span class="stringliteral">&quot;B&quot;</span>: [101, 102, 103],</div>
<div class="line"><span class="lineno">  719</span>        }</div>
<div class="line"><span class="lineno">  720</span>    )</div>
<div class="line"><span class="lineno">  721</span>    result = df.groupby([<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>], as_index=<span class="keyword">False</span>, observed=<span class="keyword">True</span>).sum()</div>
<div class="line"><span class="lineno">  722</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  723</span>        {</div>
<div class="line"><span class="lineno">  724</span>            <span class="stringliteral">&quot;cat&quot;</span>: Categorical([1, 2], categories=df.cat.cat.categories),</div>
<div class="line"><span class="lineno">  725</span>            <span class="stringliteral">&quot;A&quot;</span>: [10, 11],</div>
<div class="line"><span class="lineno">  726</span>            <span class="stringliteral">&quot;B&quot;</span>: [101, 205],</div>
<div class="line"><span class="lineno">  727</span>        },</div>
<div class="line"><span class="lineno">  728</span>        columns=[<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>],</div>
<div class="line"><span class="lineno">  729</span>    )</div>
<div class="line"><span class="lineno">  730</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>    <span class="comment"># function grouper</span></div>
<div class="line"><span class="lineno">  733</span>    f = <span class="keyword">lambda</span> r: df.loc[r, <span class="stringliteral">&quot;A&quot;</span>]</div>
<div class="line"><span class="lineno">  734</span>    result = df.groupby([<span class="stringliteral">&quot;cat&quot;</span>, f], as_index=<span class="keyword">False</span>, observed=<span class="keyword">True</span>).sum()</div>
<div class="line"><span class="lineno">  735</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  736</span>        {</div>
<div class="line"><span class="lineno">  737</span>            <span class="stringliteral">&quot;cat&quot;</span>: Categorical([1, 2], categories=df.cat.cat.categories),</div>
<div class="line"><span class="lineno">  738</span>            <span class="stringliteral">&quot;A&quot;</span>: [10, 22],</div>
<div class="line"><span class="lineno">  739</span>            <span class="stringliteral">&quot;B&quot;</span>: [101, 205],</div>
<div class="line"><span class="lineno">  740</span>        },</div>
<div class="line"><span class="lineno">  741</span>        columns=[<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>],</div>
<div class="line"><span class="lineno">  742</span>    )</div>
<div class="line"><span class="lineno">  743</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="comment"># another not in-axis grouper (conflicting names in index)</span></div>
<div class="line"><span class="lineno">  746</span>    s = Series([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], name=<span class="stringliteral">&quot;cat&quot;</span>)</div>
<div class="line"><span class="lineno">  747</span>    result = df.groupby([<span class="stringliteral">&quot;cat&quot;</span>, s], as_index=<span class="keyword">False</span>, observed=<span class="keyword">True</span>).sum()</div>
<div class="line"><span class="lineno">  748</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    <span class="comment"># is original index dropped?</span></div>
<div class="line"><span class="lineno">  751</span>    group_columns = [<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>]</div>
<div class="line"><span class="lineno">  752</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  753</span>        {</div>
<div class="line"><span class="lineno">  754</span>            <span class="stringliteral">&quot;cat&quot;</span>: Categorical([1, 2], categories=df.cat.cat.categories),</div>
<div class="line"><span class="lineno">  755</span>            <span class="stringliteral">&quot;A&quot;</span>: [10, 11],</div>
<div class="line"><span class="lineno">  756</span>            <span class="stringliteral">&quot;B&quot;</span>: [101, 205],</div>
<div class="line"><span class="lineno">  757</span>        },</div>
<div class="line"><span class="lineno">  758</span>        columns=[<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>],</div>
<div class="line"><span class="lineno">  759</span>    )</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordflow">for</span> name <span class="keywordflow">in</span> [<span class="keywordtype">None</span>, <span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>]:</div>
<div class="line"><span class="lineno">  762</span>        df.index = Index(list(<span class="stringliteral">&quot;abc&quot;</span>), name=name)</div>
<div class="line"><span class="lineno">  763</span>        result = df.groupby(group_columns, as_index=<span class="keyword">False</span>, observed=<span class="keyword">True</span>).sum()</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f5366204a0c4ebe8edd0d5aa99eca90" name="a1f5366204a0c4ebe8edd0d5aa99eca90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f5366204a0c4ebe8edd0d5aa99eca90">&#9670;&#160;</a></span>test_basic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_basic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   85</span><span class="keyword">def </span>test_basic():  <span class="comment"># TODO: split this test</span></div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>    cats = Categorical(</div>
<div class="line"><span class="lineno">   88</span>        [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>],</div>
<div class="line"><span class="lineno">   89</span>        categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>],</div>
<div class="line"><span class="lineno">   90</span>        ordered=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">   91</span>    )</div>
<div class="line"><span class="lineno">   92</span>    data = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 1, 2, 2, 2, 3, 4, 5], <span class="stringliteral">&quot;b&quot;</span>: cats})</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    exp_index = CategoricalIndex(list(<span class="stringliteral">&quot;abcd&quot;</span>), name=<span class="stringliteral">&quot;b&quot;</span>, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   95</span>    expected = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 2, 4, np.nan]}, index=exp_index)</div>
<div class="line"><span class="lineno">   96</span>    result = data.groupby(<span class="stringliteral">&quot;b&quot;</span>, observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">   97</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    cat1 = Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  100</span>    cat2 = Categorical([<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>], categories=[<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  101</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: cat1, <span class="stringliteral">&quot;B&quot;</span>: cat2, <span class="stringliteral">&quot;values&quot;</span>: [1, 2, 3, 4]})</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <span class="comment"># single grouper</span></div>
<div class="line"><span class="lineno">  104</span>    gb = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, observed=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  105</span>    exp_idx = CategoricalIndex([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>], name=<span class="stringliteral">&quot;A&quot;</span>, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  106</span>    expected = DataFrame({<span class="stringliteral">&quot;values&quot;</span>: Series([3, 7, 0], index=exp_idx)})</div>
<div class="line"><span class="lineno">  107</span>    msg = <span class="stringliteral">&quot;The default value of numeric_only&quot;</span></div>
<div class="line"><span class="lineno">  108</span>    <span class="keyword">with</span> tm.assert_produces_warning(FutureWarning, match=msg):</div>
<div class="line"><span class="lineno">  109</span>        result = gb.sum()</div>
<div class="line"><span class="lineno">  110</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="comment"># GH 8623</span></div>
<div class="line"><span class="lineno">  113</span>    x = DataFrame(</div>
<div class="line"><span class="lineno">  114</span>        [[1, <span class="stringliteral">&quot;John P. Doe&quot;</span>], [2, <span class="stringliteral">&quot;Jane Dove&quot;</span>], [1, <span class="stringliteral">&quot;John P. Doe&quot;</span>]],</div>
<div class="line"><span class="lineno">  115</span>        columns=[<span class="stringliteral">&quot;person_id&quot;</span>, <span class="stringliteral">&quot;person_name&quot;</span>],</div>
<div class="line"><span class="lineno">  116</span>    )</div>
<div class="line"><span class="lineno">  117</span>    x[<span class="stringliteral">&quot;person_name&quot;</span>] = Categorical(x.person_name)</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    g = x.groupby([<span class="stringliteral">&quot;person_id&quot;</span>], observed=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  120</span>    result = g.transform(<span class="keyword">lambda</span> x: x)</div>
<div class="line"><span class="lineno">  121</span>    tm.assert_frame_equal(result, x[[<span class="stringliteral">&quot;person_name&quot;</span>]])</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    result = x.drop_duplicates(<span class="stringliteral">&quot;person_name&quot;</span>)</div>
<div class="line"><span class="lineno">  124</span>    expected = x.iloc[[0, 1]]</div>
<div class="line"><span class="lineno">  125</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x):</div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">return</span> x.drop_duplicates(<span class="stringliteral">&quot;person_name&quot;</span>).iloc[0]</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    result = g.apply(f)</div>
<div class="line"><span class="lineno">  131</span>    expected = x.iloc[[0, 1]].copy()</div>
<div class="line"><span class="lineno">  132</span>    expected.index = Index([1, 2], name=<span class="stringliteral">&quot;person_id&quot;</span>)</div>
<div class="line"><span class="lineno">  133</span>    expected[<span class="stringliteral">&quot;person_name&quot;</span>] = expected[<span class="stringliteral">&quot;person_name&quot;</span>].astype(<span class="stringliteral">&quot;object&quot;</span>)</div>
<div class="line"><span class="lineno">  134</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="comment"># GH 9921</span></div>
<div class="line"><span class="lineno">  137</span>    <span class="comment"># Monotonic</span></div>
<div class="line"><span class="lineno">  138</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [5, 15, 25]})</div>
<div class="line"><span class="lineno">  139</span>    c = pd.cut(df.a, bins=[0, 10, 20, 30, 40])</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    result = df.a.groupby(c, observed=<span class="keyword">False</span>).transform(sum)</div>
<div class="line"><span class="lineno">  142</span>    tm.assert_series_equal(result, df[<span class="stringliteral">&quot;a&quot;</span>])</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    tm.assert_series_equal(</div>
<div class="line"><span class="lineno">  145</span>        df.a.groupby(c, observed=<span class="keyword">False</span>).transform(<span class="keyword">lambda</span> xs: np.sum(xs)), df[<span class="stringliteral">&quot;a&quot;</span>]</div>
<div class="line"><span class="lineno">  146</span>    )</div>
<div class="line"><span class="lineno">  147</span>    tm.assert_frame_equal(df.groupby(c, observed=<span class="keyword">False</span>).transform(sum), df[[<span class="stringliteral">&quot;a&quot;</span>]])</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    gbc = df.groupby(c, observed=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  150</span>    <span class="keyword">with</span> tm.assert_produces_warning(</div>
<div class="line"><span class="lineno">  151</span>        FutureWarning, match=<span class="stringliteral">&quot;scalar max&quot;</span>, check_stacklevel=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">  152</span>    ):</div>
<div class="line"><span class="lineno">  153</span>        <span class="comment"># stacklevel is thrown off (i think) bc the stack goes through numpy C code</span></div>
<div class="line"><span class="lineno">  154</span>        result = gbc.transform(<span class="keyword">lambda</span> xs: np.max(xs))</div>
<div class="line"><span class="lineno">  155</span>    tm.assert_frame_equal(result, df[[<span class="stringliteral">&quot;a&quot;</span>]])</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="keyword">with</span> tm.assert_produces_warning(<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  158</span>        result2 = gbc.transform(<span class="keyword">lambda</span> xs: np.max(xs, axis=0))</div>
<div class="line"><span class="lineno">  159</span>        result3 = gbc.transform(max)</div>
<div class="line"><span class="lineno">  160</span>        result4 = gbc.transform(np.maximum.reduce)</div>
<div class="line"><span class="lineno">  161</span>        result5 = gbc.transform(<span class="keyword">lambda</span> xs: np.maximum.reduce(xs))</div>
<div class="line"><span class="lineno">  162</span>    tm.assert_frame_equal(result2, df[[<span class="stringliteral">&quot;a&quot;</span>]], check_dtype=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  163</span>    tm.assert_frame_equal(result3, df[[<span class="stringliteral">&quot;a&quot;</span>]], check_dtype=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  164</span>    tm.assert_frame_equal(result4, df[[<span class="stringliteral">&quot;a&quot;</span>]])</div>
<div class="line"><span class="lineno">  165</span>    tm.assert_frame_equal(result5, df[[<span class="stringliteral">&quot;a&quot;</span>]])</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="comment"># Filter</span></div>
<div class="line"><span class="lineno">  168</span>    tm.assert_series_equal(df.a.groupby(c, observed=<span class="keyword">False</span>).filter(np.all), df[<span class="stringliteral">&quot;a&quot;</span>])</div>
<div class="line"><span class="lineno">  169</span>    tm.assert_frame_equal(df.groupby(c, observed=<span class="keyword">False</span>).filter(np.all), df)</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <span class="comment"># Non-monotonic</span></div>
<div class="line"><span class="lineno">  172</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [5, 15, 25, -5]})</div>
<div class="line"><span class="lineno">  173</span>    c = pd.cut(df.a, bins=[-10, 0, 10, 20, 30, 40])</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    result = df.a.groupby(c, observed=<span class="keyword">False</span>).transform(sum)</div>
<div class="line"><span class="lineno">  176</span>    tm.assert_series_equal(result, df[<span class="stringliteral">&quot;a&quot;</span>])</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    tm.assert_series_equal(</div>
<div class="line"><span class="lineno">  179</span>        df.a.groupby(c, observed=<span class="keyword">False</span>).transform(<span class="keyword">lambda</span> xs: np.sum(xs)), df[<span class="stringliteral">&quot;a&quot;</span>]</div>
<div class="line"><span class="lineno">  180</span>    )</div>
<div class="line"><span class="lineno">  181</span>    tm.assert_frame_equal(df.groupby(c, observed=<span class="keyword">False</span>).transform(sum), df[[<span class="stringliteral">&quot;a&quot;</span>]])</div>
<div class="line"><span class="lineno">  182</span>    tm.assert_frame_equal(</div>
<div class="line"><span class="lineno">  183</span>        df.groupby(c, observed=<span class="keyword">False</span>).transform(<span class="keyword">lambda</span> xs: np.sum(xs)), df[[<span class="stringliteral">&quot;a&quot;</span>]]</div>
<div class="line"><span class="lineno">  184</span>    )</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="comment"># GH 9603</span></div>
<div class="line"><span class="lineno">  187</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 0, 0, 0]})</div>
<div class="line"><span class="lineno">  188</span>    c = pd.cut(df.a, [0, 1, 2, 3, 4], labels=Categorical(list(<span class="stringliteral">&quot;abcd&quot;</span>)))</div>
<div class="line"><span class="lineno">  189</span>    result = df.groupby(c, observed=<span class="keyword">False</span>).apply(len)</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    exp_index = CategoricalIndex(c.values.categories, ordered=c.values.ordered)</div>
<div class="line"><span class="lineno">  192</span>    expected = Series([1, 0, 0, 0], index=exp_index)</div>
<div class="line"><span class="lineno">  193</span>    expected.index.name = <span class="stringliteral">&quot;a&quot;</span></div>
<div class="line"><span class="lineno">  194</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="comment"># more basic</span></div>
<div class="line"><span class="lineno">  197</span>    levels = [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>, <span class="stringliteral">&quot;qux&quot;</span>]</div>
<div class="line"><span class="lineno">  198</span>    codes = np.random.randint(0, 4, size=100)</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    cats = Categorical.from_codes(codes, levels, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    data = DataFrame(np.random.randn(100, 4))</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    result = data.groupby(cats, observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    expected = data.groupby(np.asarray(cats), observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  207</span>    exp_idx = CategoricalIndex(levels, categories=cats.categories, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  208</span>    expected = expected.reindex(exp_idx)</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    grouped = data.groupby(cats, observed=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  213</span>    desc_result = grouped.describe()</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    idx = cats.codes.argsort()</div>
<div class="line"><span class="lineno">  216</span>    ord_labels = np.asarray(cats).take(idx)</div>
<div class="line"><span class="lineno">  217</span>    ord_data = data.take(idx)</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>    exp_cats = Categorical(</div>
<div class="line"><span class="lineno">  220</span>        ord_labels, ordered=<span class="keyword">True</span>, categories=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>, <span class="stringliteral">&quot;qux&quot;</span>]</div>
<div class="line"><span class="lineno">  221</span>    )</div>
<div class="line"><span class="lineno">  222</span>    expected = ord_data.groupby(exp_cats, sort=<span class="keyword">False</span>, observed=<span class="keyword">False</span>).describe()</div>
<div class="line"><span class="lineno">  223</span>    tm.assert_frame_equal(desc_result, expected)</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    <span class="comment"># GH 10460</span></div>
<div class="line"><span class="lineno">  226</span>    expc = Categorical.from_codes(np.arange(4).repeat(8), levels, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  227</span>    exp = CategoricalIndex(expc)</div>
<div class="line"><span class="lineno">  228</span>    tm.assert_index_equal((desc_result.stack().index.get_level_values(0)), exp)</div>
<div class="line"><span class="lineno">  229</span>    exp = Index([<span class="stringliteral">&quot;count&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;std&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;25%&quot;</span>, <span class="stringliteral">&quot;50%&quot;</span>, <span class="stringliteral">&quot;75%&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>] * 4)</div>
<div class="line"><span class="lineno">  230</span>    tm.assert_index_equal((desc_result.stack().index.get_level_values(1)), exp)</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b64eb4f8b114126a0a6e779c9f21157" name="a2b64eb4f8b114126a0a6e779c9f21157"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b64eb4f8b114126a0a6e779c9f21157">&#9670;&#160;</a></span>test_bins_unequal_len()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_bins_unequal_len </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  680</span><span class="keyword">def </span>test_bins_unequal_len():</div>
<div class="line"><span class="lineno">  681</span>    <span class="comment"># GH3011</span></div>
<div class="line"><span class="lineno">  682</span>    series = Series([np.nan, np.nan, 1, 1, 2, 2, 3, 3, 4, 4])</div>
<div class="line"><span class="lineno">  683</span>    bins = pd.cut(series.dropna().values, 4)</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>    <span class="comment"># len(bins) != len(series) here</span></div>
<div class="line"><span class="lineno">  686</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;Grouper and axis must be same length&quot;</span>):</div>
<div class="line"><span class="lineno">  687</span>        series.groupby(bins).mean()</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  691</span>    [<span class="stringliteral">&quot;series&quot;</span>, <span class="stringliteral">&quot;data&quot;</span>],</div>
<div class="line"><span class="lineno">  692</span>    [</div>
<div class="line"><span class="lineno">  693</span>        <span class="comment"># Group a series with length and index equal to those of the grouper.</span></div>
<div class="line"><span class="lineno">  694</span>        (Series(range(4)), {<span class="stringliteral">&quot;A&quot;</span>: [0, 3], <span class="stringliteral">&quot;B&quot;</span>: [1, 2]}),</div>
<div class="line"><span class="lineno">  695</span>        <span class="comment"># Group a series with length equal to that of the grouper and index unequal to</span></div>
<div class="line"><span class="lineno">  696</span>        <span class="comment"># that of the grouper.</span></div>
<div class="line"><span class="lineno">  697</span>        (Series(range(4)).rename(<span class="keyword">lambda</span> idx: idx + 1), {<span class="stringliteral">&quot;A&quot;</span>: [2], <span class="stringliteral">&quot;B&quot;</span>: [0, 1]}),</div>
<div class="line"><span class="lineno">  698</span>        <span class="comment"># GH44179: Group a series with length unequal to that of the grouper.</span></div>
<div class="line"><span class="lineno">  699</span>        (Series(range(7)), {<span class="stringliteral">&quot;A&quot;</span>: [0, 3], <span class="stringliteral">&quot;B&quot;</span>: [1, 2]}),</div>
<div class="line"><span class="lineno">  700</span>    ],</div>
<div class="line"><span class="lineno">  701</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a87acbc6e3a33ef8ac2635558f0f711e8" name="a87acbc6e3a33ef8ac2635558f0f711e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87acbc6e3a33ef8ac2635558f0f711e8">&#9670;&#160;</a></span>test_categorical_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_categorical_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  621</span><span class="keyword">def </span>test_categorical_index():</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    s = np.random.RandomState(12345)</div>
<div class="line"><span class="lineno">  624</span>    levels = [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>, <span class="stringliteral">&quot;qux&quot;</span>]</div>
<div class="line"><span class="lineno">  625</span>    codes = s.randint(0, 4, size=20)</div>
<div class="line"><span class="lineno">  626</span>    cats = Categorical.from_codes(codes, levels, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  627</span>    df = DataFrame(np.repeat(np.arange(20), 4).reshape(-1, 4), columns=list(<span class="stringliteral">&quot;abcd&quot;</span>))</div>
<div class="line"><span class="lineno">  628</span>    df[<span class="stringliteral">&quot;cats&quot;</span>] = cats</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>    <span class="comment"># with a cat index</span></div>
<div class="line"><span class="lineno">  631</span>    result = df.set_index(<span class="stringliteral">&quot;cats&quot;</span>).groupby(level=0, observed=<span class="keyword">False</span>).sum()</div>
<div class="line"><span class="lineno">  632</span>    expected = df[list(<span class="stringliteral">&quot;abcd&quot;</span>)].groupby(cats.codes, observed=<span class="keyword">False</span>).sum()</div>
<div class="line"><span class="lineno">  633</span>    expected.index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  634</span>        Categorical.from_codes([0, 1, 2, 3], levels, ordered=<span class="keyword">True</span>), name=<span class="stringliteral">&quot;cats&quot;</span></div>
<div class="line"><span class="lineno">  635</span>    )</div>
<div class="line"><span class="lineno">  636</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>    <span class="comment"># with a cat column, should produce a cat index</span></div>
<div class="line"><span class="lineno">  639</span>    result = df.groupby(<span class="stringliteral">&quot;cats&quot;</span>, observed=<span class="keyword">False</span>).sum()</div>
<div class="line"><span class="lineno">  640</span>    expected = df[list(<span class="stringliteral">&quot;abcd&quot;</span>)].groupby(cats.codes, observed=<span class="keyword">False</span>).sum()</div>
<div class="line"><span class="lineno">  641</span>    expected.index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  642</span>        Categorical.from_codes([0, 1, 2, 3], levels, ordered=<span class="keyword">True</span>), name=<span class="stringliteral">&quot;cats&quot;</span></div>
<div class="line"><span class="lineno">  643</span>    )</div>
<div class="line"><span class="lineno">  644</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a497ad4ccb93281a0a8aa5ff062335ad5" name="a497ad4ccb93281a0a8aa5ff062335ad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a497ad4ccb93281a0a8aa5ff062335ad5">&#9670;&#160;</a></span>test_categorical_no_compress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_categorical_no_compress </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  853</span><span class="keyword">def </span>test_categorical_no_compress():</div>
<div class="line"><span class="lineno">  854</span>    data = Series(np.random.randn(9))</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>    codes = np.array([0, 0, 0, 1, 1, 1, 2, 2, 2])</div>
<div class="line"><span class="lineno">  857</span>    cats = Categorical.from_codes(codes, [0, 1, 2], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>    result = data.groupby(cats, observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  860</span>    exp = data.groupby(codes, observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>    exp.index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  863</span>        exp.index, categories=cats.categories, ordered=cats.ordered</div>
<div class="line"><span class="lineno">  864</span>    )</div>
<div class="line"><span class="lineno">  865</span>    tm.assert_series_equal(result, exp)</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>    codes = np.array([0, 0, 0, 1, 1, 1, 3, 3, 3])</div>
<div class="line"><span class="lineno">  868</span>    cats = Categorical.from_codes(codes, [0, 1, 2, 3], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>    result = data.groupby(cats, observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  871</span>    exp = data.groupby(codes, observed=<span class="keyword">False</span>).mean().reindex(cats.categories)</div>
<div class="line"><span class="lineno">  872</span>    exp.index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  873</span>        exp.index, categories=cats.categories, ordered=cats.ordered</div>
<div class="line"><span class="lineno">  874</span>    )</div>
<div class="line"><span class="lineno">  875</span>    tm.assert_series_equal(result, exp)</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>    cats = Categorical(</div>
<div class="line"><span class="lineno">  878</span>        [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>],</div>
<div class="line"><span class="lineno">  879</span>        categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>],</div>
<div class="line"><span class="lineno">  880</span>        ordered=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  881</span>    )</div>
<div class="line"><span class="lineno">  882</span>    data = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 1, 2, 2, 2, 3, 4, 5], <span class="stringliteral">&quot;b&quot;</span>: cats})</div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>    result = data.groupby(<span class="stringliteral">&quot;b&quot;</span>, observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  885</span>    result = result[<span class="stringliteral">&quot;a&quot;</span>].values</div>
<div class="line"><span class="lineno">  886</span>    exp = np.array([1, 2, 4, np.nan])</div>
<div class="line"><span class="lineno">  887</span>    tm.assert_numpy_array_equal(result, exp)</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bcdc6faa91b293db20c70b8049a9031" name="a0bcdc6faa91b293db20c70b8049a9031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bcdc6faa91b293db20c70b8049a9031">&#9670;&#160;</a></span>test_categorical_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_categorical_series </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>series</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  702</span><span class="keyword">def </span>test_categorical_series(series, data):</div>
<div class="line"><span class="lineno">  703</span>    <span class="comment"># Group the given series by a series with categorical data type such that group A</span></div>
<div class="line"><span class="lineno">  704</span>    <span class="comment"># takes indices 0 and 3 and group B indices 1 and 2, obtaining the values mapped in</span></div>
<div class="line"><span class="lineno">  705</span>    <span class="comment"># the given data.</span></div>
<div class="line"><span class="lineno">  706</span>    groupby = series.groupby(Series(list(<span class="stringliteral">&quot;ABBA&quot;</span>), dtype=<span class="stringliteral">&quot;category&quot;</span>))</div>
<div class="line"><span class="lineno">  707</span>    result = groupby.aggregate(list)</div>
<div class="line"><span class="lineno">  708</span>    expected = Series(data, index=CategoricalIndex(data.keys()))</div>
<div class="line"><span class="lineno">  709</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aaff7d6f537dd7599cb07d69a89b09742" name="aaff7d6f537dd7599cb07d69a89b09742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaff7d6f537dd7599cb07d69a89b09742">&#9670;&#160;</a></span>test_categorical_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_categorical_transform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1665</span><span class="keyword">def </span>test_categorical_transform():</div>
<div class="line"><span class="lineno"> 1666</span>    <span class="comment"># GH 29037</span></div>
<div class="line"><span class="lineno"> 1667</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1668</span>        {</div>
<div class="line"><span class="lineno"> 1669</span>            <span class="stringliteral">&quot;package_id&quot;</span>: [1, 1, 1, 2, 2, 3],</div>
<div class="line"><span class="lineno"> 1670</span>            <span class="stringliteral">&quot;status&quot;</span>: [</div>
<div class="line"><span class="lineno"> 1671</span>                <span class="stringliteral">&quot;Waiting&quot;</span>,</div>
<div class="line"><span class="lineno"> 1672</span>                <span class="stringliteral">&quot;OnTheWay&quot;</span>,</div>
<div class="line"><span class="lineno"> 1673</span>                <span class="stringliteral">&quot;Delivered&quot;</span>,</div>
<div class="line"><span class="lineno"> 1674</span>                <span class="stringliteral">&quot;Waiting&quot;</span>,</div>
<div class="line"><span class="lineno"> 1675</span>                <span class="stringliteral">&quot;OnTheWay&quot;</span>,</div>
<div class="line"><span class="lineno"> 1676</span>                <span class="stringliteral">&quot;Waiting&quot;</span>,</div>
<div class="line"><span class="lineno"> 1677</span>            ],</div>
<div class="line"><span class="lineno"> 1678</span>        }</div>
<div class="line"><span class="lineno"> 1679</span>    )</div>
<div class="line"><span class="lineno"> 1680</span> </div>
<div class="line"><span class="lineno"> 1681</span>    delivery_status_type = pd.CategoricalDtype(</div>
<div class="line"><span class="lineno"> 1682</span>        categories=[<span class="stringliteral">&quot;Waiting&quot;</span>, <span class="stringliteral">&quot;OnTheWay&quot;</span>, <span class="stringliteral">&quot;Delivered&quot;</span>], ordered=<span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 1683</span>    )</div>
<div class="line"><span class="lineno"> 1684</span>    df[<span class="stringliteral">&quot;status&quot;</span>] = df[<span class="stringliteral">&quot;status&quot;</span>].astype(delivery_status_type)</div>
<div class="line"><span class="lineno"> 1685</span>    df[<span class="stringliteral">&quot;last_status&quot;</span>] = df.groupby(<span class="stringliteral">&quot;package_id&quot;</span>)[<span class="stringliteral">&quot;status&quot;</span>].transform(max)</div>
<div class="line"><span class="lineno"> 1686</span>    result = df.copy()</div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1689</span>        {</div>
<div class="line"><span class="lineno"> 1690</span>            <span class="stringliteral">&quot;package_id&quot;</span>: [1, 1, 1, 2, 2, 3],</div>
<div class="line"><span class="lineno"> 1691</span>            <span class="stringliteral">&quot;status&quot;</span>: [</div>
<div class="line"><span class="lineno"> 1692</span>                <span class="stringliteral">&quot;Waiting&quot;</span>,</div>
<div class="line"><span class="lineno"> 1693</span>                <span class="stringliteral">&quot;OnTheWay&quot;</span>,</div>
<div class="line"><span class="lineno"> 1694</span>                <span class="stringliteral">&quot;Delivered&quot;</span>,</div>
<div class="line"><span class="lineno"> 1695</span>                <span class="stringliteral">&quot;Waiting&quot;</span>,</div>
<div class="line"><span class="lineno"> 1696</span>                <span class="stringliteral">&quot;OnTheWay&quot;</span>,</div>
<div class="line"><span class="lineno"> 1697</span>                <span class="stringliteral">&quot;Waiting&quot;</span>,</div>
<div class="line"><span class="lineno"> 1698</span>            ],</div>
<div class="line"><span class="lineno"> 1699</span>            <span class="stringliteral">&quot;last_status&quot;</span>: [</div>
<div class="line"><span class="lineno"> 1700</span>                <span class="stringliteral">&quot;Delivered&quot;</span>,</div>
<div class="line"><span class="lineno"> 1701</span>                <span class="stringliteral">&quot;Delivered&quot;</span>,</div>
<div class="line"><span class="lineno"> 1702</span>                <span class="stringliteral">&quot;Delivered&quot;</span>,</div>
<div class="line"><span class="lineno"> 1703</span>                <span class="stringliteral">&quot;OnTheWay&quot;</span>,</div>
<div class="line"><span class="lineno"> 1704</span>                <span class="stringliteral">&quot;OnTheWay&quot;</span>,</div>
<div class="line"><span class="lineno"> 1705</span>                <span class="stringliteral">&quot;Waiting&quot;</span>,</div>
<div class="line"><span class="lineno"> 1706</span>            ],</div>
<div class="line"><span class="lineno"> 1707</span>        }</div>
<div class="line"><span class="lineno"> 1708</span>    )</div>
<div class="line"><span class="lineno"> 1709</span> </div>
<div class="line"><span class="lineno"> 1710</span>    expected[<span class="stringliteral">&quot;status&quot;</span>] = expected[<span class="stringliteral">&quot;status&quot;</span>].astype(delivery_status_type)</div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>    <span class="comment"># .transform(max) should preserve ordered categoricals</span></div>
<div class="line"><span class="lineno"> 1713</span>    expected[<span class="stringliteral">&quot;last_status&quot;</span>] = expected[<span class="stringliteral">&quot;last_status&quot;</span>].astype(delivery_status_type)</div>
<div class="line"><span class="lineno"> 1714</span> </div>
<div class="line"><span class="lineno"> 1715</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1716</span> </div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span><span class="preprocessor">@pytest.mark.parametrize(&quot;func&quot;, [&quot;first&quot;, &quot;last&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="adfb74b7c31f31f430470cb27077b9a50" name="adfb74b7c31f31f430470cb27077b9a50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb74b7c31f31f430470cb27077b9a50">&#9670;&#160;</a></span>test_dataframe_categorical_ordered_observed_sort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_dataframe_categorical_ordered_observed_sort </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ordered</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  550</span><span class="keyword">def </span>test_dataframe_categorical_ordered_observed_sort(ordered, observed, sort):</div>
<div class="line"><span class="lineno">  551</span>    <span class="comment"># GH 25871: Fix groupby sorting on ordered Categoricals</span></div>
<div class="line"><span class="lineno">  552</span>    <span class="comment"># GH 25167: Groupby with observed=True doesn&#39;t sort</span></div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>    <span class="comment"># Build a dataframe with cat having one unobserved category (&#39;missing&#39;),</span></div>
<div class="line"><span class="lineno">  555</span>    <span class="comment"># and a Series with identical values</span></div>
<div class="line"><span class="lineno">  556</span>    label = Categorical(</div>
<div class="line"><span class="lineno">  557</span>        [<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>],</div>
<div class="line"><span class="lineno">  558</span>        categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;missing&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>],</div>
<div class="line"><span class="lineno">  559</span>        ordered=ordered,</div>
<div class="line"><span class="lineno">  560</span>    )</div>
<div class="line"><span class="lineno">  561</span>    val = Series([<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>])</div>
<div class="line"><span class="lineno">  562</span>    df = DataFrame({<span class="stringliteral">&quot;label&quot;</span>: label, <span class="stringliteral">&quot;val&quot;</span>: val})</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    <span class="comment"># aggregate on the Categorical</span></div>
<div class="line"><span class="lineno">  565</span>    result = df.groupby(<span class="stringliteral">&quot;label&quot;</span>, observed=observed, sort=sort)[<span class="stringliteral">&quot;val&quot;</span>].aggregate(<span class="stringliteral">&quot;first&quot;</span>)</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>    <span class="comment"># If ordering works, we expect index labels equal to aggregation results,</span></div>
<div class="line"><span class="lineno">  568</span>    <span class="comment"># except for &#39;observed=False&#39;: label &#39;missing&#39; has aggregation None</span></div>
<div class="line"><span class="lineno">  569</span>    label = Series(result.index.array, dtype=<span class="stringliteral">&quot;object&quot;</span>)</div>
<div class="line"><span class="lineno">  570</span>    aggr = Series(result.array)</div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> observed:</div>
<div class="line"><span class="lineno">  572</span>        aggr[aggr.isna()] = <span class="stringliteral">&quot;missing&quot;</span></div>
<div class="line"><span class="lineno">  573</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> all(label == aggr):</div>
<div class="line"><span class="lineno">  574</span>        msg = (</div>
<div class="line"><span class="lineno">  575</span>            <span class="stringliteral">&quot;Labels and aggregation results not consistently sorted\n&quot;</span></div>
<div class="line"><span class="lineno">  576</span>            f<span class="stringliteral">&quot;for (ordered={ordered}, observed={observed}, sort={sort})\n&quot;</span></div>
<div class="line"><span class="lineno">  577</span>            f<span class="stringliteral">&quot;Result:\n{result}&quot;</span></div>
<div class="line"><span class="lineno">  578</span>        )</div>
<div class="line"><span class="lineno">  579</span>        <span class="keyword">assert</span> <span class="keyword">False</span>, msg</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a84ec06518ebde8395f743adf8cf406f0" name="a84ec06518ebde8395f743adf8cf406f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84ec06518ebde8395f743adf8cf406f0">&#9670;&#160;</a></span>test_dataframe_categorical_with_nan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_dataframe_categorical_with_nan </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  527</span><span class="keyword">def </span>test_dataframe_categorical_with_nan(observed):</div>
<div class="line"><span class="lineno">  528</span>    <span class="comment"># GH 21151</span></div>
<div class="line"><span class="lineno">  529</span>    s1 = Categorical([np.nan, <span class="stringliteral">&quot;a&quot;</span>, np.nan, <span class="stringliteral">&quot;a&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>])</div>
<div class="line"><span class="lineno">  530</span>    s2 = Series([1, 2, 3, 4])</div>
<div class="line"><span class="lineno">  531</span>    df = DataFrame({<span class="stringliteral">&quot;s1&quot;</span>: s1, <span class="stringliteral">&quot;s2&quot;</span>: s2})</div>
<div class="line"><span class="lineno">  532</span>    result = df.groupby(<span class="stringliteral">&quot;s1&quot;</span>, observed=observed).first().reset_index()</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">if</span> observed:</div>
<div class="line"><span class="lineno">  534</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno">  535</span>            {<span class="stringliteral">&quot;s1&quot;</span>: Categorical([<span class="stringliteral">&quot;a&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]), <span class="stringliteral">&quot;s2&quot;</span>: [2]}</div>
<div class="line"><span class="lineno">  536</span>        )</div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  538</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno">  539</span>            {</div>
<div class="line"><span class="lineno">  540</span>                <span class="stringliteral">&quot;s1&quot;</span>: Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]),</div>
<div class="line"><span class="lineno">  541</span>                <span class="stringliteral">&quot;s2&quot;</span>: [2, np.nan, np.nan],</div>
<div class="line"><span class="lineno">  542</span>            }</div>
<div class="line"><span class="lineno">  543</span>        )</div>
<div class="line"><span class="lineno">  544</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span><span class="preprocessor">@pytest.mark.parametrize(&quot;ordered&quot;, [True, False])</span></div>
<div class="line"><span class="lineno">  548</span><span class="preprocessor">@pytest.mark.parametrize(&quot;observed&quot;, [True, False])</span></div>
<div class="line"><span class="lineno">  549</span><span class="preprocessor">@pytest.mark.parametrize(&quot;sort&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8a7ef0c3069681dd6dafd5284337e7c" name="aa8a7ef0c3069681dd6dafd5284337e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8a7ef0c3069681dd6dafd5284337e7c">&#9670;&#160;</a></span>test_dataframe_groupby_on_2_categoricals_when_observed_is_false()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_dataframe_groupby_on_2_categoricals_when_observed_is_false </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reduction_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1465</span>):</div>
<div class="line"><span class="lineno"> 1466</span>    <span class="comment"># GH 23865</span></div>
<div class="line"><span class="lineno"> 1467</span>    <span class="comment"># GH 27075</span></div>
<div class="line"><span class="lineno"> 1468</span>    <span class="comment"># Ensure that df.groupby, when &#39;by&#39; is two Categorical variables,</span></div>
<div class="line"><span class="lineno"> 1469</span>    <span class="comment"># returns the categories that are not in df when observed=False/None</span></div>
<div class="line"><span class="lineno"> 1470</span> </div>
<div class="line"><span class="lineno"> 1471</span>    <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;ngroup&quot;</span>:</div>
<div class="line"><span class="lineno"> 1472</span>        pytest.skip(<span class="stringliteral">&quot;ngroup does not return the Categories on the index&quot;</span>)</div>
<div class="line"><span class="lineno"> 1473</span>    warn = FutureWarning <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;mad&quot;</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1474</span> </div>
<div class="line"><span class="lineno"> 1475</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1476</span>        {</div>
<div class="line"><span class="lineno"> 1477</span>            <span class="stringliteral">&quot;cat_1&quot;</span>: Categorical(list(<span class="stringliteral">&quot;AABB&quot;</span>), categories=list(<span class="stringliteral">&quot;ABC&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1478</span>            <span class="stringliteral">&quot;cat_2&quot;</span>: Categorical(list(<span class="stringliteral">&quot;1111&quot;</span>), categories=list(<span class="stringliteral">&quot;12&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1479</span>            <span class="stringliteral">&quot;value&quot;</span>: [0.1, 0.1, 0.1, 0.1],</div>
<div class="line"><span class="lineno"> 1480</span>        }</div>
<div class="line"><span class="lineno"> 1481</span>    )</div>
<div class="line"><span class="lineno"> 1482</span>    unobserved_cats = [(<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>), (<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>), (<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>), (<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>)]</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>    df_grp = df.groupby([<span class="stringliteral">&quot;cat_1&quot;</span>, <span class="stringliteral">&quot;cat_2&quot;</span>], observed=observed)</div>
<div class="line"><span class="lineno"> 1485</span> </div>
<div class="line"><span class="lineno"> 1486</span>    args = get_groupby_method_args(reduction_func, df)</div>
<div class="line"><span class="lineno"> 1487</span>    <span class="keyword">with</span> tm.assert_produces_warning(warn, match=<span class="stringliteral">&quot;The &#39;mad&#39; method is deprecated&quot;</span>):</div>
<div class="line"><span class="lineno"> 1488</span>        res = getattr(df_grp, reduction_func)(*args)</div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span>    expected = _results_for_groupbys_with_missing_categories[reduction_func]</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span>    <span class="keywordflow">if</span> expected <span class="keywordflow">is</span> np.nan:</div>
<div class="line"><span class="lineno"> 1493</span>        <span class="keyword">assert</span> res.loc[unobserved_cats].isnull().all().all()</div>
<div class="line"><span class="lineno"> 1494</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1495</span>        <span class="keyword">assert</span> (res.loc[unobserved_cats] == expected).all().all()</div>
<div class="line"><span class="lineno"> 1496</span> </div>
<div class="line"><span class="lineno"> 1497</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e287177f9f1ebcb286912492e3df180" name="a3e287177f9f1ebcb286912492e3df180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e287177f9f1ebcb286912492e3df180">&#9670;&#160;</a></span>test_dataframe_groupby_on_2_categoricals_when_observed_is_true()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_dataframe_groupby_on_2_categoricals_when_observed_is_true </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reduction_func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1434</span><span class="keyword">def </span>test_dataframe_groupby_on_2_categoricals_when_observed_is_true(reduction_func):</div>
<div class="line"><span class="lineno"> 1435</span>    <span class="comment"># GH 23865</span></div>
<div class="line"><span class="lineno"> 1436</span>    <span class="comment"># GH 27075</span></div>
<div class="line"><span class="lineno"> 1437</span>    <span class="comment"># Ensure that df.groupby, when &#39;by&#39; is two Categorical variables,</span></div>
<div class="line"><span class="lineno"> 1438</span>    <span class="comment"># does not return the categories that are not in df when observed=True</span></div>
<div class="line"><span class="lineno"> 1439</span>    <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;ngroup&quot;</span>:</div>
<div class="line"><span class="lineno"> 1440</span>        pytest.skip(<span class="stringliteral">&quot;ngroup does not return the Categories on the index&quot;</span>)</div>
<div class="line"><span class="lineno"> 1441</span>    warn = FutureWarning <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;mad&quot;</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1442</span> </div>
<div class="line"><span class="lineno"> 1443</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1444</span>        {</div>
<div class="line"><span class="lineno"> 1445</span>            <span class="stringliteral">&quot;cat_1&quot;</span>: Categorical(list(<span class="stringliteral">&quot;AABB&quot;</span>), categories=list(<span class="stringliteral">&quot;ABC&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1446</span>            <span class="stringliteral">&quot;cat_2&quot;</span>: Categorical(list(<span class="stringliteral">&quot;1111&quot;</span>), categories=list(<span class="stringliteral">&quot;12&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1447</span>            <span class="stringliteral">&quot;value&quot;</span>: [0.1, 0.1, 0.1, 0.1],</div>
<div class="line"><span class="lineno"> 1448</span>        }</div>
<div class="line"><span class="lineno"> 1449</span>    )</div>
<div class="line"><span class="lineno"> 1450</span>    unobserved_cats = [(<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>), (<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>), (<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>), (<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>)]</div>
<div class="line"><span class="lineno"> 1451</span> </div>
<div class="line"><span class="lineno"> 1452</span>    df_grp = df.groupby([<span class="stringliteral">&quot;cat_1&quot;</span>, <span class="stringliteral">&quot;cat_2&quot;</span>], observed=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span>    args = get_groupby_method_args(reduction_func, df)</div>
<div class="line"><span class="lineno"> 1455</span>    <span class="keyword">with</span> tm.assert_produces_warning(warn, match=<span class="stringliteral">&quot;The &#39;mad&#39; method is deprecated&quot;</span>):</div>
<div class="line"><span class="lineno"> 1456</span>        res = getattr(df_grp, reduction_func)(*args)</div>
<div class="line"><span class="lineno"> 1457</span> </div>
<div class="line"><span class="lineno"> 1458</span>    <span class="keywordflow">for</span> cat <span class="keywordflow">in</span> unobserved_cats:</div>
<div class="line"><span class="lineno"> 1459</span>        <span class="keyword">assert</span> cat <span class="keywordflow">not</span> <span class="keywordflow">in</span> res.index</div>
<div class="line"><span class="lineno"> 1460</span> </div>
<div class="line"><span class="lineno"> 1461</span> </div>
<div class="line"><span class="lineno"> 1462</span><span class="preprocessor">@pytest.mark.parametrize(&quot;observed&quot;, [False, None])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57ed46781355a4313f533f63c5221b83" name="a57ed46781355a4313f533f63c5221b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57ed46781355a4313f533f63c5221b83">&#9670;&#160;</a></span>test_datetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_datetime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  582</span><span class="keyword">def </span>test_datetime():</div>
<div class="line"><span class="lineno">  583</span>    <span class="comment"># GH9049: ensure backward compatibility</span></div>
<div class="line"><span class="lineno">  584</span>    levels = pd.date_range(<span class="stringliteral">&quot;2014-01-01&quot;</span>, periods=4)</div>
<div class="line"><span class="lineno">  585</span>    codes = np.random.randint(0, 4, size=100)</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    cats = Categorical.from_codes(codes, levels, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>    data = DataFrame(np.random.randn(100, 4))</div>
<div class="line"><span class="lineno">  590</span>    result = data.groupby(cats, observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>    expected = data.groupby(np.asarray(cats), observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  593</span>    expected = expected.reindex(levels)</div>
<div class="line"><span class="lineno">  594</span>    expected.index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  595</span>        expected.index, categories=expected.index, ordered=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  596</span>    )</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>    grouped = data.groupby(cats, observed=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  601</span>    desc_result = grouped.describe()</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    idx = cats.codes.argsort()</div>
<div class="line"><span class="lineno">  604</span>    ord_labels = cats.take(idx)</div>
<div class="line"><span class="lineno">  605</span>    ord_data = data.take(idx)</div>
<div class="line"><span class="lineno">  606</span>    expected = ord_data.groupby(ord_labels, observed=<span class="keyword">False</span>).describe()</div>
<div class="line"><span class="lineno">  607</span>    tm.assert_frame_equal(desc_result, expected)</div>
<div class="line"><span class="lineno">  608</span>    tm.assert_index_equal(desc_result.index, expected.index)</div>
<div class="line"><span class="lineno">  609</span>    tm.assert_index_equal(</div>
<div class="line"><span class="lineno">  610</span>        desc_result.index.get_level_values(0), expected.index.get_level_values(0)</div>
<div class="line"><span class="lineno">  611</span>    )</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    <span class="comment"># GH 10460</span></div>
<div class="line"><span class="lineno">  614</span>    expc = Categorical.from_codes(np.arange(4).repeat(8), levels, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  615</span>    exp = CategoricalIndex(expc)</div>
<div class="line"><span class="lineno">  616</span>    tm.assert_index_equal((desc_result.stack().index.get_level_values(0)), exp)</div>
<div class="line"><span class="lineno">  617</span>    exp = Index([<span class="stringliteral">&quot;count&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;std&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;25%&quot;</span>, <span class="stringliteral">&quot;50%&quot;</span>, <span class="stringliteral">&quot;75%&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>] * 4)</div>
<div class="line"><span class="lineno">  618</span>    tm.assert_index_equal((desc_result.stack().index.get_level_values(1)), exp)</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a989f43179100cbb12b6452554cc9c956" name="a989f43179100cbb12b6452554cc9c956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a989f43179100cbb12b6452554cc9c956">&#9670;&#160;</a></span>test_describe_categorical_columns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_describe_categorical_columns </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  647</span><span class="keyword">def </span>test_describe_categorical_columns():</div>
<div class="line"><span class="lineno">  648</span>    <span class="comment"># GH 11558</span></div>
<div class="line"><span class="lineno">  649</span>    cats = CategoricalIndex(</div>
<div class="line"><span class="lineno">  650</span>        [<span class="stringliteral">&quot;qux&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>],</div>
<div class="line"><span class="lineno">  651</span>        categories=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>, <span class="stringliteral">&quot;qux&quot;</span>],</div>
<div class="line"><span class="lineno">  652</span>        ordered=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  653</span>    )</div>
<div class="line"><span class="lineno">  654</span>    df = DataFrame(np.random.randn(20, 4), columns=cats)</div>
<div class="line"><span class="lineno">  655</span>    result = df.groupby([1, 2, 3, 4] * 5).describe()</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    tm.assert_index_equal(result.stack().columns, cats)</div>
<div class="line"><span class="lineno">  658</span>    tm.assert_categorical_equal(result.stack().columns.values, cats.values)</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac21bb75e659fa7fdf84b12589af39434" name="ac21bb75e659fa7fdf84b12589af39434"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac21bb75e659fa7fdf84b12589af39434">&#9670;&#160;</a></span>test_df_groupby_first_on_categorical_col_grouped_on_2_categoricals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_df_groupby_first_on_categorical_col_grouped_on_2_categoricals </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool
&#160;</td>
          <td class="paramname"><em>observed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1746</span>):</div>
<div class="line"><span class="lineno"> 1747</span>    <span class="comment"># GH 34951</span></div>
<div class="line"><span class="lineno"> 1748</span>    cat = Categorical([0, 0, 1, 1])</div>
<div class="line"><span class="lineno"> 1749</span>    val = [0, 1, 1, 0]</div>
<div class="line"><span class="lineno"> 1750</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: cat, <span class="stringliteral">&quot;b&quot;</span>: cat, <span class="stringliteral">&quot;c&quot;</span>: val})</div>
<div class="line"><span class="lineno"> 1751</span> </div>
<div class="line"><span class="lineno"> 1752</span>    cat2 = Categorical([0, 1])</div>
<div class="line"><span class="lineno"> 1753</span>    idx = MultiIndex.from_product([cat2, cat2], names=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>])</div>
<div class="line"><span class="lineno"> 1754</span>    expected_dict = {</div>
<div class="line"><span class="lineno"> 1755</span>        <span class="stringliteral">&quot;first&quot;</span>: Series([0, np.NaN, np.NaN, 1], idx, name=<span class="stringliteral">&quot;c&quot;</span>),</div>
<div class="line"><span class="lineno"> 1756</span>        <span class="stringliteral">&quot;last&quot;</span>: Series([1, np.NaN, np.NaN, 0], idx, name=<span class="stringliteral">&quot;c&quot;</span>),</div>
<div class="line"><span class="lineno"> 1757</span>    }</div>
<div class="line"><span class="lineno"> 1758</span> </div>
<div class="line"><span class="lineno"> 1759</span>    expected = expected_dict[func].to_frame()</div>
<div class="line"><span class="lineno"> 1760</span>    <span class="keywordflow">if</span> observed:</div>
<div class="line"><span class="lineno"> 1761</span>        expected = expected.dropna().astype(np.int64)</div>
<div class="line"><span class="lineno"> 1762</span> </div>
<div class="line"><span class="lineno"> 1763</span>    df_grp = df.groupby([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], observed=observed)</div>
<div class="line"><span class="lineno"> 1764</span>    result = getattr(df_grp, func)()</div>
<div class="line"><span class="lineno"> 1765</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1766</span> </div>
<div class="line"><span class="lineno"> 1767</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2731ed8b2547924ac5aa3c0ea2505af" name="ad2731ed8b2547924ac5aa3c0ea2505af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2731ed8b2547924ac5aa3c0ea2505af">&#9670;&#160;</a></span>test_empty_prod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_empty_prod </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1104</span><span class="keyword">def </span>test_empty_prod():</div>
<div class="line"><span class="lineno"> 1105</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/18678</span></div>
<div class="line"><span class="lineno"> 1106</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1107</span>        {<span class="stringliteral">&quot;A&quot;</span>: Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]), <span class="stringliteral">&quot;B&quot;</span>: [1, 2, 1]}</div>
<div class="line"><span class="lineno"> 1108</span>    )</div>
<div class="line"><span class="lineno"> 1109</span> </div>
<div class="line"><span class="lineno"> 1110</span>    expected_idx = CategoricalIndex([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], name=<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span>    <span class="comment"># 1 by default</span></div>
<div class="line"><span class="lineno"> 1113</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, observed=<span class="keyword">False</span>).B.prod()</div>
<div class="line"><span class="lineno"> 1114</span>    expected = Series([2, 1, 1], expected_idx, name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1115</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>    <span class="comment"># min_count=0</span></div>
<div class="line"><span class="lineno"> 1118</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, observed=<span class="keyword">False</span>).B.prod(min_count=0)</div>
<div class="line"><span class="lineno"> 1119</span>    expected = Series([2, 1, 1], expected_idx, name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1120</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>    <span class="comment"># min_count=1</span></div>
<div class="line"><span class="lineno"> 1123</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, observed=<span class="keyword">False</span>).B.prod(min_count=1)</div>
<div class="line"><span class="lineno"> 1124</span>    expected = Series([2, 1, np.nan], expected_idx, name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1125</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f9022c65a3a6d9674780406f4177e89" name="a4f9022c65a3a6d9674780406f4177e89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f9022c65a3a6d9674780406f4177e89">&#9670;&#160;</a></span>test_empty_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_empty_sum </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1076</span><span class="keyword">def </span>test_empty_sum():</div>
<div class="line"><span class="lineno"> 1077</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/18678</span></div>
<div class="line"><span class="lineno"> 1078</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1079</span>        {<span class="stringliteral">&quot;A&quot;</span>: Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]), <span class="stringliteral">&quot;B&quot;</span>: [1, 2, 1]}</div>
<div class="line"><span class="lineno"> 1080</span>    )</div>
<div class="line"><span class="lineno"> 1081</span>    expected_idx = CategoricalIndex([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], name=<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span>    <span class="comment"># 0 by default</span></div>
<div class="line"><span class="lineno"> 1084</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, observed=<span class="keyword">False</span>).B.sum()</div>
<div class="line"><span class="lineno"> 1085</span>    expected = Series([3, 1, 0], expected_idx, name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1086</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span>    <span class="comment"># min_count=0</span></div>
<div class="line"><span class="lineno"> 1089</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, observed=<span class="keyword">False</span>).B.sum(min_count=0)</div>
<div class="line"><span class="lineno"> 1090</span>    expected = Series([3, 1, 0], expected_idx, name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1091</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    <span class="comment"># min_count=1</span></div>
<div class="line"><span class="lineno"> 1094</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, observed=<span class="keyword">False</span>).B.sum(min_count=1)</div>
<div class="line"><span class="lineno"> 1095</span>    expected = Series([3, 1, np.nan], expected_idx, name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1096</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1097</span> </div>
<div class="line"><span class="lineno"> 1098</span>    <span class="comment"># min_count&gt;1</span></div>
<div class="line"><span class="lineno"> 1099</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, observed=<span class="keyword">False</span>).B.sum(min_count=2)</div>
<div class="line"><span class="lineno"> 1100</span>    expected = Series([3, np.nan, np.nan], expected_idx, name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1101</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afa84d515bb545b6b5afe6413eacb0d30" name="afa84d515bb545b6b5afe6413eacb0d30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa84d515bb545b6b5afe6413eacb0d30">&#9670;&#160;</a></span>test_get_nonexistent_category()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_get_nonexistent_category </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1347</span><span class="keyword">def </span>test_get_nonexistent_category():</div>
<div class="line"><span class="lineno"> 1348</span>    <span class="comment"># Accessing a Category that is not in the dataframe</span></div>
<div class="line"><span class="lineno"> 1349</span>    df = DataFrame({<span class="stringliteral">&quot;var&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], <span class="stringliteral">&quot;val&quot;</span>: range(4)})</div>
<div class="line"><span class="lineno"> 1350</span>    <span class="keyword">with</span> pytest.raises(KeyError, match=<span class="stringliteral">&quot;&#39;vau&#39;&quot;</span>):</div>
<div class="line"><span class="lineno"> 1351</span>        df.groupby(<span class="stringliteral">&quot;var&quot;</span>).apply(</div>
<div class="line"><span class="lineno"> 1352</span>            <span class="keyword">lambda</span> rows: DataFrame(</div>
<div class="line"><span class="lineno"> 1353</span>                {<span class="stringliteral">&quot;var&quot;</span>: [rows.iloc[-1][<span class="stringliteral">&quot;var&quot;</span>]], <span class="stringliteral">&quot;val&quot;</span>: [rows.iloc[-1][<span class="stringliteral">&quot;vau&quot;</span>]]}</div>
<div class="line"><span class="lineno"> 1354</span>            )</div>
<div class="line"><span class="lineno"> 1355</span>        )</div>
<div class="line"><span class="lineno"> 1356</span> </div>
<div class="line"><span class="lineno"> 1357</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0a71ebd9488460225b0719bd11e710d" name="ad0a71ebd9488460225b0719bd11e710d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0a71ebd9488460225b0719bd11e710d">&#9670;&#160;</a></span>test_groupby_agg_categorical_columns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_agg_categorical_columns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1514</span><span class="keyword">def </span>test_groupby_agg_categorical_columns(func, expected_values):</div>
<div class="line"><span class="lineno"> 1515</span>    <span class="comment"># 31256</span></div>
<div class="line"><span class="lineno"> 1516</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1517</span>        {</div>
<div class="line"><span class="lineno"> 1518</span>            <span class="stringliteral">&quot;id&quot;</span>: [0, 1, 2, 3, 4],</div>
<div class="line"><span class="lineno"> 1519</span>            <span class="stringliteral">&quot;groups&quot;</span>: [0, 1, 1, 2, 2],</div>
<div class="line"><span class="lineno"> 1520</span>            <span class="stringliteral">&quot;value&quot;</span>: Categorical([0, 0, 0, 0, 1]),</div>
<div class="line"><span class="lineno"> 1521</span>        }</div>
<div class="line"><span class="lineno"> 1522</span>    ).set_index(<span class="stringliteral">&quot;id&quot;</span>)</div>
<div class="line"><span class="lineno"> 1523</span>    result = df.groupby(<span class="stringliteral">&quot;groups&quot;</span>).agg(func)</div>
<div class="line"><span class="lineno"> 1524</span> </div>
<div class="line"><span class="lineno"> 1525</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1526</span>        {<span class="stringliteral">&quot;value&quot;</span>: expected_values}, index=Index([0, 1, 2], name=<span class="stringliteral">&quot;groups&quot;</span>)</div>
<div class="line"><span class="lineno"> 1527</span>    )</div>
<div class="line"><span class="lineno"> 1528</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1529</span> </div>
<div class="line"><span class="lineno"> 1530</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2bb3ee7527321487db55b93d4685bd6d" name="a2bb3ee7527321487db55b93d4685bd6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bb3ee7527321487db55b93d4685bd6d">&#9670;&#160;</a></span>test_groupby_agg_non_numeric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_agg_non_numeric </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1531</span><span class="keyword">def </span>test_groupby_agg_non_numeric():</div>
<div class="line"><span class="lineno"> 1532</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>])})</div>
<div class="line"><span class="lineno"> 1533</span>    expected = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [2, 1]}, index=[1, 2])</div>
<div class="line"><span class="lineno"> 1534</span> </div>
<div class="line"><span class="lineno"> 1535</span>    result = df.groupby([1, 2, 1]).agg(Series.nunique)</div>
<div class="line"><span class="lineno"> 1536</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1537</span> </div>
<div class="line"><span class="lineno"> 1538</span>    result = df.groupby([1, 2, 1]).nunique()</div>
<div class="line"><span class="lineno"> 1539</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span><span class="preprocessor">@pytest.mark.parametrize(&quot;func&quot;, [&quot;first&quot;, &quot;last&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28b6b82b34c3933a3d526cec84350c49" name="a28b6b82b34c3933a3d526cec84350c49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28b6b82b34c3933a3d526cec84350c49">&#9670;&#160;</a></span>test_groupby_agg_observed_true_single_column()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_agg_observed_true_single_column </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>as_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1178</span><span class="keyword">def </span>test_groupby_agg_observed_true_single_column(as_index, expected):</div>
<div class="line"><span class="lineno"> 1179</span>    <span class="comment"># GH-23970</span></div>
<div class="line"><span class="lineno"> 1180</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1181</span>        {<span class="stringliteral">&quot;a&quot;</span>: Series([1, 1, 2], dtype=<span class="stringliteral">&quot;category&quot;</span>), <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 2], <span class="stringliteral">&quot;x&quot;</span>: [1, 2, 3]}</div>
<div class="line"><span class="lineno"> 1182</span>    )</div>
<div class="line"><span class="lineno"> 1183</span> </div>
<div class="line"><span class="lineno"> 1184</span>    result = df.groupby([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], as_index=as_index, observed=<span class="keyword">True</span>)[<span class="stringliteral">&quot;x&quot;</span>].sum()</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>    tm.assert_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span><span class="preprocessor">@pytest.mark.parametrize(&quot;fill_value&quot;, [None, np.nan, pd.NaT])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a79711d702b8cf4173109841795919242" name="a79711d702b8cf4173109841795919242"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79711d702b8cf4173109841795919242">&#9670;&#160;</a></span>test_groupby_cat_preserves_structure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_cat_preserves_structure </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ordered</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1330</span><span class="keyword">def </span>test_groupby_cat_preserves_structure(observed, ordered):</div>
<div class="line"><span class="lineno"> 1331</span>    <span class="comment"># GH 28787</span></div>
<div class="line"><span class="lineno"> 1332</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1333</span>        {<span class="stringliteral">&quot;Name&quot;</span>: Categorical([<span class="stringliteral">&quot;Bob&quot;</span>, <span class="stringliteral">&quot;Greg&quot;</span>], ordered=ordered), <span class="stringliteral">&quot;Item&quot;</span>: [1, 2]},</div>
<div class="line"><span class="lineno"> 1334</span>        columns=[<span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;Item&quot;</span>],</div>
<div class="line"><span class="lineno"> 1335</span>    )</div>
<div class="line"><span class="lineno"> 1336</span>    expected = df.copy()</div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span>    result = (</div>
<div class="line"><span class="lineno"> 1339</span>        df.groupby(<span class="stringliteral">&quot;Name&quot;</span>, observed=observed)</div>
<div class="line"><span class="lineno"> 1340</span>        .agg(DataFrame.sum, skipna=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1341</span>        .reset_index()</div>
<div class="line"><span class="lineno"> 1342</span>    )</div>
<div class="line"><span class="lineno"> 1343</span> </div>
<div class="line"><span class="lineno"> 1344</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a52eabf6de94879b207c942e59c460370" name="a52eabf6de94879b207c942e59c460370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52eabf6de94879b207c942e59c460370">&#9670;&#160;</a></span>test_groupby_categorical_aggregate_functions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_categorical_aggregate_functions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1815</span><span class="keyword">def </span>test_groupby_categorical_aggregate_functions():</div>
<div class="line"><span class="lineno"> 1816</span>    <span class="comment"># GH#37275</span></div>
<div class="line"><span class="lineno"> 1817</span>    dtype = pd.CategoricalDtype(categories=[<span class="stringliteral">&quot;small&quot;</span>, <span class="stringliteral">&quot;big&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1818</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1819</span>        [[1, <span class="stringliteral">&quot;small&quot;</span>], [1, <span class="stringliteral">&quot;big&quot;</span>], [2, <span class="stringliteral">&quot;small&quot;</span>]], columns=[<span class="stringliteral">&quot;grp&quot;</span>, <span class="stringliteral">&quot;description&quot;</span>]</div>
<div class="line"><span class="lineno"> 1820</span>    ).astype({<span class="stringliteral">&quot;description&quot;</span>: dtype})</div>
<div class="line"><span class="lineno"> 1821</span> </div>
<div class="line"><span class="lineno"> 1822</span>    result = df.groupby(<span class="stringliteral">&quot;grp&quot;</span>)[<span class="stringliteral">&quot;description&quot;</span>].max()</div>
<div class="line"><span class="lineno"> 1823</span>    expected = Series(</div>
<div class="line"><span class="lineno"> 1824</span>        [<span class="stringliteral">&quot;big&quot;</span>, <span class="stringliteral">&quot;small&quot;</span>],</div>
<div class="line"><span class="lineno"> 1825</span>        index=Index([1, 2], name=<span class="stringliteral">&quot;grp&quot;</span>),</div>
<div class="line"><span class="lineno"> 1826</span>        name=<span class="stringliteral">&quot;description&quot;</span>,</div>
<div class="line"><span class="lineno"> 1827</span>        dtype=pd.CategoricalDtype(categories=[<span class="stringliteral">&quot;small&quot;</span>, <span class="stringliteral">&quot;big&quot;</span>], ordered=<span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1828</span>    )</div>
<div class="line"><span class="lineno"> 1829</span> </div>
<div class="line"><span class="lineno"> 1830</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1831</span> </div>
<div class="line"><span class="lineno"> 1832</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac36ef13c1561a1f0adf8a860e4a70946" name="ac36ef13c1561a1f0adf8a860e4a70946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac36ef13c1561a1f0adf8a860e4a70946">&#9670;&#160;</a></span>test_groupby_categorical_axis_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_categorical_axis_1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1320</span><span class="keyword">def </span>test_groupby_categorical_axis_1(code):</div>
<div class="line"><span class="lineno"> 1321</span>    <span class="comment"># GH 13420</span></div>
<div class="line"><span class="lineno"> 1322</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 2, 3, 4], <span class="stringliteral">&quot;b&quot;</span>: [-1, -2, -3, -4], <span class="stringliteral">&quot;c&quot;</span>: [5, 6, 7, 8]})</div>
<div class="line"><span class="lineno"> 1323</span>    cat = Categorical.from_codes(code, categories=list(<span class="stringliteral">&quot;abc&quot;</span>))</div>
<div class="line"><span class="lineno"> 1324</span>    result = df.groupby(cat, axis=1).mean()</div>
<div class="line"><span class="lineno"> 1325</span>    expected = df.T.groupby(cat, axis=0).mean().T</div>
<div class="line"><span class="lineno"> 1326</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span> </div>
<div class="line"><span class="lineno"> 1329</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:.*Select only valid:FutureWarning&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4005fc9e60ed1727e244c9ef15c9519" name="ac4005fc9e60ed1727e244c9ef15c9519"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4005fc9e60ed1727e244c9ef15c9519">&#9670;&#160;</a></span>test_groupby_categorical_dropna()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_categorical_dropna </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dropna</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1833</span><span class="keyword">def </span>test_groupby_categorical_dropna(observed, dropna):</div>
<div class="line"><span class="lineno"> 1834</span>    <span class="comment"># GH#48645 - dropna should have no impact on the result when there are no NA values</span></div>
<div class="line"><span class="lineno"> 1835</span>    cat = Categorical([1, 2], categories=[1, 2, 3])</div>
<div class="line"><span class="lineno"> 1836</span>    df = DataFrame({<span class="stringliteral">&quot;x&quot;</span>: Categorical([1, 2], categories=[1, 2, 3]), <span class="stringliteral">&quot;y&quot;</span>: [3, 4]})</div>
<div class="line"><span class="lineno"> 1837</span>    gb = df.groupby(<span class="stringliteral">&quot;x&quot;</span>, observed=observed, dropna=dropna)</div>
<div class="line"><span class="lineno"> 1838</span>    result = gb.sum()</div>
<div class="line"><span class="lineno"> 1839</span> </div>
<div class="line"><span class="lineno"> 1840</span>    <span class="keywordflow">if</span> observed:</div>
<div class="line"><span class="lineno"> 1841</span>        expected = DataFrame({<span class="stringliteral">&quot;y&quot;</span>: [3, 4]}, index=cat)</div>
<div class="line"><span class="lineno"> 1842</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1843</span>        index = CategoricalIndex([1, 2, 3], [1, 2, 3])</div>
<div class="line"><span class="lineno"> 1844</span>        expected = DataFrame({<span class="stringliteral">&quot;y&quot;</span>: [3, 4, 0]}, index=index)</div>
<div class="line"><span class="lineno"> 1845</span>    expected.index.name = <span class="stringliteral">&quot;x&quot;</span></div>
<div class="line"><span class="lineno"> 1846</span> </div>
<div class="line"><span class="lineno"> 1847</span>    tm.assert_frame_equal(result, expected)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a97119e1f2536f36b3cf417321acaa657" name="a97119e1f2536f36b3cf417321acaa657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97119e1f2536f36b3cf417321acaa657">&#9670;&#160;</a></span>test_groupby_categorical_indices_unused_categories()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_categorical_indices_unused_categories </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1768</span><span class="keyword">def </span>test_groupby_categorical_indices_unused_categories():</div>
<div class="line"><span class="lineno"> 1769</span>    <span class="comment"># GH#38642</span></div>
<div class="line"><span class="lineno"> 1770</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1771</span>        {</div>
<div class="line"><span class="lineno"> 1772</span>            <span class="stringliteral">&quot;key&quot;</span>: Categorical([<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1773</span>            <span class="stringliteral">&quot;col&quot;</span>: range(3),</div>
<div class="line"><span class="lineno"> 1774</span>        }</div>
<div class="line"><span class="lineno"> 1775</span>    )</div>
<div class="line"><span class="lineno"> 1776</span>    grouped = df.groupby(<span class="stringliteral">&quot;key&quot;</span>, sort=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1777</span>    result = grouped.indices</div>
<div class="line"><span class="lineno"> 1778</span>    expected = {</div>
<div class="line"><span class="lineno"> 1779</span>        <span class="stringliteral">&quot;b&quot;</span>: np.array([0, 1], dtype=<span class="stringliteral">&quot;intp&quot;</span>),</div>
<div class="line"><span class="lineno"> 1780</span>        <span class="stringliteral">&quot;a&quot;</span>: np.array([2], dtype=<span class="stringliteral">&quot;intp&quot;</span>),</div>
<div class="line"><span class="lineno"> 1781</span>        <span class="stringliteral">&quot;c&quot;</span>: np.array([], dtype=<span class="stringliteral">&quot;intp&quot;</span>),</div>
<div class="line"><span class="lineno"> 1782</span>    }</div>
<div class="line"><span class="lineno"> 1783</span>    <span class="keyword">assert</span> result.keys() == expected.keys()</div>
<div class="line"><span class="lineno"> 1784</span>    <span class="keywordflow">for</span> key <span class="keywordflow">in</span> result.keys():</div>
<div class="line"><span class="lineno"> 1785</span>        tm.assert_numpy_array_equal(result[key], expected[key])</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span> </div>
<div class="line"><span class="lineno"> 1788</span><span class="preprocessor">@pytest.mark.parametrize(&quot;func&quot;, [&quot;first&quot;, &quot;last&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4aaf418d98bae8c5f8d4ca41e9b03cd3" name="a4aaf418d98bae8c5f8d4ca41e9b03cd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aaf418d98bae8c5f8d4ca41e9b03cd3">&#9670;&#160;</a></span>test_groupby_categorical_observed_nunique()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_categorical_observed_nunique </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1800</span><span class="keyword">def </span>test_groupby_categorical_observed_nunique():</div>
<div class="line"><span class="lineno"> 1801</span>    <span class="comment"># GH#45128</span></div>
<div class="line"><span class="lineno"> 1802</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 2], <span class="stringliteral">&quot;b&quot;</span>: [1, 2], <span class="stringliteral">&quot;c&quot;</span>: [10, 11]})</div>
<div class="line"><span class="lineno"> 1803</span>    df = df.astype(dtype={<span class="stringliteral">&quot;a&quot;</span>: <span class="stringliteral">&quot;category&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>: <span class="stringliteral">&quot;category&quot;</span>})</div>
<div class="line"><span class="lineno"> 1804</span>    result = df.groupby([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], observed=<span class="keyword">True</span>).nunique()[<span class="stringliteral">&quot;c&quot;</span>]</div>
<div class="line"><span class="lineno"> 1805</span>    expected = Series(</div>
<div class="line"><span class="lineno"> 1806</span>        [1, 1],</div>
<div class="line"><span class="lineno"> 1807</span>        index=MultiIndex.from_arrays(</div>
<div class="line"><span class="lineno"> 1808</span>            [CategoricalIndex([1, 2], name=<span class="stringliteral">&quot;a&quot;</span>), CategoricalIndex([1, 2], name=<span class="stringliteral">&quot;b&quot;</span>)]</div>
<div class="line"><span class="lineno"> 1809</span>        ),</div>
<div class="line"><span class="lineno"> 1810</span>        name=<span class="stringliteral">&quot;c&quot;</span>,</div>
<div class="line"><span class="lineno"> 1811</span>    )</div>
<div class="line"><span class="lineno"> 1812</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1813</span> </div>
<div class="line"><span class="lineno"> 1814</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af1faea3f0341c5b06ab0b2f58e032863" name="af1faea3f0341c5b06ab0b2f58e032863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1faea3f0341c5b06ab0b2f58e032863">&#9670;&#160;</a></span>test_groupby_categorical_series_dataframe_consistent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_categorical_series_dataframe_consistent </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df_cat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1312</span><span class="keyword">def </span>test_groupby_categorical_series_dataframe_consistent(df_cat):</div>
<div class="line"><span class="lineno"> 1313</span>    <span class="comment"># GH 20416</span></div>
<div class="line"><span class="lineno"> 1314</span>    expected = df_cat.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>])[<span class="stringliteral">&quot;C&quot;</span>].mean()</div>
<div class="line"><span class="lineno"> 1315</span>    result = df_cat.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>]).mean()[<span class="stringliteral">&quot;C&quot;</span>]</div>
<div class="line"><span class="lineno"> 1316</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span> </div>
<div class="line"><span class="lineno"> 1319</span><span class="preprocessor">@pytest.mark.parametrize(&quot;code&quot;, [([1, 0, 0])</span>, ([0, 0, 0])])</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2d3f824f8f37ac3c1ca3497c577781f" name="ab2d3f824f8f37ac3c1ca3497c577781f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2d3f824f8f37ac3c1ca3497c577781f">&#9670;&#160;</a></span>test_groupby_empty_with_category()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_empty_with_category </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  890</span><span class="keyword">def </span>test_groupby_empty_with_category():</div>
<div class="line"><span class="lineno">  891</span>    <span class="comment"># GH-9614</span></div>
<div class="line"><span class="lineno">  892</span>    <span class="comment"># test fix for when group by on None resulted in</span></div>
<div class="line"><span class="lineno">  893</span>    <span class="comment"># coercion of dtype categorical -&gt; float</span></div>
<div class="line"><span class="lineno">  894</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [<span class="keywordtype">None</span>] * 3, <span class="stringliteral">&quot;B&quot;</span>: Categorical([<span class="stringliteral">&quot;train&quot;</span>, <span class="stringliteral">&quot;train&quot;</span>, <span class="stringliteral">&quot;test&quot;</span>])})</div>
<div class="line"><span class="lineno">  895</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).first()[<span class="stringliteral">&quot;B&quot;</span>]</div>
<div class="line"><span class="lineno">  896</span>    expected = Series(</div>
<div class="line"><span class="lineno">  897</span>        Categorical([], categories=[<span class="stringliteral">&quot;test&quot;</span>, <span class="stringliteral">&quot;train&quot;</span>]),</div>
<div class="line"><span class="lineno">  898</span>        index=Series([], dtype=<span class="stringliteral">&quot;object&quot;</span>, name=<span class="stringliteral">&quot;A&quot;</span>),</div>
<div class="line"><span class="lineno">  899</span>        name=<span class="stringliteral">&quot;B&quot;</span>,</div>
<div class="line"><span class="lineno">  900</span>    )</div>
<div class="line"><span class="lineno">  901</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae33450c2e68f463a67a7b95e9424087d" name="ae33450c2e68f463a67a7b95e9424087d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33450c2e68f463a67a7b95e9424087d">&#9670;&#160;</a></span>test_groupby_first_returned_categorical_instead_of_dataframe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_first_returned_categorical_instead_of_dataframe </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1543</span><span class="keyword">def </span>test_groupby_first_returned_categorical_instead_of_dataframe(func):</div>
<div class="line"><span class="lineno"> 1544</span>    <span class="comment"># GH 28641: groupby drops index, when grouping over categorical column with</span></div>
<div class="line"><span class="lineno"> 1545</span>    <span class="comment"># first/last. Renamed Categorical instead of DataFrame previously.</span></div>
<div class="line"><span class="lineno"> 1546</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [1997], <span class="stringliteral">&quot;B&quot;</span>: Series([<span class="stringliteral">&quot;b&quot;</span>], dtype=<span class="stringliteral">&quot;category&quot;</span>).cat.as_ordered()})</div>
<div class="line"><span class="lineno"> 1547</span>    df_grouped = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)[<span class="stringliteral">&quot;B&quot;</span>]</div>
<div class="line"><span class="lineno"> 1548</span>    result = getattr(df_grouped, func)()</div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span>    <span class="comment"># ordered categorical dtype should be preserved</span></div>
<div class="line"><span class="lineno"> 1551</span>    expected = Series(</div>
<div class="line"><span class="lineno"> 1552</span>        [<span class="stringliteral">&quot;b&quot;</span>], index=Index([1997], name=<span class="stringliteral">&quot;A&quot;</span>), name=<span class="stringliteral">&quot;B&quot;</span>, dtype=df[<span class="stringliteral">&quot;B&quot;</span>].dtype</div>
<div class="line"><span class="lineno"> 1553</span>    )</div>
<div class="line"><span class="lineno"> 1554</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1555</span> </div>
<div class="line"><span class="lineno"> 1556</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a437486d624c6c6f4eda82faa1686ad9f" name="a437486d624c6c6f4eda82faa1686ad9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437486d624c6c6f4eda82faa1686ad9f">&#9670;&#160;</a></span>test_groupby_last_first_preserve_categoricaldtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_last_first_preserve_categoricaldtype </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1789</span><span class="keyword">def </span>test_groupby_last_first_preserve_categoricaldtype(func):</div>
<div class="line"><span class="lineno"> 1790</span>    <span class="comment"># GH#33090</span></div>
<div class="line"><span class="lineno"> 1791</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 2, 3]})</div>
<div class="line"><span class="lineno"> 1792</span>    df[<span class="stringliteral">&quot;b&quot;</span>] = df[<span class="stringliteral">&quot;a&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1793</span>    result = getattr(df.groupby(<span class="stringliteral">&quot;a&quot;</span>)[<span class="stringliteral">&quot;b&quot;</span>], func)()</div>
<div class="line"><span class="lineno"> 1794</span>    expected = Series(</div>
<div class="line"><span class="lineno"> 1795</span>        Categorical([1, 2, 3]), name=<span class="stringliteral">&quot;b&quot;</span>, index=Index([1, 2, 3], name=<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno"> 1796</span>    )</div>
<div class="line"><span class="lineno"> 1797</span>    tm.assert_series_equal(expected, result)</div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9b75588a318852deb0d70c8fe468472" name="aa9b75588a318852deb0d70c8fe468472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9b75588a318852deb0d70c8fe468472">&#9670;&#160;</a></span>test_groupby_multiindex_categorical_datetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_groupby_multiindex_categorical_datetime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1128</span><span class="keyword">def </span>test_groupby_multiindex_categorical_datetime():</div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/21390</span></div>
<div class="line"><span class="lineno"> 1130</span> </div>
<div class="line"><span class="lineno"> 1131</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1132</span>        {</div>
<div class="line"><span class="lineno"> 1133</span>            <span class="stringliteral">&quot;key1&quot;</span>: Categorical(list(<span class="stringliteral">&quot;abcbabcba&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1134</span>            <span class="stringliteral">&quot;key2&quot;</span>: Categorical(</div>
<div class="line"><span class="lineno"> 1135</span>                list(pd.date_range(<span class="stringliteral">&quot;2018-06-01 00&quot;</span>, freq=<span class="stringliteral">&quot;1T&quot;</span>, periods=3)) * 3</div>
<div class="line"><span class="lineno"> 1136</span>            ),</div>
<div class="line"><span class="lineno"> 1137</span>            <span class="stringliteral">&quot;values&quot;</span>: np.arange(9),</div>
<div class="line"><span class="lineno"> 1138</span>        }</div>
<div class="line"><span class="lineno"> 1139</span>    )</div>
<div class="line"><span class="lineno"> 1140</span>    result = df.groupby([<span class="stringliteral">&quot;key1&quot;</span>, <span class="stringliteral">&quot;key2&quot;</span>]).mean()</div>
<div class="line"><span class="lineno"> 1141</span> </div>
<div class="line"><span class="lineno"> 1142</span>    idx = MultiIndex.from_product(</div>
<div class="line"><span class="lineno"> 1143</span>        [</div>
<div class="line"><span class="lineno"> 1144</span>            Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1145</span>            Categorical(pd.date_range(<span class="stringliteral">&quot;2018-06-01 00&quot;</span>, freq=<span class="stringliteral">&quot;1T&quot;</span>, periods=3)),</div>
<div class="line"><span class="lineno"> 1146</span>        ],</div>
<div class="line"><span class="lineno"> 1147</span>        names=[<span class="stringliteral">&quot;key1&quot;</span>, <span class="stringliteral">&quot;key2&quot;</span>],</div>
<div class="line"><span class="lineno"> 1148</span>    )</div>
<div class="line"><span class="lineno"> 1149</span>    expected = DataFrame({<span class="stringliteral">&quot;values&quot;</span>: [0, 4, 8, 3, 4, 5, 6, np.nan, 2]}, index=idx)</div>
<div class="line"><span class="lineno"> 1150</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span> </div>
<div class="line"><span class="lineno"> 1153</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1154</span>    <span class="stringliteral">&quot;as_index, expected&quot;</span>,</div>
<div class="line"><span class="lineno"> 1155</span>    [</div>
<div class="line"><span class="lineno"> 1156</span>        (</div>
<div class="line"><span class="lineno"> 1157</span>            <span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1158</span>            Series(</div>
<div class="line"><span class="lineno"> 1159</span>                index=MultiIndex.from_arrays(</div>
<div class="line"><span class="lineno"> 1160</span>                    [Series([1, 1, 2], dtype=<span class="stringliteral">&quot;category&quot;</span>), [1, 2, 2]], names=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>]</div>
<div class="line"><span class="lineno"> 1161</span>                ),</div>
<div class="line"><span class="lineno"> 1162</span>                data=[1, 2, 3],</div>
<div class="line"><span class="lineno"> 1163</span>                name=<span class="stringliteral">&quot;x&quot;</span>,</div>
<div class="line"><span class="lineno"> 1164</span>            ),</div>
<div class="line"><span class="lineno"> 1165</span>        ),</div>
<div class="line"><span class="lineno"> 1166</span>        (</div>
<div class="line"><span class="lineno"> 1167</span>            <span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1168</span>            DataFrame(</div>
<div class="line"><span class="lineno"> 1169</span>                {</div>
<div class="line"><span class="lineno"> 1170</span>                    <span class="stringliteral">&quot;a&quot;</span>: Series([1, 1, 2], dtype=<span class="stringliteral">&quot;category&quot;</span>),</div>
<div class="line"><span class="lineno"> 1171</span>                    <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 2],</div>
<div class="line"><span class="lineno"> 1172</span>                    <span class="stringliteral">&quot;x&quot;</span>: [1, 2, 3],</div>
<div class="line"><span class="lineno"> 1173</span>                }</div>
<div class="line"><span class="lineno"> 1174</span>            ),</div>
<div class="line"><span class="lineno"> 1175</span>        ),</div>
<div class="line"><span class="lineno"> 1176</span>    ],</div>
<div class="line"><span class="lineno"> 1177</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5bb19b9d23b47b07e9dd74d45ff1432" name="af5bb19b9d23b47b07e9dd74d45ff1432"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5bb19b9d23b47b07e9dd74d45ff1432">&#9670;&#160;</a></span>test_level_get_group()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_level_get_group </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  233</span><span class="keyword">def </span>test_level_get_group(observed):</div>
<div class="line"><span class="lineno">  234</span>    <span class="comment"># GH15155</span></div>
<div class="line"><span class="lineno">  235</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  236</span>        data=np.arange(2, 22, 2),</div>
<div class="line"><span class="lineno">  237</span>        index=MultiIndex(</div>
<div class="line"><span class="lineno">  238</span>            levels=[CategoricalIndex([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>]), range(10)],</div>
<div class="line"><span class="lineno">  239</span>            codes=[[0] * 5 + [1] * 5, range(10)],</div>
<div class="line"><span class="lineno">  240</span>            names=[<span class="stringliteral">&quot;Index1&quot;</span>, <span class="stringliteral">&quot;Index2&quot;</span>],</div>
<div class="line"><span class="lineno">  241</span>        ),</div>
<div class="line"><span class="lineno">  242</span>    )</div>
<div class="line"><span class="lineno">  243</span>    g = df.groupby(level=[<span class="stringliteral">&quot;Index1&quot;</span>], observed=observed)</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>    <span class="comment"># expected should equal test.loc[[&quot;a&quot;]]</span></div>
<div class="line"><span class="lineno">  246</span>    <span class="comment"># GH15166</span></div>
<div class="line"><span class="lineno">  247</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  248</span>        data=np.arange(2, 12, 2),</div>
<div class="line"><span class="lineno">  249</span>        index=MultiIndex(</div>
<div class="line"><span class="lineno">  250</span>            levels=[CategoricalIndex([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>]), range(5)],</div>
<div class="line"><span class="lineno">  251</span>            codes=[[0] * 5, range(5)],</div>
<div class="line"><span class="lineno">  252</span>            names=[<span class="stringliteral">&quot;Index1&quot;</span>, <span class="stringliteral">&quot;Index2&quot;</span>],</div>
<div class="line"><span class="lineno">  253</span>        ),</div>
<div class="line"><span class="lineno">  254</span>    )</div>
<div class="line"><span class="lineno">  255</span>    result = g.get_group(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e0a3a8cb1f523bbbf97781f8052e005" name="a3e0a3a8cb1f523bbbf97781f8052e005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e0a3a8cb1f523bbbf97781f8052e005">&#9670;&#160;</a></span>test_observed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_observed </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  321</span><span class="keyword">def </span>test_observed(observed):</div>
<div class="line"><span class="lineno">  322</span>    <span class="comment"># multiple groupers, don&#39;t re-expand the output space</span></div>
<div class="line"><span class="lineno">  323</span>    <span class="comment"># of the grouper</span></div>
<div class="line"><span class="lineno">  324</span>    <span class="comment"># gh-14942 (implement)</span></div>
<div class="line"><span class="lineno">  325</span>    <span class="comment"># gh-10132 (back-compat)</span></div>
<div class="line"><span class="lineno">  326</span>    <span class="comment"># gh-8138 (back-compat)</span></div>
<div class="line"><span class="lineno">  327</span>    <span class="comment"># gh-8869</span></div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>    cat1 = Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  330</span>    cat2 = Categorical([<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>], categories=[<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  331</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: cat1, <span class="stringliteral">&quot;B&quot;</span>: cat2, <span class="stringliteral">&quot;values&quot;</span>: [1, 2, 3, 4]})</div>
<div class="line"><span class="lineno">  332</span>    df[<span class="stringliteral">&quot;C&quot;</span>] = [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>] * 2</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <span class="comment"># multiple groupers with a non-cat</span></div>
<div class="line"><span class="lineno">  335</span>    gb = df.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>], observed=observed)</div>
<div class="line"><span class="lineno">  336</span>    exp_index = MultiIndex.from_arrays(</div>
<div class="line"><span class="lineno">  337</span>        [cat1, cat2, [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>] * 2], names=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>]</div>
<div class="line"><span class="lineno">  338</span>    )</div>
<div class="line"><span class="lineno">  339</span>    expected = DataFrame({<span class="stringliteral">&quot;values&quot;</span>: Series([1, 2, 3, 4], index=exp_index)}).sort_index()</div>
<div class="line"><span class="lineno">  340</span>    result = gb.sum()</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> observed:</div>
<div class="line"><span class="lineno">  342</span>        expected = cartesian_product_for_groupers(</div>
<div class="line"><span class="lineno">  343</span>            expected, [cat1, cat2, [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]], list(<span class="stringliteral">&quot;ABC&quot;</span>), fill_value=0</div>
<div class="line"><span class="lineno">  344</span>        )</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    gb = df.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], observed=observed)</div>
<div class="line"><span class="lineno">  349</span>    exp_index = MultiIndex.from_arrays([cat1, cat2], names=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>])</div>
<div class="line"><span class="lineno">  350</span>    expected = DataFrame({<span class="stringliteral">&quot;values&quot;</span>: [1, 2, 3, 4]}, index=exp_index)</div>
<div class="line"><span class="lineno">  351</span>    result = gb.sum()</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> observed:</div>
<div class="line"><span class="lineno">  353</span>        expected = cartesian_product_for_groupers(</div>
<div class="line"><span class="lineno">  354</span>            expected, [cat1, cat2], list(<span class="stringliteral">&quot;AB&quot;</span>), fill_value=0</div>
<div class="line"><span class="lineno">  355</span>        )</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/8138</span></div>
<div class="line"><span class="lineno">  360</span>    d = {</div>
<div class="line"><span class="lineno">  361</span>        <span class="stringliteral">&quot;cat&quot;</span>: Categorical(</div>
<div class="line"><span class="lineno">  362</span>            [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], ordered=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  363</span>        ),</div>
<div class="line"><span class="lineno">  364</span>        <span class="stringliteral">&quot;ints&quot;</span>: [1, 1, 2, 2],</div>
<div class="line"><span class="lineno">  365</span>        <span class="stringliteral">&quot;val&quot;</span>: [10, 20, 30, 40],</div>
<div class="line"><span class="lineno">  366</span>    }</div>
<div class="line"><span class="lineno">  367</span>    df = DataFrame(d)</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>    <span class="comment"># Grouping on a single column</span></div>
<div class="line"><span class="lineno">  370</span>    groups_single_key = df.groupby(<span class="stringliteral">&quot;cat&quot;</span>, observed=observed)</div>
<div class="line"><span class="lineno">  371</span>    result = groups_single_key.mean()</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    exp_index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  374</span>        list(<span class="stringliteral">&quot;ab&quot;</span>), name=<span class="stringliteral">&quot;cat&quot;</span>, categories=list(<span class="stringliteral">&quot;abc&quot;</span>), ordered=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  375</span>    )</div>
<div class="line"><span class="lineno">  376</span>    expected = DataFrame({<span class="stringliteral">&quot;ints&quot;</span>: [1.5, 1.5], <span class="stringliteral">&quot;val&quot;</span>: [20.0, 30]}, index=exp_index)</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> observed:</div>
<div class="line"><span class="lineno">  378</span>        index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  379</span>            list(<span class="stringliteral">&quot;abc&quot;</span>), name=<span class="stringliteral">&quot;cat&quot;</span>, categories=list(<span class="stringliteral">&quot;abc&quot;</span>), ordered=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  380</span>        )</div>
<div class="line"><span class="lineno">  381</span>        expected = expected.reindex(index)</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    <span class="comment"># Grouping on two columns</span></div>
<div class="line"><span class="lineno">  386</span>    groups_double_key = df.groupby([<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;ints&quot;</span>], observed=observed)</div>
<div class="line"><span class="lineno">  387</span>    result = groups_double_key.agg(<span class="stringliteral">&quot;mean&quot;</span>)</div>
<div class="line"><span class="lineno">  388</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  389</span>        {</div>
<div class="line"><span class="lineno">  390</span>            <span class="stringliteral">&quot;val&quot;</span>: [10.0, 30.0, 20.0, 40.0],</div>
<div class="line"><span class="lineno">  391</span>            <span class="stringliteral">&quot;cat&quot;</span>: Categorical(</div>
<div class="line"><span class="lineno">  392</span>                [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], ordered=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  393</span>            ),</div>
<div class="line"><span class="lineno">  394</span>            <span class="stringliteral">&quot;ints&quot;</span>: [1, 2, 1, 2],</div>
<div class="line"><span class="lineno">  395</span>        }</div>
<div class="line"><span class="lineno">  396</span>    ).set_index([<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;ints&quot;</span>])</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> observed:</div>
<div class="line"><span class="lineno">  398</span>        expected = cartesian_product_for_groupers(</div>
<div class="line"><span class="lineno">  399</span>            expected, [df.cat.values, [1, 2]], [<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;ints&quot;</span>]</div>
<div class="line"><span class="lineno">  400</span>        )</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    <span class="comment"># GH 10132</span></div>
<div class="line"><span class="lineno">  405</span>    <span class="keywordflow">for</span> key <span class="keywordflow">in</span> [(<span class="stringliteral">&quot;a&quot;</span>, 1), (<span class="stringliteral">&quot;b&quot;</span>, 2), (<span class="stringliteral">&quot;b&quot;</span>, 1), (<span class="stringliteral">&quot;a&quot;</span>, 2)]:</div>
<div class="line"><span class="lineno">  406</span>        c, i = key</div>
<div class="line"><span class="lineno">  407</span>        result = groups_double_key.get_group(key)</div>
<div class="line"><span class="lineno">  408</span>        expected = df[(df.cat == c) &amp; (df.ints == i)]</div>
<div class="line"><span class="lineno">  409</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    <span class="comment"># gh-8869</span></div>
<div class="line"><span class="lineno">  412</span>    <span class="comment"># with as_index</span></div>
<div class="line"><span class="lineno">  413</span>    d = {</div>
<div class="line"><span class="lineno">  414</span>        <span class="stringliteral">&quot;foo&quot;</span>: [10, 8, 4, 8, 4, 1, 1],</div>
<div class="line"><span class="lineno">  415</span>        <span class="stringliteral">&quot;bar&quot;</span>: [10, 20, 30, 40, 50, 60, 70],</div>
<div class="line"><span class="lineno">  416</span>        <span class="stringliteral">&quot;baz&quot;</span>: [<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>],</div>
<div class="line"><span class="lineno">  417</span>    }</div>
<div class="line"><span class="lineno">  418</span>    df = DataFrame(d)</div>
<div class="line"><span class="lineno">  419</span>    cat = pd.cut(df[<span class="stringliteral">&quot;foo&quot;</span>], np.linspace(0, 10, 3))</div>
<div class="line"><span class="lineno">  420</span>    df[<span class="stringliteral">&quot;range&quot;</span>] = cat</div>
<div class="line"><span class="lineno">  421</span>    groups = df.groupby([<span class="stringliteral">&quot;range&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>], as_index=<span class="keyword">False</span>, observed=observed)</div>
<div class="line"><span class="lineno">  422</span>    result = groups.agg(<span class="stringliteral">&quot;mean&quot;</span>)</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    groups2 = df.groupby([<span class="stringliteral">&quot;range&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>], as_index=<span class="keyword">True</span>, observed=observed)</div>
<div class="line"><span class="lineno">  425</span>    expected = groups2.agg(<span class="stringliteral">&quot;mean&quot;</span>).reset_index()</div>
<div class="line"><span class="lineno">  426</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac00c999a0bd19452f4a01017298acf40" name="ac00c999a0bd19452f4a01017298acf40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac00c999a0bd19452f4a01017298acf40">&#9670;&#160;</a></span>test_observed_codes_remap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_observed_codes_remap </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  429</span><span class="keyword">def </span>test_observed_codes_remap(observed):</div>
<div class="line"><span class="lineno">  430</span>    d = {<span class="stringliteral">&quot;C1&quot;</span>: [3, 3, 4, 5], <span class="stringliteral">&quot;C2&quot;</span>: [1, 2, 3, 4], <span class="stringliteral">&quot;C3&quot;</span>: [10, 100, 200, 34]}</div>
<div class="line"><span class="lineno">  431</span>    df = DataFrame(d)</div>
<div class="line"><span class="lineno">  432</span>    values = pd.cut(df[<span class="stringliteral">&quot;C1&quot;</span>], [1, 2, 3, 6])</div>
<div class="line"><span class="lineno">  433</span>    values.name = <span class="stringliteral">&quot;cat&quot;</span></div>
<div class="line"><span class="lineno">  434</span>    groups_double_key = df.groupby([values, <span class="stringliteral">&quot;C2&quot;</span>], observed=observed)</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    idx = MultiIndex.from_arrays([values, [1, 2, 3, 4]], names=[<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;C2&quot;</span>])</div>
<div class="line"><span class="lineno">  437</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  438</span>        {<span class="stringliteral">&quot;C1&quot;</span>: [3.0, 3.0, 4.0, 5.0], <span class="stringliteral">&quot;C3&quot;</span>: [10.0, 100.0, 200.0, 34.0]}, index=idx</div>
<div class="line"><span class="lineno">  439</span>    )</div>
<div class="line"><span class="lineno">  440</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> observed:</div>
<div class="line"><span class="lineno">  441</span>        expected = cartesian_product_for_groupers(</div>
<div class="line"><span class="lineno">  442</span>            expected, [values.values, [1, 2, 3, 4]], [<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;C2&quot;</span>]</div>
<div class="line"><span class="lineno">  443</span>        )</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    result = groups_double_key.agg(<span class="stringliteral">&quot;mean&quot;</span>)</div>
<div class="line"><span class="lineno">  446</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ace5e015674a783d2eebf1328264f50d7" name="ace5e015674a783d2eebf1328264f50d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace5e015674a783d2eebf1328264f50d7">&#9670;&#160;</a></span>test_observed_groups()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_observed_groups </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  470</span><span class="keyword">def </span>test_observed_groups(observed):</div>
<div class="line"><span class="lineno">  471</span>    <span class="comment"># gh-20583</span></div>
<div class="line"><span class="lineno">  472</span>    <span class="comment"># test that we have the appropriate groups</span></div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>    cat = Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>])</div>
<div class="line"><span class="lineno">  475</span>    df = DataFrame({<span class="stringliteral">&quot;cat&quot;</span>: cat, <span class="stringliteral">&quot;vals&quot;</span>: [1, 2, 3]})</div>
<div class="line"><span class="lineno">  476</span>    g = df.groupby(<span class="stringliteral">&quot;cat&quot;</span>, observed=observed)</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    result = g.groups</div>
<div class="line"><span class="lineno">  479</span>    <span class="keywordflow">if</span> observed:</div>
<div class="line"><span class="lineno">  480</span>        expected = {<span class="stringliteral">&quot;a&quot;</span>: Index([0, 2], dtype=<span class="stringliteral">&quot;int64&quot;</span>), <span class="stringliteral">&quot;c&quot;</span>: Index([1], dtype=<span class="stringliteral">&quot;int64&quot;</span>)}</div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  482</span>        expected = {</div>
<div class="line"><span class="lineno">  483</span>            <span class="stringliteral">&quot;a&quot;</span>: Index([0, 2], dtype=<span class="stringliteral">&quot;int64&quot;</span>),</div>
<div class="line"><span class="lineno">  484</span>            <span class="stringliteral">&quot;b&quot;</span>: Index([], dtype=<span class="stringliteral">&quot;int64&quot;</span>),</div>
<div class="line"><span class="lineno">  485</span>            <span class="stringliteral">&quot;c&quot;</span>: Index([1], dtype=<span class="stringliteral">&quot;int64&quot;</span>),</div>
<div class="line"><span class="lineno">  486</span>        }</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    tm.assert_dict_equal(result, expected)</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acd40fce37d1a21fa0dfbc86199438d41" name="acd40fce37d1a21fa0dfbc86199438d41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd40fce37d1a21fa0dfbc86199438d41">&#9670;&#160;</a></span>test_observed_groups_with_nan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_observed_groups_with_nan </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  491</span><span class="keyword">def </span>test_observed_groups_with_nan(observed):</div>
<div class="line"><span class="lineno">  492</span>    <span class="comment"># GH 24740</span></div>
<div class="line"><span class="lineno">  493</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  494</span>        {</div>
<div class="line"><span class="lineno">  495</span>            <span class="stringliteral">&quot;cat&quot;</span>: Categorical([<span class="stringliteral">&quot;a&quot;</span>, np.nan, <span class="stringliteral">&quot;a&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>]),</div>
<div class="line"><span class="lineno">  496</span>            <span class="stringliteral">&quot;vals&quot;</span>: [1, 2, 3],</div>
<div class="line"><span class="lineno">  497</span>        }</div>
<div class="line"><span class="lineno">  498</span>    )</div>
<div class="line"><span class="lineno">  499</span>    g = df.groupby(<span class="stringliteral">&quot;cat&quot;</span>, observed=observed)</div>
<div class="line"><span class="lineno">  500</span>    result = g.groups</div>
<div class="line"><span class="lineno">  501</span>    <span class="keywordflow">if</span> observed:</div>
<div class="line"><span class="lineno">  502</span>        expected = {<span class="stringliteral">&quot;a&quot;</span>: Index([0, 2], dtype=<span class="stringliteral">&quot;int64&quot;</span>)}</div>
<div class="line"><span class="lineno">  503</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  504</span>        expected = {</div>
<div class="line"><span class="lineno">  505</span>            <span class="stringliteral">&quot;a&quot;</span>: Index([0, 2], dtype=<span class="stringliteral">&quot;int64&quot;</span>),</div>
<div class="line"><span class="lineno">  506</span>            <span class="stringliteral">&quot;b&quot;</span>: Index([], dtype=<span class="stringliteral">&quot;int64&quot;</span>),</div>
<div class="line"><span class="lineno">  507</span>            <span class="stringliteral">&quot;d&quot;</span>: Index([], dtype=<span class="stringliteral">&quot;int64&quot;</span>),</div>
<div class="line"><span class="lineno">  508</span>        }</div>
<div class="line"><span class="lineno">  509</span>    tm.assert_dict_equal(result, expected)</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7188f5fd477f1e588348188c980124da" name="a7188f5fd477f1e588348188c980124da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7188f5fd477f1e588348188c980124da">&#9670;&#160;</a></span>test_observed_nth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_observed_nth </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  512</span><span class="keyword">def </span>test_observed_nth():</div>
<div class="line"><span class="lineno">  513</span>    <span class="comment"># GH 26385</span></div>
<div class="line"><span class="lineno">  514</span>    cat = Categorical([<span class="stringliteral">&quot;a&quot;</span>, np.nan, np.nan], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>])</div>
<div class="line"><span class="lineno">  515</span>    ser = Series([1, 2, 3])</div>
<div class="line"><span class="lineno">  516</span>    df = DataFrame({<span class="stringliteral">&quot;cat&quot;</span>: cat, <span class="stringliteral">&quot;ser&quot;</span>: ser})</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>    result = df.groupby(<span class="stringliteral">&quot;cat&quot;</span>, observed=<span class="keyword">False</span>)[<span class="stringliteral">&quot;ser&quot;</span>].nth(0)</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>    index = Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>])</div>
<div class="line"><span class="lineno">  521</span>    expected = Series([1, np.nan, np.nan], index=index, name=<span class="stringliteral">&quot;ser&quot;</span>)</div>
<div class="line"><span class="lineno">  522</span>    expected.index.name = <span class="stringliteral">&quot;cat&quot;</span></div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a651acff76f6bd46c59cecfb9988a7572" name="a651acff76f6bd46c59cecfb9988a7572"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a651acff76f6bd46c59cecfb9988a7572">&#9670;&#160;</a></span>test_observed_perf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_observed_perf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  449</span><span class="keyword">def </span>test_observed_perf():</div>
<div class="line"><span class="lineno">  450</span>    <span class="comment"># we create a cartesian product, so this is</span></div>
<div class="line"><span class="lineno">  451</span>    <span class="comment"># non-performant if we don&#39;t use observed values</span></div>
<div class="line"><span class="lineno">  452</span>    <span class="comment"># gh-14942</span></div>
<div class="line"><span class="lineno">  453</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  454</span>        {</div>
<div class="line"><span class="lineno">  455</span>            <span class="stringliteral">&quot;cat&quot;</span>: np.random.randint(0, 255, size=30000),</div>
<div class="line"><span class="lineno">  456</span>            <span class="stringliteral">&quot;int_id&quot;</span>: np.random.randint(0, 255, size=30000),</div>
<div class="line"><span class="lineno">  457</span>            <span class="stringliteral">&quot;other_id&quot;</span>: np.random.randint(0, 10000, size=30000),</div>
<div class="line"><span class="lineno">  458</span>            <span class="stringliteral">&quot;foo&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  459</span>        }</div>
<div class="line"><span class="lineno">  460</span>    )</div>
<div class="line"><span class="lineno">  461</span>    df[<span class="stringliteral">&quot;cat&quot;</span>] = df.cat.astype(str).astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    grouped = df.groupby([<span class="stringliteral">&quot;cat&quot;</span>, <span class="stringliteral">&quot;int_id&quot;</span>, <span class="stringliteral">&quot;other_id&quot;</span>], observed=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  464</span>    result = grouped.count()</div>
<div class="line"><span class="lineno">  465</span>    <span class="keyword">assert</span> result.index.levels[0].nunique() == df.cat.nunique()</div>
<div class="line"><span class="lineno">  466</span>    <span class="keyword">assert</span> result.index.levels[1].nunique() == df.int_id.nunique()</div>
<div class="line"><span class="lineno">  467</span>    <span class="keyword">assert</span> result.index.levels[2].nunique() == df.other_id.nunique()</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8dc6e854b74667e0b38199df19ce0a6a" name="a8dc6e854b74667e0b38199df19ce0a6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dc6e854b74667e0b38199df19ce0a6a">&#9670;&#160;</a></span>test_preserve_categorical_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_preserve_categorical_dtype </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  794</span><span class="keyword">def </span>test_preserve_categorical_dtype():</div>
<div class="line"><span class="lineno">  795</span>    <span class="comment"># GH13743, GH13854</span></div>
<div class="line"><span class="lineno">  796</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  797</span>        {</div>
<div class="line"><span class="lineno">  798</span>            <span class="stringliteral">&quot;A&quot;</span>: [1, 2, 1, 1, 2],</div>
<div class="line"><span class="lineno">  799</span>            <span class="stringliteral">&quot;B&quot;</span>: [10, 16, 22, 28, 34],</div>
<div class="line"><span class="lineno">  800</span>            <span class="stringliteral">&quot;C1&quot;</span>: Categorical(list(<span class="stringliteral">&quot;abaab&quot;</span>), categories=list(<span class="stringliteral">&quot;bac&quot;</span>), ordered=<span class="keyword">False</span>),</div>
<div class="line"><span class="lineno">  801</span>            <span class="stringliteral">&quot;C2&quot;</span>: Categorical(list(<span class="stringliteral">&quot;abaab&quot;</span>), categories=list(<span class="stringliteral">&quot;bac&quot;</span>), ordered=<span class="keyword">True</span>),</div>
<div class="line"><span class="lineno">  802</span>        }</div>
<div class="line"><span class="lineno">  803</span>    )</div>
<div class="line"><span class="lineno">  804</span>    <span class="comment"># single grouper</span></div>
<div class="line"><span class="lineno">  805</span>    exp_full = DataFrame(</div>
<div class="line"><span class="lineno">  806</span>        {</div>
<div class="line"><span class="lineno">  807</span>            <span class="stringliteral">&quot;A&quot;</span>: [2.0, 1.0, np.nan],</div>
<div class="line"><span class="lineno">  808</span>            <span class="stringliteral">&quot;B&quot;</span>: [25.0, 20.0, np.nan],</div>
<div class="line"><span class="lineno">  809</span>            <span class="stringliteral">&quot;C1&quot;</span>: Categorical(list(<span class="stringliteral">&quot;bac&quot;</span>), categories=list(<span class="stringliteral">&quot;bac&quot;</span>), ordered=<span class="keyword">False</span>),</div>
<div class="line"><span class="lineno">  810</span>            <span class="stringliteral">&quot;C2&quot;</span>: Categorical(list(<span class="stringliteral">&quot;bac&quot;</span>), categories=list(<span class="stringliteral">&quot;bac&quot;</span>), ordered=<span class="keyword">True</span>),</div>
<div class="line"><span class="lineno">  811</span>        }</div>
<div class="line"><span class="lineno">  812</span>    )</div>
<div class="line"><span class="lineno">  813</span>    <span class="keywordflow">for</span> col <span class="keywordflow">in</span> [<span class="stringliteral">&quot;C1&quot;</span>, <span class="stringliteral">&quot;C2&quot;</span>]:</div>
<div class="line"><span class="lineno">  814</span>        msg = <span class="stringliteral">&quot;The default value of numeric_only&quot;</span></div>
<div class="line"><span class="lineno">  815</span>        <span class="keyword">with</span> tm.assert_produces_warning(FutureWarning, match=msg):</div>
<div class="line"><span class="lineno">  816</span>            result1 = df.groupby(by=col, as_index=<span class="keyword">False</span>, observed=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno">  817</span>            result2 = (</div>
<div class="line"><span class="lineno">  818</span>                df.groupby(by=col, as_index=<span class="keyword">True</span>, observed=<span class="keyword">False</span>).mean().reset_index()</div>
<div class="line"><span class="lineno">  819</span>            )</div>
<div class="line"><span class="lineno">  820</span>        expected = exp_full.reindex(columns=result1.columns)</div>
<div class="line"><span class="lineno">  821</span>        tm.assert_frame_equal(result1, expected)</div>
<div class="line"><span class="lineno">  822</span>        tm.assert_frame_equal(result2, expected)</div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  826</span>    <span class="stringliteral">&quot;func, values&quot;</span>,</div>
<div class="line"><span class="lineno">  827</span>    [</div>
<div class="line"><span class="lineno">  828</span>        (<span class="stringliteral">&quot;first&quot;</span>, [<span class="stringliteral">&quot;second&quot;</span>, <span class="stringliteral">&quot;first&quot;</span>]),</div>
<div class="line"><span class="lineno">  829</span>        (<span class="stringliteral">&quot;last&quot;</span>, [<span class="stringliteral">&quot;fourth&quot;</span>, <span class="stringliteral">&quot;third&quot;</span>]),</div>
<div class="line"><span class="lineno">  830</span>        (<span class="stringliteral">&quot;min&quot;</span>, [<span class="stringliteral">&quot;fourth&quot;</span>, <span class="stringliteral">&quot;first&quot;</span>]),</div>
<div class="line"><span class="lineno">  831</span>        (<span class="stringliteral">&quot;max&quot;</span>, [<span class="stringliteral">&quot;second&quot;</span>, <span class="stringliteral">&quot;third&quot;</span>]),</div>
<div class="line"><span class="lineno">  832</span>    ],</div>
<div class="line"><span class="lineno">  833</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c1b2a415f6934d103ab3ad77f8de4a8" name="a0c1b2a415f6934d103ab3ad77f8de4a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c1b2a415f6934d103ab3ad77f8de4a8">&#9670;&#160;</a></span>test_preserve_categories()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_preserve_categories </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  768</span><span class="keyword">def </span>test_preserve_categories():</div>
<div class="line"><span class="lineno">  769</span>    <span class="comment"># GH-13179</span></div>
<div class="line"><span class="lineno">  770</span>    categories = list(<span class="stringliteral">&quot;abc&quot;</span>)</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>    <span class="comment"># ordered=True</span></div>
<div class="line"><span class="lineno">  773</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: Categorical(list(<span class="stringliteral">&quot;ba&quot;</span>), categories=categories, ordered=<span class="keyword">True</span>)})</div>
<div class="line"><span class="lineno">  774</span>    index = CategoricalIndex(categories, categories, ordered=<span class="keyword">True</span>, name=<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  775</span>    tm.assert_index_equal(</div>
<div class="line"><span class="lineno">  776</span>        df.groupby(<span class="stringliteral">&quot;A&quot;</span>, sort=<span class="keyword">True</span>, observed=<span class="keyword">False</span>).first().index, index</div>
<div class="line"><span class="lineno">  777</span>    )</div>
<div class="line"><span class="lineno">  778</span>    tm.assert_index_equal(</div>
<div class="line"><span class="lineno">  779</span>        df.groupby(<span class="stringliteral">&quot;A&quot;</span>, sort=<span class="keyword">False</span>, observed=<span class="keyword">False</span>).first().index, index</div>
<div class="line"><span class="lineno">  780</span>    )</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    <span class="comment"># ordered=False</span></div>
<div class="line"><span class="lineno">  783</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: Categorical(list(<span class="stringliteral">&quot;ba&quot;</span>), categories=categories, ordered=<span class="keyword">False</span>)})</div>
<div class="line"><span class="lineno">  784</span>    sort_index = CategoricalIndex(categories, categories, ordered=<span class="keyword">False</span>, name=<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  785</span>    nosort_index = CategoricalIndex(list(<span class="stringliteral">&quot;bac&quot;</span>), list(<span class="stringliteral">&quot;bac&quot;</span>), ordered=<span class="keyword">False</span>, name=<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  786</span>    tm.assert_index_equal(</div>
<div class="line"><span class="lineno">  787</span>        df.groupby(<span class="stringliteral">&quot;A&quot;</span>, sort=<span class="keyword">True</span>, observed=<span class="keyword">False</span>).first().index, sort_index</div>
<div class="line"><span class="lineno">  788</span>    )</div>
<div class="line"><span class="lineno">  789</span>    tm.assert_index_equal(</div>
<div class="line"><span class="lineno">  790</span>        df.groupby(<span class="stringliteral">&quot;A&quot;</span>, sort=<span class="keyword">False</span>, observed=<span class="keyword">False</span>).first().index, nosort_index</div>
<div class="line"><span class="lineno">  791</span>    )</div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7abfb315e7737cb81f38329f89d72391" name="a7abfb315e7737cb81f38329f89d72391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7abfb315e7737cb81f38329f89d72391">&#9670;&#160;</a></span>test_preserve_on_ordered_ops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_preserve_on_ordered_ops </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  834</span><span class="keyword">def </span>test_preserve_on_ordered_ops(func, values):</div>
<div class="line"><span class="lineno">  835</span>    <span class="comment"># gh-18502</span></div>
<div class="line"><span class="lineno">  836</span>    <span class="comment"># preserve the categoricals on ops</span></div>
<div class="line"><span class="lineno">  837</span>    c = Categorical([<span class="stringliteral">&quot;first&quot;</span>, <span class="stringliteral">&quot;second&quot;</span>, <span class="stringliteral">&quot;third&quot;</span>, <span class="stringliteral">&quot;fourth&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  838</span>    df = DataFrame({<span class="stringliteral">&quot;payload&quot;</span>: [-1, -2, -1, -2], <span class="stringliteral">&quot;col&quot;</span>: c})</div>
<div class="line"><span class="lineno">  839</span>    g = df.groupby(<span class="stringliteral">&quot;payload&quot;</span>)</div>
<div class="line"><span class="lineno">  840</span>    result = getattr(g, func)()</div>
<div class="line"><span class="lineno">  841</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno">  842</span>        {<span class="stringliteral">&quot;payload&quot;</span>: [-2, -1], <span class="stringliteral">&quot;col&quot;</span>: Series(values, dtype=c.dtype)}</div>
<div class="line"><span class="lineno">  843</span>    ).set_index(<span class="stringliteral">&quot;payload&quot;</span>)</div>
<div class="line"><span class="lineno">  844</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>    <span class="comment"># we should also preserve categorical for SeriesGroupBy</span></div>
<div class="line"><span class="lineno">  847</span>    sgb = df.groupby(<span class="stringliteral">&quot;payload&quot;</span>)[<span class="stringliteral">&quot;col&quot;</span>]</div>
<div class="line"><span class="lineno">  848</span>    result = getattr(sgb, func)()</div>
<div class="line"><span class="lineno">  849</span>    expected = expected[<span class="stringliteral">&quot;col&quot;</span>]</div>
<div class="line"><span class="lineno">  850</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a08a75e7e01f48dce9d532c67f47ed3f9" name="a08a75e7e01f48dce9d532c67f47ed3f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08a75e7e01f48dce9d532c67f47ed3f9">&#9670;&#160;</a></span>test_read_only_category_no_sort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_read_only_category_no_sort </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1557</span><span class="keyword">def </span>test_read_only_category_no_sort():</div>
<div class="line"><span class="lineno"> 1558</span>    <span class="comment"># GH33410</span></div>
<div class="line"><span class="lineno"> 1559</span>    cats = np.array([1, 2])</div>
<div class="line"><span class="lineno"> 1560</span>    cats.flags.writeable = <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1561</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1562</span>        {<span class="stringliteral">&quot;a&quot;</span>: [1, 3, 5, 7], <span class="stringliteral">&quot;b&quot;</span>: Categorical([1, 1, 2, 2], categories=Index(cats))}</div>
<div class="line"><span class="lineno"> 1563</span>    )</div>
<div class="line"><span class="lineno"> 1564</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1565</span>        data={<span class="stringliteral">&quot;a&quot;</span>: [2.0, 6.0]}, index=CategoricalIndex([1, 2], name=<span class="stringliteral">&quot;b&quot;</span>)</div>
<div class="line"><span class="lineno"> 1566</span>    )</div>
<div class="line"><span class="lineno"> 1567</span>    result = df.groupby(<span class="stringliteral">&quot;b&quot;</span>, sort=<span class="keyword">False</span>).mean()</div>
<div class="line"><span class="lineno"> 1568</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1569</span> </div>
<div class="line"><span class="lineno"> 1570</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a933983a10a298109c3c0eed9f858f646" name="a933983a10a298109c3c0eed9f858f646"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a933983a10a298109c3c0eed9f858f646">&#9670;&#160;</a></span>test_series_groupby_categorical_aggregation_getitem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_series_groupby_categorical_aggregation_getitem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1498</span><span class="keyword">def </span>test_series_groupby_categorical_aggregation_getitem():</div>
<div class="line"><span class="lineno"> 1499</span>    <span class="comment"># GH 8870</span></div>
<div class="line"><span class="lineno"> 1500</span>    d = {<span class="stringliteral">&quot;foo&quot;</span>: [10, 8, 4, 1], <span class="stringliteral">&quot;bar&quot;</span>: [10, 20, 30, 40], <span class="stringliteral">&quot;baz&quot;</span>: [<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]}</div>
<div class="line"><span class="lineno"> 1501</span>    df = DataFrame(d)</div>
<div class="line"><span class="lineno"> 1502</span>    cat = pd.cut(df[<span class="stringliteral">&quot;foo&quot;</span>], np.linspace(0, 20, 5))</div>
<div class="line"><span class="lineno"> 1503</span>    df[<span class="stringliteral">&quot;range&quot;</span>] = cat</div>
<div class="line"><span class="lineno"> 1504</span>    groups = df.groupby([<span class="stringliteral">&quot;range&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>], as_index=<span class="keyword">True</span>, sort=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1505</span>    result = groups[<span class="stringliteral">&quot;foo&quot;</span>].agg(<span class="stringliteral">&quot;mean&quot;</span>)</div>
<div class="line"><span class="lineno"> 1506</span>    expected = groups.agg(<span class="stringliteral">&quot;mean&quot;</span>)[<span class="stringliteral">&quot;foo&quot;</span>]</div>
<div class="line"><span class="lineno"> 1507</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1511</span>    <span class="stringliteral">&quot;func, expected_values&quot;</span>,</div>
<div class="line"><span class="lineno"> 1512</span>    [(Series.nunique, [1, 1, 2]), (Series.count, [1, 2, 2])],</div>
<div class="line"><span class="lineno"> 1513</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a263f35950ad7836b2f950b5200e995aa" name="a263f35950ad7836b2f950b5200e995aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a263f35950ad7836b2f950b5200e995aa">&#9670;&#160;</a></span>test_series_groupby_first_on_categorical_col_grouped_on_2_categoricals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_series_groupby_first_on_categorical_col_grouped_on_2_categoricals </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool
&#160;</td>
          <td class="paramname"><em>observed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1721</span>):</div>
<div class="line"><span class="lineno"> 1722</span>    <span class="comment"># GH 34951</span></div>
<div class="line"><span class="lineno"> 1723</span>    cat = Categorical([0, 0, 1, 1])</div>
<div class="line"><span class="lineno"> 1724</span>    val = [0, 1, 1, 0]</div>
<div class="line"><span class="lineno"> 1725</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: cat, <span class="stringliteral">&quot;b&quot;</span>: cat, <span class="stringliteral">&quot;c&quot;</span>: val})</div>
<div class="line"><span class="lineno"> 1726</span> </div>
<div class="line"><span class="lineno"> 1727</span>    cat2 = Categorical([0, 1])</div>
<div class="line"><span class="lineno"> 1728</span>    idx = MultiIndex.from_product([cat2, cat2], names=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>])</div>
<div class="line"><span class="lineno"> 1729</span>    expected_dict = {</div>
<div class="line"><span class="lineno"> 1730</span>        <span class="stringliteral">&quot;first&quot;</span>: Series([0, np.NaN, np.NaN, 1], idx, name=<span class="stringliteral">&quot;c&quot;</span>),</div>
<div class="line"><span class="lineno"> 1731</span>        <span class="stringliteral">&quot;last&quot;</span>: Series([1, np.NaN, np.NaN, 0], idx, name=<span class="stringliteral">&quot;c&quot;</span>),</div>
<div class="line"><span class="lineno"> 1732</span>    }</div>
<div class="line"><span class="lineno"> 1733</span> </div>
<div class="line"><span class="lineno"> 1734</span>    expected = expected_dict[func]</div>
<div class="line"><span class="lineno"> 1735</span>    <span class="keywordflow">if</span> observed:</div>
<div class="line"><span class="lineno"> 1736</span>        expected = expected.dropna().astype(np.int64)</div>
<div class="line"><span class="lineno"> 1737</span> </div>
<div class="line"><span class="lineno"> 1738</span>    srs_grp = df.groupby([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>], observed=observed)[<span class="stringliteral">&quot;c&quot;</span>]</div>
<div class="line"><span class="lineno"> 1739</span>    result = getattr(srs_grp, func)()</div>
<div class="line"><span class="lineno"> 1740</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span> </div>
<div class="line"><span class="lineno"> 1743</span><span class="preprocessor">@pytest.mark.parametrize(&quot;func&quot;, [&quot;first&quot;, &quot;last&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8191e226b8b0d223c04d366e3c675f7" name="ac8191e226b8b0d223c04d366e3c675f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8191e226b8b0d223c04d366e3c675f7">&#9670;&#160;</a></span>test_series_groupby_on_2_categoricals_unobserved()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_series_groupby_on_2_categoricals_unobserved </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reduction_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1358</span><span class="keyword">def </span>test_series_groupby_on_2_categoricals_unobserved(reduction_func, observed, request):</div>
<div class="line"><span class="lineno"> 1359</span>    <span class="comment"># GH 17605</span></div>
<div class="line"><span class="lineno"> 1360</span>    <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;ngroup&quot;</span>:</div>
<div class="line"><span class="lineno"> 1361</span>        pytest.skip(<span class="stringliteral">&quot;ngroup is not truly a reduction&quot;</span>)</div>
<div class="line"><span class="lineno"> 1362</span> </div>
<div class="line"><span class="lineno"> 1363</span>    <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;corrwith&quot;</span>:  <span class="comment"># GH 32293</span></div>
<div class="line"><span class="lineno"> 1364</span>        mark = pytest.mark.xfail(</div>
<div class="line"><span class="lineno"> 1365</span>            reason=<span class="stringliteral">&quot;TODO: implemented SeriesGroupBy.corrwith. See GH 32293&quot;</span></div>
<div class="line"><span class="lineno"> 1366</span>        )</div>
<div class="line"><span class="lineno"> 1367</span>        request.node.add_marker(mark)</div>
<div class="line"><span class="lineno"> 1368</span>    warn = FutureWarning <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;mad&quot;</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1369</span> </div>
<div class="line"><span class="lineno"> 1370</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1371</span>        {</div>
<div class="line"><span class="lineno"> 1372</span>            <span class="stringliteral">&quot;cat_1&quot;</span>: Categorical(list(<span class="stringliteral">&quot;AABB&quot;</span>), categories=list(<span class="stringliteral">&quot;ABCD&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1373</span>            <span class="stringliteral">&quot;cat_2&quot;</span>: Categorical(list(<span class="stringliteral">&quot;AB&quot;</span>) * 2, categories=list(<span class="stringliteral">&quot;ABCD&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1374</span>            <span class="stringliteral">&quot;value&quot;</span>: [0.1] * 4,</div>
<div class="line"><span class="lineno"> 1375</span>        }</div>
<div class="line"><span class="lineno"> 1376</span>    )</div>
<div class="line"><span class="lineno"> 1377</span>    args = get_groupby_method_args(reduction_func, df)</div>
<div class="line"><span class="lineno"> 1378</span> </div>
<div class="line"><span class="lineno"> 1379</span>    expected_length = 4 <span class="keywordflow">if</span> observed <span class="keywordflow">else</span> 16</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span>    series_groupby = df.groupby([<span class="stringliteral">&quot;cat_1&quot;</span>, <span class="stringliteral">&quot;cat_2&quot;</span>], observed=observed)[<span class="stringliteral">&quot;value&quot;</span>]</div>
<div class="line"><span class="lineno"> 1382</span>    agg = getattr(series_groupby, reduction_func)</div>
<div class="line"><span class="lineno"> 1383</span>    <span class="keyword">with</span> tm.assert_produces_warning(warn, match=<span class="stringliteral">&quot;The &#39;mad&#39; method is deprecated&quot;</span>):</div>
<div class="line"><span class="lineno"> 1384</span>        result = agg(*args)</div>
<div class="line"><span class="lineno"> 1385</span> </div>
<div class="line"><span class="lineno"> 1386</span>    <span class="keyword">assert</span> len(result) == expected_length</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7793bfa4c87dbe1da57b3506e03bdbb" name="ac7793bfa4c87dbe1da57b3506e03bdbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7793bfa4c87dbe1da57b3506e03bdbb">&#9670;&#160;</a></span>test_series_groupby_on_2_categoricals_unobserved_zeroes_or_nans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_series_groupby_on_2_categoricals_unobserved_zeroes_or_nans </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reduction_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1391</span>):</div>
<div class="line"><span class="lineno"> 1392</span>    <span class="comment"># GH 17605</span></div>
<div class="line"><span class="lineno"> 1393</span>    <span class="comment"># Tests whether the unobserved categories in the result contain 0 or NaN</span></div>
<div class="line"><span class="lineno"> 1394</span> </div>
<div class="line"><span class="lineno"> 1395</span>    <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;ngroup&quot;</span>:</div>
<div class="line"><span class="lineno"> 1396</span>        pytest.skip(<span class="stringliteral">&quot;ngroup is not truly a reduction&quot;</span>)</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span>    <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;corrwith&quot;</span>:  <span class="comment"># GH 32293</span></div>
<div class="line"><span class="lineno"> 1399</span>        mark = pytest.mark.xfail(</div>
<div class="line"><span class="lineno"> 1400</span>            reason=<span class="stringliteral">&quot;TODO: implemented SeriesGroupBy.corrwith. See GH 32293&quot;</span></div>
<div class="line"><span class="lineno"> 1401</span>        )</div>
<div class="line"><span class="lineno"> 1402</span>        request.node.add_marker(mark)</div>
<div class="line"><span class="lineno"> 1403</span>    warn = FutureWarning <span class="keywordflow">if</span> reduction_func == <span class="stringliteral">&quot;mad&quot;</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1404</span> </div>
<div class="line"><span class="lineno"> 1405</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1406</span>        {</div>
<div class="line"><span class="lineno"> 1407</span>            <span class="stringliteral">&quot;cat_1&quot;</span>: Categorical(list(<span class="stringliteral">&quot;AABB&quot;</span>), categories=list(<span class="stringliteral">&quot;ABC&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1408</span>            <span class="stringliteral">&quot;cat_2&quot;</span>: Categorical(list(<span class="stringliteral">&quot;AB&quot;</span>) * 2, categories=list(<span class="stringliteral">&quot;ABC&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1409</span>            <span class="stringliteral">&quot;value&quot;</span>: [0.1] * 4,</div>
<div class="line"><span class="lineno"> 1410</span>        }</div>
<div class="line"><span class="lineno"> 1411</span>    )</div>
<div class="line"><span class="lineno"> 1412</span>    unobserved = [tuple(<span class="stringliteral">&quot;AC&quot;</span>), tuple(<span class="stringliteral">&quot;BC&quot;</span>), tuple(<span class="stringliteral">&quot;CA&quot;</span>), tuple(<span class="stringliteral">&quot;CB&quot;</span>), tuple(<span class="stringliteral">&quot;CC&quot;</span>)]</div>
<div class="line"><span class="lineno"> 1413</span>    args = get_groupby_method_args(reduction_func, df)</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>    series_groupby = df.groupby([<span class="stringliteral">&quot;cat_1&quot;</span>, <span class="stringliteral">&quot;cat_2&quot;</span>], observed=<span class="keyword">False</span>)[<span class="stringliteral">&quot;value&quot;</span>]</div>
<div class="line"><span class="lineno"> 1416</span>    agg = getattr(series_groupby, reduction_func)</div>
<div class="line"><span class="lineno"> 1417</span>    <span class="keyword">with</span> tm.assert_produces_warning(warn, match=<span class="stringliteral">&quot;The &#39;mad&#39; method is deprecated&quot;</span>):</div>
<div class="line"><span class="lineno"> 1418</span>        result = agg(*args)</div>
<div class="line"><span class="lineno"> 1419</span> </div>
<div class="line"><span class="lineno"> 1420</span>    zero_or_nan = _results_for_groupbys_with_missing_categories[reduction_func]</div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>    <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> unobserved:</div>
<div class="line"><span class="lineno"> 1423</span>        val = result.loc[idx]</div>
<div class="line"><span class="lineno"> 1424</span>        <span class="keyword">assert</span> (pd.isna(zero_or_nan) <span class="keywordflow">and</span> pd.isna(val)) <span class="keywordflow">or</span> (val == zero_or_nan)</div>
<div class="line"><span class="lineno"> 1425</span> </div>
<div class="line"><span class="lineno"> 1426</span>    <span class="comment"># If we expect unobserved values to be zero, we also expect the dtype to be int.</span></div>
<div class="line"><span class="lineno"> 1427</span>    <span class="comment"># Except for .sum(). If the observed categories sum to dtype=float (i.e. their</span></div>
<div class="line"><span class="lineno"> 1428</span>    <span class="comment"># sums have decimals), then the zeros for the missing categories should also be</span></div>
<div class="line"><span class="lineno"> 1429</span>    <span class="comment"># floats.</span></div>
<div class="line"><span class="lineno"> 1430</span>    <span class="keywordflow">if</span> zero_or_nan == 0 <span class="keywordflow">and</span> reduction_func != <span class="stringliteral">&quot;sum&quot;</span>:</div>
<div class="line"><span class="lineno"> 1431</span>        <span class="keyword">assert</span> np.issubdtype(result.dtype, np.integer)</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4c4bbcf51557b1ba3a771436580b603" name="ac4c4bbcf51557b1ba3a771436580b603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4c4bbcf51557b1ba3a771436580b603">&#9670;&#160;</a></span>test_seriesgroupby_observed_apply_dict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_seriesgroupby_observed_apply_dict </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df_cat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1303</span><span class="keyword">def </span>test_seriesgroupby_observed_apply_dict(df_cat, observed, index, data):</div>
<div class="line"><span class="lineno"> 1304</span>    <span class="comment"># GH 24880</span></div>
<div class="line"><span class="lineno"> 1305</span>    expected = Series(data=data, index=index, name=<span class="stringliteral">&quot;C&quot;</span>)</div>
<div class="line"><span class="lineno"> 1306</span>    result = df_cat.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], observed=observed)[<span class="stringliteral">&quot;C&quot;</span>].apply(</div>
<div class="line"><span class="lineno"> 1307</span>        <span class="keyword">lambda</span> x: {<span class="stringliteral">&quot;min&quot;</span>: x.min(), <span class="stringliteral">&quot;max&quot;</span>: x.max()}</div>
<div class="line"><span class="lineno"> 1308</span>    )</div>
<div class="line"><span class="lineno"> 1309</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6497e8cb7da8a528e1e866304a9d83dc" name="a6497e8cb7da8a528e1e866304a9d83dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6497e8cb7da8a528e1e866304a9d83dc">&#9670;&#160;</a></span>test_seriesgroupby_observed_false_or_none()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_seriesgroupby_observed_false_or_none </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df_cat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>operation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1241</span><span class="keyword">def </span>test_seriesgroupby_observed_false_or_none(df_cat, observed, operation):</div>
<div class="line"><span class="lineno"> 1242</span>    <span class="comment"># GH 24880</span></div>
<div class="line"><span class="lineno"> 1243</span>    index, _ = MultiIndex.from_product(</div>
<div class="line"><span class="lineno"> 1244</span>        [</div>
<div class="line"><span class="lineno"> 1245</span>            CategoricalIndex([<span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>], ordered=<span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1246</span>            CategoricalIndex([<span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;three&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>], ordered=<span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1247</span>        ],</div>
<div class="line"><span class="lineno"> 1248</span>        names=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>],</div>
<div class="line"><span class="lineno"> 1249</span>    ).sortlevel()</div>
<div class="line"><span class="lineno"> 1250</span> </div>
<div class="line"><span class="lineno"> 1251</span>    expected = Series(data=[2, 4, np.nan, 1, np.nan, 3], index=index, name=<span class="stringliteral">&quot;C&quot;</span>)</div>
<div class="line"><span class="lineno"> 1252</span>    <span class="keywordflow">if</span> operation == <span class="stringliteral">&quot;agg&quot;</span>:</div>
<div class="line"><span class="lineno"> 1253</span>        expected = expected.fillna(0, downcast=<span class="stringliteral">&quot;infer&quot;</span>)</div>
<div class="line"><span class="lineno"> 1254</span>    grouped = df_cat.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], observed=observed)[<span class="stringliteral">&quot;C&quot;</span>]</div>
<div class="line"><span class="lineno"> 1255</span>    result = getattr(grouped, operation)(sum)</div>
<div class="line"><span class="lineno"> 1256</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1260</span>    <span class="stringliteral">&quot;observed, index, data&quot;</span>,</div>
<div class="line"><span class="lineno"> 1261</span>    [</div>
<div class="line"><span class="lineno"> 1262</span>        (</div>
<div class="line"><span class="lineno"> 1263</span>            <span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1264</span>            MultiIndex.from_arrays(</div>
<div class="line"><span class="lineno"> 1265</span>                [</div>
<div class="line"><span class="lineno"> 1266</span>                    Index([<span class="stringliteral">&quot;foo&quot;</span>] * 4 + [<span class="stringliteral">&quot;bar&quot;</span>] * 4, dtype=<span class="stringliteral">&quot;category&quot;</span>, name=<span class="stringliteral">&quot;A&quot;</span>),</div>
<div class="line"><span class="lineno"> 1267</span>                    Index(</div>
<div class="line"><span class="lineno"> 1268</span>                        [<span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>, <span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;three&quot;</span>, <span class="stringliteral">&quot;three&quot;</span>],</div>
<div class="line"><span class="lineno"> 1269</span>                        dtype=<span class="stringliteral">&quot;category&quot;</span>,</div>
<div class="line"><span class="lineno"> 1270</span>                        name=<span class="stringliteral">&quot;B&quot;</span>,</div>
<div class="line"><span class="lineno"> 1271</span>                    ),</div>
<div class="line"><span class="lineno"> 1272</span>                    Index([<span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>] * 4),</div>
<div class="line"><span class="lineno"> 1273</span>                ]</div>
<div class="line"><span class="lineno"> 1274</span>            ),</div>
<div class="line"><span class="lineno"> 1275</span>            [1, 1, 3, 3, 2, 2, 4, 4],</div>
<div class="line"><span class="lineno"> 1276</span>        ),</div>
<div class="line"><span class="lineno"> 1277</span>        (</div>
<div class="line"><span class="lineno"> 1278</span>            <span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1279</span>            MultiIndex.from_product(</div>
<div class="line"><span class="lineno"> 1280</span>                [</div>
<div class="line"><span class="lineno"> 1281</span>                    CategoricalIndex([<span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>], ordered=<span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1282</span>                    CategoricalIndex([<span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;three&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>], ordered=<span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1283</span>                    Index([<span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1284</span>                ],</div>
<div class="line"><span class="lineno"> 1285</span>                names=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 1286</span>            ),</div>
<div class="line"><span class="lineno"> 1287</span>            [2, 2, 4, 4, np.nan, np.nan, 1, 1, np.nan, np.nan, 3, 3],</div>
<div class="line"><span class="lineno"> 1288</span>        ),</div>
<div class="line"><span class="lineno"> 1289</span>        (</div>
<div class="line"><span class="lineno"> 1290</span>            <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno"> 1291</span>            MultiIndex.from_product(</div>
<div class="line"><span class="lineno"> 1292</span>                [</div>
<div class="line"><span class="lineno"> 1293</span>                    CategoricalIndex([<span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>], ordered=<span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1294</span>                    CategoricalIndex([<span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;three&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>], ordered=<span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1295</span>                    Index([<span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1296</span>                ],</div>
<div class="line"><span class="lineno"> 1297</span>                names=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 1298</span>            ),</div>
<div class="line"><span class="lineno"> 1299</span>            [2, 2, 4, 4, np.nan, np.nan, 1, 1, np.nan, np.nan, 3, 3],</div>
<div class="line"><span class="lineno"> 1300</span>        ),</div>
<div class="line"><span class="lineno"> 1301</span>    ],</div>
<div class="line"><span class="lineno"> 1302</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1d70deb8a8e9fa07abcd0ad333b81bd" name="ae1d70deb8a8e9fa07abcd0ad333b81bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1d70deb8a8e9fa07abcd0ad333b81bd">&#9670;&#160;</a></span>test_seriesgroupby_observed_true()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_seriesgroupby_observed_true </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df_cat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>operation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1227</span><span class="keyword">def </span>test_seriesgroupby_observed_true(df_cat, operation):</div>
<div class="line"><span class="lineno"> 1228</span>    <span class="comment"># GH 24880</span></div>
<div class="line"><span class="lineno"> 1229</span>    lev_a = Index([<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>], dtype=df_cat[<span class="stringliteral">&quot;A&quot;</span>].dtype, name=<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno"> 1230</span>    lev_b = Index([<span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>, <span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;three&quot;</span>], dtype=df_cat[<span class="stringliteral">&quot;B&quot;</span>].dtype, name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1231</span>    index = MultiIndex.from_arrays([lev_a, lev_b])</div>
<div class="line"><span class="lineno"> 1232</span>    expected = Series(data=[1, 3, 2, 4], index=index, name=<span class="stringliteral">&quot;C&quot;</span>)</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>    grouped = df_cat.groupby([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], observed=<span class="keyword">True</span>)[<span class="stringliteral">&quot;C&quot;</span>]</div>
<div class="line"><span class="lineno"> 1235</span>    result = getattr(grouped, operation)(sum)</div>
<div class="line"><span class="lineno"> 1236</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1237</span> </div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span><span class="preprocessor">@pytest.mark.parametrize(&quot;operation&quot;, [&quot;agg&quot;, &quot;apply&quot;])</span></div>
<div class="line"><span class="lineno"> 1240</span><span class="preprocessor">@pytest.mark.parametrize(&quot;observed&quot;, [False, None])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e09541ee3fcfa0419e15c3c0b600df9" name="a8e09541ee3fcfa0419e15c3c0b600df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e09541ee3fcfa0419e15c3c0b600df9">&#9670;&#160;</a></span>test_shift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_shift </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fill_value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1190</span><span class="keyword">def </span>test_shift(fill_value):</div>
<div class="line"><span class="lineno"> 1191</span>    ct = Categorical(</div>
<div class="line"><span class="lineno"> 1192</span>        [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>], ordered=<span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1193</span>    )</div>
<div class="line"><span class="lineno"> 1194</span>    expected = Categorical(</div>
<div class="line"><span class="lineno"> 1195</span>        [<span class="keywordtype">None</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>], ordered=<span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1196</span>    )</div>
<div class="line"><span class="lineno"> 1197</span>    res = ct.shift(1, fill_value=fill_value)</div>
<div class="line"><span class="lineno"> 1198</span>    tm.assert_equal(res, expected)</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span> </div>
<div class="line"><span class="lineno"> 1201</span><span class="preprocessor">@pytest.fixture</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bf25423a6d89a225e33d8ae17cd546c" name="a9bf25423a6d89a225e33d8ae17cd546c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bf25423a6d89a225e33d8ae17cd546c">&#9670;&#160;</a></span>test_sort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_sort </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  904</span><span class="keyword">def </span>test_sort():</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>    <span class="comment"># https://stackoverflow.com/questions/23814368/sorting-pandas-</span></div>
<div class="line"><span class="lineno">  907</span>    <span class="comment">#        categorical-labels-after-groupby</span></div>
<div class="line"><span class="lineno">  908</span>    <span class="comment"># This should result in a properly sorted Series so that the plot</span></div>
<div class="line"><span class="lineno">  909</span>    <span class="comment"># has a sorted x axis</span></div>
<div class="line"><span class="lineno">  910</span>    <span class="comment"># self.cat.groupby([&#39;value_group&#39;])[&#39;value_group&#39;].count().plot(kind=&#39;bar&#39;)</span></div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>    df = DataFrame({<span class="stringliteral">&quot;value&quot;</span>: np.random.randint(0, 10000, 100)})</div>
<div class="line"><span class="lineno">  913</span>    labels = [f<span class="stringliteral">&quot;{i} - {i+499}&quot;</span> <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, 10000, 500)]</div>
<div class="line"><span class="lineno">  914</span>    cat_labels = Categorical(labels, labels)</div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span>    df = df.sort_values(by=[<span class="stringliteral">&quot;value&quot;</span>], ascending=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  917</span>    df[<span class="stringliteral">&quot;value_group&quot;</span>] = pd.cut(</div>
<div class="line"><span class="lineno">  918</span>        df.value, range(0, 10500, 500), right=<span class="keyword">False</span>, labels=cat_labels</div>
<div class="line"><span class="lineno">  919</span>    )</div>
<div class="line"><span class="lineno">  920</span> </div>
<div class="line"><span class="lineno">  921</span>    res = df.groupby([<span class="stringliteral">&quot;value_group&quot;</span>], observed=<span class="keyword">False</span>)[<span class="stringliteral">&quot;value_group&quot;</span>].count()</div>
<div class="line"><span class="lineno">  922</span>    exp = res[sorted(res.index, key=<span class="keyword">lambda</span> x: float(x.split()[0]))]</div>
<div class="line"><span class="lineno">  923</span>    exp.index = CategoricalIndex(exp.index, name=exp.index.name)</div>
<div class="line"><span class="lineno">  924</span>    tm.assert_series_equal(res, exp)</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a934b831bd6c1f9a3efe509dcb0216b71" name="a934b831bd6c1f9a3efe509dcb0216b71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a934b831bd6c1f9a3efe509dcb0216b71">&#9670;&#160;</a></span>test_sort2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_sort2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  927</span><span class="keyword">def </span>test_sort2():</div>
<div class="line"><span class="lineno">  928</span>    <span class="comment"># dataframe groupby sort was being ignored # GH 8868</span></div>
<div class="line"><span class="lineno">  929</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  930</span>        [</div>
<div class="line"><span class="lineno">  931</span>            [<span class="stringliteral">&quot;(7.5, 10]&quot;</span>, 10, 10],</div>
<div class="line"><span class="lineno">  932</span>            [<span class="stringliteral">&quot;(7.5, 10]&quot;</span>, 8, 20],</div>
<div class="line"><span class="lineno">  933</span>            [<span class="stringliteral">&quot;(2.5, 5]&quot;</span>, 5, 30],</div>
<div class="line"><span class="lineno">  934</span>            [<span class="stringliteral">&quot;(5, 7.5]&quot;</span>, 6, 40],</div>
<div class="line"><span class="lineno">  935</span>            [<span class="stringliteral">&quot;(2.5, 5]&quot;</span>, 4, 50],</div>
<div class="line"><span class="lineno">  936</span>            [<span class="stringliteral">&quot;(0, 2.5]&quot;</span>, 1, 60],</div>
<div class="line"><span class="lineno">  937</span>            [<span class="stringliteral">&quot;(5, 7.5]&quot;</span>, 7, 70],</div>
<div class="line"><span class="lineno">  938</span>        ],</div>
<div class="line"><span class="lineno">  939</span>        columns=[<span class="stringliteral">&quot;range&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>],</div>
<div class="line"><span class="lineno">  940</span>    )</div>
<div class="line"><span class="lineno">  941</span>    df[<span class="stringliteral">&quot;range&quot;</span>] = Categorical(df[<span class="stringliteral">&quot;range&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  942</span>    index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  943</span>        [<span class="stringliteral">&quot;(0, 2.5]&quot;</span>, <span class="stringliteral">&quot;(2.5, 5]&quot;</span>, <span class="stringliteral">&quot;(5, 7.5]&quot;</span>, <span class="stringliteral">&quot;(7.5, 10]&quot;</span>], name=<span class="stringliteral">&quot;range&quot;</span>, ordered=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  944</span>    )</div>
<div class="line"><span class="lineno">  945</span>    expected_sort = DataFrame(</div>
<div class="line"><span class="lineno">  946</span>        [[1, 60], [5, 30], [6, 40], [10, 10]], columns=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>], index=index</div>
<div class="line"><span class="lineno">  947</span>    )</div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span>    col = <span class="stringliteral">&quot;range&quot;</span></div>
<div class="line"><span class="lineno">  950</span>    result_sort = df.groupby(col, sort=<span class="keyword">True</span>, observed=<span class="keyword">False</span>).first()</div>
<div class="line"><span class="lineno">  951</span>    tm.assert_frame_equal(result_sort, expected_sort)</div>
<div class="line"><span class="lineno">  952</span> </div>
<div class="line"><span class="lineno">  953</span>    <span class="comment"># when categories is ordered, group is ordered by category&#39;s order</span></div>
<div class="line"><span class="lineno">  954</span>    expected_sort = result_sort</div>
<div class="line"><span class="lineno">  955</span>    result_sort = df.groupby(col, sort=<span class="keyword">False</span>, observed=<span class="keyword">False</span>).first()</div>
<div class="line"><span class="lineno">  956</span>    tm.assert_frame_equal(result_sort, expected_sort)</div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>    df[<span class="stringliteral">&quot;range&quot;</span>] = Categorical(df[<span class="stringliteral">&quot;range&quot;</span>], ordered=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  959</span>    index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  960</span>        [<span class="stringliteral">&quot;(0, 2.5]&quot;</span>, <span class="stringliteral">&quot;(2.5, 5]&quot;</span>, <span class="stringliteral">&quot;(5, 7.5]&quot;</span>, <span class="stringliteral">&quot;(7.5, 10]&quot;</span>], name=<span class="stringliteral">&quot;range&quot;</span></div>
<div class="line"><span class="lineno">  961</span>    )</div>
<div class="line"><span class="lineno">  962</span>    expected_sort = DataFrame(</div>
<div class="line"><span class="lineno">  963</span>        [[1, 60], [5, 30], [6, 40], [10, 10]], columns=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>], index=index</div>
<div class="line"><span class="lineno">  964</span>    )</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>    index = CategoricalIndex(</div>
<div class="line"><span class="lineno">  967</span>        [<span class="stringliteral">&quot;(7.5, 10]&quot;</span>, <span class="stringliteral">&quot;(2.5, 5]&quot;</span>, <span class="stringliteral">&quot;(5, 7.5]&quot;</span>, <span class="stringliteral">&quot;(0, 2.5]&quot;</span>],</div>
<div class="line"><span class="lineno">  968</span>        categories=[<span class="stringliteral">&quot;(7.5, 10]&quot;</span>, <span class="stringliteral">&quot;(2.5, 5]&quot;</span>, <span class="stringliteral">&quot;(5, 7.5]&quot;</span>, <span class="stringliteral">&quot;(0, 2.5]&quot;</span>],</div>
<div class="line"><span class="lineno">  969</span>        name=<span class="stringliteral">&quot;range&quot;</span>,</div>
<div class="line"><span class="lineno">  970</span>    )</div>
<div class="line"><span class="lineno">  971</span>    expected_nosort = DataFrame(</div>
<div class="line"><span class="lineno">  972</span>        [[10, 10], [5, 30], [6, 40], [1, 60]], index=index, columns=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]</div>
<div class="line"><span class="lineno">  973</span>    )</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>    col = <span class="stringliteral">&quot;range&quot;</span></div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>    <span class="comment"># this is an unordered categorical, but we allow this ####</span></div>
<div class="line"><span class="lineno">  978</span>    result_sort = df.groupby(col, sort=<span class="keyword">True</span>, observed=<span class="keyword">False</span>).first()</div>
<div class="line"><span class="lineno">  979</span>    tm.assert_frame_equal(result_sort, expected_sort)</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>    result_nosort = df.groupby(col, sort=<span class="keyword">False</span>, observed=<span class="keyword">False</span>).first()</div>
<div class="line"><span class="lineno">  982</span>    tm.assert_frame_equal(result_nosort, expected_nosort)</div>
<div class="line"><span class="lineno">  983</span> </div>
<div class="line"><span class="lineno">  984</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0be7ea72d9c8f41486945eb683aad5af" name="a0be7ea72d9c8f41486945eb683aad5af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0be7ea72d9c8f41486945eb683aad5af">&#9670;&#160;</a></span>test_sort_datetimelike()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_sort_datetimelike </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  985</span><span class="keyword">def </span>test_sort_datetimelike():</div>
<div class="line"><span class="lineno">  986</span>    <span class="comment"># GH10505</span></div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>    <span class="comment"># use same data as test_groupby_sort_categorical, which category is</span></div>
<div class="line"><span class="lineno">  989</span>    <span class="comment"># corresponding to datetime.month</span></div>
<div class="line"><span class="lineno">  990</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  991</span>        {</div>
<div class="line"><span class="lineno">  992</span>            <span class="stringliteral">&quot;dt&quot;</span>: [</div>
<div class="line"><span class="lineno">  993</span>                <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 7, 1),</div>
<div class="line"><span class="lineno">  994</span>                <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 7, 1),</div>
<div class="line"><span class="lineno">  995</span>                <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 2, 1),</div>
<div class="line"><span class="lineno">  996</span>                <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 5, 1),</div>
<div class="line"><span class="lineno">  997</span>                <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 2, 1),</div>
<div class="line"><span class="lineno">  998</span>                <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 1, 1),</div>
<div class="line"><span class="lineno">  999</span>                <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 5, 1),</div>
<div class="line"><span class="lineno"> 1000</span>            ],</div>
<div class="line"><span class="lineno"> 1001</span>            <span class="stringliteral">&quot;foo&quot;</span>: [10, 8, 5, 6, 4, 1, 7],</div>
<div class="line"><span class="lineno"> 1002</span>            <span class="stringliteral">&quot;bar&quot;</span>: [10, 20, 30, 40, 50, 60, 70],</div>
<div class="line"><span class="lineno"> 1003</span>        },</div>
<div class="line"><span class="lineno"> 1004</span>        columns=[<span class="stringliteral">&quot;dt&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>],</div>
<div class="line"><span class="lineno"> 1005</span>    )</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>    <span class="comment"># ordered=True</span></div>
<div class="line"><span class="lineno"> 1008</span>    df[<span class="stringliteral">&quot;dt&quot;</span>] = Categorical(df[<span class="stringliteral">&quot;dt&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1009</span>    index = [</div>
<div class="line"><span class="lineno"> 1010</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 1, 1),</div>
<div class="line"><span class="lineno"> 1011</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 2, 1),</div>
<div class="line"><span class="lineno"> 1012</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 5, 1),</div>
<div class="line"><span class="lineno"> 1013</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 7, 1),</div>
<div class="line"><span class="lineno"> 1014</span>    ]</div>
<div class="line"><span class="lineno"> 1015</span>    result_sort = DataFrame(</div>
<div class="line"><span class="lineno"> 1016</span>        [[1, 60], [5, 30], [6, 40], [10, 10]], columns=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]</div>
<div class="line"><span class="lineno"> 1017</span>    )</div>
<div class="line"><span class="lineno"> 1018</span>    result_sort.index = CategoricalIndex(index, name=<span class="stringliteral">&quot;dt&quot;</span>, ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>    index = [</div>
<div class="line"><span class="lineno"> 1021</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 7, 1),</div>
<div class="line"><span class="lineno"> 1022</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 2, 1),</div>
<div class="line"><span class="lineno"> 1023</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 5, 1),</div>
<div class="line"><span class="lineno"> 1024</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 1, 1),</div>
<div class="line"><span class="lineno"> 1025</span>    ]</div>
<div class="line"><span class="lineno"> 1026</span>    result_nosort = DataFrame(</div>
<div class="line"><span class="lineno"> 1027</span>        [[10, 10], [5, 30], [6, 40], [1, 60]], columns=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]</div>
<div class="line"><span class="lineno"> 1028</span>    )</div>
<div class="line"><span class="lineno"> 1029</span>    result_nosort.index = CategoricalIndex(</div>
<div class="line"><span class="lineno"> 1030</span>        index, categories=index, name=<span class="stringliteral">&quot;dt&quot;</span>, ordered=<span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 1031</span>    )</div>
<div class="line"><span class="lineno"> 1032</span> </div>
<div class="line"><span class="lineno"> 1033</span>    col = <span class="stringliteral">&quot;dt&quot;</span></div>
<div class="line"><span class="lineno"> 1034</span>    tm.assert_frame_equal(</div>
<div class="line"><span class="lineno"> 1035</span>        result_sort, df.groupby(col, sort=<span class="keyword">True</span>, observed=<span class="keyword">False</span>).first()</div>
<div class="line"><span class="lineno"> 1036</span>    )</div>
<div class="line"><span class="lineno"> 1037</span> </div>
<div class="line"><span class="lineno"> 1038</span>    <span class="comment"># when categories is ordered, group is ordered by category&#39;s order</span></div>
<div class="line"><span class="lineno"> 1039</span>    tm.assert_frame_equal(</div>
<div class="line"><span class="lineno"> 1040</span>        result_sort, df.groupby(col, sort=<span class="keyword">False</span>, observed=<span class="keyword">False</span>).first()</div>
<div class="line"><span class="lineno"> 1041</span>    )</div>
<div class="line"><span class="lineno"> 1042</span> </div>
<div class="line"><span class="lineno"> 1043</span>    <span class="comment"># ordered = False</span></div>
<div class="line"><span class="lineno"> 1044</span>    df[<span class="stringliteral">&quot;dt&quot;</span>] = Categorical(df[<span class="stringliteral">&quot;dt&quot;</span>], ordered=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1045</span>    index = [</div>
<div class="line"><span class="lineno"> 1046</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 1, 1),</div>
<div class="line"><span class="lineno"> 1047</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 2, 1),</div>
<div class="line"><span class="lineno"> 1048</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 5, 1),</div>
<div class="line"><span class="lineno"> 1049</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 7, 1),</div>
<div class="line"><span class="lineno"> 1050</span>    ]</div>
<div class="line"><span class="lineno"> 1051</span>    result_sort = DataFrame(</div>
<div class="line"><span class="lineno"> 1052</span>        [[1, 60], [5, 30], [6, 40], [10, 10]], columns=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]</div>
<div class="line"><span class="lineno"> 1053</span>    )</div>
<div class="line"><span class="lineno"> 1054</span>    result_sort.index = CategoricalIndex(index, name=<span class="stringliteral">&quot;dt&quot;</span>)</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>    index = [</div>
<div class="line"><span class="lineno"> 1057</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 7, 1),</div>
<div class="line"><span class="lineno"> 1058</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 2, 1),</div>
<div class="line"><span class="lineno"> 1059</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 5, 1),</div>
<div class="line"><span class="lineno"> 1060</span>        <a class="code hl_namespace" href="namespacedatetime.html">datetime</a>(2011, 1, 1),</div>
<div class="line"><span class="lineno"> 1061</span>    ]</div>
<div class="line"><span class="lineno"> 1062</span>    result_nosort = DataFrame(</div>
<div class="line"><span class="lineno"> 1063</span>        [[10, 10], [5, 30], [6, 40], [1, 60]], columns=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]</div>
<div class="line"><span class="lineno"> 1064</span>    )</div>
<div class="line"><span class="lineno"> 1065</span>    result_nosort.index = CategoricalIndex(index, categories=index, name=<span class="stringliteral">&quot;dt&quot;</span>)</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>    col = <span class="stringliteral">&quot;dt&quot;</span></div>
<div class="line"><span class="lineno"> 1068</span>    tm.assert_frame_equal(</div>
<div class="line"><span class="lineno"> 1069</span>        result_sort, df.groupby(col, sort=<span class="keyword">True</span>, observed=<span class="keyword">False</span>).first()</div>
<div class="line"><span class="lineno"> 1070</span>    )</div>
<div class="line"><span class="lineno"> 1071</span>    tm.assert_frame_equal(</div>
<div class="line"><span class="lineno"> 1072</span>        result_nosort, df.groupby(col, sort=<span class="keyword">False</span>, observed=<span class="keyword">False</span>).first()</div>
<div class="line"><span class="lineno"> 1073</span>    )</div>
<div class="line"><span class="lineno"> 1074</span> </div>
<div class="line"><span class="lineno"> 1075</span> </div>
<div class="ttc" id="anamespacedatetime_html"><div class="ttname"><a href="namespacedatetime.html">datetime</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a499cd38d4796d0bf4b7ee9d9c91480e8" name="a499cd38d4796d0bf4b7ee9d9c91480e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a499cd38d4796d0bf4b7ee9d9c91480e8">&#9670;&#160;</a></span>test_sorted_missing_category_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_sorted_missing_category_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1571</span><span class="keyword">def </span>test_sorted_missing_category_values():</div>
<div class="line"><span class="lineno"> 1572</span>    <span class="comment"># GH 28597</span></div>
<div class="line"><span class="lineno"> 1573</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1574</span>        {</div>
<div class="line"><span class="lineno"> 1575</span>            <span class="stringliteral">&quot;foo&quot;</span>: [</div>
<div class="line"><span class="lineno"> 1576</span>                <span class="stringliteral">&quot;small&quot;</span>,</div>
<div class="line"><span class="lineno"> 1577</span>                <span class="stringliteral">&quot;large&quot;</span>,</div>
<div class="line"><span class="lineno"> 1578</span>                <span class="stringliteral">&quot;large&quot;</span>,</div>
<div class="line"><span class="lineno"> 1579</span>                <span class="stringliteral">&quot;large&quot;</span>,</div>
<div class="line"><span class="lineno"> 1580</span>                <span class="stringliteral">&quot;medium&quot;</span>,</div>
<div class="line"><span class="lineno"> 1581</span>                <span class="stringliteral">&quot;large&quot;</span>,</div>
<div class="line"><span class="lineno"> 1582</span>                <span class="stringliteral">&quot;large&quot;</span>,</div>
<div class="line"><span class="lineno"> 1583</span>                <span class="stringliteral">&quot;medium&quot;</span>,</div>
<div class="line"><span class="lineno"> 1584</span>            ],</div>
<div class="line"><span class="lineno"> 1585</span>            <span class="stringliteral">&quot;bar&quot;</span>: [<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>],</div>
<div class="line"><span class="lineno"> 1586</span>        }</div>
<div class="line"><span class="lineno"> 1587</span>    )</div>
<div class="line"><span class="lineno"> 1588</span>    df[<span class="stringliteral">&quot;foo&quot;</span>] = (</div>
<div class="line"><span class="lineno"> 1589</span>        df[<span class="stringliteral">&quot;foo&quot;</span>]</div>
<div class="line"><span class="lineno"> 1590</span>        .astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1591</span>        .cat.set_categories([<span class="stringliteral">&quot;tiny&quot;</span>, <span class="stringliteral">&quot;small&quot;</span>, <span class="stringliteral">&quot;medium&quot;</span>, <span class="stringliteral">&quot;large&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1592</span>    )</div>
<div class="line"><span class="lineno"> 1593</span> </div>
<div class="line"><span class="lineno"> 1594</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1595</span>        {</div>
<div class="line"><span class="lineno"> 1596</span>            <span class="stringliteral">&quot;tiny&quot;</span>: {<span class="stringliteral">&quot;A&quot;</span>: 0, <span class="stringliteral">&quot;C&quot;</span>: 0},</div>
<div class="line"><span class="lineno"> 1597</span>            <span class="stringliteral">&quot;small&quot;</span>: {<span class="stringliteral">&quot;A&quot;</span>: 0, <span class="stringliteral">&quot;C&quot;</span>: 1},</div>
<div class="line"><span class="lineno"> 1598</span>            <span class="stringliteral">&quot;medium&quot;</span>: {<span class="stringliteral">&quot;A&quot;</span>: 1, <span class="stringliteral">&quot;C&quot;</span>: 1},</div>
<div class="line"><span class="lineno"> 1599</span>            <span class="stringliteral">&quot;large&quot;</span>: {<span class="stringliteral">&quot;A&quot;</span>: 3, <span class="stringliteral">&quot;C&quot;</span>: 2},</div>
<div class="line"><span class="lineno"> 1600</span>        }</div>
<div class="line"><span class="lineno"> 1601</span>    )</div>
<div class="line"><span class="lineno"> 1602</span>    expected = expected.rename_axis(<span class="stringliteral">&quot;bar&quot;</span>, axis=<span class="stringliteral">&quot;index&quot;</span>)</div>
<div class="line"><span class="lineno"> 1603</span>    expected.columns = CategoricalIndex(</div>
<div class="line"><span class="lineno"> 1604</span>        [<span class="stringliteral">&quot;tiny&quot;</span>, <span class="stringliteral">&quot;small&quot;</span>, <span class="stringliteral">&quot;medium&quot;</span>, <span class="stringliteral">&quot;large&quot;</span>],</div>
<div class="line"><span class="lineno"> 1605</span>        categories=[<span class="stringliteral">&quot;tiny&quot;</span>, <span class="stringliteral">&quot;small&quot;</span>, <span class="stringliteral">&quot;medium&quot;</span>, <span class="stringliteral">&quot;large&quot;</span>],</div>
<div class="line"><span class="lineno"> 1606</span>        ordered=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1607</span>        name=<span class="stringliteral">&quot;foo&quot;</span>,</div>
<div class="line"><span class="lineno"> 1608</span>        dtype=<span class="stringliteral">&quot;category&quot;</span>,</div>
<div class="line"><span class="lineno"> 1609</span>    )</div>
<div class="line"><span class="lineno"> 1610</span> </div>
<div class="line"><span class="lineno"> 1611</span>    result = df.groupby([<span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>]).size().unstack()</div>
<div class="line"><span class="lineno"> 1612</span> </div>
<div class="line"><span class="lineno"> 1613</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1614</span> </div>
<div class="line"><span class="lineno"> 1615</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0e1ec770620a5aa91f3b9a0b9aeb3fe" name="ad0e1ec770620a5aa91f3b9a0b9aeb3fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0e1ec770620a5aa91f3b9a0b9aeb3fe">&#9670;&#160;</a></span>test_sorting_with_different_categoricals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_sorting_with_different_categoricals </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  260</span><span class="keyword">def </span>test_sorting_with_different_categoricals():</div>
<div class="line"><span class="lineno">  261</span>    <span class="comment"># GH 24271</span></div>
<div class="line"><span class="lineno">  262</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  263</span>        {</div>
<div class="line"><span class="lineno">  264</span>            <span class="stringliteral">&quot;group&quot;</span>: [<span class="stringliteral">&quot;A&quot;</span>] * 6 + [<span class="stringliteral">&quot;B&quot;</span>] * 6,</div>
<div class="line"><span class="lineno">  265</span>            <span class="stringliteral">&quot;dose&quot;</span>: [<span class="stringliteral">&quot;high&quot;</span>, <span class="stringliteral">&quot;med&quot;</span>, <span class="stringliteral">&quot;low&quot;</span>] * 4,</div>
<div class="line"><span class="lineno">  266</span>            <span class="stringliteral">&quot;outcomes&quot;</span>: np.arange(12.0),</div>
<div class="line"><span class="lineno">  267</span>        }</div>
<div class="line"><span class="lineno">  268</span>    )</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>    df.dose = Categorical(df.dose, categories=[<span class="stringliteral">&quot;low&quot;</span>, <span class="stringliteral">&quot;med&quot;</span>, <span class="stringliteral">&quot;high&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>    result = df.groupby(<span class="stringliteral">&quot;group&quot;</span>)[<span class="stringliteral">&quot;dose&quot;</span>].value_counts()</div>
<div class="line"><span class="lineno">  273</span>    result = result.sort_index(level=0, sort_remaining=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  274</span>    index = [<span class="stringliteral">&quot;low&quot;</span>, <span class="stringliteral">&quot;med&quot;</span>, <span class="stringliteral">&quot;high&quot;</span>, <span class="stringliteral">&quot;low&quot;</span>, <span class="stringliteral">&quot;med&quot;</span>, <span class="stringliteral">&quot;high&quot;</span>]</div>
<div class="line"><span class="lineno">  275</span>    index = Categorical(index, categories=[<span class="stringliteral">&quot;low&quot;</span>, <span class="stringliteral">&quot;med&quot;</span>, <span class="stringliteral">&quot;high&quot;</span>], ordered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  276</span>    index = [[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], CategoricalIndex(index)]</div>
<div class="line"><span class="lineno">  277</span>    index = MultiIndex.from_arrays(index, names=[<span class="stringliteral">&quot;group&quot;</span>, <span class="stringliteral">&quot;dose&quot;</span>])</div>
<div class="line"><span class="lineno">  278</span>    expected = Series([2] * 6, index=index, name=<span class="stringliteral">&quot;dose&quot;</span>)</div>
<div class="line"><span class="lineno">  279</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span><span class="preprocessor">@pytest.mark.parametrize(&quot;ordered&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ff64bf024fc56b5959a45b7dceeea37" name="a6ff64bf024fc56b5959a45b7dceeea37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ff64bf024fc56b5959a45b7dceeea37">&#9670;&#160;</a></span>test_unstack_categorical()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_categorical.test_unstack_categorical </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  661</span><span class="keyword">def </span>test_unstack_categorical():</div>
<div class="line"><span class="lineno">  662</span>    <span class="comment"># GH11558 (example is taken from the original issue)</span></div>
<div class="line"><span class="lineno">  663</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  664</span>        {<span class="stringliteral">&quot;a&quot;</span>: range(10), <span class="stringliteral">&quot;medium&quot;</span>: [<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>] * 5, <span class="stringliteral">&quot;artist&quot;</span>: list(<span class="stringliteral">&quot;XYXXY&quot;</span>) * 2}</div>
<div class="line"><span class="lineno">  665</span>    )</div>
<div class="line"><span class="lineno">  666</span>    df[<span class="stringliteral">&quot;medium&quot;</span>] = df[<span class="stringliteral">&quot;medium&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    gcat = df.groupby([<span class="stringliteral">&quot;artist&quot;</span>, <span class="stringliteral">&quot;medium&quot;</span>], observed=<span class="keyword">False</span>)[<span class="stringliteral">&quot;a&quot;</span>].count().unstack()</div>
<div class="line"><span class="lineno">  669</span>    result = gcat.describe()</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>    exp_columns = CategoricalIndex([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], ordered=<span class="keyword">False</span>, name=<span class="stringliteral">&quot;medium&quot;</span>)</div>
<div class="line"><span class="lineno">  672</span>    tm.assert_index_equal(result.columns, exp_columns)</div>
<div class="line"><span class="lineno">  673</span>    tm.assert_categorical_equal(result.columns.values, exp_columns.values)</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>    result = gcat[<span class="stringliteral">&quot;A&quot;</span>] + gcat[<span class="stringliteral">&quot;B&quot;</span>]</div>
<div class="line"><span class="lineno">  676</span>    expected = Series([6, 4], index=Index([<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>], name=<span class="stringliteral">&quot;artist&quot;</span>))</div>
<div class="line"><span class="lineno">  677</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a52f05bc75014f1eba8105115e9bb95af" name="a52f05bc75014f1eba8105115e9bb95af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52f05bc75014f1eba8105115e9bb95af">&#9670;&#160;</a></span>_results_for_groupbys_with_missing_categories</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict pandas.tests.groupby.test_categorical._results_for_groupbys_with_missing_categories</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
