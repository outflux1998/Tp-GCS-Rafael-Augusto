<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._optimize Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html">_optimize</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._optimize Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__optimize_1_1___brute___wrapper.html">_Brute_Wrapper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__optimize_1_1___line_search_error.html">_LineSearchError</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__optimize_1_1___max_func_call_error.html">_MaxFuncCallError</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__optimize_1_1_brent.html">Brent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__optimize_1_1_memoize_jac.html">MemoizeJac</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__optimize_1_1_optimize_result.html">OptimizeResult</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__optimize_1_1_optimize_warning.html">OptimizeWarning</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adb2a481bff6d99a8ce39d61a605474d2" id="r_adb2a481bff6d99a8ce39d61a605474d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#adb2a481bff6d99a8ce39d61a605474d2">_check_unknown_options</a> (unknown_options)</td></tr>
<tr class="separator:adb2a481bff6d99a8ce39d61a605474d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8221279cef2672dbdc387b994cc8a2" id="r_adc8221279cef2672dbdc387b994cc8a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#adc8221279cef2672dbdc387b994cc8a2">is_array_scalar</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>)</td></tr>
<tr class="separator:adc8221279cef2672dbdc387b994cc8a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77867a3f237b7be985c2947451714929" id="r_a77867a3f237b7be985c2947451714929"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a77867a3f237b7be985c2947451714929">vecnorm</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, ord=2)</td></tr>
<tr class="separator:a77867a3f237b7be985c2947451714929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73454f855569a9ca1a9979e3d9b7a0a" id="r_ad73454f855569a9ca1a9979e3d9b7a0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#ad73454f855569a9ca1a9979e3d9b7a0a">_prepare_scalar_function</a> (fun, x0, jac=None, args=(), bounds=None, epsilon=None, finite_diff_rel_step=None, hess=None)</td></tr>
<tr class="separator:ad73454f855569a9ca1a9979e3d9b7a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf949eb8be2c742f97371a6adb8accac" id="r_adf949eb8be2c742f97371a6adb8accac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#adf949eb8be2c742f97371a6adb8accac">_clip_x_for_func</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, bounds)</td></tr>
<tr class="separator:adf949eb8be2c742f97371a6adb8accac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8352decf7aa9c9c9b686a613eec05caa" id="r_a8352decf7aa9c9c9b686a613eec05caa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8352decf7aa9c9c9b686a613eec05caa">_check_clip_x</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, bounds)</td></tr>
<tr class="separator:a8352decf7aa9c9c9b686a613eec05caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02e15f5b55789e1f63fd216733195454" id="r_a02e15f5b55789e1f63fd216733195454"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a02e15f5b55789e1f63fd216733195454">rosen</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>)</td></tr>
<tr class="separator:a02e15f5b55789e1f63fd216733195454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54e7ddc9ff63c7eaa2b008492c9f7821" id="r_a54e7ddc9ff63c7eaa2b008492c9f7821"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a54e7ddc9ff63c7eaa2b008492c9f7821">rosen_der</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>)</td></tr>
<tr class="separator:a54e7ddc9ff63c7eaa2b008492c9f7821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab0b0f1af6a0025d1ea4ab30b6412b1" id="r_aaab0b0f1af6a0025d1ea4ab30b6412b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#aaab0b0f1af6a0025d1ea4ab30b6412b1">rosen_hess</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>)</td></tr>
<tr class="separator:aaab0b0f1af6a0025d1ea4ab30b6412b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a531ebd72f83786f0ce75f3347ecb2449" id="r_a531ebd72f83786f0ce75f3347ecb2449"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a531ebd72f83786f0ce75f3347ecb2449">rosen_hess_prod</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, p)</td></tr>
<tr class="separator:a531ebd72f83786f0ce75f3347ecb2449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0289ea1f45541e56b527dc7817c88bbd" id="r_a0289ea1f45541e56b527dc7817c88bbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a0289ea1f45541e56b527dc7817c88bbd">_wrap_scalar_function</a> (function, args)</td></tr>
<tr class="separator:a0289ea1f45541e56b527dc7817c88bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf807e331a381a821ee49e99e63f6578" id="r_abf807e331a381a821ee49e99e63f6578"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#abf807e331a381a821ee49e99e63f6578">_wrap_scalar_function_maxfun_validation</a> (function, args, maxfun)</td></tr>
<tr class="separator:abf807e331a381a821ee49e99e63f6578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8825f72fbb699b9d86a64dfd7f2d5b" id="r_a1c8825f72fbb699b9d86a64dfd7f2d5b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a1c8825f72fbb699b9d86a64dfd7f2d5b">fmin</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args=(), xtol=1e-4, ftol=1e-4, maxiter=None, maxfun=None, full_output=0, disp=1, retall=0, callback=None, initial_simplex=None)</td></tr>
<tr class="separator:a1c8825f72fbb699b9d86a64dfd7f2d5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a021f788937329bc7411d5a6b29a84173" id="r_a021f788937329bc7411d5a6b29a84173"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a021f788937329bc7411d5a6b29a84173">_minimize_neldermead</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args=(), callback=None, maxiter=None, maxfev=None, disp=False, return_all=False, initial_simplex=None, xatol=1e-4, fatol=1e-4, adaptive=False, bounds=None, **unknown_options)</td></tr>
<tr class="separator:a021f788937329bc7411d5a6b29a84173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1bdcfcf9601a38ca22629dc3d93ef39" id="r_ab1bdcfcf9601a38ca22629dc3d93ef39"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#ab1bdcfcf9601a38ca22629dc3d93ef39">approx_fprime</a> (xk, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, epsilon=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, *args)</td></tr>
<tr class="separator:ab1bdcfcf9601a38ca22629dc3d93ef39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fba77c8a7356feafdaff564a7c39b48" id="r_a5fba77c8a7356feafdaff564a7c39b48"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a5fba77c8a7356feafdaff564a7c39b48">check_grad</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, grad, x0, *args, epsilon=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, direction='all', seed=None)</td></tr>
<tr class="separator:a5fba77c8a7356feafdaff564a7c39b48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11dbfcc1981be014e18da16c4f1b7545" id="r_a11dbfcc1981be014e18da16c4f1b7545"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a11dbfcc1981be014e18da16c4f1b7545">approx_fhess_p</a> (x0, p, fprime, epsilon, *args)</td></tr>
<tr class="separator:a11dbfcc1981be014e18da16c4f1b7545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7199b6af73bdb0295d37336b3be8ed5a" id="r_a7199b6af73bdb0295d37336b3be8ed5a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a7199b6af73bdb0295d37336b3be8ed5a">_line_search_wolfe12</a> (<a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, fprime, xk, pk, gfk, old_fval, old_old_fval, **kwargs)</td></tr>
<tr class="separator:a7199b6af73bdb0295d37336b3be8ed5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc7548b50584733437750426a25476c2" id="r_acc7548b50584733437750426a25476c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#acc7548b50584733437750426a25476c2">fmin_bfgs</a> (<a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, x0, fprime=None, args=(), gtol=1e-5, norm=Inf, epsilon=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, maxiter=None, full_output=0, disp=1, retall=0, callback=None)</td></tr>
<tr class="separator:acc7548b50584733437750426a25476c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda888a2135e3f51c10a055ef39f21ba" id="r_adda888a2135e3f51c10a055ef39f21ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#adda888a2135e3f51c10a055ef39f21ba">_minimize_bfgs</a> (fun, x0, args=(), jac=None, callback=None, gtol=1e-5, norm=Inf, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, maxiter=None, disp=False, return_all=False, finite_diff_rel_step=None, **unknown_options)</td></tr>
<tr class="separator:adda888a2135e3f51c10a055ef39f21ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6dce6d9178c7f8c0528157dc1b54df4" id="r_af6dce6d9178c7f8c0528157dc1b54df4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#af6dce6d9178c7f8c0528157dc1b54df4">fmin_cg</a> (<a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, x0, fprime=None, args=(), gtol=1e-5, norm=Inf, epsilon=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, maxiter=None, full_output=0, disp=1, retall=0, callback=None)</td></tr>
<tr class="separator:af6dce6d9178c7f8c0528157dc1b54df4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3191cd4252e97988cd6402c7c2286ac0" id="r_a3191cd4252e97988cd6402c7c2286ac0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a3191cd4252e97988cd6402c7c2286ac0">_minimize_cg</a> (fun, x0, args=(), jac=None, callback=None, gtol=1e-5, norm=Inf, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, maxiter=None, disp=False, return_all=False, finite_diff_rel_step=None, **unknown_options)</td></tr>
<tr class="separator:a3191cd4252e97988cd6402c7c2286ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f87d4a3076d3d4579a03dfe3f32ddd" id="r_ac1f87d4a3076d3d4579a03dfe3f32ddd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#ac1f87d4a3076d3d4579a03dfe3f32ddd">fmin_ncg</a> (<a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, x0, fprime, fhess_p=None, fhess=None, args=(), avextol=1e-5, epsilon=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, maxiter=None, full_output=0, disp=1, retall=0, callback=None)</td></tr>
<tr class="separator:ac1f87d4a3076d3d4579a03dfe3f32ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0095fb8edd856194da3b0a1ca2d761cd" id="r_a0095fb8edd856194da3b0a1ca2d761cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a0095fb8edd856194da3b0a1ca2d761cd">_minimize_newtoncg</a> (fun, x0, args=(), jac=None, hess=None, hessp=None, callback=None, xtol=1e-5, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, maxiter=None, disp=False, return_all=False, **unknown_options)</td></tr>
<tr class="separator:a0095fb8edd856194da3b0a1ca2d761cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c632088d14f5b42c1e17998149d676" id="r_a86c632088d14f5b42c1e17998149d676"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a86c632088d14f5b42c1e17998149d676">fminbound</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x1, x2, args=(), xtol=1e-5, maxfun=500, full_output=0, disp=1)</td></tr>
<tr class="separator:a86c632088d14f5b42c1e17998149d676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71ba569fdc9f756b4a622c6fe4ff91da" id="r_a71ba569fdc9f756b4a622c6fe4ff91da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a71ba569fdc9f756b4a622c6fe4ff91da">_minimize_scalar_bounded</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, bounds, args=(), xatol=1e-5, maxiter=500, disp=0, **unknown_options)</td></tr>
<tr class="separator:a71ba569fdc9f756b4a622c6fe4ff91da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab667dd7bd58227d18103e3e286969b71" id="r_ab667dd7bd58227d18103e3e286969b71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#ab667dd7bd58227d18103e3e286969b71">brent</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, args=(), brack=None, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1.48e-8, full_output=0, maxiter=500)</td></tr>
<tr class="separator:ab667dd7bd58227d18103e3e286969b71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97defae4d0b5c95d200370a81f9eebe7" id="r_a97defae4d0b5c95d200370a81f9eebe7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a97defae4d0b5c95d200370a81f9eebe7">_minimize_scalar_brent</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, brack=None, args=(), xtol=1.48e-8, maxiter=500, disp=0, **unknown_options)</td></tr>
<tr class="separator:a97defae4d0b5c95d200370a81f9eebe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f74c3036679f7cddb38d24bb4ad22ee" id="r_a4f74c3036679f7cddb38d24bb4ad22ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a4f74c3036679f7cddb38d24bb4ad22ee">golden</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, args=(), brack=None, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, full_output=0, maxiter=5000)</td></tr>
<tr class="separator:a4f74c3036679f7cddb38d24bb4ad22ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49ead78bfe447477b882bebc0daf62f6" id="r_a49ead78bfe447477b882bebc0daf62f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a49ead78bfe447477b882bebc0daf62f6">_minimize_scalar_golden</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, brack=None, args=(), xtol=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a>, maxiter=5000, disp=0, **unknown_options)</td></tr>
<tr class="separator:a49ead78bfe447477b882bebc0daf62f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee61cc6cef1e91f845fff5cf0a8fc44f" id="r_aee61cc6cef1e91f845fff5cf0a8fc44f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#aee61cc6cef1e91f845fff5cf0a8fc44f">bracket</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, xa=0.0, xb=1.0, args=(), grow_limit=110.0, maxiter=1000)</td></tr>
<tr class="separator:aee61cc6cef1e91f845fff5cf0a8fc44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b8429f36e8644a3d6523490a4633127" id="r_a3b8429f36e8644a3d6523490a4633127"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a3b8429f36e8644a3d6523490a4633127">_line_for_search</a> (x0, <a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>, lower_bound, upper_bound)</td></tr>
<tr class="separator:a3b8429f36e8644a3d6523490a4633127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7fe737c35f3c1f34556e9e97b0ba35f" id="r_ab7fe737c35f3c1f34556e9e97b0ba35f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#ab7fe737c35f3c1f34556e9e97b0ba35f">_linesearch_powell</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, p, xi, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-3, lower_bound=None, upper_bound=None, fval=None)</td></tr>
<tr class="separator:ab7fe737c35f3c1f34556e9e97b0ba35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37e1a3656d4e065f5ea2f3acdd29b20" id="r_ab37e1a3656d4e065f5ea2f3acdd29b20"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#ab37e1a3656d4e065f5ea2f3acdd29b20">fmin_powell</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args=(), xtol=1e-4, ftol=1e-4, maxiter=None, maxfun=None, full_output=0, disp=1, retall=0, callback=None, direc=None)</td></tr>
<tr class="separator:ab37e1a3656d4e065f5ea2f3acdd29b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b7569c6086976da8d1e928c31b43df8" id="r_a3b7569c6086976da8d1e928c31b43df8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a3b7569c6086976da8d1e928c31b43df8">_minimize_powell</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args=(), callback=None, bounds=None, xtol=1e-4, ftol=1e-4, maxiter=None, maxfev=None, disp=False, direc=None, return_all=False, **unknown_options)</td></tr>
<tr class="separator:a3b7569c6086976da8d1e928c31b43df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a058ffe84994a23e164037a4752b17d0c" id="r_a058ffe84994a23e164037a4752b17d0c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a058ffe84994a23e164037a4752b17d0c">_endprint</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, flag, fval, maxfun, xtol, disp)</td></tr>
<tr class="separator:a058ffe84994a23e164037a4752b17d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e856197a3ade6049ea4f05461669d8" id="r_a98e856197a3ade6049ea4f05461669d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a98e856197a3ade6049ea4f05461669d8">brute</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, ranges, args=(), Ns=20, full_output=0, finish=<a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a1c8825f72fbb699b9d86a64dfd7f2d5b">fmin</a>, disp=False, workers=1)</td></tr>
<tr class="separator:a98e856197a3ade6049ea4f05461669d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50f7c818d44ee4c953b28bcddbc326f1" id="r_a50f7c818d44ee4c953b28bcddbc326f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a50f7c818d44ee4c953b28bcddbc326f1">show_options</a> (solver=None, method=None, disp=True)</td></tr>
<tr class="separator:a50f7c818d44ee4c953b28bcddbc326f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4e43d279455305b78dd02236569efb5" id="r_ab4e43d279455305b78dd02236569efb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#ab4e43d279455305b78dd02236569efb5">main</a> ()</td></tr>
<tr class="separator:ab4e43d279455305b78dd02236569efb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a09a2252518464e5a38ff3fcffce3e3dc" id="r_a09a2252518464e5a38ff3fcffce3e3dc"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a09a2252518464e5a38ff3fcffce3e3dc">_status_message</a></td></tr>
<tr class="separator:a09a2252518464e5a38ff3fcffce3e3dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c8bc7126a371e035fd8e52aff856d71" id="r_a8c8bc7126a371e035fd8e52aff856d71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a> = sqrt(np.finfo(float).<a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>)</td></tr>
<tr class="separator:a8c8bc7126a371e035fd8e52aff856d71"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8352decf7aa9c9c9b686a613eec05caa" name="a8352decf7aa9c9c9b686a613eec05caa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8352decf7aa9c9c9b686a613eec05caa">&#9670;&#160;</a></span>_check_clip_x()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._check_clip_x </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  282</span><span class="keyword">def </span>_check_clip_x(x, bounds):</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">if</span> (x &lt; bounds[0]).any() <span class="keywordflow">or</span> (x &gt; bounds[1]).any():</div>
<div class="line"><span class="lineno">  284</span>        warnings.warn(<span class="stringliteral">&quot;Values in x were outside bounds during a &quot;</span></div>
<div class="line"><span class="lineno">  285</span>                      <span class="stringliteral">&quot;minimize step, clipping to bounds&quot;</span>, RuntimeWarning)</div>
<div class="line"><span class="lineno">  286</span>        x = np.clip(x, bounds[0], bounds[1])</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adb2a481bff6d99a8ce39d61a605474d2" name="adb2a481bff6d99a8ce39d61a605474d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb2a481bff6d99a8ce39d61a605474d2">&#9670;&#160;</a></span>_check_unknown_options()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._check_unknown_options </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>unknown_options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  147</span><span class="keyword">def </span>_check_unknown_options(unknown_options):</div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">if</span> unknown_options:</div>
<div class="line"><span class="lineno">  149</span>        msg = <span class="stringliteral">&quot;, &quot;</span>.join(map(str, unknown_options.keys()))</div>
<div class="line"><span class="lineno">  150</span>        <span class="comment"># Stack level 4: this is called from _minimize_*, which is</span></div>
<div class="line"><span class="lineno">  151</span>        <span class="comment"># called from another function in SciPy. Level 4 is the first</span></div>
<div class="line"><span class="lineno">  152</span>        <span class="comment"># level in user code.</span></div>
<div class="line"><span class="lineno">  153</span>        warnings.warn(<span class="stringliteral">&quot;Unknown solver options: %s&quot;</span> % msg, OptimizeWarning, 4)</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adf949eb8be2c742f97371a6adb8accac" name="adf949eb8be2c742f97371a6adb8accac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf949eb8be2c742f97371a6adb8accac">&#9670;&#160;</a></span>_clip_x_for_func()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._clip_x_for_func </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  269</span><span class="keyword">def </span>_clip_x_for_func(func, bounds):</div>
<div class="line"><span class="lineno">  270</span>    <span class="comment"># ensures that x values sent to func are clipped to bounds</span></div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>    <span class="comment"># this is used as a mitigation for gh11403, slsqp/tnc sometimes</span></div>
<div class="line"><span class="lineno">  273</span>    <span class="comment"># suggest a move that is outside the limits by 1 or 2 ULP. This</span></div>
<div class="line"><span class="lineno">  274</span>    <span class="comment"># unclean fix makes sure x is strictly within bounds.</span></div>
<div class="line"><span class="lineno">  275</span>    <span class="keyword">def </span>eval(x):</div>
<div class="line"><span class="lineno">  276</span>        x = _check_clip_x(x, bounds)</div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x)</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordflow">return</span> eval</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a058ffe84994a23e164037a4752b17d0c" name="a058ffe84994a23e164037a4752b17d0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a058ffe84994a23e164037a4752b17d0c">&#9670;&#160;</a></span>_endprint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._endprint </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3275</span><span class="keyword">def </span>_endprint(x, flag, fval, maxfun, xtol, disp):</div>
<div class="line"><span class="lineno"> 3276</span>    <span class="keywordflow">if</span> flag == 0:</div>
<div class="line"><span class="lineno"> 3277</span>        <span class="keywordflow">if</span> disp &gt; 1:</div>
<div class="line"><span class="lineno"> 3278</span>            print(<span class="stringliteral">&quot;\nOptimization terminated successfully;\n&quot;</span></div>
<div class="line"><span class="lineno"> 3279</span>                  <span class="stringliteral">&quot;The returned value satisfies the termination criteria\n&quot;</span></div>
<div class="line"><span class="lineno"> 3280</span>                  <span class="stringliteral">&quot;(using xtol = &quot;</span>, xtol, <span class="stringliteral">&quot;)&quot;</span>)</div>
<div class="line"><span class="lineno"> 3281</span>    <span class="keywordflow">if</span> flag == 1:</div>
<div class="line"><span class="lineno"> 3282</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 3283</span>            print(<span class="stringliteral">&quot;\nMaximum number of function evaluations exceeded --- &quot;</span></div>
<div class="line"><span class="lineno"> 3284</span>                  <span class="stringliteral">&quot;increase maxfun argument.\n&quot;</span>)</div>
<div class="line"><span class="lineno"> 3285</span>    <span class="keywordflow">if</span> flag == 2:</div>
<div class="line"><span class="lineno"> 3286</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 3287</span>            print(<span class="stringliteral">&quot;\n{}&quot;</span>.format(_status_message[<span class="stringliteral">&#39;nan&#39;</span>]))</div>
<div class="line"><span class="lineno"> 3288</span>    <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno"> 3289</span> </div>
<div class="line"><span class="lineno"> 3290</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b8429f36e8644a3d6523490a4633127" name="a3b8429f36e8644a3d6523490a4633127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b8429f36e8644a3d6523490a4633127">&#9670;&#160;</a></span>_line_for_search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._line_for_search </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lower_bound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>upper_bound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given a parameter vector ``x0`` with length ``n`` and a direction
vector ``alpha`` with length ``n``, and lower and upper bounds on
each of the ``n`` parameters, what are the bounds on a scalar
``l`` such that ``lower_bound &lt;= x0 + alpha * l &lt;= upper_bound``.


Parameters
----------
x0 : np.array.
    The vector representing the current location.
    Note ``np.shape(x0) == (n,)``.
alpha : np.array.
    The vector representing the direction.
    Note ``np.shape(alpha) == (n,)``.
lower_bound : np.array.
    The lower bounds for each parameter in ``x0``. If the ``i``th
    parameter in ``x0`` is unbounded below, then ``lower_bound[i]``
    should be ``-np.inf``.
    Note ``np.shape(lower_bound) == (n,)``.
upper_bound : np.array.
    The upper bounds for each parameter in ``x0``. If the ``i``th
    parameter in ``x0`` is unbounded above, then ``upper_bound[i]``
    should be ``np.inf``.
    Note ``np.shape(upper_bound) == (n,)``.

Returns
-------
res : tuple ``(lmin, lmax)``
    The bounds for ``l`` such that
        ``lower_bound[i] &lt;= x0[i] + alpha[i] * l &lt;= upper_bound[i]``
    for all ``i``.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2818</span><span class="keyword">def </span>_line_for_search(x0, alpha, lower_bound, upper_bound):</div>
<div class="line"><span class="lineno"> 2819</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2820</span><span class="stringliteral">    Given a parameter vector ``x0`` with length ``n`` and a direction</span></div>
<div class="line"><span class="lineno"> 2821</span><span class="stringliteral">    vector ``alpha`` with length ``n``, and lower and upper bounds on</span></div>
<div class="line"><span class="lineno"> 2822</span><span class="stringliteral">    each of the ``n`` parameters, what are the bounds on a scalar</span></div>
<div class="line"><span class="lineno"> 2823</span><span class="stringliteral">    ``l`` such that ``lower_bound &lt;= x0 + alpha * l &lt;= upper_bound``.</span></div>
<div class="line"><span class="lineno"> 2824</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2825</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2826</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2827</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2828</span><span class="stringliteral">    x0 : np.array.</span></div>
<div class="line"><span class="lineno"> 2829</span><span class="stringliteral">        The vector representing the current location.</span></div>
<div class="line"><span class="lineno"> 2830</span><span class="stringliteral">        Note ``np.shape(x0) == (n,)``.</span></div>
<div class="line"><span class="lineno"> 2831</span><span class="stringliteral">    alpha : np.array.</span></div>
<div class="line"><span class="lineno"> 2832</span><span class="stringliteral">        The vector representing the direction.</span></div>
<div class="line"><span class="lineno"> 2833</span><span class="stringliteral">        Note ``np.shape(alpha) == (n,)``.</span></div>
<div class="line"><span class="lineno"> 2834</span><span class="stringliteral">    lower_bound : np.array.</span></div>
<div class="line"><span class="lineno"> 2835</span><span class="stringliteral">        The lower bounds for each parameter in ``x0``. If the ``i``th</span></div>
<div class="line"><span class="lineno"> 2836</span><span class="stringliteral">        parameter in ``x0`` is unbounded below, then ``lower_bound[i]``</span></div>
<div class="line"><span class="lineno"> 2837</span><span class="stringliteral">        should be ``-np.inf``.</span></div>
<div class="line"><span class="lineno"> 2838</span><span class="stringliteral">        Note ``np.shape(lower_bound) == (n,)``.</span></div>
<div class="line"><span class="lineno"> 2839</span><span class="stringliteral">    upper_bound : np.array.</span></div>
<div class="line"><span class="lineno"> 2840</span><span class="stringliteral">        The upper bounds for each parameter in ``x0``. If the ``i``th</span></div>
<div class="line"><span class="lineno"> 2841</span><span class="stringliteral">        parameter in ``x0`` is unbounded above, then ``upper_bound[i]``</span></div>
<div class="line"><span class="lineno"> 2842</span><span class="stringliteral">        should be ``np.inf``.</span></div>
<div class="line"><span class="lineno"> 2843</span><span class="stringliteral">        Note ``np.shape(upper_bound) == (n,)``.</span></div>
<div class="line"><span class="lineno"> 2844</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2845</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2846</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2847</span><span class="stringliteral">    res : tuple ``(lmin, lmax)``</span></div>
<div class="line"><span class="lineno"> 2848</span><span class="stringliteral">        The bounds for ``l`` such that</span></div>
<div class="line"><span class="lineno"> 2849</span><span class="stringliteral">            ``lower_bound[i] &lt;= x0[i] + alpha[i] * l &lt;= upper_bound[i]``</span></div>
<div class="line"><span class="lineno"> 2850</span><span class="stringliteral">        for all ``i``.</span></div>
<div class="line"><span class="lineno"> 2851</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2852</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2853</span>    <span class="comment"># get nonzero indices of alpha so we don&#39;t get any zero division errors.</span></div>
<div class="line"><span class="lineno"> 2854</span>    <span class="comment"># alpha will not be all zero, since it is called from _linesearch_powell</span></div>
<div class="line"><span class="lineno"> 2855</span>    <span class="comment"># where we have a check for this.</span></div>
<div class="line"><span class="lineno"> 2856</span>    nonzero, = alpha.nonzero()</div>
<div class="line"><span class="lineno"> 2857</span>    lower_bound, upper_bound = lower_bound[nonzero], upper_bound[nonzero]</div>
<div class="line"><span class="lineno"> 2858</span>    x0, alpha = x0[nonzero], alpha[nonzero]</div>
<div class="line"><span class="lineno"> 2859</span>    low = (lower_bound - x0) / alpha</div>
<div class="line"><span class="lineno"> 2860</span>    high = (upper_bound - x0) / alpha</div>
<div class="line"><span class="lineno"> 2861</span> </div>
<div class="line"><span class="lineno"> 2862</span>    <span class="comment"># positive and negative indices</span></div>
<div class="line"><span class="lineno"> 2863</span>    pos = alpha &gt; 0</div>
<div class="line"><span class="lineno"> 2864</span> </div>
<div class="line"><span class="lineno"> 2865</span>    lmin_pos = np.where(pos, low, 0)</div>
<div class="line"><span class="lineno"> 2866</span>    lmin_neg = np.where(pos, 0, high)</div>
<div class="line"><span class="lineno"> 2867</span>    lmax_pos = np.where(pos, high, 0)</div>
<div class="line"><span class="lineno"> 2868</span>    lmax_neg = np.where(pos, 0, low)</div>
<div class="line"><span class="lineno"> 2869</span> </div>
<div class="line"><span class="lineno"> 2870</span>    lmin = np.max(lmin_pos + lmin_neg)</div>
<div class="line"><span class="lineno"> 2871</span>    lmax = np.min(lmax_pos + lmax_neg)</div>
<div class="line"><span class="lineno"> 2872</span> </div>
<div class="line"><span class="lineno"> 2873</span>    <span class="comment"># if x0 is outside the bounds, then it is possible that there is</span></div>
<div class="line"><span class="lineno"> 2874</span>    <span class="comment"># no way to get back in the bounds for the parameters being updated</span></div>
<div class="line"><span class="lineno"> 2875</span>    <span class="comment"># with the current direction alpha.</span></div>
<div class="line"><span class="lineno"> 2876</span>    <span class="comment"># when this happens, lmax &lt; lmin.</span></div>
<div class="line"><span class="lineno"> 2877</span>    <span class="comment"># If this is the case, then we can just return (0, 0)</span></div>
<div class="line"><span class="lineno"> 2878</span>    <span class="keywordflow">return</span> (lmin, lmax) <span class="keywordflow">if</span> lmax &gt;= lmin <span class="keywordflow">else</span> (0, 0)</div>
<div class="line"><span class="lineno"> 2879</span> </div>
<div class="line"><span class="lineno"> 2880</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7199b6af73bdb0295d37336b3be8ed5a" name="a7199b6af73bdb0295d37336b3be8ed5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7199b6af73bdb0295d37336b3be8ed5a">&#9670;&#160;</a></span>_line_search_wolfe12()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._line_search_wolfe12 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fprime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gfk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>old_fval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>old_old_fval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Same as line_search_wolfe1, but fall back to line_search_wolfe2 if
suitable step length is not found, and raise an exception if a
suitable step length is not found.

Raises
------
_LineSearchError
    If no suitable step size is found</pre> <div class="fragment"><div class="line"><span class="lineno"> 1072</span>                         **kwargs):</div>
<div class="line"><span class="lineno"> 1073</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral">    Same as line_search_wolfe1, but fall back to line_search_wolfe2 if</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">    suitable step length is not found, and raise an exception if a</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">    suitable step length is not found.</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">    _LineSearchError</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">        If no suitable step size is found</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1084</span> </div>
<div class="line"><span class="lineno"> 1085</span>    extra_condition = kwargs.pop(<span class="stringliteral">&#39;extra_condition&#39;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>    ret = line_search_wolfe1(f, fprime, xk, pk, gfk,</div>
<div class="line"><span class="lineno"> 1088</span>                             old_fval, old_old_fval,</div>
<div class="line"><span class="lineno"> 1089</span>                             **kwargs)</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keywordflow">if</span> ret[0] <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> extra_condition <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1092</span>        xp1 = xk + ret[0] * pk</div>
<div class="line"><span class="lineno"> 1093</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> extra_condition(ret[0], xp1, ret[3], ret[5]):</div>
<div class="line"><span class="lineno"> 1094</span>            <span class="comment"># Reject step if extra_condition fails</span></div>
<div class="line"><span class="lineno"> 1095</span>            ret = (<span class="keywordtype">None</span>,)</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keywordflow">if</span> ret[0] <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1098</span>        <span class="comment"># line search failed: try different one.</span></div>
<div class="line"><span class="lineno"> 1099</span>        <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno"> 1100</span>            warnings.simplefilter(<span class="stringliteral">&#39;ignore&#39;</span>, LineSearchWarning)</div>
<div class="line"><span class="lineno"> 1101</span>            kwargs2 = {}</div>
<div class="line"><span class="lineno"> 1102</span>            <span class="keywordflow">for</span> key <span class="keywordflow">in</span> (<span class="stringliteral">&#39;c1&#39;</span>, <span class="stringliteral">&#39;c2&#39;</span>, <span class="stringliteral">&#39;amax&#39;</span>):</div>
<div class="line"><span class="lineno"> 1103</span>                <span class="keywordflow">if</span> key <span class="keywordflow">in</span> kwargs:</div>
<div class="line"><span class="lineno"> 1104</span>                    kwargs2[key] = kwargs[key]</div>
<div class="line"><span class="lineno"> 1105</span>            ret = line_search_wolfe2(f, fprime, xk, pk, gfk,</div>
<div class="line"><span class="lineno"> 1106</span>                                     old_fval, old_old_fval,</div>
<div class="line"><span class="lineno"> 1107</span>                                     extra_condition=extra_condition,</div>
<div class="line"><span class="lineno"> 1108</span>                                     **kwargs2)</div>
<div class="line"><span class="lineno"> 1109</span> </div>
<div class="line"><span class="lineno"> 1110</span>    <span class="keywordflow">if</span> ret[0] <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1111</span>        <span class="keywordflow">raise</span> _LineSearchError()</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordflow">return</span> ret</div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7fe737c35f3c1f34556e9e97b0ba35f" name="ab7fe737c35f3c1f34556e9e97b0ba35f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7fe737c35f3c1f34556e9e97b0ba35f">&#9670;&#160;</a></span>_linesearch_powell()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._linesearch_powell </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lower_bound</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>upper_bound</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fval</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Line-search algorithm using fminbound.

Find the minimium of the function ``func(x0 + alpha*direc)``.

lower_bound : np.array.
    The lower bounds for each parameter in ``x0``. If the ``i``th
    parameter in ``x0`` is unbounded below, then ``lower_bound[i]``
    should be ``-np.inf``.
    Note ``np.shape(lower_bound) == (n,)``.
upper_bound : np.array.
    The upper bounds for each parameter in ``x0``. If the ``i``th
    parameter in ``x0`` is unbounded above, then ``upper_bound[i]``
    should be ``np.inf``.
    Note ``np.shape(upper_bound) == (n,)``.
fval : number.
    ``fval`` is equal to ``func(p)``, the idea is just to avoid
    recomputing it so we can limit the ``fevals``.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2882</span>                       lower_bound=<span class="keywordtype">None</span>, upper_bound=<span class="keywordtype">None</span>, fval=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2883</span>    <span class="stringliteral">&quot;&quot;&quot;Line-search algorithm using fminbound.</span></div>
<div class="line"><span class="lineno"> 2884</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2885</span><span class="stringliteral">    Find the minimium of the function ``func(x0 + alpha*direc)``.</span></div>
<div class="line"><span class="lineno"> 2886</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2887</span><span class="stringliteral">    lower_bound : np.array.</span></div>
<div class="line"><span class="lineno"> 2888</span><span class="stringliteral">        The lower bounds for each parameter in ``x0``. If the ``i``th</span></div>
<div class="line"><span class="lineno"> 2889</span><span class="stringliteral">        parameter in ``x0`` is unbounded below, then ``lower_bound[i]``</span></div>
<div class="line"><span class="lineno"> 2890</span><span class="stringliteral">        should be ``-np.inf``.</span></div>
<div class="line"><span class="lineno"> 2891</span><span class="stringliteral">        Note ``np.shape(lower_bound) == (n,)``.</span></div>
<div class="line"><span class="lineno"> 2892</span><span class="stringliteral">    upper_bound : np.array.</span></div>
<div class="line"><span class="lineno"> 2893</span><span class="stringliteral">        The upper bounds for each parameter in ``x0``. If the ``i``th</span></div>
<div class="line"><span class="lineno"> 2894</span><span class="stringliteral">        parameter in ``x0`` is unbounded above, then ``upper_bound[i]``</span></div>
<div class="line"><span class="lineno"> 2895</span><span class="stringliteral">        should be ``np.inf``.</span></div>
<div class="line"><span class="lineno"> 2896</span><span class="stringliteral">        Note ``np.shape(upper_bound) == (n,)``.</span></div>
<div class="line"><span class="lineno"> 2897</span><span class="stringliteral">    fval : number.</span></div>
<div class="line"><span class="lineno"> 2898</span><span class="stringliteral">        ``fval`` is equal to ``func(p)``, the idea is just to avoid</span></div>
<div class="line"><span class="lineno"> 2899</span><span class="stringliteral">        recomputing it so we can limit the ``fevals``.</span></div>
<div class="line"><span class="lineno"> 2900</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2901</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2902</span>    <span class="keyword">def </span>myfunc(alpha):</div>
<div class="line"><span class="lineno"> 2903</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p + alpha*xi)</div>
<div class="line"><span class="lineno"> 2904</span> </div>
<div class="line"><span class="lineno"> 2905</span>    <span class="comment"># if xi is zero, then don&#39;t optimize</span></div>
<div class="line"><span class="lineno"> 2906</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.any(xi):</div>
<div class="line"><span class="lineno"> 2907</span>        <span class="keywordflow">return</span> ((fval, p, xi) <span class="keywordflow">if</span> fval <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> (<a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p), p, xi))</div>
<div class="line"><span class="lineno"> 2908</span>    <span class="keywordflow">elif</span> lower_bound <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> upper_bound <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2909</span>        <span class="comment"># non-bounded minimization</span></div>
<div class="line"><span class="lineno"> 2910</span>        alpha_min, fret, _, _ = brent(myfunc, full_output=1, tol=tol)</div>
<div class="line"><span class="lineno"> 2911</span>        xi = alpha_min * xi</div>
<div class="line"><span class="lineno"> 2912</span>        <span class="keywordflow">return</span> squeeze(fret), p + xi, xi</div>
<div class="line"><span class="lineno"> 2913</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2914</span>        bound = _line_for_search(p, xi, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno"> 2915</span>        <span class="keywordflow">if</span> np.isneginf(bound[0]) <span class="keywordflow">and</span> np.isposinf(bound[1]):</div>
<div class="line"><span class="lineno"> 2916</span>            <span class="comment"># equivalent to unbounded</span></div>
<div class="line"><span class="lineno"> 2917</span>            <span class="keywordflow">return</span> _linesearch_powell(func, p, xi, fval=fval, tol=tol)</div>
<div class="line"><span class="lineno"> 2918</span>        <span class="keywordflow">elif</span> <span class="keywordflow">not</span> np.isneginf(bound[0]) <span class="keywordflow">and</span> <span class="keywordflow">not</span> np.isposinf(bound[1]):</div>
<div class="line"><span class="lineno"> 2919</span>            <span class="comment"># we can use a bounded scalar minimization</span></div>
<div class="line"><span class="lineno"> 2920</span>            res = _minimize_scalar_bounded(myfunc, bound, xatol=tol / 100)</div>
<div class="line"><span class="lineno"> 2921</span>            xi = res.x * xi</div>
<div class="line"><span class="lineno"> 2922</span>            <span class="keywordflow">return</span> squeeze(res.fun), p + xi, xi</div>
<div class="line"><span class="lineno"> 2923</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2924</span>            <span class="comment"># only bounded on one side. use the tangent function to convert</span></div>
<div class="line"><span class="lineno"> 2925</span>            <span class="comment"># the infinity bound to a finite bound. The new bounded region</span></div>
<div class="line"><span class="lineno"> 2926</span>            <span class="comment"># is a subregion of the region bounded by -np.pi/2 and np.pi/2.</span></div>
<div class="line"><span class="lineno"> 2927</span>            bound = np.arctan(bound[0]), np.arctan(bound[1])</div>
<div class="line"><span class="lineno"> 2928</span>            res = _minimize_scalar_bounded(</div>
<div class="line"><span class="lineno"> 2929</span>                <span class="keyword">lambda</span> x: myfunc(np.tan(x)),</div>
<div class="line"><span class="lineno"> 2930</span>                bound,</div>
<div class="line"><span class="lineno"> 2931</span>                xatol=tol / 100)</div>
<div class="line"><span class="lineno"> 2932</span>            xi = np.tan(res.x) * xi</div>
<div class="line"><span class="lineno"> 2933</span>            <span class="keywordflow">return</span> squeeze(res.fun), p + xi, xi</div>
<div class="line"><span class="lineno"> 2934</span> </div>
<div class="line"><span class="lineno"> 2935</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adda888a2135e3f51c10a055ef39f21ba" name="adda888a2135e3f51c10a055ef39f21ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda888a2135e3f51c10a055ef39f21ba">&#9670;&#160;</a></span>_minimize_bfgs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._minimize_bfgs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gtol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>Inf</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_all</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>finite_diff_rel_step</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimization of scalar function of one or more variables using the
BFGS algorithm.

Options
-------
disp : bool
    Set to True to print convergence messages.
maxiter : int
    Maximum number of iterations to perform.
gtol : float
    Gradient norm must be less than `gtol` before successful
    termination.
norm : float
    Order of norm (Inf is max, -Inf is min).
eps : float or ndarray
    If `jac is None` the absolute step size used for numerical
    approximation of the jacobian via forward differences.
return_all : bool, optional
    Set to True to return a list of the best solution at each of the
    iterations.
finite_diff_rel_step : None or array_like, optional
    If `jac in ['2-point', '3-point', 'cs']` the relative step size to
    use for numerical approximation of the jacobian. The absolute step
    size is computed as ``h = rel_step * sign(x) * max(1, abs(x))``,
    possibly adjusted to fit into the bounds. For ``method='3-point'``
    the sign of `h` is ignored. If None (default) then step is selected
    automatically.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1243</span>                   **unknown_options):</div>
<div class="line"><span class="lineno"> 1244</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1245</span><span class="stringliteral">    Minimization of scalar function of one or more variables using the</span></div>
<div class="line"><span class="lineno"> 1246</span><span class="stringliteral">    BFGS algorithm.</span></div>
<div class="line"><span class="lineno"> 1247</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1248</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno"> 1249</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1250</span><span class="stringliteral">    disp : bool</span></div>
<div class="line"><span class="lineno"> 1251</span><span class="stringliteral">        Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno"> 1252</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 1254</span><span class="stringliteral">    gtol : float</span></div>
<div class="line"><span class="lineno"> 1255</span><span class="stringliteral">        Gradient norm must be less than `gtol` before successful</span></div>
<div class="line"><span class="lineno"> 1256</span><span class="stringliteral">        termination.</span></div>
<div class="line"><span class="lineno"> 1257</span><span class="stringliteral">    norm : float</span></div>
<div class="line"><span class="lineno"> 1258</span><span class="stringliteral">        Order of norm (Inf is max, -Inf is min).</span></div>
<div class="line"><span class="lineno"> 1259</span><span class="stringliteral">    eps : float or ndarray</span></div>
<div class="line"><span class="lineno"> 1260</span><span class="stringliteral">        If `jac is None` the absolute step size used for numerical</span></div>
<div class="line"><span class="lineno"> 1261</span><span class="stringliteral">        approximation of the jacobian via forward differences.</span></div>
<div class="line"><span class="lineno"> 1262</span><span class="stringliteral">    return_all : bool, optional</span></div>
<div class="line"><span class="lineno"> 1263</span><span class="stringliteral">        Set to True to return a list of the best solution at each of the</span></div>
<div class="line"><span class="lineno"> 1264</span><span class="stringliteral">        iterations.</span></div>
<div class="line"><span class="lineno"> 1265</span><span class="stringliteral">    finite_diff_rel_step : None or array_like, optional</span></div>
<div class="line"><span class="lineno"> 1266</span><span class="stringliteral">        If `jac in [&#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;]` the relative step size to</span></div>
<div class="line"><span class="lineno"> 1267</span><span class="stringliteral">        use for numerical approximation of the jacobian. The absolute step</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="stringliteral">        size is computed as ``h = rel_step * sign(x) * max(1, abs(x))``,</span></div>
<div class="line"><span class="lineno"> 1269</span><span class="stringliteral">        possibly adjusted to fit into the bounds. For ``method=&#39;3-point&#39;``</span></div>
<div class="line"><span class="lineno"> 1270</span><span class="stringliteral">        the sign of `h` is ignored. If None (default) then step is selected</span></div>
<div class="line"><span class="lineno"> 1271</span><span class="stringliteral">        automatically.</span></div>
<div class="line"><span class="lineno"> 1272</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1273</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1274</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno"> 1275</span>    retall = return_all</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>    x0 = asarray(x0).flatten()</div>
<div class="line"><span class="lineno"> 1278</span>    <span class="keywordflow">if</span> x0.ndim == 0:</div>
<div class="line"><span class="lineno"> 1279</span>        x0.shape = (1,)</div>
<div class="line"><span class="lineno"> 1280</span>    <span class="keywordflow">if</span> maxiter <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1281</span>        maxiter = len(x0) * 200</div>
<div class="line"><span class="lineno"> 1282</span> </div>
<div class="line"><span class="lineno"> 1283</span>    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,</div>
<div class="line"><span class="lineno"> 1284</span>                                  finite_diff_rel_step=finite_diff_rel_step)</div>
<div class="line"><span class="lineno"> 1285</span> </div>
<div class="line"><span class="lineno"> 1286</span>    f = sf.fun</div>
<div class="line"><span class="lineno"> 1287</span>    myfprime = sf.grad</div>
<div class="line"><span class="lineno"> 1288</span> </div>
<div class="line"><span class="lineno"> 1289</span>    old_fval = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x0)</div>
<div class="line"><span class="lineno"> 1290</span>    gfk = myfprime(x0)</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>    k = 0</div>
<div class="line"><span class="lineno"> 1293</span>    N = len(x0)</div>
<div class="line"><span class="lineno"> 1294</span>    I = np.eye(N, dtype=int)</div>
<div class="line"><span class="lineno"> 1295</span>    Hk = I</div>
<div class="line"><span class="lineno"> 1296</span> </div>
<div class="line"><span class="lineno"> 1297</span>    <span class="comment"># Sets the initial step guess to dx ~ 1</span></div>
<div class="line"><span class="lineno"> 1298</span>    old_old_fval = old_fval + np.linalg.norm(gfk) / 2</div>
<div class="line"><span class="lineno"> 1299</span> </div>
<div class="line"><span class="lineno"> 1300</span>    xk = x0</div>
<div class="line"><span class="lineno"> 1301</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1302</span>        allvecs = [x0]</div>
<div class="line"><span class="lineno"> 1303</span>    warnflag = 0</div>
<div class="line"><span class="lineno"> 1304</span>    gnorm = vecnorm(gfk, ord=norm)</div>
<div class="line"><span class="lineno"> 1305</span>    <span class="keywordflow">while</span> (gnorm &gt; gtol) <span class="keywordflow">and</span> (k &lt; maxiter):</div>
<div class="line"><span class="lineno"> 1306</span>        pk = -np.dot(Hk, gfk)</div>
<div class="line"><span class="lineno"> 1307</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1308</span>            alpha_k, fc, gc, old_fval, old_old_fval, gfkp1 = \</div>
<div class="line"><span class="lineno"> 1309</span>                     _line_search_wolfe12(f, myfprime, xk, pk, gfk,</div>
<div class="line"><span class="lineno"> 1310</span>                                          old_fval, old_old_fval, amin=1e-100, amax=1e100)</div>
<div class="line"><span class="lineno"> 1311</span>        <span class="keywordflow">except</span> _LineSearchError:</div>
<div class="line"><span class="lineno"> 1312</span>            <span class="comment"># Line search failed to find a better solution.</span></div>
<div class="line"><span class="lineno"> 1313</span>            warnflag = 2</div>
<div class="line"><span class="lineno"> 1314</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>        xkp1 = xk + alpha_k * pk</div>
<div class="line"><span class="lineno"> 1317</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1318</span>            allvecs.append(xkp1)</div>
<div class="line"><span class="lineno"> 1319</span>        sk = xkp1 - xk</div>
<div class="line"><span class="lineno"> 1320</span>        xk = xkp1</div>
<div class="line"><span class="lineno"> 1321</span>        <span class="keywordflow">if</span> gfkp1 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1322</span>            gfkp1 = myfprime(xkp1)</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>        yk = gfkp1 - gfk</div>
<div class="line"><span class="lineno"> 1325</span>        gfk = gfkp1</div>
<div class="line"><span class="lineno"> 1326</span>        <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1327</span>            callback(xk)</div>
<div class="line"><span class="lineno"> 1328</span>        k += 1</div>
<div class="line"><span class="lineno"> 1329</span>        gnorm = vecnorm(gfk, ord=norm)</div>
<div class="line"><span class="lineno"> 1330</span>        <span class="keywordflow">if</span> (gnorm &lt;= gtol):</div>
<div class="line"><span class="lineno"> 1331</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isfinite(old_fval):</div>
<div class="line"><span class="lineno"> 1334</span>            <span class="comment"># We correctly found +-Inf as optimal value, or something went</span></div>
<div class="line"><span class="lineno"> 1335</span>            <span class="comment"># wrong.</span></div>
<div class="line"><span class="lineno"> 1336</span>            warnflag = 2</div>
<div class="line"><span class="lineno"> 1337</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1338</span> </div>
<div class="line"><span class="lineno"> 1339</span>        rhok_inv = np.dot(yk, sk)</div>
<div class="line"><span class="lineno"> 1340</span>        <span class="comment"># this was handled in numeric, let it remaines for more safety</span></div>
<div class="line"><span class="lineno"> 1341</span>        <span class="keywordflow">if</span> rhok_inv == 0.:</div>
<div class="line"><span class="lineno"> 1342</span>            rhok = 1000.0</div>
<div class="line"><span class="lineno"> 1343</span>            <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 1344</span>                print(<span class="stringliteral">&quot;Divide-by-zero encountered: rhok assumed large&quot;</span>)</div>
<div class="line"><span class="lineno"> 1345</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1346</span>            rhok = 1. / rhok_inv</div>
<div class="line"><span class="lineno"> 1347</span> </div>
<div class="line"><span class="lineno"> 1348</span>        A1 = I - sk[:, np.newaxis] * yk[np.newaxis, :] * rhok</div>
<div class="line"><span class="lineno"> 1349</span>        A2 = I - yk[:, np.newaxis] * sk[np.newaxis, :] * rhok</div>
<div class="line"><span class="lineno"> 1350</span>        Hk = np.dot(A1, np.dot(Hk, A2)) + (rhok * sk[:, np.newaxis] *</div>
<div class="line"><span class="lineno"> 1351</span>                                                 sk[np.newaxis, :])</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>    fval = old_fval</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordflow">if</span> warnflag == 2:</div>
<div class="line"><span class="lineno"> 1356</span>        msg = _status_message[<span class="stringliteral">&#39;pr_loss&#39;</span>]</div>
<div class="line"><span class="lineno"> 1357</span>    <span class="keywordflow">elif</span> k &gt;= maxiter:</div>
<div class="line"><span class="lineno"> 1358</span>        warnflag = 1</div>
<div class="line"><span class="lineno"> 1359</span>        msg = _status_message[<span class="stringliteral">&#39;maxiter&#39;</span>]</div>
<div class="line"><span class="lineno"> 1360</span>    <span class="keywordflow">elif</span> np.isnan(gnorm) <span class="keywordflow">or</span> np.isnan(fval) <span class="keywordflow">or</span> np.isnan(xk).any():</div>
<div class="line"><span class="lineno"> 1361</span>        warnflag = 3</div>
<div class="line"><span class="lineno"> 1362</span>        msg = _status_message[<span class="stringliteral">&#39;nan&#39;</span>]</div>
<div class="line"><span class="lineno"> 1363</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1364</span>        msg = _status_message[<span class="stringliteral">&#39;success&#39;</span>]</div>
<div class="line"><span class="lineno"> 1365</span> </div>
<div class="line"><span class="lineno"> 1366</span>    <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 1367</span>        print(<span class="stringliteral">&quot;%s%s&quot;</span> % (<span class="stringliteral">&quot;Warning: &quot;</span> <span class="keywordflow">if</span> warnflag != 0 <span class="keywordflow">else</span> <span class="stringliteral">&quot;&quot;</span>, msg))</div>
<div class="line"><span class="lineno"> 1368</span>        print(<span class="stringliteral">&quot;         Current function value: %f&quot;</span> % fval)</div>
<div class="line"><span class="lineno"> 1369</span>        print(<span class="stringliteral">&quot;         Iterations: %d&quot;</span> % k)</div>
<div class="line"><span class="lineno"> 1370</span>        print(<span class="stringliteral">&quot;         Function evaluations: %d&quot;</span> % sf.nfev)</div>
<div class="line"><span class="lineno"> 1371</span>        print(<span class="stringliteral">&quot;         Gradient evaluations: %d&quot;</span> % sf.ngev)</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>    result = OptimizeResult(fun=fval, jac=gfk, hess_inv=Hk, nfev=sf.nfev,</div>
<div class="line"><span class="lineno"> 1374</span>                            njev=sf.ngev, status=warnflag,</div>
<div class="line"><span class="lineno"> 1375</span>                            success=(warnflag == 0), message=msg, x=xk,</div>
<div class="line"><span class="lineno"> 1376</span>                            nit=k)</div>
<div class="line"><span class="lineno"> 1377</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1378</span>        result[<span class="stringliteral">&#39;allvecs&#39;</span>] = allvecs</div>
<div class="line"><span class="lineno"> 1379</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3191cd4252e97988cd6402c7c2286ac0" name="a3191cd4252e97988cd6402c7c2286ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3191cd4252e97988cd6402c7c2286ac0">&#9670;&#160;</a></span>_minimize_cg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._minimize_cg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gtol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>Inf</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_all</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>finite_diff_rel_step</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimization of scalar function of one or more variables using the
conjugate gradient algorithm.

Options
-------
disp : bool
    Set to True to print convergence messages.
maxiter : int
    Maximum number of iterations to perform.
gtol : float
    Gradient norm must be less than `gtol` before successful
    termination.
norm : float
    Order of norm (Inf is max, -Inf is min).
eps : float or ndarray
    If `jac is None` the absolute step size used for numerical
    approximation of the jacobian via forward differences.
return_all : bool, optional
    Set to True to return a list of the best solution at each of the
    iterations.
finite_diff_rel_step : None or array_like, optional
    If `jac in ['2-point', '3-point', 'cs']` the relative step size to
    use for numerical approximation of the jacobian. The absolute step
    size is computed as ``h = rel_step * sign(x) * max(1, abs(x))``,
    possibly adjusted to fit into the bounds. For ``method='3-point'``
    the sign of `h` is ignored. If None (default) then step is selected
    automatically.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1558</span>                 **unknown_options):</div>
<div class="line"><span class="lineno"> 1559</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1560</span><span class="stringliteral">    Minimization of scalar function of one or more variables using the</span></div>
<div class="line"><span class="lineno"> 1561</span><span class="stringliteral">    conjugate gradient algorithm.</span></div>
<div class="line"><span class="lineno"> 1562</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1563</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno"> 1564</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1565</span><span class="stringliteral">    disp : bool</span></div>
<div class="line"><span class="lineno"> 1566</span><span class="stringliteral">        Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno"> 1567</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno"> 1568</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 1569</span><span class="stringliteral">    gtol : float</span></div>
<div class="line"><span class="lineno"> 1570</span><span class="stringliteral">        Gradient norm must be less than `gtol` before successful</span></div>
<div class="line"><span class="lineno"> 1571</span><span class="stringliteral">        termination.</span></div>
<div class="line"><span class="lineno"> 1572</span><span class="stringliteral">    norm : float</span></div>
<div class="line"><span class="lineno"> 1573</span><span class="stringliteral">        Order of norm (Inf is max, -Inf is min).</span></div>
<div class="line"><span class="lineno"> 1574</span><span class="stringliteral">    eps : float or ndarray</span></div>
<div class="line"><span class="lineno"> 1575</span><span class="stringliteral">        If `jac is None` the absolute step size used for numerical</span></div>
<div class="line"><span class="lineno"> 1576</span><span class="stringliteral">        approximation of the jacobian via forward differences.</span></div>
<div class="line"><span class="lineno"> 1577</span><span class="stringliteral">    return_all : bool, optional</span></div>
<div class="line"><span class="lineno"> 1578</span><span class="stringliteral">        Set to True to return a list of the best solution at each of the</span></div>
<div class="line"><span class="lineno"> 1579</span><span class="stringliteral">        iterations.</span></div>
<div class="line"><span class="lineno"> 1580</span><span class="stringliteral">    finite_diff_rel_step : None or array_like, optional</span></div>
<div class="line"><span class="lineno"> 1581</span><span class="stringliteral">        If `jac in [&#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;]` the relative step size to</span></div>
<div class="line"><span class="lineno"> 1582</span><span class="stringliteral">        use for numerical approximation of the jacobian. The absolute step</span></div>
<div class="line"><span class="lineno"> 1583</span><span class="stringliteral">        size is computed as ``h = rel_step * sign(x) * max(1, abs(x))``,</span></div>
<div class="line"><span class="lineno"> 1584</span><span class="stringliteral">        possibly adjusted to fit into the bounds. For ``method=&#39;3-point&#39;``</span></div>
<div class="line"><span class="lineno"> 1585</span><span class="stringliteral">        the sign of `h` is ignored. If None (default) then step is selected</span></div>
<div class="line"><span class="lineno"> 1586</span><span class="stringliteral">        automatically.</span></div>
<div class="line"><span class="lineno"> 1587</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1588</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno"> 1589</span> </div>
<div class="line"><span class="lineno"> 1590</span>    retall = return_all</div>
<div class="line"><span class="lineno"> 1591</span> </div>
<div class="line"><span class="lineno"> 1592</span>    x0 = asarray(x0).flatten()</div>
<div class="line"><span class="lineno"> 1593</span>    <span class="keywordflow">if</span> maxiter <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1594</span>        maxiter = len(x0) * 200</div>
<div class="line"><span class="lineno"> 1595</span> </div>
<div class="line"><span class="lineno"> 1596</span>    sf = _prepare_scalar_function(fun, x0, jac=jac, args=args, epsilon=eps,</div>
<div class="line"><span class="lineno"> 1597</span>                                  finite_diff_rel_step=finite_diff_rel_step)</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>    f = sf.fun</div>
<div class="line"><span class="lineno"> 1600</span>    myfprime = sf.grad</div>
<div class="line"><span class="lineno"> 1601</span> </div>
<div class="line"><span class="lineno"> 1602</span>    old_fval = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x0)</div>
<div class="line"><span class="lineno"> 1603</span>    gfk = myfprime(x0)</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>    k = 0</div>
<div class="line"><span class="lineno"> 1606</span>    xk = x0</div>
<div class="line"><span class="lineno"> 1607</span>    <span class="comment"># Sets the initial step guess to dx ~ 1</span></div>
<div class="line"><span class="lineno"> 1608</span>    old_old_fval = old_fval + np.linalg.norm(gfk) / 2</div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1611</span>        allvecs = [xk]</div>
<div class="line"><span class="lineno"> 1612</span>    warnflag = 0</div>
<div class="line"><span class="lineno"> 1613</span>    pk = -gfk</div>
<div class="line"><span class="lineno"> 1614</span>    gnorm = vecnorm(gfk, ord=norm)</div>
<div class="line"><span class="lineno"> 1615</span> </div>
<div class="line"><span class="lineno"> 1616</span>    sigma_3 = 0.01</div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>    <span class="keywordflow">while</span> (gnorm &gt; gtol) <span class="keywordflow">and</span> (k &lt; maxiter):</div>
<div class="line"><span class="lineno"> 1619</span>        deltak = np.dot(gfk, gfk)</div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>        cached_step = [<span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno"> 1622</span> </div>
<div class="line"><span class="lineno"> 1623</span>        <span class="keyword">def </span>polak_ribiere_powell_step(alpha, gfkp1=None):</div>
<div class="line"><span class="lineno"> 1624</span>            xkp1 = xk + alpha * pk</div>
<div class="line"><span class="lineno"> 1625</span>            <span class="keywordflow">if</span> gfkp1 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1626</span>                gfkp1 = myfprime(xkp1)</div>
<div class="line"><span class="lineno"> 1627</span>            yk = gfkp1 - gfk</div>
<div class="line"><span class="lineno"> 1628</span>            beta_k = max(0, np.dot(yk, gfkp1) / deltak)</div>
<div class="line"><span class="lineno"> 1629</span>            pkp1 = -gfkp1 + beta_k * pk</div>
<div class="line"><span class="lineno"> 1630</span>            gnorm = vecnorm(gfkp1, ord=norm)</div>
<div class="line"><span class="lineno"> 1631</span>            <span class="keywordflow">return</span> (alpha, xkp1, pkp1, gfkp1, gnorm)</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>        <span class="keyword">def </span>descent_condition(alpha, xkp1, fp1, gfkp1):</div>
<div class="line"><span class="lineno"> 1634</span>            <span class="comment"># Polak-Ribiere+ needs an explicit check of a sufficient</span></div>
<div class="line"><span class="lineno"> 1635</span>            <span class="comment"># descent condition, which is not guaranteed by strong Wolfe.</span></div>
<div class="line"><span class="lineno"> 1636</span>            <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 1637</span>            <span class="comment"># See Gilbert &amp; Nocedal, &quot;Global convergence properties of</span></div>
<div class="line"><span class="lineno"> 1638</span>            <span class="comment"># conjugate gradient methods for optimization&quot;,</span></div>
<div class="line"><span class="lineno"> 1639</span>            <span class="comment"># SIAM J. Optimization 2, 21 (1992).</span></div>
<div class="line"><span class="lineno"> 1640</span>            cached_step[:] = polak_ribiere_powell_step(alpha, gfkp1)</div>
<div class="line"><span class="lineno"> 1641</span>            alpha, xk, pk, gfk, gnorm = cached_step</div>
<div class="line"><span class="lineno"> 1642</span> </div>
<div class="line"><span class="lineno"> 1643</span>            <span class="comment"># Accept step if it leads to convergence.</span></div>
<div class="line"><span class="lineno"> 1644</span>            <span class="keywordflow">if</span> gnorm &lt;= gtol:</div>
<div class="line"><span class="lineno"> 1645</span>                <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 1646</span> </div>
<div class="line"><span class="lineno"> 1647</span>            <span class="comment"># Accept step if sufficient descent condition applies.</span></div>
<div class="line"><span class="lineno"> 1648</span>            <span class="keywordflow">return</span> np.dot(pk, gfk) &lt;= -sigma_3 * np.dot(gfk, gfk)</div>
<div class="line"><span class="lineno"> 1649</span> </div>
<div class="line"><span class="lineno"> 1650</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1651</span>            alpha_k, fc, gc, old_fval, old_old_fval, gfkp1 = \</div>
<div class="line"><span class="lineno"> 1652</span>                     _line_search_wolfe12(f, myfprime, xk, pk, gfk, old_fval,</div>
<div class="line"><span class="lineno"> 1653</span>                                          old_old_fval, c2=0.4, amin=1e-100, amax=1e100,</div>
<div class="line"><span class="lineno"> 1654</span>                                          extra_condition=descent_condition)</div>
<div class="line"><span class="lineno"> 1655</span>        <span class="keywordflow">except</span> _LineSearchError:</div>
<div class="line"><span class="lineno"> 1656</span>            <span class="comment"># Line search failed to find a better solution.</span></div>
<div class="line"><span class="lineno"> 1657</span>            warnflag = 2</div>
<div class="line"><span class="lineno"> 1658</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1659</span> </div>
<div class="line"><span class="lineno"> 1660</span>        <span class="comment"># Reuse already computed results if possible</span></div>
<div class="line"><span class="lineno"> 1661</span>        <span class="keywordflow">if</span> alpha_k == cached_step[0]:</div>
<div class="line"><span class="lineno"> 1662</span>            alpha_k, xk, pk, gfk, gnorm = cached_step</div>
<div class="line"><span class="lineno"> 1663</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1664</span>            alpha_k, xk, pk, gfk, gnorm = polak_ribiere_powell_step(alpha_k, gfkp1)</div>
<div class="line"><span class="lineno"> 1665</span> </div>
<div class="line"><span class="lineno"> 1666</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1667</span>            allvecs.append(xk)</div>
<div class="line"><span class="lineno"> 1668</span>        <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1669</span>            callback(xk)</div>
<div class="line"><span class="lineno"> 1670</span>        k += 1</div>
<div class="line"><span class="lineno"> 1671</span> </div>
<div class="line"><span class="lineno"> 1672</span>    fval = old_fval</div>
<div class="line"><span class="lineno"> 1673</span>    <span class="keywordflow">if</span> warnflag == 2:</div>
<div class="line"><span class="lineno"> 1674</span>        msg = _status_message[<span class="stringliteral">&#39;pr_loss&#39;</span>]</div>
<div class="line"><span class="lineno"> 1675</span>    <span class="keywordflow">elif</span> k &gt;= maxiter:</div>
<div class="line"><span class="lineno"> 1676</span>        warnflag = 1</div>
<div class="line"><span class="lineno"> 1677</span>        msg = _status_message[<span class="stringliteral">&#39;maxiter&#39;</span>]</div>
<div class="line"><span class="lineno"> 1678</span>    <span class="keywordflow">elif</span> np.isnan(gnorm) <span class="keywordflow">or</span> np.isnan(fval) <span class="keywordflow">or</span> np.isnan(xk).any():</div>
<div class="line"><span class="lineno"> 1679</span>        warnflag = 3</div>
<div class="line"><span class="lineno"> 1680</span>        msg = _status_message[<span class="stringliteral">&#39;nan&#39;</span>]</div>
<div class="line"><span class="lineno"> 1681</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1682</span>        msg = _status_message[<span class="stringliteral">&#39;success&#39;</span>]</div>
<div class="line"><span class="lineno"> 1683</span> </div>
<div class="line"><span class="lineno"> 1684</span>    <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 1685</span>        print(<span class="stringliteral">&quot;%s%s&quot;</span> % (<span class="stringliteral">&quot;Warning: &quot;</span> <span class="keywordflow">if</span> warnflag != 0 <span class="keywordflow">else</span> <span class="stringliteral">&quot;&quot;</span>, msg))</div>
<div class="line"><span class="lineno"> 1686</span>        print(<span class="stringliteral">&quot;         Current function value: %f&quot;</span> % fval)</div>
<div class="line"><span class="lineno"> 1687</span>        print(<span class="stringliteral">&quot;         Iterations: %d&quot;</span> % k)</div>
<div class="line"><span class="lineno"> 1688</span>        print(<span class="stringliteral">&quot;         Function evaluations: %d&quot;</span> % sf.nfev)</div>
<div class="line"><span class="lineno"> 1689</span>        print(<span class="stringliteral">&quot;         Gradient evaluations: %d&quot;</span> % sf.ngev)</div>
<div class="line"><span class="lineno"> 1690</span> </div>
<div class="line"><span class="lineno"> 1691</span>    result = OptimizeResult(fun=fval, jac=gfk, nfev=sf.nfev,</div>
<div class="line"><span class="lineno"> 1692</span>                            njev=sf.ngev, status=warnflag,</div>
<div class="line"><span class="lineno"> 1693</span>                            success=(warnflag == 0), message=msg, x=xk,</div>
<div class="line"><span class="lineno"> 1694</span>                            nit=k)</div>
<div class="line"><span class="lineno"> 1695</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1696</span>        result[<span class="stringliteral">&#39;allvecs&#39;</span>] = allvecs</div>
<div class="line"><span class="lineno"> 1697</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a021f788937329bc7411d5a6b29a84173" name="a021f788937329bc7411d5a6b29a84173"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a021f788937329bc7411d5a6b29a84173">&#9670;&#160;</a></span>_minimize_neldermead()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._minimize_neldermead </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfev</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_all</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>initial_simplex</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xatol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fatol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>adaptive</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimization of scalar function of one or more variables using the
Nelder-Mead algorithm.

Options
-------
disp : bool
    Set to True to print convergence messages.
maxiter, maxfev : int
    Maximum allowed number of iterations and function evaluations.
    Will default to ``N*200``, where ``N`` is the number of
    variables, if neither `maxiter` or `maxfev` is set. If both
    `maxiter` and `maxfev` are set, minimization will stop at the
    first reached.
return_all : bool, optional
    Set to True to return a list of the best solution at each of the
    iterations.
initial_simplex : array_like of shape (N + 1, N)
    Initial simplex. If given, overrides `x0`.
    ``initial_simplex[j,:]`` should contain the coordinates of
    the jth vertex of the ``N+1`` vertices in the simplex, where
    ``N`` is the dimension.
xatol : float, optional
    Absolute error in xopt between iterations that is acceptable for
    convergence.
fatol : number, optional
    Absolute error in func(xopt) between iterations that is acceptable for
    convergence.
adaptive : bool, optional
    Adapt algorithm parameters to dimensionality of problem. Useful for
    high-dimensional minimization [1]_.
bounds : sequence or `Bounds`, optional
    Bounds on variables. There are two ways to specify the bounds:

        1. Instance of `Bounds` class.
        2. Sequence of ``(min, max)`` pairs for each element in `x`. None
           is used to specify no bound.

    Note that this just clips all vertices in simplex based on
    the bounds.

References
----------
.. [1] Gao, F. and Han, L.
   Implementing the Nelder-Mead simplex algorithm with adaptive
   parameters. 2012. Computational Optimization and Applications.
   51:1, pp. 259-277</pre> <div class="fragment"><div class="line"><span class="lineno">  639</span>                         **unknown_options):</div>
<div class="line"><span class="lineno">  640</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">    Minimization of scalar function of one or more variables using the</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">    Nelder-Mead algorithm.</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">    disp : bool</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral">        Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral">    maxiter, maxfev : int</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">        Maximum allowed number of iterations and function evaluations.</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral">        Will default to ``N*200``, where ``N`` is the number of</span></div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">        variables, if neither `maxiter` or `maxfev` is set. If both</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral">        `maxiter` and `maxfev` are set, minimization will stop at the</span></div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">        first reached.</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">    return_all : bool, optional</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">        Set to True to return a list of the best solution at each of the</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">        iterations.</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">    initial_simplex : array_like of shape (N + 1, N)</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral">        Initial simplex. If given, overrides `x0`.</span></div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">        ``initial_simplex[j,:]`` should contain the coordinates of</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">        the jth vertex of the ``N+1`` vertices in the simplex, where</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">        ``N`` is the dimension.</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">    xatol : float, optional</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">        Absolute error in xopt between iterations that is acceptable for</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">        convergence.</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">    fatol : number, optional</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">        Absolute error in func(xopt) between iterations that is acceptable for</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">        convergence.</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">    adaptive : bool, optional</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral">        Adapt algorithm parameters to dimensionality of problem. Useful for</span></div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral">        high-dimensional minimization [1]_.</span></div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">    bounds : sequence or `Bounds`, optional</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">        Bounds on variables. There are two ways to specify the bounds:</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">            1. Instance of `Bounds` class.</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral">            2. Sequence of ``(min, max)`` pairs for each element in `x`. None</span></div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral">               is used to specify no bound.</span></div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">        Note that this just clips all vertices in simplex based on</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">        the bounds.</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">    .. [1] Gao, F. and Han, L.</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">       Implementing the Nelder-Mead simplex algorithm with adaptive</span></div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral">       parameters. 2012. Computational Optimization and Applications.</span></div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral">       51:1, pp. 259-277</span></div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  689</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno">  690</span>    maxfun = maxfev</div>
<div class="line"><span class="lineno">  691</span>    retall = return_all</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>    x0 = asfarray(x0).flatten()</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>    <span class="keywordflow">if</span> adaptive:</div>
<div class="line"><span class="lineno">  696</span>        dim = float(len(x0))</div>
<div class="line"><span class="lineno">  697</span>        rho = 1</div>
<div class="line"><span class="lineno">  698</span>        chi = 1 + 2/dim</div>
<div class="line"><span class="lineno">  699</span>        psi = 0.75 - 1/(2*dim)</div>
<div class="line"><span class="lineno">  700</span>        sigma = 1 - 1/dim</div>
<div class="line"><span class="lineno">  701</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  702</span>        rho = 1</div>
<div class="line"><span class="lineno">  703</span>        chi = 2</div>
<div class="line"><span class="lineno">  704</span>        psi = 0.5</div>
<div class="line"><span class="lineno">  705</span>        sigma = 0.5</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    nonzdelt = 0.05</div>
<div class="line"><span class="lineno">  708</span>    zdelt = 0.00025</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  711</span>        lower_bound, upper_bound = bounds.lb, bounds.ub</div>
<div class="line"><span class="lineno">  712</span>        <span class="comment"># check bounds</span></div>
<div class="line"><span class="lineno">  713</span>        <span class="keywordflow">if</span> (lower_bound &gt; upper_bound).any():</div>
<div class="line"><span class="lineno">  714</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Nelder Mead - one of the lower bounds is greater than an upper bound.&quot;</span>)</div>
<div class="line"><span class="lineno">  715</span>        <span class="keywordflow">if</span> np.any(lower_bound &gt; x0) <span class="keywordflow">or</span> np.any(x0 &gt; upper_bound):</div>
<div class="line"><span class="lineno">  716</span>            warnings.warn(<span class="stringliteral">&quot;Initial guess is not within the specified bounds&quot;</span>,</div>
<div class="line"><span class="lineno">  717</span>                          OptimizeWarning, 3)</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  720</span>        x0 = np.clip(x0, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>    <span class="keywordflow">if</span> initial_simplex <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  723</span>        N = len(x0)</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>        sim = np.empty((N + 1, N), dtype=x0.dtype)</div>
<div class="line"><span class="lineno">  726</span>        sim[0] = x0</div>
<div class="line"><span class="lineno">  727</span>        <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(N):</div>
<div class="line"><span class="lineno">  728</span>            y = np.array(x0, copy=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  729</span>            <span class="keywordflow">if</span> y[k] != 0:</div>
<div class="line"><span class="lineno">  730</span>                y[k] = (1 + nonzdelt)*y[k]</div>
<div class="line"><span class="lineno">  731</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  732</span>                y[k] = zdelt</div>
<div class="line"><span class="lineno">  733</span>            sim[k + 1] = y</div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  735</span>        sim = np.asfarray(initial_simplex).copy()</div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordflow">if</span> sim.ndim != 2 <span class="keywordflow">or</span> sim.shape[0] != sim.shape[1] + 1:</div>
<div class="line"><span class="lineno">  737</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`initial_simplex` should be an array of shape (N+1,N)&quot;</span>)</div>
<div class="line"><span class="lineno">  738</span>        <span class="keywordflow">if</span> len(x0) != sim.shape[1]:</div>
<div class="line"><span class="lineno">  739</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Size of `initial_simplex` is not consistent with `x0`&quot;</span>)</div>
<div class="line"><span class="lineno">  740</span>        N = sim.shape[1]</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno">  743</span>        allvecs = [sim[0]]</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="comment"># If neither are set, then set both to default</span></div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> maxiter <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> maxfun <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  747</span>        maxiter = N * 200</div>
<div class="line"><span class="lineno">  748</span>        maxfun = N * 200</div>
<div class="line"><span class="lineno">  749</span>    <span class="keywordflow">elif</span> maxiter <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  750</span>        <span class="comment"># Convert remaining Nones, to np.inf, unless the other is np.inf, in</span></div>
<div class="line"><span class="lineno">  751</span>        <span class="comment"># which case use the default to avoid unbounded iteration</span></div>
<div class="line"><span class="lineno">  752</span>        <span class="keywordflow">if</span> maxfun == np.inf:</div>
<div class="line"><span class="lineno">  753</span>            maxiter = N * 200</div>
<div class="line"><span class="lineno">  754</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  755</span>            maxiter = np.inf</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">elif</span> maxfun <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  757</span>        <span class="keywordflow">if</span> maxiter == np.inf:</div>
<div class="line"><span class="lineno">  758</span>            maxfun = N * 200</div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  760</span>            maxfun = np.inf</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  763</span>        sim = np.clip(sim, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>    one2np1 = list(range(1, N + 1))</div>
<div class="line"><span class="lineno">  766</span>    fsim = np.full((N + 1,), np.inf, dtype=float)</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>    fcalls, func = _wrap_scalar_function_maxfun_validation(func, args, maxfun)</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  771</span>        <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(N + 1):</div>
<div class="line"><span class="lineno">  772</span>            fsim[k] = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(sim[k])</div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordflow">except</span> _MaxFuncCallError:</div>
<div class="line"><span class="lineno">  774</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  776</span>        ind = np.argsort(fsim)</div>
<div class="line"><span class="lineno">  777</span>        sim = np.take(sim, ind, 0)</div>
<div class="line"><span class="lineno">  778</span>        fsim = np.take(fsim, ind, 0)</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>    ind = np.argsort(fsim)</div>
<div class="line"><span class="lineno">  781</span>    fsim = np.take(fsim, ind, 0)</div>
<div class="line"><span class="lineno">  782</span>    <span class="comment"># sort so sim[0,:] has the lowest function value</span></div>
<div class="line"><span class="lineno">  783</span>    sim = np.take(sim, ind, 0)</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>    iterations = 1</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">while</span> (fcalls[0] &lt; maxfun <span class="keywordflow">and</span> iterations &lt; maxiter):</div>
<div class="line"><span class="lineno">  788</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  789</span>            <span class="keywordflow">if</span> (np.max(np.ravel(np.abs(sim[1:] - sim[0]))) &lt;= xatol <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  790</span>                    np.max(np.abs(fsim[0] - fsim[1:])) &lt;= fatol):</div>
<div class="line"><span class="lineno">  791</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  792</span> </div>
<div class="line"><span class="lineno">  793</span>            xbar = np.add.reduce(sim[:-1], 0) / N</div>
<div class="line"><span class="lineno">  794</span>            xr = (1 + rho) * xbar - rho * sim[-1]</div>
<div class="line"><span class="lineno">  795</span>            <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  796</span>                xr = np.clip(xr, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno">  797</span>            fxr = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xr)</div>
<div class="line"><span class="lineno">  798</span>            doshrink = 0</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>            <span class="keywordflow">if</span> fxr &lt; fsim[0]:</div>
<div class="line"><span class="lineno">  801</span>                xe = (1 + rho * chi) * xbar - rho * chi * sim[-1]</div>
<div class="line"><span class="lineno">  802</span>                <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  803</span>                    xe = np.clip(xe, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno">  804</span>                fxe = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xe)</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>                <span class="keywordflow">if</span> fxe &lt; fxr:</div>
<div class="line"><span class="lineno">  807</span>                    sim[-1] = xe</div>
<div class="line"><span class="lineno">  808</span>                    fsim[-1] = fxe</div>
<div class="line"><span class="lineno">  809</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  810</span>                    sim[-1] = xr</div>
<div class="line"><span class="lineno">  811</span>                    fsim[-1] = fxr</div>
<div class="line"><span class="lineno">  812</span>            <span class="keywordflow">else</span>:  <span class="comment"># fsim[0] &lt;= fxr</span></div>
<div class="line"><span class="lineno">  813</span>                <span class="keywordflow">if</span> fxr &lt; fsim[-2]:</div>
<div class="line"><span class="lineno">  814</span>                    sim[-1] = xr</div>
<div class="line"><span class="lineno">  815</span>                    fsim[-1] = fxr</div>
<div class="line"><span class="lineno">  816</span>                <span class="keywordflow">else</span>:  <span class="comment"># fxr &gt;= fsim[-2]</span></div>
<div class="line"><span class="lineno">  817</span>                    <span class="comment"># Perform contraction</span></div>
<div class="line"><span class="lineno">  818</span>                    <span class="keywordflow">if</span> fxr &lt; fsim[-1]:</div>
<div class="line"><span class="lineno">  819</span>                        xc = (1 + psi * rho) * xbar - psi * rho * sim[-1]</div>
<div class="line"><span class="lineno">  820</span>                        <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  821</span>                            xc = np.clip(xc, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno">  822</span>                        fxc = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xc)</div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span>                        <span class="keywordflow">if</span> fxc &lt;= fxr:</div>
<div class="line"><span class="lineno">  825</span>                            sim[-1] = xc</div>
<div class="line"><span class="lineno">  826</span>                            fsim[-1] = fxc</div>
<div class="line"><span class="lineno">  827</span>                        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  828</span>                            doshrink = 1</div>
<div class="line"><span class="lineno">  829</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  830</span>                        <span class="comment"># Perform an inside contraction</span></div>
<div class="line"><span class="lineno">  831</span>                        xcc = (1 - psi) * xbar + psi * sim[-1]</div>
<div class="line"><span class="lineno">  832</span>                        <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  833</span>                            xcc = np.clip(xcc, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno">  834</span>                        fxcc = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xcc)</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>                        <span class="keywordflow">if</span> fxcc &lt; fsim[-1]:</div>
<div class="line"><span class="lineno">  837</span>                            sim[-1] = xcc</div>
<div class="line"><span class="lineno">  838</span>                            fsim[-1] = fxcc</div>
<div class="line"><span class="lineno">  839</span>                        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  840</span>                            doshrink = 1</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>                    <span class="keywordflow">if</span> doshrink:</div>
<div class="line"><span class="lineno">  843</span>                        <span class="keywordflow">for</span> j <span class="keywordflow">in</span> one2np1:</div>
<div class="line"><span class="lineno">  844</span>                            sim[j] = sim[0] + sigma * (sim[j] - sim[0])</div>
<div class="line"><span class="lineno">  845</span>                            <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  846</span>                                sim[j] = np.clip(</div>
<div class="line"><span class="lineno">  847</span>                                    sim[j], lower_bound, upper_bound)</div>
<div class="line"><span class="lineno">  848</span>                            fsim[j] = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(sim[j])</div>
<div class="line"><span class="lineno">  849</span>            iterations += 1</div>
<div class="line"><span class="lineno">  850</span>        <span class="keywordflow">except</span> _MaxFuncCallError:</div>
<div class="line"><span class="lineno">  851</span>            <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  852</span>        <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  853</span>            ind = np.argsort(fsim)</div>
<div class="line"><span class="lineno">  854</span>            sim = np.take(sim, ind, 0)</div>
<div class="line"><span class="lineno">  855</span>            fsim = np.take(fsim, ind, 0)</div>
<div class="line"><span class="lineno">  856</span>            <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  857</span>                callback(sim[0])</div>
<div class="line"><span class="lineno">  858</span>            <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno">  859</span>                allvecs.append(sim[0])</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>    x = sim[0]</div>
<div class="line"><span class="lineno">  862</span>    fval = np.min(fsim)</div>
<div class="line"><span class="lineno">  863</span>    warnflag = 0</div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span>    <span class="keywordflow">if</span> fcalls[0] &gt;= maxfun:</div>
<div class="line"><span class="lineno">  866</span>        warnflag = 1</div>
<div class="line"><span class="lineno">  867</span>        msg = _status_message[<span class="stringliteral">&#39;maxfev&#39;</span>]</div>
<div class="line"><span class="lineno">  868</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno">  869</span>            warnings.warn(msg, RuntimeWarning, 3)</div>
<div class="line"><span class="lineno">  870</span>    <span class="keywordflow">elif</span> iterations &gt;= maxiter:</div>
<div class="line"><span class="lineno">  871</span>        warnflag = 2</div>
<div class="line"><span class="lineno">  872</span>        msg = _status_message[<span class="stringliteral">&#39;maxiter&#39;</span>]</div>
<div class="line"><span class="lineno">  873</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno">  874</span>            warnings.warn(msg, RuntimeWarning, 3)</div>
<div class="line"><span class="lineno">  875</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  876</span>        msg = _status_message[<span class="stringliteral">&#39;success&#39;</span>]</div>
<div class="line"><span class="lineno">  877</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno">  878</span>            print(msg)</div>
<div class="line"><span class="lineno">  879</span>            print(<span class="stringliteral">&quot;         Current function value: %f&quot;</span> % fval)</div>
<div class="line"><span class="lineno">  880</span>            print(<span class="stringliteral">&quot;         Iterations: %d&quot;</span> % iterations)</div>
<div class="line"><span class="lineno">  881</span>            print(<span class="stringliteral">&quot;         Function evaluations: %d&quot;</span> % fcalls[0])</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>    result = OptimizeResult(fun=fval, nit=iterations, nfev=fcalls[0],</div>
<div class="line"><span class="lineno">  884</span>                            status=warnflag, success=(warnflag == 0),</div>
<div class="line"><span class="lineno">  885</span>                            message=msg, x=x, final_simplex=(sim, fsim))</div>
<div class="line"><span class="lineno">  886</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno">  887</span>        result[<span class="stringliteral">&#39;allvecs&#39;</span>] = allvecs</div>
<div class="line"><span class="lineno">  888</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0095fb8edd856194da3b0a1ca2d761cd" name="a0095fb8edd856194da3b0a1ca2d761cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0095fb8edd856194da3b0a1ca2d761cd">&#9670;&#160;</a></span>_minimize_newtoncg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._minimize_newtoncg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hess</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hessp</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_all</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimization of scalar function of one or more variables using the
Newton-CG algorithm.

Note that the `jac` parameter (Jacobian) is required.

Options
-------
disp : bool
    Set to True to print convergence messages.
xtol : float
    Average relative error in solution `xopt` acceptable for
    convergence.
maxiter : int
    Maximum number of iterations to perform.
eps : float or ndarray
    If `hessp` is approximated, use this value for the step size.
return_all : bool, optional
    Set to True to return a list of the best solution at each of the
    iterations.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1816</span>                       **unknown_options):</div>
<div class="line"><span class="lineno"> 1817</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1818</span><span class="stringliteral">    Minimization of scalar function of one or more variables using the</span></div>
<div class="line"><span class="lineno"> 1819</span><span class="stringliteral">    Newton-CG algorithm.</span></div>
<div class="line"><span class="lineno"> 1820</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1821</span><span class="stringliteral">    Note that the `jac` parameter (Jacobian) is required.</span></div>
<div class="line"><span class="lineno"> 1822</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1823</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno"> 1824</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1825</span><span class="stringliteral">    disp : bool</span></div>
<div class="line"><span class="lineno"> 1826</span><span class="stringliteral">        Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno"> 1827</span><span class="stringliteral">    xtol : float</span></div>
<div class="line"><span class="lineno"> 1828</span><span class="stringliteral">        Average relative error in solution `xopt` acceptable for</span></div>
<div class="line"><span class="lineno"> 1829</span><span class="stringliteral">        convergence.</span></div>
<div class="line"><span class="lineno"> 1830</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno"> 1831</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 1832</span><span class="stringliteral">    eps : float or ndarray</span></div>
<div class="line"><span class="lineno"> 1833</span><span class="stringliteral">        If `hessp` is approximated, use this value for the step size.</span></div>
<div class="line"><span class="lineno"> 1834</span><span class="stringliteral">    return_all : bool, optional</span></div>
<div class="line"><span class="lineno"> 1835</span><span class="stringliteral">        Set to True to return a list of the best solution at each of the</span></div>
<div class="line"><span class="lineno"> 1836</span><span class="stringliteral">        iterations.</span></div>
<div class="line"><span class="lineno"> 1837</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1838</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno"> 1839</span>    <span class="keywordflow">if</span> jac <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1840</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Jacobian is required for Newton-CG method&#39;</span>)</div>
<div class="line"><span class="lineno"> 1841</span>    fhess_p = hessp</div>
<div class="line"><span class="lineno"> 1842</span>    fhess = hess</div>
<div class="line"><span class="lineno"> 1843</span>    avextol = xtol</div>
<div class="line"><span class="lineno"> 1844</span>    epsilon = eps</div>
<div class="line"><span class="lineno"> 1845</span>    retall = return_all</div>
<div class="line"><span class="lineno"> 1846</span> </div>
<div class="line"><span class="lineno"> 1847</span>    x0 = asarray(x0).flatten()</div>
<div class="line"><span class="lineno"> 1848</span>    <span class="comment"># TODO: add hessp (callable or FD) to ScalarFunction?</span></div>
<div class="line"><span class="lineno"> 1849</span>    sf = _prepare_scalar_function(</div>
<div class="line"><span class="lineno"> 1850</span>        fun, x0, jac, args=args, epsilon=eps, hess=hess</div>
<div class="line"><span class="lineno"> 1851</span>    )</div>
<div class="line"><span class="lineno"> 1852</span>    f = sf.fun</div>
<div class="line"><span class="lineno"> 1853</span>    fprime = sf.grad</div>
<div class="line"><span class="lineno"> 1854</span>    _h = sf.hess(x0)</div>
<div class="line"><span class="lineno"> 1855</span> </div>
<div class="line"><span class="lineno"> 1856</span>    <span class="comment"># Logic for hess/hessp</span></div>
<div class="line"><span class="lineno"> 1857</span>    <span class="comment"># - If a callable(hess) is provided, then use that</span></div>
<div class="line"><span class="lineno"> 1858</span>    <span class="comment"># - If hess is a FD_METHOD, or the output fom hess(x) is a LinearOperator</span></div>
<div class="line"><span class="lineno"> 1859</span>    <span class="comment">#   then create a hessp function using those.</span></div>
<div class="line"><span class="lineno"> 1860</span>    <span class="comment"># - If hess is None but you have callable(hessp) then use the hessp.</span></div>
<div class="line"><span class="lineno"> 1861</span>    <span class="comment"># - If hess and hessp are None then approximate hessp using the grad/jac.</span></div>
<div class="line"><span class="lineno"> 1862</span> </div>
<div class="line"><span class="lineno"> 1863</span>    <span class="keywordflow">if</span> (hess <span class="keywordflow">in</span> FD_METHODS <span class="keywordflow">or</span> isinstance(_h, LinearOperator)):</div>
<div class="line"><span class="lineno"> 1864</span>        fhess = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1865</span> </div>
<div class="line"><span class="lineno"> 1866</span>        <span class="keyword">def </span>_hessp(x, p, *args):</div>
<div class="line"><span class="lineno"> 1867</span>            <span class="keywordflow">return</span> sf.hess(x).dot(p)</div>
<div class="line"><span class="lineno"> 1868</span> </div>
<div class="line"><span class="lineno"> 1869</span>        fhess_p = _hessp</div>
<div class="line"><span class="lineno"> 1870</span> </div>
<div class="line"><span class="lineno"> 1871</span>    <span class="keyword">def </span>terminate(warnflag, msg):</div>
<div class="line"><span class="lineno"> 1872</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 1873</span>            print(msg)</div>
<div class="line"><span class="lineno"> 1874</span>            print(<span class="stringliteral">&quot;         Current function value: %f&quot;</span> % old_fval)</div>
<div class="line"><span class="lineno"> 1875</span>            print(<span class="stringliteral">&quot;         Iterations: %d&quot;</span> % k)</div>
<div class="line"><span class="lineno"> 1876</span>            print(<span class="stringliteral">&quot;         Function evaluations: %d&quot;</span> % sf.nfev)</div>
<div class="line"><span class="lineno"> 1877</span>            print(<span class="stringliteral">&quot;         Gradient evaluations: %d&quot;</span> % sf.ngev)</div>
<div class="line"><span class="lineno"> 1878</span>            print(<span class="stringliteral">&quot;         Hessian evaluations: %d&quot;</span> % hcalls)</div>
<div class="line"><span class="lineno"> 1879</span>        fval = old_fval</div>
<div class="line"><span class="lineno"> 1880</span>        result = OptimizeResult(fun=fval, jac=gfk, nfev=sf.nfev,</div>
<div class="line"><span class="lineno"> 1881</span>                                njev=sf.ngev, nhev=hcalls, status=warnflag,</div>
<div class="line"><span class="lineno"> 1882</span>                                success=(warnflag == 0), message=msg, x=xk,</div>
<div class="line"><span class="lineno"> 1883</span>                                nit=k)</div>
<div class="line"><span class="lineno"> 1884</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1885</span>            result[<span class="stringliteral">&#39;allvecs&#39;</span>] = allvecs</div>
<div class="line"><span class="lineno"> 1886</span>        <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 1887</span> </div>
<div class="line"><span class="lineno"> 1888</span>    hcalls = 0</div>
<div class="line"><span class="lineno"> 1889</span>    <span class="keywordflow">if</span> maxiter <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1890</span>        maxiter = len(x0)*200</div>
<div class="line"><span class="lineno"> 1891</span>    cg_maxiter = 20*len(x0)</div>
<div class="line"><span class="lineno"> 1892</span> </div>
<div class="line"><span class="lineno"> 1893</span>    xtol = len(x0) * avextol</div>
<div class="line"><span class="lineno"> 1894</span>    update = [2 * xtol]</div>
<div class="line"><span class="lineno"> 1895</span>    xk = x0</div>
<div class="line"><span class="lineno"> 1896</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1897</span>        allvecs = [xk]</div>
<div class="line"><span class="lineno"> 1898</span>    k = 0</div>
<div class="line"><span class="lineno"> 1899</span>    gfk = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1900</span>    old_fval = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x0)</div>
<div class="line"><span class="lineno"> 1901</span>    old_old_fval = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1902</span>    float64eps = np.finfo(np.float64).eps</div>
<div class="line"><span class="lineno"> 1903</span>    <span class="keywordflow">while</span> np.add.reduce(np.abs(update)) &gt; xtol:</div>
<div class="line"><span class="lineno"> 1904</span>        <span class="keywordflow">if</span> k &gt;= maxiter:</div>
<div class="line"><span class="lineno"> 1905</span>            msg = <span class="stringliteral">&quot;Warning: &quot;</span> + _status_message[<span class="stringliteral">&#39;maxiter&#39;</span>]</div>
<div class="line"><span class="lineno"> 1906</span>            <span class="keywordflow">return</span> terminate(1, msg)</div>
<div class="line"><span class="lineno"> 1907</span>        <span class="comment"># Compute a search direction pk by applying the CG method to</span></div>
<div class="line"><span class="lineno"> 1908</span>        <span class="comment">#  del2 f(xk) p = - grad f(xk) starting from 0.</span></div>
<div class="line"><span class="lineno"> 1909</span>        b = -fprime(xk)</div>
<div class="line"><span class="lineno"> 1910</span>        maggrad = np.add.reduce(np.abs(b))</div>
<div class="line"><span class="lineno"> 1911</span>        eta = np.min([0.5, np.sqrt(maggrad)])</div>
<div class="line"><span class="lineno"> 1912</span>        termcond = eta * maggrad</div>
<div class="line"><span class="lineno"> 1913</span>        xsupi = zeros(len(x0), dtype=x0.dtype)</div>
<div class="line"><span class="lineno"> 1914</span>        ri = -b</div>
<div class="line"><span class="lineno"> 1915</span>        psupi = -ri</div>
<div class="line"><span class="lineno"> 1916</span>        i = 0</div>
<div class="line"><span class="lineno"> 1917</span>        dri0 = np.dot(ri, ri)</div>
<div class="line"><span class="lineno"> 1918</span> </div>
<div class="line"><span class="lineno"> 1919</span>        <span class="keywordflow">if</span> fhess <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:             <span class="comment"># you want to compute hessian once.</span></div>
<div class="line"><span class="lineno"> 1920</span>            A = sf.hess(xk)</div>
<div class="line"><span class="lineno"> 1921</span>            hcalls = hcalls + 1</div>
<div class="line"><span class="lineno"> 1922</span> </div>
<div class="line"><span class="lineno"> 1923</span>        <span class="keywordflow">for</span> k2 <span class="keywordflow">in</span> range(cg_maxiter):</div>
<div class="line"><span class="lineno"> 1924</span>            <span class="keywordflow">if</span> np.add.reduce(np.abs(ri)) &lt;= termcond:</div>
<div class="line"><span class="lineno"> 1925</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1926</span>            <span class="keywordflow">if</span> fhess <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1927</span>                <span class="keywordflow">if</span> fhess_p <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1928</span>                    Ap = approx_fhess_p(xk, psupi, fprime, epsilon)</div>
<div class="line"><span class="lineno"> 1929</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1930</span>                    Ap = fhess_p(xk, psupi, *args)</div>
<div class="line"><span class="lineno"> 1931</span>                    hcalls = hcalls + 1</div>
<div class="line"><span class="lineno"> 1932</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1933</span>                <span class="keywordflow">if</span> isinstance(A, HessianUpdateStrategy):</div>
<div class="line"><span class="lineno"> 1934</span>                    <span class="comment"># if hess was supplied as a HessianUpdateStrategy</span></div>
<div class="line"><span class="lineno"> 1935</span>                    Ap = A.dot(psupi)</div>
<div class="line"><span class="lineno"> 1936</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1937</span>                    Ap = np.dot(A, psupi)</div>
<div class="line"><span class="lineno"> 1938</span>            <span class="comment"># check curvature</span></div>
<div class="line"><span class="lineno"> 1939</span>            Ap = asarray(Ap).squeeze()  <span class="comment"># get rid of matrices...</span></div>
<div class="line"><span class="lineno"> 1940</span>            curv = np.dot(psupi, Ap)</div>
<div class="line"><span class="lineno"> 1941</span>            <span class="keywordflow">if</span> 0 &lt;= curv &lt;= 3 * float64eps:</div>
<div class="line"><span class="lineno"> 1942</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1943</span>            <span class="keywordflow">elif</span> curv &lt; 0:</div>
<div class="line"><span class="lineno"> 1944</span>                <span class="keywordflow">if</span> (i &gt; 0):</div>
<div class="line"><span class="lineno"> 1945</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1946</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1947</span>                    <span class="comment"># fall back to steepest descent direction</span></div>
<div class="line"><span class="lineno"> 1948</span>                    xsupi = dri0 / (-curv) * b</div>
<div class="line"><span class="lineno"> 1949</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1950</span>            alphai = dri0 / curv</div>
<div class="line"><span class="lineno"> 1951</span>            xsupi = xsupi + alphai * psupi</div>
<div class="line"><span class="lineno"> 1952</span>            ri = ri + alphai * Ap</div>
<div class="line"><span class="lineno"> 1953</span>            dri1 = np.dot(ri, ri)</div>
<div class="line"><span class="lineno"> 1954</span>            betai = dri1 / dri0</div>
<div class="line"><span class="lineno"> 1955</span>            psupi = -ri + betai * psupi</div>
<div class="line"><span class="lineno"> 1956</span>            i = i + 1</div>
<div class="line"><span class="lineno"> 1957</span>            dri0 = dri1          <span class="comment"># update np.dot(ri,ri) for next time.</span></div>
<div class="line"><span class="lineno"> 1958</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1959</span>            <span class="comment"># curvature keeps increasing, bail out</span></div>
<div class="line"><span class="lineno"> 1960</span>            msg = (<span class="stringliteral">&quot;Warning: CG iterations didn&#39;t converge. The Hessian is not &quot;</span></div>
<div class="line"><span class="lineno"> 1961</span>                   <span class="stringliteral">&quot;positive definite.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1962</span>            <span class="keywordflow">return</span> terminate(3, msg)</div>
<div class="line"><span class="lineno"> 1963</span> </div>
<div class="line"><span class="lineno"> 1964</span>        pk = xsupi  <span class="comment"># search direction is solution to system.</span></div>
<div class="line"><span class="lineno"> 1965</span>        gfk = -b    <span class="comment"># gradient at xk</span></div>
<div class="line"><span class="lineno"> 1966</span> </div>
<div class="line"><span class="lineno"> 1967</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1968</span>            alphak, fc, gc, old_fval, old_old_fval, gfkp1 = \</div>
<div class="line"><span class="lineno"> 1969</span>                     _line_search_wolfe12(f, fprime, xk, pk, gfk,</div>
<div class="line"><span class="lineno"> 1970</span>                                          old_fval, old_old_fval)</div>
<div class="line"><span class="lineno"> 1971</span>        <span class="keywordflow">except</span> _LineSearchError:</div>
<div class="line"><span class="lineno"> 1972</span>            <span class="comment"># Line search failed to find a better solution.</span></div>
<div class="line"><span class="lineno"> 1973</span>            msg = <span class="stringliteral">&quot;Warning: &quot;</span> + _status_message[<span class="stringliteral">&#39;pr_loss&#39;</span>]</div>
<div class="line"><span class="lineno"> 1974</span>            <span class="keywordflow">return</span> terminate(2, msg)</div>
<div class="line"><span class="lineno"> 1975</span> </div>
<div class="line"><span class="lineno"> 1976</span>        update = alphak * pk</div>
<div class="line"><span class="lineno"> 1977</span>        xk = xk + update        <span class="comment"># upcast if necessary</span></div>
<div class="line"><span class="lineno"> 1978</span>        <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1979</span>            callback(xk)</div>
<div class="line"><span class="lineno"> 1980</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1981</span>            allvecs.append(xk)</div>
<div class="line"><span class="lineno"> 1982</span>        k += 1</div>
<div class="line"><span class="lineno"> 1983</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1984</span>        <span class="keywordflow">if</span> np.isnan(old_fval) <span class="keywordflow">or</span> np.isnan(update).any():</div>
<div class="line"><span class="lineno"> 1985</span>            <span class="keywordflow">return</span> terminate(3, _status_message[<span class="stringliteral">&#39;nan&#39;</span>])</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>        msg = _status_message[<span class="stringliteral">&#39;success&#39;</span>]</div>
<div class="line"><span class="lineno"> 1988</span>        <span class="keywordflow">return</span> terminate(0, msg)</div>
<div class="line"><span class="lineno"> 1989</span> </div>
<div class="line"><span class="lineno"> 1990</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b7569c6086976da8d1e928c31b43df8" name="a3b7569c6086976da8d1e928c31b43df8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b7569c6086976da8d1e928c31b43df8">&#9670;&#160;</a></span>_minimize_powell()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._minimize_powell </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfev</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direc</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_all</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimization of scalar function of one or more variables using the
modified Powell algorithm.

Options
-------
disp : bool
    Set to True to print convergence messages.
xtol : float
    Relative error in solution `xopt` acceptable for convergence.
ftol : float
    Relative error in ``fun(xopt)`` acceptable for convergence.
maxiter, maxfev : int
    Maximum allowed number of iterations and function evaluations.
    Will default to ``N*1000``, where ``N`` is the number of
    variables, if neither `maxiter` or `maxfev` is set. If both
    `maxiter` and `maxfev` are set, minimization will stop at the
    first reached.
direc : ndarray
    Initial set of direction vectors for the Powell method.
return_all : bool, optional
    Set to True to return a list of the best solution at each of the
    iterations.
bounds : `Bounds`
    If bounds are not provided, then an unbounded line search will be used.
    If bounds are provided and the initial guess is within the bounds, then
    every function evaluation throughout the minimization procedure will be
    within the bounds. If bounds are provided, the initial guess is outside
    the bounds, and `direc` is full rank (or left to default), then some
    function evaluations during the first iteration may be outside the
    bounds, but every function evaluation after the first iteration will be
    within the bounds. If `direc` is not full rank, then some parameters may
    not be optimized and the solution is not guaranteed to be within the
    bounds.
return_all : bool, optional
    Set to True to return a list of the best solution at each of the
    iterations.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 3080</span>                     **unknown_options):</div>
<div class="line"><span class="lineno"> 3081</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3082</span><span class="stringliteral">    Minimization of scalar function of one or more variables using the</span></div>
<div class="line"><span class="lineno"> 3083</span><span class="stringliteral">    modified Powell algorithm.</span></div>
<div class="line"><span class="lineno"> 3084</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3085</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno"> 3086</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3087</span><span class="stringliteral">    disp : bool</span></div>
<div class="line"><span class="lineno"> 3088</span><span class="stringliteral">        Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno"> 3089</span><span class="stringliteral">    xtol : float</span></div>
<div class="line"><span class="lineno"> 3090</span><span class="stringliteral">        Relative error in solution `xopt` acceptable for convergence.</span></div>
<div class="line"><span class="lineno"> 3091</span><span class="stringliteral">    ftol : float</span></div>
<div class="line"><span class="lineno"> 3092</span><span class="stringliteral">        Relative error in ``fun(xopt)`` acceptable for convergence.</span></div>
<div class="line"><span class="lineno"> 3093</span><span class="stringliteral">    maxiter, maxfev : int</span></div>
<div class="line"><span class="lineno"> 3094</span><span class="stringliteral">        Maximum allowed number of iterations and function evaluations.</span></div>
<div class="line"><span class="lineno"> 3095</span><span class="stringliteral">        Will default to ``N*1000``, where ``N`` is the number of</span></div>
<div class="line"><span class="lineno"> 3096</span><span class="stringliteral">        variables, if neither `maxiter` or `maxfev` is set. If both</span></div>
<div class="line"><span class="lineno"> 3097</span><span class="stringliteral">        `maxiter` and `maxfev` are set, minimization will stop at the</span></div>
<div class="line"><span class="lineno"> 3098</span><span class="stringliteral">        first reached.</span></div>
<div class="line"><span class="lineno"> 3099</span><span class="stringliteral">    direc : ndarray</span></div>
<div class="line"><span class="lineno"> 3100</span><span class="stringliteral">        Initial set of direction vectors for the Powell method.</span></div>
<div class="line"><span class="lineno"> 3101</span><span class="stringliteral">    return_all : bool, optional</span></div>
<div class="line"><span class="lineno"> 3102</span><span class="stringliteral">        Set to True to return a list of the best solution at each of the</span></div>
<div class="line"><span class="lineno"> 3103</span><span class="stringliteral">        iterations.</span></div>
<div class="line"><span class="lineno"> 3104</span><span class="stringliteral">    bounds : `Bounds`</span></div>
<div class="line"><span class="lineno"> 3105</span><span class="stringliteral">        If bounds are not provided, then an unbounded line search will be used.</span></div>
<div class="line"><span class="lineno"> 3106</span><span class="stringliteral">        If bounds are provided and the initial guess is within the bounds, then</span></div>
<div class="line"><span class="lineno"> 3107</span><span class="stringliteral">        every function evaluation throughout the minimization procedure will be</span></div>
<div class="line"><span class="lineno"> 3108</span><span class="stringliteral">        within the bounds. If bounds are provided, the initial guess is outside</span></div>
<div class="line"><span class="lineno"> 3109</span><span class="stringliteral">        the bounds, and `direc` is full rank (or left to default), then some</span></div>
<div class="line"><span class="lineno"> 3110</span><span class="stringliteral">        function evaluations during the first iteration may be outside the</span></div>
<div class="line"><span class="lineno"> 3111</span><span class="stringliteral">        bounds, but every function evaluation after the first iteration will be</span></div>
<div class="line"><span class="lineno"> 3112</span><span class="stringliteral">        within the bounds. If `direc` is not full rank, then some parameters may</span></div>
<div class="line"><span class="lineno"> 3113</span><span class="stringliteral">        not be optimized and the solution is not guaranteed to be within the</span></div>
<div class="line"><span class="lineno"> 3114</span><span class="stringliteral">        bounds.</span></div>
<div class="line"><span class="lineno"> 3115</span><span class="stringliteral">    return_all : bool, optional</span></div>
<div class="line"><span class="lineno"> 3116</span><span class="stringliteral">        Set to True to return a list of the best solution at each of the</span></div>
<div class="line"><span class="lineno"> 3117</span><span class="stringliteral">        iterations.</span></div>
<div class="line"><span class="lineno"> 3118</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3119</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno"> 3120</span>    maxfun = maxfev</div>
<div class="line"><span class="lineno"> 3121</span>    retall = return_all</div>
<div class="line"><span class="lineno"> 3122</span> </div>
<div class="line"><span class="lineno"> 3123</span>    x = asarray(x0).flatten()</div>
<div class="line"><span class="lineno"> 3124</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 3125</span>        allvecs = [x]</div>
<div class="line"><span class="lineno"> 3126</span>    N = len(x)</div>
<div class="line"><span class="lineno"> 3127</span>    <span class="comment"># If neither are set, then set both to default</span></div>
<div class="line"><span class="lineno"> 3128</span>    <span class="keywordflow">if</span> maxiter <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> maxfun <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3129</span>        maxiter = N * 1000</div>
<div class="line"><span class="lineno"> 3130</span>        maxfun = N * 1000</div>
<div class="line"><span class="lineno"> 3131</span>    <span class="keywordflow">elif</span> maxiter <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3132</span>        <span class="comment"># Convert remaining Nones, to np.inf, unless the other is np.inf, in</span></div>
<div class="line"><span class="lineno"> 3133</span>        <span class="comment"># which case use the default to avoid unbounded iteration</span></div>
<div class="line"><span class="lineno"> 3134</span>        <span class="keywordflow">if</span> maxfun == np.inf:</div>
<div class="line"><span class="lineno"> 3135</span>            maxiter = N * 1000</div>
<div class="line"><span class="lineno"> 3136</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3137</span>            maxiter = np.inf</div>
<div class="line"><span class="lineno"> 3138</span>    <span class="keywordflow">elif</span> maxfun <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3139</span>        <span class="keywordflow">if</span> maxiter == np.inf:</div>
<div class="line"><span class="lineno"> 3140</span>            maxfun = N * 1000</div>
<div class="line"><span class="lineno"> 3141</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3142</span>            maxfun = np.inf</div>
<div class="line"><span class="lineno"> 3143</span> </div>
<div class="line"><span class="lineno"> 3144</span>    <span class="comment"># we need to use a mutable object here that we can update in the</span></div>
<div class="line"><span class="lineno"> 3145</span>    <span class="comment"># wrapper function</span></div>
<div class="line"><span class="lineno"> 3146</span>    fcalls, func = _wrap_scalar_function_maxfun_validation(func, args, maxfun)</div>
<div class="line"><span class="lineno"> 3147</span> </div>
<div class="line"><span class="lineno"> 3148</span>    <span class="keywordflow">if</span> direc <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3149</span>        direc = eye(N, dtype=float)</div>
<div class="line"><span class="lineno"> 3150</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3151</span>        direc = asarray(direc, dtype=float)</div>
<div class="line"><span class="lineno"> 3152</span>        <span class="keywordflow">if</span> np.linalg.matrix_rank(direc) != direc.shape[0]:</div>
<div class="line"><span class="lineno"> 3153</span>            warnings.warn(<span class="stringliteral">&quot;direc input is not full rank, some parameters may &quot;</span></div>
<div class="line"><span class="lineno"> 3154</span>                          <span class="stringliteral">&quot;not be optimized&quot;</span>,</div>
<div class="line"><span class="lineno"> 3155</span>                          OptimizeWarning, 3)</div>
<div class="line"><span class="lineno"> 3156</span> </div>
<div class="line"><span class="lineno"> 3157</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3158</span>        <span class="comment"># don&#39;t make these arrays of all +/- inf. because</span></div>
<div class="line"><span class="lineno"> 3159</span>        <span class="comment"># _linesearch_powell will do an unnecessary check of all the elements.</span></div>
<div class="line"><span class="lineno"> 3160</span>        <span class="comment"># just keep them None, _linesearch_powell will not have to check</span></div>
<div class="line"><span class="lineno"> 3161</span>        <span class="comment"># all the elements.</span></div>
<div class="line"><span class="lineno"> 3162</span>        lower_bound, upper_bound = <span class="keywordtype">None</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3163</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3164</span>        <span class="comment"># bounds is standardized in _minimize.py.</span></div>
<div class="line"><span class="lineno"> 3165</span>        lower_bound, upper_bound = bounds.lb, bounds.ub</div>
<div class="line"><span class="lineno"> 3166</span>        <span class="keywordflow">if</span> np.any(lower_bound &gt; x0) <span class="keywordflow">or</span> np.any(x0 &gt; upper_bound):</div>
<div class="line"><span class="lineno"> 3167</span>            warnings.warn(<span class="stringliteral">&quot;Initial guess is not within the specified bounds&quot;</span>,</div>
<div class="line"><span class="lineno"> 3168</span>                          OptimizeWarning, 3)</div>
<div class="line"><span class="lineno"> 3169</span> </div>
<div class="line"><span class="lineno"> 3170</span>    fval = squeeze(<a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x))</div>
<div class="line"><span class="lineno"> 3171</span>    x1 = x.copy()</div>
<div class="line"><span class="lineno"> 3172</span>    iter = 0</div>
<div class="line"><span class="lineno"> 3173</span>    <span class="keywordflow">while</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno"> 3174</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 3175</span>            fx = fval</div>
<div class="line"><span class="lineno"> 3176</span>            bigind = 0</div>
<div class="line"><span class="lineno"> 3177</span>            delta = 0.0</div>
<div class="line"><span class="lineno"> 3178</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(N):</div>
<div class="line"><span class="lineno"> 3179</span>                direc1 = direc[i]</div>
<div class="line"><span class="lineno"> 3180</span>                fx2 = fval</div>
<div class="line"><span class="lineno"> 3181</span>                fval, x, direc1 = _linesearch_powell(func, x, direc1,</div>
<div class="line"><span class="lineno"> 3182</span>                                                     tol=xtol * 100,</div>
<div class="line"><span class="lineno"> 3183</span>                                                     lower_bound=lower_bound,</div>
<div class="line"><span class="lineno"> 3184</span>                                                     upper_bound=upper_bound,</div>
<div class="line"><span class="lineno"> 3185</span>                                                     fval=fval)</div>
<div class="line"><span class="lineno"> 3186</span>                <span class="keywordflow">if</span> (fx2 - fval) &gt; delta:</div>
<div class="line"><span class="lineno"> 3187</span>                    delta = fx2 - fval</div>
<div class="line"><span class="lineno"> 3188</span>                    bigind = i</div>
<div class="line"><span class="lineno"> 3189</span>            iter += 1</div>
<div class="line"><span class="lineno"> 3190</span>            <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3191</span>                callback(x)</div>
<div class="line"><span class="lineno"> 3192</span>            <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 3193</span>                allvecs.append(x)</div>
<div class="line"><span class="lineno"> 3194</span>            bnd = ftol * (np.abs(fx) + np.abs(fval)) + 1e-20</div>
<div class="line"><span class="lineno"> 3195</span>            <span class="keywordflow">if</span> 2.0 * (fx - fval) &lt;= bnd:</div>
<div class="line"><span class="lineno"> 3196</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 3197</span>            <span class="keywordflow">if</span> fcalls[0] &gt;= maxfun:</div>
<div class="line"><span class="lineno"> 3198</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 3199</span>            <span class="keywordflow">if</span> iter &gt;= maxiter:</div>
<div class="line"><span class="lineno"> 3200</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 3201</span>            <span class="keywordflow">if</span> np.isnan(fx) <span class="keywordflow">and</span> np.isnan(fval):</div>
<div class="line"><span class="lineno"> 3202</span>                <span class="comment"># Ended up in a nan-region: bail out</span></div>
<div class="line"><span class="lineno"> 3203</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 3204</span> </div>
<div class="line"><span class="lineno"> 3205</span>            <span class="comment"># Construct the extrapolated point</span></div>
<div class="line"><span class="lineno"> 3206</span>            direc1 = x - x1</div>
<div class="line"><span class="lineno"> 3207</span>            x1 = x.copy()</div>
<div class="line"><span class="lineno"> 3208</span>            <span class="comment"># make sure that we don&#39;t go outside the bounds when extrapolating</span></div>
<div class="line"><span class="lineno"> 3209</span>            <span class="keywordflow">if</span> lower_bound <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> upper_bound <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3210</span>                lmax = 1</div>
<div class="line"><span class="lineno"> 3211</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3212</span>                _, lmax = _line_for_search(x, direc1, lower_bound, upper_bound)</div>
<div class="line"><span class="lineno"> 3213</span>            x2 = x + min(lmax, 1) * direc1</div>
<div class="line"><span class="lineno"> 3214</span>            fx2 = squeeze(<a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x2))</div>
<div class="line"><span class="lineno"> 3215</span> </div>
<div class="line"><span class="lineno"> 3216</span>            <span class="keywordflow">if</span> (fx &gt; fx2):</div>
<div class="line"><span class="lineno"> 3217</span>                t = 2.0*(fx + fx2 - 2.0*fval)</div>
<div class="line"><span class="lineno"> 3218</span>                temp = (fx - fval - delta)</div>
<div class="line"><span class="lineno"> 3219</span>                t *= temp*temp</div>
<div class="line"><span class="lineno"> 3220</span>                temp = fx - fx2</div>
<div class="line"><span class="lineno"> 3221</span>                t -= delta*temp*temp</div>
<div class="line"><span class="lineno"> 3222</span>                <span class="keywordflow">if</span> t &lt; 0.0:</div>
<div class="line"><span class="lineno"> 3223</span>                    fval, x, direc1 = _linesearch_powell(</div>
<div class="line"><span class="lineno"> 3224</span>                        func, x, direc1,</div>
<div class="line"><span class="lineno"> 3225</span>                        tol=xtol * 100,</div>
<div class="line"><span class="lineno"> 3226</span>                        lower_bound=lower_bound,</div>
<div class="line"><span class="lineno"> 3227</span>                        upper_bound=upper_bound,</div>
<div class="line"><span class="lineno"> 3228</span>                        fval=fval</div>
<div class="line"><span class="lineno"> 3229</span>                    )</div>
<div class="line"><span class="lineno"> 3230</span>                    <span class="keywordflow">if</span> np.any(direc1):</div>
<div class="line"><span class="lineno"> 3231</span>                        direc[bigind] = direc[-1]</div>
<div class="line"><span class="lineno"> 3232</span>                        direc[-1] = direc1</div>
<div class="line"><span class="lineno"> 3233</span>        <span class="keywordflow">except</span> _MaxFuncCallError:</div>
<div class="line"><span class="lineno"> 3234</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 3235</span> </div>
<div class="line"><span class="lineno"> 3236</span>    warnflag = 0</div>
<div class="line"><span class="lineno"> 3237</span>    <span class="comment"># out of bounds is more urgent than exceeding function evals or iters,</span></div>
<div class="line"><span class="lineno"> 3238</span>    <span class="comment"># but I don&#39;t want to cause inconsistencies by changing the</span></div>
<div class="line"><span class="lineno"> 3239</span>    <span class="comment"># established warning flags for maxfev and maxiter, so the out of bounds</span></div>
<div class="line"><span class="lineno"> 3240</span>    <span class="comment"># warning flag becomes 3, but is checked for first.</span></div>
<div class="line"><span class="lineno"> 3241</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">and</span> (np.any(lower_bound &gt; x) <span class="keywordflow">or</span> np.any(x &gt; upper_bound)):</div>
<div class="line"><span class="lineno"> 3242</span>        warnflag = 4</div>
<div class="line"><span class="lineno"> 3243</span>        msg = _status_message[<span class="stringliteral">&#39;out_of_bounds&#39;</span>]</div>
<div class="line"><span class="lineno"> 3244</span>    <span class="keywordflow">elif</span> fcalls[0] &gt;= maxfun:</div>
<div class="line"><span class="lineno"> 3245</span>        warnflag = 1</div>
<div class="line"><span class="lineno"> 3246</span>        msg = _status_message[<span class="stringliteral">&#39;maxfev&#39;</span>]</div>
<div class="line"><span class="lineno"> 3247</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 3248</span>            warnings.warn(msg, RuntimeWarning, 3)</div>
<div class="line"><span class="lineno"> 3249</span>    <span class="keywordflow">elif</span> iter &gt;= maxiter:</div>
<div class="line"><span class="lineno"> 3250</span>        warnflag = 2</div>
<div class="line"><span class="lineno"> 3251</span>        msg = _status_message[<span class="stringliteral">&#39;maxiter&#39;</span>]</div>
<div class="line"><span class="lineno"> 3252</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 3253</span>            warnings.warn(msg, RuntimeWarning, 3)</div>
<div class="line"><span class="lineno"> 3254</span>    <span class="keywordflow">elif</span> np.isnan(fval) <span class="keywordflow">or</span> np.isnan(x).any():</div>
<div class="line"><span class="lineno"> 3255</span>        warnflag = 3</div>
<div class="line"><span class="lineno"> 3256</span>        msg = _status_message[<span class="stringliteral">&#39;nan&#39;</span>]</div>
<div class="line"><span class="lineno"> 3257</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 3258</span>            warnings.warn(msg, RuntimeWarning, 3)</div>
<div class="line"><span class="lineno"> 3259</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3260</span>        msg = _status_message[<span class="stringliteral">&#39;success&#39;</span>]</div>
<div class="line"><span class="lineno"> 3261</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 3262</span>            print(msg)</div>
<div class="line"><span class="lineno"> 3263</span>            print(<span class="stringliteral">&quot;         Current function value: %f&quot;</span> % fval)</div>
<div class="line"><span class="lineno"> 3264</span>            print(<span class="stringliteral">&quot;         Iterations: %d&quot;</span> % iter)</div>
<div class="line"><span class="lineno"> 3265</span>            print(<span class="stringliteral">&quot;         Function evaluations: %d&quot;</span> % fcalls[0])</div>
<div class="line"><span class="lineno"> 3266</span> </div>
<div class="line"><span class="lineno"> 3267</span>    result = OptimizeResult(fun=fval, direc=direc, nit=iter, nfev=fcalls[0],</div>
<div class="line"><span class="lineno"> 3268</span>                            status=warnflag, success=(warnflag == 0),</div>
<div class="line"><span class="lineno"> 3269</span>                            message=msg, x=x)</div>
<div class="line"><span class="lineno"> 3270</span>    <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 3271</span>        result[<span class="stringliteral">&#39;allvecs&#39;</span>] = allvecs</div>
<div class="line"><span class="lineno"> 3272</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 3273</span> </div>
<div class="line"><span class="lineno"> 3274</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a71ba569fdc9f756b4a622c6fe4ff91da" name="a71ba569fdc9f756b4a622c6fe4ff91da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71ba569fdc9f756b4a622c6fe4ff91da">&#9670;&#160;</a></span>_minimize_scalar_bounded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._minimize_scalar_bounded </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xatol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Options
-------
maxiter : int
    Maximum number of iterations to perform.
disp: int, optional
    If non-zero, print messages.
        0 : no message printing.
        1 : non-convergence notification messages only.
        2 : print a message on convergence too.
        3 : print iteration results.
xatol : float
    Absolute error in solution `xopt` acceptable for convergence.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2071</span>                             **unknown_options):</div>
<div class="line"><span class="lineno"> 2072</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2073</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno"> 2074</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2075</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno"> 2076</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 2077</span><span class="stringliteral">    disp: int, optional</span></div>
<div class="line"><span class="lineno"> 2078</span><span class="stringliteral">        If non-zero, print messages.</span></div>
<div class="line"><span class="lineno"> 2079</span><span class="stringliteral">            0 : no message printing.</span></div>
<div class="line"><span class="lineno"> 2080</span><span class="stringliteral">            1 : non-convergence notification messages only.</span></div>
<div class="line"><span class="lineno"> 2081</span><span class="stringliteral">            2 : print a message on convergence too.</span></div>
<div class="line"><span class="lineno"> 2082</span><span class="stringliteral">            3 : print iteration results.</span></div>
<div class="line"><span class="lineno"> 2083</span><span class="stringliteral">    xatol : float</span></div>
<div class="line"><span class="lineno"> 2084</span><span class="stringliteral">        Absolute error in solution `xopt` acceptable for convergence.</span></div>
<div class="line"><span class="lineno"> 2085</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2086</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2087</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno"> 2088</span>    maxfun = maxiter</div>
<div class="line"><span class="lineno"> 2089</span>    <span class="comment"># Test bounds are of correct form</span></div>
<div class="line"><span class="lineno"> 2090</span>    <span class="keywordflow">if</span> len(bounds) != 2:</div>
<div class="line"><span class="lineno"> 2091</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;bounds must have two elements.&#39;</span>)</div>
<div class="line"><span class="lineno"> 2092</span>    x1, x2 = bounds</div>
<div class="line"><span class="lineno"> 2093</span> </div>
<div class="line"><span class="lineno"> 2094</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (is_array_scalar(x1) <span class="keywordflow">and</span> is_array_scalar(x2)):</div>
<div class="line"><span class="lineno"> 2095</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Optimization bounds must be scalars&quot;</span></div>
<div class="line"><span class="lineno"> 2096</span>                         <span class="stringliteral">&quot; or array scalars.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2097</span>    <span class="keywordflow">if</span> x1 &gt; x2:</div>
<div class="line"><span class="lineno"> 2098</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The lower bound exceeds the upper bound.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2099</span> </div>
<div class="line"><span class="lineno"> 2100</span>    flag = 0</div>
<div class="line"><span class="lineno"> 2101</span>    header = <span class="stringliteral">&#39; Func-count     x          f(x)          Procedure&#39;</span></div>
<div class="line"><span class="lineno"> 2102</span>    step = <span class="stringliteral">&#39;       initial&#39;</span></div>
<div class="line"><span class="lineno"> 2103</span> </div>
<div class="line"><span class="lineno"> 2104</span>    sqrt_eps = sqrt(2.2e-16)</div>
<div class="line"><span class="lineno"> 2105</span>    golden_mean = 0.5 * (3.0 - sqrt(5.0))</div>
<div class="line"><span class="lineno"> 2106</span>    a, b = x1, x2</div>
<div class="line"><span class="lineno"> 2107</span>    fulc = a + golden_mean * (b - a)</div>
<div class="line"><span class="lineno"> 2108</span>    nfc, xf = fulc, fulc</div>
<div class="line"><span class="lineno"> 2109</span>    rat = e = 0.0</div>
<div class="line"><span class="lineno"> 2110</span>    x = xf</div>
<div class="line"><span class="lineno"> 2111</span>    fx = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x, *args)</div>
<div class="line"><span class="lineno"> 2112</span>    num = 1</div>
<div class="line"><span class="lineno"> 2113</span>    fmin_data = (1, xf, fx)</div>
<div class="line"><span class="lineno"> 2114</span>    fu = np.inf</div>
<div class="line"><span class="lineno"> 2115</span> </div>
<div class="line"><span class="lineno"> 2116</span>    ffulc = fnfc = fx</div>
<div class="line"><span class="lineno"> 2117</span>    xm = 0.5 * (a + b)</div>
<div class="line"><span class="lineno"> 2118</span>    tol1 = sqrt_eps * np.abs(xf) + xatol / 3.0</div>
<div class="line"><span class="lineno"> 2119</span>    tol2 = 2.0 * tol1</div>
<div class="line"><span class="lineno"> 2120</span> </div>
<div class="line"><span class="lineno"> 2121</span>    <span class="keywordflow">if</span> disp &gt; 2:</div>
<div class="line"><span class="lineno"> 2122</span>        print(<span class="stringliteral">&quot; &quot;</span>)</div>
<div class="line"><span class="lineno"> 2123</span>        print(header)</div>
<div class="line"><span class="lineno"> 2124</span>        print(<span class="stringliteral">&quot;%5.0f   %12.6g %12.6g %s&quot;</span> % (fmin_data + (step,)))</div>
<div class="line"><span class="lineno"> 2125</span> </div>
<div class="line"><span class="lineno"> 2126</span>    <span class="keywordflow">while</span> (np.abs(xf - xm) &gt; (tol2 - 0.5 * (b - a))):</div>
<div class="line"><span class="lineno"> 2127</span>        golden = 1</div>
<div class="line"><span class="lineno"> 2128</span>        <span class="comment"># Check for parabolic fit</span></div>
<div class="line"><span class="lineno"> 2129</span>        <span class="keywordflow">if</span> np.abs(e) &gt; tol1:</div>
<div class="line"><span class="lineno"> 2130</span>            golden = 0</div>
<div class="line"><span class="lineno"> 2131</span>            r = (xf - nfc) * (fx - ffulc)</div>
<div class="line"><span class="lineno"> 2132</span>            q = (xf - fulc) * (fx - fnfc)</div>
<div class="line"><span class="lineno"> 2133</span>            p = (xf - fulc) * q - (xf - nfc) * r</div>
<div class="line"><span class="lineno"> 2134</span>            q = 2.0 * (q - r)</div>
<div class="line"><span class="lineno"> 2135</span>            <span class="keywordflow">if</span> q &gt; 0.0:</div>
<div class="line"><span class="lineno"> 2136</span>                p = -p</div>
<div class="line"><span class="lineno"> 2137</span>            q = np.abs(q)</div>
<div class="line"><span class="lineno"> 2138</span>            r = e</div>
<div class="line"><span class="lineno"> 2139</span>            e = rat</div>
<div class="line"><span class="lineno"> 2140</span> </div>
<div class="line"><span class="lineno"> 2141</span>            <span class="comment"># Check for acceptability of parabola</span></div>
<div class="line"><span class="lineno"> 2142</span>            <span class="keywordflow">if</span> ((np.abs(p) &lt; np.abs(0.5*q*r)) <span class="keywordflow">and</span> (p &gt; q*(a - xf)) <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno"> 2143</span>                    (p &lt; q * (b - xf))):</div>
<div class="line"><span class="lineno"> 2144</span>                rat = (p + 0.0) / q</div>
<div class="line"><span class="lineno"> 2145</span>                x = xf + rat</div>
<div class="line"><span class="lineno"> 2146</span>                step = <span class="stringliteral">&#39;       parabolic&#39;</span></div>
<div class="line"><span class="lineno"> 2147</span> </div>
<div class="line"><span class="lineno"> 2148</span>                <span class="keywordflow">if</span> ((x - a) &lt; tol2) <span class="keywordflow">or</span> ((b - x) &lt; tol2):</div>
<div class="line"><span class="lineno"> 2149</span>                    si = np.sign(xm - xf) + ((xm - xf) == 0)</div>
<div class="line"><span class="lineno"> 2150</span>                    rat = tol1 * si</div>
<div class="line"><span class="lineno"> 2151</span>            <span class="keywordflow">else</span>:      <span class="comment"># do a golden-section step</span></div>
<div class="line"><span class="lineno"> 2152</span>                golden = 1</div>
<div class="line"><span class="lineno"> 2153</span> </div>
<div class="line"><span class="lineno"> 2154</span>        <span class="keywordflow">if</span> golden:  <span class="comment"># do a golden-section step</span></div>
<div class="line"><span class="lineno"> 2155</span>            <span class="keywordflow">if</span> xf &gt;= xm:</div>
<div class="line"><span class="lineno"> 2156</span>                e = a - xf</div>
<div class="line"><span class="lineno"> 2157</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2158</span>                e = b - xf</div>
<div class="line"><span class="lineno"> 2159</span>            rat = golden_mean*e</div>
<div class="line"><span class="lineno"> 2160</span>            step = <span class="stringliteral">&#39;       golden&#39;</span></div>
<div class="line"><span class="lineno"> 2161</span> </div>
<div class="line"><span class="lineno"> 2162</span>        si = np.sign(rat) + (rat == 0)</div>
<div class="line"><span class="lineno"> 2163</span>        x = xf + si * np.maximum(np.abs(rat), tol1)</div>
<div class="line"><span class="lineno"> 2164</span>        fu = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x, *args)</div>
<div class="line"><span class="lineno"> 2165</span>        num += 1</div>
<div class="line"><span class="lineno"> 2166</span>        fmin_data = (num, x, fu)</div>
<div class="line"><span class="lineno"> 2167</span>        <span class="keywordflow">if</span> disp &gt; 2:</div>
<div class="line"><span class="lineno"> 2168</span>            print(<span class="stringliteral">&quot;%5.0f   %12.6g %12.6g %s&quot;</span> % (fmin_data + (step,)))</div>
<div class="line"><span class="lineno"> 2169</span> </div>
<div class="line"><span class="lineno"> 2170</span>        <span class="keywordflow">if</span> fu &lt;= fx:</div>
<div class="line"><span class="lineno"> 2171</span>            <span class="keywordflow">if</span> x &gt;= xf:</div>
<div class="line"><span class="lineno"> 2172</span>                a = xf</div>
<div class="line"><span class="lineno"> 2173</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2174</span>                b = xf</div>
<div class="line"><span class="lineno"> 2175</span>            fulc, ffulc = nfc, fnfc</div>
<div class="line"><span class="lineno"> 2176</span>            nfc, fnfc = xf, fx</div>
<div class="line"><span class="lineno"> 2177</span>            xf, fx = x, fu</div>
<div class="line"><span class="lineno"> 2178</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2179</span>            <span class="keywordflow">if</span> x &lt; xf:</div>
<div class="line"><span class="lineno"> 2180</span>                a = x</div>
<div class="line"><span class="lineno"> 2181</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2182</span>                b = x</div>
<div class="line"><span class="lineno"> 2183</span>            <span class="keywordflow">if</span> (fu &lt;= fnfc) <span class="keywordflow">or</span> (nfc == xf):</div>
<div class="line"><span class="lineno"> 2184</span>                fulc, ffulc = nfc, fnfc</div>
<div class="line"><span class="lineno"> 2185</span>                nfc, fnfc = x, fu</div>
<div class="line"><span class="lineno"> 2186</span>            <span class="keywordflow">elif</span> (fu &lt;= ffulc) <span class="keywordflow">or</span> (fulc == xf) <span class="keywordflow">or</span> (fulc == nfc):</div>
<div class="line"><span class="lineno"> 2187</span>                fulc, ffulc = x, fu</div>
<div class="line"><span class="lineno"> 2188</span> </div>
<div class="line"><span class="lineno"> 2189</span>        xm = 0.5 * (a + b)</div>
<div class="line"><span class="lineno"> 2190</span>        tol1 = sqrt_eps * np.abs(xf) + xatol / 3.0</div>
<div class="line"><span class="lineno"> 2191</span>        tol2 = 2.0 * tol1</div>
<div class="line"><span class="lineno"> 2192</span> </div>
<div class="line"><span class="lineno"> 2193</span>        <span class="keywordflow">if</span> num &gt;= maxfun:</div>
<div class="line"><span class="lineno"> 2194</span>            flag = 1</div>
<div class="line"><span class="lineno"> 2195</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 2196</span> </div>
<div class="line"><span class="lineno"> 2197</span>    <span class="keywordflow">if</span> np.isnan(xf) <span class="keywordflow">or</span> np.isnan(fx) <span class="keywordflow">or</span> np.isnan(fu):</div>
<div class="line"><span class="lineno"> 2198</span>        flag = 2</div>
<div class="line"><span class="lineno"> 2199</span> </div>
<div class="line"><span class="lineno"> 2200</span>    fval = fx</div>
<div class="line"><span class="lineno"> 2201</span>    <span class="keywordflow">if</span> disp &gt; 0:</div>
<div class="line"><span class="lineno"> 2202</span>        _endprint(x, flag, fval, maxfun, xatol, disp)</div>
<div class="line"><span class="lineno"> 2203</span> </div>
<div class="line"><span class="lineno"> 2204</span>    result = OptimizeResult(fun=fval, status=flag, success=(flag == 0),</div>
<div class="line"><span class="lineno"> 2205</span>                            message={0: <span class="stringliteral">&#39;Solution found.&#39;</span>,</div>
<div class="line"><span class="lineno"> 2206</span>                                     1: <span class="stringliteral">&#39;Maximum number of function calls &#39;</span></div>
<div class="line"><span class="lineno"> 2207</span>                                        <span class="stringliteral">&#39;reached.&#39;</span>,</div>
<div class="line"><span class="lineno"> 2208</span>                                     2: _status_message[<span class="stringliteral">&#39;nan&#39;</span>]}.get(flag, <span class="stringliteral">&#39;&#39;</span>),</div>
<div class="line"><span class="lineno"> 2209</span>                            x=xf, nfev=num, nit=num)</div>
<div class="line"><span class="lineno"> 2210</span> </div>
<div class="line"><span class="lineno"> 2211</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 2212</span> </div>
<div class="line"><span class="lineno"> 2213</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a97defae4d0b5c95d200370a81f9eebe7" name="a97defae4d0b5c95d200370a81f9eebe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97defae4d0b5c95d200370a81f9eebe7">&#9670;&#160;</a></span>_minimize_scalar_brent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._minimize_scalar_brent </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brack</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1.48e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Options
-------
maxiter : int
    Maximum number of iterations to perform.
xtol : float
    Relative error in solution `xopt` acceptable for convergence.
disp: int, optional
    If non-zero, print messages.
        0 : no message printing.
        1 : non-convergence notification messages only.
        2 : print a message on convergence too.
        3 : print iteration results.
Notes
-----
Uses inverse parabolic interpolation when possible to speed up
convergence of golden section method.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2470</span>                           **unknown_options):</div>
<div class="line"><span class="lineno"> 2471</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2472</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno"> 2473</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2474</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno"> 2475</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 2476</span><span class="stringliteral">    xtol : float</span></div>
<div class="line"><span class="lineno"> 2477</span><span class="stringliteral">        Relative error in solution `xopt` acceptable for convergence.</span></div>
<div class="line"><span class="lineno"> 2478</span><span class="stringliteral">    disp: int, optional</span></div>
<div class="line"><span class="lineno"> 2479</span><span class="stringliteral">        If non-zero, print messages.</span></div>
<div class="line"><span class="lineno"> 2480</span><span class="stringliteral">            0 : no message printing.</span></div>
<div class="line"><span class="lineno"> 2481</span><span class="stringliteral">            1 : non-convergence notification messages only.</span></div>
<div class="line"><span class="lineno"> 2482</span><span class="stringliteral">            2 : print a message on convergence too.</span></div>
<div class="line"><span class="lineno"> 2483</span><span class="stringliteral">            3 : print iteration results.</span></div>
<div class="line"><span class="lineno"> 2484</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2485</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2486</span><span class="stringliteral">    Uses inverse parabolic interpolation when possible to speed up</span></div>
<div class="line"><span class="lineno"> 2487</span><span class="stringliteral">    convergence of golden section method.</span></div>
<div class="line"><span class="lineno"> 2488</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2489</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2490</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno"> 2491</span>    tol = xtol</div>
<div class="line"><span class="lineno"> 2492</span>    <span class="keywordflow">if</span> tol &lt; 0:</div>
<div class="line"><span class="lineno"> 2493</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;tolerance should be &gt;= 0, got %r&#39;</span> % tol)</div>
<div class="line"><span class="lineno"> 2494</span> </div>
<div class="line"><span class="lineno"> 2495</span>    brent = Brent(func=func, args=args, tol=tol,</div>
<div class="line"><span class="lineno"> 2496</span>                  full_output=<span class="keyword">True</span>, maxiter=maxiter, disp=disp)</div>
<div class="line"><span class="lineno"> 2497</span>    brent.set_bracket(brack)</div>
<div class="line"><span class="lineno"> 2498</span>    brent.optimize()</div>
<div class="line"><span class="lineno"> 2499</span>    x, fval, nit, nfev = brent.get_result(full_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2500</span> </div>
<div class="line"><span class="lineno"> 2501</span>    success = nit &lt; maxiter <span class="keywordflow">and</span> <span class="keywordflow">not</span> (np.isnan(x) <span class="keywordflow">or</span> np.isnan(fval))</div>
<div class="line"><span class="lineno"> 2502</span> </div>
<div class="line"><span class="lineno"> 2503</span>    <span class="keywordflow">if</span> success:</div>
<div class="line"><span class="lineno"> 2504</span>        message = (<span class="stringliteral">&quot;\nOptimization terminated successfully;\n&quot;</span></div>
<div class="line"><span class="lineno"> 2505</span>                   <span class="stringliteral">&quot;The returned value satisfies the termination criteria\n&quot;</span></div>
<div class="line"><span class="lineno"> 2506</span>                   f<span class="stringliteral">&quot;(using xtol = {xtol} )&quot;</span>)</div>
<div class="line"><span class="lineno"> 2507</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2508</span>        <span class="keywordflow">if</span> nit &gt;= maxiter:</div>
<div class="line"><span class="lineno"> 2509</span>            message = <span class="stringliteral">&quot;\nMaximum number of iterations exceeded&quot;</span></div>
<div class="line"><span class="lineno"> 2510</span>        <span class="keywordflow">if</span> np.isnan(x) <span class="keywordflow">or</span> np.isnan(fval):</div>
<div class="line"><span class="lineno"> 2511</span>            message = f<span class="stringliteral">&quot;{_status_message[&#39;nan&#39;]}&quot;</span></div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>    <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 2514</span>        print(message)</div>
<div class="line"><span class="lineno"> 2515</span> </div>
<div class="line"><span class="lineno"> 2516</span>    <span class="keywordflow">return</span> OptimizeResult(fun=fval, x=x, nit=nit, nfev=nfev,</div>
<div class="line"><span class="lineno"> 2517</span>                          success=success, message=message)</div>
<div class="line"><span class="lineno"> 2518</span> </div>
<div class="line"><span class="lineno"> 2519</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a49ead78bfe447477b882bebc0daf62f6" name="a49ead78bfe447477b882bebc0daf62f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49ead78bfe447477b882bebc0daf62f6">&#9670;&#160;</a></span>_minimize_scalar_golden()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._minimize_scalar_golden </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brack</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>5000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Options
-------
xtol : float
    Relative error in solution `xopt` acceptable for convergence.
maxiter : int
    Maximum number of iterations to perform.
disp: int, optional
    If non-zero, print messages.
        0 : no message printing.
        1 : non-convergence notification messages only.
        2 : print a message on convergence too.
        3 : print iteration results.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2589</span>                            **unknown_options):</div>
<div class="line"><span class="lineno"> 2590</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2591</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno"> 2592</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2593</span><span class="stringliteral">    xtol : float</span></div>
<div class="line"><span class="lineno"> 2594</span><span class="stringliteral">        Relative error in solution `xopt` acceptable for convergence.</span></div>
<div class="line"><span class="lineno"> 2595</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno"> 2596</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 2597</span><span class="stringliteral">    disp: int, optional</span></div>
<div class="line"><span class="lineno"> 2598</span><span class="stringliteral">        If non-zero, print messages.</span></div>
<div class="line"><span class="lineno"> 2599</span><span class="stringliteral">            0 : no message printing.</span></div>
<div class="line"><span class="lineno"> 2600</span><span class="stringliteral">            1 : non-convergence notification messages only.</span></div>
<div class="line"><span class="lineno"> 2601</span><span class="stringliteral">            2 : print a message on convergence too.</span></div>
<div class="line"><span class="lineno"> 2602</span><span class="stringliteral">            3 : print iteration results.</span></div>
<div class="line"><span class="lineno"> 2603</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2604</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno"> 2605</span>    tol = xtol</div>
<div class="line"><span class="lineno"> 2606</span>    <span class="keywordflow">if</span> brack <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2607</span>        xa, xb, xc, fa, fb, fc, funcalls = bracket(func, args=args)</div>
<div class="line"><span class="lineno"> 2608</span>    <span class="keywordflow">elif</span> len(brack) == 2:</div>
<div class="line"><span class="lineno"> 2609</span>        xa, xb, xc, fa, fb, fc, funcalls = bracket(func, xa=brack[0],</div>
<div class="line"><span class="lineno"> 2610</span>                                                   xb=brack[1], args=args)</div>
<div class="line"><span class="lineno"> 2611</span>    <span class="keywordflow">elif</span> len(brack) == 3:</div>
<div class="line"><span class="lineno"> 2612</span>        xa, xb, xc = brack</div>
<div class="line"><span class="lineno"> 2613</span>        <span class="keywordflow">if</span> (xa &gt; xc):  <span class="comment"># swap so xa &lt; xc can be assumed</span></div>
<div class="line"><span class="lineno"> 2614</span>            xc, xa = xa, xc</div>
<div class="line"><span class="lineno"> 2615</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> ((xa &lt; xb) <span class="keywordflow">and</span> (xb &lt; xc)):</div>
<div class="line"><span class="lineno"> 2616</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Not a bracketing interval.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2617</span>        fa = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((xa,) + args))</div>
<div class="line"><span class="lineno"> 2618</span>        fb = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((xb,) + args))</div>
<div class="line"><span class="lineno"> 2619</span>        fc = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((xc,) + args))</div>
<div class="line"><span class="lineno"> 2620</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> ((fb &lt; fa) <span class="keywordflow">and</span> (fb &lt; fc)):</div>
<div class="line"><span class="lineno"> 2621</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Not a bracketing interval.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2622</span>        funcalls = 3</div>
<div class="line"><span class="lineno"> 2623</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2624</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Bracketing interval must be length 2 or 3 sequence.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span>    _gR = 0.61803399  <span class="comment"># golden ratio conjugate: 2.0/(1.0+sqrt(5.0))</span></div>
<div class="line"><span class="lineno"> 2627</span>    _gC = 1.0 - _gR</div>
<div class="line"><span class="lineno"> 2628</span>    x3 = xc</div>
<div class="line"><span class="lineno"> 2629</span>    x0 = xa</div>
<div class="line"><span class="lineno"> 2630</span>    <span class="keywordflow">if</span> (np.abs(xc - xb) &gt; np.abs(xb - xa)):</div>
<div class="line"><span class="lineno"> 2631</span>        x1 = xb</div>
<div class="line"><span class="lineno"> 2632</span>        x2 = xb + _gC * (xc - xb)</div>
<div class="line"><span class="lineno"> 2633</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2634</span>        x2 = xb</div>
<div class="line"><span class="lineno"> 2635</span>        x1 = xb - _gC * (xb - xa)</div>
<div class="line"><span class="lineno"> 2636</span>    f1 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((x1,) + args))</div>
<div class="line"><span class="lineno"> 2637</span>    f2 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((x2,) + args))</div>
<div class="line"><span class="lineno"> 2638</span>    funcalls += 2</div>
<div class="line"><span class="lineno"> 2639</span>    nit = 0</div>
<div class="line"><span class="lineno"> 2640</span> </div>
<div class="line"><span class="lineno"> 2641</span>    <span class="keywordflow">if</span> disp &gt; 2:</div>
<div class="line"><span class="lineno"> 2642</span>        print(<span class="stringliteral">&quot; &quot;</span>)</div>
<div class="line"><span class="lineno"> 2643</span>        print(f<span class="stringliteral">&quot;{&#39;Func-count&#39;:^12} {&#39;x&#39;:^12} {&#39;f(x)&#39;: ^12}&quot;</span>)</div>
<div class="line"><span class="lineno"> 2644</span> </div>
<div class="line"><span class="lineno"> 2645</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(maxiter):</div>
<div class="line"><span class="lineno"> 2646</span>        <span class="keywordflow">if</span> np.abs(x3 - x0) &lt;= tol * (np.abs(x1) + np.abs(x2)):</div>
<div class="line"><span class="lineno"> 2647</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 2648</span>        <span class="keywordflow">if</span> (f2 &lt; f1):</div>
<div class="line"><span class="lineno"> 2649</span>            x0 = x1</div>
<div class="line"><span class="lineno"> 2650</span>            x1 = x2</div>
<div class="line"><span class="lineno"> 2651</span>            x2 = _gR * x1 + _gC * x3</div>
<div class="line"><span class="lineno"> 2652</span>            f1 = f2</div>
<div class="line"><span class="lineno"> 2653</span>            f2 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((x2,) + args))</div>
<div class="line"><span class="lineno"> 2654</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2655</span>            x3 = x2</div>
<div class="line"><span class="lineno"> 2656</span>            x2 = x1</div>
<div class="line"><span class="lineno"> 2657</span>            x1 = _gR * x2 + _gC * x0</div>
<div class="line"><span class="lineno"> 2658</span>            f2 = f1</div>
<div class="line"><span class="lineno"> 2659</span>            f1 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((x1,) + args))</div>
<div class="line"><span class="lineno"> 2660</span>        funcalls += 1</div>
<div class="line"><span class="lineno"> 2661</span>        <span class="keywordflow">if</span> disp &gt; 2:</div>
<div class="line"><span class="lineno"> 2662</span>            <span class="keywordflow">if</span> (f1 &lt; f2):</div>
<div class="line"><span class="lineno"> 2663</span>                xmin, fval = x1, f1</div>
<div class="line"><span class="lineno"> 2664</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2665</span>                xmin, fval = x2, f2</div>
<div class="line"><span class="lineno"> 2666</span>            print(f<span class="stringliteral">&quot;{funcalls:^12g} {xmin:^12.6g} {fval:^12.6g}&quot;</span>)</div>
<div class="line"><span class="lineno"> 2667</span> </div>
<div class="line"><span class="lineno"> 2668</span>        nit += 1</div>
<div class="line"><span class="lineno"> 2669</span>    <span class="comment"># end of iteration loop</span></div>
<div class="line"><span class="lineno"> 2670</span> </div>
<div class="line"><span class="lineno"> 2671</span>    <span class="keywordflow">if</span> (f1 &lt; f2):</div>
<div class="line"><span class="lineno"> 2672</span>        xmin = x1</div>
<div class="line"><span class="lineno"> 2673</span>        fval = f1</div>
<div class="line"><span class="lineno"> 2674</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2675</span>        xmin = x2</div>
<div class="line"><span class="lineno"> 2676</span>        fval = f2</div>
<div class="line"><span class="lineno"> 2677</span> </div>
<div class="line"><span class="lineno"> 2678</span>    success = nit &lt; maxiter <span class="keywordflow">and</span> <span class="keywordflow">not</span> (np.isnan(fval) <span class="keywordflow">or</span> np.isnan(xmin))</div>
<div class="line"><span class="lineno"> 2679</span> </div>
<div class="line"><span class="lineno"> 2680</span>    <span class="keywordflow">if</span> success:</div>
<div class="line"><span class="lineno"> 2681</span>        message = (<span class="stringliteral">&quot;\nOptimization terminated successfully;\n&quot;</span></div>
<div class="line"><span class="lineno"> 2682</span>                   <span class="stringliteral">&quot;The returned value satisfies the termination criteria\n&quot;</span></div>
<div class="line"><span class="lineno"> 2683</span>                   f<span class="stringliteral">&quot;(using xtol = {xtol} )&quot;</span>)</div>
<div class="line"><span class="lineno"> 2684</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2685</span>        <span class="keywordflow">if</span> nit &gt;= maxiter:</div>
<div class="line"><span class="lineno"> 2686</span>            message = <span class="stringliteral">&quot;\nMaximum number of iterations exceeded&quot;</span></div>
<div class="line"><span class="lineno"> 2687</span>        <span class="keywordflow">if</span> np.isnan(xmin) <span class="keywordflow">or</span> np.isnan(fval):</div>
<div class="line"><span class="lineno"> 2688</span>            message = f<span class="stringliteral">&quot;{_status_message[&#39;nan&#39;]}&quot;</span></div>
<div class="line"><span class="lineno"> 2689</span> </div>
<div class="line"><span class="lineno"> 2690</span>    <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 2691</span>        print(message)</div>
<div class="line"><span class="lineno"> 2692</span> </div>
<div class="line"><span class="lineno"> 2693</span>    <span class="keywordflow">return</span> OptimizeResult(fun=fval, nfev=funcalls, x=xmin, nit=nit,</div>
<div class="line"><span class="lineno"> 2694</span>                          success=success, message=message)</div>
<div class="line"><span class="lineno"> 2695</span> </div>
<div class="line"><span class="lineno"> 2696</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad73454f855569a9ca1a9979e3d9b7a0a" name="ad73454f855569a9ca1a9979e3d9b7a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73454f855569a9ca1a9979e3d9b7a0a">&#9670;&#160;</a></span>_prepare_scalar_function()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._prepare_scalar_function </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>finite_diff_rel_step</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hess</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Creates a ScalarFunction object for use with scalar minimizers
(BFGS/LBFGSB/SLSQP/TNC/CG/etc).

Parameters
----------
fun : callable
    The objective function to be minimized.

        ``fun(x, *args) -&gt; float``

    where ``x`` is an 1-D array with shape (n,) and ``args``
    is a tuple of the fixed parameters needed to completely
    specify the function.
x0 : ndarray, shape (n,)
    Initial guess. Array of real elements of size (n,),
    where 'n' is the number of independent variables.
jac : {callable,  '2-point', '3-point', 'cs', None}, optional
    Method for computing the gradient vector. If it is a callable, it
    should be a function that returns the gradient vector:

        ``jac(x, *args) -&gt; array_like, shape (n,)``

    If one of `{'2-point', '3-point', 'cs'}` is selected then the gradient
    is calculated with a relative step for finite differences. If `None`,
    then two-point finite differences with an absolute step is used.
args : tuple, optional
    Extra arguments passed to the objective function and its
    derivatives (`fun`, `jac` functions).
bounds : sequence, optional
    Bounds on variables. 'new-style' bounds are required.
eps : float or ndarray
    If `jac is None` the absolute step size used for numerical
    approximation of the jacobian via forward differences.
finite_diff_rel_step : None or array_like, optional
    If `jac in ['2-point', '3-point', 'cs']` the relative step size to
    use for numerical approximation of the jacobian. The absolute step
    size is computed as ``h = rel_step * sign(x0) * max(1, abs(x0))``,
    possibly adjusted to fit into the bounds. For ``method='3-point'``
    the sign of `h` is ignored. If None (default) then step is selected
    automatically.
hess : {callable,  '2-point', '3-point', 'cs', None}
    Computes the Hessian matrix. If it is callable, it should return the
    Hessian matrix:

        ``hess(x, *args) -&gt; {LinearOperator, spmatrix, array}, (n, n)``

    Alternatively, the keywords {'2-point', '3-point', 'cs'} select a
    finite difference scheme for numerical estimation.
    Whenever the gradient is estimated via finite-differences, the Hessian
    cannot be estimated with options {'2-point', '3-point', 'cs'} and needs
    to be estimated using one of the quasi-Newton strategies.

Returns
-------
sf : ScalarFunction
</pre> <div class="fragment"><div class="line"><span class="lineno">  177</span>                             hess=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  178</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">    Creates a ScalarFunction object for use with scalar minimizers</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    (BFGS/LBFGSB/SLSQP/TNC/CG/etc).</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    fun : callable</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">        The objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">            ``fun(x, *args) -&gt; float``</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">        where ``x`` is an 1-D array with shape (n,) and ``args``</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">        is a tuple of the fixed parameters needed to completely</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">        specify the function.</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">    x0 : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">        Initial guess. Array of real elements of size (n,),</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">        where &#39;n&#39; is the number of independent variables.</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    jac : {callable,  &#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;, None}, optional</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">        Method for computing the gradient vector. If it is a callable, it</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">        should be a function that returns the gradient vector:</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">            ``jac(x, *args) -&gt; array_like, shape (n,)``</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">        If one of `{&#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;}` is selected then the gradient</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">        is calculated with a relative step for finite differences. If `None`,</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">        then two-point finite differences with an absolute step is used.</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">        Extra arguments passed to the objective function and its</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">        derivatives (`fun`, `jac` functions).</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    bounds : sequence, optional</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">        Bounds on variables. &#39;new-style&#39; bounds are required.</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    eps : float or ndarray</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">        If `jac is None` the absolute step size used for numerical</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">        approximation of the jacobian via forward differences.</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    finite_diff_rel_step : None or array_like, optional</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">        If `jac in [&#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;]` the relative step size to</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">        use for numerical approximation of the jacobian. The absolute step</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">        size is computed as ``h = rel_step * sign(x0) * max(1, abs(x0))``,</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">        possibly adjusted to fit into the bounds. For ``method=&#39;3-point&#39;``</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">        the sign of `h` is ignored. If None (default) then step is selected</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">        automatically.</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    hess : {callable,  &#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;, None}</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">        Computes the Hessian matrix. If it is callable, it should return the</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">        Hessian matrix:</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">            ``hess(x, *args) -&gt; {LinearOperator, spmatrix, array}, (n, n)``</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">        Alternatively, the keywords {&#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;} select a</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">        finite difference scheme for numerical estimation.</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">        Whenever the gradient is estimated via finite-differences, the Hessian</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">        cannot be estimated with options {&#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;} and needs</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">        to be estimated using one of the quasi-Newton strategies.</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    sf : ScalarFunction</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> callable(jac):</div>
<div class="line"><span class="lineno">  236</span>        grad = jac</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">elif</span> jac <span class="keywordflow">in</span> FD_METHODS:</div>
<div class="line"><span class="lineno">  238</span>        <span class="comment"># epsilon is set to None so that ScalarFunction is made to use</span></div>
<div class="line"><span class="lineno">  239</span>        <span class="comment"># rel_step</span></div>
<div class="line"><span class="lineno">  240</span>        epsilon = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  241</span>        grad = jac</div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  243</span>        <span class="comment"># default (jac is None) is to do 2-point finite differences with</span></div>
<div class="line"><span class="lineno">  244</span>        <span class="comment"># absolute step size. ScalarFunction has to be provided an</span></div>
<div class="line"><span class="lineno">  245</span>        <span class="comment"># epsilon value that is not None to use absolute steps. This is</span></div>
<div class="line"><span class="lineno">  246</span>        <span class="comment"># normally the case from most _minimize* methods.</span></div>
<div class="line"><span class="lineno">  247</span>        grad = <span class="stringliteral">&#39;2-point&#39;</span></div>
<div class="line"><span class="lineno">  248</span>        epsilon = epsilon</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordflow">if</span> hess <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  251</span>        <span class="comment"># ScalarFunction requires something for hess, so we give a dummy</span></div>
<div class="line"><span class="lineno">  252</span>        <span class="comment"># implementation here if nothing is provided, return a value of None</span></div>
<div class="line"><span class="lineno">  253</span>        <span class="comment"># so that downstream minimisers halt. The results of `fun.hess`</span></div>
<div class="line"><span class="lineno">  254</span>        <span class="comment"># should not be used.</span></div>
<div class="line"><span class="lineno">  255</span>        <span class="keyword">def </span>hess(x, *args):</div>
<div class="line"><span class="lineno">  256</span>            <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  259</span>        bounds = (-np.inf, np.inf)</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    <span class="comment"># ScalarFunction caches. Reuse of fun(x) during grad</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="comment"># calculation reduces overall function evaluations.</span></div>
<div class="line"><span class="lineno">  263</span>    sf = ScalarFunction(fun, x0, args, grad, hess,</div>
<div class="line"><span class="lineno">  264</span>                        finite_diff_rel_step, bounds, epsilon=epsilon)</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">return</span> sf</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0289ea1f45541e56b527dc7817c88bbd" name="a0289ea1f45541e56b527dc7817c88bbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0289ea1f45541e56b527dc7817c88bbd">&#9670;&#160;</a></span>_wrap_scalar_function()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._wrap_scalar_function </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  456</span><span class="keyword">def </span>_wrap_scalar_function(function, args):</div>
<div class="line"><span class="lineno">  457</span>    <span class="comment"># wraps a minimizer function to count number of evaluations</span></div>
<div class="line"><span class="lineno">  458</span>    <span class="comment"># and to easily provide an args kwd.</span></div>
<div class="line"><span class="lineno">  459</span>    ncalls = [0]</div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">if</span> function <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  461</span>        <span class="keywordflow">return</span> ncalls, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="keyword">def </span>function_wrapper(x, *wrapper_args):</div>
<div class="line"><span class="lineno">  464</span>        ncalls[0] += 1</div>
<div class="line"><span class="lineno">  465</span>        <span class="comment"># A copy of x is sent to the user function (gh13740)</span></div>
<div class="line"><span class="lineno">  466</span>        fx = function(np.copy(x), *(wrapper_args + args))</div>
<div class="line"><span class="lineno">  467</span>        <span class="comment"># Ideally, we&#39;d like to a have a true scalar returned from f(x). For</span></div>
<div class="line"><span class="lineno">  468</span>        <span class="comment"># backwards-compatibility, also allow np.array([1.3]), np.array([[1.3]]) etc.</span></div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isscalar(fx):</div>
<div class="line"><span class="lineno">  470</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  471</span>                fx = np.asarray(fx).item()</div>
<div class="line"><span class="lineno">  472</span>            <span class="keywordflow">except</span> (TypeError, ValueError) <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  473</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The user-provided objective function &quot;</span></div>
<div class="line"><span class="lineno">  474</span>                                 <span class="stringliteral">&quot;must return a scalar value.&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  475</span>        <span class="keywordflow">return</span> fx</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">return</span> ncalls, function_wrapper</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abf807e331a381a821ee49e99e63f6578" name="abf807e331a381a821ee49e99e63f6578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf807e331a381a821ee49e99e63f6578">&#9670;&#160;</a></span>_wrap_scalar_function_maxfun_validation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._wrap_scalar_function_maxfun_validation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  484</span><span class="keyword">def </span>_wrap_scalar_function_maxfun_validation(function, args, maxfun):</div>
<div class="line"><span class="lineno">  485</span>    <span class="comment"># wraps a minimizer function to count number of evaluations</span></div>
<div class="line"><span class="lineno">  486</span>    <span class="comment"># and to easily provide an args kwd.</span></div>
<div class="line"><span class="lineno">  487</span>    ncalls = [0]</div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordflow">if</span> function <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">return</span> ncalls, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    <span class="keyword">def </span>function_wrapper(x, *wrapper_args):</div>
<div class="line"><span class="lineno">  492</span>        <span class="keywordflow">if</span> ncalls[0] &gt;= maxfun:</div>
<div class="line"><span class="lineno">  493</span>            <span class="keywordflow">raise</span> _MaxFuncCallError(<span class="stringliteral">&quot;Too many function calls&quot;</span>)</div>
<div class="line"><span class="lineno">  494</span>        ncalls[0] += 1</div>
<div class="line"><span class="lineno">  495</span>        <span class="comment"># A copy of x is sent to the user function (gh13740)</span></div>
<div class="line"><span class="lineno">  496</span>        fx = function(np.copy(x), *(wrapper_args + args))</div>
<div class="line"><span class="lineno">  497</span>        <span class="comment"># Ideally, we&#39;d like to a have a true scalar returned from f(x). For</span></div>
<div class="line"><span class="lineno">  498</span>        <span class="comment"># backwards-compatibility, also allow np.array([1.3]),</span></div>
<div class="line"><span class="lineno">  499</span>        <span class="comment"># np.array([[1.3]]) etc.</span></div>
<div class="line"><span class="lineno">  500</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isscalar(fx):</div>
<div class="line"><span class="lineno">  501</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  502</span>                fx = np.asarray(fx).item()</div>
<div class="line"><span class="lineno">  503</span>            <span class="keywordflow">except</span> (TypeError, ValueError) <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  504</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The user-provided objective function &quot;</span></div>
<div class="line"><span class="lineno">  505</span>                                 <span class="stringliteral">&quot;must return a scalar value.&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  506</span>        <span class="keywordflow">return</span> fx</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>    <span class="keywordflow">return</span> ncalls, function_wrapper</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a11dbfcc1981be014e18da16c4f1b7545" name="a11dbfcc1981be014e18da16c4f1b7545"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11dbfcc1981be014e18da16c4f1b7545">&#9670;&#160;</a></span>approx_fhess_p()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.approx_fhess_p </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fprime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1060</span><span class="keyword">def </span>approx_fhess_p(x0, p, fprime, epsilon, *args):</div>
<div class="line"><span class="lineno"> 1061</span>    <span class="comment"># calculate fprime(x0) first, as this may be cached by ScalarFunction</span></div>
<div class="line"><span class="lineno"> 1062</span>    f1 = fprime(*((x0,) + args))</div>
<div class="line"><span class="lineno"> 1063</span>    f2 = fprime(*((x0 + epsilon*p,) + args))</div>
<div class="line"><span class="lineno"> 1064</span>    <span class="keywordflow">return</span> (f2 - f1) / epsilon</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1bdcfcf9601a38ca22629dc3d93ef39" name="ab1bdcfcf9601a38ca22629dc3d93ef39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1bdcfcf9601a38ca22629dc3d93ef39">&#9670;&#160;</a></span>approx_fprime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.approx_fprime </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Finite difference approximation of the derivatives of a
scalar or vector-valued function.

If a function maps from :math:`R^n` to :math:`R^m`, its derivatives form
an m-by-n matrix
called the Jacobian, where an element :math:`(i, j)` is a partial
derivative of f[i] with respect to ``xk[j]``.

Parameters
----------
xk : array_like
    The coordinate vector at which to determine the gradient of `f`.
f : callable
    Function of which to estimate the derivatives of. Has the signature
    ``f(xk, *args)`` where `xk` is the argument in the form of a 1-D array
    and `args` is a tuple of any additional fixed parameters needed to
    completely specify the function. The argument `xk` passed to this
    function is an ndarray of shape (n,) (never a scalar even if n=1).
    It must return a 1-D array_like of shape (m,) or a scalar.

    .. versionchanged:: 1.9.0
        `f` is now able to return a 1-D array-like, with the :math:`(m, n)`
        Jacobian being estimated.

epsilon : {float, array_like}, optional
    Increment to `xk` to use for determining the function gradient.
    If a scalar, uses the same finite difference delta for all partial
    derivatives. If an array, should contain one value per element of
    `xk`. Defaults to ``sqrt(np.finfo(float).eps)``, which is approximately
    1.49e-08.
\\*args : args, optional
    Any other arguments that are to be passed to `f`.

Returns
-------
jac : ndarray
    The partial derivatives of `f` to `xk`.

See Also
--------
check_grad : Check correctness of gradient function against approx_fprime.

Notes
-----
The function gradient is determined by the forward finite difference
formula::

             f(xk[i] + epsilon[i]) - f(xk[i])
    f'[i] = ---------------------------------
                        epsilon[i]

Examples
--------
&gt;&gt;&gt; from scipy import optimize
&gt;&gt;&gt; def func(x, c0, c1):
...     "Coordinate vector `x` should be an array of size two."
...     return c0 * x[0]**2 + c1*x[1]**2

&gt;&gt;&gt; x = np.ones(2)
&gt;&gt;&gt; c0, c1 = (1, 200)
&gt;&gt;&gt; eps = np.sqrt(np.finfo(float).eps)
&gt;&gt;&gt; optimize.approx_fprime(x, func, [eps, np.sqrt(200) * eps], c0, c1)
array([   2.        ,  400.00004198])</pre> <div class="fragment"><div class="line"><span class="lineno">  891</span><span class="keyword">def </span>approx_fprime(xk, f, epsilon=_epsilon, *args):</div>
<div class="line"><span class="lineno">  892</span>    <span class="stringliteral">&quot;&quot;&quot;Finite difference approximation of the derivatives of a</span></div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">    scalar or vector-valued function.</span></div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">    If a function maps from :math:`R^n` to :math:`R^m`, its derivatives form</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral">    an m-by-n matrix</span></div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">    called the Jacobian, where an element :math:`(i, j)` is a partial</span></div>
<div class="line"><span class="lineno">  898</span><span class="stringliteral">    derivative of f[i] with respect to ``xk[j]``.</span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">    xk : array_like</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral">        The coordinate vector at which to determine the gradient of `f`.</span></div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">    f : callable</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral">        Function of which to estimate the derivatives of. Has the signature</span></div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">        ``f(xk, *args)`` where `xk` is the argument in the form of a 1-D array</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">        and `args` is a tuple of any additional fixed parameters needed to</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">        completely specify the function. The argument `xk` passed to this</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral">        function is an ndarray of shape (n,) (never a scalar even if n=1).</span></div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">        It must return a 1-D array_like of shape (m,) or a scalar.</span></div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">        .. versionchanged:: 1.9.0</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral">            `f` is now able to return a 1-D array-like, with the :math:`(m, n)`</span></div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">            Jacobian being estimated.</span></div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral">    epsilon : {float, array_like}, optional</span></div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">        Increment to `xk` to use for determining the function gradient.</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">        If a scalar, uses the same finite difference delta for all partial</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">        derivatives. If an array, should contain one value per element of</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral">        `xk`. Defaults to ``sqrt(np.finfo(float).eps)``, which is approximately</span></div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral">        1.49e-08.</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">    \\*args : args, optional</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral">        Any other arguments that are to be passed to `f`.</span></div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">    jac : ndarray</span></div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral">        The partial derivatives of `f` to `xk`.</span></div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral">    check_grad : Check correctness of gradient function against approx_fprime.</span></div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">    The function gradient is determined by the forward finite difference</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">    formula::</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">                 f(xk[i] + epsilon[i]) - f(xk[i])</span></div>
<div class="line"><span class="lineno">  940</span><span class="stringliteral">        f&#39;[i] = ---------------------------------</span></div>
<div class="line"><span class="lineno">  941</span><span class="stringliteral">                            epsilon[i]</span></div>
<div class="line"><span class="lineno">  942</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  943</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  944</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  945</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno">  946</span><span class="stringliteral">    &gt;&gt;&gt; def func(x, c0, c1):</span></div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral">    ...     &quot;Coordinate vector `x` should be an array of size two.&quot;</span></div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral">    ...     return c0 * x[0]**2 + c1*x[1]**2</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">    &gt;&gt;&gt; x = np.ones(2)</span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    &gt;&gt;&gt; c0, c1 = (1, 200)</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">    &gt;&gt;&gt; eps = np.sqrt(np.finfo(float).eps)</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral">    &gt;&gt;&gt; optimize.approx_fprime(x, func, [eps, np.sqrt(200) * eps], c0, c1)</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">    array([   2.        ,  400.00004198])</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  957</span>    xk = np.asarray(xk, float)</div>
<div class="line"><span class="lineno">  958</span>    f0 = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(xk, *args)</div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>    <span class="keywordflow">return</span> approx_derivative(f, xk, method=<span class="stringliteral">&#39;2-point&#39;</span>, abs_step=epsilon,</div>
<div class="line"><span class="lineno">  961</span>                             args=args, f0=f0)</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aee61cc6cef1e91f845fff5cf0a8fc44f" name="aee61cc6cef1e91f845fff5cf0a8fc44f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee61cc6cef1e91f845fff5cf0a8fc44f">&#9670;&#160;</a></span>bracket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.bracket </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xa</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xb</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>grow_limit</em> = <code>110.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>1000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Bracket the minimum of the function.

Given a function and distinct initial points, search in the
downhill direction (as defined by the initial points) and return
new points xa, xb, xc that bracket the minimum of the function
f(xa) &gt; f(xb) &lt; f(xc). It doesn't always mean that obtained
solution will satisfy xa&lt;=x&lt;=xb.

Parameters
----------
func : callable f(x,*args)
    Objective function to minimize.
xa, xb : float, optional
    Bracketing interval. Defaults `xa` to 0.0, and `xb` to 1.0.
args : tuple, optional
    Additional arguments (if present), passed to `func`.
grow_limit : float, optional
    Maximum grow limit.  Defaults to 110.0
maxiter : int, optional
    Maximum number of iterations to perform. Defaults to 1000.

Returns
-------
xa, xb, xc : float
    Bracket.
fa, fb, fc : float
    Objective function values in bracket.
funcalls : int
    Number of function evaluations made.

Examples
--------
This function can find a downward convex region of a function:

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; from scipy.optimize import bracket
&gt;&gt;&gt; def f(x):
...     return 10*x**2 + 3*x + 5
&gt;&gt;&gt; x = np.linspace(-2, 2)
&gt;&gt;&gt; y = f(x)
&gt;&gt;&gt; init_xa, init_xb = 0, 1
&gt;&gt;&gt; xa, xb, xc, fa, fb, fc, funcalls = bracket(f, xa=init_xa, xb=init_xb)
&gt;&gt;&gt; plt.axvline(x=init_xa, color="k", linestyle="--")
&gt;&gt;&gt; plt.axvline(x=init_xb, color="k", linestyle="--")
&gt;&gt;&gt; plt.plot(x, y, "-k")
&gt;&gt;&gt; plt.plot(xa, fa, "bx")
&gt;&gt;&gt; plt.plot(xb, fb, "rx")
&gt;&gt;&gt; plt.plot(xc, fc, "bx")
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno"> 2697</span><span class="keyword">def </span>bracket(func, xa=0.0, xb=1.0, args=(), grow_limit=110.0, maxiter=1000):</div>
<div class="line"><span class="lineno"> 2698</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2699</span><span class="stringliteral">    Bracket the minimum of the function.</span></div>
<div class="line"><span class="lineno"> 2700</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2701</span><span class="stringliteral">    Given a function and distinct initial points, search in the</span></div>
<div class="line"><span class="lineno"> 2702</span><span class="stringliteral">    downhill direction (as defined by the initial points) and return</span></div>
<div class="line"><span class="lineno"> 2703</span><span class="stringliteral">    new points xa, xb, xc that bracket the minimum of the function</span></div>
<div class="line"><span class="lineno"> 2704</span><span class="stringliteral">    f(xa) &gt; f(xb) &lt; f(xc). It doesn&#39;t always mean that obtained</span></div>
<div class="line"><span class="lineno"> 2705</span><span class="stringliteral">    solution will satisfy xa&lt;=x&lt;=xb.</span></div>
<div class="line"><span class="lineno"> 2706</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2707</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2708</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2709</span><span class="stringliteral">    func : callable f(x,*args)</span></div>
<div class="line"><span class="lineno"> 2710</span><span class="stringliteral">        Objective function to minimize.</span></div>
<div class="line"><span class="lineno"> 2711</span><span class="stringliteral">    xa, xb : float, optional</span></div>
<div class="line"><span class="lineno"> 2712</span><span class="stringliteral">        Bracketing interval. Defaults `xa` to 0.0, and `xb` to 1.0.</span></div>
<div class="line"><span class="lineno"> 2713</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 2714</span><span class="stringliteral">        Additional arguments (if present), passed to `func`.</span></div>
<div class="line"><span class="lineno"> 2715</span><span class="stringliteral">    grow_limit : float, optional</span></div>
<div class="line"><span class="lineno"> 2716</span><span class="stringliteral">        Maximum grow limit.  Defaults to 110.0</span></div>
<div class="line"><span class="lineno"> 2717</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno"> 2718</span><span class="stringliteral">        Maximum number of iterations to perform. Defaults to 1000.</span></div>
<div class="line"><span class="lineno"> 2719</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2720</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2721</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2722</span><span class="stringliteral">    xa, xb, xc : float</span></div>
<div class="line"><span class="lineno"> 2723</span><span class="stringliteral">        Bracket.</span></div>
<div class="line"><span class="lineno"> 2724</span><span class="stringliteral">    fa, fb, fc : float</span></div>
<div class="line"><span class="lineno"> 2725</span><span class="stringliteral">        Objective function values in bracket.</span></div>
<div class="line"><span class="lineno"> 2726</span><span class="stringliteral">    funcalls : int</span></div>
<div class="line"><span class="lineno"> 2727</span><span class="stringliteral">        Number of function evaluations made.</span></div>
<div class="line"><span class="lineno"> 2728</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2729</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2730</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2731</span><span class="stringliteral">    This function can find a downward convex region of a function:</span></div>
<div class="line"><span class="lineno"> 2732</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2733</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 2734</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import bracket</span></div>
<div class="line"><span class="lineno"> 2735</span><span class="stringliteral">    &gt;&gt;&gt; def f(x):</span></div>
<div class="line"><span class="lineno"> 2736</span><span class="stringliteral">    ...     return 10*x**2 + 3*x + 5</span></div>
<div class="line"><span class="lineno"> 2737</span><span class="stringliteral">    &gt;&gt;&gt; x = np.linspace(-2, 2)</span></div>
<div class="line"><span class="lineno"> 2738</span><span class="stringliteral">    &gt;&gt;&gt; y = f(x)</span></div>
<div class="line"><span class="lineno"> 2739</span><span class="stringliteral">    &gt;&gt;&gt; init_xa, init_xb = 0, 1</span></div>
<div class="line"><span class="lineno"> 2740</span><span class="stringliteral">    &gt;&gt;&gt; xa, xb, xc, fa, fb, fc, funcalls = bracket(f, xa=init_xa, xb=init_xb)</span></div>
<div class="line"><span class="lineno"> 2741</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(x=init_xa, color=&quot;k&quot;, linestyle=&quot;--&quot;)</span></div>
<div class="line"><span class="lineno"> 2742</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(x=init_xb, color=&quot;k&quot;, linestyle=&quot;--&quot;)</span></div>
<div class="line"><span class="lineno"> 2743</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(x, y, &quot;-k&quot;)</span></div>
<div class="line"><span class="lineno"> 2744</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(xa, fa, &quot;bx&quot;)</span></div>
<div class="line"><span class="lineno"> 2745</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(xb, fb, &quot;rx&quot;)</span></div>
<div class="line"><span class="lineno"> 2746</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(xc, fc, &quot;bx&quot;)</span></div>
<div class="line"><span class="lineno"> 2747</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 2748</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2749</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2750</span>    _gold = 1.618034  <span class="comment"># golden ratio: (1.0+sqrt(5.0))/2.0</span></div>
<div class="line"><span class="lineno"> 2751</span>    _verysmall_num = 1e-21</div>
<div class="line"><span class="lineno"> 2752</span>    fa = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*(xa,) + args)</div>
<div class="line"><span class="lineno"> 2753</span>    fb = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*(xb,) + args)</div>
<div class="line"><span class="lineno"> 2754</span>    <span class="keywordflow">if</span> (fa &lt; fb):                      <span class="comment"># Switch so fa &gt; fb</span></div>
<div class="line"><span class="lineno"> 2755</span>        xa, xb = xb, xa</div>
<div class="line"><span class="lineno"> 2756</span>        fa, fb = fb, fa</div>
<div class="line"><span class="lineno"> 2757</span>    xc = xb + _gold * (xb - xa)</div>
<div class="line"><span class="lineno"> 2758</span>    fc = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((xc,) + args))</div>
<div class="line"><span class="lineno"> 2759</span>    funcalls = 3</div>
<div class="line"><span class="lineno"> 2760</span>    iter = 0</div>
<div class="line"><span class="lineno"> 2761</span>    <span class="keywordflow">while</span> (fc &lt; fb):</div>
<div class="line"><span class="lineno"> 2762</span>        tmp1 = (xb - xa) * (fb - fc)</div>
<div class="line"><span class="lineno"> 2763</span>        tmp2 = (xb - xc) * (fb - fa)</div>
<div class="line"><span class="lineno"> 2764</span>        val = tmp2 - tmp1</div>
<div class="line"><span class="lineno"> 2765</span>        <span class="keywordflow">if</span> np.abs(val) &lt; _verysmall_num:</div>
<div class="line"><span class="lineno"> 2766</span>            denom = 2.0 * _verysmall_num</div>
<div class="line"><span class="lineno"> 2767</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2768</span>            denom = 2.0 * val</div>
<div class="line"><span class="lineno"> 2769</span>        w = xb - ((xb - xc) * tmp2 - (xb - xa) * tmp1) / denom</div>
<div class="line"><span class="lineno"> 2770</span>        wlim = xb + grow_limit * (xc - xb)</div>
<div class="line"><span class="lineno"> 2771</span>        <span class="keywordflow">if</span> iter &gt; maxiter:</div>
<div class="line"><span class="lineno"> 2772</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;Too many iterations.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2773</span>        iter += 1</div>
<div class="line"><span class="lineno"> 2774</span>        <span class="keywordflow">if</span> (w - xc) * (xb - w) &gt; 0.0:</div>
<div class="line"><span class="lineno"> 2775</span>            fw = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((w,) + args))</div>
<div class="line"><span class="lineno"> 2776</span>            funcalls += 1</div>
<div class="line"><span class="lineno"> 2777</span>            <span class="keywordflow">if</span> (fw &lt; fc):</div>
<div class="line"><span class="lineno"> 2778</span>                xa = xb</div>
<div class="line"><span class="lineno"> 2779</span>                xb = w</div>
<div class="line"><span class="lineno"> 2780</span>                fa = fb</div>
<div class="line"><span class="lineno"> 2781</span>                fb = fw</div>
<div class="line"><span class="lineno"> 2782</span>                <span class="keywordflow">return</span> xa, xb, xc, fa, fb, fc, funcalls</div>
<div class="line"><span class="lineno"> 2783</span>            <span class="keywordflow">elif</span> (fw &gt; fb):</div>
<div class="line"><span class="lineno"> 2784</span>                xc = w</div>
<div class="line"><span class="lineno"> 2785</span>                fc = fw</div>
<div class="line"><span class="lineno"> 2786</span>                <span class="keywordflow">return</span> xa, xb, xc, fa, fb, fc, funcalls</div>
<div class="line"><span class="lineno"> 2787</span>            w = xc + _gold * (xc - xb)</div>
<div class="line"><span class="lineno"> 2788</span>            fw = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((w,) + args))</div>
<div class="line"><span class="lineno"> 2789</span>            funcalls += 1</div>
<div class="line"><span class="lineno"> 2790</span>        <span class="keywordflow">elif</span> (w - wlim)*(wlim - xc) &gt;= 0.0:</div>
<div class="line"><span class="lineno"> 2791</span>            w = wlim</div>
<div class="line"><span class="lineno"> 2792</span>            fw = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((w,) + args))</div>
<div class="line"><span class="lineno"> 2793</span>            funcalls += 1</div>
<div class="line"><span class="lineno"> 2794</span>        <span class="keywordflow">elif</span> (w - wlim)*(xc - w) &gt; 0.0:</div>
<div class="line"><span class="lineno"> 2795</span>            fw = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((w,) + args))</div>
<div class="line"><span class="lineno"> 2796</span>            funcalls += 1</div>
<div class="line"><span class="lineno"> 2797</span>            <span class="keywordflow">if</span> (fw &lt; fc):</div>
<div class="line"><span class="lineno"> 2798</span>                xb = xc</div>
<div class="line"><span class="lineno"> 2799</span>                xc = w</div>
<div class="line"><span class="lineno"> 2800</span>                w = xc + _gold * (xc - xb)</div>
<div class="line"><span class="lineno"> 2801</span>                fb = fc</div>
<div class="line"><span class="lineno"> 2802</span>                fc = fw</div>
<div class="line"><span class="lineno"> 2803</span>                fw = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((w,) + args))</div>
<div class="line"><span class="lineno"> 2804</span>                funcalls += 1</div>
<div class="line"><span class="lineno"> 2805</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2806</span>            w = xc + _gold * (xc - xb)</div>
<div class="line"><span class="lineno"> 2807</span>            fw = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*((w,) + args))</div>
<div class="line"><span class="lineno"> 2808</span>            funcalls += 1</div>
<div class="line"><span class="lineno"> 2809</span>        xa = xb</div>
<div class="line"><span class="lineno"> 2810</span>        xb = xc</div>
<div class="line"><span class="lineno"> 2811</span>        xc = w</div>
<div class="line"><span class="lineno"> 2812</span>        fa = fb</div>
<div class="line"><span class="lineno"> 2813</span>        fb = fc</div>
<div class="line"><span class="lineno"> 2814</span>        fc = fw</div>
<div class="line"><span class="lineno"> 2815</span>    <span class="keywordflow">return</span> xa, xb, xc, fa, fb, fc, funcalls</div>
<div class="line"><span class="lineno"> 2816</span> </div>
<div class="line"><span class="lineno"> 2817</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab667dd7bd58227d18103e3e286969b71" name="ab667dd7bd58227d18103e3e286969b71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab667dd7bd58227d18103e3e286969b71">&#9670;&#160;</a></span>brent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.brent </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brack</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1.48e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>500</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Given a function of one variable and a possible bracket, return
the local minimum of the function isolated to a fractional precision
of tol.

Parameters
----------
func : callable f(x,*args)
    Objective function.
args : tuple, optional
    Additional arguments (if present).
brack : tuple, optional
    Either a triple (xa,xb,xc) where xa&lt;xb&lt;xc and func(xb) &lt;
    func(xa), func(xc) or a pair (xa,xb) which are used as a
    starting interval for a downhill bracket search (see
    `bracket`). Providing the pair (xa,xb) does not always mean
    the obtained solution will satisfy xa&lt;=x&lt;=xb.
tol : float, optional
    Relative error in solution `xopt` acceptable for convergence.
full_output : bool, optional
    If True, return all output args (xmin, fval, iter,
    funcalls).
maxiter : int, optional
    Maximum number of iterations in solution.

Returns
-------
xmin : ndarray
    Optimum point.
fval : float
    Optimum value.
iter : int
    Number of iterations.
funcalls : int
    Number of objective function evaluations made.

See also
--------
minimize_scalar: Interface to minimization algorithms for scalar
    univariate functions. See the 'Brent' `method` in particular.

Notes
-----
Uses inverse parabolic interpolation when possible to speed up
convergence of golden section method.

Does not ensure that the minimum lies in the range specified by
`brack`. See `fminbound`.

Examples
--------
We illustrate the behaviour of the function when `brack` is of
size 2 and 3 respectively. In the case where `brack` is of the
form (xa,xb), we can see for the given values, the output need
not necessarily lie in the range (xa,xb).

&gt;&gt;&gt; def f(x):
...     return x**2

&gt;&gt;&gt; from scipy import optimize

&gt;&gt;&gt; minimum = optimize.brent(f,brack=(1,2))
&gt;&gt;&gt; minimum
0.0
&gt;&gt;&gt; minimum = optimize.brent(f,brack=(-1,0.5,2))
&gt;&gt;&gt; minimum
-2.7755575615628914e-17</pre> <div class="fragment"><div class="line"><span class="lineno"> 2389</span><span class="keyword">def </span>brent(func, args=(), brack=<span class="keywordtype">None</span>, tol=1.48e-8, full_output=0, maxiter=500):</div>
<div class="line"><span class="lineno"> 2390</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2391</span><span class="stringliteral">    Given a function of one variable and a possible bracket, return</span></div>
<div class="line"><span class="lineno"> 2392</span><span class="stringliteral">    the local minimum of the function isolated to a fractional precision</span></div>
<div class="line"><span class="lineno"> 2393</span><span class="stringliteral">    of tol.</span></div>
<div class="line"><span class="lineno"> 2394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2395</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2396</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2397</span><span class="stringliteral">    func : callable f(x,*args)</span></div>
<div class="line"><span class="lineno"> 2398</span><span class="stringliteral">        Objective function.</span></div>
<div class="line"><span class="lineno"> 2399</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 2400</span><span class="stringliteral">        Additional arguments (if present).</span></div>
<div class="line"><span class="lineno"> 2401</span><span class="stringliteral">    brack : tuple, optional</span></div>
<div class="line"><span class="lineno"> 2402</span><span class="stringliteral">        Either a triple (xa,xb,xc) where xa&lt;xb&lt;xc and func(xb) &lt;</span></div>
<div class="line"><span class="lineno"> 2403</span><span class="stringliteral">        func(xa), func(xc) or a pair (xa,xb) which are used as a</span></div>
<div class="line"><span class="lineno"> 2404</span><span class="stringliteral">        starting interval for a downhill bracket search (see</span></div>
<div class="line"><span class="lineno"> 2405</span><span class="stringliteral">        `bracket`). Providing the pair (xa,xb) does not always mean</span></div>
<div class="line"><span class="lineno"> 2406</span><span class="stringliteral">        the obtained solution will satisfy xa&lt;=x&lt;=xb.</span></div>
<div class="line"><span class="lineno"> 2407</span><span class="stringliteral">    tol : float, optional</span></div>
<div class="line"><span class="lineno"> 2408</span><span class="stringliteral">        Relative error in solution `xopt` acceptable for convergence.</span></div>
<div class="line"><span class="lineno"> 2409</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno"> 2410</span><span class="stringliteral">        If True, return all output args (xmin, fval, iter,</span></div>
<div class="line"><span class="lineno"> 2411</span><span class="stringliteral">        funcalls).</span></div>
<div class="line"><span class="lineno"> 2412</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno"> 2413</span><span class="stringliteral">        Maximum number of iterations in solution.</span></div>
<div class="line"><span class="lineno"> 2414</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2415</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2416</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2417</span><span class="stringliteral">    xmin : ndarray</span></div>
<div class="line"><span class="lineno"> 2418</span><span class="stringliteral">        Optimum point.</span></div>
<div class="line"><span class="lineno"> 2419</span><span class="stringliteral">    fval : float</span></div>
<div class="line"><span class="lineno"> 2420</span><span class="stringliteral">        Optimum value.</span></div>
<div class="line"><span class="lineno"> 2421</span><span class="stringliteral">    iter : int</span></div>
<div class="line"><span class="lineno"> 2422</span><span class="stringliteral">        Number of iterations.</span></div>
<div class="line"><span class="lineno"> 2423</span><span class="stringliteral">    funcalls : int</span></div>
<div class="line"><span class="lineno"> 2424</span><span class="stringliteral">        Number of objective function evaluations made.</span></div>
<div class="line"><span class="lineno"> 2425</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2426</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 2427</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2428</span><span class="stringliteral">    minimize_scalar: Interface to minimization algorithms for scalar</span></div>
<div class="line"><span class="lineno"> 2429</span><span class="stringliteral">        univariate functions. See the &#39;Brent&#39; `method` in particular.</span></div>
<div class="line"><span class="lineno"> 2430</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2431</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2432</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2433</span><span class="stringliteral">    Uses inverse parabolic interpolation when possible to speed up</span></div>
<div class="line"><span class="lineno"> 2434</span><span class="stringliteral">    convergence of golden section method.</span></div>
<div class="line"><span class="lineno"> 2435</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2436</span><span class="stringliteral">    Does not ensure that the minimum lies in the range specified by</span></div>
<div class="line"><span class="lineno"> 2437</span><span class="stringliteral">    `brack`. See `fminbound`.</span></div>
<div class="line"><span class="lineno"> 2438</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2439</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2440</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2441</span><span class="stringliteral">    We illustrate the behaviour of the function when `brack` is of</span></div>
<div class="line"><span class="lineno"> 2442</span><span class="stringliteral">    size 2 and 3 respectively. In the case where `brack` is of the</span></div>
<div class="line"><span class="lineno"> 2443</span><span class="stringliteral">    form (xa,xb), we can see for the given values, the output need</span></div>
<div class="line"><span class="lineno"> 2444</span><span class="stringliteral">    not necessarily lie in the range (xa,xb).</span></div>
<div class="line"><span class="lineno"> 2445</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2446</span><span class="stringliteral">    &gt;&gt;&gt; def f(x):</span></div>
<div class="line"><span class="lineno"> 2447</span><span class="stringliteral">    ...     return x**2</span></div>
<div class="line"><span class="lineno"> 2448</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2449</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno"> 2450</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2451</span><span class="stringliteral">    &gt;&gt;&gt; minimum = optimize.brent(f,brack=(1,2))</span></div>
<div class="line"><span class="lineno"> 2452</span><span class="stringliteral">    &gt;&gt;&gt; minimum</span></div>
<div class="line"><span class="lineno"> 2453</span><span class="stringliteral">    0.0</span></div>
<div class="line"><span class="lineno"> 2454</span><span class="stringliteral">    &gt;&gt;&gt; minimum = optimize.brent(f,brack=(-1,0.5,2))</span></div>
<div class="line"><span class="lineno"> 2455</span><span class="stringliteral">    &gt;&gt;&gt; minimum</span></div>
<div class="line"><span class="lineno"> 2456</span><span class="stringliteral">    -2.7755575615628914e-17</span></div>
<div class="line"><span class="lineno"> 2457</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2458</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2459</span>    options = {<span class="stringliteral">&#39;xtol&#39;</span>: tol,</div>
<div class="line"><span class="lineno"> 2460</span>               <span class="stringliteral">&#39;maxiter&#39;</span>: maxiter}</div>
<div class="line"><span class="lineno"> 2461</span>    res = _minimize_scalar_brent(func, brack, args, **options)</div>
<div class="line"><span class="lineno"> 2462</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno"> 2463</span>        <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;fun&#39;</span>], res[<span class="stringliteral">&#39;nit&#39;</span>], res[<span class="stringliteral">&#39;nfev&#39;</span>]</div>
<div class="line"><span class="lineno"> 2464</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2465</span>        <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno"> 2466</span> </div>
<div class="line"><span class="lineno"> 2467</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a98e856197a3ade6049ea4f05461669d8" name="a98e856197a3ade6049ea4f05461669d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98e856197a3ade6049ea4f05461669d8">&#9670;&#160;</a></span>brute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.brute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Ns</em> = <code>20</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>finish</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a1c8825f72fbb699b9d86a64dfd7f2d5b">fmin</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>workers</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Minimize a function over a given range by brute force.

Uses the "brute force" method, i.e., computes the function's value
at each point of a multidimensional grid of points, to find the global
minimum of the function.

The function is evaluated everywhere in the range with the datatype of the
first call to the function, as enforced by the ``vectorize`` NumPy
function. The value and type of the function evaluation returned when
``full_output=True`` are affected in addition by the ``finish`` argument
(see Notes).

The brute force approach is inefficient because the number of grid points
increases exponentially - the number of grid points to evaluate is
``Ns ** len(x)``. Consequently, even with coarse grid spacing, even
moderately sized problems can take a long time to run, and/or run into
memory limitations.

Parameters
----------
func : callable
    The objective function to be minimized. Must be in the
    form ``f(x, *args)``, where ``x`` is the argument in
    the form of a 1-D array and ``args`` is a tuple of any
    additional fixed parameters needed to completely specify
    the function.
ranges : tuple
    Each component of the `ranges` tuple must be either a
    "slice object" or a range tuple of the form ``(low, high)``.
    The program uses these to create the grid of points on which
    the objective function will be computed. See `Note 2` for
    more detail.
args : tuple, optional
    Any additional fixed parameters needed to completely specify
    the function.
Ns : int, optional
    Number of grid points along the axes, if not otherwise
    specified. See `Note2`.
full_output : bool, optional
    If True, return the evaluation grid and the objective function's
    values on it.
finish : callable, optional
    An optimization function that is called with the result of brute force
    minimization as initial guess. `finish` should take `func` and
    the initial guess as positional arguments, and take `args` as
    keyword arguments. It may additionally take `full_output`
    and/or `disp` as keyword arguments. Use None if no "polishing"
    function is to be used. See Notes for more details.
disp : bool, optional
    Set to True to print convergence messages from the `finish` callable.
workers : int or map-like callable, optional
    If `workers` is an int the grid is subdivided into `workers`
    sections and evaluated in parallel (uses
    `multiprocessing.Pool &lt;multiprocessing&gt;`).
    Supply `-1` to use all cores available to the Process.
    Alternatively supply a map-like callable, such as
    `multiprocessing.Pool.map` for evaluating the grid in parallel.
    This evaluation is carried out as ``workers(func, iterable)``.
    Requires that `func` be pickleable.

    .. versionadded:: 1.3.0

Returns
-------
x0 : ndarray
    A 1-D array containing the coordinates of a point at which the
    objective function had its minimum value. (See `Note 1` for
    which point is returned.)
fval : float
    Function value at the point `x0`. (Returned when `full_output` is
    True.)
grid : tuple
    Representation of the evaluation grid. It has the same
    length as `x0`. (Returned when `full_output` is True.)
Jout : ndarray
    Function values at each point of the evaluation
    grid, i.e., ``Jout = func(*grid)``. (Returned
    when `full_output` is True.)

See Also
--------
basinhopping, differential_evolution

Notes
-----
*Note 1*: The program finds the gridpoint at which the lowest value
of the objective function occurs. If `finish` is None, that is the
point returned. When the global minimum occurs within (or not very far
outside) the grid's boundaries, and the grid is fine enough, that
point will be in the neighborhood of the global minimum.

However, users often employ some other optimization program to
"polish" the gridpoint values, i.e., to seek a more precise
(local) minimum near `brute's` best gridpoint.
The `brute` function's `finish` option provides a convenient way to do
that. Any polishing program used must take `brute's` output as its
initial guess as a positional argument, and take `brute's` input values
for `args` as keyword arguments, otherwise an error will be raised.
It may additionally take `full_output` and/or `disp` as keyword arguments.

`brute` assumes that the `finish` function returns either an
`OptimizeResult` object or a tuple in the form:
``(xmin, Jmin, ... , statuscode)``, where ``xmin`` is the minimizing
value of the argument, ``Jmin`` is the minimum value of the objective
function, "..." may be some other returned values (which are not used
by `brute`), and ``statuscode`` is the status code of the `finish` program.

Note that when `finish` is not None, the values returned are those
of the `finish` program, *not* the gridpoint ones. Consequently,
while `brute` confines its search to the input grid points,
the `finish` program's results usually will not coincide with any
gridpoint, and may fall outside the grid's boundary. Thus, if a
minimum only needs to be found over the provided grid points, make
sure to pass in `finish=None`.

*Note 2*: The grid of points is a `numpy.mgrid` object.
For `brute` the `ranges` and `Ns` inputs have the following effect.
Each component of the `ranges` tuple can be either a slice object or a
two-tuple giving a range of values, such as (0, 5). If the component is a
slice object, `brute` uses it directly. If the component is a two-tuple
range, `brute` internally converts it to a slice object that interpolates
`Ns` points from its low-value to its high-value, inclusive.

Examples
--------
We illustrate the use of `brute` to seek the global minimum of a function
of two variables that is given as the sum of a positive-definite
quadratic and two deep "Gaussian-shaped" craters. Specifically, define
the objective function `f` as the sum of three other functions,
``f = f1 + f2 + f3``. We suppose each of these has a signature
``(z, *params)``, where ``z = (x, y)``,  and ``params`` and the functions
are as defined below.

&gt;&gt;&gt; params = (2, 3, 7, 8, 9, 10, 44, -1, 2, 26, 1, -2, 0.5)
&gt;&gt;&gt; def f1(z, *params):
...     x, y = z
...     a, b, c, d, e, f, g, h, i, j, k, l, scale = params
...     return (a * x**2 + b * x * y + c * y**2 + d*x + e*y + f)

&gt;&gt;&gt; def f2(z, *params):
...     x, y = z
...     a, b, c, d, e, f, g, h, i, j, k, l, scale = params
...     return (-g*np.exp(-((x-h)**2 + (y-i)**2) / scale))

&gt;&gt;&gt; def f3(z, *params):
...     x, y = z
...     a, b, c, d, e, f, g, h, i, j, k, l, scale = params
...     return (-j*np.exp(-((x-k)**2 + (y-l)**2) / scale))

&gt;&gt;&gt; def f(z, *params):
...     return f1(z, *params) + f2(z, *params) + f3(z, *params)

Thus, the objective function may have local minima near the minimum
of each of the three functions of which it is composed. To
use `fmin` to polish its gridpoint result, we may then continue as
follows:

&gt;&gt;&gt; rranges = (slice(-4, 4, 0.25), slice(-4, 4, 0.25))
&gt;&gt;&gt; from scipy import optimize
&gt;&gt;&gt; resbrute = optimize.brute(f, rranges, args=params, full_output=True,
...                           finish=optimize.fmin)
&gt;&gt;&gt; resbrute[0]  # global minimum
array([-1.05665192,  1.80834843])
&gt;&gt;&gt; resbrute[1]  # function value at global minimum
-3.4085818767

Note that if `finish` had been set to None, we would have gotten the
gridpoint [-1.0 1.75] where the rounded function value is -2.892.</pre> <div class="fragment"><div class="line"><span class="lineno"> 3292</span>          disp=<span class="keyword">False</span>, workers=1):</div>
<div class="line"><span class="lineno"> 3293</span>    <span class="stringliteral">&quot;&quot;&quot;Minimize a function over a given range by brute force.</span></div>
<div class="line"><span class="lineno"> 3294</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3295</span><span class="stringliteral">    Uses the &quot;brute force&quot; method, i.e., computes the function&#39;s value</span></div>
<div class="line"><span class="lineno"> 3296</span><span class="stringliteral">    at each point of a multidimensional grid of points, to find the global</span></div>
<div class="line"><span class="lineno"> 3297</span><span class="stringliteral">    minimum of the function.</span></div>
<div class="line"><span class="lineno"> 3298</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3299</span><span class="stringliteral">    The function is evaluated everywhere in the range with the datatype of the</span></div>
<div class="line"><span class="lineno"> 3300</span><span class="stringliteral">    first call to the function, as enforced by the ``vectorize`` NumPy</span></div>
<div class="line"><span class="lineno"> 3301</span><span class="stringliteral">    function. The value and type of the function evaluation returned when</span></div>
<div class="line"><span class="lineno"> 3302</span><span class="stringliteral">    ``full_output=True`` are affected in addition by the ``finish`` argument</span></div>
<div class="line"><span class="lineno"> 3303</span><span class="stringliteral">    (see Notes).</span></div>
<div class="line"><span class="lineno"> 3304</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3305</span><span class="stringliteral">    The brute force approach is inefficient because the number of grid points</span></div>
<div class="line"><span class="lineno"> 3306</span><span class="stringliteral">    increases exponentially - the number of grid points to evaluate is</span></div>
<div class="line"><span class="lineno"> 3307</span><span class="stringliteral">    ``Ns ** len(x)``. Consequently, even with coarse grid spacing, even</span></div>
<div class="line"><span class="lineno"> 3308</span><span class="stringliteral">    moderately sized problems can take a long time to run, and/or run into</span></div>
<div class="line"><span class="lineno"> 3309</span><span class="stringliteral">    memory limitations.</span></div>
<div class="line"><span class="lineno"> 3310</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3311</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3312</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3313</span><span class="stringliteral">    func : callable</span></div>
<div class="line"><span class="lineno"> 3314</span><span class="stringliteral">        The objective function to be minimized. Must be in the</span></div>
<div class="line"><span class="lineno"> 3315</span><span class="stringliteral">        form ``f(x, *args)``, where ``x`` is the argument in</span></div>
<div class="line"><span class="lineno"> 3316</span><span class="stringliteral">        the form of a 1-D array and ``args`` is a tuple of any</span></div>
<div class="line"><span class="lineno"> 3317</span><span class="stringliteral">        additional fixed parameters needed to completely specify</span></div>
<div class="line"><span class="lineno"> 3318</span><span class="stringliteral">        the function.</span></div>
<div class="line"><span class="lineno"> 3319</span><span class="stringliteral">    ranges : tuple</span></div>
<div class="line"><span class="lineno"> 3320</span><span class="stringliteral">        Each component of the `ranges` tuple must be either a</span></div>
<div class="line"><span class="lineno"> 3321</span><span class="stringliteral">        &quot;slice object&quot; or a range tuple of the form ``(low, high)``.</span></div>
<div class="line"><span class="lineno"> 3322</span><span class="stringliteral">        The program uses these to create the grid of points on which</span></div>
<div class="line"><span class="lineno"> 3323</span><span class="stringliteral">        the objective function will be computed. See `Note 2` for</span></div>
<div class="line"><span class="lineno"> 3324</span><span class="stringliteral">        more detail.</span></div>
<div class="line"><span class="lineno"> 3325</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 3326</span><span class="stringliteral">        Any additional fixed parameters needed to completely specify</span></div>
<div class="line"><span class="lineno"> 3327</span><span class="stringliteral">        the function.</span></div>
<div class="line"><span class="lineno"> 3328</span><span class="stringliteral">    Ns : int, optional</span></div>
<div class="line"><span class="lineno"> 3329</span><span class="stringliteral">        Number of grid points along the axes, if not otherwise</span></div>
<div class="line"><span class="lineno"> 3330</span><span class="stringliteral">        specified. See `Note2`.</span></div>
<div class="line"><span class="lineno"> 3331</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno"> 3332</span><span class="stringliteral">        If True, return the evaluation grid and the objective function&#39;s</span></div>
<div class="line"><span class="lineno"> 3333</span><span class="stringliteral">        values on it.</span></div>
<div class="line"><span class="lineno"> 3334</span><span class="stringliteral">    finish : callable, optional</span></div>
<div class="line"><span class="lineno"> 3335</span><span class="stringliteral">        An optimization function that is called with the result of brute force</span></div>
<div class="line"><span class="lineno"> 3336</span><span class="stringliteral">        minimization as initial guess. `finish` should take `func` and</span></div>
<div class="line"><span class="lineno"> 3337</span><span class="stringliteral">        the initial guess as positional arguments, and take `args` as</span></div>
<div class="line"><span class="lineno"> 3338</span><span class="stringliteral">        keyword arguments. It may additionally take `full_output`</span></div>
<div class="line"><span class="lineno"> 3339</span><span class="stringliteral">        and/or `disp` as keyword arguments. Use None if no &quot;polishing&quot;</span></div>
<div class="line"><span class="lineno"> 3340</span><span class="stringliteral">        function is to be used. See Notes for more details.</span></div>
<div class="line"><span class="lineno"> 3341</span><span class="stringliteral">    disp : bool, optional</span></div>
<div class="line"><span class="lineno"> 3342</span><span class="stringliteral">        Set to True to print convergence messages from the `finish` callable.</span></div>
<div class="line"><span class="lineno"> 3343</span><span class="stringliteral">    workers : int or map-like callable, optional</span></div>
<div class="line"><span class="lineno"> 3344</span><span class="stringliteral">        If `workers` is an int the grid is subdivided into `workers`</span></div>
<div class="line"><span class="lineno"> 3345</span><span class="stringliteral">        sections and evaluated in parallel (uses</span></div>
<div class="line"><span class="lineno"> 3346</span><span class="stringliteral">        `multiprocessing.Pool &lt;multiprocessing&gt;`).</span></div>
<div class="line"><span class="lineno"> 3347</span><span class="stringliteral">        Supply `-1` to use all cores available to the Process.</span></div>
<div class="line"><span class="lineno"> 3348</span><span class="stringliteral">        Alternatively supply a map-like callable, such as</span></div>
<div class="line"><span class="lineno"> 3349</span><span class="stringliteral">        `multiprocessing.Pool.map` for evaluating the grid in parallel.</span></div>
<div class="line"><span class="lineno"> 3350</span><span class="stringliteral">        This evaluation is carried out as ``workers(func, iterable)``.</span></div>
<div class="line"><span class="lineno"> 3351</span><span class="stringliteral">        Requires that `func` be pickleable.</span></div>
<div class="line"><span class="lineno"> 3352</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3353</span><span class="stringliteral">        .. versionadded:: 1.3.0</span></div>
<div class="line"><span class="lineno"> 3354</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3355</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3356</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3357</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno"> 3358</span><span class="stringliteral">        A 1-D array containing the coordinates of a point at which the</span></div>
<div class="line"><span class="lineno"> 3359</span><span class="stringliteral">        objective function had its minimum value. (See `Note 1` for</span></div>
<div class="line"><span class="lineno"> 3360</span><span class="stringliteral">        which point is returned.)</span></div>
<div class="line"><span class="lineno"> 3361</span><span class="stringliteral">    fval : float</span></div>
<div class="line"><span class="lineno"> 3362</span><span class="stringliteral">        Function value at the point `x0`. (Returned when `full_output` is</span></div>
<div class="line"><span class="lineno"> 3363</span><span class="stringliteral">        True.)</span></div>
<div class="line"><span class="lineno"> 3364</span><span class="stringliteral">    grid : tuple</span></div>
<div class="line"><span class="lineno"> 3365</span><span class="stringliteral">        Representation of the evaluation grid. It has the same</span></div>
<div class="line"><span class="lineno"> 3366</span><span class="stringliteral">        length as `x0`. (Returned when `full_output` is True.)</span></div>
<div class="line"><span class="lineno"> 3367</span><span class="stringliteral">    Jout : ndarray</span></div>
<div class="line"><span class="lineno"> 3368</span><span class="stringliteral">        Function values at each point of the evaluation</span></div>
<div class="line"><span class="lineno"> 3369</span><span class="stringliteral">        grid, i.e., ``Jout = func(*grid)``. (Returned</span></div>
<div class="line"><span class="lineno"> 3370</span><span class="stringliteral">        when `full_output` is True.)</span></div>
<div class="line"><span class="lineno"> 3371</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3372</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 3373</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3374</span><span class="stringliteral">    basinhopping, differential_evolution</span></div>
<div class="line"><span class="lineno"> 3375</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3376</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 3377</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 3378</span><span class="stringliteral">    *Note 1*: The program finds the gridpoint at which the lowest value</span></div>
<div class="line"><span class="lineno"> 3379</span><span class="stringliteral">    of the objective function occurs. If `finish` is None, that is the</span></div>
<div class="line"><span class="lineno"> 3380</span><span class="stringliteral">    point returned. When the global minimum occurs within (or not very far</span></div>
<div class="line"><span class="lineno"> 3381</span><span class="stringliteral">    outside) the grid&#39;s boundaries, and the grid is fine enough, that</span></div>
<div class="line"><span class="lineno"> 3382</span><span class="stringliteral">    point will be in the neighborhood of the global minimum.</span></div>
<div class="line"><span class="lineno"> 3383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3384</span><span class="stringliteral">    However, users often employ some other optimization program to</span></div>
<div class="line"><span class="lineno"> 3385</span><span class="stringliteral">    &quot;polish&quot; the gridpoint values, i.e., to seek a more precise</span></div>
<div class="line"><span class="lineno"> 3386</span><span class="stringliteral">    (local) minimum near `brute&#39;s` best gridpoint.</span></div>
<div class="line"><span class="lineno"> 3387</span><span class="stringliteral">    The `brute` function&#39;s `finish` option provides a convenient way to do</span></div>
<div class="line"><span class="lineno"> 3388</span><span class="stringliteral">    that. Any polishing program used must take `brute&#39;s` output as its</span></div>
<div class="line"><span class="lineno"> 3389</span><span class="stringliteral">    initial guess as a positional argument, and take `brute&#39;s` input values</span></div>
<div class="line"><span class="lineno"> 3390</span><span class="stringliteral">    for `args` as keyword arguments, otherwise an error will be raised.</span></div>
<div class="line"><span class="lineno"> 3391</span><span class="stringliteral">    It may additionally take `full_output` and/or `disp` as keyword arguments.</span></div>
<div class="line"><span class="lineno"> 3392</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3393</span><span class="stringliteral">    `brute` assumes that the `finish` function returns either an</span></div>
<div class="line"><span class="lineno"> 3394</span><span class="stringliteral">    `OptimizeResult` object or a tuple in the form:</span></div>
<div class="line"><span class="lineno"> 3395</span><span class="stringliteral">    ``(xmin, Jmin, ... , statuscode)``, where ``xmin`` is the minimizing</span></div>
<div class="line"><span class="lineno"> 3396</span><span class="stringliteral">    value of the argument, ``Jmin`` is the minimum value of the objective</span></div>
<div class="line"><span class="lineno"> 3397</span><span class="stringliteral">    function, &quot;...&quot; may be some other returned values (which are not used</span></div>
<div class="line"><span class="lineno"> 3398</span><span class="stringliteral">    by `brute`), and ``statuscode`` is the status code of the `finish` program.</span></div>
<div class="line"><span class="lineno"> 3399</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3400</span><span class="stringliteral">    Note that when `finish` is not None, the values returned are those</span></div>
<div class="line"><span class="lineno"> 3401</span><span class="stringliteral">    of the `finish` program, *not* the gridpoint ones. Consequently,</span></div>
<div class="line"><span class="lineno"> 3402</span><span class="stringliteral">    while `brute` confines its search to the input grid points,</span></div>
<div class="line"><span class="lineno"> 3403</span><span class="stringliteral">    the `finish` program&#39;s results usually will not coincide with any</span></div>
<div class="line"><span class="lineno"> 3404</span><span class="stringliteral">    gridpoint, and may fall outside the grid&#39;s boundary. Thus, if a</span></div>
<div class="line"><span class="lineno"> 3405</span><span class="stringliteral">    minimum only needs to be found over the provided grid points, make</span></div>
<div class="line"><span class="lineno"> 3406</span><span class="stringliteral">    sure to pass in `finish=None`.</span></div>
<div class="line"><span class="lineno"> 3407</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3408</span><span class="stringliteral">    *Note 2*: The grid of points is a `numpy.mgrid` object.</span></div>
<div class="line"><span class="lineno"> 3409</span><span class="stringliteral">    For `brute` the `ranges` and `Ns` inputs have the following effect.</span></div>
<div class="line"><span class="lineno"> 3410</span><span class="stringliteral">    Each component of the `ranges` tuple can be either a slice object or a</span></div>
<div class="line"><span class="lineno"> 3411</span><span class="stringliteral">    two-tuple giving a range of values, such as (0, 5). If the component is a</span></div>
<div class="line"><span class="lineno"> 3412</span><span class="stringliteral">    slice object, `brute` uses it directly. If the component is a two-tuple</span></div>
<div class="line"><span class="lineno"> 3413</span><span class="stringliteral">    range, `brute` internally converts it to a slice object that interpolates</span></div>
<div class="line"><span class="lineno"> 3414</span><span class="stringliteral">    `Ns` points from its low-value to its high-value, inclusive.</span></div>
<div class="line"><span class="lineno"> 3415</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3416</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3417</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3418</span><span class="stringliteral">    We illustrate the use of `brute` to seek the global minimum of a function</span></div>
<div class="line"><span class="lineno"> 3419</span><span class="stringliteral">    of two variables that is given as the sum of a positive-definite</span></div>
<div class="line"><span class="lineno"> 3420</span><span class="stringliteral">    quadratic and two deep &quot;Gaussian-shaped&quot; craters. Specifically, define</span></div>
<div class="line"><span class="lineno"> 3421</span><span class="stringliteral">    the objective function `f` as the sum of three other functions,</span></div>
<div class="line"><span class="lineno"> 3422</span><span class="stringliteral">    ``f = f1 + f2 + f3``. We suppose each of these has a signature</span></div>
<div class="line"><span class="lineno"> 3423</span><span class="stringliteral">    ``(z, *params)``, where ``z = (x, y)``,  and ``params`` and the functions</span></div>
<div class="line"><span class="lineno"> 3424</span><span class="stringliteral">    are as defined below.</span></div>
<div class="line"><span class="lineno"> 3425</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3426</span><span class="stringliteral">    &gt;&gt;&gt; params = (2, 3, 7, 8, 9, 10, 44, -1, 2, 26, 1, -2, 0.5)</span></div>
<div class="line"><span class="lineno"> 3427</span><span class="stringliteral">    &gt;&gt;&gt; def f1(z, *params):</span></div>
<div class="line"><span class="lineno"> 3428</span><span class="stringliteral">    ...     x, y = z</span></div>
<div class="line"><span class="lineno"> 3429</span><span class="stringliteral">    ...     a, b, c, d, e, f, g, h, i, j, k, l, scale = params</span></div>
<div class="line"><span class="lineno"> 3430</span><span class="stringliteral">    ...     return (a * x**2 + b * x * y + c * y**2 + d*x + e*y + f)</span></div>
<div class="line"><span class="lineno"> 3431</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3432</span><span class="stringliteral">    &gt;&gt;&gt; def f2(z, *params):</span></div>
<div class="line"><span class="lineno"> 3433</span><span class="stringliteral">    ...     x, y = z</span></div>
<div class="line"><span class="lineno"> 3434</span><span class="stringliteral">    ...     a, b, c, d, e, f, g, h, i, j, k, l, scale = params</span></div>
<div class="line"><span class="lineno"> 3435</span><span class="stringliteral">    ...     return (-g*np.exp(-((x-h)**2 + (y-i)**2) / scale))</span></div>
<div class="line"><span class="lineno"> 3436</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3437</span><span class="stringliteral">    &gt;&gt;&gt; def f3(z, *params):</span></div>
<div class="line"><span class="lineno"> 3438</span><span class="stringliteral">    ...     x, y = z</span></div>
<div class="line"><span class="lineno"> 3439</span><span class="stringliteral">    ...     a, b, c, d, e, f, g, h, i, j, k, l, scale = params</span></div>
<div class="line"><span class="lineno"> 3440</span><span class="stringliteral">    ...     return (-j*np.exp(-((x-k)**2 + (y-l)**2) / scale))</span></div>
<div class="line"><span class="lineno"> 3441</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3442</span><span class="stringliteral">    &gt;&gt;&gt; def f(z, *params):</span></div>
<div class="line"><span class="lineno"> 3443</span><span class="stringliteral">    ...     return f1(z, *params) + f2(z, *params) + f3(z, *params)</span></div>
<div class="line"><span class="lineno"> 3444</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3445</span><span class="stringliteral">    Thus, the objective function may have local minima near the minimum</span></div>
<div class="line"><span class="lineno"> 3446</span><span class="stringliteral">    of each of the three functions of which it is composed. To</span></div>
<div class="line"><span class="lineno"> 3447</span><span class="stringliteral">    use `fmin` to polish its gridpoint result, we may then continue as</span></div>
<div class="line"><span class="lineno"> 3448</span><span class="stringliteral">    follows:</span></div>
<div class="line"><span class="lineno"> 3449</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3450</span><span class="stringliteral">    &gt;&gt;&gt; rranges = (slice(-4, 4, 0.25), slice(-4, 4, 0.25))</span></div>
<div class="line"><span class="lineno"> 3451</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno"> 3452</span><span class="stringliteral">    &gt;&gt;&gt; resbrute = optimize.brute(f, rranges, args=params, full_output=True,</span></div>
<div class="line"><span class="lineno"> 3453</span><span class="stringliteral">    ...                           finish=optimize.fmin)</span></div>
<div class="line"><span class="lineno"> 3454</span><span class="stringliteral">    &gt;&gt;&gt; resbrute[0]  # global minimum</span></div>
<div class="line"><span class="lineno"> 3455</span><span class="stringliteral">    array([-1.05665192,  1.80834843])</span></div>
<div class="line"><span class="lineno"> 3456</span><span class="stringliteral">    &gt;&gt;&gt; resbrute[1]  # function value at global minimum</span></div>
<div class="line"><span class="lineno"> 3457</span><span class="stringliteral">    -3.4085818767</span></div>
<div class="line"><span class="lineno"> 3458</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3459</span><span class="stringliteral">    Note that if `finish` had been set to None, we would have gotten the</span></div>
<div class="line"><span class="lineno"> 3460</span><span class="stringliteral">    gridpoint [-1.0 1.75] where the rounded function value is -2.892.</span></div>
<div class="line"><span class="lineno"> 3461</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3462</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3463</span>    N = len(ranges)</div>
<div class="line"><span class="lineno"> 3464</span>    <span class="keywordflow">if</span> N &gt; 40:</div>
<div class="line"><span class="lineno"> 3465</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Brute Force not possible with more &quot;</span></div>
<div class="line"><span class="lineno"> 3466</span>                         <span class="stringliteral">&quot;than 40 variables.&quot;</span>)</div>
<div class="line"><span class="lineno"> 3467</span>    lrange = list(ranges)</div>
<div class="line"><span class="lineno"> 3468</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(N):</div>
<div class="line"><span class="lineno"> 3469</span>        <span class="keywordflow">if</span> type(lrange[k]) <span class="keywordflow">is</span> <span class="keywordflow">not</span> type(slice(<span class="keywordtype">None</span>)):</div>
<div class="line"><span class="lineno"> 3470</span>            <span class="keywordflow">if</span> len(lrange[k]) &lt; 3:</div>
<div class="line"><span class="lineno"> 3471</span>                lrange[k] = tuple(lrange[k]) + (complex(Ns),)</div>
<div class="line"><span class="lineno"> 3472</span>            lrange[k] = slice(*lrange[k])</div>
<div class="line"><span class="lineno"> 3473</span>    <span class="keywordflow">if</span> (N == 1):</div>
<div class="line"><span class="lineno"> 3474</span>        lrange = lrange[0]</div>
<div class="line"><span class="lineno"> 3475</span> </div>
<div class="line"><span class="lineno"> 3476</span>    grid = np.mgrid[lrange]</div>
<div class="line"><span class="lineno"> 3477</span> </div>
<div class="line"><span class="lineno"> 3478</span>    <span class="comment"># obtain an array of parameters that is iterable by a map-like callable</span></div>
<div class="line"><span class="lineno"> 3479</span>    inpt_shape = grid.shape</div>
<div class="line"><span class="lineno"> 3480</span>    <span class="keywordflow">if</span> (N &gt; 1):</div>
<div class="line"><span class="lineno"> 3481</span>        grid = np.reshape(grid, (inpt_shape[0], np.prod(inpt_shape[1:]))).T</div>
<div class="line"><span class="lineno"> 3482</span> </div>
<div class="line"><span class="lineno"> 3483</span>    wrapped_func = _Brute_Wrapper(func, args)</div>
<div class="line"><span class="lineno"> 3484</span> </div>
<div class="line"><span class="lineno"> 3485</span>    <span class="comment"># iterate over input arrays, possibly in parallel</span></div>
<div class="line"><span class="lineno"> 3486</span>    <span class="keyword">with</span> MapWrapper(pool=workers) <span class="keyword">as</span> mapper:</div>
<div class="line"><span class="lineno"> 3487</span>        Jout = np.array(list(mapper(wrapped_func, grid)))</div>
<div class="line"><span class="lineno"> 3488</span>        <span class="keywordflow">if</span> (N == 1):</div>
<div class="line"><span class="lineno"> 3489</span>            grid = (grid,)</div>
<div class="line"><span class="lineno"> 3490</span>            Jout = np.squeeze(Jout)</div>
<div class="line"><span class="lineno"> 3491</span>        <span class="keywordflow">elif</span> (N &gt; 1):</div>
<div class="line"><span class="lineno"> 3492</span>            Jout = np.reshape(Jout, inpt_shape[1:])</div>
<div class="line"><span class="lineno"> 3493</span>            grid = np.reshape(grid.T, inpt_shape)</div>
<div class="line"><span class="lineno"> 3494</span> </div>
<div class="line"><span class="lineno"> 3495</span>    Nshape = shape(Jout)</div>
<div class="line"><span class="lineno"> 3496</span> </div>
<div class="line"><span class="lineno"> 3497</span>    indx = argmin(Jout.ravel(), axis=-1)</div>
<div class="line"><span class="lineno"> 3498</span>    Nindx = np.empty(N, int)</div>
<div class="line"><span class="lineno"> 3499</span>    xmin = np.empty(N, float)</div>
<div class="line"><span class="lineno"> 3500</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(N - 1, -1, -1):</div>
<div class="line"><span class="lineno"> 3501</span>        thisN = Nshape[k]</div>
<div class="line"><span class="lineno"> 3502</span>        Nindx[k] = indx % Nshape[k]</div>
<div class="line"><span class="lineno"> 3503</span>        indx = indx // thisN</div>
<div class="line"><span class="lineno"> 3504</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(N):</div>
<div class="line"><span class="lineno"> 3505</span>        xmin[k] = grid[k][tuple(Nindx)]</div>
<div class="line"><span class="lineno"> 3506</span> </div>
<div class="line"><span class="lineno"> 3507</span>    Jmin = Jout[tuple(Nindx)]</div>
<div class="line"><span class="lineno"> 3508</span>    <span class="keywordflow">if</span> (N == 1):</div>
<div class="line"><span class="lineno"> 3509</span>        grid = grid[0]</div>
<div class="line"><span class="lineno"> 3510</span>        xmin = xmin[0]</div>
<div class="line"><span class="lineno"> 3511</span> </div>
<div class="line"><span class="lineno"> 3512</span>    <span class="keywordflow">if</span> callable(finish):</div>
<div class="line"><span class="lineno"> 3513</span>        <span class="comment"># set up kwargs for `finish` function</span></div>
<div class="line"><span class="lineno"> 3514</span>        finish_args = _getfullargspec(finish).args</div>
<div class="line"><span class="lineno"> 3515</span>        finish_kwargs = dict()</div>
<div class="line"><span class="lineno"> 3516</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;full_output&#39;</span> <span class="keywordflow">in</span> finish_args:</div>
<div class="line"><span class="lineno"> 3517</span>            finish_kwargs[<span class="stringliteral">&#39;full_output&#39;</span>] = 1</div>
<div class="line"><span class="lineno"> 3518</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;disp&#39;</span> <span class="keywordflow">in</span> finish_args:</div>
<div class="line"><span class="lineno"> 3519</span>            finish_kwargs[<span class="stringliteral">&#39;disp&#39;</span>] = disp</div>
<div class="line"><span class="lineno"> 3520</span>        <span class="keywordflow">elif</span> <span class="stringliteral">&#39;options&#39;</span> <span class="keywordflow">in</span> finish_args:</div>
<div class="line"><span class="lineno"> 3521</span>            <span class="comment"># pass &#39;disp&#39; as `options`</span></div>
<div class="line"><span class="lineno"> 3522</span>            <span class="comment"># (e.g., if `finish` is `minimize`)</span></div>
<div class="line"><span class="lineno"> 3523</span>            finish_kwargs[<span class="stringliteral">&#39;options&#39;</span>] = {<span class="stringliteral">&#39;disp&#39;</span>: disp}</div>
<div class="line"><span class="lineno"> 3524</span> </div>
<div class="line"><span class="lineno"> 3525</span>        <span class="comment"># run minimizer</span></div>
<div class="line"><span class="lineno"> 3526</span>        res = finish(func, xmin, args=args, **finish_kwargs)</div>
<div class="line"><span class="lineno"> 3527</span> </div>
<div class="line"><span class="lineno"> 3528</span>        <span class="keywordflow">if</span> isinstance(res, OptimizeResult):</div>
<div class="line"><span class="lineno"> 3529</span>            xmin = res.x</div>
<div class="line"><span class="lineno"> 3530</span>            Jmin = res.fun</div>
<div class="line"><span class="lineno"> 3531</span>            success = res.success</div>
<div class="line"><span class="lineno"> 3532</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3533</span>            xmin = res[0]</div>
<div class="line"><span class="lineno"> 3534</span>            Jmin = res[1]</div>
<div class="line"><span class="lineno"> 3535</span>            success = res[-1] == 0</div>
<div class="line"><span class="lineno"> 3536</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> success:</div>
<div class="line"><span class="lineno"> 3537</span>            <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 3538</span>                warnings.warn(</div>
<div class="line"><span class="lineno"> 3539</span>                    <span class="stringliteral">&quot;Either final optimization did not succeed &quot;</span></div>
<div class="line"><span class="lineno"> 3540</span>                    <span class="stringliteral">&quot;or `finish` does not return `statuscode` as its last &quot;</span></div>
<div class="line"><span class="lineno"> 3541</span>                    <span class="stringliteral">&quot;argument.&quot;</span>, RuntimeWarning, 2)</div>
<div class="line"><span class="lineno"> 3542</span> </div>
<div class="line"><span class="lineno"> 3543</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno"> 3544</span>        <span class="keywordflow">return</span> xmin, Jmin, grid, Jout</div>
<div class="line"><span class="lineno"> 3545</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3546</span>        <span class="keywordflow">return</span> xmin</div>
<div class="line"><span class="lineno"> 3547</span> </div>
<div class="line"><span class="lineno"> 3548</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fba77c8a7356feafdaff564a7c39b48" name="a5fba77c8a7356feafdaff564a7c39b48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fba77c8a7356feafdaff564a7c39b48">&#9670;&#160;</a></span>check_grad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.check_grad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direction</em> = <code>'all'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the correctness of a gradient function by comparing it against a
(forward) finite-difference approximation of the gradient.

Parameters
----------
func : callable ``func(x0, *args)``
    Function whose derivative is to be checked.
grad : callable ``grad(x0, *args)``
    Jacobian of `func`.
x0 : ndarray
    Points to check `grad` against forward difference approximation of grad
    using `func`.
args : \\*args, optional
    Extra arguments passed to `func` and `grad`.
epsilon : float, optional
    Step size used for the finite difference approximation. It defaults to
    ``sqrt(np.finfo(float).eps)``, which is approximately 1.49e-08.
direction : str, optional
    If set to ``'random'``, then gradients along a random vector
    are used to check `grad` against forward difference approximation
    using `func`. By default it is ``'all'``, in which case, all
    the one hot direction vectors are considered to check `grad`.
    If `func` is a vector valued function then only ``'all'`` can be used.
seed : {None, int, `numpy.random.Generator`,
        `numpy.random.RandomState`}, optional

    If `seed` is None (or `np.random`), the `numpy.random.RandomState`
    singleton is used.
    If `seed` is an int, a new ``RandomState`` instance is used,
    seeded with `seed`.
    If `seed` is already a ``Generator`` or ``RandomState`` instance then
    that instance is used.
    Specify `seed` for reproducing the return value from this function.
    The random numbers generated with this seed affect the random vector
    along which gradients are computed to check ``grad``. Note that `seed`
    is only used when `direction` argument is set to `'random'`.

Returns
-------
err : float
    The square root of the sum of squares (i.e., the 2-norm) of the
    difference between ``grad(x0, *args)`` and the finite difference
    approximation of `grad` using func at the points `x0`.

See Also
--------
approx_fprime

Examples
--------
&gt;&gt;&gt; def func(x):
...     return x[0]**2 - 0.5 * x[1]**3
&gt;&gt;&gt; def grad(x):
...     return [2 * x[0], -1.5 * x[1]**2]
&gt;&gt;&gt; from scipy.optimize import check_grad
&gt;&gt;&gt; check_grad(func, grad, [1.5, -1.5])
2.9802322387695312e-08  # may vary
&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; check_grad(func, grad, [1.5, -1.5],
...             direction='random', seed=rng)
2.9802322387695312e-08</pre> <div class="fragment"><div class="line"><span class="lineno">  965</span>                direction=<span class="stringliteral">&#39;all&#39;</span>, seed=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  966</span>    <span class="stringliteral">&quot;&quot;&quot;Check the correctness of a gradient function by comparing it against a</span></div>
<div class="line"><span class="lineno">  967</span><span class="stringliteral">    (forward) finite-difference approximation of the gradient.</span></div>
<div class="line"><span class="lineno">  968</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  969</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral">    func : callable ``func(x0, *args)``</span></div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral">        Function whose derivative is to be checked.</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">    grad : callable ``grad(x0, *args)``</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">        Jacobian of `func`.</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">        Points to check `grad` against forward difference approximation of grad</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">        using `func`.</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">    args : \\*args, optional</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">        Extra arguments passed to `func` and `grad`.</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">    epsilon : float, optional</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">        Step size used for the finite difference approximation. It defaults to</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">        ``sqrt(np.finfo(float).eps)``, which is approximately 1.49e-08.</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">    direction : str, optional</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">        If set to ``&#39;random&#39;``, then gradients along a random vector</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">        are used to check `grad` against forward difference approximation</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral">        using `func`. By default it is ``&#39;all&#39;``, in which case, all</span></div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">        the one hot direction vectors are considered to check `grad`.</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">        If `func` is a vector valued function then only ``&#39;all&#39;`` can be used.</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">    seed : {None, int, `numpy.random.Generator`,</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">            `numpy.random.RandomState`}, optional</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">        If `seed` is None (or `np.random`), the `numpy.random.RandomState`</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">        singleton is used.</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">        If `seed` is an int, a new ``RandomState`` instance is used,</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral">        seeded with `seed`.</span></div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">        If `seed` is already a ``Generator`` or ``RandomState`` instance then</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral">        that instance is used.</span></div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">        Specify `seed` for reproducing the return value from this function.</span></div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">        The random numbers generated with this seed affect the random vector</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">        along which gradients are computed to check ``grad``. Note that `seed`</span></div>
<div class="line"><span class="lineno"> 1001</span><span class="stringliteral">        is only used when `direction` argument is set to `&#39;random&#39;`.</span></div>
<div class="line"><span class="lineno"> 1002</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1003</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1004</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="stringliteral">    err : float</span></div>
<div class="line"><span class="lineno"> 1006</span><span class="stringliteral">        The square root of the sum of squares (i.e., the 2-norm) of the</span></div>
<div class="line"><span class="lineno"> 1007</span><span class="stringliteral">        difference between ``grad(x0, *args)`` and the finite difference</span></div>
<div class="line"><span class="lineno"> 1008</span><span class="stringliteral">        approximation of `grad` using func at the points `x0`.</span></div>
<div class="line"><span class="lineno"> 1009</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1010</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral">    approx_fprime</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1016</span><span class="stringliteral">    &gt;&gt;&gt; def func(x):</span></div>
<div class="line"><span class="lineno"> 1017</span><span class="stringliteral">    ...     return x[0]**2 - 0.5 * x[1]**3</span></div>
<div class="line"><span class="lineno"> 1018</span><span class="stringliteral">    &gt;&gt;&gt; def grad(x):</span></div>
<div class="line"><span class="lineno"> 1019</span><span class="stringliteral">    ...     return [2 * x[0], -1.5 * x[1]**2]</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import check_grad</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral">    &gt;&gt;&gt; check_grad(func, grad, [1.5, -1.5])</span></div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral">    2.9802322387695312e-08  # may vary</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral">    &gt;&gt;&gt; rng = np.random.default_rng()</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral">    &gt;&gt;&gt; check_grad(func, grad, [1.5, -1.5],</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral">    ...             direction=&#39;random&#39;, seed=rng)</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="stringliteral">    2.9802322387695312e-08</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1028</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1029</span>    step = epsilon</div>
<div class="line"><span class="lineno"> 1030</span>    x0 = np.asarray(x0)</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#aeb0d2dd2a2609d5775607acf542b2161">g</a>(w, func, x0, v, *args):</div>
<div class="line"><span class="lineno"> 1033</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x0 + w*v, *args)</div>
<div class="line"><span class="lineno"> 1034</span> </div>
<div class="line"><span class="lineno"> 1035</span>    <span class="keywordflow">if</span> direction == <span class="stringliteral">&#39;random&#39;</span>:</div>
<div class="line"><span class="lineno"> 1036</span>        _grad = np.asanyarray(grad(x0, *args))</div>
<div class="line"><span class="lineno"> 1037</span>        <span class="keywordflow">if</span> _grad.ndim &gt; 1:</div>
<div class="line"><span class="lineno"> 1038</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;random&#39; can only be used with scalar valued&quot;</span></div>
<div class="line"><span class="lineno"> 1039</span>                             <span class="stringliteral">&quot; func&quot;</span>)</div>
<div class="line"><span class="lineno"> 1040</span>        random_state = check_random_state(seed)</div>
<div class="line"><span class="lineno"> 1041</span>        v = random_state.normal(0, 1, size=(x0.shape))</div>
<div class="line"><span class="lineno"> 1042</span>        _args = (func, x0, v) + args</div>
<div class="line"><span class="lineno"> 1043</span>        _func = g</div>
<div class="line"><span class="lineno"> 1044</span>        vars = np.zeros((1,))</div>
<div class="line"><span class="lineno"> 1045</span>        analytical_grad = np.dot(_grad, v)</div>
<div class="line"><span class="lineno"> 1046</span>    <span class="keywordflow">elif</span> direction == <span class="stringliteral">&#39;all&#39;</span>:</div>
<div class="line"><span class="lineno"> 1047</span>        _args = args</div>
<div class="line"><span class="lineno"> 1048</span>        _func = func</div>
<div class="line"><span class="lineno"> 1049</span>        vars = x0</div>
<div class="line"><span class="lineno"> 1050</span>        analytical_grad = grad(x0, *args)</div>
<div class="line"><span class="lineno"> 1051</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1052</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;{} is not a valid string for &quot;</span></div>
<div class="line"><span class="lineno"> 1053</span>                         <span class="stringliteral">&quot;``direction`` argument&quot;</span>.format(direction))</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>    <span class="keywordflow">return</span> np.sqrt(np.sum(np.abs(</div>
<div class="line"><span class="lineno"> 1056</span>        (analytical_grad - approx_fprime(vars, _func, step, *_args))**2</div>
<div class="line"><span class="lineno"> 1057</span>    )))</div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_aeb0d2dd2a2609d5775607acf542b2161"><div class="ttname"><a href="__lapack__subroutines_8h.html#aeb0d2dd2a2609d5775607acf542b2161">g</a></div><div class="ttdeci">void npy_complex64 * g</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:284</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c8825f72fbb699b9d86a64dfd7f2d5b" name="a1c8825f72fbb699b9d86a64dfd7f2d5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c8825f72fbb699b9d86a64dfd7f2d5b">&#9670;&#160;</a></span>fmin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.fmin </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfun</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>retall</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>initial_simplex</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Minimize a function using the downhill simplex algorithm.

This algorithm only uses function values, not derivatives or second
derivatives.

Parameters
----------
func : callable func(x,*args)
    The objective function to be minimized.
x0 : ndarray
    Initial guess.
args : tuple, optional
    Extra arguments passed to func, i.e., ``f(x,*args)``.
xtol : float, optional
    Absolute error in xopt between iterations that is acceptable for
    convergence.
ftol : number, optional
    Absolute error in func(xopt) between iterations that is acceptable for
    convergence.
maxiter : int, optional
    Maximum number of iterations to perform.
maxfun : number, optional
    Maximum number of function evaluations to make.
full_output : bool, optional
    Set to True if fopt and warnflag outputs are desired.
disp : bool, optional
    Set to True to print convergence messages.
retall : bool, optional
    Set to True to return list of solutions at each iteration.
callback : callable, optional
    Called after each iteration, as callback(xk), where xk is the
    current parameter vector.
initial_simplex : array_like of shape (N + 1, N), optional
    Initial simplex. If given, overrides `x0`.
    ``initial_simplex[j,:]`` should contain the coordinates of
    the jth vertex of the ``N+1`` vertices in the simplex, where
    ``N`` is the dimension.

Returns
-------
xopt : ndarray
    Parameter that minimizes function.
fopt : float
    Value of function at minimum: ``fopt = func(xopt)``.
iter : int
    Number of iterations performed.
funcalls : int
    Number of function calls made.
warnflag : int
    1 : Maximum number of function evaluations made.
    2 : Maximum number of iterations reached.
allvecs : list
    Solution at each iteration.

See also
--------
minimize: Interface to minimization algorithms for multivariate
    functions. See the 'Nelder-Mead' `method` in particular.

Notes
-----
Uses a Nelder-Mead simplex algorithm to find the minimum of function of
one or more variables.

This algorithm has a long history of successful use in applications.
But it will usually be slower than an algorithm that uses first or
second derivative information. In practice, it can have poor
performance in high-dimensional problems and is not robust to
minimizing complicated functions. Additionally, there currently is no
complete theory describing when the algorithm will successfully
converge to the minimum, or how fast it will if it does. Both the ftol and
xtol criteria must be met for convergence.

Examples
--------
&gt;&gt;&gt; def f(x):
...     return x**2

&gt;&gt;&gt; from scipy import optimize

&gt;&gt;&gt; minimum = optimize.fmin(f, 1)
Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 17
         Function evaluations: 34
&gt;&gt;&gt; minimum[0]
-8.8817841970012523e-16

References
----------
.. [1] Nelder, J.A. and Mead, R. (1965), "A simplex method for function
       minimization", The Computer Journal, 7, pp. 308-313

.. [2] Wright, M.H. (1996), "Direct Search Methods: Once Scorned, Now
       Respectable", in Numerical Analysis 1995, Proceedings of the
       1995 Dundee Biennial Conference in Numerical Analysis, D.F.
       Griffiths and G.A. Watson (Eds.), Addison Wesley Longman,
       Harlow, UK, pp. 191-208.</pre> <div class="fragment"><div class="line"><span class="lineno">  512</span>         full_output=0, disp=1, retall=0, callback=<span class="keywordtype">None</span>, initial_simplex=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  513</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">    Minimize a function using the downhill simplex algorithm.</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">    This algorithm only uses function values, not derivatives or second</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">    derivatives.</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">    func : callable func(x,*args)</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">        The objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">        Initial guess.</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">        Extra arguments passed to func, i.e., ``f(x,*args)``.</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    xtol : float, optional</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">        Absolute error in xopt between iterations that is acceptable for</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">        convergence.</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    ftol : number, optional</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">        Absolute error in func(xopt) between iterations that is acceptable for</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">        convergence.</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral">    maxfun : number, optional</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">        Maximum number of function evaluations to make.</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral">        Set to True if fopt and warnflag outputs are desired.</span></div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">    disp : bool, optional</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral">        Set to True to print convergence messages.</span></div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">    retall : bool, optional</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">        Set to True to return list of solutions at each iteration.</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">        Called after each iteration, as callback(xk), where xk is the</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">        current parameter vector.</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">    initial_simplex : array_like of shape (N + 1, N), optional</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">        Initial simplex. If given, overrides `x0`.</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">        ``initial_simplex[j,:]`` should contain the coordinates of</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">        the jth vertex of the ``N+1`` vertices in the simplex, where</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">        ``N`` is the dimension.</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">    xopt : ndarray</span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">        Parameter that minimizes function.</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">    fopt : float</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">        Value of function at minimum: ``fopt = func(xopt)``.</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">    iter : int</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">        Number of iterations performed.</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">    funcalls : int</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        Number of function calls made.</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">    warnflag : int</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">        1 : Maximum number of function evaluations made.</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">        2 : Maximum number of iterations reached.</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">    allvecs : list</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">        Solution at each iteration.</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">    minimize: Interface to minimization algorithms for multivariate</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">        functions. See the &#39;Nelder-Mead&#39; `method` in particular.</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">    Uses a Nelder-Mead simplex algorithm to find the minimum of function of</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">    one or more variables.</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">    This algorithm has a long history of successful use in applications.</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">    But it will usually be slower than an algorithm that uses first or</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">    second derivative information. In practice, it can have poor</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">    performance in high-dimensional problems and is not robust to</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">    minimizing complicated functions. Additionally, there currently is no</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral">    complete theory describing when the algorithm will successfully</span></div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">    converge to the minimum, or how fast it will if it does. Both the ftol and</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">    xtol criteria must be met for convergence.</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">    &gt;&gt;&gt; def f(x):</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">    ...     return x**2</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">    &gt;&gt;&gt; minimum = optimize.fmin(f, 1)</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">    Optimization terminated successfully.</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral">             Current function value: 0.000000</span></div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral">             Iterations: 17</span></div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">             Function evaluations: 34</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">    &gt;&gt;&gt; minimum[0]</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral">    -8.8817841970012523e-16</span></div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">    .. [1] Nelder, J.A. and Mead, R. (1965), &quot;A simplex method for function</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">           minimization&quot;, The Computer Journal, 7, pp. 308-313</span></div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">    .. [2] Wright, M.H. (1996), &quot;Direct Search Methods: Once Scorned, Now</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">           Respectable&quot;, in Numerical Analysis 1995, Proceedings of the</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral">           1995 Dundee Biennial Conference in Numerical Analysis, D.F.</span></div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral">           Griffiths and G.A. Watson (Eds.), Addison Wesley Longman,</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">           Harlow, UK, pp. 191-208.</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  614</span>    opts = {<span class="stringliteral">&#39;xatol&#39;</span>: xtol,</div>
<div class="line"><span class="lineno">  615</span>            <span class="stringliteral">&#39;fatol&#39;</span>: ftol,</div>
<div class="line"><span class="lineno">  616</span>            <span class="stringliteral">&#39;maxiter&#39;</span>: maxiter,</div>
<div class="line"><span class="lineno">  617</span>            <span class="stringliteral">&#39;maxfev&#39;</span>: maxfun,</div>
<div class="line"><span class="lineno">  618</span>            <span class="stringliteral">&#39;disp&#39;</span>: disp,</div>
<div class="line"><span class="lineno">  619</span>            <span class="stringliteral">&#39;return_all&#39;</span>: retall,</div>
<div class="line"><span class="lineno">  620</span>            <span class="stringliteral">&#39;initial_simplex&#39;</span>: initial_simplex}</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    res = _minimize_neldermead(func, x0, args, callback=callback, **opts)</div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno">  624</span>        retlist = res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;fun&#39;</span>], res[<span class="stringliteral">&#39;nit&#39;</span>], res[<span class="stringliteral">&#39;nfev&#39;</span>], res[<span class="stringliteral">&#39;status&#39;</span>]</div>
<div class="line"><span class="lineno">  625</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno">  626</span>            retlist += (res[<span class="stringliteral">&#39;allvecs&#39;</span>], )</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordflow">return</span> retlist</div>
<div class="line"><span class="lineno">  628</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  629</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno">  630</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;allvecs&#39;</span>]</div>
<div class="line"><span class="lineno">  631</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  632</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acc7548b50584733437750426a25476c2" name="acc7548b50584733437750426a25476c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc7548b50584733437750426a25476c2">&#9670;&#160;</a></span>fmin_bfgs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.fmin_bfgs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fprime</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gtol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>Inf</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>retall</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Minimize a function using the BFGS algorithm.

Parameters
----------
f : callable ``f(x,*args)``
    Objective function to be minimized.
x0 : ndarray
    Initial guess.
fprime : callable ``f'(x,*args)``, optional
    Gradient of f.
args : tuple, optional
    Extra arguments passed to f and fprime.
gtol : float, optional
    Gradient norm must be less than `gtol` before successful termination.
norm : float, optional
    Order of norm (Inf is max, -Inf is min)
epsilon : int or ndarray, optional
    If `fprime` is approximated, use this value for the step size.
callback : callable, optional
    An optional user-supplied function to call after each
    iteration. Called as ``callback(xk)``, where ``xk`` is the
    current parameter vector.
maxiter : int, optional
    Maximum number of iterations to perform.
full_output : bool, optional
    If True, return ``fopt``, ``func_calls``, ``grad_calls``, and
    ``warnflag`` in addition to ``xopt``.
disp : bool, optional
    Print convergence message if True.
retall : bool, optional
    Return a list of results at each iteration if True.

Returns
-------
xopt : ndarray
    Parameters which minimize f, i.e., ``f(xopt) == fopt``.
fopt : float
    Minimum value.
gopt : ndarray
    Value of gradient at minimum, f'(xopt), which should be near 0.
Bopt : ndarray
    Value of 1/f''(xopt), i.e., the inverse Hessian matrix.
func_calls : int
    Number of function_calls made.
grad_calls : int
    Number of gradient calls made.
warnflag : integer
    1 : Maximum number of iterations exceeded.
    2 : Gradient and/or function calls not changing.
    3 : NaN result encountered.
allvecs : list
    The value of `xopt` at each iteration. Only returned if `retall` is
    True.

Notes
-----
Optimize the function, `f`, whose gradient is given by `fprime`
using the quasi-Newton method of Broyden, Fletcher, Goldfarb,
and Shanno (BFGS).

See Also
--------
minimize: Interface to minimization algorithms for multivariate
    functions. See ``method='BFGS'`` in particular.

References
----------
Wright, and Nocedal 'Numerical Optimization', 1999, p. 198.

Examples
--------
&gt;&gt;&gt; from scipy.optimize import fmin_bfgs
&gt;&gt;&gt; def quadratic_cost(x, Q):
...     return x @ Q @ x
...
&gt;&gt;&gt; x0 = np.array([-3, -4])
&gt;&gt;&gt; cost_weight =  np.diag([1., 10.])
&gt;&gt;&gt; # Note that a trailing comma is necessary for a tuple with single element
&gt;&gt;&gt; fmin_bfgs(quadratic_cost, x0, args=(cost_weight,))
Optimization terminated successfully.
        Current function value: 0.000000
        Iterations: 7                   # may vary
        Function evaluations: 24        # may vary
        Gradient evaluations: 8         # may vary
array([ 2.85169950e-06, -4.61820139e-07])

&gt;&gt;&gt; def quadratic_cost_grad(x, Q):
...     return 2 * Q @ x
...
&gt;&gt;&gt; fmin_bfgs(quadratic_cost, x0, quadratic_cost_grad, args=(cost_weight,))
Optimization terminated successfully.
        Current function value: 0.000000
        Iterations: 7
        Function evaluations: 8
        Gradient evaluations: 8
array([ 2.85916637e-06, -4.54371951e-07])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1118</span>              retall=0, callback=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1119</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1120</span><span class="stringliteral">    Minimize a function using the BFGS algorithm.</span></div>
<div class="line"><span class="lineno"> 1121</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1122</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1123</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1124</span><span class="stringliteral">    f : callable ``f(x,*args)``</span></div>
<div class="line"><span class="lineno"> 1125</span><span class="stringliteral">        Objective function to be minimized.</span></div>
<div class="line"><span class="lineno"> 1126</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno"> 1127</span><span class="stringliteral">        Initial guess.</span></div>
<div class="line"><span class="lineno"> 1128</span><span class="stringliteral">    fprime : callable ``f&#39;(x,*args)``, optional</span></div>
<div class="line"><span class="lineno"> 1129</span><span class="stringliteral">        Gradient of f.</span></div>
<div class="line"><span class="lineno"> 1130</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 1131</span><span class="stringliteral">        Extra arguments passed to f and fprime.</span></div>
<div class="line"><span class="lineno"> 1132</span><span class="stringliteral">    gtol : float, optional</span></div>
<div class="line"><span class="lineno"> 1133</span><span class="stringliteral">        Gradient norm must be less than `gtol` before successful termination.</span></div>
<div class="line"><span class="lineno"> 1134</span><span class="stringliteral">    norm : float, optional</span></div>
<div class="line"><span class="lineno"> 1135</span><span class="stringliteral">        Order of norm (Inf is max, -Inf is min)</span></div>
<div class="line"><span class="lineno"> 1136</span><span class="stringliteral">    epsilon : int or ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1137</span><span class="stringliteral">        If `fprime` is approximated, use this value for the step size.</span></div>
<div class="line"><span class="lineno"> 1138</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno"> 1139</span><span class="stringliteral">        An optional user-supplied function to call after each</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="stringliteral">        iteration. Called as ``callback(xk)``, where ``xk`` is the</span></div>
<div class="line"><span class="lineno"> 1141</span><span class="stringliteral">        current parameter vector.</span></div>
<div class="line"><span class="lineno"> 1142</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno"> 1145</span><span class="stringliteral">        If True, return ``fopt``, ``func_calls``, ``grad_calls``, and</span></div>
<div class="line"><span class="lineno"> 1146</span><span class="stringliteral">        ``warnflag`` in addition to ``xopt``.</span></div>
<div class="line"><span class="lineno"> 1147</span><span class="stringliteral">    disp : bool, optional</span></div>
<div class="line"><span class="lineno"> 1148</span><span class="stringliteral">        Print convergence message if True.</span></div>
<div class="line"><span class="lineno"> 1149</span><span class="stringliteral">    retall : bool, optional</span></div>
<div class="line"><span class="lineno"> 1150</span><span class="stringliteral">        Return a list of results at each iteration if True.</span></div>
<div class="line"><span class="lineno"> 1151</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1152</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1153</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1154</span><span class="stringliteral">    xopt : ndarray</span></div>
<div class="line"><span class="lineno"> 1155</span><span class="stringliteral">        Parameters which minimize f, i.e., ``f(xopt) == fopt``.</span></div>
<div class="line"><span class="lineno"> 1156</span><span class="stringliteral">    fopt : float</span></div>
<div class="line"><span class="lineno"> 1157</span><span class="stringliteral">        Minimum value.</span></div>
<div class="line"><span class="lineno"> 1158</span><span class="stringliteral">    gopt : ndarray</span></div>
<div class="line"><span class="lineno"> 1159</span><span class="stringliteral">        Value of gradient at minimum, f&#39;(xopt), which should be near 0.</span></div>
<div class="line"><span class="lineno"> 1160</span><span class="stringliteral">    Bopt : ndarray</span></div>
<div class="line"><span class="lineno"> 1161</span><span class="stringliteral">        Value of 1/f&#39;&#39;(xopt), i.e., the inverse Hessian matrix.</span></div>
<div class="line"><span class="lineno"> 1162</span><span class="stringliteral">    func_calls : int</span></div>
<div class="line"><span class="lineno"> 1163</span><span class="stringliteral">        Number of function_calls made.</span></div>
<div class="line"><span class="lineno"> 1164</span><span class="stringliteral">    grad_calls : int</span></div>
<div class="line"><span class="lineno"> 1165</span><span class="stringliteral">        Number of gradient calls made.</span></div>
<div class="line"><span class="lineno"> 1166</span><span class="stringliteral">    warnflag : integer</span></div>
<div class="line"><span class="lineno"> 1167</span><span class="stringliteral">        1 : Maximum number of iterations exceeded.</span></div>
<div class="line"><span class="lineno"> 1168</span><span class="stringliteral">        2 : Gradient and/or function calls not changing.</span></div>
<div class="line"><span class="lineno"> 1169</span><span class="stringliteral">        3 : NaN result encountered.</span></div>
<div class="line"><span class="lineno"> 1170</span><span class="stringliteral">    allvecs : list</span></div>
<div class="line"><span class="lineno"> 1171</span><span class="stringliteral">        The value of `xopt` at each iteration. Only returned if `retall` is</span></div>
<div class="line"><span class="lineno"> 1172</span><span class="stringliteral">        True.</span></div>
<div class="line"><span class="lineno"> 1173</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1174</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1175</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1176</span><span class="stringliteral">    Optimize the function, `f`, whose gradient is given by `fprime`</span></div>
<div class="line"><span class="lineno"> 1177</span><span class="stringliteral">    using the quasi-Newton method of Broyden, Fletcher, Goldfarb,</span></div>
<div class="line"><span class="lineno"> 1178</span><span class="stringliteral">    and Shanno (BFGS).</span></div>
<div class="line"><span class="lineno"> 1179</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1180</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1181</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1182</span><span class="stringliteral">    minimize: Interface to minimization algorithms for multivariate</span></div>
<div class="line"><span class="lineno"> 1183</span><span class="stringliteral">        functions. See ``method=&#39;BFGS&#39;`` in particular.</span></div>
<div class="line"><span class="lineno"> 1184</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1185</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1186</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1187</span><span class="stringliteral">    Wright, and Nocedal &#39;Numerical Optimization&#39;, 1999, p. 198.</span></div>
<div class="line"><span class="lineno"> 1188</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1189</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1190</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1191</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import fmin_bfgs</span></div>
<div class="line"><span class="lineno"> 1192</span><span class="stringliteral">    &gt;&gt;&gt; def quadratic_cost(x, Q):</span></div>
<div class="line"><span class="lineno"> 1193</span><span class="stringliteral">    ...     return x @ Q @ x</span></div>
<div class="line"><span class="lineno"> 1194</span><span class="stringliteral">    ...</span></div>
<div class="line"><span class="lineno"> 1195</span><span class="stringliteral">    &gt;&gt;&gt; x0 = np.array([-3, -4])</span></div>
<div class="line"><span class="lineno"> 1196</span><span class="stringliteral">    &gt;&gt;&gt; cost_weight =  np.diag([1., 10.])</span></div>
<div class="line"><span class="lineno"> 1197</span><span class="stringliteral">    &gt;&gt;&gt; # Note that a trailing comma is necessary for a tuple with single element</span></div>
<div class="line"><span class="lineno"> 1198</span><span class="stringliteral">    &gt;&gt;&gt; fmin_bfgs(quadratic_cost, x0, args=(cost_weight,))</span></div>
<div class="line"><span class="lineno"> 1199</span><span class="stringliteral">    Optimization terminated successfully.</span></div>
<div class="line"><span class="lineno"> 1200</span><span class="stringliteral">            Current function value: 0.000000</span></div>
<div class="line"><span class="lineno"> 1201</span><span class="stringliteral">            Iterations: 7                   # may vary</span></div>
<div class="line"><span class="lineno"> 1202</span><span class="stringliteral">            Function evaluations: 24        # may vary</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="stringliteral">            Gradient evaluations: 8         # may vary</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">    array([ 2.85169950e-06, -4.61820139e-07])</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">    &gt;&gt;&gt; def quadratic_cost_grad(x, Q):</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="stringliteral">    ...     return 2 * Q @ x</span></div>
<div class="line"><span class="lineno"> 1208</span><span class="stringliteral">    ...</span></div>
<div class="line"><span class="lineno"> 1209</span><span class="stringliteral">    &gt;&gt;&gt; fmin_bfgs(quadratic_cost, x0, quadratic_cost_grad, args=(cost_weight,))</span></div>
<div class="line"><span class="lineno"> 1210</span><span class="stringliteral">    Optimization terminated successfully.</span></div>
<div class="line"><span class="lineno"> 1211</span><span class="stringliteral">            Current function value: 0.000000</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="stringliteral">            Iterations: 7</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="stringliteral">            Function evaluations: 8</span></div>
<div class="line"><span class="lineno"> 1214</span><span class="stringliteral">            Gradient evaluations: 8</span></div>
<div class="line"><span class="lineno"> 1215</span><span class="stringliteral">    array([ 2.85916637e-06, -4.54371951e-07])</span></div>
<div class="line"><span class="lineno"> 1216</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1217</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1218</span>    opts = {<span class="stringliteral">&#39;gtol&#39;</span>: gtol,</div>
<div class="line"><span class="lineno"> 1219</span>            <span class="stringliteral">&#39;norm&#39;</span>: norm,</div>
<div class="line"><span class="lineno"> 1220</span>            <span class="stringliteral">&#39;eps&#39;</span>: epsilon,</div>
<div class="line"><span class="lineno"> 1221</span>            <span class="stringliteral">&#39;disp&#39;</span>: disp,</div>
<div class="line"><span class="lineno"> 1222</span>            <span class="stringliteral">&#39;maxiter&#39;</span>: maxiter,</div>
<div class="line"><span class="lineno"> 1223</span>            <span class="stringliteral">&#39;return_all&#39;</span>: retall}</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span>    res = _minimize_bfgs(f, x0, args, fprime, callback=callback, **opts)</div>
<div class="line"><span class="lineno"> 1226</span> </div>
<div class="line"><span class="lineno"> 1227</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno"> 1228</span>        retlist = (res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;fun&#39;</span>], res[<span class="stringliteral">&#39;jac&#39;</span>], res[<span class="stringliteral">&#39;hess_inv&#39;</span>],</div>
<div class="line"><span class="lineno"> 1229</span>                   res[<span class="stringliteral">&#39;nfev&#39;</span>], res[<span class="stringliteral">&#39;njev&#39;</span>], res[<span class="stringliteral">&#39;status&#39;</span>])</div>
<div class="line"><span class="lineno"> 1230</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1231</span>            retlist += (res[<span class="stringliteral">&#39;allvecs&#39;</span>], )</div>
<div class="line"><span class="lineno"> 1232</span>        <span class="keywordflow">return</span> retlist</div>
<div class="line"><span class="lineno"> 1233</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1234</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1235</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;allvecs&#39;</span>]</div>
<div class="line"><span class="lineno"> 1236</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1237</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af6dce6d9178c7f8c0528157dc1b54df4" name="af6dce6d9178c7f8c0528157dc1b54df4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6dce6d9178c7f8c0528157dc1b54df4">&#9670;&#160;</a></span>fmin_cg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.fmin_cg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fprime</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gtol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>Inf</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>retall</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Minimize a function using a nonlinear conjugate gradient algorithm.

Parameters
----------
f : callable, ``f(x, *args)``
    Objective function to be minimized. Here `x` must be a 1-D array of
    the variables that are to be changed in the search for a minimum, and
    `args` are the other (fixed) parameters of `f`.
x0 : ndarray
    A user-supplied initial estimate of `xopt`, the optimal value of `x`.
    It must be a 1-D array of values.
fprime : callable, ``fprime(x, *args)``, optional
    A function that returns the gradient of `f` at `x`. Here `x` and `args`
    are as described above for `f`. The returned value must be a 1-D array.
    Defaults to None, in which case the gradient is approximated
    numerically (see `epsilon`, below).
args : tuple, optional
    Parameter values passed to `f` and `fprime`. Must be supplied whenever
    additional fixed parameters are needed to completely specify the
    functions `f` and `fprime`.
gtol : float, optional
    Stop when the norm of the gradient is less than `gtol`.
norm : float, optional
    Order to use for the norm of the gradient
    (``-np.Inf`` is min, ``np.Inf`` is max).
epsilon : float or ndarray, optional
    Step size(s) to use when `fprime` is approximated numerically. Can be a
    scalar or a 1-D array. Defaults to ``sqrt(eps)``, with eps the
    floating point machine precision.  Usually ``sqrt(eps)`` is about
    1.5e-8.
maxiter : int, optional
    Maximum number of iterations to perform. Default is ``200 * len(x0)``.
full_output : bool, optional
    If True, return `fopt`, `func_calls`, `grad_calls`, and `warnflag` in
    addition to `xopt`.  See the Returns section below for additional
    information on optional return values.
disp : bool, optional
    If True, return a convergence message, followed by `xopt`.
retall : bool, optional
    If True, add to the returned values the results of each iteration.
callback : callable, optional
    An optional user-supplied function, called after each iteration.
    Called as ``callback(xk)``, where ``xk`` is the current value of `x0`.

Returns
-------
xopt : ndarray
    Parameters which minimize f, i.e., ``f(xopt) == fopt``.
fopt : float, optional
    Minimum value found, f(xopt). Only returned if `full_output` is True.
func_calls : int, optional
    The number of function_calls made. Only returned if `full_output`
    is True.
grad_calls : int, optional
    The number of gradient calls made. Only returned if `full_output` is
    True.
warnflag : int, optional
    Integer value with warning status, only returned if `full_output` is
    True.

    0 : Success.

    1 : The maximum number of iterations was exceeded.

    2 : Gradient and/or function calls were not changing. May indicate
        that precision was lost, i.e., the routine did not converge.

    3 : NaN result encountered.

allvecs : list of ndarray, optional
    List of arrays, containing the results at each iteration.
    Only returned if `retall` is True.

See Also
--------
minimize : common interface to all `scipy.optimize` algorithms for
           unconstrained and constrained minimization of multivariate
           functions. It provides an alternative way to call
           ``fmin_cg``, by specifying ``method='CG'``.

Notes
-----
This conjugate gradient algorithm is based on that of Polak and Ribiere
[1]_.

Conjugate gradient methods tend to work better when:

1. `f` has a unique global minimizing point, and no local minima or
   other stationary points,
2. `f` is, at least locally, reasonably well approximated by a
   quadratic function of the variables,
3. `f` is continuous and has a continuous gradient,
4. `fprime` is not too large, e.g., has a norm less than 1000,
5. The initial guess, `x0`, is reasonably close to `f` 's global
   minimizing point, `xopt`.

References
----------
.. [1] Wright &amp; Nocedal, "Numerical Optimization", 1999, pp. 120-122.

Examples
--------
Example 1: seek the minimum value of the expression
``a*u**2 + b*u*v + c*v**2 + d*u + e*v + f`` for given values
of the parameters and an initial guess ``(u, v) = (0, 0)``.

&gt;&gt;&gt; args = (2, 3, 7, 8, 9, 10)  # parameter values
&gt;&gt;&gt; def f(x, *args):
...     u, v = x
...     a, b, c, d, e, f = args
...     return a*u**2 + b*u*v + c*v**2 + d*u + e*v + f
&gt;&gt;&gt; def gradf(x, *args):
...     u, v = x
...     a, b, c, d, e, f = args
...     gu = 2*a*u + b*v + d     # u-component of the gradient
...     gv = b*u + 2*c*v + e     # v-component of the gradient
...     return np.asarray((gu, gv))
&gt;&gt;&gt; x0 = np.asarray((0, 0))  # Initial guess.
&gt;&gt;&gt; from scipy import optimize
&gt;&gt;&gt; res1 = optimize.fmin_cg(f, x0, fprime=gradf, args=args)
Optimization terminated successfully.
         Current function value: 1.617021
         Iterations: 4
         Function evaluations: 8
         Gradient evaluations: 8
&gt;&gt;&gt; res1
array([-1.80851064, -0.25531915])

Example 2: solve the same problem using the `minimize` function.
(This `myopts` dictionary shows all of the available options,
although in practice only non-default values would be needed.
The returned value will be a dictionary.)

&gt;&gt;&gt; opts = {'maxiter' : None,    # default value.
...         'disp' : True,    # non-default value.
...         'gtol' : 1e-5,    # default value.
...         'norm' : np.inf,  # default value.
...         'eps' : 1.4901161193847656e-08}  # default value.
&gt;&gt;&gt; res2 = optimize.minimize(f, x0, jac=gradf, args=args,
...                          method='CG', options=opts)
Optimization terminated successfully.
        Current function value: 1.617021
        Iterations: 4
        Function evaluations: 8
        Gradient evaluations: 8
&gt;&gt;&gt; res2.x  # minimum found
array([-1.80851064, -0.25531915])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1383</span>            maxiter=<span class="keywordtype">None</span>, full_output=0, disp=1, retall=0, callback=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1384</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1385</span><span class="stringliteral">    Minimize a function using a nonlinear conjugate gradient algorithm.</span></div>
<div class="line"><span class="lineno"> 1386</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1387</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1388</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1389</span><span class="stringliteral">    f : callable, ``f(x, *args)``</span></div>
<div class="line"><span class="lineno"> 1390</span><span class="stringliteral">        Objective function to be minimized. Here `x` must be a 1-D array of</span></div>
<div class="line"><span class="lineno"> 1391</span><span class="stringliteral">        the variables that are to be changed in the search for a minimum, and</span></div>
<div class="line"><span class="lineno"> 1392</span><span class="stringliteral">        `args` are the other (fixed) parameters of `f`.</span></div>
<div class="line"><span class="lineno"> 1393</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno"> 1394</span><span class="stringliteral">        A user-supplied initial estimate of `xopt`, the optimal value of `x`.</span></div>
<div class="line"><span class="lineno"> 1395</span><span class="stringliteral">        It must be a 1-D array of values.</span></div>
<div class="line"><span class="lineno"> 1396</span><span class="stringliteral">    fprime : callable, ``fprime(x, *args)``, optional</span></div>
<div class="line"><span class="lineno"> 1397</span><span class="stringliteral">        A function that returns the gradient of `f` at `x`. Here `x` and `args`</span></div>
<div class="line"><span class="lineno"> 1398</span><span class="stringliteral">        are as described above for `f`. The returned value must be a 1-D array.</span></div>
<div class="line"><span class="lineno"> 1399</span><span class="stringliteral">        Defaults to None, in which case the gradient is approximated</span></div>
<div class="line"><span class="lineno"> 1400</span><span class="stringliteral">        numerically (see `epsilon`, below).</span></div>
<div class="line"><span class="lineno"> 1401</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 1402</span><span class="stringliteral">        Parameter values passed to `f` and `fprime`. Must be supplied whenever</span></div>
<div class="line"><span class="lineno"> 1403</span><span class="stringliteral">        additional fixed parameters are needed to completely specify the</span></div>
<div class="line"><span class="lineno"> 1404</span><span class="stringliteral">        functions `f` and `fprime`.</span></div>
<div class="line"><span class="lineno"> 1405</span><span class="stringliteral">    gtol : float, optional</span></div>
<div class="line"><span class="lineno"> 1406</span><span class="stringliteral">        Stop when the norm of the gradient is less than `gtol`.</span></div>
<div class="line"><span class="lineno"> 1407</span><span class="stringliteral">    norm : float, optional</span></div>
<div class="line"><span class="lineno"> 1408</span><span class="stringliteral">        Order to use for the norm of the gradient</span></div>
<div class="line"><span class="lineno"> 1409</span><span class="stringliteral">        (``-np.Inf`` is min, ``np.Inf`` is max).</span></div>
<div class="line"><span class="lineno"> 1410</span><span class="stringliteral">    epsilon : float or ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1411</span><span class="stringliteral">        Step size(s) to use when `fprime` is approximated numerically. Can be a</span></div>
<div class="line"><span class="lineno"> 1412</span><span class="stringliteral">        scalar or a 1-D array. Defaults to ``sqrt(eps)``, with eps the</span></div>
<div class="line"><span class="lineno"> 1413</span><span class="stringliteral">        floating point machine precision.  Usually ``sqrt(eps)`` is about</span></div>
<div class="line"><span class="lineno"> 1414</span><span class="stringliteral">        1.5e-8.</span></div>
<div class="line"><span class="lineno"> 1415</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno"> 1416</span><span class="stringliteral">        Maximum number of iterations to perform. Default is ``200 * len(x0)``.</span></div>
<div class="line"><span class="lineno"> 1417</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno"> 1418</span><span class="stringliteral">        If True, return `fopt`, `func_calls`, `grad_calls`, and `warnflag` in</span></div>
<div class="line"><span class="lineno"> 1419</span><span class="stringliteral">        addition to `xopt`.  See the Returns section below for additional</span></div>
<div class="line"><span class="lineno"> 1420</span><span class="stringliteral">        information on optional return values.</span></div>
<div class="line"><span class="lineno"> 1421</span><span class="stringliteral">    disp : bool, optional</span></div>
<div class="line"><span class="lineno"> 1422</span><span class="stringliteral">        If True, return a convergence message, followed by `xopt`.</span></div>
<div class="line"><span class="lineno"> 1423</span><span class="stringliteral">    retall : bool, optional</span></div>
<div class="line"><span class="lineno"> 1424</span><span class="stringliteral">        If True, add to the returned values the results of each iteration.</span></div>
<div class="line"><span class="lineno"> 1425</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno"> 1426</span><span class="stringliteral">        An optional user-supplied function, called after each iteration.</span></div>
<div class="line"><span class="lineno"> 1427</span><span class="stringliteral">        Called as ``callback(xk)``, where ``xk`` is the current value of `x0`.</span></div>
<div class="line"><span class="lineno"> 1428</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1429</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1430</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1431</span><span class="stringliteral">    xopt : ndarray</span></div>
<div class="line"><span class="lineno"> 1432</span><span class="stringliteral">        Parameters which minimize f, i.e., ``f(xopt) == fopt``.</span></div>
<div class="line"><span class="lineno"> 1433</span><span class="stringliteral">    fopt : float, optional</span></div>
<div class="line"><span class="lineno"> 1434</span><span class="stringliteral">        Minimum value found, f(xopt). Only returned if `full_output` is True.</span></div>
<div class="line"><span class="lineno"> 1435</span><span class="stringliteral">    func_calls : int, optional</span></div>
<div class="line"><span class="lineno"> 1436</span><span class="stringliteral">        The number of function_calls made. Only returned if `full_output`</span></div>
<div class="line"><span class="lineno"> 1437</span><span class="stringliteral">        is True.</span></div>
<div class="line"><span class="lineno"> 1438</span><span class="stringliteral">    grad_calls : int, optional</span></div>
<div class="line"><span class="lineno"> 1439</span><span class="stringliteral">        The number of gradient calls made. Only returned if `full_output` is</span></div>
<div class="line"><span class="lineno"> 1440</span><span class="stringliteral">        True.</span></div>
<div class="line"><span class="lineno"> 1441</span><span class="stringliteral">    warnflag : int, optional</span></div>
<div class="line"><span class="lineno"> 1442</span><span class="stringliteral">        Integer value with warning status, only returned if `full_output` is</span></div>
<div class="line"><span class="lineno"> 1443</span><span class="stringliteral">        True.</span></div>
<div class="line"><span class="lineno"> 1444</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1445</span><span class="stringliteral">        0 : Success.</span></div>
<div class="line"><span class="lineno"> 1446</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1447</span><span class="stringliteral">        1 : The maximum number of iterations was exceeded.</span></div>
<div class="line"><span class="lineno"> 1448</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1449</span><span class="stringliteral">        2 : Gradient and/or function calls were not changing. May indicate</span></div>
<div class="line"><span class="lineno"> 1450</span><span class="stringliteral">            that precision was lost, i.e., the routine did not converge.</span></div>
<div class="line"><span class="lineno"> 1451</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1452</span><span class="stringliteral">        3 : NaN result encountered.</span></div>
<div class="line"><span class="lineno"> 1453</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1454</span><span class="stringliteral">    allvecs : list of ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1455</span><span class="stringliteral">        List of arrays, containing the results at each iteration.</span></div>
<div class="line"><span class="lineno"> 1456</span><span class="stringliteral">        Only returned if `retall` is True.</span></div>
<div class="line"><span class="lineno"> 1457</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1458</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1459</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1460</span><span class="stringliteral">    minimize : common interface to all `scipy.optimize` algorithms for</span></div>
<div class="line"><span class="lineno"> 1461</span><span class="stringliteral">               unconstrained and constrained minimization of multivariate</span></div>
<div class="line"><span class="lineno"> 1462</span><span class="stringliteral">               functions. It provides an alternative way to call</span></div>
<div class="line"><span class="lineno"> 1463</span><span class="stringliteral">               ``fmin_cg``, by specifying ``method=&#39;CG&#39;``.</span></div>
<div class="line"><span class="lineno"> 1464</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1465</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1466</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1467</span><span class="stringliteral">    This conjugate gradient algorithm is based on that of Polak and Ribiere</span></div>
<div class="line"><span class="lineno"> 1468</span><span class="stringliteral">    [1]_.</span></div>
<div class="line"><span class="lineno"> 1469</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1470</span><span class="stringliteral">    Conjugate gradient methods tend to work better when:</span></div>
<div class="line"><span class="lineno"> 1471</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1472</span><span class="stringliteral">    1. `f` has a unique global minimizing point, and no local minima or</span></div>
<div class="line"><span class="lineno"> 1473</span><span class="stringliteral">       other stationary points,</span></div>
<div class="line"><span class="lineno"> 1474</span><span class="stringliteral">    2. `f` is, at least locally, reasonably well approximated by a</span></div>
<div class="line"><span class="lineno"> 1475</span><span class="stringliteral">       quadratic function of the variables,</span></div>
<div class="line"><span class="lineno"> 1476</span><span class="stringliteral">    3. `f` is continuous and has a continuous gradient,</span></div>
<div class="line"><span class="lineno"> 1477</span><span class="stringliteral">    4. `fprime` is not too large, e.g., has a norm less than 1000,</span></div>
<div class="line"><span class="lineno"> 1478</span><span class="stringliteral">    5. The initial guess, `x0`, is reasonably close to `f` &#39;s global</span></div>
<div class="line"><span class="lineno"> 1479</span><span class="stringliteral">       minimizing point, `xopt`.</span></div>
<div class="line"><span class="lineno"> 1480</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1481</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1482</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1483</span><span class="stringliteral">    .. [1] Wright &amp; Nocedal, &quot;Numerical Optimization&quot;, 1999, pp. 120-122.</span></div>
<div class="line"><span class="lineno"> 1484</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1485</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1486</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1487</span><span class="stringliteral">    Example 1: seek the minimum value of the expression</span></div>
<div class="line"><span class="lineno"> 1488</span><span class="stringliteral">    ``a*u**2 + b*u*v + c*v**2 + d*u + e*v + f`` for given values</span></div>
<div class="line"><span class="lineno"> 1489</span><span class="stringliteral">    of the parameters and an initial guess ``(u, v) = (0, 0)``.</span></div>
<div class="line"><span class="lineno"> 1490</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1491</span><span class="stringliteral">    &gt;&gt;&gt; args = (2, 3, 7, 8, 9, 10)  # parameter values</span></div>
<div class="line"><span class="lineno"> 1492</span><span class="stringliteral">    &gt;&gt;&gt; def f(x, *args):</span></div>
<div class="line"><span class="lineno"> 1493</span><span class="stringliteral">    ...     u, v = x</span></div>
<div class="line"><span class="lineno"> 1494</span><span class="stringliteral">    ...     a, b, c, d, e, f = args</span></div>
<div class="line"><span class="lineno"> 1495</span><span class="stringliteral">    ...     return a*u**2 + b*u*v + c*v**2 + d*u + e*v + f</span></div>
<div class="line"><span class="lineno"> 1496</span><span class="stringliteral">    &gt;&gt;&gt; def gradf(x, *args):</span></div>
<div class="line"><span class="lineno"> 1497</span><span class="stringliteral">    ...     u, v = x</span></div>
<div class="line"><span class="lineno"> 1498</span><span class="stringliteral">    ...     a, b, c, d, e, f = args</span></div>
<div class="line"><span class="lineno"> 1499</span><span class="stringliteral">    ...     gu = 2*a*u + b*v + d     # u-component of the gradient</span></div>
<div class="line"><span class="lineno"> 1500</span><span class="stringliteral">    ...     gv = b*u + 2*c*v + e     # v-component of the gradient</span></div>
<div class="line"><span class="lineno"> 1501</span><span class="stringliteral">    ...     return np.asarray((gu, gv))</span></div>
<div class="line"><span class="lineno"> 1502</span><span class="stringliteral">    &gt;&gt;&gt; x0 = np.asarray((0, 0))  # Initial guess.</span></div>
<div class="line"><span class="lineno"> 1503</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno"> 1504</span><span class="stringliteral">    &gt;&gt;&gt; res1 = optimize.fmin_cg(f, x0, fprime=gradf, args=args)</span></div>
<div class="line"><span class="lineno"> 1505</span><span class="stringliteral">    Optimization terminated successfully.</span></div>
<div class="line"><span class="lineno"> 1506</span><span class="stringliteral">             Current function value: 1.617021</span></div>
<div class="line"><span class="lineno"> 1507</span><span class="stringliteral">             Iterations: 4</span></div>
<div class="line"><span class="lineno"> 1508</span><span class="stringliteral">             Function evaluations: 8</span></div>
<div class="line"><span class="lineno"> 1509</span><span class="stringliteral">             Gradient evaluations: 8</span></div>
<div class="line"><span class="lineno"> 1510</span><span class="stringliteral">    &gt;&gt;&gt; res1</span></div>
<div class="line"><span class="lineno"> 1511</span><span class="stringliteral">    array([-1.80851064, -0.25531915])</span></div>
<div class="line"><span class="lineno"> 1512</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1513</span><span class="stringliteral">    Example 2: solve the same problem using the `minimize` function.</span></div>
<div class="line"><span class="lineno"> 1514</span><span class="stringliteral">    (This `myopts` dictionary shows all of the available options,</span></div>
<div class="line"><span class="lineno"> 1515</span><span class="stringliteral">    although in practice only non-default values would be needed.</span></div>
<div class="line"><span class="lineno"> 1516</span><span class="stringliteral">    The returned value will be a dictionary.)</span></div>
<div class="line"><span class="lineno"> 1517</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1518</span><span class="stringliteral">    &gt;&gt;&gt; opts = {&#39;maxiter&#39; : None,    # default value.</span></div>
<div class="line"><span class="lineno"> 1519</span><span class="stringliteral">    ...         &#39;disp&#39; : True,    # non-default value.</span></div>
<div class="line"><span class="lineno"> 1520</span><span class="stringliteral">    ...         &#39;gtol&#39; : 1e-5,    # default value.</span></div>
<div class="line"><span class="lineno"> 1521</span><span class="stringliteral">    ...         &#39;norm&#39; : np.inf,  # default value.</span></div>
<div class="line"><span class="lineno"> 1522</span><span class="stringliteral">    ...         &#39;eps&#39; : 1.4901161193847656e-08}  # default value.</span></div>
<div class="line"><span class="lineno"> 1523</span><span class="stringliteral">    &gt;&gt;&gt; res2 = optimize.minimize(f, x0, jac=gradf, args=args,</span></div>
<div class="line"><span class="lineno"> 1524</span><span class="stringliteral">    ...                          method=&#39;CG&#39;, options=opts)</span></div>
<div class="line"><span class="lineno"> 1525</span><span class="stringliteral">    Optimization terminated successfully.</span></div>
<div class="line"><span class="lineno"> 1526</span><span class="stringliteral">            Current function value: 1.617021</span></div>
<div class="line"><span class="lineno"> 1527</span><span class="stringliteral">            Iterations: 4</span></div>
<div class="line"><span class="lineno"> 1528</span><span class="stringliteral">            Function evaluations: 8</span></div>
<div class="line"><span class="lineno"> 1529</span><span class="stringliteral">            Gradient evaluations: 8</span></div>
<div class="line"><span class="lineno"> 1530</span><span class="stringliteral">    &gt;&gt;&gt; res2.x  # minimum found</span></div>
<div class="line"><span class="lineno"> 1531</span><span class="stringliteral">    array([-1.80851064, -0.25531915])</span></div>
<div class="line"><span class="lineno"> 1532</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1533</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1534</span>    opts = {<span class="stringliteral">&#39;gtol&#39;</span>: gtol,</div>
<div class="line"><span class="lineno"> 1535</span>            <span class="stringliteral">&#39;norm&#39;</span>: norm,</div>
<div class="line"><span class="lineno"> 1536</span>            <span class="stringliteral">&#39;eps&#39;</span>: epsilon,</div>
<div class="line"><span class="lineno"> 1537</span>            <span class="stringliteral">&#39;disp&#39;</span>: disp,</div>
<div class="line"><span class="lineno"> 1538</span>            <span class="stringliteral">&#39;maxiter&#39;</span>: maxiter,</div>
<div class="line"><span class="lineno"> 1539</span>            <span class="stringliteral">&#39;return_all&#39;</span>: retall}</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>    res = _minimize_cg(f, x0, args, fprime, callback=callback, **opts)</div>
<div class="line"><span class="lineno"> 1542</span> </div>
<div class="line"><span class="lineno"> 1543</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno"> 1544</span>        retlist = res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;fun&#39;</span>], res[<span class="stringliteral">&#39;nfev&#39;</span>], res[<span class="stringliteral">&#39;njev&#39;</span>], res[<span class="stringliteral">&#39;status&#39;</span>]</div>
<div class="line"><span class="lineno"> 1545</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1546</span>            retlist += (res[<span class="stringliteral">&#39;allvecs&#39;</span>], )</div>
<div class="line"><span class="lineno"> 1547</span>        <span class="keywordflow">return</span> retlist</div>
<div class="line"><span class="lineno"> 1548</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1549</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1550</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;allvecs&#39;</span>]</div>
<div class="line"><span class="lineno"> 1551</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1552</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno"> 1553</span> </div>
<div class="line"><span class="lineno"> 1554</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1f87d4a3076d3d4579a03dfe3f32ddd" name="ac1f87d4a3076d3d4579a03dfe3f32ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1f87d4a3076d3d4579a03dfe3f32ddd">&#9670;&#160;</a></span>fmin_ncg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.fmin_ncg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fprime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fhess_p</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fhess</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>avextol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>retall</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Unconstrained minimization of a function using the Newton-CG method.

Parameters
----------
f : callable ``f(x, *args)``
    Objective function to be minimized.
x0 : ndarray
    Initial guess.
fprime : callable ``f'(x, *args)``
    Gradient of f.
fhess_p : callable ``fhess_p(x, p, *args)``, optional
    Function which computes the Hessian of f times an
    arbitrary vector, p.
fhess : callable ``fhess(x, *args)``, optional
    Function to compute the Hessian matrix of f.
args : tuple, optional
    Extra arguments passed to f, fprime, fhess_p, and fhess
    (the same set of extra arguments is supplied to all of
    these functions).
epsilon : float or ndarray, optional
    If fhess is approximated, use this value for the step size.
callback : callable, optional
    An optional user-supplied function which is called after
    each iteration. Called as callback(xk), where xk is the
    current parameter vector.
avextol : float, optional
    Convergence is assumed when the average relative error in
    the minimizer falls below this amount.
maxiter : int, optional
    Maximum number of iterations to perform.
full_output : bool, optional
    If True, return the optional outputs.
disp : bool, optional
    If True, print convergence message.
retall : bool, optional
    If True, return a list of results at each iteration.

Returns
-------
xopt : ndarray
    Parameters which minimize f, i.e., ``f(xopt) == fopt``.
fopt : float
    Value of the function at xopt, i.e., ``fopt = f(xopt)``.
fcalls : int
    Number of function calls made.
gcalls : int
    Number of gradient calls made.
hcalls : int
    Number of Hessian calls made.
warnflag : int
    Warnings generated by the algorithm.
    1 : Maximum number of iterations exceeded.
    2 : Line search failure (precision loss).
    3 : NaN result encountered.
allvecs : list
    The result at each iteration, if retall is True (see below).

See also
--------
minimize: Interface to minimization algorithms for multivariate
    functions. See the 'Newton-CG' `method` in particular.

Notes
-----
Only one of `fhess_p` or `fhess` need to be given.  If `fhess`
is provided, then `fhess_p` will be ignored. If neither `fhess`
nor `fhess_p` is provided, then the hessian product will be
approximated using finite differences on `fprime`. `fhess_p`
must compute the hessian times an arbitrary vector. If it is not
given, finite-differences on `fprime` are used to compute
it.

Newton-CG methods are also called truncated Newton methods. This
function differs from scipy.optimize.fmin_tnc because

1. scipy.optimize.fmin_ncg is written purely in Python using NumPy
    and scipy while scipy.optimize.fmin_tnc calls a C function.
2. scipy.optimize.fmin_ncg is only for unconstrained minimization
    while scipy.optimize.fmin_tnc is for unconstrained minimization
    or box constrained minimization. (Box constraints give
    lower and upper bounds for each variable separately.)

References
----------
Wright &amp; Nocedal, 'Numerical Optimization', 1999, p. 140.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1702</span>             callback=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1703</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1704</span><span class="stringliteral">    Unconstrained minimization of a function using the Newton-CG method.</span></div>
<div class="line"><span class="lineno"> 1705</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1706</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1707</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1708</span><span class="stringliteral">    f : callable ``f(x, *args)``</span></div>
<div class="line"><span class="lineno"> 1709</span><span class="stringliteral">        Objective function to be minimized.</span></div>
<div class="line"><span class="lineno"> 1710</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno"> 1711</span><span class="stringliteral">        Initial guess.</span></div>
<div class="line"><span class="lineno"> 1712</span><span class="stringliteral">    fprime : callable ``f&#39;(x, *args)``</span></div>
<div class="line"><span class="lineno"> 1713</span><span class="stringliteral">        Gradient of f.</span></div>
<div class="line"><span class="lineno"> 1714</span><span class="stringliteral">    fhess_p : callable ``fhess_p(x, p, *args)``, optional</span></div>
<div class="line"><span class="lineno"> 1715</span><span class="stringliteral">        Function which computes the Hessian of f times an</span></div>
<div class="line"><span class="lineno"> 1716</span><span class="stringliteral">        arbitrary vector, p.</span></div>
<div class="line"><span class="lineno"> 1717</span><span class="stringliteral">    fhess : callable ``fhess(x, *args)``, optional</span></div>
<div class="line"><span class="lineno"> 1718</span><span class="stringliteral">        Function to compute the Hessian matrix of f.</span></div>
<div class="line"><span class="lineno"> 1719</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 1720</span><span class="stringliteral">        Extra arguments passed to f, fprime, fhess_p, and fhess</span></div>
<div class="line"><span class="lineno"> 1721</span><span class="stringliteral">        (the same set of extra arguments is supplied to all of</span></div>
<div class="line"><span class="lineno"> 1722</span><span class="stringliteral">        these functions).</span></div>
<div class="line"><span class="lineno"> 1723</span><span class="stringliteral">    epsilon : float or ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1724</span><span class="stringliteral">        If fhess is approximated, use this value for the step size.</span></div>
<div class="line"><span class="lineno"> 1725</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno"> 1726</span><span class="stringliteral">        An optional user-supplied function which is called after</span></div>
<div class="line"><span class="lineno"> 1727</span><span class="stringliteral">        each iteration. Called as callback(xk), where xk is the</span></div>
<div class="line"><span class="lineno"> 1728</span><span class="stringliteral">        current parameter vector.</span></div>
<div class="line"><span class="lineno"> 1729</span><span class="stringliteral">    avextol : float, optional</span></div>
<div class="line"><span class="lineno"> 1730</span><span class="stringliteral">        Convergence is assumed when the average relative error in</span></div>
<div class="line"><span class="lineno"> 1731</span><span class="stringliteral">        the minimizer falls below this amount.</span></div>
<div class="line"><span class="lineno"> 1732</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno"> 1733</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 1734</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno"> 1735</span><span class="stringliteral">        If True, return the optional outputs.</span></div>
<div class="line"><span class="lineno"> 1736</span><span class="stringliteral">    disp : bool, optional</span></div>
<div class="line"><span class="lineno"> 1737</span><span class="stringliteral">        If True, print convergence message.</span></div>
<div class="line"><span class="lineno"> 1738</span><span class="stringliteral">    retall : bool, optional</span></div>
<div class="line"><span class="lineno"> 1739</span><span class="stringliteral">        If True, return a list of results at each iteration.</span></div>
<div class="line"><span class="lineno"> 1740</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1741</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1742</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1743</span><span class="stringliteral">    xopt : ndarray</span></div>
<div class="line"><span class="lineno"> 1744</span><span class="stringliteral">        Parameters which minimize f, i.e., ``f(xopt) == fopt``.</span></div>
<div class="line"><span class="lineno"> 1745</span><span class="stringliteral">    fopt : float</span></div>
<div class="line"><span class="lineno"> 1746</span><span class="stringliteral">        Value of the function at xopt, i.e., ``fopt = f(xopt)``.</span></div>
<div class="line"><span class="lineno"> 1747</span><span class="stringliteral">    fcalls : int</span></div>
<div class="line"><span class="lineno"> 1748</span><span class="stringliteral">        Number of function calls made.</span></div>
<div class="line"><span class="lineno"> 1749</span><span class="stringliteral">    gcalls : int</span></div>
<div class="line"><span class="lineno"> 1750</span><span class="stringliteral">        Number of gradient calls made.</span></div>
<div class="line"><span class="lineno"> 1751</span><span class="stringliteral">    hcalls : int</span></div>
<div class="line"><span class="lineno"> 1752</span><span class="stringliteral">        Number of Hessian calls made.</span></div>
<div class="line"><span class="lineno"> 1753</span><span class="stringliteral">    warnflag : int</span></div>
<div class="line"><span class="lineno"> 1754</span><span class="stringliteral">        Warnings generated by the algorithm.</span></div>
<div class="line"><span class="lineno"> 1755</span><span class="stringliteral">        1 : Maximum number of iterations exceeded.</span></div>
<div class="line"><span class="lineno"> 1756</span><span class="stringliteral">        2 : Line search failure (precision loss).</span></div>
<div class="line"><span class="lineno"> 1757</span><span class="stringliteral">        3 : NaN result encountered.</span></div>
<div class="line"><span class="lineno"> 1758</span><span class="stringliteral">    allvecs : list</span></div>
<div class="line"><span class="lineno"> 1759</span><span class="stringliteral">        The result at each iteration, if retall is True (see below).</span></div>
<div class="line"><span class="lineno"> 1760</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1761</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1762</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1763</span><span class="stringliteral">    minimize: Interface to minimization algorithms for multivariate</span></div>
<div class="line"><span class="lineno"> 1764</span><span class="stringliteral">        functions. See the &#39;Newton-CG&#39; `method` in particular.</span></div>
<div class="line"><span class="lineno"> 1765</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1766</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1767</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1768</span><span class="stringliteral">    Only one of `fhess_p` or `fhess` need to be given.  If `fhess`</span></div>
<div class="line"><span class="lineno"> 1769</span><span class="stringliteral">    is provided, then `fhess_p` will be ignored. If neither `fhess`</span></div>
<div class="line"><span class="lineno"> 1770</span><span class="stringliteral">    nor `fhess_p` is provided, then the hessian product will be</span></div>
<div class="line"><span class="lineno"> 1771</span><span class="stringliteral">    approximated using finite differences on `fprime`. `fhess_p`</span></div>
<div class="line"><span class="lineno"> 1772</span><span class="stringliteral">    must compute the hessian times an arbitrary vector. If it is not</span></div>
<div class="line"><span class="lineno"> 1773</span><span class="stringliteral">    given, finite-differences on `fprime` are used to compute</span></div>
<div class="line"><span class="lineno"> 1774</span><span class="stringliteral">    it.</span></div>
<div class="line"><span class="lineno"> 1775</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1776</span><span class="stringliteral">    Newton-CG methods are also called truncated Newton methods. This</span></div>
<div class="line"><span class="lineno"> 1777</span><span class="stringliteral">    function differs from scipy.optimize.fmin_tnc because</span></div>
<div class="line"><span class="lineno"> 1778</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1779</span><span class="stringliteral">    1. scipy.optimize.fmin_ncg is written purely in Python using NumPy</span></div>
<div class="line"><span class="lineno"> 1780</span><span class="stringliteral">        and scipy while scipy.optimize.fmin_tnc calls a C function.</span></div>
<div class="line"><span class="lineno"> 1781</span><span class="stringliteral">    2. scipy.optimize.fmin_ncg is only for unconstrained minimization</span></div>
<div class="line"><span class="lineno"> 1782</span><span class="stringliteral">        while scipy.optimize.fmin_tnc is for unconstrained minimization</span></div>
<div class="line"><span class="lineno"> 1783</span><span class="stringliteral">        or box constrained minimization. (Box constraints give</span></div>
<div class="line"><span class="lineno"> 1784</span><span class="stringliteral">        lower and upper bounds for each variable separately.)</span></div>
<div class="line"><span class="lineno"> 1785</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1786</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1787</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1788</span><span class="stringliteral">    Wright &amp; Nocedal, &#39;Numerical Optimization&#39;, 1999, p. 140.</span></div>
<div class="line"><span class="lineno"> 1789</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1790</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1791</span>    opts = {<span class="stringliteral">&#39;xtol&#39;</span>: avextol,</div>
<div class="line"><span class="lineno"> 1792</span>            <span class="stringliteral">&#39;eps&#39;</span>: epsilon,</div>
<div class="line"><span class="lineno"> 1793</span>            <span class="stringliteral">&#39;maxiter&#39;</span>: maxiter,</div>
<div class="line"><span class="lineno"> 1794</span>            <span class="stringliteral">&#39;disp&#39;</span>: disp,</div>
<div class="line"><span class="lineno"> 1795</span>            <span class="stringliteral">&#39;return_all&#39;</span>: retall}</div>
<div class="line"><span class="lineno"> 1796</span> </div>
<div class="line"><span class="lineno"> 1797</span>    res = _minimize_newtoncg(f, x0, args, fprime, fhess, fhess_p,</div>
<div class="line"><span class="lineno"> 1798</span>                             callback=callback, **opts)</div>
<div class="line"><span class="lineno"> 1799</span> </div>
<div class="line"><span class="lineno"> 1800</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno"> 1801</span>        retlist = (res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;fun&#39;</span>], res[<span class="stringliteral">&#39;nfev&#39;</span>], res[<span class="stringliteral">&#39;njev&#39;</span>],</div>
<div class="line"><span class="lineno"> 1802</span>                   res[<span class="stringliteral">&#39;nhev&#39;</span>], res[<span class="stringliteral">&#39;status&#39;</span>])</div>
<div class="line"><span class="lineno"> 1803</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1804</span>            retlist += (res[<span class="stringliteral">&#39;allvecs&#39;</span>], )</div>
<div class="line"><span class="lineno"> 1805</span>        <span class="keywordflow">return</span> retlist</div>
<div class="line"><span class="lineno"> 1806</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1807</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 1808</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;allvecs&#39;</span>]</div>
<div class="line"><span class="lineno"> 1809</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1810</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno"> 1811</span> </div>
<div class="line"><span class="lineno"> 1812</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab37e1a3656d4e065f5ea2f3acdd29b20" name="ab37e1a3656d4e065f5ea2f3acdd29b20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37e1a3656d4e065f5ea2f3acdd29b20">&#9670;&#160;</a></span>fmin_powell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.fmin_powell </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfun</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>retall</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direc</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Minimize a function using modified Powell's method.

This method only uses function values, not derivatives.

Parameters
----------
func : callable f(x,*args)
    Objective function to be minimized.
x0 : ndarray
    Initial guess.
args : tuple, optional
    Extra arguments passed to func.
xtol : float, optional
    Line-search error tolerance.
ftol : float, optional
    Relative error in ``func(xopt)`` acceptable for convergence.
maxiter : int, optional
    Maximum number of iterations to perform.
maxfun : int, optional
    Maximum number of function evaluations to make.
full_output : bool, optional
    If True, ``fopt``, ``xi``, ``direc``, ``iter``, ``funcalls``, and
    ``warnflag`` are returned.
disp : bool, optional
    If True, print convergence messages.
retall : bool, optional
    If True, return a list of the solution at each iteration.
callback : callable, optional
    An optional user-supplied function, called after each
    iteration.  Called as ``callback(xk)``, where ``xk`` is the
    current parameter vector.
direc : ndarray, optional
    Initial fitting step and parameter order set as an (N, N) array, where N
    is the number of fitting parameters in `x0`. Defaults to step size 1.0
    fitting all parameters simultaneously (``np.eye((N, N))``). To
    prevent initial consideration of values in a step or to change initial
    step size, set to 0 or desired step size in the Jth position in the Mth
    block, where J is the position in `x0` and M is the desired evaluation
    step, with steps being evaluated in index order. Step size and ordering
    will change freely as minimization proceeds.

Returns
-------
xopt : ndarray
    Parameter which minimizes `func`.
fopt : number
    Value of function at minimum: ``fopt = func(xopt)``.
direc : ndarray
    Current direction set.
iter : int
    Number of iterations.
funcalls : int
    Number of function calls made.
warnflag : int
    Integer warning flag:
        1 : Maximum number of function evaluations.
        2 : Maximum number of iterations.
        3 : NaN result encountered.
        4 : The result is out of the provided bounds.
allvecs : list
    List of solutions at each iteration.

See also
--------
minimize: Interface to unconstrained minimization algorithms for
    multivariate functions. See the 'Powell' method in particular.

Notes
-----
Uses a modification of Powell's method to find the minimum of
a function of N variables. Powell's method is a conjugate
direction method.

The algorithm has two loops. The outer loop merely iterates over the inner
loop. The inner loop minimizes over each current direction in the direction
set. At the end of the inner loop, if certain conditions are met, the
direction that gave the largest decrease is dropped and replaced with the
difference between the current estimated x and the estimated x from the
beginning of the inner-loop.

The technical conditions for replacing the direction of greatest
increase amount to checking that

1. No further gain can be made along the direction of greatest increase
   from that iteration.
2. The direction of greatest increase accounted for a large sufficient
   fraction of the decrease in the function value from that iteration of
   the inner loop.

References
----------
Powell M.J.D. (1964) An efficient method for finding the minimum of a
function of several variables without calculating derivatives,
Computer Journal, 7 (2):155-162.

Press W., Teukolsky S.A., Vetterling W.T., and Flannery B.P.:
Numerical Recipes (any edition), Cambridge University Press

Examples
--------
&gt;&gt;&gt; def f(x):
...     return x**2

&gt;&gt;&gt; from scipy import optimize

&gt;&gt;&gt; minimum = optimize.fmin_powell(f, -1)
Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 2
         Function evaluations: 18
&gt;&gt;&gt; minimum
array(0.0)</pre> <div class="fragment"><div class="line"><span class="lineno"> 2938</span>                direc=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2939</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2940</span><span class="stringliteral">    Minimize a function using modified Powell&#39;s method.</span></div>
<div class="line"><span class="lineno"> 2941</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2942</span><span class="stringliteral">    This method only uses function values, not derivatives.</span></div>
<div class="line"><span class="lineno"> 2943</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2944</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2945</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2946</span><span class="stringliteral">    func : callable f(x,*args)</span></div>
<div class="line"><span class="lineno"> 2947</span><span class="stringliteral">        Objective function to be minimized.</span></div>
<div class="line"><span class="lineno"> 2948</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno"> 2949</span><span class="stringliteral">        Initial guess.</span></div>
<div class="line"><span class="lineno"> 2950</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 2951</span><span class="stringliteral">        Extra arguments passed to func.</span></div>
<div class="line"><span class="lineno"> 2952</span><span class="stringliteral">    xtol : float, optional</span></div>
<div class="line"><span class="lineno"> 2953</span><span class="stringliteral">        Line-search error tolerance.</span></div>
<div class="line"><span class="lineno"> 2954</span><span class="stringliteral">    ftol : float, optional</span></div>
<div class="line"><span class="lineno"> 2955</span><span class="stringliteral">        Relative error in ``func(xopt)`` acceptable for convergence.</span></div>
<div class="line"><span class="lineno"> 2956</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno"> 2957</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 2958</span><span class="stringliteral">    maxfun : int, optional</span></div>
<div class="line"><span class="lineno"> 2959</span><span class="stringliteral">        Maximum number of function evaluations to make.</span></div>
<div class="line"><span class="lineno"> 2960</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno"> 2961</span><span class="stringliteral">        If True, ``fopt``, ``xi``, ``direc``, ``iter``, ``funcalls``, and</span></div>
<div class="line"><span class="lineno"> 2962</span><span class="stringliteral">        ``warnflag`` are returned.</span></div>
<div class="line"><span class="lineno"> 2963</span><span class="stringliteral">    disp : bool, optional</span></div>
<div class="line"><span class="lineno"> 2964</span><span class="stringliteral">        If True, print convergence messages.</span></div>
<div class="line"><span class="lineno"> 2965</span><span class="stringliteral">    retall : bool, optional</span></div>
<div class="line"><span class="lineno"> 2966</span><span class="stringliteral">        If True, return a list of the solution at each iteration.</span></div>
<div class="line"><span class="lineno"> 2967</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno"> 2968</span><span class="stringliteral">        An optional user-supplied function, called after each</span></div>
<div class="line"><span class="lineno"> 2969</span><span class="stringliteral">        iteration.  Called as ``callback(xk)``, where ``xk`` is the</span></div>
<div class="line"><span class="lineno"> 2970</span><span class="stringliteral">        current parameter vector.</span></div>
<div class="line"><span class="lineno"> 2971</span><span class="stringliteral">    direc : ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2972</span><span class="stringliteral">        Initial fitting step and parameter order set as an (N, N) array, where N</span></div>
<div class="line"><span class="lineno"> 2973</span><span class="stringliteral">        is the number of fitting parameters in `x0`. Defaults to step size 1.0</span></div>
<div class="line"><span class="lineno"> 2974</span><span class="stringliteral">        fitting all parameters simultaneously (``np.eye((N, N))``). To</span></div>
<div class="line"><span class="lineno"> 2975</span><span class="stringliteral">        prevent initial consideration of values in a step or to change initial</span></div>
<div class="line"><span class="lineno"> 2976</span><span class="stringliteral">        step size, set to 0 or desired step size in the Jth position in the Mth</span></div>
<div class="line"><span class="lineno"> 2977</span><span class="stringliteral">        block, where J is the position in `x0` and M is the desired evaluation</span></div>
<div class="line"><span class="lineno"> 2978</span><span class="stringliteral">        step, with steps being evaluated in index order. Step size and ordering</span></div>
<div class="line"><span class="lineno"> 2979</span><span class="stringliteral">        will change freely as minimization proceeds.</span></div>
<div class="line"><span class="lineno"> 2980</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2981</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2982</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2983</span><span class="stringliteral">    xopt : ndarray</span></div>
<div class="line"><span class="lineno"> 2984</span><span class="stringliteral">        Parameter which minimizes `func`.</span></div>
<div class="line"><span class="lineno"> 2985</span><span class="stringliteral">    fopt : number</span></div>
<div class="line"><span class="lineno"> 2986</span><span class="stringliteral">        Value of function at minimum: ``fopt = func(xopt)``.</span></div>
<div class="line"><span class="lineno"> 2987</span><span class="stringliteral">    direc : ndarray</span></div>
<div class="line"><span class="lineno"> 2988</span><span class="stringliteral">        Current direction set.</span></div>
<div class="line"><span class="lineno"> 2989</span><span class="stringliteral">    iter : int</span></div>
<div class="line"><span class="lineno"> 2990</span><span class="stringliteral">        Number of iterations.</span></div>
<div class="line"><span class="lineno"> 2991</span><span class="stringliteral">    funcalls : int</span></div>
<div class="line"><span class="lineno"> 2992</span><span class="stringliteral">        Number of function calls made.</span></div>
<div class="line"><span class="lineno"> 2993</span><span class="stringliteral">    warnflag : int</span></div>
<div class="line"><span class="lineno"> 2994</span><span class="stringliteral">        Integer warning flag:</span></div>
<div class="line"><span class="lineno"> 2995</span><span class="stringliteral">            1 : Maximum number of function evaluations.</span></div>
<div class="line"><span class="lineno"> 2996</span><span class="stringliteral">            2 : Maximum number of iterations.</span></div>
<div class="line"><span class="lineno"> 2997</span><span class="stringliteral">            3 : NaN result encountered.</span></div>
<div class="line"><span class="lineno"> 2998</span><span class="stringliteral">            4 : The result is out of the provided bounds.</span></div>
<div class="line"><span class="lineno"> 2999</span><span class="stringliteral">    allvecs : list</span></div>
<div class="line"><span class="lineno"> 3000</span><span class="stringliteral">        List of solutions at each iteration.</span></div>
<div class="line"><span class="lineno"> 3001</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3002</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 3003</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3004</span><span class="stringliteral">    minimize: Interface to unconstrained minimization algorithms for</span></div>
<div class="line"><span class="lineno"> 3005</span><span class="stringliteral">        multivariate functions. See the &#39;Powell&#39; method in particular.</span></div>
<div class="line"><span class="lineno"> 3006</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3007</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 3008</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 3009</span><span class="stringliteral">    Uses a modification of Powell&#39;s method to find the minimum of</span></div>
<div class="line"><span class="lineno"> 3010</span><span class="stringliteral">    a function of N variables. Powell&#39;s method is a conjugate</span></div>
<div class="line"><span class="lineno"> 3011</span><span class="stringliteral">    direction method.</span></div>
<div class="line"><span class="lineno"> 3012</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3013</span><span class="stringliteral">    The algorithm has two loops. The outer loop merely iterates over the inner</span></div>
<div class="line"><span class="lineno"> 3014</span><span class="stringliteral">    loop. The inner loop minimizes over each current direction in the direction</span></div>
<div class="line"><span class="lineno"> 3015</span><span class="stringliteral">    set. At the end of the inner loop, if certain conditions are met, the</span></div>
<div class="line"><span class="lineno"> 3016</span><span class="stringliteral">    direction that gave the largest decrease is dropped and replaced with the</span></div>
<div class="line"><span class="lineno"> 3017</span><span class="stringliteral">    difference between the current estimated x and the estimated x from the</span></div>
<div class="line"><span class="lineno"> 3018</span><span class="stringliteral">    beginning of the inner-loop.</span></div>
<div class="line"><span class="lineno"> 3019</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3020</span><span class="stringliteral">    The technical conditions for replacing the direction of greatest</span></div>
<div class="line"><span class="lineno"> 3021</span><span class="stringliteral">    increase amount to checking that</span></div>
<div class="line"><span class="lineno"> 3022</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3023</span><span class="stringliteral">    1. No further gain can be made along the direction of greatest increase</span></div>
<div class="line"><span class="lineno"> 3024</span><span class="stringliteral">       from that iteration.</span></div>
<div class="line"><span class="lineno"> 3025</span><span class="stringliteral">    2. The direction of greatest increase accounted for a large sufficient</span></div>
<div class="line"><span class="lineno"> 3026</span><span class="stringliteral">       fraction of the decrease in the function value from that iteration of</span></div>
<div class="line"><span class="lineno"> 3027</span><span class="stringliteral">       the inner loop.</span></div>
<div class="line"><span class="lineno"> 3028</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3029</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 3030</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3031</span><span class="stringliteral">    Powell M.J.D. (1964) An efficient method for finding the minimum of a</span></div>
<div class="line"><span class="lineno"> 3032</span><span class="stringliteral">    function of several variables without calculating derivatives,</span></div>
<div class="line"><span class="lineno"> 3033</span><span class="stringliteral">    Computer Journal, 7 (2):155-162.</span></div>
<div class="line"><span class="lineno"> 3034</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3035</span><span class="stringliteral">    Press W., Teukolsky S.A., Vetterling W.T., and Flannery B.P.:</span></div>
<div class="line"><span class="lineno"> 3036</span><span class="stringliteral">    Numerical Recipes (any edition), Cambridge University Press</span></div>
<div class="line"><span class="lineno"> 3037</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3038</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3039</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3040</span><span class="stringliteral">    &gt;&gt;&gt; def f(x):</span></div>
<div class="line"><span class="lineno"> 3041</span><span class="stringliteral">    ...     return x**2</span></div>
<div class="line"><span class="lineno"> 3042</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3043</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno"> 3044</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3045</span><span class="stringliteral">    &gt;&gt;&gt; minimum = optimize.fmin_powell(f, -1)</span></div>
<div class="line"><span class="lineno"> 3046</span><span class="stringliteral">    Optimization terminated successfully.</span></div>
<div class="line"><span class="lineno"> 3047</span><span class="stringliteral">             Current function value: 0.000000</span></div>
<div class="line"><span class="lineno"> 3048</span><span class="stringliteral">             Iterations: 2</span></div>
<div class="line"><span class="lineno"> 3049</span><span class="stringliteral">             Function evaluations: 18</span></div>
<div class="line"><span class="lineno"> 3050</span><span class="stringliteral">    &gt;&gt;&gt; minimum</span></div>
<div class="line"><span class="lineno"> 3051</span><span class="stringliteral">    array(0.0)</span></div>
<div class="line"><span class="lineno"> 3052</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3053</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3054</span>    opts = {<span class="stringliteral">&#39;xtol&#39;</span>: xtol,</div>
<div class="line"><span class="lineno"> 3055</span>            <span class="stringliteral">&#39;ftol&#39;</span>: ftol,</div>
<div class="line"><span class="lineno"> 3056</span>            <span class="stringliteral">&#39;maxiter&#39;</span>: maxiter,</div>
<div class="line"><span class="lineno"> 3057</span>            <span class="stringliteral">&#39;maxfev&#39;</span>: maxfun,</div>
<div class="line"><span class="lineno"> 3058</span>            <span class="stringliteral">&#39;disp&#39;</span>: disp,</div>
<div class="line"><span class="lineno"> 3059</span>            <span class="stringliteral">&#39;direc&#39;</span>: direc,</div>
<div class="line"><span class="lineno"> 3060</span>            <span class="stringliteral">&#39;return_all&#39;</span>: retall}</div>
<div class="line"><span class="lineno"> 3061</span> </div>
<div class="line"><span class="lineno"> 3062</span>    res = _minimize_powell(func, x0, args, callback=callback, **opts)</div>
<div class="line"><span class="lineno"> 3063</span> </div>
<div class="line"><span class="lineno"> 3064</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno"> 3065</span>        retlist = (res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;fun&#39;</span>], res[<span class="stringliteral">&#39;direc&#39;</span>], res[<span class="stringliteral">&#39;nit&#39;</span>],</div>
<div class="line"><span class="lineno"> 3066</span>                   res[<span class="stringliteral">&#39;nfev&#39;</span>], res[<span class="stringliteral">&#39;status&#39;</span>])</div>
<div class="line"><span class="lineno"> 3067</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 3068</span>            retlist += (res[<span class="stringliteral">&#39;allvecs&#39;</span>], )</div>
<div class="line"><span class="lineno"> 3069</span>        <span class="keywordflow">return</span> retlist</div>
<div class="line"><span class="lineno"> 3070</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3071</span>        <span class="keywordflow">if</span> retall:</div>
<div class="line"><span class="lineno"> 3072</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;allvecs&#39;</span>]</div>
<div class="line"><span class="lineno"> 3073</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3074</span>            <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno"> 3075</span> </div>
<div class="line"><span class="lineno"> 3076</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a86c632088d14f5b42c1e17998149d676" name="a86c632088d14f5b42c1e17998149d676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c632088d14f5b42c1e17998149d676">&#9670;&#160;</a></span>fminbound()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.fminbound </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfun</em> = <code>500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Bounded minimization for scalar functions.

Parameters
----------
func : callable f(x,*args)
    Objective function to be minimized (must accept and return scalars).
x1, x2 : float or array scalar
    The optimization bounds.
args : tuple, optional
    Extra arguments passed to function.
xtol : float, optional
    The convergence tolerance.
maxfun : int, optional
    Maximum number of function evaluations allowed.
full_output : bool, optional
    If True, return optional outputs.
disp : int, optional
    If non-zero, print messages.
        0 : no message printing.
        1 : non-convergence notification messages only.
        2 : print a message on convergence too.
        3 : print iteration results.


Returns
-------
xopt : ndarray
    Parameters (over given interval) which minimize the
    objective function.
fval : number
    The function value at the minimum point.
ierr : int
    An error flag (0 if converged, 1 if maximum number of
    function calls reached).
numfunc : int
  The number of function calls made.

See also
--------
minimize_scalar: Interface to minimization algorithms for scalar
    univariate functions. See the 'Bounded' `method` in particular.

Notes
-----
Finds a local minimizer of the scalar function `func` in the
interval x1 &lt; xopt &lt; x2 using Brent's method. (See `brent`
for auto-bracketing.)

Examples
--------
`fminbound` finds the minimum of the function in the given range.
The following examples illustrate the same

&gt;&gt;&gt; def f(x):
...     return x**2

&gt;&gt;&gt; from scipy import optimize

&gt;&gt;&gt; minimum = optimize.fminbound(f, -1, 2)
&gt;&gt;&gt; minimum
0.0
&gt;&gt;&gt; minimum = optimize.fminbound(f, 1, 2)
&gt;&gt;&gt; minimum
1.0000059608609866
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1992</span>              full_output=0, disp=1):</div>
<div class="line"><span class="lineno"> 1993</span>    <span class="stringliteral">&quot;&quot;&quot;Bounded minimization for scalar functions.</span></div>
<div class="line"><span class="lineno"> 1994</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1995</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1996</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1997</span><span class="stringliteral">    func : callable f(x,*args)</span></div>
<div class="line"><span class="lineno"> 1998</span><span class="stringliteral">        Objective function to be minimized (must accept and return scalars).</span></div>
<div class="line"><span class="lineno"> 1999</span><span class="stringliteral">    x1, x2 : float or array scalar</span></div>
<div class="line"><span class="lineno"> 2000</span><span class="stringliteral">        The optimization bounds.</span></div>
<div class="line"><span class="lineno"> 2001</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 2002</span><span class="stringliteral">        Extra arguments passed to function.</span></div>
<div class="line"><span class="lineno"> 2003</span><span class="stringliteral">    xtol : float, optional</span></div>
<div class="line"><span class="lineno"> 2004</span><span class="stringliteral">        The convergence tolerance.</span></div>
<div class="line"><span class="lineno"> 2005</span><span class="stringliteral">    maxfun : int, optional</span></div>
<div class="line"><span class="lineno"> 2006</span><span class="stringliteral">        Maximum number of function evaluations allowed.</span></div>
<div class="line"><span class="lineno"> 2007</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno"> 2008</span><span class="stringliteral">        If True, return optional outputs.</span></div>
<div class="line"><span class="lineno"> 2009</span><span class="stringliteral">    disp : int, optional</span></div>
<div class="line"><span class="lineno"> 2010</span><span class="stringliteral">        If non-zero, print messages.</span></div>
<div class="line"><span class="lineno"> 2011</span><span class="stringliteral">            0 : no message printing.</span></div>
<div class="line"><span class="lineno"> 2012</span><span class="stringliteral">            1 : non-convergence notification messages only.</span></div>
<div class="line"><span class="lineno"> 2013</span><span class="stringliteral">            2 : print a message on convergence too.</span></div>
<div class="line"><span class="lineno"> 2014</span><span class="stringliteral">            3 : print iteration results.</span></div>
<div class="line"><span class="lineno"> 2015</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2016</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2017</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2018</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2019</span><span class="stringliteral">    xopt : ndarray</span></div>
<div class="line"><span class="lineno"> 2020</span><span class="stringliteral">        Parameters (over given interval) which minimize the</span></div>
<div class="line"><span class="lineno"> 2021</span><span class="stringliteral">        objective function.</span></div>
<div class="line"><span class="lineno"> 2022</span><span class="stringliteral">    fval : number</span></div>
<div class="line"><span class="lineno"> 2023</span><span class="stringliteral">        The function value at the minimum point.</span></div>
<div class="line"><span class="lineno"> 2024</span><span class="stringliteral">    ierr : int</span></div>
<div class="line"><span class="lineno"> 2025</span><span class="stringliteral">        An error flag (0 if converged, 1 if maximum number of</span></div>
<div class="line"><span class="lineno"> 2026</span><span class="stringliteral">        function calls reached).</span></div>
<div class="line"><span class="lineno"> 2027</span><span class="stringliteral">    numfunc : int</span></div>
<div class="line"><span class="lineno"> 2028</span><span class="stringliteral">      The number of function calls made.</span></div>
<div class="line"><span class="lineno"> 2029</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2030</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 2031</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2032</span><span class="stringliteral">    minimize_scalar: Interface to minimization algorithms for scalar</span></div>
<div class="line"><span class="lineno"> 2033</span><span class="stringliteral">        univariate functions. See the &#39;Bounded&#39; `method` in particular.</span></div>
<div class="line"><span class="lineno"> 2034</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2035</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2036</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2037</span><span class="stringliteral">    Finds a local minimizer of the scalar function `func` in the</span></div>
<div class="line"><span class="lineno"> 2038</span><span class="stringliteral">    interval x1 &lt; xopt &lt; x2 using Brent&#39;s method. (See `brent`</span></div>
<div class="line"><span class="lineno"> 2039</span><span class="stringliteral">    for auto-bracketing.)</span></div>
<div class="line"><span class="lineno"> 2040</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2041</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2042</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2043</span><span class="stringliteral">    `fminbound` finds the minimum of the function in the given range.</span></div>
<div class="line"><span class="lineno"> 2044</span><span class="stringliteral">    The following examples illustrate the same</span></div>
<div class="line"><span class="lineno"> 2045</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2046</span><span class="stringliteral">    &gt;&gt;&gt; def f(x):</span></div>
<div class="line"><span class="lineno"> 2047</span><span class="stringliteral">    ...     return x**2</span></div>
<div class="line"><span class="lineno"> 2048</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2049</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno"> 2050</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2051</span><span class="stringliteral">    &gt;&gt;&gt; minimum = optimize.fminbound(f, -1, 2)</span></div>
<div class="line"><span class="lineno"> 2052</span><span class="stringliteral">    &gt;&gt;&gt; minimum</span></div>
<div class="line"><span class="lineno"> 2053</span><span class="stringliteral">    0.0</span></div>
<div class="line"><span class="lineno"> 2054</span><span class="stringliteral">    &gt;&gt;&gt; minimum = optimize.fminbound(f, 1, 2)</span></div>
<div class="line"><span class="lineno"> 2055</span><span class="stringliteral">    &gt;&gt;&gt; minimum</span></div>
<div class="line"><span class="lineno"> 2056</span><span class="stringliteral">    1.0000059608609866</span></div>
<div class="line"><span class="lineno"> 2057</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2058</span>    options = {<span class="stringliteral">&#39;xatol&#39;</span>: xtol,</div>
<div class="line"><span class="lineno"> 2059</span>               <span class="stringliteral">&#39;maxiter&#39;</span>: maxfun,</div>
<div class="line"><span class="lineno"> 2060</span>               <span class="stringliteral">&#39;disp&#39;</span>: disp}</div>
<div class="line"><span class="lineno"> 2061</span> </div>
<div class="line"><span class="lineno"> 2062</span>    res = _minimize_scalar_bounded(func, (x1, x2), args, **options)</div>
<div class="line"><span class="lineno"> 2063</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno"> 2064</span>        <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;fun&#39;</span>], res[<span class="stringliteral">&#39;status&#39;</span>], res[<span class="stringliteral">&#39;nfev&#39;</span>]</div>
<div class="line"><span class="lineno"> 2065</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2066</span>        <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno"> 2067</span> </div>
<div class="line"><span class="lineno"> 2068</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f74c3036679f7cddb38d24bb4ad22ee" name="a4f74c3036679f7cddb38d24bb4ad22ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f74c3036679f7cddb38d24bb4ad22ee">&#9670;&#160;</a></span>golden()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.golden </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brack</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code><a class="el" href="namespacescipy_1_1optimize_1_1__optimize.html#a8c8bc7126a371e035fd8e52aff856d71">_epsilon</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>5000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return the minimum of a function of one variable using golden section
method.

Given a function of one variable and a possible bracketing interval,
return the minimum of the function isolated to a fractional precision of
tol.

Parameters
----------
func : callable func(x,*args)
    Objective function to minimize.
args : tuple, optional
    Additional arguments (if present), passed to func.
brack : tuple, optional
    Triple (a,b,c), where (a&lt;b&lt;c) and func(b) &lt;
    func(a),func(c). If bracket consists of two numbers (a,
    c), then they are assumed to be a starting interval for a
    downhill bracket search (see `bracket`); it doesn't always
    mean that obtained solution will satisfy a&lt;=x&lt;=c.
tol : float, optional
    x tolerance stop criterion
full_output : bool, optional
    If True, return optional outputs.
maxiter : int
    Maximum number of iterations to perform.

See also
--------
minimize_scalar: Interface to minimization algorithms for scalar
    univariate functions. See the 'Golden' `method` in particular.

Notes
-----
Uses analog of bisection method to decrease the bracketed
interval.

Examples
--------
We illustrate the behaviour of the function when `brack` is of
size 2 and 3, respectively. In the case where `brack` is of the
form (xa,xb), we can see for the given values, the output need
not necessarily lie in the range ``(xa, xb)``.

&gt;&gt;&gt; def f(x):
...     return x**2

&gt;&gt;&gt; from scipy import optimize

&gt;&gt;&gt; minimum = optimize.golden(f, brack=(1, 2))
&gt;&gt;&gt; minimum
1.5717277788484873e-162
&gt;&gt;&gt; minimum = optimize.golden(f, brack=(-1, 0.5, 2))
&gt;&gt;&gt; minimum
-1.5717277788484873e-162</pre> <div class="fragment"><div class="line"><span class="lineno"> 2521</span>           full_output=0, maxiter=5000):</div>
<div class="line"><span class="lineno"> 2522</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2523</span><span class="stringliteral">    Return the minimum of a function of one variable using golden section</span></div>
<div class="line"><span class="lineno"> 2524</span><span class="stringliteral">    method.</span></div>
<div class="line"><span class="lineno"> 2525</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2526</span><span class="stringliteral">    Given a function of one variable and a possible bracketing interval,</span></div>
<div class="line"><span class="lineno"> 2527</span><span class="stringliteral">    return the minimum of the function isolated to a fractional precision of</span></div>
<div class="line"><span class="lineno"> 2528</span><span class="stringliteral">    tol.</span></div>
<div class="line"><span class="lineno"> 2529</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2530</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2531</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2532</span><span class="stringliteral">    func : callable func(x,*args)</span></div>
<div class="line"><span class="lineno"> 2533</span><span class="stringliteral">        Objective function to minimize.</span></div>
<div class="line"><span class="lineno"> 2534</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno"> 2535</span><span class="stringliteral">        Additional arguments (if present), passed to func.</span></div>
<div class="line"><span class="lineno"> 2536</span><span class="stringliteral">    brack : tuple, optional</span></div>
<div class="line"><span class="lineno"> 2537</span><span class="stringliteral">        Triple (a,b,c), where (a&lt;b&lt;c) and func(b) &lt;</span></div>
<div class="line"><span class="lineno"> 2538</span><span class="stringliteral">        func(a),func(c). If bracket consists of two numbers (a,</span></div>
<div class="line"><span class="lineno"> 2539</span><span class="stringliteral">        c), then they are assumed to be a starting interval for a</span></div>
<div class="line"><span class="lineno"> 2540</span><span class="stringliteral">        downhill bracket search (see `bracket`); it doesn&#39;t always</span></div>
<div class="line"><span class="lineno"> 2541</span><span class="stringliteral">        mean that obtained solution will satisfy a&lt;=x&lt;=c.</span></div>
<div class="line"><span class="lineno"> 2542</span><span class="stringliteral">    tol : float, optional</span></div>
<div class="line"><span class="lineno"> 2543</span><span class="stringliteral">        x tolerance stop criterion</span></div>
<div class="line"><span class="lineno"> 2544</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno"> 2545</span><span class="stringliteral">        If True, return optional outputs.</span></div>
<div class="line"><span class="lineno"> 2546</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno"> 2547</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno"> 2548</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2549</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 2550</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2551</span><span class="stringliteral">    minimize_scalar: Interface to minimization algorithms for scalar</span></div>
<div class="line"><span class="lineno"> 2552</span><span class="stringliteral">        univariate functions. See the &#39;Golden&#39; `method` in particular.</span></div>
<div class="line"><span class="lineno"> 2553</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2554</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2555</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2556</span><span class="stringliteral">    Uses analog of bisection method to decrease the bracketed</span></div>
<div class="line"><span class="lineno"> 2557</span><span class="stringliteral">    interval.</span></div>
<div class="line"><span class="lineno"> 2558</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2559</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2560</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2561</span><span class="stringliteral">    We illustrate the behaviour of the function when `brack` is of</span></div>
<div class="line"><span class="lineno"> 2562</span><span class="stringliteral">    size 2 and 3, respectively. In the case where `brack` is of the</span></div>
<div class="line"><span class="lineno"> 2563</span><span class="stringliteral">    form (xa,xb), we can see for the given values, the output need</span></div>
<div class="line"><span class="lineno"> 2564</span><span class="stringliteral">    not necessarily lie in the range ``(xa, xb)``.</span></div>
<div class="line"><span class="lineno"> 2565</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2566</span><span class="stringliteral">    &gt;&gt;&gt; def f(x):</span></div>
<div class="line"><span class="lineno"> 2567</span><span class="stringliteral">    ...     return x**2</span></div>
<div class="line"><span class="lineno"> 2568</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2569</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno"> 2570</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2571</span><span class="stringliteral">    &gt;&gt;&gt; minimum = optimize.golden(f, brack=(1, 2))</span></div>
<div class="line"><span class="lineno"> 2572</span><span class="stringliteral">    &gt;&gt;&gt; minimum</span></div>
<div class="line"><span class="lineno"> 2573</span><span class="stringliteral">    1.5717277788484873e-162</span></div>
<div class="line"><span class="lineno"> 2574</span><span class="stringliteral">    &gt;&gt;&gt; minimum = optimize.golden(f, brack=(-1, 0.5, 2))</span></div>
<div class="line"><span class="lineno"> 2575</span><span class="stringliteral">    &gt;&gt;&gt; minimum</span></div>
<div class="line"><span class="lineno"> 2576</span><span class="stringliteral">    -1.5717277788484873e-162</span></div>
<div class="line"><span class="lineno"> 2577</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2578</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2579</span>    options = {<span class="stringliteral">&#39;xtol&#39;</span>: tol, <span class="stringliteral">&#39;maxiter&#39;</span>: maxiter}</div>
<div class="line"><span class="lineno"> 2580</span>    res = _minimize_scalar_golden(func, brack, args, **options)</div>
<div class="line"><span class="lineno"> 2581</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno"> 2582</span>        <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>], res[<span class="stringliteral">&#39;fun&#39;</span>], res[<span class="stringliteral">&#39;nfev&#39;</span>]</div>
<div class="line"><span class="lineno"> 2583</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2584</span>        <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno"> 2585</span> </div>
<div class="line"><span class="lineno"> 2586</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adc8221279cef2672dbdc387b994cc8a2" name="adc8221279cef2672dbdc387b994cc8a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8221279cef2672dbdc387b994cc8a2">&#9670;&#160;</a></span>is_array_scalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.is_array_scalar </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test whether `x` is either a scalar or an array scalar.</pre> <div class="fragment"><div class="line"><span class="lineno">  156</span><span class="keyword">def </span>is_array_scalar(x):</div>
<div class="line"><span class="lineno">  157</span>    <span class="stringliteral">&quot;&quot;&quot;Test whether `x` is either a scalar or an array scalar.</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">return</span> np.size(x) == 1</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4e43d279455305b78dd02236569efb5" name="ab4e43d279455305b78dd02236569efb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4e43d279455305b78dd02236569efb5">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3785</span><span class="keyword">def </span>main():</div>
<div class="line"><span class="lineno"> 3786</span>    <span class="keyword">import</span> time</div>
<div class="line"><span class="lineno"> 3787</span> </div>
<div class="line"><span class="lineno"> 3788</span>    times = []</div>
<div class="line"><span class="lineno"> 3789</span>    algor = []</div>
<div class="line"><span class="lineno"> 3790</span>    x0 = [0.8, 1.2, 0.7]</div>
<div class="line"><span class="lineno"> 3791</span>    print(<span class="stringliteral">&quot;Nelder-Mead Simplex&quot;</span>)</div>
<div class="line"><span class="lineno"> 3792</span>    print(<span class="stringliteral">&quot;===================&quot;</span>)</div>
<div class="line"><span class="lineno"> 3793</span>    start = time.time()</div>
<div class="line"><span class="lineno"> 3794</span>    x = fmin(rosen, x0)</div>
<div class="line"><span class="lineno"> 3795</span>    print(x)</div>
<div class="line"><span class="lineno"> 3796</span>    times.append(time.time() - start)</div>
<div class="line"><span class="lineno"> 3797</span>    algor.append(<span class="stringliteral">&#39;Nelder-Mead Simplex\t&#39;</span>)</div>
<div class="line"><span class="lineno"> 3798</span> </div>
<div class="line"><span class="lineno"> 3799</span>    print()</div>
<div class="line"><span class="lineno"> 3800</span>    print(<span class="stringliteral">&quot;Powell Direction Set Method&quot;</span>)</div>
<div class="line"><span class="lineno"> 3801</span>    print(<span class="stringliteral">&quot;===========================&quot;</span>)</div>
<div class="line"><span class="lineno"> 3802</span>    start = time.time()</div>
<div class="line"><span class="lineno"> 3803</span>    x = fmin_powell(rosen, x0)</div>
<div class="line"><span class="lineno"> 3804</span>    print(x)</div>
<div class="line"><span class="lineno"> 3805</span>    times.append(time.time() - start)</div>
<div class="line"><span class="lineno"> 3806</span>    algor.append(<span class="stringliteral">&#39;Powell Direction Set Method.&#39;</span>)</div>
<div class="line"><span class="lineno"> 3807</span> </div>
<div class="line"><span class="lineno"> 3808</span>    print()</div>
<div class="line"><span class="lineno"> 3809</span>    print(<span class="stringliteral">&quot;Nonlinear CG&quot;</span>)</div>
<div class="line"><span class="lineno"> 3810</span>    print(<span class="stringliteral">&quot;============&quot;</span>)</div>
<div class="line"><span class="lineno"> 3811</span>    start = time.time()</div>
<div class="line"><span class="lineno"> 3812</span>    x = fmin_cg(rosen, x0, fprime=rosen_der, maxiter=200)</div>
<div class="line"><span class="lineno"> 3813</span>    print(x)</div>
<div class="line"><span class="lineno"> 3814</span>    times.append(time.time() - start)</div>
<div class="line"><span class="lineno"> 3815</span>    algor.append(<span class="stringliteral">&#39;Nonlinear CG     \t&#39;</span>)</div>
<div class="line"><span class="lineno"> 3816</span> </div>
<div class="line"><span class="lineno"> 3817</span>    print()</div>
<div class="line"><span class="lineno"> 3818</span>    print(<span class="stringliteral">&quot;BFGS Quasi-Newton&quot;</span>)</div>
<div class="line"><span class="lineno"> 3819</span>    print(<span class="stringliteral">&quot;=================&quot;</span>)</div>
<div class="line"><span class="lineno"> 3820</span>    start = time.time()</div>
<div class="line"><span class="lineno"> 3821</span>    x = fmin_bfgs(rosen, x0, fprime=rosen_der, maxiter=80)</div>
<div class="line"><span class="lineno"> 3822</span>    print(x)</div>
<div class="line"><span class="lineno"> 3823</span>    times.append(time.time() - start)</div>
<div class="line"><span class="lineno"> 3824</span>    algor.append(<span class="stringliteral">&#39;BFGS Quasi-Newton\t&#39;</span>)</div>
<div class="line"><span class="lineno"> 3825</span> </div>
<div class="line"><span class="lineno"> 3826</span>    print()</div>
<div class="line"><span class="lineno"> 3827</span>    print(<span class="stringliteral">&quot;BFGS approximate gradient&quot;</span>)</div>
<div class="line"><span class="lineno"> 3828</span>    print(<span class="stringliteral">&quot;=========================&quot;</span>)</div>
<div class="line"><span class="lineno"> 3829</span>    start = time.time()</div>
<div class="line"><span class="lineno"> 3830</span>    x = fmin_bfgs(rosen, x0, gtol=1e-4, maxiter=100)</div>
<div class="line"><span class="lineno"> 3831</span>    print(x)</div>
<div class="line"><span class="lineno"> 3832</span>    times.append(time.time() - start)</div>
<div class="line"><span class="lineno"> 3833</span>    algor.append(<span class="stringliteral">&#39;BFGS without gradient\t&#39;</span>)</div>
<div class="line"><span class="lineno"> 3834</span> </div>
<div class="line"><span class="lineno"> 3835</span>    print()</div>
<div class="line"><span class="lineno"> 3836</span>    print(<span class="stringliteral">&quot;Newton-CG with Hessian product&quot;</span>)</div>
<div class="line"><span class="lineno"> 3837</span>    print(<span class="stringliteral">&quot;==============================&quot;</span>)</div>
<div class="line"><span class="lineno"> 3838</span>    start = time.time()</div>
<div class="line"><span class="lineno"> 3839</span>    x = fmin_ncg(rosen, x0, rosen_der, fhess_p=rosen_hess_prod, maxiter=80)</div>
<div class="line"><span class="lineno"> 3840</span>    print(x)</div>
<div class="line"><span class="lineno"> 3841</span>    times.append(time.time() - start)</div>
<div class="line"><span class="lineno"> 3842</span>    algor.append(<span class="stringliteral">&#39;Newton-CG with hessian product&#39;</span>)</div>
<div class="line"><span class="lineno"> 3843</span> </div>
<div class="line"><span class="lineno"> 3844</span>    print()</div>
<div class="line"><span class="lineno"> 3845</span>    print(<span class="stringliteral">&quot;Newton-CG with full Hessian&quot;</span>)</div>
<div class="line"><span class="lineno"> 3846</span>    print(<span class="stringliteral">&quot;===========================&quot;</span>)</div>
<div class="line"><span class="lineno"> 3847</span>    start = time.time()</div>
<div class="line"><span class="lineno"> 3848</span>    x = fmin_ncg(rosen, x0, rosen_der, fhess=rosen_hess, maxiter=80)</div>
<div class="line"><span class="lineno"> 3849</span>    print(x)</div>
<div class="line"><span class="lineno"> 3850</span>    times.append(time.time() - start)</div>
<div class="line"><span class="lineno"> 3851</span>    algor.append(<span class="stringliteral">&#39;Newton-CG with full Hessian&#39;</span>)</div>
<div class="line"><span class="lineno"> 3852</span> </div>
<div class="line"><span class="lineno"> 3853</span>    print()</div>
<div class="line"><span class="lineno"> 3854</span>    print(<span class="stringliteral">&quot;\nMinimizing the Rosenbrock function of order 3\n&quot;</span>)</div>
<div class="line"><span class="lineno"> 3855</span>    print(<span class="stringliteral">&quot; Algorithm \t\t\t       Seconds&quot;</span>)</div>
<div class="line"><span class="lineno"> 3856</span>    print(<span class="stringliteral">&quot;===========\t\t\t      =========&quot;</span>)</div>
<div class="line"><span class="lineno"> 3857</span>    <span class="keywordflow">for</span> alg, tme <span class="keywordflow">in</span> zip(algor, times):</div>
<div class="line"><span class="lineno"> 3858</span>        print(alg, <span class="stringliteral">&quot;\t -- &quot;</span>, tme)</div>
<div class="line"><span class="lineno"> 3859</span> </div>
<div class="line"><span class="lineno"> 3860</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a02e15f5b55789e1f63fd216733195454" name="a02e15f5b55789e1f63fd216733195454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02e15f5b55789e1f63fd216733195454">&#9670;&#160;</a></span>rosen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.rosen </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The Rosenbrock function.

The function computed is::

    sum(100.0*(x[1:] - x[:-1]**2.0)**2.0 + (1 - x[:-1])**2.0)

Parameters
----------
x : array_like
    1-D array of points at which the Rosenbrock function is to be computed.

Returns
-------
f : float
    The value of the Rosenbrock function.

See Also
--------
rosen_der, rosen_hess, rosen_hess_prod

Examples
--------
&gt;&gt;&gt; from scipy.optimize import rosen
&gt;&gt;&gt; X = 0.1 * np.arange(10)
&gt;&gt;&gt; rosen(X)
76.56

For higher-dimensional input ``rosen`` broadcasts.
In the following example, we use this to plot a 2D landscape.
Note that ``rosen_hess`` does not broadcast in this manner.

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; from mpl_toolkits.mplot3d import Axes3D
&gt;&gt;&gt; x = np.linspace(-1, 1, 50)
&gt;&gt;&gt; X, Y = np.meshgrid(x, x)
&gt;&gt;&gt; ax = plt.subplot(111, projection='3d')
&gt;&gt;&gt; ax.plot_surface(X, Y, rosen([X, Y]))
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno">  292</span><span class="keyword">def </span>rosen(x):</div>
<div class="line"><span class="lineno">  293</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">    The Rosenbrock function.</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">    The function computed is::</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">        sum(100.0*(x[1:] - x[:-1]**2.0)**2.0 + (1 - x[:-1])**2.0)</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">    x : array_like</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">        1-D array of points at which the Rosenbrock function is to be computed.</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">    f : float</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">        The value of the Rosenbrock function.</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">    rosen_der, rosen_hess, rosen_hess_prod</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import rosen</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">    &gt;&gt;&gt; X = 0.1 * np.arange(10)</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">    &gt;&gt;&gt; rosen(X)</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    76.56</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    For higher-dimensional input ``rosen`` broadcasts.</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">    In the following example, we use this to plot a 2D landscape.</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    Note that ``rosen_hess`` does not broadcast in this manner.</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">    &gt;&gt;&gt; from mpl_toolkits.mplot3d import Axes3D</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">    &gt;&gt;&gt; x = np.linspace(-1, 1, 50)</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">    &gt;&gt;&gt; X, Y = np.meshgrid(x, x)</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">    &gt;&gt;&gt; ax = plt.subplot(111, projection=&#39;3d&#39;)</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    &gt;&gt;&gt; ax.plot_surface(X, Y, rosen([X, Y]))</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  333</span>    x = asarray(x)</div>
<div class="line"><span class="lineno">  334</span>    r = np.sum(100.0 * (x[1:] - x[:-1]**2.0)**2.0 + (1 - x[:-1])**2.0,</div>
<div class="line"><span class="lineno">  335</span>                  axis=0)</div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">return</span> r</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a54e7ddc9ff63c7eaa2b008492c9f7821" name="a54e7ddc9ff63c7eaa2b008492c9f7821"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54e7ddc9ff63c7eaa2b008492c9f7821">&#9670;&#160;</a></span>rosen_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.rosen_der </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The derivative (i.e. gradient) of the Rosenbrock function.

Parameters
----------
x : array_like
    1-D array of points at which the derivative is to be computed.

Returns
-------
rosen_der : (N,) ndarray
    The gradient of the Rosenbrock function at `x`.

See Also
--------
rosen, rosen_hess, rosen_hess_prod

Examples
--------
&gt;&gt;&gt; from scipy.optimize import rosen_der
&gt;&gt;&gt; X = 0.1 * np.arange(9)
&gt;&gt;&gt; rosen_der(X)
array([ -2. ,  10.6,  15.6,  13.4,   6.4,  -3. , -12.4, -19.4,  62. ])</pre> <div class="fragment"><div class="line"><span class="lineno">  339</span><span class="keyword">def </span>rosen_der(x):</div>
<div class="line"><span class="lineno">  340</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    The derivative (i.e. gradient) of the Rosenbrock function.</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    x : array_like</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">        1-D array of points at which the derivative is to be computed.</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    rosen_der : (N,) ndarray</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">        The gradient of the Rosenbrock function at `x`.</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    rosen, rosen_hess, rosen_hess_prod</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import rosen_der</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">    &gt;&gt;&gt; X = 0.1 * np.arange(9)</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">    &gt;&gt;&gt; rosen_der(X)</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">    array([ -2. ,  10.6,  15.6,  13.4,   6.4,  -3. , -12.4, -19.4,  62. ])</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  365</span>    x = asarray(x)</div>
<div class="line"><span class="lineno">  366</span>    xm = x[1:-1]</div>
<div class="line"><span class="lineno">  367</span>    xm_m1 = x[:-2]</div>
<div class="line"><span class="lineno">  368</span>    xm_p1 = x[2:]</div>
<div class="line"><span class="lineno">  369</span>    der = np.zeros_like(x)</div>
<div class="line"><span class="lineno">  370</span>    der[1:-1] = (200 * (xm - xm_m1**2) -</div>
<div class="line"><span class="lineno">  371</span>                 400 * (xm_p1 - xm**2) * xm - 2 * (1 - xm))</div>
<div class="line"><span class="lineno">  372</span>    der[0] = -400 * x[0] * (x[1] - x[0]**2) - 2 * (1 - x[0])</div>
<div class="line"><span class="lineno">  373</span>    der[-1] = 200 * (x[-1] - x[-2]**2)</div>
<div class="line"><span class="lineno">  374</span>    <span class="keywordflow">return</span> der</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aaab0b0f1af6a0025d1ea4ab30b6412b1" name="aaab0b0f1af6a0025d1ea4ab30b6412b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaab0b0f1af6a0025d1ea4ab30b6412b1">&#9670;&#160;</a></span>rosen_hess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.rosen_hess </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The Hessian matrix of the Rosenbrock function.

Parameters
----------
x : array_like
    1-D array of points at which the Hessian matrix is to be computed.

Returns
-------
rosen_hess : ndarray
    The Hessian matrix of the Rosenbrock function at `x`.

See Also
--------
rosen, rosen_der, rosen_hess_prod

Examples
--------
&gt;&gt;&gt; from scipy.optimize import rosen_hess
&gt;&gt;&gt; X = 0.1 * np.arange(4)
&gt;&gt;&gt; rosen_hess(X)
array([[-38.,   0.,   0.,   0.],
       [  0., 134., -40.,   0.],
       [  0., -40., 130., -80.],
       [  0.,   0., -80., 200.]])</pre> <div class="fragment"><div class="line"><span class="lineno">  377</span><span class="keyword">def </span>rosen_hess(x):</div>
<div class="line"><span class="lineno">  378</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">    The Hessian matrix of the Rosenbrock function.</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">    x : array_like</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">        1-D array of points at which the Hessian matrix is to be computed.</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">    rosen_hess : ndarray</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">        The Hessian matrix of the Rosenbrock function at `x`.</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    rosen, rosen_der, rosen_hess_prod</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import rosen_hess</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">    &gt;&gt;&gt; X = 0.1 * np.arange(4)</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    &gt;&gt;&gt; rosen_hess(X)</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    array([[-38.,   0.,   0.,   0.],</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">           [  0., 134., -40.,   0.],</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">           [  0., -40., 130., -80.],</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">           [  0.,   0., -80., 200.]])</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  406</span>    x = atleast_1d(x)</div>
<div class="line"><span class="lineno">  407</span>    H = np.diag(-400 * x[:-1], 1) - np.diag(400 * x[:-1], -1)</div>
<div class="line"><span class="lineno">  408</span>    diagonal = np.zeros(len(x), dtype=x.dtype)</div>
<div class="line"><span class="lineno">  409</span>    diagonal[0] = 1200 * x[0]**2 - 400 * x[1] + 2</div>
<div class="line"><span class="lineno">  410</span>    diagonal[-1] = 200</div>
<div class="line"><span class="lineno">  411</span>    diagonal[1:-1] = 202 + 1200 * x[1:-1]**2 - 400 * x[2:]</div>
<div class="line"><span class="lineno">  412</span>    H = H + np.diag(diagonal)</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">return</span> H</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a531ebd72f83786f0ce75f3347ecb2449" name="a531ebd72f83786f0ce75f3347ecb2449"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a531ebd72f83786f0ce75f3347ecb2449">&#9670;&#160;</a></span>rosen_hess_prod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.rosen_hess_prod </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Product of the Hessian matrix of the Rosenbrock function with a vector.

Parameters
----------
x : array_like
    1-D array of points at which the Hessian matrix is to be computed.
p : array_like
    1-D array, the vector to be multiplied by the Hessian matrix.

Returns
-------
rosen_hess_prod : ndarray
    The Hessian matrix of the Rosenbrock function at `x` multiplied
    by the vector `p`.

See Also
--------
rosen, rosen_der, rosen_hess

Examples
--------
&gt;&gt;&gt; from scipy.optimize import rosen_hess_prod
&gt;&gt;&gt; X = 0.1 * np.arange(9)
&gt;&gt;&gt; p = 0.5 * np.arange(9)
&gt;&gt;&gt; rosen_hess_prod(X, p)
array([  -0.,   27.,  -10.,  -95., -192., -265., -278., -195., -180.])</pre> <div class="fragment"><div class="line"><span class="lineno">  416</span><span class="keyword">def </span>rosen_hess_prod(x, p):</div>
<div class="line"><span class="lineno">  417</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">    Product of the Hessian matrix of the Rosenbrock function with a vector.</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">    x : array_like</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">        1-D array of points at which the Hessian matrix is to be computed.</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">        1-D array, the vector to be multiplied by the Hessian matrix.</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral">    rosen_hess_prod : ndarray</span></div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">        The Hessian matrix of the Rosenbrock function at `x` multiplied</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">        by the vector `p`.</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">    rosen, rosen_der, rosen_hess</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import rosen_hess_prod</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">    &gt;&gt;&gt; X = 0.1 * np.arange(9)</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">    &gt;&gt;&gt; p = 0.5 * np.arange(9)</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    &gt;&gt;&gt; rosen_hess_prod(X, p)</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">    array([  -0.,   27.,  -10.,  -95., -192., -265., -278., -195., -180.])</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  446</span>    x = atleast_1d(x)</div>
<div class="line"><span class="lineno">  447</span>    Hp = np.zeros(len(x), dtype=x.dtype)</div>
<div class="line"><span class="lineno">  448</span>    Hp[0] = (1200 * x[0]**2 - 400 * x[1] + 2) * p[0] - 400 * x[0] * p[1]</div>
<div class="line"><span class="lineno">  449</span>    Hp[1:-1] = (-400 * x[:-2] * p[:-2] +</div>
<div class="line"><span class="lineno">  450</span>                (202 + 1200 * x[1:-1]**2 - 400 * x[2:]) * p[1:-1] -</div>
<div class="line"><span class="lineno">  451</span>                400 * x[1:-1] * p[2:])</div>
<div class="line"><span class="lineno">  452</span>    Hp[-1] = -400 * x[-2] * p[-2] + 200*p[-1]</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">return</span> Hp</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a50f7c818d44ee4c953b28bcddbc326f1" name="a50f7c818d44ee4c953b28bcddbc326f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50f7c818d44ee4c953b28bcddbc326f1">&#9670;&#160;</a></span>show_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.show_options </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>solver</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Show documentation for additional options of optimization solvers.

These are method-specific options that can be supplied through the
``options`` dict.

Parameters
----------
solver : str
    Type of optimization solver. One of 'minimize', 'minimize_scalar',
    'root', 'root_scalar', 'linprog', or 'quadratic_assignment'.
method : str, optional
    If not given, shows all methods of the specified solver. Otherwise,
    show only the options for the specified method. Valid values
    corresponds to methods' names of respective solver (e.g., 'BFGS' for
    'minimize').
disp : bool, optional
    Whether to print the result rather than returning it.

Returns
-------
text
    Either None (for disp=True) or the text string (disp=False)

Notes
-----
The solver-specific methods are:

`scipy.optimize.minimize`

- :ref:`Nelder-Mead &lt;optimize.minimize-neldermead&gt;`
- :ref:`Powell      &lt;optimize.minimize-powell&gt;`
- :ref:`CG          &lt;optimize.minimize-cg&gt;`
- :ref:`BFGS        &lt;optimize.minimize-bfgs&gt;`
- :ref:`Newton-CG   &lt;optimize.minimize-newtoncg&gt;`
- :ref:`L-BFGS-B    &lt;optimize.minimize-lbfgsb&gt;`
- :ref:`TNC         &lt;optimize.minimize-tnc&gt;`
- :ref:`COBYLA      &lt;optimize.minimize-cobyla&gt;`
- :ref:`SLSQP       &lt;optimize.minimize-slsqp&gt;`
- :ref:`dogleg      &lt;optimize.minimize-dogleg&gt;`
- :ref:`trust-ncg   &lt;optimize.minimize-trustncg&gt;`

`scipy.optimize.root`

- :ref:`hybr              &lt;optimize.root-hybr&gt;`
- :ref:`lm                &lt;optimize.root-lm&gt;`
- :ref:`broyden1          &lt;optimize.root-broyden1&gt;`
- :ref:`broyden2          &lt;optimize.root-broyden2&gt;`
- :ref:`anderson          &lt;optimize.root-anderson&gt;`
- :ref:`linearmixing      &lt;optimize.root-linearmixing&gt;`
- :ref:`diagbroyden       &lt;optimize.root-diagbroyden&gt;`
- :ref:`excitingmixing    &lt;optimize.root-excitingmixing&gt;`
- :ref:`krylov            &lt;optimize.root-krylov&gt;`
- :ref:`df-sane           &lt;optimize.root-dfsane&gt;`

`scipy.optimize.minimize_scalar`

- :ref:`brent       &lt;optimize.minimize_scalar-brent&gt;`
- :ref:`golden      &lt;optimize.minimize_scalar-golden&gt;`
- :ref:`bounded     &lt;optimize.minimize_scalar-bounded&gt;`

`scipy.optimize.root_scalar`

- :ref:`bisect  &lt;optimize.root_scalar-bisect&gt;`
- :ref:`brentq  &lt;optimize.root_scalar-brentq&gt;`
- :ref:`brenth  &lt;optimize.root_scalar-brenth&gt;`
- :ref:`ridder  &lt;optimize.root_scalar-ridder&gt;`
- :ref:`toms748 &lt;optimize.root_scalar-toms748&gt;`
- :ref:`newton  &lt;optimize.root_scalar-newton&gt;`
- :ref:`secant  &lt;optimize.root_scalar-secant&gt;`
- :ref:`halley  &lt;optimize.root_scalar-halley&gt;`

`scipy.optimize.linprog`

- :ref:`simplex           &lt;optimize.linprog-simplex&gt;`
- :ref:`interior-point    &lt;optimize.linprog-interior-point&gt;`
- :ref:`revised simplex   &lt;optimize.linprog-revised_simplex&gt;`
- :ref:`highs             &lt;optimize.linprog-highs&gt;`
- :ref:`highs-ds          &lt;optimize.linprog-highs-ds&gt;`
- :ref:`highs-ipm         &lt;optimize.linprog-highs-ipm&gt;`

`scipy.optimize.quadratic_assignment`

- :ref:`faq             &lt;optimize.qap-faq&gt;`
- :ref:`2opt            &lt;optimize.qap-2opt&gt;`

Examples
--------
We can print documentations of a solver in stdout:

&gt;&gt;&gt; from scipy.optimize import show_options
&gt;&gt;&gt; show_options(solver="minimize")
...

Specifying a method is possible:

&gt;&gt;&gt; show_options(solver="minimize", method="Nelder-Mead")
...

We can also get the documentations as a string:

&gt;&gt;&gt; show_options(solver="minimize", method="Nelder-Mead", disp=False)
Minimization of scalar function of one or more variables using the ...</pre> <div class="fragment"><div class="line"><span class="lineno"> 3563</span><span class="keyword">def </span>show_options(solver=None, method=None, disp=True):</div>
<div class="line"><span class="lineno"> 3564</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3565</span><span class="stringliteral">    Show documentation for additional options of optimization solvers.</span></div>
<div class="line"><span class="lineno"> 3566</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3567</span><span class="stringliteral">    These are method-specific options that can be supplied through the</span></div>
<div class="line"><span class="lineno"> 3568</span><span class="stringliteral">    ``options`` dict.</span></div>
<div class="line"><span class="lineno"> 3569</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3570</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3571</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3572</span><span class="stringliteral">    solver : str</span></div>
<div class="line"><span class="lineno"> 3573</span><span class="stringliteral">        Type of optimization solver. One of &#39;minimize&#39;, &#39;minimize_scalar&#39;,</span></div>
<div class="line"><span class="lineno"> 3574</span><span class="stringliteral">        &#39;root&#39;, &#39;root_scalar&#39;, &#39;linprog&#39;, or &#39;quadratic_assignment&#39;.</span></div>
<div class="line"><span class="lineno"> 3575</span><span class="stringliteral">    method : str, optional</span></div>
<div class="line"><span class="lineno"> 3576</span><span class="stringliteral">        If not given, shows all methods of the specified solver. Otherwise,</span></div>
<div class="line"><span class="lineno"> 3577</span><span class="stringliteral">        show only the options for the specified method. Valid values</span></div>
<div class="line"><span class="lineno"> 3578</span><span class="stringliteral">        corresponds to methods&#39; names of respective solver (e.g., &#39;BFGS&#39; for</span></div>
<div class="line"><span class="lineno"> 3579</span><span class="stringliteral">        &#39;minimize&#39;).</span></div>
<div class="line"><span class="lineno"> 3580</span><span class="stringliteral">    disp : bool, optional</span></div>
<div class="line"><span class="lineno"> 3581</span><span class="stringliteral">        Whether to print the result rather than returning it.</span></div>
<div class="line"><span class="lineno"> 3582</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3583</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3584</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3585</span><span class="stringliteral">    text</span></div>
<div class="line"><span class="lineno"> 3586</span><span class="stringliteral">        Either None (for disp=True) or the text string (disp=False)</span></div>
<div class="line"><span class="lineno"> 3587</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3588</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 3589</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 3590</span><span class="stringliteral">    The solver-specific methods are:</span></div>
<div class="line"><span class="lineno"> 3591</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3592</span><span class="stringliteral">    `scipy.optimize.minimize`</span></div>
<div class="line"><span class="lineno"> 3593</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3594</span><span class="stringliteral">    - :ref:`Nelder-Mead &lt;optimize.minimize-neldermead&gt;`</span></div>
<div class="line"><span class="lineno"> 3595</span><span class="stringliteral">    - :ref:`Powell      &lt;optimize.minimize-powell&gt;`</span></div>
<div class="line"><span class="lineno"> 3596</span><span class="stringliteral">    - :ref:`CG          &lt;optimize.minimize-cg&gt;`</span></div>
<div class="line"><span class="lineno"> 3597</span><span class="stringliteral">    - :ref:`BFGS        &lt;optimize.minimize-bfgs&gt;`</span></div>
<div class="line"><span class="lineno"> 3598</span><span class="stringliteral">    - :ref:`Newton-CG   &lt;optimize.minimize-newtoncg&gt;`</span></div>
<div class="line"><span class="lineno"> 3599</span><span class="stringliteral">    - :ref:`L-BFGS-B    &lt;optimize.minimize-lbfgsb&gt;`</span></div>
<div class="line"><span class="lineno"> 3600</span><span class="stringliteral">    - :ref:`TNC         &lt;optimize.minimize-tnc&gt;`</span></div>
<div class="line"><span class="lineno"> 3601</span><span class="stringliteral">    - :ref:`COBYLA      &lt;optimize.minimize-cobyla&gt;`</span></div>
<div class="line"><span class="lineno"> 3602</span><span class="stringliteral">    - :ref:`SLSQP       &lt;optimize.minimize-slsqp&gt;`</span></div>
<div class="line"><span class="lineno"> 3603</span><span class="stringliteral">    - :ref:`dogleg      &lt;optimize.minimize-dogleg&gt;`</span></div>
<div class="line"><span class="lineno"> 3604</span><span class="stringliteral">    - :ref:`trust-ncg   &lt;optimize.minimize-trustncg&gt;`</span></div>
<div class="line"><span class="lineno"> 3605</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3606</span><span class="stringliteral">    `scipy.optimize.root`</span></div>
<div class="line"><span class="lineno"> 3607</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3608</span><span class="stringliteral">    - :ref:`hybr              &lt;optimize.root-hybr&gt;`</span></div>
<div class="line"><span class="lineno"> 3609</span><span class="stringliteral">    - :ref:`lm                &lt;optimize.root-lm&gt;`</span></div>
<div class="line"><span class="lineno"> 3610</span><span class="stringliteral">    - :ref:`broyden1          &lt;optimize.root-broyden1&gt;`</span></div>
<div class="line"><span class="lineno"> 3611</span><span class="stringliteral">    - :ref:`broyden2          &lt;optimize.root-broyden2&gt;`</span></div>
<div class="line"><span class="lineno"> 3612</span><span class="stringliteral">    - :ref:`anderson          &lt;optimize.root-anderson&gt;`</span></div>
<div class="line"><span class="lineno"> 3613</span><span class="stringliteral">    - :ref:`linearmixing      &lt;optimize.root-linearmixing&gt;`</span></div>
<div class="line"><span class="lineno"> 3614</span><span class="stringliteral">    - :ref:`diagbroyden       &lt;optimize.root-diagbroyden&gt;`</span></div>
<div class="line"><span class="lineno"> 3615</span><span class="stringliteral">    - :ref:`excitingmixing    &lt;optimize.root-excitingmixing&gt;`</span></div>
<div class="line"><span class="lineno"> 3616</span><span class="stringliteral">    - :ref:`krylov            &lt;optimize.root-krylov&gt;`</span></div>
<div class="line"><span class="lineno"> 3617</span><span class="stringliteral">    - :ref:`df-sane           &lt;optimize.root-dfsane&gt;`</span></div>
<div class="line"><span class="lineno"> 3618</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3619</span><span class="stringliteral">    `scipy.optimize.minimize_scalar`</span></div>
<div class="line"><span class="lineno"> 3620</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3621</span><span class="stringliteral">    - :ref:`brent       &lt;optimize.minimize_scalar-brent&gt;`</span></div>
<div class="line"><span class="lineno"> 3622</span><span class="stringliteral">    - :ref:`golden      &lt;optimize.minimize_scalar-golden&gt;`</span></div>
<div class="line"><span class="lineno"> 3623</span><span class="stringliteral">    - :ref:`bounded     &lt;optimize.minimize_scalar-bounded&gt;`</span></div>
<div class="line"><span class="lineno"> 3624</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3625</span><span class="stringliteral">    `scipy.optimize.root_scalar`</span></div>
<div class="line"><span class="lineno"> 3626</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3627</span><span class="stringliteral">    - :ref:`bisect  &lt;optimize.root_scalar-bisect&gt;`</span></div>
<div class="line"><span class="lineno"> 3628</span><span class="stringliteral">    - :ref:`brentq  &lt;optimize.root_scalar-brentq&gt;`</span></div>
<div class="line"><span class="lineno"> 3629</span><span class="stringliteral">    - :ref:`brenth  &lt;optimize.root_scalar-brenth&gt;`</span></div>
<div class="line"><span class="lineno"> 3630</span><span class="stringliteral">    - :ref:`ridder  &lt;optimize.root_scalar-ridder&gt;`</span></div>
<div class="line"><span class="lineno"> 3631</span><span class="stringliteral">    - :ref:`toms748 &lt;optimize.root_scalar-toms748&gt;`</span></div>
<div class="line"><span class="lineno"> 3632</span><span class="stringliteral">    - :ref:`newton  &lt;optimize.root_scalar-newton&gt;`</span></div>
<div class="line"><span class="lineno"> 3633</span><span class="stringliteral">    - :ref:`secant  &lt;optimize.root_scalar-secant&gt;`</span></div>
<div class="line"><span class="lineno"> 3634</span><span class="stringliteral">    - :ref:`halley  &lt;optimize.root_scalar-halley&gt;`</span></div>
<div class="line"><span class="lineno"> 3635</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3636</span><span class="stringliteral">    `scipy.optimize.linprog`</span></div>
<div class="line"><span class="lineno"> 3637</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3638</span><span class="stringliteral">    - :ref:`simplex           &lt;optimize.linprog-simplex&gt;`</span></div>
<div class="line"><span class="lineno"> 3639</span><span class="stringliteral">    - :ref:`interior-point    &lt;optimize.linprog-interior-point&gt;`</span></div>
<div class="line"><span class="lineno"> 3640</span><span class="stringliteral">    - :ref:`revised simplex   &lt;optimize.linprog-revised_simplex&gt;`</span></div>
<div class="line"><span class="lineno"> 3641</span><span class="stringliteral">    - :ref:`highs             &lt;optimize.linprog-highs&gt;`</span></div>
<div class="line"><span class="lineno"> 3642</span><span class="stringliteral">    - :ref:`highs-ds          &lt;optimize.linprog-highs-ds&gt;`</span></div>
<div class="line"><span class="lineno"> 3643</span><span class="stringliteral">    - :ref:`highs-ipm         &lt;optimize.linprog-highs-ipm&gt;`</span></div>
<div class="line"><span class="lineno"> 3644</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3645</span><span class="stringliteral">    `scipy.optimize.quadratic_assignment`</span></div>
<div class="line"><span class="lineno"> 3646</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3647</span><span class="stringliteral">    - :ref:`faq             &lt;optimize.qap-faq&gt;`</span></div>
<div class="line"><span class="lineno"> 3648</span><span class="stringliteral">    - :ref:`2opt            &lt;optimize.qap-2opt&gt;`</span></div>
<div class="line"><span class="lineno"> 3649</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3650</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3651</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3652</span><span class="stringliteral">    We can print documentations of a solver in stdout:</span></div>
<div class="line"><span class="lineno"> 3653</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3654</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import show_options</span></div>
<div class="line"><span class="lineno"> 3655</span><span class="stringliteral">    &gt;&gt;&gt; show_options(solver=&quot;minimize&quot;)</span></div>
<div class="line"><span class="lineno"> 3656</span><span class="stringliteral">    ...</span></div>
<div class="line"><span class="lineno"> 3657</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3658</span><span class="stringliteral">    Specifying a method is possible:</span></div>
<div class="line"><span class="lineno"> 3659</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3660</span><span class="stringliteral">    &gt;&gt;&gt; show_options(solver=&quot;minimize&quot;, method=&quot;Nelder-Mead&quot;)</span></div>
<div class="line"><span class="lineno"> 3661</span><span class="stringliteral">    ...</span></div>
<div class="line"><span class="lineno"> 3662</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3663</span><span class="stringliteral">    We can also get the documentations as a string:</span></div>
<div class="line"><span class="lineno"> 3664</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3665</span><span class="stringliteral">    &gt;&gt;&gt; show_options(solver=&quot;minimize&quot;, method=&quot;Nelder-Mead&quot;, disp=False)</span></div>
<div class="line"><span class="lineno"> 3666</span><span class="stringliteral">    Minimization of scalar function of one or more variables using the ...</span></div>
<div class="line"><span class="lineno"> 3667</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3668</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3669</span>    <span class="keyword">import</span> textwrap</div>
<div class="line"><span class="lineno"> 3670</span> </div>
<div class="line"><span class="lineno"> 3671</span>    doc_routines = {</div>
<div class="line"><span class="lineno"> 3672</span>        <span class="stringliteral">&#39;minimize&#39;</span>: (</div>
<div class="line"><span class="lineno"> 3673</span>            (<span class="stringliteral">&#39;bfgs&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._optimize._minimize_bfgs&#39;</span>),</div>
<div class="line"><span class="lineno"> 3674</span>            (<span class="stringliteral">&#39;cg&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._optimize._minimize_cg&#39;</span>),</div>
<div class="line"><span class="lineno"> 3675</span>            (<span class="stringliteral">&#39;cobyla&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._cobyla_py._minimize_cobyla&#39;</span>),</div>
<div class="line"><span class="lineno"> 3676</span>            (<span class="stringliteral">&#39;dogleg&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._trustregion_dogleg._minimize_dogleg&#39;</span>),</div>
<div class="line"><span class="lineno"> 3677</span>            (<span class="stringliteral">&#39;l-bfgs-b&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._lbfgsb_py._minimize_lbfgsb&#39;</span>),</div>
<div class="line"><span class="lineno"> 3678</span>            (<span class="stringliteral">&#39;nelder-mead&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._optimize._minimize_neldermead&#39;</span>),</div>
<div class="line"><span class="lineno"> 3679</span>            (<span class="stringliteral">&#39;newton-cg&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._optimize._minimize_newtoncg&#39;</span>),</div>
<div class="line"><span class="lineno"> 3680</span>            (<span class="stringliteral">&#39;powell&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._optimize._minimize_powell&#39;</span>),</div>
<div class="line"><span class="lineno"> 3681</span>            (<span class="stringliteral">&#39;slsqp&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._slsqp_py._minimize_slsqp&#39;</span>),</div>
<div class="line"><span class="lineno"> 3682</span>            (<span class="stringliteral">&#39;tnc&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._tnc._minimize_tnc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3683</span>            (<span class="stringliteral">&#39;trust-ncg&#39;</span>,</div>
<div class="line"><span class="lineno"> 3684</span>             <span class="stringliteral">&#39;scipy.optimize._trustregion_ncg._minimize_trust_ncg&#39;</span>),</div>
<div class="line"><span class="lineno"> 3685</span>            (<span class="stringliteral">&#39;trust-constr&#39;</span>,</div>
<div class="line"><span class="lineno"> 3686</span>             <span class="stringliteral">&#39;scipy.optimize._trustregion_constr.&#39;</span></div>
<div class="line"><span class="lineno"> 3687</span>             <span class="stringliteral">&#39;_minimize_trustregion_constr&#39;</span>),</div>
<div class="line"><span class="lineno"> 3688</span>            (<span class="stringliteral">&#39;trust-exact&#39;</span>,</div>
<div class="line"><span class="lineno"> 3689</span>             <span class="stringliteral">&#39;scipy.optimize._trustregion_exact._minimize_trustregion_exact&#39;</span>),</div>
<div class="line"><span class="lineno"> 3690</span>            (<span class="stringliteral">&#39;trust-krylov&#39;</span>,</div>
<div class="line"><span class="lineno"> 3691</span>             <span class="stringliteral">&#39;scipy.optimize._trustregion_krylov._minimize_trust_krylov&#39;</span>),</div>
<div class="line"><span class="lineno"> 3692</span>        ),</div>
<div class="line"><span class="lineno"> 3693</span>        <span class="stringliteral">&#39;root&#39;</span>: (</div>
<div class="line"><span class="lineno"> 3694</span>            (<span class="stringliteral">&#39;hybr&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._minpack_py._root_hybr&#39;</span>),</div>
<div class="line"><span class="lineno"> 3695</span>            (<span class="stringliteral">&#39;lm&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root._root_leastsq&#39;</span>),</div>
<div class="line"><span class="lineno"> 3696</span>            (<span class="stringliteral">&#39;broyden1&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root._root_broyden1_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3697</span>            (<span class="stringliteral">&#39;broyden2&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root._root_broyden2_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3698</span>            (<span class="stringliteral">&#39;anderson&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root._root_anderson_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3699</span>            (<span class="stringliteral">&#39;diagbroyden&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root._root_diagbroyden_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3700</span>            (<span class="stringliteral">&#39;excitingmixing&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root._root_excitingmixing_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3701</span>            (<span class="stringliteral">&#39;linearmixing&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root._root_linearmixing_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3702</span>            (<span class="stringliteral">&#39;krylov&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root._root_krylov_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3703</span>            (<span class="stringliteral">&#39;df-sane&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._spectral._root_df_sane&#39;</span>),</div>
<div class="line"><span class="lineno"> 3704</span>        ),</div>
<div class="line"><span class="lineno"> 3705</span>        <span class="stringliteral">&#39;root_scalar&#39;</span>: (</div>
<div class="line"><span class="lineno"> 3706</span>            (<span class="stringliteral">&#39;bisect&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root_scalar._root_scalar_bisect_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3707</span>            (<span class="stringliteral">&#39;brentq&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root_scalar._root_scalar_brentq_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3708</span>            (<span class="stringliteral">&#39;brenth&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root_scalar._root_scalar_brenth_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3709</span>            (<span class="stringliteral">&#39;ridder&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root_scalar._root_scalar_ridder_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3710</span>            (<span class="stringliteral">&#39;toms748&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root_scalar._root_scalar_toms748_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3711</span>            (<span class="stringliteral">&#39;secant&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root_scalar._root_scalar_secant_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3712</span>            (<span class="stringliteral">&#39;newton&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root_scalar._root_scalar_newton_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3713</span>            (<span class="stringliteral">&#39;halley&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._root_scalar._root_scalar_halley_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3714</span>        ),</div>
<div class="line"><span class="lineno"> 3715</span>        <span class="stringliteral">&#39;linprog&#39;</span>: (</div>
<div class="line"><span class="lineno"> 3716</span>            (<span class="stringliteral">&#39;simplex&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._linprog._linprog_simplex_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3717</span>            (<span class="stringliteral">&#39;interior-point&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._linprog._linprog_ip_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3718</span>            (<span class="stringliteral">&#39;revised simplex&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._linprog._linprog_rs_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3719</span>            (<span class="stringliteral">&#39;highs-ipm&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._linprog._linprog_highs_ipm_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3720</span>            (<span class="stringliteral">&#39;highs-ds&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._linprog._linprog_highs_ds_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3721</span>            (<span class="stringliteral">&#39;highs&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._linprog._linprog_highs_doc&#39;</span>),</div>
<div class="line"><span class="lineno"> 3722</span>        ),</div>
<div class="line"><span class="lineno"> 3723</span>        <span class="stringliteral">&#39;quadratic_assignment&#39;</span>: (</div>
<div class="line"><span class="lineno"> 3724</span>            (<span class="stringliteral">&#39;faq&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._qap._quadratic_assignment_faq&#39;</span>),</div>
<div class="line"><span class="lineno"> 3725</span>            (<span class="stringliteral">&#39;2opt&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._qap._quadratic_assignment_2opt&#39;</span>),</div>
<div class="line"><span class="lineno"> 3726</span>        ),</div>
<div class="line"><span class="lineno"> 3727</span>        <span class="stringliteral">&#39;minimize_scalar&#39;</span>: (</div>
<div class="line"><span class="lineno"> 3728</span>            (<span class="stringliteral">&#39;brent&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._optimize._minimize_scalar_brent&#39;</span>),</div>
<div class="line"><span class="lineno"> 3729</span>            (<span class="stringliteral">&#39;bounded&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._optimize._minimize_scalar_bounded&#39;</span>),</div>
<div class="line"><span class="lineno"> 3730</span>            (<span class="stringliteral">&#39;golden&#39;</span>, <span class="stringliteral">&#39;scipy.optimize._optimize._minimize_scalar_golden&#39;</span>),</div>
<div class="line"><span class="lineno"> 3731</span>        ),</div>
<div class="line"><span class="lineno"> 3732</span>    }</div>
<div class="line"><span class="lineno"> 3733</span> </div>
<div class="line"><span class="lineno"> 3734</span>    <span class="keywordflow">if</span> solver <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3735</span>        text = [<span class="stringliteral">&quot;\n\n\n========\n&quot;</span>, <span class="stringliteral">&quot;minimize\n&quot;</span>, <span class="stringliteral">&quot;========\n&quot;</span>]</div>
<div class="line"><span class="lineno"> 3736</span>        text.append(show_options(<span class="stringliteral">&#39;minimize&#39;</span>, disp=<span class="keyword">False</span>))</div>
<div class="line"><span class="lineno"> 3737</span>        text.extend([<span class="stringliteral">&quot;\n\n===============\n&quot;</span>, <span class="stringliteral">&quot;minimize_scalar\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3738</span>                     <span class="stringliteral">&quot;===============\n&quot;</span>])</div>
<div class="line"><span class="lineno"> 3739</span>        text.append(show_options(<span class="stringliteral">&#39;minimize_scalar&#39;</span>, disp=<span class="keyword">False</span>))</div>
<div class="line"><span class="lineno"> 3740</span>        text.extend([<span class="stringliteral">&quot;\n\n\n====\n&quot;</span>, <span class="stringliteral">&quot;root\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3741</span>                     <span class="stringliteral">&quot;====\n&quot;</span>])</div>
<div class="line"><span class="lineno"> 3742</span>        text.append(show_options(<span class="stringliteral">&#39;root&#39;</span>, disp=<span class="keyword">False</span>))</div>
<div class="line"><span class="lineno"> 3743</span>        text.extend([<span class="stringliteral">&#39;\n\n\n=======\n&#39;</span>, <span class="stringliteral">&#39;linprog\n&#39;</span>,</div>
<div class="line"><span class="lineno"> 3744</span>                     <span class="stringliteral">&#39;=======\n&#39;</span>])</div>
<div class="line"><span class="lineno"> 3745</span>        text.append(show_options(<span class="stringliteral">&#39;linprog&#39;</span>, disp=<span class="keyword">False</span>))</div>
<div class="line"><span class="lineno"> 3746</span>        text = <span class="stringliteral">&quot;&quot;</span>.join(text)</div>
<div class="line"><span class="lineno"> 3747</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3748</span>        solver = solver.lower()</div>
<div class="line"><span class="lineno"> 3749</span>        <span class="keywordflow">if</span> solver <span class="keywordflow">not</span> <span class="keywordflow">in</span> doc_routines:</div>
<div class="line"><span class="lineno"> 3750</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Unknown solver %r&#39;</span> % (solver,))</div>
<div class="line"><span class="lineno"> 3751</span> </div>
<div class="line"><span class="lineno"> 3752</span>        <span class="keywordflow">if</span> method <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3753</span>            text = []</div>
<div class="line"><span class="lineno"> 3754</span>            <span class="keywordflow">for</span> name, _ <span class="keywordflow">in</span> doc_routines[solver]:</div>
<div class="line"><span class="lineno"> 3755</span>                text.extend([<span class="stringliteral">&quot;\n\n&quot;</span> + name, <span class="stringliteral">&quot;\n&quot;</span> + <span class="stringliteral">&quot;=&quot;</span>*len(name) + <span class="stringliteral">&quot;\n\n&quot;</span>])</div>
<div class="line"><span class="lineno"> 3756</span>                text.append(show_options(solver, name, disp=<span class="keyword">False</span>))</div>
<div class="line"><span class="lineno"> 3757</span>            text = <span class="stringliteral">&quot;&quot;</span>.join(text)</div>
<div class="line"><span class="lineno"> 3758</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3759</span>            method = method.lower()</div>
<div class="line"><span class="lineno"> 3760</span>            methods = dict(doc_routines[solver])</div>
<div class="line"><span class="lineno"> 3761</span>            <span class="keywordflow">if</span> method <span class="keywordflow">not</span> <span class="keywordflow">in</span> methods:</div>
<div class="line"><span class="lineno"> 3762</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unknown method %r&quot;</span> % (method,))</div>
<div class="line"><span class="lineno"> 3763</span>            name = methods[method]</div>
<div class="line"><span class="lineno"> 3764</span> </div>
<div class="line"><span class="lineno"> 3765</span>            <span class="comment"># Import function object</span></div>
<div class="line"><span class="lineno"> 3766</span>            parts = name.split(<span class="stringliteral">&#39;.&#39;</span>)</div>
<div class="line"><span class="lineno"> 3767</span>            mod_name = <span class="stringliteral">&quot;.&quot;</span>.join(parts[:-1])</div>
<div class="line"><span class="lineno"> 3768</span>            __import__(mod_name)</div>
<div class="line"><span class="lineno"> 3769</span>            obj = getattr(sys.modules[mod_name], parts[-1])</div>
<div class="line"><span class="lineno"> 3770</span> </div>
<div class="line"><span class="lineno"> 3771</span>            <span class="comment"># Get doc</span></div>
<div class="line"><span class="lineno"> 3772</span>            doc = obj.__doc__</div>
<div class="line"><span class="lineno"> 3773</span>            <span class="keywordflow">if</span> doc <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3774</span>                text = textwrap.dedent(doc).strip()</div>
<div class="line"><span class="lineno"> 3775</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3776</span>                text = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3777</span> </div>
<div class="line"><span class="lineno"> 3778</span>    <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno"> 3779</span>        print(text)</div>
<div class="line"><span class="lineno"> 3780</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno"> 3781</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3782</span>        <span class="keywordflow">return</span> text</div>
<div class="line"><span class="lineno"> 3783</span> </div>
<div class="line"><span class="lineno"> 3784</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a77867a3f237b7be985c2947451714929" name="a77867a3f237b7be985c2947451714929"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77867a3f237b7be985c2947451714929">&#9670;&#160;</a></span>vecnorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize.vecnorm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ord</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  166</span><span class="keyword">def </span>vecnorm(x, ord=2):</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">if</span> ord == Inf:</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">return</span> np.amax(np.abs(x))</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">elif</span> ord == -Inf:</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">return</span> np.amin(np.abs(x))</div>
<div class="line"><span class="lineno">  171</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  172</span>        <span class="keywordflow">return</span> np.sum(np.abs(x)**ord, axis=0)**(1.0 / ord)</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8c8bc7126a371e035fd8e52aff856d71" name="a8c8bc7126a371e035fd8e52aff856d71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c8bc7126a371e035fd8e52aff856d71">&#9670;&#160;</a></span>_epsilon</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._optimize._epsilon = sqrt(np.finfo(float).<a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a09a2252518464e5a38ff3fcffce3e3dc" name="a09a2252518464e5a38ff3fcffce3e3dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09a2252518464e5a38ff3fcffce3e3dc">&#9670;&#160;</a></span>_status_message</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.optimize._optimize._status_message</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {<span class="stringliteral">&#39;success&#39;</span>: <span class="stringliteral">&#39;Optimization terminated successfully.&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>                   <span class="stringliteral">&#39;maxfev&#39;</span>: <span class="stringliteral">&#39;Maximum number of function evaluations has &#39;</span></div>
<div class="line"><span class="lineno">    3</span>                              <span class="stringliteral">&#39;been exceeded.&#39;</span>,</div>
<div class="line"><span class="lineno">    4</span>                   <span class="stringliteral">&#39;maxiter&#39;</span>: <span class="stringliteral">&#39;Maximum number of iterations has been &#39;</span></div>
<div class="line"><span class="lineno">    5</span>                              <span class="stringliteral">&#39;exceeded.&#39;</span>,</div>
<div class="line"><span class="lineno">    6</span>                   <span class="stringliteral">&#39;pr_loss&#39;</span>: <span class="stringliteral">&#39;Desired error not necessarily achieved due &#39;</span></div>
<div class="line"><span class="lineno">    7</span>                              <span class="stringliteral">&#39;to precision loss.&#39;</span>,</div>
<div class="line"><span class="lineno">    8</span>                   <span class="stringliteral">&#39;nan&#39;</span>: <span class="stringliteral">&#39;NaN result encountered.&#39;</span>,</div>
<div class="line"><span class="lineno">    9</span>                   <span class="stringliteral">&#39;out_of_bounds&#39;</span>: <span class="stringliteral">&#39;The result is outside of the provided &#39;</span></div>
<div class="line"><span class="lineno">   10</span>                                    <span class="stringliteral">&#39;bounds.&#39;</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
