<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.neural_network.tests.test_mlp Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1neural__network.html">neural_network</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html">test_mlp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sklearn.neural_network.tests.test_mlp Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8f39d1d4b8a1c836c441fd787af1c001" id="r_a8f39d1d4b8a1c836c441fd787af1c001"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a8f39d1d4b8a1c836c441fd787af1c001">test_alpha</a> ()</td></tr>
<tr class="separator:a8f39d1d4b8a1c836c441fd787af1c001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39c8143409d88b00bf357671c7aefda9" id="r_a39c8143409d88b00bf357671c7aefda9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a39c8143409d88b00bf357671c7aefda9">test_fit</a> ()</td></tr>
<tr class="separator:a39c8143409d88b00bf357671c7aefda9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae94d4c02908e1612fa4fe9de48ed2a91" id="r_ae94d4c02908e1612fa4fe9de48ed2a91"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae94d4c02908e1612fa4fe9de48ed2a91">test_gradient</a> ()</td></tr>
<tr class="separator:ae94d4c02908e1612fa4fe9de48ed2a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a565841a9d225e989462be677926c60fd" id="r_a565841a9d225e989462be677926c60fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a565841a9d225e989462be677926c60fd">test_lbfgs_classification</a> (X, y)</td></tr>
<tr class="separator:a565841a9d225e989462be677926c60fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987fd4a3a1407b945075a80b72527d4c" id="r_a987fd4a3a1407b945075a80b72527d4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a987fd4a3a1407b945075a80b72527d4c">test_lbfgs_regression</a> (X, y)</td></tr>
<tr class="separator:a987fd4a3a1407b945075a80b72527d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3c5ba0300b7bb4080cbac08bc3f058" id="r_a2e3c5ba0300b7bb4080cbac08bc3f058"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a2e3c5ba0300b7bb4080cbac08bc3f058">test_lbfgs_classification_maxfun</a> (X, y)</td></tr>
<tr class="separator:a2e3c5ba0300b7bb4080cbac08bc3f058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aad51e4cd90eed1a9b010287759e27e" id="r_a7aad51e4cd90eed1a9b010287759e27e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a7aad51e4cd90eed1a9b010287759e27e">test_lbfgs_regression_maxfun</a> (X, y)</td></tr>
<tr class="separator:a7aad51e4cd90eed1a9b010287759e27e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84f918cc78990614c5414aa2fad5456" id="r_ac84f918cc78990614c5414aa2fad5456"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ac84f918cc78990614c5414aa2fad5456">test_learning_rate_warmstart</a> ()</td></tr>
<tr class="separator:ac84f918cc78990614c5414aa2fad5456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2727f666365a01eb23bce8f1d42956e" id="r_ab2727f666365a01eb23bce8f1d42956e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ab2727f666365a01eb23bce8f1d42956e">test_multilabel_classification</a> ()</td></tr>
<tr class="separator:ab2727f666365a01eb23bce8f1d42956e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d049d7425d7e288c9f8148897f664f7" id="r_a8d049d7425d7e288c9f8148897f664f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a8d049d7425d7e288c9f8148897f664f7">test_multioutput_regression</a> ()</td></tr>
<tr class="separator:a8d049d7425d7e288c9f8148897f664f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2447bd81e9240bc057909498ca486424" id="r_a2447bd81e9240bc057909498ca486424"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a2447bd81e9240bc057909498ca486424">test_partial_fit_classes_error</a> ()</td></tr>
<tr class="separator:a2447bd81e9240bc057909498ca486424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4456f3262dafcaa29fed11cf08cc5834" id="r_a4456f3262dafcaa29fed11cf08cc5834"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a4456f3262dafcaa29fed11cf08cc5834">test_partial_fit_classification</a> ()</td></tr>
<tr class="separator:a4456f3262dafcaa29fed11cf08cc5834"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35364d5983dcc58e0be9edbd8d05a2e8" id="r_a35364d5983dcc58e0be9edbd8d05a2e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a35364d5983dcc58e0be9edbd8d05a2e8">test_partial_fit_unseen_classes</a> ()</td></tr>
<tr class="separator:a35364d5983dcc58e0be9edbd8d05a2e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a75d4fb7963870a1cbf8997689b76d6" id="r_a6a75d4fb7963870a1cbf8997689b76d6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a6a75d4fb7963870a1cbf8997689b76d6">test_partial_fit_regression</a> ()</td></tr>
<tr class="separator:a6a75d4fb7963870a1cbf8997689b76d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1dbf7d8ba33c6d81fd5f73071e28cfb" id="r_af1dbf7d8ba33c6d81fd5f73071e28cfb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#af1dbf7d8ba33c6d81fd5f73071e28cfb">test_partial_fit_errors</a> ()</td></tr>
<tr class="separator:af1dbf7d8ba33c6d81fd5f73071e28cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a350b5d1c5d172d7b557bdfc081fdd9a9" id="r_a350b5d1c5d172d7b557bdfc081fdd9a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a350b5d1c5d172d7b557bdfc081fdd9a9">test_nonfinite_params</a> ()</td></tr>
<tr class="separator:a350b5d1c5d172d7b557bdfc081fdd9a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea534ac81cf906f03462e37a2f2abad" id="r_a7ea534ac81cf906f03462e37a2f2abad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a7ea534ac81cf906f03462e37a2f2abad">test_predict_proba_binary</a> ()</td></tr>
<tr class="separator:a7ea534ac81cf906f03462e37a2f2abad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5bc0f25a21e42410dfdb0d2538198dd" id="r_ab5bc0f25a21e42410dfdb0d2538198dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ab5bc0f25a21e42410dfdb0d2538198dd">test_predict_proba_multiclass</a> ()</td></tr>
<tr class="separator:ab5bc0f25a21e42410dfdb0d2538198dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebe8d02ee0ea66260e9c417e118a27f4" id="r_aebe8d02ee0ea66260e9c417e118a27f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aebe8d02ee0ea66260e9c417e118a27f4">test_predict_proba_multilabel</a> ()</td></tr>
<tr class="separator:aebe8d02ee0ea66260e9c417e118a27f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae476ea7cc86be32e324976da911fb9c7" id="r_ae476ea7cc86be32e324976da911fb9c7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae476ea7cc86be32e324976da911fb9c7">test_shuffle</a> ()</td></tr>
<tr class="separator:ae476ea7cc86be32e324976da911fb9c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9cc8e812d56d506cf202ccbd7569059" id="r_ae9cc8e812d56d506cf202ccbd7569059"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae9cc8e812d56d506cf202ccbd7569059">test_sparse_matrices</a> ()</td></tr>
<tr class="separator:ae9cc8e812d56d506cf202ccbd7569059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1786d36f31a009126f52f1591478f889" id="r_a1786d36f31a009126f52f1591478f889"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a1786d36f31a009126f52f1591478f889">test_tolerance</a> ()</td></tr>
<tr class="separator:a1786d36f31a009126f52f1591478f889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8adae4f143035c238e92d22204c1d2b2" id="r_a8adae4f143035c238e92d22204c1d2b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a8adae4f143035c238e92d22204c1d2b2">test_verbose_sgd</a> ()</td></tr>
<tr class="separator:a8adae4f143035c238e92d22204c1d2b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99ecc0cd3422b3e82da6e09b4e1ae857" id="r_a99ecc0cd3422b3e82da6e09b4e1ae857"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a99ecc0cd3422b3e82da6e09b4e1ae857">test_early_stopping</a> (MLPEstimator)</td></tr>
<tr class="separator:a99ecc0cd3422b3e82da6e09b4e1ae857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a786c1d1325d4eb24f1e42dba627a0c11" id="r_a786c1d1325d4eb24f1e42dba627a0c11"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a786c1d1325d4eb24f1e42dba627a0c11">test_adaptive_learning_rate</a> ()</td></tr>
<tr class="separator:a786c1d1325d4eb24f1e42dba627a0c11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba31069da1837d412eef94011b3f5075" id="r_aba31069da1837d412eef94011b3f5075"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aba31069da1837d412eef94011b3f5075">test_warm_start</a> ()</td></tr>
<tr class="separator:aba31069da1837d412eef94011b3f5075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33c02ab2f361d9fd85edc074b0111420" id="r_a33c02ab2f361d9fd85edc074b0111420"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a33c02ab2f361d9fd85edc074b0111420">test_warm_start_full_iteration</a> (MLPEstimator)</td></tr>
<tr class="separator:a33c02ab2f361d9fd85edc074b0111420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac726590d9ce841a4a4644c71caeb9b21" id="r_ac726590d9ce841a4a4644c71caeb9b21"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ac726590d9ce841a4a4644c71caeb9b21">test_n_iter_no_change</a> ()</td></tr>
<tr class="separator:ac726590d9ce841a4a4644c71caeb9b21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04ce2e6eadaca5dd398589d52639a576" id="r_a04ce2e6eadaca5dd398589d52639a576"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a04ce2e6eadaca5dd398589d52639a576">test_n_iter_no_change_inf</a> ()</td></tr>
<tr class="separator:a04ce2e6eadaca5dd398589d52639a576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41c0718f7ed87d0c8de1eec375952e61" id="r_a41c0718f7ed87d0c8de1eec375952e61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a41c0718f7ed87d0c8de1eec375952e61">test_early_stopping_stratified</a> ()</td></tr>
<tr class="separator:a41c0718f7ed87d0c8de1eec375952e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2ab5c1e0ba063a1313cb18a16b2125c" id="r_aa2ab5c1e0ba063a1313cb18a16b2125c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aa2ab5c1e0ba063a1313cb18a16b2125c">test_mlp_classifier_dtypes_casting</a> ()</td></tr>
<tr class="separator:aa2ab5c1e0ba063a1313cb18a16b2125c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb3fcdee462b7280d7ec793f647695e5" id="r_acb3fcdee462b7280d7ec793f647695e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#acb3fcdee462b7280d7ec793f647695e5">test_mlp_regressor_dtypes_casting</a> ()</td></tr>
<tr class="separator:acb3fcdee462b7280d7ec793f647695e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e26da6b433edc44df6a775c35e1b6d" id="r_a11e26da6b433edc44df6a775c35e1b6d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a11e26da6b433edc44df6a775c35e1b6d">test_mlp_param_dtypes</a> (dtype, Estimator)</td></tr>
<tr class="separator:a11e26da6b433edc44df6a775c35e1b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ccb270d00fc93b4c05644f49981f50" id="r_ae9ccb270d00fc93b4c05644f49981f50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae9ccb270d00fc93b4c05644f49981f50">test_mlp_loading_from_joblib_partial_fit</a> (tmp_path)</td></tr>
<tr class="separator:ae9ccb270d00fc93b4c05644f49981f50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5644282e1908d38f78c3631893316875" id="r_a5644282e1908d38f78c3631893316875"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a5644282e1908d38f78c3631893316875">test_mlp_warm_start_with_early_stopping</a> (MLPEstimator)</td></tr>
<tr class="separator:a5644282e1908d38f78c3631893316875"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a00b4fde4ddacec55d607496e54249a16" id="r_a00b4fde4ddacec55d607496e54249a16"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a00b4fde4ddacec55d607496e54249a16">ACTIVATION_TYPES</a> = [&quot;identity&quot;, &quot;logistic&quot;, &quot;tanh&quot;, &quot;relu&quot;]</td></tr>
<tr class="separator:a00b4fde4ddacec55d607496e54249a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae497361b1402ccade424e806046329b7" id="r_ae497361b1402ccade424e806046329b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae497361b1402ccade424e806046329b7">X_digits</a></td></tr>
<tr class="separator:ae497361b1402ccade424e806046329b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec28455bf8211f083be74eacb5a630ce" id="r_aec28455bf8211f083be74eacb5a630ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aec28455bf8211f083be74eacb5a630ce">y_digits</a></td></tr>
<tr class="separator:aec28455bf8211f083be74eacb5a630ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c669c91d031b0b441fd3ee580cf0ba3" id="r_a0c669c91d031b0b441fd3ee580cf0ba3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a0c669c91d031b0b441fd3ee580cf0ba3">n_class</a></td></tr>
<tr class="separator:a0c669c91d031b0b441fd3ee580cf0ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bc5c7300232f2ab27f08ba117a522c9" id="r_a4bc5c7300232f2ab27f08ba117a522c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a4bc5c7300232f2ab27f08ba117a522c9">return_X_y</a></td></tr>
<tr class="separator:a4bc5c7300232f2ab27f08ba117a522c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a322657f2e6dc97d733b5263c587dc09d" id="r_a322657f2e6dc97d733b5263c587dc09d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a322657f2e6dc97d733b5263c587dc09d">X_digits_multi</a> = <a class="el" href="classsklearn_1_1preprocessing_1_1__data_1_1_min_max_scaler.html">MinMaxScaler</a>().fit_transform(<a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae497361b1402ccade424e806046329b7">X_digits</a>[:200])</td></tr>
<tr class="separator:a322657f2e6dc97d733b5263c587dc09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80167de8a121787b37d4aa658b3a89f1" id="r_a80167de8a121787b37d4aa658b3a89f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a80167de8a121787b37d4aa658b3a89f1">y_digits_multi</a> = <a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aec28455bf8211f083be74eacb5a630ce">y_digits</a>[:200]</td></tr>
<tr class="separator:a80167de8a121787b37d4aa658b3a89f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9a58c0276687f14f1a7389fac9c7051" id="r_ab9a58c0276687f14f1a7389fac9c7051"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ab9a58c0276687f14f1a7389fac9c7051">X_digits_binary</a> = <a class="el" href="classsklearn_1_1preprocessing_1_1__data_1_1_min_max_scaler.html">MinMaxScaler</a>().fit_transform(<a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae497361b1402ccade424e806046329b7">X_digits</a>[:200])</td></tr>
<tr class="separator:ab9a58c0276687f14f1a7389fac9c7051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76a3f6b0b6082ae7743fd7eed649d1d4" id="r_a76a3f6b0b6082ae7743fd7eed649d1d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a76a3f6b0b6082ae7743fd7eed649d1d4">y_digits_binary</a> = <a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aec28455bf8211f083be74eacb5a630ce">y_digits</a>[:200]</td></tr>
<tr class="separator:a76a3f6b0b6082ae7743fd7eed649d1d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab34e4ceb4c0d74b7f20f5d92d58cc41" id="r_aab34e4ceb4c0d74b7f20f5d92d58cc41"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aab34e4ceb4c0d74b7f20f5d92d58cc41">classification_datasets</a></td></tr>
<tr class="separator:aab34e4ceb4c0d74b7f20f5d92d58cc41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accd0b8a98d4a4e688d48ebf52b14adf9" id="r_accd0b8a98d4a4e688d48ebf52b14adf9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#accd0b8a98d4a4e688d48ebf52b14adf9">X_reg</a></td></tr>
<tr class="separator:accd0b8a98d4a4e688d48ebf52b14adf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e74759b6305e32d382bdb259c9b5ecf" id="r_a1e74759b6305e32d382bdb259c9b5ecf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a1e74759b6305e32d382bdb259c9b5ecf">y_reg</a> = scale(y_reg)</td></tr>
<tr class="separator:a1e74759b6305e32d382bdb259c9b5ecf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7aebdc89fd31b39e7590c1177b4b478" id="r_ad7aebdc89fd31b39e7590c1177b4b478"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ad7aebdc89fd31b39e7590c1177b4b478">n_samples</a></td></tr>
<tr class="separator:ad7aebdc89fd31b39e7590c1177b4b478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a377bf2f18526bfe8f88e9fdbd815f884" id="r_a377bf2f18526bfe8f88e9fdbd815f884"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a377bf2f18526bfe8f88e9fdbd815f884">n_features</a></td></tr>
<tr class="separator:a377bf2f18526bfe8f88e9fdbd815f884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5f97c13157215deeca200365bb9190" id="r_aaa5f97c13157215deeca200365bb9190"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aaa5f97c13157215deeca200365bb9190">bias</a></td></tr>
<tr class="separator:aaa5f97c13157215deeca200365bb9190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a414fdfc9cd1e2330ab954fbc9da89e24" id="r_a414fdfc9cd1e2330ab954fbc9da89e24"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a414fdfc9cd1e2330ab954fbc9da89e24">noise</a></td></tr>
<tr class="separator:a414fdfc9cd1e2330ab954fbc9da89e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecbbef70ae9cd16399bc07b993361712" id="r_aecbbef70ae9cd16399bc07b993361712"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aecbbef70ae9cd16399bc07b993361712">random_state</a></td></tr>
<tr class="separator:aecbbef70ae9cd16399bc07b993361712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a509e3ebb07a8b03883c98829e64f49dd" id="r_a509e3ebb07a8b03883c98829e64f49dd"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a509e3ebb07a8b03883c98829e64f49dd">regression_datasets</a> = [(<a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#accd0b8a98d4a4e688d48ebf52b14adf9">X_reg</a>, <a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a1e74759b6305e32d382bdb259c9b5ecf">y_reg</a>)]</td></tr>
<tr class="separator:a509e3ebb07a8b03883c98829e64f49dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b7796891bd3d92740b3585ec9a1c9d" id="r_af3b7796891bd3d92740b3585ec9a1c9d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#af3b7796891bd3d92740b3585ec9a1c9d">iris</a> = load_iris()</td></tr>
<tr class="separator:af3b7796891bd3d92740b3585ec9a1c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42886b1e5e428d9aaab32d41466ebb7f" id="r_a42886b1e5e428d9aaab32d41466ebb7f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a42886b1e5e428d9aaab32d41466ebb7f">X_iris</a> = iris.data</td></tr>
<tr class="separator:a42886b1e5e428d9aaab32d41466ebb7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07ead6070d83c7e0855a9e12bb5588d8" id="r_a07ead6070d83c7e0855a9e12bb5588d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a07ead6070d83c7e0855a9e12bb5588d8">y_iris</a> = iris.target</td></tr>
<tr class="separator:a07ead6070d83c7e0855a9e12bb5588d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Testing for Multi-layer Perceptron module (sklearn.neural_network)
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a786c1d1325d4eb24f1e42dba627a0c11" name="a786c1d1325d4eb24f1e42dba627a0c11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a786c1d1325d4eb24f1e42dba627a0c11">&#9670;&#160;</a></span>test_adaptive_learning_rate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_adaptive_learning_rate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  702</span><span class="keyword">def </span>test_adaptive_learning_rate():</div>
<div class="line"><span class="lineno">  703</span>    X = [[3, 2], [1, 6]]</div>
<div class="line"><span class="lineno">  704</span>    y = [1, 0]</div>
<div class="line"><span class="lineno">  705</span>    clf = MLPClassifier(tol=0.5, max_iter=3000, solver=<span class="stringliteral">&quot;sgd&quot;</span>, learning_rate=<span class="stringliteral">&quot;adaptive&quot;</span>)</div>
<div class="line"><span class="lineno">  706</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  707</span>    <span class="keyword">assert</span> clf.max_iter &gt; clf.n_iter_</div>
<div class="line"><span class="lineno">  708</span>    <span class="keyword">assert</span> 1e-6 &gt; clf._optimizer.learning_rate</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span><span class="preprocessor">@ignore_warnings(category=RuntimeWarning)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f39d1d4b8a1c836c441fd787af1c001" name="a8f39d1d4b8a1c836c441fd787af1c001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f39d1d4b8a1c836c441fd787af1c001">&#9670;&#160;</a></span>test_alpha()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_alpha </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   64</span><span class="keyword">def </span>test_alpha():</div>
<div class="line"><span class="lineno">   65</span>    <span class="comment"># Test that larger alpha yields weights closer to zero</span></div>
<div class="line"><span class="lineno">   66</span>    X = X_digits_binary[:100]</div>
<div class="line"><span class="lineno">   67</span>    y = y_digits_binary[:100]</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    alpha_vectors = []</div>
<div class="line"><span class="lineno">   70</span>    alpha_values = np.arange(2)</div>
<div class="line"><span class="lineno">   71</span>    absolute_sum = <span class="keyword">lambda</span> x: np.sum(np.abs(x))</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">for</span> alpha <span class="keywordflow">in</span> alpha_values:</div>
<div class="line"><span class="lineno">   74</span>        mlp = MLPClassifier(hidden_layer_sizes=10, alpha=alpha, random_state=1)</div>
<div class="line"><span class="lineno">   75</span>        <span class="keyword">with</span> ignore_warnings(category=ConvergenceWarning):</div>
<div class="line"><span class="lineno">   76</span>            mlp.fit(X, y)</div>
<div class="line"><span class="lineno">   77</span>        alpha_vectors.append(</div>
<div class="line"><span class="lineno">   78</span>            np.array([absolute_sum(mlp.coefs_[0]), absolute_sum(mlp.coefs_[1])])</div>
<div class="line"><span class="lineno">   79</span>        )</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(alpha_values) - 1):</div>
<div class="line"><span class="lineno">   82</span>        <span class="keyword">assert</span> (alpha_vectors[i] &gt; alpha_vectors[i + 1]).all()</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a99ecc0cd3422b3e82da6e09b4e1ae857" name="a99ecc0cd3422b3e82da6e09b4e1ae857"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99ecc0cd3422b3e82da6e09b4e1ae857">&#9670;&#160;</a></span>test_early_stopping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_early_stopping </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>MLPEstimator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  672</span><span class="keyword">def </span>test_early_stopping(MLPEstimator):</div>
<div class="line"><span class="lineno">  673</span>    X = X_digits_binary[:100]</div>
<div class="line"><span class="lineno">  674</span>    y = y_digits_binary[:100]</div>
<div class="line"><span class="lineno">  675</span>    tol = 0.2</div>
<div class="line"><span class="lineno">  676</span>    mlp_estimator = MLPEstimator(</div>
<div class="line"><span class="lineno">  677</span>        tol=tol, max_iter=3000, solver=<span class="stringliteral">&quot;sgd&quot;</span>, early_stopping=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  678</span>    )</div>
<div class="line"><span class="lineno">  679</span>    mlp_estimator.fit(X, y)</div>
<div class="line"><span class="lineno">  680</span>    <span class="keyword">assert</span> mlp_estimator.max_iter &gt; mlp_estimator.n_iter_</div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>    <span class="keyword">assert</span> mlp_estimator.best_loss_ <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  683</span>    <span class="keyword">assert</span> isinstance(mlp_estimator.validation_scores_, list)</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>    valid_scores = mlp_estimator.validation_scores_</div>
<div class="line"><span class="lineno">  686</span>    best_valid_score = mlp_estimator.best_validation_score_</div>
<div class="line"><span class="lineno">  687</span>    <span class="keyword">assert</span> max(valid_scores) == best_valid_score</div>
<div class="line"><span class="lineno">  688</span>    <span class="keyword">assert</span> best_valid_score + tol &gt; valid_scores[-2]</div>
<div class="line"><span class="lineno">  689</span>    <span class="keyword">assert</span> best_valid_score + tol &gt; valid_scores[-1]</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>    <span class="comment"># check that the attributes `validation_scores_` and `best_validation_score_`</span></div>
<div class="line"><span class="lineno">  692</span>    <span class="comment"># are set to None when `early_stopping=False`</span></div>
<div class="line"><span class="lineno">  693</span>    mlp_estimator = MLPEstimator(</div>
<div class="line"><span class="lineno">  694</span>        tol=tol, max_iter=3000, solver=<span class="stringliteral">&quot;sgd&quot;</span>, early_stopping=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">  695</span>    )</div>
<div class="line"><span class="lineno">  696</span>    mlp_estimator.fit(X, y)</div>
<div class="line"><span class="lineno">  697</span>    <span class="keyword">assert</span> mlp_estimator.validation_scores_ <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  698</span>    <span class="keyword">assert</span> mlp_estimator.best_validation_score_ <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  699</span>    <span class="keyword">assert</span> mlp_estimator.best_loss_ <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a41c0718f7ed87d0c8de1eec375952e61" name="a41c0718f7ed87d0c8de1eec375952e61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41c0718f7ed87d0c8de1eec375952e61">&#9670;&#160;</a></span>test_early_stopping_stratified()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_early_stopping_stratified </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  804</span><span class="keyword">def </span>test_early_stopping_stratified():</div>
<div class="line"><span class="lineno">  805</span>    <span class="comment"># Make sure data splitting for early stopping is stratified</span></div>
<div class="line"><span class="lineno">  806</span>    X = [[1, 2], [2, 3], [3, 4], [4, 5]]</div>
<div class="line"><span class="lineno">  807</span>    y = [0, 0, 0, 1]</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>    mlp = MLPClassifier(early_stopping=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  810</span>    <span class="keyword">with</span> pytest.raises(</div>
<div class="line"><span class="lineno">  811</span>        ValueError, match=<span class="stringliteral">&quot;The least populated class in y has only 1 member&quot;</span></div>
<div class="line"><span class="lineno">  812</span>    ):</div>
<div class="line"><span class="lineno">  813</span>        mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a39c8143409d88b00bf357671c7aefda9" name="a39c8143409d88b00bf357671c7aefda9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39c8143409d88b00bf357671c7aefda9">&#9670;&#160;</a></span>test_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_fit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   85</span><span class="keyword">def </span>test_fit():</div>
<div class="line"><span class="lineno">   86</span>    <span class="comment"># Test that the algorithm solution is equal to a worked out example.</span></div>
<div class="line"><span class="lineno">   87</span>    X = np.array([[0.6, 0.8, 0.7]])</div>
<div class="line"><span class="lineno">   88</span>    y = np.array([0])</div>
<div class="line"><span class="lineno">   89</span>    mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">   90</span>        solver=<span class="stringliteral">&quot;sgd&quot;</span>,</div>
<div class="line"><span class="lineno">   91</span>        learning_rate_init=0.1,</div>
<div class="line"><span class="lineno">   92</span>        alpha=0.1,</div>
<div class="line"><span class="lineno">   93</span>        activation=<span class="stringliteral">&quot;logistic&quot;</span>,</div>
<div class="line"><span class="lineno">   94</span>        random_state=1,</div>
<div class="line"><span class="lineno">   95</span>        max_iter=1,</div>
<div class="line"><span class="lineno">   96</span>        hidden_layer_sizes=2,</div>
<div class="line"><span class="lineno">   97</span>        momentum=0,</div>
<div class="line"><span class="lineno">   98</span>    )</div>
<div class="line"><span class="lineno">   99</span>    <span class="comment"># set weights</span></div>
<div class="line"><span class="lineno">  100</span>    mlp.coefs_ = [0] * 2</div>
<div class="line"><span class="lineno">  101</span>    mlp.intercepts_ = [0] * 2</div>
<div class="line"><span class="lineno">  102</span>    mlp.n_outputs_ = 1</div>
<div class="line"><span class="lineno">  103</span>    mlp.coefs_[0] = np.array([[0.1, 0.2], [0.3, 0.1], [0.5, 0]])</div>
<div class="line"><span class="lineno">  104</span>    mlp.coefs_[1] = np.array([[0.1], [0.2]])</div>
<div class="line"><span class="lineno">  105</span>    mlp.intercepts_[0] = np.array([0.1, 0.1])</div>
<div class="line"><span class="lineno">  106</span>    mlp.intercepts_[1] = np.array([1.0])</div>
<div class="line"><span class="lineno">  107</span>    mlp._coef_grads = [] * 2</div>
<div class="line"><span class="lineno">  108</span>    mlp._intercept_grads = [] * 2</div>
<div class="line"><span class="lineno">  109</span>    mlp.n_features_in_ = 3</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="comment"># Initialize parameters</span></div>
<div class="line"><span class="lineno">  112</span>    mlp.n_iter_ = 0</div>
<div class="line"><span class="lineno">  113</span>    mlp.learning_rate_ = 0.1</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <span class="comment"># Compute the number of layers</span></div>
<div class="line"><span class="lineno">  116</span>    mlp.n_layers_ = 3</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="comment"># Pre-allocate gradient matrices</span></div>
<div class="line"><span class="lineno">  119</span>    mlp._coef_grads = [0] * (mlp.n_layers_ - 1)</div>
<div class="line"><span class="lineno">  120</span>    mlp._intercept_grads = [0] * (mlp.n_layers_ - 1)</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    mlp.out_activation_ = <span class="stringliteral">&quot;logistic&quot;</span></div>
<div class="line"><span class="lineno">  123</span>    mlp.t_ = 0</div>
<div class="line"><span class="lineno">  124</span>    mlp.best_loss_ = np.inf</div>
<div class="line"><span class="lineno">  125</span>    mlp.loss_curve_ = []</div>
<div class="line"><span class="lineno">  126</span>    mlp._no_improvement_count = 0</div>
<div class="line"><span class="lineno">  127</span>    mlp._intercept_velocity = [</div>
<div class="line"><span class="lineno">  128</span>        np.zeros_like(intercepts) <span class="keywordflow">for</span> intercepts <span class="keywordflow">in</span> mlp.intercepts_</div>
<div class="line"><span class="lineno">  129</span>    ]</div>
<div class="line"><span class="lineno">  130</span>    mlp._coef_velocity = [np.zeros_like(coefs) <span class="keywordflow">for</span> coefs <span class="keywordflow">in</span> mlp.coefs_]</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    mlp.partial_fit(X, y, classes=[0, 1])</div>
<div class="line"><span class="lineno">  133</span>    <span class="comment"># Manually worked out example</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="comment"># h1 = g(X1 * W_i1 + b11) = g(0.6 * 0.1 + 0.8 * 0.3 + 0.7 * 0.5 + 0.1)</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="comment">#       =  0.679178699175393</span></div>
<div class="line"><span class="lineno">  136</span>    <span class="comment"># h2 = g(X2 * W_i2 + b12) = g(0.6 * 0.2 + 0.8 * 0.1 + 0.7 * 0 + 0.1)</span></div>
<div class="line"><span class="lineno">  137</span>    <span class="comment">#         = 0.574442516811659</span></div>
<div class="line"><span class="lineno">  138</span>    <span class="comment"># o1 = g(h * W2 + b21) = g(0.679 * 0.1 + 0.574 * 0.2 + 1)</span></div>
<div class="line"><span class="lineno">  139</span>    <span class="comment">#       = 0.7654329236196236</span></div>
<div class="line"><span class="lineno">  140</span>    <span class="comment"># d21 = -(0 - 0.765) = 0.765</span></div>
<div class="line"><span class="lineno">  141</span>    <span class="comment"># d11 = (1 - 0.679) * 0.679 * 0.765 * 0.1 = 0.01667</span></div>
<div class="line"><span class="lineno">  142</span>    <span class="comment"># d12 = (1 - 0.574) * 0.574 * 0.765 * 0.2 = 0.0374</span></div>
<div class="line"><span class="lineno">  143</span>    <span class="comment"># W1grad11 = X1 * d11 + alpha * W11 = 0.6 * 0.01667 + 0.1 * 0.1 = 0.0200</span></div>
<div class="line"><span class="lineno">  144</span>    <span class="comment"># W1grad11 = X1 * d12 + alpha * W12 = 0.6 * 0.0374 + 0.1 * 0.2 = 0.04244</span></div>
<div class="line"><span class="lineno">  145</span>    <span class="comment"># W1grad21 = X2 * d11 + alpha * W13 = 0.8 * 0.01667 + 0.1 * 0.3 = 0.043336</span></div>
<div class="line"><span class="lineno">  146</span>    <span class="comment"># W1grad22 = X2 * d12 + alpha * W14 = 0.8 * 0.0374 + 0.1 * 0.1 = 0.03992</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="comment"># W1grad31 = X3 * d11 + alpha * W15 = 0.6 * 0.01667 + 0.1 * 0.5 = 0.060002</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="comment"># W1grad32 = X3 * d12 + alpha * W16 = 0.6 * 0.0374 + 0.1 * 0 = 0.02244</span></div>
<div class="line"><span class="lineno">  149</span>    <span class="comment"># W2grad1 = h1 * d21 + alpha * W21 = 0.679 * 0.765 + 0.1 * 0.1 = 0.5294</span></div>
<div class="line"><span class="lineno">  150</span>    <span class="comment"># W2grad2 = h2 * d21 + alpha * W22 = 0.574 * 0.765 + 0.1 * 0.2 = 0.45911</span></div>
<div class="line"><span class="lineno">  151</span>    <span class="comment"># b1grad1 = d11 = 0.01667</span></div>
<div class="line"><span class="lineno">  152</span>    <span class="comment"># b1grad2 = d12 = 0.0374</span></div>
<div class="line"><span class="lineno">  153</span>    <span class="comment"># b2grad = d21 = 0.765</span></div>
<div class="line"><span class="lineno">  154</span>    <span class="comment"># W1 = W1 - eta * [W1grad11, .., W1grad32] = [[0.1, 0.2], [0.3, 0.1],</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="comment">#          [0.5, 0]] - 0.1 * [[0.0200, 0.04244], [0.043336, 0.03992],</span></div>
<div class="line"><span class="lineno">  156</span>    <span class="comment">#          [0.060002, 0.02244]] = [[0.098, 0.195756], [0.2956664,</span></div>
<div class="line"><span class="lineno">  157</span>    <span class="comment">#          0.096008], [0.4939998, -0.002244]]</span></div>
<div class="line"><span class="lineno">  158</span>    <span class="comment"># W2 = W2 - eta * [W2grad1, W2grad2] = [[0.1], [0.2]] - 0.1 *</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="comment">#        [[0.5294], [0.45911]] = [[0.04706], [0.154089]]</span></div>
<div class="line"><span class="lineno">  160</span>    <span class="comment"># b1 = b1 - eta * [b1grad1, b1grad2] = 0.1 - 0.1 * [0.01667, 0.0374]</span></div>
<div class="line"><span class="lineno">  161</span>    <span class="comment">#         = [0.098333, 0.09626]</span></div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># b2 = b2 - eta * b2grad = 1.0 - 0.1 * 0.765 = 0.9235</span></div>
<div class="line"><span class="lineno">  163</span>    assert_almost_equal(</div>
<div class="line"><span class="lineno">  164</span>        mlp.coefs_[0],</div>
<div class="line"><span class="lineno">  165</span>        np.array([[0.098, 0.195756], [0.2956664, 0.096008], [0.4939998, -0.002244]]),</div>
<div class="line"><span class="lineno">  166</span>        decimal=3,</div>
<div class="line"><span class="lineno">  167</span>    )</div>
<div class="line"><span class="lineno">  168</span>    assert_almost_equal(mlp.coefs_[1], np.array([[0.04706], [0.154089]]), decimal=3)</div>
<div class="line"><span class="lineno">  169</span>    assert_almost_equal(mlp.intercepts_[0], np.array([0.098333, 0.09626]), decimal=3)</div>
<div class="line"><span class="lineno">  170</span>    assert_almost_equal(mlp.intercepts_[1], np.array(0.9235), decimal=3)</div>
<div class="line"><span class="lineno">  171</span>    <span class="comment"># Testing output</span></div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">#  h1 = g(X1 * W_i1 + b11) = g(0.6 * 0.098 + 0.8 * 0.2956664 +</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">#               0.7 * 0.4939998 + 0.098333) = 0.677</span></div>
<div class="line"><span class="lineno">  174</span>    <span class="comment">#  h2 = g(X2 * W_i2 + b12) = g(0.6 * 0.195756 + 0.8 * 0.096008 +</span></div>
<div class="line"><span class="lineno">  175</span>    <span class="comment">#            0.7 * -0.002244 + 0.09626) = 0.572</span></div>
<div class="line"><span class="lineno">  176</span>    <span class="comment">#  o1 = h * W2 + b21 = 0.677 * 0.04706 +</span></div>
<div class="line"><span class="lineno">  177</span>    <span class="comment">#             0.572 * 0.154089 + 0.9235 = 1.043</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">#  prob = sigmoid(o1) = 0.739</span></div>
<div class="line"><span class="lineno">  179</span>    assert_almost_equal(mlp.predict_proba(X)[0, 1], 0.739, decimal=3)</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae94d4c02908e1612fa4fe9de48ed2a91" name="ae94d4c02908e1612fa4fe9de48ed2a91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae94d4c02908e1612fa4fe9de48ed2a91">&#9670;&#160;</a></span>test_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_gradient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  182</span><span class="keyword">def </span>test_gradient():</div>
<div class="line"><span class="lineno">  183</span>    <span class="comment"># Test gradient.</span></div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    <span class="comment"># This makes sure that the activation functions and their derivatives</span></div>
<div class="line"><span class="lineno">  186</span>    <span class="comment"># are correct. The numerical and analytical computation of the gradient</span></div>
<div class="line"><span class="lineno">  187</span>    <span class="comment"># should be close.</span></div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">for</span> n_labels <span class="keywordflow">in</span> [2, 3]:</div>
<div class="line"><span class="lineno">  189</span>        n_samples = 5</div>
<div class="line"><span class="lineno">  190</span>        n_features = 10</div>
<div class="line"><span class="lineno">  191</span>        random_state = np.random.RandomState(seed=42)</div>
<div class="line"><span class="lineno">  192</span>        X = random_state.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno">  193</span>        y = 1 + np.mod(np.arange(n_samples) + 1, n_labels)</div>
<div class="line"><span class="lineno">  194</span>        Y = LabelBinarizer().fit_transform(y)</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">for</span> activation <span class="keywordflow">in</span> ACTIVATION_TYPES:</div>
<div class="line"><span class="lineno">  197</span>            mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">  198</span>                activation=activation,</div>
<div class="line"><span class="lineno">  199</span>                hidden_layer_sizes=10,</div>
<div class="line"><span class="lineno">  200</span>                solver=<span class="stringliteral">&quot;lbfgs&quot;</span>,</div>
<div class="line"><span class="lineno">  201</span>                alpha=1e-5,</div>
<div class="line"><span class="lineno">  202</span>                learning_rate_init=0.2,</div>
<div class="line"><span class="lineno">  203</span>                max_iter=1,</div>
<div class="line"><span class="lineno">  204</span>                random_state=1,</div>
<div class="line"><span class="lineno">  205</span>            )</div>
<div class="line"><span class="lineno">  206</span>            mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>            theta = np.hstack([l.ravel() <span class="keywordflow">for</span> l <span class="keywordflow">in</span> mlp.coefs_ + mlp.intercepts_])</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>            layer_units = [X.shape[1]] + [mlp.hidden_layer_sizes] + [mlp.n_outputs_]</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>            activations = []</div>
<div class="line"><span class="lineno">  213</span>            deltas = []</div>
<div class="line"><span class="lineno">  214</span>            coef_grads = []</div>
<div class="line"><span class="lineno">  215</span>            intercept_grads = []</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>            activations.append(X)</div>
<div class="line"><span class="lineno">  218</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(mlp.n_layers_ - 1):</div>
<div class="line"><span class="lineno">  219</span>                activations.append(np.empty((X.shape[0], layer_units[i + 1])))</div>
<div class="line"><span class="lineno">  220</span>                deltas.append(np.empty((X.shape[0], layer_units[i + 1])))</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>                fan_in = layer_units[i]</div>
<div class="line"><span class="lineno">  223</span>                fan_out = layer_units[i + 1]</div>
<div class="line"><span class="lineno">  224</span>                coef_grads.append(np.empty((fan_in, fan_out)))</div>
<div class="line"><span class="lineno">  225</span>                intercept_grads.append(np.empty(fan_out))</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>            <span class="comment"># analytically compute the gradients</span></div>
<div class="line"><span class="lineno">  228</span>            <span class="keyword">def </span>loss_grad_fun(t):</div>
<div class="line"><span class="lineno">  229</span>                <span class="keywordflow">return</span> mlp._loss_grad_lbfgs(</div>
<div class="line"><span class="lineno">  230</span>                    t, X, Y, activations, deltas, coef_grads, intercept_grads</div>
<div class="line"><span class="lineno">  231</span>                )</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>            [value, grad] = loss_grad_fun(theta)</div>
<div class="line"><span class="lineno">  234</span>            numgrad = np.zeros(np.size(theta))</div>
<div class="line"><span class="lineno">  235</span>            n = np.size(theta, 0)</div>
<div class="line"><span class="lineno">  236</span>            E = np.eye(n)</div>
<div class="line"><span class="lineno">  237</span>            epsilon = 1e-5</div>
<div class="line"><span class="lineno">  238</span>            <span class="comment"># numerically compute the gradients</span></div>
<div class="line"><span class="lineno">  239</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n):</div>
<div class="line"><span class="lineno">  240</span>                dtheta = E[:, i] * epsilon</div>
<div class="line"><span class="lineno">  241</span>                numgrad[i] = (</div>
<div class="line"><span class="lineno">  242</span>                    loss_grad_fun(theta + dtheta)[0] - loss_grad_fun(theta - dtheta)[0]</div>
<div class="line"><span class="lineno">  243</span>                ) / (epsilon * 2.0)</div>
<div class="line"><span class="lineno">  244</span>            assert_almost_equal(numgrad, grad)</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span><span class="preprocessor">@pytest.mark.parametrize(&quot;X,y&quot;, classification_datasets)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a565841a9d225e989462be677926c60fd" name="a565841a9d225e989462be677926c60fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a565841a9d225e989462be677926c60fd">&#9670;&#160;</a></span>test_lbfgs_classification()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_lbfgs_classification </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  248</span><span class="keyword">def </span>test_lbfgs_classification(X, y):</div>
<div class="line"><span class="lineno">  249</span>    <span class="comment"># Test lbfgs on classification.</span></div>
<div class="line"><span class="lineno">  250</span>    <span class="comment"># It should achieve a score higher than 0.95 for the binary and multi-class</span></div>
<div class="line"><span class="lineno">  251</span>    <span class="comment"># versions of the digits dataset.</span></div>
<div class="line"><span class="lineno">  252</span>    X_train = X[:150]</div>
<div class="line"><span class="lineno">  253</span>    y_train = y[:150]</div>
<div class="line"><span class="lineno">  254</span>    X_test = X[150:]</div>
<div class="line"><span class="lineno">  255</span>    expected_shape_dtype = (X_test.shape[0], y_train.dtype.kind)</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">for</span> activation <span class="keywordflow">in</span> ACTIVATION_TYPES:</div>
<div class="line"><span class="lineno">  258</span>        mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">  259</span>            solver=<span class="stringliteral">&quot;lbfgs&quot;</span>,</div>
<div class="line"><span class="lineno">  260</span>            hidden_layer_sizes=50,</div>
<div class="line"><span class="lineno">  261</span>            max_iter=150,</div>
<div class="line"><span class="lineno">  262</span>            shuffle=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  263</span>            random_state=1,</div>
<div class="line"><span class="lineno">  264</span>            activation=activation,</div>
<div class="line"><span class="lineno">  265</span>        )</div>
<div class="line"><span class="lineno">  266</span>        mlp.fit(X_train, y_train)</div>
<div class="line"><span class="lineno">  267</span>        y_predict = mlp.predict(X_test)</div>
<div class="line"><span class="lineno">  268</span>        <span class="keyword">assert</span> mlp.score(X_train, y_train) &gt; 0.95</div>
<div class="line"><span class="lineno">  269</span>        <span class="keyword">assert</span> (y_predict.shape[0], y_predict.dtype.kind) == expected_shape_dtype</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span><span class="preprocessor">@pytest.mark.parametrize(&quot;X,y&quot;, regression_datasets)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e3c5ba0300b7bb4080cbac08bc3f058" name="a2e3c5ba0300b7bb4080cbac08bc3f058"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e3c5ba0300b7bb4080cbac08bc3f058">&#9670;&#160;</a></span>test_lbfgs_classification_maxfun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_lbfgs_classification_maxfun </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  293</span><span class="keyword">def </span>test_lbfgs_classification_maxfun(X, y):</div>
<div class="line"><span class="lineno">  294</span>    <span class="comment"># Test lbfgs parameter max_fun.</span></div>
<div class="line"><span class="lineno">  295</span>    <span class="comment"># It should independently limit the number of iterations for lbfgs.</span></div>
<div class="line"><span class="lineno">  296</span>    max_fun = 10</div>
<div class="line"><span class="lineno">  297</span>    <span class="comment"># classification tests</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">for</span> activation <span class="keywordflow">in</span> ACTIVATION_TYPES:</div>
<div class="line"><span class="lineno">  299</span>        mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">  300</span>            solver=<span class="stringliteral">&quot;lbfgs&quot;</span>,</div>
<div class="line"><span class="lineno">  301</span>            hidden_layer_sizes=50,</div>
<div class="line"><span class="lineno">  302</span>            max_iter=150,</div>
<div class="line"><span class="lineno">  303</span>            max_fun=max_fun,</div>
<div class="line"><span class="lineno">  304</span>            shuffle=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  305</span>            random_state=1,</div>
<div class="line"><span class="lineno">  306</span>            activation=activation,</div>
<div class="line"><span class="lineno">  307</span>        )</div>
<div class="line"><span class="lineno">  308</span>        <span class="keyword">with</span> pytest.warns(ConvergenceWarning):</div>
<div class="line"><span class="lineno">  309</span>            mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  310</span>            <span class="keyword">assert</span> max_fun &gt;= mlp.n_iter_</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span><span class="preprocessor">@pytest.mark.parametrize(&quot;X,y&quot;, regression_datasets)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a987fd4a3a1407b945075a80b72527d4c" name="a987fd4a3a1407b945075a80b72527d4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987fd4a3a1407b945075a80b72527d4c">&#9670;&#160;</a></span>test_lbfgs_regression()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_lbfgs_regression </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  273</span><span class="keyword">def </span>test_lbfgs_regression(X, y):</div>
<div class="line"><span class="lineno">  274</span>    <span class="comment"># Test lbfgs on the regression dataset.</span></div>
<div class="line"><span class="lineno">  275</span>    <span class="keywordflow">for</span> activation <span class="keywordflow">in</span> ACTIVATION_TYPES:</div>
<div class="line"><span class="lineno">  276</span>        mlp = MLPRegressor(</div>
<div class="line"><span class="lineno">  277</span>            solver=<span class="stringliteral">&quot;lbfgs&quot;</span>,</div>
<div class="line"><span class="lineno">  278</span>            hidden_layer_sizes=50,</div>
<div class="line"><span class="lineno">  279</span>            max_iter=150,</div>
<div class="line"><span class="lineno">  280</span>            shuffle=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  281</span>            random_state=1,</div>
<div class="line"><span class="lineno">  282</span>            activation=activation,</div>
<div class="line"><span class="lineno">  283</span>        )</div>
<div class="line"><span class="lineno">  284</span>        mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">if</span> activation == <span class="stringliteral">&quot;identity&quot;</span>:</div>
<div class="line"><span class="lineno">  286</span>            <span class="keyword">assert</span> mlp.score(X, y) &gt; 0.80</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  288</span>            <span class="comment"># Non linear models perform much better than linear bottleneck:</span></div>
<div class="line"><span class="lineno">  289</span>            <span class="keyword">assert</span> mlp.score(X, y) &gt; 0.98</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span><span class="preprocessor">@pytest.mark.parametrize(&quot;X,y&quot;, classification_datasets)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7aad51e4cd90eed1a9b010287759e27e" name="a7aad51e4cd90eed1a9b010287759e27e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aad51e4cd90eed1a9b010287759e27e">&#9670;&#160;</a></span>test_lbfgs_regression_maxfun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_lbfgs_regression_maxfun </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  314</span><span class="keyword">def </span>test_lbfgs_regression_maxfun(X, y):</div>
<div class="line"><span class="lineno">  315</span>    <span class="comment"># Test lbfgs parameter max_fun.</span></div>
<div class="line"><span class="lineno">  316</span>    <span class="comment"># It should independently limit the number of iterations for lbfgs.</span></div>
<div class="line"><span class="lineno">  317</span>    max_fun = 10</div>
<div class="line"><span class="lineno">  318</span>    <span class="comment"># regression tests</span></div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordflow">for</span> activation <span class="keywordflow">in</span> ACTIVATION_TYPES:</div>
<div class="line"><span class="lineno">  320</span>        mlp = MLPRegressor(</div>
<div class="line"><span class="lineno">  321</span>            solver=<span class="stringliteral">&quot;lbfgs&quot;</span>,</div>
<div class="line"><span class="lineno">  322</span>            hidden_layer_sizes=50,</div>
<div class="line"><span class="lineno">  323</span>            tol=0.0,</div>
<div class="line"><span class="lineno">  324</span>            max_iter=150,</div>
<div class="line"><span class="lineno">  325</span>            max_fun=max_fun,</div>
<div class="line"><span class="lineno">  326</span>            shuffle=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  327</span>            random_state=1,</div>
<div class="line"><span class="lineno">  328</span>            activation=activation,</div>
<div class="line"><span class="lineno">  329</span>        )</div>
<div class="line"><span class="lineno">  330</span>        <span class="keyword">with</span> pytest.warns(ConvergenceWarning):</div>
<div class="line"><span class="lineno">  331</span>            mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  332</span>            <span class="keyword">assert</span> max_fun &gt;= mlp.n_iter_</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac84f918cc78990614c5414aa2fad5456" name="ac84f918cc78990614c5414aa2fad5456"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac84f918cc78990614c5414aa2fad5456">&#9670;&#160;</a></span>test_learning_rate_warmstart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_learning_rate_warmstart </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  335</span><span class="keyword">def </span>test_learning_rate_warmstart():</div>
<div class="line"><span class="lineno">  336</span>    <span class="comment"># Tests that warm_start reuse past solutions.</span></div>
<div class="line"><span class="lineno">  337</span>    X = [[3, 2], [1, 6], [5, 6], [-2, -4]]</div>
<div class="line"><span class="lineno">  338</span>    y = [1, 1, 1, 0]</div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordflow">for</span> learning_rate <span class="keywordflow">in</span> [<span class="stringliteral">&quot;invscaling&quot;</span>, <span class="stringliteral">&quot;constant&quot;</span>]:</div>
<div class="line"><span class="lineno">  340</span>        mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">  341</span>            solver=<span class="stringliteral">&quot;sgd&quot;</span>,</div>
<div class="line"><span class="lineno">  342</span>            hidden_layer_sizes=4,</div>
<div class="line"><span class="lineno">  343</span>            learning_rate=learning_rate,</div>
<div class="line"><span class="lineno">  344</span>            max_iter=1,</div>
<div class="line"><span class="lineno">  345</span>            power_t=0.25,</div>
<div class="line"><span class="lineno">  346</span>            warm_start=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  347</span>        )</div>
<div class="line"><span class="lineno">  348</span>        <span class="keyword">with</span> ignore_warnings(category=ConvergenceWarning):</div>
<div class="line"><span class="lineno">  349</span>            mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  350</span>            prev_eta = mlp._optimizer.learning_rate</div>
<div class="line"><span class="lineno">  351</span>            mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  352</span>            post_eta = mlp._optimizer.learning_rate</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>        <span class="keywordflow">if</span> learning_rate == <span class="stringliteral">&quot;constant&quot;</span>:</div>
<div class="line"><span class="lineno">  355</span>            <span class="keyword">assert</span> prev_eta == post_eta</div>
<div class="line"><span class="lineno">  356</span>        <span class="keywordflow">elif</span> learning_rate == <span class="stringliteral">&quot;invscaling&quot;</span>:</div>
<div class="line"><span class="lineno">  357</span>            <span class="keyword">assert</span> mlp.learning_rate_init / pow(8 + 1, mlp.power_t) == post_eta</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2ab5c1e0ba063a1313cb18a16b2125c" name="aa2ab5c1e0ba063a1313cb18a16b2125c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2ab5c1e0ba063a1313cb18a16b2125c">&#9670;&#160;</a></span>test_mlp_classifier_dtypes_casting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_mlp_classifier_dtypes_casting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  816</span><span class="keyword">def </span>test_mlp_classifier_dtypes_casting():</div>
<div class="line"><span class="lineno">  817</span>    <span class="comment"># Compare predictions for different dtypes</span></div>
<div class="line"><span class="lineno">  818</span>    mlp_64 = MLPClassifier(</div>
<div class="line"><span class="lineno">  819</span>        alpha=1e-5, hidden_layer_sizes=(5, 3), random_state=1, max_iter=50</div>
<div class="line"><span class="lineno">  820</span>    )</div>
<div class="line"><span class="lineno">  821</span>    mlp_64.fit(X_digits[:300], y_digits[:300])</div>
<div class="line"><span class="lineno">  822</span>    pred_64 = mlp_64.predict(X_digits[300:])</div>
<div class="line"><span class="lineno">  823</span>    proba_64 = mlp_64.predict_proba(X_digits[300:])</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>    mlp_32 = MLPClassifier(</div>
<div class="line"><span class="lineno">  826</span>        alpha=1e-5, hidden_layer_sizes=(5, 3), random_state=1, max_iter=50</div>
<div class="line"><span class="lineno">  827</span>    )</div>
<div class="line"><span class="lineno">  828</span>    mlp_32.fit(X_digits[:300].astype(np.float32), y_digits[:300])</div>
<div class="line"><span class="lineno">  829</span>    pred_32 = mlp_32.predict(X_digits[300:].astype(np.float32))</div>
<div class="line"><span class="lineno">  830</span>    proba_32 = mlp_32.predict_proba(X_digits[300:].astype(np.float32))</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>    assert_array_equal(pred_64, pred_32)</div>
<div class="line"><span class="lineno">  833</span>    assert_allclose(proba_64, proba_32, rtol=1e-02)</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9ccb270d00fc93b4c05644f49981f50" name="ae9ccb270d00fc93b4c05644f49981f50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ccb270d00fc93b4c05644f49981f50">&#9670;&#160;</a></span>test_mlp_loading_from_joblib_partial_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_mlp_loading_from_joblib_partial_fit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tmp_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Loading from MLP and partial fitting updates weights. Non-regression
test for #19626.</pre> <div class="fragment"><div class="line"><span class="lineno">  870</span><span class="keyword">def </span>test_mlp_loading_from_joblib_partial_fit(tmp_path):</div>
<div class="line"><span class="lineno">  871</span>    <span class="stringliteral">&quot;&quot;&quot;Loading from MLP and partial fitting updates weights. Non-regression</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral">    test for #19626.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  873</span>    pre_trained_estimator = MLPRegressor(</div>
<div class="line"><span class="lineno">  874</span>        hidden_layer_sizes=(42,), random_state=42, learning_rate_init=0.01, max_iter=200</div>
<div class="line"><span class="lineno">  875</span>    )</div>
<div class="line"><span class="lineno">  876</span>    features, target = [[2]], [4]</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>    <span class="comment"># Fit on x=2, y=4</span></div>
<div class="line"><span class="lineno">  879</span>    pre_trained_estimator.fit(features, target)</div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span>    <span class="comment"># dump and load model</span></div>
<div class="line"><span class="lineno">  882</span>    pickled_file = tmp_path / <span class="stringliteral">&quot;mlp.pkl&quot;</span></div>
<div class="line"><span class="lineno">  883</span>    joblib.dump(pre_trained_estimator, pickled_file)</div>
<div class="line"><span class="lineno">  884</span>    load_estimator = joblib.load(pickled_file)</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>    <span class="comment"># Train for a more epochs on point x=2, y=1</span></div>
<div class="line"><span class="lineno">  887</span>    fine_tune_features, fine_tune_target = [[2]], [1]</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>    <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(200):</div>
<div class="line"><span class="lineno">  890</span>        load_estimator.partial_fit(fine_tune_features, fine_tune_target)</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>    <span class="comment"># finetuned model learned the new target</span></div>
<div class="line"><span class="lineno">  893</span>    predicted_value = load_estimator.predict(fine_tune_features)</div>
<div class="line"><span class="lineno">  894</span>    assert_allclose(predicted_value, fine_tune_target, rtol=1e-4)</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span> </div>
<div class="line"><span class="lineno">  897</span><span class="preprocessor">@pytest.mark.parametrize(&quot;MLPEstimator&quot;, [MLPClassifier, MLPRegressor])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11e26da6b433edc44df6a775c35e1b6d" name="a11e26da6b433edc44df6a775c35e1b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11e26da6b433edc44df6a775c35e1b6d">&#9670;&#160;</a></span>test_mlp_param_dtypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_mlp_param_dtypes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  854</span><span class="keyword">def </span>test_mlp_param_dtypes(dtype, Estimator):</div>
<div class="line"><span class="lineno">  855</span>    <span class="comment"># Checks if input dtype is used for network parameters</span></div>
<div class="line"><span class="lineno">  856</span>    <span class="comment"># and predictions</span></div>
<div class="line"><span class="lineno">  857</span>    X, y = X_digits.astype(dtype), y_digits</div>
<div class="line"><span class="lineno">  858</span>    mlp = Estimator(alpha=1e-5, hidden_layer_sizes=(5, 3), random_state=1, max_iter=50)</div>
<div class="line"><span class="lineno">  859</span>    mlp.fit(X[:300], y[:300])</div>
<div class="line"><span class="lineno">  860</span>    pred = mlp.predict(X[300:])</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>    <span class="keyword">assert</span> all([intercept.dtype == dtype <span class="keywordflow">for</span> intercept <span class="keywordflow">in</span> mlp.intercepts_])</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>    <span class="keyword">assert</span> all([coef.dtype == dtype <span class="keywordflow">for</span> coef <span class="keywordflow">in</span> mlp.coefs_])</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>    <span class="keywordflow">if</span> Estimator == MLPRegressor:</div>
<div class="line"><span class="lineno">  867</span>        <span class="keyword">assert</span> pred.dtype == dtype</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acb3fcdee462b7280d7ec793f647695e5" name="acb3fcdee462b7280d7ec793f647695e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb3fcdee462b7280d7ec793f647695e5">&#9670;&#160;</a></span>test_mlp_regressor_dtypes_casting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_mlp_regressor_dtypes_casting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  836</span><span class="keyword">def </span>test_mlp_regressor_dtypes_casting():</div>
<div class="line"><span class="lineno">  837</span>    mlp_64 = MLPRegressor(</div>
<div class="line"><span class="lineno">  838</span>        alpha=1e-5, hidden_layer_sizes=(5, 3), random_state=1, max_iter=50</div>
<div class="line"><span class="lineno">  839</span>    )</div>
<div class="line"><span class="lineno">  840</span>    mlp_64.fit(X_digits[:300], y_digits[:300])</div>
<div class="line"><span class="lineno">  841</span>    pred_64 = mlp_64.predict(X_digits[300:])</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>    mlp_32 = MLPRegressor(</div>
<div class="line"><span class="lineno">  844</span>        alpha=1e-5, hidden_layer_sizes=(5, 3), random_state=1, max_iter=50</div>
<div class="line"><span class="lineno">  845</span>    )</div>
<div class="line"><span class="lineno">  846</span>    mlp_32.fit(X_digits[:300].astype(np.float32), y_digits[:300])</div>
<div class="line"><span class="lineno">  847</span>    pred_32 = mlp_32.predict(X_digits[300:].astype(np.float32))</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>    assert_allclose(pred_64, pred_32, rtol=1e-04)</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [np.float32, np.float64])</span></div>
<div class="line"><span class="lineno">  853</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [MLPClassifier, MLPRegressor])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5644282e1908d38f78c3631893316875" name="a5644282e1908d38f78c3631893316875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5644282e1908d38f78c3631893316875">&#9670;&#160;</a></span>test_mlp_warm_start_with_early_stopping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_mlp_warm_start_with_early_stopping </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>MLPEstimator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that early stopping works with warm start.</pre> <div class="fragment"><div class="line"><span class="lineno">  898</span><span class="keyword">def </span>test_mlp_warm_start_with_early_stopping(MLPEstimator):</div>
<div class="line"><span class="lineno">  899</span>    <span class="stringliteral">&quot;&quot;&quot;Check that early stopping works with warm start.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  900</span>    mlp = MLPEstimator(</div>
<div class="line"><span class="lineno">  901</span>        max_iter=10, random_state=0, warm_start=<span class="keyword">True</span>, early_stopping=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  902</span>    )</div>
<div class="line"><span class="lineno">  903</span>    mlp.fit(X_iris, y_iris)</div>
<div class="line"><span class="lineno">  904</span>    n_validation_scores = len(mlp.validation_scores_)</div>
<div class="line"><span class="lineno">  905</span>    mlp.set_params(max_iter=20)</div>
<div class="line"><span class="lineno">  906</span>    mlp.fit(X_iris, y_iris)</div>
<div class="line"><span class="lineno">  907</span>    <span class="keyword">assert</span> len(mlp.validation_scores_) &gt; n_validation_scores</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2727f666365a01eb23bce8f1d42956e" name="ab2727f666365a01eb23bce8f1d42956e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2727f666365a01eb23bce8f1d42956e">&#9670;&#160;</a></span>test_multilabel_classification()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_multilabel_classification </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  360</span><span class="keyword">def </span>test_multilabel_classification():</div>
<div class="line"><span class="lineno">  361</span>    <span class="comment"># Test that multi-label classification works as expected.</span></div>
<div class="line"><span class="lineno">  362</span>    <span class="comment"># test fit method</span></div>
<div class="line"><span class="lineno">  363</span>    X, y = make_multilabel_classification(</div>
<div class="line"><span class="lineno">  364</span>        n_samples=50, random_state=0, return_indicator=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  365</span>    )</div>
<div class="line"><span class="lineno">  366</span>    mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">  367</span>        solver=<span class="stringliteral">&quot;lbfgs&quot;</span>,</div>
<div class="line"><span class="lineno">  368</span>        hidden_layer_sizes=50,</div>
<div class="line"><span class="lineno">  369</span>        alpha=1e-5,</div>
<div class="line"><span class="lineno">  370</span>        max_iter=150,</div>
<div class="line"><span class="lineno">  371</span>        random_state=0,</div>
<div class="line"><span class="lineno">  372</span>        activation=<span class="stringliteral">&quot;logistic&quot;</span>,</div>
<div class="line"><span class="lineno">  373</span>        learning_rate_init=0.2,</div>
<div class="line"><span class="lineno">  374</span>    )</div>
<div class="line"><span class="lineno">  375</span>    mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  376</span>    <span class="keyword">assert</span> mlp.score(X, y) &gt; 0.97</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>    <span class="comment"># test partial fit method</span></div>
<div class="line"><span class="lineno">  379</span>    mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">  380</span>        solver=<span class="stringliteral">&quot;sgd&quot;</span>,</div>
<div class="line"><span class="lineno">  381</span>        hidden_layer_sizes=50,</div>
<div class="line"><span class="lineno">  382</span>        max_iter=150,</div>
<div class="line"><span class="lineno">  383</span>        random_state=0,</div>
<div class="line"><span class="lineno">  384</span>        activation=<span class="stringliteral">&quot;logistic&quot;</span>,</div>
<div class="line"><span class="lineno">  385</span>        alpha=1e-5,</div>
<div class="line"><span class="lineno">  386</span>        learning_rate_init=0.2,</div>
<div class="line"><span class="lineno">  387</span>    )</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(100):</div>
<div class="line"><span class="lineno">  389</span>        mlp.partial_fit(X, y, classes=[0, 1, 2, 3, 4])</div>
<div class="line"><span class="lineno">  390</span>    <span class="keyword">assert</span> mlp.score(X, y) &gt; 0.9</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    <span class="comment"># Make sure early stopping still work now that splitting is stratified by</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="comment"># default (it is disabled for multilabel classification)</span></div>
<div class="line"><span class="lineno">  394</span>    mlp = MLPClassifier(early_stopping=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  395</span>    mlp.fit(X, y).predict(X)</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d049d7425d7e288c9f8148897f664f7" name="a8d049d7425d7e288c9f8148897f664f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d049d7425d7e288c9f8148897f664f7">&#9670;&#160;</a></span>test_multioutput_regression()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_multioutput_regression </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  398</span><span class="keyword">def </span>test_multioutput_regression():</div>
<div class="line"><span class="lineno">  399</span>    <span class="comment"># Test that multi-output regression works as expected</span></div>
<div class="line"><span class="lineno">  400</span>    X, y = make_regression(n_samples=200, n_targets=5)</div>
<div class="line"><span class="lineno">  401</span>    mlp = MLPRegressor(</div>
<div class="line"><span class="lineno">  402</span>        solver=<span class="stringliteral">&quot;lbfgs&quot;</span>, hidden_layer_sizes=50, max_iter=200, random_state=1</div>
<div class="line"><span class="lineno">  403</span>    )</div>
<div class="line"><span class="lineno">  404</span>    mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  405</span>    <span class="keyword">assert</span> mlp.score(X, y) &gt; 0.9</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac726590d9ce841a4a4644c71caeb9b21" name="ac726590d9ce841a4a4644c71caeb9b21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac726590d9ce841a4a4644c71caeb9b21">&#9670;&#160;</a></span>test_n_iter_no_change()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_n_iter_no_change </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  758</span><span class="keyword">def </span>test_n_iter_no_change():</div>
<div class="line"><span class="lineno">  759</span>    <span class="comment"># test n_iter_no_change using binary data set</span></div>
<div class="line"><span class="lineno">  760</span>    <span class="comment"># the classifying fitting process is not prone to loss curve fluctuations</span></div>
<div class="line"><span class="lineno">  761</span>    X = X_digits_binary[:100]</div>
<div class="line"><span class="lineno">  762</span>    y = y_digits_binary[:100]</div>
<div class="line"><span class="lineno">  763</span>    tol = 0.01</div>
<div class="line"><span class="lineno">  764</span>    max_iter = 3000</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="comment"># test multiple n_iter_no_change</span></div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordflow">for</span> n_iter_no_change <span class="keywordflow">in</span> [2, 5, 10, 50, 100]:</div>
<div class="line"><span class="lineno">  768</span>        clf = MLPClassifier(</div>
<div class="line"><span class="lineno">  769</span>            tol=tol, max_iter=max_iter, solver=<span class="stringliteral">&quot;sgd&quot;</span>, n_iter_no_change=n_iter_no_change</div>
<div class="line"><span class="lineno">  770</span>        )</div>
<div class="line"><span class="lineno">  771</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>        <span class="comment"># validate n_iter_no_change</span></div>
<div class="line"><span class="lineno">  774</span>        <span class="keyword">assert</span> clf._no_improvement_count == n_iter_no_change + 1</div>
<div class="line"><span class="lineno">  775</span>        <span class="keyword">assert</span> max_iter &gt; clf.n_iter_</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span><span class="preprocessor">@ignore_warnings(category=ConvergenceWarning)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04ce2e6eadaca5dd398589d52639a576" name="a04ce2e6eadaca5dd398589d52639a576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04ce2e6eadaca5dd398589d52639a576">&#9670;&#160;</a></span>test_n_iter_no_change_inf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_n_iter_no_change_inf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  779</span><span class="keyword">def </span>test_n_iter_no_change_inf():</div>
<div class="line"><span class="lineno">  780</span>    <span class="comment"># test n_iter_no_change using binary data set</span></div>
<div class="line"><span class="lineno">  781</span>    <span class="comment"># the fitting process should go to max_iter iterations</span></div>
<div class="line"><span class="lineno">  782</span>    X = X_digits_binary[:100]</div>
<div class="line"><span class="lineno">  783</span>    y = y_digits_binary[:100]</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>    <span class="comment"># set a ridiculous tolerance</span></div>
<div class="line"><span class="lineno">  786</span>    <span class="comment"># this should always trigger _update_no_improvement_count()</span></div>
<div class="line"><span class="lineno">  787</span>    tol = 1e9</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>    <span class="comment"># fit</span></div>
<div class="line"><span class="lineno">  790</span>    n_iter_no_change = np.inf</div>
<div class="line"><span class="lineno">  791</span>    max_iter = 3000</div>
<div class="line"><span class="lineno">  792</span>    clf = MLPClassifier(</div>
<div class="line"><span class="lineno">  793</span>        tol=tol, max_iter=max_iter, solver=<span class="stringliteral">&quot;sgd&quot;</span>, n_iter_no_change=n_iter_no_change</div>
<div class="line"><span class="lineno">  794</span>    )</div>
<div class="line"><span class="lineno">  795</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    <span class="comment"># validate n_iter_no_change doesn&#39;t cause early stopping</span></div>
<div class="line"><span class="lineno">  798</span>    <span class="keyword">assert</span> clf.n_iter_ == max_iter</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    <span class="comment"># validate _update_no_improvement_count() was always triggered</span></div>
<div class="line"><span class="lineno">  801</span>    <span class="keyword">assert</span> clf._no_improvement_count == clf.n_iter_ - 1</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a350b5d1c5d172d7b557bdfc081fdd9a9" name="a350b5d1c5d172d7b557bdfc081fdd9a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a350b5d1c5d172d7b557bdfc081fdd9a9">&#9670;&#160;</a></span>test_nonfinite_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_nonfinite_params </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  505</span><span class="keyword">def </span>test_nonfinite_params():</div>
<div class="line"><span class="lineno">  506</span>    <span class="comment"># Check that MLPRegressor throws ValueError when dealing with non-finite</span></div>
<div class="line"><span class="lineno">  507</span>    <span class="comment"># parameter values</span></div>
<div class="line"><span class="lineno">  508</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  509</span>    n_samples = 10</div>
<div class="line"><span class="lineno">  510</span>    fmax = np.finfo(np.float64).max</div>
<div class="line"><span class="lineno">  511</span>    X = fmax * rng.uniform(size=(n_samples, 2))</div>
<div class="line"><span class="lineno">  512</span>    y = rng.standard_normal(size=n_samples)</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    clf = MLPRegressor()</div>
<div class="line"><span class="lineno">  515</span>    msg = (</div>
<div class="line"><span class="lineno">  516</span>        <span class="stringliteral">&quot;Solver produced non-finite parameter weights. The input data may contain large&quot;</span></div>
<div class="line"><span class="lineno">  517</span>        <span class="stringliteral">&quot; values and need to be preprocessed.&quot;</span></div>
<div class="line"><span class="lineno">  518</span>    )</div>
<div class="line"><span class="lineno">  519</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  520</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2447bd81e9240bc057909498ca486424" name="a2447bd81e9240bc057909498ca486424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2447bd81e9240bc057909498ca486424">&#9670;&#160;</a></span>test_partial_fit_classes_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_partial_fit_classes_error </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  408</span><span class="keyword">def </span>test_partial_fit_classes_error():</div>
<div class="line"><span class="lineno">  409</span>    <span class="comment"># Tests that passing different classes to partial_fit raises an error</span></div>
<div class="line"><span class="lineno">  410</span>    X = [[3, 2]]</div>
<div class="line"><span class="lineno">  411</span>    y = [0]</div>
<div class="line"><span class="lineno">  412</span>    clf = MLPClassifier(solver=<span class="stringliteral">&quot;sgd&quot;</span>)</div>
<div class="line"><span class="lineno">  413</span>    clf.partial_fit(X, y, classes=[0, 1])</div>
<div class="line"><span class="lineno">  414</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  415</span>        clf.partial_fit(X, y, classes=[1, 2])</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4456f3262dafcaa29fed11cf08cc5834" name="a4456f3262dafcaa29fed11cf08cc5834"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4456f3262dafcaa29fed11cf08cc5834">&#9670;&#160;</a></span>test_partial_fit_classification()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_partial_fit_classification </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  418</span><span class="keyword">def </span>test_partial_fit_classification():</div>
<div class="line"><span class="lineno">  419</span>    <span class="comment"># Test partial_fit on classification.</span></div>
<div class="line"><span class="lineno">  420</span>    <span class="comment"># `partial_fit` should yield the same results as &#39;fit&#39; for binary and</span></div>
<div class="line"><span class="lineno">  421</span>    <span class="comment"># multi-class classification.</span></div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordflow">for</span> X, y <span class="keywordflow">in</span> classification_datasets:</div>
<div class="line"><span class="lineno">  423</span>        mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">  424</span>            solver=<span class="stringliteral">&quot;sgd&quot;</span>,</div>
<div class="line"><span class="lineno">  425</span>            max_iter=100,</div>
<div class="line"><span class="lineno">  426</span>            random_state=1,</div>
<div class="line"><span class="lineno">  427</span>            tol=0,</div>
<div class="line"><span class="lineno">  428</span>            alpha=1e-5,</div>
<div class="line"><span class="lineno">  429</span>            learning_rate_init=0.2,</div>
<div class="line"><span class="lineno">  430</span>        )</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>        <span class="keyword">with</span> ignore_warnings(category=ConvergenceWarning):</div>
<div class="line"><span class="lineno">  433</span>            mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  434</span>        pred1 = mlp.predict(X)</div>
<div class="line"><span class="lineno">  435</span>        mlp = MLPClassifier(</div>
<div class="line"><span class="lineno">  436</span>            solver=<span class="stringliteral">&quot;sgd&quot;</span>, random_state=1, alpha=1e-5, learning_rate_init=0.2</div>
<div class="line"><span class="lineno">  437</span>        )</div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(100):</div>
<div class="line"><span class="lineno">  439</span>            mlp.partial_fit(X, y, classes=np.unique(y))</div>
<div class="line"><span class="lineno">  440</span>        pred2 = mlp.predict(X)</div>
<div class="line"><span class="lineno">  441</span>        assert_array_equal(pred1, pred2)</div>
<div class="line"><span class="lineno">  442</span>        <span class="keyword">assert</span> mlp.score(X, y) &gt; 0.95</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af1dbf7d8ba33c6d81fd5f73071e28cfb" name="af1dbf7d8ba33c6d81fd5f73071e28cfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1dbf7d8ba33c6d81fd5f73071e28cfb">&#9670;&#160;</a></span>test_partial_fit_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_partial_fit_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  492</span><span class="keyword">def </span>test_partial_fit_errors():</div>
<div class="line"><span class="lineno">  493</span>    <span class="comment"># Test partial_fit error handling.</span></div>
<div class="line"><span class="lineno">  494</span>    X = [[3, 2], [1, 6]]</div>
<div class="line"><span class="lineno">  495</span>    y = [1, 0]</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    <span class="comment"># no classes passed</span></div>
<div class="line"><span class="lineno">  498</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  499</span>        MLPClassifier(solver=<span class="stringliteral">&quot;sgd&quot;</span>).partial_fit(X, y, classes=[2])</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>    <span class="comment"># lbfgs doesn&#39;t support partial_fit</span></div>
<div class="line"><span class="lineno">  502</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> hasattr(MLPClassifier(solver=<span class="stringliteral">&quot;lbfgs&quot;</span>), <span class="stringliteral">&quot;partial_fit&quot;</span>)</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a75d4fb7963870a1cbf8997689b76d6" name="a6a75d4fb7963870a1cbf8997689b76d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a75d4fb7963870a1cbf8997689b76d6">&#9670;&#160;</a></span>test_partial_fit_regression()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_partial_fit_regression </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  455</span><span class="keyword">def </span>test_partial_fit_regression():</div>
<div class="line"><span class="lineno">  456</span>    <span class="comment"># Test partial_fit on regression.</span></div>
<div class="line"><span class="lineno">  457</span>    <span class="comment"># `partial_fit` should yield the same results as &#39;fit&#39; for regression.</span></div>
<div class="line"><span class="lineno">  458</span>    X = X_reg</div>
<div class="line"><span class="lineno">  459</span>    y = y_reg</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">for</span> momentum <span class="keywordflow">in</span> [0, 0.9]:</div>
<div class="line"><span class="lineno">  462</span>        mlp = MLPRegressor(</div>
<div class="line"><span class="lineno">  463</span>            solver=<span class="stringliteral">&quot;sgd&quot;</span>,</div>
<div class="line"><span class="lineno">  464</span>            max_iter=100,</div>
<div class="line"><span class="lineno">  465</span>            activation=<span class="stringliteral">&quot;relu&quot;</span>,</div>
<div class="line"><span class="lineno">  466</span>            random_state=1,</div>
<div class="line"><span class="lineno">  467</span>            learning_rate_init=0.01,</div>
<div class="line"><span class="lineno">  468</span>            batch_size=X.shape[0],</div>
<div class="line"><span class="lineno">  469</span>            momentum=momentum,</div>
<div class="line"><span class="lineno">  470</span>        )</div>
<div class="line"><span class="lineno">  471</span>        <span class="keyword">with</span> warnings.catch_warnings(record=<span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">  472</span>            <span class="comment"># catch convergence warning</span></div>
<div class="line"><span class="lineno">  473</span>            mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  474</span>        pred1 = mlp.predict(X)</div>
<div class="line"><span class="lineno">  475</span>        mlp = MLPRegressor(</div>
<div class="line"><span class="lineno">  476</span>            solver=<span class="stringliteral">&quot;sgd&quot;</span>,</div>
<div class="line"><span class="lineno">  477</span>            activation=<span class="stringliteral">&quot;relu&quot;</span>,</div>
<div class="line"><span class="lineno">  478</span>            learning_rate_init=0.01,</div>
<div class="line"><span class="lineno">  479</span>            random_state=1,</div>
<div class="line"><span class="lineno">  480</span>            batch_size=X.shape[0],</div>
<div class="line"><span class="lineno">  481</span>            momentum=momentum,</div>
<div class="line"><span class="lineno">  482</span>        )</div>
<div class="line"><span class="lineno">  483</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(100):</div>
<div class="line"><span class="lineno">  484</span>            mlp.partial_fit(X, y)</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>        pred2 = mlp.predict(X)</div>
<div class="line"><span class="lineno">  487</span>        assert_allclose(pred1, pred2)</div>
<div class="line"><span class="lineno">  488</span>        score = mlp.score(X, y)</div>
<div class="line"><span class="lineno">  489</span>        <span class="keyword">assert</span> score &gt; 0.65</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a35364d5983dcc58e0be9edbd8d05a2e8" name="a35364d5983dcc58e0be9edbd8d05a2e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35364d5983dcc58e0be9edbd8d05a2e8">&#9670;&#160;</a></span>test_partial_fit_unseen_classes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_partial_fit_unseen_classes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  445</span><span class="keyword">def </span>test_partial_fit_unseen_classes():</div>
<div class="line"><span class="lineno">  446</span>    <span class="comment"># Non regression test for bug 6994</span></div>
<div class="line"><span class="lineno">  447</span>    <span class="comment"># Tests for labeling errors in partial fit</span></div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    clf = MLPClassifier(random_state=0)</div>
<div class="line"><span class="lineno">  450</span>    clf.partial_fit([[1], [2], [3]], [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], classes=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>])</div>
<div class="line"><span class="lineno">  451</span>    clf.partial_fit([[4]], [<span class="stringliteral">&quot;d&quot;</span>])</div>
<div class="line"><span class="lineno">  452</span>    <span class="keyword">assert</span> clf.score([[1], [2], [3], [4]], [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>]) &gt; 0</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ea534ac81cf906f03462e37a2f2abad" name="a7ea534ac81cf906f03462e37a2f2abad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ea534ac81cf906f03462e37a2f2abad">&#9670;&#160;</a></span>test_predict_proba_binary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_predict_proba_binary </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  523</span><span class="keyword">def </span>test_predict_proba_binary():</div>
<div class="line"><span class="lineno">  524</span>    <span class="comment"># Test that predict_proba works as expected for binary class.</span></div>
<div class="line"><span class="lineno">  525</span>    X = X_digits_binary[:50]</div>
<div class="line"><span class="lineno">  526</span>    y = y_digits_binary[:50]</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>    clf = MLPClassifier(hidden_layer_sizes=5, activation=<span class="stringliteral">&quot;logistic&quot;</span>, random_state=1)</div>
<div class="line"><span class="lineno">  529</span>    <span class="keyword">with</span> ignore_warnings(category=ConvergenceWarning):</div>
<div class="line"><span class="lineno">  530</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno">  531</span>    y_proba = clf.predict_proba(X)</div>
<div class="line"><span class="lineno">  532</span>    y_log_proba = clf.predict_log_proba(X)</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>    (n_samples, n_classes) = y.shape[0], 2</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    proba_max = y_proba.argmax(axis=1)</div>
<div class="line"><span class="lineno">  537</span>    proba_log_max = y_log_proba.argmax(axis=1)</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    <span class="keyword">assert</span> y_proba.shape == (n_samples, n_classes)</div>
<div class="line"><span class="lineno">  540</span>    assert_array_equal(proba_max, proba_log_max)</div>
<div class="line"><span class="lineno">  541</span>    assert_allclose(y_log_proba, np.log(y_proba))</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keyword">assert</span> roc_auc_score(y, y_proba[:, 1]) == 1.0</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5bc0f25a21e42410dfdb0d2538198dd" name="ab5bc0f25a21e42410dfdb0d2538198dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5bc0f25a21e42410dfdb0d2538198dd">&#9670;&#160;</a></span>test_predict_proba_multiclass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_predict_proba_multiclass </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  546</span><span class="keyword">def </span>test_predict_proba_multiclass():</div>
<div class="line"><span class="lineno">  547</span>    <span class="comment"># Test that predict_proba works as expected for multi class.</span></div>
<div class="line"><span class="lineno">  548</span>    X = X_digits_multi[:10]</div>
<div class="line"><span class="lineno">  549</span>    y = y_digits_multi[:10]</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>    clf = MLPClassifier(hidden_layer_sizes=5)</div>
<div class="line"><span class="lineno">  552</span>    <span class="keyword">with</span> ignore_warnings(category=ConvergenceWarning):</div>
<div class="line"><span class="lineno">  553</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno">  554</span>    y_proba = clf.predict_proba(X)</div>
<div class="line"><span class="lineno">  555</span>    y_log_proba = clf.predict_log_proba(X)</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>    (n_samples, n_classes) = y.shape[0], np.unique(y).size</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    proba_max = y_proba.argmax(axis=1)</div>
<div class="line"><span class="lineno">  560</span>    proba_log_max = y_log_proba.argmax(axis=1)</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>    <span class="keyword">assert</span> y_proba.shape == (n_samples, n_classes)</div>
<div class="line"><span class="lineno">  563</span>    assert_array_equal(proba_max, proba_log_max)</div>
<div class="line"><span class="lineno">  564</span>    assert_allclose(y_log_proba, np.log(y_proba))</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aebe8d02ee0ea66260e9c417e118a27f4" name="aebe8d02ee0ea66260e9c417e118a27f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebe8d02ee0ea66260e9c417e118a27f4">&#9670;&#160;</a></span>test_predict_proba_multilabel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_predict_proba_multilabel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  567</span><span class="keyword">def </span>test_predict_proba_multilabel():</div>
<div class="line"><span class="lineno">  568</span>    <span class="comment"># Test that predict_proba works as expected for multilabel.</span></div>
<div class="line"><span class="lineno">  569</span>    <span class="comment"># Multilabel should not use softmax which makes probabilities sum to 1</span></div>
<div class="line"><span class="lineno">  570</span>    X, Y = make_multilabel_classification(</div>
<div class="line"><span class="lineno">  571</span>        n_samples=50, random_state=0, return_indicator=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  572</span>    )</div>
<div class="line"><span class="lineno">  573</span>    n_samples, n_classes = Y.shape</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>    clf = MLPClassifier(solver=<span class="stringliteral">&quot;lbfgs&quot;</span>, hidden_layer_sizes=30, random_state=0)</div>
<div class="line"><span class="lineno">  576</span>    clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  577</span>    y_proba = clf.predict_proba(X)</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    <span class="keyword">assert</span> y_proba.shape == (n_samples, n_classes)</div>
<div class="line"><span class="lineno">  580</span>    assert_array_equal(y_proba &gt; 0.5, Y)</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>    y_log_proba = clf.predict_log_proba(X)</div>
<div class="line"><span class="lineno">  583</span>    proba_max = y_proba.argmax(axis=1)</div>
<div class="line"><span class="lineno">  584</span>    proba_log_max = y_log_proba.argmax(axis=1)</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    <span class="keyword">assert</span> (y_proba.sum(1) - 1).dot(y_proba.sum(1) - 1) &gt; 1e-10</div>
<div class="line"><span class="lineno">  587</span>    assert_array_equal(proba_max, proba_log_max)</div>
<div class="line"><span class="lineno">  588</span>    assert_allclose(y_log_proba, np.log(y_proba))</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae476ea7cc86be32e324976da911fb9c7" name="ae476ea7cc86be32e324976da911fb9c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae476ea7cc86be32e324976da911fb9c7">&#9670;&#160;</a></span>test_shuffle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_shuffle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  591</span><span class="keyword">def </span>test_shuffle():</div>
<div class="line"><span class="lineno">  592</span>    <span class="comment"># Test that the shuffle parameter affects the training process (it should)</span></div>
<div class="line"><span class="lineno">  593</span>    X, y = make_regression(n_samples=50, n_features=5, n_targets=1, random_state=0)</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>    <span class="comment"># The coefficients will be identical if both do or do not shuffle</span></div>
<div class="line"><span class="lineno">  596</span>    <span class="keywordflow">for</span> shuffle <span class="keywordflow">in</span> [<span class="keyword">True</span>, <span class="keyword">False</span>]:</div>
<div class="line"><span class="lineno">  597</span>        mlp1 = MLPRegressor(</div>
<div class="line"><span class="lineno">  598</span>            hidden_layer_sizes=1,</div>
<div class="line"><span class="lineno">  599</span>            max_iter=1,</div>
<div class="line"><span class="lineno">  600</span>            batch_size=1,</div>
<div class="line"><span class="lineno">  601</span>            random_state=0,</div>
<div class="line"><span class="lineno">  602</span>            shuffle=shuffle,</div>
<div class="line"><span class="lineno">  603</span>        )</div>
<div class="line"><span class="lineno">  604</span>        mlp2 = MLPRegressor(</div>
<div class="line"><span class="lineno">  605</span>            hidden_layer_sizes=1,</div>
<div class="line"><span class="lineno">  606</span>            max_iter=1,</div>
<div class="line"><span class="lineno">  607</span>            batch_size=1,</div>
<div class="line"><span class="lineno">  608</span>            random_state=0,</div>
<div class="line"><span class="lineno">  609</span>            shuffle=shuffle,</div>
<div class="line"><span class="lineno">  610</span>        )</div>
<div class="line"><span class="lineno">  611</span>        mlp1.fit(X, y)</div>
<div class="line"><span class="lineno">  612</span>        mlp2.fit(X, y)</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>        <span class="keyword">assert</span> np.array_equal(mlp1.coefs_[0], mlp2.coefs_[0])</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>    <span class="comment"># The coefficients will be slightly different if shuffle=True</span></div>
<div class="line"><span class="lineno">  617</span>    mlp1 = MLPRegressor(</div>
<div class="line"><span class="lineno">  618</span>        hidden_layer_sizes=1, max_iter=1, batch_size=1, random_state=0, shuffle=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  619</span>    )</div>
<div class="line"><span class="lineno">  620</span>    mlp2 = MLPRegressor(</div>
<div class="line"><span class="lineno">  621</span>        hidden_layer_sizes=1, max_iter=1, batch_size=1, random_state=0, shuffle=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">  622</span>    )</div>
<div class="line"><span class="lineno">  623</span>    mlp1.fit(X, y)</div>
<div class="line"><span class="lineno">  624</span>    mlp2.fit(X, y)</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> np.array_equal(mlp1.coefs_[0], mlp2.coefs_[0])</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9cc8e812d56d506cf202ccbd7569059" name="ae9cc8e812d56d506cf202ccbd7569059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9cc8e812d56d506cf202ccbd7569059">&#9670;&#160;</a></span>test_sparse_matrices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_sparse_matrices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  629</span><span class="keyword">def </span>test_sparse_matrices():</div>
<div class="line"><span class="lineno">  630</span>    <span class="comment"># Test that sparse and dense input matrices output the same results.</span></div>
<div class="line"><span class="lineno">  631</span>    X = X_digits_binary[:50]</div>
<div class="line"><span class="lineno">  632</span>    y = y_digits_binary[:50]</div>
<div class="line"><span class="lineno">  633</span>    X_sparse = csr_matrix(X)</div>
<div class="line"><span class="lineno">  634</span>    mlp = MLPClassifier(solver=<span class="stringliteral">&quot;lbfgs&quot;</span>, hidden_layer_sizes=15, random_state=1)</div>
<div class="line"><span class="lineno">  635</span>    mlp.fit(X, y)</div>
<div class="line"><span class="lineno">  636</span>    pred1 = mlp.predict(X)</div>
<div class="line"><span class="lineno">  637</span>    mlp.fit(X_sparse, y)</div>
<div class="line"><span class="lineno">  638</span>    pred2 = mlp.predict(X_sparse)</div>
<div class="line"><span class="lineno">  639</span>    assert_almost_equal(pred1, pred2)</div>
<div class="line"><span class="lineno">  640</span>    pred1 = mlp.predict(X)</div>
<div class="line"><span class="lineno">  641</span>    pred2 = mlp.predict(X_sparse)</div>
<div class="line"><span class="lineno">  642</span>    assert_array_equal(pred1, pred2)</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1786d36f31a009126f52f1591478f889" name="a1786d36f31a009126f52f1591478f889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1786d36f31a009126f52f1591478f889">&#9670;&#160;</a></span>test_tolerance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_tolerance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  645</span><span class="keyword">def </span>test_tolerance():</div>
<div class="line"><span class="lineno">  646</span>    <span class="comment"># Test tolerance.</span></div>
<div class="line"><span class="lineno">  647</span>    <span class="comment"># It should force the solver to exit the loop when it converges.</span></div>
<div class="line"><span class="lineno">  648</span>    X = [[3, 2], [1, 6]]</div>
<div class="line"><span class="lineno">  649</span>    y = [1, 0]</div>
<div class="line"><span class="lineno">  650</span>    clf = MLPClassifier(tol=0.5, max_iter=3000, solver=<span class="stringliteral">&quot;sgd&quot;</span>)</div>
<div class="line"><span class="lineno">  651</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  652</span>    <span class="keyword">assert</span> clf.max_iter &gt; clf.n_iter_</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8adae4f143035c238e92d22204c1d2b2" name="a8adae4f143035c238e92d22204c1d2b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8adae4f143035c238e92d22204c1d2b2">&#9670;&#160;</a></span>test_verbose_sgd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_verbose_sgd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  655</span><span class="keyword">def </span>test_verbose_sgd():</div>
<div class="line"><span class="lineno">  656</span>    <span class="comment"># Test verbose.</span></div>
<div class="line"><span class="lineno">  657</span>    X = [[3, 2], [1, 6]]</div>
<div class="line"><span class="lineno">  658</span>    y = [1, 0]</div>
<div class="line"><span class="lineno">  659</span>    clf = MLPClassifier(solver=<span class="stringliteral">&quot;sgd&quot;</span>, max_iter=2, verbose=10, hidden_layer_sizes=2)</div>
<div class="line"><span class="lineno">  660</span>    old_stdout = sys.stdout</div>
<div class="line"><span class="lineno">  661</span>    sys.stdout = output = StringIO()</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="keyword">with</span> ignore_warnings(category=ConvergenceWarning):</div>
<div class="line"><span class="lineno">  664</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno">  665</span>    clf.partial_fit(X, y)</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>    sys.stdout = old_stdout</div>
<div class="line"><span class="lineno">  668</span>    <span class="keyword">assert</span> <span class="stringliteral">&quot;Iteration&quot;</span> <span class="keywordflow">in</span> output.getvalue()</div>
<div class="line"><span class="lineno">  669</span> </div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span><span class="preprocessor">@pytest.mark.parametrize(&quot;MLPEstimator&quot;, [MLPClassifier, MLPRegressor])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aba31069da1837d412eef94011b3f5075" name="aba31069da1837d412eef94011b3f5075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba31069da1837d412eef94011b3f5075">&#9670;&#160;</a></span>test_warm_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_warm_start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  712</span><span class="keyword">def </span>test_warm_start():</div>
<div class="line"><span class="lineno">  713</span>    X = X_iris</div>
<div class="line"><span class="lineno">  714</span>    y = y_iris</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>    y_2classes = np.array([0] * 75 + [1] * 75)</div>
<div class="line"><span class="lineno">  717</span>    y_3classes = np.array([0] * 40 + [1] * 40 + [2] * 70)</div>
<div class="line"><span class="lineno">  718</span>    y_3classes_alt = np.array([0] * 50 + [1] * 50 + [3] * 50)</div>
<div class="line"><span class="lineno">  719</span>    y_4classes = np.array([0] * 37 + [1] * 37 + [2] * 38 + [3] * 38)</div>
<div class="line"><span class="lineno">  720</span>    y_5classes = np.array([0] * 30 + [1] * 30 + [2] * 30 + [3] * 30 + [4] * 30)</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>    <span class="comment"># No error raised</span></div>
<div class="line"><span class="lineno">  723</span>    clf = MLPClassifier(hidden_layer_sizes=2, solver=<span class="stringliteral">&quot;lbfgs&quot;</span>, warm_start=<span class="keyword">True</span>).fit(X, y)</div>
<div class="line"><span class="lineno">  724</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  725</span>    clf.fit(X, y_3classes)</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordflow">for</span> y_i <span class="keywordflow">in</span> (y_2classes, y_3classes_alt, y_4classes, y_5classes):</div>
<div class="line"><span class="lineno">  728</span>        clf = MLPClassifier(hidden_layer_sizes=2, solver=<span class="stringliteral">&quot;lbfgs&quot;</span>, warm_start=<span class="keyword">True</span>).fit(</div>
<div class="line"><span class="lineno">  729</span>            X, y</div>
<div class="line"><span class="lineno">  730</span>        )</div>
<div class="line"><span class="lineno">  731</span>        message = (</div>
<div class="line"><span class="lineno">  732</span>            <span class="stringliteral">&quot;warm_start can only be used where `y` has the same &quot;</span></div>
<div class="line"><span class="lineno">  733</span>            <span class="stringliteral">&quot;classes as in the previous call to fit.&quot;</span></div>
<div class="line"><span class="lineno">  734</span>            <span class="stringliteral">&quot; Previously got [0 1 2], `y` has %s&quot;</span></div>
<div class="line"><span class="lineno">  735</span>            % np.unique(y_i)</div>
<div class="line"><span class="lineno">  736</span>        )</div>
<div class="line"><span class="lineno">  737</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=re.escape(message)):</div>
<div class="line"><span class="lineno">  738</span>            clf.fit(X, y_i)</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span><span class="preprocessor">@pytest.mark.parametrize(&quot;MLPEstimator&quot;, [MLPClassifier, MLPRegressor])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a33c02ab2f361d9fd85edc074b0111420" name="a33c02ab2f361d9fd85edc074b0111420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33c02ab2f361d9fd85edc074b0111420">&#9670;&#160;</a></span>test_warm_start_full_iteration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.test_warm_start_full_iteration </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>MLPEstimator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  742</span><span class="keyword">def </span>test_warm_start_full_iteration(MLPEstimator):</div>
<div class="line"><span class="lineno">  743</span>    <span class="comment"># Non-regression test for:</span></div>
<div class="line"><span class="lineno">  744</span>    <span class="comment"># https://github.com/scikit-learn/scikit-learn/issues/16812</span></div>
<div class="line"><span class="lineno">  745</span>    <span class="comment"># Check that the MLP estimator accomplish `max_iter` with a</span></div>
<div class="line"><span class="lineno">  746</span>    <span class="comment"># warm started estimator.</span></div>
<div class="line"><span class="lineno">  747</span>    X, y = X_iris, y_iris</div>
<div class="line"><span class="lineno">  748</span>    max_iter = 3</div>
<div class="line"><span class="lineno">  749</span>    clf = MLPEstimator(</div>
<div class="line"><span class="lineno">  750</span>        hidden_layer_sizes=2, solver=<span class="stringliteral">&quot;sgd&quot;</span>, warm_start=<span class="keyword">True</span>, max_iter=max_iter</div>
<div class="line"><span class="lineno">  751</span>    )</div>
<div class="line"><span class="lineno">  752</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  753</span>    <span class="keyword">assert</span> max_iter == clf.n_iter_</div>
<div class="line"><span class="lineno">  754</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  755</span>    <span class="keyword">assert</span> 2 * max_iter == clf.n_iter_</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a00b4fde4ddacec55d607496e54249a16" name="a00b4fde4ddacec55d607496e54249a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00b4fde4ddacec55d607496e54249a16">&#9670;&#160;</a></span>ACTIVATION_TYPES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list sklearn.neural_network.tests.test_mlp.ACTIVATION_TYPES = [&quot;identity&quot;, &quot;logistic&quot;, &quot;tanh&quot;, &quot;relu&quot;]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaa5f97c13157215deeca200365bb9190" name="aaa5f97c13157215deeca200365bb9190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa5f97c13157215deeca200365bb9190">&#9670;&#160;</a></span>bias</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.bias</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aab34e4ceb4c0d74b7f20f5d92d58cc41" name="aab34e4ceb4c0d74b7f20f5d92d58cc41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab34e4ceb4c0d74b7f20f5d92d58cc41">&#9670;&#160;</a></span>classification_datasets</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list sklearn.neural_network.tests.test_mlp.classification_datasets</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  [</div>
<div class="line"><span class="lineno">    2</span>    (X_digits_multi, y_digits_multi),</div>
<div class="line"><span class="lineno">    3</span>    (X_digits_binary, y_digits_binary),</div>
<div class="line"><span class="lineno">    4</span>]</div>
</div><!-- fragment -->
</div>
</div>
<a id="af3b7796891bd3d92740b3585ec9a1c9d" name="af3b7796891bd3d92740b3585ec9a1c9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3b7796891bd3d92740b3585ec9a1c9d">&#9670;&#160;</a></span>iris</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.iris = load_iris()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0c669c91d031b0b441fd3ee580cf0ba3" name="a0c669c91d031b0b441fd3ee580cf0ba3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c669c91d031b0b441fd3ee580cf0ba3">&#9670;&#160;</a></span>n_class</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.n_class</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a377bf2f18526bfe8f88e9fdbd815f884" name="a377bf2f18526bfe8f88e9fdbd815f884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a377bf2f18526bfe8f88e9fdbd815f884">&#9670;&#160;</a></span>n_features</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.n_features</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad7aebdc89fd31b39e7590c1177b4b478" name="ad7aebdc89fd31b39e7590c1177b4b478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7aebdc89fd31b39e7590c1177b4b478">&#9670;&#160;</a></span>n_samples</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.n_samples</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a414fdfc9cd1e2330ab954fbc9da89e24" name="a414fdfc9cd1e2330ab954fbc9da89e24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a414fdfc9cd1e2330ab954fbc9da89e24">&#9670;&#160;</a></span>noise</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.noise</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aecbbef70ae9cd16399bc07b993361712" name="aecbbef70ae9cd16399bc07b993361712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecbbef70ae9cd16399bc07b993361712">&#9670;&#160;</a></span>random_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.random_state</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a509e3ebb07a8b03883c98829e64f49dd" name="a509e3ebb07a8b03883c98829e64f49dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a509e3ebb07a8b03883c98829e64f49dd">&#9670;&#160;</a></span>regression_datasets</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list sklearn.neural_network.tests.test_mlp.regression_datasets = [(<a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#accd0b8a98d4a4e688d48ebf52b14adf9">X_reg</a>, <a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#a1e74759b6305e32d382bdb259c9b5ecf">y_reg</a>)]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4bc5c7300232f2ab27f08ba117a522c9" name="a4bc5c7300232f2ab27f08ba117a522c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bc5c7300232f2ab27f08ba117a522c9">&#9670;&#160;</a></span>return_X_y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.return_X_y</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae497361b1402ccade424e806046329b7" name="ae497361b1402ccade424e806046329b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae497361b1402ccade424e806046329b7">&#9670;&#160;</a></span>X_digits</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.X_digits</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab9a58c0276687f14f1a7389fac9c7051" name="ab9a58c0276687f14f1a7389fac9c7051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9a58c0276687f14f1a7389fac9c7051">&#9670;&#160;</a></span>X_digits_binary</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.X_digits_binary = <a class="el" href="classsklearn_1_1preprocessing_1_1__data_1_1_min_max_scaler.html">MinMaxScaler</a>().fit_transform(<a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae497361b1402ccade424e806046329b7">X_digits</a>[:200])</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a322657f2e6dc97d733b5263c587dc09d" name="a322657f2e6dc97d733b5263c587dc09d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a322657f2e6dc97d733b5263c587dc09d">&#9670;&#160;</a></span>X_digits_multi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.X_digits_multi = <a class="el" href="classsklearn_1_1preprocessing_1_1__data_1_1_min_max_scaler.html">MinMaxScaler</a>().fit_transform(<a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#ae497361b1402ccade424e806046329b7">X_digits</a>[:200])</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a42886b1e5e428d9aaab32d41466ebb7f" name="a42886b1e5e428d9aaab32d41466ebb7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42886b1e5e428d9aaab32d41466ebb7f">&#9670;&#160;</a></span>X_iris</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.X_iris = iris.data</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="accd0b8a98d4a4e688d48ebf52b14adf9" name="accd0b8a98d4a4e688d48ebf52b14adf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accd0b8a98d4a4e688d48ebf52b14adf9">&#9670;&#160;</a></span>X_reg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.X_reg</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aec28455bf8211f083be74eacb5a630ce" name="aec28455bf8211f083be74eacb5a630ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec28455bf8211f083be74eacb5a630ce">&#9670;&#160;</a></span>y_digits</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.y_digits</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a76a3f6b0b6082ae7743fd7eed649d1d4" name="a76a3f6b0b6082ae7743fd7eed649d1d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76a3f6b0b6082ae7743fd7eed649d1d4">&#9670;&#160;</a></span>y_digits_binary</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.y_digits_binary = <a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aec28455bf8211f083be74eacb5a630ce">y_digits</a>[:200]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a80167de8a121787b37d4aa658b3a89f1" name="a80167de8a121787b37d4aa658b3a89f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80167de8a121787b37d4aa658b3a89f1">&#9670;&#160;</a></span>y_digits_multi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.y_digits_multi = <a class="el" href="namespacesklearn_1_1neural__network_1_1tests_1_1test__mlp.html#aec28455bf8211f083be74eacb5a630ce">y_digits</a>[:200]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a07ead6070d83c7e0855a9e12bb5588d8" name="a07ead6070d83c7e0855a9e12bb5588d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07ead6070d83c7e0855a9e12bb5588d8">&#9670;&#160;</a></span>y_iris</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.y_iris = iris.target</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e74759b6305e32d382bdb259c9b5ecf" name="a1e74759b6305e32d382bdb259c9b5ecf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e74759b6305e32d382bdb259c9b5ecf">&#9670;&#160;</a></span>y_reg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neural_network.tests.test_mlp.y_reg = scale(y_reg)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
