<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.cluster.vq Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1cluster.html">cluster</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html">vq</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.cluster.vq Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1cluster_1_1vq_1_1_cluster_error.html">ClusterError</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7df9ca827cf63f3db8b909e2016564e6" id="r_a7df9ca827cf63f3db8b909e2016564e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a7df9ca827cf63f3db8b909e2016564e6">whiten</a> (obs, check_finite=True)</td></tr>
<tr class="separator:a7df9ca827cf63f3db8b909e2016564e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df8bb3df11b1fa79c14827e68daa380" id="r_a1df8bb3df11b1fa79c14827e68daa380"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a1df8bb3df11b1fa79c14827e68daa380">vq</a> (obs, code_book, check_finite=True)</td></tr>
<tr class="separator:a1df8bb3df11b1fa79c14827e68daa380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21cecc8a60b1bf0f25294402ed724a00" id="r_a21cecc8a60b1bf0f25294402ed724a00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a21cecc8a60b1bf0f25294402ed724a00">py_vq</a> (obs, code_book, check_finite=True)</td></tr>
<tr class="separator:a21cecc8a60b1bf0f25294402ed724a00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1b3f84a4372466d852d0656ed98608" id="r_a3d1b3f84a4372466d852d0656ed98608"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a3d1b3f84a4372466d852d0656ed98608">_kmeans</a> (obs, guess, thresh=1e-5)</td></tr>
<tr class="separator:a3d1b3f84a4372466d852d0656ed98608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8e184a19966bd748489fdbdabf8fb9c" id="r_aa8e184a19966bd748489fdbdabf8fb9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#aa8e184a19966bd748489fdbdabf8fb9c">kmeans</a> (obs, k_or_guess, <a class="el" href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a>=20, thresh=1e-5, check_finite=True, *seed=None)</td></tr>
<tr class="separator:aa8e184a19966bd748489fdbdabf8fb9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5bb59c4a885b3c1bd6d699a516ac75f" id="r_af5bb59c4a885b3c1bd6d699a516ac75f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#af5bb59c4a885b3c1bd6d699a516ac75f">_kpoints</a> (data, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, rng)</td></tr>
<tr class="separator:af5bb59c4a885b3c1bd6d699a516ac75f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a314bfaa7dd07a3454a258cfd8e745e63" id="r_a314bfaa7dd07a3454a258cfd8e745e63"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a314bfaa7dd07a3454a258cfd8e745e63">_krandinit</a> (data, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, rng)</td></tr>
<tr class="separator:a314bfaa7dd07a3454a258cfd8e745e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb3b53d741c4f3985fdf3f5a24ee024" id="r_adeb3b53d741c4f3985fdf3f5a24ee024"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#adeb3b53d741c4f3985fdf3f5a24ee024">_kpp</a> (data, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, rng)</td></tr>
<tr class="separator:adeb3b53d741c4f3985fdf3f5a24ee024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01dbd1bbf3e4212502fdffc9be0383f7" id="r_a01dbd1bbf3e4212502fdffc9be0383f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a01dbd1bbf3e4212502fdffc9be0383f7">_missing_warn</a> ()</td></tr>
<tr class="separator:a01dbd1bbf3e4212502fdffc9be0383f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0862354c163a66ba853ffe86186e207b" id="r_a0862354c163a66ba853ffe86186e207b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a0862354c163a66ba853ffe86186e207b">_missing_raise</a> ()</td></tr>
<tr class="separator:a0862354c163a66ba853ffe86186e207b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d7c0080924bd0a4511cce7d443e0217" id="r_a6d7c0080924bd0a4511cce7d443e0217"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a6d7c0080924bd0a4511cce7d443e0217">kmeans2</a> (data, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, <a class="el" href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a>=10, thresh=1e-5, minit='random', missing='warn', check_finite=True, *seed=None)</td></tr>
<tr class="separator:a6d7c0080924bd0a4511cce7d443e0217"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad3bf8e7babf57d496624ff317edcacf1" id="r_ad3bf8e7babf57d496624ff317edcacf1"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#ad3bf8e7babf57d496624ff317edcacf1">_valid_init_meth</a> = {'random': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a314bfaa7dd07a3454a258cfd8e745e63">_krandinit</a>, 'points': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#af5bb59c4a885b3c1bd6d699a516ac75f">_kpoints</a>, '++': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#adeb3b53d741c4f3985fdf3f5a24ee024">_kpp</a>}</td></tr>
<tr class="separator:ad3bf8e7babf57d496624ff317edcacf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e6ae79c5f26df48a29efe7e4a5c5817" id="r_a8e6ae79c5f26df48a29efe7e4a5c5817"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a8e6ae79c5f26df48a29efe7e4a5c5817">_valid_miss_meth</a> = {'warn': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a01dbd1bbf3e4212502fdffc9be0383f7">_missing_warn</a>, 'raise': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a0862354c163a66ba853ffe86186e207b">_missing_raise</a>}</td></tr>
<tr class="separator:a8e6ae79c5f26df48a29efe7e4a5c5817"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">K-means clustering and vector quantization (:mod:`scipy.cluster.vq`)
====================================================================

Provides routines for k-means clustering, generating code books
from k-means models and quantizing vectors by comparing them with
centroids in a code book.

.. autosummary::
   :toctree: generated/

   whiten -- Normalize a group of observations so each feature has unit variance
   vq -- Calculate code book membership of a set of observation vectors
   kmeans -- Perform k-means on a set of observation vectors forming k clusters
   kmeans2 -- A different implementation of k-means with more methods
           -- for initializing centroids

Background information
----------------------
The k-means algorithm takes as input the number of clusters to
generate, k, and a set of observation vectors to cluster. It
returns a set of centroids, one for each of the k clusters. An
observation vector is classified with the cluster number or
centroid index of the centroid closest to it.

A vector v belongs to cluster i if it is closer to centroid i than
any other centroid. If v belongs to i, we say centroid i is the
dominating centroid of v. The k-means algorithm tries to
minimize distortion, which is defined as the sum of the squared distances
between each observation vector and its dominating centroid.
The minimization is achieved by iteratively reclassifying
the observations into clusters and recalculating the centroids until
a configuration is reached in which the centroids are stable. One can
also define a maximum number of iterations.

Since vector quantization is a natural application for k-means,
information theory terminology is often used. The centroid index
or cluster index is also referred to as a "code" and the table
mapping codes to centroids and, vice versa, is often referred to as a
"code book". The result of k-means, a set of centroids, can be
used to quantize vectors. Quantization aims to find an encoding of
vectors that reduces the expected distortion.

All routines expect obs to be an M by N array, where the rows are
the observation vectors. The codebook is a k by N array, where the
ith row is the centroid of code word i. The observation vectors
and centroids have the same feature dimension.

As an example, suppose we wish to compress a 24-bit color image
(each pixel is represented by one byte for red, one for blue, and
one for green) before sending it over the web. By using a smaller
8-bit encoding, we can reduce the amount of data by two
thirds. Ideally, the colors for each of the 256 possible 8-bit
encoding values should be chosen to minimize distortion of the
color. Running k-means with k=256 generates a code book of 256
codes, which fills up all possible 8-bit sequences. Instead of
sending a 3-byte value for each pixel, the 8-bit centroid index
(or code word) of the dominating centroid is transmitted. The code
book is also sent over the wire so each 8-bit code can be
translated back to a 24-bit pixel value representation. If the
image of interest was of an ocean, we would expect many 24-bit
blues to be represented by 8-bit codes. If it was an image of a
human face, more flesh-tone colors would be represented in the
code book.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a3d1b3f84a4372466d852d0656ed98608" name="a3d1b3f84a4372466d852d0656ed98608"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d1b3f84a4372466d852d0656ed98608">&#9670;&#160;</a></span>_kmeans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq._kmeans </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thresh</em> = <code>1e-5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment"> "raw" version of k-means.

Returns
-------
code_book
    The lowest distortion codebook found.
avg_dist
    The average distance a observation is from a code in the book.
    Lower means the code_book matches the data better.

See Also
--------
kmeans : wrapper around k-means

Examples
--------
Note: not whitened in this example.

&gt;&gt;&gt; from numpy import array
&gt;&gt;&gt; from scipy.cluster.vq import _kmeans
&gt;&gt;&gt; features  = array([[ 1.9,2.3],
...                    [ 1.5,2.5],
...                    [ 0.8,0.6],
...                    [ 0.4,1.8],
...                    [ 1.0,1.0]])
&gt;&gt;&gt; book = array((features[0],features[2]))
&gt;&gt;&gt; _kmeans(features,book)
(array([[ 1.7       ,  2.4       ],
       [ 0.73333333,  1.13333333]]), 0.40563916697728591)</pre> <div class="fragment"><div class="line"><span class="lineno">  265</span><span class="keyword">def </span>_kmeans(obs, guess, thresh=1e-5):</div>
<div class="line"><span class="lineno">  266</span>    <span class="stringliteral">&quot;&quot;&quot; &quot;raw&quot; version of k-means.</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    code_book</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">        The lowest distortion codebook found.</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    avg_dist</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">        The average distance a observation is from a code in the book.</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">        Lower means the code_book matches the data better.</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    kmeans : wrapper around k-means</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    Note: not whitened in this example.</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">    &gt;&gt;&gt; from numpy import array</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.cluster.vq import _kmeans</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">    &gt;&gt;&gt; features  = array([[ 1.9,2.3],</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">    ...                    [ 1.5,2.5],</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">    ...                    [ 0.8,0.6],</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">    ...                    [ 0.4,1.8],</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">    ...                    [ 1.0,1.0]])</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    &gt;&gt;&gt; book = array((features[0],features[2]))</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    &gt;&gt;&gt; _kmeans(features,book)</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">    (array([[ 1.7       ,  2.4       ],</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">           [ 0.73333333,  1.13333333]]), 0.40563916697728591)</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    code_book = np.asarray(guess)</div>
<div class="line"><span class="lineno">  299</span>    diff = np.inf</div>
<div class="line"><span class="lineno">  300</span>    prev_avg_dists = deque([diff], maxlen=2)</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">while</span> diff &gt; thresh:</div>
<div class="line"><span class="lineno">  302</span>        <span class="comment"># compute membership and distances between obs and code_book</span></div>
<div class="line"><span class="lineno">  303</span>        obs_code, distort = vq(obs, code_book, check_finite=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  304</span>        prev_avg_dists.append(distort.mean(axis=-1))</div>
<div class="line"><span class="lineno">  305</span>        <span class="comment"># recalc code_book as centroids of associated obs</span></div>
<div class="line"><span class="lineno">  306</span>        code_book, has_members = _vq.update_cluster_means(obs, obs_code,</div>
<div class="line"><span class="lineno">  307</span>                                                          code_book.shape[0])</div>
<div class="line"><span class="lineno">  308</span>        code_book = code_book[has_members]</div>
<div class="line"><span class="lineno">  309</span>        diff = prev_avg_dists[0] - prev_avg_dists[1]</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordflow">return</span> code_book, prev_avg_dists[1]</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af5bb59c4a885b3c1bd6d699a516ac75f" name="af5bb59c4a885b3c1bd6d699a516ac75f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5bb59c4a885b3c1bd6d699a516ac75f">&#9670;&#160;</a></span>_kpoints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq._kpoints </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Pick k points at random in data (one row = one observation).

Parameters
----------
data : ndarray
    Expect a rank 1 or 2 array. Rank 1 are assumed to describe one
    dimensional data, rank 2 multidimensional data, in which case one
    row is one observation.
k : int
    Number of samples to generate.
rng : `numpy.random.Generator` or `numpy.random.RandomState`
    Random number generator.

Returns
-------
x : ndarray
    A 'k' by 'N' containing the initial centroids</pre> <div class="fragment"><div class="line"><span class="lineno">  484</span><span class="keyword">def </span>_kpoints(data, k, rng):</div>
<div class="line"><span class="lineno">  485</span>    <span class="stringliteral">&quot;&quot;&quot;Pick k points at random in data (one row = one observation).</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">    data : ndarray</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">        Expect a rank 1 or 2 array. Rank 1 are assumed to describe one</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">        dimensional data, rank 2 multidimensional data, in which case one</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">        row is one observation.</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">    k : int</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">        Number of samples to generate.</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">    rng : `numpy.random.Generator` or `numpy.random.RandomState`</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">        Random number generator.</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">    x : ndarray</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">        A &#39;k&#39; by &#39;N&#39; containing the initial centroids</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  504</span>    idx = rng.choice(data.shape[0], size=k, replace=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordflow">return</span> data[idx]</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adeb3b53d741c4f3985fdf3f5a24ee024" name="adeb3b53d741c4f3985fdf3f5a24ee024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeb3b53d741c4f3985fdf3f5a24ee024">&#9670;&#160;</a></span>_kpp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq._kpp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment"> Picks k points in the data based on the kmeans++ method.

Parameters
----------
data : ndarray
    Expect a rank 1 or 2 array. Rank 1 is assumed to describe 1-D
    data, rank 2 multidimensional data, in which case one
    row is one observation.
k : int
    Number of samples to generate.
rng : `numpy.random.Generator` or `numpy.random.RandomState`
    Random number generator.

Returns
-------
init : ndarray
    A 'k' by 'N' containing the initial centroids.

References
----------
.. [1] D. Arthur and S. Vassilvitskii, "k-means++: the advantages of
   careful seeding", Proceedings of the Eighteenth Annual ACM-SIAM Symposium
   on Discrete Algorithms, 2007.
</pre> <div class="fragment"><div class="line"><span class="lineno">  555</span><span class="keyword">def </span>_kpp(data, k, rng):</div>
<div class="line"><span class="lineno">  556</span>    <span class="stringliteral">&quot;&quot;&quot; Picks k points in the data based on the kmeans++ method.</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">    data : ndarray</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        Expect a rank 1 or 2 array. Rank 1 is assumed to describe 1-D</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">        data, rank 2 multidimensional data, in which case one</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">        row is one observation.</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">    k : int</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">        Number of samples to generate.</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">    rng : `numpy.random.Generator` or `numpy.random.RandomState`</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">        Random number generator.</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">    init : ndarray</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral">        A &#39;k&#39; by &#39;N&#39; containing the initial centroids.</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">    .. [1] D. Arthur and S. Vassilvitskii, &quot;k-means++: the advantages of</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral">       careful seeding&quot;, Proceedings of the Eighteenth Annual ACM-SIAM Symposium</span></div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">       on Discrete Algorithms, 2007.</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    dims = data.shape[1] <span class="keywordflow">if</span> len(data.shape) &gt; 1 <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  582</span>    init = np.ndarray((k, dims))</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(k):</div>
<div class="line"><span class="lineno">  585</span>        <span class="keywordflow">if</span> i == 0:</div>
<div class="line"><span class="lineno">  586</span>            init[i, :] = data[rng_integers(rng, data.shape[0])]</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  589</span>            D2 = cdist(init[:i,:], data, metric=<span class="stringliteral">&#39;sqeuclidean&#39;</span>).min(axis=0)</div>
<div class="line"><span class="lineno">  590</span>            probs = D2/D2.sum()</div>
<div class="line"><span class="lineno">  591</span>            cumprobs = probs.cumsum()</div>
<div class="line"><span class="lineno">  592</span>            r = rng.uniform()</div>
<div class="line"><span class="lineno">  593</span>            init[i, :] = data[np.searchsorted(cumprobs, r)]</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>    <span class="keywordflow">return</span> init</div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a314bfaa7dd07a3454a258cfd8e745e63" name="a314bfaa7dd07a3454a258cfd8e745e63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a314bfaa7dd07a3454a258cfd8e745e63">&#9670;&#160;</a></span>_krandinit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq._krandinit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns k samples of a random variable whose parameters depend on data.

More precisely, it returns k observations sampled from a Gaussian random
variable whose mean and covariances are the ones estimated from the data.

Parameters
----------
data : ndarray
    Expect a rank 1 or 2 array. Rank 1 is assumed to describe 1-D
    data, rank 2 multidimensional data, in which case one
    row is one observation.
k : int
    Number of samples to generate.
rng : `numpy.random.Generator` or `numpy.random.RandomState`
    Random number generator.

Returns
-------
x : ndarray
    A 'k' by 'N' containing the initial centroids</pre> <div class="fragment"><div class="line"><span class="lineno">  508</span><span class="keyword">def </span>_krandinit(data, k, rng):</div>
<div class="line"><span class="lineno">  509</span>    <span class="stringliteral">&quot;&quot;&quot;Returns k samples of a random variable whose parameters depend on data.</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">    More precisely, it returns k observations sampled from a Gaussian random</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">    variable whose mean and covariances are the ones estimated from the data.</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">    data : ndarray</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">        Expect a rank 1 or 2 array. Rank 1 is assumed to describe 1-D</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">        data, rank 2 multidimensional data, in which case one</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">        row is one observation.</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">    k : int</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">        Number of samples to generate.</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">    rng : `numpy.random.Generator` or `numpy.random.RandomState`</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">        Random number generator.</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    x : ndarray</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">        A &#39;k&#39; by &#39;N&#39; containing the initial centroids</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  531</span>    mu = data.mean(axis=0)</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">if</span> data.ndim == 1:</div>
<div class="line"><span class="lineno">  534</span>        cov = np.cov(data)</div>
<div class="line"><span class="lineno">  535</span>        x = rng.standard_normal(size=k)</div>
<div class="line"><span class="lineno">  536</span>        x *= np.sqrt(cov)</div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">elif</span> data.shape[1] &gt; data.shape[0]:</div>
<div class="line"><span class="lineno">  538</span>        <span class="comment"># initialize when the covariance matrix is rank deficient</span></div>
<div class="line"><span class="lineno">  539</span>        _, s, vh = np.linalg.svd(data - mu, full_matrices=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  540</span>        x = rng.standard_normal(size=(k, s.size))</div>
<div class="line"><span class="lineno">  541</span>        sVh = s[:, <span class="keywordtype">None</span>] * vh / np.sqrt(data.shape[0] - 1)</div>
<div class="line"><span class="lineno">  542</span>        x = x.dot(sVh)</div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  544</span>        cov = np.atleast_2d(np.cov(data, rowvar=<span class="keyword">False</span>))</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>        <span class="comment"># k rows, d cols (one row = one obs)</span></div>
<div class="line"><span class="lineno">  547</span>        <span class="comment"># Generate k sample of a random variable ~ Gaussian(mu, cov)</span></div>
<div class="line"><span class="lineno">  548</span>        x = rng.standard_normal(size=(k, mu.size))</div>
<div class="line"><span class="lineno">  549</span>        x = x.dot(np.linalg.cholesky(cov).T)</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>    x += mu</div>
<div class="line"><span class="lineno">  552</span>    <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0862354c163a66ba853ffe86186e207b" name="a0862354c163a66ba853ffe86186e207b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0862354c163a66ba853ffe86186e207b">&#9670;&#160;</a></span>_missing_raise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq._missing_raise </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Raise a ClusterError when called.</pre> <div class="fragment"><div class="line"><span class="lineno">  607</span><span class="keyword">def </span>_missing_raise():</div>
<div class="line"><span class="lineno">  608</span>    <span class="stringliteral">&quot;&quot;&quot;Raise a ClusterError when called.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">raise</span> ClusterError(<span class="stringliteral">&quot;One of the clusters is empty. &quot;</span></div>
<div class="line"><span class="lineno">  610</span>                       <span class="stringliteral">&quot;Re-run kmeans with a different initialization.&quot;</span>)</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a01dbd1bbf3e4212502fdffc9be0383f7" name="a01dbd1bbf3e4212502fdffc9be0383f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01dbd1bbf3e4212502fdffc9be0383f7">&#9670;&#160;</a></span>_missing_warn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq._missing_warn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Print a warning when called.</pre> <div class="fragment"><div class="line"><span class="lineno">  601</span><span class="keyword">def </span>_missing_warn():</div>
<div class="line"><span class="lineno">  602</span>    <span class="stringliteral">&quot;&quot;&quot;Print a warning when called.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  603</span>    warnings.warn(<span class="stringliteral">&quot;One of the clusters is empty. &quot;</span></div>
<div class="line"><span class="lineno">  604</span>                  <span class="stringliteral">&quot;Re-run kmeans with a different initialization.&quot;</span>)</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8e184a19966bd748489fdbdabf8fb9c" name="aa8e184a19966bd748489fdbdabf8fb9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8e184a19966bd748489fdbdabf8fb9c">&#9670;&#160;</a></span>kmeans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq.kmeans </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k_or_guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iter</em> = <code>20</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thresh</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Performs k-means on a set of observation vectors forming k clusters.

The k-means algorithm adjusts the classification of the observations
into clusters and updates the cluster centroids until the position of
the centroids is stable over successive iterations. In this
implementation of the algorithm, the stability of the centroids is
determined by comparing the absolute value of the change in the average
Euclidean distance between the observations and their corresponding
centroids against a threshold. This yields
a code book mapping centroids to codes and vice versa.

Parameters
----------
obs : ndarray
   Each row of the M by N array is an observation vector. The
   columns are the features seen during each observation.
   The features must be whitened first with the `whiten` function.

k_or_guess : int or ndarray
   The number of centroids to generate. A code is assigned to
   each centroid, which is also the row index of the centroid
   in the code_book matrix generated.

   The initial k centroids are chosen by randomly selecting
   observations from the observation matrix. Alternatively,
   passing a k by N array specifies the initial k centroids.

iter : int, optional
   The number of times to run k-means, returning the codebook
   with the lowest distortion. This argument is ignored if
   initial centroids are specified with an array for the
   ``k_or_guess`` parameter. This parameter does not represent the
   number of iterations of the k-means algorithm.

thresh : float, optional
   Terminates the k-means algorithm if the change in
   distortion since the last k-means iteration is less than
   or equal to threshold.

check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
    Default: True

seed : {None, int, `numpy.random.Generator`,
        `numpy.random.RandomState`}, optional

    Seed for initializing the pseudo-random number generator.
    If `seed` is None (or `numpy.random`), the `numpy.random.RandomState`
    singleton is used.
    If `seed` is an int, a new ``RandomState`` instance is used,
    seeded with `seed`.
    If `seed` is already a ``Generator`` or ``RandomState`` instance then
    that instance is used.
    The default is None.

Returns
-------
codebook : ndarray
   A k by N array of k centroids. The ith centroid
   codebook[i] is represented with the code i. The centroids
   and codes generated represent the lowest distortion seen,
   not necessarily the globally minimal distortion.
   Note that the number of centroids is not necessarily the same as the
   ``k_or_guess`` parameter, because centroids assigned to no observations
   are removed during iterations.

distortion : float
   The mean (non-squared) Euclidean distance between the observations
   passed and the centroids generated. Note the difference to the standard
   definition of distortion in the context of the k-means algorithm, which
   is the sum of the squared distances.

See Also
--------
kmeans2 : a different implementation of k-means clustering
   with more methods for generating initial centroids but without
   using a distortion change threshold as a stopping criterion.

whiten : must be called prior to passing an observation matrix
   to kmeans.

Notes
-----
For more functionalities or optimal performance, you can use
`sklearn.cluster.KMeans &lt;https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html&gt;`_.
`This &lt;https://hdbscan.readthedocs.io/en/latest/performance_and_scalability.html#comparison-of-high-performance-implementations&gt;`_
is a benchmark result of several implementations.

Examples
--------
&gt;&gt;&gt; from numpy import array
&gt;&gt;&gt; from scipy.cluster.vq import vq, kmeans, whiten
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; features  = array([[ 1.9,2.3],
...                    [ 1.5,2.5],
...                    [ 0.8,0.6],
...                    [ 0.4,1.8],
...                    [ 0.1,0.1],
...                    [ 0.2,1.8],
...                    [ 2.0,0.5],
...                    [ 0.3,1.5],
...                    [ 1.0,1.0]])
&gt;&gt;&gt; whitened = whiten(features)
&gt;&gt;&gt; book = np.array((whitened[0],whitened[2]))
&gt;&gt;&gt; kmeans(whitened,book)
(array([[ 2.3110306 ,  2.86287398],    # random
       [ 0.93218041,  1.24398691]]), 0.85684700941625547)

&gt;&gt;&gt; codes = 3
&gt;&gt;&gt; kmeans(whitened,codes)
(array([[ 2.3110306 ,  2.86287398],    # random
       [ 1.32544402,  0.65607529],
       [ 0.40782893,  2.02786907]]), 0.5196582527686241)

&gt;&gt;&gt; # Create 50 datapoints in two clusters a and b
&gt;&gt;&gt; pts = 50
&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; a = rng.multivariate_normal([0, 0], [[4, 1], [1, 4]], size=pts)
&gt;&gt;&gt; b = rng.multivariate_normal([30, 10],
...                             [[10, 2], [2, 1]],
...                             size=pts)
&gt;&gt;&gt; features = np.concatenate((a, b))
&gt;&gt;&gt; # Whiten data
&gt;&gt;&gt; whitened = whiten(features)
&gt;&gt;&gt; # Find 2 clusters in the data
&gt;&gt;&gt; codebook, distortion = kmeans(whitened, 2)
&gt;&gt;&gt; # Plot whitened data and cluster centers in red
&gt;&gt;&gt; plt.scatter(whitened[:, 0], whitened[:, 1])
&gt;&gt;&gt; plt.scatter(codebook[:, 0], codebook[:, 1], c='r')
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  315</span>           *, seed=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  316</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">    Performs k-means on a set of observation vectors forming k clusters.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    The k-means algorithm adjusts the classification of the observations</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">    into clusters and updates the cluster centroids until the position of</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    the centroids is stable over successive iterations. In this</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">    implementation of the algorithm, the stability of the centroids is</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    determined by comparing the absolute value of the change in the average</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">    Euclidean distance between the observations and their corresponding</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    centroids against a threshold. This yields</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">    a code book mapping centroids to codes and vice versa.</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    obs : ndarray</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">       Each row of the M by N array is an observation vector. The</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">       columns are the features seen during each observation.</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">       The features must be whitened first with the `whiten` function.</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    k_or_guess : int or ndarray</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">       The number of centroids to generate. A code is assigned to</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">       each centroid, which is also the row index of the centroid</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">       in the code_book matrix generated.</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">       The initial k centroids are chosen by randomly selecting</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">       observations from the observation matrix. Alternatively,</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">       passing a k by N array specifies the initial k centroids.</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    iter : int, optional</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">       The number of times to run k-means, returning the codebook</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">       with the lowest distortion. This argument is ignored if</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">       initial centroids are specified with an array for the</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">       ``k_or_guess`` parameter. This parameter does not represent the</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">       number of iterations of the k-means algorithm.</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    thresh : float, optional</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">       Terminates the k-means algorithm if the change in</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">       distortion since the last k-means iteration is less than</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">       or equal to threshold.</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">        Default: True</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">    seed : {None, int, `numpy.random.Generator`,</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">            `numpy.random.RandomState`}, optional</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">        Seed for initializing the pseudo-random number generator.</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">        If `seed` is None (or `numpy.random`), the `numpy.random.RandomState`</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">        singleton is used.</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">        If `seed` is an int, a new ``RandomState`` instance is used,</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">        seeded with `seed`.</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">        If `seed` is already a ``Generator`` or ``RandomState`` instance then</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">        that instance is used.</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">        The default is None.</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">    codebook : ndarray</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">       A k by N array of k centroids. The ith centroid</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">       codebook[i] is represented with the code i. The centroids</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">       and codes generated represent the lowest distortion seen,</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">       not necessarily the globally minimal distortion.</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">       Note that the number of centroids is not necessarily the same as the</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">       ``k_or_guess`` parameter, because centroids assigned to no observations</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">       are removed during iterations.</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">    distortion : float</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">       The mean (non-squared) Euclidean distance between the observations</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">       passed and the centroids generated. Note the difference to the standard</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">       definition of distortion in the context of the k-means algorithm, which</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">       is the sum of the squared distances.</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    kmeans2 : a different implementation of k-means clustering</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">       with more methods for generating initial centroids but without</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">       using a distortion change threshold as a stopping criterion.</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    whiten : must be called prior to passing an observation matrix</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">       to kmeans.</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">    For more functionalities or optimal performance, you can use</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">    `sklearn.cluster.KMeans &lt;https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html&gt;`_.</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">    `This &lt;https://hdbscan.readthedocs.io/en/latest/performance_and_scalability.html#comparison-of-high-performance-implementations&gt;`_</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">    is a benchmark result of several implementations.</span></div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  407</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  408</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral">    &gt;&gt;&gt; from numpy import array</span></div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.cluster.vq import vq, kmeans, whiten</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral">    &gt;&gt;&gt; features  = array([[ 1.9,2.3],</span></div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral">    ...                    [ 1.5,2.5],</span></div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral">    ...                    [ 0.8,0.6],</span></div>
<div class="line"><span class="lineno">  415</span><span class="stringliteral">    ...                    [ 0.4,1.8],</span></div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral">    ...                    [ 0.1,0.1],</span></div>
<div class="line"><span class="lineno">  417</span><span class="stringliteral">    ...                    [ 0.2,1.8],</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">    ...                    [ 2.0,0.5],</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral">    ...                    [ 0.3,1.5],</span></div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">    ...                    [ 1.0,1.0]])</span></div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">    &gt;&gt;&gt; whitened = whiten(features)</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">    &gt;&gt;&gt; book = np.array((whitened[0],whitened[2]))</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">    &gt;&gt;&gt; kmeans(whitened,book)</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">    (array([[ 2.3110306 ,  2.86287398],    # random</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">           [ 0.93218041,  1.24398691]]), 0.85684700941625547)</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">    &gt;&gt;&gt; codes = 3</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">    &gt;&gt;&gt; kmeans(whitened,codes)</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral">    (array([[ 2.3110306 ,  2.86287398],    # random</span></div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">           [ 1.32544402,  0.65607529],</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">           [ 0.40782893,  2.02786907]]), 0.5196582527686241)</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    &gt;&gt;&gt; # Create 50 datapoints in two clusters a and b</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    &gt;&gt;&gt; pts = 50</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">    &gt;&gt;&gt; rng = np.random.default_rng()</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">    &gt;&gt;&gt; a = rng.multivariate_normal([0, 0], [[4, 1], [1, 4]], size=pts)</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">    &gt;&gt;&gt; b = rng.multivariate_normal([30, 10],</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">    ...                             [[10, 2], [2, 1]],</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">    ...                             size=pts)</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">    &gt;&gt;&gt; features = np.concatenate((a, b))</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">    &gt;&gt;&gt; # Whiten data</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    &gt;&gt;&gt; whitened = whiten(features)</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">    &gt;&gt;&gt; # Find 2 clusters in the data</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">    &gt;&gt;&gt; codebook, distortion = kmeans(whitened, 2)</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">    &gt;&gt;&gt; # Plot whitened data and cluster centers in red</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral">    &gt;&gt;&gt; plt.scatter(whitened[:, 0], whitened[:, 1])</span></div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">    &gt;&gt;&gt; plt.scatter(codebook[:, 0], codebook[:, 1], c=&#39;r&#39;)</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  451</span>    obs = _asarray_validated(obs, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  452</span>    <span class="keywordflow">if</span> iter &lt; 1:</div>
<div class="line"><span class="lineno">  453</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;iter must be at least 1, got %s&quot;</span> % iter)</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <span class="comment"># Determine whether a count (scalar) or an initial guess (array) was passed.</span></div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isscalar(k_or_guess):</div>
<div class="line"><span class="lineno">  457</span>        guess = _asarray_validated(k_or_guess, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">if</span> guess.size &lt; 1:</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Asked for 0 clusters. Initial book was %s&quot;</span> %</div>
<div class="line"><span class="lineno">  460</span>                             guess)</div>
<div class="line"><span class="lineno">  461</span>        <span class="keywordflow">return</span> _kmeans(obs, guess, thresh=thresh)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="comment"># k_or_guess is a scalar, now verify that it&#39;s an integer</span></div>
<div class="line"><span class="lineno">  464</span>    k = int(k_or_guess)</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">if</span> k != k_or_guess:</div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;If k_or_guess is a scalar, it must be an integer.&quot;</span>)</div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">if</span> k &lt; 1:</div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Asked for %d clusters.&quot;</span> % k)</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    rng = check_random_state(seed)</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>    <span class="comment"># initialize best distance value to a large value</span></div>
<div class="line"><span class="lineno">  473</span>    best_dist = np.inf</div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(iter):</div>
<div class="line"><span class="lineno">  475</span>        <span class="comment"># the initial code book is randomly selected from observations</span></div>
<div class="line"><span class="lineno">  476</span>        guess = _kpoints(obs, k, rng)</div>
<div class="line"><span class="lineno">  477</span>        book, dist = _kmeans(obs, guess, thresh=thresh)</div>
<div class="line"><span class="lineno">  478</span>        <span class="keywordflow">if</span> dist &lt; best_dist:</div>
<div class="line"><span class="lineno">  479</span>            best_book = book</div>
<div class="line"><span class="lineno">  480</span>            best_dist = dist</div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">return</span> best_book, best_dist</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d7c0080924bd0a4511cce7d443e0217" name="a6d7c0080924bd0a4511cce7d443e0217"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d7c0080924bd0a4511cce7d443e0217">&#9670;&#160;</a></span>kmeans2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq.kmeans2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iter</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thresh</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>minit</em> = <code>'random'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>missing</em> = <code>'warn'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Classify a set of observations into k clusters using the k-means algorithm.

The algorithm attempts to minimize the Euclidean distance between
observations and centroids. Several initialization methods are
included.

Parameters
----------
data : ndarray
    A 'M' by 'N' array of 'M' observations in 'N' dimensions or a length
    'M' array of 'M' 1-D observations.
k : int or ndarray
    The number of clusters to form as well as the number of
    centroids to generate. If `minit` initialization string is
    'matrix', or if a ndarray is given instead, it is
    interpreted as initial cluster to use instead.
iter : int, optional
    Number of iterations of the k-means algorithm to run. Note
    that this differs in meaning from the iters parameter to
    the kmeans function.
thresh : float, optional
    (not used yet)
minit : str, optional
    Method for initialization. Available methods are 'random',
    'points', '++' and 'matrix':

    'random': generate k centroids from a Gaussian with mean and
    variance estimated from the data.

    'points': choose k observations (rows) at random from data for
    the initial centroids.

    '++': choose k observations accordingly to the kmeans++ method
    (careful seeding)

    'matrix': interpret the k parameter as a k by M (or length k
    array for 1-D data) array of initial centroids.
missing : str, optional
    Method to deal with empty clusters. Available methods are
    'warn' and 'raise':

    'warn': give a warning and continue.

    'raise': raise an ClusterError and terminate the algorithm.
check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
    Default: True
seed : {None, int, `numpy.random.Generator`,
        `numpy.random.RandomState`}, optional

    Seed for initializing the pseudo-random number generator.
    If `seed` is None (or `numpy.random`), the `numpy.random.RandomState`
    singleton is used.
    If `seed` is an int, a new ``RandomState`` instance is used,
    seeded with `seed`.
    If `seed` is already a ``Generator`` or ``RandomState`` instance then
    that instance is used.
    The default is None.

Returns
-------
centroid : ndarray
    A 'k' by 'N' array of centroids found at the last iteration of
    k-means.
label : ndarray
    label[i] is the code or index of the centroid the
    ith observation is closest to.

See Also
--------
kmeans

References
----------
.. [1] D. Arthur and S. Vassilvitskii, "k-means++: the advantages of
   careful seeding", Proceedings of the Eighteenth Annual ACM-SIAM Symposium
   on Discrete Algorithms, 2007.

Examples
--------
&gt;&gt;&gt; from scipy.cluster.vq import kmeans2
&gt;&gt;&gt; import matplotlib.pyplot as plt

Create z, an array with shape (100, 2) containing a mixture of samples
from three multivariate normal distributions.

&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; a = rng.multivariate_normal([0, 6], [[2, 1], [1, 1.5]], size=45)
&gt;&gt;&gt; b = rng.multivariate_normal([2, 0], [[1, -1], [-1, 3]], size=30)
&gt;&gt;&gt; c = rng.multivariate_normal([6, 4], [[5, 0], [0, 1.2]], size=25)
&gt;&gt;&gt; z = np.concatenate((a, b, c))
&gt;&gt;&gt; rng.shuffle(z)

Compute three clusters.

&gt;&gt;&gt; centroid, label = kmeans2(z, 3, minit='points')
&gt;&gt;&gt; centroid
array([[ 2.22274463, -0.61666946],  # may vary
       [ 0.54069047,  5.86541444],
       [ 6.73846769,  4.01991898]])

How many points are in each cluster?

&gt;&gt;&gt; counts = np.bincount(label)
&gt;&gt;&gt; counts
array([29, 51, 20])  # may vary

Plot the clusters.

&gt;&gt;&gt; w0 = z[label == 0]
&gt;&gt;&gt; w1 = z[label == 1]
&gt;&gt;&gt; w2 = z[label == 2]
&gt;&gt;&gt; plt.plot(w0[:, 0], w0[:, 1], 'o', alpha=0.5, label='cluster 0')
&gt;&gt;&gt; plt.plot(w1[:, 0], w1[:, 1], 'd', alpha=0.5, label='cluster 1')
&gt;&gt;&gt; plt.plot(w2[:, 0], w2[:, 1], 's', alpha=0.5, label='cluster 2')
&gt;&gt;&gt; plt.plot(centroid[:, 0], centroid[:, 1], 'k*', label='centroids')
&gt;&gt;&gt; plt.axis('equal')
&gt;&gt;&gt; plt.legend(shadow=True)
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  617</span>            missing=<span class="stringliteral">&#39;warn&#39;</span>, check_finite=<span class="keyword">True</span>, *, seed=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  618</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral">    Classify a set of observations into k clusters using the k-means algorithm.</span></div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral">    The algorithm attempts to minimize the Euclidean distance between</span></div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral">    observations and centroids. Several initialization methods are</span></div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral">    included.</span></div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">    data : ndarray</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">        A &#39;M&#39; by &#39;N&#39; array of &#39;M&#39; observations in &#39;N&#39; dimensions or a length</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral">        &#39;M&#39; array of &#39;M&#39; 1-D observations.</span></div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">    k : int or ndarray</span></div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral">        The number of clusters to form as well as the number of</span></div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">        centroids to generate. If `minit` initialization string is</span></div>
<div class="line"><span class="lineno">  633</span><span class="stringliteral">        &#39;matrix&#39;, or if a ndarray is given instead, it is</span></div>
<div class="line"><span class="lineno">  634</span><span class="stringliteral">        interpreted as initial cluster to use instead.</span></div>
<div class="line"><span class="lineno">  635</span><span class="stringliteral">    iter : int, optional</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral">        Number of iterations of the k-means algorithm to run. Note</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">        that this differs in meaning from the iters parameter to</span></div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral">        the kmeans function.</span></div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral">    thresh : float, optional</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">        (not used yet)</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">    minit : str, optional</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">        Method for initialization. Available methods are &#39;random&#39;,</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral">        &#39;points&#39;, &#39;++&#39; and &#39;matrix&#39;:</span></div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">        &#39;random&#39;: generate k centroids from a Gaussian with mean and</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">        variance estimated from the data.</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral">        &#39;points&#39;: choose k observations (rows) at random from data for</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">        the initial centroids.</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">        &#39;++&#39;: choose k observations accordingly to the kmeans++ method</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral">        (careful seeding)</span></div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">        &#39;matrix&#39;: interpret the k parameter as a k by M (or length k</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">        array for 1-D data) array of initial centroids.</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">    missing : str, optional</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">        Method to deal with empty clusters. Available methods are</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral">        &#39;warn&#39; and &#39;raise&#39;:</span></div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">        &#39;warn&#39;: give a warning and continue.</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">        &#39;raise&#39;: raise an ClusterError and terminate the algorithm.</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">        Default: True</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">    seed : {None, int, `numpy.random.Generator`,</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral">            `numpy.random.RandomState`}, optional</span></div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">        Seed for initializing the pseudo-random number generator.</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">        If `seed` is None (or `numpy.random`), the `numpy.random.RandomState`</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">        singleton is used.</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">        If `seed` is an int, a new ``RandomState`` instance is used,</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral">        seeded with `seed`.</span></div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral">        If `seed` is already a ``Generator`` or ``RandomState`` instance then</span></div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral">        that instance is used.</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">        The default is None.</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    centroid : ndarray</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">        A &#39;k&#39; by &#39;N&#39; array of centroids found at the last iteration of</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">        k-means.</span></div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral">    label : ndarray</span></div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral">        label[i] is the code or index of the centroid the</span></div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral">        ith observation is closest to.</span></div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral">    kmeans</span></div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral">    .. [1] D. Arthur and S. Vassilvitskii, &quot;k-means++: the advantages of</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral">       careful seeding&quot;, Proceedings of the Eighteenth Annual ACM-SIAM Symposium</span></div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">       on Discrete Algorithms, 2007.</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.cluster.vq import kmeans2</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral">    Create z, an array with shape (100, 2) containing a mixture of samples</span></div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral">    from three multivariate normal distributions.</span></div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral">    &gt;&gt;&gt; rng = np.random.default_rng()</span></div>
<div class="line"><span class="lineno">  708</span><span class="stringliteral">    &gt;&gt;&gt; a = rng.multivariate_normal([0, 6], [[2, 1], [1, 1.5]], size=45)</span></div>
<div class="line"><span class="lineno">  709</span><span class="stringliteral">    &gt;&gt;&gt; b = rng.multivariate_normal([2, 0], [[1, -1], [-1, 3]], size=30)</span></div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral">    &gt;&gt;&gt; c = rng.multivariate_normal([6, 4], [[5, 0], [0, 1.2]], size=25)</span></div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral">    &gt;&gt;&gt; z = np.concatenate((a, b, c))</span></div>
<div class="line"><span class="lineno">  712</span><span class="stringliteral">    &gt;&gt;&gt; rng.shuffle(z)</span></div>
<div class="line"><span class="lineno">  713</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">    Compute three clusters.</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">    &gt;&gt;&gt; centroid, label = kmeans2(z, 3, minit=&#39;points&#39;)</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">    &gt;&gt;&gt; centroid</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">    array([[ 2.22274463, -0.61666946],  # may vary</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral">           [ 0.54069047,  5.86541444],</span></div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral">           [ 6.73846769,  4.01991898]])</span></div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">    How many points are in each cluster?</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral">    &gt;&gt;&gt; counts = np.bincount(label)</span></div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">    &gt;&gt;&gt; counts</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">    array([29, 51, 20])  # may vary</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral">    Plot the clusters.</span></div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral">    &gt;&gt;&gt; w0 = z[label == 0]</span></div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">    &gt;&gt;&gt; w1 = z[label == 1]</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">    &gt;&gt;&gt; w2 = z[label == 2]</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w0[:, 0], w0[:, 1], &#39;o&#39;, alpha=0.5, label=&#39;cluster 0&#39;)</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w1[:, 0], w1[:, 1], &#39;d&#39;, alpha=0.5, label=&#39;cluster 1&#39;)</span></div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w2[:, 0], w2[:, 1], &#39;s&#39;, alpha=0.5, label=&#39;cluster 2&#39;)</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(centroid[:, 0], centroid[:, 1], &#39;k*&#39;, label=&#39;centroids&#39;)</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">    &gt;&gt;&gt; plt.axis(&#39;equal&#39;)</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">    &gt;&gt;&gt; plt.legend(shadow=True)</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">if</span> int(iter) &lt; 1:</div>
<div class="line"><span class="lineno">  743</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Invalid iter (%s), &quot;</span></div>
<div class="line"><span class="lineno">  744</span>                         <span class="stringliteral">&quot;must be a positive integer.&quot;</span> % iter)</div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  746</span>        miss_meth = _valid_miss_meth[missing]</div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unknown missing method %r&quot;</span> % (missing,)) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    data = _asarray_validated(data, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordflow">if</span> data.ndim == 1:</div>
<div class="line"><span class="lineno">  752</span>        d = 1</div>
<div class="line"><span class="lineno">  753</span>    <span class="keywordflow">elif</span> data.ndim == 2:</div>
<div class="line"><span class="lineno">  754</span>        d = data.shape[1]</div>
<div class="line"><span class="lineno">  755</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  756</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Input of rank &gt; 2 is not supported.&quot;</span>)</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>    <span class="keywordflow">if</span> data.size &lt; 1:</div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Empty input is not supported.&quot;</span>)</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>    <span class="comment"># If k is not a single value, it should be compatible with data&#39;s shape</span></div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordflow">if</span> minit == <span class="stringliteral">&#39;matrix&#39;</span> <span class="keywordflow">or</span> <span class="keywordflow">not</span> np.isscalar(k):</div>
<div class="line"><span class="lineno">  763</span>        code_book = np.array(k, copy=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  764</span>        <span class="keywordflow">if</span> data.ndim != code_book.ndim:</div>
<div class="line"><span class="lineno">  765</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;k array doesn&#39;t match data rank&quot;</span>)</div>
<div class="line"><span class="lineno">  766</span>        nc = len(code_book)</div>
<div class="line"><span class="lineno">  767</span>        <span class="keywordflow">if</span> data.ndim &gt; 1 <span class="keywordflow">and</span> code_book.shape[1] != d:</div>
<div class="line"><span class="lineno">  768</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;k array doesn&#39;t match data dimension&quot;</span>)</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  770</span>        nc = int(k)</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>        <span class="keywordflow">if</span> nc &lt; 1:</div>
<div class="line"><span class="lineno">  773</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Cannot ask kmeans2 for %d clusters&quot;</span></div>
<div class="line"><span class="lineno">  774</span>                             <span class="stringliteral">&quot; (k was %s)&quot;</span> % (nc, k))</div>
<div class="line"><span class="lineno">  775</span>        <span class="keywordflow">elif</span> nc != k:</div>
<div class="line"><span class="lineno">  776</span>            warnings.warn(<span class="stringliteral">&quot;k was not an integer, was converted.&quot;</span>)</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  779</span>            init_meth = _valid_init_meth[minit]</div>
<div class="line"><span class="lineno">  780</span>        <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  781</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unknown init method %r&quot;</span> % (minit,)) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  782</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  783</span>            rng = check_random_state(seed)</div>
<div class="line"><span class="lineno">  784</span>            code_book = init_meth(data, k, rng)</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(iter):</div>
<div class="line"><span class="lineno">  787</span>        <span class="comment"># Compute the nearest neighbor for each obs using the current code book</span></div>
<div class="line"><span class="lineno">  788</span>        label = vq(data, code_book)[0]</div>
<div class="line"><span class="lineno">  789</span>        <span class="comment"># Update the code book by computing centroids</span></div>
<div class="line"><span class="lineno">  790</span>        new_code_book, has_members = _vq.update_cluster_means(data, label, nc)</div>
<div class="line"><span class="lineno">  791</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> has_members.all():</div>
<div class="line"><span class="lineno">  792</span>            miss_meth()</div>
<div class="line"><span class="lineno">  793</span>            <span class="comment"># Set the empty clusters to their previous positions</span></div>
<div class="line"><span class="lineno">  794</span>            new_code_book[~has_members] = code_book[~has_members]</div>
<div class="line"><span class="lineno">  795</span>        code_book = new_code_book</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordflow">return</span> code_book, label</div>
</div><!-- fragment -->
</div>
</div>
<a id="a21cecc8a60b1bf0f25294402ed724a00" name="a21cecc8a60b1bf0f25294402ed724a00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21cecc8a60b1bf0f25294402ed724a00">&#9670;&#160;</a></span>py_vq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq.py_vq </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code_book</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment"> Python version of vq algorithm.

The algorithm computes the Euclidean distance between each
observation and every frame in the code_book.

Parameters
----------
obs : ndarray
    Expects a rank 2 array. Each row is one observation.
code_book : ndarray
    Code book to use. Same format than obs. Should have same number of
    features (e.g., columns) than obs.
check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
    Default: True

Returns
-------
code : ndarray
    code[i] gives the label of the ith obversation; its code is
    code_book[code[i]].
mind_dist : ndarray
    min_dist[i] gives the distance between the ith observation and its
    corresponding code.

Notes
-----
This function is slower than the C version but works for
all input types. If the inputs have the wrong types for the
C versions of the function, this one is called as a last resort.

It is about 20 times slower than the C version.</pre> <div class="fragment"><div class="line"><span class="lineno">  212</span><span class="keyword">def </span>py_vq(obs, code_book, check_finite=True):</div>
<div class="line"><span class="lineno">  213</span>    <span class="stringliteral">&quot;&quot;&quot; Python version of vq algorithm.</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    The algorithm computes the Euclidean distance between each</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">    observation and every frame in the code_book.</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    obs : ndarray</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">        Expects a rank 2 array. Each row is one observation.</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    code_book : ndarray</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">        Code book to use. Same format than obs. Should have same number of</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">        features (e.g., columns) than obs.</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">        Default: True</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    code : ndarray</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">        code[i] gives the label of the ith obversation; its code is</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">        code_book[code[i]].</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">    mind_dist : ndarray</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">        min_dist[i] gives the distance between the ith observation and its</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">        corresponding code.</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">    This function is slower than the C version but works for</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    all input types. If the inputs have the wrong types for the</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    C versions of the function, this one is called as a last resort.</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">    It is about 20 times slower than the C version.</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  249</span>    obs = _asarray_validated(obs, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  250</span>    code_book = _asarray_validated(code_book, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">if</span> obs.ndim != code_book.ndim:</div>
<div class="line"><span class="lineno">  253</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Observation and code_book should have the same rank&quot;</span>)</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">if</span> obs.ndim == 1:</div>
<div class="line"><span class="lineno">  256</span>        obs = obs[:, np.newaxis]</div>
<div class="line"><span class="lineno">  257</span>        code_book = code_book[:, np.newaxis]</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>    dist = cdist(obs, code_book)</div>
<div class="line"><span class="lineno">  260</span>    code = dist.argmin(axis=1)</div>
<div class="line"><span class="lineno">  261</span>    min_dist = dist[np.arange(len(code)), code]</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">return</span> code, min_dist</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1df8bb3df11b1fa79c14827e68daa380" name="a1df8bb3df11b1fa79c14827e68daa380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1df8bb3df11b1fa79c14827e68daa380">&#9670;&#160;</a></span>vq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq.vq </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code_book</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Assign codes from a code book to observations.

Assigns a code from a code book to each observation. Each
observation vector in the 'M' by 'N' `obs` array is compared with the
centroids in the code book and assigned the code of the closest
centroid.

The features in `obs` should have unit variance, which can be
achieved by passing them through the whiten function. The code
book can be created with the k-means algorithm or a different
encoding algorithm.

Parameters
----------
obs : ndarray
    Each row of the 'M' x 'N' array is an observation. The columns are
    the "features" seen during each observation. The features must be
    whitened first using the whiten function or something equivalent.
code_book : ndarray
    The code book is usually generated using the k-means algorithm.
    Each row of the array holds a different code, and the columns are
    the features of the code.

     &gt;&gt;&gt; #              f0    f1    f2   f3
     &gt;&gt;&gt; code_book = [
     ...             [  1.,   2.,   3.,   4.],  #c0
     ...             [  1.,   2.,   3.,   4.],  #c1
     ...             [  1.,   2.,   3.,   4.]]  #c2

check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
    Default: True

Returns
-------
code : ndarray
    A length M array holding the code book index for each observation.
dist : ndarray
    The distortion (distance) between the observation and its nearest
    code.

Examples
--------
&gt;&gt;&gt; from numpy import array
&gt;&gt;&gt; from scipy.cluster.vq import vq
&gt;&gt;&gt; code_book = array([[1.,1.,1.],
...                    [2.,2.,2.]])
&gt;&gt;&gt; features  = array([[  1.9,2.3,1.7],
...                    [  1.5,2.5,2.2],
...                    [  0.8,0.6,1.7]])
&gt;&gt;&gt; vq(features,code_book)
(array([1, 1, 0],'i'), array([ 0.43588989,  0.73484692,  0.83066239]))</pre> <div class="fragment"><div class="line"><span class="lineno">  142</span><span class="keyword">def </span>vq(obs, code_book, check_finite=True):</div>
<div class="line"><span class="lineno">  143</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    Assign codes from a code book to observations.</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    Assigns a code from a code book to each observation. Each</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    observation vector in the &#39;M&#39; by &#39;N&#39; `obs` array is compared with the</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    centroids in the code book and assigned the code of the closest</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    centroid.</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    The features in `obs` should have unit variance, which can be</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    achieved by passing them through the whiten function. The code</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    book can be created with the k-means algorithm or a different</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    encoding algorithm.</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    obs : ndarray</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">        Each row of the &#39;M&#39; x &#39;N&#39; array is an observation. The columns are</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">        the &quot;features&quot; seen during each observation. The features must be</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">        whitened first using the whiten function or something equivalent.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">    code_book : ndarray</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">        The code book is usually generated using the k-means algorithm.</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">        Each row of the array holds a different code, and the columns are</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">        the features of the code.</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">         &gt;&gt;&gt; #              f0    f1    f2   f3</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">         &gt;&gt;&gt; code_book = [</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">         ...             [  1.,   2.,   3.,   4.],  #c0</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">         ...             [  1.,   2.,   3.,   4.],  #c1</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">         ...             [  1.,   2.,   3.,   4.]]  #c2</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">        Default: True</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">    code : ndarray</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">        A length M array holding the code book index for each observation.</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">    dist : ndarray</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">        The distortion (distance) between the observation and its nearest</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">        code.</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    &gt;&gt;&gt; from numpy import array</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.cluster.vq import vq</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    &gt;&gt;&gt; code_book = array([[1.,1.,1.],</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">    ...                    [2.,2.,2.]])</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    &gt;&gt;&gt; features  = array([[  1.9,2.3,1.7],</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    ...                    [  1.5,2.5,2.2],</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    ...                    [  0.8,0.6,1.7]])</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">    &gt;&gt;&gt; vq(features,code_book)</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    (array([1, 1, 0],&#39;i&#39;), array([ 0.43588989,  0.73484692,  0.83066239]))</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  200</span>    obs = _asarray_validated(obs, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  201</span>    code_book = _asarray_validated(code_book, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  202</span>    ct = np.common_type(obs, code_book)</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    c_obs = obs.astype(ct, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  205</span>    c_code_book = code_book.astype(ct, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span> np.issubdtype(ct, np.float64) <span class="keywordflow">or</span> np.issubdtype(ct, np.float32):</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">return</span> _vq.vq(c_obs, c_code_book)</div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">return</span> py_vq(obs, code_book, check_finite=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7df9ca827cf63f3db8b909e2016564e6" name="a7df9ca827cf63f3db8b909e2016564e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7df9ca827cf63f3db8b909e2016564e6">&#9670;&#160;</a></span>whiten()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.cluster.vq.whiten </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Normalize a group of observations on a per feature basis.

Before running k-means, it is beneficial to rescale each feature
dimension of the observation set by its standard deviation (i.e. "whiten"
it - as in "white noise" where each frequency has equal power).
Each feature is divided by its standard deviation across all observations
to give it unit variance.

Parameters
----------
obs : ndarray
    Each row of the array is an observation.  The
    columns are the features seen during each observation.

    &gt;&gt;&gt; #         f0    f1    f2
    &gt;&gt;&gt; obs = [[  1.,   1.,   1.],  #o0
    ...        [  2.,   2.,   2.],  #o1
    ...        [  3.,   3.,   3.],  #o2
    ...        [  4.,   4.,   4.]]  #o3

check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
    Default: True

Returns
-------
result : ndarray
    Contains the values in `obs` scaled by the standard deviation
    of each column.

Examples
--------
&gt;&gt;&gt; from scipy.cluster.vq import whiten
&gt;&gt;&gt; features  = np.array([[1.9, 2.3, 1.7],
...                       [1.5, 2.5, 2.2],
...                       [0.8, 0.6, 1.7,]])
&gt;&gt;&gt; whiten(features)
array([[ 4.17944278,  2.69811351,  7.21248917],
       [ 3.29956009,  2.93273208,  9.33380951],
       [ 1.75976538,  0.7038557 ,  7.21248917]])</pre> <div class="fragment"><div class="line"><span class="lineno">   85</span><span class="keyword">def </span>whiten(obs, check_finite=True):</div>
<div class="line"><span class="lineno">   86</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">    Normalize a group of observations on a per feature basis.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    Before running k-means, it is beneficial to rescale each feature</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    dimension of the observation set by its standard deviation (i.e. &quot;whiten&quot;</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    it - as in &quot;white noise&quot; where each frequency has equal power).</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    Each feature is divided by its standard deviation across all observations</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    to give it unit variance.</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    obs : ndarray</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">        Each row of the array is an observation.  The</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">        columns are the features seen during each observation.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">        &gt;&gt;&gt; #         f0    f1    f2</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">        &gt;&gt;&gt; obs = [[  1.,   1.,   1.],  #o0</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">        ...        [  2.,   2.,   2.],  #o1</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">        ...        [  3.,   3.,   3.],  #o2</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">        ...        [  4.,   4.,   4.]]  #o3</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">        Default: True</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">    result : ndarray</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">        Contains the values in `obs` scaled by the standard deviation</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">        of each column.</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.cluster.vq import whiten</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    &gt;&gt;&gt; features  = np.array([[1.9, 2.3, 1.7],</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    ...                       [1.5, 2.5, 2.2],</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    ...                       [0.8, 0.6, 1.7,]])</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    &gt;&gt;&gt; whiten(features)</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">    array([[ 4.17944278,  2.69811351,  7.21248917],</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">           [ 3.29956009,  2.93273208,  9.33380951],</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">           [ 1.75976538,  0.7038557 ,  7.21248917]])</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  131</span>    obs = _asarray_validated(obs, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  132</span>    std_dev = obs.std(axis=0)</div>
<div class="line"><span class="lineno">  133</span>    zero_std_mask = std_dev == 0</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">if</span> zero_std_mask.any():</div>
<div class="line"><span class="lineno">  135</span>        std_dev[zero_std_mask] = 1.0</div>
<div class="line"><span class="lineno">  136</span>        warnings.warn(<span class="stringliteral">&quot;Some columns have standard deviation zero. &quot;</span></div>
<div class="line"><span class="lineno">  137</span>                      <span class="stringliteral">&quot;The values of these columns will not change.&quot;</span>,</div>
<div class="line"><span class="lineno">  138</span>                      RuntimeWarning)</div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">return</span> obs / std_dev</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad3bf8e7babf57d496624ff317edcacf1" name="ad3bf8e7babf57d496624ff317edcacf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3bf8e7babf57d496624ff317edcacf1">&#9670;&#160;</a></span>_valid_init_meth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.cluster.vq._valid_init_meth = {'random': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a314bfaa7dd07a3454a258cfd8e745e63">_krandinit</a>, 'points': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#af5bb59c4a885b3c1bd6d699a516ac75f">_kpoints</a>, '++': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#adeb3b53d741c4f3985fdf3f5a24ee024">_kpp</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e6ae79c5f26df48a29efe7e4a5c5817" name="a8e6ae79c5f26df48a29efe7e4a5c5817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e6ae79c5f26df48a29efe7e4a5c5817">&#9670;&#160;</a></span>_valid_miss_meth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.cluster.vq._valid_miss_meth = {'warn': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a01dbd1bbf3e4212502fdffc9be0383f7">_missing_warn</a>, 'raise': <a class="el" href="namespacescipy_1_1cluster_1_1vq.html#a0862354c163a66ba853ffe86186e207b">_missing_raise</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
