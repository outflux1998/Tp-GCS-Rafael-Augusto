<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.stats.tests.test_resampling.TestPermutationTest Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html">test_resampling</a></li><li class="navelem"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html">TestPermutationTest</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats.tests.test_resampling.TestPermutationTest Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a79bd832ff9722c44dcfa89d2a376a059" id="r_a79bd832ff9722c44dcfa89d2a376a059"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a79bd832ff9722c44dcfa89d2a376a059">test_permutation_test_iv</a> (self)</td></tr>
<tr class="separator:a79bd832ff9722c44dcfa89d2a376a059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48e5ac34e42c42beb40be52304ae0f82" id="r_a48e5ac34e42c42beb40be52304ae0f82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a48e5ac34e42c42beb40be52304ae0f82">test_batch</a> (self, permutation_type)</td></tr>
<tr class="separator:a48e5ac34e42c42beb40be52304ae0f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1a35cba63d12bed007dabfc3a08235" id="r_a3d1a35cba63d12bed007dabfc3a08235"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a3d1a35cba63d12bed007dabfc3a08235">test_permutations</a> (self, permutation_type, exact_size)</td></tr>
<tr class="separator:a3d1a35cba63d12bed007dabfc3a08235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a244e5b825ec4c991ea9ec69445526fc0" id="r_a244e5b825ec4c991ea9ec69445526fc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a244e5b825ec4c991ea9ec69445526fc0">test_randomized_test_against_exact_both</a> (self)</td></tr>
<tr class="separator:a244e5b825ec4c991ea9ec69445526fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e590d16451fb332e6a4ed46a5c4562" id="r_af4e590d16451fb332e6a4ed46a5c4562"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#af4e590d16451fb332e6a4ed46a5c4562">test_randomized_test_against_exact_samples</a> (self)</td></tr>
<tr class="separator:af4e590d16451fb332e6a4ed46a5c4562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb10b09dfd299dbdfaf0233740d22c0c" id="r_acb10b09dfd299dbdfaf0233740d22c0c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#acb10b09dfd299dbdfaf0233740d22c0c">test_randomized_test_against_exact_pairings</a> (self)</td></tr>
<tr class="separator:acb10b09dfd299dbdfaf0233740d22c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24cf502c080b8c6395fbe115a56a7044" id="r_a24cf502c080b8c6395fbe115a56a7044"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a24cf502c080b8c6395fbe115a56a7044">test_against_permutation_ttest</a> (self, alternative, permutations, axis)</td></tr>
<tr class="separator:a24cf502c080b8c6395fbe115a56a7044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc10f00726b184ae0d37083962bb2ed" id="r_a1cc10f00726b184ae0d37083962bb2ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a1cc10f00726b184ae0d37083962bb2ed">test_against_kstest</a> (self)</td></tr>
<tr class="separator:a1cc10f00726b184ae0d37083962bb2ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad05c473fa20f8d928a81afc05f192535" id="r_ad05c473fa20f8d928a81afc05f192535"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#ad05c473fa20f8d928a81afc05f192535">test_against_ansari</a> (self, alternative)</td></tr>
<tr class="separator:ad05c473fa20f8d928a81afc05f192535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abde7fc133644e526ab2e7a6c26fc2a08" id="r_abde7fc133644e526ab2e7a6c26fc2a08"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#abde7fc133644e526ab2e7a6c26fc2a08">test_against_mannwhitneyu</a> (self, alternative)</td></tr>
<tr class="separator:abde7fc133644e526ab2e7a6c26fc2a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afedb0a2f7fd8e591dd1d98b014bdc085" id="r_afedb0a2f7fd8e591dd1d98b014bdc085"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#afedb0a2f7fd8e591dd1d98b014bdc085">test_against_cvm</a> (self)</td></tr>
<tr class="separator:afedb0a2f7fd8e591dd1d98b014bdc085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1c8617448448fab557a029d632dc2e0" id="r_ac1c8617448448fab557a029d632dc2e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#ac1c8617448448fab557a029d632dc2e0">test_vectorized_nsamp_ptype_both</a> (self, axis)</td></tr>
<tr class="separator:ac1c8617448448fab557a029d632dc2e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7fbec6f79a96026f34c57b59b9f25ee" id="r_ae7fbec6f79a96026f34c57b59b9f25ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#ae7fbec6f79a96026f34c57b59b9f25ee">test_against_wilcoxon</a> (self, alternative)</td></tr>
<tr class="separator:ae7fbec6f79a96026f34c57b59b9f25ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff2790420c7650e0aa6a9eace21ec126" id="r_aff2790420c7650e0aa6a9eace21ec126"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#aff2790420c7650e0aa6a9eace21ec126">test_against_binomtest</a> (self, alternative)</td></tr>
<tr class="separator:aff2790420c7650e0aa6a9eace21ec126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243868996a44797dd73402c690fe3259" id="r_a243868996a44797dd73402c690fe3259"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a243868996a44797dd73402c690fe3259">test_against_kendalltau</a> (self)</td></tr>
<tr class="separator:a243868996a44797dd73402c690fe3259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6ec58c6595ea0dedbb16de2b9c3e0ee" id="r_aa6ec58c6595ea0dedbb16de2b9c3e0ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#aa6ec58c6595ea0dedbb16de2b9c3e0ee">test_against_fisher_exact</a> (self, alternative)</td></tr>
<tr class="separator:aa6ec58c6595ea0dedbb16de2b9c3e0ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fbb5a0afb341efd1ef1496c5136c24b" id="r_a2fbb5a0afb341efd1ef1496c5136c24b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a2fbb5a0afb341efd1ef1496c5136c24b">test_vectorized_nsamp_ptype_samples</a> (self, axis)</td></tr>
<tr class="separator:a2fbb5a0afb341efd1ef1496c5136c24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf5e60a06f4913fadf1988b3a9aa33b9" id="r_acf5e60a06f4913fadf1988b3a9aa33b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#acf5e60a06f4913fadf1988b3a9aa33b9">test_with_ties</a> (self, case)</td></tr>
<tr class="separator:acf5e60a06f4913fadf1988b3a9aa33b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0237f2bda9c7bfb7ca8a0e3a328933a3" id="r_a0237f2bda9c7bfb7ca8a0e3a328933a3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a0237f2bda9c7bfb7ca8a0e3a328933a3">test_against_spearmanr_in_R</a> (self, alternative, expected_pvalue)</td></tr>
<tr class="separator:a0237f2bda9c7bfb7ca8a0e3a328933a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad79574c3e1a088665969cb999ad9a0a4" id="r_ad79574c3e1a088665969cb999ad9a0a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#ad79574c3e1a088665969cb999ad9a0a4">test_batch_generator_iv</a> (self, batch)</td></tr>
<tr class="separator:ad79574c3e1a088665969cb999ad9a0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36288b38d973bdc1d38030eccb5f5fa8" id="r_a36288b38d973bdc1d38030eccb5f5fa8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a36288b38d973bdc1d38030eccb5f5fa8">test_batch_generator</a> (self, iterable, batch, expected)</td></tr>
<tr class="separator:a36288b38d973bdc1d38030eccb5f5fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8abd46a7594588bd066f977f52872fd" id="r_ad8abd46a7594588bd066f977f52872fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#ad8abd46a7594588bd066f977f52872fd">test_finite_precision_statistic</a> (self)</td></tr>
<tr class="separator:ad8abd46a7594588bd066f977f52872fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a51590c7ed1bfde325c737b27521802cb" id="r_a51590c7ed1bfde325c737b27521802cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a51590c7ed1bfde325c737b27521802cb">rtol</a> = 1e-14</td></tr>
<tr class="separator:a51590c7ed1bfde325c737b27521802cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae99214dc6edc2f4911426858fff3580e" id="r_ae99214dc6edc2f4911426858fff3580e"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#ae99214dc6edc2f4911426858fff3580e">tie_case_1</a></td></tr>
<tr class="separator:ae99214dc6edc2f4911426858fff3580e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c0e7d5d94e20198d6877829ad37fbbb" id="r_a5c0e7d5d94e20198d6877829ad37fbbb"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a5c0e7d5d94e20198d6877829ad37fbbb">tie_case_2</a></td></tr>
<tr class="separator:a5c0e7d5d94e20198d6877829ad37fbbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a92c967adabc692de67dd4ed1b4dd4" id="r_a75a92c967adabc692de67dd4ed1b4dd4"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html#a75a92c967adabc692de67dd4ed1b4dd4">batch_generator_cases</a></td></tr>
<tr class="separator:a75a92c967adabc692de67dd4ed1b4dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad05c473fa20f8d928a81afc05f192535" name="ad05c473fa20f8d928a81afc05f192535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad05c473fa20f8d928a81afc05f192535">&#9670;&#160;</a></span>test_against_ansari()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_ansari </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1029</span>    <span class="keyword">def </span>test_against_ansari(self, alternative):</div>
<div class="line"><span class="lineno"> 1030</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1031</span>        x = stats.norm.rvs(size=4, scale=1)</div>
<div class="line"><span class="lineno"> 1032</span>        y = stats.norm.rvs(size=5, scale=3)</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>        <span class="comment"># ansari has a different convention for &#39;alternative&#39;</span></div>
<div class="line"><span class="lineno"> 1035</span>        alternative_correspondence = {<span class="stringliteral">&quot;less&quot;</span>: <span class="stringliteral">&quot;greater&quot;</span>,</div>
<div class="line"><span class="lineno"> 1036</span>                                      <span class="stringliteral">&quot;greater&quot;</span>: <span class="stringliteral">&quot;less&quot;</span>,</div>
<div class="line"><span class="lineno"> 1037</span>                                      <span class="stringliteral">&quot;two-sided&quot;</span>: <span class="stringliteral">&quot;two-sided&quot;</span>}</div>
<div class="line"><span class="lineno"> 1038</span>        alternative_scipy = alternative_correspondence[alternative]</div>
<div class="line"><span class="lineno"> 1039</span>        expected = stats.ansari(x, y, alternative=alternative_scipy)</div>
<div class="line"><span class="lineno"> 1040</span> </div>
<div class="line"><span class="lineno"> 1041</span>        <span class="keyword">def </span>statistic1d(x, y):</div>
<div class="line"><span class="lineno"> 1042</span>            <span class="keywordflow">return</span> stats.ansari(x, y).statistic</div>
<div class="line"><span class="lineno"> 1043</span> </div>
<div class="line"><span class="lineno"> 1044</span>        res = permutation_test((x, y), statistic1d, n_resamples=np.inf,</div>
<div class="line"><span class="lineno"> 1045</span>                               alternative=alternative)</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>        assert_allclose(res.statistic, expected.statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1048</span>        assert_allclose(res.pvalue, expected.pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1049</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aff2790420c7650e0aa6a9eace21ec126" name="aff2790420c7650e0aa6a9eace21ec126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff2790420c7650e0aa6a9eace21ec126">&#9670;&#160;</a></span>test_against_binomtest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_binomtest </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1175</span>    <span class="keyword">def </span>test_against_binomtest(self, alternative):</div>
<div class="line"><span class="lineno"> 1176</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1177</span>        x = np.random.randint(0, 2, size=10)</div>
<div class="line"><span class="lineno"> 1178</span>        x[x == 0] = -1</div>
<div class="line"><span class="lineno"> 1179</span>        <span class="comment"># More naturally, the test would flip elements between 0 and one.</span></div>
<div class="line"><span class="lineno"> 1180</span>        <span class="comment"># However, permutation_test will flip the _signs_ of the elements.</span></div>
<div class="line"><span class="lineno"> 1181</span>        <span class="comment"># So we have to work with +1/-1 instead of 1/0.</span></div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>        <span class="keyword">def </span>statistic(x, axis=0):</div>
<div class="line"><span class="lineno"> 1184</span>            <span class="keywordflow">return</span> np.sum(x &gt; 0, axis=axis)</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>        k, n, p = statistic(x), 10, 0.5</div>
<div class="line"><span class="lineno"> 1187</span>        expected = stats.binomtest(k, n, p, alternative=alternative)</div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span>        res = stats.permutation_test((x,), statistic, vectorized=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1190</span>                                     permutation_type=<span class="stringliteral">&#39;samples&#39;</span>,</div>
<div class="line"><span class="lineno"> 1191</span>                                     n_resamples=np.inf,</div>
<div class="line"><span class="lineno"> 1192</span>                                     alternative=alternative)</div>
<div class="line"><span class="lineno"> 1193</span>        assert_allclose(res.pvalue, expected.pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1194</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afedb0a2f7fd8e591dd1d98b014bdc085" name="afedb0a2f7fd8e591dd1d98b014bdc085"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afedb0a2f7fd8e591dd1d98b014bdc085">&#9670;&#160;</a></span>test_against_cvm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_cvm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1068</span>    <span class="keyword">def </span>test_against_cvm(self):</div>
<div class="line"><span class="lineno"> 1069</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1070</span>        x = stats.norm.rvs(size=4, scale=1)</div>
<div class="line"><span class="lineno"> 1071</span>        y = stats.norm.rvs(size=5, loc=3, scale=3)</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>        expected = stats.cramervonmises_2samp(x, y, method=<span class="stringliteral">&#39;exact&#39;</span>)</div>
<div class="line"><span class="lineno"> 1074</span> </div>
<div class="line"><span class="lineno"> 1075</span>        <span class="keyword">def </span>statistic1d(x, y):</div>
<div class="line"><span class="lineno"> 1076</span>            <span class="keywordflow">return</span> stats.cramervonmises_2samp(x, y,</div>
<div class="line"><span class="lineno"> 1077</span>                                              method=<span class="stringliteral">&#39;asymptotic&#39;</span>).statistic</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>        <span class="comment"># cramervonmises_2samp has only one alternative, greater</span></div>
<div class="line"><span class="lineno"> 1080</span>        res = permutation_test((x, y), statistic1d, n_resamples=np.inf,</div>
<div class="line"><span class="lineno"> 1081</span>                               alternative=<span class="stringliteral">&#39;greater&#39;</span>)</div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span>        assert_allclose(res.statistic, expected.statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1084</span>        assert_allclose(res.pvalue, expected.pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1085</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6ec58c6595ea0dedbb16de2b9c3e0ee" name="aa6ec58c6595ea0dedbb16de2b9c3e0ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6ec58c6595ea0dedbb16de2b9c3e0ee">&#9670;&#160;</a></span>test_against_fisher_exact()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_fisher_exact </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1215</span>    <span class="keyword">def </span>test_against_fisher_exact(self, alternative):</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>        <span class="keyword">def </span>statistic(x,):</div>
<div class="line"><span class="lineno"> 1218</span>            <span class="keywordflow">return</span> np.sum((x == 1) &amp; (y == 1))</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1221</span>        <span class="comment"># x and y are binary random variables with some dependence</span></div>
<div class="line"><span class="lineno"> 1222</span>        x = (np.random.rand(7) &gt; 0.6).astype(float)</div>
<div class="line"><span class="lineno"> 1223</span>        y = (np.random.rand(7) + 0.25*x &gt; 0.6).astype(float)</div>
<div class="line"><span class="lineno"> 1224</span>        tab = stats.contingency.crosstab(x, y)[1]</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>        res = permutation_test((x,), statistic, permutation_type=<span class="stringliteral">&#39;pairings&#39;</span>,</div>
<div class="line"><span class="lineno"> 1227</span>                               n_resamples=np.inf, alternative=alternative)</div>
<div class="line"><span class="lineno"> 1228</span>        res2 = stats.fisher_exact(tab, alternative=alternative)</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>        assert_allclose(res.pvalue, res2[1])</div>
<div class="line"><span class="lineno"> 1231</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a243868996a44797dd73402c690fe3259" name="a243868996a44797dd73402c690fe3259"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a243868996a44797dd73402c690fe3259">&#9670;&#160;</a></span>test_against_kendalltau()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_kendalltau </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1197</span>    <span class="keyword">def </span>test_against_kendalltau(self):</div>
<div class="line"><span class="lineno"> 1198</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1199</span>        x = stats.norm.rvs(size=6)</div>
<div class="line"><span class="lineno"> 1200</span>        y = x + stats.norm.rvs(size=6)</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>        expected = stats.kendalltau(x, y, method=<span class="stringliteral">&#39;exact&#39;</span>)</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>        <span class="keyword">def </span>statistic1d(x):</div>
<div class="line"><span class="lineno"> 1205</span>            <span class="keywordflow">return</span> stats.kendalltau(x, y, method=<span class="stringliteral">&#39;asymptotic&#39;</span>).correlation</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>        <span class="comment"># kendalltau currently has only one alternative, two-sided</span></div>
<div class="line"><span class="lineno"> 1208</span>        res = permutation_test((x,), statistic1d, permutation_type=<span class="stringliteral">&#39;pairings&#39;</span>,</div>
<div class="line"><span class="lineno"> 1209</span>                               n_resamples=np.inf)</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>        assert_allclose(res.statistic, expected.correlation, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1212</span>        assert_allclose(res.pvalue, expected.pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1213</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1cc10f00726b184ae0d37083962bb2ed" name="a1cc10f00726b184ae0d37083962bb2ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc10f00726b184ae0d37083962bb2ed">&#9670;&#160;</a></span>test_against_kstest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_kstest </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1010</span>    <span class="keyword">def </span>test_against_kstest(self):</div>
<div class="line"><span class="lineno"> 1011</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1012</span>        x = stats.norm.rvs(size=4, scale=1)</div>
<div class="line"><span class="lineno"> 1013</span>        y = stats.norm.rvs(size=5, loc=3, scale=3)</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>        alternative = <span class="stringliteral">&#39;greater&#39;</span></div>
<div class="line"><span class="lineno"> 1016</span>        expected = stats.ks_2samp(x, y, alternative=alternative, mode=<span class="stringliteral">&#39;exact&#39;</span>)</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>        <span class="keyword">def </span>statistic1d(x, y):</div>
<div class="line"><span class="lineno"> 1019</span>            <span class="keywordflow">return</span> stats.ks_2samp(x, y, mode=<span class="stringliteral">&#39;asymp&#39;</span>,</div>
<div class="line"><span class="lineno"> 1020</span>                                  alternative=alternative).statistic</div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span>        res = permutation_test((x, y), statistic1d, n_resamples=np.inf,</div>
<div class="line"><span class="lineno"> 1023</span>                               alternative=alternative)</div>
<div class="line"><span class="lineno"> 1024</span> </div>
<div class="line"><span class="lineno"> 1025</span>        assert_allclose(res.statistic, expected.statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1026</span>        assert_allclose(res.pvalue, expected.pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1027</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abde7fc133644e526ab2e7a6c26fc2a08" name="abde7fc133644e526ab2e7a6c26fc2a08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abde7fc133644e526ab2e7a6c26fc2a08">&#9670;&#160;</a></span>test_against_mannwhitneyu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_mannwhitneyu </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1051</span>    <span class="keyword">def </span>test_against_mannwhitneyu(self, alternative):</div>
<div class="line"><span class="lineno"> 1052</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1053</span>        x = stats.uniform.rvs(size=(3, 5, 2), loc=0)</div>
<div class="line"><span class="lineno"> 1054</span>        y = stats.uniform.rvs(size=(3, 5, 2), loc=0.05)</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>        expected = stats.mannwhitneyu(x, y, axis=1, alternative=alternative)</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>        <span class="keyword">def </span>statistic(x, y, axis):</div>
<div class="line"><span class="lineno"> 1059</span>            <span class="keywordflow">return</span> stats.mannwhitneyu(x, y, axis=axis).statistic</div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>        res = permutation_test((x, y), statistic, vectorized=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1062</span>                               n_resamples=np.inf, alternative=alternative,</div>
<div class="line"><span class="lineno"> 1063</span>                               axis=1)</div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span>        assert_allclose(res.statistic, expected.statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1066</span>        assert_allclose(res.pvalue, expected.pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1067</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a24cf502c080b8c6395fbe115a56a7044" name="a24cf502c080b8c6395fbe115a56a7044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24cf502c080b8c6395fbe115a56a7044">&#9670;&#160;</a></span>test_against_permutation_ttest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_permutation_ttest </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>permutations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  987</span>    <span class="keyword">def </span>test_against_permutation_ttest(self, alternative, permutations, axis):</div>
<div class="line"><span class="lineno">  988</span>        <span class="comment"># check that this function and ttest_ind with permutations give</span></div>
<div class="line"><span class="lineno">  989</span>        <span class="comment"># essentially identical results.</span></div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>        x = np.arange(3*4*5).reshape(3, 4, 5)</div>
<div class="line"><span class="lineno">  992</span>        y = np.moveaxis(np.arange(4)[:, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>], 0, axis)</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>        res1 = stats.ttest_ind(x, y, permutations=permutations, axis=axis,</div>
<div class="line"><span class="lineno">  995</span>                               random_state=0, alternative=alternative)</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>        <span class="keyword">def </span>statistic(x, y, axis):</div>
<div class="line"><span class="lineno">  998</span>            <span class="keywordflow">return</span> stats.ttest_ind(x, y, axis=axis).statistic</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>        res2 = permutation_test((x, y), statistic, vectorized=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1001</span>                                n_resamples=permutations,</div>
<div class="line"><span class="lineno"> 1002</span>                                alternative=alternative, axis=axis,</div>
<div class="line"><span class="lineno"> 1003</span>                                random_state=0)</div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>        assert_allclose(res1.statistic, res2.statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1006</span>        assert_allclose(res1.pvalue, res2.pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1007</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0237f2bda9c7bfb7ca8a0e3a328933a3" name="a0237f2bda9c7bfb7ca8a0e3a328933a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0237f2bda9c7bfb7ca8a0e3a328933a3">&#9670;&#160;</a></span>test_against_spearmanr_in_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_spearmanr_in_R </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_pvalue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Results above from R cor.test, e.g.

options(digits=16)
x &lt;- c(1.76405235, 0.40015721, 0.97873798,
       2.2408932, 1.86755799, -0.97727788)
y &lt;- c(2.71414076, 0.2488, 0.87551913,
       2.6514917, 2.01160156, 0.47699563)
cor.test(x, y, method = "spearm", alternative = "t")
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1358</span>    <span class="keyword">def </span>test_against_spearmanr_in_R(self, alternative, expected_pvalue):</div>
<div class="line"><span class="lineno"> 1359</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1360</span><span class="stringliteral">        Results above from R cor.test, e.g.</span></div>
<div class="line"><span class="lineno"> 1361</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1362</span><span class="stringliteral">        options(digits=16)</span></div>
<div class="line"><span class="lineno"> 1363</span><span class="stringliteral">        x &lt;- c(1.76405235, 0.40015721, 0.97873798,</span></div>
<div class="line"><span class="lineno"> 1364</span><span class="stringliteral">               2.2408932, 1.86755799, -0.97727788)</span></div>
<div class="line"><span class="lineno"> 1365</span><span class="stringliteral">        y &lt;- c(2.71414076, 0.2488, 0.87551913,</span></div>
<div class="line"><span class="lineno"> 1366</span><span class="stringliteral">               2.6514917, 2.01160156, 0.47699563)</span></div>
<div class="line"><span class="lineno"> 1367</span><span class="stringliteral">        cor.test(x, y, method = &quot;spearm&quot;, alternative = &quot;t&quot;)</span></div>
<div class="line"><span class="lineno"> 1368</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1369</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1370</span>        x = stats.norm.rvs(size=6)</div>
<div class="line"><span class="lineno"> 1371</span>        y = x + stats.norm.rvs(size=6)</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>        expected_statistic = 0.7714285714285715</div>
<div class="line"><span class="lineno"> 1374</span> </div>
<div class="line"><span class="lineno"> 1375</span>        <span class="keyword">def </span>statistic1d(x):</div>
<div class="line"><span class="lineno"> 1376</span>            <span class="keywordflow">return</span> stats.spearmanr(x, y).correlation</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>        res = permutation_test((x,), statistic1d, permutation_type=<span class="stringliteral">&#39;pairings&#39;</span>,</div>
<div class="line"><span class="lineno"> 1379</span>                               n_resamples=np.inf, alternative=alternative)</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span>        assert_allclose(res.statistic, expected_statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1382</span>        assert_allclose(res.pvalue, expected_pvalue, atol=1e-13)</div>
<div class="line"><span class="lineno"> 1383</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7fbec6f79a96026f34c57b59b9f25ee" name="ae7fbec6f79a96026f34c57b59b9f25ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7fbec6f79a96026f34c57b59b9f25ee">&#9670;&#160;</a></span>test_against_wilcoxon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_against_wilcoxon </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1135</span>    <span class="keyword">def </span>test_against_wilcoxon(self, alternative):</div>
<div class="line"><span class="lineno"> 1136</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1137</span>        x = stats.uniform.rvs(size=(3, 6, 2), loc=0)</div>
<div class="line"><span class="lineno"> 1138</span>        y = stats.uniform.rvs(size=(3, 6, 2), loc=0.05)</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>        <span class="comment"># We&#39;ll check both 1- and 2-sample versions of the same test;</span></div>
<div class="line"><span class="lineno"> 1141</span>        <span class="comment"># we expect identical results to wilcoxon in all cases.</span></div>
<div class="line"><span class="lineno"> 1142</span>        <span class="keyword">def </span>statistic_1samp_1d(z):</div>
<div class="line"><span class="lineno"> 1143</span>            <span class="comment"># &#39;less&#39; ensures we get the same of two statistics every time</span></div>
<div class="line"><span class="lineno"> 1144</span>            <span class="keywordflow">return</span> stats.wilcoxon(z, alternative=<span class="stringliteral">&#39;less&#39;</span>).statistic</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>        <span class="keyword">def </span>statistic_2samp_1d(x, y):</div>
<div class="line"><span class="lineno"> 1147</span>            <span class="keywordflow">return</span> stats.wilcoxon(x, y, alternative=<span class="stringliteral">&#39;less&#39;</span>).statistic</div>
<div class="line"><span class="lineno"> 1148</span> </div>
<div class="line"><span class="lineno"> 1149</span>        <span class="keyword">def </span>test_1d(x, y):</div>
<div class="line"><span class="lineno"> 1150</span>            <span class="keywordflow">return</span> stats.wilcoxon(x, y, alternative=alternative)</div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span>        test = _resampling._vectorize_statistic(test_1d)</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>        expected = <a class="code hl_namespace" href="namespacetest.html">test</a>(x, y, axis=1)</div>
<div class="line"><span class="lineno"> 1155</span>        expected_stat = expected[0]</div>
<div class="line"><span class="lineno"> 1156</span>        expected_p = expected[1]</div>
<div class="line"><span class="lineno"> 1157</span> </div>
<div class="line"><span class="lineno"> 1158</span>        res1 = permutation_test((x-y,), statistic_1samp_1d, vectorized=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1159</span>                                permutation_type=<span class="stringliteral">&#39;samples&#39;</span>, n_resamples=np.inf,</div>
<div class="line"><span class="lineno"> 1160</span>                                alternative=alternative, axis=1)</div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span>        res2 = permutation_test((x, y), statistic_2samp_1d, vectorized=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1163</span>                                permutation_type=<span class="stringliteral">&#39;samples&#39;</span>, n_resamples=np.inf,</div>
<div class="line"><span class="lineno"> 1164</span>                                alternative=alternative, axis=1)</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>        <span class="comment"># `wilcoxon` returns a different statistic with &#39;two-sided&#39;</span></div>
<div class="line"><span class="lineno"> 1167</span>        assert_allclose(res1.statistic, res2.statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1168</span>        <span class="keywordflow">if</span> alternative != <span class="stringliteral">&#39;two-sided&#39;</span>:</div>
<div class="line"><span class="lineno"> 1169</span>            assert_allclose(res2.statistic, expected_stat, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1170</span> </div>
<div class="line"><span class="lineno"> 1171</span>        assert_allclose(res2.pvalue, expected_p, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1172</span>        assert_allclose(res1.pvalue, res2.pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="ttc" id="anamespacetest_html"><div class="ttname"><a href="namespacetest.html">test</a></div><div class="ttdef"><b>Definition</b> gh18403_mod.f90:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a48e5ac34e42c42beb40be52304ae0f82" name="a48e5ac34e42c42beb40be52304ae0f82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48e5ac34e42c42beb40be52304ae0f82">&#9670;&#160;</a></span>test_batch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_batch </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>permutation_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  835</span>    <span class="keyword">def </span>test_batch(self, permutation_type):</div>
<div class="line"><span class="lineno">  836</span>        <span class="comment"># make sure that the `batch` parameter is respected by checking the</span></div>
<div class="line"><span class="lineno">  837</span>        <span class="comment"># maximum batch size provided in calls to `statistic`</span></div>
<div class="line"><span class="lineno">  838</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno">  839</span>        x = np.random.rand(10)</div>
<div class="line"><span class="lineno">  840</span>        y = np.random.rand(10)</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>        <span class="keyword">def </span>statistic(x, y, axis):</div>
<div class="line"><span class="lineno">  843</span>            batch_size = 1 <span class="keywordflow">if</span> x.ndim == 1 <span class="keywordflow">else</span> len(x)</div>
<div class="line"><span class="lineno">  844</span>            statistic.batch_size = max(batch_size, statistic.batch_size)</div>
<div class="line"><span class="lineno">  845</span>            statistic.counter += 1</div>
<div class="line"><span class="lineno">  846</span>            <span class="keywordflow">return</span> np.mean(x, axis=axis) - np.mean(y, axis=axis)</div>
<div class="line"><span class="lineno">  847</span>        statistic.counter = 0</div>
<div class="line"><span class="lineno">  848</span>        statistic.batch_size = 0</div>
<div class="line"><span class="lineno">  849</span> </div>
<div class="line"><span class="lineno">  850</span>        kwds = {<span class="stringliteral">&#39;n_resamples&#39;</span>: 1000, <span class="stringliteral">&#39;permutation_type&#39;</span>: permutation_type,</div>
<div class="line"><span class="lineno">  851</span>                <span class="stringliteral">&#39;vectorized&#39;</span>: <span class="keyword">True</span>, <span class="stringliteral">&#39;random_state&#39;</span>: 0}</div>
<div class="line"><span class="lineno">  852</span>        res1 = stats.permutation_test((x, y), statistic, batch=1, **kwds)</div>
<div class="line"><span class="lineno">  853</span>        assert_equal(statistic.counter, 1001)</div>
<div class="line"><span class="lineno">  854</span>        assert_equal(statistic.batch_size, 1)</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>        statistic.counter = 0</div>
<div class="line"><span class="lineno">  857</span>        res2 = stats.permutation_test((x, y), statistic, batch=50, **kwds)</div>
<div class="line"><span class="lineno">  858</span>        assert_equal(statistic.counter, 21)</div>
<div class="line"><span class="lineno">  859</span>        assert_equal(statistic.batch_size, 50)</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>        statistic.counter = 0</div>
<div class="line"><span class="lineno">  862</span>        res3 = stats.permutation_test((x, y), statistic, batch=1000, **kwds)</div>
<div class="line"><span class="lineno">  863</span>        assert_equal(statistic.counter, 2)</div>
<div class="line"><span class="lineno">  864</span>        assert_equal(statistic.batch_size, 1000)</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>        assert_equal(res1.pvalue, res3.pvalue)</div>
<div class="line"><span class="lineno">  867</span>        assert_equal(res2.pvalue, res3.pvalue)</div>
<div class="line"><span class="lineno">  868</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a36288b38d973bdc1d38030eccb5f5fa8" name="a36288b38d973bdc1d38030eccb5f5fa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36288b38d973bdc1d38030eccb5f5fa8">&#9670;&#160;</a></span>test_batch_generator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_batch_generator </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1395</span>    <span class="keyword">def </span>test_batch_generator(self, iterable, batch, expected):</div>
<div class="line"><span class="lineno"> 1396</span>        got = list(_resampling._batch_generator(iterable, batch))</div>
<div class="line"><span class="lineno"> 1397</span>        <span class="keyword">assert</span> got == expected</div>
<div class="line"><span class="lineno"> 1398</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad79574c3e1a088665969cb999ad9a0a4" name="ad79574c3e1a088665969cb999ad9a0a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad79574c3e1a088665969cb999ad9a0a4">&#9670;&#160;</a></span>test_batch_generator_iv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_batch_generator_iv </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1385</span>    <span class="keyword">def </span>test_batch_generator_iv(self, batch):</div>
<div class="line"><span class="lineno"> 1386</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;`batch` must be positive.&quot;</span>):</div>
<div class="line"><span class="lineno"> 1387</span>            list(_resampling._batch_generator([1, 2, 3], batch))</div>
<div class="line"><span class="lineno"> 1388</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8abd46a7594588bd066f977f52872fd" name="ad8abd46a7594588bd066f977f52872fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8abd46a7594588bd066f977f52872fd">&#9670;&#160;</a></span>test_finite_precision_statistic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_finite_precision_statistic </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1399</span>    <span class="keyword">def </span>test_finite_precision_statistic(self):</div>
<div class="line"><span class="lineno"> 1400</span>        <span class="comment"># Some statistics return numerically distinct values when the values</span></div>
<div class="line"><span class="lineno"> 1401</span>        <span class="comment"># should be equal in theory. Test that `permutation_test` accounts</span></div>
<div class="line"><span class="lineno"> 1402</span>        <span class="comment"># for this in some way.</span></div>
<div class="line"><span class="lineno"> 1403</span>        x = [1, 2, 4, 3]</div>
<div class="line"><span class="lineno"> 1404</span>        y = [2, 4, 6, 8]</div>
<div class="line"><span class="lineno"> 1405</span> </div>
<div class="line"><span class="lineno"> 1406</span>        <span class="keyword">def </span>statistic(x, y):</div>
<div class="line"><span class="lineno"> 1407</span>            <span class="keywordflow">return</span> stats.pearsonr(x, y)[0]</div>
<div class="line"><span class="lineno"> 1408</span> </div>
<div class="line"><span class="lineno"> 1409</span>        res = stats.permutation_test((x, y), statistic, vectorized=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1410</span>                                     permutation_type=<span class="stringliteral">&#39;pairings&#39;</span>)</div>
<div class="line"><span class="lineno"> 1411</span>        r, pvalue, null = res.statistic, res.pvalue, res.null_distribution</div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span>        correct_p = 2 * np.sum(null &gt;= r - 1e-14) / len(null)</div>
<div class="line"><span class="lineno"> 1414</span>        <span class="keyword">assert</span> pvalue == correct_p == 1/3</div>
<div class="line"><span class="lineno"> 1415</span>        <span class="comment"># Compare against other exact correlation tests using R corr.test</span></div>
<div class="line"><span class="lineno"> 1416</span>        <span class="comment"># options(digits=16)</span></div>
<div class="line"><span class="lineno"> 1417</span>        <span class="comment"># x = c(1, 2, 4, 3)</span></div>
<div class="line"><span class="lineno"> 1418</span>        <span class="comment"># y = c(2, 4, 6, 8)</span></div>
<div class="line"><span class="lineno"> 1419</span>        <span class="comment"># cor.test(x, y, alternative = &quot;t&quot;, method = &quot;spearman&quot;)  # 0.333333333</span></div>
<div class="line"><span class="lineno"> 1420</span>        <span class="comment"># cor.test(x, y, alternative = &quot;t&quot;, method = &quot;kendall&quot;)  # 0.333333333</span></div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a79bd832ff9722c44dcfa89d2a376a059" name="a79bd832ff9722c44dcfa89d2a376a059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79bd832ff9722c44dcfa89d2a376a059">&#9670;&#160;</a></span>test_permutation_test_iv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_permutation_test_iv </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  779</span>    <span class="keyword">def </span>test_permutation_test_iv(self):</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>        <span class="keyword">def </span>stat(x, y, axis):</div>
<div class="line"><span class="lineno">  782</span>            <span class="keywordflow">return</span> stats.ttest_ind((x, y), axis).statistic</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>        message = <span class="stringliteral">&quot;each sample in `data` must contain two or more ...&quot;</span></div>
<div class="line"><span class="lineno">  785</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  786</span>            permutation_test(([1, 2, 3], [1]), stat)</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>        message = <span class="stringliteral">&quot;`data` must be a tuple containing at least two samples&quot;</span></div>
<div class="line"><span class="lineno">  789</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  790</span>            permutation_test((1,), stat)</div>
<div class="line"><span class="lineno">  791</span>        <span class="keyword">with</span> pytest.raises(TypeError, match=message):</div>
<div class="line"><span class="lineno">  792</span>            permutation_test(1, stat)</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>        message = <span class="stringliteral">&quot;`axis` must be an integer.&quot;</span></div>
<div class="line"><span class="lineno">  795</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  796</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat, axis=1.5)</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>        message = <span class="stringliteral">&quot;`permutation_type` must be in...&quot;</span></div>
<div class="line"><span class="lineno">  799</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  800</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat,</div>
<div class="line"><span class="lineno">  801</span>                             permutation_type=<span class="stringliteral">&quot;ekki&quot;</span>)</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>        message = <span class="stringliteral">&quot;`vectorized` must be `True` or `False`.&quot;</span></div>
<div class="line"><span class="lineno">  804</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  805</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat, vectorized=1.5)</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>        message = <span class="stringliteral">&quot;`n_resamples` must be a positive integer.&quot;</span></div>
<div class="line"><span class="lineno">  808</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  809</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat, n_resamples=-1000)</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>        message = <span class="stringliteral">&quot;`n_resamples` must be a positive integer.&quot;</span></div>
<div class="line"><span class="lineno">  812</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  813</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat, n_resamples=1000.5)</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>        message = <span class="stringliteral">&quot;`batch` must be a positive integer or None.&quot;</span></div>
<div class="line"><span class="lineno">  816</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  817</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat, batch=-1000)</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>        message = <span class="stringliteral">&quot;`batch` must be a positive integer or None.&quot;</span></div>
<div class="line"><span class="lineno">  820</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  821</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat, batch=1000.5)</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>        message = <span class="stringliteral">&quot;`alternative` must be in...&quot;</span></div>
<div class="line"><span class="lineno">  824</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  825</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat, alternative=<span class="stringliteral">&#39;ekki&#39;</span>)</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>        message = <span class="stringliteral">&quot;&#39;herring&#39; cannot be used to seed a&quot;</span></div>
<div class="line"><span class="lineno">  828</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">  829</span>            permutation_test(([1, 2, 3], [1, 2, 3]), stat,</div>
<div class="line"><span class="lineno">  830</span>                             random_state=<span class="stringliteral">&#39;herring&#39;</span>)</div>
<div class="line"><span class="lineno">  831</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d1a35cba63d12bed007dabfc3a08235" name="a3d1a35cba63d12bed007dabfc3a08235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d1a35cba63d12bed007dabfc3a08235">&#9670;&#160;</a></span>test_permutations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_permutations </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>permutation_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exact_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  873</span>    <span class="keyword">def </span>test_permutations(self, permutation_type, exact_size):</div>
<div class="line"><span class="lineno">  874</span>        <span class="comment"># make sure that the `permutations` parameter is respected by checking</span></div>
<div class="line"><span class="lineno">  875</span>        <span class="comment"># the size of the null distribution</span></div>
<div class="line"><span class="lineno">  876</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno">  877</span>        x = np.random.rand(3)</div>
<div class="line"><span class="lineno">  878</span>        y = np.random.rand(3)</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>        <span class="keyword">def </span>statistic(x, y, axis):</div>
<div class="line"><span class="lineno">  881</span>            <span class="keywordflow">return</span> np.mean(x, axis=axis) - np.mean(y, axis=axis)</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>        kwds = {<span class="stringliteral">&#39;permutation_type&#39;</span>: permutation_type,</div>
<div class="line"><span class="lineno">  884</span>                <span class="stringliteral">&#39;vectorized&#39;</span>: <span class="keyword">True</span>, <span class="stringliteral">&#39;random_state&#39;</span>: 0}</div>
<div class="line"><span class="lineno">  885</span>        res = stats.permutation_test((x, y), statistic, n_resamples=3, **kwds)</div>
<div class="line"><span class="lineno">  886</span>        assert_equal(res.null_distribution.size, 3)</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>        res = stats.permutation_test((x, y), statistic, **kwds)</div>
<div class="line"><span class="lineno">  889</span>        assert_equal(res.null_distribution.size, exact_size)</div>
<div class="line"><span class="lineno">  890</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a244e5b825ec4c991ea9ec69445526fc0" name="a244e5b825ec4c991ea9ec69445526fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a244e5b825ec4c991ea9ec69445526fc0">&#9670;&#160;</a></span>test_randomized_test_against_exact_both()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_randomized_test_against_exact_both </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  899</span>    <span class="keyword">def </span>test_randomized_test_against_exact_both(self):</div>
<div class="line"><span class="lineno">  900</span>        <span class="comment"># check that the randomized and exact tests agree to reasonable</span></div>
<div class="line"><span class="lineno">  901</span>        <span class="comment"># precision for permutation_type=&#39;both</span></div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>        alternative, rng = <span class="stringliteral">&#39;less&#39;</span>, 0</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>        nx, ny, permutations = 8, 9, 24000</div>
<div class="line"><span class="lineno">  906</span>        <span class="keyword">assert</span> special.binom(nx + ny, nx) &gt; permutations</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>        x = stats.norm.rvs(size=nx)</div>
<div class="line"><span class="lineno">  909</span>        y = stats.norm.rvs(size=ny)</div>
<div class="line"><span class="lineno">  910</span>        data = x, y</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>        <span class="keyword">def </span>statistic(x, y, axis):</div>
<div class="line"><span class="lineno">  913</span>            <span class="keywordflow">return</span> np.mean(x, axis=axis) - np.mean(y, axis=axis)</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>        kwds = {<span class="stringliteral">&#39;vectorized&#39;</span>: <span class="keyword">True</span>, <span class="stringliteral">&#39;permutation_type&#39;</span>: <span class="stringliteral">&#39;independent&#39;</span>,</div>
<div class="line"><span class="lineno">  916</span>                <span class="stringliteral">&#39;batch&#39;</span>: 100, <span class="stringliteral">&#39;alternative&#39;</span>: alternative, <span class="stringliteral">&#39;random_state&#39;</span>: rng}</div>
<div class="line"><span class="lineno">  917</span>        res = permutation_test(data, statistic, n_resamples=permutations,</div>
<div class="line"><span class="lineno">  918</span>                               **kwds)</div>
<div class="line"><span class="lineno">  919</span>        res2 = permutation_test(data, statistic, n_resamples=np.inf, **kwds)</div>
<div class="line"><span class="lineno">  920</span> </div>
<div class="line"><span class="lineno">  921</span>        <span class="keyword">assert</span> res.statistic == res2.statistic</div>
<div class="line"><span class="lineno">  922</span>        assert_allclose(res.pvalue, res2.pvalue, atol=1e-2)</div>
<div class="line"><span class="lineno">  923</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acb10b09dfd299dbdfaf0233740d22c0c" name="acb10b09dfd299dbdfaf0233740d22c0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb10b09dfd299dbdfaf0233740d22c0c">&#9670;&#160;</a></span>test_randomized_test_against_exact_pairings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_randomized_test_against_exact_pairings </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  950</span>    <span class="keyword">def </span>test_randomized_test_against_exact_pairings(self):</div>
<div class="line"><span class="lineno">  951</span>        <span class="comment"># check that the randomized and exact tests agree to reasonable</span></div>
<div class="line"><span class="lineno">  952</span>        <span class="comment"># precision for permutation_type=&#39;pairings&#39;</span></div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span>        alternative = <span class="stringliteral">&#39;two-sided&#39;</span></div>
<div class="line"><span class="lineno">  955</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  956</span>            rng = np.random.default_rng(1)</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordflow">except</span> AttributeError:</div>
<div class="line"><span class="lineno">  958</span>            rng = np.random.RandomState(1)</div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>        nx, ny, permutations = 8, 8, 40000</div>
<div class="line"><span class="lineno">  961</span>        <span class="keyword">assert</span> special.factorial(nx) &gt; permutations</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span>        x = stats.norm.rvs(size=nx)</div>
<div class="line"><span class="lineno">  964</span>        y = stats.norm.rvs(size=ny)</div>
<div class="line"><span class="lineno">  965</span>        data = [x]</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>        <span class="keyword">def </span>statistic1d(x):</div>
<div class="line"><span class="lineno">  968</span>            <span class="keywordflow">return</span> stats.pearsonr(x, y)[0]</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>        statistic = _resampling._vectorize_statistic(statistic1d)</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>        kwds = {<span class="stringliteral">&#39;vectorized&#39;</span>: <span class="keyword">True</span>, <span class="stringliteral">&#39;permutation_type&#39;</span>: <span class="stringliteral">&#39;samples&#39;</span>,</div>
<div class="line"><span class="lineno">  973</span>                <span class="stringliteral">&#39;batch&#39;</span>: 100, <span class="stringliteral">&#39;alternative&#39;</span>: alternative, <span class="stringliteral">&#39;random_state&#39;</span>: rng}</div>
<div class="line"><span class="lineno">  974</span>        res = permutation_test(data, statistic, n_resamples=permutations,</div>
<div class="line"><span class="lineno">  975</span>                               **kwds)</div>
<div class="line"><span class="lineno">  976</span>        res2 = permutation_test(data, statistic, n_resamples=np.inf, **kwds)</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>        <span class="keyword">assert</span> res.statistic == res2.statistic</div>
<div class="line"><span class="lineno">  979</span>        assert_allclose(res.pvalue, res2.pvalue, atol=1e-2)</div>
<div class="line"><span class="lineno">  980</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af4e590d16451fb332e6a4ed46a5c4562" name="af4e590d16451fb332e6a4ed46a5c4562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4e590d16451fb332e6a4ed46a5c4562">&#9670;&#160;</a></span>test_randomized_test_against_exact_samples()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_randomized_test_against_exact_samples </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  925</span>    <span class="keyword">def </span>test_randomized_test_against_exact_samples(self):</div>
<div class="line"><span class="lineno">  926</span>        <span class="comment"># check that the randomized and exact tests agree to reasonable</span></div>
<div class="line"><span class="lineno">  927</span>        <span class="comment"># precision for permutation_type=&#39;samples&#39;</span></div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>        alternative, rng = <span class="stringliteral">&#39;greater&#39;</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>        nx, ny, permutations = 15, 15, 32000</div>
<div class="line"><span class="lineno">  932</span>        <span class="keyword">assert</span> 2**nx &gt; permutations</div>
<div class="line"><span class="lineno">  933</span> </div>
<div class="line"><span class="lineno">  934</span>        x = stats.norm.rvs(size=nx)</div>
<div class="line"><span class="lineno">  935</span>        y = stats.norm.rvs(size=ny)</div>
<div class="line"><span class="lineno">  936</span>        data = x, y</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>        <span class="keyword">def </span>statistic(x, y, axis):</div>
<div class="line"><span class="lineno">  939</span>            <span class="keywordflow">return</span> np.mean(x - y, axis=axis)</div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span>        kwds = {<span class="stringliteral">&#39;vectorized&#39;</span>: <span class="keyword">True</span>, <span class="stringliteral">&#39;permutation_type&#39;</span>: <span class="stringliteral">&#39;samples&#39;</span>,</div>
<div class="line"><span class="lineno">  942</span>                <span class="stringliteral">&#39;batch&#39;</span>: 100, <span class="stringliteral">&#39;alternative&#39;</span>: alternative, <span class="stringliteral">&#39;random_state&#39;</span>: rng}</div>
<div class="line"><span class="lineno">  943</span>        res = permutation_test(data, statistic, n_resamples=permutations,</div>
<div class="line"><span class="lineno">  944</span>                               **kwds)</div>
<div class="line"><span class="lineno">  945</span>        res2 = permutation_test(data, statistic, n_resamples=np.inf, **kwds)</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>        <span class="keyword">assert</span> res.statistic == res2.statistic</div>
<div class="line"><span class="lineno">  948</span>        assert_allclose(res.pvalue, res2.pvalue, atol=1e-2)</div>
<div class="line"><span class="lineno">  949</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1c8617448448fab557a029d632dc2e0" name="ac1c8617448448fab557a029d632dc2e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1c8617448448fab557a029d632dc2e0">&#9670;&#160;</a></span>test_vectorized_nsamp_ptype_both()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_vectorized_nsamp_ptype_both </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1088</span>    <span class="keyword">def </span>test_vectorized_nsamp_ptype_both(self, axis):</div>
<div class="line"><span class="lineno"> 1089</span>        <span class="comment"># Test that permutation_test with permutation_type=&#39;independent&#39; works</span></div>
<div class="line"><span class="lineno"> 1090</span>        <span class="comment"># properly for a 3-sample statistic with nd array samples of different</span></div>
<div class="line"><span class="lineno"> 1091</span>        <span class="comment"># (but compatible) shapes and ndims. Show that exact permutation test</span></div>
<div class="line"><span class="lineno"> 1092</span>        <span class="comment"># and random permutation tests approximate SciPy&#39;s asymptotic pvalues</span></div>
<div class="line"><span class="lineno"> 1093</span>        <span class="comment"># and that exact and random permutation test results are even closer</span></div>
<div class="line"><span class="lineno"> 1094</span>        <span class="comment"># to one another (than they are to the asymptotic results).</span></div>
<div class="line"><span class="lineno"> 1095</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>        <span class="comment"># Three samples, different (but compatible) shapes with different ndims</span></div>
<div class="line"><span class="lineno"> 1098</span>        x = np.random.rand(3)</div>
<div class="line"><span class="lineno"> 1099</span>        y = np.random.rand(1, 3, 2)</div>
<div class="line"><span class="lineno"> 1100</span>        z = np.random.rand(2, 1, 4)</div>
<div class="line"><span class="lineno"> 1101</span>        data = (x, y, z)</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span>        <span class="comment"># Define the statistic (and pvalue for comparison)</span></div>
<div class="line"><span class="lineno"> 1104</span>        <span class="keyword">def </span>statistic1d(*data):</div>
<div class="line"><span class="lineno"> 1105</span>            <span class="keywordflow">return</span> stats.kruskal(*data).statistic</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>        <span class="keyword">def </span>pvalue1d(*data):</div>
<div class="line"><span class="lineno"> 1108</span>            <span class="keywordflow">return</span> stats.kruskal(*data).pvalue</div>
<div class="line"><span class="lineno"> 1109</span> </div>
<div class="line"><span class="lineno"> 1110</span>        statistic = _resampling._vectorize_statistic(statistic1d)</div>
<div class="line"><span class="lineno"> 1111</span>        pvalue = _resampling._vectorize_statistic(pvalue1d)</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>        <span class="comment"># Calculate the expected results</span></div>
<div class="line"><span class="lineno"> 1114</span>        x2 = np.broadcast_to(x, (2, 3, 3))  <span class="comment"># broadcast manually because</span></div>
<div class="line"><span class="lineno"> 1115</span>        y2 = np.broadcast_to(y, (2, 3, 2))  <span class="comment"># _vectorize_statistic doesn&#39;t</span></div>
<div class="line"><span class="lineno"> 1116</span>        z2 = np.broadcast_to(z, (2, 3, 4))</div>
<div class="line"><span class="lineno"> 1117</span>        expected_statistic = statistic(x2, y2, z2, axis=axis)</div>
<div class="line"><span class="lineno"> 1118</span>        expected_pvalue = pvalue(x2, y2, z2, axis=axis)</div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>        <span class="comment"># Calculate exact and randomized permutation results</span></div>
<div class="line"><span class="lineno"> 1121</span>        kwds = {<span class="stringliteral">&#39;vectorized&#39;</span>: <span class="keyword">False</span>, <span class="stringliteral">&#39;axis&#39;</span>: axis, <span class="stringliteral">&#39;alternative&#39;</span>: <span class="stringliteral">&#39;greater&#39;</span>,</div>
<div class="line"><span class="lineno"> 1122</span>                <span class="stringliteral">&#39;permutation_type&#39;</span>: <span class="stringliteral">&#39;independent&#39;</span>, <span class="stringliteral">&#39;random_state&#39;</span>: 0}</div>
<div class="line"><span class="lineno"> 1123</span>        res = permutation_test(data, statistic1d, n_resamples=np.inf, **kwds)</div>
<div class="line"><span class="lineno"> 1124</span>        res2 = permutation_test(data, statistic1d, n_resamples=1000, **kwds)</div>
<div class="line"><span class="lineno"> 1125</span> </div>
<div class="line"><span class="lineno"> 1126</span>        <span class="comment"># Check results</span></div>
<div class="line"><span class="lineno"> 1127</span>        assert_allclose(res.statistic, expected_statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1128</span>        assert_allclose(res.statistic, res2.statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1129</span>        assert_allclose(res.pvalue, expected_pvalue, atol=6e-2)</div>
<div class="line"><span class="lineno"> 1130</span>        assert_allclose(res.pvalue, res2.pvalue, atol=3e-2)</div>
<div class="line"><span class="lineno"> 1131</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fbb5a0afb341efd1ef1496c5136c24b" name="a2fbb5a0afb341efd1ef1496c5136c24b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fbb5a0afb341efd1ef1496c5136c24b">&#9670;&#160;</a></span>test_vectorized_nsamp_ptype_samples()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_vectorized_nsamp_ptype_samples </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1234</span>    <span class="keyword">def </span>test_vectorized_nsamp_ptype_samples(self, axis):</div>
<div class="line"><span class="lineno"> 1235</span>        <span class="comment"># Test that permutation_test with permutation_type=&#39;samples&#39; works</span></div>
<div class="line"><span class="lineno"> 1236</span>        <span class="comment"># properly for a 3-sample statistic with nd array samples of different</span></div>
<div class="line"><span class="lineno"> 1237</span>        <span class="comment"># (but compatible) shapes and ndims. Show that exact permutation test</span></div>
<div class="line"><span class="lineno"> 1238</span>        <span class="comment"># reproduces SciPy&#39;s exact pvalue and that random permutation test</span></div>
<div class="line"><span class="lineno"> 1239</span>        <span class="comment"># approximates it.</span></div>
<div class="line"><span class="lineno"> 1240</span> </div>
<div class="line"><span class="lineno"> 1241</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno"> 1242</span> </div>
<div class="line"><span class="lineno"> 1243</span>        x = np.random.rand(2, 4, 3)</div>
<div class="line"><span class="lineno"> 1244</span>        y = np.random.rand(1, 4, 3)</div>
<div class="line"><span class="lineno"> 1245</span>        z = np.random.rand(2, 4, 1)</div>
<div class="line"><span class="lineno"> 1246</span>        x = stats.rankdata(x, axis=axis)</div>
<div class="line"><span class="lineno"> 1247</span>        y = stats.rankdata(y, axis=axis)</div>
<div class="line"><span class="lineno"> 1248</span>        z = stats.rankdata(z, axis=axis)</div>
<div class="line"><span class="lineno"> 1249</span>        y = y[0]  <span class="comment"># to check broadcast with different ndim</span></div>
<div class="line"><span class="lineno"> 1250</span>        data = (x, y, z)</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>        <span class="keyword">def </span>statistic1d(*data):</div>
<div class="line"><span class="lineno"> 1253</span>            <span class="keywordflow">return</span> stats.page_trend_test(data, ranked=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1254</span>                                         method=<span class="stringliteral">&#39;asymptotic&#39;</span>).statistic</div>
<div class="line"><span class="lineno"> 1255</span> </div>
<div class="line"><span class="lineno"> 1256</span>        <span class="keyword">def </span>pvalue1d(*data):</div>
<div class="line"><span class="lineno"> 1257</span>            <span class="keywordflow">return</span> stats.page_trend_test(data, ranked=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1258</span>                                         method=<span class="stringliteral">&#39;exact&#39;</span>).pvalue</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span>        statistic = _resampling._vectorize_statistic(statistic1d)</div>
<div class="line"><span class="lineno"> 1261</span>        pvalue = _resampling._vectorize_statistic(pvalue1d)</div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>        expected_statistic = statistic(*np.broadcast_arrays(*data), axis=axis)</div>
<div class="line"><span class="lineno"> 1264</span>        expected_pvalue = pvalue(*np.broadcast_arrays(*data), axis=axis)</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>        kwds = {<span class="stringliteral">&#39;vectorized&#39;</span>: <span class="keyword">False</span>, <span class="stringliteral">&#39;axis&#39;</span>: axis, <span class="stringliteral">&#39;alternative&#39;</span>: <span class="stringliteral">&#39;greater&#39;</span>,</div>
<div class="line"><span class="lineno"> 1267</span>                <span class="stringliteral">&#39;permutation_type&#39;</span>: <span class="stringliteral">&#39;pairings&#39;</span>, <span class="stringliteral">&#39;random_state&#39;</span>: 0}</div>
<div class="line"><span class="lineno"> 1268</span>        res = permutation_test(data, statistic1d, n_resamples=np.inf, **kwds)</div>
<div class="line"><span class="lineno"> 1269</span>        res2 = permutation_test(data, statistic1d, n_resamples=5000, **kwds)</div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span>        assert_allclose(res.statistic, expected_statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1272</span>        assert_allclose(res.statistic, res2.statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1273</span>        assert_allclose(res.pvalue, expected_pvalue, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1274</span>        assert_allclose(res.pvalue, res2.pvalue, atol=3e-2)</div>
<div class="line"><span class="lineno"> 1275</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acf5e60a06f4913fadf1988b3a9aa33b9" name="acf5e60a06f4913fadf1988b3a9aa33b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf5e60a06f4913fadf1988b3a9aa33b9">&#9670;&#160;</a></span>test_with_ties()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.TestPermutationTest.test_with_ties </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>case</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Results above from SAS PROC NPAR1WAY, e.g.

DATA myData;
INPUT X Y;
CARDS;
1 1
1 2
1 3
1 4
2 1.5
2 2
2 2.5
ods graphics on;
proc npar1way AB data=myData;
    class X;
    EXACT;
run;
ods graphics off;

Note: SAS provides Pr &gt;= |S-Mean|, which is different from our
definition of a two-sided p-value.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1294</span>    <span class="keyword">def </span>test_with_ties(self, case):</div>
<div class="line"><span class="lineno"> 1295</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="stringliteral">        Results above from SAS PROC NPAR1WAY, e.g.</span></div>
<div class="line"><span class="lineno"> 1297</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1298</span><span class="stringliteral">        DATA myData;</span></div>
<div class="line"><span class="lineno"> 1299</span><span class="stringliteral">        INPUT X Y;</span></div>
<div class="line"><span class="lineno"> 1300</span><span class="stringliteral">        CARDS;</span></div>
<div class="line"><span class="lineno"> 1301</span><span class="stringliteral">        1 1</span></div>
<div class="line"><span class="lineno"> 1302</span><span class="stringliteral">        1 2</span></div>
<div class="line"><span class="lineno"> 1303</span><span class="stringliteral">        1 3</span></div>
<div class="line"><span class="lineno"> 1304</span><span class="stringliteral">        1 4</span></div>
<div class="line"><span class="lineno"> 1305</span><span class="stringliteral">        2 1.5</span></div>
<div class="line"><span class="lineno"> 1306</span><span class="stringliteral">        2 2</span></div>
<div class="line"><span class="lineno"> 1307</span><span class="stringliteral">        2 2.5</span></div>
<div class="line"><span class="lineno"> 1308</span><span class="stringliteral">        ods graphics on;</span></div>
<div class="line"><span class="lineno"> 1309</span><span class="stringliteral">        proc npar1way AB data=myData;</span></div>
<div class="line"><span class="lineno"> 1310</span><span class="stringliteral">            class X;</span></div>
<div class="line"><span class="lineno"> 1311</span><span class="stringliteral">            EXACT;</span></div>
<div class="line"><span class="lineno"> 1312</span><span class="stringliteral">        run;</span></div>
<div class="line"><span class="lineno"> 1313</span><span class="stringliteral">        ods graphics off;</span></div>
<div class="line"><span class="lineno"> 1314</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1315</span><span class="stringliteral">        Note: SAS provides Pr &gt;= |S-Mean|, which is different from our</span></div>
<div class="line"><span class="lineno"> 1316</span><span class="stringliteral">        definition of a two-sided p-value.</span></div>
<div class="line"><span class="lineno"> 1317</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1318</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>        x = case[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno"> 1321</span>        y = case[<span class="stringliteral">&#39;y&#39;</span>]</div>
<div class="line"><span class="lineno"> 1322</span> </div>
<div class="line"><span class="lineno"> 1323</span>        expected_statistic = case[<span class="stringliteral">&#39;expected_statistic&#39;</span>]</div>
<div class="line"><span class="lineno"> 1324</span>        expected_less = case[<span class="stringliteral">&#39;expected_less&#39;</span>]</div>
<div class="line"><span class="lineno"> 1325</span>        expected_2sided = case[<span class="stringliteral">&#39;expected_2sided&#39;</span>]</div>
<div class="line"><span class="lineno"> 1326</span>        expected_Pr_gte_S_mean = case[<span class="stringliteral">&#39;expected_Pr_gte_S_mean&#39;</span>]</div>
<div class="line"><span class="lineno"> 1327</span>        expected_avg = case[<span class="stringliteral">&#39;expected_avg&#39;</span>]</div>
<div class="line"><span class="lineno"> 1328</span>        expected_std = case[<span class="stringliteral">&#39;expected_std&#39;</span>]</div>
<div class="line"><span class="lineno"> 1329</span> </div>
<div class="line"><span class="lineno"> 1330</span>        <span class="keyword">def </span>statistic1d(x, y):</div>
<div class="line"><span class="lineno"> 1331</span>            <span class="keywordflow">return</span> stats.ansari(x, y).statistic</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>        <span class="keyword">with</span> np.testing.suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno"> 1334</span>            sup.filter(UserWarning, <span class="stringliteral">&quot;Ties preclude use of exact statistic&quot;</span>)</div>
<div class="line"><span class="lineno"> 1335</span>            res = permutation_test((x, y), statistic1d, n_resamples=np.inf,</div>
<div class="line"><span class="lineno"> 1336</span>                                   alternative=<span class="stringliteral">&#39;less&#39;</span>)</div>
<div class="line"><span class="lineno"> 1337</span>            res2 = permutation_test((x, y), statistic1d, n_resamples=np.inf,</div>
<div class="line"><span class="lineno"> 1338</span>                                    alternative=<span class="stringliteral">&#39;two-sided&#39;</span>)</div>
<div class="line"><span class="lineno"> 1339</span> </div>
<div class="line"><span class="lineno"> 1340</span>        assert_allclose(res.statistic, expected_statistic, rtol=self.rtol)</div>
<div class="line"><span class="lineno"> 1341</span>        assert_allclose(res.pvalue, expected_less, atol=1e-10)</div>
<div class="line"><span class="lineno"> 1342</span>        assert_allclose(res2.pvalue, expected_2sided, atol=1e-10)</div>
<div class="line"><span class="lineno"> 1343</span>        assert_allclose(res2.null_distribution.mean(), expected_avg, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1344</span>        assert_allclose(res2.null_distribution.std(), expected_std, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span>        <span class="comment"># SAS provides Pr &gt;= |S-Mean|; might as well check against that, too</span></div>
<div class="line"><span class="lineno"> 1347</span>        S = res.statistic</div>
<div class="line"><span class="lineno"> 1348</span>        mean = res.null_distribution.mean()</div>
<div class="line"><span class="lineno"> 1349</span>        n = len(res.null_distribution)</div>
<div class="line"><span class="lineno"> 1350</span>        Pr_gte_S_mean = np.sum(np.abs(res.null_distribution-mean)</div>
<div class="line"><span class="lineno"> 1351</span>                               &gt;= np.abs(S-mean))/n</div>
<div class="line"><span class="lineno"> 1352</span>        assert_allclose(expected_Pr_gte_S_mean, Pr_gte_S_mean)</div>
<div class="line"><span class="lineno"> 1353</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a75a92c967adabc692de67dd4ed1b4dd4" name="a75a92c967adabc692de67dd4ed1b4dd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75a92c967adabc692de67dd4ed1b4dd4">&#9670;&#160;</a></span>batch_generator_cases</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.stats.tests.test_resampling.TestPermutationTest.batch_generator_cases</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  [(range(0), 3, []),</div>
<div class="line">                             (range(6), 3, [[0, 1, 2], [3, 4, 5]]),</div>
<div class="line">                             (range(8), 3, [[0, 1, 2], [3, 4, 5], [6, 7]])]</div>
</div><!-- fragment -->
</div>
</div>
<a id="a51590c7ed1bfde325c737b27521802cb" name="a51590c7ed1bfde325c737b27521802cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51590c7ed1bfde325c737b27521802cb">&#9670;&#160;</a></span>rtol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int scipy.stats.tests.test_resampling.TestPermutationTest.rtol = 1e-14</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae99214dc6edc2f4911426858fff3580e" name="ae99214dc6edc2f4911426858fff3580e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae99214dc6edc2f4911426858fff3580e">&#9670;&#160;</a></span>tie_case_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.stats.tests.test_resampling.TestPermutationTest.tie_case_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  {<span class="stringliteral">&#39;x&#39;</span>: [1, 2, 3, 4], <span class="stringliteral">&#39;y&#39;</span>: [1.5, 2, 2.5],</div>
<div class="line">                  <span class="stringliteral">&#39;expected_less&#39;</span>: 0.2000000000,</div>
<div class="line">                  <span class="stringliteral">&#39;expected_2sided&#39;</span>: 0.4,  <span class="comment"># 2*expected_less</span></div>
<div class="line">                  <span class="stringliteral">&#39;expected_Pr_gte_S_mean&#39;</span>: 0.3428571429,  <span class="comment"># see note below</span></div>
<div class="line">                  <span class="stringliteral">&#39;expected_statistic&#39;</span>: 7.5,</div>
<div class="line">                  <span class="stringliteral">&#39;expected_avg&#39;</span>: 9.142857, <span class="stringliteral">&#39;expected_std&#39;</span>: 1.40698}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c0e7d5d94e20198d6877829ad37fbbb" name="a5c0e7d5d94e20198d6877829ad37fbbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c0e7d5d94e20198d6877829ad37fbbb">&#9670;&#160;</a></span>tie_case_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.stats.tests.test_resampling.TestPermutationTest.tie_case_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  {<span class="stringliteral">&#39;x&#39;</span>: [111, 107, 100, 99, 102, 106, 109, 108],</div>
<div class="line">                  <span class="stringliteral">&#39;y&#39;</span>: [107, 108, 106, 98, 105, 103, 110, 105, 104],</div>
<div class="line">                  <span class="stringliteral">&#39;expected_less&#39;</span>: 0.1555738379,</div>
<div class="line">                  <span class="stringliteral">&#39;expected_2sided&#39;</span>: 0.3111476758,</div>
<div class="line">                  <span class="stringliteral">&#39;expected_Pr_gte_S_mean&#39;</span>: 0.2969971205,  <span class="comment"># see note below</span></div>
<div class="line">                  <span class="stringliteral">&#39;expected_statistic&#39;</span>: 32.5,</div>
<div class="line">                  <span class="stringliteral">&#39;expected_avg&#39;</span>: 38.117647, <span class="stringliteral">&#39;expected_std&#39;</span>: 5.172124}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/scipy/stats/tests/<a class="el" href="test__resampling_8py.html">test_resampling.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
