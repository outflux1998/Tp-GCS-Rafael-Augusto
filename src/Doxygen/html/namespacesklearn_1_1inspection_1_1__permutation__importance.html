<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.inspection._permutation_importance Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1inspection.html">inspection</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1inspection_1_1__permutation__importance.html">_permutation_importance</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.inspection._permutation_importance Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afd6b4fbb2c55f3f7abaf95a3bc8936ef" id="r_afd6b4fbb2c55f3f7abaf95a3bc8936ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1inspection_1_1__permutation__importance.html#afd6b4fbb2c55f3f7abaf95a3bc8936ef">_weights_scorer</a> (scorer, estimator, X, y, sample_weight)</td></tr>
<tr class="separator:afd6b4fbb2c55f3f7abaf95a3bc8936ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ee170fa30a79c810be07bcab2ba9cd5" id="r_a1ee170fa30a79c810be07bcab2ba9cd5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1inspection_1_1__permutation__importance.html#a1ee170fa30a79c810be07bcab2ba9cd5">_calculate_permutation_scores</a> (estimator, X, y, sample_weight, col_idx, random_state, n_repeats, scorer, max_samples)</td></tr>
<tr class="separator:a1ee170fa30a79c810be07bcab2ba9cd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fec4d55ca3c27b0924fae0d6ed4456d" id="r_a3fec4d55ca3c27b0924fae0d6ed4456d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1inspection_1_1__permutation__importance.html#a3fec4d55ca3c27b0924fae0d6ed4456d">_create_importances_bunch</a> (baseline_score, permuted_score)</td></tr>
<tr class="separator:a3fec4d55ca3c27b0924fae0d6ed4456d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7390560b8f05025e1c88ee74f66aeb08" id="r_a7390560b8f05025e1c88ee74f66aeb08"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1inspection_1_1__permutation__importance.html#a7390560b8f05025e1c88ee74f66aeb08">permutation_importance</a> (estimator, X, y, *scoring=None, n_repeats=5, n_jobs=None, random_state=None, sample_weight=None, max_samples=1.0)</td></tr>
<tr class="separator:a7390560b8f05025e1c88ee74f66aeb08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Permutation importance for estimators.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a1ee170fa30a79c810be07bcab2ba9cd5" name="a1ee170fa30a79c810be07bcab2ba9cd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ee170fa30a79c810be07bcab2ba9cd5">&#9670;&#160;</a></span>_calculate_permutation_scores()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.inspection._permutation_importance._calculate_permutation_scores </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sample_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>col_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_repeats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scorer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_samples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Calculate score when `col_idx` is permuted.</pre> <div class="fragment"><div class="line"><span class="lineno">   32</span>):</div>
<div class="line"><span class="lineno">   33</span>    <span class="stringliteral">&quot;&quot;&quot;Calculate score when `col_idx` is permuted.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   34</span>    random_state = check_random_state(random_state)</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>    <span class="comment"># Work on a copy of X to ensure thread-safety in case of threading based</span></div>
<div class="line"><span class="lineno">   37</span>    <span class="comment"># parallelism. Furthermore, making a copy is also useful when the joblib</span></div>
<div class="line"><span class="lineno">   38</span>    <span class="comment"># backend is &#39;loky&#39; (default) or the old &#39;multiprocessing&#39;: in those cases,</span></div>
<div class="line"><span class="lineno">   39</span>    <span class="comment"># if X is large it will be automatically be backed by a readonly memory map</span></div>
<div class="line"><span class="lineno">   40</span>    <span class="comment"># (memmap). X.copy() on the other hand is always guaranteed to return a</span></div>
<div class="line"><span class="lineno">   41</span>    <span class="comment"># writable data-structure whose columns can be shuffled inplace.</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">if</span> max_samples &lt; X.shape[0]:</div>
<div class="line"><span class="lineno">   43</span>        row_indices = _generate_indices(</div>
<div class="line"><span class="lineno">   44</span>            random_state=random_state,</div>
<div class="line"><span class="lineno">   45</span>            bootstrap=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">   46</span>            n_population=X.shape[0],</div>
<div class="line"><span class="lineno">   47</span>            n_samples=max_samples,</div>
<div class="line"><span class="lineno">   48</span>        )</div>
<div class="line"><span class="lineno">   49</span>        X_permuted = _safe_indexing(X, row_indices, axis=0)</div>
<div class="line"><span class="lineno">   50</span>        y = _safe_indexing(y, row_indices, axis=0)</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   52</span>        X_permuted = X.copy()</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    scores = []</div>
<div class="line"><span class="lineno">   55</span>    shuffling_idx = np.arange(X_permuted.shape[0])</div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(n_repeats):</div>
<div class="line"><span class="lineno">   57</span>        random_state.shuffle(shuffling_idx)</div>
<div class="line"><span class="lineno">   58</span>        <span class="keywordflow">if</span> hasattr(X_permuted, <span class="stringliteral">&quot;iloc&quot;</span>):</div>
<div class="line"><span class="lineno">   59</span>            col = X_permuted.iloc[shuffling_idx, col_idx]</div>
<div class="line"><span class="lineno">   60</span>            col.index = X_permuted.index</div>
<div class="line"><span class="lineno">   61</span>            X_permuted[X_permuted.columns[col_idx]] = col</div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   63</span>            X_permuted[:, col_idx] = X_permuted[shuffling_idx, col_idx]</div>
<div class="line"><span class="lineno">   64</span>        scores.append(_weights_scorer(scorer, estimator, X_permuted, y, sample_weight))</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">if</span> isinstance(scores[0], dict):</div>
<div class="line"><span class="lineno">   67</span>        scores = _aggregate_score_dicts(scores)</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   69</span>        scores = np.array(scores)</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">return</span> scores</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3fec4d55ca3c27b0924fae0d6ed4456d" name="a3fec4d55ca3c27b0924fae0d6ed4456d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fec4d55ca3c27b0924fae0d6ed4456d">&#9670;&#160;</a></span>_create_importances_bunch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.inspection._permutation_importance._create_importances_bunch </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>baseline_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>permuted_score</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Compute the importances as the decrease in score.

Parameters
----------
baseline_score : ndarray of shape (n_features,)
    The baseline score without permutation.
permuted_score : ndarray of shape (n_features, n_repeats)
    The permuted scores for the `n` repetitions.

Returns
-------
importances : :class:`~sklearn.utils.Bunch`
    Dictionary-like object, with the following attributes.
    importances_mean : ndarray, shape (n_features, )
        Mean of feature importance over `n_repeats`.
    importances_std : ndarray, shape (n_features, )
        Standard deviation over `n_repeats`.
    importances : ndarray, shape (n_features, n_repeats)
        Raw permutation importance scores.
</pre> <div class="fragment"><div class="line"><span class="lineno">   74</span><span class="keyword">def </span>_create_importances_bunch(baseline_score, permuted_score):</div>
<div class="line"><span class="lineno">   75</span>    <span class="stringliteral">&quot;&quot;&quot;Compute the importances as the decrease in score.</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    baseline_score : ndarray of shape (n_features,)</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">        The baseline score without permutation.</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    permuted_score : ndarray of shape (n_features, n_repeats)</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">        The permuted scores for the `n` repetitions.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">    importances : :class:`~sklearn.utils.Bunch`</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        Dictionary-like object, with the following attributes.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">        importances_mean : ndarray, shape (n_features, )</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">            Mean of feature importance over `n_repeats`.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">        importances_std : ndarray, shape (n_features, )</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">            Standard deviation over `n_repeats`.</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">        importances : ndarray, shape (n_features, n_repeats)</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">            Raw permutation importance scores.</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   95</span>    importances = baseline_score - permuted_score</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">return</span> Bunch(</div>
<div class="line"><span class="lineno">   97</span>        importances_mean=np.mean(importances, axis=1),</div>
<div class="line"><span class="lineno">   98</span>        importances_std=np.std(importances, axis=1),</div>
<div class="line"><span class="lineno">   99</span>        importances=importances,</div>
<div class="line"><span class="lineno">  100</span>    )</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afd6b4fbb2c55f3f7abaf95a3bc8936ef" name="afd6b4fbb2c55f3f7abaf95a3bc8936ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd6b4fbb2c55f3f7abaf95a3bc8936ef">&#9670;&#160;</a></span>_weights_scorer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.inspection._permutation_importance._weights_scorer </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scorer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sample_weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   16</span><span class="keyword">def </span>_weights_scorer(scorer, estimator, X, y, sample_weight):</div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordflow">if</span> sample_weight <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   18</span>        <span class="keywordflow">return</span> scorer(estimator, X, y, sample_weight)</div>
<div class="line"><span class="lineno">   19</span>    <span class="keywordflow">return</span> scorer(estimator, X, y)</div>
<div class="line"><span class="lineno">   20</span> </div>
<div class="line"><span class="lineno">   21</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7390560b8f05025e1c88ee74f66aeb08" name="a7390560b8f05025e1c88ee74f66aeb08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7390560b8f05025e1c88ee74f66aeb08">&#9670;&#160;</a></span>permutation_importance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.inspection._permutation_importance.permutation_importance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>scoring</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_repeats</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_jobs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sample_weight</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_samples</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Permutation importance for feature evaluation [BRE]_.

The :term:`estimator` is required to be a fitted estimator. `X` can be the
data set used to train the estimator or a hold-out set. The permutation
importance of a feature is calculated as follows. First, a baseline metric,
defined by :term:`scoring`, is evaluated on a (potentially different)
dataset defined by the `X`. Next, a feature column from the validation set
is permuted and the metric is evaluated again. The permutation importance
is defined to be the difference between the baseline metric and metric from
permutating the feature column.

Read more in the :ref:`User Guide &lt;permutation_importance&gt;`.

Parameters
----------
estimator : object
    An estimator that has already been :term:`fitted` and is compatible
    with :term:`scorer`.

X : ndarray or DataFrame, shape (n_samples, n_features)
    Data on which permutation importance will be computed.

y : array-like or None, shape (n_samples, ) or (n_samples, n_classes)
    Targets for supervised or `None` for unsupervised.

scoring : str, callable, list, tuple, or dict, default=None
    Scorer to use.
    If `scoring` represents a single score, one can use:

    - a single string (see :ref:`scoring_parameter`);
    - a callable (see :ref:`scoring`) that returns a single value.

    If `scoring` represents multiple scores, one can use:

    - a list or tuple of unique strings;
    - a callable returning a dictionary where the keys are the metric
      names and the values are the metric scores;
    - a dictionary with metric names as keys and callables a values.

    Passing multiple scores to `scoring` is more efficient than calling
    `permutation_importance` for each of the scores as it reuses
    predictions to avoid redundant computation.

    If None, the estimator's default scorer is used.

n_repeats : int, default=5
    Number of times to permute a feature.

n_jobs : int or None, default=None
    Number of jobs to run in parallel. The computation is done by computing
    permutation score for each columns and parallelized over the columns.
    `None` means 1 unless in a :obj:`joblib.parallel_backend` context.
    `-1` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`
    for more details.

random_state : int, RandomState instance, default=None
    Pseudo-random number generator to control the permutations of each
    feature.
    Pass an int to get reproducible results across function calls.
    See :term:`Glossary &lt;random_state&gt;`.

sample_weight : array-like of shape (n_samples,), default=None
    Sample weights used in scoring.

    .. versionadded:: 0.24

max_samples : int or float, default=1.0
    The number of samples to draw from X to compute feature importance
    in each repeat (without replacement).

    - If int, then draw `max_samples` samples.
    - If float, then draw `max_samples * X.shape[0]` samples.
    - If `max_samples` is equal to `1.0` or `X.shape[0]`, all samples
      will be used.

    While using this option may provide less accurate importance estimates,
    it keeps the method tractable when evaluating feature importance on
    large datasets. In combination with `n_repeats`, this allows to control
    the computational speed vs statistical accuracy trade-off of this method.

    .. versionadded:: 1.0

Returns
-------
result : :class:`~sklearn.utils.Bunch` or dict of such instances
    Dictionary-like object, with the following attributes.

    importances_mean : ndarray of shape (n_features, )
        Mean of feature importance over `n_repeats`.
    importances_std : ndarray of shape (n_features, )
        Standard deviation over `n_repeats`.
    importances : ndarray of shape (n_features, n_repeats)
        Raw permutation importance scores.

    If there are multiple scoring metrics in the scoring parameter
    `result` is a dict with scorer names as keys (e.g. 'roc_auc') and
    `Bunch` objects like above as values.

References
----------
.. [BRE] :doi:`L. Breiman, "Random Forests", Machine Learning, 45(1), 5-32,
         2001. &lt;10.1023/A:1010933404324&gt;`

Examples
--------
&gt;&gt;&gt; from sklearn.linear_model import LogisticRegression
&gt;&gt;&gt; from sklearn.inspection import permutation_importance
&gt;&gt;&gt; X = [[1, 9, 9],[1, 9, 9],[1, 9, 9],
...      [0, 9, 9],[0, 9, 9],[0, 9, 9]]
&gt;&gt;&gt; y = [1, 1, 1, 0, 0, 0]
&gt;&gt;&gt; clf = LogisticRegression().fit(X, y)
&gt;&gt;&gt; result = permutation_importance(clf, X, y, n_repeats=10,
...                                 random_state=0)
&gt;&gt;&gt; result.importances_mean
array([0.4666..., 0.       , 0.       ])
&gt;&gt;&gt; result.importances_std
array([0.2211..., 0.       , 0.       ])
</pre> <div class="fragment"><div class="line"><span class="lineno">  114</span>):</div>
<div class="line"><span class="lineno">  115</span>    <span class="stringliteral">&quot;&quot;&quot;Permutation importance for feature evaluation [BRE]_.</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">    The :term:`estimator` is required to be a fitted estimator. `X` can be the</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">    data set used to train the estimator or a hold-out set. The permutation</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    importance of a feature is calculated as follows. First, a baseline metric,</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    defined by :term:`scoring`, is evaluated on a (potentially different)</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    dataset defined by the `X`. Next, a feature column from the validation set</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    is permuted and the metric is evaluated again. The permutation importance</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    is defined to be the difference between the baseline metric and metric from</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    permutating the feature column.</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">    Read more in the :ref:`User Guide &lt;permutation_importance&gt;`.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">    estimator : object</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">        An estimator that has already been :term:`fitted` and is compatible</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">        with :term:`scorer`.</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    X : ndarray or DataFrame, shape (n_samples, n_features)</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">        Data on which permutation importance will be computed.</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    y : array-like or None, shape (n_samples, ) or (n_samples, n_classes)</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        Targets for supervised or `None` for unsupervised.</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    scoring : str, callable, list, tuple, or dict, default=None</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">        Scorer to use.</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">        If `scoring` represents a single score, one can use:</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        - a single string (see :ref:`scoring_parameter`);</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">        - a callable (see :ref:`scoring`) that returns a single value.</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">        If `scoring` represents multiple scores, one can use:</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">        - a list or tuple of unique strings;</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        - a callable returning a dictionary where the keys are the metric</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">          names and the values are the metric scores;</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">        - a dictionary with metric names as keys and callables a values.</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">        Passing multiple scores to `scoring` is more efficient than calling</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">        `permutation_importance` for each of the scores as it reuses</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">        predictions to avoid redundant computation.</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">        If None, the estimator&#39;s default scorer is used.</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">    n_repeats : int, default=5</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">        Number of times to permute a feature.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    n_jobs : int or None, default=None</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">        Number of jobs to run in parallel. The computation is done by computing</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">        permutation score for each columns and parallelized over the columns.</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">        `None` means 1 unless in a :obj:`joblib.parallel_backend` context.</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">        `-1` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">        for more details.</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    random_state : int, RandomState instance, default=None</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">        Pseudo-random number generator to control the permutations of each</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">        feature.</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">        Pass an int to get reproducible results across function calls.</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">        See :term:`Glossary &lt;random_state&gt;`.</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    sample_weight : array-like of shape (n_samples,), default=None</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">        Sample weights used in scoring.</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">        .. versionadded:: 0.24</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">    max_samples : int or float, default=1.0</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">        The number of samples to draw from X to compute feature importance</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">        in each repeat (without replacement).</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">        - If int, then draw `max_samples` samples.</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">        - If float, then draw `max_samples * X.shape[0]` samples.</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">        - If `max_samples` is equal to `1.0` or `X.shape[0]`, all samples</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">          will be used.</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">        While using this option may provide less accurate importance estimates,</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">        it keeps the method tractable when evaluating feature importance on</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">        large datasets. In combination with `n_repeats`, this allows to control</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">        the computational speed vs statistical accuracy trade-off of this method.</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">        .. versionadded:: 1.0</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    result : :class:`~sklearn.utils.Bunch` or dict of such instances</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">        Dictionary-like object, with the following attributes.</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">        importances_mean : ndarray of shape (n_features, )</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">            Mean of feature importance over `n_repeats`.</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">        importances_std : ndarray of shape (n_features, )</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">            Standard deviation over `n_repeats`.</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">        importances : ndarray of shape (n_features, n_repeats)</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">            Raw permutation importance scores.</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">        If there are multiple scoring metrics in the scoring parameter</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">        `result` is a dict with scorer names as keys (e.g. &#39;roc_auc&#39;) and</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">        `Bunch` objects like above as values.</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    .. [BRE] :doi:`L. Breiman, &quot;Random Forests&quot;, Machine Learning, 45(1), 5-32,</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">             2001. &lt;10.1023/A:1010933404324&gt;`</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    &gt;&gt;&gt; from sklearn.linear_model import LogisticRegression</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">    &gt;&gt;&gt; from sklearn.inspection import permutation_importance</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    &gt;&gt;&gt; X = [[1, 9, 9],[1, 9, 9],[1, 9, 9],</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">    ...      [0, 9, 9],[0, 9, 9],[0, 9, 9]]</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">    &gt;&gt;&gt; y = [1, 1, 1, 0, 0, 0]</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">    &gt;&gt;&gt; clf = LogisticRegression().fit(X, y)</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">    &gt;&gt;&gt; result = permutation_importance(clf, X, y, n_repeats=10,</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    ...                                 random_state=0)</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">    &gt;&gt;&gt; result.importances_mean</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">    array([0.4666..., 0.       , 0.       ])</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    &gt;&gt;&gt; result.importances_std</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">    array([0.2211..., 0.       , 0.       ])</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(X, <span class="stringliteral">&quot;iloc&quot;</span>):</div>
<div class="line"><span class="lineno">  234</span>        X = check_array(X, force_all_finite=<span class="stringliteral">&quot;allow-nan&quot;</span>, dtype=<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="comment"># Precompute random seed from the random state to be used</span></div>
<div class="line"><span class="lineno">  237</span>    <span class="comment"># to get a fresh independent RandomState instance for each</span></div>
<div class="line"><span class="lineno">  238</span>    <span class="comment"># parallel call to _calculate_permutation_scores, irrespective of</span></div>
<div class="line"><span class="lineno">  239</span>    <span class="comment"># the fact that variables are shared or not depending on the active</span></div>
<div class="line"><span class="lineno">  240</span>    <span class="comment"># joblib backend (sequential, thread-based or process-based).</span></div>
<div class="line"><span class="lineno">  241</span>    random_state = check_random_state(random_state)</div>
<div class="line"><span class="lineno">  242</span>    random_seed = random_state.randint(np.iinfo(np.int32).max + 1)</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(max_samples, numbers.Integral):</div>
<div class="line"><span class="lineno">  245</span>        max_samples = int(max_samples * X.shape[0])</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordflow">elif</span> <span class="keywordflow">not</span> (0 &lt; max_samples &lt;= X.shape[0]):</div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;max_samples must be in (0, n_samples]&quot;</span>)</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">if</span> callable(scoring):</div>
<div class="line"><span class="lineno">  250</span>        scorer = scoring</div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordflow">elif</span> scoring <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">or</span> isinstance(scoring, str):</div>
<div class="line"><span class="lineno">  252</span>        scorer = check_scoring(estimator, scoring=scoring)</div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  254</span>        scorers_dict = _check_multimetric_scoring(estimator, scoring)</div>
<div class="line"><span class="lineno">  255</span>        scorer = _MultimetricScorer(**scorers_dict)</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    baseline_score = _weights_scorer(scorer, estimator, X, y, sample_weight)</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>    scores = Parallel(n_jobs=n_jobs)(</div>
<div class="line"><span class="lineno">  260</span>        delayed(_calculate_permutation_scores)(</div>
<div class="line"><span class="lineno">  261</span>            estimator,</div>
<div class="line"><span class="lineno">  262</span>            X,</div>
<div class="line"><span class="lineno">  263</span>            y,</div>
<div class="line"><span class="lineno">  264</span>            sample_weight,</div>
<div class="line"><span class="lineno">  265</span>            col_idx,</div>
<div class="line"><span class="lineno">  266</span>            random_seed,</div>
<div class="line"><span class="lineno">  267</span>            n_repeats,</div>
<div class="line"><span class="lineno">  268</span>            scorer,</div>
<div class="line"><span class="lineno">  269</span>            max_samples,</div>
<div class="line"><span class="lineno">  270</span>        )</div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">for</span> col_idx <span class="keywordflow">in</span> range(X.shape[1])</div>
<div class="line"><span class="lineno">  272</span>    )</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">if</span> isinstance(baseline_score, dict):</div>
<div class="line"><span class="lineno">  275</span>        <span class="keywordflow">return</span> {</div>
<div class="line"><span class="lineno">  276</span>            name: _create_importances_bunch(</div>
<div class="line"><span class="lineno">  277</span>                baseline_score[name],</div>
<div class="line"><span class="lineno">  278</span>                <span class="comment"># unpack the permuted scores</span></div>
<div class="line"><span class="lineno">  279</span>                np.array([scores[col_idx][name] <span class="keywordflow">for</span> col_idx <span class="keywordflow">in</span> range(X.shape[1])]),</div>
<div class="line"><span class="lineno">  280</span>            )</div>
<div class="line"><span class="lineno">  281</span>            <span class="keywordflow">for</span> name <span class="keywordflow">in</span> baseline_score</div>
<div class="line"><span class="lineno">  282</span>        }</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  284</span>        <span class="keywordflow">return</span> _create_importances_bunch(baseline_score, np.array(scores))</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
