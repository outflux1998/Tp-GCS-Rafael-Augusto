<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: gensim.models.keyedvectors Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegensim.html">gensim</a></li><li class="navelem"><a class="el" href="namespacegensim_1_1models.html">models</a></li><li class="navelem"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html">keyedvectors</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">gensim.models.keyedvectors Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_base_keyed_vectors.html">BaseKeyedVectors</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_doc2_vec_keyed_vectors.html">Doc2VecKeyedVectors</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_fast_text_keyed_vectors.html">FastTextKeyedVectors</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_vocab.html">Vocab</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_word2_vec_keyed_vectors.html">Word2VecKeyedVectors</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_word_embedding_similarity_index.html">WordEmbeddingSimilarityIndex</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_word_embeddings_keyed_vectors.html">WordEmbeddingsKeyedVectors</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8e7f2c637ffbc9cc0537bd2687f384be" id="r_a8e7f2c637ffbc9cc0537bd2687f384be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#a8e7f2c637ffbc9cc0537bd2687f384be">_process_fasttext_vocab</a> (iterable, min_n, max_n, num_buckets, compatible_hash)</td></tr>
<tr class="separator:a8e7f2c637ffbc9cc0537bd2687f384be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab34ed3f752ef039fbef56caed9dfb26a" id="r_ab34ed3f752ef039fbef56caed9dfb26a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#ab34ed3f752ef039fbef56caed9dfb26a">_pad_random</a> (m, new_rows, rand)</td></tr>
<tr class="separator:ab34ed3f752ef039fbef56caed9dfb26a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afefb78b84865e3d9bc077e9f0bc14ae8" id="r_afefb78b84865e3d9bc077e9f0bc14ae8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#afefb78b84865e3d9bc077e9f0bc14ae8">_l2_norm</a> (m, replace=False)</td></tr>
<tr class="separator:afefb78b84865e3d9bc077e9f0bc14ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae43132c3b55cae100ca04fa5ece1d133" id="r_ae43132c3b55cae100ca04fa5ece1d133"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#ae43132c3b55cae100ca04fa5ece1d133">_rollback_optimization</a> (kv)</td></tr>
<tr class="separator:ae43132c3b55cae100ca04fa5ece1d133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadbe4696abfa0ef202434330dc8332c4" id="r_aadbe4696abfa0ef202434330dc8332c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#aadbe4696abfa0ef202434330dc8332c4">_unpack_copy</a> (m, num_rows, hash2index, seed=1)</td></tr>
<tr class="separator:aadbe4696abfa0ef202434330dc8332c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4e64759da1d371e0542c6017a4c9223" id="r_ab4e64759da1d371e0542c6017a4c9223"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#ab4e64759da1d371e0542c6017a4c9223">_unpack</a> (m, num_rows, hash2index, seed=1)</td></tr>
<tr class="separator:ab4e64759da1d371e0542c6017a4c9223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad249baa6c6b2d5d8897df1a983ce1012" id="r_ad249baa6c6b2d5d8897df1a983ce1012"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#ad249baa6c6b2d5d8897df1a983ce1012">_try_upgrade</a> (<a class="el" href="__lapack__subroutines_8h.html#a74495572856ad48dce0855c1bd9f38a4">wv</a>)</td></tr>
<tr class="separator:ad249baa6c6b2d5d8897df1a983ce1012"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1793f79e7bfdb2e4484739dce27ab207" id="r_a1793f79e7bfdb2e4484739dce27ab207"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#a1793f79e7bfdb2e4484739dce27ab207">logger</a> = logging.getLogger(__name__)</td></tr>
<tr class="separator:a1793f79e7bfdb2e4484739dce27ab207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b95cbce987467e38e937f4cc7515e95" id="r_a2b95cbce987467e38e937f4cc7515e95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1models_1_1keyedvectors.html#a2b95cbce987467e38e937f4cc7515e95">KeyedVectors</a> = <a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_word2_vec_keyed_vectors.html">Word2VecKeyedVectors</a></td></tr>
<tr class="separator:a2b95cbce987467e38e937f4cc7515e95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This module implements word vectors and their similarity look-ups.

Since trained word vectors are independent from the way they were trained (:class:`~gensim.models.word2vec.Word2Vec`,
:class:`~gensim.models.fasttext.FastText`, :class:`~gensim.models.wrappers.wordrank.WordRank`,
:class:`~gensim.models.wrappers.varembed.VarEmbed` etc), they can be represented by a standalone structure,
as implemented in this module.

The structure is called "KeyedVectors" and is essentially a mapping between *entities*
and *vectors*. Each entity is identified by its string id, so this is a mapping between {str =&gt; 1D numpy array}.

The entity typically corresponds to a word (so the mapping maps words to 1D vectors),
but for some models, the key can also correspond to a document, a graph node etc. To generalize
over different use-cases, this module calls the keys **entities**. Each entity is
always represented by its string id, no matter whether the entity is a word, a document or a graph node.

Why use KeyedVectors instead of a full model?
=============================================

+---------------------------+--------------+------------+-------------------------------------------------------------+
|        capability         | KeyedVectors | full model |                               note                          |
+---------------------------+--------------+------------+-------------------------------------------------------------+
| continue training vectors | ❌           | ✅         | You need the full model to train or update vectors.         |
+---------------------------+--------------+------------+-------------------------------------------------------------+
| smaller objects           | ✅           | ❌         | KeyedVectors are smaller and need less RAM, because they    |
|                           |              |            | don't need to store the model state that enables training.  |
+---------------------------+--------------+------------+-------------------------------------------------------------+
| save/load from native     |              |            | Vectors exported by the Facebook and Google tools           |
| fasttext/word2vec format  | ✅           | ❌         | do not support further training, but you can still load     |
|                           |              |            | them into KeyedVectors.                                     |
+---------------------------+--------------+------------+-------------------------------------------------------------+
| append new vectors        | ✅           | ✅         | Add new entity-vector entries to the mapping dynamically.   |
+---------------------------+--------------+------------+-------------------------------------------------------------+
| concurrency               | ✅           | ✅         | Thread-safe, allows concurrent vector queries.              |
+---------------------------+--------------+------------+-------------------------------------------------------------+
| shared RAM                | ✅           | ✅         | Multiple processes can re-use the same data, keeping only   |
|                           |              |            | a single copy in RAM using                                  |
|                           |              |            | `mmap &lt;https://en.wikipedia.org/wiki/Mmap&gt;`_.               |
+---------------------------+--------------+------------+-------------------------------------------------------------+
| fast load                 | ✅           | ✅         | Supports `mmap &lt;https://en.wikipedia.org/wiki/Mmap&gt;`_       |
|                           |              |            | to load data from disk instantaneously.                     |
+---------------------------+--------------+------------+-------------------------------------------------------------+

TL;DR: the main difference is that KeyedVectors do not support further training.
On the other hand, by shedding the internal data structures necessary for training, KeyedVectors offer a smaller RAM
footprint and a simpler interface.

How to obtain word vectors?
===========================

Train a full model, then access its `model.wv` property, which holds the standalone keyed vectors.
For example, using the Word2Vec algorithm to train the vectors

.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.test.utils import common_texts
    &gt;&gt;&gt; from gensim.models import Word2Vec
    &gt;&gt;&gt;
    &gt;&gt;&gt; model = Word2Vec(common_texts, size=100, window=5, min_count=1, workers=4)
    &gt;&gt;&gt; word_vectors = model.wv

Persist the word vectors to disk with

.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.test.utils import get_tmpfile
    &gt;&gt;&gt; from gensim.models import KeyedVectors
    &gt;&gt;&gt;
    &gt;&gt;&gt; fname = get_tmpfile("vectors.kv")
    &gt;&gt;&gt; word_vectors.save(fname)
    &gt;&gt;&gt; word_vectors = KeyedVectors.load(fname, mmap='r')

The vectors can also be instantiated from an existing file on disk
in the original Google's word2vec C format as a KeyedVectors instance

.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.test.utils import datapath
    &gt;&gt;&gt;
    &gt;&gt;&gt; wv_from_text = KeyedVectors.load_word2vec_format(datapath('word2vec_pre_kv_c'), binary=False)  # C text format
    &gt;&gt;&gt; wv_from_bin = KeyedVectors.load_word2vec_format(datapath("euclidean_vectors.bin"), binary=True)  # C bin format

What can I do with word vectors?
================================

You can perform various syntactic/semantic NLP word tasks with the trained vectors.
Some of them are already built-in

.. sourcecode:: pycon

    &gt;&gt;&gt; import gensim.downloader as api
    &gt;&gt;&gt;
    &gt;&gt;&gt; word_vectors = api.load("glove-wiki-gigaword-100")  # load pre-trained word-vectors from gensim-data
    &gt;&gt;&gt;
    &gt;&gt;&gt; result = word_vectors.most_similar(positive=['woman', 'king'], negative=['man'])
    &gt;&gt;&gt; print("{}: {:.4f}".format(*result[0]))
    queen: 0.7699
    &gt;&gt;&gt;
    &gt;&gt;&gt; result = word_vectors.most_similar_cosmul(positive=['woman', 'king'], negative=['man'])
    &gt;&gt;&gt; print("{}: {:.4f}".format(*result[0]))
    queen: 0.8965
    &gt;&gt;&gt;
    &gt;&gt;&gt; print(word_vectors.doesnt_match("breakfast cereal dinner lunch".split()))
    cereal
    &gt;&gt;&gt;
    &gt;&gt;&gt; similarity = word_vectors.similarity('woman', 'man')
    &gt;&gt;&gt; similarity &gt; 0.8
    True
    &gt;&gt;&gt;
    &gt;&gt;&gt; result = word_vectors.similar_by_word("cat")
    &gt;&gt;&gt; print("{}: {:.4f}".format(*result[0]))
    dog: 0.8798
    &gt;&gt;&gt;
    &gt;&gt;&gt; sentence_obama = 'Obama speaks to the media in Illinois'.lower().split()
    &gt;&gt;&gt; sentence_president = 'The president greets the press in Chicago'.lower().split()
    &gt;&gt;&gt;
    &gt;&gt;&gt; similarity = word_vectors.wmdistance(sentence_obama, sentence_president)
    &gt;&gt;&gt; print("{:.4f}".format(similarity))
    3.4893
    &gt;&gt;&gt;
    &gt;&gt;&gt; distance = word_vectors.distance("media", "media")
    &gt;&gt;&gt; print("{:.1f}".format(distance))
    0.0
    &gt;&gt;&gt;
    &gt;&gt;&gt; sim = word_vectors.n_similarity(['sushi', 'shop'], ['japanese', 'restaurant'])
    &gt;&gt;&gt; print("{:.4f}".format(sim))
    0.7067
    &gt;&gt;&gt;
    &gt;&gt;&gt; vector = word_vectors['computer']  # numpy vector of a word
    &gt;&gt;&gt; vector.shape
    (100,)
    &gt;&gt;&gt;
    &gt;&gt;&gt; vector = word_vectors.wv.word_vec('office', use_norm=True)
    &gt;&gt;&gt; vector.shape
    (100,)

Correlation with human opinion on word similarity

.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.test.utils import datapath
    &gt;&gt;&gt;
    &gt;&gt;&gt; similarities = model.wv.evaluate_word_pairs(datapath('wordsim353.tsv'))

And on word analogies

.. sourcecode:: pycon

    &gt;&gt;&gt; analogy_scores = model.wv.evaluate_word_analogies(datapath('questions-words.txt'))

and so on.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="afefb78b84865e3d9bc077e9f0bc14ae8" name="afefb78b84865e3d9bc077e9f0bc14ae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afefb78b84865e3d9bc077e9f0bc14ae8">&#9670;&#160;</a></span>_l2_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors._l2_norm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>replace</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return an L2-normalized version of a matrix.

Parameters
----------
m : np.array
    The matrix to normalize.
replace : boolean, optional
    If True, modifies the existing matrix.

Returns
-------
The normalized matrix.  If replace=True, this will be the same as m.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2369</span><span class="keyword">def </span>_l2_norm(m, replace=False):</div>
<div class="line"><span class="lineno"> 2370</span>    <span class="stringliteral">&quot;&quot;&quot;Return an L2-normalized version of a matrix.</span></div>
<div class="line"><span class="lineno"> 2371</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2372</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2373</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2374</span><span class="stringliteral">    m : np.array</span></div>
<div class="line"><span class="lineno"> 2375</span><span class="stringliteral">        The matrix to normalize.</span></div>
<div class="line"><span class="lineno"> 2376</span><span class="stringliteral">    replace : boolean, optional</span></div>
<div class="line"><span class="lineno"> 2377</span><span class="stringliteral">        If True, modifies the existing matrix.</span></div>
<div class="line"><span class="lineno"> 2378</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2379</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2380</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2381</span><span class="stringliteral">    The normalized matrix.  If replace=True, this will be the same as m.</span></div>
<div class="line"><span class="lineno"> 2382</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2383</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2384</span>    dist = sqrt((m ** 2).sum(-1))[..., newaxis]</div>
<div class="line"><span class="lineno"> 2385</span>    <span class="keywordflow">if</span> replace:</div>
<div class="line"><span class="lineno"> 2386</span>        m /= dist</div>
<div class="line"><span class="lineno"> 2387</span>        <span class="keywordflow">return</span> m</div>
<div class="line"><span class="lineno"> 2388</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2389</span>        <span class="keywordflow">return</span> (m / dist).astype(REAL)</div>
<div class="line"><span class="lineno"> 2390</span> </div>
<div class="line"><span class="lineno"> 2391</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab34ed3f752ef039fbef56caed9dfb26a" name="ab34ed3f752ef039fbef56caed9dfb26a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab34ed3f752ef039fbef56caed9dfb26a">&#9670;&#160;</a></span>_pad_random()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors._pad_random </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>new_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Pad a matrix with additional rows filled with random values.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2361</span><span class="keyword">def </span>_pad_random(m, new_rows, rand):</div>
<div class="line"><span class="lineno"> 2362</span>    <span class="stringliteral">&quot;&quot;&quot;Pad a matrix with additional rows filled with random values.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2363</span>    rows, columns = m.shape</div>
<div class="line"><span class="lineno"> 2364</span>    low, high = -1.0 / columns, 1.0 / columns</div>
<div class="line"><span class="lineno"> 2365</span>    suffix = rand.uniform(low, high, (new_rows, columns)).astype(REAL)</div>
<div class="line"><span class="lineno"> 2366</span>    <span class="keywordflow">return</span> vstack([m, suffix])</div>
<div class="line"><span class="lineno"> 2367</span> </div>
<div class="line"><span class="lineno"> 2368</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e7f2c637ffbc9cc0537bd2687f384be" name="a8e7f2c637ffbc9cc0537bd2687f384be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e7f2c637ffbc9cc0537bd2687f384be">&#9670;&#160;</a></span>_process_fasttext_vocab()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors._process_fasttext_vocab </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_buckets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compatible_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Performs a common operation for FastText weight initialization and
updates: scan the vocabulary, calculate ngrams and their hashes, keep
track of new ngrams, the buckets that each word relates to via its
ngrams, etc.

Parameters
----------
iterable : list
    A list of (word, :class:`Vocab`) tuples.
min_n : int
    The minimum length of ngrams.
max_n : int
    The maximum length of ngrams.
num_buckets : int
    The number of buckets used by the model.
compatible_hash : boolean
    True for compatibility with the Facebook implementation.
    False for compatibility with the old Gensim implementation.

Returns
-------
dict
    Keys are indices of entities in the vocabulary (words).  Values are
    arrays containing indices into vectors_ngrams for each ngram of the
    word.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2318</span><span class="keyword">def </span>_process_fasttext_vocab(iterable, min_n, max_n, num_buckets, compatible_hash):</div>
<div class="line"><span class="lineno"> 2319</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2320</span><span class="stringliteral">    Performs a common operation for FastText weight initialization and</span></div>
<div class="line"><span class="lineno"> 2321</span><span class="stringliteral">    updates: scan the vocabulary, calculate ngrams and their hashes, keep</span></div>
<div class="line"><span class="lineno"> 2322</span><span class="stringliteral">    track of new ngrams, the buckets that each word relates to via its</span></div>
<div class="line"><span class="lineno"> 2323</span><span class="stringliteral">    ngrams, etc.</span></div>
<div class="line"><span class="lineno"> 2324</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2325</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2326</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2327</span><span class="stringliteral">    iterable : list</span></div>
<div class="line"><span class="lineno"> 2328</span><span class="stringliteral">        A list of (word, :class:`Vocab`) tuples.</span></div>
<div class="line"><span class="lineno"> 2329</span><span class="stringliteral">    min_n : int</span></div>
<div class="line"><span class="lineno"> 2330</span><span class="stringliteral">        The minimum length of ngrams.</span></div>
<div class="line"><span class="lineno"> 2331</span><span class="stringliteral">    max_n : int</span></div>
<div class="line"><span class="lineno"> 2332</span><span class="stringliteral">        The maximum length of ngrams.</span></div>
<div class="line"><span class="lineno"> 2333</span><span class="stringliteral">    num_buckets : int</span></div>
<div class="line"><span class="lineno"> 2334</span><span class="stringliteral">        The number of buckets used by the model.</span></div>
<div class="line"><span class="lineno"> 2335</span><span class="stringliteral">    compatible_hash : boolean</span></div>
<div class="line"><span class="lineno"> 2336</span><span class="stringliteral">        True for compatibility with the Facebook implementation.</span></div>
<div class="line"><span class="lineno"> 2337</span><span class="stringliteral">        False for compatibility with the old Gensim implementation.</span></div>
<div class="line"><span class="lineno"> 2338</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2339</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2340</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2341</span><span class="stringliteral">    dict</span></div>
<div class="line"><span class="lineno"> 2342</span><span class="stringliteral">        Keys are indices of entities in the vocabulary (words).  Values are</span></div>
<div class="line"><span class="lineno"> 2343</span><span class="stringliteral">        arrays containing indices into vectors_ngrams for each ngram of the</span></div>
<div class="line"><span class="lineno"> 2344</span><span class="stringliteral">        word.</span></div>
<div class="line"><span class="lineno"> 2345</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2346</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2347</span>    word_indices = {}</div>
<div class="line"><span class="lineno"> 2348</span> </div>
<div class="line"><span class="lineno"> 2349</span>    <span class="keywordflow">if</span> num_buckets == 0:</div>
<div class="line"><span class="lineno"> 2350</span>        <span class="keywordflow">return</span> {v.index: np.array([], dtype=np.uint32) <span class="keywordflow">for</span> w, v <span class="keywordflow">in</span> iterable}</div>
<div class="line"><span class="lineno"> 2351</span> </div>
<div class="line"><span class="lineno"> 2352</span>    <span class="keywordflow">for</span> word, vocab <span class="keywordflow">in</span> iterable:</div>
<div class="line"><span class="lineno"> 2353</span>        wi = []</div>
<div class="line"><span class="lineno"> 2354</span>        <span class="keywordflow">for</span> ngram_hash <span class="keywordflow">in</span> ft_ngram_hashes(word, min_n, max_n, num_buckets, compatible_hash):</div>
<div class="line"><span class="lineno"> 2355</span>            wi.append(ngram_hash)</div>
<div class="line"><span class="lineno"> 2356</span>        word_indices[vocab.index] = np.array(wi, dtype=np.uint32)</div>
<div class="line"><span class="lineno"> 2357</span> </div>
<div class="line"><span class="lineno"> 2358</span>    <span class="keywordflow">return</span> word_indices</div>
<div class="line"><span class="lineno"> 2359</span> </div>
<div class="line"><span class="lineno"> 2360</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae43132c3b55cae100ca04fa5ece1d133" name="ae43132c3b55cae100ca04fa5ece1d133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae43132c3b55cae100ca04fa5ece1d133">&#9670;&#160;</a></span>_rollback_optimization()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors._rollback_optimization </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Undo the optimization that pruned buckets.

This unfortunate optimization saves memory and CPU cycles, but breaks
compatibility with Facebook's model by introducing divergent behavior
for OOV words.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2392</span><span class="keyword">def </span>_rollback_optimization(kv):</div>
<div class="line"><span class="lineno"> 2393</span>    <span class="stringliteral">&quot;&quot;&quot;Undo the optimization that pruned buckets.</span></div>
<div class="line"><span class="lineno"> 2394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2395</span><span class="stringliteral">    This unfortunate optimization saves memory and CPU cycles, but breaks</span></div>
<div class="line"><span class="lineno"> 2396</span><span class="stringliteral">    compatibility with Facebook&#39;s model by introducing divergent behavior</span></div>
<div class="line"><span class="lineno"> 2397</span><span class="stringliteral">    for OOV words.</span></div>
<div class="line"><span class="lineno"> 2398</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2399</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2400</span>    logger.warning(</div>
<div class="line"><span class="lineno"> 2401</span>        <span class="stringliteral">&quot;This saved FastText model was trained with an optimization we no longer support. &quot;</span></div>
<div class="line"><span class="lineno"> 2402</span>        <span class="stringliteral">&quot;The current Gensim version automatically reverses this optimization during loading. &quot;</span></div>
<div class="line"><span class="lineno"> 2403</span>        <span class="stringliteral">&quot;Save the loaded model to a new file and reload to suppress this message.&quot;</span></div>
<div class="line"><span class="lineno"> 2404</span>    )</div>
<div class="line"><span class="lineno"> 2405</span>    <span class="keyword">assert</span> hasattr(kv, <span class="stringliteral">&#39;hash2index&#39;</span>)</div>
<div class="line"><span class="lineno"> 2406</span>    <span class="keyword">assert</span> hasattr(kv, <span class="stringliteral">&#39;num_ngram_vectors&#39;</span>)</div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span>    kv.vectors_ngrams = _unpack(kv.vectors_ngrams, kv.bucket, kv.hash2index)</div>
<div class="line"><span class="lineno"> 2409</span> </div>
<div class="line"><span class="lineno"> 2410</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2411</span>    <span class="comment"># We have replaced num_ngram_vectors with a property and deprecated it.</span></div>
<div class="line"><span class="lineno"> 2412</span>    <span class="comment"># We can&#39;t delete it because the new attribute masks the member.</span></div>
<div class="line"><span class="lineno"> 2413</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2414</span>    del kv.hash2index</div>
<div class="line"><span class="lineno"> 2415</span> </div>
<div class="line"><span class="lineno"> 2416</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad249baa6c6b2d5d8897df1a983ce1012" name="ad249baa6c6b2d5d8897df1a983ce1012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad249baa6c6b2d5d8897df1a983ce1012">&#9670;&#160;</a></span>_try_upgrade()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors._try_upgrade </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2516</span><span class="keyword">def </span>_try_upgrade(wv):</div>
<div class="line"><span class="lineno"> 2517</span>    <span class="keywordflow">if</span> hasattr(wv, <span class="stringliteral">&#39;hash2index&#39;</span>):</div>
<div class="line"><span class="lineno"> 2518</span>        _rollback_optimization(wv)</div>
<div class="line"><span class="lineno"> 2519</span> </div>
<div class="line"><span class="lineno"> 2520</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(wv, <span class="stringliteral">&#39;compatible_hash&#39;</span>):</div>
<div class="line"><span class="lineno"> 2521</span>        logger.warning(</div>
<div class="line"><span class="lineno"> 2522</span>            <span class="stringliteral">&quot;This older model was trained with a buggy hash function. &quot;</span></div>
<div class="line"><span class="lineno"> 2523</span>            <span class="stringliteral">&quot;The model will continue to work, but consider training it &quot;</span></div>
<div class="line"><span class="lineno"> 2524</span>            <span class="stringliteral">&quot;from scratch.&quot;</span></div>
<div class="line"><span class="lineno"> 2525</span>        )</div>
<div class="line"><span class="lineno"> 2526</span>        wv.compatible_hash = <span class="keyword">False</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4e64759da1d371e0542c6017a4c9223" name="ab4e64759da1d371e0542c6017a4c9223"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4e64759da1d371e0542c6017a4c9223">&#9670;&#160;</a></span>_unpack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors._unpack </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hash2index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Restore the array to its natural shape, undoing the optimization.

A packed matrix contains contiguous vectors for ngrams, as well as a hashmap.
The hash map maps the ngram hash to its index in the packed matrix.
To unpack the matrix, we need to do several things:

1. Restore the matrix to its "natural" shape, where the number of rows
   equals the number of buckets.
2. Rearrange the existing rows such that the hashmap becomes the identity
   function and is thus redundant.
3. Fill the new rows with random values.

Parameters
----------

m : np.ndarray
    The matrix to restore.
num_rows : int
    The number of rows that this array should have.
hash2index : dict
    the product of the optimization we are undoing.
seed : float, optional
    The seed for the PRNG.  Will be used to initialize new rows.

Returns
-------
np.array
    The unpacked matrix.

Notes
-----

The unpacked matrix will reference some rows in the input matrix to save memory.
Throw away the old matrix after calling this function, or use np.copy.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2443</span><span class="keyword">def </span>_unpack(m, num_rows, hash2index, seed=1):</div>
<div class="line"><span class="lineno"> 2444</span>    <span class="stringliteral">&quot;&quot;&quot;Restore the array to its natural shape, undoing the optimization.</span></div>
<div class="line"><span class="lineno"> 2445</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2446</span><span class="stringliteral">    A packed matrix contains contiguous vectors for ngrams, as well as a hashmap.</span></div>
<div class="line"><span class="lineno"> 2447</span><span class="stringliteral">    The hash map maps the ngram hash to its index in the packed matrix.</span></div>
<div class="line"><span class="lineno"> 2448</span><span class="stringliteral">    To unpack the matrix, we need to do several things:</span></div>
<div class="line"><span class="lineno"> 2449</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2450</span><span class="stringliteral">    1. Restore the matrix to its &quot;natural&quot; shape, where the number of rows</span></div>
<div class="line"><span class="lineno"> 2451</span><span class="stringliteral">       equals the number of buckets.</span></div>
<div class="line"><span class="lineno"> 2452</span><span class="stringliteral">    2. Rearrange the existing rows such that the hashmap becomes the identity</span></div>
<div class="line"><span class="lineno"> 2453</span><span class="stringliteral">       function and is thus redundant.</span></div>
<div class="line"><span class="lineno"> 2454</span><span class="stringliteral">    3. Fill the new rows with random values.</span></div>
<div class="line"><span class="lineno"> 2455</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2456</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2457</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2458</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2459</span><span class="stringliteral">    m : np.ndarray</span></div>
<div class="line"><span class="lineno"> 2460</span><span class="stringliteral">        The matrix to restore.</span></div>
<div class="line"><span class="lineno"> 2461</span><span class="stringliteral">    num_rows : int</span></div>
<div class="line"><span class="lineno"> 2462</span><span class="stringliteral">        The number of rows that this array should have.</span></div>
<div class="line"><span class="lineno"> 2463</span><span class="stringliteral">    hash2index : dict</span></div>
<div class="line"><span class="lineno"> 2464</span><span class="stringliteral">        the product of the optimization we are undoing.</span></div>
<div class="line"><span class="lineno"> 2465</span><span class="stringliteral">    seed : float, optional</span></div>
<div class="line"><span class="lineno"> 2466</span><span class="stringliteral">        The seed for the PRNG.  Will be used to initialize new rows.</span></div>
<div class="line"><span class="lineno"> 2467</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2468</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2469</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2470</span><span class="stringliteral">    np.array</span></div>
<div class="line"><span class="lineno"> 2471</span><span class="stringliteral">        The unpacked matrix.</span></div>
<div class="line"><span class="lineno"> 2472</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2473</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2474</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2475</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2476</span><span class="stringliteral">    The unpacked matrix will reference some rows in the input matrix to save memory.</span></div>
<div class="line"><span class="lineno"> 2477</span><span class="stringliteral">    Throw away the old matrix after calling this function, or use np.copy.</span></div>
<div class="line"><span class="lineno"> 2478</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2479</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2480</span>    orig_rows, orig_columns = m.shape</div>
<div class="line"><span class="lineno"> 2481</span>    <span class="keywordflow">if</span> orig_rows == num_rows:</div>
<div class="line"><span class="lineno"> 2482</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2483</span>        <span class="comment"># Nothing to do.</span></div>
<div class="line"><span class="lineno"> 2484</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2485</span>        <span class="keywordflow">return</span> m</div>
<div class="line"><span class="lineno"> 2486</span>    <span class="keyword">assert</span> num_rows &gt; orig_rows</div>
<div class="line"><span class="lineno"> 2487</span> </div>
<div class="line"><span class="lineno"> 2488</span>    rand_obj = np.random</div>
<div class="line"><span class="lineno"> 2489</span>    rand_obj.seed(seed)</div>
<div class="line"><span class="lineno"> 2490</span> </div>
<div class="line"><span class="lineno"> 2491</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2492</span>    <span class="comment"># Rows at the top of the matrix (the first orig_rows) will contain &quot;packed&quot; learned vectors.</span></div>
<div class="line"><span class="lineno"> 2493</span>    <span class="comment"># Rows at the bottom of the matrix will be &quot;free&quot;: initialized to random values.</span></div>
<div class="line"><span class="lineno"> 2494</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2495</span>    m = _pad_random(m, num_rows - orig_rows, rand_obj)</div>
<div class="line"><span class="lineno"> 2496</span> </div>
<div class="line"><span class="lineno"> 2497</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2498</span>    <span class="comment"># Swap rows to transform hash2index into the identify function.</span></div>
<div class="line"><span class="lineno"> 2499</span>    <span class="comment"># There are two kinds of swaps.</span></div>
<div class="line"><span class="lineno"> 2500</span>    <span class="comment"># First, rearrange the rows that belong entirely within the original matrix dimensions.</span></div>
<div class="line"><span class="lineno"> 2501</span>    <span class="comment"># Second, swap out rows from the original matrix dimensions, replacing them with</span></div>
<div class="line"><span class="lineno"> 2502</span>    <span class="comment"># randomly initialized values.</span></div>
<div class="line"><span class="lineno"> 2503</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2504</span>    <span class="comment"># N.B. We only do the swap in one direction, because doing it in both directions</span></div>
<div class="line"><span class="lineno"> 2505</span>    <span class="comment"># nullifies the effect.</span></div>
<div class="line"><span class="lineno"> 2506</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2507</span>    swap = {h: i <span class="keywordflow">for</span> (h, i) <span class="keywordflow">in</span> hash2index.items() <span class="keywordflow">if</span> h &lt; i &lt; orig_rows}</div>
<div class="line"><span class="lineno"> 2508</span>    swap.update({h: i <span class="keywordflow">for</span> (h, i) <span class="keywordflow">in</span> hash2index.items() <span class="keywordflow">if</span> h &gt;= orig_rows})</div>
<div class="line"><span class="lineno"> 2509</span>    <span class="keywordflow">for</span> h, i <span class="keywordflow">in</span> swap.items():</div>
<div class="line"><span class="lineno"> 2510</span>        <span class="keyword">assert</span> h != i</div>
<div class="line"><span class="lineno"> 2511</span>        m[[h, i]] = m[[i, h]]  <span class="comment"># swap rows i and h</span></div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>    <span class="keywordflow">return</span> m</div>
<div class="line"><span class="lineno"> 2514</span> </div>
<div class="line"><span class="lineno"> 2515</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aadbe4696abfa0ef202434330dc8332c4" name="aadbe4696abfa0ef202434330dc8332c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadbe4696abfa0ef202434330dc8332c4">&#9670;&#160;</a></span>_unpack_copy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors._unpack_copy </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hash2index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Same as _unpack, but makes a copy of the matrix.

Simpler implementation, but uses more RAM.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2417</span><span class="keyword">def </span>_unpack_copy(m, num_rows, hash2index, seed=1):</div>
<div class="line"><span class="lineno"> 2418</span>    <span class="stringliteral">&quot;&quot;&quot;Same as _unpack, but makes a copy of the matrix.</span></div>
<div class="line"><span class="lineno"> 2419</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2420</span><span class="stringliteral">    Simpler implementation, but uses more RAM.</span></div>
<div class="line"><span class="lineno"> 2421</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2422</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2423</span>    rows, columns = m.shape</div>
<div class="line"><span class="lineno"> 2424</span>    <span class="keywordflow">if</span> rows == num_rows:</div>
<div class="line"><span class="lineno"> 2425</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2426</span>        <span class="comment"># Nothing to do.</span></div>
<div class="line"><span class="lineno"> 2427</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 2428</span>        <span class="keywordflow">return</span> m</div>
<div class="line"><span class="lineno"> 2429</span>    <span class="keyword">assert</span> num_rows &gt; rows</div>
<div class="line"><span class="lineno"> 2430</span> </div>
<div class="line"><span class="lineno"> 2431</span>    rand_obj = np.random</div>
<div class="line"><span class="lineno"> 2432</span>    rand_obj.seed(seed)</div>
<div class="line"><span class="lineno"> 2433</span> </div>
<div class="line"><span class="lineno"> 2434</span>    n = np.empty((0, columns), dtype=m.dtype)</div>
<div class="line"><span class="lineno"> 2435</span>    n = _pad_random(n, num_rows, rand_obj)</div>
<div class="line"><span class="lineno"> 2436</span> </div>
<div class="line"><span class="lineno"> 2437</span>    <span class="keywordflow">for</span> src, dst <span class="keywordflow">in</span> hash2index.items():</div>
<div class="line"><span class="lineno"> 2438</span>        n[src] = m[dst]</div>
<div class="line"><span class="lineno"> 2439</span> </div>
<div class="line"><span class="lineno"> 2440</span>    <span class="keywordflow">return</span> n</div>
<div class="line"><span class="lineno"> 2441</span> </div>
<div class="line"><span class="lineno"> 2442</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2b95cbce987467e38e937f4cc7515e95" name="a2b95cbce987467e38e937f4cc7515e95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b95cbce987467e38e937f4cc7515e95">&#9670;&#160;</a></span>KeyedVectors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors.KeyedVectors = <a class="el" href="classgensim_1_1models_1_1keyedvectors_1_1_word2_vec_keyed_vectors.html">Word2VecKeyedVectors</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1793f79e7bfdb2e4484739dce27ab207" name="a1793f79e7bfdb2e4484739dce27ab207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1793f79e7bfdb2e4484739dce27ab207">&#9670;&#160;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.models.keyedvectors.logger = logging.getLogger(__name__)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
