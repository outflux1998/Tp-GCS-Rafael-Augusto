<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.stats._binomtest Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1__binomtest.html">_binomtest</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats._binomtest Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__binomtest_1_1_binom_test_result.html">BinomTestResult</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a54cbff7d40579adb69706ece965d3ca1" id="r_a54cbff7d40579adb69706ece965d3ca1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__binomtest.html#a54cbff7d40579adb69706ece965d3ca1">_findp</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:a54cbff7d40579adb69706ece965d3ca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ac7df055dcf2e8757ce2db53b56c72" id="r_ab4ac7df055dcf2e8757ce2db53b56c72"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__binomtest.html#ab4ac7df055dcf2e8757ce2db53b56c72">_binom_exact_conf_int</a> (<a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, confidence_level, alternative)</td></tr>
<tr class="separator:ab4ac7df055dcf2e8757ce2db53b56c72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99be4720c8569933ed149f3a657f98b8" id="r_a99be4720c8569933ed149f3a657f98b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__binomtest.html#a99be4720c8569933ed149f3a657f98b8">_binom_wilson_conf_int</a> (<a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, confidence_level, alternative, correction)</td></tr>
<tr class="separator:a99be4720c8569933ed149f3a657f98b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e01b0e1b04568dd51866a37d703906" id="r_a13e01b0e1b04568dd51866a37d703906"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__binomtest.html#a13e01b0e1b04568dd51866a37d703906">binomtest</a> (<a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, p=0.5, alternative='two-sided')</td></tr>
<tr class="separator:a13e01b0e1b04568dd51866a37d703906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0045f4f12e23e678c49836777aa33c81" id="r_a0045f4f12e23e678c49836777aa33c81"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__binomtest.html#a0045f4f12e23e678c49836777aa33c81">_binary_search_for_binom_tst</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, <a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>, lo, <a class="el" href="hi77_8f.html#af751d504092e46d5821a80bd42954a8a">hi</a>)</td></tr>
<tr class="separator:a0045f4f12e23e678c49836777aa33c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0045f4f12e23e678c49836777aa33c81" name="a0045f4f12e23e678c49836777aa33c81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0045f4f12e23e678c49836777aa33c81">&#9670;&#160;</a></span>_binary_search_for_binom_tst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._binomtest._binary_search_for_binom_tst </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Conducts an implicit binary search on a function specified by `a`.

Meant to be used on the binomial PMF for the case of two-sided tests
to obtain the value on the other side of the mode where the tail
probability should be computed. The values on either side of
the mode are always in order, meaning binary search is applicable.

Parameters
----------
a : callable
  The function over which to perform binary search. Its values
  for inputs lo and hi should be in ascending order.
d : float
  The value to search.
lo : int
  The lower end of range to search.
hi : int
  The higher end of the range to search.

Returns
-------
int
  The index, i between lo and hi
  such that a(i)&lt;=d&lt;a(i+1)
</pre> <div class="fragment"><div class="line"><span class="lineno">  332</span><span class="keyword">def </span>_binary_search_for_binom_tst(a, d, lo, hi):</div>
<div class="line"><span class="lineno">  333</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    Conducts an implicit binary search on a function specified by `a`.</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    Meant to be used on the binomial PMF for the case of two-sided tests</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    to obtain the value on the other side of the mode where the tail</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    probability should be computed. The values on either side of</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">    the mode are always in order, meaning binary search is applicable.</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    a : callable</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">      The function over which to perform binary search. Its values</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">      for inputs lo and hi should be in ascending order.</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    d : float</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">      The value to search.</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">    lo : int</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">      The lower end of range to search.</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    hi : int</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">      The higher end of the range to search.</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    int</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">      The index, i between lo and hi</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">      such that a(i)&lt;=d&lt;a(i+1)</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">while</span> lo &lt; hi:</div>
<div class="line"><span class="lineno">  360</span>        mid = lo + (hi-lo)//2</div>
<div class="line"><span class="lineno">  361</span>        midval = <a class="code hl_variable" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>(mid)</div>
<div class="line"><span class="lineno">  362</span>        <span class="keywordflow">if</span> midval &lt; d:</div>
<div class="line"><span class="lineno">  363</span>            lo = mid+1</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">elif</span> midval &gt; d:</div>
<div class="line"><span class="lineno">  365</span>            hi = mid-1</div>
<div class="line"><span class="lineno">  366</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">return</span> mid</div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">if</span> <a class="code hl_variable" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>(lo) &lt;= d:</div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">return</span> lo</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  371</span>        <span class="keywordflow">return</span> lo-1</div>
<div class="ttc" id="a__blas__subroutines_8h_html_a4da0a64c77789ca4c8115aef76120fd2"><div class="ttname"><a href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a></div><div class="ttdeci">void int int int int npy_complex64 npy_complex64 * a</div><div class="ttdef"><b>Definition</b> _blas_subroutines.h:38</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4ac7df055dcf2e8757ce2db53b56c72" name="ab4ac7df055dcf2e8757ce2db53b56c72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ac7df055dcf2e8757ce2db53b56c72">&#9670;&#160;</a></span>_binom_exact_conf_int()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._binomtest._binom_exact_conf_int </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>confidence_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Compute the estimate and confidence interval for the binomial test.

Returns proportion, prop_low, prop_high
</pre> <div class="fragment"><div class="line"><span class="lineno">  126</span><span class="keyword">def </span>_binom_exact_conf_int(k, n, confidence_level, alternative):</div>
<div class="line"><span class="lineno">  127</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    Compute the estimate and confidence interval for the binomial test.</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">    Returns proportion, prop_low, prop_high</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">if</span> alternative == <span class="stringliteral">&#39;two-sided&#39;</span>:</div>
<div class="line"><span class="lineno">  133</span>        alpha = (1 - confidence_level) / 2</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">if</span> k == 0:</div>
<div class="line"><span class="lineno">  135</span>            plow = 0.0</div>
<div class="line"><span class="lineno">  136</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  137</span>            plow = _findp(<span class="keyword">lambda</span> p: binom.sf(k-1, n, p) - alpha)</div>
<div class="line"><span class="lineno">  138</span>        <span class="keywordflow">if</span> k == n:</div>
<div class="line"><span class="lineno">  139</span>            phigh = 1.0</div>
<div class="line"><span class="lineno">  140</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  141</span>            phigh = _findp(<span class="keyword">lambda</span> p: binom.cdf(k, n, p) - alpha)</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">elif</span> alternative == <span class="stringliteral">&#39;less&#39;</span>:</div>
<div class="line"><span class="lineno">  143</span>        alpha = 1 - confidence_level</div>
<div class="line"><span class="lineno">  144</span>        plow = 0.0</div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">if</span> k == n:</div>
<div class="line"><span class="lineno">  146</span>            phigh = 1.0</div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  148</span>            phigh = _findp(<span class="keyword">lambda</span> p: binom.cdf(k, n, p) - alpha)</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">elif</span> alternative == <span class="stringliteral">&#39;greater&#39;</span>:</div>
<div class="line"><span class="lineno">  150</span>        alpha = 1 - confidence_level</div>
<div class="line"><span class="lineno">  151</span>        <span class="keywordflow">if</span> k == 0:</div>
<div class="line"><span class="lineno">  152</span>            plow = 0.0</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  154</span>            plow = _findp(<span class="keyword">lambda</span> p: binom.sf(k-1, n, p) - alpha)</div>
<div class="line"><span class="lineno">  155</span>        phigh = 1.0</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">return</span> plow, phigh</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a99be4720c8569933ed149f3a657f98b8" name="a99be4720c8569933ed149f3a657f98b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99be4720c8569933ed149f3a657f98b8">&#9670;&#160;</a></span>_binom_wilson_conf_int()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._binomtest._binom_wilson_conf_int </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>confidence_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>correction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  159</span><span class="keyword">def </span>_binom_wilson_conf_int(k, n, confidence_level, alternative, correction):</div>
<div class="line"><span class="lineno">  160</span>    <span class="comment"># This function assumes that the arguments have already been validated.</span></div>
<div class="line"><span class="lineno">  161</span>    <span class="comment"># In particular, `alternative` must be one of &#39;two-sided&#39;, &#39;less&#39; or</span></div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># &#39;greater&#39;.</span></div>
<div class="line"><span class="lineno">  163</span>    p = k / n</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">if</span> alternative == <span class="stringliteral">&#39;two-sided&#39;</span>:</div>
<div class="line"><span class="lineno">  165</span>        z = ndtri(0.5 + 0.5*confidence_level)</div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  167</span>        z = ndtri(confidence_level)</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    <span class="comment"># For reference, the formulas implemented here are from</span></div>
<div class="line"><span class="lineno">  170</span>    <span class="comment"># Newcombe (1998) (ref. [3] in the proportion_ci docstring).</span></div>
<div class="line"><span class="lineno">  171</span>    denom = 2*(n + z**2)</div>
<div class="line"><span class="lineno">  172</span>    center = (2*n*p + z**2)/denom</div>
<div class="line"><span class="lineno">  173</span>    q = 1 - p</div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">if</span> correction:</div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordflow">if</span> alternative == <span class="stringliteral">&#39;less&#39;</span> <span class="keywordflow">or</span> k == 0:</div>
<div class="line"><span class="lineno">  176</span>            lo = 0.0</div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  178</span>            dlo = (1 + z*sqrt(z**2 - 2 - 1/n + 4*p*(n*q + 1))) / denom</div>
<div class="line"><span class="lineno">  179</span>            lo = center - dlo</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">if</span> alternative == <span class="stringliteral">&#39;greater&#39;</span> <span class="keywordflow">or</span> k == n:</div>
<div class="line"><span class="lineno">  181</span>            hi = 1.0</div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  183</span>            dhi = (1 + z*sqrt(z**2 + 2 - 1/n + 4*p*(n*q - 1))) / denom</div>
<div class="line"><span class="lineno">  184</span>            hi = center + dhi</div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  186</span>        delta = z/denom * sqrt(4*n*p*q + z**2)</div>
<div class="line"><span class="lineno">  187</span>        <span class="keywordflow">if</span> alternative == <span class="stringliteral">&#39;less&#39;</span> <span class="keywordflow">or</span> k == 0:</div>
<div class="line"><span class="lineno">  188</span>            lo = 0.0</div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  190</span>            lo = center - delta</div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordflow">if</span> alternative == <span class="stringliteral">&#39;greater&#39;</span> <span class="keywordflow">or</span> k == n:</div>
<div class="line"><span class="lineno">  192</span>            hi = 1.0</div>
<div class="line"><span class="lineno">  193</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  194</span>            hi = center + delta</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">return</span> lo, hi</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a54cbff7d40579adb69706ece965d3ca1" name="a54cbff7d40579adb69706ece965d3ca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54cbff7d40579adb69706ece965d3ca1">&#9670;&#160;</a></span>_findp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._binomtest._findp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  114</span><span class="keyword">def </span>_findp(func):</div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  116</span>        p = brentq(func, 0, 1)</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">except</span> RuntimeError:</div>
<div class="line"><span class="lineno">  118</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;numerical solver failed to converge when &#39;</span></div>
<div class="line"><span class="lineno">  119</span>                           <span class="stringliteral">&#39;computing the confidence limits&#39;</span>) <span class="keyword">from</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> exc:</div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;brentq raised a ValueError; report this to the &#39;</span></div>
<div class="line"><span class="lineno">  122</span>                         <span class="stringliteral">&#39;SciPy developers&#39;</span>) <span class="keyword">from</span> exc</div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">return</span> p</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a13e01b0e1b04568dd51866a37d703906" name="a13e01b0e1b04568dd51866a37d703906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13e01b0e1b04568dd51866a37d703906">&#9670;&#160;</a></span>binomtest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._binomtest.binomtest </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em> = <code>'two-sided'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Perform a test that the probability of success is p.

The binomial test [1]_ is a test of the null hypothesis that the
probability of success in a Bernoulli experiment is `p`.

Details of the test can be found in many texts on statistics, such
as section 24.5 of [2]_.

Parameters
----------
k : int
    The number of successes.
n : int
    The number of trials.
p : float, optional
    The hypothesized probability of success, i.e. the expected
    proportion of successes.  The value must be in the interval
    ``0 &lt;= p &lt;= 1``. The default value is ``p = 0.5``.
alternative : {'two-sided', 'greater', 'less'}, optional
    Indicates the alternative hypothesis. The default value is
    'two-sided'.

Returns
-------
result : `~scipy.stats._result_classes.BinomTestResult` instance
    The return value is an object with the following attributes:

    k : int
        The number of successes (copied from `binomtest` input).
    n : int
        The number of trials (copied from `binomtest` input).
    alternative : str
        Indicates the alternative hypothesis specified in the input
        to `binomtest`.  It will be one of ``'two-sided'``, ``'greater'``,
        or ``'less'``.
    pvalue : float
        The p-value of the hypothesis test.
    proportion_estimate : float
        The estimate of the proportion of successes.

    The object has the following methods:

    proportion_ci(confidence_level=0.95, method='exact') :
        Compute the confidence interval for ``proportion_estimate``.

Notes
-----
.. versionadded:: 1.7.0

References
----------
.. [1] Binomial test, https://en.wikipedia.org/wiki/Binomial_test
.. [2] Jerrold H. Zar, Biostatistical Analysis (fifth edition),
       Prentice Hall, Upper Saddle River, New Jersey USA (2010)

Examples
--------
&gt;&gt;&gt; from scipy.stats import binomtest

A car manufacturer claims that no more than 10% of their cars are unsafe.
15 cars are inspected for safety, 3 were found to be unsafe. Test the
manufacturer's claim:

&gt;&gt;&gt; result = binomtest(3, n=15, p=0.1, alternative='greater')
&gt;&gt;&gt; result.pvalue
0.18406106910639114

The null hypothesis cannot be rejected at the 5% level of significance
because the returned p-value is greater than the critical value of 5%.

The estimated proportion is simply ``3/15``:

&gt;&gt;&gt; result.proportion_estimate
0.2

We can use the `proportion_ci()` method of the result to compute the
confidence interval of the estimate:

&gt;&gt;&gt; result.proportion_ci(confidence_level=0.95)
ConfidenceInterval(low=0.05684686759024681, high=1.0)</pre> <div class="fragment"><div class="line"><span class="lineno">  199</span><span class="keyword">def </span>binomtest(k, n, p=0.5, alternative=&#39;two-sided&#39;):</div>
<div class="line"><span class="lineno">  200</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">    Perform a test that the probability of success is p.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">    The binomial test [1]_ is a test of the null hypothesis that the</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    probability of success in a Bernoulli experiment is `p`.</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    Details of the test can be found in many texts on statistics, such</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    as section 24.5 of [2]_.</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    k : int</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">        The number of successes.</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">        The number of trials.</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    p : float, optional</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">        The hypothesized probability of success, i.e. the expected</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">        proportion of successes.  The value must be in the interval</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">        ``0 &lt;= p &lt;= 1``. The default value is ``p = 0.5``.</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    alternative : {&#39;two-sided&#39;, &#39;greater&#39;, &#39;less&#39;}, optional</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">        Indicates the alternative hypothesis. The default value is</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">        &#39;two-sided&#39;.</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">    result : `~scipy.stats._result_classes.BinomTestResult` instance</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">        The return value is an object with the following attributes:</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">        k : int</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">            The number of successes (copied from `binomtest` input).</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">        n : int</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">            The number of trials (copied from `binomtest` input).</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">        alternative : str</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">            Indicates the alternative hypothesis specified in the input</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">            to `binomtest`.  It will be one of ``&#39;two-sided&#39;``, ``&#39;greater&#39;``,</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">            or ``&#39;less&#39;``.</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">        pvalue : float</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">            The p-value of the hypothesis test.</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">        proportion_estimate : float</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">            The estimate of the proportion of successes.</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">        The object has the following methods:</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">        proportion_ci(confidence_level=0.95, method=&#39;exact&#39;) :</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">            Compute the confidence interval for ``proportion_estimate``.</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    .. versionadded:: 1.7.0</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    .. [1] Binomial test, https://en.wikipedia.org/wiki/Binomial_test</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    .. [2] Jerrold H. Zar, Biostatistical Analysis (fifth edition),</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">           Prentice Hall, Upper Saddle River, New Jersey USA (2010)</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import binomtest</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    A car manufacturer claims that no more than 10% of their cars are unsafe.</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    15 cars are inspected for safety, 3 were found to be unsafe. Test the</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">    manufacturer&#39;s claim:</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    &gt;&gt;&gt; result = binomtest(3, n=15, p=0.1, alternative=&#39;greater&#39;)</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    &gt;&gt;&gt; result.pvalue</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    0.18406106910639114</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    The null hypothesis cannot be rejected at the 5% level of significance</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    because the returned p-value is greater than the critical value of 5%.</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">    The estimated proportion is simply ``3/15``:</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    &gt;&gt;&gt; result.proportion_estimate</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    0.2</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    We can use the `proportion_ci()` method of the result to compute the</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    confidence interval of the estimate:</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">    &gt;&gt;&gt; result.proportion_ci(confidence_level=0.95)</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">    ConfidenceInterval(low=0.05684686759024681, high=1.0)</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  283</span>    k = _validate_int(k, <span class="stringliteral">&#39;k&#39;</span>, minimum=0)</div>
<div class="line"><span class="lineno">  284</span>    n = _validate_int(n, <span class="stringliteral">&#39;n&#39;</span>, minimum=1)</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">if</span> k &gt; n:</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;k must not be greater than n.&#39;</span>)</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (0 &lt;= p &lt;= 1):</div>
<div class="line"><span class="lineno">  289</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;p must be in range [0,1]&quot;</span>)</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">if</span> alternative <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&#39;two-sided&#39;</span>, <span class="stringliteral">&#39;less&#39;</span>, <span class="stringliteral">&#39;greater&#39;</span>):</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;alternative not recognized; \n&quot;</span></div>
<div class="line"><span class="lineno">  293</span>                         <span class="stringliteral">&quot;must be &#39;two-sided&#39;, &#39;less&#39; or &#39;greater&#39;&quot;</span>)</div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">if</span> alternative == <span class="stringliteral">&#39;less&#39;</span>:</div>
<div class="line"><span class="lineno">  295</span>        pval = binom.cdf(k, n, p)</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">elif</span> alternative == <span class="stringliteral">&#39;greater&#39;</span>:</div>
<div class="line"><span class="lineno">  297</span>        pval = binom.sf(k-1, n, p)</div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  299</span>        <span class="comment"># alternative is &#39;two-sided&#39;</span></div>
<div class="line"><span class="lineno">  300</span>        d = binom.pmf(k, n, p)</div>
<div class="line"><span class="lineno">  301</span>        rerr = 1 + 1e-7</div>
<div class="line"><span class="lineno">  302</span>        <span class="keywordflow">if</span> k == p * n:</div>
<div class="line"><span class="lineno">  303</span>            <span class="comment"># special case as shortcut, would also be handled by `else` below</span></div>
<div class="line"><span class="lineno">  304</span>            pval = 1.</div>
<div class="line"><span class="lineno">  305</span>        <span class="keywordflow">elif</span> k &lt; p * n:</div>
<div class="line"><span class="lineno">  306</span>            ix = _binary_search_for_binom_tst(<span class="keyword">lambda</span> x1: -binom.pmf(x1, n, p),</div>
<div class="line"><span class="lineno">  307</span>                                              -d*rerr, np.ceil(p * n), n)</div>
<div class="line"><span class="lineno">  308</span>            <span class="comment"># y is the number of terms between mode and n that are &lt;= d*rerr.</span></div>
<div class="line"><span class="lineno">  309</span>            <span class="comment"># ix gave us the first term where a(ix) &lt;= d*rerr &lt; a(ix-1)</span></div>
<div class="line"><span class="lineno">  310</span>            <span class="comment"># if the first equality doesn&#39;t hold, y=n-ix. Otherwise, we</span></div>
<div class="line"><span class="lineno">  311</span>            <span class="comment"># need to include ix as well as the equality holds. Note that</span></div>
<div class="line"><span class="lineno">  312</span>            <span class="comment"># the equality will hold in very very rare situations due to rerr.</span></div>
<div class="line"><span class="lineno">  313</span>            y = n - ix + int(d*rerr == binom.pmf(ix, n, p))</div>
<div class="line"><span class="lineno">  314</span>            pval = binom.cdf(k, n, p) + binom.sf(n - y, n, p)</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  316</span>            ix = _binary_search_for_binom_tst(<span class="keyword">lambda</span> x1: binom.pmf(x1, n, p),</div>
<div class="line"><span class="lineno">  317</span>                                              d*rerr, 0, np.floor(p * n))</div>
<div class="line"><span class="lineno">  318</span>            <span class="comment"># y is the number of terms between 0 and mode that are &lt;= d*rerr.</span></div>
<div class="line"><span class="lineno">  319</span>            <span class="comment"># we need to add a 1 to account for the 0 index.</span></div>
<div class="line"><span class="lineno">  320</span>            <span class="comment"># For comparing this with old behavior, see</span></div>
<div class="line"><span class="lineno">  321</span>            <span class="comment"># tst_binary_srch_for_binom_tst method in test_morestats.</span></div>
<div class="line"><span class="lineno">  322</span>            y = ix + 1</div>
<div class="line"><span class="lineno">  323</span>            pval = binom.cdf(y-1, n, p) + binom.sf(k-1, n, p)</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>        pval = min(1.0, pval)</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    result = BinomTestResult(k=k, n=n, alternative=alternative,</div>
<div class="line"><span class="lineno">  328</span>                             proportion_estimate=k/n, pvalue=pval)</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
