<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.linalg._decomp Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1linalg.html">linalg</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html">_decomp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.linalg._decomp Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae419dde39fa4935bdd921c60581ad391" id="r_ae419dde39fa4935bdd921c60581ad391"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#ae419dde39fa4935bdd921c60581ad391">_make_complex_eigvecs</a> (<a class="el" href="__lapack__subroutines_8h.html#a817b85d82af73ef273fafbec623bb90b">w</a>, vin, dtype)</td></tr>
<tr class="separator:ae419dde39fa4935bdd921c60581ad391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16418e9b8561f9096e50d0b5c5598e4" id="r_af16418e9b8561f9096e50d0b5c5598e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#af16418e9b8561f9096e50d0b5c5598e4">_make_eigvals</a> (<a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>, beta, homogeneous_eigvals)</td></tr>
<tr class="separator:af16418e9b8561f9096e50d0b5c5598e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d47a5880d4fcacf815bf61e37fcb478" id="r_a4d47a5880d4fcacf815bf61e37fcb478"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#a4d47a5880d4fcacf815bf61e37fcb478">_geneig</a> (<a class="el" href="__lapack__subroutines_8h.html#ad223529d61b8fe1426f84b016d4381ca">a1</a>, <a class="el" href="__lapack__subroutines_8h.html#a08cfc3794996a7d0b6a9990bf0a43589">b1</a>, left, right, overwrite_a, overwrite_b, homogeneous_eigvals)</td></tr>
<tr class="separator:a4d47a5880d4fcacf815bf61e37fcb478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf818ed3a2db370daa816628c1573ad9" id="r_adf818ed3a2db370daa816628c1573ad9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#adf818ed3a2db370daa816628c1573ad9">eig</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b=None, left=False, right=True, overwrite_a=False, overwrite_b=False, check_finite=True, homogeneous_eigvals=False)</td></tr>
<tr class="separator:adf818ed3a2db370daa816628c1573ad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abad401fa81ef2480a8119fe55741e53d" id="r_abad401fa81ef2480a8119fe55741e53d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#abad401fa81ef2480a8119fe55741e53d">eigh</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b=None, lower=True, eigvals_only=False, overwrite_a=False, overwrite_b=False, turbo=True, <a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#a84379fe233225ca57719634e3daaae31">eigvals</a>=None, type=1, check_finite=True, subset_by_index=None, subset_by_value=None, driver=None)</td></tr>
<tr class="separator:abad401fa81ef2480a8119fe55741e53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d85515b23393bb63634771bfa1b84e8" id="r_a0d85515b23393bb63634771bfa1b84e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#a0d85515b23393bb63634771bfa1b84e8">_check_select</a> (select, select_range, max_ev, max_len)</td></tr>
<tr class="separator:a0d85515b23393bb63634771bfa1b84e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9bd9ce46012cf260f70f80300a5464" id="r_afc9bd9ce46012cf260f70f80300a5464"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#afc9bd9ce46012cf260f70f80300a5464">eig_banded</a> (a_band, lower=False, eigvals_only=False, overwrite_a_band=False, select='<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>', select_range=None, max_ev=0, check_finite=True)</td></tr>
<tr class="separator:afc9bd9ce46012cf260f70f80300a5464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84379fe233225ca57719634e3daaae31" id="r_a84379fe233225ca57719634e3daaae31"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#a84379fe233225ca57719634e3daaae31">eigvals</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b=None, overwrite_a=False, check_finite=True, homogeneous_eigvals=False)</td></tr>
<tr class="separator:a84379fe233225ca57719634e3daaae31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5228dd5bb7c2d9aeff5dcfb1192abd67" id="r_a5228dd5bb7c2d9aeff5dcfb1192abd67"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#a5228dd5bb7c2d9aeff5dcfb1192abd67">eigvalsh</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b=None, lower=True, overwrite_a=False, overwrite_b=False, turbo=True, <a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#a84379fe233225ca57719634e3daaae31">eigvals</a>=None, type=1, check_finite=True, subset_by_index=None, subset_by_value=None, driver=None)</td></tr>
<tr class="separator:a5228dd5bb7c2d9aeff5dcfb1192abd67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd5ac3fa1c4dfa155bce6260a8591dc0" id="r_afd5ac3fa1c4dfa155bce6260a8591dc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#afd5ac3fa1c4dfa155bce6260a8591dc0">eigvals_banded</a> (a_band, lower=False, overwrite_a_band=False, select='<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>', select_range=None, check_finite=True)</td></tr>
<tr class="separator:afd5ac3fa1c4dfa155bce6260a8591dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5546b86001a7fb1ffcc6441f255d099" id="r_af5546b86001a7fb1ffcc6441f255d099"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#af5546b86001a7fb1ffcc6441f255d099">eigvalsh_tridiagonal</a> (<a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>, e, select='<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>', select_range=None, check_finite=True, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=0., lapack_driver='auto')</td></tr>
<tr class="separator:af5546b86001a7fb1ffcc6441f255d099"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3007455a4fa998ad0cdf864c23215a1" id="r_ac3007455a4fa998ad0cdf864c23215a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#ac3007455a4fa998ad0cdf864c23215a1">eigh_tridiagonal</a> (<a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>, e, eigvals_only=False, select='<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>', select_range=None, check_finite=True, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=0., lapack_driver='auto')</td></tr>
<tr class="separator:ac3007455a4fa998ad0cdf864c23215a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83c68330a9dd3b417d1aa5b0040933dd" id="r_a83c68330a9dd3b417d1aa5b0040933dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#a83c68330a9dd3b417d1aa5b0040933dd">_check_info</a> (info, driver, positive='did not converge(LAPACK info=%<a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>)')</td></tr>
<tr class="separator:a83c68330a9dd3b417d1aa5b0040933dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a0702d6966eb8ebf9d14863e54281e5" id="r_a0a0702d6966eb8ebf9d14863e54281e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#a0a0702d6966eb8ebf9d14863e54281e5">hessenberg</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, calc_q=False, overwrite_a=False, check_finite=True)</td></tr>
<tr class="separator:a0a0702d6966eb8ebf9d14863e54281e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb07f386843ceadffed7bf74caa44fbc" id="r_acb07f386843ceadffed7bf74caa44fbc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#acb07f386843ceadffed7bf74caa44fbc">cdf2rdf</a> (<a class="el" href="__lapack__subroutines_8h.html#a817b85d82af73ef273fafbec623bb90b">w</a>, v)</td></tr>
<tr class="separator:acb07f386843ceadffed7bf74caa44fbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa391e8b58056f43fc20071410da9c5d0" id="r_aa391e8b58056f43fc20071410da9c5d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#aa391e8b58056f43fc20071410da9c5d0">_I</a> = cast['F'](1<a class="el" href="__lapack__subroutines_8h.html#a7a2934b0e050f997202d3f47a979d888">j</a>)</td></tr>
<tr class="separator:aa391e8b58056f43fc20071410da9c5d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f0e6c6286201ab5e853b29b8430756" id="r_ab7f0e6c6286201ab5e853b29b8430756"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1__decomp.html#ab7f0e6c6286201ab5e853b29b8430756">_conv_dict</a></td></tr>
<tr class="separator:ab7f0e6c6286201ab5e853b29b8430756"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a83c68330a9dd3b417d1aa5b0040933dd" name="a83c68330a9dd3b417d1aa5b0040933dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83c68330a9dd3b417d1aa5b0040933dd">&#9670;&#160;</a></span>_check_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp._check_info </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>driver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive</em> = <code>'did&#160;not&#160;converge&#160;(LAPACK&#160;info=%<a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>)'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Check info return value.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1350</span><span class="keyword">def </span>_check_info(info, driver, positive=&#39;did not converge (LAPACK info=%d)<span class="stringliteral">&#39;):</span></div>
<div class="line"><span class="lineno"> 1351</span><span class="stringliteral">    &quot;&quot;&quot;Check info return value.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1352</span>    <span class="keywordflow">if</span> info &lt; 0:</div>
<div class="line"><span class="lineno"> 1353</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;illegal value in argument %d of internal %s&#39;</span></div>
<div class="line"><span class="lineno"> 1354</span>                         % (-info, driver))</div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordflow">if</span> info &gt; 0 <span class="keywordflow">and</span> positive:</div>
<div class="line"><span class="lineno"> 1356</span>        <span class="keywordflow">raise</span> LinAlgError((<span class="stringliteral">&quot;%s &quot;</span> + positive) % (driver, info,))</div>
<div class="line"><span class="lineno"> 1357</span> </div>
<div class="line"><span class="lineno"> 1358</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d85515b23393bb63634771bfa1b84e8" name="a0d85515b23393bb63634771bfa1b84e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d85515b23393bb63634771bfa1b84e8">&#9670;&#160;</a></span>_check_select()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp._check_select </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_ev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Check that select is valid, convert to Fortran style.</pre> <div class="fragment"><div class="line"><span class="lineno">  614</span><span class="keyword">def </span>_check_select(select, select_range, max_ev, max_len):</div>
<div class="line"><span class="lineno">  615</span>    <span class="stringliteral">&quot;&quot;&quot;Check that select is valid, convert to Fortran style.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  616</span>    <span class="keywordflow">if</span> isinstance(select, str):</div>
<div class="line"><span class="lineno">  617</span>        select = select.lower()</div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  619</span>        select = _conv_dict[select]</div>
<div class="line"><span class="lineno">  620</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  621</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;invalid argument for select&#39;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  622</span>    vl, vu = 0., 1.</div>
<div class="line"><span class="lineno">  623</span>    il = iu = 1</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">if</span> select != 0:  <span class="comment"># (non-all)</span></div>
<div class="line"><span class="lineno">  625</span>        sr = asarray(select_range)</div>
<div class="line"><span class="lineno">  626</span>        <span class="keywordflow">if</span> sr.ndim != 1 <span class="keywordflow">or</span> sr.size != 2 <span class="keywordflow">or</span> sr[1] &lt; sr[0]:</div>
<div class="line"><span class="lineno">  627</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;select_range must be a 2-element array-like &#39;</span></div>
<div class="line"><span class="lineno">  628</span>                             <span class="stringliteral">&#39;in nondecreasing order&#39;</span>)</div>
<div class="line"><span class="lineno">  629</span>        <span class="keywordflow">if</span> select == 1:  <span class="comment"># (value)</span></div>
<div class="line"><span class="lineno">  630</span>            vl, vu = sr</div>
<div class="line"><span class="lineno">  631</span>            <span class="keywordflow">if</span> max_ev == 0:</div>
<div class="line"><span class="lineno">  632</span>                max_ev = max_len</div>
<div class="line"><span class="lineno">  633</span>        <span class="keywordflow">else</span>:  <span class="comment"># 2 (index)</span></div>
<div class="line"><span class="lineno">  634</span>            <span class="keywordflow">if</span> sr.dtype.char.lower() <span class="keywordflow">not</span> <span class="keywordflow">in</span> <span class="stringliteral">&#39;hilqp&#39;</span>:</div>
<div class="line"><span class="lineno">  635</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;when using select=&quot;i&quot;, select_range must &#39;</span></div>
<div class="line"><span class="lineno">  636</span>                                 <span class="stringliteral">&#39;contain integers, got dtype %s (%s)&#39;</span></div>
<div class="line"><span class="lineno">  637</span>                                 % (sr.dtype, sr.dtype.char))</div>
<div class="line"><span class="lineno">  638</span>            <span class="comment"># translate Python (0 ... N-1) into Fortran (1 ... N) with + 1</span></div>
<div class="line"><span class="lineno">  639</span>            il, iu = sr + 1</div>
<div class="line"><span class="lineno">  640</span>            <span class="keywordflow">if</span> min(il, iu) &lt; 1 <span class="keywordflow">or</span> max(il, iu) &gt; max_len:</div>
<div class="line"><span class="lineno">  641</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;select_range out of bounds&#39;</span>)</div>
<div class="line"><span class="lineno">  642</span>            max_ev = iu - il + 1</div>
<div class="line"><span class="lineno">  643</span>    <span class="keywordflow">return</span> select, vl, vu, il, iu, max_ev</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d47a5880d4fcacf815bf61e37fcb478" name="a4d47a5880d4fcacf815bf61e37fcb478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d47a5880d4fcacf815bf61e37fcb478">&#9670;&#160;</a></span>_geneig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp._geneig </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>homogeneous_eigvals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   74</span>            homogeneous_eigvals):</div>
<div class="line"><span class="lineno">   75</span>    ggev, = get_lapack_funcs((<span class="stringliteral">&#39;ggev&#39;</span>,), (a1, b1))</div>
<div class="line"><span class="lineno">   76</span>    cvl, cvr = left, right</div>
<div class="line"><span class="lineno">   77</span>    res = ggev(a1, b1, lwork=-1)</div>
<div class="line"><span class="lineno">   78</span>    lwork = res[-2][0].real.astype(numpy.int_)</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">if</span> ggev.typecode <span class="keywordflow">in</span> <span class="stringliteral">&#39;cz&#39;</span>:</div>
<div class="line"><span class="lineno">   80</span>        alpha, beta, vl, vr, work, info = ggev(a1, b1, cvl, cvr, lwork,</div>
<div class="line"><span class="lineno">   81</span>                                               overwrite_a, overwrite_b)</div>
<div class="line"><span class="lineno">   82</span>        w = _make_eigvals(alpha, beta, homogeneous_eigvals)</div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   84</span>        alphar, alphai, beta, vl, vr, work, info = ggev(a1, b1, cvl, cvr,</div>
<div class="line"><span class="lineno">   85</span>                                                        lwork, overwrite_a,</div>
<div class="line"><span class="lineno">   86</span>                                                        overwrite_b)</div>
<div class="line"><span class="lineno">   87</span>        alpha = alphar + _I * alphai</div>
<div class="line"><span class="lineno">   88</span>        w = _make_eigvals(alpha, beta, homogeneous_eigvals)</div>
<div class="line"><span class="lineno">   89</span>    _check_info(info, <span class="stringliteral">&#39;generalized eig algorithm (ggev)&#39;</span>)</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    only_real = numpy.all(w.imag == 0.0)</div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (ggev.typecode <span class="keywordflow">in</span> <span class="stringliteral">&#39;cz&#39;</span> <span class="keywordflow">or</span> only_real):</div>
<div class="line"><span class="lineno">   93</span>        t = w.dtype.char</div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">if</span> left:</div>
<div class="line"><span class="lineno">   95</span>            vl = _make_complex_eigvecs(w, vl, t)</div>
<div class="line"><span class="lineno">   96</span>        <span class="keywordflow">if</span> right:</div>
<div class="line"><span class="lineno">   97</span>            vr = _make_complex_eigvecs(w, vr, t)</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="comment"># the eigenvectors returned by the lapack function are NOT normalized</span></div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(vr.shape[0]):</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordflow">if</span> right:</div>
<div class="line"><span class="lineno">  102</span>            vr[:, i] /= norm(vr[:, i])</div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">if</span> left:</div>
<div class="line"><span class="lineno">  104</span>            vl[:, i] /= norm(vl[:, i])</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (left <span class="keywordflow">or</span> right):</div>
<div class="line"><span class="lineno">  107</span>        <span class="keywordflow">return</span> w</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> left:</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">if</span> right:</div>
<div class="line"><span class="lineno">  110</span>            <span class="keywordflow">return</span> w, vl, vr</div>
<div class="line"><span class="lineno">  111</span>        <span class="keywordflow">return</span> w, vl</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">return</span> w, vr</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae419dde39fa4935bdd921c60581ad391" name="ae419dde39fa4935bdd921c60581ad391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae419dde39fa4935bdd921c60581ad391">&#9670;&#160;</a></span>_make_complex_eigvecs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp._make_complex_eigvecs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Produce complex-valued eigenvectors from LAPACK DGGEV real-valued output
</pre> <div class="fragment"><div class="line"><span class="lineno">   33</span><span class="keyword">def </span>_make_complex_eigvecs(w, vin, dtype):</div>
<div class="line"><span class="lineno">   34</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">    Produce complex-valued eigenvectors from LAPACK DGGEV real-valued output</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   37</span>    <span class="comment"># - see LAPACK man page DGGEV at ALPHAI</span></div>
<div class="line"><span class="lineno">   38</span>    v = numpy.array(vin, dtype=dtype)</div>
<div class="line"><span class="lineno">   39</span>    m = (w.imag &gt; 0)</div>
<div class="line"><span class="lineno">   40</span>    m[:-1] |= (w.imag[1:] &lt; 0)  <span class="comment"># workaround for LAPACK bug, cf. ticket #709</span></div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> flatnonzero(m):</div>
<div class="line"><span class="lineno">   42</span>        v.imag[:, i] = vin[:, i+1]</div>
<div class="line"><span class="lineno">   43</span>        conj(v[:, i], v[:, i+1])</div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">return</span> v</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af16418e9b8561f9096e50d0b5c5598e4" name="af16418e9b8561f9096e50d0b5c5598e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af16418e9b8561f9096e50d0b5c5598e4">&#9670;&#160;</a></span>_make_eigvals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp._make_eigvals </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>homogeneous_eigvals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   47</span><span class="keyword">def </span>_make_eigvals(alpha, beta, homogeneous_eigvals):</div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">if</span> homogeneous_eigvals:</div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">if</span> beta <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   50</span>            <span class="keywordflow">return</span> numpy.vstack((alpha, numpy.ones_like(alpha)))</div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   52</span>            <span class="keywordflow">return</span> numpy.vstack((alpha, beta))</div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   54</span>        <span class="keywordflow">if</span> beta <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   55</span>            <span class="keywordflow">return</span> alpha</div>
<div class="line"><span class="lineno">   56</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   57</span>            w = numpy.empty_like(alpha)</div>
<div class="line"><span class="lineno">   58</span>            alpha_zero = (alpha == 0)</div>
<div class="line"><span class="lineno">   59</span>            beta_zero = (beta == 0)</div>
<div class="line"><span class="lineno">   60</span>            beta_nonzero = ~beta_zero</div>
<div class="line"><span class="lineno">   61</span>            w[beta_nonzero] = alpha[beta_nonzero]/beta[beta_nonzero]</div>
<div class="line"><span class="lineno">   62</span>            <span class="comment"># Use numpy.inf for complex values too since</span></div>
<div class="line"><span class="lineno">   63</span>            <span class="comment"># 1/numpy.inf = 0, i.e., it correctly behaves as projective</span></div>
<div class="line"><span class="lineno">   64</span>            <span class="comment"># infinity.</span></div>
<div class="line"><span class="lineno">   65</span>            w[~alpha_zero &amp; beta_zero] = numpy.inf</div>
<div class="line"><span class="lineno">   66</span>            <span class="keywordflow">if</span> numpy.all(alpha.imag == 0):</div>
<div class="line"><span class="lineno">   67</span>                w[alpha_zero &amp; beta_zero] = numpy.nan</div>
<div class="line"><span class="lineno">   68</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   69</span>                w[alpha_zero &amp; beta_zero] = complex(numpy.nan, numpy.nan)</div>
<div class="line"><span class="lineno">   70</span>            <span class="keywordflow">return</span> w</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acb07f386843ceadffed7bf74caa44fbc" name="acb07f386843ceadffed7bf74caa44fbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb07f386843ceadffed7bf74caa44fbc">&#9670;&#160;</a></span>cdf2rdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.cdf2rdf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Converts complex eigenvalues ``w`` and eigenvectors ``v`` to real
eigenvalues in a block diagonal form ``wr`` and the associated real
eigenvectors ``vr``, such that::

    vr @ wr = X @ vr

continues to hold, where ``X`` is the original array for which ``w`` and
``v`` are the eigenvalues and eigenvectors.

.. versionadded:: 1.1.0

Parameters
----------
w : (..., M) array_like
    Complex or real eigenvalues, an array or stack of arrays

    Conjugate pairs must not be interleaved, else the wrong result
    will be produced. So ``[1+1j, 1, 1-1j]`` will give a correct result,
    but ``[1+1j, 2+1j, 1-1j, 2-1j]`` will not.

v : (..., M, M) array_like
    Complex or real eigenvectors, a square array or stack of square arrays.

Returns
-------
wr : (..., M, M) ndarray
    Real diagonal block form of eigenvalues
vr : (..., M, M) ndarray
    Real eigenvectors associated with ``wr``

See Also
--------
eig : Eigenvalues and right eigenvectors for non-symmetric arrays
rsf2csf : Convert real Schur form to complex Schur form

Notes
-----
``w``, ``v`` must be the eigenstructure for some *real* matrix ``X``.
For example, obtained by ``w, v = scipy.linalg.eig(X)`` or
``w, v = numpy.linalg.eig(X)`` in which case ``X`` can also represent
stacked arrays.

.. versionadded:: 1.1.0

Examples
--------
&gt;&gt;&gt; X = np.array([[1, 2, 3], [0, 4, 5], [0, -5, 4]])
&gt;&gt;&gt; X
array([[ 1,  2,  3],
       [ 0,  4,  5],
       [ 0, -5,  4]])

&gt;&gt;&gt; from scipy import linalg
&gt;&gt;&gt; w, v = linalg.eig(X)
&gt;&gt;&gt; w
array([ 1.+0.j,  4.+5.j,  4.-5.j])
&gt;&gt;&gt; v
array([[ 1.00000+0.j     , -0.01906-0.40016j, -0.01906+0.40016j],
       [ 0.00000+0.j     ,  0.00000-0.64788j,  0.00000+0.64788j],
       [ 0.00000+0.j     ,  0.64788+0.j     ,  0.64788-0.j     ]])

&gt;&gt;&gt; wr, vr = linalg.cdf2rdf(w, v)
&gt;&gt;&gt; wr
array([[ 1.,  0.,  0.],
       [ 0.,  4.,  5.],
       [ 0., -5.,  4.]])
&gt;&gt;&gt; vr
array([[ 1.     ,  0.40016, -0.01906],
       [ 0.     ,  0.64788,  0.     ],
       [ 0.     ,  0.     ,  0.64788]])

&gt;&gt;&gt; vr @ wr
array([[ 1.     ,  1.69593,  1.9246 ],
       [ 0.     ,  2.59153,  3.23942],
       [ 0.     , -3.23942,  2.59153]])
&gt;&gt;&gt; X @ vr
array([[ 1.     ,  1.69593,  1.9246 ],
       [ 0.     ,  2.59153,  3.23942],
       [ 0.     , -3.23942,  2.59153]])
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1439</span><span class="keyword">def </span>cdf2rdf(w, v):</div>
<div class="line"><span class="lineno"> 1440</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1441</span><span class="stringliteral">    Converts complex eigenvalues ``w`` and eigenvectors ``v`` to real</span></div>
<div class="line"><span class="lineno"> 1442</span><span class="stringliteral">    eigenvalues in a block diagonal form ``wr`` and the associated real</span></div>
<div class="line"><span class="lineno"> 1443</span><span class="stringliteral">    eigenvectors ``vr``, such that::</span></div>
<div class="line"><span class="lineno"> 1444</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1445</span><span class="stringliteral">        vr @ wr = X @ vr</span></div>
<div class="line"><span class="lineno"> 1446</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1447</span><span class="stringliteral">    continues to hold, where ``X`` is the original array for which ``w`` and</span></div>
<div class="line"><span class="lineno"> 1448</span><span class="stringliteral">    ``v`` are the eigenvalues and eigenvectors.</span></div>
<div class="line"><span class="lineno"> 1449</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1450</span><span class="stringliteral">    .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno"> 1451</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1452</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1453</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1454</span><span class="stringliteral">    w : (..., M) array_like</span></div>
<div class="line"><span class="lineno"> 1455</span><span class="stringliteral">        Complex or real eigenvalues, an array or stack of arrays</span></div>
<div class="line"><span class="lineno"> 1456</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1457</span><span class="stringliteral">        Conjugate pairs must not be interleaved, else the wrong result</span></div>
<div class="line"><span class="lineno"> 1458</span><span class="stringliteral">        will be produced. So ``[1+1j, 1, 1-1j]`` will give a correct result,</span></div>
<div class="line"><span class="lineno"> 1459</span><span class="stringliteral">        but ``[1+1j, 2+1j, 1-1j, 2-1j]`` will not.</span></div>
<div class="line"><span class="lineno"> 1460</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1461</span><span class="stringliteral">    v : (..., M, M) array_like</span></div>
<div class="line"><span class="lineno"> 1462</span><span class="stringliteral">        Complex or real eigenvectors, a square array or stack of square arrays.</span></div>
<div class="line"><span class="lineno"> 1463</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1464</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1465</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1466</span><span class="stringliteral">    wr : (..., M, M) ndarray</span></div>
<div class="line"><span class="lineno"> 1467</span><span class="stringliteral">        Real diagonal block form of eigenvalues</span></div>
<div class="line"><span class="lineno"> 1468</span><span class="stringliteral">    vr : (..., M, M) ndarray</span></div>
<div class="line"><span class="lineno"> 1469</span><span class="stringliteral">        Real eigenvectors associated with ``wr``</span></div>
<div class="line"><span class="lineno"> 1470</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1471</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1472</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1473</span><span class="stringliteral">    eig : Eigenvalues and right eigenvectors for non-symmetric arrays</span></div>
<div class="line"><span class="lineno"> 1474</span><span class="stringliteral">    rsf2csf : Convert real Schur form to complex Schur form</span></div>
<div class="line"><span class="lineno"> 1475</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1476</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1477</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1478</span><span class="stringliteral">    ``w``, ``v`` must be the eigenstructure for some *real* matrix ``X``.</span></div>
<div class="line"><span class="lineno"> 1479</span><span class="stringliteral">    For example, obtained by ``w, v = scipy.linalg.eig(X)`` or</span></div>
<div class="line"><span class="lineno"> 1480</span><span class="stringliteral">    ``w, v = numpy.linalg.eig(X)`` in which case ``X`` can also represent</span></div>
<div class="line"><span class="lineno"> 1481</span><span class="stringliteral">    stacked arrays.</span></div>
<div class="line"><span class="lineno"> 1482</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1483</span><span class="stringliteral">    .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno"> 1484</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1485</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1486</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1487</span><span class="stringliteral">    &gt;&gt;&gt; X = np.array([[1, 2, 3], [0, 4, 5], [0, -5, 4]])</span></div>
<div class="line"><span class="lineno"> 1488</span><span class="stringliteral">    &gt;&gt;&gt; X</span></div>
<div class="line"><span class="lineno"> 1489</span><span class="stringliteral">    array([[ 1,  2,  3],</span></div>
<div class="line"><span class="lineno"> 1490</span><span class="stringliteral">           [ 0,  4,  5],</span></div>
<div class="line"><span class="lineno"> 1491</span><span class="stringliteral">           [ 0, -5,  4]])</span></div>
<div class="line"><span class="lineno"> 1492</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1493</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import linalg</span></div>
<div class="line"><span class="lineno"> 1494</span><span class="stringliteral">    &gt;&gt;&gt; w, v = linalg.eig(X)</span></div>
<div class="line"><span class="lineno"> 1495</span><span class="stringliteral">    &gt;&gt;&gt; w</span></div>
<div class="line"><span class="lineno"> 1496</span><span class="stringliteral">    array([ 1.+0.j,  4.+5.j,  4.-5.j])</span></div>
<div class="line"><span class="lineno"> 1497</span><span class="stringliteral">    &gt;&gt;&gt; v</span></div>
<div class="line"><span class="lineno"> 1498</span><span class="stringliteral">    array([[ 1.00000+0.j     , -0.01906-0.40016j, -0.01906+0.40016j],</span></div>
<div class="line"><span class="lineno"> 1499</span><span class="stringliteral">           [ 0.00000+0.j     ,  0.00000-0.64788j,  0.00000+0.64788j],</span></div>
<div class="line"><span class="lineno"> 1500</span><span class="stringliteral">           [ 0.00000+0.j     ,  0.64788+0.j     ,  0.64788-0.j     ]])</span></div>
<div class="line"><span class="lineno"> 1501</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1502</span><span class="stringliteral">    &gt;&gt;&gt; wr, vr = linalg.cdf2rdf(w, v)</span></div>
<div class="line"><span class="lineno"> 1503</span><span class="stringliteral">    &gt;&gt;&gt; wr</span></div>
<div class="line"><span class="lineno"> 1504</span><span class="stringliteral">    array([[ 1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno"> 1505</span><span class="stringliteral">           [ 0.,  4.,  5.],</span></div>
<div class="line"><span class="lineno"> 1506</span><span class="stringliteral">           [ 0., -5.,  4.]])</span></div>
<div class="line"><span class="lineno"> 1507</span><span class="stringliteral">    &gt;&gt;&gt; vr</span></div>
<div class="line"><span class="lineno"> 1508</span><span class="stringliteral">    array([[ 1.     ,  0.40016, -0.01906],</span></div>
<div class="line"><span class="lineno"> 1509</span><span class="stringliteral">           [ 0.     ,  0.64788,  0.     ],</span></div>
<div class="line"><span class="lineno"> 1510</span><span class="stringliteral">           [ 0.     ,  0.     ,  0.64788]])</span></div>
<div class="line"><span class="lineno"> 1511</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1512</span><span class="stringliteral">    &gt;&gt;&gt; vr @ wr</span></div>
<div class="line"><span class="lineno"> 1513</span><span class="stringliteral">    array([[ 1.     ,  1.69593,  1.9246 ],</span></div>
<div class="line"><span class="lineno"> 1514</span><span class="stringliteral">           [ 0.     ,  2.59153,  3.23942],</span></div>
<div class="line"><span class="lineno"> 1515</span><span class="stringliteral">           [ 0.     , -3.23942,  2.59153]])</span></div>
<div class="line"><span class="lineno"> 1516</span><span class="stringliteral">    &gt;&gt;&gt; X @ vr</span></div>
<div class="line"><span class="lineno"> 1517</span><span class="stringliteral">    array([[ 1.     ,  1.69593,  1.9246 ],</span></div>
<div class="line"><span class="lineno"> 1518</span><span class="stringliteral">           [ 0.     ,  2.59153,  3.23942],</span></div>
<div class="line"><span class="lineno"> 1519</span><span class="stringliteral">           [ 0.     , -3.23942,  2.59153]])</span></div>
<div class="line"><span class="lineno"> 1520</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1521</span>    w, v = _asarray_validated(w), _asarray_validated(v)</div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>    <span class="comment"># check dimensions</span></div>
<div class="line"><span class="lineno"> 1524</span>    <span class="keywordflow">if</span> w.ndim &lt; 1:</div>
<div class="line"><span class="lineno"> 1525</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected w to be at least 1D&#39;</span>)</div>
<div class="line"><span class="lineno"> 1526</span>    <span class="keywordflow">if</span> v.ndim &lt; 2:</div>
<div class="line"><span class="lineno"> 1527</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected v to be at least 2D&#39;</span>)</div>
<div class="line"><span class="lineno"> 1528</span>    <span class="keywordflow">if</span> v.ndim != w.ndim + 1:</div>
<div class="line"><span class="lineno"> 1529</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected eigenvectors array to have exactly one &#39;</span></div>
<div class="line"><span class="lineno"> 1530</span>                         <span class="stringliteral">&#39;dimension more than eigenvalues array&#39;</span>)</div>
<div class="line"><span class="lineno"> 1531</span> </div>
<div class="line"><span class="lineno"> 1532</span>    <span class="comment"># check shapes</span></div>
<div class="line"><span class="lineno"> 1533</span>    n = w.shape[-1]</div>
<div class="line"><span class="lineno"> 1534</span>    M = w.shape[:-1]</div>
<div class="line"><span class="lineno"> 1535</span>    <span class="keywordflow">if</span> v.shape[-2] != v.shape[-1]:</div>
<div class="line"><span class="lineno"> 1536</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected v to be a square matrix or stacked square &#39;</span></div>
<div class="line"><span class="lineno"> 1537</span>                         <span class="stringliteral">&#39;matrices: v.shape[-2] = v.shape[-1]&#39;</span>)</div>
<div class="line"><span class="lineno"> 1538</span>    <span class="keywordflow">if</span> v.shape[-1] != n:</div>
<div class="line"><span class="lineno"> 1539</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected the same number of eigenvalues as &#39;</span></div>
<div class="line"><span class="lineno"> 1540</span>                         <span class="stringliteral">&#39;eigenvectors&#39;</span>)</div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span>    <span class="comment"># get indices for each first pair of complex eigenvalues</span></div>
<div class="line"><span class="lineno"> 1543</span>    complex_mask = iscomplex(w)</div>
<div class="line"><span class="lineno"> 1544</span>    n_complex = complex_mask.sum(axis=-1)</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>    <span class="comment"># check if all complex eigenvalues have conjugate pairs</span></div>
<div class="line"><span class="lineno"> 1547</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (n_complex % 2 == 0).all():</div>
<div class="line"><span class="lineno"> 1548</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected complex-conjugate pairs of eigenvalues&#39;</span>)</div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span>    <span class="comment"># find complex indices</span></div>
<div class="line"><span class="lineno"> 1551</span>    idx = nonzero(complex_mask)</div>
<div class="line"><span class="lineno"> 1552</span>    idx_stack = idx[:-1]</div>
<div class="line"><span class="lineno"> 1553</span>    idx_elem = idx[-1]</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span>    <span class="comment"># filter them to conjugate indices, assuming pairs are not interleaved</span></div>
<div class="line"><span class="lineno"> 1556</span>    j = idx_elem[0::2]</div>
<div class="line"><span class="lineno"> 1557</span>    k = idx_elem[1::2]</div>
<div class="line"><span class="lineno"> 1558</span>    stack_ind = ()</div>
<div class="line"><span class="lineno"> 1559</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> idx_stack:</div>
<div class="line"><span class="lineno"> 1560</span>        <span class="comment"># should never happen, assuming nonzero orders by the last axis</span></div>
<div class="line"><span class="lineno"> 1561</span>        <span class="keyword">assert</span> (i[0::2] == i[1::2]).all(),\</div>
<div class="line"><span class="lineno"> 1562</span>                <span class="stringliteral">&quot;Conjugate pair spanned different arrays!&quot;</span></div>
<div class="line"><span class="lineno"> 1563</span>        stack_ind += (i[0::2],)</div>
<div class="line"><span class="lineno"> 1564</span> </div>
<div class="line"><span class="lineno"> 1565</span>    <span class="comment"># all eigenvalues to diagonal form</span></div>
<div class="line"><span class="lineno"> 1566</span>    wr = zeros(M + (n, n), dtype=w.real.dtype)</div>
<div class="line"><span class="lineno"> 1567</span>    di = range(n)</div>
<div class="line"><span class="lineno"> 1568</span>    wr[..., di, di] = w.real</div>
<div class="line"><span class="lineno"> 1569</span> </div>
<div class="line"><span class="lineno"> 1570</span>    <span class="comment"># complex eigenvalues to real block diagonal form</span></div>
<div class="line"><span class="lineno"> 1571</span>    wr[stack_ind + (j, k)] = w[stack_ind + (j,)].imag</div>
<div class="line"><span class="lineno"> 1572</span>    wr[stack_ind + (k, j)] = w[stack_ind + (k,)].imag</div>
<div class="line"><span class="lineno"> 1573</span> </div>
<div class="line"><span class="lineno"> 1574</span>    <span class="comment"># compute real eigenvectors associated with real block diagonal eigenvalues</span></div>
<div class="line"><span class="lineno"> 1575</span>    u = zeros(M + (n, n), dtype=numpy.cdouble)</div>
<div class="line"><span class="lineno"> 1576</span>    u[..., di, di] = 1.0</div>
<div class="line"><span class="lineno"> 1577</span>    u[stack_ind + (j, j)] = 0.5j</div>
<div class="line"><span class="lineno"> 1578</span>    u[stack_ind + (j, k)] = 0.5</div>
<div class="line"><span class="lineno"> 1579</span>    u[stack_ind + (k, j)] = -0.5j</div>
<div class="line"><span class="lineno"> 1580</span>    u[stack_ind + (k, k)] = 0.5</div>
<div class="line"><span class="lineno"> 1581</span> </div>
<div class="line"><span class="lineno"> 1582</span>    <span class="comment"># multipy matrices v and u (equivalent to v @ u)</span></div>
<div class="line"><span class="lineno"> 1583</span>    vr = einsum(<span class="stringliteral">&#39;...ij,...jk-&gt;...ik&#39;</span>, v, u).real</div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span>    <span class="keywordflow">return</span> wr, vr</div>
</div><!-- fragment -->
</div>
</div>
<a id="adf818ed3a2db370daa816628c1573ad9" name="adf818ed3a2db370daa816628c1573ad9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf818ed3a2db370daa816628c1573ad9">&#9670;&#160;</a></span>eig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.eig </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_a</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_b</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>homogeneous_eigvals</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solve an ordinary or generalized eigenvalue problem of a square matrix.

Find eigenvalues w and right or left eigenvectors of a general matrix::

    a   vr[:,i] = w[i]        b   vr[:,i]
    a.H vl[:,i] = w[i].conj() b.H vl[:,i]

where ``.H`` is the Hermitian conjugation.

Parameters
----------
a : (M, M) array_like
    A complex or real matrix whose eigenvalues and eigenvectors
    will be computed.
b : (M, M) array_like, optional
    Right-hand side matrix in a generalized eigenvalue problem.
    Default is None, identity matrix is assumed.
left : bool, optional
    Whether to calculate and return left eigenvectors.  Default is False.
right : bool, optional
    Whether to calculate and return right eigenvectors.  Default is True.
overwrite_a : bool, optional
    Whether to overwrite `a`; may improve performance.  Default is False.
overwrite_b : bool, optional
    Whether to overwrite `b`; may improve performance.  Default is False.
check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
homogeneous_eigvals : bool, optional
    If True, return the eigenvalues in homogeneous coordinates.
    In this case ``w`` is a (2, M) array so that::

        w[1,i] a vr[:,i] = w[0,i] b vr[:,i]

    Default is False.

Returns
-------
w : (M,) or (2, M) double or complex ndarray
    The eigenvalues, each repeated according to its
    multiplicity. The shape is (M,) unless
    ``homogeneous_eigvals=True``.
vl : (M, M) double or complex ndarray
    The normalized left eigenvector corresponding to the eigenvalue
    ``w[i]`` is the column vl[:,i]. Only returned if ``left=True``.
vr : (M, M) double or complex ndarray
    The normalized right eigenvector corresponding to the eigenvalue
    ``w[i]`` is the column ``vr[:,i]``.  Only returned if ``right=True``.

Raises
------
LinAlgError
    If eigenvalue computation does not converge.

See Also
--------
eigvals : eigenvalues of general arrays
eigh : Eigenvalues and right eigenvectors for symmetric/Hermitian arrays.
eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian
    band matrices
eigh_tridiagonal : eigenvalues and right eiegenvectors for
    symmetric/Hermitian tridiagonal matrices

Examples
--------
&gt;&gt;&gt; from scipy import linalg
&gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])
&gt;&gt;&gt; linalg.eigvals(a)
array([0.+1.j, 0.-1.j])

&gt;&gt;&gt; b = np.array([[0., 1.], [1., 1.]])
&gt;&gt;&gt; linalg.eigvals(a, b)
array([ 1.+0.j, -1.+0.j])

&gt;&gt;&gt; a = np.array([[3., 0., 0.], [0., 8., 0.], [0., 0., 7.]])
&gt;&gt;&gt; linalg.eigvals(a, homogeneous_eigvals=True)
array([[3.+0.j, 8.+0.j, 7.+0.j],
       [1.+0.j, 1.+0.j, 1.+0.j]])

&gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])
&gt;&gt;&gt; linalg.eigvals(a) == linalg.eig(a)[0]
array([ True,  True])
&gt;&gt;&gt; linalg.eig(a, left=True, right=False)[1] # normalized left eigenvector
array([[-0.70710678+0.j        , -0.70710678-0.j        ],
       [-0.        +0.70710678j, -0.        -0.70710678j]])
&gt;&gt;&gt; linalg.eig(a, left=False, right=True)[1] # normalized right eigenvector
array([[0.70710678+0.j        , 0.70710678-0.j        ],
       [0.        -0.70710678j, 0.        +0.70710678j]])</pre> <div class="fragment"><div class="line"><span class="lineno">  116</span>        overwrite_b=<span class="keyword">False</span>, check_finite=<span class="keyword">True</span>, homogeneous_eigvals=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  117</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">    Solve an ordinary or generalized eigenvalue problem of a square matrix.</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    Find eigenvalues w and right or left eigenvectors of a general matrix::</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">        a   vr[:,i] = w[i]        b   vr[:,i]</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">        a.H vl[:,i] = w[i].conj() b.H vl[:,i]</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    where ``.H`` is the Hermitian conjugation.</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    a : (M, M) array_like</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">        A complex or real matrix whose eigenvalues and eigenvectors</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">        will be computed.</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">    b : (M, M) array_like, optional</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">        Right-hand side matrix in a generalized eigenvalue problem.</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">        Default is None, identity matrix is assumed.</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    left : bool, optional</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">        Whether to calculate and return left eigenvectors.  Default is False.</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    right : bool, optional</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        Whether to calculate and return right eigenvectors.  Default is True.</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    overwrite_a : bool, optional</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">        Whether to overwrite `a`; may improve performance.  Default is False.</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    overwrite_b : bool, optional</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">        Whether to overwrite `b`; may improve performance.  Default is False.</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    homogeneous_eigvals : bool, optional</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">        If True, return the eigenvalues in homogeneous coordinates.</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">        In this case ``w`` is a (2, M) array so that::</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">            w[1,i] a vr[:,i] = w[0,i] b vr[:,i]</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">        Default is False.</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    w : (M,) or (2, M) double or complex ndarray</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">        The eigenvalues, each repeated according to its</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">        multiplicity. The shape is (M,) unless</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">        ``homogeneous_eigvals=True``.</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    vl : (M, M) double or complex ndarray</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">        The normalized left eigenvector corresponding to the eigenvalue</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">        ``w[i]`` is the column vl[:,i]. Only returned if ``left=True``.</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    vr : (M, M) double or complex ndarray</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">        The normalized right eigenvector corresponding to the eigenvalue</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">        ``w[i]`` is the column ``vr[:,i]``.  Only returned if ``right=True``.</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    LinAlgError</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">        If eigenvalue computation does not converge.</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    eigvals : eigenvalues of general arrays</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    eigh : Eigenvalues and right eigenvectors for symmetric/Hermitian arrays.</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">    eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">        band matrices</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">    eigh_tridiagonal : eigenvalues and right eiegenvectors for</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">        symmetric/Hermitian tridiagonal matrices</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import linalg</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eigvals(a)</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    array([0.+1.j, 0.-1.j])</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    &gt;&gt;&gt; b = np.array([[0., 1.], [1., 1.]])</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eigvals(a, b)</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    array([ 1.+0.j, -1.+0.j])</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[3., 0., 0.], [0., 8., 0.], [0., 0., 7.]])</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eigvals(a, homogeneous_eigvals=True)</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    array([[3.+0.j, 8.+0.j, 7.+0.j],</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">           [1.+0.j, 1.+0.j, 1.+0.j]])</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eigvals(a) == linalg.eig(a)[0]</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    array([ True,  True])</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eig(a, left=True, right=False)[1] # normalized left eigenvector</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">    array([[-0.70710678+0.j        , -0.70710678-0.j        ],</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">           [-0.        +0.70710678j, -0.        -0.70710678j]])</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eig(a, left=False, right=True)[1] # normalized right eigenvector</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    array([[0.70710678+0.j        , 0.70710678-0.j        ],</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">           [0.        -0.70710678j, 0.        +0.70710678j]])</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  211</span>    a1 = _asarray_validated(a, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">if</span> len(a1.shape) != 2 <span class="keywordflow">or</span> a1.shape[0] != a1.shape[1]:</div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected square matrix&#39;</span>)</div>
<div class="line"><span class="lineno">  214</span>    overwrite_a = overwrite_a <span class="keywordflow">or</span> (_datacopied(a1, a))</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">if</span> b <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  216</span>        b1 = _asarray_validated(b, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  217</span>        overwrite_b = overwrite_b <span class="keywordflow">or</span> _datacopied(b1, b)</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">if</span> len(b1.shape) != 2 <span class="keywordflow">or</span> b1.shape[0] != b1.shape[1]:</div>
<div class="line"><span class="lineno">  219</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected square matrix&#39;</span>)</div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">if</span> b1.shape != a1.shape:</div>
<div class="line"><span class="lineno">  221</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;a and b must have the same shape&#39;</span>)</div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">return</span> _geneig(a1, b1, left, right, overwrite_a, overwrite_b,</div>
<div class="line"><span class="lineno">  223</span>                       homogeneous_eigvals)</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    geev, geev_lwork = get_lapack_funcs((<span class="stringliteral">&#39;geev&#39;</span>, <span class="stringliteral">&#39;geev_lwork&#39;</span>), (a1,))</div>
<div class="line"><span class="lineno">  226</span>    compute_vl, compute_vr = left, right</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>    lwork = _compute_lwork(geev_lwork, a1.shape[0],</div>
<div class="line"><span class="lineno">  229</span>                           compute_vl=compute_vl,</div>
<div class="line"><span class="lineno">  230</span>                           compute_vr=compute_vr)</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> geev.typecode <span class="keywordflow">in</span> <span class="stringliteral">&#39;cz&#39;</span>:</div>
<div class="line"><span class="lineno">  233</span>        w, vl, vr, info = geev(a1, lwork=lwork,</div>
<div class="line"><span class="lineno">  234</span>                               compute_vl=compute_vl,</div>
<div class="line"><span class="lineno">  235</span>                               compute_vr=compute_vr,</div>
<div class="line"><span class="lineno">  236</span>                               overwrite_a=overwrite_a)</div>
<div class="line"><span class="lineno">  237</span>        w = _make_eigvals(w, <span class="keywordtype">None</span>, homogeneous_eigvals)</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  239</span>        wr, wi, vl, vr, info = geev(a1, lwork=lwork,</div>
<div class="line"><span class="lineno">  240</span>                                    compute_vl=compute_vl,</div>
<div class="line"><span class="lineno">  241</span>                                    compute_vr=compute_vr,</div>
<div class="line"><span class="lineno">  242</span>                                    overwrite_a=overwrite_a)</div>
<div class="line"><span class="lineno">  243</span>        t = {<span class="stringliteral">&#39;f&#39;</span>: <span class="stringliteral">&#39;F&#39;</span>, <span class="stringliteral">&#39;d&#39;</span>: <span class="stringliteral">&#39;D&#39;</span>}[wr.dtype.char]</div>
<div class="line"><span class="lineno">  244</span>        w = wr + _I * wi</div>
<div class="line"><span class="lineno">  245</span>        w = _make_eigvals(w, <span class="keywordtype">None</span>, homogeneous_eigvals)</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    _check_info(info, <span class="stringliteral">&#39;eig algorithm (geev)&#39;</span>,</div>
<div class="line"><span class="lineno">  248</span>                positive=<span class="stringliteral">&#39;did not converge (only eigenvalues &#39;</span></div>
<div class="line"><span class="lineno">  249</span>                         <span class="stringliteral">&#39;with order &gt;= %d have converged)&#39;</span>)</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    only_real = numpy.all(w.imag == 0.0)</div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (geev.typecode <span class="keywordflow">in</span> <span class="stringliteral">&#39;cz&#39;</span> <span class="keywordflow">or</span> only_real):</div>
<div class="line"><span class="lineno">  253</span>        t = w.dtype.char</div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">if</span> left:</div>
<div class="line"><span class="lineno">  255</span>            vl = _make_complex_eigvecs(w, vl, t)</div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">if</span> right:</div>
<div class="line"><span class="lineno">  257</span>            vr = _make_complex_eigvecs(w, vr, t)</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (left <span class="keywordflow">or</span> right):</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">return</span> w</div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">if</span> left:</div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordflow">if</span> right:</div>
<div class="line"><span class="lineno">  262</span>            <span class="keywordflow">return</span> w, vl, vr</div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">return</span> w, vl</div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">return</span> w, vr</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afc9bd9ce46012cf260f70f80300a5464" name="afc9bd9ce46012cf260f70f80300a5464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc9bd9ce46012cf260f70f80300a5464">&#9670;&#160;</a></span>eig_banded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.eig_banded </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a_band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lower</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eigvals_only</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_a_band</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select</em> = <code>'<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select_range</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_ev</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solve real symmetric or complex Hermitian band matrix eigenvalue problem.

Find eigenvalues w and optionally right eigenvectors v of a::

    a v[:,i] = w[i] v[:,i]
    v.H v    = identity

The matrix a is stored in a_band either in lower diagonal or upper
diagonal ordered form:

    a_band[u + i - j, j] == a[i,j]        (if upper form; i &lt;= j)
    a_band[    i - j, j] == a[i,j]        (if lower form; i &gt;= j)

where u is the number of bands above the diagonal.

Example of a_band (shape of a is (6,6), u=2)::

    upper form:
    *   *   a02 a13 a24 a35
    *   a01 a12 a23 a34 a45
    a00 a11 a22 a33 a44 a55

    lower form:
    a00 a11 a22 a33 a44 a55
    a10 a21 a32 a43 a54 *
    a20 a31 a42 a53 *   *

Cells marked with * are not used.

Parameters
----------
a_band : (u+1, M) array_like
    The bands of the M by M matrix a.
lower : bool, optional
    Is the matrix in the lower form. (Default is upper form)
eigvals_only : bool, optional
    Compute only the eigenvalues and no eigenvectors.
    (Default: calculate also eigenvectors)
overwrite_a_band : bool, optional
    Discard data in a_band (may enhance performance)
select : {'a', 'v', 'i'}, optional
    Which eigenvalues to calculate

    ======  ========================================
    select  calculated
    ======  ========================================
    'a'     All eigenvalues
    'v'     Eigenvalues in the interval (min, max]
    'i'     Eigenvalues with indices min &lt;= i &lt;= max
    ======  ========================================
select_range : (min, max), optional
    Range of selected eigenvalues
max_ev : int, optional
    For select=='v', maximum number of eigenvalues expected.
    For other values of select, has no meaning.

    In doubt, leave this parameter untouched.

check_finite : bool, optional
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.

Returns
-------
w : (M,) ndarray
    The eigenvalues, in ascending order, each repeated according to its
    multiplicity.
v : (M, M) float or complex ndarray
    The normalized eigenvector corresponding to the eigenvalue w[i] is
    the column v[:,i].

Raises
------
LinAlgError
    If eigenvalue computation does not converge.

See Also
--------
eigvals_banded : eigenvalues for symmetric/Hermitian band matrices
eig : eigenvalues and right eigenvectors of general arrays.
eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays
eigh_tridiagonal : eigenvalues and right eigenvectors for
    symmetric/Hermitian tridiagonal matrices

Examples
--------
&gt;&gt;&gt; from scipy.linalg import eig_banded
&gt;&gt;&gt; A = np.array([[1, 5, 2, 0], [5, 2, 5, 2], [2, 5, 3, 5], [0, 2, 5, 4]])
&gt;&gt;&gt; Ab = np.array([[1, 2, 3, 4], [5, 5, 5, 0], [2, 2, 0, 0]])
&gt;&gt;&gt; w, v = eig_banded(Ab, lower=True)
&gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))
True
&gt;&gt;&gt; w = eig_banded(Ab, lower=True, eigvals_only=True)
&gt;&gt;&gt; w
array([-4.26200532, -2.22987175,  3.95222349, 12.53965359])

Request only the eigenvalues between ``[-3, 4]``

&gt;&gt;&gt; w, v = eig_banded(Ab, lower=True, select='v', select_range=[-3, 4])
&gt;&gt;&gt; w
array([-2.22987175,  3.95222349])</pre> <div class="fragment"><div class="line"><span class="lineno">  647</span>               select=<span class="stringliteral">&#39;a&#39;</span>, select_range=<span class="keywordtype">None</span>, max_ev=0, check_finite=<span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">  648</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">    Solve real symmetric or complex Hermitian band matrix eigenvalue problem.</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">    Find eigenvalues w and optionally right eigenvectors v of a::</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">        a v[:,i] = w[i] v[:,i]</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">        v.H v    = identity</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">    The matrix a is stored in a_band either in lower diagonal or upper</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">    diagonal ordered form:</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">        a_band[u + i - j, j] == a[i,j]        (if upper form; i &lt;= j)</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">        a_band[    i - j, j] == a[i,j]        (if lower form; i &gt;= j)</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">    where u is the number of bands above the diagonal.</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">    Example of a_band (shape of a is (6,6), u=2)::</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">        upper form:</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">        *   *   a02 a13 a24 a35</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">        *   a01 a12 a23 a34 a45</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral">        a00 a11 a22 a33 a44 a55</span></div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">        lower form:</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">        a00 a11 a22 a33 a44 a55</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">        a10 a21 a32 a43 a54 *</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">        a20 a31 a42 a53 *   *</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral">    Cells marked with * are not used.</span></div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral">    a_band : (u+1, M) array_like</span></div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">        The bands of the M by M matrix a.</span></div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    lower : bool, optional</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">        Is the matrix in the lower form. (Default is upper form)</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">    eigvals_only : bool, optional</span></div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral">        Compute only the eigenvalues and no eigenvectors.</span></div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral">        (Default: calculate also eigenvectors)</span></div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral">    overwrite_a_band : bool, optional</span></div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral">        Discard data in a_band (may enhance performance)</span></div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral">    select : {&#39;a&#39;, &#39;v&#39;, &#39;i&#39;}, optional</span></div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral">        Which eigenvalues to calculate</span></div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral">        select  calculated</span></div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral">        &#39;a&#39;     All eigenvalues</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral">        &#39;v&#39;     Eigenvalues in the interval (min, max]</span></div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">        &#39;i&#39;     Eigenvalues with indices min &lt;= i &lt;= max</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">    select_range : (min, max), optional</span></div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral">        Range of selected eigenvalues</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">    max_ev : int, optional</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral">        For select==&#39;v&#39;, maximum number of eigenvalues expected.</span></div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">        For other values of select, has no meaning.</span></div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral">        In doubt, leave this parameter untouched.</span></div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  708</span><span class="stringliteral">        Whether to check that the input matrix contains only finite numbers.</span></div>
<div class="line"><span class="lineno">  709</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  712</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  713</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">    w : (M,) ndarray</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral">        The eigenvalues, in ascending order, each repeated according to its</span></div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">        multiplicity.</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">    v : (M, M) float or complex ndarray</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">        The normalized eigenvector corresponding to the eigenvalue w[i] is</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral">        the column v[:,i].</span></div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">    LinAlgError</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral">        If eigenvalue computation does not converge.</span></div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral">    eigvals_banded : eigenvalues for symmetric/Hermitian band matrices</span></div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">    eig : eigenvalues and right eigenvectors of general arrays.</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral">    eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays</span></div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">    eigh_tridiagonal : eigenvalues and right eigenvectors for</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">        symmetric/Hermitian tridiagonal matrices</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import eig_banded</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">    &gt;&gt;&gt; A = np.array([[1, 5, 2, 0], [5, 2, 5, 2], [2, 5, 3, 5], [0, 2, 5, 4]])</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">    &gt;&gt;&gt; Ab = np.array([[1, 2, 3, 4], [5, 5, 5, 0], [2, 2, 0, 0]])</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">    &gt;&gt;&gt; w, v = eig_banded(Ab, lower=True)</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">    &gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">    True</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">    &gt;&gt;&gt; w = eig_banded(Ab, lower=True, eigvals_only=True)</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">    &gt;&gt;&gt; w</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">    array([-4.26200532, -2.22987175,  3.95222349, 12.53965359])</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">    Request only the eigenvalues between ``[-3, 4]``</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">    &gt;&gt;&gt; w, v = eig_banded(Ab, lower=True, select=&#39;v&#39;, select_range=[-3, 4])</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral">    &gt;&gt;&gt; w</span></div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral">    array([-2.22987175,  3.95222349])</span></div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  752</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  753</span>    <span class="keywordflow">if</span> eigvals_only <span class="keywordflow">or</span> overwrite_a_band:</div>
<div class="line"><span class="lineno">  754</span>        a1 = _asarray_validated(a_band, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  755</span>        overwrite_a_band = overwrite_a_band <span class="keywordflow">or</span> (_datacopied(a1, a_band))</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  757</span>        a1 = array(a_band)</div>
<div class="line"><span class="lineno">  758</span>        <span class="keywordflow">if</span> issubclass(a1.dtype.type, inexact) <span class="keywordflow">and</span> <span class="keywordflow">not</span> isfinite(a1).all():</div>
<div class="line"><span class="lineno">  759</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;array must not contain infs or NaNs&quot;</span>)</div>
<div class="line"><span class="lineno">  760</span>        overwrite_a_band = 1</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordflow">if</span> len(a1.shape) != 2:</div>
<div class="line"><span class="lineno">  763</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected a 2-D array&#39;</span>)</div>
<div class="line"><span class="lineno">  764</span>    select, vl, vu, il, iu, max_ev = _check_select(</div>
<div class="line"><span class="lineno">  765</span>        select, select_range, max_ev, a1.shape[1])</div>
<div class="line"><span class="lineno">  766</span>    del select_range</div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordflow">if</span> select == 0:</div>
<div class="line"><span class="lineno">  768</span>        <span class="keywordflow">if</span> a1.dtype.char <span class="keywordflow">in</span> <span class="stringliteral">&#39;GFD&#39;</span>:</div>
<div class="line"><span class="lineno">  769</span>            <span class="comment"># FIXME: implement this somewhen, for now go with builtin values</span></div>
<div class="line"><span class="lineno">  770</span>            <span class="comment"># FIXME: calc optimal lwork by calling ?hbevd(lwork=-1)</span></div>
<div class="line"><span class="lineno">  771</span>            <span class="comment">#        or by using calc_lwork.f ???</span></div>
<div class="line"><span class="lineno">  772</span>            <span class="comment"># lwork = calc_lwork.hbevd(bevd.typecode, a1.shape[0], lower)</span></div>
<div class="line"><span class="lineno">  773</span>            internal_name = <span class="stringliteral">&#39;hbevd&#39;</span></div>
<div class="line"><span class="lineno">  774</span>        <span class="keywordflow">else</span>:  <span class="comment"># a1.dtype.char in &#39;fd&#39;:</span></div>
<div class="line"><span class="lineno">  775</span>            <span class="comment"># FIXME: implement this somewhen, for now go with builtin values</span></div>
<div class="line"><span class="lineno">  776</span>            <span class="comment">#         see above</span></div>
<div class="line"><span class="lineno">  777</span>            <span class="comment"># lwork = calc_lwork.sbevd(bevd.typecode, a1.shape[0], lower)</span></div>
<div class="line"><span class="lineno">  778</span>            internal_name = <span class="stringliteral">&#39;sbevd&#39;</span></div>
<div class="line"><span class="lineno">  779</span>        bevd, = get_lapack_funcs((internal_name,), (a1,))</div>
<div class="line"><span class="lineno">  780</span>        w, v, info = bevd(a1, compute_v=<span class="keywordflow">not</span> eigvals_only,</div>
<div class="line"><span class="lineno">  781</span>                          lower=lower, overwrite_ab=overwrite_a_band)</div>
<div class="line"><span class="lineno">  782</span>    <span class="keywordflow">else</span>:  <span class="comment"># select in [1, 2]</span></div>
<div class="line"><span class="lineno">  783</span>        <span class="keywordflow">if</span> eigvals_only:</div>
<div class="line"><span class="lineno">  784</span>            max_ev = 1</div>
<div class="line"><span class="lineno">  785</span>        <span class="comment"># calculate optimal abstol for dsbevx (see manpage)</span></div>
<div class="line"><span class="lineno">  786</span>        <span class="keywordflow">if</span> a1.dtype.char <span class="keywordflow">in</span> <span class="stringliteral">&#39;fF&#39;</span>:  <span class="comment"># single precision</span></div>
<div class="line"><span class="lineno">  787</span>            lamch, = get_lapack_funcs((<span class="stringliteral">&#39;lamch&#39;</span>,), (array(0, dtype=<span class="stringliteral">&#39;f&#39;</span>),))</div>
<div class="line"><span class="lineno">  788</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  789</span>            lamch, = get_lapack_funcs((<span class="stringliteral">&#39;lamch&#39;</span>,), (array(0, dtype=<span class="stringliteral">&#39;d&#39;</span>),))</div>
<div class="line"><span class="lineno">  790</span>        abstol = 2 * lamch(<span class="stringliteral">&#39;s&#39;</span>)</div>
<div class="line"><span class="lineno">  791</span>        <span class="keywordflow">if</span> a1.dtype.char <span class="keywordflow">in</span> <span class="stringliteral">&#39;GFD&#39;</span>:</div>
<div class="line"><span class="lineno">  792</span>            internal_name = <span class="stringliteral">&#39;hbevx&#39;</span></div>
<div class="line"><span class="lineno">  793</span>        <span class="keywordflow">else</span>:  <span class="comment"># a1.dtype.char in &#39;gfd&#39;</span></div>
<div class="line"><span class="lineno">  794</span>            internal_name = <span class="stringliteral">&#39;sbevx&#39;</span></div>
<div class="line"><span class="lineno">  795</span>        bevx, = get_lapack_funcs((internal_name,), (a1,))</div>
<div class="line"><span class="lineno">  796</span>        w, v, m, ifail, info = bevx(</div>
<div class="line"><span class="lineno">  797</span>            a1, vl, vu, il, iu, compute_v=<span class="keywordflow">not</span> eigvals_only, mmax=max_ev,</div>
<div class="line"><span class="lineno">  798</span>            range=select, lower=lower, overwrite_ab=overwrite_a_band,</div>
<div class="line"><span class="lineno">  799</span>            abstol=abstol)</div>
<div class="line"><span class="lineno">  800</span>        <span class="comment"># crop off w and v</span></div>
<div class="line"><span class="lineno">  801</span>        w = w[:m]</div>
<div class="line"><span class="lineno">  802</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> eigvals_only:</div>
<div class="line"><span class="lineno">  803</span>            v = v[:, :m]</div>
<div class="line"><span class="lineno">  804</span>    _check_info(info, internal_name)</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>    <span class="keywordflow">if</span> eigvals_only:</div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordflow">return</span> w</div>
<div class="line"><span class="lineno">  808</span>    <span class="keywordflow">return</span> w, v</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abad401fa81ef2480a8119fe55741e53d" name="abad401fa81ef2480a8119fe55741e53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abad401fa81ef2480a8119fe55741e53d">&#9670;&#160;</a></span>eigh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.eigh </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lower</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eigvals_only</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_a</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_b</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>turbo</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eigvals</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>type</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>subset_by_index</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>subset_by_value</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>driver</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solve a standard or generalized eigenvalue problem for a complex
Hermitian or real symmetric matrix.

Find eigenvalues array ``w`` and optionally eigenvectors array ``v`` of
array ``a``, where ``b`` is positive definite such that for every
eigenvalue  (i-th entry of w) and its eigenvector ``vi`` (i-th column of
``v``) satisfies::

                  a @ vi =  * b @ vi
    vi.conj().T @ a @ vi = 
    vi.conj().T @ b @ vi = 1

In the standard problem, ``b`` is assumed to be the identity matrix.

Parameters
----------
a : (M, M) array_like
    A complex Hermitian or real symmetric matrix whose eigenvalues and
    eigenvectors will be computed.
b : (M, M) array_like, optional
    A complex Hermitian or real symmetric definite positive matrix in.
    If omitted, identity matrix is assumed.
lower : bool, optional
    Whether the pertinent array data is taken from the lower or upper
    triangle of ``a`` and, if applicable, ``b``. (Default: lower)
eigvals_only : bool, optional
    Whether to calculate only eigenvalues and no eigenvectors.
    (Default: both are calculated)
subset_by_index : iterable, optional
    If provided, this two-element iterable defines the start and the end
    indices of the desired eigenvalues (ascending order and 0-indexed).
    To return only the second smallest to fifth smallest eigenvalues,
    ``[1, 4]`` is used. ``[n-3, n-1]`` returns the largest three. Only
    available with "evr", "evx", and "gvx" drivers. The entries are
    directly converted to integers via ``int()``.
subset_by_value : iterable, optional
    If provided, this two-element iterable defines the half-open interval
    ``(a, b]`` that, if any, only the eigenvalues between these values
    are returned. Only available with "evr", "evx", and "gvx" drivers. Use
    ``np.inf`` for the unconstrained ends.
driver : str, optional
    Defines which LAPACK driver should be used. Valid options are "ev",
    "evd", "evr", "evx" for standard problems and "gv", "gvd", "gvx" for
    generalized (where b is not None) problems. See the Notes section.
    The default for standard problems is "evr". For generalized problems,
    "gvd" is used for full set, and "gvx" for subset requested cases.
type : int, optional
    For the generalized problems, this keyword specifies the problem type
    to be solved for ``w`` and ``v`` (only takes 1, 2, 3 as possible
    inputs)::

        1 =&gt;     a @ v = w @ b @ v
        2 =&gt; a @ b @ v = w @ v
        3 =&gt; b @ a @ v = w @ v

    This keyword is ignored for standard problems.
overwrite_a : bool, optional
    Whether to overwrite data in ``a`` (may improve performance). Default
    is False.
overwrite_b : bool, optional
    Whether to overwrite data in ``b`` (may improve performance). Default
    is False.
check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
turbo : bool, optional
    *Deprecated since v1.5.0, use ``driver=gvd`` keyword instead*.
    Use divide and conquer algorithm (faster but expensive in memory, only
    for generalized eigenvalue problem and if full set of eigenvalues are
    requested.). Has no significant effect if eigenvectors are not
    requested.
eigvals : tuple (lo, hi), optional
    *Deprecated since v1.5.0, use ``subset_by_index`` keyword instead*.
    Indexes of the smallest and largest (in ascending order) eigenvalues
    and corresponding eigenvectors to be returned: 0 &lt;= lo &lt;= hi &lt;= M-1.
    If omitted, all eigenvalues and eigenvectors are returned.

Returns
-------
w : (N,) ndarray
    The N (1&lt;=N&lt;=M) selected eigenvalues, in ascending order, each
    repeated according to its multiplicity.
v : (M, N) ndarray
    (if ``eigvals_only == False``)

Raises
------
LinAlgError
    If eigenvalue computation does not converge, an error occurred, or
    b matrix is not definite positive. Note that if input matrices are
    not symmetric or Hermitian, no error will be reported but results will
    be wrong.

See Also
--------
eigvalsh : eigenvalues of symmetric or Hermitian arrays
eig : eigenvalues and right eigenvectors for non-symmetric arrays
eigh_tridiagonal : eigenvalues and right eiegenvectors for
    symmetric/Hermitian tridiagonal matrices

Notes
-----
This function does not check the input array for being Hermitian/symmetric
in order to allow for representing arrays with only their upper/lower
triangular parts. Also, note that even though not taken into account,
finiteness check applies to the whole array and unaffected by "lower"
keyword.

This function uses LAPACK drivers for computations in all possible keyword
combinations, prefixed with ``sy`` if arrays are real and ``he`` if
complex, e.g., a float array with "evr" driver is solved via
"syevr", complex arrays with "gvx" driver problem is solved via "hegvx"
etc.

As a brief summary, the slowest and the most robust driver is the
classical ``&lt;sy/he&gt;ev`` which uses symmetric QR. ``&lt;sy/he&gt;evr`` is seen as
the optimal choice for the most general cases. However, there are certain
occasions that ``&lt;sy/he&gt;evd`` computes faster at the expense of more
memory usage. ``&lt;sy/he&gt;evx``, while still being faster than ``&lt;sy/he&gt;ev``,
often performs worse than the rest except when very few eigenvalues are
requested for large arrays though there is still no performance guarantee.


For the generalized problem, normalization with respect to the given
type argument::

        type 1 and 3 :      v.conj().T @ a @ v = w
        type 2       : inv(v).conj().T @ a @ inv(v) = w

        type 1 or 2  :      v.conj().T @ b @ v  = I
        type 3       : v.conj().T @ inv(b) @ v  = I


Examples
--------
&gt;&gt;&gt; from scipy.linalg import eigh
&gt;&gt;&gt; A = np.array([[6, 3, 1, 5], [3, 0, 5, 1], [1, 5, 6, 2], [5, 1, 2, 2]])
&gt;&gt;&gt; w, v = eigh(A)
&gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))
True

Request only the eigenvalues

&gt;&gt;&gt; w = eigh(A, eigvals_only=True)

Request eigenvalues that are less than 10.

&gt;&gt;&gt; A = np.array([[34, -4, -10, -7, 2],
...               [-4, 7, 2, 12, 0],
...               [-10, 2, 44, 2, -19],
...               [-7, 12, 2, 79, -34],
...               [2, 0, -19, -34, 29]])
&gt;&gt;&gt; eigh(A, eigvals_only=True, subset_by_value=[-np.inf, 10])
array([6.69199443e-07, 9.11938152e+00])

Request the second smallest eigenvalue and its eigenvector

&gt;&gt;&gt; w, v = eigh(A, subset_by_index=[1, 1])
&gt;&gt;&gt; w
array([9.11938152])
&gt;&gt;&gt; v.shape  # only a single column is returned
(5, 1)</pre> <div class="fragment"><div class="line"><span class="lineno">  270</span>         driver=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  271</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    Solve a standard or generalized eigenvalue problem for a complex</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    Hermitian or real symmetric matrix.</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    Find eigenvalues array ``w`` and optionally eigenvectors array ``v`` of</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    array ``a``, where ``b`` is positive definite such that for every</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    eigenvalue  (i-th entry of w) and its eigenvector ``vi`` (i-th column of</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    ``v``) satisfies::</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">                      a @ vi =  * b @ vi</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">        vi.conj().T @ a @ vi = </span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">        vi.conj().T @ b @ vi = 1</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">    In the standard problem, ``b`` is assumed to be the identity matrix.</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">    a : (M, M) array_like</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">        A complex Hermitian or real symmetric matrix whose eigenvalues and</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">        eigenvectors will be computed.</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    b : (M, M) array_like, optional</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">        A complex Hermitian or real symmetric definite positive matrix in.</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">        If omitted, identity matrix is assumed.</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">    lower : bool, optional</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">        Whether the pertinent array data is taken from the lower or upper</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">        triangle of ``a`` and, if applicable, ``b``. (Default: lower)</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">    eigvals_only : bool, optional</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">        Whether to calculate only eigenvalues and no eigenvectors.</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">        (Default: both are calculated)</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">    subset_by_index : iterable, optional</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">        If provided, this two-element iterable defines the start and the end</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">        indices of the desired eigenvalues (ascending order and 0-indexed).</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">        To return only the second smallest to fifth smallest eigenvalues,</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        ``[1, 4]`` is used. ``[n-3, n-1]`` returns the largest three. Only</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">        available with &quot;evr&quot;, &quot;evx&quot;, and &quot;gvx&quot; drivers. The entries are</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">        directly converted to integers via ``int()``.</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">    subset_by_value : iterable, optional</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">        If provided, this two-element iterable defines the half-open interval</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">        ``(a, b]`` that, if any, only the eigenvalues between these values</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">        are returned. Only available with &quot;evr&quot;, &quot;evx&quot;, and &quot;gvx&quot; drivers. Use</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">        ``np.inf`` for the unconstrained ends.</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">    driver : str, optional</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">        Defines which LAPACK driver should be used. Valid options are &quot;ev&quot;,</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">        &quot;evd&quot;, &quot;evr&quot;, &quot;evx&quot; for standard problems and &quot;gv&quot;, &quot;gvd&quot;, &quot;gvx&quot; for</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">        generalized (where b is not None) problems. See the Notes section.</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">        The default for standard problems is &quot;evr&quot;. For generalized problems,</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">        &quot;gvd&quot; is used for full set, and &quot;gvx&quot; for subset requested cases.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">    type : int, optional</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">        For the generalized problems, this keyword specifies the problem type</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        to be solved for ``w`` and ``v`` (only takes 1, 2, 3 as possible</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">        inputs)::</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">            1 =&gt;     a @ v = w @ b @ v</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">            2 =&gt; a @ b @ v = w @ v</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">            3 =&gt; b @ a @ v = w @ v</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        This keyword is ignored for standard problems.</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">    overwrite_a : bool, optional</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">        Whether to overwrite data in ``a`` (may improve performance). Default</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">        is False.</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    overwrite_b : bool, optional</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">        Whether to overwrite data in ``b`` (may improve performance). Default</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">        is False.</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    turbo : bool, optional</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">        *Deprecated since v1.5.0, use ``driver=gvd`` keyword instead*.</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">        Use divide and conquer algorithm (faster but expensive in memory, only</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">        for generalized eigenvalue problem and if full set of eigenvalues are</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">        requested.). Has no significant effect if eigenvectors are not</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">        requested.</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    eigvals : tuple (lo, hi), optional</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">        *Deprecated since v1.5.0, use ``subset_by_index`` keyword instead*.</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">        Indexes of the smallest and largest (in ascending order) eigenvalues</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">        and corresponding eigenvectors to be returned: 0 &lt;= lo &lt;= hi &lt;= M-1.</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">        If omitted, all eigenvalues and eigenvectors are returned.</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">    w : (N,) ndarray</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">        The N (1&lt;=N&lt;=M) selected eigenvalues, in ascending order, each</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">        repeated according to its multiplicity.</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    v : (M, N) ndarray</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">        (if ``eigvals_only == False``)</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">    LinAlgError</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">        If eigenvalue computation does not converge, an error occurred, or</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">        b matrix is not definite positive. Note that if input matrices are</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">        not symmetric or Hermitian, no error will be reported but results will</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">        be wrong.</span></div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">    eigvalsh : eigenvalues of symmetric or Hermitian arrays</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">    eig : eigenvalues and right eigenvectors for non-symmetric arrays</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">    eigh_tridiagonal : eigenvalues and right eiegenvectors for</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">        symmetric/Hermitian tridiagonal matrices</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">    This function does not check the input array for being Hermitian/symmetric</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">    in order to allow for representing arrays with only their upper/lower</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">    triangular parts. Also, note that even though not taken into account,</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">    finiteness check applies to the whole array and unaffected by &quot;lower&quot;</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">    keyword.</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">    This function uses LAPACK drivers for computations in all possible keyword</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">    combinations, prefixed with ``sy`` if arrays are real and ``he`` if</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">    complex, e.g., a float array with &quot;evr&quot; driver is solved via</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">    &quot;syevr&quot;, complex arrays with &quot;gvx&quot; driver problem is solved via &quot;hegvx&quot;</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">    etc.</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">    As a brief summary, the slowest and the most robust driver is the</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">    classical ``&lt;sy/he&gt;ev`` which uses symmetric QR. ``&lt;sy/he&gt;evr`` is seen as</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">    the optimal choice for the most general cases. However, there are certain</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">    occasions that ``&lt;sy/he&gt;evd`` computes faster at the expense of more</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    memory usage. ``&lt;sy/he&gt;evx``, while still being faster than ``&lt;sy/he&gt;ev``,</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    often performs worse than the rest except when very few eigenvalues are</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    requested for large arrays though there is still no performance guarantee.</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    For the generalized problem, normalization with respect to the given</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    type argument::</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">            type 1 and 3 :      v.conj().T @ a @ v = w</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">            type 2       : inv(v).conj().T @ a @ inv(v) = w</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">            type 1 or 2  :      v.conj().T @ b @ v  = I</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">            type 3       : v.conj().T @ inv(b) @ v  = I</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  407</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  408</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import eigh</span></div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral">    &gt;&gt;&gt; A = np.array([[6, 3, 1, 5], [3, 0, 5, 1], [1, 5, 6, 2], [5, 1, 2, 2]])</span></div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral">    &gt;&gt;&gt; w, v = eigh(A)</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">    &gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral">    True</span></div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral">    Request only the eigenvalues</span></div>
<div class="line"><span class="lineno">  415</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral">    &gt;&gt;&gt; w = eigh(A, eigvals_only=True)</span></div>
<div class="line"><span class="lineno">  417</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">    Request eigenvalues that are less than 10.</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">    &gt;&gt;&gt; A = np.array([[34, -4, -10, -7, 2],</span></div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">    ...               [-4, 7, 2, 12, 0],</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">    ...               [-10, 2, 44, 2, -19],</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">    ...               [-7, 12, 2, 79, -34],</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">    ...               [2, 0, -19, -34, 29]])</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">    &gt;&gt;&gt; eigh(A, eigvals_only=True, subset_by_value=[-np.inf, 10])</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">    array([6.69199443e-07, 9.11938152e+00])</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">    Request the second smallest eigenvalue and its eigenvector</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">    &gt;&gt;&gt; w, v = eigh(A, subset_by_index=[1, 1])</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">    &gt;&gt;&gt; w</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">    array([9.11938152])</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    &gt;&gt;&gt; v.shape  # only a single column is returned</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    (5, 1)</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  437</span>    <span class="comment"># set lower</span></div>
<div class="line"><span class="lineno">  438</span>    uplo = <span class="stringliteral">&#39;L&#39;</span> <span class="keywordflow">if</span> lower <span class="keywordflow">else</span> <span class="stringliteral">&#39;U&#39;</span></div>
<div class="line"><span class="lineno">  439</span>    <span class="comment"># Set job for Fortran routines</span></div>
<div class="line"><span class="lineno">  440</span>    _job = <span class="stringliteral">&#39;N&#39;</span> <span class="keywordflow">if</span> eigvals_only <span class="keywordflow">else</span> <span class="stringliteral">&#39;V&#39;</span></div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>    drv_str = [<span class="keywordtype">None</span>, <span class="stringliteral">&quot;ev&quot;</span>, <span class="stringliteral">&quot;evd&quot;</span>, <span class="stringliteral">&quot;evr&quot;</span>, <span class="stringliteral">&quot;evx&quot;</span>, <span class="stringliteral">&quot;gv&quot;</span>, <span class="stringliteral">&quot;gvd&quot;</span>, <span class="stringliteral">&quot;gvx&quot;</span>]</div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">if</span> driver <span class="keywordflow">not</span> <span class="keywordflow">in</span> drv_str:</div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;&quot;{}&quot; is unknown. Possible values are &quot;None&quot;, &quot;{}&quot;.&#39;</span></div>
<div class="line"><span class="lineno">  445</span>                         <span class="stringliteral">&#39;&#39;</span>.format(driver, <span class="stringliteral">&#39;&quot;, &quot;&#39;</span>.join(drv_str[1:])))</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    a1 = _asarray_validated(a, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">if</span> len(a1.shape) != 2 <span class="keywordflow">or</span> a1.shape[0] != a1.shape[1]:</div>
<div class="line"><span class="lineno">  449</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected square &quot;a&quot; matrix&#39;</span>)</div>
<div class="line"><span class="lineno">  450</span>    overwrite_a = overwrite_a <span class="keywordflow">or</span> (_datacopied(a1, a))</div>
<div class="line"><span class="lineno">  451</span>    cplx = <span class="keyword">True</span> <span class="keywordflow">if</span> iscomplexobj(a1) <span class="keywordflow">else</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  452</span>    n = a1.shape[0]</div>
<div class="line"><span class="lineno">  453</span>    drv_args = {<span class="stringliteral">&#39;overwrite_a&#39;</span>: overwrite_a}</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">if</span> b <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  456</span>        b1 = _asarray_validated(b, check_finite=check_finite)</div>
<div class="line"><span class="lineno">  457</span>        overwrite_b = overwrite_b <span class="keywordflow">or</span> _datacopied(b1, b)</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">if</span> len(b1.shape) != 2 <span class="keywordflow">or</span> b1.shape[0] != b1.shape[1]:</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected square &quot;b&quot; matrix&#39;</span>)</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>        <span class="keywordflow">if</span> b1.shape != a1.shape:</div>
<div class="line"><span class="lineno">  462</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;wrong b dimensions {}, should &quot;</span></div>
<div class="line"><span class="lineno">  463</span>                             <span class="stringliteral">&quot;be {}&quot;</span>.format(b1.shape, a1.shape))</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">if</span> type <span class="keywordflow">not</span> <span class="keywordflow">in</span> [1, 2, 3]:</div>
<div class="line"><span class="lineno">  466</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;&quot;type&quot; keyword only accepts 1, 2, and 3.&#39;</span>)</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>        cplx = <span class="keyword">True</span> <span class="keywordflow">if</span> iscomplexobj(b1) <span class="keywordflow">else</span> (cplx <span class="keywordflow">or</span> <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  469</span>        drv_args.update({<span class="stringliteral">&#39;overwrite_b&#39;</span>: overwrite_b, <span class="stringliteral">&#39;itype&#39;</span>: type})</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    <span class="comment"># backwards-compatibility handling</span></div>
<div class="line"><span class="lineno">  472</span>    subset_by_index = subset_by_index <span class="keywordflow">if</span> (eigvals <span class="keywordflow">is</span> <span class="keywordtype">None</span>) <span class="keywordflow">else</span> eigvals</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>    subset = (subset_by_index <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>) <span class="keywordflow">or</span> (subset_by_value <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>    <span class="comment"># Both subsets can&#39;t be given</span></div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">if</span> subset_by_index <span class="keywordflow">and</span> subset_by_value:</div>
<div class="line"><span class="lineno">  478</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Either index or value subset can be requested.&#39;</span>)</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="comment"># Take turbo into account if all conditions are met otherwise ignore</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">if</span> turbo <span class="keywordflow">and</span> b <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  482</span>        driver = <span class="stringliteral">&#39;gvx&#39;</span> <span class="keywordflow">if</span> subset <span class="keywordflow">else</span> <span class="stringliteral">&#39;gvd&#39;</span></div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>    <span class="comment"># Check indices if given</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="keywordflow">if</span> subset_by_index:</div>
<div class="line"><span class="lineno">  486</span>        lo, hi = [int(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> subset_by_index]</div>
<div class="line"><span class="lineno">  487</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> (0 &lt;= lo &lt;= hi &lt; n):</div>
<div class="line"><span class="lineno">  488</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Requested eigenvalue indices are not valid. &#39;</span></div>
<div class="line"><span class="lineno">  489</span>                             <span class="stringliteral">&#39;Valid range is [0, {}] and start &lt;= end, but &#39;</span></div>
<div class="line"><span class="lineno">  490</span>                             <span class="stringliteral">&#39;start={}, end={} is given&#39;</span>.format(n-1, lo, hi))</div>
<div class="line"><span class="lineno">  491</span>        <span class="comment"># fortran is 1-indexed</span></div>
<div class="line"><span class="lineno">  492</span>        drv_args.update({<span class="stringliteral">&#39;range&#39;</span>: <span class="stringliteral">&#39;I&#39;</span>, <span class="stringliteral">&#39;il&#39;</span>: lo + 1, <span class="stringliteral">&#39;iu&#39;</span>: hi + 1})</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>    <span class="keywordflow">if</span> subset_by_value:</div>
<div class="line"><span class="lineno">  495</span>        lo, hi = subset_by_value</div>
<div class="line"><span class="lineno">  496</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> (-inf &lt;= lo &lt; hi &lt;= inf):</div>
<div class="line"><span class="lineno">  497</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Requested eigenvalue bounds are not valid. &#39;</span></div>
<div class="line"><span class="lineno">  498</span>                             <span class="stringliteral">&#39;Valid range is (-inf, inf) and low &lt; high, but &#39;</span></div>
<div class="line"><span class="lineno">  499</span>                             <span class="stringliteral">&#39;low={}, high={} is given&#39;</span>.format(lo, hi))</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>        drv_args.update({<span class="stringliteral">&#39;range&#39;</span>: <span class="stringliteral">&#39;V&#39;</span>, <span class="stringliteral">&#39;vl&#39;</span>: lo, <span class="stringliteral">&#39;vu&#39;</span>: hi})</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>    <span class="comment"># fix prefix for lapack routines</span></div>
<div class="line"><span class="lineno">  504</span>    pfx = <span class="stringliteral">&#39;he&#39;</span> <span class="keywordflow">if</span> cplx <span class="keywordflow">else</span> <span class="stringliteral">&#39;sy&#39;</span></div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>    <span class="comment"># decide on the driver if not given</span></div>
<div class="line"><span class="lineno">  507</span>    <span class="comment"># first early exit on incompatible choice</span></div>
<div class="line"><span class="lineno">  508</span>    <span class="keywordflow">if</span> driver:</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">if</span> b <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> (driver <span class="keywordflow">in</span> [<span class="stringliteral">&quot;gv&quot;</span>, <span class="stringliteral">&quot;gvd&quot;</span>, <span class="stringliteral">&quot;gvx&quot;</span>]):</div>
<div class="line"><span class="lineno">  510</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;{} requires input b array to be supplied &#39;</span></div>
<div class="line"><span class="lineno">  511</span>                             <span class="stringliteral">&#39;for generalized eigenvalue problems.&#39;</span></div>
<div class="line"><span class="lineno">  512</span>                             <span class="stringliteral">&#39;&#39;</span>.format(driver))</div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">if</span> (b <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>) <span class="keywordflow">and</span> (driver <span class="keywordflow">in</span> [<span class="stringliteral">&#39;ev&#39;</span>, <span class="stringliteral">&#39;evd&#39;</span>, <span class="stringliteral">&#39;evr&#39;</span>, <span class="stringliteral">&#39;evx&#39;</span>]):</div>
<div class="line"><span class="lineno">  514</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;&quot;{}&quot; does not accept input b array &#39;</span></div>
<div class="line"><span class="lineno">  515</span>                             <span class="stringliteral">&#39;for standard eigenvalue problems.&#39;</span></div>
<div class="line"><span class="lineno">  516</span>                             <span class="stringliteral">&#39;&#39;</span>.format(driver))</div>
<div class="line"><span class="lineno">  517</span>        <span class="keywordflow">if</span> subset <span class="keywordflow">and</span> (driver <span class="keywordflow">in</span> [<span class="stringliteral">&quot;ev&quot;</span>, <span class="stringliteral">&quot;evd&quot;</span>, <span class="stringliteral">&quot;gv&quot;</span>, <span class="stringliteral">&quot;gvd&quot;</span>]):</div>
<div class="line"><span class="lineno">  518</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;&quot;{}&quot; cannot compute subsets of eigenvalues&#39;</span></div>
<div class="line"><span class="lineno">  519</span>                             <span class="stringliteral">&#39;&#39;</span>.format(driver))</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>    <span class="comment"># Default driver is evr and gvd</span></div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  523</span>        driver = <span class="stringliteral">&quot;evr&quot;</span> <span class="keywordflow">if</span> b <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> (<span class="stringliteral">&quot;gvx&quot;</span> <span class="keywordflow">if</span> subset <span class="keywordflow">else</span> <span class="stringliteral">&quot;gvd&quot;</span>)</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    lwork_spec = {</div>
<div class="line"><span class="lineno">  526</span>                  <span class="stringliteral">&#39;syevd&#39;</span>: [<span class="stringliteral">&#39;lwork&#39;</span>, <span class="stringliteral">&#39;liwork&#39;</span>],</div>
<div class="line"><span class="lineno">  527</span>                  <span class="stringliteral">&#39;syevr&#39;</span>: [<span class="stringliteral">&#39;lwork&#39;</span>, <span class="stringliteral">&#39;liwork&#39;</span>],</div>
<div class="line"><span class="lineno">  528</span>                  <span class="stringliteral">&#39;heevd&#39;</span>: [<span class="stringliteral">&#39;lwork&#39;</span>, <span class="stringliteral">&#39;liwork&#39;</span>, <span class="stringliteral">&#39;lrwork&#39;</span>],</div>
<div class="line"><span class="lineno">  529</span>                  <span class="stringliteral">&#39;heevr&#39;</span>: [<span class="stringliteral">&#39;lwork&#39;</span>, <span class="stringliteral">&#39;lrwork&#39;</span>, <span class="stringliteral">&#39;liwork&#39;</span>],</div>
<div class="line"><span class="lineno">  530</span>                  }</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>    <span class="keywordflow">if</span> b <span class="keywordflow">is</span> <span class="keywordtype">None</span>:  <span class="comment"># Standard problem</span></div>
<div class="line"><span class="lineno">  533</span>        drv, drvlw = get_lapack_funcs((pfx + driver, pfx+driver+<span class="stringliteral">&#39;_lwork&#39;</span>),</div>
<div class="line"><span class="lineno">  534</span>                                      [a1])</div>
<div class="line"><span class="lineno">  535</span>        clw_args = {<span class="stringliteral">&#39;n&#39;</span>: n, <span class="stringliteral">&#39;lower&#39;</span>: lower}</div>
<div class="line"><span class="lineno">  536</span>        <span class="keywordflow">if</span> driver == <span class="stringliteral">&#39;evd&#39;</span>:</div>
<div class="line"><span class="lineno">  537</span>            clw_args.update({<span class="stringliteral">&#39;compute_v&#39;</span>: 0 <span class="keywordflow">if</span> _job == <span class="stringliteral">&quot;N&quot;</span> <span class="keywordflow">else</span> 1})</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>        lw = _compute_lwork(drvlw, **clw_args)</div>
<div class="line"><span class="lineno">  540</span>        <span class="comment"># Multiple lwork vars</span></div>
<div class="line"><span class="lineno">  541</span>        <span class="keywordflow">if</span> isinstance(lw, tuple):</div>
<div class="line"><span class="lineno">  542</span>            lwork_args = dict(zip(lwork_spec[pfx+driver], lw))</div>
<div class="line"><span class="lineno">  543</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  544</span>            lwork_args = {<span class="stringliteral">&#39;lwork&#39;</span>: lw}</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>        drv_args.update({<span class="stringliteral">&#39;lower&#39;</span>: lower, <span class="stringliteral">&#39;compute_v&#39;</span>: 0 <span class="keywordflow">if</span> _job == <span class="stringliteral">&quot;N&quot;</span> <span class="keywordflow">else</span> 1})</div>
<div class="line"><span class="lineno">  547</span>        w, v, *other_args, info = drv(a=a1, **drv_args, **lwork_args)</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>    <span class="keywordflow">else</span>:  <span class="comment"># Generalized problem</span></div>
<div class="line"><span class="lineno">  550</span>        <span class="comment"># &#39;gvd&#39; doesn&#39;t have lwork query</span></div>
<div class="line"><span class="lineno">  551</span>        <span class="keywordflow">if</span> driver == <span class="stringliteral">&quot;gvd&quot;</span>:</div>
<div class="line"><span class="lineno">  552</span>            drv = get_lapack_funcs(pfx + <span class="stringliteral">&quot;gvd&quot;</span>, [a1, b1])</div>
<div class="line"><span class="lineno">  553</span>            lwork_args = {}</div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  555</span>            drv, drvlw = get_lapack_funcs((pfx + driver, pfx+driver+<span class="stringliteral">&#39;_lwork&#39;</span>),</div>
<div class="line"><span class="lineno">  556</span>                                          [a1, b1])</div>
<div class="line"><span class="lineno">  557</span>            <span class="comment"># generalized drivers use uplo instead of lower</span></div>
<div class="line"><span class="lineno">  558</span>            lw = _compute_lwork(drvlw, n, uplo=uplo)</div>
<div class="line"><span class="lineno">  559</span>            lwork_args = {<span class="stringliteral">&#39;lwork&#39;</span>: lw}</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>        drv_args.update({<span class="stringliteral">&#39;uplo&#39;</span>: uplo, <span class="stringliteral">&#39;jobz&#39;</span>: _job})</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>        w, v, *other_args, info = drv(a=a1, b=b1, **drv_args, **lwork_args)</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="comment"># m is always the first extra argument</span></div>
<div class="line"><span class="lineno">  566</span>    w = w[:other_args[0]] <span class="keywordflow">if</span> subset <span class="keywordflow">else</span> w</div>
<div class="line"><span class="lineno">  567</span>    v = v[:, :other_args[0]] <span class="keywordflow">if</span> (subset <span class="keywordflow">and</span> <span class="keywordflow">not</span> eigvals_only) <span class="keywordflow">else</span> v</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>    <span class="comment"># Check if we had a  successful exit</span></div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">if</span> info == 0:</div>
<div class="line"><span class="lineno">  571</span>        <span class="keywordflow">if</span> eigvals_only:</div>
<div class="line"><span class="lineno">  572</span>            <span class="keywordflow">return</span> w</div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  574</span>            <span class="keywordflow">return</span> w, v</div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  576</span>        <span class="keywordflow">if</span> info &lt; -1:</div>
<div class="line"><span class="lineno">  577</span>            <span class="keywordflow">raise</span> LinAlgError(<span class="stringliteral">&#39;Illegal value in argument {} of internal {}&#39;</span></div>
<div class="line"><span class="lineno">  578</span>                              <span class="stringliteral">&#39;&#39;</span>.format(-info, drv.typecode + pfx + driver))</div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordflow">elif</span> info &gt; n:</div>
<div class="line"><span class="lineno">  580</span>            <span class="keywordflow">raise</span> LinAlgError(<span class="stringliteral">&#39;The leading minor of order {} of B is not &#39;</span></div>
<div class="line"><span class="lineno">  581</span>                              <span class="stringliteral">&#39;positive definite. The factorization of B &#39;</span></div>
<div class="line"><span class="lineno">  582</span>                              <span class="stringliteral">&#39;could not be completed and no eigenvalues &#39;</span></div>
<div class="line"><span class="lineno">  583</span>                              <span class="stringliteral">&#39;or eigenvectors were computed.&#39;</span>.format(info-n))</div>
<div class="line"><span class="lineno">  584</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  585</span>            drv_err = {<span class="stringliteral">&#39;ev&#39;</span>: <span class="stringliteral">&#39;The algorithm failed to converge; {} &#39;</span></div>
<div class="line"><span class="lineno">  586</span>                             <span class="stringliteral">&#39;off-diagonal elements of an intermediate &#39;</span></div>
<div class="line"><span class="lineno">  587</span>                             <span class="stringliteral">&#39;tridiagonal form did not converge to zero.&#39;</span>,</div>
<div class="line"><span class="lineno">  588</span>                       <span class="stringliteral">&#39;evx&#39;</span>: <span class="stringliteral">&#39;{} eigenvectors failed to converge.&#39;</span>,</div>
<div class="line"><span class="lineno">  589</span>                       <span class="stringliteral">&#39;evd&#39;</span>: <span class="stringliteral">&#39;The algorithm failed to compute an eigenvalue &#39;</span></div>
<div class="line"><span class="lineno">  590</span>                              <span class="stringliteral">&#39;while working on the submatrix lying in rows &#39;</span></div>
<div class="line"><span class="lineno">  591</span>                              <span class="stringliteral">&#39;and columns {0}/{1} through mod({0},{1}).&#39;</span>,</div>
<div class="line"><span class="lineno">  592</span>                       <span class="stringliteral">&#39;evr&#39;</span>: <span class="stringliteral">&#39;Internal Error.&#39;</span></div>
<div class="line"><span class="lineno">  593</span>                       }</div>
<div class="line"><span class="lineno">  594</span>            <span class="keywordflow">if</span> driver <span class="keywordflow">in</span> [<span class="stringliteral">&#39;ev&#39;</span>, <span class="stringliteral">&#39;gv&#39;</span>]:</div>
<div class="line"><span class="lineno">  595</span>                msg = drv_err[<span class="stringliteral">&#39;ev&#39;</span>].format(info)</div>
<div class="line"><span class="lineno">  596</span>            <span class="keywordflow">elif</span> driver <span class="keywordflow">in</span> [<span class="stringliteral">&#39;evx&#39;</span>, <span class="stringliteral">&#39;gvx&#39;</span>]:</div>
<div class="line"><span class="lineno">  597</span>                msg = drv_err[<span class="stringliteral">&#39;evx&#39;</span>].format(info)</div>
<div class="line"><span class="lineno">  598</span>            <span class="keywordflow">elif</span> driver <span class="keywordflow">in</span> [<span class="stringliteral">&#39;evd&#39;</span>, <span class="stringliteral">&#39;gvd&#39;</span>]:</div>
<div class="line"><span class="lineno">  599</span>                <span class="keywordflow">if</span> eigvals_only:</div>
<div class="line"><span class="lineno">  600</span>                    msg = drv_err[<span class="stringliteral">&#39;ev&#39;</span>].format(info)</div>
<div class="line"><span class="lineno">  601</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  602</span>                    msg = drv_err[<span class="stringliteral">&#39;evd&#39;</span>].format(info, n+1)</div>
<div class="line"><span class="lineno">  603</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  604</span>                msg = drv_err[<span class="stringliteral">&#39;evr&#39;</span>]</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>            <span class="keywordflow">raise</span> LinAlgError(msg)</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3007455a4fa998ad0cdf864c23215a1" name="ac3007455a4fa998ad0cdf864c23215a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3007455a4fa998ad0cdf864c23215a1">&#9670;&#160;</a></span>eigh_tridiagonal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.eigh_tridiagonal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eigvals_only</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select</em> = <code>'<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select_range</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lapack_driver</em> = <code>'auto'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solve eigenvalue problem for a real symmetric tridiagonal matrix.

Find eigenvalues `w` and optionally right eigenvectors `v` of ``a``::

    a v[:,i] = w[i] v[:,i]
    v.H v    = identity

For a real symmetric matrix ``a`` with diagonal elements `d` and
off-diagonal elements `e`.

Parameters
----------
d : ndarray, shape (ndim,)
    The diagonal elements of the array.
e : ndarray, shape (ndim-1,)
    The off-diagonal elements of the array.
select : {'a', 'v', 'i'}, optional
    Which eigenvalues to calculate

    ======  ========================================
    select  calculated
    ======  ========================================
    'a'     All eigenvalues
    'v'     Eigenvalues in the interval (min, max]
    'i'     Eigenvalues with indices min &lt;= i &lt;= max
    ======  ========================================
select_range : (min, max), optional
    Range of selected eigenvalues
check_finite : bool, optional
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
tol : float
    The absolute tolerance to which each eigenvalue is required
    (only used when 'stebz' is the `lapack_driver`).
    An eigenvalue (or cluster) is considered to have converged if it
    lies in an interval of this width. If &lt;= 0. (default),
    the value ``eps*|a|`` is used where eps is the machine precision,
    and ``|a|`` is the 1-norm of the matrix ``a``.
lapack_driver : str
    LAPACK function to use, can be 'auto', 'stemr', 'stebz', 'sterf',
    or 'stev'. When 'auto' (default), it will use 'stemr' if ``select='a'``
    and 'stebz' otherwise. When 'stebz' is used to find the eigenvalues and
    ``eigvals_only=False``, then a second LAPACK call (to ``?STEIN``) is
    used to find the corresponding eigenvectors. 'sterf' can only be
    used when ``eigvals_only=True`` and ``select='a'``. 'stev' can only
    be used when ``select='a'``.

Returns
-------
w : (M,) ndarray
    The eigenvalues, in ascending order, each repeated according to its
    multiplicity.
v : (M, M) ndarray
    The normalized eigenvector corresponding to the eigenvalue ``w[i]`` is
    the column ``v[:,i]``.

Raises
------
LinAlgError
    If eigenvalue computation does not converge.

See Also
--------
eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal
    matrices
eig : eigenvalues and right eigenvectors for non-symmetric arrays
eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays
eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian
    band matrices

Notes
-----
This function makes use of LAPACK ``S/DSTEMR`` routines.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import eigh_tridiagonal
&gt;&gt;&gt; d = 3*np.ones(4)
&gt;&gt;&gt; e = -1*np.ones(3)
&gt;&gt;&gt; w, v = eigh_tridiagonal(d, e)
&gt;&gt;&gt; A = np.diag(d) + np.diag(e, k=1) + np.diag(e, k=-1)
&gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))
True
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1190</span>                     check_finite=<span class="keyword">True</span>, tol=0., lapack_driver=<span class="stringliteral">&#39;auto&#39;</span>):</div>
<div class="line"><span class="lineno"> 1191</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1192</span><span class="stringliteral">    Solve eigenvalue problem for a real symmetric tridiagonal matrix.</span></div>
<div class="line"><span class="lineno"> 1193</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1194</span><span class="stringliteral">    Find eigenvalues `w` and optionally right eigenvectors `v` of ``a``::</span></div>
<div class="line"><span class="lineno"> 1195</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1196</span><span class="stringliteral">        a v[:,i] = w[i] v[:,i]</span></div>
<div class="line"><span class="lineno"> 1197</span><span class="stringliteral">        v.H v    = identity</span></div>
<div class="line"><span class="lineno"> 1198</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1199</span><span class="stringliteral">    For a real symmetric matrix ``a`` with diagonal elements `d` and</span></div>
<div class="line"><span class="lineno"> 1200</span><span class="stringliteral">    off-diagonal elements `e`.</span></div>
<div class="line"><span class="lineno"> 1201</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1202</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">    d : ndarray, shape (ndim,)</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral">        The diagonal elements of the array.</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">    e : ndarray, shape (ndim-1,)</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="stringliteral">        The off-diagonal elements of the array.</span></div>
<div class="line"><span class="lineno"> 1208</span><span class="stringliteral">    select : {&#39;a&#39;, &#39;v&#39;, &#39;i&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1209</span><span class="stringliteral">        Which eigenvalues to calculate</span></div>
<div class="line"><span class="lineno"> 1210</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1211</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="stringliteral">        select  calculated</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1214</span><span class="stringliteral">        &#39;a&#39;     All eigenvalues</span></div>
<div class="line"><span class="lineno"> 1215</span><span class="stringliteral">        &#39;v&#39;     Eigenvalues in the interval (min, max]</span></div>
<div class="line"><span class="lineno"> 1216</span><span class="stringliteral">        &#39;i&#39;     Eigenvalues with indices min &lt;= i &lt;= max</span></div>
<div class="line"><span class="lineno"> 1217</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1218</span><span class="stringliteral">    select_range : (min, max), optional</span></div>
<div class="line"><span class="lineno"> 1219</span><span class="stringliteral">        Range of selected eigenvalues</span></div>
<div class="line"><span class="lineno"> 1220</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno"> 1221</span><span class="stringliteral">        Whether to check that the input matrix contains only finite numbers.</span></div>
<div class="line"><span class="lineno"> 1222</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno"> 1223</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno"> 1224</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno"> 1225</span><span class="stringliteral">        The absolute tolerance to which each eigenvalue is required</span></div>
<div class="line"><span class="lineno"> 1226</span><span class="stringliteral">        (only used when &#39;stebz&#39; is the `lapack_driver`).</span></div>
<div class="line"><span class="lineno"> 1227</span><span class="stringliteral">        An eigenvalue (or cluster) is considered to have converged if it</span></div>
<div class="line"><span class="lineno"> 1228</span><span class="stringliteral">        lies in an interval of this width. If &lt;= 0. (default),</span></div>
<div class="line"><span class="lineno"> 1229</span><span class="stringliteral">        the value ``eps*|a|`` is used where eps is the machine precision,</span></div>
<div class="line"><span class="lineno"> 1230</span><span class="stringliteral">        and ``|a|`` is the 1-norm of the matrix ``a``.</span></div>
<div class="line"><span class="lineno"> 1231</span><span class="stringliteral">    lapack_driver : str</span></div>
<div class="line"><span class="lineno"> 1232</span><span class="stringliteral">        LAPACK function to use, can be &#39;auto&#39;, &#39;stemr&#39;, &#39;stebz&#39;, &#39;sterf&#39;,</span></div>
<div class="line"><span class="lineno"> 1233</span><span class="stringliteral">        or &#39;stev&#39;. When &#39;auto&#39; (default), it will use &#39;stemr&#39; if ``select=&#39;a&#39;``</span></div>
<div class="line"><span class="lineno"> 1234</span><span class="stringliteral">        and &#39;stebz&#39; otherwise. When &#39;stebz&#39; is used to find the eigenvalues and</span></div>
<div class="line"><span class="lineno"> 1235</span><span class="stringliteral">        ``eigvals_only=False``, then a second LAPACK call (to ``?STEIN``) is</span></div>
<div class="line"><span class="lineno"> 1236</span><span class="stringliteral">        used to find the corresponding eigenvectors. &#39;sterf&#39; can only be</span></div>
<div class="line"><span class="lineno"> 1237</span><span class="stringliteral">        used when ``eigvals_only=True`` and ``select=&#39;a&#39;``. &#39;stev&#39; can only</span></div>
<div class="line"><span class="lineno"> 1238</span><span class="stringliteral">        be used when ``select=&#39;a&#39;``.</span></div>
<div class="line"><span class="lineno"> 1239</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1240</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1241</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1242</span><span class="stringliteral">    w : (M,) ndarray</span></div>
<div class="line"><span class="lineno"> 1243</span><span class="stringliteral">        The eigenvalues, in ascending order, each repeated according to its</span></div>
<div class="line"><span class="lineno"> 1244</span><span class="stringliteral">        multiplicity.</span></div>
<div class="line"><span class="lineno"> 1245</span><span class="stringliteral">    v : (M, M) ndarray</span></div>
<div class="line"><span class="lineno"> 1246</span><span class="stringliteral">        The normalized eigenvector corresponding to the eigenvalue ``w[i]`` is</span></div>
<div class="line"><span class="lineno"> 1247</span><span class="stringliteral">        the column ``v[:,i]``.</span></div>
<div class="line"><span class="lineno"> 1248</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1249</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno"> 1250</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno"> 1251</span><span class="stringliteral">    LinAlgError</span></div>
<div class="line"><span class="lineno"> 1252</span><span class="stringliteral">        If eigenvalue computation does not converge.</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1254</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1255</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1256</span><span class="stringliteral">    eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal</span></div>
<div class="line"><span class="lineno"> 1257</span><span class="stringliteral">        matrices</span></div>
<div class="line"><span class="lineno"> 1258</span><span class="stringliteral">    eig : eigenvalues and right eigenvectors for non-symmetric arrays</span></div>
<div class="line"><span class="lineno"> 1259</span><span class="stringliteral">    eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays</span></div>
<div class="line"><span class="lineno"> 1260</span><span class="stringliteral">    eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian</span></div>
<div class="line"><span class="lineno"> 1261</span><span class="stringliteral">        band matrices</span></div>
<div class="line"><span class="lineno"> 1262</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1263</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1264</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1265</span><span class="stringliteral">    This function makes use of LAPACK ``S/DSTEMR`` routines.</span></div>
<div class="line"><span class="lineno"> 1266</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1267</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1269</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import eigh_tridiagonal</span></div>
<div class="line"><span class="lineno"> 1270</span><span class="stringliteral">    &gt;&gt;&gt; d = 3*np.ones(4)</span></div>
<div class="line"><span class="lineno"> 1271</span><span class="stringliteral">    &gt;&gt;&gt; e = -1*np.ones(3)</span></div>
<div class="line"><span class="lineno"> 1272</span><span class="stringliteral">    &gt;&gt;&gt; w, v = eigh_tridiagonal(d, e)</span></div>
<div class="line"><span class="lineno"> 1273</span><span class="stringliteral">    &gt;&gt;&gt; A = np.diag(d) + np.diag(e, k=1) + np.diag(e, k=-1)</span></div>
<div class="line"><span class="lineno"> 1274</span><span class="stringliteral">    &gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))</span></div>
<div class="line"><span class="lineno"> 1275</span><span class="stringliteral">    True</span></div>
<div class="line"><span class="lineno"> 1276</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1277</span>    d = _asarray_validated(d, check_finite=check_finite)</div>
<div class="line"><span class="lineno"> 1278</span>    e = _asarray_validated(e, check_finite=check_finite)</div>
<div class="line"><span class="lineno"> 1279</span>    <span class="keywordflow">for</span> check <span class="keywordflow">in</span> (d, e):</div>
<div class="line"><span class="lineno"> 1280</span>        <span class="keywordflow">if</span> check.ndim != 1:</div>
<div class="line"><span class="lineno"> 1281</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected a 1-D array&#39;</span>)</div>
<div class="line"><span class="lineno"> 1282</span>        <span class="keywordflow">if</span> check.dtype.char <span class="keywordflow">in</span> <span class="stringliteral">&#39;GFD&#39;</span>:  <span class="comment"># complex</span></div>
<div class="line"><span class="lineno"> 1283</span>            <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;Only real arrays currently supported&#39;</span>)</div>
<div class="line"><span class="lineno"> 1284</span>    <span class="keywordflow">if</span> d.size != e.size + 1:</div>
<div class="line"><span class="lineno"> 1285</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;d (%s) must have one more element than e (%s)&#39;</span></div>
<div class="line"><span class="lineno"> 1286</span>                         % (d.size, e.size))</div>
<div class="line"><span class="lineno"> 1287</span>    select, vl, vu, il, iu, _ = _check_select(</div>
<div class="line"><span class="lineno"> 1288</span>        select, select_range, 0, d.size)</div>
<div class="line"><span class="lineno"> 1289</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(lapack_driver, str):</div>
<div class="line"><span class="lineno"> 1290</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;lapack_driver must be str&#39;</span>)</div>
<div class="line"><span class="lineno"> 1291</span>    drivers = (<span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;stemr&#39;</span>, <span class="stringliteral">&#39;sterf&#39;</span>, <span class="stringliteral">&#39;stebz&#39;</span>, <span class="stringliteral">&#39;stev&#39;</span>)</div>
<div class="line"><span class="lineno"> 1292</span>    <span class="keywordflow">if</span> lapack_driver <span class="keywordflow">not</span> <span class="keywordflow">in</span> drivers:</div>
<div class="line"><span class="lineno"> 1293</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;lapack_driver must be one of %s, got %s&#39;</span></div>
<div class="line"><span class="lineno"> 1294</span>                         % (drivers, lapack_driver))</div>
<div class="line"><span class="lineno"> 1295</span>    <span class="keywordflow">if</span> lapack_driver == <span class="stringliteral">&#39;auto&#39;</span>:</div>
<div class="line"><span class="lineno"> 1296</span>        lapack_driver = <span class="stringliteral">&#39;stemr&#39;</span> <span class="keywordflow">if</span> select == 0 <span class="keywordflow">else</span> <span class="stringliteral">&#39;stebz&#39;</span></div>
<div class="line"><span class="lineno"> 1297</span>    func, = get_lapack_funcs((lapack_driver,), (d, e))</div>
<div class="line"><span class="lineno"> 1298</span>    compute_v = <span class="keywordflow">not</span> eigvals_only</div>
<div class="line"><span class="lineno"> 1299</span>    <span class="keywordflow">if</span> lapack_driver == <span class="stringliteral">&#39;sterf&#39;</span>:</div>
<div class="line"><span class="lineno"> 1300</span>        <span class="keywordflow">if</span> select != 0:</div>
<div class="line"><span class="lineno"> 1301</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;sterf can only be used when select == &quot;a&quot;&#39;</span>)</div>
<div class="line"><span class="lineno"> 1302</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> eigvals_only:</div>
<div class="line"><span class="lineno"> 1303</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;sterf can only be used when eigvals_only is &#39;</span></div>
<div class="line"><span class="lineno"> 1304</span>                             <span class="stringliteral">&#39;True&#39;</span>)</div>
<div class="line"><span class="lineno"> 1305</span>        w, info = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(d, e)</div>
<div class="line"><span class="lineno"> 1306</span>        m = len(w)</div>
<div class="line"><span class="lineno"> 1307</span>    <span class="keywordflow">elif</span> lapack_driver == <span class="stringliteral">&#39;stev&#39;</span>:</div>
<div class="line"><span class="lineno"> 1308</span>        <span class="keywordflow">if</span> select != 0:</div>
<div class="line"><span class="lineno"> 1309</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;stev can only be used when select == &quot;a&quot;&#39;</span>)</div>
<div class="line"><span class="lineno"> 1310</span>        w, v, info = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(d, e, compute_v=compute_v)</div>
<div class="line"><span class="lineno"> 1311</span>        m = len(w)</div>
<div class="line"><span class="lineno"> 1312</span>    <span class="keywordflow">elif</span> lapack_driver == <span class="stringliteral">&#39;stebz&#39;</span>:</div>
<div class="line"><span class="lineno"> 1313</span>        tol = float(tol)</div>
<div class="line"><span class="lineno"> 1314</span>        internal_name = <span class="stringliteral">&#39;stebz&#39;</span></div>
<div class="line"><span class="lineno"> 1315</span>        stebz, = get_lapack_funcs((internal_name,), (d, e))</div>
<div class="line"><span class="lineno"> 1316</span>        <span class="comment"># If getting eigenvectors, needs to be block-ordered (B) instead of</span></div>
<div class="line"><span class="lineno"> 1317</span>        <span class="comment"># matrix-ordered (E), and we will reorder later</span></div>
<div class="line"><span class="lineno"> 1318</span>        order = <span class="stringliteral">&#39;E&#39;</span> <span class="keywordflow">if</span> eigvals_only <span class="keywordflow">else</span> <span class="stringliteral">&#39;B&#39;</span></div>
<div class="line"><span class="lineno"> 1319</span>        m, w, iblock, isplit, info = stebz(d, e, select, vl, vu, il, iu, tol,</div>
<div class="line"><span class="lineno"> 1320</span>                                           order)</div>
<div class="line"><span class="lineno"> 1321</span>    <span class="keywordflow">else</span>:   <span class="comment"># &#39;stemr&#39;</span></div>
<div class="line"><span class="lineno"> 1322</span>        <span class="comment"># ?STEMR annoyingly requires size N instead of N-1</span></div>
<div class="line"><span class="lineno"> 1323</span>        e_ = empty(e.size+1, e.dtype)</div>
<div class="line"><span class="lineno"> 1324</span>        e_[:-1] = e</div>
<div class="line"><span class="lineno"> 1325</span>        stemr_lwork, = get_lapack_funcs((<span class="stringliteral">&#39;stemr_lwork&#39;</span>,), (d, e))</div>
<div class="line"><span class="lineno"> 1326</span>        lwork, liwork, info = stemr_lwork(d, e_, select, vl, vu, il, iu,</div>
<div class="line"><span class="lineno"> 1327</span>                                          compute_v=compute_v)</div>
<div class="line"><span class="lineno"> 1328</span>        _check_info(info, <span class="stringliteral">&#39;stemr_lwork&#39;</span>)</div>
<div class="line"><span class="lineno"> 1329</span>        m, w, v, info = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(d, e_, select, vl, vu, il, iu,</div>
<div class="line"><span class="lineno"> 1330</span>                             compute_v=compute_v, lwork=lwork, liwork=liwork)</div>
<div class="line"><span class="lineno"> 1331</span>    _check_info(info, lapack_driver + <span class="stringliteral">&#39; (eigh_tridiagonal)&#39;</span>)</div>
<div class="line"><span class="lineno"> 1332</span>    w = w[:m]</div>
<div class="line"><span class="lineno"> 1333</span>    <span class="keywordflow">if</span> eigvals_only:</div>
<div class="line"><span class="lineno"> 1334</span>        <span class="keywordflow">return</span> w</div>
<div class="line"><span class="lineno"> 1335</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1336</span>        <span class="comment"># Do we still need to compute the eigenvalues?</span></div>
<div class="line"><span class="lineno"> 1337</span>        <span class="keywordflow">if</span> lapack_driver == <span class="stringliteral">&#39;stebz&#39;</span>:</div>
<div class="line"><span class="lineno"> 1338</span>            func, = get_lapack_funcs((<span class="stringliteral">&#39;stein&#39;</span>,), (d, e))</div>
<div class="line"><span class="lineno"> 1339</span>            v, info = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(d, e, w, iblock, isplit)</div>
<div class="line"><span class="lineno"> 1340</span>            _check_info(info, <span class="stringliteral">&#39;stein (eigh_tridiagonal)&#39;</span>,</div>
<div class="line"><span class="lineno"> 1341</span>                        positive=<span class="stringliteral">&#39;%d eigenvectors failed to converge&#39;</span>)</div>
<div class="line"><span class="lineno"> 1342</span>            <span class="comment"># Convert block-order to matrix-order</span></div>
<div class="line"><span class="lineno"> 1343</span>            order = argsort(w)</div>
<div class="line"><span class="lineno"> 1344</span>            w, v = w[order], v[:, order]</div>
<div class="line"><span class="lineno"> 1345</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1346</span>            v = v[:, :m]</div>
<div class="line"><span class="lineno"> 1347</span>        <span class="keywordflow">return</span> w, v</div>
<div class="line"><span class="lineno"> 1348</span> </div>
<div class="line"><span class="lineno"> 1349</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a84379fe233225ca57719634e3daaae31" name="a84379fe233225ca57719634e3daaae31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84379fe233225ca57719634e3daaae31">&#9670;&#160;</a></span>eigvals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.eigvals </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_a</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>homogeneous_eigvals</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute eigenvalues from an ordinary or generalized eigenvalue problem.

Find eigenvalues of a general matrix::

    a   vr[:,i] = w[i]        b   vr[:,i]

Parameters
----------
a : (M, M) array_like
    A complex or real matrix whose eigenvalues and eigenvectors
    will be computed.
b : (M, M) array_like, optional
    Right-hand side matrix in a generalized eigenvalue problem.
    If omitted, identity matrix is assumed.
overwrite_a : bool, optional
    Whether to overwrite data in a (may improve performance)
check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities
    or NaNs.
homogeneous_eigvals : bool, optional
    If True, return the eigenvalues in homogeneous coordinates.
    In this case ``w`` is a (2, M) array so that::

        w[1,i] a vr[:,i] = w[0,i] b vr[:,i]

    Default is False.

Returns
-------
w : (M,) or (2, M) double or complex ndarray
    The eigenvalues, each repeated according to its multiplicity
    but not in any specific order. The shape is (M,) unless
    ``homogeneous_eigvals=True``.

Raises
------
LinAlgError
    If eigenvalue computation does not converge

See Also
--------
eig : eigenvalues and right eigenvectors of general arrays.
eigvalsh : eigenvalues of symmetric or Hermitian arrays
eigvals_banded : eigenvalues for symmetric/Hermitian band matrices
eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal
    matrices

Examples
--------
&gt;&gt;&gt; from scipy import linalg
&gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])
&gt;&gt;&gt; linalg.eigvals(a)
array([0.+1.j, 0.-1.j])

&gt;&gt;&gt; b = np.array([[0., 1.], [1., 1.]])
&gt;&gt;&gt; linalg.eigvals(a, b)
array([ 1.+0.j, -1.+0.j])

&gt;&gt;&gt; a = np.array([[3., 0., 0.], [0., 8., 0.], [0., 0., 7.]])
&gt;&gt;&gt; linalg.eigvals(a, homogeneous_eigvals=True)
array([[3.+0.j, 8.+0.j, 7.+0.j],
       [1.+0.j, 1.+0.j, 1.+0.j]])</pre> <div class="fragment"><div class="line"><span class="lineno">  812</span>            homogeneous_eigvals=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  813</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  814</span><span class="stringliteral">    Compute eigenvalues from an ordinary or generalized eigenvalue problem.</span></div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">    Find eigenvalues of a general matrix::</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">        a   vr[:,i] = w[i]        b   vr[:,i]</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">    a : (M, M) array_like</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">        A complex or real matrix whose eigenvalues and eigenvectors</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">        will be computed.</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">    b : (M, M) array_like, optional</span></div>
<div class="line"><span class="lineno">  826</span><span class="stringliteral">        Right-hand side matrix in a generalized eigenvalue problem.</span></div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral">        If omitted, identity matrix is assumed.</span></div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral">    overwrite_a : bool, optional</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">        Whether to overwrite data in a (may improve performance)</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  831</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  832</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  833</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities</span></div>
<div class="line"><span class="lineno">  834</span><span class="stringliteral">        or NaNs.</span></div>
<div class="line"><span class="lineno">  835</span><span class="stringliteral">    homogeneous_eigvals : bool, optional</span></div>
<div class="line"><span class="lineno">  836</span><span class="stringliteral">        If True, return the eigenvalues in homogeneous coordinates.</span></div>
<div class="line"><span class="lineno">  837</span><span class="stringliteral">        In this case ``w`` is a (2, M) array so that::</span></div>
<div class="line"><span class="lineno">  838</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  839</span><span class="stringliteral">            w[1,i] a vr[:,i] = w[0,i] b vr[:,i]</span></div>
<div class="line"><span class="lineno">  840</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  841</span><span class="stringliteral">        Default is False.</span></div>
<div class="line"><span class="lineno">  842</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  843</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  844</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  845</span><span class="stringliteral">    w : (M,) or (2, M) double or complex ndarray</span></div>
<div class="line"><span class="lineno">  846</span><span class="stringliteral">        The eigenvalues, each repeated according to its multiplicity</span></div>
<div class="line"><span class="lineno">  847</span><span class="stringliteral">        but not in any specific order. The shape is (M,) unless</span></div>
<div class="line"><span class="lineno">  848</span><span class="stringliteral">        ``homogeneous_eigvals=True``.</span></div>
<div class="line"><span class="lineno">  849</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  850</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  851</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  852</span><span class="stringliteral">    LinAlgError</span></div>
<div class="line"><span class="lineno">  853</span><span class="stringliteral">        If eigenvalue computation does not converge</span></div>
<div class="line"><span class="lineno">  854</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  855</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  856</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  857</span><span class="stringliteral">    eig : eigenvalues and right eigenvectors of general arrays.</span></div>
<div class="line"><span class="lineno">  858</span><span class="stringliteral">    eigvalsh : eigenvalues of symmetric or Hermitian arrays</span></div>
<div class="line"><span class="lineno">  859</span><span class="stringliteral">    eigvals_banded : eigenvalues for symmetric/Hermitian band matrices</span></div>
<div class="line"><span class="lineno">  860</span><span class="stringliteral">    eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal</span></div>
<div class="line"><span class="lineno">  861</span><span class="stringliteral">        matrices</span></div>
<div class="line"><span class="lineno">  862</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  863</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  864</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  865</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import linalg</span></div>
<div class="line"><span class="lineno">  866</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])</span></div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eigvals(a)</span></div>
<div class="line"><span class="lineno">  868</span><span class="stringliteral">    array([0.+1.j, 0.-1.j])</span></div>
<div class="line"><span class="lineno">  869</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  870</span><span class="stringliteral">    &gt;&gt;&gt; b = np.array([[0., 1.], [1., 1.]])</span></div>
<div class="line"><span class="lineno">  871</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eigvals(a, b)</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral">    array([ 1.+0.j, -1.+0.j])</span></div>
<div class="line"><span class="lineno">  873</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  874</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[3., 0., 0.], [0., 8., 0.], [0., 0., 7.]])</span></div>
<div class="line"><span class="lineno">  875</span><span class="stringliteral">    &gt;&gt;&gt; linalg.eigvals(a, homogeneous_eigvals=True)</span></div>
<div class="line"><span class="lineno">  876</span><span class="stringliteral">    array([[3.+0.j, 8.+0.j, 7.+0.j],</span></div>
<div class="line"><span class="lineno">  877</span><span class="stringliteral">           [1.+0.j, 1.+0.j, 1.+0.j]])</span></div>
<div class="line"><span class="lineno">  878</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  879</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  880</span>    <span class="keywordflow">return</span> eig(a, b=b, left=0, right=0, overwrite_a=overwrite_a,</div>
<div class="line"><span class="lineno">  881</span>               check_finite=check_finite,</div>
<div class="line"><span class="lineno">  882</span>               homogeneous_eigvals=homogeneous_eigvals)</div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afd5ac3fa1c4dfa155bce6260a8591dc0" name="afd5ac3fa1c4dfa155bce6260a8591dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd5ac3fa1c4dfa155bce6260a8591dc0">&#9670;&#160;</a></span>eigvals_banded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.eigvals_banded </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a_band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lower</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_a_band</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select</em> = <code>'<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select_range</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solve real symmetric or complex Hermitian band matrix eigenvalue problem.

Find eigenvalues w of a::

    a v[:,i] = w[i] v[:,i]
    v.H v    = identity

The matrix a is stored in a_band either in lower diagonal or upper
diagonal ordered form:

    a_band[u + i - j, j] == a[i,j]        (if upper form; i &lt;= j)
    a_band[    i - j, j] == a[i,j]        (if lower form; i &gt;= j)

where u is the number of bands above the diagonal.

Example of a_band (shape of a is (6,6), u=2)::

    upper form:
    *   *   a02 a13 a24 a35
    *   a01 a12 a23 a34 a45
    a00 a11 a22 a33 a44 a55

    lower form:
    a00 a11 a22 a33 a44 a55
    a10 a21 a32 a43 a54 *
    a20 a31 a42 a53 *   *

Cells marked with * are not used.

Parameters
----------
a_band : (u+1, M) array_like
    The bands of the M by M matrix a.
lower : bool, optional
    Is the matrix in the lower form. (Default is upper form)
overwrite_a_band : bool, optional
    Discard data in a_band (may enhance performance)
select : {'a', 'v', 'i'}, optional
    Which eigenvalues to calculate

    ======  ========================================
    select  calculated
    ======  ========================================
    'a'     All eigenvalues
    'v'     Eigenvalues in the interval (min, max]
    'i'     Eigenvalues with indices min &lt;= i &lt;= max
    ======  ========================================
select_range : (min, max), optional
    Range of selected eigenvalues
check_finite : bool, optional
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.

Returns
-------
w : (M,) ndarray
    The eigenvalues, in ascending order, each repeated according to its
    multiplicity.

Raises
------
LinAlgError
    If eigenvalue computation does not converge.

See Also
--------
eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian
    band matrices
eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal
    matrices
eigvals : eigenvalues of general arrays
eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays
eig : eigenvalues and right eigenvectors for non-symmetric arrays

Examples
--------
&gt;&gt;&gt; from scipy.linalg import eigvals_banded
&gt;&gt;&gt; A = np.array([[1, 5, 2, 0], [5, 2, 5, 2], [2, 5, 3, 5], [0, 2, 5, 4]])
&gt;&gt;&gt; Ab = np.array([[1, 2, 3, 4], [5, 5, 5, 0], [2, 2, 0, 0]])
&gt;&gt;&gt; w = eigvals_banded(Ab, lower=True)
&gt;&gt;&gt; w
array([-4.26200532, -2.22987175,  3.95222349, 12.53965359])
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1018</span>                   select=<span class="stringliteral">&#39;a&#39;</span>, select_range=<span class="keywordtype">None</span>, check_finite=<span class="keyword">True</span>):</div>
<div class="line"><span class="lineno"> 1019</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral">    Solve real symmetric or complex Hermitian band matrix eigenvalue problem.</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral">    Find eigenvalues w of a::</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral">        a v[:,i] = w[i] v[:,i]</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral">        v.H v    = identity</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1027</span><span class="stringliteral">    The matrix a is stored in a_band either in lower diagonal or upper</span></div>
<div class="line"><span class="lineno"> 1028</span><span class="stringliteral">    diagonal ordered form:</span></div>
<div class="line"><span class="lineno"> 1029</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1030</span><span class="stringliteral">        a_band[u + i - j, j] == a[i,j]        (if upper form; i &lt;= j)</span></div>
<div class="line"><span class="lineno"> 1031</span><span class="stringliteral">        a_band[    i - j, j] == a[i,j]        (if lower form; i &gt;= j)</span></div>
<div class="line"><span class="lineno"> 1032</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1033</span><span class="stringliteral">    where u is the number of bands above the diagonal.</span></div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral">    Example of a_band (shape of a is (6,6), u=2)::</span></div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral">        upper form:</span></div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">        *   *   a02 a13 a24 a35</span></div>
<div class="line"><span class="lineno"> 1039</span><span class="stringliteral">        *   a01 a12 a23 a34 a45</span></div>
<div class="line"><span class="lineno"> 1040</span><span class="stringliteral">        a00 a11 a22 a33 a44 a55</span></div>
<div class="line"><span class="lineno"> 1041</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1042</span><span class="stringliteral">        lower form:</span></div>
<div class="line"><span class="lineno"> 1043</span><span class="stringliteral">        a00 a11 a22 a33 a44 a55</span></div>
<div class="line"><span class="lineno"> 1044</span><span class="stringliteral">        a10 a21 a32 a43 a54 *</span></div>
<div class="line"><span class="lineno"> 1045</span><span class="stringliteral">        a20 a31 a42 a53 *   *</span></div>
<div class="line"><span class="lineno"> 1046</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1047</span><span class="stringliteral">    Cells marked with * are not used.</span></div>
<div class="line"><span class="lineno"> 1048</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">    a_band : (u+1, M) array_like</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">        The bands of the M by M matrix a.</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">    lower : bool, optional</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">        Is the matrix in the lower form. (Default is upper form)</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral">    overwrite_a_band : bool, optional</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">        Discard data in a_band (may enhance performance)</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral">    select : {&#39;a&#39;, &#39;v&#39;, &#39;i&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">        Which eigenvalues to calculate</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral">        select  calculated</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral">        &#39;a&#39;     All eigenvalues</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral">        &#39;v&#39;     Eigenvalues in the interval (min, max]</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral">        &#39;i&#39;     Eigenvalues with indices min &lt;= i &lt;= max</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="stringliteral">    select_range : (min, max), optional</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="stringliteral">        Range of selected eigenvalues</span></div>
<div class="line"><span class="lineno"> 1069</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="stringliteral">        Whether to check that the input matrix contains only finite numbers.</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">    w : (M,) ndarray</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral">        The eigenvalues, in ascending order, each repeated according to its</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">        multiplicity.</span></div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">    LinAlgError</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral">        If eigenvalue computation does not converge.</span></div>
<div class="line"><span class="lineno"> 1084</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1085</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1086</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1087</span><span class="stringliteral">    eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian</span></div>
<div class="line"><span class="lineno"> 1088</span><span class="stringliteral">        band matrices</span></div>
<div class="line"><span class="lineno"> 1089</span><span class="stringliteral">    eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal</span></div>
<div class="line"><span class="lineno"> 1090</span><span class="stringliteral">        matrices</span></div>
<div class="line"><span class="lineno"> 1091</span><span class="stringliteral">    eigvals : eigenvalues of general arrays</span></div>
<div class="line"><span class="lineno"> 1092</span><span class="stringliteral">    eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays</span></div>
<div class="line"><span class="lineno"> 1093</span><span class="stringliteral">    eig : eigenvalues and right eigenvectors for non-symmetric arrays</span></div>
<div class="line"><span class="lineno"> 1094</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1095</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1096</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1097</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import eigvals_banded</span></div>
<div class="line"><span class="lineno"> 1098</span><span class="stringliteral">    &gt;&gt;&gt; A = np.array([[1, 5, 2, 0], [5, 2, 5, 2], [2, 5, 3, 5], [0, 2, 5, 4]])</span></div>
<div class="line"><span class="lineno"> 1099</span><span class="stringliteral">    &gt;&gt;&gt; Ab = np.array([[1, 2, 3, 4], [5, 5, 5, 0], [2, 2, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1100</span><span class="stringliteral">    &gt;&gt;&gt; w = eigvals_banded(Ab, lower=True)</span></div>
<div class="line"><span class="lineno"> 1101</span><span class="stringliteral">    &gt;&gt;&gt; w</span></div>
<div class="line"><span class="lineno"> 1102</span><span class="stringliteral">    array([-4.26200532, -2.22987175,  3.95222349, 12.53965359])</span></div>
<div class="line"><span class="lineno"> 1103</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1104</span>    <span class="keywordflow">return</span> eig_banded(a_band, lower=lower, eigvals_only=1,</div>
<div class="line"><span class="lineno"> 1105</span>                      overwrite_a_band=overwrite_a_band, select=select,</div>
<div class="line"><span class="lineno"> 1106</span>                      select_range=select_range, check_finite=check_finite)</div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5228dd5bb7c2d9aeff5dcfb1192abd67" name="a5228dd5bb7c2d9aeff5dcfb1192abd67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5228dd5bb7c2d9aeff5dcfb1192abd67">&#9670;&#160;</a></span>eigvalsh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.eigvalsh </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lower</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_a</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_b</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>turbo</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eigvals</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>type</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>subset_by_index</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>subset_by_value</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>driver</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solves a standard or generalized eigenvalue problem for a complex
Hermitian or real symmetric matrix.

Find eigenvalues array ``w`` of array ``a``, where ``b`` is positive
definite such that for every eigenvalue  (i-th entry of w) and its
eigenvector vi (i-th column of v) satisfies::

                  a @ vi =  * b @ vi
    vi.conj().T @ a @ vi = 
    vi.conj().T @ b @ vi = 1

In the standard problem, b is assumed to be the identity matrix.

Parameters
----------
a : (M, M) array_like
    A complex Hermitian or real symmetric matrix whose eigenvalues will
    be computed.
b : (M, M) array_like, optional
    A complex Hermitian or real symmetric definite positive matrix in.
    If omitted, identity matrix is assumed.
lower : bool, optional
    Whether the pertinent array data is taken from the lower or upper
    triangle of ``a`` and, if applicable, ``b``. (Default: lower)
overwrite_a : bool, optional
    Whether to overwrite data in ``a`` (may improve performance). Default
    is False.
overwrite_b : bool, optional
    Whether to overwrite data in ``b`` (may improve performance). Default
    is False.
type : int, optional
    For the generalized problems, this keyword specifies the problem type
    to be solved for ``w`` and ``v`` (only takes 1, 2, 3 as possible
    inputs)::

        1 =&gt;     a @ v = w @ b @ v
        2 =&gt; a @ b @ v = w @ v
        3 =&gt; b @ a @ v = w @ v

    This keyword is ignored for standard problems.
check_finite : bool, optional
    Whether to check that the input matrices contain only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
subset_by_index : iterable, optional
    If provided, this two-element iterable defines the start and the end
    indices of the desired eigenvalues (ascending order and 0-indexed).
    To return only the second smallest to fifth smallest eigenvalues,
    ``[1, 4]`` is used. ``[n-3, n-1]`` returns the largest three. Only
    available with "evr", "evx", and "gvx" drivers. The entries are
    directly converted to integers via ``int()``.
subset_by_value : iterable, optional
    If provided, this two-element iterable defines the half-open interval
    ``(a, b]`` that, if any, only the eigenvalues between these values
    are returned. Only available with "evr", "evx", and "gvx" drivers. Use
    ``np.inf`` for the unconstrained ends.
driver : str, optional
    Defines which LAPACK driver should be used. Valid options are "ev",
    "evd", "evr", "evx" for standard problems and "gv", "gvd", "gvx" for
    generalized (where b is not None) problems. See the Notes section of
    `scipy.linalg.eigh`.
turbo : bool, optional
    *Deprecated by ``driver=gvd`` option*. Has no significant effect for
    eigenvalue computations since no eigenvectors are requested.

    .. deprecated:: 1.5.0

eigvals : tuple (lo, hi), optional
    *Deprecated by ``subset_by_index`` keyword*. Indexes of the smallest
    and largest (in ascending order) eigenvalues and corresponding
    eigenvectors to be returned: 0 &lt;= lo &lt;= hi &lt;= M-1. If omitted, all
    eigenvalues and eigenvectors are returned.

    .. deprecated:: 1.5.0

Returns
-------
w : (N,) ndarray
    The ``N`` (``1&lt;=N&lt;=M``) selected eigenvalues, in ascending order, each
    repeated according to its multiplicity.

Raises
------
LinAlgError
    If eigenvalue computation does not converge, an error occurred, or
    b matrix is not definite positive. Note that if input matrices are
    not symmetric or Hermitian, no error will be reported but results will
    be wrong.

See Also
--------
eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays
eigvals : eigenvalues of general arrays
eigvals_banded : eigenvalues for symmetric/Hermitian band matrices
eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal
    matrices

Notes
-----
This function does not check the input array for being Hermitian/symmetric
in order to allow for representing arrays with only their upper/lower
triangular parts.

This function serves as a one-liner shorthand for `scipy.linalg.eigh` with
the option ``eigvals_only=True`` to get the eigenvalues and not the
eigenvectors. Here it is kept as a legacy convenience. It might be
beneficial to use the main function to have full control and to be a bit
more pythonic.

Examples
--------
For more examples see `scipy.linalg.eigh`.

&gt;&gt;&gt; from scipy.linalg import eigvalsh
&gt;&gt;&gt; A = np.array([[6, 3, 1, 5], [3, 0, 5, 1], [1, 5, 6, 2], [5, 1, 2, 2]])
&gt;&gt;&gt; w = eigvalsh(A)
&gt;&gt;&gt; w
array([-3.74637491, -0.76263923,  6.08502336, 12.42399079])</pre> <div class="fragment"><div class="line"><span class="lineno">  888</span>             driver=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  889</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  890</span><span class="stringliteral">    Solves a standard or generalized eigenvalue problem for a complex</span></div>
<div class="line"><span class="lineno">  891</span><span class="stringliteral">    Hermitian or real symmetric matrix.</span></div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">    Find eigenvalues array ``w`` of array ``a``, where ``b`` is positive</span></div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral">    definite such that for every eigenvalue  (i-th entry of w) and its</span></div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">    eigenvector vi (i-th column of v) satisfies::</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">                      a @ vi =  * b @ vi</span></div>
<div class="line"><span class="lineno">  898</span><span class="stringliteral">        vi.conj().T @ a @ vi = </span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral">        vi.conj().T @ b @ vi = 1</span></div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">    In the standard problem, b is assumed to be the identity matrix.</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral">    a : (M, M) array_like</span></div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">        A complex Hermitian or real symmetric matrix whose eigenvalues will</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">        be computed.</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">    b : (M, M) array_like, optional</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral">        A complex Hermitian or real symmetric definite positive matrix in.</span></div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">        If omitted, identity matrix is assumed.</span></div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral">    lower : bool, optional</span></div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">        Whether the pertinent array data is taken from the lower or upper</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral">        triangle of ``a`` and, if applicable, ``b``. (Default: lower)</span></div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">    overwrite_a : bool, optional</span></div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral">        Whether to overwrite data in ``a`` (may improve performance). Default</span></div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral">        is False.</span></div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">    overwrite_b : bool, optional</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">        Whether to overwrite data in ``b`` (may improve performance). Default</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">        is False.</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral">    type : int, optional</span></div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral">        For the generalized problems, this keyword specifies the problem type</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">        to be solved for ``w`` and ``v`` (only takes 1, 2, 3 as possible</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral">        inputs)::</span></div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral">            1 =&gt;     a @ v = w @ b @ v</span></div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">            2 =&gt; a @ b @ v = w @ v</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">            3 =&gt; b @ a @ v = w @ v</span></div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral">        This keyword is ignored for standard problems.</span></div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral">        Whether to check that the input matrices contain only finite numbers.</span></div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral">    subset_by_index : iterable, optional</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral">        If provided, this two-element iterable defines the start and the end</span></div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">        indices of the desired eigenvalues (ascending order and 0-indexed).</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">        To return only the second smallest to fifth smallest eigenvalues,</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral">        ``[1, 4]`` is used. ``[n-3, n-1]`` returns the largest three. Only</span></div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">        available with &quot;evr&quot;, &quot;evx&quot;, and &quot;gvx&quot; drivers. The entries are</span></div>
<div class="line"><span class="lineno">  940</span><span class="stringliteral">        directly converted to integers via ``int()``.</span></div>
<div class="line"><span class="lineno">  941</span><span class="stringliteral">    subset_by_value : iterable, optional</span></div>
<div class="line"><span class="lineno">  942</span><span class="stringliteral">        If provided, this two-element iterable defines the half-open interval</span></div>
<div class="line"><span class="lineno">  943</span><span class="stringliteral">        ``(a, b]`` that, if any, only the eigenvalues between these values</span></div>
<div class="line"><span class="lineno">  944</span><span class="stringliteral">        are returned. Only available with &quot;evr&quot;, &quot;evx&quot;, and &quot;gvx&quot; drivers. Use</span></div>
<div class="line"><span class="lineno">  945</span><span class="stringliteral">        ``np.inf`` for the unconstrained ends.</span></div>
<div class="line"><span class="lineno">  946</span><span class="stringliteral">    driver : str, optional</span></div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral">        Defines which LAPACK driver should be used. Valid options are &quot;ev&quot;,</span></div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral">        &quot;evd&quot;, &quot;evr&quot;, &quot;evx&quot; for standard problems and &quot;gv&quot;, &quot;gvd&quot;, &quot;gvx&quot; for</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">        generalized (where b is not None) problems. See the Notes section of</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">        `scipy.linalg.eigh`.</span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    turbo : bool, optional</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">        *Deprecated by ``driver=gvd`` option*. Has no significant effect for</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral">        eigenvalue computations since no eigenvectors are requested.</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">        .. deprecated:: 1.5.0</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">    eigvals : tuple (lo, hi), optional</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">        *Deprecated by ``subset_by_index`` keyword*. Indexes of the smallest</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral">        and largest (in ascending order) eigenvalues and corresponding</span></div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">        eigenvectors to be returned: 0 &lt;= lo &lt;= hi &lt;= M-1. If omitted, all</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">        eigenvalues and eigenvectors are returned.</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">        .. deprecated:: 1.5.0</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  967</span><span class="stringliteral">    w : (N,) ndarray</span></div>
<div class="line"><span class="lineno">  968</span><span class="stringliteral">        The ``N`` (``1&lt;=N&lt;=M``) selected eigenvalues, in ascending order, each</span></div>
<div class="line"><span class="lineno">  969</span><span class="stringliteral">        repeated according to its multiplicity.</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">    LinAlgError</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">        If eigenvalue computation does not converge, an error occurred, or</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">        b matrix is not definite positive. Note that if input matrices are</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">        not symmetric or Hermitian, no error will be reported but results will</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">        be wrong.</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">    eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">    eigvals : eigenvalues of general arrays</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">    eigvals_banded : eigenvalues for symmetric/Hermitian band matrices</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">    eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">        matrices</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">    This function does not check the input array for being Hermitian/symmetric</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">    in order to allow for representing arrays with only their upper/lower</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral">    triangular parts.</span></div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">    This function serves as a one-liner shorthand for `scipy.linalg.eigh` with</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">    the option ``eigvals_only=True`` to get the eigenvalues and not the</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral">    eigenvectors. Here it is kept as a legacy convenience. It might be</span></div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">    beneficial to use the main function to have full control and to be a bit</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral">    more pythonic.</span></div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1001</span><span class="stringliteral">    For more examples see `scipy.linalg.eigh`.</span></div>
<div class="line"><span class="lineno"> 1002</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1003</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import eigvalsh</span></div>
<div class="line"><span class="lineno"> 1004</span><span class="stringliteral">    &gt;&gt;&gt; A = np.array([[6, 3, 1, 5], [3, 0, 5, 1], [1, 5, 6, 2], [5, 1, 2, 2]])</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="stringliteral">    &gt;&gt;&gt; w = eigvalsh(A)</span></div>
<div class="line"><span class="lineno"> 1006</span><span class="stringliteral">    &gt;&gt;&gt; w</span></div>
<div class="line"><span class="lineno"> 1007</span><span class="stringliteral">    array([-3.74637491, -0.76263923,  6.08502336, 12.42399079])</span></div>
<div class="line"><span class="lineno"> 1008</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1009</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keywordflow">return</span> eigh(a, b=b, lower=lower, eigvals_only=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1011</span>                overwrite_a=overwrite_a, overwrite_b=overwrite_b,</div>
<div class="line"><span class="lineno"> 1012</span>                turbo=turbo, eigvals=eigvals, type=type,</div>
<div class="line"><span class="lineno"> 1013</span>                check_finite=check_finite, subset_by_index=subset_by_index,</div>
<div class="line"><span class="lineno"> 1014</span>                subset_by_value=subset_by_value, driver=driver)</div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af5546b86001a7fb1ffcc6441f255d099" name="af5546b86001a7fb1ffcc6441f255d099"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5546b86001a7fb1ffcc6441f255d099">&#9670;&#160;</a></span>eigvalsh_tridiagonal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.eigvalsh_tridiagonal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select</em> = <code>'<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>select_range</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lapack_driver</em> = <code>'auto'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solve eigenvalue problem for a real symmetric tridiagonal matrix.

Find eigenvalues `w` of ``a``::

    a v[:,i] = w[i] v[:,i]
    v.H v    = identity

For a real symmetric matrix ``a`` with diagonal elements `d` and
off-diagonal elements `e`.

Parameters
----------
d : ndarray, shape (ndim,)
    The diagonal elements of the array.
e : ndarray, shape (ndim-1,)
    The off-diagonal elements of the array.
select : {'a', 'v', 'i'}, optional
    Which eigenvalues to calculate

    ======  ========================================
    select  calculated
    ======  ========================================
    'a'     All eigenvalues
    'v'     Eigenvalues in the interval (min, max]
    'i'     Eigenvalues with indices min &lt;= i &lt;= max
    ======  ========================================
select_range : (min, max), optional
    Range of selected eigenvalues
check_finite : bool, optional
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.
tol : float
    The absolute tolerance to which each eigenvalue is required
    (only used when ``lapack_driver='stebz'``).
    An eigenvalue (or cluster) is considered to have converged if it
    lies in an interval of this width. If &lt;= 0. (default),
    the value ``eps*|a|`` is used where eps is the machine precision,
    and ``|a|`` is the 1-norm of the matrix ``a``.
lapack_driver : str
    LAPACK function to use, can be 'auto', 'stemr', 'stebz',  'sterf',
    or 'stev'. When 'auto' (default), it will use 'stemr' if ``select='a'``
    and 'stebz' otherwise. 'sterf' and 'stev' can only be used when
    ``select='a'``.

Returns
-------
w : (M,) ndarray
    The eigenvalues, in ascending order, each repeated according to its
    multiplicity.

Raises
------
LinAlgError
    If eigenvalue computation does not converge.

See Also
--------
eigh_tridiagonal : eigenvalues and right eiegenvectors for
    symmetric/Hermitian tridiagonal matrices

Examples
--------
&gt;&gt;&gt; from scipy.linalg import eigvalsh_tridiagonal, eigvalsh
&gt;&gt;&gt; d = 3*np.ones(4)
&gt;&gt;&gt; e = -1*np.ones(3)
&gt;&gt;&gt; w = eigvalsh_tridiagonal(d, e)
&gt;&gt;&gt; A = np.diag(d) + np.diag(e, k=1) + np.diag(e, k=-1)
&gt;&gt;&gt; w2 = eigvalsh(A)  # Verify with other eigenvalue routines
&gt;&gt;&gt; np.allclose(w - w2, np.zeros(4))
True
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1110</span>                         check_finite=<span class="keyword">True</span>, tol=0., lapack_driver=<span class="stringliteral">&#39;auto&#39;</span>):</div>
<div class="line"><span class="lineno"> 1111</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1112</span><span class="stringliteral">    Solve eigenvalue problem for a real symmetric tridiagonal matrix.</span></div>
<div class="line"><span class="lineno"> 1113</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1114</span><span class="stringliteral">    Find eigenvalues `w` of ``a``::</span></div>
<div class="line"><span class="lineno"> 1115</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1116</span><span class="stringliteral">        a v[:,i] = w[i] v[:,i]</span></div>
<div class="line"><span class="lineno"> 1117</span><span class="stringliteral">        v.H v    = identity</span></div>
<div class="line"><span class="lineno"> 1118</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1119</span><span class="stringliteral">    For a real symmetric matrix ``a`` with diagonal elements `d` and</span></div>
<div class="line"><span class="lineno"> 1120</span><span class="stringliteral">    off-diagonal elements `e`.</span></div>
<div class="line"><span class="lineno"> 1121</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1122</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1123</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1124</span><span class="stringliteral">    d : ndarray, shape (ndim,)</span></div>
<div class="line"><span class="lineno"> 1125</span><span class="stringliteral">        The diagonal elements of the array.</span></div>
<div class="line"><span class="lineno"> 1126</span><span class="stringliteral">    e : ndarray, shape (ndim-1,)</span></div>
<div class="line"><span class="lineno"> 1127</span><span class="stringliteral">        The off-diagonal elements of the array.</span></div>
<div class="line"><span class="lineno"> 1128</span><span class="stringliteral">    select : {&#39;a&#39;, &#39;v&#39;, &#39;i&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1129</span><span class="stringliteral">        Which eigenvalues to calculate</span></div>
<div class="line"><span class="lineno"> 1130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1131</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1132</span><span class="stringliteral">        select  calculated</span></div>
<div class="line"><span class="lineno"> 1133</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1134</span><span class="stringliteral">        &#39;a&#39;     All eigenvalues</span></div>
<div class="line"><span class="lineno"> 1135</span><span class="stringliteral">        &#39;v&#39;     Eigenvalues in the interval (min, max]</span></div>
<div class="line"><span class="lineno"> 1136</span><span class="stringliteral">        &#39;i&#39;     Eigenvalues with indices min &lt;= i &lt;= max</span></div>
<div class="line"><span class="lineno"> 1137</span><span class="stringliteral">        ======  ========================================</span></div>
<div class="line"><span class="lineno"> 1138</span><span class="stringliteral">    select_range : (min, max), optional</span></div>
<div class="line"><span class="lineno"> 1139</span><span class="stringliteral">        Range of selected eigenvalues</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno"> 1141</span><span class="stringliteral">        Whether to check that the input matrix contains only finite numbers.</span></div>
<div class="line"><span class="lineno"> 1142</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno"> 1145</span><span class="stringliteral">        The absolute tolerance to which each eigenvalue is required</span></div>
<div class="line"><span class="lineno"> 1146</span><span class="stringliteral">        (only used when ``lapack_driver=&#39;stebz&#39;``).</span></div>
<div class="line"><span class="lineno"> 1147</span><span class="stringliteral">        An eigenvalue (or cluster) is considered to have converged if it</span></div>
<div class="line"><span class="lineno"> 1148</span><span class="stringliteral">        lies in an interval of this width. If &lt;= 0. (default),</span></div>
<div class="line"><span class="lineno"> 1149</span><span class="stringliteral">        the value ``eps*|a|`` is used where eps is the machine precision,</span></div>
<div class="line"><span class="lineno"> 1150</span><span class="stringliteral">        and ``|a|`` is the 1-norm of the matrix ``a``.</span></div>
<div class="line"><span class="lineno"> 1151</span><span class="stringliteral">    lapack_driver : str</span></div>
<div class="line"><span class="lineno"> 1152</span><span class="stringliteral">        LAPACK function to use, can be &#39;auto&#39;, &#39;stemr&#39;, &#39;stebz&#39;,  &#39;sterf&#39;,</span></div>
<div class="line"><span class="lineno"> 1153</span><span class="stringliteral">        or &#39;stev&#39;. When &#39;auto&#39; (default), it will use &#39;stemr&#39; if ``select=&#39;a&#39;``</span></div>
<div class="line"><span class="lineno"> 1154</span><span class="stringliteral">        and &#39;stebz&#39; otherwise. &#39;sterf&#39; and &#39;stev&#39; can only be used when</span></div>
<div class="line"><span class="lineno"> 1155</span><span class="stringliteral">        ``select=&#39;a&#39;``.</span></div>
<div class="line"><span class="lineno"> 1156</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1157</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1158</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1159</span><span class="stringliteral">    w : (M,) ndarray</span></div>
<div class="line"><span class="lineno"> 1160</span><span class="stringliteral">        The eigenvalues, in ascending order, each repeated according to its</span></div>
<div class="line"><span class="lineno"> 1161</span><span class="stringliteral">        multiplicity.</span></div>
<div class="line"><span class="lineno"> 1162</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1163</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno"> 1164</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno"> 1165</span><span class="stringliteral">    LinAlgError</span></div>
<div class="line"><span class="lineno"> 1166</span><span class="stringliteral">        If eigenvalue computation does not converge.</span></div>
<div class="line"><span class="lineno"> 1167</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1168</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1169</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1170</span><span class="stringliteral">    eigh_tridiagonal : eigenvalues and right eiegenvectors for</span></div>
<div class="line"><span class="lineno"> 1171</span><span class="stringliteral">        symmetric/Hermitian tridiagonal matrices</span></div>
<div class="line"><span class="lineno"> 1172</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1173</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1174</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1175</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import eigvalsh_tridiagonal, eigvalsh</span></div>
<div class="line"><span class="lineno"> 1176</span><span class="stringliteral">    &gt;&gt;&gt; d = 3*np.ones(4)</span></div>
<div class="line"><span class="lineno"> 1177</span><span class="stringliteral">    &gt;&gt;&gt; e = -1*np.ones(3)</span></div>
<div class="line"><span class="lineno"> 1178</span><span class="stringliteral">    &gt;&gt;&gt; w = eigvalsh_tridiagonal(d, e)</span></div>
<div class="line"><span class="lineno"> 1179</span><span class="stringliteral">    &gt;&gt;&gt; A = np.diag(d) + np.diag(e, k=1) + np.diag(e, k=-1)</span></div>
<div class="line"><span class="lineno"> 1180</span><span class="stringliteral">    &gt;&gt;&gt; w2 = eigvalsh(A)  # Verify with other eigenvalue routines</span></div>
<div class="line"><span class="lineno"> 1181</span><span class="stringliteral">    &gt;&gt;&gt; np.allclose(w - w2, np.zeros(4))</span></div>
<div class="line"><span class="lineno"> 1182</span><span class="stringliteral">    True</span></div>
<div class="line"><span class="lineno"> 1183</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1184</span>    <span class="keywordflow">return</span> eigh_tridiagonal(</div>
<div class="line"><span class="lineno"> 1185</span>        d, e, eigvals_only=<span class="keyword">True</span>, select=select, select_range=select_range,</div>
<div class="line"><span class="lineno"> 1186</span>        check_finite=check_finite, tol=tol, lapack_driver=lapack_driver)</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a0702d6966eb8ebf9d14863e54281e5" name="a0a0702d6966eb8ebf9d14863e54281e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a0702d6966eb8ebf9d14863e54281e5">&#9670;&#160;</a></span>hessenberg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp.hessenberg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>calc_q</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite_a</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute Hessenberg form of a matrix.

The Hessenberg decomposition is::

    A = Q H Q^H

where `Q` is unitary/orthogonal and `H` has only zero elements below
the first sub-diagonal.

Parameters
----------
a : (M, M) array_like
    Matrix to bring into Hessenberg form.
calc_q : bool, optional
    Whether to compute the transformation matrix.  Default is False.
overwrite_a : bool, optional
    Whether to overwrite `a`; may improve performance.
    Default is False.
check_finite : bool, optional
    Whether to check that the input matrix contains only finite numbers.
    Disabling may give a performance gain, but may result in problems
    (crashes, non-termination) if the inputs do contain infinities or NaNs.

Returns
-------
H : (M, M) ndarray
    Hessenberg form of `a`.
Q : (M, M) ndarray
    Unitary/orthogonal similarity transformation matrix ``A = Q H Q^H``.
    Only returned if ``calc_q=True``.

Examples
--------
&gt;&gt;&gt; from scipy.linalg import hessenberg
&gt;&gt;&gt; A = np.array([[2, 5, 8, 7], [5, 2, 2, 8], [7, 5, 6, 6], [5, 4, 4, 8]])
&gt;&gt;&gt; H, Q = hessenberg(A, calc_q=True)
&gt;&gt;&gt; H
array([[  2.        , -11.65843866,   1.42005301,   0.25349066],
       [ -9.94987437,  14.53535354,  -5.31022304,   2.43081618],
       [  0.        ,  -1.83299243,   0.38969961,  -0.51527034],
       [  0.        ,   0.        ,  -3.83189513,   1.07494686]])
&gt;&gt;&gt; np.allclose(Q @ H @ Q.conj().T - A, np.zeros((4, 4)))
True
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1359</span><span class="keyword">def </span>hessenberg(a, calc_q=False, overwrite_a=False, check_finite=True):</div>
<div class="line"><span class="lineno"> 1360</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1361</span><span class="stringliteral">    Compute Hessenberg form of a matrix.</span></div>
<div class="line"><span class="lineno"> 1362</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1363</span><span class="stringliteral">    The Hessenberg decomposition is::</span></div>
<div class="line"><span class="lineno"> 1364</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1365</span><span class="stringliteral">        A = Q H Q^H</span></div>
<div class="line"><span class="lineno"> 1366</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1367</span><span class="stringliteral">    where `Q` is unitary/orthogonal and `H` has only zero elements below</span></div>
<div class="line"><span class="lineno"> 1368</span><span class="stringliteral">    the first sub-diagonal.</span></div>
<div class="line"><span class="lineno"> 1369</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1370</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1371</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1372</span><span class="stringliteral">    a : (M, M) array_like</span></div>
<div class="line"><span class="lineno"> 1373</span><span class="stringliteral">        Matrix to bring into Hessenberg form.</span></div>
<div class="line"><span class="lineno"> 1374</span><span class="stringliteral">    calc_q : bool, optional</span></div>
<div class="line"><span class="lineno"> 1375</span><span class="stringliteral">        Whether to compute the transformation matrix.  Default is False.</span></div>
<div class="line"><span class="lineno"> 1376</span><span class="stringliteral">    overwrite_a : bool, optional</span></div>
<div class="line"><span class="lineno"> 1377</span><span class="stringliteral">        Whether to overwrite `a`; may improve performance.</span></div>
<div class="line"><span class="lineno"> 1378</span><span class="stringliteral">        Default is False.</span></div>
<div class="line"><span class="lineno"> 1379</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno"> 1380</span><span class="stringliteral">        Whether to check that the input matrix contains only finite numbers.</span></div>
<div class="line"><span class="lineno"> 1381</span><span class="stringliteral">        Disabling may give a performance gain, but may result in problems</span></div>
<div class="line"><span class="lineno"> 1382</span><span class="stringliteral">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span></div>
<div class="line"><span class="lineno"> 1383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1384</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1385</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1386</span><span class="stringliteral">    H : (M, M) ndarray</span></div>
<div class="line"><span class="lineno"> 1387</span><span class="stringliteral">        Hessenberg form of `a`.</span></div>
<div class="line"><span class="lineno"> 1388</span><span class="stringliteral">    Q : (M, M) ndarray</span></div>
<div class="line"><span class="lineno"> 1389</span><span class="stringliteral">        Unitary/orthogonal similarity transformation matrix ``A = Q H Q^H``.</span></div>
<div class="line"><span class="lineno"> 1390</span><span class="stringliteral">        Only returned if ``calc_q=True``.</span></div>
<div class="line"><span class="lineno"> 1391</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1392</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1393</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1394</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.linalg import hessenberg</span></div>
<div class="line"><span class="lineno"> 1395</span><span class="stringliteral">    &gt;&gt;&gt; A = np.array([[2, 5, 8, 7], [5, 2, 2, 8], [7, 5, 6, 6], [5, 4, 4, 8]])</span></div>
<div class="line"><span class="lineno"> 1396</span><span class="stringliteral">    &gt;&gt;&gt; H, Q = hessenberg(A, calc_q=True)</span></div>
<div class="line"><span class="lineno"> 1397</span><span class="stringliteral">    &gt;&gt;&gt; H</span></div>
<div class="line"><span class="lineno"> 1398</span><span class="stringliteral">    array([[  2.        , -11.65843866,   1.42005301,   0.25349066],</span></div>
<div class="line"><span class="lineno"> 1399</span><span class="stringliteral">           [ -9.94987437,  14.53535354,  -5.31022304,   2.43081618],</span></div>
<div class="line"><span class="lineno"> 1400</span><span class="stringliteral">           [  0.        ,  -1.83299243,   0.38969961,  -0.51527034],</span></div>
<div class="line"><span class="lineno"> 1401</span><span class="stringliteral">           [  0.        ,   0.        ,  -3.83189513,   1.07494686]])</span></div>
<div class="line"><span class="lineno"> 1402</span><span class="stringliteral">    &gt;&gt;&gt; np.allclose(Q @ H @ Q.conj().T - A, np.zeros((4, 4)))</span></div>
<div class="line"><span class="lineno"> 1403</span><span class="stringliteral">    True</span></div>
<div class="line"><span class="lineno"> 1404</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1405</span>    a1 = _asarray_validated(a, check_finite=check_finite)</div>
<div class="line"><span class="lineno"> 1406</span>    <span class="keywordflow">if</span> len(a1.shape) != 2 <span class="keywordflow">or</span> (a1.shape[0] != a1.shape[1]):</div>
<div class="line"><span class="lineno"> 1407</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;expected square matrix&#39;</span>)</div>
<div class="line"><span class="lineno"> 1408</span>    overwrite_a = overwrite_a <span class="keywordflow">or</span> (_datacopied(a1, a))</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>    <span class="comment"># if 2x2 or smaller: already in Hessenberg</span></div>
<div class="line"><span class="lineno"> 1411</span>    <span class="keywordflow">if</span> a1.shape[0] &lt;= 2:</div>
<div class="line"><span class="lineno"> 1412</span>        <span class="keywordflow">if</span> calc_q:</div>
<div class="line"><span class="lineno"> 1413</span>            <span class="keywordflow">return</span> a1, eye(a1.shape[0])</div>
<div class="line"><span class="lineno"> 1414</span>        <span class="keywordflow">return</span> a1</div>
<div class="line"><span class="lineno"> 1415</span> </div>
<div class="line"><span class="lineno"> 1416</span>    gehrd, gebal, gehrd_lwork = get_lapack_funcs((<span class="stringliteral">&#39;gehrd&#39;</span>, <span class="stringliteral">&#39;gebal&#39;</span>,</div>
<div class="line"><span class="lineno"> 1417</span>                                                  <span class="stringliteral">&#39;gehrd_lwork&#39;</span>), (a1,))</div>
<div class="line"><span class="lineno"> 1418</span>    ba, lo, hi, pivscale, info = gebal(a1, permute=0, overwrite_a=overwrite_a)</div>
<div class="line"><span class="lineno"> 1419</span>    _check_info(info, <span class="stringliteral">&#39;gebal (hessenberg)&#39;</span>, positive=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1420</span>    n = len(a1)</div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>    lwork = _compute_lwork(gehrd_lwork, ba.shape[0], lo=lo, hi=hi)</div>
<div class="line"><span class="lineno"> 1423</span> </div>
<div class="line"><span class="lineno"> 1424</span>    hq, tau, info = gehrd(ba, lo=lo, hi=hi, lwork=lwork, overwrite_a=1)</div>
<div class="line"><span class="lineno"> 1425</span>    _check_info(info, <span class="stringliteral">&#39;gehrd (hessenberg)&#39;</span>, positive=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1426</span>    h = numpy.triu(hq, -1)</div>
<div class="line"><span class="lineno"> 1427</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> calc_q:</div>
<div class="line"><span class="lineno"> 1428</span>        <span class="keywordflow">return</span> h</div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>    <span class="comment"># use orghr/unghr to compute q</span></div>
<div class="line"><span class="lineno"> 1431</span>    orghr, orghr_lwork = get_lapack_funcs((<span class="stringliteral">&#39;orghr&#39;</span>, <span class="stringliteral">&#39;orghr_lwork&#39;</span>), (a1,))</div>
<div class="line"><span class="lineno"> 1432</span>    lwork = _compute_lwork(orghr_lwork, n, lo=lo, hi=hi)</div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span>    q, info = orghr(a=hq, tau=tau, lo=lo, hi=hi, lwork=lwork, overwrite_a=1)</div>
<div class="line"><span class="lineno"> 1435</span>    _check_info(info, <span class="stringliteral">&#39;orghr (hessenberg)&#39;</span>, positive=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1436</span>    <span class="keywordflow">return</span> h, q</div>
<div class="line"><span class="lineno"> 1437</span> </div>
<div class="line"><span class="lineno"> 1438</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab7f0e6c6286201ab5e853b29b8430756" name="ab7f0e6c6286201ab5e853b29b8430756"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7f0e6c6286201ab5e853b29b8430756">&#9670;&#160;</a></span>_conv_dict</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.linalg._decomp._conv_dict</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {0: 0, 1: 1, 2: 2,</div>
<div class="line"><span class="lineno">    2</span>              <span class="stringliteral">&#39;all&#39;</span>: 0, <span class="stringliteral">&#39;value&#39;</span>: 1, <span class="stringliteral">&#39;index&#39;</span>: 2,</div>
<div class="line"><span class="lineno">    3</span>              <span class="stringliteral">&#39;a&#39;</span>: 0, <span class="stringliteral">&#39;v&#39;</span>: 1, <span class="stringliteral">&#39;i&#39;</span>: 2}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa391e8b58056f43fc20071410da9c5d0" name="aa391e8b58056f43fc20071410da9c5d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa391e8b58056f43fc20071410da9c5d0">&#9670;&#160;</a></span>_I</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg._decomp._I = cast['F'](1<a class="el" href="__lapack__subroutines_8h.html#a7a2934b0e050f997202d3f47a979d888">j</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
