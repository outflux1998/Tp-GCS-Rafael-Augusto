<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: gensim.corpora.sharded_corpus.ShardedCorpus Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegensim.html">gensim</a></li><li class="navelem"><a class="el" href="namespacegensim_1_1corpora.html">corpora</a></li><li class="navelem"><a class="el" href="namespacegensim_1_1corpora_1_1sharded__corpus.html">sharded_corpus</a></li><li class="navelem"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html">ShardedCorpus</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">gensim.corpora.sharded_corpus.ShardedCorpus Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for gensim.corpora.sharded_corpus.ShardedCorpus:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.png" usemap="#gensim.corpora.sharded_5Fcorpus.ShardedCorpus_map" alt=""/>
  <map id="gensim.corpora.sharded_5Fcorpus.ShardedCorpus_map" name="gensim.corpora.sharded_5Fcorpus.ShardedCorpus_map">
<area href="classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus.html" alt="gensim.corpora.indexedcorpus.IndexedCorpus" shape="rect" coords="0,168,289,192"/>
<area href="classgensim_1_1interfaces_1_1_corpus_a_b_c.html" alt="gensim.interfaces.CorpusABC" shape="rect" coords="0,112,289,136"/>
<area href="classgensim_1_1utils_1_1_save_load.html" alt="gensim.utils.SaveLoad" shape="rect" coords="0,56,289,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a788065778ef569d3c2de3d0dbc3923b7" id="r_a788065778ef569d3c2de3d0dbc3923b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a788065778ef569d3c2de3d0dbc3923b7">__init__</a> (self, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a8c242bfdf47d1cc3adebacd587375d63">output_prefix</a>, corpus, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a55d35eb0c66dbee8ca7b5e4157f36677">dim</a>=None, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#af5840f504f8b1909710e3f37bc48c837">shardsize</a>=4096, overwrite=False, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a2bbb05690c88f987cc2879ca8688c98e">sparse_serialization</a>=False, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#abb0bf6ab60006d4c87d7865a94dc3d23">sparse_retrieval</a>=False, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a8a590a3539895629fde932b46dec624f">gensim</a>=False)</td></tr>
<tr class="separator:a788065778ef569d3c2de3d0dbc3923b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e8a99f857d0b21e1316a3bdd8644c6" id="r_a56e8a99f857d0b21e1316a3bdd8644c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a56e8a99f857d0b21e1316a3bdd8644c6">init_shards</a> (self, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a8c242bfdf47d1cc3adebacd587375d63">output_prefix</a>, corpus, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#af5840f504f8b1909710e3f37bc48c837">shardsize</a>=4096, dtype=<a class="el" href="namespacegensim_1_1corpora_1_1sharded__corpus.html#a9aed23c4c6273f1436d6d476b71d60e4">_default_dtype</a>)</td></tr>
<tr class="separator:a56e8a99f857d0b21e1316a3bdd8644c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2174e7ff63832eff79cd8a158fc1db" id="r_a2e2174e7ff63832eff79cd8a158fc1db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a2e2174e7ff63832eff79cd8a158fc1db">init_by_clone</a> (self)</td></tr>
<tr class="separator:a2e2174e7ff63832eff79cd8a158fc1db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a692d3c5aa316ad69507570f823c8a642" id="r_a692d3c5aa316ad69507570f823c8a642"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a692d3c5aa316ad69507570f823c8a642">save_shard</a> (self, shard, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>=None, filename=None)</td></tr>
<tr class="separator:a692d3c5aa316ad69507570f823c8a642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12bb2c1de4f3b8cbe9f32b9d3be869fc" id="r_a12bb2c1de4f3b8cbe9f32b9d3be869fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a12bb2c1de4f3b8cbe9f32b9d3be869fc">load_shard</a> (self, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a12bb2c1de4f3b8cbe9f32b9d3be869fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a624de074b98bd0a0267619957730f1cf" id="r_a624de074b98bd0a0267619957730f1cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a624de074b98bd0a0267619957730f1cf">reset</a> (self)</td></tr>
<tr class="separator:a624de074b98bd0a0267619957730f1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acada0a5bbde0c11c7ab72df8852b31ae" id="r_acada0a5bbde0c11c7ab72df8852b31ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#acada0a5bbde0c11c7ab72df8852b31ae">shard_by_offset</a> (self, <a class="el" href="__lapack__subroutines_8h.html#ac5c1dfc0f77d6570b83bf10cfe850d4e">offset</a>)</td></tr>
<tr class="separator:acada0a5bbde0c11c7ab72df8852b31ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef371496c09fdbc7ee0217cdc7af42c" id="r_aeef371496c09fdbc7ee0217cdc7af42c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#aeef371496c09fdbc7ee0217cdc7af42c">in_current</a> (self, <a class="el" href="__lapack__subroutines_8h.html#ac5c1dfc0f77d6570b83bf10cfe850d4e">offset</a>)</td></tr>
<tr class="separator:aeef371496c09fdbc7ee0217cdc7af42c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5739426dd46156baf563b70d762f1fdb" id="r_a5739426dd46156baf563b70d762f1fdb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a5739426dd46156baf563b70d762f1fdb">in_next</a> (self, <a class="el" href="__lapack__subroutines_8h.html#ac5c1dfc0f77d6570b83bf10cfe850d4e">offset</a>)</td></tr>
<tr class="separator:a5739426dd46156baf563b70d762f1fdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0291d539bc79bc3f39adac09f48cee7" id="r_aa0291d539bc79bc3f39adac09f48cee7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#aa0291d539bc79bc3f39adac09f48cee7">resize_shards</a> (self, <a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#af5840f504f8b1909710e3f37bc48c837">shardsize</a>)</td></tr>
<tr class="separator:aa0291d539bc79bc3f39adac09f48cee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e3389cf66c2e3b5523f3258713eb00" id="r_a71e3389cf66c2e3b5523f3258713eb00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a71e3389cf66c2e3b5523f3258713eb00">__len__</a> (self)</td></tr>
<tr class="separator:a71e3389cf66c2e3b5523f3258713eb00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b8d0874c2526358f04dff82c83b232" id="r_ad9b8d0874c2526358f04dff82c83b232"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#ad9b8d0874c2526358f04dff82c83b232">get_by_offset</a> (self, <a class="el" href="__lapack__subroutines_8h.html#ac5c1dfc0f77d6570b83bf10cfe850d4e">offset</a>)</td></tr>
<tr class="separator:ad9b8d0874c2526358f04dff82c83b232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4a7cd90598855fd2990458e1f4abc61" id="r_ac4a7cd90598855fd2990458e1f4abc61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#ac4a7cd90598855fd2990458e1f4abc61">__getitem__</a> (self, <a class="el" href="__lapack__subroutines_8h.html#ac5c1dfc0f77d6570b83bf10cfe850d4e">offset</a>)</td></tr>
<tr class="separator:ac4a7cd90598855fd2990458e1f4abc61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4749bedc67ef76cd315fc824f0cc2001" id="r_a4749bedc67ef76cd315fc824f0cc2001"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a4749bedc67ef76cd315fc824f0cc2001">__iter__</a> (self)</td></tr>
<tr class="separator:a4749bedc67ef76cd315fc824f0cc2001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeba96bf724465bfaa6b4cd7af205144e" id="r_aeba96bf724465bfaa6b4cd7af205144e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#aeba96bf724465bfaa6b4cd7af205144e">save</a> (self, *args, **kwargs)</td></tr>
<tr class="separator:aeba96bf724465bfaa6b4cd7af205144e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282ef9536238e0de25d7d6d449560f0c" id="r_a282ef9536238e0de25d7d6d449560f0c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a282ef9536238e0de25d7d6d449560f0c">load</a> (cls, fname, mmap=None)</td></tr>
<tr class="separator:a282ef9536238e0de25d7d6d449560f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb215fb983ad84ee2f2eba896af9d72" id="r_a9fb215fb983ad84ee2f2eba896af9d72"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a9fb215fb983ad84ee2f2eba896af9d72">serialize</a> (serializer, fname, corpus, id2word=None, index_fname=None, progress_cnt=None, labels=None, metadata=False, **kwargs)</td></tr>
<tr class="separator:a9fb215fb983ad84ee2f2eba896af9d72"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aabe23ddf80e6edbbbe977a25c3eea1c4" id="r_aabe23ddf80e6edbbbe977a25c3eea1c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#aabe23ddf80e6edbbbe977a25c3eea1c4">save_corpus</a> (fname, corpus, id2word=None, progress_cnt=1000, metadata=False, **kwargs)</td></tr>
<tr class="separator:aabe23ddf80e6edbbbe977a25c3eea1c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a8c242bfdf47d1cc3adebacd587375d63" id="r_a8c242bfdf47d1cc3adebacd587375d63"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a8c242bfdf47d1cc3adebacd587375d63">output_prefix</a></td></tr>
<tr class="separator:a8c242bfdf47d1cc3adebacd587375d63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5840f504f8b1909710e3f37bc48c837" id="r_af5840f504f8b1909710e3f37bc48c837"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#af5840f504f8b1909710e3f37bc48c837">shardsize</a></td></tr>
<tr class="separator:af5840f504f8b1909710e3f37bc48c837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e01c678e0b36ccea62a63d3571c6a44" id="r_a5e01c678e0b36ccea62a63d3571c6a44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a5e01c678e0b36ccea62a63d3571c6a44">n_docs</a></td></tr>
<tr class="separator:a5e01c678e0b36ccea62a63d3571c6a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a839dafb430b88b19a022fe5ca734efac" id="r_a839dafb430b88b19a022fe5ca734efac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a839dafb430b88b19a022fe5ca734efac">offsets</a></td></tr>
<tr class="separator:a839dafb430b88b19a022fe5ca734efac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00fa62a50a1b18129e677f1d364e81ec" id="r_a00fa62a50a1b18129e677f1d364e81ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a00fa62a50a1b18129e677f1d364e81ec">n_shards</a></td></tr>
<tr class="separator:a00fa62a50a1b18129e677f1d364e81ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d35eb0c66dbee8ca7b5e4157f36677" id="r_a55d35eb0c66dbee8ca7b5e4157f36677"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a55d35eb0c66dbee8ca7b5e4157f36677">dim</a></td></tr>
<tr class="separator:a55d35eb0c66dbee8ca7b5e4157f36677"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bbb05690c88f987cc2879ca8688c98e" id="r_a2bbb05690c88f987cc2879ca8688c98e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a2bbb05690c88f987cc2879ca8688c98e">sparse_serialization</a></td></tr>
<tr class="separator:a2bbb05690c88f987cc2879ca8688c98e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb0bf6ab60006d4c87d7865a94dc3d23" id="r_abb0bf6ab60006d4c87d7865a94dc3d23"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#abb0bf6ab60006d4c87d7865a94dc3d23">sparse_retrieval</a></td></tr>
<tr class="separator:abb0bf6ab60006d4c87d7865a94dc3d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a590a3539895629fde932b46dec624f" id="r_a8a590a3539895629fde932b46dec624f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a8a590a3539895629fde932b46dec624f">gensim</a></td></tr>
<tr class="separator:a8a590a3539895629fde932b46dec624f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c4661324d05733c021e1a9b5847126" id="r_af6c4661324d05733c021e1a9b5847126"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#af6c4661324d05733c021e1a9b5847126">current_shard</a></td></tr>
<tr class="separator:af6c4661324d05733c021e1a9b5847126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c9b8ffc56b535813b0ea455ae37885" id="r_ab6c9b8ffc56b535813b0ea455ae37885"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#ab6c9b8ffc56b535813b0ea455ae37885">current_shard_n</a></td></tr>
<tr class="separator:ab6c9b8ffc56b535813b0ea455ae37885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f90f7c0aa9dd2978b2d58b06d518399" id="r_a2f90f7c0aa9dd2978b2d58b06d518399"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a2f90f7c0aa9dd2978b2d58b06d518399">current_offset</a></td></tr>
<tr class="separator:a2f90f7c0aa9dd2978b2d58b06d518399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus.html">gensim.corpora.indexedcorpus.IndexedCorpus</a></td></tr>
<tr class="memitem:a153bf323211b1fe889237b14759f222a inherit pub_attribs_classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus" id="r_a153bf323211b1fe889237b14759f222a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus.html#a153bf323211b1fe889237b14759f222a">index</a></td></tr>
<tr class="separator:a153bf323211b1fe889237b14759f222a inherit pub_attribs_classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0bd1abf2354b432e39cc50e2c442277 inherit pub_attribs_classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus" id="r_ac0bd1abf2354b432e39cc50e2c442277"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus.html#ac0bd1abf2354b432e39cc50e2c442277">length</a></td></tr>
<tr class="separator:ac0bd1abf2354b432e39cc50e2c442277 inherit pub_attribs_classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a410fe56e53ce2b7efb0443182a257792" id="r_a410fe56e53ce2b7efb0443182a257792"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a410fe56e53ce2b7efb0443182a257792">_shard_name</a> (self, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a410fe56e53ce2b7efb0443182a257792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bcf844710712b511f1a98af5c288070" id="r_a3bcf844710712b511f1a98af5c288070"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a3bcf844710712b511f1a98af5c288070">_resized_shard_name</a> (self, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a3bcf844710712b511f1a98af5c288070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0da4eefd27ed5933bdef16f924f97f6" id="r_ac0da4eefd27ed5933bdef16f924f97f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#ac0da4eefd27ed5933bdef16f924f97f6">_guess_n_features</a> (self, corpus)</td></tr>
<tr class="separator:ac0da4eefd27ed5933bdef16f924f97f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb5a4ab653f4381c108a2153fa254b2" id="r_a0fb5a4ab653f4381c108a2153fa254b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a0fb5a4ab653f4381c108a2153fa254b2">_ensure_shard</a> (self, <a class="el" href="__lapack__subroutines_8h.html#ac5c1dfc0f77d6570b83bf10cfe850d4e">offset</a>)</td></tr>
<tr class="separator:a0fb5a4ab653f4381c108a2153fa254b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17cdba18b8c618e53ba9cb86faf0b5f5" id="r_a17cdba18b8c618e53ba9cb86faf0b5f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a17cdba18b8c618e53ba9cb86faf0b5f5">_getitem_format</a> (self, s_result)</td></tr>
<tr class="separator:a17cdba18b8c618e53ba9cb86faf0b5f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237fb64a82bcefe60deaf8f96c95fe42" id="r_a237fb64a82bcefe60deaf8f96c95fe42"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a237fb64a82bcefe60deaf8f96c95fe42">_getitem_sparse2gensim</a> (self, result)</td></tr>
<tr class="separator:a237fb64a82bcefe60deaf8f96c95fe42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c6e409c8e28f0c6a2736ca619e78b5e" id="r_a8c6e409c8e28f0c6a2736ca619e78b5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1corpora_1_1sharded__corpus_1_1_sharded_corpus.html#a8c6e409c8e28f0c6a2736ca619e78b5e">_getitem_dense2gensim</a> (self, result)</td></tr>
<tr class="separator:a8c6e409c8e28f0c6a2736ca619e78b5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classgensim_1_1utils_1_1_save_load"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classgensim_1_1utils_1_1_save_load')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classgensim_1_1utils_1_1_save_load.html">gensim.utils.SaveLoad</a></td></tr>
<tr class="memitem:ace7b79d8870c44c2bab0d590a5aca91e inherit pro_methods_classgensim_1_1utils_1_1_save_load" id="r_ace7b79d8870c44c2bab0d590a5aca91e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#ace7b79d8870c44c2bab0d590a5aca91e">_load_specials</a> (self, fname, mmap, compress, subname)</td></tr>
<tr class="separator:ace7b79d8870c44c2bab0d590a5aca91e inherit pro_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9faa42ba3aae8f0a175418889d425c inherit pro_methods_classgensim_1_1utils_1_1_save_load" id="r_acd9faa42ba3aae8f0a175418889d425c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#acd9faa42ba3aae8f0a175418889d425c">_smart_save</a> (self, fname, separately=None, sep_limit=10 *1024 **2, ignore=frozenset(), pickle_protocol=2)</td></tr>
<tr class="separator:acd9faa42ba3aae8f0a175418889d425c inherit pro_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bae38a76fa8264d2c8759b9d40a6f5c inherit pro_methods_classgensim_1_1utils_1_1_save_load" id="r_a4bae38a76fa8264d2c8759b9d40a6f5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#a4bae38a76fa8264d2c8759b9d40a6f5c">_save_specials</a> (self, fname, separately, sep_limit, ignore, pickle_protocol, compress, subname)</td></tr>
<tr class="separator:a4bae38a76fa8264d2c8759b9d40a6f5c inherit pro_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_static_methods_classgensim_1_1utils_1_1_save_load"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classgensim_1_1utils_1_1_save_load')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classgensim_1_1utils_1_1_save_load.html">gensim.utils.SaveLoad</a></td></tr>
<tr class="memitem:a6cf051b348407267110444260535d143 inherit pro_static_methods_classgensim_1_1utils_1_1_save_load" id="r_a6cf051b348407267110444260535d143"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#a6cf051b348407267110444260535d143">_adapt_by_suffix</a> (fname)</td></tr>
<tr class="separator:a6cf051b348407267110444260535d143 inherit pro_static_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This corpus is designed for situations where you need to train a model
on matrices, with a large number of iterations. (It should be faster than
gensim's other IndexedCorpus implementations for this use case; check the
`benchmark_datasets.py` script. It should also serialize faster.)

The corpus stores its data in separate files called
"shards". This is a compromise between speed (keeping the whole dataset
in memory) and memory footprint (keeping the data on disk and reading from
it on demand). Persistence is done using the standard gensim load/save methods.

.. note::

  The dataset is **read-only**, there is - as opposed to gensim's Similarity
  class, which works similarly - no way of adding documents to the dataset
  (for now).

You can use ShardedCorpus to serialize your data just like any other gensim
corpus that implements serialization. However, because the data is saved
as numpy 2-dimensional ndarrays (or scipy sparse matrices), you need to
supply the dimension of your data to the corpus. (The dimension of word
frequency vectors will typically be the size of the vocabulary, etc.)

.. sourcecode:: pycon

    &gt;&gt;&gt; corpus = gensim.utils.mock_data()
    &gt;&gt;&gt; output_prefix = 'mydata.shdat'
    &gt;&gt;&gt; ShardedCorpus.serialize(output_prefix, corpus, dim=1000)

The `output_prefix` tells the ShardedCorpus where to put the data.
Shards are saved as `output_prefix.0`, `output_prefix.1`, etc.
All shards must be of the same size. The shards can be re-sized (which
is essentially a re-serialization into new-size shards), but note that
this operation will temporarily take twice as much disk space, because
the old shards are not deleted until the new shards are safely in place.

After serializing the data, the corpus will then save itself to the file
`output_prefix`.

On further initialization with the same `output_prefix`, the corpus
will load the already built dataset unless the `overwrite` option is
given. (A new object is "cloned" from the one saved to `output_prefix`
previously.)

To retrieve data, you can load the corpus and use it like a list:

.. sourcecode:: pycon

    &gt;&gt;&gt; sh_corpus = ShardedCorpus.load(output_prefix)
    &gt;&gt;&gt; batch = sh_corpus[100:150]

This will retrieve a numpy 2-dimensional array of 50 rows and 1000
columns (1000 was the dimension of the data we supplied to the corpus).
To retrieve gensim-style sparse vectors, set the `gensim` property:

.. sourcecode:: pycon

    &gt;&gt;&gt; sh_corpus.gensim = True
    &gt;&gt;&gt; batch = sh_corpus[100:150]

The batch now will be a generator of gensim vectors.

Since the corpus needs the data serialized in order to be able to operate,
it will serialize data right away on initialization. Instead of calling
`ShardedCorpus.serialize()`, you can just initialize and use the corpus
right away:

.. sourcecode:: pycon

    &gt;&gt;&gt; corpus = ShardedCorpus(output_prefix, corpus, dim=1000)
    &gt;&gt;&gt; batch = corpus[100:150]

ShardedCorpus also supports working with scipy sparse matrices, both
during retrieval and during serialization. If you want to serialize your
data as sparse matrices, set the `sparse_serialization` flag. For
retrieving your data as sparse matrices, use the `sparse_retrieval`
flag. (You can also retrieve densely serialized data as sparse matrices,
for the sake of completeness, and vice versa.) By default, the corpus
will retrieve numpy ndarrays even if it was serialized into sparse
matrices.

.. sourcecode:: pycon

    &gt;&gt;&gt; sparse_prefix = 'mydata.sparse.shdat'
    &gt;&gt;&gt; ShardedCorpus.serialize(sparse_prefix, corpus, dim=1000, sparse_serialization=True)
    &gt;&gt;&gt; sparse_corpus = ShardedCorpus.load(sparse_prefix)
    &gt;&gt;&gt; batch = sparse_corpus[100:150]
    &gt;&gt;&gt; type(batch)
    &lt;type 'numpy.ndarray'&gt;
    &gt;&gt;&gt; sparse_corpus.sparse_retrieval = True
    &gt;&gt;&gt; batch = sparse_corpus[100:150]
    &lt;class 'scipy.sparse.csr.csr_matrix'&gt;

While you *can* touch the `sparse_retrieval` attribute during the life
of a ShardedCorpus object, you should definitely not touch `
`sharded_serialization`! Changing the attribute will not miraculously
re-serialize the data in the requested format.

The CSR format is used for sparse data throughout.

Internally, to retrieve data, the dataset keeps track of which shard is
currently open and on a `__getitem__` request, either returns an item from
the current shard, or opens a new one. The shard size is constant, except
for the last shard.
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a788065778ef569d3c2de3d0dbc3923b7" name="a788065778ef569d3c2de3d0dbc3923b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a788065778ef569d3c2de3d0dbc3923b7">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output_prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dim</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shardsize</em> = <code>4096</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overwrite</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparse_serialization</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparse_retrieval</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gensim</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initializes the dataset. If `output_prefix` is not found,
builds the shards.

:type output_prefix: str
:param output_prefix: The absolute path to the file from which shard
    filenames should be derived. The individual shards will be saved
    as `output_prefix.0`, `output_prefix.1`, etc.

    The `output_prefix` path then works as the filename to which
    the ShardedCorpus object itself will be automatically saved.
    Normally, gensim corpora do not do this, but ShardedCorpus needs
    to remember several serialization settings: namely the shard
    size and whether it was serialized in dense or sparse format. By
    saving automatically, any new ShardedCorpus with the same
    `output_prefix` will be able to find the information about the
    data serialized with the given prefix.

    If you want to *overwrite* your data serialized with some output
    prefix, set the `overwrite` flag to True.

    Of course, you can save your corpus separately as well using
    the `save()` method.

:type corpus: gensim.interfaces.CorpusABC
:param corpus: The source corpus from which to build the dataset.

:type dim: int
:param dim: Specify beforehand what the dimension of a dataset item
    should be. This is useful when initializing from a corpus that
    doesn't advertise its dimension, or when it does and you want to
    check that the corpus matches the expected dimension. **If `dim`
    is left unused and `corpus` does not provide its dimension in
    an expected manner, initialization will fail.**

:type shardsize: int
:param shardsize: How many data points should be in one shard. More
    data per shard means less shard reloading but higher memory usage
    and vice versa.

:type overwrite: bool
:param overwrite: If set, will build dataset from given corpus even
    if `output_prefix` already exists.

:type sparse_serialization: bool
:param sparse_serialization: If set, will save the data in a sparse
    form (as csr matrices). This is to speed up retrieval when you
    know you will be using sparse matrices.

    ..note::

        This property **should not change** during the lifetime of
        the dataset. (If you find out you need to change from a sparse
        to a dense representation, the best practice is to create
        another ShardedCorpus object.)

:type sparse_retrieval: bool
:param sparse_retrieval: If set, will retrieve data as sparse vectors
    (numpy csr matrices). If unset, will return ndarrays.

    Note that retrieval speed for this option depends on how the dataset
    was serialized. If `sparse_serialization` was set, then setting
    `sparse_retrieval` will be faster. However, if the two settings
    do not correspond, the conversion on the fly will slow the dataset
    down.

:type gensim: bool
:param gensim: If set, will convert the output to gensim
    sparse vectors (list of tuples (id, value)) to make it behave like
    any other gensim corpus. This **will** slow the dataset down.</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus.html#a0feb039f937b55407472f5b2d02e828a">gensim.corpora.indexedcorpus.IndexedCorpus</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  159</span>                 sparse_retrieval=<span class="keyword">False</span>, gensim=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  160</span>        <span class="stringliteral">&quot;&quot;&quot;Initializes the dataset. If `output_prefix` is not found,</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">        builds the shards.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">        :type output_prefix: str</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">        :param output_prefix: The absolute path to the file from which shard</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">            filenames should be derived. The individual shards will be saved</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">            as `output_prefix.0`, `output_prefix.1`, etc.</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">            The `output_prefix` path then works as the filename to which</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">            the ShardedCorpus object itself will be automatically saved.</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">            Normally, gensim corpora do not do this, but ShardedCorpus needs</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">            to remember several serialization settings: namely the shard</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">            size and whether it was serialized in dense or sparse format. By</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">            saving automatically, any new ShardedCorpus with the same</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">            `output_prefix` will be able to find the information about the</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">            data serialized with the given prefix.</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">            If you want to *overwrite* your data serialized with some output</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">            prefix, set the `overwrite` flag to True.</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">            Of course, you can save your corpus separately as well using</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">            the `save()` method.</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">        :type corpus: gensim.interfaces.CorpusABC</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">        :param corpus: The source corpus from which to build the dataset.</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">        :type dim: int</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">        :param dim: Specify beforehand what the dimension of a dataset item</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">            should be. This is useful when initializing from a corpus that</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">            doesn&#39;t advertise its dimension, or when it does and you want to</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">            check that the corpus matches the expected dimension. **If `dim`</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">            is left unused and `corpus` does not provide its dimension in</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">            an expected manner, initialization will fail.**</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">        :type shardsize: int</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">        :param shardsize: How many data points should be in one shard. More</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">            data per shard means less shard reloading but higher memory usage</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">            and vice versa.</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">        :type overwrite: bool</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">        :param overwrite: If set, will build dataset from given corpus even</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">            if `output_prefix` already exists.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">        :type sparse_serialization: bool</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">        :param sparse_serialization: If set, will save the data in a sparse</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">            form (as csr matrices). This is to speed up retrieval when you</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">            know you will be using sparse matrices.</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">            ..note::</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">                This property **should not change** during the lifetime of</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">                the dataset. (If you find out you need to change from a sparse</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">                to a dense representation, the best practice is to create</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">                another ShardedCorpus object.)</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">        :type sparse_retrieval: bool</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">        :param sparse_retrieval: If set, will retrieve data as sparse vectors</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">            (numpy csr matrices). If unset, will return ndarrays.</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">            Note that retrieval speed for this option depends on how the dataset</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">            was serialized. If `sparse_serialization` was set, then setting</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">            `sparse_retrieval` will be faster. However, if the two settings</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">            do not correspond, the conversion on the fly will slow the dataset</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">            down.</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">        :type gensim: bool</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">        :param gensim: If set, will convert the output to gensim</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">            sparse vectors (list of tuples (id, value)) to make it behave like</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">            any other gensim corpus. This **will** slow the dataset down.</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  231</span>        self.output_prefix = output_prefix</div>
<div class="line"><span class="lineno">  232</span>        self.shardsize = shardsize</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>        self.n_docs = 0</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>        self.offsets = []</div>
<div class="line"><span class="lineno">  237</span>        self.n_shards = 0</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>        self.dim = dim  <span class="comment"># This number may change during initialization/loading.</span></div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>        <span class="comment"># Sparse vs. dense serialization and retrieval.</span></div>
<div class="line"><span class="lineno">  242</span>        self.sparse_serialization = sparse_serialization</div>
<div class="line"><span class="lineno">  243</span>        self.sparse_retrieval = sparse_retrieval</div>
<div class="line"><span class="lineno">  244</span>        self.gensim = gensim</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>        <span class="comment"># The &quot;state&quot; of the dataset.</span></div>
<div class="line"><span class="lineno">  247</span>        self.current_shard = <span class="keywordtype">None</span>    <span class="comment"># The current shard itself (numpy ndarray)</span></div>
<div class="line"><span class="lineno">  248</span>        self.current_shard_n = <span class="keywordtype">None</span>  <span class="comment"># Current shard is the current_shard_n-th</span></div>
<div class="line"><span class="lineno">  249</span>        self.current_offset = <span class="keywordtype">None</span>   <span class="comment"># The index into the dataset which</span></div>
<div class="line"><span class="lineno">  250</span>        <span class="comment"># corresponds to index 0 of current shard</span></div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>        logger.info(<span class="stringliteral">&#39;Initializing sharded corpus with prefix %s&#39;</span>, output_prefix)</div>
<div class="line"><span class="lineno">  253</span>        <span class="keywordflow">if</span> (<span class="keywordflow">not</span> os.path.isfile(output_prefix)) <span class="keywordflow">or</span> overwrite:</div>
<div class="line"><span class="lineno">  254</span>            logger.info(<span class="stringliteral">&#39;Building from corpus...&#39;</span>)</div>
<div class="line"><span class="lineno">  255</span>            self.init_shards(output_prefix, corpus, shardsize)</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>            <span class="comment"># Save automatically, to facilitate re-loading</span></div>
<div class="line"><span class="lineno">  258</span>            <span class="comment"># and retain information about how the corpus</span></div>
<div class="line"><span class="lineno">  259</span>            <span class="comment"># was serialized.</span></div>
<div class="line"><span class="lineno">  260</span>            logger.info(<span class="stringliteral">&#39;Saving ShardedCorpus object to %s&#39;</span>, self.output_prefix)</div>
<div class="line"><span class="lineno">  261</span>            self.save()</div>
<div class="line"><span class="lineno">  262</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  263</span>            logger.info(<span class="stringliteral">&#39;Cloning existing...&#39;</span>)</div>
<div class="line"><span class="lineno">  264</span>            self.init_by_clone()</div>
<div class="line"><span class="lineno">  265</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac4a7cd90598855fd2990458e1f4abc61" name="ac4a7cd90598855fd2990458e1f4abc61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4a7cd90598855fd2990458e1f4abc61">&#9670;&#160;</a></span>__getitem__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.__getitem__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Retrieve the given row of the dataset. Supports slice notation.</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus.html#a87ac007657ba16694d45c462757e6c77">gensim.corpora.indexedcorpus.IndexedCorpus</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  571</span>    <span class="keyword">def </span>__getitem__(self, offset):</div>
<div class="line"><span class="lineno">  572</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">        Retrieve the given row of the dataset. Supports slice notation.</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  576</span>        <span class="keywordflow">if</span> isinstance(offset, list):</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>            <span class="comment"># Handle all serialization &amp; retrieval options.</span></div>
<div class="line"><span class="lineno">  579</span>            <span class="keywordflow">if</span> self.sparse_serialization:</div>
<div class="line"><span class="lineno">  580</span>                l_result = sparse.vstack([self.get_by_offset(i)</div>
<div class="line"><span class="lineno">  581</span>                                          <span class="keywordflow">for</span> i <span class="keywordflow">in</span> offset])</div>
<div class="line"><span class="lineno">  582</span>                <span class="keywordflow">if</span> self.gensim:</div>
<div class="line"><span class="lineno">  583</span>                    l_result = self._getitem_sparse2gensim(l_result)</div>
<div class="line"><span class="lineno">  584</span>                <span class="keywordflow">elif</span> <span class="keywordflow">not</span> self.sparse_retrieval:</div>
<div class="line"><span class="lineno">  585</span>                    l_result = numpy.array(l_result.todense())</div>
<div class="line"><span class="lineno">  586</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  587</span>                l_result = numpy.array([self.get_by_offset(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> offset])</div>
<div class="line"><span class="lineno">  588</span>                <span class="keywordflow">if</span> self.gensim:</div>
<div class="line"><span class="lineno">  589</span>                    l_result = self._getitem_dense2gensim(l_result)</div>
<div class="line"><span class="lineno">  590</span>                <span class="keywordflow">elif</span> self.sparse_retrieval:</div>
<div class="line"><span class="lineno">  591</span>                    l_result = sparse.csr_matrix(l_result)</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>            <span class="keywordflow">return</span> l_result</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>        <span class="keywordflow">elif</span> isinstance(offset, slice):</div>
<div class="line"><span class="lineno">  596</span>            start = offset.start</div>
<div class="line"><span class="lineno">  597</span>            stop = offset.stop</div>
<div class="line"><span class="lineno">  598</span>            <span class="keywordflow">if</span> stop &gt; self.n_docs:</div>
<div class="line"><span class="lineno">  599</span>                <span class="keywordflow">raise</span> IndexError(<span class="stringliteral">&#39;Requested slice offset {0} out of range ({1} docs)&#39;</span>.format(stop, self.n_docs))</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>            <span class="comment"># - get range of shards over which to iterate</span></div>
<div class="line"><span class="lineno">  602</span>            first_shard = self.shard_by_offset(start)</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>            last_shard = self.n_shards - 1</div>
<div class="line"><span class="lineno">  605</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> stop == self.n_docs:</div>
<div class="line"><span class="lineno">  606</span>                last_shard = self.shard_by_offset(stop)</div>
<div class="line"><span class="lineno">  607</span>                <span class="comment"># This fails on one-past</span></div>
<div class="line"><span class="lineno">  608</span>                <span class="comment"># slice indexing; that&#39;s why there&#39;s a code branch here.</span></div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>            self.load_shard(first_shard)</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>            <span class="comment"># The easy case: both in one shard.</span></div>
<div class="line"><span class="lineno">  613</span>            <span class="keywordflow">if</span> first_shard == last_shard:</div>
<div class="line"><span class="lineno">  614</span>                s_result = self.current_shard[start - self.current_offset: stop - self.current_offset]</div>
<div class="line"><span class="lineno">  615</span>                <span class="comment"># Handle different sparsity settings:</span></div>
<div class="line"><span class="lineno">  616</span>                s_result = self._getitem_format(s_result)</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>                <span class="keywordflow">return</span> s_result</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>            <span class="comment"># The hard case: the slice is distributed across multiple shards</span></div>
<div class="line"><span class="lineno">  621</span>            <span class="comment"># - initialize numpy.zeros()</span></div>
<div class="line"><span class="lineno">  622</span>            s_result = numpy.zeros((stop - start, self.dim), dtype=self.current_shard.dtype)</div>
<div class="line"><span class="lineno">  623</span>            <span class="keywordflow">if</span> self.sparse_serialization:</div>
<div class="line"><span class="lineno">  624</span>                s_result = sparse.csr_matrix((0, self.dim), dtype=self.current_shard.dtype)</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>            <span class="comment"># - gradually build it up. We will be using three set of start:stop</span></div>
<div class="line"><span class="lineno">  627</span>            <span class="comment">#   indexes:</span></div>
<div class="line"><span class="lineno">  628</span>            <span class="comment">#    - into the dataset (these are the indexes the caller works with)</span></div>
<div class="line"><span class="lineno">  629</span>            <span class="comment">#    - into the current shard</span></div>
<div class="line"><span class="lineno">  630</span>            <span class="comment">#    - into the result</span></div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>            <span class="comment"># Indexes into current result rows. These are always smaller than</span></div>
<div class="line"><span class="lineno">  633</span>            <span class="comment"># the dataset indexes by `start` (as we move over the shards,</span></div>
<div class="line"><span class="lineno">  634</span>            <span class="comment"># we&#39;re moving by the same number of rows through the result).</span></div>
<div class="line"><span class="lineno">  635</span>            result_start = 0</div>
<div class="line"><span class="lineno">  636</span>            result_stop = self.offsets[self.current_shard_n + 1] - start</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>            <span class="comment"># Indexes into current shard. These are trickiest:</span></div>
<div class="line"><span class="lineno">  639</span>            <span class="comment">#  - if in starting shard, these are from (start - current_offset)</span></div>
<div class="line"><span class="lineno">  640</span>            <span class="comment">#    to self.shardsize</span></div>
<div class="line"><span class="lineno">  641</span>            <span class="comment">#  - if in intermediate shard, these are from 0 to self.shardsize</span></div>
<div class="line"><span class="lineno">  642</span>            <span class="comment">#  - if in ending shard, these are from 0</span></div>
<div class="line"><span class="lineno">  643</span>            <span class="comment">#    to (stop - current_offset)</span></div>
<div class="line"><span class="lineno">  644</span>            shard_start = start - self.current_offset</div>
<div class="line"><span class="lineno">  645</span>            shard_stop = self.offsets[self.current_shard_n + 1] - self.current_offset</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>            <span class="comment"># s_result[result_start:result_stop] = self.current_shard[</span></div>
<div class="line"><span class="lineno">  648</span>            <span class="comment">#                                         shard_start:shard_stop]</span></div>
<div class="line"><span class="lineno">  649</span>            s_result = self.__add_to_slice(s_result, result_start, result_stop, shard_start, shard_stop)</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>            <span class="comment"># First and last get special treatment, these are in between</span></div>
<div class="line"><span class="lineno">  652</span>            <span class="keywordflow">for</span> shard_n <span class="keywordflow">in</span> range(first_shard + 1, last_shard):</div>
<div class="line"><span class="lineno">  653</span>                self.load_shard(shard_n)</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>                result_start = result_stop</div>
<div class="line"><span class="lineno">  656</span>                result_stop += self.shardsize</div>
<div class="line"><span class="lineno">  657</span>                shard_start = 0</div>
<div class="line"><span class="lineno">  658</span>                shard_stop = self.shardsize</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>                s_result = self.__add_to_slice(s_result, result_start, result_stop, shard_start, shard_stop)</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>            <span class="comment"># Last shard</span></div>
<div class="line"><span class="lineno">  663</span>            self.load_shard(last_shard)</div>
<div class="line"><span class="lineno">  664</span>            result_start = result_stop</div>
<div class="line"><span class="lineno">  665</span>            result_stop += stop - self.current_offset</div>
<div class="line"><span class="lineno">  666</span>            shard_start = 0</div>
<div class="line"><span class="lineno">  667</span>            shard_stop = stop - self.current_offset</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>            s_result = self.__add_to_slice(s_result, result_start, result_stop, shard_start, shard_stop)</div>
<div class="line"><span class="lineno">  670</span>            s_result = self._getitem_format(s_result)</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>            <span class="keywordflow">return</span> s_result</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  675</span>            s_result = self.get_by_offset(offset)</div>
<div class="line"><span class="lineno">  676</span>            s_result = self._getitem_format(s_result)</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>            <span class="keywordflow">return</span> s_result</div>
<div class="line"><span class="lineno">  679</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4749bedc67ef76cd315fc824f0cc2001" name="a4749bedc67ef76cd315fc824f0cc2001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4749bedc67ef76cd315fc824f0cc2001">&#9670;&#160;</a></span>__iter__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.__iter__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Yield dataset items one by one (generator).</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1interfaces_1_1_corpus_a_b_c.html#a27649a9021c136ec6e56228f43950342">gensim.interfaces.CorpusABC</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  757</span>    <span class="keyword">def </span>__iter__(self):</div>
<div class="line"><span class="lineno">  758</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  759</span><span class="stringliteral">        Yield dataset items one by one (generator).</span></div>
<div class="line"><span class="lineno">  760</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  761</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  762</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(self)):</div>
<div class="line"><span class="lineno">  763</span>            <span class="keywordflow">yield</span> self[i]</div>
<div class="line"><span class="lineno">  764</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a71e3389cf66c2e3b5523f3258713eb00" name="a71e3389cf66c2e3b5523f3258713eb00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e3389cf66c2e3b5523f3258713eb00">&#9670;&#160;</a></span>__len__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.__len__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get the index length.

Notes
-----
If the corpus is not indexed, also count corpus length and cache this value.

Returns
-------
int
    Length of index.</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus.html#ad95412021175f56f749c0f1384cacf21">gensim.corpora.indexedcorpus.IndexedCorpus</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  549</span>    <span class="keyword">def </span>__len__(self):</div>
<div class="line"><span class="lineno">  550</span>        <span class="keywordflow">return</span> self.n_docs</div>
<div class="line"><span class="lineno">  551</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0fb5a4ab653f4381c108a2153fa254b2" name="a0fb5a4ab653f4381c108a2153fa254b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fb5a4ab653f4381c108a2153fa254b2">&#9670;&#160;</a></span>_ensure_shard()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus._ensure_shard </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  552</span>    <span class="keyword">def </span>_ensure_shard(self, offset):</div>
<div class="line"><span class="lineno">  553</span>        <span class="comment"># No shard loaded</span></div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">if</span> self.current_shard <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  555</span>            shard_n = self.shard_by_offset(offset)</div>
<div class="line"><span class="lineno">  556</span>            self.load_shard(shard_n)</div>
<div class="line"><span class="lineno">  557</span>        <span class="comment"># Find appropriate shard, if necessary</span></div>
<div class="line"><span class="lineno">  558</span>        <span class="keywordflow">elif</span> <span class="keywordflow">not</span> self.in_current(offset):</div>
<div class="line"><span class="lineno">  559</span>            <span class="keywordflow">if</span> self.in_next(offset):</div>
<div class="line"><span class="lineno">  560</span>                self.load_shard(self.current_shard_n + 1)</div>
<div class="line"><span class="lineno">  561</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  562</span>                shard_n = self.shard_by_offset(offset)</div>
<div class="line"><span class="lineno">  563</span>                self.load_shard(shard_n)</div>
<div class="line"><span class="lineno">  564</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c6e409c8e28f0c6a2736ca619e78b5e" name="a8c6e409c8e28f0c6a2736ca619e78b5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c6e409c8e28f0c6a2736ca619e78b5e">&#9670;&#160;</a></span>_getitem_dense2gensim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus._getitem_dense2gensim </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Change given dense result matrix to gensim sparse vectors.</pre> <div class="fragment"><div class="line"><span class="lineno">  747</span>    <span class="keyword">def </span>_getitem_dense2gensim(self, result):</div>
<div class="line"><span class="lineno">  748</span>        <span class="stringliteral">&quot;&quot;&quot;Change given dense result matrix to gensim sparse vectors.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  749</span>        <span class="keywordflow">if</span> len(result.shape) == 1:</div>
<div class="line"><span class="lineno">  750</span>            output = <a class="code hl_function" href="namespacegensim_1_1matutils.html#a8972e8b9ba0f7f794b7c947bc49077d4">gensim.matutils.full2sparse</a>(result)</div>
<div class="line"><span class="lineno">  751</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  752</span>            output = (<a class="code hl_function" href="namespacegensim_1_1matutils.html#a8972e8b9ba0f7f794b7c947bc49077d4">gensim.matutils.full2sparse</a>(result[i])</div>
<div class="line"><span class="lineno">  753</span>                      <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(result.shape[0]))</div>
<div class="line"><span class="lineno">  754</span>        <span class="keywordflow">return</span> output</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="ttc" id="anamespacegensim_1_1matutils_html_a8972e8b9ba0f7f794b7c947bc49077d4"><div class="ttname"><a href="namespacegensim_1_1matutils.html#a8972e8b9ba0f7f794b7c947bc49077d4">gensim.matutils.full2sparse</a></div><div class="ttdeci">full2sparse(vec, eps=1e-9)</div><div class="ttdef"><b>Definition</b> matutils.py:407</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17cdba18b8c618e53ba9cb86faf0b5f5" name="a17cdba18b8c618e53ba9cb86faf0b5f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17cdba18b8c618e53ba9cb86faf0b5f5">&#9670;&#160;</a></span>_getitem_format()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus._getitem_format </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  718</span>    <span class="keyword">def </span>_getitem_format(self, s_result):</div>
<div class="line"><span class="lineno">  719</span>        <span class="keywordflow">if</span> self.sparse_serialization:</div>
<div class="line"><span class="lineno">  720</span>            <span class="keywordflow">if</span> self.gensim:</div>
<div class="line"><span class="lineno">  721</span>                s_result = self._getitem_sparse2gensim(s_result)</div>
<div class="line"><span class="lineno">  722</span>            <span class="keywordflow">elif</span> <span class="keywordflow">not</span> self.sparse_retrieval:</div>
<div class="line"><span class="lineno">  723</span>                s_result = numpy.array(s_result.todense())</div>
<div class="line"><span class="lineno">  724</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  725</span>            <span class="keywordflow">if</span> self.gensim:</div>
<div class="line"><span class="lineno">  726</span>                s_result = self._getitem_dense2gensim(s_result)</div>
<div class="line"><span class="lineno">  727</span>            <span class="keywordflow">elif</span> self.sparse_retrieval:</div>
<div class="line"><span class="lineno">  728</span>                s_result = sparse.csr_matrix(s_result)</div>
<div class="line"><span class="lineno">  729</span>        <span class="keywordflow">return</span> s_result</div>
<div class="line"><span class="lineno">  730</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a237fb64a82bcefe60deaf8f96c95fe42" name="a237fb64a82bcefe60deaf8f96c95fe42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a237fb64a82bcefe60deaf8f96c95fe42">&#9670;&#160;</a></span>_getitem_sparse2gensim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus._getitem_sparse2gensim </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Change given sparse result matrix to gensim sparse vectors.

Uses the internals of the sparse matrix to make this fast.</pre> <div class="fragment"><div class="line"><span class="lineno">  731</span>    <span class="keyword">def </span>_getitem_sparse2gensim(self, result):</div>
<div class="line"><span class="lineno">  732</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">        Change given sparse result matrix to gensim sparse vectors.</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">        Uses the internals of the sparse matrix to make this fast.</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  738</span>        <span class="keyword">def </span>row_sparse2gensim(row_idx, csr_matrix):</div>
<div class="line"><span class="lineno">  739</span>            indices = csr_matrix.indices[csr_matrix.indptr[row_idx]:csr_matrix.indptr[row_idx + 1]]</div>
<div class="line"><span class="lineno">  740</span>            g_row = [(col_idx, csr_matrix[row_idx, col_idx]) <span class="keywordflow">for</span> col_idx <span class="keywordflow">in</span> indices]</div>
<div class="line"><span class="lineno">  741</span>            <span class="keywordflow">return</span> g_row</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>        output = (row_sparse2gensim(i, result) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(result.shape[0]))</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>        <span class="keywordflow">return</span> output</div>
<div class="line"><span class="lineno">  746</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0da4eefd27ed5933bdef16f924f97f6" name="ac0da4eefd27ed5933bdef16f924f97f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0da4eefd27ed5933bdef16f924f97f6">&#9670;&#160;</a></span>_guess_n_features()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus._guess_n_features </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Attempt to guess number of features in `corpus`.</pre> <div class="fragment"><div class="line"><span class="lineno">  506</span>    <span class="keyword">def </span>_guess_n_features(self, corpus):</div>
<div class="line"><span class="lineno">  507</span>        <span class="stringliteral">&quot;&quot;&quot;Attempt to guess number of features in `corpus`.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  508</span>        n_features = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">if</span> hasattr(corpus, <span class="stringliteral">&#39;dim&#39;</span>):</div>
<div class="line"><span class="lineno">  510</span>            <span class="comment"># print &#39;Guessing from \&#39;dim\&#39; attribute.&#39;</span></div>
<div class="line"><span class="lineno">  511</span>            n_features = corpus.dim</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">elif</span> hasattr(corpus, <span class="stringliteral">&#39;dictionary&#39;</span>):</div>
<div class="line"><span class="lineno">  513</span>            <span class="comment"># print &#39;GUessing from dictionary.&#39;</span></div>
<div class="line"><span class="lineno">  514</span>            n_features = len(corpus.dictionary)</div>
<div class="line"><span class="lineno">  515</span>        <span class="keywordflow">elif</span> hasattr(corpus, <span class="stringliteral">&#39;n_out&#39;</span>):</div>
<div class="line"><span class="lineno">  516</span>            <span class="comment"># print &#39;Guessing from \&#39;n_out\&#39; attribute.&#39;</span></div>
<div class="line"><span class="lineno">  517</span>            n_features = corpus.n_out</div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordflow">elif</span> hasattr(corpus, <span class="stringliteral">&#39;num_terms&#39;</span>):</div>
<div class="line"><span class="lineno">  519</span>            <span class="comment"># print &#39;Guessing from \&#39;num_terms\&#39; attribute.&#39;</span></div>
<div class="line"><span class="lineno">  520</span>            n_features = corpus.num_terms</div>
<div class="line"><span class="lineno">  521</span>        <span class="keywordflow">elif</span> isinstance(corpus, TransformedCorpus):</div>
<div class="line"><span class="lineno">  522</span>            <span class="comment"># TransformedCorpus: first check if the transformer object</span></div>
<div class="line"><span class="lineno">  523</span>            <span class="comment"># defines some output dimension; if it doesn&#39;t, relegate guessing</span></div>
<div class="line"><span class="lineno">  524</span>            <span class="comment"># to the corpus that is being transformed. This may easily fail!</span></div>
<div class="line"><span class="lineno">  525</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  526</span>                <span class="keywordflow">return</span> self._guess_n_features(corpus.obj)</div>
<div class="line"><span class="lineno">  527</span>            <span class="keywordflow">except</span> TypeError:</div>
<div class="line"><span class="lineno">  528</span>                <span class="keywordflow">return</span> self._guess_n_features(corpus.corpus)</div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  530</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.dim:</div>
<div class="line"><span class="lineno">  531</span>                <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  532</span>                    <span class="stringliteral">&quot;Couldn&#39;t find number of features, refusing to guess &quot;</span></div>
<div class="line"><span class="lineno">  533</span>                    <span class="stringliteral">&quot;(dimension set to {0}, type of corpus: {1}).&quot;</span></div>
<div class="line"><span class="lineno">  534</span>                    .format(self.dim, type(corpus))</div>
<div class="line"><span class="lineno">  535</span>                )</div>
<div class="line"><span class="lineno">  536</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  537</span>                logger.warning(<span class="stringliteral">&quot;Couldn&#39;t find number of features, trusting supplied dimension (%d)&quot;</span>, self.dim)</div>
<div class="line"><span class="lineno">  538</span>                n_features = self.dim</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">if</span> self.dim <span class="keywordflow">and</span> n_features != self.dim:</div>
<div class="line"><span class="lineno">  541</span>            logger.warning(</div>
<div class="line"><span class="lineno">  542</span>                <span class="stringliteral">&quot;Discovered inconsistent dataset dim (%d) and feature count from corpus (%d). &quot;</span></div>
<div class="line"><span class="lineno">  543</span>                <span class="stringliteral">&quot;Coercing to dimension given by argument.&quot;</span>,</div>
<div class="line"><span class="lineno">  544</span>                self.dim, n_features</div>
<div class="line"><span class="lineno">  545</span>            )</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>        <span class="keywordflow">return</span> n_features</div>
<div class="line"><span class="lineno">  548</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bcf844710712b511f1a98af5c288070" name="a3bcf844710712b511f1a98af5c288070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bcf844710712b511f1a98af5c288070">&#9670;&#160;</a></span>_resized_shard_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus._resized_shard_name </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Generate the name for the n-th new shard temporary file when
resizing dataset. The file will then be re-named to standard shard name.
</pre> <div class="fragment"><div class="line"><span class="lineno">  499</span>    <span class="keyword">def </span>_resized_shard_name(self, n):</div>
<div class="line"><span class="lineno">  500</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">        Generate the name for the n-th new shard temporary file when</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">        resizing dataset. The file will then be re-named to standard shard name.</span></div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordflow">return</span> self.output_prefix + <span class="stringliteral">&#39;.resize-temp.&#39;</span> + str(n)</div>
<div class="line"><span class="lineno">  505</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a410fe56e53ce2b7efb0443182a257792" name="a410fe56e53ce2b7efb0443182a257792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a410fe56e53ce2b7efb0443182a257792">&#9670;&#160;</a></span>_shard_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus._shard_name </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Generate the name for the n-th shard.</pre> <div class="fragment"><div class="line"><span class="lineno">  495</span>    <span class="keyword">def </span>_shard_name(self, n):</div>
<div class="line"><span class="lineno">  496</span>        <span class="stringliteral">&quot;&quot;&quot;Generate the name for the n-th shard.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  497</span>        <span class="keywordflow">return</span> self.output_prefix + <span class="stringliteral">&#39;.&#39;</span> + str(n)</div>
<div class="line"><span class="lineno">  498</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9b8d0874c2526358f04dff82c83b232" name="ad9b8d0874c2526358f04dff82c83b232"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9b8d0874c2526358f04dff82c83b232">&#9670;&#160;</a></span>get_by_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.get_by_offset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">As opposed to getitem, this one only accepts ints as offsets.</pre> <div class="fragment"><div class="line"><span class="lineno">  565</span>    <span class="keyword">def </span>get_by_offset(self, offset):</div>
<div class="line"><span class="lineno">  566</span>        <span class="stringliteral">&quot;&quot;&quot;As opposed to getitem, this one only accepts ints as offsets.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  567</span>        self._ensure_shard(offset)</div>
<div class="line"><span class="lineno">  568</span>        result = self.current_shard[offset - self.current_offset]</div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  570</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aeef371496c09fdbc7ee0217cdc7af42c" name="aeef371496c09fdbc7ee0217cdc7af42c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef371496c09fdbc7ee0217cdc7af42c">&#9670;&#160;</a></span>in_current()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.in_current </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Determine whether the given offset falls within the current shard.</pre> <div class="fragment"><div class="line"><span class="lineno">  402</span>    <span class="keyword">def </span>in_current(self, offset):</div>
<div class="line"><span class="lineno">  403</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">        Determine whether the given offset falls within the current shard.</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  407</span>        <span class="keywordflow">return</span> (self.current_offset &lt;= offset) <span class="keywordflow">and</span> (offset &lt; self.offsets[self.current_shard_n + 1])</div>
<div class="line"><span class="lineno">  408</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5739426dd46156baf563b70d762f1fdb" name="a5739426dd46156baf563b70d762f1fdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5739426dd46156baf563b70d762f1fdb">&#9670;&#160;</a></span>in_next()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.in_next </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Determine whether the given offset falls within the next shard.
This is a very small speedup: typically, we will be iterating through
the data forward. Could save considerable time with a very large number
of smaller shards.</pre> <div class="fragment"><div class="line"><span class="lineno">  409</span>    <span class="keyword">def </span>in_next(self, offset):</div>
<div class="line"><span class="lineno">  410</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">        Determine whether the given offset falls within the next shard.</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral">        This is a very small speedup: typically, we will be iterating through</span></div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral">        the data forward. Could save considerable time with a very large number</span></div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral">        of smaller shards.</span></div>
<div class="line"><span class="lineno">  415</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  417</span>        <span class="keywordflow">if</span> self.current_shard_n == self.n_shards:</div>
<div class="line"><span class="lineno">  418</span>            <span class="keywordflow">return</span> <span class="keyword">False</span>  <span class="comment"># There&#39;s no next shard.</span></div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">return</span> (self.offsets[self.current_shard_n + 1] &lt;= offset) <span class="keywordflow">and</span> (offset &lt; self.offsets[self.current_shard_n + 2])</div>
<div class="line"><span class="lineno">  420</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e2174e7ff63832eff79cd8a158fc1db" name="a2e2174e7ff63832eff79cd8a158fc1db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e2174e7ff63832eff79cd8a158fc1db">&#9670;&#160;</a></span>init_by_clone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.init_by_clone </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initialize by copying over attributes of another ShardedCorpus
instance saved to the output_prefix given at __init__().</pre> <div class="fragment"><div class="line"><span class="lineno">  311</span>    <span class="keyword">def </span>init_by_clone(self):</div>
<div class="line"><span class="lineno">  312</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">        Initialize by copying over attributes of another ShardedCorpus</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">        instance saved to the output_prefix given at __init__().</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  317</span>        temp = self.__class__.load(self.output_prefix)</div>
<div class="line"><span class="lineno">  318</span>        self.n_shards = temp.n_shards</div>
<div class="line"><span class="lineno">  319</span>        self.n_docs = temp.n_docs</div>
<div class="line"><span class="lineno">  320</span>        self.offsets = temp.offsets</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">if</span> temp.dim != self.dim:</div>
<div class="line"><span class="lineno">  323</span>            <span class="keywordflow">if</span> self.dim <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  324</span>                logger.info(<span class="stringliteral">&#39;Loaded dataset dimension: %d&#39;</span>, temp.dim)</div>
<div class="line"><span class="lineno">  325</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  326</span>                logger.warning(</div>
<div class="line"><span class="lineno">  327</span>                    <span class="stringliteral">&quot;Loaded dataset dimension differs from init arg dimension, &quot;</span></div>
<div class="line"><span class="lineno">  328</span>                    <span class="stringliteral">&quot;using loaded dim. (loaded %d, init %d)&quot;</span>,</div>
<div class="line"><span class="lineno">  329</span>                    temp.dim, self.dim</div>
<div class="line"><span class="lineno">  330</span>                )</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>        self.dim = temp.dim  <span class="comment"># To be consistent with the loaded data!</span></div>
<div class="line"><span class="lineno">  333</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a56e8a99f857d0b21e1316a3bdd8644c6" name="a56e8a99f857d0b21e1316a3bdd8644c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56e8a99f857d0b21e1316a3bdd8644c6">&#9670;&#160;</a></span>init_shards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.init_shards </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output_prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shardsize</em> = <code>4096</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em> = <code><a class="el" href="namespacegensim_1_1corpora_1_1sharded__corpus.html#a9aed23c4c6273f1436d6d476b71d60e4">_default_dtype</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initialize shards from the corpus.</pre> <div class="fragment"><div class="line"><span class="lineno">  266</span>    <span class="keyword">def </span>init_shards(self, output_prefix, corpus, shardsize=4096, dtype=_default_dtype):</div>
<div class="line"><span class="lineno">  267</span>        <span class="stringliteral">&quot;&quot;&quot;Initialize shards from the corpus.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>        is_corpus, corpus = <a class="code hl_function" href="namespacegensim_1_1utils.html#ac8815bd28fa8011c6f712ab341cbcb89">gensim.utils.is_corpus</a>(corpus)</div>
<div class="line"><span class="lineno">  270</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_corpus:</div>
<div class="line"><span class="lineno">  271</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  272</span>                <span class="stringliteral">&quot;Cannot initialize shards without a corpus to read from! (Got corpus type: {0})&quot;</span>.format(type(corpus))</div>
<div class="line"><span class="lineno">  273</span>            )</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>        proposed_dim = self._guess_n_features(corpus)</div>
<div class="line"><span class="lineno">  276</span>        <span class="keywordflow">if</span> proposed_dim != self.dim:</div>
<div class="line"><span class="lineno">  277</span>            <span class="keywordflow">if</span> self.dim <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  278</span>                logger.info(<span class="stringliteral">&#39;Deriving dataset dimension from corpus: %d&#39;</span>, proposed_dim)</div>
<div class="line"><span class="lineno">  279</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  280</span>                logger.warning(</div>
<div class="line"><span class="lineno">  281</span>                    <span class="stringliteral">&quot;Dataset dimension derived from input corpus differs from initialization argument, &quot;</span></div>
<div class="line"><span class="lineno">  282</span>                    <span class="stringliteral">&quot;using corpus. (corpus %d, init arg %d)&quot;</span>, proposed_dim, self.dim</div>
<div class="line"><span class="lineno">  283</span>                )</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>        self.dim = proposed_dim</div>
<div class="line"><span class="lineno">  286</span>        self.offsets = [0]</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>        start_time = perf_counter()</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>        logger.info(<span class="stringliteral">&#39;Running init from corpus.&#39;</span>)</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">for</span> n, doc_chunk <span class="keywordflow">in</span> enumerate(<a class="code hl_variable" href="namespacegensim_1_1utils.html#a72003b38870fd1b2af9a54765535f899">gensim.utils.grouper</a>(corpus, chunksize=shardsize)):</div>
<div class="line"><span class="lineno">  293</span>            logger.info(<span class="stringliteral">&#39;Chunk no. %d at %f s&#39;</span>, n, perf_counter() - start_time)</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>            current_shard = numpy.zeros((len(doc_chunk), self.dim), dtype=dtype)</div>
<div class="line"><span class="lineno">  296</span>            logger.debug(<span class="stringliteral">&#39;Current chunk dimension: %d x %d&#39;</span>, len(doc_chunk), self.dim)</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>            <span class="keywordflow">for</span> i, doc <span class="keywordflow">in</span> enumerate(doc_chunk):</div>
<div class="line"><span class="lineno">  299</span>                doc = dict(doc)</div>
<div class="line"><span class="lineno">  300</span>                current_shard[i][list(doc)] = list(gensim.matutils.itervalues(doc))</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>            <span class="comment"># Handles the updating as well.</span></div>
<div class="line"><span class="lineno">  303</span>            <span class="keywordflow">if</span> self.sparse_serialization:</div>
<div class="line"><span class="lineno">  304</span>                current_shard = sparse.csr_matrix(current_shard)</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>            self.save_shard(current_shard)</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>        end_time = perf_counter()</div>
<div class="line"><span class="lineno">  309</span>        logger.info(<span class="stringliteral">&#39;Built %d shards in %f s.&#39;</span>, self.n_shards, end_time - start_time)</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="ttc" id="anamespacegensim_1_1utils_html_a72003b38870fd1b2af9a54765535f899"><div class="ttname"><a href="namespacegensim_1_1utils.html#a72003b38870fd1b2af9a54765535f899">gensim.utils.grouper</a></div><div class="ttdeci">grouper</div><div class="ttdef"><b>Definition</b> utils.py:1186</div></div>
<div class="ttc" id="anamespacegensim_1_1utils_html_ac8815bd28fa8011c6f712ab341cbcb89"><div class="ttname"><a href="namespacegensim_1_1utils.html#ac8815bd28fa8011c6f712ab341cbcb89">gensim.utils.is_corpus</a></div><div class="ttdeci">is_corpus(obj)</div><div class="ttdef"><b>Definition</b> utils.py:840</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a282ef9536238e0de25d7d6d449560f0c" name="a282ef9536238e0de25d7d6d449560f0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a282ef9536238e0de25d7d6d449560f0c">&#9670;&#160;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.load </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mmap</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Load itself in clean state. `mmap` has no effect here.
</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1utils_1_1_save_load.html#a70d054bfd9dfd1373fef9e0e691a24b5">gensim.utils.SaveLoad</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  783</span>    <span class="keyword">def </span>load(cls, fname, mmap=None):</div>
<div class="line"><span class="lineno">  784</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  785</span><span class="stringliteral">        Load itself in clean state. `mmap` has no effect here.</span></div>
<div class="line"><span class="lineno">  786</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  787</span>        <span class="keywordflow">return</span> super(ShardedCorpus, cls).load(fname, mmap)</div>
<div class="line"><span class="lineno">  788</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a12bb2c1de4f3b8cbe9f32b9d3be869fc" name="a12bb2c1de4f3b8cbe9f32b9d3be869fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12bb2c1de4f3b8cbe9f32b9d3be869fc">&#9670;&#160;</a></span>load_shard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.load_shard </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Load (unpickle) the n-th shard as the "live" part of the dataset
into the Dataset object.</pre> <div class="fragment"><div class="line"><span class="lineno">  357</span>    <span class="keyword">def </span>load_shard(self, n):</div>
<div class="line"><span class="lineno">  358</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">        Load (unpickle) the n-th shard as the &quot;live&quot; part of the dataset</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">        into the Dataset object.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>        <span class="comment"># No-op if the shard is already open.</span></div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordflow">if</span> self.current_shard_n == n:</div>
<div class="line"><span class="lineno">  364</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>        filename = self._shard_name(n)</div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.isfile(filename):</div>
<div class="line"><span class="lineno">  368</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Attempting to load nonexistent shard no. {0}&#39;</span>.format(n))</div>
<div class="line"><span class="lineno">  369</span>        shard = <a class="code hl_function" href="namespacegensim_1_1utils.html#aad558496f36666822c8f15ea95f9515c">gensim.utils.unpickle</a>(filename)</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>        self.current_shard = shard</div>
<div class="line"><span class="lineno">  372</span>        self.current_shard_n = n</div>
<div class="line"><span class="lineno">  373</span>        self.current_offset = self.offsets[n]</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="ttc" id="anamespacegensim_1_1utils_html_aad558496f36666822c8f15ea95f9515c"><div class="ttname"><a href="namespacegensim_1_1utils.html#aad558496f36666822c8f15ea95f9515c">gensim.utils.unpickle</a></div><div class="ttdeci">unpickle(fname)</div><div class="ttdef"><b>Definition</b> utils.py:1381</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a624de074b98bd0a0267619957730f1cf" name="a624de074b98bd0a0267619957730f1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a624de074b98bd0a0267619957730f1cf">&#9670;&#160;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.reset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reset to no shard at all. Used for saving.</pre> <div class="fragment"><div class="line"><span class="lineno">  375</span>    <span class="keyword">def </span>reset(self):</div>
<div class="line"><span class="lineno">  376</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">        Reset to no shard at all. Used for saving.</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  380</span>        self.current_shard = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  381</span>        self.current_shard_n = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  382</span>        self.current_offset = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  383</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa0291d539bc79bc3f39adac09f48cee7" name="aa0291d539bc79bc3f39adac09f48cee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0291d539bc79bc3f39adac09f48cee7">&#9670;&#160;</a></span>resize_shards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.resize_shards </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shardsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Re-process the dataset to new shard size. This may take pretty long.
Also, note that you need some space on disk for this one (we're
assuming there is enough disk space for double the size of the dataset
and that there is enough memory for old + new shardsize).

:type shardsize: int
:param shardsize: The new shard size.</pre> <div class="fragment"><div class="line"><span class="lineno">  421</span>    <span class="keyword">def </span>resize_shards(self, shardsize):</div>
<div class="line"><span class="lineno">  422</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">        Re-process the dataset to new shard size. This may take pretty long.</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">        Also, note that you need some space on disk for this one (we&#39;re</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">        assuming there is enough disk space for double the size of the dataset</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">        and that there is enough memory for old + new shardsize).</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">        :type shardsize: int</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral">        :param shardsize: The new shard size.</span></div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  432</span>        <span class="comment"># Determine how many new shards there will be</span></div>
<div class="line"><span class="lineno">  433</span>        n_new_shards = int(math.floor(self.n_docs / float(shardsize)))</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">if</span> self.n_docs % shardsize != 0:</div>
<div class="line"><span class="lineno">  435</span>            n_new_shards += 1</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>        new_shard_names = []</div>
<div class="line"><span class="lineno">  438</span>        new_offsets = [0]</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>        <span class="keywordflow">for</span> new_shard_idx <span class="keywordflow">in</span> range(n_new_shards):</div>
<div class="line"><span class="lineno">  441</span>            new_start = shardsize * new_shard_idx</div>
<div class="line"><span class="lineno">  442</span>            new_stop = new_start + shardsize</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>            <span class="comment"># Last shard?</span></div>
<div class="line"><span class="lineno">  445</span>            <span class="keywordflow">if</span> new_stop &gt; self.n_docs:</div>
<div class="line"><span class="lineno">  446</span>                <span class="comment"># Sanity check</span></div>
<div class="line"><span class="lineno">  447</span>                <span class="keyword">assert</span> new_shard_idx == n_new_shards - 1, \</div>
<div class="line"><span class="lineno">  448</span>                    <span class="stringliteral">&#39;Shard no. {0} that ends at {1} over last document&#39;</span> \</div>
<div class="line"><span class="lineno">  449</span>                    <span class="stringliteral">&#39; ({2}) is not the last projected shard ({3})???&#39;</span> \</div>
<div class="line"><span class="lineno">  450</span>                    <span class="stringliteral">&#39;&#39;</span>.format(new_shard_idx, new_stop, self.n_docs, n_new_shards)</div>
<div class="line"><span class="lineno">  451</span>                new_stop = self.n_docs</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>            new_shard = self[new_start:new_stop]</div>
<div class="line"><span class="lineno">  454</span>            new_shard_name = self._resized_shard_name(new_shard_idx)</div>
<div class="line"><span class="lineno">  455</span>            new_shard_names.append(new_shard_name)</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  458</span>                self.save_shard(new_shard, new_shard_idx, new_shard_name)</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno">  460</span>                <span class="comment"># Clean up on unsuccessful resize.</span></div>
<div class="line"><span class="lineno">  461</span>                <span class="keywordflow">for</span> new_shard_name <span class="keywordflow">in</span> new_shard_names:</div>
<div class="line"><span class="lineno">  462</span>                    os.remove(new_shard_name)</div>
<div class="line"><span class="lineno">  463</span>                <span class="keywordflow">raise</span></div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>            new_offsets.append(new_stop)</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>        <span class="comment"># Move old shard files out, new ones in. Complicated due to possibility</span></div>
<div class="line"><span class="lineno">  468</span>        <span class="comment"># of exceptions.</span></div>
<div class="line"><span class="lineno">  469</span>        old_shard_names = [self._shard_name(n) <span class="keywordflow">for</span> n <span class="keywordflow">in</span> range(self.n_shards)]</div>
<div class="line"><span class="lineno">  470</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  471</span>            <span class="keywordflow">for</span> old_shard_n, old_shard_name <span class="keywordflow">in</span> enumerate(old_shard_names):</div>
<div class="line"><span class="lineno">  472</span>                os.remove(old_shard_name)</div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  474</span>            logger.error(</div>
<div class="line"><span class="lineno">  475</span>                <span class="stringliteral">&#39;Exception occurred during old shard no. %d removal: %s.\nAttempting to at least move new shards in.&#39;</span>,</div>
<div class="line"><span class="lineno">  476</span>                old_shard_n, str(e)</div>
<div class="line"><span class="lineno">  477</span>            )</div>
<div class="line"><span class="lineno">  478</span>        <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  479</span>            <span class="comment"># If something happens with cleaning up - try to at least get the</span></div>
<div class="line"><span class="lineno">  480</span>            <span class="comment"># new guys in.</span></div>
<div class="line"><span class="lineno">  481</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  482</span>                <span class="keywordflow">for</span> shard_n, new_shard_name <span class="keywordflow">in</span> enumerate(new_shard_names):</div>
<div class="line"><span class="lineno">  483</span>                    os.rename(new_shard_name, self._shard_name(shard_n))</div>
<div class="line"><span class="lineno">  484</span>            <span class="comment"># If something happens when we&#39;re in this stage, we&#39;re screwed.</span></div>
<div class="line"><span class="lineno">  485</span>            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  486</span>                logger.exception(e)</div>
<div class="line"><span class="lineno">  487</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;Resizing completely failed for some reason. Sorry, dataset is probably ruined...&#39;</span>)</div>
<div class="line"><span class="lineno">  488</span>            <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  489</span>                <span class="comment"># Sets the new shard stats.</span></div>
<div class="line"><span class="lineno">  490</span>                self.n_shards = n_new_shards</div>
<div class="line"><span class="lineno">  491</span>                self.offsets = new_offsets</div>
<div class="line"><span class="lineno">  492</span>                self.shardsize = shardsize</div>
<div class="line"><span class="lineno">  493</span>                self.reset()</div>
<div class="line"><span class="lineno">  494</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aeba96bf724465bfaa6b4cd7af205144e" name="aeba96bf724465bfaa6b4cd7af205144e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeba96bf724465bfaa6b4cd7af205144e">&#9670;&#160;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.save </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Save itself (the wrapper) in clean state (after calling `reset()`)
to the output_prefix file. If you wish to save to a different file,
use the `fname` argument as the first positional arg.</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1interfaces_1_1_corpus_a_b_c.html#ab64bdb03fe8138bc17beb2f8fc3a134c">gensim.interfaces.CorpusABC</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  765</span>    <span class="keyword">def </span>save(self, *args, **kwargs):</div>
<div class="line"><span class="lineno">  766</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  767</span><span class="stringliteral">        Save itself (the wrapper) in clean state (after calling `reset()`)</span></div>
<div class="line"><span class="lineno">  768</span><span class="stringliteral">        to the output_prefix file. If you wish to save to a different file,</span></div>
<div class="line"><span class="lineno">  769</span><span class="stringliteral">        use the `fname` argument as the first positional arg.</span></div>
<div class="line"><span class="lineno">  770</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  771</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  772</span>        <span class="comment"># Can we save to a different file than output_prefix? Well, why not?</span></div>
<div class="line"><span class="lineno">  773</span>        <span class="keywordflow">if</span> len(args) == 0:</div>
<div class="line"><span class="lineno">  774</span>            args = (self.output_prefix,)</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>        attrs_to_ignore = [<span class="stringliteral">&#39;current_shard&#39;</span>, <span class="stringliteral">&#39;current_shard_n&#39;</span>, <span class="stringliteral">&#39;current_offset&#39;</span>]</div>
<div class="line"><span class="lineno">  777</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;ignore&#39;</span> <span class="keywordflow">in</span> kwargs:</div>
<div class="line"><span class="lineno">  778</span>            attrs_to_ignore.extend(kwargs[<span class="stringliteral">&#39;ignore&#39;</span>])</div>
<div class="line"><span class="lineno">  779</span>        kwargs[<span class="stringliteral">&#39;ignore&#39;</span>] = frozenset(attrs_to_ignore)</div>
<div class="line"><span class="lineno">  780</span>        super(ShardedCorpus, self).save(*args, **kwargs)</div>
<div class="line"><span class="lineno">  781</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aabe23ddf80e6edbbbe977a25c3eea1c4" name="aabe23ddf80e6edbbbe977a25c3eea1c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabe23ddf80e6edbbbe977a25c3eea1c4">&#9670;&#160;</a></span>save_corpus()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.save_corpus </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>id2word</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>progress_cnt</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metadata</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Implement a serialization interface. Do not call directly;
use the `serialize` method instead.

Note that you might need some ShardedCorpus init parameters, most
likely the dimension (`dim`). Again, pass these as `kwargs` to the
`serialize` method.

All this thing does is initialize a ShardedCorpus from a corpus
with the `output_prefix` argument set to the `fname` parameter
of this method. The initialization of a ShardedCorpus takes care of
serializing the data (in dense form) to shards.

Ignore the parameters id2word, progress_cnt and metadata. They
currently do nothing and are here only to provide a compatible
method signature with superclass.</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1interfaces_1_1_corpus_a_b_c.html#a7d53a6fd1ce50a2952f2f2fb70620ace">gensim.interfaces.CorpusABC</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  790</span>    <span class="keyword">def </span>save_corpus(fname, corpus, id2word=None, progress_cnt=1000, metadata=False, **kwargs):</div>
<div class="line"><span class="lineno">  791</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral">        Implement a serialization interface. Do not call directly;</span></div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">        use the `serialize` method instead.</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral">        Note that you might need some ShardedCorpus init parameters, most</span></div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">        likely the dimension (`dim`). Again, pass these as `kwargs` to the</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">        `serialize` method.</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  799</span><span class="stringliteral">        All this thing does is initialize a ShardedCorpus from a corpus</span></div>
<div class="line"><span class="lineno">  800</span><span class="stringliteral">        with the `output_prefix` argument set to the `fname` parameter</span></div>
<div class="line"><span class="lineno">  801</span><span class="stringliteral">        of this method. The initialization of a ShardedCorpus takes care of</span></div>
<div class="line"><span class="lineno">  802</span><span class="stringliteral">        serializing the data (in dense form) to shards.</span></div>
<div class="line"><span class="lineno">  803</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  804</span><span class="stringliteral">        Ignore the parameters id2word, progress_cnt and metadata. They</span></div>
<div class="line"><span class="lineno">  805</span><span class="stringliteral">        currently do nothing and are here only to provide a compatible</span></div>
<div class="line"><span class="lineno">  806</span><span class="stringliteral">        method signature with superclass.</span></div>
<div class="line"><span class="lineno">  807</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  808</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  809</span>        ShardedCorpus(fname, corpus, **kwargs)</div>
<div class="line"><span class="lineno">  810</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a692d3c5aa316ad69507570f823c8a642" name="a692d3c5aa316ad69507570f823c8a642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a692d3c5aa316ad69507570f823c8a642">&#9670;&#160;</a></span>save_shard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.save_shard </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Pickle the given shard. If `n` is not given, will consider the shard
a new one.

If `filename` is given, will use that file name instead of generating
one.</pre> <div class="fragment"><div class="line"><span class="lineno">  334</span>    <span class="keyword">def </span>save_shard(self, shard, n=None, filename=None):</div>
<div class="line"><span class="lineno">  335</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">        Pickle the given shard. If `n` is not given, will consider the shard</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">        a new one.</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">        If `filename` is given, will use that file name instead of generating</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">        one.</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  343</span>        new_shard = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">if</span> n <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  345</span>            n = self.n_shards  <span class="comment"># Saving the *next* one by default.</span></div>
<div class="line"><span class="lineno">  346</span>            new_shard = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> filename:</div>
<div class="line"><span class="lineno">  349</span>            filename = self._shard_name(n)</div>
<div class="line"><span class="lineno">  350</span>        <a class="code hl_function" href="namespacegensim_1_1utils.html#acbf830b64b172ff4f3da823f7e2b308e">gensim.utils.pickle</a>(shard, filename)</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>        <span class="keywordflow">if</span> new_shard:</div>
<div class="line"><span class="lineno">  353</span>            self.offsets.append(self.offsets[-1] + shard.shape[0])</div>
<div class="line"><span class="lineno">  354</span>            self.n_docs += shard.shape[0]</div>
<div class="line"><span class="lineno">  355</span>            self.n_shards += 1</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="ttc" id="anamespacegensim_1_1utils_html_acbf830b64b172ff4f3da823f7e2b308e"><div class="ttname"><a href="namespacegensim_1_1utils.html#acbf830b64b172ff4f3da823f7e2b308e">gensim.utils.pickle</a></div><div class="ttdeci">pickle(obj, fname, protocol=2)</div><div class="ttdef"><b>Definition</b> utils.py:1364</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fb215fb983ad84ee2f2eba896af9d72" name="a9fb215fb983ad84ee2f2eba896af9d72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb215fb983ad84ee2f2eba896af9d72">&#9670;&#160;</a></span>serialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.serialize </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>serializer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>id2word</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index_fname</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>progress_cnt</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metadata</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Iterate through the document stream `corpus`, saving the documents
as a ShardedCorpus to `fname`.

Use this method instead of calling `save_corpus` directly.
You may need to supply some kwargs that are used upon dataset creation
(namely: `dim`, unless the dataset can infer the dimension from the
given corpus).

Ignore the parameters id2word, index_fname, progress_cnt, labels
and metadata. They currently do nothing and are here only to
provide a compatible method signature with superclass.</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1corpora_1_1indexedcorpus_1_1_indexed_corpus.html#aa7f9ae4b0b43ffe686a77d5ef3446881">gensim.corpora.indexedcorpus.IndexedCorpus</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  813</span>                  labels=<span class="keywordtype">None</span>, metadata=<span class="keyword">False</span>, **kwargs):</div>
<div class="line"><span class="lineno">  814</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral">        Iterate through the document stream `corpus`, saving the documents</span></div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">        as a ShardedCorpus to `fname`.</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">        Use this method instead of calling `save_corpus` directly.</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral">        You may need to supply some kwargs that are used upon dataset creation</span></div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral">        (namely: `dim`, unless the dataset can infer the dimension from the</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">        given corpus).</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">        Ignore the parameters id2word, index_fname, progress_cnt, labels</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">        and metadata. They currently do nothing and are here only to</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">        provide a compatible method signature with superclass.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  826</span>        serializer.save_corpus(fname, corpus, id2word=id2word, progress_cnt=progress_cnt, metadata=metadata, **kwargs)</div>
</div><!-- fragment -->
</div>
</div>
<a id="acada0a5bbde0c11c7ab72df8852b31ae" name="acada0a5bbde0c11c7ab72df8852b31ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acada0a5bbde0c11c7ab72df8852b31ae">&#9670;&#160;</a></span>shard_by_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.shard_by_offset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Determine which shard the given offset belongs to. If the offset
is greater than the number of available documents, raises a
`ValueError`.

Assumes that all shards have the same size.</pre> <div class="fragment"><div class="line"><span class="lineno">  384</span>    <span class="keyword">def </span>shard_by_offset(self, offset):</div>
<div class="line"><span class="lineno">  385</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">        Determine which shard the given offset belongs to. If the offset</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">        is greater than the number of available documents, raises a</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">        `ValueError`.</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">        Assumes that all shards have the same size.</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  393</span>        k = int(offset / self.shardsize)</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">if</span> offset &gt;= self.n_docs:</div>
<div class="line"><span class="lineno">  395</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Too high offset specified ({0}), available &#39;</span></div>
<div class="line"><span class="lineno">  396</span>                             <span class="stringliteral">&#39;docs: {1}&#39;</span>.format(offset, self.n_docs))</div>
<div class="line"><span class="lineno">  397</span>        <span class="keywordflow">if</span> offset &lt; 0:</div>
<div class="line"><span class="lineno">  398</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Negative offset {0} currently not&#39;</span></div>
<div class="line"><span class="lineno">  399</span>                             <span class="stringliteral">&#39; supported.&#39;</span>.format(offset))</div>
<div class="line"><span class="lineno">  400</span>        <span class="keywordflow">return</span> k</div>
<div class="line"><span class="lineno">  401</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2f90f7c0aa9dd2978b2d58b06d518399" name="a2f90f7c0aa9dd2978b2d58b06d518399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f90f7c0aa9dd2978b2d58b06d518399">&#9670;&#160;</a></span>current_offset</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.current_offset</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af6c4661324d05733c021e1a9b5847126" name="af6c4661324d05733c021e1a9b5847126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6c4661324d05733c021e1a9b5847126">&#9670;&#160;</a></span>current_shard</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.current_shard</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab6c9b8ffc56b535813b0ea455ae37885" name="ab6c9b8ffc56b535813b0ea455ae37885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c9b8ffc56b535813b0ea455ae37885">&#9670;&#160;</a></span>current_shard_n</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.current_shard_n</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a55d35eb0c66dbee8ca7b5e4157f36677" name="a55d35eb0c66dbee8ca7b5e4157f36677"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55d35eb0c66dbee8ca7b5e4157f36677">&#9670;&#160;</a></span>dim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.dim</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a590a3539895629fde932b46dec624f" name="a8a590a3539895629fde932b46dec624f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a590a3539895629fde932b46dec624f">&#9670;&#160;</a></span>gensim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.gensim</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5e01c678e0b36ccea62a63d3571c6a44" name="a5e01c678e0b36ccea62a63d3571c6a44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e01c678e0b36ccea62a63d3571c6a44">&#9670;&#160;</a></span>n_docs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.n_docs</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a00fa62a50a1b18129e677f1d364e81ec" name="a00fa62a50a1b18129e677f1d364e81ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00fa62a50a1b18129e677f1d364e81ec">&#9670;&#160;</a></span>n_shards</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.n_shards</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a839dafb430b88b19a022fe5ca734efac" name="a839dafb430b88b19a022fe5ca734efac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a839dafb430b88b19a022fe5ca734efac">&#9670;&#160;</a></span>offsets</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.offsets</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8c242bfdf47d1cc3adebacd587375d63" name="a8c242bfdf47d1cc3adebacd587375d63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c242bfdf47d1cc3adebacd587375d63">&#9670;&#160;</a></span>output_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.output_prefix</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af5840f504f8b1909710e3f37bc48c837" name="af5840f504f8b1909710e3f37bc48c837"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5840f504f8b1909710e3f37bc48c837">&#9670;&#160;</a></span>shardsize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.shardsize</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abb0bf6ab60006d4c87d7865a94dc3d23" name="abb0bf6ab60006d4c87d7865a94dc3d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb0bf6ab60006d4c87d7865a94dc3d23">&#9670;&#160;</a></span>sparse_retrieval</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.sparse_retrieval</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2bbb05690c88f987cc2879ca8688c98e" name="a2bbb05690c88f987cc2879ca8688c98e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bbb05690c88f987cc2879ca8688c98e">&#9670;&#160;</a></span>sparse_serialization</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.corpora.sharded_corpus.ShardedCorpus.sparse_serialization</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/gensim/corpora/<a class="el" href="sharded__corpus_8py.html">sharded_corpus.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
