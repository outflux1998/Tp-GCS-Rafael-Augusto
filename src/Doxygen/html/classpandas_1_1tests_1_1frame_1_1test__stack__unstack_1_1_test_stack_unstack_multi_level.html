<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1frame.html">frame</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1frame_1_1test__stack__unstack.html">test_stack_unstack</a></li><li class="navelem"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html">TestStackUnstackMultiLevel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a648ab3828dba2dd37f098ffc1df01f52" id="r_a648ab3828dba2dd37f098ffc1df01f52"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a648ab3828dba2dd37f098ffc1df01f52">test_unstack</a> (self, multiindex_year_month_day_dataframe_random_data)</td></tr>
<tr class="separator:a648ab3828dba2dd37f098ffc1df01f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5b2bb57575b23dbf91147d122a2678" id="r_a9d5b2bb57575b23dbf91147d122a2678"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a9d5b2bb57575b23dbf91147d122a2678">test_unstack_partial</a> (self, result_rows, result_columns, index_product, expected_row)</td></tr>
<tr class="separator:a9d5b2bb57575b23dbf91147d122a2678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac769d73cf27cf404d03914d814cdf18a" id="r_ac769d73cf27cf404d03914d814cdf18a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#ac769d73cf27cf404d03914d814cdf18a">test_unstack_multiple_no_empty_columns</a> (self)</td></tr>
<tr class="separator:ac769d73cf27cf404d03914d814cdf18a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4ddc8d1d4338ae5e261b3e638deaccb" id="r_ae4ddc8d1d4338ae5e261b3e638deaccb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#ae4ddc8d1d4338ae5e261b3e638deaccb">test_stack</a> (self, multiindex_year_month_day_dataframe_random_data)</td></tr>
<tr class="separator:ae4ddc8d1d4338ae5e261b3e638deaccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b0c69608422d9ce055873706e5f5b51" id="r_a0b0c69608422d9ce055873706e5f5b51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a0b0c69608422d9ce055873706e5f5b51">test_stack_duplicate_index</a> (self, <a class="el" href="__lapack__subroutines_8h.html#a0de1bc518c4a24bade63153311d1d7b2">idx</a>, columns, exp_idx)</td></tr>
<tr class="separator:a0b0c69608422d9ce055873706e5f5b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fd0afcd1509c27c6ffdb10156347ba1" id="r_a2fd0afcd1509c27c6ffdb10156347ba1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a2fd0afcd1509c27c6ffdb10156347ba1">test_unstack_odd_failure</a> (self)</td></tr>
<tr class="separator:a2fd0afcd1509c27c6ffdb10156347ba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a432f7f0d4a0d4e25fe0706416672d8" id="r_a5a432f7f0d4a0d4e25fe0706416672d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a5a432f7f0d4a0d4e25fe0706416672d8">test_stack_mixed_dtype</a> (self, multiindex_dataframe_random_data)</td></tr>
<tr class="separator:a5a432f7f0d4a0d4e25fe0706416672d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26de54179010e89c0e014e086c6b8994" id="r_a26de54179010e89c0e014e086c6b8994"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a26de54179010e89c0e014e086c6b8994">test_unstack_bug</a> (self)</td></tr>
<tr class="separator:a26de54179010e89c0e014e086c6b8994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27006d634dba060f7b5856a991d880ab" id="r_a27006d634dba060f7b5856a991d880ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a27006d634dba060f7b5856a991d880ab">test_stack_unstack_preserve_names</a> (self, multiindex_dataframe_random_data)</td></tr>
<tr class="separator:a27006d634dba060f7b5856a991d880ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac272168b80055f54d22f9c0e646d61fd" id="r_ac272168b80055f54d22f9c0e646d61fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#ac272168b80055f54d22f9c0e646d61fd">test_stack_unstack_wrong_level_name</a> (self, method, multiindex_dataframe_random_data)</td></tr>
<tr class="separator:ac272168b80055f54d22f9c0e646d61fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add7b4ff2a9b5013061f8879d68c84ceb" id="r_add7b4ff2a9b5013061f8879d68c84ceb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#add7b4ff2a9b5013061f8879d68c84ceb">test_unstack_level_name</a> (self, multiindex_dataframe_random_data)</td></tr>
<tr class="separator:add7b4ff2a9b5013061f8879d68c84ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af35e7f9804622edc2e7525035c57c247" id="r_af35e7f9804622edc2e7525035c57c247"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#af35e7f9804622edc2e7525035c57c247">test_stack_level_name</a> (self, multiindex_dataframe_random_data)</td></tr>
<tr class="separator:af35e7f9804622edc2e7525035c57c247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2316247beb5fa7cfd6ded3ed104c5679" id="r_a2316247beb5fa7cfd6ded3ed104c5679"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a2316247beb5fa7cfd6ded3ed104c5679">test_stack_unstack_multiple</a> (self, multiindex_year_month_day_dataframe_random_data)</td></tr>
<tr class="separator:a2316247beb5fa7cfd6ded3ed104c5679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a8c2d0103ceb8b891a6dc136fc83c62" id="r_a9a8c2d0103ceb8b891a6dc136fc83c62"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a9a8c2d0103ceb8b891a6dc136fc83c62">test_stack_names_and_numbers</a> (self, multiindex_year_month_day_dataframe_random_data)</td></tr>
<tr class="separator:a9a8c2d0103ceb8b891a6dc136fc83c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c3d520712f420371e156e1bfc70cc0" id="r_a40c3d520712f420371e156e1bfc70cc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a40c3d520712f420371e156e1bfc70cc0">test_stack_multiple_out_of_bounds</a> (self, multiindex_year_month_day_dataframe_random_data)</td></tr>
<tr class="separator:a40c3d520712f420371e156e1bfc70cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad71eac08ac1cfe9bccabe138d2f80f90" id="r_ad71eac08ac1cfe9bccabe138d2f80f90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#ad71eac08ac1cfe9bccabe138d2f80f90">test_unstack_period_series</a> (self)</td></tr>
<tr class="separator:ad71eac08ac1cfe9bccabe138d2f80f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a2b05d0131756a9ada711b1a262710b" id="r_a8a2b05d0131756a9ada711b1a262710b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a8a2b05d0131756a9ada711b1a262710b">test_unstack_period_frame</a> (self)</td></tr>
<tr class="separator:a8a2b05d0131756a9ada711b1a262710b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9f439a846228c499b2e860f26cbd508" id="r_ab9f439a846228c499b2e860f26cbd508"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#ab9f439a846228c499b2e860f26cbd508">test_stack_multiple_bug</a> (self)</td></tr>
<tr class="separator:ab9f439a846228c499b2e860f26cbd508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af562738bfe6b36df07c05d93fb66ab3f" id="r_af562738bfe6b36df07c05d93fb66ab3f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#af562738bfe6b36df07c05d93fb66ab3f">test_stack_dropna</a> (self)</td></tr>
<tr class="separator:af562738bfe6b36df07c05d93fb66ab3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab23dcc2a98d271b235125e9c5497c7a2" id="r_ab23dcc2a98d271b235125e9c5497c7a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#ab23dcc2a98d271b235125e9c5497c7a2">test_unstack_multiple_hierarchical</a> (self)</td></tr>
<tr class="separator:ab23dcc2a98d271b235125e9c5497c7a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4aed3298d372909a95515393068d6bd" id="r_aa4aed3298d372909a95515393068d6bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#aa4aed3298d372909a95515393068d6bd">test_unstack_sparse_keyspace</a> (self)</td></tr>
<tr class="separator:aa4aed3298d372909a95515393068d6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e1924f13c6cb0470534f09c35d70db6" id="r_a7e1924f13c6cb0470534f09c35d70db6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a7e1924f13c6cb0470534f09c35d70db6">test_unstack_unobserved_keys</a> (self)</td></tr>
<tr class="separator:a7e1924f13c6cb0470534f09c35d70db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71891597db16b2fbf1a5023e0605b342" id="r_a71891597db16b2fbf1a5023e0605b342"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a71891597db16b2fbf1a5023e0605b342">test_unstack_number_of_levels_larger_than_int32</a> (self, monkeypatch)</td></tr>
<tr class="separator:a71891597db16b2fbf1a5023e0605b342"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af50da6fdb76943b8ccf2856a8aa990b1" id="r_af50da6fdb76943b8ccf2856a8aa990b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#af50da6fdb76943b8ccf2856a8aa990b1">test_stack_order_with_unsorted_levels</a> (self, levels, stack_lev)</td></tr>
<tr class="separator:af50da6fdb76943b8ccf2856a8aa990b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1cb40764a1deba3b505ecc252b4bcb4" id="r_aa1cb40764a1deba3b505ecc252b4bcb4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#aa1cb40764a1deba3b505ecc252b4bcb4">test_stack_order_with_unsorted_levels_multi_row</a> (self)</td></tr>
<tr class="separator:aa1cb40764a1deba3b505ecc252b4bcb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ab7165b6e2ace310f48637b289b7f28" id="r_a3ab7165b6e2ace310f48637b289b7f28"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a3ab7165b6e2ace310f48637b289b7f28">test_stack_unstack_unordered_multiindex</a> (self)</td></tr>
<tr class="separator:a3ab7165b6e2ace310f48637b289b7f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a85eceda97f6ad1629cb9ac5bd4248b" id="r_a4a85eceda97f6ad1629cb9ac5bd4248b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a4a85eceda97f6ad1629cb9ac5bd4248b">test_unstack_preserve_types</a> (self, multiindex_year_month_day_dataframe_random_data)</td></tr>
<tr class="separator:a4a85eceda97f6ad1629cb9ac5bd4248b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1448f41f7418e529693f7c4fb4e57fe5" id="r_a1448f41f7418e529693f7c4fb4e57fe5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a1448f41f7418e529693f7c4fb4e57fe5">test_unstack_group_index_overflow</a> (self)</td></tr>
<tr class="separator:a1448f41f7418e529693f7c4fb4e57fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a695b2e1fd3039f7dae1a9b1ee503484e" id="r_a695b2e1fd3039f7dae1a9b1ee503484e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a695b2e1fd3039f7dae1a9b1ee503484e">test_unstack_with_missing_int_cast_to_float</a> (self, using_array_manager)</td></tr>
<tr class="separator:a695b2e1fd3039f7dae1a9b1ee503484e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba1de14b1a1c3afd29e2435523432f1" id="r_a5ba1de14b1a1c3afd29e2435523432f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a5ba1de14b1a1c3afd29e2435523432f1">test_unstack_with_level_has_nan</a> (self)</td></tr>
<tr class="separator:a5ba1de14b1a1c3afd29e2435523432f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6500b1adac29ab894511d1abd240ca2" id="r_af6500b1adac29ab894511d1abd240ca2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#af6500b1adac29ab894511d1abd240ca2">test_stack_nan_in_multiindex_columns</a> (self)</td></tr>
<tr class="separator:af6500b1adac29ab894511d1abd240ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d7a2c49aa1d63fc8c6d3a32c106a231" id="r_a6d7a2c49aa1d63fc8c6d3a32c106a231"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a6d7a2c49aa1d63fc8c6d3a32c106a231">test_multi_level_stack_categorical</a> (self)</td></tr>
<tr class="separator:a6d7a2c49aa1d63fc8c6d3a32c106a231"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9801b48a7167efe8bc8b499e50f54f9c" id="r_a9801b48a7167efe8bc8b499e50f54f9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a9801b48a7167efe8bc8b499e50f54f9c">test_stack_nan_level</a> (self)</td></tr>
<tr class="separator:a9801b48a7167efe8bc8b499e50f54f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab943091a4f562bf850120a934dc8b5fc" id="r_ab943091a4f562bf850120a934dc8b5fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#ab943091a4f562bf850120a934dc8b5fc">test_unstack_categorical_columns</a> (self)</td></tr>
<tr class="separator:ab943091a4f562bf850120a934dc8b5fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dca6dd6ec614a7dd93fe82f89eefd1a" id="r_a8dca6dd6ec614a7dd93fe82f89eefd1a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a8dca6dd6ec614a7dd93fe82f89eefd1a">test_stack_unsorted</a> (self)</td></tr>
<tr class="separator:a8dca6dd6ec614a7dd93fe82f89eefd1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c4273b46e3280252c64851fa12a763" id="r_a76c4273b46e3280252c64851fa12a763"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1frame_1_1test__stack__unstack_1_1_test_stack_unstack_multi_level.html#a76c4273b46e3280252c64851fa12a763">test_stack_nullable_dtype</a> (self)</td></tr>
<tr class="separator:a76c4273b46e3280252c64851fa12a763"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6d7a2c49aa1d63fc8c6d3a32c106a231" name="a6d7a2c49aa1d63fc8c6d3a32c106a231"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d7a2c49aa1d63fc8c6d3a32c106a231">&#9670;&#160;</a></span>test_multi_level_stack_categorical()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_multi_level_stack_categorical </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2077</span>    <span class="keyword">def </span>test_multi_level_stack_categorical(self):</div>
<div class="line"><span class="lineno"> 2078</span>        <span class="comment"># GH 15239</span></div>
<div class="line"><span class="lineno"> 2079</span>        midx = MultiIndex.from_arrays(</div>
<div class="line"><span class="lineno"> 2080</span>            [</div>
<div class="line"><span class="lineno"> 2081</span>                [<span class="stringliteral">&quot;A&quot;</span>] * 2 + [<span class="stringliteral">&quot;B&quot;</span>] * 2,</div>
<div class="line"><span class="lineno"> 2082</span>                pd.Categorical(list(<span class="stringliteral">&quot;abab&quot;</span>)),</div>
<div class="line"><span class="lineno"> 2083</span>                pd.Categorical(list(<span class="stringliteral">&quot;ccdd&quot;</span>)),</div>
<div class="line"><span class="lineno"> 2084</span>            ]</div>
<div class="line"><span class="lineno"> 2085</span>        )</div>
<div class="line"><span class="lineno"> 2086</span>        df = DataFrame(np.arange(8).reshape(2, 4), columns=midx)</div>
<div class="line"><span class="lineno"> 2087</span>        result = df.stack([1, 2])</div>
<div class="line"><span class="lineno"> 2088</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 2089</span>            [</div>
<div class="line"><span class="lineno"> 2090</span>                [0, np.nan],</div>
<div class="line"><span class="lineno"> 2091</span>                [np.nan, 2],</div>
<div class="line"><span class="lineno"> 2092</span>                [1, np.nan],</div>
<div class="line"><span class="lineno"> 2093</span>                [np.nan, 3],</div>
<div class="line"><span class="lineno"> 2094</span>                [4, np.nan],</div>
<div class="line"><span class="lineno"> 2095</span>                [np.nan, 6],</div>
<div class="line"><span class="lineno"> 2096</span>                [5, np.nan],</div>
<div class="line"><span class="lineno"> 2097</span>                [np.nan, 7],</div>
<div class="line"><span class="lineno"> 2098</span>            ],</div>
<div class="line"><span class="lineno"> 2099</span>            columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>],</div>
<div class="line"><span class="lineno"> 2100</span>            index=MultiIndex.from_arrays(</div>
<div class="line"><span class="lineno"> 2101</span>                [</div>
<div class="line"><span class="lineno"> 2102</span>                    [0] * 4 + [1] * 4,</div>
<div class="line"><span class="lineno"> 2103</span>                    pd.Categorical(list(<span class="stringliteral">&quot;aabbaabb&quot;</span>)),</div>
<div class="line"><span class="lineno"> 2104</span>                    pd.Categorical(list(<span class="stringliteral">&quot;cdcdcdcd&quot;</span>)),</div>
<div class="line"><span class="lineno"> 2105</span>                ]</div>
<div class="line"><span class="lineno"> 2106</span>            ),</div>
<div class="line"><span class="lineno"> 2107</span>        )</div>
<div class="line"><span class="lineno"> 2108</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2109</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4ddc8d1d4338ae5e261b3e638deaccb" name="ae4ddc8d1d4338ae5e261b3e638deaccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4ddc8d1d4338ae5e261b3e638deaccb">&#9670;&#160;</a></span>test_stack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_year_month_day_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1404</span>    <span class="keyword">def </span>test_stack(self, multiindex_year_month_day_dataframe_random_data):</div>
<div class="line"><span class="lineno"> 1405</span>        ymd = multiindex_year_month_day_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1406</span> </div>
<div class="line"><span class="lineno"> 1407</span>        <span class="comment"># regular roundtrip</span></div>
<div class="line"><span class="lineno"> 1408</span>        unstacked = ymd.unstack()</div>
<div class="line"><span class="lineno"> 1409</span>        restacked = unstacked.stack()</div>
<div class="line"><span class="lineno"> 1410</span>        tm.assert_frame_equal(restacked, ymd)</div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span>        unlexsorted = ymd.sort_index(level=2)</div>
<div class="line"><span class="lineno"> 1413</span> </div>
<div class="line"><span class="lineno"> 1414</span>        unstacked = unlexsorted.unstack(2)</div>
<div class="line"><span class="lineno"> 1415</span>        restacked = unstacked.stack()</div>
<div class="line"><span class="lineno"> 1416</span>        tm.assert_frame_equal(restacked.sort_index(level=0), ymd)</div>
<div class="line"><span class="lineno"> 1417</span> </div>
<div class="line"><span class="lineno"> 1418</span>        unlexsorted = unlexsorted[::-1]</div>
<div class="line"><span class="lineno"> 1419</span>        unstacked = unlexsorted.unstack(1)</div>
<div class="line"><span class="lineno"> 1420</span>        restacked = unstacked.stack().swaplevel(1, 2)</div>
<div class="line"><span class="lineno"> 1421</span>        tm.assert_frame_equal(restacked.sort_index(level=0), ymd)</div>
<div class="line"><span class="lineno"> 1422</span> </div>
<div class="line"><span class="lineno"> 1423</span>        unlexsorted = unlexsorted.swaplevel(0, 1)</div>
<div class="line"><span class="lineno"> 1424</span>        unstacked = unlexsorted.unstack(0).swaplevel(0, 1, axis=1)</div>
<div class="line"><span class="lineno"> 1425</span>        restacked = unstacked.stack(0).swaplevel(1, 2)</div>
<div class="line"><span class="lineno"> 1426</span>        tm.assert_frame_equal(restacked.sort_index(level=0), ymd)</div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>        <span class="comment"># columns unsorted</span></div>
<div class="line"><span class="lineno"> 1429</span>        unstacked = ymd.unstack()</div>
<div class="line"><span class="lineno"> 1430</span>        unstacked = unstacked.sort_index(axis=1, ascending=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1431</span>        restacked = unstacked.stack()</div>
<div class="line"><span class="lineno"> 1432</span>        tm.assert_frame_equal(restacked, ymd)</div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span>        <span class="comment"># more than 2 levels in the columns</span></div>
<div class="line"><span class="lineno"> 1435</span>        unstacked = ymd.unstack(1).unstack(1)</div>
<div class="line"><span class="lineno"> 1436</span> </div>
<div class="line"><span class="lineno"> 1437</span>        result = unstacked.stack(1)</div>
<div class="line"><span class="lineno"> 1438</span>        expected = ymd.unstack()</div>
<div class="line"><span class="lineno"> 1439</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1440</span> </div>
<div class="line"><span class="lineno"> 1441</span>        result = unstacked.stack(2)</div>
<div class="line"><span class="lineno"> 1442</span>        expected = ymd.unstack(1)</div>
<div class="line"><span class="lineno"> 1443</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1444</span> </div>
<div class="line"><span class="lineno"> 1445</span>        result = unstacked.stack(0)</div>
<div class="line"><span class="lineno"> 1446</span>        expected = ymd.stack().unstack(1).unstack(1)</div>
<div class="line"><span class="lineno"> 1447</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>        <span class="comment"># not all levels present in each echelon</span></div>
<div class="line"><span class="lineno"> 1450</span>        unstacked = ymd.unstack(2).loc[:, ::3]</div>
<div class="line"><span class="lineno"> 1451</span>        stacked = unstacked.stack().stack()</div>
<div class="line"><span class="lineno"> 1452</span>        ymd_stacked = ymd.stack()</div>
<div class="line"><span class="lineno"> 1453</span>        tm.assert_series_equal(stacked, ymd_stacked.reindex(stacked.index))</div>
<div class="line"><span class="lineno"> 1454</span> </div>
<div class="line"><span class="lineno"> 1455</span>        <span class="comment"># stack with negative number</span></div>
<div class="line"><span class="lineno"> 1456</span>        result = ymd.unstack(0).stack(-2)</div>
<div class="line"><span class="lineno"> 1457</span>        expected = ymd.unstack(0).stack(0)</div>
<div class="line"><span class="lineno"> 1458</span>        tm.assert_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1459</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af562738bfe6b36df07c05d93fb66ab3f" name="af562738bfe6b36df07c05d93fb66ab3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af562738bfe6b36df07c05d93fb66ab3f">&#9670;&#160;</a></span>test_stack_dropna()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_dropna </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1801</span>    <span class="keyword">def </span>test_stack_dropna(self):</div>
<div class="line"><span class="lineno"> 1802</span>        <span class="comment"># GH#3997</span></div>
<div class="line"><span class="lineno"> 1803</span>        df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [<span class="stringliteral">&quot;a1&quot;</span>, <span class="stringliteral">&quot;a2&quot;</span>], <span class="stringliteral">&quot;B&quot;</span>: [<span class="stringliteral">&quot;b1&quot;</span>, <span class="stringliteral">&quot;b2&quot;</span>], <span class="stringliteral">&quot;C&quot;</span>: [1, 1]})</div>
<div class="line"><span class="lineno"> 1804</span>        df = df.set_index([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>])</div>
<div class="line"><span class="lineno"> 1805</span> </div>
<div class="line"><span class="lineno"> 1806</span>        stacked = df.unstack().stack(dropna=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1807</span>        <span class="keyword">assert</span> len(stacked) &gt; len(stacked.dropna())</div>
<div class="line"><span class="lineno"> 1808</span> </div>
<div class="line"><span class="lineno"> 1809</span>        stacked = df.unstack().stack(dropna=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1810</span>        tm.assert_frame_equal(stacked, stacked.dropna())</div>
<div class="line"><span class="lineno"> 1811</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b0c69608422d9ce055873706e5f5b51" name="a0b0c69608422d9ce055873706e5f5b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b0c69608422d9ce055873706e5f5b51">&#9670;&#160;</a></span>test_stack_duplicate_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_duplicate_index </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exp_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1496</span>    <span class="keyword">def </span>test_stack_duplicate_index(self, idx, columns, exp_idx):</div>
<div class="line"><span class="lineno"> 1497</span>        <span class="comment"># GH10417</span></div>
<div class="line"><span class="lineno"> 1498</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 1499</span>            np.arange(12).reshape(4, 3),</div>
<div class="line"><span class="lineno"> 1500</span>            index=idx,</div>
<div class="line"><span class="lineno"> 1501</span>            columns=columns,</div>
<div class="line"><span class="lineno"> 1502</span>        )</div>
<div class="line"><span class="lineno"> 1503</span>        result = df.stack()</div>
<div class="line"><span class="lineno"> 1504</span>        expected = Series(np.arange(12), index=exp_idx)</div>
<div class="line"><span class="lineno"> 1505</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1506</span>        <span class="keyword">assert</span> result.index.is_unique <span class="keywordflow">is</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1507</span>        li, ri = result.index, expected.index</div>
<div class="line"><span class="lineno"> 1508</span>        tm.assert_index_equal(li, ri)</div>
<div class="line"><span class="lineno"> 1509</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af35e7f9804622edc2e7525035c57c247" name="af35e7f9804622edc2e7525035c57c247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af35e7f9804622edc2e7525035c57c247">&#9670;&#160;</a></span>test_stack_level_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_level_name </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1598</span>    <span class="keyword">def </span>test_stack_level_name(self, multiindex_dataframe_random_data):</div>
<div class="line"><span class="lineno"> 1599</span>        frame = multiindex_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1600</span> </div>
<div class="line"><span class="lineno"> 1601</span>        unstacked = frame.unstack(<span class="stringliteral">&quot;second&quot;</span>)</div>
<div class="line"><span class="lineno"> 1602</span>        result = unstacked.stack(<span class="stringliteral">&quot;exp&quot;</span>)</div>
<div class="line"><span class="lineno"> 1603</span>        expected = frame.unstack().stack(0)</div>
<div class="line"><span class="lineno"> 1604</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1605</span> </div>
<div class="line"><span class="lineno"> 1606</span>        result = frame.stack(<span class="stringliteral">&quot;exp&quot;</span>)</div>
<div class="line"><span class="lineno"> 1607</span>        expected = frame.stack()</div>
<div class="line"><span class="lineno"> 1608</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1609</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a432f7f0d4a0d4e25fe0706416672d8" name="a5a432f7f0d4a0d4e25fe0706416672d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a432f7f0d4a0d4e25fe0706416672d8">&#9670;&#160;</a></span>test_stack_mixed_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_mixed_dtype </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1532</span>    <span class="keyword">def </span>test_stack_mixed_dtype(self, multiindex_dataframe_random_data):</div>
<div class="line"><span class="lineno"> 1533</span>        frame = multiindex_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1534</span> </div>
<div class="line"><span class="lineno"> 1535</span>        df = frame.T</div>
<div class="line"><span class="lineno"> 1536</span>        df[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;four&quot;</span>] = <span class="stringliteral">&quot;foo&quot;</span></div>
<div class="line"><span class="lineno"> 1537</span>        df = df.sort_index(level=1, axis=1)</div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>        stacked = df.stack()</div>
<div class="line"><span class="lineno"> 1540</span>        result = df[<span class="stringliteral">&quot;foo&quot;</span>].stack().sort_index()</div>
<div class="line"><span class="lineno"> 1541</span>        tm.assert_series_equal(stacked[<span class="stringliteral">&quot;foo&quot;</span>], result, check_names=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1542</span>        <span class="keyword">assert</span> result.name <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1543</span>        <span class="keyword">assert</span> stacked[<span class="stringliteral">&quot;bar&quot;</span>].dtype == np.float_</div>
<div class="line"><span class="lineno"> 1544</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab9f439a846228c499b2e860f26cbd508" name="ab9f439a846228c499b2e860f26cbd508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9f439a846228c499b2e860f26cbd508">&#9670;&#160;</a></span>test_stack_multiple_bug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_multiple_bug </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1781</span>    <span class="keyword">def </span>test_stack_multiple_bug(self):</div>
<div class="line"><span class="lineno"> 1782</span>        <span class="comment"># bug when some uniques are not present in the data GH#3170</span></div>
<div class="line"><span class="lineno"> 1783</span>        id_col = ([1] * 3) + ([2] * 3)</div>
<div class="line"><span class="lineno"> 1784</span>        name = ([<span class="stringliteral">&quot;a&quot;</span>] * 3) + ([<span class="stringliteral">&quot;b&quot;</span>] * 3)</div>
<div class="line"><span class="lineno"> 1785</span>        date = pd.to_datetime([<span class="stringliteral">&quot;2013-01-03&quot;</span>, <span class="stringliteral">&quot;2013-01-04&quot;</span>, <span class="stringliteral">&quot;2013-01-05&quot;</span>] * 2)</div>
<div class="line"><span class="lineno"> 1786</span>        var1 = np.random.randint(0, 100, 6)</div>
<div class="line"><span class="lineno"> 1787</span>        df = DataFrame({<span class="stringliteral">&quot;ID&quot;</span>: id_col, <span class="stringliteral">&quot;NAME&quot;</span>: name, <span class="stringliteral">&quot;DATE&quot;</span>: date, <span class="stringliteral">&quot;VAR1&quot;</span>: var1})</div>
<div class="line"><span class="lineno"> 1788</span> </div>
<div class="line"><span class="lineno"> 1789</span>        multi = df.set_index([<span class="stringliteral">&quot;DATE&quot;</span>, <span class="stringliteral">&quot;ID&quot;</span>])</div>
<div class="line"><span class="lineno"> 1790</span>        multi.columns.name = <span class="stringliteral">&quot;Params&quot;</span></div>
<div class="line"><span class="lineno"> 1791</span>        unst = multi.unstack(<span class="stringliteral">&quot;ID&quot;</span>)</div>
<div class="line"><span class="lineno"> 1792</span>        msg = <span class="stringliteral">&quot;The default value of numeric_only&quot;</span></div>
<div class="line"><span class="lineno"> 1793</span>        <span class="keyword">with</span> tm.assert_produces_warning(FutureWarning, match=msg):</div>
<div class="line"><span class="lineno"> 1794</span>            down = unst.resample(<span class="stringliteral">&quot;W-THU&quot;</span>).mean()</div>
<div class="line"><span class="lineno"> 1795</span> </div>
<div class="line"><span class="lineno"> 1796</span>        rs = down.stack(<span class="stringliteral">&quot;ID&quot;</span>)</div>
<div class="line"><span class="lineno"> 1797</span>        xp = unst.loc[:, [<span class="stringliteral">&quot;VAR1&quot;</span>]].resample(<span class="stringliteral">&quot;W-THU&quot;</span>).mean().stack(<span class="stringliteral">&quot;ID&quot;</span>)</div>
<div class="line"><span class="lineno"> 1798</span>        xp.columns.name = <span class="stringliteral">&quot;Params&quot;</span></div>
<div class="line"><span class="lineno"> 1799</span>        tm.assert_frame_equal(rs, xp)</div>
<div class="line"><span class="lineno"> 1800</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a40c3d520712f420371e156e1bfc70cc0" name="a40c3d520712f420371e156e1bfc70cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40c3d520712f420371e156e1bfc70cc0">&#9670;&#160;</a></span>test_stack_multiple_out_of_bounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_multiple_out_of_bounds </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_year_month_day_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1654</span>    ):</div>
<div class="line"><span class="lineno"> 1655</span>        <span class="comment"># nlevels == 3</span></div>
<div class="line"><span class="lineno"> 1656</span>        ymd = multiindex_year_month_day_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1657</span> </div>
<div class="line"><span class="lineno"> 1658</span>        unstacked = ymd.unstack([<span class="stringliteral">&quot;year&quot;</span>, <span class="stringliteral">&quot;month&quot;</span>])</div>
<div class="line"><span class="lineno"> 1659</span> </div>
<div class="line"><span class="lineno"> 1660</span>        <span class="keyword">with</span> pytest.raises(IndexError, match=<span class="stringliteral">&quot;Too many levels&quot;</span>):</div>
<div class="line"><span class="lineno"> 1661</span>            unstacked.stack([2, 3])</div>
<div class="line"><span class="lineno"> 1662</span>        <span class="keyword">with</span> pytest.raises(IndexError, match=<span class="stringliteral">&quot;not a valid level number&quot;</span>):</div>
<div class="line"><span class="lineno"> 1663</span>            unstacked.stack([-4, -3])</div>
<div class="line"><span class="lineno"> 1664</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a8c2d0103ceb8b891a6dc136fc83c62" name="a9a8c2d0103ceb8b891a6dc136fc83c62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a8c2d0103ceb8b891a6dc136fc83c62">&#9670;&#160;</a></span>test_stack_names_and_numbers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_names_and_numbers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_year_month_day_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1643</span>    ):</div>
<div class="line"><span class="lineno"> 1644</span>        ymd = multiindex_year_month_day_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1645</span> </div>
<div class="line"><span class="lineno"> 1646</span>        unstacked = ymd.unstack([<span class="stringliteral">&quot;year&quot;</span>, <span class="stringliteral">&quot;month&quot;</span>])</div>
<div class="line"><span class="lineno"> 1647</span> </div>
<div class="line"><span class="lineno"> 1648</span>        <span class="comment"># Can&#39;t use mixture of names and numbers to stack</span></div>
<div class="line"><span class="lineno"> 1649</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;level should contain&quot;</span>):</div>
<div class="line"><span class="lineno"> 1650</span>            unstacked.stack([0, <span class="stringliteral">&quot;month&quot;</span>])</div>
<div class="line"><span class="lineno"> 1651</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af6500b1adac29ab894511d1abd240ca2" name="af6500b1adac29ab894511d1abd240ca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6500b1adac29ab894511d1abd240ca2">&#9670;&#160;</a></span>test_stack_nan_in_multiindex_columns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_nan_in_multiindex_columns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2055</span>    <span class="keyword">def </span>test_stack_nan_in_multiindex_columns(self):</div>
<div class="line"><span class="lineno"> 2056</span>        <span class="comment"># GH#39481</span></div>
<div class="line"><span class="lineno"> 2057</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 2058</span>            np.zeros([1, 5]),</div>
<div class="line"><span class="lineno"> 2059</span>            columns=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno"> 2060</span>                [</div>
<div class="line"><span class="lineno"> 2061</span>                    (0, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>),</div>
<div class="line"><span class="lineno"> 2062</span>                    (0, 2, 0),</div>
<div class="line"><span class="lineno"> 2063</span>                    (0, 2, 1),</div>
<div class="line"><span class="lineno"> 2064</span>                    (0, 3, 0),</div>
<div class="line"><span class="lineno"> 2065</span>                    (0, 3, 1),</div>
<div class="line"><span class="lineno"> 2066</span>                ],</div>
<div class="line"><span class="lineno"> 2067</span>            ),</div>
<div class="line"><span class="lineno"> 2068</span>        )</div>
<div class="line"><span class="lineno"> 2069</span>        result = df.stack(2)</div>
<div class="line"><span class="lineno"> 2070</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 2071</span>            [[0.0, np.nan, np.nan], [np.nan, 0.0, 0.0], [np.nan, 0.0, 0.0]],</div>
<div class="line"><span class="lineno"> 2072</span>            index=Index([(0, <span class="keywordtype">None</span>), (0, 0), (0, 1)]),</div>
<div class="line"><span class="lineno"> 2073</span>            columns=Index([(0, <span class="keywordtype">None</span>), (0, 2), (0, 3)]),</div>
<div class="line"><span class="lineno"> 2074</span>        )</div>
<div class="line"><span class="lineno"> 2075</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2076</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9801b48a7167efe8bc8b499e50f54f9c" name="a9801b48a7167efe8bc8b499e50f54f9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9801b48a7167efe8bc8b499e50f54f9c">&#9670;&#160;</a></span>test_stack_nan_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_nan_level </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2110</span>    <span class="keyword">def </span>test_stack_nan_level(self):</div>
<div class="line"><span class="lineno"> 2111</span>        <span class="comment"># GH 9406</span></div>
<div class="line"><span class="lineno"> 2112</span>        df_nan = DataFrame(</div>
<div class="line"><span class="lineno"> 2113</span>            np.arange(4).reshape(2, 2),</div>
<div class="line"><span class="lineno"> 2114</span>            columns=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno"> 2115</span>                [(<span class="stringliteral">&quot;A&quot;</span>, np.nan), (<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>)], names=[<span class="stringliteral">&quot;Upper&quot;</span>, <span class="stringliteral">&quot;Lower&quot;</span>]</div>
<div class="line"><span class="lineno"> 2116</span>            ),</div>
<div class="line"><span class="lineno"> 2117</span>            index=Index([0, 1], name=<span class="stringliteral">&quot;Num&quot;</span>),</div>
<div class="line"><span class="lineno"> 2118</span>            dtype=np.float64,</div>
<div class="line"><span class="lineno"> 2119</span>        )</div>
<div class="line"><span class="lineno"> 2120</span>        result = df_nan.stack()</div>
<div class="line"><span class="lineno"> 2121</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 2122</span>            [[0.0, np.nan], [np.nan, 1], [2.0, np.nan], [np.nan, 3.0]],</div>
<div class="line"><span class="lineno"> 2123</span>            columns=Index([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], name=<span class="stringliteral">&quot;Upper&quot;</span>),</div>
<div class="line"><span class="lineno"> 2124</span>            index=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno"> 2125</span>                [(0, np.nan), (0, <span class="stringliteral">&quot;b&quot;</span>), (1, np.nan), (1, <span class="stringliteral">&quot;b&quot;</span>)], names=[<span class="stringliteral">&quot;Num&quot;</span>, <span class="stringliteral">&quot;Lower&quot;</span>]</div>
<div class="line"><span class="lineno"> 2126</span>            ),</div>
<div class="line"><span class="lineno"> 2127</span>        )</div>
<div class="line"><span class="lineno"> 2128</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2129</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a76c4273b46e3280252c64851fa12a763" name="a76c4273b46e3280252c64851fa12a763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76c4273b46e3280252c64851fa12a763">&#9670;&#160;</a></span>test_stack_nullable_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_nullable_dtype </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2163</span>    <span class="keyword">def </span>test_stack_nullable_dtype(self):</div>
<div class="line"><span class="lineno"> 2164</span>        <span class="comment"># GH#43561</span></div>
<div class="line"><span class="lineno"> 2165</span>        columns = MultiIndex.from_product(</div>
<div class="line"><span class="lineno"> 2166</span>            [[<span class="stringliteral">&quot;54511&quot;</span>, <span class="stringliteral">&quot;54515&quot;</span>], [<span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;t_mean&quot;</span>]], names=[<span class="stringliteral">&quot;station&quot;</span>, <span class="stringliteral">&quot;element&quot;</span>]</div>
<div class="line"><span class="lineno"> 2167</span>        )</div>
<div class="line"><span class="lineno"> 2168</span>        index = Index([1, 2, 3], name=<span class="stringliteral">&quot;time&quot;</span>)</div>
<div class="line"><span class="lineno"> 2169</span> </div>
<div class="line"><span class="lineno"> 2170</span>        arr = np.array([[50, 226, 10, 215], [10, 215, 9, 220], [305, 232, 111, 220]])</div>
<div class="line"><span class="lineno"> 2171</span>        df = DataFrame(arr, columns=columns, index=index, dtype=pd.Int64Dtype())</div>
<div class="line"><span class="lineno"> 2172</span> </div>
<div class="line"><span class="lineno"> 2173</span>        result = df.stack(<span class="stringliteral">&quot;station&quot;</span>)</div>
<div class="line"><span class="lineno"> 2174</span> </div>
<div class="line"><span class="lineno"> 2175</span>        expected = df.astype(np.int64).stack(<span class="stringliteral">&quot;station&quot;</span>).astype(pd.Int64Dtype())</div>
<div class="line"><span class="lineno"> 2176</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2177</span> </div>
<div class="line"><span class="lineno"> 2178</span>        <span class="comment"># non-homogeneous case</span></div>
<div class="line"><span class="lineno"> 2179</span>        df[df.columns[0]] = df[df.columns[0]].astype(pd.Float64Dtype())</div>
<div class="line"><span class="lineno"> 2180</span>        result = df.stack(<span class="stringliteral">&quot;station&quot;</span>)</div>
<div class="line"><span class="lineno"> 2181</span> </div>
<div class="line"><span class="lineno"> 2182</span>        <span class="comment"># TODO(EA2D): we get object dtype because DataFrame.values can&#39;t</span></div>
<div class="line"><span class="lineno"> 2183</span>        <span class="comment">#  be an EA</span></div>
<div class="line"><span class="lineno"> 2184</span>        expected = df.astype(object).stack(<span class="stringliteral">&quot;station&quot;</span>)</div>
<div class="line"><span class="lineno"> 2185</span>        tm.assert_frame_equal(result, expected)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af50da6fdb76943b8ccf2856a8aa990b1" name="af50da6fdb76943b8ccf2856a8aa990b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af50da6fdb76943b8ccf2856a8aa990b1">&#9670;&#160;</a></span>test_stack_order_with_unsorted_levels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_order_with_unsorted_levels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stack_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1894</span>    <span class="keyword">def </span>test_stack_order_with_unsorted_levels(self, levels, stack_lev):</div>
<div class="line"><span class="lineno"> 1895</span>        <span class="comment"># GH#16323</span></div>
<div class="line"><span class="lineno"> 1896</span>        <span class="comment"># deep check for 1-row case</span></div>
<div class="line"><span class="lineno"> 1897</span>        columns = MultiIndex(levels=levels, codes=[[0, 0, 1, 1], [0, 1, 0, 1]])</div>
<div class="line"><span class="lineno"> 1898</span>        df = DataFrame(columns=columns, data=[range(4)])</div>
<div class="line"><span class="lineno"> 1899</span>        df_stacked = df.stack(stack_lev)</div>
<div class="line"><span class="lineno"> 1900</span>        <span class="keyword">assert</span> all(</div>
<div class="line"><span class="lineno"> 1901</span>            df.loc[row, col]</div>
<div class="line"><span class="lineno"> 1902</span>            == df_stacked.loc[(row, col[stack_lev]), col[1 - stack_lev]]</div>
<div class="line"><span class="lineno"> 1903</span>            <span class="keywordflow">for</span> row <span class="keywordflow">in</span> df.index</div>
<div class="line"><span class="lineno"> 1904</span>            <span class="keywordflow">for</span> col <span class="keywordflow">in</span> df.columns</div>
<div class="line"><span class="lineno"> 1905</span>        )</div>
<div class="line"><span class="lineno"> 1906</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1cb40764a1deba3b505ecc252b4bcb4" name="aa1cb40764a1deba3b505ecc252b4bcb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1cb40764a1deba3b505ecc252b4bcb4">&#9670;&#160;</a></span>test_stack_order_with_unsorted_levels_multi_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_order_with_unsorted_levels_multi_row </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1907</span>    <span class="keyword">def </span>test_stack_order_with_unsorted_levels_multi_row(self):</div>
<div class="line"><span class="lineno"> 1908</span>        <span class="comment"># GH#16323</span></div>
<div class="line"><span class="lineno"> 1909</span> </div>
<div class="line"><span class="lineno"> 1910</span>        <span class="comment"># check multi-row case</span></div>
<div class="line"><span class="lineno"> 1911</span>        mi = MultiIndex(</div>
<div class="line"><span class="lineno"> 1912</span>            levels=[[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], [<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>]],</div>
<div class="line"><span class="lineno"> 1913</span>            codes=[np.repeat(range(3), 3), np.tile(range(3), 3)],</div>
<div class="line"><span class="lineno"> 1914</span>        )</div>
<div class="line"><span class="lineno"> 1915</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 1916</span>            columns=mi, index=range(5), data=np.arange(5 * len(mi)).reshape(5, -1)</div>
<div class="line"><span class="lineno"> 1917</span>        )</div>
<div class="line"><span class="lineno"> 1918</span>        <span class="keyword">assert</span> all(</div>
<div class="line"><span class="lineno"> 1919</span>            df.loc[row, col] == df.stack(0).loc[(row, col[0]), col[1]]</div>
<div class="line"><span class="lineno"> 1920</span>            <span class="keywordflow">for</span> row <span class="keywordflow">in</span> df.index</div>
<div class="line"><span class="lineno"> 1921</span>            <span class="keywordflow">for</span> col <span class="keywordflow">in</span> df.columns</div>
<div class="line"><span class="lineno"> 1922</span>        )</div>
<div class="line"><span class="lineno"> 1923</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8dca6dd6ec614a7dd93fe82f89eefd1a" name="a8dca6dd6ec614a7dd93fe82f89eefd1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dca6dd6ec614a7dd93fe82f89eefd1a">&#9670;&#160;</a></span>test_stack_unsorted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_unsorted </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2145</span>    <span class="keyword">def </span>test_stack_unsorted(self):</div>
<div class="line"><span class="lineno"> 2146</span>        <span class="comment"># GH 16925</span></div>
<div class="line"><span class="lineno"> 2147</span>        PAE = [<span class="stringliteral">&quot;ITA&quot;</span>, <span class="stringliteral">&quot;FRA&quot;</span>]</div>
<div class="line"><span class="lineno"> 2148</span>        VAR = [<span class="stringliteral">&quot;A1&quot;</span>, <span class="stringliteral">&quot;A2&quot;</span>]</div>
<div class="line"><span class="lineno"> 2149</span>        TYP = [<span class="stringliteral">&quot;CRT&quot;</span>, <span class="stringliteral">&quot;DBT&quot;</span>, <span class="stringliteral">&quot;NET&quot;</span>]</div>
<div class="line"><span class="lineno"> 2150</span>        MI = MultiIndex.from_product([PAE, VAR, TYP], names=[<span class="stringliteral">&quot;PAE&quot;</span>, <span class="stringliteral">&quot;VAR&quot;</span>, <span class="stringliteral">&quot;TYP&quot;</span>])</div>
<div class="line"><span class="lineno"> 2151</span> </div>
<div class="line"><span class="lineno"> 2152</span>        V = list(range(len(MI)))</div>
<div class="line"><span class="lineno"> 2153</span>        DF = DataFrame(data=V, index=MI, columns=[<span class="stringliteral">&quot;VALUE&quot;</span>])</div>
<div class="line"><span class="lineno"> 2154</span> </div>
<div class="line"><span class="lineno"> 2155</span>        DF = DF.unstack([<span class="stringliteral">&quot;VAR&quot;</span>, <span class="stringliteral">&quot;TYP&quot;</span>])</div>
<div class="line"><span class="lineno"> 2156</span>        DF.columns = DF.columns.droplevel(0)</div>
<div class="line"><span class="lineno"> 2157</span>        DF.loc[:, (<span class="stringliteral">&quot;A0&quot;</span>, <span class="stringliteral">&quot;NET&quot;</span>)] = 9999</div>
<div class="line"><span class="lineno"> 2158</span> </div>
<div class="line"><span class="lineno"> 2159</span>        result = DF.stack([<span class="stringliteral">&quot;VAR&quot;</span>, <span class="stringliteral">&quot;TYP&quot;</span>]).sort_index()</div>
<div class="line"><span class="lineno"> 2160</span>        expected = DF.sort_index(axis=1).stack([<span class="stringliteral">&quot;VAR&quot;</span>, <span class="stringliteral">&quot;TYP&quot;</span>]).sort_index()</div>
<div class="line"><span class="lineno"> 2161</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2162</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2316247beb5fa7cfd6ded3ed104c5679" name="a2316247beb5fa7cfd6ded3ed104c5679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2316247beb5fa7cfd6ded3ed104c5679">&#9670;&#160;</a></span>test_stack_unstack_multiple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_unstack_multiple </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_year_month_day_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1612</span>    ):</div>
<div class="line"><span class="lineno"> 1613</span>        ymd = multiindex_year_month_day_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1614</span> </div>
<div class="line"><span class="lineno"> 1615</span>        unstacked = ymd.unstack([<span class="stringliteral">&quot;year&quot;</span>, <span class="stringliteral">&quot;month&quot;</span>])</div>
<div class="line"><span class="lineno"> 1616</span>        expected = ymd.unstack(<span class="stringliteral">&quot;year&quot;</span>).unstack(<span class="stringliteral">&quot;month&quot;</span>)</div>
<div class="line"><span class="lineno"> 1617</span>        tm.assert_frame_equal(unstacked, expected)</div>
<div class="line"><span class="lineno"> 1618</span>        <span class="keyword">assert</span> unstacked.columns.names == expected.columns.names</div>
<div class="line"><span class="lineno"> 1619</span> </div>
<div class="line"><span class="lineno"> 1620</span>        <span class="comment"># series</span></div>
<div class="line"><span class="lineno"> 1621</span>        s = ymd[<span class="stringliteral">&quot;A&quot;</span>]</div>
<div class="line"><span class="lineno"> 1622</span>        s_unstacked = s.unstack([<span class="stringliteral">&quot;year&quot;</span>, <span class="stringliteral">&quot;month&quot;</span>])</div>
<div class="line"><span class="lineno"> 1623</span>        tm.assert_frame_equal(s_unstacked, expected[<span class="stringliteral">&quot;A&quot;</span>])</div>
<div class="line"><span class="lineno"> 1624</span> </div>
<div class="line"><span class="lineno"> 1625</span>        restacked = unstacked.stack([<span class="stringliteral">&quot;year&quot;</span>, <span class="stringliteral">&quot;month&quot;</span>])</div>
<div class="line"><span class="lineno"> 1626</span>        restacked = restacked.swaplevel(0, 1).swaplevel(1, 2)</div>
<div class="line"><span class="lineno"> 1627</span>        restacked = restacked.sort_index(level=0)</div>
<div class="line"><span class="lineno"> 1628</span> </div>
<div class="line"><span class="lineno"> 1629</span>        tm.assert_frame_equal(restacked, ymd)</div>
<div class="line"><span class="lineno"> 1630</span>        <span class="keyword">assert</span> restacked.index.names == ymd.index.names</div>
<div class="line"><span class="lineno"> 1631</span> </div>
<div class="line"><span class="lineno"> 1632</span>        <span class="comment"># GH #451</span></div>
<div class="line"><span class="lineno"> 1633</span>        unstacked = ymd.unstack([1, 2])</div>
<div class="line"><span class="lineno"> 1634</span>        expected = ymd.unstack(1).unstack(1).dropna(axis=1, how=<span class="stringliteral">&quot;all&quot;</span>)</div>
<div class="line"><span class="lineno"> 1635</span>        tm.assert_frame_equal(unstacked, expected)</div>
<div class="line"><span class="lineno"> 1636</span> </div>
<div class="line"><span class="lineno"> 1637</span>        unstacked = ymd.unstack([2, 1])</div>
<div class="line"><span class="lineno"> 1638</span>        expected = ymd.unstack(2).unstack(1).dropna(axis=1, how=<span class="stringliteral">&quot;all&quot;</span>)</div>
<div class="line"><span class="lineno"> 1639</span>        tm.assert_frame_equal(unstacked, expected.loc[:, unstacked.columns])</div>
<div class="line"><span class="lineno"> 1640</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a27006d634dba060f7b5856a991d880ab" name="a27006d634dba060f7b5856a991d880ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27006d634dba060f7b5856a991d880ab">&#9670;&#160;</a></span>test_stack_unstack_preserve_names()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_unstack_preserve_names </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1562</span>    <span class="keyword">def </span>test_stack_unstack_preserve_names(self, multiindex_dataframe_random_data):</div>
<div class="line"><span class="lineno"> 1563</span>        frame = multiindex_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1564</span> </div>
<div class="line"><span class="lineno"> 1565</span>        unstacked = frame.unstack()</div>
<div class="line"><span class="lineno"> 1566</span>        <span class="keyword">assert</span> unstacked.index.name == <span class="stringliteral">&quot;first&quot;</span></div>
<div class="line"><span class="lineno"> 1567</span>        <span class="keyword">assert</span> unstacked.columns.names == [<span class="stringliteral">&quot;exp&quot;</span>, <span class="stringliteral">&quot;second&quot;</span>]</div>
<div class="line"><span class="lineno"> 1568</span> </div>
<div class="line"><span class="lineno"> 1569</span>        restacked = unstacked.stack()</div>
<div class="line"><span class="lineno"> 1570</span>        <span class="keyword">assert</span> restacked.index.names == frame.index.names</div>
<div class="line"><span class="lineno"> 1571</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ab7165b6e2ace310f48637b289b7f28" name="a3ab7165b6e2ace310f48637b289b7f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ab7165b6e2ace310f48637b289b7f28">&#9670;&#160;</a></span>test_stack_unstack_unordered_multiindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_unstack_unordered_multiindex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1924</span>    <span class="keyword">def </span>test_stack_unstack_unordered_multiindex(self):</div>
<div class="line"><span class="lineno"> 1925</span>        <span class="comment"># GH# 18265</span></div>
<div class="line"><span class="lineno"> 1926</span>        values = np.arange(5)</div>
<div class="line"><span class="lineno"> 1927</span>        data = np.vstack(</div>
<div class="line"><span class="lineno"> 1928</span>            [</div>
<div class="line"><span class="lineno"> 1929</span>                [f<span class="stringliteral">&quot;b{x}&quot;</span> <span class="keywordflow">for</span> x <span class="keywordflow">in</span> values],  <span class="comment"># b0, b1, ..</span></div>
<div class="line"><span class="lineno"> 1930</span>                [f<span class="stringliteral">&quot;a{x}&quot;</span> <span class="keywordflow">for</span> x <span class="keywordflow">in</span> values],  <span class="comment"># a0, a1, ..</span></div>
<div class="line"><span class="lineno"> 1931</span>            ]</div>
<div class="line"><span class="lineno"> 1932</span>        )</div>
<div class="line"><span class="lineno"> 1933</span>        df = DataFrame(data.T, columns=[<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>])</div>
<div class="line"><span class="lineno"> 1934</span>        df.columns.name = <span class="stringliteral">&quot;first&quot;</span></div>
<div class="line"><span class="lineno"> 1935</span>        second_level_dict = {<span class="stringliteral">&quot;x&quot;</span>: df}</div>
<div class="line"><span class="lineno"> 1936</span>        multi_level_df = pd.concat(second_level_dict, axis=1)</div>
<div class="line"><span class="lineno"> 1937</span>        multi_level_df.columns.names = [<span class="stringliteral">&quot;second&quot;</span>, <span class="stringliteral">&quot;first&quot;</span>]</div>
<div class="line"><span class="lineno"> 1938</span>        df = multi_level_df.reindex(sorted(multi_level_df.columns), axis=1)</div>
<div class="line"><span class="lineno"> 1939</span>        result = df.stack([<span class="stringliteral">&quot;first&quot;</span>, <span class="stringliteral">&quot;second&quot;</span>]).unstack([<span class="stringliteral">&quot;first&quot;</span>, <span class="stringliteral">&quot;second&quot;</span>])</div>
<div class="line"><span class="lineno"> 1940</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1941</span>            [[<span class="stringliteral">&quot;a0&quot;</span>, <span class="stringliteral">&quot;b0&quot;</span>], [<span class="stringliteral">&quot;a1&quot;</span>, <span class="stringliteral">&quot;b1&quot;</span>], [<span class="stringliteral">&quot;a2&quot;</span>, <span class="stringliteral">&quot;b2&quot;</span>], [<span class="stringliteral">&quot;a3&quot;</span>, <span class="stringliteral">&quot;b3&quot;</span>], [<span class="stringliteral">&quot;a4&quot;</span>, <span class="stringliteral">&quot;b4&quot;</span>]],</div>
<div class="line"><span class="lineno"> 1942</span>            index=[0, 1, 2, 3, 4],</div>
<div class="line"><span class="lineno"> 1943</span>            columns=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno"> 1944</span>                [(<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>), (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>)], names=[<span class="stringliteral">&quot;first&quot;</span>, <span class="stringliteral">&quot;second&quot;</span>]</div>
<div class="line"><span class="lineno"> 1945</span>            ),</div>
<div class="line"><span class="lineno"> 1946</span>        )</div>
<div class="line"><span class="lineno"> 1947</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1948</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac272168b80055f54d22f9c0e646d61fd" name="ac272168b80055f54d22f9c0e646d61fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac272168b80055f54d22f9c0e646d61fd">&#9670;&#160;</a></span>test_stack_unstack_wrong_level_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_stack_unstack_wrong_level_name </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1575</span>    ):</div>
<div class="line"><span class="lineno"> 1576</span>        <span class="comment"># GH 18303 - wrong level name should raise</span></div>
<div class="line"><span class="lineno"> 1577</span>        frame = multiindex_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1578</span> </div>
<div class="line"><span class="lineno"> 1579</span>        <span class="comment"># A DataFrame with flat axes:</span></div>
<div class="line"><span class="lineno"> 1580</span>        df = frame.loc[<span class="stringliteral">&quot;foo&quot;</span>]</div>
<div class="line"><span class="lineno"> 1581</span> </div>
<div class="line"><span class="lineno"> 1582</span>        <span class="keyword">with</span> pytest.raises(KeyError, match=<span class="stringliteral">&quot;does not match index name&quot;</span>):</div>
<div class="line"><span class="lineno"> 1583</span>            getattr(df, method)(<span class="stringliteral">&quot;mistake&quot;</span>)</div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span>        <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;unstack&quot;</span>:</div>
<div class="line"><span class="lineno"> 1586</span>            <span class="comment"># Same on a Series:</span></div>
<div class="line"><span class="lineno"> 1587</span>            s = df.iloc[:, 0]</div>
<div class="line"><span class="lineno"> 1588</span>            <span class="keyword">with</span> pytest.raises(KeyError, match=<span class="stringliteral">&quot;does not match index name&quot;</span>):</div>
<div class="line"><span class="lineno"> 1589</span>                getattr(s, method)(<span class="stringliteral">&quot;mistake&quot;</span>)</div>
<div class="line"><span class="lineno"> 1590</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a648ab3828dba2dd37f098ffc1df01f52" name="a648ab3828dba2dd37f098ffc1df01f52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a648ab3828dba2dd37f098ffc1df01f52">&#9670;&#160;</a></span>test_unstack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_year_month_day_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1337</span>    <span class="keyword">def </span>test_unstack(self, multiindex_year_month_day_dataframe_random_data):</div>
<div class="line"><span class="lineno"> 1338</span>        <span class="comment"># just check that it works for now</span></div>
<div class="line"><span class="lineno"> 1339</span>        ymd = multiindex_year_month_day_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>        unstacked = ymd.unstack()</div>
<div class="line"><span class="lineno"> 1342</span>        unstacked.unstack()</div>
<div class="line"><span class="lineno"> 1343</span> </div>
<div class="line"><span class="lineno"> 1344</span>        <span class="comment"># test that ints work</span></div>
<div class="line"><span class="lineno"> 1345</span>        ymd.astype(int).unstack()</div>
<div class="line"><span class="lineno"> 1346</span> </div>
<div class="line"><span class="lineno"> 1347</span>        <span class="comment"># test that int32 work</span></div>
<div class="line"><span class="lineno"> 1348</span>        ymd.astype(np.int32).unstack()</div>
<div class="line"><span class="lineno"> 1349</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a26de54179010e89c0e014e086c6b8994" name="a26de54179010e89c0e014e086c6b8994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26de54179010e89c0e014e086c6b8994">&#9670;&#160;</a></span>test_unstack_bug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_bug </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1545</span>    <span class="keyword">def </span>test_unstack_bug(self):</div>
<div class="line"><span class="lineno"> 1546</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 1547</span>            {</div>
<div class="line"><span class="lineno"> 1548</span>                <span class="stringliteral">&quot;state&quot;</span>: [<span class="stringliteral">&quot;naive&quot;</span>, <span class="stringliteral">&quot;naive&quot;</span>, <span class="stringliteral">&quot;naive&quot;</span>, <span class="stringliteral">&quot;active&quot;</span>, <span class="stringliteral">&quot;active&quot;</span>, <span class="stringliteral">&quot;active&quot;</span>],</div>
<div class="line"><span class="lineno"> 1549</span>                <span class="stringliteral">&quot;exp&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>],</div>
<div class="line"><span class="lineno"> 1550</span>                <span class="stringliteral">&quot;barcode&quot;</span>: [1, 2, 3, 4, 1, 3],</div>
<div class="line"><span class="lineno"> 1551</span>                <span class="stringliteral">&quot;v&quot;</span>: [<span class="stringliteral">&quot;hi&quot;</span>, <span class="stringliteral">&quot;hi&quot;</span>, <span class="stringliteral">&quot;bye&quot;</span>, <span class="stringliteral">&quot;bye&quot;</span>, <span class="stringliteral">&quot;bye&quot;</span>, <span class="stringliteral">&quot;peace&quot;</span>],</div>
<div class="line"><span class="lineno"> 1552</span>                <span class="stringliteral">&quot;extra&quot;</span>: np.arange(6.0),</div>
<div class="line"><span class="lineno"> 1553</span>            }</div>
<div class="line"><span class="lineno"> 1554</span>        )</div>
<div class="line"><span class="lineno"> 1555</span> </div>
<div class="line"><span class="lineno"> 1556</span>        result = df.groupby([<span class="stringliteral">&quot;state&quot;</span>, <span class="stringliteral">&quot;exp&quot;</span>, <span class="stringliteral">&quot;barcode&quot;</span>, <span class="stringliteral">&quot;v&quot;</span>]).apply(len)</div>
<div class="line"><span class="lineno"> 1557</span> </div>
<div class="line"><span class="lineno"> 1558</span>        unstacked = result.unstack()</div>
<div class="line"><span class="lineno"> 1559</span>        restacked = unstacked.stack()</div>
<div class="line"><span class="lineno"> 1560</span>        tm.assert_series_equal(restacked, result.reindex(restacked.index).astype(float))</div>
<div class="line"><span class="lineno"> 1561</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab943091a4f562bf850120a934dc8b5fc" name="ab943091a4f562bf850120a934dc8b5fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab943091a4f562bf850120a934dc8b5fc">&#9670;&#160;</a></span>test_unstack_categorical_columns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_categorical_columns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2130</span>    <span class="keyword">def </span>test_unstack_categorical_columns(self):</div>
<div class="line"><span class="lineno"> 2131</span>        <span class="comment"># GH 14018</span></div>
<div class="line"><span class="lineno"> 2132</span>        idx = MultiIndex.from_product([[<span class="stringliteral">&quot;A&quot;</span>], [0, 1]])</div>
<div class="line"><span class="lineno"> 2133</span>        df = DataFrame({<span class="stringliteral">&quot;cat&quot;</span>: pd.Categorical([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>])}, index=idx)</div>
<div class="line"><span class="lineno"> 2134</span>        result = df.unstack()</div>
<div class="line"><span class="lineno"> 2135</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 2136</span>            {</div>
<div class="line"><span class="lineno"> 2137</span>                0: pd.Categorical([<span class="stringliteral">&quot;a&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>]),</div>
<div class="line"><span class="lineno"> 2138</span>                1: pd.Categorical([<span class="stringliteral">&quot;b&quot;</span>], categories=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>]),</div>
<div class="line"><span class="lineno"> 2139</span>            },</div>
<div class="line"><span class="lineno"> 2140</span>            index=[<span class="stringliteral">&quot;A&quot;</span>],</div>
<div class="line"><span class="lineno"> 2141</span>        )</div>
<div class="line"><span class="lineno"> 2142</span>        expected.columns = MultiIndex.from_tuples([(<span class="stringliteral">&quot;cat&quot;</span>, 0), (<span class="stringliteral">&quot;cat&quot;</span>, 1)])</div>
<div class="line"><span class="lineno"> 2143</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2144</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1448f41f7418e529693f7c4fb4e57fe5" name="a1448f41f7418e529693f7c4fb4e57fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1448f41f7418e529693f7c4fb4e57fe5">&#9670;&#160;</a></span>test_unstack_group_index_overflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_group_index_overflow </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1962</span>    <span class="keyword">def </span>test_unstack_group_index_overflow(self):</div>
<div class="line"><span class="lineno"> 1963</span>        codes = np.tile(np.arange(500), 2)</div>
<div class="line"><span class="lineno"> 1964</span>        level = np.arange(500)</div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span>        index = MultiIndex(</div>
<div class="line"><span class="lineno"> 1967</span>            levels=[level] * 8 + [[0, 1]],</div>
<div class="line"><span class="lineno"> 1968</span>            codes=[codes] * 8 + [np.arange(2).repeat(500)],</div>
<div class="line"><span class="lineno"> 1969</span>        )</div>
<div class="line"><span class="lineno"> 1970</span> </div>
<div class="line"><span class="lineno"> 1971</span>        s = Series(np.arange(1000), index=index)</div>
<div class="line"><span class="lineno"> 1972</span>        result = s.unstack()</div>
<div class="line"><span class="lineno"> 1973</span>        <span class="keyword">assert</span> result.shape == (500, 2)</div>
<div class="line"><span class="lineno"> 1974</span> </div>
<div class="line"><span class="lineno"> 1975</span>        <span class="comment"># test roundtrip</span></div>
<div class="line"><span class="lineno"> 1976</span>        stacked = result.stack()</div>
<div class="line"><span class="lineno"> 1977</span>        tm.assert_series_equal(s, stacked.reindex(s.index))</div>
<div class="line"><span class="lineno"> 1978</span> </div>
<div class="line"><span class="lineno"> 1979</span>        <span class="comment"># put it at beginning</span></div>
<div class="line"><span class="lineno"> 1980</span>        index = MultiIndex(</div>
<div class="line"><span class="lineno"> 1981</span>            levels=[[0, 1]] + [level] * 8,</div>
<div class="line"><span class="lineno"> 1982</span>            codes=[np.arange(2).repeat(500)] + [codes] * 8,</div>
<div class="line"><span class="lineno"> 1983</span>        )</div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span>        s = Series(np.arange(1000), index=index)</div>
<div class="line"><span class="lineno"> 1986</span>        result = s.unstack(0)</div>
<div class="line"><span class="lineno"> 1987</span>        <span class="keyword">assert</span> result.shape == (500, 2)</div>
<div class="line"><span class="lineno"> 1988</span> </div>
<div class="line"><span class="lineno"> 1989</span>        <span class="comment"># put it in middle</span></div>
<div class="line"><span class="lineno"> 1990</span>        index = MultiIndex(</div>
<div class="line"><span class="lineno"> 1991</span>            levels=[level] * 4 + [[0, 1]] + [level] * 4,</div>
<div class="line"><span class="lineno"> 1992</span>            codes=([codes] * 4 + [np.arange(2).repeat(500)] + [codes] * 4),</div>
<div class="line"><span class="lineno"> 1993</span>        )</div>
<div class="line"><span class="lineno"> 1994</span> </div>
<div class="line"><span class="lineno"> 1995</span>        s = Series(np.arange(1000), index=index)</div>
<div class="line"><span class="lineno"> 1996</span>        result = s.unstack(4)</div>
<div class="line"><span class="lineno"> 1997</span>        <span class="keyword">assert</span> result.shape == (500, 2)</div>
<div class="line"><span class="lineno"> 1998</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="add7b4ff2a9b5013061f8879d68c84ceb" name="add7b4ff2a9b5013061f8879d68c84ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add7b4ff2a9b5013061f8879d68c84ceb">&#9670;&#160;</a></span>test_unstack_level_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_level_name </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1591</span>    <span class="keyword">def </span>test_unstack_level_name(self, multiindex_dataframe_random_data):</div>
<div class="line"><span class="lineno"> 1592</span>        frame = multiindex_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1593</span> </div>
<div class="line"><span class="lineno"> 1594</span>        result = frame.unstack(<span class="stringliteral">&quot;second&quot;</span>)</div>
<div class="line"><span class="lineno"> 1595</span>        expected = frame.unstack(level=1)</div>
<div class="line"><span class="lineno"> 1596</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1597</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab23dcc2a98d271b235125e9c5497c7a2" name="ab23dcc2a98d271b235125e9c5497c7a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab23dcc2a98d271b235125e9c5497c7a2">&#9670;&#160;</a></span>test_unstack_multiple_hierarchical()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_multiple_hierarchical </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1812</span>    <span class="keyword">def </span>test_unstack_multiple_hierarchical(self):</div>
<div class="line"><span class="lineno"> 1813</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 1814</span>            index=[</div>
<div class="line"><span class="lineno"> 1815</span>                [0, 0, 0, 0, 1, 1, 1, 1],</div>
<div class="line"><span class="lineno"> 1816</span>                [0, 0, 1, 1, 0, 0, 1, 1],</div>
<div class="line"><span class="lineno"> 1817</span>                [0, 1, 0, 1, 0, 1, 0, 1],</div>
<div class="line"><span class="lineno"> 1818</span>            ],</div>
<div class="line"><span class="lineno"> 1819</span>            columns=[[0, 0, 1, 1], [0, 1, 0, 1]],</div>
<div class="line"><span class="lineno"> 1820</span>        )</div>
<div class="line"><span class="lineno"> 1821</span> </div>
<div class="line"><span class="lineno"> 1822</span>        df.index.names = [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]</div>
<div class="line"><span class="lineno"> 1823</span>        df.columns.names = [<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>]</div>
<div class="line"><span class="lineno"> 1824</span> </div>
<div class="line"><span class="lineno"> 1825</span>        <span class="comment"># it works!</span></div>
<div class="line"><span class="lineno"> 1826</span>        df.unstack([<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>])</div>
<div class="line"><span class="lineno"> 1827</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac769d73cf27cf404d03914d814cdf18a" name="ac769d73cf27cf404d03914d814cdf18a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac769d73cf27cf404d03914d814cdf18a">&#9670;&#160;</a></span>test_unstack_multiple_no_empty_columns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_multiple_no_empty_columns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1393</span>    <span class="keyword">def </span>test_unstack_multiple_no_empty_columns(self):</div>
<div class="line"><span class="lineno"> 1394</span>        index = MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno"> 1395</span>            [(0, <span class="stringliteral">&quot;foo&quot;</span>, 0), (0, <span class="stringliteral">&quot;bar&quot;</span>, 0), (1, <span class="stringliteral">&quot;baz&quot;</span>, 1), (1, <span class="stringliteral">&quot;qux&quot;</span>, 1)]</div>
<div class="line"><span class="lineno"> 1396</span>        )</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span>        s = Series(np.random.randn(4), index=index)</div>
<div class="line"><span class="lineno"> 1399</span> </div>
<div class="line"><span class="lineno"> 1400</span>        unstacked = s.unstack([1, 2])</div>
<div class="line"><span class="lineno"> 1401</span>        expected = unstacked.dropna(axis=1, how=<span class="stringliteral">&quot;all&quot;</span>)</div>
<div class="line"><span class="lineno"> 1402</span>        tm.assert_frame_equal(unstacked, expected)</div>
<div class="line"><span class="lineno"> 1403</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a71891597db16b2fbf1a5023e0605b342" name="a71891597db16b2fbf1a5023e0605b342"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71891597db16b2fbf1a5023e0605b342">&#9670;&#160;</a></span>test_unstack_number_of_levels_larger_than_int32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_number_of_levels_larger_than_int32 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>monkeypatch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1865</span>    <span class="keyword">def </span>test_unstack_number_of_levels_larger_than_int32(self, monkeypatch):</div>
<div class="line"><span class="lineno"> 1866</span>        <span class="comment"># GH#20601</span></div>
<div class="line"><span class="lineno"> 1867</span>        <span class="comment"># GH 26314: Change ValueError to PerformanceWarning</span></div>
<div class="line"><span class="lineno"> 1868</span> </div>
<div class="line"><span class="lineno"> 1869</span>        <span class="keyword">class </span>MockUnstacker(reshape_lib._Unstacker):</div>
<div class="line"><span class="lineno"> 1870</span>            <span class="keyword">def </span>__init__(self, *args, **kwargs) -&gt; None:</div>
<div class="line"><span class="lineno"> 1871</span>                <span class="comment"># __init__ will raise the warning</span></div>
<div class="line"><span class="lineno"> 1872</span>                super().__init__(*args, **kwargs)</div>
<div class="line"><span class="lineno"> 1873</span>                <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Don&#39;t compute final result.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1874</span> </div>
<div class="line"><span class="lineno"> 1875</span>        <span class="keyword">with</span> monkeypatch.context() <span class="keyword">as</span> m:</div>
<div class="line"><span class="lineno"> 1876</span>            m.setattr(reshape_lib, <span class="stringliteral">&quot;_Unstacker&quot;</span>, MockUnstacker)</div>
<div class="line"><span class="lineno"> 1877</span>            df = DataFrame(</div>
<div class="line"><span class="lineno"> 1878</span>                np.random.randn(2**16, 2),</div>
<div class="line"><span class="lineno"> 1879</span>                index=[np.arange(2**16), np.arange(2**16)],</div>
<div class="line"><span class="lineno"> 1880</span>            )</div>
<div class="line"><span class="lineno"> 1881</span>            msg = <span class="stringliteral">&quot;The following operation may generate&quot;</span></div>
<div class="line"><span class="lineno"> 1882</span>            <span class="keyword">with</span> tm.assert_produces_warning(PerformanceWarning, match=msg):</div>
<div class="line"><span class="lineno"> 1883</span>                <span class="keyword">with</span> pytest.raises(Exception, match=<span class="stringliteral">&quot;Don&#39;t compute final result.&quot;</span>):</div>
<div class="line"><span class="lineno"> 1884</span>                    df.unstack()</div>
<div class="line"><span class="lineno"> 1885</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fd0afcd1509c27c6ffdb10156347ba1" name="a2fd0afcd1509c27c6ffdb10156347ba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fd0afcd1509c27c6ffdb10156347ba1">&#9670;&#160;</a></span>test_unstack_odd_failure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_odd_failure </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1510</span>    <span class="keyword">def </span>test_unstack_odd_failure(self):</div>
<div class="line"><span class="lineno"> 1511</span>        data = <span class="stringliteral">&quot;&quot;&quot;day,time,smoker,sum,len</span></div>
<div class="line"><span class="lineno"> 1512</span><span class="stringliteral">Fri,Dinner,No,8.25,3.</span></div>
<div class="line"><span class="lineno"> 1513</span><span class="stringliteral">Fri,Dinner,Yes,27.03,9</span></div>
<div class="line"><span class="lineno"> 1514</span><span class="stringliteral">Fri,Lunch,No,3.0,1</span></div>
<div class="line"><span class="lineno"> 1515</span><span class="stringliteral">Fri,Lunch,Yes,13.68,6</span></div>
<div class="line"><span class="lineno"> 1516</span><span class="stringliteral">Sat,Dinner,No,139.63,45</span></div>
<div class="line"><span class="lineno"> 1517</span><span class="stringliteral">Sat,Dinner,Yes,120.77,42</span></div>
<div class="line"><span class="lineno"> 1518</span><span class="stringliteral">Sun,Dinner,No,180.57,57</span></div>
<div class="line"><span class="lineno"> 1519</span><span class="stringliteral">Sun,Dinner,Yes,66.82,19</span></div>
<div class="line"><span class="lineno"> 1520</span><span class="stringliteral">Thu,Dinner,No,3.0,1</span></div>
<div class="line"><span class="lineno"> 1521</span><span class="stringliteral">Thu,Lunch,No,117.32,44</span></div>
<div class="line"><span class="lineno"> 1522</span><span class="stringliteral">Thu,Lunch,Yes,51.51,17&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1523</span> </div>
<div class="line"><span class="lineno"> 1524</span>        df = pd.read_csv(StringIO(data)).set_index([<span class="stringliteral">&quot;day&quot;</span>, <span class="stringliteral">&quot;time&quot;</span>, <span class="stringliteral">&quot;smoker&quot;</span>])</div>
<div class="line"><span class="lineno"> 1525</span> </div>
<div class="line"><span class="lineno"> 1526</span>        <span class="comment"># it works, #2100</span></div>
<div class="line"><span class="lineno"> 1527</span>        result = df.unstack(2)</div>
<div class="line"><span class="lineno"> 1528</span> </div>
<div class="line"><span class="lineno"> 1529</span>        recons = result.stack()</div>
<div class="line"><span class="lineno"> 1530</span>        tm.assert_frame_equal(recons, df)</div>
<div class="line"><span class="lineno"> 1531</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d5b2bb57575b23dbf91147d122a2678" name="a9d5b2bb57575b23dbf91147d122a2678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d5b2bb57575b23dbf91147d122a2678">&#9670;&#160;</a></span>test_unstack_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_partial </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result_columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index_product</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_row</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1375</span>    ):</div>
<div class="line"><span class="lineno"> 1376</span>        <span class="comment"># check for regressions on this issue:</span></div>
<div class="line"><span class="lineno"> 1377</span>        <span class="comment"># https://github.com/pandas-dev/pandas/issues/19351</span></div>
<div class="line"><span class="lineno"> 1378</span>        <span class="comment"># make sure DataFrame.unstack() works when its run on a subset of the DataFrame</span></div>
<div class="line"><span class="lineno"> 1379</span>        <span class="comment"># and the Index levels contain values that are not present in the subset</span></div>
<div class="line"><span class="lineno"> 1380</span>        result = DataFrame(result_rows, columns=result_columns).set_index(</div>
<div class="line"><span class="lineno"> 1381</span>            [<span class="stringliteral">&quot;ix1&quot;</span>, <span class="stringliteral">&quot;ix2&quot;</span>]</div>
<div class="line"><span class="lineno"> 1382</span>        )</div>
<div class="line"><span class="lineno"> 1383</span>        result = result.iloc[1:2].unstack(<span class="stringliteral">&quot;ix2&quot;</span>)</div>
<div class="line"><span class="lineno"> 1384</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1385</span>            [expected_row],</div>
<div class="line"><span class="lineno"> 1386</span>            columns=MultiIndex.from_product(</div>
<div class="line"><span class="lineno"> 1387</span>                [result_columns[2:], [index_product]], names=[<span class="keywordtype">None</span>, <span class="stringliteral">&quot;ix2&quot;</span>]</div>
<div class="line"><span class="lineno"> 1388</span>            ),</div>
<div class="line"><span class="lineno"> 1389</span>            index=Index([2], name=<span class="stringliteral">&quot;ix1&quot;</span>),</div>
<div class="line"><span class="lineno"> 1390</span>        )</div>
<div class="line"><span class="lineno"> 1391</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1392</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a2b05d0131756a9ada711b1a262710b" name="a8a2b05d0131756a9ada711b1a262710b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a2b05d0131756a9ada711b1a262710b">&#9670;&#160;</a></span>test_unstack_period_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_period_frame </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1734</span>    <span class="keyword">def </span>test_unstack_period_frame(self):</div>
<div class="line"><span class="lineno"> 1735</span>        <span class="comment"># GH4342</span></div>
<div class="line"><span class="lineno"> 1736</span>        idx1 = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1737</span>            [<span class="stringliteral">&quot;2014-01&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>, <span class="stringliteral">&quot;2014-01&quot;</span>, <span class="stringliteral">&quot;2014-01&quot;</span>],</div>
<div class="line"><span class="lineno"> 1738</span>            freq=<span class="stringliteral">&quot;M&quot;</span>,</div>
<div class="line"><span class="lineno"> 1739</span>            name=<span class="stringliteral">&quot;period1&quot;</span>,</div>
<div class="line"><span class="lineno"> 1740</span>        )</div>
<div class="line"><span class="lineno"> 1741</span>        idx2 = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1742</span>            [<span class="stringliteral">&quot;2013-12&quot;</span>, <span class="stringliteral">&quot;2013-12&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>, <span class="stringliteral">&quot;2013-10&quot;</span>, <span class="stringliteral">&quot;2013-10&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>],</div>
<div class="line"><span class="lineno"> 1743</span>            freq=<span class="stringliteral">&quot;M&quot;</span>,</div>
<div class="line"><span class="lineno"> 1744</span>            name=<span class="stringliteral">&quot;period2&quot;</span>,</div>
<div class="line"><span class="lineno"> 1745</span>        )</div>
<div class="line"><span class="lineno"> 1746</span>        value = {<span class="stringliteral">&quot;A&quot;</span>: [1, 2, 3, 4, 5, 6], <span class="stringliteral">&quot;B&quot;</span>: [6, 5, 4, 3, 2, 1]}</div>
<div class="line"><span class="lineno"> 1747</span>        idx = MultiIndex.from_arrays([idx1, idx2])</div>
<div class="line"><span class="lineno"> 1748</span>        df = DataFrame(value, index=idx)</div>
<div class="line"><span class="lineno"> 1749</span> </div>
<div class="line"><span class="lineno"> 1750</span>        result1 = df.unstack()</div>
<div class="line"><span class="lineno"> 1751</span>        result2 = df.unstack(level=1)</div>
<div class="line"><span class="lineno"> 1752</span>        result3 = df.unstack(level=0)</div>
<div class="line"><span class="lineno"> 1753</span> </div>
<div class="line"><span class="lineno"> 1754</span>        e_1 = pd.PeriodIndex([<span class="stringliteral">&quot;2014-01&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>], freq=<span class="stringliteral">&quot;M&quot;</span>, name=<span class="stringliteral">&quot;period1&quot;</span>)</div>
<div class="line"><span class="lineno"> 1755</span>        e_2 = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1756</span>            [<span class="stringliteral">&quot;2013-10&quot;</span>, <span class="stringliteral">&quot;2013-12&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>, <span class="stringliteral">&quot;2013-10&quot;</span>, <span class="stringliteral">&quot;2013-12&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>],</div>
<div class="line"><span class="lineno"> 1757</span>            freq=<span class="stringliteral">&quot;M&quot;</span>,</div>
<div class="line"><span class="lineno"> 1758</span>            name=<span class="stringliteral">&quot;period2&quot;</span>,</div>
<div class="line"><span class="lineno"> 1759</span>        )</div>
<div class="line"><span class="lineno"> 1760</span>        e_cols = MultiIndex.from_arrays([<span class="stringliteral">&quot;A A A B B B&quot;</span>.split(), e_2])</div>
<div class="line"><span class="lineno"> 1761</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1762</span>            [[5, 1, 6, 2, 6, 1], [4, 2, 3, 3, 5, 4]], index=e_1, columns=e_cols</div>
<div class="line"><span class="lineno"> 1763</span>        )</div>
<div class="line"><span class="lineno"> 1764</span> </div>
<div class="line"><span class="lineno"> 1765</span>        tm.assert_frame_equal(result1, expected)</div>
<div class="line"><span class="lineno"> 1766</span>        tm.assert_frame_equal(result2, expected)</div>
<div class="line"><span class="lineno"> 1767</span> </div>
<div class="line"><span class="lineno"> 1768</span>        e_1 = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1769</span>            [<span class="stringliteral">&quot;2014-01&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>, <span class="stringliteral">&quot;2014-01&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>], freq=<span class="stringliteral">&quot;M&quot;</span>, name=<span class="stringliteral">&quot;period1&quot;</span></div>
<div class="line"><span class="lineno"> 1770</span>        )</div>
<div class="line"><span class="lineno"> 1771</span>        e_2 = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1772</span>            [<span class="stringliteral">&quot;2013-10&quot;</span>, <span class="stringliteral">&quot;2013-12&quot;</span>, <span class="stringliteral">&quot;2014-02&quot;</span>], freq=<span class="stringliteral">&quot;M&quot;</span>, name=<span class="stringliteral">&quot;period2&quot;</span></div>
<div class="line"><span class="lineno"> 1773</span>        )</div>
<div class="line"><span class="lineno"> 1774</span>        e_cols = MultiIndex.from_arrays([<span class="stringliteral">&quot;A A B B&quot;</span>.split(), e_1])</div>
<div class="line"><span class="lineno"> 1775</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1776</span>            [[5, 4, 2, 3], [1, 2, 6, 5], [6, 3, 1, 4]], index=e_2, columns=e_cols</div>
<div class="line"><span class="lineno"> 1777</span>        )</div>
<div class="line"><span class="lineno"> 1778</span> </div>
<div class="line"><span class="lineno"> 1779</span>        tm.assert_frame_equal(result3, expected)</div>
<div class="line"><span class="lineno"> 1780</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad71eac08ac1cfe9bccabe138d2f80f90" name="ad71eac08ac1cfe9bccabe138d2f80f90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad71eac08ac1cfe9bccabe138d2f80f90">&#9670;&#160;</a></span>test_unstack_period_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_period_series </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1665</span>    <span class="keyword">def </span>test_unstack_period_series(self):</div>
<div class="line"><span class="lineno"> 1666</span>        <span class="comment"># GH4342</span></div>
<div class="line"><span class="lineno"> 1667</span>        idx1 = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1668</span>            [<span class="stringliteral">&quot;2013-01&quot;</span>, <span class="stringliteral">&quot;2013-01&quot;</span>, <span class="stringliteral">&quot;2013-02&quot;</span>, <span class="stringliteral">&quot;2013-02&quot;</span>, <span class="stringliteral">&quot;2013-03&quot;</span>, <span class="stringliteral">&quot;2013-03&quot;</span>],</div>
<div class="line"><span class="lineno"> 1669</span>            freq=<span class="stringliteral">&quot;M&quot;</span>,</div>
<div class="line"><span class="lineno"> 1670</span>            name=<span class="stringliteral">&quot;period&quot;</span>,</div>
<div class="line"><span class="lineno"> 1671</span>        )</div>
<div class="line"><span class="lineno"> 1672</span>        idx2 = Index([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>] * 3, name=<span class="stringliteral">&quot;str&quot;</span>)</div>
<div class="line"><span class="lineno"> 1673</span>        value = [1, 2, 3, 4, 5, 6]</div>
<div class="line"><span class="lineno"> 1674</span> </div>
<div class="line"><span class="lineno"> 1675</span>        idx = MultiIndex.from_arrays([idx1, idx2])</div>
<div class="line"><span class="lineno"> 1676</span>        s = Series(value, index=idx)</div>
<div class="line"><span class="lineno"> 1677</span> </div>
<div class="line"><span class="lineno"> 1678</span>        result1 = s.unstack()</div>
<div class="line"><span class="lineno"> 1679</span>        result2 = s.unstack(level=1)</div>
<div class="line"><span class="lineno"> 1680</span>        result3 = s.unstack(level=0)</div>
<div class="line"><span class="lineno"> 1681</span> </div>
<div class="line"><span class="lineno"> 1682</span>        e_idx = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1683</span>            [<span class="stringliteral">&quot;2013-01&quot;</span>, <span class="stringliteral">&quot;2013-02&quot;</span>, <span class="stringliteral">&quot;2013-03&quot;</span>], freq=<span class="stringliteral">&quot;M&quot;</span>, name=<span class="stringliteral">&quot;period&quot;</span></div>
<div class="line"><span class="lineno"> 1684</span>        )</div>
<div class="line"><span class="lineno"> 1685</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1686</span>            {<span class="stringliteral">&quot;A&quot;</span>: [1, 3, 5], <span class="stringliteral">&quot;B&quot;</span>: [2, 4, 6]}, index=e_idx, columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>]</div>
<div class="line"><span class="lineno"> 1687</span>        )</div>
<div class="line"><span class="lineno"> 1688</span>        expected.columns.name = <span class="stringliteral">&quot;str&quot;</span></div>
<div class="line"><span class="lineno"> 1689</span> </div>
<div class="line"><span class="lineno"> 1690</span>        tm.assert_frame_equal(result1, expected)</div>
<div class="line"><span class="lineno"> 1691</span>        tm.assert_frame_equal(result2, expected)</div>
<div class="line"><span class="lineno"> 1692</span>        tm.assert_frame_equal(result3, expected.T)</div>
<div class="line"><span class="lineno"> 1693</span> </div>
<div class="line"><span class="lineno"> 1694</span>        idx1 = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1695</span>            [<span class="stringliteral">&quot;2013-01&quot;</span>, <span class="stringliteral">&quot;2013-01&quot;</span>, <span class="stringliteral">&quot;2013-02&quot;</span>, <span class="stringliteral">&quot;2013-02&quot;</span>, <span class="stringliteral">&quot;2013-03&quot;</span>, <span class="stringliteral">&quot;2013-03&quot;</span>],</div>
<div class="line"><span class="lineno"> 1696</span>            freq=<span class="stringliteral">&quot;M&quot;</span>,</div>
<div class="line"><span class="lineno"> 1697</span>            name=<span class="stringliteral">&quot;period1&quot;</span>,</div>
<div class="line"><span class="lineno"> 1698</span>        )</div>
<div class="line"><span class="lineno"> 1699</span> </div>
<div class="line"><span class="lineno"> 1700</span>        idx2 = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1701</span>            [<span class="stringliteral">&quot;2013-12&quot;</span>, <span class="stringliteral">&quot;2013-11&quot;</span>, <span class="stringliteral">&quot;2013-10&quot;</span>, <span class="stringliteral">&quot;2013-09&quot;</span>, <span class="stringliteral">&quot;2013-08&quot;</span>, <span class="stringliteral">&quot;2013-07&quot;</span>],</div>
<div class="line"><span class="lineno"> 1702</span>            freq=<span class="stringliteral">&quot;M&quot;</span>,</div>
<div class="line"><span class="lineno"> 1703</span>            name=<span class="stringliteral">&quot;period2&quot;</span>,</div>
<div class="line"><span class="lineno"> 1704</span>        )</div>
<div class="line"><span class="lineno"> 1705</span>        idx = MultiIndex.from_arrays([idx1, idx2])</div>
<div class="line"><span class="lineno"> 1706</span>        s = Series(value, index=idx)</div>
<div class="line"><span class="lineno"> 1707</span> </div>
<div class="line"><span class="lineno"> 1708</span>        result1 = s.unstack()</div>
<div class="line"><span class="lineno"> 1709</span>        result2 = s.unstack(level=1)</div>
<div class="line"><span class="lineno"> 1710</span>        result3 = s.unstack(level=0)</div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>        e_idx = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1713</span>            [<span class="stringliteral">&quot;2013-01&quot;</span>, <span class="stringliteral">&quot;2013-02&quot;</span>, <span class="stringliteral">&quot;2013-03&quot;</span>], freq=<span class="stringliteral">&quot;M&quot;</span>, name=<span class="stringliteral">&quot;period1&quot;</span></div>
<div class="line"><span class="lineno"> 1714</span>        )</div>
<div class="line"><span class="lineno"> 1715</span>        e_cols = pd.PeriodIndex(</div>
<div class="line"><span class="lineno"> 1716</span>            [<span class="stringliteral">&quot;2013-07&quot;</span>, <span class="stringliteral">&quot;2013-08&quot;</span>, <span class="stringliteral">&quot;2013-09&quot;</span>, <span class="stringliteral">&quot;2013-10&quot;</span>, <span class="stringliteral">&quot;2013-11&quot;</span>, <span class="stringliteral">&quot;2013-12&quot;</span>],</div>
<div class="line"><span class="lineno"> 1717</span>            freq=<span class="stringliteral">&quot;M&quot;</span>,</div>
<div class="line"><span class="lineno"> 1718</span>            name=<span class="stringliteral">&quot;period2&quot;</span>,</div>
<div class="line"><span class="lineno"> 1719</span>        )</div>
<div class="line"><span class="lineno"> 1720</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1721</span>            [</div>
<div class="line"><span class="lineno"> 1722</span>                [np.nan, np.nan, np.nan, np.nan, 2, 1],</div>
<div class="line"><span class="lineno"> 1723</span>                [np.nan, np.nan, 4, 3, np.nan, np.nan],</div>
<div class="line"><span class="lineno"> 1724</span>                [6, 5, np.nan, np.nan, np.nan, np.nan],</div>
<div class="line"><span class="lineno"> 1725</span>            ],</div>
<div class="line"><span class="lineno"> 1726</span>            index=e_idx,</div>
<div class="line"><span class="lineno"> 1727</span>            columns=e_cols,</div>
<div class="line"><span class="lineno"> 1728</span>        )</div>
<div class="line"><span class="lineno"> 1729</span> </div>
<div class="line"><span class="lineno"> 1730</span>        tm.assert_frame_equal(result1, expected)</div>
<div class="line"><span class="lineno"> 1731</span>        tm.assert_frame_equal(result2, expected)</div>
<div class="line"><span class="lineno"> 1732</span>        tm.assert_frame_equal(result3, expected.T)</div>
<div class="line"><span class="lineno"> 1733</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a85eceda97f6ad1629cb9ac5bd4248b" name="a4a85eceda97f6ad1629cb9ac5bd4248b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a85eceda97f6ad1629cb9ac5bd4248b">&#9670;&#160;</a></span>test_unstack_preserve_types()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_preserve_types </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiindex_year_month_day_dataframe_random_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1951</span>    ):</div>
<div class="line"><span class="lineno"> 1952</span>        <span class="comment"># GH#403</span></div>
<div class="line"><span class="lineno"> 1953</span>        ymd = multiindex_year_month_day_dataframe_random_data</div>
<div class="line"><span class="lineno"> 1954</span>        ymd[<span class="stringliteral">&quot;E&quot;</span>] = <span class="stringliteral">&quot;foo&quot;</span></div>
<div class="line"><span class="lineno"> 1955</span>        ymd[<span class="stringliteral">&quot;F&quot;</span>] = 2</div>
<div class="line"><span class="lineno"> 1956</span> </div>
<div class="line"><span class="lineno"> 1957</span>        unstacked = ymd.unstack(<span class="stringliteral">&quot;month&quot;</span>)</div>
<div class="line"><span class="lineno"> 1958</span>        <span class="keyword">assert</span> unstacked[<span class="stringliteral">&quot;A&quot;</span>, 1].dtype == np.float64</div>
<div class="line"><span class="lineno"> 1959</span>        <span class="keyword">assert</span> unstacked[<span class="stringliteral">&quot;E&quot;</span>, 1].dtype == np.object_</div>
<div class="line"><span class="lineno"> 1960</span>        <span class="keyword">assert</span> unstacked[<span class="stringliteral">&quot;F&quot;</span>, 1].dtype == np.float64</div>
<div class="line"><span class="lineno"> 1961</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4aed3298d372909a95515393068d6bd" name="aa4aed3298d372909a95515393068d6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4aed3298d372909a95515393068d6bd">&#9670;&#160;</a></span>test_unstack_sparse_keyspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_sparse_keyspace </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1828</span>    <span class="keyword">def </span>test_unstack_sparse_keyspace(self):</div>
<div class="line"><span class="lineno"> 1829</span>        <span class="comment"># memory problems with naive impl GH#2278</span></div>
<div class="line"><span class="lineno"> 1830</span>        <span class="comment"># Generate Long File &amp; Test Pivot</span></div>
<div class="line"><span class="lineno"> 1831</span>        NUM_ROWS = 1000</div>
<div class="line"><span class="lineno"> 1832</span> </div>
<div class="line"><span class="lineno"> 1833</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 1834</span>            {</div>
<div class="line"><span class="lineno"> 1835</span>                <span class="stringliteral">&quot;A&quot;</span>: np.random.randint(100, size=NUM_ROWS),</div>
<div class="line"><span class="lineno"> 1836</span>                <span class="stringliteral">&quot;B&quot;</span>: np.random.randint(300, size=NUM_ROWS),</div>
<div class="line"><span class="lineno"> 1837</span>                <span class="stringliteral">&quot;C&quot;</span>: np.random.randint(-7, 7, size=NUM_ROWS),</div>
<div class="line"><span class="lineno"> 1838</span>                <span class="stringliteral">&quot;D&quot;</span>: np.random.randint(-19, 19, size=NUM_ROWS),</div>
<div class="line"><span class="lineno"> 1839</span>                <span class="stringliteral">&quot;E&quot;</span>: np.random.randint(3000, size=NUM_ROWS),</div>
<div class="line"><span class="lineno"> 1840</span>                <span class="stringliteral">&quot;F&quot;</span>: np.random.randn(NUM_ROWS),</div>
<div class="line"><span class="lineno"> 1841</span>            }</div>
<div class="line"><span class="lineno"> 1842</span>        )</div>
<div class="line"><span class="lineno"> 1843</span> </div>
<div class="line"><span class="lineno"> 1844</span>        idf = df.set_index([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;E&quot;</span>])</div>
<div class="line"><span class="lineno"> 1845</span> </div>
<div class="line"><span class="lineno"> 1846</span>        <span class="comment"># it works! is sufficient</span></div>
<div class="line"><span class="lineno"> 1847</span>        idf.unstack(<span class="stringliteral">&quot;E&quot;</span>)</div>
<div class="line"><span class="lineno"> 1848</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e1924f13c6cb0470534f09c35d70db6" name="a7e1924f13c6cb0470534f09c35d70db6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e1924f13c6cb0470534f09c35d70db6">&#9670;&#160;</a></span>test_unstack_unobserved_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_unobserved_keys </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1849</span>    <span class="keyword">def </span>test_unstack_unobserved_keys(self):</div>
<div class="line"><span class="lineno"> 1850</span>        <span class="comment"># related to GH#2278 refactoring</span></div>
<div class="line"><span class="lineno"> 1851</span>        levels = [[0, 1], [0, 1, 2, 3]]</div>
<div class="line"><span class="lineno"> 1852</span>        codes = [[0, 0, 1, 1], [0, 2, 0, 2]]</div>
<div class="line"><span class="lineno"> 1853</span> </div>
<div class="line"><span class="lineno"> 1854</span>        index = MultiIndex(levels, codes)</div>
<div class="line"><span class="lineno"> 1855</span> </div>
<div class="line"><span class="lineno"> 1856</span>        df = DataFrame(np.random.randn(4, 2), index=index)</div>
<div class="line"><span class="lineno"> 1857</span> </div>
<div class="line"><span class="lineno"> 1858</span>        result = df.unstack()</div>
<div class="line"><span class="lineno"> 1859</span>        <span class="keyword">assert</span> len(result.columns) == 4</div>
<div class="line"><span class="lineno"> 1860</span> </div>
<div class="line"><span class="lineno"> 1861</span>        recons = result.stack()</div>
<div class="line"><span class="lineno"> 1862</span>        tm.assert_frame_equal(recons, df)</div>
<div class="line"><span class="lineno"> 1863</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ba1de14b1a1c3afd29e2435523432f1" name="a5ba1de14b1a1c3afd29e2435523432f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ba1de14b1a1c3afd29e2435523432f1">&#9670;&#160;</a></span>test_unstack_with_level_has_nan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_with_level_has_nan </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2031</span>    <span class="keyword">def </span>test_unstack_with_level_has_nan(self):</div>
<div class="line"><span class="lineno"> 2032</span>        <span class="comment"># GH 37510</span></div>
<div class="line"><span class="lineno"> 2033</span>        df1 = DataFrame(</div>
<div class="line"><span class="lineno"> 2034</span>            {</div>
<div class="line"><span class="lineno"> 2035</span>                <span class="stringliteral">&quot;L1&quot;</span>: [1, 2, 3, 4],</div>
<div class="line"><span class="lineno"> 2036</span>                <span class="stringliteral">&quot;L2&quot;</span>: [3, 4, 1, 2],</div>
<div class="line"><span class="lineno"> 2037</span>                <span class="stringliteral">&quot;L3&quot;</span>: [1, 1, 1, 1],</div>
<div class="line"><span class="lineno"> 2038</span>                <span class="stringliteral">&quot;x&quot;</span>: [1, 2, 3, 4],</div>
<div class="line"><span class="lineno"> 2039</span>            }</div>
<div class="line"><span class="lineno"> 2040</span>        )</div>
<div class="line"><span class="lineno"> 2041</span>        df1 = df1.set_index([<span class="stringliteral">&quot;L1&quot;</span>, <span class="stringliteral">&quot;L2&quot;</span>, <span class="stringliteral">&quot;L3&quot;</span>])</div>
<div class="line"><span class="lineno"> 2042</span>        new_levels = [<span class="stringliteral">&quot;n1&quot;</span>, <span class="stringliteral">&quot;n2&quot;</span>, <span class="stringliteral">&quot;n3&quot;</span>, <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno"> 2043</span>        df1.index = df1.index.set_levels(levels=new_levels, level=<span class="stringliteral">&quot;L1&quot;</span>)</div>
<div class="line"><span class="lineno"> 2044</span>        df1.index = df1.index.set_levels(levels=new_levels, level=<span class="stringliteral">&quot;L2&quot;</span>)</div>
<div class="line"><span class="lineno"> 2045</span> </div>
<div class="line"><span class="lineno"> 2046</span>        result = df1.unstack(<span class="stringliteral">&quot;L3&quot;</span>)[(<span class="stringliteral">&quot;x&quot;</span>, 1)].sort_index().index</div>
<div class="line"><span class="lineno"> 2047</span>        expected = MultiIndex(</div>
<div class="line"><span class="lineno"> 2048</span>            levels=[[<span class="stringliteral">&quot;n1&quot;</span>, <span class="stringliteral">&quot;n2&quot;</span>, <span class="stringliteral">&quot;n3&quot;</span>, <span class="keywordtype">None</span>], [<span class="stringliteral">&quot;n1&quot;</span>, <span class="stringliteral">&quot;n2&quot;</span>, <span class="stringliteral">&quot;n3&quot;</span>, <span class="keywordtype">None</span>]],</div>
<div class="line"><span class="lineno"> 2049</span>            codes=[[0, 1, 2, 3], [2, 3, 0, 1]],</div>
<div class="line"><span class="lineno"> 2050</span>            names=[<span class="stringliteral">&quot;L1&quot;</span>, <span class="stringliteral">&quot;L2&quot;</span>],</div>
<div class="line"><span class="lineno"> 2051</span>        )</div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span>        tm.assert_index_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2054</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a695b2e1fd3039f7dae1a9b1ee503484e" name="a695b2e1fd3039f7dae1a9b1ee503484e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a695b2e1fd3039f7dae1a9b1ee503484e">&#9670;&#160;</a></span>test_unstack_with_missing_int_cast_to_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.frame.test_stack_unstack.TestStackUnstackMultiLevel.test_unstack_with_missing_int_cast_to_float </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>using_array_manager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1999</span>    <span class="keyword">def </span>test_unstack_with_missing_int_cast_to_float(self, using_array_manager):</div>
<div class="line"><span class="lineno"> 2000</span>        <span class="comment"># https://github.com/pandas-dev/pandas/issues/37115</span></div>
<div class="line"><span class="lineno"> 2001</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 2002</span>            {</div>
<div class="line"><span class="lineno"> 2003</span>                <span class="stringliteral">&quot;a&quot;</span>: [<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>],</div>
<div class="line"><span class="lineno"> 2004</span>                <span class="stringliteral">&quot;b&quot;</span>: [<span class="stringliteral">&quot;ca&quot;</span>, <span class="stringliteral">&quot;cb&quot;</span>, <span class="stringliteral">&quot;cb&quot;</span>],</div>
<div class="line"><span class="lineno"> 2005</span>                <span class="stringliteral">&quot;v&quot;</span>: [10] * 3,</div>
<div class="line"><span class="lineno"> 2006</span>            }</div>
<div class="line"><span class="lineno"> 2007</span>        ).set_index([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>])</div>
<div class="line"><span class="lineno"> 2008</span> </div>
<div class="line"><span class="lineno"> 2009</span>        <span class="comment"># add another int column to get 2 blocks</span></div>
<div class="line"><span class="lineno"> 2010</span>        df[<span class="stringliteral">&quot;is_&quot;</span>] = 1</div>
<div class="line"><span class="lineno"> 2011</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> using_array_manager:</div>
<div class="line"><span class="lineno"> 2012</span>            <span class="keyword">assert</span> len(df._mgr.blocks) == 2</div>
<div class="line"><span class="lineno"> 2013</span> </div>
<div class="line"><span class="lineno"> 2014</span>        result = df.unstack(<span class="stringliteral">&quot;b&quot;</span>)</div>
<div class="line"><span class="lineno"> 2015</span>        result[(<span class="stringliteral">&quot;is_&quot;</span>, <span class="stringliteral">&quot;ca&quot;</span>)] = result[(<span class="stringliteral">&quot;is_&quot;</span>, <span class="stringliteral">&quot;ca&quot;</span>)].fillna(0)</div>
<div class="line"><span class="lineno"> 2016</span> </div>
<div class="line"><span class="lineno"> 2017</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 2018</span>            [[10.0, 10.0, 1.0, 1.0], [np.nan, 10.0, 0.0, 1.0]],</div>
<div class="line"><span class="lineno"> 2019</span>            index=Index([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], dtype=<span class="stringliteral">&quot;object&quot;</span>, name=<span class="stringliteral">&quot;a&quot;</span>),</div>
<div class="line"><span class="lineno"> 2020</span>            columns=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno"> 2021</span>                [(<span class="stringliteral">&quot;v&quot;</span>, <span class="stringliteral">&quot;ca&quot;</span>), (<span class="stringliteral">&quot;v&quot;</span>, <span class="stringliteral">&quot;cb&quot;</span>), (<span class="stringliteral">&quot;is_&quot;</span>, <span class="stringliteral">&quot;ca&quot;</span>), (<span class="stringliteral">&quot;is_&quot;</span>, <span class="stringliteral">&quot;cb&quot;</span>)],</div>
<div class="line"><span class="lineno"> 2022</span>                names=[<span class="keywordtype">None</span>, <span class="stringliteral">&quot;b&quot;</span>],</div>
<div class="line"><span class="lineno"> 2023</span>            ),</div>
<div class="line"><span class="lineno"> 2024</span>        )</div>
<div class="line"><span class="lineno"> 2025</span>        <span class="keywordflow">if</span> using_array_manager:</div>
<div class="line"><span class="lineno"> 2026</span>            <span class="comment"># INFO(ArrayManager) with ArrayManager preserve dtype where possible</span></div>
<div class="line"><span class="lineno"> 2027</span>            expected[(<span class="stringliteral">&quot;v&quot;</span>, <span class="stringliteral">&quot;cb&quot;</span>)] = expected[(<span class="stringliteral">&quot;v&quot;</span>, <span class="stringliteral">&quot;cb&quot;</span>)].astype(<span class="stringliteral">&quot;int64&quot;</span>)</div>
<div class="line"><span class="lineno"> 2028</span>            expected[(<span class="stringliteral">&quot;is_&quot;</span>, <span class="stringliteral">&quot;cb&quot;</span>)] = expected[(<span class="stringliteral">&quot;is_&quot;</span>, <span class="stringliteral">&quot;cb&quot;</span>)].astype(<span class="stringliteral">&quot;int64&quot;</span>)</div>
<div class="line"><span class="lineno"> 2029</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2030</span> </div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/pandas/tests/frame/<a class="el" href="test__stack__unstack_8py.html">test_stack_unstack.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
