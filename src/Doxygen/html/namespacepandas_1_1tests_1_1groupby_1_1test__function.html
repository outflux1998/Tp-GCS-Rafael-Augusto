<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.tests.groupby.test_function Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1groupby.html">groupby</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html">test_function</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">pandas.tests.groupby.test_function Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1groupby_1_1test__function_1_1_test_group_by_non_cython_paths.html">TestGroupByNonCythonPaths</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1groupby_1_1test__function_1_1_test_numeric_only.html">TestNumericOnly</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0f21e2b498088453fd5b29d8e55332ca" id="r_a0f21e2b498088453fd5b29d8e55332ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a0f21e2b498088453fd5b29d8e55332ca">dtypes_for_minmax</a> (request)</td></tr>
<tr class="separator:a0f21e2b498088453fd5b29d8e55332ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac3bb12f562252789a79e30d0e9c756" id="r_aeac3bb12f562252789a79e30d0e9c756"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#aeac3bb12f562252789a79e30d0e9c756">test_intercept_builtin_sum</a> ()</td></tr>
<tr class="separator:aeac3bb12f562252789a79e30d0e9c756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae3d0ce3418570ea8f601fe58e6539c" id="r_aeae3d0ce3418570ea8f601fe58e6539c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#aeae3d0ce3418570ea8f601fe58e6539c">test_builtins_apply</a> (keys, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>)</td></tr>
<tr class="separator:aeae3d0ce3418570ea8f601fe58e6539c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dbc0ef49b6c94c14885b0b538b5fd7d" id="r_a5dbc0ef49b6c94c14885b0b538b5fd7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a5dbc0ef49b6c94c14885b0b538b5fd7d">test_cython_api2</a> ()</td></tr>
<tr class="separator:a5dbc0ef49b6c94c14885b0b538b5fd7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb3c7ffb99c8b78313d372a30ee1b879" id="r_abb3c7ffb99c8b78313d372a30ee1b879"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#abb3c7ffb99c8b78313d372a30ee1b879">test_cython_median</a> ()</td></tr>
<tr class="separator:abb3c7ffb99c8b78313d372a30ee1b879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7598c7faf1fa7e97c11b0ce394d6ed93" id="r_a7598c7faf1fa7e97c11b0ce394d6ed93"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a7598c7faf1fa7e97c11b0ce394d6ed93">test_median_empty_bins</a> (observed)</td></tr>
<tr class="separator:a7598c7faf1fa7e97c11b0ce394d6ed93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24357cbf6dc379e2f6a98fe8906600c6" id="r_a24357cbf6dc379e2f6a98fe8906600c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a24357cbf6dc379e2f6a98fe8906600c6">test_groupby_non_arithmetic_agg_types</a> (dtype, method, data)</td></tr>
<tr class="separator:a24357cbf6dc379e2f6a98fe8906600c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ccc3b5ac676897a33570b43e6613c25" id="r_a2ccc3b5ac676897a33570b43e6613c25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a2ccc3b5ac676897a33570b43e6613c25">test_groupby_non_arithmetic_agg_int_like_precision</a> (<a class="el" href="__lapack__subroutines_8h.html#a5325f1842789194c441b272cbf424674">i</a>)</td></tr>
<tr class="separator:a2ccc3b5ac676897a33570b43e6613c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64dc6b5a9dbdda4736df9e00879863a9" id="r_a64dc6b5a9dbdda4736df9e00879863a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a64dc6b5a9dbdda4736df9e00879863a9">test_idxmin_idxmax_returns_int_types</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, values, numeric_only)</td></tr>
<tr class="separator:a64dc6b5a9dbdda4736df9e00879863a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a742ed41ca97775027a6799be9b9f2611" id="r_a742ed41ca97775027a6799be9b9f2611"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a742ed41ca97775027a6799be9b9f2611">test_idxmin_idxmax_axis1</a> ()</td></tr>
<tr class="separator:a742ed41ca97775027a6799be9b9f2611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fe6adcb8bd02234b80d4b850e831efa" id="r_a6fe6adcb8bd02234b80d4b850e831efa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a6fe6adcb8bd02234b80d4b850e831efa">test_axis1_numeric_only</a> (request, groupby_func, numeric_only)</td></tr>
<tr class="separator:a6fe6adcb8bd02234b80d4b850e831efa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab615c80d83ed44effb9a7417d9e66aab" id="r_ab615c80d83ed44effb9a7417d9e66aab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#ab615c80d83ed44effb9a7417d9e66aab">test_groupby_cumprod</a> ()</td></tr>
<tr class="separator:ab615c80d83ed44effb9a7417d9e66aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05c56f5b5cf204a2713c661370d2a516" id="r_a05c56f5b5cf204a2713c661370d2a516"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a05c56f5b5cf204a2713c661370d2a516">test_groupby_cumprod_nan_influences_other_columns</a> ()</td></tr>
<tr class="separator:a05c56f5b5cf204a2713c661370d2a516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af45a092bb0836623b5b3bd6ae1afd9ca" id="r_af45a092bb0836623b5b3bd6ae1afd9ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#af45a092bb0836623b5b3bd6ae1afd9ca">scipy_sem</a> (*args, **kwargs)</td></tr>
<tr class="separator:af45a092bb0836623b5b3bd6ae1afd9ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15064cfeda235e20d3841275f40090d6" id="r_a15064cfeda235e20d3841275f40090d6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a15064cfeda235e20d3841275f40090d6">test_ops_general</a> (op, targop)</td></tr>
<tr class="separator:a15064cfeda235e20d3841275f40090d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc6a4adbdb015a13227ca09d058dd1db" id="r_afc6a4adbdb015a13227ca09d058dd1db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#afc6a4adbdb015a13227ca09d058dd1db">test_max_nan_bug</a> ()</td></tr>
<tr class="separator:afc6a4adbdb015a13227ca09d058dd1db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af178bef2b17de6a21f6acd95f7a7ff15" id="r_af178bef2b17de6a21f6acd95f7a7ff15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#af178bef2b17de6a21f6acd95f7a7ff15">test_nlargest</a> ()</td></tr>
<tr class="separator:af178bef2b17de6a21f6acd95f7a7ff15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b719b6c4fc7fbc94dad2506226a296" id="r_ae3b719b6c4fc7fbc94dad2506226a296"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#ae3b719b6c4fc7fbc94dad2506226a296">test_nlargest_mi_grouper</a> ()</td></tr>
<tr class="separator:ae3b719b6c4fc7fbc94dad2506226a296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a244bfa0f23a8fbb5ca0685a71a49c521" id="r_a244bfa0f23a8fbb5ca0685a71a49c521"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a244bfa0f23a8fbb5ca0685a71a49c521">test_nsmallest</a> ()</td></tr>
<tr class="separator:a244bfa0f23a8fbb5ca0685a71a49c521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb73fdbe07cdc26d5668c8b4e8a5b500" id="r_acb73fdbe07cdc26d5668c8b4e8a5b500"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#acb73fdbe07cdc26d5668c8b4e8a5b500">test_nlargest_and_smallest_noop</a> (data, groups, method)</td></tr>
<tr class="separator:acb73fdbe07cdc26d5668c8b4e8a5b500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0a61d34448ed935d73a8afc99149e71" id="r_ad0a61d34448ed935d73a8afc99149e71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#ad0a61d34448ed935d73a8afc99149e71">test_numpy_compat</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:ad0a61d34448ed935d73a8afc99149e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ca4c196d444dcdff127d3944983c7c5" id="r_a9ca4c196d444dcdff127d3944983c7c5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a9ca4c196d444dcdff127d3944983c7c5">test_cummin</a> (<a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a0f21e2b498088453fd5b29d8e55332ca">dtypes_for_minmax</a>)</td></tr>
<tr class="separator:a9ca4c196d444dcdff127d3944983c7c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd729cdd3d12bcb49b22318796d83031" id="r_abd729cdd3d12bcb49b22318796d83031"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#abd729cdd3d12bcb49b22318796d83031">test_cummin_max_all_nan_column</a> (method, dtype)</td></tr>
<tr class="separator:abd729cdd3d12bcb49b22318796d83031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a735c274a56d14088c362759194cf5f" id="r_a7a735c274a56d14088c362759194cf5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a7a735c274a56d14088c362759194cf5f">test_cummax</a> (<a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a0f21e2b498088453fd5b29d8e55332ca">dtypes_for_minmax</a>)</td></tr>
<tr class="separator:a7a735c274a56d14088c362759194cf5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07f9534d7a4c596214f1fcefd36718ef" id="r_a07f9534d7a4c596214f1fcefd36718ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a07f9534d7a4c596214f1fcefd36718ef">test_cummax_i8_at_implementation_bound</a> ()</td></tr>
<tr class="separator:a07f9534d7a4c596214f1fcefd36718ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac76e3b361c062f3a8fabb7ccaa3d46" id="r_a5ac76e3b361c062f3a8fabb7ccaa3d46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a5ac76e3b361c062f3a8fabb7ccaa3d46">test_cummin_max_skipna</a> (method, dtype, groups, expected_data)</td></tr>
<tr class="separator:a5ac76e3b361c062f3a8fabb7ccaa3d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abca7780ae1776ff3985c8be6b63f20fe" id="r_abca7780ae1776ff3985c8be6b63f20fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#abca7780ae1776ff3985c8be6b63f20fe">test_cummin_max_skipna_multiple_cols</a> (method)</td></tr>
<tr class="separator:abca7780ae1776ff3985c8be6b63f20fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61263403950d1e95d32328177a280a8" id="r_ad61263403950d1e95d32328177a280a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#ad61263403950d1e95d32328177a280a8">test_nullable_int_not_cast_as_float</a> (method, dtype, val)</td></tr>
<tr class="separator:ad61263403950d1e95d32328177a280a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53026f30281e86c85722a9842164a662" id="r_a53026f30281e86c85722a9842164a662"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a53026f30281e86c85722a9842164a662">test_is_monotonic_increasing</a> (in_vals, out_vals)</td></tr>
<tr class="separator:a53026f30281e86c85722a9842164a662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23387620ebd5a2dcc4ebdfb5e1c1af5d" id="r_a23387620ebd5a2dcc4ebdfb5e1c1af5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a23387620ebd5a2dcc4ebdfb5e1c1af5d">test_is_monotonic_decreasing</a> (in_vals, out_vals)</td></tr>
<tr class="separator:a23387620ebd5a2dcc4ebdfb5e1c1af5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a29ca1f65a0ae78da75f69b335b94b4" id="r_a0a29ca1f65a0ae78da75f69b335b94b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a0a29ca1f65a0ae78da75f69b335b94b4">test_apply_describe_bug</a> (mframe)</td></tr>
<tr class="separator:a0a29ca1f65a0ae78da75f69b335b94b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14360959c808c04d41ad3474bbe5cd2" id="r_af14360959c808c04d41ad3474bbe5cd2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#af14360959c808c04d41ad3474bbe5cd2">test_series_describe_multikey</a> ()</td></tr>
<tr class="separator:af14360959c808c04d41ad3474bbe5cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bcd85671b20661d1d98167da3a073f4" id="r_a5bcd85671b20661d1d98167da3a073f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a5bcd85671b20661d1d98167da3a073f4">test_series_describe_single</a> ()</td></tr>
<tr class="separator:a5bcd85671b20661d1d98167da3a073f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed7f5ae1dcc11abd4d3d4cbb19235401" id="r_aed7f5ae1dcc11abd4d3d4cbb19235401"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#aed7f5ae1dcc11abd4d3d4cbb19235401">test_series_index_name</a> (<a class="el" href="__lapack__subroutines_8h.html#a2a33a012da63c0be8f0f3845c10bf577">df</a>)</td></tr>
<tr class="separator:aed7f5ae1dcc11abd4d3d4cbb19235401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9091717cb21db7420f923d3cd0357b99" id="r_a9091717cb21db7420f923d3cd0357b99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a9091717cb21db7420f923d3cd0357b99">test_frame_describe_multikey</a> (tsframe)</td></tr>
<tr class="separator:a9091717cb21db7420f923d3cd0357b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af164a2c03499bbab3705825f3c551520" id="r_af164a2c03499bbab3705825f3c551520"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#af164a2c03499bbab3705825f3c551520">test_frame_describe_tupleindex</a> ()</td></tr>
<tr class="separator:af164a2c03499bbab3705825f3c551520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ebe92725fcb2788b362891dde3d34f9" id="r_a9ebe92725fcb2788b362891dde3d34f9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a9ebe92725fcb2788b362891dde3d34f9">test_frame_describe_unstacked_format</a> ()</td></tr>
<tr class="separator:a9ebe92725fcb2788b362891dde3d34f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4515ebe762cd795d79ee7a73b8c4ccde" id="r_a4515ebe762cd795d79ee7a73b8c4ccde"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a4515ebe762cd795d79ee7a73b8c4ccde">test_describe_with_duplicate_output_column_names</a> (as_index)</td></tr>
<tr class="separator:a4515ebe762cd795d79ee7a73b8c4ccde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2cbb73b6b968063e0962b27efca9d78" id="r_ae2cbb73b6b968063e0962b27efca9d78"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#ae2cbb73b6b968063e0962b27efca9d78">test_groupby_mean_no_overflow</a> ()</td></tr>
<tr class="separator:ae2cbb73b6b968063e0962b27efca9d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cda8a66b49d311ec458142cd8eac332" id="r_a5cda8a66b49d311ec458142cd8eac332"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a5cda8a66b49d311ec458142cd8eac332">test_apply_to_nullable_integer_returns_float</a> (values, function)</td></tr>
<tr class="separator:a5cda8a66b49d311ec458142cd8eac332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f0efcb13c5ef4ae4d05dbe604b256b" id="r_a36f0efcb13c5ef4ae4d05dbe604b256b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a36f0efcb13c5ef4ae4d05dbe604b256b">test_groupby_sum_below_mincount_nullable_integer</a> ()</td></tr>
<tr class="separator:a36f0efcb13c5ef4ae4d05dbe604b256b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9faa2298e31580ffb37ff270a865320c" id="r_a9faa2298e31580ffb37ff270a865320c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a9faa2298e31580ffb37ff270a865320c">test_mean_on_timedelta</a> ()</td></tr>
<tr class="separator:a9faa2298e31580ffb37ff270a865320c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebea940515168e162d9962785cbdfb1c" id="r_aebea940515168e162d9962785cbdfb1c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#aebea940515168e162d9962785cbdfb1c">test_groupby_sum_timedelta_with_nat</a> ()</td></tr>
<tr class="separator:aebea940515168e162d9962785cbdfb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aa7896f1ce0e0b7e9a54f27ddf47492" id="r_a2aa7896f1ce0e0b7e9a54f27ddf47492"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a2aa7896f1ce0e0b7e9a54f27ddf47492">test_deprecate_numeric_only</a> (kernel, numeric_only_default, drops_nuisance, has_arg, numeric_only, keys)</td></tr>
<tr class="separator:a2aa7896f1ce0e0b7e9a54f27ddf47492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26f69199c04e50106aa54d339f5093ec" id="r_a26f69199c04e50106aa54d339f5093ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a26f69199c04e50106aa54d339f5093ec">test_deprecate_numeric_only_series</a> (dtype, groupby_func, request)</td></tr>
<tr class="separator:a26f69199c04e50106aa54d339f5093ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58a75b30558cb377022507f573b7bb41" id="r_a58a75b30558cb377022507f573b7bb41"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a58a75b30558cb377022507f573b7bb41">test_groupby_empty_dataset</a> (dtype, kwargs)</td></tr>
<tr class="separator:a58a75b30558cb377022507f573b7bb41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8e91df5387c55bf399d8ca0ffa2e3ae" id="r_ad8e91df5387c55bf399d8ca0ffa2e3ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#ad8e91df5387c55bf399d8ca0ffa2e3ae">test_corrwith_with_1_axis</a> ()</td></tr>
<tr class="separator:ad8e91df5387c55bf399d8ca0ffa2e3ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19186ccb40355ae56294dac9e82da0c3" id="r_a19186ccb40355ae56294dac9e82da0c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1groupby_1_1test__function.html#a19186ccb40355ae56294dac9e82da0c3">test_multiindex_group_all_columns_when_empty</a> (groupby_func)</td></tr>
<tr class="separator:a19186ccb40355ae56294dac9e82da0c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0f21e2b498088453fd5b29d8e55332ca" name="a0f21e2b498088453fd5b29d8e55332ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f21e2b498088453fd5b29d8e55332ca">&#9670;&#160;</a></span>dtypes_for_minmax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.dtypes_for_minmax </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Fixture of dtypes with min and max values used for testing
cummin and cummax
</pre> <div class="fragment"><div class="line"><span class="lineno">   29</span><span class="keyword">def </span>dtypes_for_minmax(request):</div>
<div class="line"><span class="lineno">   30</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">    Fixture of dtypes with min and max values used for testing</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">    cummin and cummax</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   34</span>    dtype = request.param</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>    np_type = dtype</div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordflow">if</span> dtype == <span class="stringliteral">&quot;Int64&quot;</span>:</div>
<div class="line"><span class="lineno">   38</span>        np_type = np.int64</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">elif</span> dtype == <span class="stringliteral">&quot;Float64&quot;</span>:</div>
<div class="line"><span class="lineno">   40</span>        np_type = np.float64</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>    min_val = (</div>
<div class="line"><span class="lineno">   43</span>        np.iinfo(np_type).min</div>
<div class="line"><span class="lineno">   44</span>        <span class="keywordflow">if</span> np.dtype(np_type).kind == <span class="stringliteral">&quot;i&quot;</span></div>
<div class="line"><span class="lineno">   45</span>        <span class="keywordflow">else</span> np.finfo(np_type).min</div>
<div class="line"><span class="lineno">   46</span>    )</div>
<div class="line"><span class="lineno">   47</span>    max_val = (</div>
<div class="line"><span class="lineno">   48</span>        np.iinfo(np_type).max</div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">if</span> np.dtype(np_type).kind == <span class="stringliteral">&quot;i&quot;</span></div>
<div class="line"><span class="lineno">   50</span>        <span class="keywordflow">else</span> np.finfo(np_type).max</div>
<div class="line"><span class="lineno">   51</span>    )</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordflow">return</span> (dtype, min_val, max_val)</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af45a092bb0836623b5b3bd6ae1afd9ca" name="af45a092bb0836623b5b3bd6ae1afd9ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af45a092bb0836623b5b3bd6ae1afd9ca">&#9670;&#160;</a></span>scipy_sem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.scipy_sem </td>
          <td>(</td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  667</span><span class="keyword">def </span>scipy_sem(*args, **kwargs):</div>
<div class="line"><span class="lineno">  668</span>    <span class="keyword">from</span> <a class="code hl_namespace" href="namespacescipy_1_1stats.html">scipy.stats</a> <span class="keyword">import</span> sem</div>
<div class="line"><span class="lineno">  669</span> </div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordflow">return</span> sem(*args, ddof=1, **kwargs)</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  674</span>    <span class="stringliteral">&quot;op,targop&quot;</span>,</div>
<div class="line"><span class="lineno">  675</span>    [</div>
<div class="line"><span class="lineno">  676</span>        (<span class="stringliteral">&quot;mean&quot;</span>, np.mean),</div>
<div class="line"><span class="lineno">  677</span>        (<span class="stringliteral">&quot;median&quot;</span>, np.median),</div>
<div class="line"><span class="lineno">  678</span>        (<span class="stringliteral">&quot;std&quot;</span>, np.std),</div>
<div class="line"><span class="lineno">  679</span>        (<span class="stringliteral">&quot;var&quot;</span>, np.var),</div>
<div class="line"><span class="lineno">  680</span>        (<span class="stringliteral">&quot;sum&quot;</span>, np.sum),</div>
<div class="line"><span class="lineno">  681</span>        (<span class="stringliteral">&quot;prod&quot;</span>, np.prod),</div>
<div class="line"><span class="lineno">  682</span>        (<span class="stringliteral">&quot;min&quot;</span>, np.min),</div>
<div class="line"><span class="lineno">  683</span>        (<span class="stringliteral">&quot;max&quot;</span>, np.max),</div>
<div class="line"><span class="lineno">  684</span>        (<span class="stringliteral">&quot;first&quot;</span>, <span class="keyword">lambda</span> x: x.iloc[0]),</div>
<div class="line"><span class="lineno">  685</span>        (<span class="stringliteral">&quot;last&quot;</span>, <span class="keyword">lambda</span> x: x.iloc[-1]),</div>
<div class="line"><span class="lineno">  686</span>        (<span class="stringliteral">&quot;count&quot;</span>, np.size),</div>
<div class="line"><span class="lineno">  687</span>        pytest.param(<span class="stringliteral">&quot;sem&quot;</span>, scipy_sem, marks=td.skip_if_no_scipy),</div>
<div class="line"><span class="lineno">  688</span>    ],</div>
<div class="line"><span class="lineno">  689</span>)</div>
<div class="ttc" id="anamespacescipy_1_1stats_html"><div class="ttname"><a href="namespacescipy_1_1stats.html">scipy.stats</a></div><div class="ttdef"><b>Definition</b> __init__.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a29ca1f65a0ae78da75f69b335b94b4" name="a0a29ca1f65a0ae78da75f69b335b94b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a29ca1f65a0ae78da75f69b335b94b4">&#9670;&#160;</a></span>test_apply_describe_bug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_apply_describe_bug </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mframe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1084</span><span class="keyword">def </span>test_apply_describe_bug(mframe):</div>
<div class="line"><span class="lineno"> 1085</span>    grouped = mframe.groupby(level=<span class="stringliteral">&quot;first&quot;</span>)</div>
<div class="line"><span class="lineno"> 1086</span>    grouped.describe()  <span class="comment"># it works!</span></div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5cda8a66b49d311ec458142cd8eac332" name="a5cda8a66b49d311ec458142cd8eac332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cda8a66b49d311ec458142cd8eac332">&#9670;&#160;</a></span>test_apply_to_nullable_integer_returns_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_apply_to_nullable_integer_returns_float </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1269</span><span class="keyword">def </span>test_apply_to_nullable_integer_returns_float(values, function):</div>
<div class="line"><span class="lineno"> 1270</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/32219</span></div>
<div class="line"><span class="lineno"> 1271</span>    output = 0.5 <span class="keywordflow">if</span> function == <span class="stringliteral">&quot;var&quot;</span> <span class="keywordflow">else</span> 1.5</div>
<div class="line"><span class="lineno"> 1272</span>    arr = np.array([output] * 3, dtype=float)</div>
<div class="line"><span class="lineno"> 1273</span>    idx = Index([1, 2, 3], name=<span class="stringliteral">&quot;a&quot;</span>, dtype=<span class="stringliteral">&quot;Int64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1274</span>    expected = DataFrame({<span class="stringliteral">&quot;b&quot;</span>: arr}, index=idx).astype(<span class="stringliteral">&quot;Float64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1275</span> </div>
<div class="line"><span class="lineno"> 1276</span>    groups = DataFrame(values, dtype=<span class="stringliteral">&quot;Int64&quot;</span>).groupby(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno"> 1277</span> </div>
<div class="line"><span class="lineno"> 1278</span>    result = getattr(groups, function)()</div>
<div class="line"><span class="lineno"> 1279</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1280</span> </div>
<div class="line"><span class="lineno"> 1281</span>    result = groups.agg(function)</div>
<div class="line"><span class="lineno"> 1282</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1283</span> </div>
<div class="line"><span class="lineno"> 1284</span>    result = groups.agg([function])</div>
<div class="line"><span class="lineno"> 1285</span>    expected.columns = MultiIndex.from_tuples([(<span class="stringliteral">&quot;b&quot;</span>, function)])</div>
<div class="line"><span class="lineno"> 1286</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6fe6adcb8bd02234b80d4b850e831efa" name="a6fe6adcb8bd02234b80d4b850e831efa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fe6adcb8bd02234b80d4b850e831efa">&#9670;&#160;</a></span>test_axis1_numeric_only()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_axis1_numeric_only </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groupby_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>numeric_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  560</span><span class="keyword">def </span>test_axis1_numeric_only(request, groupby_func, numeric_only):</div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordflow">if</span> groupby_func <span class="keywordflow">in</span> (<span class="stringliteral">&quot;idxmax&quot;</span>, <span class="stringliteral">&quot;idxmin&quot;</span>):</div>
<div class="line"><span class="lineno">  562</span>        pytest.skip(<span class="stringliteral">&quot;idxmax and idx_min tested in test_idxmin_idxmax_axis1&quot;</span>)</div>
<div class="line"><span class="lineno">  563</span>    <span class="keywordflow">if</span> groupby_func <span class="keywordflow">in</span> (<span class="stringliteral">&quot;mad&quot;</span>, <span class="stringliteral">&quot;tshift&quot;</span>):</div>
<div class="line"><span class="lineno">  564</span>        pytest.skip(<span class="stringliteral">&quot;mad and tshift are deprecated&quot;</span>)</div>
<div class="line"><span class="lineno">  565</span>    <span class="keywordflow">if</span> groupby_func <span class="keywordflow">in</span> (<span class="stringliteral">&quot;corrwith&quot;</span>, <span class="stringliteral">&quot;skew&quot;</span>):</div>
<div class="line"><span class="lineno">  566</span>        msg = <span class="stringliteral">&quot;GH#47723 groupby.corrwith and skew do not correctly implement axis=1&quot;</span></div>
<div class="line"><span class="lineno">  567</span>        request.node.add_marker(pytest.mark.xfail(reason=msg))</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>    df = DataFrame(np.random.randn(10, 4), columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>])</div>
<div class="line"><span class="lineno">  570</span>    df[<span class="stringliteral">&quot;E&quot;</span>] = <span class="stringliteral">&quot;x&quot;</span></div>
<div class="line"><span class="lineno">  571</span>    groups = [1, 2, 3, 1, 2, 3, 1, 2, 3, 4]</div>
<div class="line"><span class="lineno">  572</span>    gb = df.groupby(groups)</div>
<div class="line"><span class="lineno">  573</span>    method = getattr(gb, groupby_func)</div>
<div class="line"><span class="lineno">  574</span>    args = get_groupby_method_args(groupby_func, df)</div>
<div class="line"><span class="lineno">  575</span>    kwargs = {<span class="stringliteral">&quot;axis&quot;</span>: 1}</div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">if</span> numeric_only <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  577</span>        <span class="comment"># when numeric_only is None we don&#39;t pass any argument</span></div>
<div class="line"><span class="lineno">  578</span>        kwargs[<span class="stringliteral">&quot;numeric_only&quot;</span>] = numeric_only</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>    <span class="comment"># Functions without numeric_only and axis args</span></div>
<div class="line"><span class="lineno">  581</span>    no_args = (<span class="stringliteral">&quot;cumprod&quot;</span>, <span class="stringliteral">&quot;cumsum&quot;</span>, <span class="stringliteral">&quot;diff&quot;</span>, <span class="stringliteral">&quot;fillna&quot;</span>, <span class="stringliteral">&quot;pct_change&quot;</span>, <span class="stringliteral">&quot;rank&quot;</span>, <span class="stringliteral">&quot;shift&quot;</span>)</div>
<div class="line"><span class="lineno">  582</span>    <span class="comment"># Functions with axis args</span></div>
<div class="line"><span class="lineno">  583</span>    has_axis = (</div>
<div class="line"><span class="lineno">  584</span>        <span class="stringliteral">&quot;cumprod&quot;</span>,</div>
<div class="line"><span class="lineno">  585</span>        <span class="stringliteral">&quot;cumsum&quot;</span>,</div>
<div class="line"><span class="lineno">  586</span>        <span class="stringliteral">&quot;diff&quot;</span>,</div>
<div class="line"><span class="lineno">  587</span>        <span class="stringliteral">&quot;pct_change&quot;</span>,</div>
<div class="line"><span class="lineno">  588</span>        <span class="stringliteral">&quot;rank&quot;</span>,</div>
<div class="line"><span class="lineno">  589</span>        <span class="stringliteral">&quot;shift&quot;</span>,</div>
<div class="line"><span class="lineno">  590</span>        <span class="stringliteral">&quot;cummax&quot;</span>,</div>
<div class="line"><span class="lineno">  591</span>        <span class="stringliteral">&quot;cummin&quot;</span>,</div>
<div class="line"><span class="lineno">  592</span>        <span class="stringliteral">&quot;idxmin&quot;</span>,</div>
<div class="line"><span class="lineno">  593</span>        <span class="stringliteral">&quot;idxmax&quot;</span>,</div>
<div class="line"><span class="lineno">  594</span>        <span class="stringliteral">&quot;fillna&quot;</span>,</div>
<div class="line"><span class="lineno">  595</span>    )</div>
<div class="line"><span class="lineno">  596</span>    <span class="keywordflow">if</span> numeric_only <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> groupby_func <span class="keywordflow">in</span> no_args:</div>
<div class="line"><span class="lineno">  597</span>        msg = <span class="stringliteral">&quot;got an unexpected keyword argument &#39;numeric_only&#39;&quot;</span></div>
<div class="line"><span class="lineno">  598</span>        <span class="keyword">with</span> pytest.raises(TypeError, match=msg):</div>
<div class="line"><span class="lineno">  599</span>            method(*args, **kwargs)</div>
<div class="line"><span class="lineno">  600</span>    <span class="keywordflow">elif</span> groupby_func <span class="keywordflow">not</span> <span class="keywordflow">in</span> has_axis:</div>
<div class="line"><span class="lineno">  601</span>        msg = <span class="stringliteral">&quot;got an unexpected keyword argument &#39;axis&#39;&quot;</span></div>
<div class="line"><span class="lineno">  602</span>        warn = FutureWarning <span class="keywordflow">if</span> groupby_func == <span class="stringliteral">&quot;skew&quot;</span> <span class="keywordflow">and</span> <span class="keywordflow">not</span> numeric_only <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  603</span>        <span class="keyword">with</span> tm.assert_produces_warning(warn, match=<span class="stringliteral">&quot;Dropping of nuisance columns&quot;</span>):</div>
<div class="line"><span class="lineno">  604</span>            <span class="keyword">with</span> pytest.raises(TypeError, match=msg):</div>
<div class="line"><span class="lineno">  605</span>                method(*args, **kwargs)</div>
<div class="line"><span class="lineno">  606</span>    <span class="comment"># fillna and shift are successful even on object dtypes</span></div>
<div class="line"><span class="lineno">  607</span>    <span class="keywordflow">elif</span> (numeric_only <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">or</span> <span class="keywordflow">not</span> numeric_only) <span class="keywordflow">and</span> groupby_func <span class="keywordflow">not</span> <span class="keywordflow">in</span> (</div>
<div class="line"><span class="lineno">  608</span>        <span class="stringliteral">&quot;fillna&quot;</span>,</div>
<div class="line"><span class="lineno">  609</span>        <span class="stringliteral">&quot;shift&quot;</span>,</div>
<div class="line"><span class="lineno">  610</span>    ):</div>
<div class="line"><span class="lineno">  611</span>        msgs = (</div>
<div class="line"><span class="lineno">  612</span>            <span class="comment"># cummax, cummin, rank</span></div>
<div class="line"><span class="lineno">  613</span>            <span class="stringliteral">&quot;not supported between instances of&quot;</span>,</div>
<div class="line"><span class="lineno">  614</span>            <span class="comment"># cumprod</span></div>
<div class="line"><span class="lineno">  615</span>            <span class="stringliteral">&quot;can&#39;t multiply sequence by non-int of type &#39;float&#39;&quot;</span>,</div>
<div class="line"><span class="lineno">  616</span>            <span class="comment"># cumsum, diff, pct_change</span></div>
<div class="line"><span class="lineno">  617</span>            <span class="stringliteral">&quot;unsupported operand type&quot;</span>,</div>
<div class="line"><span class="lineno">  618</span>        )</div>
<div class="line"><span class="lineno">  619</span>        <span class="keyword">with</span> pytest.raises(TypeError, match=f<span class="stringliteral">&quot;({&#39;|&#39;.join(msgs)})&quot;</span>):</div>
<div class="line"><span class="lineno">  620</span>            method(*args, **kwargs)</div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  622</span>        result = method(*args, **kwargs)</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>        df_expected = df.drop(columns=<span class="stringliteral">&quot;E&quot;</span>).T <span class="keywordflow">if</span> numeric_only <span class="keywordflow">else</span> df.T</div>
<div class="line"><span class="lineno">  625</span>        expected = getattr(df_expected, groupby_func)(*args).T</div>
<div class="line"><span class="lineno">  626</span>        <span class="keywordflow">if</span> groupby_func == <span class="stringliteral">&quot;shift&quot;</span> <span class="keywordflow">and</span> <span class="keywordflow">not</span> numeric_only:</div>
<div class="line"><span class="lineno">  627</span>            <span class="comment"># shift with axis=1 leaves the leftmost column as numeric</span></div>
<div class="line"><span class="lineno">  628</span>            <span class="comment"># but transposing for expected gives us object dtype</span></div>
<div class="line"><span class="lineno">  629</span>            expected = expected.astype(float)</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>        tm.assert_equal(result, expected)</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aeae3d0ce3418570ea8f601fe58e6539c" name="aeae3d0ce3418570ea8f601fe58e6539c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae3d0ce3418570ea8f601fe58e6539c">&#9670;&#160;</a></span>test_builtins_apply()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_builtins_apply </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   69</span><span class="keyword">def </span>test_builtins_apply(keys, f):</div>
<div class="line"><span class="lineno">   70</span>    <span class="comment"># see gh-8155</span></div>
<div class="line"><span class="lineno">   71</span>    df = DataFrame(np.random.randint(1, 50, (1000, 2)), columns=[<span class="stringliteral">&quot;jim&quot;</span>, <span class="stringliteral">&quot;joe&quot;</span>])</div>
<div class="line"><span class="lineno">   72</span>    df[<span class="stringliteral">&quot;jolie&quot;</span>] = np.random.randn(1000)</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    gb = df.groupby(keys)</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    fname = f.__name__</div>
<div class="line"><span class="lineno">   77</span>    result = gb.apply(f)</div>
<div class="line"><span class="lineno">   78</span>    ngroups = len(df.drop_duplicates(subset=keys))</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    assert_msg = f<span class="stringliteral">&quot;invalid frame shape: {result.shape} (expected ({ngroups}, 3))&quot;</span></div>
<div class="line"><span class="lineno">   81</span>    <span class="keyword">assert</span> result.shape == (ngroups, 3), assert_msg</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    npfunc = getattr(np, fname)  <span class="comment"># numpy&#39;s equivalent function</span></div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">if</span> f <span class="keywordflow">in</span> [max, min]:</div>
<div class="line"><span class="lineno">   85</span>        warn = FutureWarning</div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   87</span>        warn = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   88</span>    msg = <span class="stringliteral">&quot;scalar (max|min) over the entire DataFrame&quot;</span></div>
<div class="line"><span class="lineno">   89</span>    <span class="keyword">with</span> tm.assert_produces_warning(warn, match=msg, check_stacklevel=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">   90</span>        <span class="comment"># stacklevel can be thrown off because (i think) the stack</span></div>
<div class="line"><span class="lineno">   91</span>        <span class="comment">#  goes through some of numpy&#39;s C code.</span></div>
<div class="line"><span class="lineno">   92</span>        expected = gb.apply(npfunc)</div>
<div class="line"><span class="lineno">   93</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>    <span class="keyword">with</span> tm.assert_produces_warning(<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">   96</span>        expected2 = gb.apply(<span class="keyword">lambda</span> x: npfunc(x, axis=0))</div>
<div class="line"><span class="lineno">   97</span>    tm.assert_frame_equal(result, expected2)</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span> f != sum:</div>
<div class="line"><span class="lineno">  100</span>        expected = gb.agg(fname).reset_index()</div>
<div class="line"><span class="lineno">  101</span>        expected.set_index(keys, inplace=<span class="keyword">True</span>, drop=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  102</span>        tm.assert_frame_equal(result, expected, check_dtype=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    tm.assert_series_equal(getattr(result, fname)(), getattr(df, fname)())</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8e91df5387c55bf399d8ca0ffa2e3ae" name="ad8e91df5387c55bf399d8ca0ffa2e3ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8e91df5387c55bf399d8ca0ffa2e3ae">&#9670;&#160;</a></span>test_corrwith_with_1_axis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_corrwith_with_1_axis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1581</span><span class="keyword">def </span>test_corrwith_with_1_axis():</div>
<div class="line"><span class="lineno"> 1582</span>    <span class="comment"># GH 47723</span></div>
<div class="line"><span class="lineno"> 1583</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2], <span class="stringliteral">&quot;b&quot;</span>: [3, 7, 4]})</div>
<div class="line"><span class="lineno"> 1584</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>).corrwith(df, axis=1)</div>
<div class="line"><span class="lineno"> 1585</span>    index = Index(</div>
<div class="line"><span class="lineno"> 1586</span>        data=[(1, 0), (1, 1), (1, 2), (2, 2), (2, 0), (2, 1)],</div>
<div class="line"><span class="lineno"> 1587</span>        name=(<span class="stringliteral">&quot;a&quot;</span>, <span class="keywordtype">None</span>),</div>
<div class="line"><span class="lineno"> 1588</span>    )</div>
<div class="line"><span class="lineno"> 1589</span>    expected = Series([np.nan] * 6, index=index)</div>
<div class="line"><span class="lineno"> 1590</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1591</span> </div>
<div class="line"><span class="lineno"> 1592</span> </div>
<div class="line"><span class="lineno"> 1593</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:.* is deprecated:FutureWarning&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a735c274a56d14088c362759194cf5f" name="a7a735c274a56d14088c362759194cf5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a735c274a56d14088c362759194cf5f">&#9670;&#160;</a></span>test_cummax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_cummax </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtypes_for_minmax</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  896</span><span class="keyword">def </span>test_cummax(dtypes_for_minmax):</div>
<div class="line"><span class="lineno">  897</span>    dtype = dtypes_for_minmax[0]</div>
<div class="line"><span class="lineno">  898</span>    max_val = dtypes_for_minmax[2]</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>    <span class="comment"># GH 15048</span></div>
<div class="line"><span class="lineno">  901</span>    base_df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [1, 1, 1, 1, 2, 2, 2, 2], <span class="stringliteral">&quot;B&quot;</span>: [3, 4, 3, 2, 2, 3, 2, 1]})</div>
<div class="line"><span class="lineno">  902</span>    expected_maxs = [3, 4, 4, 4, 2, 3, 3, 3]</div>
<div class="line"><span class="lineno">  903</span> </div>
<div class="line"><span class="lineno">  904</span>    df = base_df.astype(dtype)</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>    expected = DataFrame({<span class="stringliteral">&quot;B&quot;</span>: expected_maxs}).astype(dtype)</div>
<div class="line"><span class="lineno">  907</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cummax()</div>
<div class="line"><span class="lineno">  908</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  909</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, group_keys=<span class="keyword">False</span>).B.apply(<span class="keyword">lambda</span> x: x.cummax()).to_frame()</div>
<div class="line"><span class="lineno">  910</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>    <span class="comment"># Test w/ max value for dtype</span></div>
<div class="line"><span class="lineno">  913</span>    df.loc[[2, 6], <span class="stringliteral">&quot;B&quot;</span>] = max_val</div>
<div class="line"><span class="lineno">  914</span>    expected.loc[[2, 3, 6, 7], <span class="stringliteral">&quot;B&quot;</span>] = max_val</div>
<div class="line"><span class="lineno">  915</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cummax()</div>
<div class="line"><span class="lineno">  916</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  917</span>    expected = (</div>
<div class="line"><span class="lineno">  918</span>        df.groupby(<span class="stringliteral">&quot;A&quot;</span>, group_keys=<span class="keyword">False</span>).B.apply(<span class="keyword">lambda</span> x: x.cummax()).to_frame()</div>
<div class="line"><span class="lineno">  919</span>    )</div>
<div class="line"><span class="lineno">  920</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>    <span class="comment"># Test nan in some values</span></div>
<div class="line"><span class="lineno">  923</span>    base_df.loc[[0, 2, 4, 6], <span class="stringliteral">&quot;B&quot;</span>] = np.nan</div>
<div class="line"><span class="lineno">  924</span>    expected = DataFrame({<span class="stringliteral">&quot;B&quot;</span>: [np.nan, 4, np.nan, 4, np.nan, 3, np.nan, 3]})</div>
<div class="line"><span class="lineno">  925</span>    result = base_df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cummax()</div>
<div class="line"><span class="lineno">  926</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  927</span>    expected = (</div>
<div class="line"><span class="lineno">  928</span>        base_df.groupby(<span class="stringliteral">&quot;A&quot;</span>, group_keys=<span class="keyword">False</span>).B.apply(<span class="keyword">lambda</span> x: x.cummax()).to_frame()</div>
<div class="line"><span class="lineno">  929</span>    )</div>
<div class="line"><span class="lineno">  930</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>    <span class="comment"># GH 15561</span></div>
<div class="line"><span class="lineno">  933</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1], <span class="stringliteral">&quot;b&quot;</span>: pd.to_datetime([<span class="stringliteral">&quot;2001&quot;</span>])})</div>
<div class="line"><span class="lineno">  934</span>    expected = Series(pd.to_datetime(<span class="stringliteral">&quot;2001&quot;</span>), index=[0], name=<span class="stringliteral">&quot;b&quot;</span>)</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>)[<span class="stringliteral">&quot;b&quot;</span>].cummax()</div>
<div class="line"><span class="lineno">  937</span>    tm.assert_series_equal(expected, result)</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>    <span class="comment"># GH 15635</span></div>
<div class="line"><span class="lineno">  940</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 2, 1], <span class="stringliteral">&quot;b&quot;</span>: [2, 1, 1]})</div>
<div class="line"><span class="lineno">  941</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>).b.cummax()</div>
<div class="line"><span class="lineno">  942</span>    expected = Series([2, 1, 2], name=<span class="stringliteral">&quot;b&quot;</span>)</div>
<div class="line"><span class="lineno">  943</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  944</span> </div>
<div class="line"><span class="lineno">  945</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a07f9534d7a4c596214f1fcefd36718ef" name="a07f9534d7a4c596214f1fcefd36718ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07f9534d7a4c596214f1fcefd36718ef">&#9670;&#160;</a></span>test_cummax_i8_at_implementation_bound()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_cummax_i8_at_implementation_bound </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  946</span><span class="keyword">def </span>test_cummax_i8_at_implementation_bound():</div>
<div class="line"><span class="lineno">  947</span>    <span class="comment"># the minimum value used to be treated as NPY_NAT+1 instead of NPY_NAT</span></div>
<div class="line"><span class="lineno">  948</span>    <span class="comment">#  for int64 dtype GH#46382</span></div>
<div class="line"><span class="lineno">  949</span>    ser = Series([pd.NaT.value + n <span class="keywordflow">for</span> n <span class="keywordflow">in</span> range(5)])</div>
<div class="line"><span class="lineno">  950</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: 1, <span class="stringliteral">&quot;B&quot;</span>: ser, <span class="stringliteral">&quot;C&quot;</span>: ser.view(<span class="stringliteral">&quot;M8[ns]&quot;</span>)})</div>
<div class="line"><span class="lineno">  951</span>    gb = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  952</span> </div>
<div class="line"><span class="lineno">  953</span>    res = gb.cummax()</div>
<div class="line"><span class="lineno">  954</span>    exp = df[[<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>]]</div>
<div class="line"><span class="lineno">  955</span>    tm.assert_frame_equal(res, exp)</div>
<div class="line"><span class="lineno">  956</span> </div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;cummin&quot;, &quot;cummax&quot;])</span></div>
<div class="line"><span class="lineno">  959</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [&quot;float&quot;, &quot;Int64&quot;, &quot;Float64&quot;])</span></div>
<div class="line"><span class="lineno">  960</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  961</span>    <span class="stringliteral">&quot;groups,expected_data&quot;</span>,</div>
<div class="line"><span class="lineno">  962</span>    [</div>
<div class="line"><span class="lineno">  963</span>        ([1, 1, 1], [1, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>]),</div>
<div class="line"><span class="lineno">  964</span>        ([1, 2, 3], [1, <span class="keywordtype">None</span>, 2]),</div>
<div class="line"><span class="lineno">  965</span>        ([1, 3, 3], [1, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>]),</div>
<div class="line"><span class="lineno">  966</span>    ],</div>
<div class="line"><span class="lineno">  967</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ca4c196d444dcdff127d3944983c7c5" name="a9ca4c196d444dcdff127d3944983c7c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ca4c196d444dcdff127d3944983c7c5">&#9670;&#160;</a></span>test_cummin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_cummin </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtypes_for_minmax</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  829</span><span class="keyword">def </span>test_cummin(dtypes_for_minmax):</div>
<div class="line"><span class="lineno">  830</span>    dtype = dtypes_for_minmax[0]</div>
<div class="line"><span class="lineno">  831</span>    min_val = dtypes_for_minmax[1]</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>    <span class="comment"># GH 15048</span></div>
<div class="line"><span class="lineno">  834</span>    base_df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [1, 1, 1, 1, 2, 2, 2, 2], <span class="stringliteral">&quot;B&quot;</span>: [3, 4, 3, 2, 2, 3, 2, 1]})</div>
<div class="line"><span class="lineno">  835</span>    expected_mins = [3, 3, 3, 2, 2, 2, 2, 1]</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>    df = base_df.astype(dtype)</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    expected = DataFrame({<span class="stringliteral">&quot;B&quot;</span>: expected_mins}).astype(dtype)</div>
<div class="line"><span class="lineno">  840</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cummin()</div>
<div class="line"><span class="lineno">  841</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  842</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, group_keys=<span class="keyword">False</span>).B.apply(<span class="keyword">lambda</span> x: x.cummin()).to_frame()</div>
<div class="line"><span class="lineno">  843</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>    <span class="comment"># Test w/ min value for dtype</span></div>
<div class="line"><span class="lineno">  846</span>    df.loc[[2, 6], <span class="stringliteral">&quot;B&quot;</span>] = min_val</div>
<div class="line"><span class="lineno">  847</span>    df.loc[[1, 5], <span class="stringliteral">&quot;B&quot;</span>] = min_val + 1</div>
<div class="line"><span class="lineno">  848</span>    expected.loc[[2, 3, 6, 7], <span class="stringliteral">&quot;B&quot;</span>] = min_val</div>
<div class="line"><span class="lineno">  849</span>    expected.loc[[1, 5], <span class="stringliteral">&quot;B&quot;</span>] = min_val + 1  <span class="comment"># should not be rounded to min_val</span></div>
<div class="line"><span class="lineno">  850</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cummin()</div>
<div class="line"><span class="lineno">  851</span>    tm.assert_frame_equal(result, expected, check_exact=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  852</span>    expected = (</div>
<div class="line"><span class="lineno">  853</span>        df.groupby(<span class="stringliteral">&quot;A&quot;</span>, group_keys=<span class="keyword">False</span>).B.apply(<span class="keyword">lambda</span> x: x.cummin()).to_frame()</div>
<div class="line"><span class="lineno">  854</span>    )</div>
<div class="line"><span class="lineno">  855</span>    tm.assert_frame_equal(result, expected, check_exact=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>    <span class="comment"># Test nan in some values</span></div>
<div class="line"><span class="lineno">  858</span>    base_df.loc[[0, 2, 4, 6], <span class="stringliteral">&quot;B&quot;</span>] = np.nan</div>
<div class="line"><span class="lineno">  859</span>    expected = DataFrame({<span class="stringliteral">&quot;B&quot;</span>: [np.nan, 4, np.nan, 2, np.nan, 3, np.nan, 1]})</div>
<div class="line"><span class="lineno">  860</span>    result = base_df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cummin()</div>
<div class="line"><span class="lineno">  861</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  862</span>    expected = (</div>
<div class="line"><span class="lineno">  863</span>        base_df.groupby(<span class="stringliteral">&quot;A&quot;</span>, group_keys=<span class="keyword">False</span>).B.apply(<span class="keyword">lambda</span> x: x.cummin()).to_frame()</div>
<div class="line"><span class="lineno">  864</span>    )</div>
<div class="line"><span class="lineno">  865</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>    <span class="comment"># GH 15561</span></div>
<div class="line"><span class="lineno">  868</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1], <span class="stringliteral">&quot;b&quot;</span>: pd.to_datetime([<span class="stringliteral">&quot;2001&quot;</span>])})</div>
<div class="line"><span class="lineno">  869</span>    expected = Series(pd.to_datetime(<span class="stringliteral">&quot;2001&quot;</span>), index=[0], name=<span class="stringliteral">&quot;b&quot;</span>)</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>)[<span class="stringliteral">&quot;b&quot;</span>].cummin()</div>
<div class="line"><span class="lineno">  872</span>    tm.assert_series_equal(expected, result)</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>    <span class="comment"># GH 15635</span></div>
<div class="line"><span class="lineno">  875</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [1, 2, 1], <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 2]})</div>
<div class="line"><span class="lineno">  876</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>).b.cummin()</div>
<div class="line"><span class="lineno">  877</span>    expected = Series([1, 2, 1], name=<span class="stringliteral">&quot;b&quot;</span>)</div>
<div class="line"><span class="lineno">  878</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;cummin&quot;, &quot;cummax&quot;])</span></div>
<div class="line"><span class="lineno">  882</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [&quot;UInt64&quot;, &quot;Int64&quot;, &quot;Float64&quot;, &quot;float&quot;, &quot;boolean&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abd729cdd3d12bcb49b22318796d83031" name="abd729cdd3d12bcb49b22318796d83031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd729cdd3d12bcb49b22318796d83031">&#9670;&#160;</a></span>test_cummin_max_all_nan_column()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_cummin_max_all_nan_column </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  883</span><span class="keyword">def </span>test_cummin_max_all_nan_column(method, dtype):</div>
<div class="line"><span class="lineno">  884</span>    base_df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [1, 1, 1, 1, 2, 2, 2, 2], <span class="stringliteral">&quot;B&quot;</span>: [np.nan] * 8})</div>
<div class="line"><span class="lineno">  885</span>    base_df[<span class="stringliteral">&quot;B&quot;</span>] = base_df[<span class="stringliteral">&quot;B&quot;</span>].astype(dtype)</div>
<div class="line"><span class="lineno">  886</span>    grouped = base_df.groupby(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>    expected = DataFrame({<span class="stringliteral">&quot;B&quot;</span>: [np.nan] * 8}, dtype=dtype)</div>
<div class="line"><span class="lineno">  889</span>    result = getattr(grouped, method)()</div>
<div class="line"><span class="lineno">  890</span>    tm.assert_frame_equal(expected, result)</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>    result = getattr(grouped[<span class="stringliteral">&quot;B&quot;</span>], method)().to_frame()</div>
<div class="line"><span class="lineno">  893</span>    tm.assert_frame_equal(expected, result)</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ac76e3b361c062f3a8fabb7ccaa3d46" name="a5ac76e3b361c062f3a8fabb7ccaa3d46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac76e3b361c062f3a8fabb7ccaa3d46">&#9670;&#160;</a></span>test_cummin_max_skipna()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_cummin_max_skipna </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  968</span><span class="keyword">def </span>test_cummin_max_skipna(method, dtype, groups, expected_data):</div>
<div class="line"><span class="lineno">  969</span>    <span class="comment"># GH-34047</span></div>
<div class="line"><span class="lineno">  970</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: Series([1, <span class="keywordtype">None</span>, 2], dtype=dtype)})</div>
<div class="line"><span class="lineno">  971</span>    orig = df.copy()</div>
<div class="line"><span class="lineno">  972</span>    gb = df.groupby(groups)[<span class="stringliteral">&quot;a&quot;</span>]</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>    result = getattr(gb, method)(skipna=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  975</span>    expected = Series(expected_data, dtype=dtype, name=<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>    <span class="comment"># check we didn&#39;t accidentally alter df</span></div>
<div class="line"><span class="lineno">  978</span>    tm.assert_frame_equal(df, orig)</div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  981</span> </div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;cummin&quot;, &quot;cummax&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abca7780ae1776ff3985c8be6b63f20fe" name="abca7780ae1776ff3985c8be6b63f20fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abca7780ae1776ff3985c8be6b63f20fe">&#9670;&#160;</a></span>test_cummin_max_skipna_multiple_cols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_cummin_max_skipna_multiple_cols </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  984</span><span class="keyword">def </span>test_cummin_max_skipna_multiple_cols(method):</div>
<div class="line"><span class="lineno">  985</span>    <span class="comment"># Ensure missing value in &quot;a&quot; doesn&#39;t cause &quot;b&quot; to be nan-filled</span></div>
<div class="line"><span class="lineno">  986</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [np.nan, 2.0, 2.0], <span class="stringliteral">&quot;b&quot;</span>: [2.0, 2.0, 2.0]})</div>
<div class="line"><span class="lineno">  987</span>    gb = df.groupby([1, 1, 1])[[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>]]</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>    result = getattr(gb, method)(skipna=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  990</span>    expected = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [np.nan, np.nan, np.nan], <span class="stringliteral">&quot;b&quot;</span>: [2.0, 2.0, 2.0]})</div>
<div class="line"><span class="lineno">  991</span> </div>
<div class="line"><span class="lineno">  992</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span> </div>
<div class="line"><span class="lineno">  995</span><span class="preprocessor">@td.skip_if_32bit</span></div>
<div class="line"><span class="lineno">  996</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;cummin&quot;, &quot;cummax&quot;])</span></div>
<div class="line"><span class="lineno">  997</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  998</span>    <span class="stringliteral">&quot;dtype,val&quot;</span>, [(<span class="stringliteral">&quot;UInt64&quot;</span>, np.iinfo(<span class="stringliteral">&quot;uint64&quot;</span>).max), (<span class="stringliteral">&quot;Int64&quot;</span>, 2**53 + 1)]</div>
<div class="line"><span class="lineno">  999</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5dbc0ef49b6c94c14885b0b538b5fd7d" name="a5dbc0ef49b6c94c14885b0b538b5fd7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dbc0ef49b6c94c14885b0b538b5fd7d">&#9670;&#160;</a></span>test_cython_api2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_cython_api2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  372</span><span class="keyword">def </span>test_cython_api2():</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>    <span class="comment"># this takes the fast apply path</span></div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    <span class="comment"># cumsum (GH5614)</span></div>
<div class="line"><span class="lineno">  377</span>    df = DataFrame([[1, 2, np.nan], [1, np.nan, 9], [3, 4, 9]], columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>])</div>
<div class="line"><span class="lineno">  378</span>    expected = DataFrame([[2, np.nan], [np.nan, 9], [4, 9]], columns=[<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>])</div>
<div class="line"><span class="lineno">  379</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cumsum()</div>
<div class="line"><span class="lineno">  380</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>    <span class="comment"># GH 5755 - cumsum is a transformer and should ignore as_index</span></div>
<div class="line"><span class="lineno">  383</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>, as_index=<span class="keyword">False</span>).cumsum()</div>
<div class="line"><span class="lineno">  384</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>    <span class="comment"># GH 13994</span></div>
<div class="line"><span class="lineno">  387</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cumsum(axis=1)</div>
<div class="line"><span class="lineno">  388</span>    expected = df.cumsum(axis=1)</div>
<div class="line"><span class="lineno">  389</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  390</span>    result = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).cumprod(axis=1)</div>
<div class="line"><span class="lineno">  391</span>    expected = df.cumprod(axis=1)</div>
<div class="line"><span class="lineno">  392</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abb3c7ffb99c8b78313d372a30ee1b879" name="abb3c7ffb99c8b78313d372a30ee1b879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb3c7ffb99c8b78313d372a30ee1b879">&#9670;&#160;</a></span>test_cython_median()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_cython_median </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  395</span><span class="keyword">def </span>test_cython_median():</div>
<div class="line"><span class="lineno">  396</span>    df = DataFrame(np.random.randn(1000))</div>
<div class="line"><span class="lineno">  397</span>    df.values[::2] = np.nan</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>    labels = np.random.randint(0, 50, size=1000).astype(float)</div>
<div class="line"><span class="lineno">  400</span>    labels[::17] = np.nan</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>    result = df.groupby(labels).median()</div>
<div class="line"><span class="lineno">  403</span>    exp = df.groupby(labels).agg(nanops.nanmedian)</div>
<div class="line"><span class="lineno">  404</span>    tm.assert_frame_equal(result, exp)</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    df = DataFrame(np.random.randn(1000, 5))</div>
<div class="line"><span class="lineno">  407</span>    rs = df.groupby(labels).agg(np.median)</div>
<div class="line"><span class="lineno">  408</span>    xp = df.groupby(labels).median()</div>
<div class="line"><span class="lineno">  409</span>    tm.assert_frame_equal(rs, xp)</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2aa7896f1ce0e0b7e9a54f27ddf47492" name="a2aa7896f1ce0e0b7e9a54f27ddf47492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aa7896f1ce0e0b7e9a54f27ddf47492">&#9670;&#160;</a></span>test_deprecate_numeric_only()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_deprecate_numeric_only </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>numeric_only_default</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>drops_nuisance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>has_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>numeric_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1378</span>):</div>
<div class="line"><span class="lineno"> 1379</span>    <span class="comment"># GH#46072</span></div>
<div class="line"><span class="lineno"> 1380</span>    <span class="comment"># drops_nuisance: Whether the op drops nuisance columns even when numeric_only=False</span></div>
<div class="line"><span class="lineno"> 1381</span>    <span class="comment"># has_arg: Whether the op has a numeric_only arg</span></div>
<div class="line"><span class="lineno"> 1382</span>    df = DataFrame({<span class="stringliteral">&quot;a1&quot;</span>: [1, 1], <span class="stringliteral">&quot;a2&quot;</span>: [2, 2], <span class="stringliteral">&quot;a3&quot;</span>: [5, 6], <span class="stringliteral">&quot;b&quot;</span>: 2 * [object]})</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span>    args = get_groupby_method_args(kernel, df)</div>
<div class="line"><span class="lineno"> 1385</span>    kwargs = {} <span class="keywordflow">if</span> numeric_only <span class="keywordflow">is</span> lib.no_default <span class="keywordflow">else</span> {<span class="stringliteral">&quot;numeric_only&quot;</span>: numeric_only}</div>
<div class="line"><span class="lineno"> 1386</span> </div>
<div class="line"><span class="lineno"> 1387</span>    gb = df.groupby(keys)</div>
<div class="line"><span class="lineno"> 1388</span>    method = getattr(gb, kernel)</div>
<div class="line"><span class="lineno"> 1389</span>    <span class="keywordflow">if</span> has_arg <span class="keywordflow">and</span> (</div>
<div class="line"><span class="lineno"> 1390</span>        <span class="comment"># Cases where b does not appear in the result</span></div>
<div class="line"><span class="lineno"> 1391</span>        numeric_only <span class="keywordflow">is</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 1392</span>        <span class="keywordflow">or</span> (numeric_only <span class="keywordflow">is</span> lib.no_default <span class="keywordflow">and</span> numeric_only_default)</div>
<div class="line"><span class="lineno"> 1393</span>        <span class="keywordflow">or</span> drops_nuisance</div>
<div class="line"><span class="lineno"> 1394</span>    ):</div>
<div class="line"><span class="lineno"> 1395</span>        <span class="keywordflow">if</span> numeric_only <span class="keywordflow">is</span> <span class="keyword">True</span> <span class="keywordflow">or</span> (<span class="keywordflow">not</span> numeric_only_default <span class="keywordflow">and</span> <span class="keywordflow">not</span> drops_nuisance):</div>
<div class="line"><span class="lineno"> 1396</span>            warn = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1397</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1398</span>            warn = FutureWarning</div>
<div class="line"><span class="lineno"> 1399</span>        <span class="keywordflow">if</span> numeric_only <span class="keywordflow">is</span> lib.no_default <span class="keywordflow">and</span> numeric_only_default:</div>
<div class="line"><span class="lineno"> 1400</span>            msg = f<span class="stringliteral">&quot;The default value of numeric_only in DataFrameGroupBy.{kernel}&quot;</span></div>
<div class="line"><span class="lineno"> 1401</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1402</span>            msg = f<span class="stringliteral">&quot;Dropping invalid columns in DataFrameGroupBy.{kernel}&quot;</span></div>
<div class="line"><span class="lineno"> 1403</span>        <span class="keyword">with</span> tm.assert_produces_warning(warn, match=msg):</div>
<div class="line"><span class="lineno"> 1404</span>            result = method(*args, **kwargs)</div>
<div class="line"><span class="lineno"> 1405</span> </div>
<div class="line"><span class="lineno"> 1406</span>        <span class="keyword">assert</span> <span class="stringliteral">&quot;b&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> result.columns</div>
<div class="line"><span class="lineno"> 1407</span>    <span class="keywordflow">elif</span> (</div>
<div class="line"><span class="lineno"> 1408</span>        <span class="comment"># kernels that work on any dtype and have numeric_only arg</span></div>
<div class="line"><span class="lineno"> 1409</span>        kernel <span class="keywordflow">in</span> (<span class="stringliteral">&quot;first&quot;</span>, <span class="stringliteral">&quot;last&quot;</span>)</div>
<div class="line"><span class="lineno"> 1410</span>        <span class="keywordflow">or</span> (</div>
<div class="line"><span class="lineno"> 1411</span>            <span class="comment"># kernels that work on any dtype and don&#39;t have numeric_only arg</span></div>
<div class="line"><span class="lineno"> 1412</span>            kernel <span class="keywordflow">in</span> (<span class="stringliteral">&quot;any&quot;</span>, <span class="stringliteral">&quot;all&quot;</span>, <span class="stringliteral">&quot;bfill&quot;</span>, <span class="stringliteral">&quot;ffill&quot;</span>, <span class="stringliteral">&quot;fillna&quot;</span>, <span class="stringliteral">&quot;nth&quot;</span>, <span class="stringliteral">&quot;nunique&quot;</span>)</div>
<div class="line"><span class="lineno"> 1413</span>            <span class="keywordflow">and</span> numeric_only <span class="keywordflow">is</span> lib.no_default</div>
<div class="line"><span class="lineno"> 1414</span>        )</div>
<div class="line"><span class="lineno"> 1415</span>    ):</div>
<div class="line"><span class="lineno"> 1416</span>        result = method(*args, **kwargs)</div>
<div class="line"><span class="lineno"> 1417</span>        <span class="keyword">assert</span> <span class="stringliteral">&quot;b&quot;</span> <span class="keywordflow">in</span> result.columns</div>
<div class="line"><span class="lineno"> 1418</span>    <span class="keywordflow">elif</span> has_arg:</div>
<div class="line"><span class="lineno"> 1419</span>        <span class="keyword">assert</span> numeric_only <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 1420</span>        <span class="keyword">assert</span> numeric_only <span class="keywordflow">is</span> <span class="keywordflow">not</span> lib.no_default <span class="keywordflow">or</span> numeric_only_default <span class="keywordflow">is</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1421</span>        <span class="keyword">assert</span> <span class="keywordflow">not</span> drops_nuisance</div>
<div class="line"><span class="lineno"> 1422</span>        <span class="comment"># kernels that are successful on any dtype were above; this will fail</span></div>
<div class="line"><span class="lineno"> 1423</span>        msg = (</div>
<div class="line"><span class="lineno"> 1424</span>            <span class="stringliteral">&quot;(not allowed for this dtype&quot;</span></div>
<div class="line"><span class="lineno"> 1425</span>            <span class="stringliteral">&quot;|must be a string or a number&quot;</span></div>
<div class="line"><span class="lineno"> 1426</span>            <span class="stringliteral">&quot;|cannot be performed against &#39;object&#39; dtypes&quot;</span></div>
<div class="line"><span class="lineno"> 1427</span>            <span class="stringliteral">&quot;|must be a string or a real number&quot;</span></div>
<div class="line"><span class="lineno"> 1428</span>            <span class="stringliteral">&quot;|unsupported operand type)&quot;</span></div>
<div class="line"><span class="lineno"> 1429</span>        )</div>
<div class="line"><span class="lineno"> 1430</span>        <span class="keyword">with</span> pytest.raises(TypeError, match=msg):</div>
<div class="line"><span class="lineno"> 1431</span>            method(*args, **kwargs)</div>
<div class="line"><span class="lineno"> 1432</span>    <span class="keywordflow">elif</span> <span class="keywordflow">not</span> has_arg <span class="keywordflow">and</span> numeric_only <span class="keywordflow">is</span> <span class="keywordflow">not</span> lib.no_default:</div>
<div class="line"><span class="lineno"> 1433</span>        <span class="keyword">with</span> pytest.raises(</div>
<div class="line"><span class="lineno"> 1434</span>            TypeError, match=<span class="stringliteral">&quot;got an unexpected keyword argument &#39;numeric_only&#39;&quot;</span></div>
<div class="line"><span class="lineno"> 1435</span>        ):</div>
<div class="line"><span class="lineno"> 1436</span>            method(*args, **kwargs)</div>
<div class="line"><span class="lineno"> 1437</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1438</span>        <span class="keyword">assert</span> kernel <span class="keywordflow">in</span> (<span class="stringliteral">&quot;diff&quot;</span>, <span class="stringliteral">&quot;pct_change&quot;</span>)</div>
<div class="line"><span class="lineno"> 1439</span>        <span class="keyword">assert</span> numeric_only <span class="keywordflow">is</span> lib.no_default</div>
<div class="line"><span class="lineno"> 1440</span>        <span class="comment"># Doesn&#39;t have numeric_only argument and fails on nuisance columns</span></div>
<div class="line"><span class="lineno"> 1441</span>        <span class="keyword">with</span> pytest.raises(TypeError, match=<span class="stringliteral">r&quot;unsupported operand type&quot;</span>):</div>
<div class="line"><span class="lineno"> 1442</span>            method(*args, **kwargs)</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span> </div>
<div class="line"><span class="lineno"> 1445</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [bool, int, float, object])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a26f69199c04e50106aa54d339f5093ec" name="a26f69199c04e50106aa54d339f5093ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f69199c04e50106aa54d339f5093ec">&#9670;&#160;</a></span>test_deprecate_numeric_only_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_deprecate_numeric_only_series </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groupby_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1446</span><span class="keyword">def </span>test_deprecate_numeric_only_series(dtype, groupby_func, request):</div>
<div class="line"><span class="lineno"> 1447</span>    <span class="comment"># GH#46560</span></div>
<div class="line"><span class="lineno"> 1448</span>    <span class="keywordflow">if</span> groupby_func <span class="keywordflow">in</span> (<span class="stringliteral">&quot;backfill&quot;</span>, <span class="stringliteral">&quot;mad&quot;</span>, <span class="stringliteral">&quot;pad&quot;</span>, <span class="stringliteral">&quot;tshift&quot;</span>):</div>
<div class="line"><span class="lineno"> 1449</span>        pytest.skip(<span class="stringliteral">&quot;method is deprecated&quot;</span>)</div>
<div class="line"><span class="lineno"> 1450</span>    <span class="keywordflow">elif</span> groupby_func == <span class="stringliteral">&quot;corrwith&quot;</span>:</div>
<div class="line"><span class="lineno"> 1451</span>        msg = <span class="stringliteral">&quot;corrwith is not implemented on SeriesGroupBy&quot;</span></div>
<div class="line"><span class="lineno"> 1452</span>        request.node.add_marker(pytest.mark.xfail(reason=msg))</div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span>    grouper = [0, 0, 1]</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>    ser = Series([1, 0, 0], dtype=dtype)</div>
<div class="line"><span class="lineno"> 1457</span>    gb = ser.groupby(grouper)</div>
<div class="line"><span class="lineno"> 1458</span>    method = getattr(gb, groupby_func)</div>
<div class="line"><span class="lineno"> 1459</span> </div>
<div class="line"><span class="lineno"> 1460</span>    expected_ser = Series([1, 0, 0])</div>
<div class="line"><span class="lineno"> 1461</span>    expected_gb = expected_ser.groupby(grouper)</div>
<div class="line"><span class="lineno"> 1462</span>    expected_method = getattr(expected_gb, groupby_func)</div>
<div class="line"><span class="lineno"> 1463</span> </div>
<div class="line"><span class="lineno"> 1464</span>    args = get_groupby_method_args(groupby_func, ser)</div>
<div class="line"><span class="lineno"> 1465</span> </div>
<div class="line"><span class="lineno"> 1466</span>    fails_on_numeric_object = (</div>
<div class="line"><span class="lineno"> 1467</span>        <span class="stringliteral">&quot;corr&quot;</span>,</div>
<div class="line"><span class="lineno"> 1468</span>        <span class="stringliteral">&quot;cov&quot;</span>,</div>
<div class="line"><span class="lineno"> 1469</span>        <span class="stringliteral">&quot;cummax&quot;</span>,</div>
<div class="line"><span class="lineno"> 1470</span>        <span class="stringliteral">&quot;cummin&quot;</span>,</div>
<div class="line"><span class="lineno"> 1471</span>        <span class="stringliteral">&quot;cumprod&quot;</span>,</div>
<div class="line"><span class="lineno"> 1472</span>        <span class="stringliteral">&quot;cumsum&quot;</span>,</div>
<div class="line"><span class="lineno"> 1473</span>        <span class="stringliteral">&quot;idxmax&quot;</span>,</div>
<div class="line"><span class="lineno"> 1474</span>        <span class="stringliteral">&quot;idxmin&quot;</span>,</div>
<div class="line"><span class="lineno"> 1475</span>        <span class="stringliteral">&quot;quantile&quot;</span>,</div>
<div class="line"><span class="lineno"> 1476</span>    )</div>
<div class="line"><span class="lineno"> 1477</span>    <span class="comment"># ops that give an object result on object input</span></div>
<div class="line"><span class="lineno"> 1478</span>    obj_result = (</div>
<div class="line"><span class="lineno"> 1479</span>        <span class="stringliteral">&quot;first&quot;</span>,</div>
<div class="line"><span class="lineno"> 1480</span>        <span class="stringliteral">&quot;last&quot;</span>,</div>
<div class="line"><span class="lineno"> 1481</span>        <span class="stringliteral">&quot;nth&quot;</span>,</div>
<div class="line"><span class="lineno"> 1482</span>        <span class="stringliteral">&quot;bfill&quot;</span>,</div>
<div class="line"><span class="lineno"> 1483</span>        <span class="stringliteral">&quot;ffill&quot;</span>,</div>
<div class="line"><span class="lineno"> 1484</span>        <span class="stringliteral">&quot;shift&quot;</span>,</div>
<div class="line"><span class="lineno"> 1485</span>        <span class="stringliteral">&quot;sum&quot;</span>,</div>
<div class="line"><span class="lineno"> 1486</span>        <span class="stringliteral">&quot;diff&quot;</span>,</div>
<div class="line"><span class="lineno"> 1487</span>        <span class="stringliteral">&quot;pct_change&quot;</span>,</div>
<div class="line"><span class="lineno"> 1488</span>    )</div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span>    <span class="comment"># Test default behavior; kernels that fail may be enabled in the future but kernels</span></div>
<div class="line"><span class="lineno"> 1491</span>    <span class="comment"># that succeed should not be allowed to fail (without deprecation, at least)</span></div>
<div class="line"><span class="lineno"> 1492</span>    <span class="keywordflow">if</span> groupby_func <span class="keywordflow">in</span> fails_on_numeric_object <span class="keywordflow">and</span> dtype <span class="keywordflow">is</span> object:</div>
<div class="line"><span class="lineno"> 1493</span>        <span class="keywordflow">if</span> groupby_func <span class="keywordflow">in</span> (<span class="stringliteral">&quot;idxmax&quot;</span>, <span class="stringliteral">&quot;idxmin&quot;</span>):</div>
<div class="line"><span class="lineno"> 1494</span>            msg = <span class="stringliteral">&quot;not allowed for this dtype&quot;</span></div>
<div class="line"><span class="lineno"> 1495</span>        <span class="keywordflow">elif</span> groupby_func == <span class="stringliteral">&quot;quantile&quot;</span>:</div>
<div class="line"><span class="lineno"> 1496</span>            msg = <span class="stringliteral">&quot;cannot be performed against &#39;object&#39; dtypes&quot;</span></div>
<div class="line"><span class="lineno"> 1497</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1498</span>            msg = <span class="stringliteral">&quot;is not supported for object dtype&quot;</span></div>
<div class="line"><span class="lineno"> 1499</span>        <span class="keyword">with</span> pytest.raises(TypeError, match=msg):</div>
<div class="line"><span class="lineno"> 1500</span>            method(*args)</div>
<div class="line"><span class="lineno"> 1501</span>    <span class="keywordflow">elif</span> dtype <span class="keywordflow">is</span> object:</div>
<div class="line"><span class="lineno"> 1502</span>        result = method(*args)</div>
<div class="line"><span class="lineno"> 1503</span>        expected = expected_method(*args)</div>
<div class="line"><span class="lineno"> 1504</span>        <span class="keywordflow">if</span> groupby_func <span class="keywordflow">in</span> obj_result:</div>
<div class="line"><span class="lineno"> 1505</span>            expected = expected.astype(object)</div>
<div class="line"><span class="lineno"> 1506</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1507</span> </div>
<div class="line"><span class="lineno"> 1508</span>    has_numeric_only = (</div>
<div class="line"><span class="lineno"> 1509</span>        <span class="stringliteral">&quot;first&quot;</span>,</div>
<div class="line"><span class="lineno"> 1510</span>        <span class="stringliteral">&quot;last&quot;</span>,</div>
<div class="line"><span class="lineno"> 1511</span>        <span class="stringliteral">&quot;max&quot;</span>,</div>
<div class="line"><span class="lineno"> 1512</span>        <span class="stringliteral">&quot;mean&quot;</span>,</div>
<div class="line"><span class="lineno"> 1513</span>        <span class="stringliteral">&quot;median&quot;</span>,</div>
<div class="line"><span class="lineno"> 1514</span>        <span class="stringliteral">&quot;min&quot;</span>,</div>
<div class="line"><span class="lineno"> 1515</span>        <span class="stringliteral">&quot;prod&quot;</span>,</div>
<div class="line"><span class="lineno"> 1516</span>        <span class="stringliteral">&quot;quantile&quot;</span>,</div>
<div class="line"><span class="lineno"> 1517</span>        <span class="stringliteral">&quot;sem&quot;</span>,</div>
<div class="line"><span class="lineno"> 1518</span>        <span class="stringliteral">&quot;skew&quot;</span>,</div>
<div class="line"><span class="lineno"> 1519</span>        <span class="stringliteral">&quot;std&quot;</span>,</div>
<div class="line"><span class="lineno"> 1520</span>        <span class="stringliteral">&quot;sum&quot;</span>,</div>
<div class="line"><span class="lineno"> 1521</span>        <span class="stringliteral">&quot;var&quot;</span>,</div>
<div class="line"><span class="lineno"> 1522</span>        <span class="stringliteral">&quot;cummax&quot;</span>,</div>
<div class="line"><span class="lineno"> 1523</span>        <span class="stringliteral">&quot;cummin&quot;</span>,</div>
<div class="line"><span class="lineno"> 1524</span>        <span class="stringliteral">&quot;cumprod&quot;</span>,</div>
<div class="line"><span class="lineno"> 1525</span>        <span class="stringliteral">&quot;cumsum&quot;</span>,</div>
<div class="line"><span class="lineno"> 1526</span>    )</div>
<div class="line"><span class="lineno"> 1527</span>    <span class="keywordflow">if</span> groupby_func <span class="keywordflow">not</span> <span class="keywordflow">in</span> has_numeric_only:</div>
<div class="line"><span class="lineno"> 1528</span>        msg = <span class="stringliteral">&quot;got an unexpected keyword argument &#39;numeric_only&#39;&quot;</span></div>
<div class="line"><span class="lineno"> 1529</span>        <span class="keyword">with</span> pytest.raises(TypeError, match=msg):</div>
<div class="line"><span class="lineno"> 1530</span>            method(*args, numeric_only=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordflow">elif</span> dtype <span class="keywordflow">is</span> object:</div>
<div class="line"><span class="lineno"> 1532</span>        err_category = NotImplementedError</div>
<div class="line"><span class="lineno"> 1533</span>        err_msg = f<span class="stringliteral">&quot;{groupby_func} does not implement numeric_only&quot;</span></div>
<div class="line"><span class="lineno"> 1534</span>        <span class="keywordflow">if</span> groupby_func.startswith(<span class="stringliteral">&quot;cum&quot;</span>):</div>
<div class="line"><span class="lineno"> 1535</span>            <span class="comment"># cum ops already exhibit future behavior</span></div>
<div class="line"><span class="lineno"> 1536</span>            warn_category = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1537</span>            warn_msg = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1538</span>            err_category = TypeError</div>
<div class="line"><span class="lineno"> 1539</span>            err_msg = f<span class="stringliteral">&quot;{groupby_func} is not supported for object dtype&quot;</span></div>
<div class="line"><span class="lineno"> 1540</span>        <span class="keywordflow">elif</span> groupby_func == <span class="stringliteral">&quot;skew&quot;</span>:</div>
<div class="line"><span class="lineno"> 1541</span>            warn_category = FutureWarning</div>
<div class="line"><span class="lineno"> 1542</span>            warn_msg = <span class="stringliteral">&quot;will raise a TypeError in the future&quot;</span></div>
<div class="line"><span class="lineno"> 1543</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1544</span>            warn_category = FutureWarning</div>
<div class="line"><span class="lineno"> 1545</span>            warn_msg = <span class="stringliteral">&quot;This will raise a TypeError&quot;</span></div>
<div class="line"><span class="lineno"> 1546</span> </div>
<div class="line"><span class="lineno"> 1547</span>        <span class="keyword">with</span> tm.assert_produces_warning(warn_category, match=warn_msg):</div>
<div class="line"><span class="lineno"> 1548</span>            <span class="keyword">with</span> pytest.raises(err_category, match=err_msg):</div>
<div class="line"><span class="lineno"> 1549</span>                method(*args, numeric_only=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1550</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1551</span>        result = method(*args, numeric_only=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1552</span>        expected = method(*args, numeric_only=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1553</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span> </div>
<div class="line"><span class="lineno"> 1556</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [int, float, object])</span></div>
<div class="line"><span class="lineno"> 1557</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1558</span>    <span class="stringliteral">&quot;kwargs&quot;</span>,</div>
<div class="line"><span class="lineno"> 1559</span>    [</div>
<div class="line"><span class="lineno"> 1560</span>        {<span class="stringliteral">&quot;percentiles&quot;</span>: [0.10, 0.20, 0.30], <span class="stringliteral">&quot;include&quot;</span>: <span class="stringliteral">&quot;all&quot;</span>, <span class="stringliteral">&quot;exclude&quot;</span>: <span class="keywordtype">None</span>},</div>
<div class="line"><span class="lineno"> 1561</span>        {<span class="stringliteral">&quot;percentiles&quot;</span>: [0.10, 0.20, 0.30], <span class="stringliteral">&quot;include&quot;</span>: <span class="keywordtype">None</span>, <span class="stringliteral">&quot;exclude&quot;</span>: [<span class="stringliteral">&quot;int&quot;</span>]},</div>
<div class="line"><span class="lineno"> 1562</span>        {<span class="stringliteral">&quot;percentiles&quot;</span>: [0.10, 0.20, 0.30], <span class="stringliteral">&quot;include&quot;</span>: [<span class="stringliteral">&quot;int&quot;</span>], <span class="stringliteral">&quot;exclude&quot;</span>: <span class="keywordtype">None</span>},</div>
<div class="line"><span class="lineno"> 1563</span>    ],</div>
<div class="line"><span class="lineno"> 1564</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4515ebe762cd795d79ee7a73b8c4ccde" name="a4515ebe762cd795d79ee7a73b8c4ccde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4515ebe762cd795d79ee7a73b8c4ccde">&#9670;&#160;</a></span>test_describe_with_duplicate_output_column_names()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_describe_with_duplicate_output_column_names </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>as_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1190</span><span class="keyword">def </span>test_describe_with_duplicate_output_column_names(as_index):</div>
<div class="line"><span class="lineno"> 1191</span>    <span class="comment"># GH 35314</span></div>
<div class="line"><span class="lineno"> 1192</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1193</span>        {</div>
<div class="line"><span class="lineno"> 1194</span>            <span class="stringliteral">&quot;a&quot;</span>: [99, 99, 99, 88, 88, 88],</div>
<div class="line"><span class="lineno"> 1195</span>            <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 3, 4, 5, 6],</div>
<div class="line"><span class="lineno"> 1196</span>            <span class="stringliteral">&quot;c&quot;</span>: [10, 20, 30, 40, 50, 60],</div>
<div class="line"><span class="lineno"> 1197</span>        },</div>
<div class="line"><span class="lineno"> 1198</span>        columns=[<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>],</div>
<div class="line"><span class="lineno"> 1199</span>        copy=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1200</span>    )</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>    expected = (</div>
<div class="line"><span class="lineno"> 1203</span>        DataFrame.from_records(</div>
<div class="line"><span class="lineno"> 1204</span>            [</div>
<div class="line"><span class="lineno"> 1205</span>                (<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;count&quot;</span>, 3.0, 3.0),</div>
<div class="line"><span class="lineno"> 1206</span>                (<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>, 88.0, 99.0),</div>
<div class="line"><span class="lineno"> 1207</span>                (<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;std&quot;</span>, 0.0, 0.0),</div>
<div class="line"><span class="lineno"> 1208</span>                (<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>, 88.0, 99.0),</div>
<div class="line"><span class="lineno"> 1209</span>                (<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;25%&quot;</span>, 88.0, 99.0),</div>
<div class="line"><span class="lineno"> 1210</span>                (<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;50%&quot;</span>, 88.0, 99.0),</div>
<div class="line"><span class="lineno"> 1211</span>                (<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;75%&quot;</span>, 88.0, 99.0),</div>
<div class="line"><span class="lineno"> 1212</span>                (<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>, 88.0, 99.0),</div>
<div class="line"><span class="lineno"> 1213</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;count&quot;</span>, 3.0, 3.0),</div>
<div class="line"><span class="lineno"> 1214</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>, 5.0, 2.0),</div>
<div class="line"><span class="lineno"> 1215</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;std&quot;</span>, 1.0, 1.0),</div>
<div class="line"><span class="lineno"> 1216</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>, 4.0, 1.0),</div>
<div class="line"><span class="lineno"> 1217</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;25%&quot;</span>, 4.5, 1.5),</div>
<div class="line"><span class="lineno"> 1218</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;50%&quot;</span>, 5.0, 2.0),</div>
<div class="line"><span class="lineno"> 1219</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;75%&quot;</span>, 5.5, 2.5),</div>
<div class="line"><span class="lineno"> 1220</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>, 6.0, 3.0),</div>
<div class="line"><span class="lineno"> 1221</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;count&quot;</span>, 3.0, 3.0),</div>
<div class="line"><span class="lineno"> 1222</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>, 5.0, 2.0),</div>
<div class="line"><span class="lineno"> 1223</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;std&quot;</span>, 1.0, 1.0),</div>
<div class="line"><span class="lineno"> 1224</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>, 4.0, 1.0),</div>
<div class="line"><span class="lineno"> 1225</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;25%&quot;</span>, 4.5, 1.5),</div>
<div class="line"><span class="lineno"> 1226</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;50%&quot;</span>, 5.0, 2.0),</div>
<div class="line"><span class="lineno"> 1227</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;75%&quot;</span>, 5.5, 2.5),</div>
<div class="line"><span class="lineno"> 1228</span>                (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>, 6.0, 3.0),</div>
<div class="line"><span class="lineno"> 1229</span>            ],</div>
<div class="line"><span class="lineno"> 1230</span>        )</div>
<div class="line"><span class="lineno"> 1231</span>        .set_index([0, 1])</div>
<div class="line"><span class="lineno"> 1232</span>        .T</div>
<div class="line"><span class="lineno"> 1233</span>    )</div>
<div class="line"><span class="lineno"> 1234</span>    expected.columns.names = [<span class="keywordtype">None</span>, <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno"> 1235</span>    expected.index = Index([88, 99], name=<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>    <span class="keywordflow">if</span> as_index:</div>
<div class="line"><span class="lineno"> 1238</span>        expected = expected.drop(columns=[<span class="stringliteral">&quot;a&quot;</span>], level=0)</div>
<div class="line"><span class="lineno"> 1239</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1240</span>        expected = expected.reset_index(drop=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>, as_index=as_index).describe()</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1245</span> </div>
<div class="line"><span class="lineno"> 1246</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9091717cb21db7420f923d3cd0357b99" name="a9091717cb21db7420f923d3cd0357b99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9091717cb21db7420f923d3cd0357b99">&#9670;&#160;</a></span>test_frame_describe_multikey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_frame_describe_multikey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tsframe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1112</span><span class="keyword">def </span>test_frame_describe_multikey(tsframe):</div>
<div class="line"><span class="lineno"> 1113</span>    grouped = tsframe.groupby([<span class="keyword">lambda</span> x: x.year, <span class="keyword">lambda</span> x: x.month])</div>
<div class="line"><span class="lineno"> 1114</span>    result = grouped.describe()</div>
<div class="line"><span class="lineno"> 1115</span>    desc_groups = []</div>
<div class="line"><span class="lineno"> 1116</span>    <span class="keywordflow">for</span> col <span class="keywordflow">in</span> tsframe:</div>
<div class="line"><span class="lineno"> 1117</span>        group = grouped[col].describe()</div>
<div class="line"><span class="lineno"> 1118</span>        <span class="comment"># GH 17464 - Remove duplicate MultiIndex levels</span></div>
<div class="line"><span class="lineno"> 1119</span>        group_col = MultiIndex(</div>
<div class="line"><span class="lineno"> 1120</span>            levels=[[col], group.columns],</div>
<div class="line"><span class="lineno"> 1121</span>            codes=[[0] * len(group.columns), range(len(group.columns))],</div>
<div class="line"><span class="lineno"> 1122</span>        )</div>
<div class="line"><span class="lineno"> 1123</span>        group = DataFrame(group.values, columns=group_col, index=group.index)</div>
<div class="line"><span class="lineno"> 1124</span>        desc_groups.append(group)</div>
<div class="line"><span class="lineno"> 1125</span>    expected = pd.concat(desc_groups, axis=1)</div>
<div class="line"><span class="lineno"> 1126</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>    groupedT = tsframe.groupby({<span class="stringliteral">&quot;A&quot;</span>: 0, <span class="stringliteral">&quot;B&quot;</span>: 0, <span class="stringliteral">&quot;C&quot;</span>: 1, <span class="stringliteral">&quot;D&quot;</span>: 1}, axis=1)</div>
<div class="line"><span class="lineno"> 1129</span>    result = groupedT.describe()</div>
<div class="line"><span class="lineno"> 1130</span>    expected = tsframe.describe().T</div>
<div class="line"><span class="lineno"> 1131</span>    <span class="comment"># reverting the change from https://github.com/pandas-dev/pandas/pull/35441/</span></div>
<div class="line"><span class="lineno"> 1132</span>    expected.index = MultiIndex(</div>
<div class="line"><span class="lineno"> 1133</span>        levels=[[0, 1], expected.index],</div>
<div class="line"><span class="lineno"> 1134</span>        codes=[[0, 0, 1, 1], range(len(expected.index))],</div>
<div class="line"><span class="lineno"> 1135</span>    )</div>
<div class="line"><span class="lineno"> 1136</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af164a2c03499bbab3705825f3c551520" name="af164a2c03499bbab3705825f3c551520"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af164a2c03499bbab3705825f3c551520">&#9670;&#160;</a></span>test_frame_describe_tupleindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_frame_describe_tupleindex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1139</span><span class="keyword">def </span>test_frame_describe_tupleindex():</div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>    <span class="comment"># GH 14848 - regression from 0.19.0 to 0.19.1</span></div>
<div class="line"><span class="lineno"> 1142</span>    df1 = DataFrame(</div>
<div class="line"><span class="lineno"> 1143</span>        {</div>
<div class="line"><span class="lineno"> 1144</span>            <span class="stringliteral">&quot;x&quot;</span>: [1, 2, 3, 4, 5] * 3,</div>
<div class="line"><span class="lineno"> 1145</span>            <span class="stringliteral">&quot;y&quot;</span>: [10, 20, 30, 40, 50] * 3,</div>
<div class="line"><span class="lineno"> 1146</span>            <span class="stringliteral">&quot;z&quot;</span>: [100, 200, 300, 400, 500] * 3,</div>
<div class="line"><span class="lineno"> 1147</span>        }</div>
<div class="line"><span class="lineno"> 1148</span>    )</div>
<div class="line"><span class="lineno"> 1149</span>    df1[<span class="stringliteral">&quot;k&quot;</span>] = [(0, 0, 1), (0, 1, 0), (1, 0, 0)] * 5</div>
<div class="line"><span class="lineno"> 1150</span>    df2 = df1.rename(columns={<span class="stringliteral">&quot;k&quot;</span>: <span class="stringliteral">&quot;key&quot;</span>})</div>
<div class="line"><span class="lineno"> 1151</span>    msg = <span class="stringliteral">&quot;Names should be list-like for a MultiIndex&quot;</span></div>
<div class="line"><span class="lineno"> 1152</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno"> 1153</span>        df1.groupby(<span class="stringliteral">&quot;k&quot;</span>).describe()</div>
<div class="line"><span class="lineno"> 1154</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno"> 1155</span>        df2.groupby(<span class="stringliteral">&quot;key&quot;</span>).describe()</div>
<div class="line"><span class="lineno"> 1156</span> </div>
<div class="line"><span class="lineno"> 1157</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ebe92725fcb2788b362891dde3d34f9" name="a9ebe92725fcb2788b362891dde3d34f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ebe92725fcb2788b362891dde3d34f9">&#9670;&#160;</a></span>test_frame_describe_unstacked_format()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_frame_describe_unstacked_format </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1158</span><span class="keyword">def </span>test_frame_describe_unstacked_format():</div>
<div class="line"><span class="lineno"> 1159</span>    <span class="comment"># GH 4792</span></div>
<div class="line"><span class="lineno"> 1160</span>    prices = {</div>
<div class="line"><span class="lineno"> 1161</span>        Timestamp(<span class="stringliteral">&quot;2011-01-06 10:59:05&quot;</span>, tz=<span class="keywordtype">None</span>): 24990,</div>
<div class="line"><span class="lineno"> 1162</span>        Timestamp(<span class="stringliteral">&quot;2011-01-06 12:43:33&quot;</span>, tz=<span class="keywordtype">None</span>): 25499,</div>
<div class="line"><span class="lineno"> 1163</span>        Timestamp(<span class="stringliteral">&quot;2011-01-06 12:54:09&quot;</span>, tz=<span class="keywordtype">None</span>): 25499,</div>
<div class="line"><span class="lineno"> 1164</span>    }</div>
<div class="line"><span class="lineno"> 1165</span>    volumes = {</div>
<div class="line"><span class="lineno"> 1166</span>        Timestamp(<span class="stringliteral">&quot;2011-01-06 10:59:05&quot;</span>, tz=<span class="keywordtype">None</span>): 1500000000,</div>
<div class="line"><span class="lineno"> 1167</span>        Timestamp(<span class="stringliteral">&quot;2011-01-06 12:43:33&quot;</span>, tz=<span class="keywordtype">None</span>): 5000000000,</div>
<div class="line"><span class="lineno"> 1168</span>        Timestamp(<span class="stringliteral">&quot;2011-01-06 12:54:09&quot;</span>, tz=<span class="keywordtype">None</span>): 100000000,</div>
<div class="line"><span class="lineno"> 1169</span>    }</div>
<div class="line"><span class="lineno"> 1170</span>    df = DataFrame({<span class="stringliteral">&quot;PRICE&quot;</span>: prices, <span class="stringliteral">&quot;VOLUME&quot;</span>: volumes})</div>
<div class="line"><span class="lineno"> 1171</span>    result = df.groupby(<span class="stringliteral">&quot;PRICE&quot;</span>).VOLUME.describe()</div>
<div class="line"><span class="lineno"> 1172</span>    data = [</div>
<div class="line"><span class="lineno"> 1173</span>        df[df.PRICE == 24990].VOLUME.describe().values.tolist(),</div>
<div class="line"><span class="lineno"> 1174</span>        df[df.PRICE == 25499].VOLUME.describe().values.tolist(),</div>
<div class="line"><span class="lineno"> 1175</span>    ]</div>
<div class="line"><span class="lineno"> 1176</span>    expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1177</span>        data,</div>
<div class="line"><span class="lineno"> 1178</span>        index=Index([24990, 25499], name=<span class="stringliteral">&quot;PRICE&quot;</span>),</div>
<div class="line"><span class="lineno"> 1179</span>        columns=[<span class="stringliteral">&quot;count&quot;</span>, <span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;std&quot;</span>, <span class="stringliteral">&quot;min&quot;</span>, <span class="stringliteral">&quot;25%&quot;</span>, <span class="stringliteral">&quot;50%&quot;</span>, <span class="stringliteral">&quot;75%&quot;</span>, <span class="stringliteral">&quot;max&quot;</span>],</div>
<div class="line"><span class="lineno"> 1180</span>    )</div>
<div class="line"><span class="lineno"> 1181</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span> </div>
<div class="line"><span class="lineno"> 1184</span><span class="preprocessor">@pytest.mark.filterwarnings</span>(</div>
<div class="line"><span class="lineno"> 1185</span>    <span class="stringliteral">&quot;ignore:&quot;</span></div>
<div class="line"><span class="lineno"> 1186</span>    <span class="stringliteral">&quot;indexing past lexsort depth may impact performance:&quot;</span></div>
<div class="line"><span class="lineno"> 1187</span>    <span class="stringliteral">&quot;pandas.errors.PerformanceWarning&quot;</span></div>
<div class="line"><span class="lineno"> 1188</span>)</div>
<div class="line"><span class="lineno"> 1189</span><span class="preprocessor">@pytest.mark.parametrize(&quot;as_index&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab615c80d83ed44effb9a7417d9e66aab" name="ab615c80d83ed44effb9a7417d9e66aab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab615c80d83ed44effb9a7417d9e66aab">&#9670;&#160;</a></span>test_groupby_cumprod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_groupby_cumprod </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  634</span><span class="keyword">def </span>test_groupby_cumprod():</div>
<div class="line"><span class="lineno">  635</span>    <span class="comment"># GH 4095</span></div>
<div class="line"><span class="lineno">  636</span>    df = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [<span class="stringliteral">&quot;b&quot;</span>] * 10, <span class="stringliteral">&quot;value&quot;</span>: 2})</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>    actual = df.groupby(<span class="stringliteral">&quot;key&quot;</span>)[<span class="stringliteral">&quot;value&quot;</span>].cumprod()</div>
<div class="line"><span class="lineno">  639</span>    expected = df.groupby(<span class="stringliteral">&quot;key&quot;</span>, group_keys=<span class="keyword">False</span>)[<span class="stringliteral">&quot;value&quot;</span>].apply(<span class="keyword">lambda</span> x: x.cumprod())</div>
<div class="line"><span class="lineno">  640</span>    expected.name = <span class="stringliteral">&quot;value&quot;</span></div>
<div class="line"><span class="lineno">  641</span>    tm.assert_series_equal(actual, expected)</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>    df = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [<span class="stringliteral">&quot;b&quot;</span>] * 100, <span class="stringliteral">&quot;value&quot;</span>: 2})</div>
<div class="line"><span class="lineno">  644</span>    actual = df.groupby(<span class="stringliteral">&quot;key&quot;</span>)[<span class="stringliteral">&quot;value&quot;</span>].cumprod()</div>
<div class="line"><span class="lineno">  645</span>    <span class="comment"># if overflows, groupby product casts to float</span></div>
<div class="line"><span class="lineno">  646</span>    <span class="comment"># while numpy passes back invalid values</span></div>
<div class="line"><span class="lineno">  647</span>    df[<span class="stringliteral">&quot;value&quot;</span>] = df[<span class="stringliteral">&quot;value&quot;</span>].astype(float)</div>
<div class="line"><span class="lineno">  648</span>    expected = df.groupby(<span class="stringliteral">&quot;key&quot;</span>, group_keys=<span class="keyword">False</span>)[<span class="stringliteral">&quot;value&quot;</span>].apply(<span class="keyword">lambda</span> x: x.cumprod())</div>
<div class="line"><span class="lineno">  649</span>    expected.name = <span class="stringliteral">&quot;value&quot;</span></div>
<div class="line"><span class="lineno">  650</span>    tm.assert_series_equal(actual, expected)</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a05c56f5b5cf204a2713c661370d2a516" name="a05c56f5b5cf204a2713c661370d2a516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05c56f5b5cf204a2713c661370d2a516">&#9670;&#160;</a></span>test_groupby_cumprod_nan_influences_other_columns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_groupby_cumprod_nan_influences_other_columns </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  653</span><span class="keyword">def </span>test_groupby_cumprod_nan_influences_other_columns():</div>
<div class="line"><span class="lineno">  654</span>    <span class="comment"># GH#48064</span></div>
<div class="line"><span class="lineno">  655</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  656</span>        {</div>
<div class="line"><span class="lineno">  657</span>            <span class="stringliteral">&quot;a&quot;</span>: 1,</div>
<div class="line"><span class="lineno">  658</span>            <span class="stringliteral">&quot;b&quot;</span>: [1, np.nan, 2],</div>
<div class="line"><span class="lineno">  659</span>            <span class="stringliteral">&quot;c&quot;</span>: [1, 2, 3.0],</div>
<div class="line"><span class="lineno">  660</span>        }</div>
<div class="line"><span class="lineno">  661</span>    )</div>
<div class="line"><span class="lineno">  662</span>    result = df.groupby(<span class="stringliteral">&quot;a&quot;</span>).cumprod(numeric_only=<span class="keyword">True</span>, skipna=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  663</span>    expected = DataFrame({<span class="stringliteral">&quot;b&quot;</span>: [1, np.nan, np.nan], <span class="stringliteral">&quot;c&quot;</span>: [1, 2, 6.0]})</div>
<div class="line"><span class="lineno">  664</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a58a75b30558cb377022507f573b7bb41" name="a58a75b30558cb377022507f573b7bb41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58a75b30558cb377022507f573b7bb41">&#9670;&#160;</a></span>test_groupby_empty_dataset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_groupby_empty_dataset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1565</span><span class="keyword">def </span>test_groupby_empty_dataset(dtype, kwargs):</div>
<div class="line"><span class="lineno"> 1566</span>    <span class="comment"># GH#41575</span></div>
<div class="line"><span class="lineno"> 1567</span>    df = DataFrame([[1, 2, 3]], columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>], dtype=dtype)</div>
<div class="line"><span class="lineno"> 1568</span>    df[<span class="stringliteral">&quot;B&quot;</span>] = df[<span class="stringliteral">&quot;B&quot;</span>].astype(int)</div>
<div class="line"><span class="lineno"> 1569</span>    df[<span class="stringliteral">&quot;C&quot;</span>] = df[<span class="stringliteral">&quot;C&quot;</span>].astype(float)</div>
<div class="line"><span class="lineno"> 1570</span> </div>
<div class="line"><span class="lineno"> 1571</span>    result = df.iloc[:0].groupby(<span class="stringliteral">&quot;A&quot;</span>).describe(**kwargs)</div>
<div class="line"><span class="lineno"> 1572</span>    expected = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).describe(**kwargs).reset_index(drop=<span class="keyword">True</span>).iloc[:0]</div>
<div class="line"><span class="lineno"> 1573</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1574</span> </div>
<div class="line"><span class="lineno"> 1575</span>    result = df.iloc[:0].groupby(<span class="stringliteral">&quot;A&quot;</span>).B.describe(**kwargs)</div>
<div class="line"><span class="lineno"> 1576</span>    expected = df.groupby(<span class="stringliteral">&quot;A&quot;</span>).B.describe(**kwargs).reset_index(drop=<span class="keyword">True</span>).iloc[:0]</div>
<div class="line"><span class="lineno"> 1577</span>    expected.index = Index([])</div>
<div class="line"><span class="lineno"> 1578</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2cbb73b6b968063e0962b27efca9d78" name="ae2cbb73b6b968063e0962b27efca9d78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2cbb73b6b968063e0962b27efca9d78">&#9670;&#160;</a></span>test_groupby_mean_no_overflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_groupby_mean_no_overflow </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1247</span><span class="keyword">def </span>test_groupby_mean_no_overflow():</div>
<div class="line"><span class="lineno"> 1248</span>    <span class="comment"># Regression test for (#22487)</span></div>
<div class="line"><span class="lineno"> 1249</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1250</span>        {</div>
<div class="line"><span class="lineno"> 1251</span>            <span class="stringliteral">&quot;user&quot;</span>: [<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>],</div>
<div class="line"><span class="lineno"> 1252</span>            <span class="stringliteral">&quot;connections&quot;</span>: [4970, 4749, 4719, 4704, 18446744073699999744],</div>
<div class="line"><span class="lineno"> 1253</span>        }</div>
<div class="line"><span class="lineno"> 1254</span>    )</div>
<div class="line"><span class="lineno"> 1255</span>    <span class="keyword">assert</span> df.groupby(<span class="stringliteral">&quot;user&quot;</span>)[<span class="stringliteral">&quot;connections&quot;</span>].mean()[<span class="stringliteral">&quot;A&quot;</span>] == 3689348814740003840</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1259</span>    <span class="stringliteral">&quot;values&quot;</span>,</div>
<div class="line"><span class="lineno"> 1260</span>    [</div>
<div class="line"><span class="lineno"> 1261</span>        {</div>
<div class="line"><span class="lineno"> 1262</span>            <span class="stringliteral">&quot;a&quot;</span>: [1, 1, 1, 2, 2, 2, 3, 3, 3],</div>
<div class="line"><span class="lineno"> 1263</span>            <span class="stringliteral">&quot;b&quot;</span>: [1, pd.NA, 2, 1, pd.NA, 2, 1, pd.NA, 2],</div>
<div class="line"><span class="lineno"> 1264</span>        },</div>
<div class="line"><span class="lineno"> 1265</span>        {<span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2, 2, 3, 3], <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 1, 2, 1, 2]},</div>
<div class="line"><span class="lineno"> 1266</span>    ],</div>
<div class="line"><span class="lineno"> 1267</span>)</div>
<div class="line"><span class="lineno"> 1268</span><span class="preprocessor">@pytest.mark.parametrize(&quot;function&quot;, [&quot;mean&quot;, &quot;median&quot;, &quot;var&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ccc3b5ac676897a33570b43e6613c25" name="a2ccc3b5ac676897a33570b43e6613c25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ccc3b5ac676897a33570b43e6613c25">&#9670;&#160;</a></span>test_groupby_non_arithmetic_agg_int_like_precision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_groupby_non_arithmetic_agg_int_like_precision </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  474</span><span class="keyword">def </span>test_groupby_non_arithmetic_agg_int_like_precision(i):</div>
<div class="line"><span class="lineno">  475</span>    <span class="comment"># see gh-6620, gh-9311</span></div>
<div class="line"><span class="lineno">  476</span>    df = DataFrame([{<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: i[0]}, {<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: i[1]}])</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    grp_exp = {</div>
<div class="line"><span class="lineno">  479</span>        <span class="stringliteral">&quot;first&quot;</span>: {<span class="stringliteral">&quot;expected&quot;</span>: i[0]},</div>
<div class="line"><span class="lineno">  480</span>        <span class="stringliteral">&quot;last&quot;</span>: {<span class="stringliteral">&quot;expected&quot;</span>: i[1]},</div>
<div class="line"><span class="lineno">  481</span>        <span class="stringliteral">&quot;min&quot;</span>: {<span class="stringliteral">&quot;expected&quot;</span>: i[0]},</div>
<div class="line"><span class="lineno">  482</span>        <span class="stringliteral">&quot;max&quot;</span>: {<span class="stringliteral">&quot;expected&quot;</span>: i[1]},</div>
<div class="line"><span class="lineno">  483</span>        <span class="stringliteral">&quot;nth&quot;</span>: {<span class="stringliteral">&quot;expected&quot;</span>: i[1], <span class="stringliteral">&quot;args&quot;</span>: [1]},</div>
<div class="line"><span class="lineno">  484</span>        <span class="stringliteral">&quot;count&quot;</span>: {<span class="stringliteral">&quot;expected&quot;</span>: 2},</div>
<div class="line"><span class="lineno">  485</span>    }</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>    <span class="keywordflow">for</span> method, data <span class="keywordflow">in</span> grp_exp.items():</div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;args&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> data:</div>
<div class="line"><span class="lineno">  489</span>            data[<span class="stringliteral">&quot;args&quot;</span>] = []</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>        grouped = df.groupby(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  492</span>        res = getattr(grouped, method)(*data[<span class="stringliteral">&quot;args&quot;</span>])</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>        <span class="keyword">assert</span> res.iloc[0].b == data[<span class="stringliteral">&quot;expected&quot;</span>]</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  498</span>    <span class="stringliteral">&quot;func, values&quot;</span>,</div>
<div class="line"><span class="lineno">  499</span>    [</div>
<div class="line"><span class="lineno">  500</span>        (<span class="stringliteral">&quot;idxmin&quot;</span>, {<span class="stringliteral">&quot;c_int&quot;</span>: [0, 2], <span class="stringliteral">&quot;c_float&quot;</span>: [1, 3], <span class="stringliteral">&quot;c_date&quot;</span>: [1, 2]}),</div>
<div class="line"><span class="lineno">  501</span>        (<span class="stringliteral">&quot;idxmax&quot;</span>, {<span class="stringliteral">&quot;c_int&quot;</span>: [1, 3], <span class="stringliteral">&quot;c_float&quot;</span>: [0, 2], <span class="stringliteral">&quot;c_date&quot;</span>: [0, 3]}),</div>
<div class="line"><span class="lineno">  502</span>    ],</div>
<div class="line"><span class="lineno">  503</span>)</div>
<div class="line"><span class="lineno">  504</span><span class="preprocessor">@pytest.mark.parametrize(&quot;numeric_only&quot;, [True, False])</span></div>
<div class="line"><span class="lineno">  505</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:.*Select only valid:FutureWarning&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a24357cbf6dc379e2f6a98fe8906600c6" name="a24357cbf6dc379e2f6a98fe8906600c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24357cbf6dc379e2f6a98fe8906600c6">&#9670;&#160;</a></span>test_groupby_non_arithmetic_agg_types()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_groupby_non_arithmetic_agg_types </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  437</span><span class="keyword">def </span>test_groupby_non_arithmetic_agg_types(dtype, method, data):</div>
<div class="line"><span class="lineno">  438</span>    <span class="comment"># GH9311, GH6620</span></div>
<div class="line"><span class="lineno">  439</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  440</span>        [{<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: 1}, {<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: 2}, {<span class="stringliteral">&quot;a&quot;</span>: 2, <span class="stringliteral">&quot;b&quot;</span>: 3}, {<span class="stringliteral">&quot;a&quot;</span>: 2, <span class="stringliteral">&quot;b&quot;</span>: 4}]</div>
<div class="line"><span class="lineno">  441</span>    )</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    df[<span class="stringliteral">&quot;b&quot;</span>] = df.b.astype(dtype)</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;args&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> data:</div>
<div class="line"><span class="lineno">  446</span>        data[<span class="stringliteral">&quot;args&quot;</span>] = []</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;out_type&quot;</span> <span class="keywordflow">in</span> data:</div>
<div class="line"><span class="lineno">  449</span>        out_type = data[<span class="stringliteral">&quot;out_type&quot;</span>]</div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  451</span>        out_type = dtype</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>    exp = data[<span class="stringliteral">&quot;df&quot;</span>]</div>
<div class="line"><span class="lineno">  454</span>    df_out = DataFrame(exp)</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span>    df_out[<span class="stringliteral">&quot;b&quot;</span>] = df_out.b.astype(out_type)</div>
<div class="line"><span class="lineno">  457</span>    df_out.set_index(<span class="stringliteral">&quot;a&quot;</span>, inplace=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>    grpd = df.groupby(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  460</span>    t = getattr(grpd, method)(*data[<span class="stringliteral">&quot;args&quot;</span>])</div>
<div class="line"><span class="lineno">  461</span>    tm.assert_frame_equal(t, df_out)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  465</span>    <span class="stringliteral">&quot;i&quot;</span>,</div>
<div class="line"><span class="lineno">  466</span>    [</div>
<div class="line"><span class="lineno">  467</span>        (</div>
<div class="line"><span class="lineno">  468</span>            Timestamp(<span class="stringliteral">&quot;2011-01-15 12:50:28.502376&quot;</span>),</div>
<div class="line"><span class="lineno">  469</span>            Timestamp(<span class="stringliteral">&quot;2011-01-20 12:50:28.593448&quot;</span>),</div>
<div class="line"><span class="lineno">  470</span>        ),</div>
<div class="line"><span class="lineno">  471</span>        (24650000000000001, 24650000000000002),</div>
<div class="line"><span class="lineno">  472</span>    ],</div>
<div class="line"><span class="lineno">  473</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a36f0efcb13c5ef4ae4d05dbe604b256b" name="a36f0efcb13c5ef4ae4d05dbe604b256b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36f0efcb13c5ef4ae4d05dbe604b256b">&#9670;&#160;</a></span>test_groupby_sum_below_mincount_nullable_integer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_groupby_sum_below_mincount_nullable_integer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1289</span><span class="keyword">def </span>test_groupby_sum_below_mincount_nullable_integer():</div>
<div class="line"><span class="lineno"> 1290</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/32861</span></div>
<div class="line"><span class="lineno"> 1291</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [0, 1, 2], <span class="stringliteral">&quot;b&quot;</span>: [0, 1, 2], <span class="stringliteral">&quot;c&quot;</span>: [0, 1, 2]}, dtype=<span class="stringliteral">&quot;Int64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1292</span>    grouped = df.groupby(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno"> 1293</span>    idx = Index([0, 1, 2], name=<span class="stringliteral">&quot;a&quot;</span>, dtype=<span class="stringliteral">&quot;Int64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>    result = grouped[<span class="stringliteral">&quot;b&quot;</span>].sum(min_count=2)</div>
<div class="line"><span class="lineno"> 1296</span>    expected = Series([pd.NA] * 3, dtype=<span class="stringliteral">&quot;Int64&quot;</span>, index=idx, name=<span class="stringliteral">&quot;b&quot;</span>)</div>
<div class="line"><span class="lineno"> 1297</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1298</span> </div>
<div class="line"><span class="lineno"> 1299</span>    result = grouped.sum(min_count=2)</div>
<div class="line"><span class="lineno"> 1300</span>    expected = DataFrame({<span class="stringliteral">&quot;b&quot;</span>: [pd.NA] * 3, <span class="stringliteral">&quot;c&quot;</span>: [pd.NA] * 3}, dtype=<span class="stringliteral">&quot;Int64&quot;</span>, index=idx)</div>
<div class="line"><span class="lineno"> 1301</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aebea940515168e162d9962785cbdfb1c" name="aebea940515168e162d9962785cbdfb1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebea940515168e162d9962785cbdfb1c">&#9670;&#160;</a></span>test_groupby_sum_timedelta_with_nat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_groupby_sum_timedelta_with_nat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1314</span><span class="keyword">def </span>test_groupby_sum_timedelta_with_nat():</div>
<div class="line"><span class="lineno"> 1315</span>    <span class="comment"># GH#42659</span></div>
<div class="line"><span class="lineno"> 1316</span>    df = DataFrame(</div>
<div class="line"><span class="lineno"> 1317</span>        {</div>
<div class="line"><span class="lineno"> 1318</span>            <span class="stringliteral">&quot;a&quot;</span>: [1, 1, 2, 2],</div>
<div class="line"><span class="lineno"> 1319</span>            <span class="stringliteral">&quot;b&quot;</span>: [pd.Timedelta(<span class="stringliteral">&quot;1d&quot;</span>), pd.Timedelta(<span class="stringliteral">&quot;2d&quot;</span>), pd.Timedelta(<span class="stringliteral">&quot;3d&quot;</span>), pd.NaT],</div>
<div class="line"><span class="lineno"> 1320</span>        }</div>
<div class="line"><span class="lineno"> 1321</span>    )</div>
<div class="line"><span class="lineno"> 1322</span>    td3 = pd.Timedelta(days=3)</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>    gb = df.groupby(<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno"> 1325</span> </div>
<div class="line"><span class="lineno"> 1326</span>    res = gb.sum()</div>
<div class="line"><span class="lineno"> 1327</span>    expected = DataFrame({<span class="stringliteral">&quot;b&quot;</span>: [td3, td3]}, index=Index([1, 2], name=<span class="stringliteral">&quot;a&quot;</span>))</div>
<div class="line"><span class="lineno"> 1328</span>    tm.assert_frame_equal(res, expected)</div>
<div class="line"><span class="lineno"> 1329</span> </div>
<div class="line"><span class="lineno"> 1330</span>    res = gb[<span class="stringliteral">&quot;b&quot;</span>].sum()</div>
<div class="line"><span class="lineno"> 1331</span>    tm.assert_series_equal(res, expected[<span class="stringliteral">&quot;b&quot;</span>])</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>    res = gb[<span class="stringliteral">&quot;b&quot;</span>].sum(min_count=2)</div>
<div class="line"><span class="lineno"> 1334</span>    expected = Series([td3, pd.NaT], dtype=<span class="stringliteral">&quot;m8[ns]&quot;</span>, name=<span class="stringliteral">&quot;b&quot;</span>, index=expected.index)</div>
<div class="line"><span class="lineno"> 1335</span>    tm.assert_series_equal(res, expected)</div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1339</span>    <span class="stringliteral">&quot;kernel, numeric_only_default, drops_nuisance, has_arg&quot;</span>,</div>
<div class="line"><span class="lineno"> 1340</span>    [</div>
<div class="line"><span class="lineno"> 1341</span>        (<span class="stringliteral">&quot;all&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1342</span>        (<span class="stringliteral">&quot;any&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1343</span>        (<span class="stringliteral">&quot;bfill&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1344</span>        (<span class="stringliteral">&quot;corr&quot;</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1345</span>        (<span class="stringliteral">&quot;corrwith&quot;</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1346</span>        (<span class="stringliteral">&quot;cov&quot;</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1347</span>        (<span class="stringliteral">&quot;cummax&quot;</span>, <span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1348</span>        (<span class="stringliteral">&quot;cummin&quot;</span>, <span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1349</span>        (<span class="stringliteral">&quot;cumprod&quot;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1350</span>        (<span class="stringliteral">&quot;cumsum&quot;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1351</span>        (<span class="stringliteral">&quot;diff&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1352</span>        (<span class="stringliteral">&quot;ffill&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1353</span>        (<span class="stringliteral">&quot;fillna&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1354</span>        (<span class="stringliteral">&quot;first&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1355</span>        (<span class="stringliteral">&quot;idxmax&quot;</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1356</span>        (<span class="stringliteral">&quot;idxmin&quot;</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1357</span>        (<span class="stringliteral">&quot;last&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1358</span>        (<span class="stringliteral">&quot;max&quot;</span>, <span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1359</span>        (<span class="stringliteral">&quot;mean&quot;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1360</span>        (<span class="stringliteral">&quot;median&quot;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1361</span>        (<span class="stringliteral">&quot;min&quot;</span>, <span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1362</span>        (<span class="stringliteral">&quot;nth&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1363</span>        (<span class="stringliteral">&quot;nunique&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1364</span>        (<span class="stringliteral">&quot;pct_change&quot;</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1365</span>        (<span class="stringliteral">&quot;prod&quot;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1366</span>        (<span class="stringliteral">&quot;quantile&quot;</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1367</span>        (<span class="stringliteral">&quot;sem&quot;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1368</span>        (<span class="stringliteral">&quot;skew&quot;</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1369</span>        (<span class="stringliteral">&quot;std&quot;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1370</span>        (<span class="stringliteral">&quot;sum&quot;</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1371</span>        (<span class="stringliteral">&quot;var&quot;</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1372</span>    ],</div>
<div class="line"><span class="lineno"> 1373</span>)</div>
<div class="line"><span class="lineno"> 1374</span><span class="preprocessor">@pytest.mark.parametrize(&quot;numeric_only&quot;, [True, False, lib.no_default])</span></div>
<div class="line"><span class="lineno"> 1375</span><span class="preprocessor">@pytest.mark.parametrize(&quot;keys&quot;, [[&quot;a1&quot;], [&quot;a1&quot;, &quot;a2&quot;]])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a742ed41ca97775027a6799be9b9f2611" name="a742ed41ca97775027a6799be9b9f2611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a742ed41ca97775027a6799be9b9f2611">&#9670;&#160;</a></span>test_idxmin_idxmax_axis1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_idxmin_idxmax_axis1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  538</span><span class="keyword">def </span>test_idxmin_idxmax_axis1():</div>
<div class="line"><span class="lineno">  539</span>    df = DataFrame(np.random.randn(10, 4), columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>])</div>
<div class="line"><span class="lineno">  540</span>    df[<span class="stringliteral">&quot;A&quot;</span>] = [1, 2, 3, 1, 2, 3, 1, 2, 3, 4]</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>    gb = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    res = gb.idxmax(axis=1)</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>    alt = df.iloc[:, 1:].idxmax(axis=1)</div>
<div class="line"><span class="lineno">  547</span>    indexer = res.index.get_level_values(1)</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>    tm.assert_series_equal(alt[indexer], res.droplevel(<span class="stringliteral">&quot;A&quot;</span>))</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>    df[<span class="stringliteral">&quot;E&quot;</span>] = date_range(<span class="stringliteral">&quot;2016-01-01&quot;</span>, periods=10)</div>
<div class="line"><span class="lineno">  552</span>    gb2 = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>    msg = <span class="stringliteral">&quot;reduction operation &#39;argmax&#39; not allowed for this dtype&quot;</span></div>
<div class="line"><span class="lineno">  555</span>    <span class="keyword">with</span> pytest.raises(TypeError, match=msg):</div>
<div class="line"><span class="lineno">  556</span>        gb2.idxmax(axis=1)</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span><span class="preprocessor">@pytest.mark.parametrize(&quot;numeric_only&quot;, [True, False, None])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64dc6b5a9dbdda4736df9e00879863a9" name="a64dc6b5a9dbdda4736df9e00879863a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64dc6b5a9dbdda4736df9e00879863a9">&#9670;&#160;</a></span>test_idxmin_idxmax_returns_int_types()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_idxmin_idxmax_returns_int_types </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>numeric_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  506</span><span class="keyword">def </span>test_idxmin_idxmax_returns_int_types(func, values, numeric_only):</div>
<div class="line"><span class="lineno">  507</span>    <span class="comment"># GH 25444</span></div>
<div class="line"><span class="lineno">  508</span>    df = DataFrame(</div>
<div class="line"><span class="lineno">  509</span>        {</div>
<div class="line"><span class="lineno">  510</span>            <span class="stringliteral">&quot;name&quot;</span>: [<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>],</div>
<div class="line"><span class="lineno">  511</span>            <span class="stringliteral">&quot;c_int&quot;</span>: [1, 2, 3, 4],</div>
<div class="line"><span class="lineno">  512</span>            <span class="stringliteral">&quot;c_float&quot;</span>: [4.02, 3.03, 2.04, 1.05],</div>
<div class="line"><span class="lineno">  513</span>            <span class="stringliteral">&quot;c_date&quot;</span>: [<span class="stringliteral">&quot;2019&quot;</span>, <span class="stringliteral">&quot;2018&quot;</span>, <span class="stringliteral">&quot;2016&quot;</span>, <span class="stringliteral">&quot;2017&quot;</span>],</div>
<div class="line"><span class="lineno">  514</span>        }</div>
<div class="line"><span class="lineno">  515</span>    )</div>
<div class="line"><span class="lineno">  516</span>    df[<span class="stringliteral">&quot;c_date&quot;</span>] = pd.to_datetime(df[<span class="stringliteral">&quot;c_date&quot;</span>])</div>
<div class="line"><span class="lineno">  517</span>    df[<span class="stringliteral">&quot;c_date_tz&quot;</span>] = df[<span class="stringliteral">&quot;c_date&quot;</span>].dt.tz_localize(<span class="stringliteral">&quot;US/Pacific&quot;</span>)</div>
<div class="line"><span class="lineno">  518</span>    df[<span class="stringliteral">&quot;c_timedelta&quot;</span>] = df[<span class="stringliteral">&quot;c_date&quot;</span>] - df[<span class="stringliteral">&quot;c_date&quot;</span>].iloc[0]</div>
<div class="line"><span class="lineno">  519</span>    df[<span class="stringliteral">&quot;c_period&quot;</span>] = df[<span class="stringliteral">&quot;c_date&quot;</span>].dt.to_period(<span class="stringliteral">&quot;W&quot;</span>)</div>
<div class="line"><span class="lineno">  520</span>    df[<span class="stringliteral">&quot;c_Integer&quot;</span>] = df[<span class="stringliteral">&quot;c_int&quot;</span>].astype(<span class="stringliteral">&quot;Int64&quot;</span>)</div>
<div class="line"><span class="lineno">  521</span>    df[<span class="stringliteral">&quot;c_Floating&quot;</span>] = df[<span class="stringliteral">&quot;c_float&quot;</span>].astype(<span class="stringliteral">&quot;Float64&quot;</span>)</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>    result = getattr(df.groupby(<span class="stringliteral">&quot;name&quot;</span>), func)(numeric_only=numeric_only)</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    expected = DataFrame(values, index=Index([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], name=<span class="stringliteral">&quot;name&quot;</span>))</div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">if</span> numeric_only:</div>
<div class="line"><span class="lineno">  527</span>        expected = expected.drop(columns=[<span class="stringliteral">&quot;c_date&quot;</span>])</div>
<div class="line"><span class="lineno">  528</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  529</span>        expected[<span class="stringliteral">&quot;c_date_tz&quot;</span>] = expected[<span class="stringliteral">&quot;c_date&quot;</span>]</div>
<div class="line"><span class="lineno">  530</span>        expected[<span class="stringliteral">&quot;c_timedelta&quot;</span>] = expected[<span class="stringliteral">&quot;c_date&quot;</span>]</div>
<div class="line"><span class="lineno">  531</span>        expected[<span class="stringliteral">&quot;c_period&quot;</span>] = expected[<span class="stringliteral">&quot;c_date&quot;</span>]</div>
<div class="line"><span class="lineno">  532</span>    expected[<span class="stringliteral">&quot;c_Integer&quot;</span>] = expected[<span class="stringliteral">&quot;c_int&quot;</span>]</div>
<div class="line"><span class="lineno">  533</span>    expected[<span class="stringliteral">&quot;c_Floating&quot;</span>] = expected[<span class="stringliteral">&quot;c_float&quot;</span>]</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aeac3bb12f562252789a79e30d0e9c756" name="aeac3bb12f562252789a79e30d0e9c756"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac3bb12f562252789a79e30d0e9c756">&#9670;&#160;</a></span>test_intercept_builtin_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_intercept_builtin_sum </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   56</span><span class="keyword">def </span>test_intercept_builtin_sum():</div>
<div class="line"><span class="lineno">   57</span>    s = Series([1.0, 2.0, np.nan, 3.0])</div>
<div class="line"><span class="lineno">   58</span>    grouped = s.groupby([0, 1, 2, 2])</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    result = grouped.agg(builtins.sum)</div>
<div class="line"><span class="lineno">   61</span>    result2 = grouped.apply(builtins.sum)</div>
<div class="line"><span class="lineno">   62</span>    expected = grouped.sum()</div>
<div class="line"><span class="lineno">   63</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">   64</span>    tm.assert_series_equal(result2, expected)</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span><span class="preprocessor">@pytest.mark.parametrize(&quot;f&quot;, [max, min, sum])</span></div>
<div class="line"><span class="lineno">   68</span><span class="preprocessor">@pytest.mark.parametrize(&quot;keys&quot;, [&quot;jim&quot;, [&quot;jim&quot;, &quot;joe&quot;]])</span>  <span class="comment"># Single key  # Multi-key</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a23387620ebd5a2dcc4ebdfb5e1c1af5d" name="a23387620ebd5a2dcc4ebdfb5e1c1af5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23387620ebd5a2dcc4ebdfb5e1c1af5d">&#9670;&#160;</a></span>test_is_monotonic_decreasing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_is_monotonic_decreasing </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>in_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out_vals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1065</span><span class="keyword">def </span>test_is_monotonic_decreasing(in_vals, out_vals):</div>
<div class="line"><span class="lineno"> 1066</span>    <span class="comment"># GH 17015</span></div>
<div class="line"><span class="lineno"> 1067</span>    source_dict = {</div>
<div class="line"><span class="lineno"> 1068</span>        <span class="stringliteral">&quot;A&quot;</span>: [<span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>, <span class="stringliteral">&quot;9&quot;</span>, <span class="stringliteral">&quot;10&quot;</span>, <span class="stringliteral">&quot;11&quot;</span>],</div>
<div class="line"><span class="lineno"> 1069</span>        <span class="stringliteral">&quot;B&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>],</div>
<div class="line"><span class="lineno"> 1070</span>        <span class="stringliteral">&quot;C&quot;</span>: in_vals,</div>
<div class="line"><span class="lineno"> 1071</span>    }</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>    df = DataFrame(source_dict)</div>
<div class="line"><span class="lineno"> 1074</span>    result = df.groupby(<span class="stringliteral">&quot;B&quot;</span>).C.is_monotonic_decreasing</div>
<div class="line"><span class="lineno"> 1075</span>    index = Index(list(<span class="stringliteral">&quot;abcd&quot;</span>), name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1076</span>    expected = Series(index=index, data=out_vals, name=<span class="stringliteral">&quot;C&quot;</span>)</div>
<div class="line"><span class="lineno"> 1077</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span><span class="comment"># describe</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="comment"># --------------------------------</span></div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a53026f30281e86c85722a9842164a662" name="a53026f30281e86c85722a9842164a662"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53026f30281e86c85722a9842164a662">&#9670;&#160;</a></span>test_is_monotonic_increasing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_is_monotonic_increasing </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>in_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out_vals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1029</span><span class="keyword">def </span>test_is_monotonic_increasing(in_vals, out_vals):</div>
<div class="line"><span class="lineno"> 1030</span>    <span class="comment"># GH 17015</span></div>
<div class="line"><span class="lineno"> 1031</span>    source_dict = {</div>
<div class="line"><span class="lineno"> 1032</span>        <span class="stringliteral">&quot;A&quot;</span>: [<span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>, <span class="stringliteral">&quot;9&quot;</span>, <span class="stringliteral">&quot;10&quot;</span>, <span class="stringliteral">&quot;11&quot;</span>],</div>
<div class="line"><span class="lineno"> 1033</span>        <span class="stringliteral">&quot;B&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>],</div>
<div class="line"><span class="lineno"> 1034</span>        <span class="stringliteral">&quot;C&quot;</span>: in_vals,</div>
<div class="line"><span class="lineno"> 1035</span>    }</div>
<div class="line"><span class="lineno"> 1036</span>    df = DataFrame(source_dict)</div>
<div class="line"><span class="lineno"> 1037</span>    result = df.groupby(<span class="stringliteral">&quot;B&quot;</span>).C.is_monotonic_increasing</div>
<div class="line"><span class="lineno"> 1038</span>    index = Index(list(<span class="stringliteral">&quot;abcd&quot;</span>), name=<span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno"> 1039</span>    expected = Series(index=index, data=out_vals, name=<span class="stringliteral">&quot;C&quot;</span>)</div>
<div class="line"><span class="lineno"> 1040</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>    <span class="comment"># Also check result equal to manually taking x.is_monotonic_increasing.</span></div>
<div class="line"><span class="lineno"> 1043</span>    expected = df.groupby([<span class="stringliteral">&quot;B&quot;</span>]).C.apply(<span class="keyword">lambda</span> x: x.is_monotonic_increasing)</div>
<div class="line"><span class="lineno"> 1044</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1048</span>    <span class="stringliteral">&quot;in_vals, out_vals&quot;</span>,</div>
<div class="line"><span class="lineno"> 1049</span>    [</div>
<div class="line"><span class="lineno"> 1050</span>        <span class="comment"># Basics: strictly decreasing (T), strictly increasing (F),</span></div>
<div class="line"><span class="lineno"> 1051</span>        <span class="comment"># abs val decreasing (F), non-strictly increasing (T)</span></div>
<div class="line"><span class="lineno"> 1052</span>        ([10, 9, 7, 3, 4, 5, -3, 2, 0, 1, 1], [<span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">True</span>]),</div>
<div class="line"><span class="lineno"> 1053</span>        <span class="comment"># Test with inf vals</span></div>
<div class="line"><span class="lineno"> 1054</span>        (</div>
<div class="line"><span class="lineno"> 1055</span>            [np.inf, 1, -np.inf, np.inf, 2, -3, -np.inf, 5, -3, -np.inf, -np.inf],</div>
<div class="line"><span class="lineno"> 1056</span>            [<span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>],</div>
<div class="line"><span class="lineno"> 1057</span>        ),</div>
<div class="line"><span class="lineno"> 1058</span>        <span class="comment"># Test with nan vals; should always be False</span></div>
<div class="line"><span class="lineno"> 1059</span>        (</div>
<div class="line"><span class="lineno"> 1060</span>            [1, 2, np.nan, 3, 2, np.nan, np.nan, 5, -np.inf, 1, np.nan],</div>
<div class="line"><span class="lineno"> 1061</span>            [<span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>],</div>
<div class="line"><span class="lineno"> 1062</span>        ),</div>
<div class="line"><span class="lineno"> 1063</span>    ],</div>
<div class="line"><span class="lineno"> 1064</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc6a4adbdb015a13227ca09d058dd1db" name="afc6a4adbdb015a13227ca09d058dd1db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc6a4adbdb015a13227ca09d058dd1db">&#9670;&#160;</a></span>test_max_nan_bug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_max_nan_bug </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  699</span><span class="keyword">def </span>test_max_nan_bug():</div>
<div class="line"><span class="lineno">  700</span>    raw = <span class="stringliteral">&quot;&quot;&quot;,Date,app,File</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">-04-23,2013-04-23 00:00:00,,log080001.log</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral">-05-06,2013-05-06 00:00:00,,log.log</span></div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">-05-07,2013-05-07 00:00:00,OE,xlsx&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>    df = pd.read_csv(StringIO(raw), parse_dates=[0])</div>
<div class="line"><span class="lineno">  706</span>    gb = df.groupby(<span class="stringliteral">&quot;Date&quot;</span>)</div>
<div class="line"><span class="lineno">  707</span>    r = gb[[<span class="stringliteral">&quot;File&quot;</span>]].max()</div>
<div class="line"><span class="lineno">  708</span>    e = gb[<span class="stringliteral">&quot;File&quot;</span>].max().to_frame()</div>
<div class="line"><span class="lineno">  709</span>    tm.assert_frame_equal(r, e)</div>
<div class="line"><span class="lineno">  710</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> r[<span class="stringliteral">&quot;File&quot;</span>].isna().any()</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9faa2298e31580ffb37ff270a865320c" name="a9faa2298e31580ffb37ff270a865320c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9faa2298e31580ffb37ff270a865320c">&#9670;&#160;</a></span>test_mean_on_timedelta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_mean_on_timedelta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1304</span><span class="keyword">def </span>test_mean_on_timedelta():</div>
<div class="line"><span class="lineno"> 1305</span>    <span class="comment"># GH 17382</span></div>
<div class="line"><span class="lineno"> 1306</span>    df = DataFrame({<span class="stringliteral">&quot;time&quot;</span>: pd.to_timedelta(range(10)), <span class="stringliteral">&quot;cat&quot;</span>: [<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>] * 5})</div>
<div class="line"><span class="lineno"> 1307</span>    result = df.groupby(<span class="stringliteral">&quot;cat&quot;</span>)[<span class="stringliteral">&quot;time&quot;</span>].mean()</div>
<div class="line"><span class="lineno"> 1308</span>    expected = Series(</div>
<div class="line"><span class="lineno"> 1309</span>        pd.to_timedelta([4, 5]), name=<span class="stringliteral">&quot;time&quot;</span>, index=Index([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>], name=<span class="stringliteral">&quot;cat&quot;</span>)</div>
<div class="line"><span class="lineno"> 1310</span>    )</div>
<div class="line"><span class="lineno"> 1311</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1312</span> </div>
<div class="line"><span class="lineno"> 1313</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7598c7faf1fa7e97c11b0ce394d6ed93" name="a7598c7faf1fa7e97c11b0ce394d6ed93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7598c7faf1fa7e97c11b0ce394d6ed93">&#9670;&#160;</a></span>test_median_empty_bins()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_median_empty_bins </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  412</span><span class="keyword">def </span>test_median_empty_bins(observed):</div>
<div class="line"><span class="lineno">  413</span>    df = DataFrame(np.random.randint(0, 44, 500))</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>    grps = range(0, 55, 5)</div>
<div class="line"><span class="lineno">  416</span>    bins = pd.cut(df[0], grps)</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    result = df.groupby(bins, observed=observed).median()</div>
<div class="line"><span class="lineno">  419</span>    expected = df.groupby(bins, observed=observed).agg(<span class="keyword">lambda</span> x: x.median())</div>
<div class="line"><span class="lineno">  420</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  424</span>    <span class="stringliteral">&quot;dtype&quot;</span>, [<span class="stringliteral">&quot;int8&quot;</span>, <span class="stringliteral">&quot;int16&quot;</span>, <span class="stringliteral">&quot;int32&quot;</span>, <span class="stringliteral">&quot;int64&quot;</span>, <span class="stringliteral">&quot;float32&quot;</span>, <span class="stringliteral">&quot;float64&quot;</span>, <span class="stringliteral">&quot;uint64&quot;</span>]</div>
<div class="line"><span class="lineno">  425</span>)</div>
<div class="line"><span class="lineno">  426</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  427</span>    <span class="stringliteral">&quot;method,data&quot;</span>,</div>
<div class="line"><span class="lineno">  428</span>    [</div>
<div class="line"><span class="lineno">  429</span>        (<span class="stringliteral">&quot;first&quot;</span>, {<span class="stringliteral">&quot;df&quot;</span>: [{<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: 1}, {<span class="stringliteral">&quot;a&quot;</span>: 2, <span class="stringliteral">&quot;b&quot;</span>: 3}]}),</div>
<div class="line"><span class="lineno">  430</span>        (<span class="stringliteral">&quot;last&quot;</span>, {<span class="stringliteral">&quot;df&quot;</span>: [{<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: 2}, {<span class="stringliteral">&quot;a&quot;</span>: 2, <span class="stringliteral">&quot;b&quot;</span>: 4}]}),</div>
<div class="line"><span class="lineno">  431</span>        (<span class="stringliteral">&quot;min&quot;</span>, {<span class="stringliteral">&quot;df&quot;</span>: [{<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: 1}, {<span class="stringliteral">&quot;a&quot;</span>: 2, <span class="stringliteral">&quot;b&quot;</span>: 3}]}),</div>
<div class="line"><span class="lineno">  432</span>        (<span class="stringliteral">&quot;max&quot;</span>, {<span class="stringliteral">&quot;df&quot;</span>: [{<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: 2}, {<span class="stringliteral">&quot;a&quot;</span>: 2, <span class="stringliteral">&quot;b&quot;</span>: 4}]}),</div>
<div class="line"><span class="lineno">  433</span>        (<span class="stringliteral">&quot;nth&quot;</span>, {<span class="stringliteral">&quot;df&quot;</span>: [{<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: 2}, {<span class="stringliteral">&quot;a&quot;</span>: 2, <span class="stringliteral">&quot;b&quot;</span>: 4}], <span class="stringliteral">&quot;args&quot;</span>: [1]}),</div>
<div class="line"><span class="lineno">  434</span>        (<span class="stringliteral">&quot;count&quot;</span>, {<span class="stringliteral">&quot;df&quot;</span>: [{<span class="stringliteral">&quot;a&quot;</span>: 1, <span class="stringliteral">&quot;b&quot;</span>: 2}, {<span class="stringliteral">&quot;a&quot;</span>: 2, <span class="stringliteral">&quot;b&quot;</span>: 2}], <span class="stringliteral">&quot;out_type&quot;</span>: <span class="stringliteral">&quot;int64&quot;</span>}),</div>
<div class="line"><span class="lineno">  435</span>    ],</div>
<div class="line"><span class="lineno">  436</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a19186ccb40355ae56294dac9e82da0c3" name="a19186ccb40355ae56294dac9e82da0c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19186ccb40355ae56294dac9e82da0c3">&#9670;&#160;</a></span>test_multiindex_group_all_columns_when_empty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_multiindex_group_all_columns_when_empty </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groupby_func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1594</span><span class="keyword">def </span>test_multiindex_group_all_columns_when_empty(groupby_func):</div>
<div class="line"><span class="lineno"> 1595</span>    <span class="comment"># GH 32464</span></div>
<div class="line"><span class="lineno"> 1596</span>    df = DataFrame({<span class="stringliteral">&quot;a&quot;</span>: [], <span class="stringliteral">&quot;b&quot;</span>: [], <span class="stringliteral">&quot;c&quot;</span>: []}).set_index([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>])</div>
<div class="line"><span class="lineno"> 1597</span>    gb = df.groupby([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>], group_keys=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1598</span>    method = getattr(gb, groupby_func)</div>
<div class="line"><span class="lineno"> 1599</span>    args = get_groupby_method_args(groupby_func, df)</div>
<div class="line"><span class="lineno"> 1600</span> </div>
<div class="line"><span class="lineno"> 1601</span>    result = method(*args).index</div>
<div class="line"><span class="lineno"> 1602</span>    expected = df.index</div>
<div class="line"><span class="lineno"> 1603</span>    tm.assert_index_equal(result, expected)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af178bef2b17de6a21f6acd95f7a7ff15" name="af178bef2b17de6a21f6acd95f7a7ff15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af178bef2b17de6a21f6acd95f7a7ff15">&#9670;&#160;</a></span>test_nlargest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_nlargest </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  713</span><span class="keyword">def </span>test_nlargest():</div>
<div class="line"><span class="lineno">  714</span>    a = Series([1, 3, 5, 7, 2, 9, 0, 4, 6, 10])</div>
<div class="line"><span class="lineno">  715</span>    b = Series(list(<span class="stringliteral">&quot;a&quot;</span> * 5 + <span class="stringliteral">&quot;b&quot;</span> * 5))</div>
<div class="line"><span class="lineno">  716</span>    gb = a.groupby(b)</div>
<div class="line"><span class="lineno">  717</span>    r = gb.nlargest(3)</div>
<div class="line"><span class="lineno">  718</span>    e = Series(</div>
<div class="line"><span class="lineno">  719</span>        [7, 5, 3, 10, 9, 6],</div>
<div class="line"><span class="lineno">  720</span>        index=MultiIndex.from_arrays([list(<span class="stringliteral">&quot;aaabbb&quot;</span>), [3, 2, 1, 9, 5, 8]]),</div>
<div class="line"><span class="lineno">  721</span>    )</div>
<div class="line"><span class="lineno">  722</span>    tm.assert_series_equal(r, e)</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>    a = Series([1, 1, 3, 2, 0, 3, 3, 2, 1, 0])</div>
<div class="line"><span class="lineno">  725</span>    gb = a.groupby(b)</div>
<div class="line"><span class="lineno">  726</span>    e = Series(</div>
<div class="line"><span class="lineno">  727</span>        [3, 2, 1, 3, 3, 2],</div>
<div class="line"><span class="lineno">  728</span>        index=MultiIndex.from_arrays([list(<span class="stringliteral">&quot;aaabbb&quot;</span>), [2, 3, 1, 6, 5, 7]]),</div>
<div class="line"><span class="lineno">  729</span>    )</div>
<div class="line"><span class="lineno">  730</span>    tm.assert_series_equal(gb.nlargest(3, keep=<span class="stringliteral">&quot;last&quot;</span>), e)</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acb73fdbe07cdc26d5668c8b4e8a5b500" name="acb73fdbe07cdc26d5668c8b4e8a5b500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb73fdbe07cdc26d5668c8b4e8a5b500">&#9670;&#160;</a></span>test_nlargest_and_smallest_noop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_nlargest_and_smallest_noop </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  803</span><span class="keyword">def </span>test_nlargest_and_smallest_noop(data, groups, method):</div>
<div class="line"><span class="lineno">  804</span>    <span class="comment"># GH 15272, GH 16345, GH 29129</span></div>
<div class="line"><span class="lineno">  805</span>    <span class="comment"># Test nlargest/smallest when it results in a noop,</span></div>
<div class="line"><span class="lineno">  806</span>    <span class="comment"># i.e. input is sorted and group size &lt;= n</span></div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;nlargest&quot;</span>:</div>
<div class="line"><span class="lineno">  808</span>        data = list(reversed(data))</div>
<div class="line"><span class="lineno">  809</span>    ser = Series(data, name=<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  810</span>    result = getattr(ser.groupby(groups), method)(n=2)</div>
<div class="line"><span class="lineno">  811</span>    expected = Series(data, index=MultiIndex.from_arrays([groups, ser.index]), name=<span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><span class="lineno">  812</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span><span class="preprocessor">@pytest.mark.parametrize(&quot;func&quot;, [&quot;cumprod&quot;, &quot;cumsum&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3b719b6c4fc7fbc94dad2506226a296" name="ae3b719b6c4fc7fbc94dad2506226a296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b719b6c4fc7fbc94dad2506226a296">&#9670;&#160;</a></span>test_nlargest_mi_grouper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_nlargest_mi_grouper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  733</span><span class="keyword">def </span>test_nlargest_mi_grouper():</div>
<div class="line"><span class="lineno">  734</span>    <span class="comment"># see gh-21411</span></div>
<div class="line"><span class="lineno">  735</span>    npr = np.random.RandomState(123456789)</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>    dts = date_range(<span class="stringliteral">&quot;20180101&quot;</span>, periods=10)</div>
<div class="line"><span class="lineno">  738</span>    iterables = [dts, [<span class="stringliteral">&quot;one&quot;</span>, <span class="stringliteral">&quot;two&quot;</span>]]</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    idx = MultiIndex.from_product(iterables, names=[<span class="stringliteral">&quot;first&quot;</span>, <span class="stringliteral">&quot;second&quot;</span>])</div>
<div class="line"><span class="lineno">  741</span>    s = Series(npr.randn(20), index=idx)</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>    result = s.groupby(<span class="stringliteral">&quot;first&quot;</span>).nlargest(1)</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    exp_idx = MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno">  746</span>        [</div>
<div class="line"><span class="lineno">  747</span>            (dts[0], dts[0], <span class="stringliteral">&quot;one&quot;</span>),</div>
<div class="line"><span class="lineno">  748</span>            (dts[1], dts[1], <span class="stringliteral">&quot;one&quot;</span>),</div>
<div class="line"><span class="lineno">  749</span>            (dts[2], dts[2], <span class="stringliteral">&quot;one&quot;</span>),</div>
<div class="line"><span class="lineno">  750</span>            (dts[3], dts[3], <span class="stringliteral">&quot;two&quot;</span>),</div>
<div class="line"><span class="lineno">  751</span>            (dts[4], dts[4], <span class="stringliteral">&quot;one&quot;</span>),</div>
<div class="line"><span class="lineno">  752</span>            (dts[5], dts[5], <span class="stringliteral">&quot;one&quot;</span>),</div>
<div class="line"><span class="lineno">  753</span>            (dts[6], dts[6], <span class="stringliteral">&quot;one&quot;</span>),</div>
<div class="line"><span class="lineno">  754</span>            (dts[7], dts[7], <span class="stringliteral">&quot;one&quot;</span>),</div>
<div class="line"><span class="lineno">  755</span>            (dts[8], dts[8], <span class="stringliteral">&quot;two&quot;</span>),</div>
<div class="line"><span class="lineno">  756</span>            (dts[9], dts[9], <span class="stringliteral">&quot;one&quot;</span>),</div>
<div class="line"><span class="lineno">  757</span>        ],</div>
<div class="line"><span class="lineno">  758</span>        names=[<span class="stringliteral">&quot;first&quot;</span>, <span class="stringliteral">&quot;first&quot;</span>, <span class="stringliteral">&quot;second&quot;</span>],</div>
<div class="line"><span class="lineno">  759</span>    )</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>    exp_values = [</div>
<div class="line"><span class="lineno">  762</span>        2.2129019979039612,</div>
<div class="line"><span class="lineno">  763</span>        1.8417114045748335,</div>
<div class="line"><span class="lineno">  764</span>        0.858963679564603,</div>
<div class="line"><span class="lineno">  765</span>        1.3759151378258088,</div>
<div class="line"><span class="lineno">  766</span>        0.9430284594687134,</div>
<div class="line"><span class="lineno">  767</span>        0.5296914208183142,</div>
<div class="line"><span class="lineno">  768</span>        0.8318045593815487,</div>
<div class="line"><span class="lineno">  769</span>        -0.8476703342910327,</div>
<div class="line"><span class="lineno">  770</span>        0.3804446884133735,</div>
<div class="line"><span class="lineno">  771</span>        -0.8028845810770998,</div>
<div class="line"><span class="lineno">  772</span>    ]</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>    expected = Series(exp_values, index=exp_idx)</div>
<div class="line"><span class="lineno">  775</span>    tm.assert_series_equal(result, expected, check_exact=<span class="keyword">False</span>, rtol=1e-3)</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a244bfa0f23a8fbb5ca0685a71a49c521" name="a244bfa0f23a8fbb5ca0685a71a49c521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a244bfa0f23a8fbb5ca0685a71a49c521">&#9670;&#160;</a></span>test_nsmallest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_nsmallest </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  778</span><span class="keyword">def </span>test_nsmallest():</div>
<div class="line"><span class="lineno">  779</span>    a = Series([1, 3, 5, 7, 2, 9, 0, 4, 6, 10])</div>
<div class="line"><span class="lineno">  780</span>    b = Series(list(<span class="stringliteral">&quot;a&quot;</span> * 5 + <span class="stringliteral">&quot;b&quot;</span> * 5))</div>
<div class="line"><span class="lineno">  781</span>    gb = a.groupby(b)</div>
<div class="line"><span class="lineno">  782</span>    r = gb.nsmallest(3)</div>
<div class="line"><span class="lineno">  783</span>    e = Series(</div>
<div class="line"><span class="lineno">  784</span>        [1, 2, 3, 0, 4, 6],</div>
<div class="line"><span class="lineno">  785</span>        index=MultiIndex.from_arrays([list(<span class="stringliteral">&quot;aaabbb&quot;</span>), [0, 4, 1, 6, 7, 8]]),</div>
<div class="line"><span class="lineno">  786</span>    )</div>
<div class="line"><span class="lineno">  787</span>    tm.assert_series_equal(r, e)</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>    a = Series([1, 1, 3, 2, 0, 3, 3, 2, 1, 0])</div>
<div class="line"><span class="lineno">  790</span>    gb = a.groupby(b)</div>
<div class="line"><span class="lineno">  791</span>    e = Series(</div>
<div class="line"><span class="lineno">  792</span>        [0, 1, 1, 0, 1, 2],</div>
<div class="line"><span class="lineno">  793</span>        index=MultiIndex.from_arrays([list(<span class="stringliteral">&quot;aaabbb&quot;</span>), [4, 1, 0, 9, 8, 7]]),</div>
<div class="line"><span class="lineno">  794</span>    )</div>
<div class="line"><span class="lineno">  795</span>    tm.assert_series_equal(gb.nsmallest(3, keep=<span class="stringliteral">&quot;last&quot;</span>), e)</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  799</span>    <span class="stringliteral">&quot;data, groups&quot;</span>,</div>
<div class="line"><span class="lineno">  800</span>    [([0, 1, 2, 3], [0, 0, 1, 1]), ([0], [0])],</div>
<div class="line"><span class="lineno">  801</span>)</div>
<div class="line"><span class="lineno">  802</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;nlargest&quot;, &quot;nsmallest&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad61263403950d1e95d32328177a280a8" name="ad61263403950d1e95d32328177a280a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad61263403950d1e95d32328177a280a8">&#9670;&#160;</a></span>test_nullable_int_not_cast_as_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_nullable_int_not_cast_as_float </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1000</span><span class="keyword">def </span>test_nullable_int_not_cast_as_float(method, dtype, val):</div>
<div class="line"><span class="lineno"> 1001</span>    data = [val, pd.NA]</div>
<div class="line"><span class="lineno"> 1002</span>    df = DataFrame({<span class="stringliteral">&quot;grp&quot;</span>: [1, 1], <span class="stringliteral">&quot;b&quot;</span>: data}, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1003</span>    grouped = df.groupby(<span class="stringliteral">&quot;grp&quot;</span>)</div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>    result = grouped.transform(method)</div>
<div class="line"><span class="lineno"> 1006</span>    expected = DataFrame({<span class="stringliteral">&quot;b&quot;</span>: data}, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1009</span> </div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1012</span>    <span class="stringliteral">&quot;in_vals, out_vals&quot;</span>,</div>
<div class="line"><span class="lineno"> 1013</span>    [</div>
<div class="line"><span class="lineno"> 1014</span>        <span class="comment"># Basics: strictly increasing (T), strictly decreasing (F),</span></div>
<div class="line"><span class="lineno"> 1015</span>        <span class="comment"># abs val increasing (F), non-strictly increasing (T)</span></div>
<div class="line"><span class="lineno"> 1016</span>        ([1, 2, 5, 3, 2, 0, 4, 5, -6, 1, 1], [<span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">True</span>]),</div>
<div class="line"><span class="lineno"> 1017</span>        <span class="comment"># Test with inf vals</span></div>
<div class="line"><span class="lineno"> 1018</span>        (</div>
<div class="line"><span class="lineno"> 1019</span>            [1, 2.1, np.inf, 3, 2, np.inf, -np.inf, 5, 11, 1, -np.inf],</div>
<div class="line"><span class="lineno"> 1020</span>            [<span class="keyword">True</span>, <span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">False</span>],</div>
<div class="line"><span class="lineno"> 1021</span>        ),</div>
<div class="line"><span class="lineno"> 1022</span>        <span class="comment"># Test with nan vals; should always be False</span></div>
<div class="line"><span class="lineno"> 1023</span>        (</div>
<div class="line"><span class="lineno"> 1024</span>            [1, 2, np.nan, 3, 2, np.nan, np.nan, 5, -np.inf, 1, np.nan],</div>
<div class="line"><span class="lineno"> 1025</span>            [<span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">False</span>],</div>
<div class="line"><span class="lineno"> 1026</span>        ),</div>
<div class="line"><span class="lineno"> 1027</span>    ],</div>
<div class="line"><span class="lineno"> 1028</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0a61d34448ed935d73a8afc99149e71" name="ad0a61d34448ed935d73a8afc99149e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0a61d34448ed935d73a8afc99149e71">&#9670;&#160;</a></span>test_numpy_compat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_numpy_compat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  816</span><span class="keyword">def </span>test_numpy_compat(func):</div>
<div class="line"><span class="lineno">  817</span>    <span class="comment"># see gh-12811</span></div>
<div class="line"><span class="lineno">  818</span>    df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [1, 2, 1], <span class="stringliteral">&quot;B&quot;</span>: [1, 2, 3]})</div>
<div class="line"><span class="lineno">  819</span>    g = df.groupby(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>    msg = <span class="stringliteral">&quot;numpy operations are not valid with groupby&quot;</span></div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>    <span class="keyword">with</span> pytest.raises(UnsupportedFunctionCall, match=msg):</div>
<div class="line"><span class="lineno">  824</span>        getattr(g, func)(1, 2, 3)</div>
<div class="line"><span class="lineno">  825</span>    <span class="keyword">with</span> pytest.raises(UnsupportedFunctionCall, match=msg):</div>
<div class="line"><span class="lineno">  826</span>        getattr(g, func)(foo=1)</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a15064cfeda235e20d3841275f40090d6" name="a15064cfeda235e20d3841275f40090d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15064cfeda235e20d3841275f40090d6">&#9670;&#160;</a></span>test_ops_general()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_ops_general </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>targop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  690</span><span class="keyword">def </span>test_ops_general(op, targop):</div>
<div class="line"><span class="lineno">  691</span>    df = DataFrame(np.random.randn(1000))</div>
<div class="line"><span class="lineno">  692</span>    labels = np.random.randint(0, 50, size=1000).astype(float)</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>    result = getattr(df.groupby(labels), op)()</div>
<div class="line"><span class="lineno">  695</span>    expected = df.groupby(labels).agg(targop)</div>
<div class="line"><span class="lineno">  696</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af14360959c808c04d41ad3474bbe5cd2" name="af14360959c808c04d41ad3474bbe5cd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af14360959c808c04d41ad3474bbe5cd2">&#9670;&#160;</a></span>test_series_describe_multikey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_series_describe_multikey </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1089</span><span class="keyword">def </span>test_series_describe_multikey():</div>
<div class="line"><span class="lineno"> 1090</span>    ts = tm.makeTimeSeries()</div>
<div class="line"><span class="lineno"> 1091</span>    grouped = ts.groupby([<span class="keyword">lambda</span> x: x.year, <span class="keyword">lambda</span> x: x.month])</div>
<div class="line"><span class="lineno"> 1092</span>    result = grouped.describe()</div>
<div class="line"><span class="lineno"> 1093</span>    tm.assert_series_equal(result[<span class="stringliteral">&quot;mean&quot;</span>], grouped.mean(), check_names=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1094</span>    tm.assert_series_equal(result[<span class="stringliteral">&quot;std&quot;</span>], grouped.std(), check_names=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1095</span>    tm.assert_series_equal(result[<span class="stringliteral">&quot;min&quot;</span>], grouped.min(), check_names=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bcd85671b20661d1d98167da3a073f4" name="a5bcd85671b20661d1d98167da3a073f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bcd85671b20661d1d98167da3a073f4">&#9670;&#160;</a></span>test_series_describe_single()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_series_describe_single </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1098</span><span class="keyword">def </span>test_series_describe_single():</div>
<div class="line"><span class="lineno"> 1099</span>    ts = tm.makeTimeSeries()</div>
<div class="line"><span class="lineno"> 1100</span>    grouped = ts.groupby(<span class="keyword">lambda</span> x: x.month)</div>
<div class="line"><span class="lineno"> 1101</span>    result = grouped.apply(<span class="keyword">lambda</span> x: x.describe())</div>
<div class="line"><span class="lineno"> 1102</span>    expected = grouped.describe().stack()</div>
<div class="line"><span class="lineno"> 1103</span>    tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1104</span> </div>
<div class="line"><span class="lineno"> 1105</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aed7f5ae1dcc11abd4d3d4cbb19235401" name="aed7f5ae1dcc11abd4d3d4cbb19235401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed7f5ae1dcc11abd4d3d4cbb19235401">&#9670;&#160;</a></span>test_series_index_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.groupby.test_function.test_series_index_name </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1106</span><span class="keyword">def </span>test_series_index_name(df):</div>
<div class="line"><span class="lineno"> 1107</span>    grouped = df.loc[:, [<span class="stringliteral">&quot;C&quot;</span>]].groupby(df[<span class="stringliteral">&quot;A&quot;</span>])</div>
<div class="line"><span class="lineno"> 1108</span>    result = grouped.agg(<span class="keyword">lambda</span> x: x.mean())</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="keyword">assert</span> result.index.name == <span class="stringliteral">&quot;A&quot;</span></div>
<div class="line"><span class="lineno"> 1110</span> </div>
<div class="line"><span class="lineno"> 1111</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
