<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: jinja2.debug Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacejinja2.html">jinja2</a></li><li class="navelem"><a class="el" href="namespacejinja2_1_1debug.html">debug</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">jinja2.debug Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9224f875d3eaeebf46a3c708668aa2fd" id="r_a9224f875d3eaeebf46a3c708668aa2fd"><td class="memItemLeft" align="right" valign="top">BaseException&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejinja2_1_1debug.html#a9224f875d3eaeebf46a3c708668aa2fd">rewrite_traceback_stack</a> (t.Optional[str] source=None)</td></tr>
<tr class="separator:a9224f875d3eaeebf46a3c708668aa2fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee85e3536634249c08a9526e8ac5c383" id="r_aee85e3536634249c08a9526e8ac5c383"><td class="memItemLeft" align="right" valign="top">TracebackType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejinja2_1_1debug.html#aee85e3536634249c08a9526e8ac5c383">fake_traceback</a> (BaseException exc_value, t.Optional[TracebackType] tb, str filename, int lineno)</td></tr>
<tr class="separator:aee85e3536634249c08a9526e8ac5c383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6397faa7422667ce6daef046eeb0ed5" id="r_aa6397faa7422667ce6daef046eeb0ed5"><td class="memItemLeft" align="right" valign="top">t.Dict[str, t.Any]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacejinja2_1_1debug.html#aa6397faa7422667ce6daef046eeb0ed5">get_template_locals</a> (t.Mapping[str, t.Any] real_locals)</td></tr>
<tr class="separator:aa6397faa7422667ce6daef046eeb0ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aee85e3536634249c08a9526e8ac5c383" name="aee85e3536634249c08a9526e8ac5c383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee85e3536634249c08a9526e8ac5c383">&#9670;&#160;</a></span>fake_traceback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> TracebackType jinja2.debug.fake_traceback </td>
          <td>(</td>
          <td class="paramtype">BaseException&#160;</td>
          <td class="paramname"><em>exc_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">t.Optional[TracebackType]&#160;</td>
          <td class="paramname"><em>tb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int
&#160;</td>
          <td class="paramname"><em>lineno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Produce a new traceback object that looks like it came from the
template source instead of the compiled code. The filename, line
number, and location name will point to the template, and the local
variables will be the current template context.

:param exc_value: The original exception to be re-raised to create
    the new traceback.
:param tb: The original traceback to get the local variables and
    code info from.
:param filename: The template filename.
:param lineno: The line number in the template source.
</pre> <div class="fragment"><div class="line"><span class="lineno">   78</span>) -&gt; TracebackType:</div>
<div class="line"><span class="lineno">   79</span>    <span class="stringliteral">&quot;&quot;&quot;Produce a new traceback object that looks like it came from the</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    template source instead of the compiled code. The filename, line</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    number, and location name will point to the template, and the local</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    variables will be the current template context.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    :param exc_value: The original exception to be re-raised to create</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        the new traceback.</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">    :param tb: The original traceback to get the local variables and</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        code info from.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    :param filename: The template filename.</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    :param lineno: The line number in the template source.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">if</span> tb <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   92</span>        <span class="comment"># Replace the real locals with the context that would be</span></div>
<div class="line"><span class="lineno">   93</span>        <span class="comment"># available at that point in the template.</span></div>
<div class="line"><span class="lineno">   94</span>        locals = get_template_locals(tb.tb_frame.f_locals)</div>
<div class="line"><span class="lineno">   95</span>        locals.pop(<span class="stringliteral">&quot;__jinja_exception__&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   97</span>        locals = {}</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    globals = {</div>
<div class="line"><span class="lineno">  100</span>        <span class="stringliteral">&quot;__name__&quot;</span>: filename,</div>
<div class="line"><span class="lineno">  101</span>        <span class="stringliteral">&quot;__file__&quot;</span>: filename,</div>
<div class="line"><span class="lineno">  102</span>        <span class="stringliteral">&quot;__jinja_exception__&quot;</span>: exc_value,</div>
<div class="line"><span class="lineno">  103</span>    }</div>
<div class="line"><span class="lineno">  104</span>    <span class="comment"># Raise an exception at the correct line number.</span></div>
<div class="line"><span class="lineno">  105</span>    code: CodeType = compile(</div>
<div class="line"><span class="lineno">  106</span>        <span class="stringliteral">&quot;\n&quot;</span> * (lineno - 1) + <span class="stringliteral">&quot;raise __jinja_exception__&quot;</span>, filename, <span class="stringliteral">&quot;exec&quot;</span></div>
<div class="line"><span class="lineno">  107</span>    )</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="comment"># Build a new code object that points to the template file and</span></div>
<div class="line"><span class="lineno">  110</span>    <span class="comment"># replaces the location with a block name.</span></div>
<div class="line"><span class="lineno">  111</span>    location = <span class="stringliteral">&quot;template&quot;</span></div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">if</span> tb <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  114</span>        function = tb.tb_frame.f_code.co_name</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>        <span class="keywordflow">if</span> function == <span class="stringliteral">&quot;root&quot;</span>:</div>
<div class="line"><span class="lineno">  117</span>            location = <span class="stringliteral">&quot;top-level template code&quot;</span></div>
<div class="line"><span class="lineno">  118</span>        <span class="keywordflow">elif</span> function.startswith(<span class="stringliteral">&quot;block_&quot;</span>):</div>
<div class="line"><span class="lineno">  119</span>            location = f<span class="stringliteral">&quot;block {function[6:]!r}&quot;</span></div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">if</span> sys.version_info &gt;= (3, 8):</div>
<div class="line"><span class="lineno">  122</span>        code = code.replace(co_name=location)</div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  124</span>        code = CodeType(</div>
<div class="line"><span class="lineno">  125</span>            code.co_argcount,</div>
<div class="line"><span class="lineno">  126</span>            code.co_kwonlyargcount,</div>
<div class="line"><span class="lineno">  127</span>            code.co_nlocals,</div>
<div class="line"><span class="lineno">  128</span>            code.co_stacksize,</div>
<div class="line"><span class="lineno">  129</span>            code.co_flags,</div>
<div class="line"><span class="lineno">  130</span>            code.co_code,</div>
<div class="line"><span class="lineno">  131</span>            code.co_consts,</div>
<div class="line"><span class="lineno">  132</span>            code.co_names,</div>
<div class="line"><span class="lineno">  133</span>            code.co_varnames,</div>
<div class="line"><span class="lineno">  134</span>            code.co_filename,</div>
<div class="line"><span class="lineno">  135</span>            location,</div>
<div class="line"><span class="lineno">  136</span>            code.co_firstlineno,</div>
<div class="line"><span class="lineno">  137</span>            code.co_lnotab,</div>
<div class="line"><span class="lineno">  138</span>            code.co_freevars,</div>
<div class="line"><span class="lineno">  139</span>            code.co_cellvars,</div>
<div class="line"><span class="lineno">  140</span>        )</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    <span class="comment"># Execute the new code, which is guaranteed to raise, and return</span></div>
<div class="line"><span class="lineno">  143</span>    <span class="comment"># the new traceback without this frame.</span></div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  145</span>        exec(code, globals, locals)</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">except</span> BaseException:</div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">return</span> sys.exc_info()[2].tb_next  <span class="comment"># type: ignore</span></div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6397faa7422667ce6daef046eeb0ed5" name="aa6397faa7422667ce6daef046eeb0ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6397faa7422667ce6daef046eeb0ed5">&#9670;&#160;</a></span>get_template_locals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> t.Dict[str, t.Any] jinja2.debug.get_template_locals </td>
          <td>(</td>
          <td class="paramtype">t.Mapping[str, t.Any]&#160;</td>
          <td class="paramname"><em>real_locals</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Based on the runtime locals, get the context that would be
available at that point in the template.
</pre> <div class="fragment"><div class="line"><span class="lineno">  150</span><span class="keyword">def </span>get_template_locals(real_locals: t.Mapping[str, t.Any]) -&gt; t.Dict[str, t.Any]:</div>
<div class="line"><span class="lineno">  151</span>    <span class="stringliteral">&quot;&quot;&quot;Based on the runtime locals, get the context that would be</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    available at that point in the template.</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  154</span>    <span class="comment"># Start with the current template context.</span></div>
<div class="line"><span class="lineno">  155</span>    ctx: <span class="stringliteral">&quot;t.Optional[Context]&quot;</span> = real_locals.get(<span class="stringliteral">&quot;context&quot;</span>)</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">if</span> ctx <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  158</span>        data: t.Dict[str, t.Any] = ctx.get_all().copy()</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  160</span>        data = {}</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># Might be in a derived context that only sets local variables</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="comment"># rather than pushing a context. Local variables follow the scheme</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="comment"># l_depth_name. Find the highest-depth local that has a value for</span></div>
<div class="line"><span class="lineno">  165</span>    <span class="comment"># each name.</span></div>
<div class="line"><span class="lineno">  166</span>    local_overrides: t.Dict[str, t.Tuple[int, t.Any]] = {}</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">for</span> name, value <span class="keywordflow">in</span> real_locals.items():</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> name.startswith(<span class="stringliteral">&quot;l_&quot;</span>) <span class="keywordflow">or</span> value <span class="keywordflow">is</span> missing:</div>
<div class="line"><span class="lineno">  170</span>            <span class="comment"># Not a template variable, or no longer relevant.</span></div>
<div class="line"><span class="lineno">  171</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  174</span>            _, depth_str, name = name.split(<span class="stringliteral">&quot;_&quot;</span>, 2)</div>
<div class="line"><span class="lineno">  175</span>            depth = int(depth_str)</div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  177</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>        cur_depth = local_overrides.get(name, (-1,))[0]</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">if</span> cur_depth &lt; depth:</div>
<div class="line"><span class="lineno">  182</span>            local_overrides[name] = (depth, value)</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    <span class="comment"># Modify the context with any derived context.</span></div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">for</span> name, (_, value) <span class="keywordflow">in</span> local_overrides.items():</div>
<div class="line"><span class="lineno">  186</span>        <span class="keywordflow">if</span> value <span class="keywordflow">is</span> missing:</div>
<div class="line"><span class="lineno">  187</span>            data.pop(name, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  189</span>            data[name] = value</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">return</span> data</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9224f875d3eaeebf46a3c708668aa2fd" name="a9224f875d3eaeebf46a3c708668aa2fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9224f875d3eaeebf46a3c708668aa2fd">&#9670;&#160;</a></span>rewrite_traceback_stack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> BaseException jinja2.debug.rewrite_traceback_stack </td>
          <td>(</td>
          <td class="paramtype">t.Optional[str] &#160;</td>
          <td class="paramname"><em>source</em> = <code>None</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Rewrite the current exception to replace any tracebacks from
within compiled template code with tracebacks that look like they
came from the template source.

This must be called within an ``except`` block.

:param source: For ``TemplateSyntaxError``, the original source if
    known.
:return: The original exception with the rewritten traceback.
</pre> <div class="fragment"><div class="line"><span class="lineno">   14</span><span class="keyword">def </span>rewrite_traceback_stack(source: t.Optional[str] = <span class="keywordtype">None</span>) -&gt; BaseException:</div>
<div class="line"><span class="lineno">   15</span>    <span class="stringliteral">&quot;&quot;&quot;Rewrite the current exception to replace any tracebacks from</span></div>
<div class="line"><span class="lineno">   16</span><span class="stringliteral">    within compiled template code with tracebacks that look like they</span></div>
<div class="line"><span class="lineno">   17</span><span class="stringliteral">    came from the template source.</span></div>
<div class="line"><span class="lineno">   18</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   19</span><span class="stringliteral">    This must be called within an ``except`` block.</span></div>
<div class="line"><span class="lineno">   20</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   21</span><span class="stringliteral">    :param source: For ``TemplateSyntaxError``, the original source if</span></div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral">        known.</span></div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral">    :return: The original exception with the rewritten traceback.</span></div>
<div class="line"><span class="lineno">   24</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   25</span>    _, exc_value, tb = sys.exc_info()</div>
<div class="line"><span class="lineno">   26</span>    exc_value = t.cast(BaseException, exc_value)</div>
<div class="line"><span class="lineno">   27</span>    tb = t.cast(TracebackType, tb)</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">if</span> isinstance(exc_value, TemplateSyntaxError) <span class="keywordflow">and</span> <span class="keywordflow">not</span> exc_value.translated:</div>
<div class="line"><span class="lineno">   30</span>        exc_value.translated = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">   31</span>        exc_value.source = source</div>
<div class="line"><span class="lineno">   32</span>        <span class="comment"># Remove the old traceback, otherwise the frames from the</span></div>
<div class="line"><span class="lineno">   33</span>        <span class="comment"># compiler still show up.</span></div>
<div class="line"><span class="lineno">   34</span>        exc_value.with_traceback(<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">   35</span>        <span class="comment"># Outside of runtime, so the frame isn&#39;t executing template</span></div>
<div class="line"><span class="lineno">   36</span>        <span class="comment"># code, but it still needs to point at the template.</span></div>
<div class="line"><span class="lineno">   37</span>        tb = fake_traceback(</div>
<div class="line"><span class="lineno">   38</span>            exc_value, <span class="keywordtype">None</span>, exc_value.filename <span class="keywordflow">or</span> <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>, exc_value.lineno</div>
<div class="line"><span class="lineno">   39</span>        )</div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   41</span>        <span class="comment"># Skip the frame for the render function.</span></div>
<div class="line"><span class="lineno">   42</span>        tb = tb.tb_next</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>    stack = []</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    <span class="comment"># Build the stack of traceback object, replacing any in template</span></div>
<div class="line"><span class="lineno">   47</span>    <span class="comment"># code with the source file and line information.</span></div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">while</span> tb <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   49</span>        <span class="comment"># Skip frames decorated with @internalcode. These are internal</span></div>
<div class="line"><span class="lineno">   50</span>        <span class="comment"># calls that aren&#39;t useful in template debugging output.</span></div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordflow">if</span> tb.tb_frame.f_code <span class="keywordflow">in</span> internal_code:</div>
<div class="line"><span class="lineno">   52</span>            tb = tb.tb_next</div>
<div class="line"><span class="lineno">   53</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>        template = tb.tb_frame.f_globals.get(<span class="stringliteral">&quot;__jinja_template__&quot;</span>)</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>        <span class="keywordflow">if</span> template <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   58</span>            lineno = template.get_corresponding_lineno(tb.tb_lineno)</div>
<div class="line"><span class="lineno">   59</span>            fake_tb = fake_traceback(exc_value, tb, template.filename, lineno)</div>
<div class="line"><span class="lineno">   60</span>            stack.append(fake_tb)</div>
<div class="line"><span class="lineno">   61</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   62</span>            stack.append(tb)</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>        tb = tb.tb_next</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    tb_next = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="comment"># Assign tb_next in reverse to avoid circular references.</span></div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">for</span> tb <span class="keywordflow">in</span> reversed(stack):</div>
<div class="line"><span class="lineno">   70</span>        tb.tb_next = tb_next</div>
<div class="line"><span class="lineno">   71</span>        tb_next = tb</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">return</span> exc_value.with_traceback(tb_next)</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
