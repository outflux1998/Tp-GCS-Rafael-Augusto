<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.neighbors._base Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1neighbors.html">neighbors</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html">_base</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sklearn.neighbors._base Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1neighbors_1_1__base_1_1_k_neighbors_mixin.html">KNeighborsMixin</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1neighbors_1_1__base_1_1_neighbors_base.html">NeighborsBase</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1neighbors_1_1__base_1_1_radius_neighbors_mixin.html">RadiusNeighborsMixin</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adacbba35a56ee6f6a72df15f2f73789e" id="r_adacbba35a56ee6f6a72df15f2f73789e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#adacbba35a56ee6f6a72df15f2f73789e">_get_weights</a> (dist, weights)</td></tr>
<tr class="separator:adacbba35a56ee6f6a72df15f2f73789e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a915ae0bca9503ae26315114a422377f5" id="r_a915ae0bca9503ae26315114a422377f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#a915ae0bca9503ae26315114a422377f5">_is_sorted_by_data</a> (graph)</td></tr>
<tr class="separator:a915ae0bca9503ae26315114a422377f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a465e810e6ab1c4abe663b7eb47a9d769" id="r_a465e810e6ab1c4abe663b7eb47a9d769"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#a465e810e6ab1c4abe663b7eb47a9d769">_check_precomputed</a> (X)</td></tr>
<tr class="separator:a465e810e6ab1c4abe663b7eb47a9d769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63ea0d0f41a218d63305958400cefc46" id="r_a63ea0d0f41a218d63305958400cefc46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#a63ea0d0f41a218d63305958400cefc46">sort_graph_by_row_values</a> (graph, copy=False, warn_when_not_sorted=True)</td></tr>
<tr class="separator:a63ea0d0f41a218d63305958400cefc46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16a11c93f07496d52692c71dc84d385" id="r_ab16a11c93f07496d52692c71dc84d385"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#ab16a11c93f07496d52692c71dc84d385">_kneighbors_from_graph</a> (graph, n_neighbors, return_distance)</td></tr>
<tr class="separator:ab16a11c93f07496d52692c71dc84d385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9348f412b346650dd45044c882e74a0" id="r_ae9348f412b346650dd45044c882e74a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#ae9348f412b346650dd45044c882e74a0">_radius_neighbors_from_graph</a> (graph, radius, return_distance)</td></tr>
<tr class="separator:ae9348f412b346650dd45044c882e74a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2787f8b1ff5a26f979cbdffbd7afdfae" id="r_a2787f8b1ff5a26f979cbdffbd7afdfae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#a2787f8b1ff5a26f979cbdffbd7afdfae">_tree_query_parallel_helper</a> (tree, *args, **kwargs)</td></tr>
<tr class="separator:a2787f8b1ff5a26f979cbdffbd7afdfae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa797f09dd2e21510f47524be5c7ea19c" id="r_aa797f09dd2e21510f47524be5c7ea19c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#aa797f09dd2e21510f47524be5c7ea19c">_tree_query_radius_parallel_helper</a> (tree, *args, **kwargs)</td></tr>
<tr class="separator:aa797f09dd2e21510f47524be5c7ea19c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a09008ab392e7e934d40f8b7413da8804" id="r_a09008ab392e7e934d40f8b7413da8804"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#a09008ab392e7e934d40f8b7413da8804">VALID_METRICS</a></td></tr>
<tr class="separator:a09008ab392e7e934d40f8b7413da8804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51bc698b7677560d17aa0807ee8c7d43" id="r_a51bc698b7677560d17aa0807ee8c7d43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1neighbors_1_1__base.html#a51bc698b7677560d17aa0807ee8c7d43">VALID_METRICS_SPARSE</a></td></tr>
<tr class="separator:a51bc698b7677560d17aa0807ee8c7d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Base and mixin classes for nearest neighbors.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a465e810e6ab1c4abe663b7eb47a9d769" name="a465e810e6ab1c4abe663b7eb47a9d769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a465e810e6ab1c4abe663b7eb47a9d769">&#9670;&#160;</a></span>_check_precomputed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base._check_precomputed </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Check precomputed distance matrix.

If the precomputed distance matrix is sparse, it checks that the non-zero
entries are sorted by distances. If not, the matrix is copied and sorted.

Parameters
----------
X : {sparse matrix, array-like}, (n_samples, n_samples)
    Distance matrix to other samples. X may be a sparse matrix, in which
    case only non-zero elements may be considered neighbors.

Returns
-------
X : {sparse matrix, array-like}, (n_samples, n_samples)
    Distance matrix to other samples. X may be a sparse matrix, in which
    case only non-zero elements may be considered neighbors.
</pre> <div class="fragment"><div class="line"><span class="lineno">  162</span><span class="keyword">def </span>_check_precomputed(X):</div>
<div class="line"><span class="lineno">  163</span>    <span class="stringliteral">&quot;&quot;&quot;Check precomputed distance matrix.</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">    If the precomputed distance matrix is sparse, it checks that the non-zero</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">    entries are sorted by distances. If not, the matrix is copied and sorted.</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    X : {sparse matrix, array-like}, (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">        Distance matrix to other samples. X may be a sparse matrix, in which</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">        case only non-zero elements may be considered neighbors.</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    X : {sparse matrix, array-like}, (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">        Distance matrix to other samples. X may be a sparse matrix, in which</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">        case only non-zero elements may be considered neighbors.</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> issparse(X):</div>
<div class="line"><span class="lineno">  181</span>        X = check_array(X)</div>
<div class="line"><span class="lineno">  182</span>        check_non_negative(X, whom=<span class="stringliteral">&quot;precomputed distance matrix.&quot;</span>)</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">return</span> X</div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  185</span>        graph = X</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">if</span> graph.format <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&quot;csr&quot;</span>, <span class="stringliteral">&quot;csc&quot;</span>, <span class="stringliteral">&quot;coo&quot;</span>, <span class="stringliteral">&quot;lil&quot;</span>):</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  189</span>            <span class="stringliteral">&quot;Sparse matrix in {!r} format is not supported due to &quot;</span></div>
<div class="line"><span class="lineno">  190</span>            <span class="stringliteral">&quot;its handling of explicit zeros&quot;</span>.format(graph.format)</div>
<div class="line"><span class="lineno">  191</span>        )</div>
<div class="line"><span class="lineno">  192</span>    copied = graph.format != <span class="stringliteral">&quot;csr&quot;</span></div>
<div class="line"><span class="lineno">  193</span>    graph = check_array(graph, accept_sparse=<span class="stringliteral">&quot;csr&quot;</span>)</div>
<div class="line"><span class="lineno">  194</span>    check_non_negative(graph, whom=<span class="stringliteral">&quot;precomputed distance matrix.&quot;</span>)</div>
<div class="line"><span class="lineno">  195</span>    graph = sort_graph_by_row_values(graph, copy=<span class="keywordflow">not</span> copied, warn_when_not_sorted=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordflow">return</span> graph</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adacbba35a56ee6f6a72df15f2f73789e" name="adacbba35a56ee6f6a72df15f2f73789e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adacbba35a56ee6f6a72df15f2f73789e">&#9670;&#160;</a></span>_get_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base._get_weights </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Get the weights from an array of distances and a parameter ``weights``.

Assume weights have already been validated.

Parameters
----------
dist : ndarray
    The input distances.

weights : {'uniform', 'distance'}, callable or None
    The kind of weighting used.

Returns
-------
weights_arr : array of the same shape as ``dist``
    If ``weights == 'uniform'``, then returns None.
</pre> <div class="fragment"><div class="line"><span class="lineno">   89</span><span class="keyword">def </span>_get_weights(dist, weights):</div>
<div class="line"><span class="lineno">   90</span>    <span class="stringliteral">&quot;&quot;&quot;Get the weights from an array of distances and a parameter ``weights``.</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    Assume weights have already been validated.</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    dist : ndarray</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">        The input distances.</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    weights : {&#39;uniform&#39;, &#39;distance&#39;}, callable or None</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">        The kind of weighting used.</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    weights_arr : array of the same shape as ``dist``</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">        If ``weights == &#39;uniform&#39;``, then returns None.</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span> weights <span class="keywordflow">in</span> (<span class="keywordtype">None</span>, <span class="stringliteral">&quot;uniform&quot;</span>):</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">if</span> weights == <span class="stringliteral">&quot;distance&quot;</span>:</div>
<div class="line"><span class="lineno">  111</span>        <span class="comment"># if user attempts to classify a point that was zero distance from one</span></div>
<div class="line"><span class="lineno">  112</span>        <span class="comment"># or more training points, those training points are weighted as 1.0</span></div>
<div class="line"><span class="lineno">  113</span>        <span class="comment"># and the other points as 0.0</span></div>
<div class="line"><span class="lineno">  114</span>        <span class="keywordflow">if</span> dist.dtype <span class="keywordflow">is</span> np.dtype(object):</div>
<div class="line"><span class="lineno">  115</span>            <span class="keywordflow">for</span> point_dist_i, point_dist <span class="keywordflow">in</span> enumerate(dist):</div>
<div class="line"><span class="lineno">  116</span>                <span class="comment"># check if point_dist is iterable</span></div>
<div class="line"><span class="lineno">  117</span>                <span class="comment"># (ex: RadiusNeighborClassifier.predict may set an element of</span></div>
<div class="line"><span class="lineno">  118</span>                <span class="comment"># dist to 1e-6 to represent an &#39;outlier&#39;)</span></div>
<div class="line"><span class="lineno">  119</span>                <span class="keywordflow">if</span> hasattr(point_dist, <span class="stringliteral">&quot;__contains__&quot;</span>) <span class="keywordflow">and</span> 0.0 <span class="keywordflow">in</span> point_dist:</div>
<div class="line"><span class="lineno">  120</span>                    dist[point_dist_i] = point_dist == 0.0</div>
<div class="line"><span class="lineno">  121</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  122</span>                    dist[point_dist_i] = 1.0 / point_dist</div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  124</span>            <span class="keyword">with</span> np.errstate(divide=<span class="stringliteral">&quot;ignore&quot;</span>):</div>
<div class="line"><span class="lineno">  125</span>                dist = 1.0 / dist</div>
<div class="line"><span class="lineno">  126</span>            inf_mask = np.isinf(dist)</div>
<div class="line"><span class="lineno">  127</span>            inf_row = np.any(inf_mask, axis=1)</div>
<div class="line"><span class="lineno">  128</span>            dist[inf_row] = inf_mask[inf_row]</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">return</span> dist</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> callable(weights):</div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordflow">return</span> weights(dist)</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a915ae0bca9503ae26315114a422377f5" name="a915ae0bca9503ae26315114a422377f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a915ae0bca9503ae26315114a422377f5">&#9670;&#160;</a></span>_is_sorted_by_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base._is_sorted_by_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>graph</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return whether the graph's non-zero entries are sorted by data.

The non-zero entries are stored in graph.data and graph.indices.
For each row (or sample), the non-zero entries can be either:
    - sorted by indices, as after graph.sort_indices();
    - sorted by data, as after _check_precomputed(graph);
    - not sorted.

Parameters
----------
graph : sparse matrix of shape (n_samples, n_samples)
    Neighbors graph as given by `kneighbors_graph` or
    `radius_neighbors_graph`. Matrix should be of format CSR format.

Returns
-------
res : bool
    Whether input graph is sorted by data.
</pre> <div class="fragment"><div class="line"><span class="lineno">  135</span><span class="keyword">def </span>_is_sorted_by_data(graph):</div>
<div class="line"><span class="lineno">  136</span>    <span class="stringliteral">&quot;&quot;&quot;Return whether the graph&#39;s non-zero entries are sorted by data.</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    The non-zero entries are stored in graph.data and graph.indices.</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    For each row (or sample), the non-zero entries can be either:</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">        - sorted by indices, as after graph.sort_indices();</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">        - sorted by data, as after _check_precomputed(graph);</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">        - not sorted.</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    graph : sparse matrix of shape (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">        Neighbors graph as given by `kneighbors_graph` or</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">        `radius_neighbors_graph`. Matrix should be of format CSR format.</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    res : bool</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">        Whether input graph is sorted by data.</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="keyword">assert</span> graph.format == <span class="stringliteral">&quot;csr&quot;</span></div>
<div class="line"><span class="lineno">  156</span>    out_of_order = graph.data[:-1] &gt; graph.data[1:]</div>
<div class="line"><span class="lineno">  157</span>    line_change = np.unique(graph.indptr[1:-1] - 1)</div>
<div class="line"><span class="lineno">  158</span>    line_change = line_change[line_change &lt; out_of_order.shape[0]]</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">return</span> out_of_order.sum() == out_of_order[line_change].sum()</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab16a11c93f07496d52692c71dc84d385" name="ab16a11c93f07496d52692c71dc84d385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16a11c93f07496d52692c71dc84d385">&#9670;&#160;</a></span>_kneighbors_from_graph()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base._kneighbors_from_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_neighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Decompose a nearest neighbors sparse graph into distances and indices.

Parameters
----------
graph : sparse matrix of shape (n_samples, n_samples)
    Neighbors graph as given by `kneighbors_graph` or
    `radius_neighbors_graph`. Matrix should be of format CSR format.

n_neighbors : int
    Number of neighbors required for each sample.

return_distance : bool
    Whether or not to return the distances.

Returns
-------
neigh_dist : ndarray of shape (n_samples, n_neighbors)
    Distances to nearest neighbors. Only present if `return_distance=True`.

neigh_ind : ndarray of shape (n_samples, n_neighbors)
    Indices of nearest neighbors.
</pre> <div class="fragment"><div class="line"><span class="lineno">  277</span><span class="keyword">def </span>_kneighbors_from_graph(graph, n_neighbors, return_distance):</div>
<div class="line"><span class="lineno">  278</span>    <span class="stringliteral">&quot;&quot;&quot;Decompose a nearest neighbors sparse graph into distances and indices.</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    graph : sparse matrix of shape (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">        Neighbors graph as given by `kneighbors_graph` or</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">        `radius_neighbors_graph`. Matrix should be of format CSR format.</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">    n_neighbors : int</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">        Number of neighbors required for each sample.</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">    return_distance : bool</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">        Whether or not to return the distances.</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">    neigh_dist : ndarray of shape (n_samples, n_neighbors)</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">        Distances to nearest neighbors. Only present if `return_distance=True`.</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">    neigh_ind : ndarray of shape (n_samples, n_neighbors)</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">        Indices of nearest neighbors.</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  300</span>    n_samples = graph.shape[0]</div>
<div class="line"><span class="lineno">  301</span>    <span class="keyword">assert</span> graph.format == <span class="stringliteral">&quot;csr&quot;</span></div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    <span class="comment"># number of neighbors by samples</span></div>
<div class="line"><span class="lineno">  304</span>    row_nnz = np.diff(graph.indptr)</div>
<div class="line"><span class="lineno">  305</span>    row_nnz_min = row_nnz.min()</div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">if</span> n_neighbors <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> row_nnz_min &lt; n_neighbors:</div>
<div class="line"><span class="lineno">  307</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  308</span>            <span class="stringliteral">&quot;%d neighbors per samples are required, but some samples have only&quot;</span></div>
<div class="line"><span class="lineno">  309</span>            <span class="stringliteral">&quot; %d neighbors in precomputed graph matrix. Decrease number of &quot;</span></div>
<div class="line"><span class="lineno">  310</span>            <span class="stringliteral">&quot;neighbors used or recompute the graph with more neighbors.&quot;</span></div>
<div class="line"><span class="lineno">  311</span>            % (n_neighbors, row_nnz_min)</div>
<div class="line"><span class="lineno">  312</span>        )</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    <span class="keyword">def </span>extract(a):</div>
<div class="line"><span class="lineno">  315</span>        <span class="comment"># if each sample has the same number of provided neighbors</span></div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordflow">if</span> row_nnz.max() == row_nnz_min:</div>
<div class="line"><span class="lineno">  317</span>            <span class="keywordflow">return</span> a.reshape(n_samples, -1)[:, :n_neighbors]</div>
<div class="line"><span class="lineno">  318</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  319</span>            idx = np.tile(np.arange(n_neighbors), (n_samples, 1))</div>
<div class="line"><span class="lineno">  320</span>            idx += graph.indptr[:-1, <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  321</span>            <span class="keywordflow">return</span> a.take(idx, mode=<span class="stringliteral">&quot;clip&quot;</span>).reshape(n_samples, n_neighbors)</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordflow">if</span> return_distance:</div>
<div class="line"><span class="lineno">  324</span>        <span class="keywordflow">return</span> extract(graph.data), extract(graph.indices)</div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  326</span>        <span class="keywordflow">return</span> extract(graph.indices)</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9348f412b346650dd45044c882e74a0" name="ae9348f412b346650dd45044c882e74a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9348f412b346650dd45044c882e74a0">&#9670;&#160;</a></span>_radius_neighbors_from_graph()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base._radius_neighbors_from_graph </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Decompose a nearest neighbors sparse graph into distances and indices.

Parameters
----------
graph : sparse matrix of shape (n_samples, n_samples)
    Neighbors graph as given by `kneighbors_graph` or
    `radius_neighbors_graph`. Matrix should be of format CSR format.

radius : float
    Radius of neighborhoods which should be strictly positive.

return_distance : bool
    Whether or not to return the distances.

Returns
-------
neigh_dist : ndarray of shape (n_samples,) of arrays
    Distances to nearest neighbors. Only present if `return_distance=True`.

neigh_ind : ndarray of shape (n_samples,) of arrays
    Indices of nearest neighbors.
</pre> <div class="fragment"><div class="line"><span class="lineno">  329</span><span class="keyword">def </span>_radius_neighbors_from_graph(graph, radius, return_distance):</div>
<div class="line"><span class="lineno">  330</span>    <span class="stringliteral">&quot;&quot;&quot;Decompose a nearest neighbors sparse graph into distances and indices.</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    graph : sparse matrix of shape (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">        Neighbors graph as given by `kneighbors_graph` or</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">        `radius_neighbors_graph`. Matrix should be of format CSR format.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    radius : float</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">        Radius of neighborhoods which should be strictly positive.</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    return_distance : bool</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">        Whether or not to return the distances.</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    neigh_dist : ndarray of shape (n_samples,) of arrays</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">        Distances to nearest neighbors. Only present if `return_distance=True`.</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    neigh_ind : ndarray of shape (n_samples,) of arrays</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">        Indices of nearest neighbors.</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="keyword">assert</span> graph.format == <span class="stringliteral">&quot;csr&quot;</span></div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    no_filter_needed = bool(graph.data.max() &lt;= radius)</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">if</span> no_filter_needed:</div>
<div class="line"><span class="lineno">  357</span>        data, indices, indptr = graph.data, graph.indices, graph.indptr</div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  359</span>        mask = graph.data &lt;= radius</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">if</span> return_distance:</div>
<div class="line"><span class="lineno">  361</span>            data = np.compress(mask, graph.data)</div>
<div class="line"><span class="lineno">  362</span>        indices = np.compress(mask, graph.indices)</div>
<div class="line"><span class="lineno">  363</span>        indptr = np.concatenate(([0], np.cumsum(mask)))[graph.indptr]</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    indices = indices.astype(np.intp, copy=no_filter_needed)</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">if</span> return_distance:</div>
<div class="line"><span class="lineno">  368</span>        neigh_dist = _to_object_array(np.split(data, indptr[1:-1]))</div>
<div class="line"><span class="lineno">  369</span>    neigh_ind = _to_object_array(np.split(indices, indptr[1:-1]))</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">if</span> return_distance:</div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">return</span> neigh_dist, neigh_ind</div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  374</span>        <span class="keywordflow">return</span> neigh_ind</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2787f8b1ff5a26f979cbdffbd7afdfae" name="a2787f8b1ff5a26f979cbdffbd7afdfae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2787f8b1ff5a26f979cbdffbd7afdfae">&#9670;&#160;</a></span>_tree_query_parallel_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base._tree_query_parallel_helper </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Helper for the Parallel calls in KNeighborsMixin.kneighbors.

The Cython method tree.query is not directly picklable by cloudpickle
under PyPy.
</pre> <div class="fragment"><div class="line"><span class="lineno">  679</span><span class="keyword">def </span>_tree_query_parallel_helper(tree, *args, **kwargs):</div>
<div class="line"><span class="lineno">  680</span>    <span class="stringliteral">&quot;&quot;&quot;Helper for the Parallel calls in KNeighborsMixin.kneighbors.</span></div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    The Cython method tree.query is not directly picklable by cloudpickle</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">    under PyPy.</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">return</span> tree.query(*args, **kwargs)</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa797f09dd2e21510f47524be5c7ea19c" name="aa797f09dd2e21510f47524be5c7ea19c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa797f09dd2e21510f47524be5c7ea19c">&#9670;&#160;</a></span>_tree_query_radius_parallel_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base._tree_query_radius_parallel_helper </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Helper for the Parallel calls in RadiusNeighborsMixin.radius_neighbors.

The Cython method tree.query_radius is not directly picklable by
cloudpickle under PyPy.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1009</span><span class="keyword">def </span>_tree_query_radius_parallel_helper(tree, *args, **kwargs):</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="stringliteral">&quot;&quot;&quot;Helper for the Parallel calls in RadiusNeighborsMixin.radius_neighbors.</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral">    The Cython method tree.query_radius is not directly picklable by</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral">    cloudpickle under PyPy.</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordflow">return</span> tree.query_radius(*args, **kwargs)</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a63ea0d0f41a218d63305958400cefc46" name="a63ea0d0f41a218d63305958400cefc46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63ea0d0f41a218d63305958400cefc46">&#9670;&#160;</a></span>sort_graph_by_row_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base.sort_graph_by_row_values </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>copy</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>warn_when_not_sorted</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Sort a sparse graph such that each row is stored with increasing values.

.. versionadded:: 1.2

Parameters
----------
graph : sparse matrix of shape (n_samples, n_samples)
    Distance matrix to other samples, where only non-zero elements are
    considered neighbors. Matrix is converted to CSR format if not already.

copy : bool, default=False
    If True, the graph is copied before sorting. If False, the sorting is
    performed inplace. If the graph is not of CSR format, `copy` must be
    True to allow the conversion to CSR format, otherwise an error is
    raised.

warn_when_not_sorted : bool, default=True
    If True, a :class:`~sklearn.exceptions.EfficiencyWarning` is raised
    when the input graph is not sorted by row values.

Returns
-------
graph : sparse matrix of shape (n_samples, n_samples)
    Distance matrix to other samples, where only non-zero elements are
    considered neighbors. Matrix is in CSR format.
</pre> <div class="fragment"><div class="line"><span class="lineno">  200</span><span class="keyword">def </span>sort_graph_by_row_values(graph, copy=False, warn_when_not_sorted=True):</div>
<div class="line"><span class="lineno">  201</span>    <span class="stringliteral">&quot;&quot;&quot;Sort a sparse graph such that each row is stored with increasing values.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">    .. versionadded:: 1.2</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    graph : sparse matrix of shape (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">        Distance matrix to other samples, where only non-zero elements are</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">        considered neighbors. Matrix is converted to CSR format if not already.</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    copy : bool, default=False</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">        If True, the graph is copied before sorting. If False, the sorting is</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">        performed inplace. If the graph is not of CSR format, `copy` must be</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">        True to allow the conversion to CSR format, otherwise an error is</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">        raised.</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">    warn_when_not_sorted : bool, default=True</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">        If True, a :class:`~sklearn.exceptions.EfficiencyWarning` is raised</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">        when the input graph is not sorted by row values.</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">    graph : sparse matrix of shape (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">        Distance matrix to other samples, where only non-zero elements are</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">        considered neighbors. Matrix is in CSR format.</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> issparse(graph):</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">raise</span> TypeError(f<span class="stringliteral">&quot;Input graph must be a sparse matrix, got {graph!r} instead.&quot;</span>)</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">if</span> graph.format == <span class="stringliteral">&quot;csr&quot;</span> <span class="keywordflow">and</span> _is_sorted_by_data(graph):</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">return</span> graph</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">if</span> warn_when_not_sorted:</div>
<div class="line"><span class="lineno">  234</span>        warnings.warn(</div>
<div class="line"><span class="lineno">  235</span>            <span class="stringliteral">&quot;Precomputed sparse input was not sorted by row values. Use the function&quot;</span></div>
<div class="line"><span class="lineno">  236</span>            <span class="stringliteral">&quot; sklearn.neighbors.sort_graph_by_row_values to sort the input by row&quot;</span></div>
<div class="line"><span class="lineno">  237</span>            <span class="stringliteral">&quot; values, with warn_when_not_sorted=False to remove this warning.&quot;</span>,</div>
<div class="line"><span class="lineno">  238</span>            EfficiencyWarning,</div>
<div class="line"><span class="lineno">  239</span>        )</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">if</span> graph.format <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&quot;csr&quot;</span>, <span class="stringliteral">&quot;csc&quot;</span>, <span class="stringliteral">&quot;coo&quot;</span>, <span class="stringliteral">&quot;lil&quot;</span>):</div>
<div class="line"><span class="lineno">  242</span>        <span class="keywordflow">raise</span> TypeError(</div>
<div class="line"><span class="lineno">  243</span>            f<span class="stringliteral">&quot;Sparse matrix in {graph.format!r} format is not supported due to &quot;</span></div>
<div class="line"><span class="lineno">  244</span>            <span class="stringliteral">&quot;its handling of explicit zeros&quot;</span></div>
<div class="line"><span class="lineno">  245</span>        )</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordflow">elif</span> graph.format != <span class="stringliteral">&quot;csr&quot;</span>:</div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> copy:</div>
<div class="line"><span class="lineno">  248</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  249</span>                <span class="stringliteral">&quot;The input graph is not in CSR format. Use copy=True to allow &quot;</span></div>
<div class="line"><span class="lineno">  250</span>                <span class="stringliteral">&quot;the conversion to CSR format.&quot;</span></div>
<div class="line"><span class="lineno">  251</span>            )</div>
<div class="line"><span class="lineno">  252</span>        graph = graph.asformat(<span class="stringliteral">&quot;csr&quot;</span>)</div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">elif</span> copy:  <span class="comment"># csr format with copy=True</span></div>
<div class="line"><span class="lineno">  254</span>        graph = graph.copy()</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    row_nnz = np.diff(graph.indptr)</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">if</span> row_nnz.max() == row_nnz.min():</div>
<div class="line"><span class="lineno">  258</span>        <span class="comment"># if each sample has the same number of provided neighbors</span></div>
<div class="line"><span class="lineno">  259</span>        n_samples = graph.shape[0]</div>
<div class="line"><span class="lineno">  260</span>        distances = graph.data.reshape(n_samples, -1)</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>        order = np.argsort(distances, kind=<span class="stringliteral">&quot;mergesort&quot;</span>)</div>
<div class="line"><span class="lineno">  263</span>        order += np.arange(n_samples)[:, <span class="keywordtype">None</span>] * row_nnz[0]</div>
<div class="line"><span class="lineno">  264</span>        order = order.ravel()</div>
<div class="line"><span class="lineno">  265</span>        graph.data = graph.data[order]</div>
<div class="line"><span class="lineno">  266</span>        graph.indices = graph.indices[order]</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  269</span>        <span class="keywordflow">for</span> start, stop <span class="keywordflow">in</span> zip(graph.indptr, graph.indptr[1:]):</div>
<div class="line"><span class="lineno">  270</span>            order = np.argsort(graph.data[start:stop], kind=<span class="stringliteral">&quot;mergesort&quot;</span>)</div>
<div class="line"><span class="lineno">  271</span>            graph.data[start:stop] = graph.data[start:stop][order]</div>
<div class="line"><span class="lineno">  272</span>            graph.indices[start:stop] = graph.indices[start:stop][order]</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">return</span> graph</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a09008ab392e7e934d40f8b7413da8804" name="a09008ab392e7e934d40f8b7413da8804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09008ab392e7e934d40f8b7413da8804">&#9670;&#160;</a></span>VALID_METRICS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base.VALID_METRICS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a51bc698b7677560d17aa0807ee8c7d43" name="a51bc698b7677560d17aa0807ee8c7d43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51bc698b7677560d17aa0807ee8c7d43">&#9670;&#160;</a></span>VALID_METRICS_SPARSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.neighbors._base.VALID_METRICS_SPARSE</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  dict(</div>
<div class="line"><span class="lineno">    2</span>    ball_tree=[],</div>
<div class="line"><span class="lineno">    3</span>    kd_tree=[],</div>
<div class="line"><span class="lineno">    4</span>    brute=(PAIRWISE_DISTANCE_FUNCTIONS.keys() - {<span class="stringliteral">&quot;haversine&quot;</span>, <span class="stringliteral">&quot;nan_euclidean&quot;</span>}),</div>
<div class="line"><span class="lineno">    5</span>)</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
