<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.tests.arrays.masked.test_arrow_compat Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1arrays.html">arrays</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked.html">masked</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html">test_arrow_compat</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">pandas.tests.arrays.masked.test_arrow_compat Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af674f99ba816712fa345aa6ad126c5ed" id="r_af674f99ba816712fa345aa6ad126c5ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#af674f99ba816712fa345aa6ad126c5ed">data</a> (request)</td></tr>
<tr class="separator:af674f99ba816712fa345aa6ad126c5ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe277c238ef019d3bd8f8a1435364873" id="r_afe277c238ef019d3bd8f8a1435364873"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#afe277c238ef019d3bd8f8a1435364873">test_arrow_array</a> (<a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#af674f99ba816712fa345aa6ad126c5ed">data</a>)</td></tr>
<tr class="separator:afe277c238ef019d3bd8f8a1435364873"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853e88352692a8803bacf4220f62e975" id="r_a853e88352692a8803bacf4220f62e975"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#a853e88352692a8803bacf4220f62e975">test_arrow_roundtrip</a> (<a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#af674f99ba816712fa345aa6ad126c5ed">data</a>)</td></tr>
<tr class="separator:a853e88352692a8803bacf4220f62e975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac236f25d389ca47a4ec48c42665ddb6f" id="r_ac236f25d389ca47a4ec48c42665ddb6f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ac236f25d389ca47a4ec48c42665ddb6f">test_dataframe_from_arrow_types_mapper</a> ()</td></tr>
<tr class="separator:ac236f25d389ca47a4ec48c42665ddb6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a93a27920b7dbcd35ca83481474c00d" id="r_a1a93a27920b7dbcd35ca83481474c00d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#a1a93a27920b7dbcd35ca83481474c00d">test_arrow_load_from_zero_chunks</a> (<a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#af674f99ba816712fa345aa6ad126c5ed">data</a>)</td></tr>
<tr class="separator:a1a93a27920b7dbcd35ca83481474c00d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ce6bc3e923dbe428bbea83eb5a69cfb" id="r_a3ce6bc3e923dbe428bbea83eb5a69cfb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#a3ce6bc3e923dbe428bbea83eb5a69cfb">test_arrow_from_arrow_uint</a> ()</td></tr>
<tr class="separator:a3ce6bc3e923dbe428bbea83eb5a69cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7db321d6c3b1fce60a595517897c6a47" id="r_a7db321d6c3b1fce60a595517897c6a47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#a7db321d6c3b1fce60a595517897c6a47">test_arrow_sliced</a> (<a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#af674f99ba816712fa345aa6ad126c5ed">data</a>)</td></tr>
<tr class="separator:a7db321d6c3b1fce60a595517897c6a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab575b447963626b2380e9f765d18dc19" id="r_ab575b447963626b2380e9f765d18dc19"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ab575b447963626b2380e9f765d18dc19">np_dtype_to_arrays</a> (any_real_numpy_dtype)</td></tr>
<tr class="separator:ab575b447963626b2380e9f765d18dc19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee1ef2e8f09faa64ba27ade942913316" id="r_aee1ef2e8f09faa64ba27ade942913316"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#aee1ef2e8f09faa64ba27ade942913316">test_pyarrow_array_to_numpy_and_mask</a> (<a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ab575b447963626b2380e9f765d18dc19">np_dtype_to_arrays</a>)</td></tr>
<tr class="separator:aee1ef2e8f09faa64ba27ade942913316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdd098b7c951e8ea5e5fad203deab4dc" id="r_abdd098b7c951e8ea5e5fad203deab4dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#abdd098b7c951e8ea5e5fad203deab4dc">test_from_arrow_type_error</a> (<a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#af674f99ba816712fa345aa6ad126c5ed">data</a>)</td></tr>
<tr class="separator:abdd098b7c951e8ea5e5fad203deab4dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afade1ef490d17fa7690ceb912383e476" id="r_afade1ef490d17fa7690ceb912383e476"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#afade1ef490d17fa7690ceb912383e476">pa</a> = pytest.importorskip(&quot;pyarrow&quot;, minversion=&quot;1.0.1&quot;)</td></tr>
<tr class="separator:afade1ef490d17fa7690ceb912383e476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff10927d5716d6fdb40d06e1196ae349" id="r_aff10927d5716d6fdb40d06e1196ae349"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#aff10927d5716d6fdb40d06e1196ae349">arrays</a> = [pd.array([1, 2, 3, None], <a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ac9933becc834cf36846601034ea22fe7">dtype</a>=<a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ac9933becc834cf36846601034ea22fe7">dtype</a>) for <a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ac9933becc834cf36846601034ea22fe7">dtype</a> <a class="el" href="__lapack__subroutines_8h.html#aa83d4778c28341ab79b01b2371f666fe">in</a> tm.ALL_INT_EA_DTYPES]</td></tr>
<tr class="separator:aff10927d5716d6fdb40d06e1196ae349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9933becc834cf36846601034ea22fe7" id="r_ac9933becc834cf36846601034ea22fe7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ac9933becc834cf36846601034ea22fe7">dtype</a></td></tr>
<tr class="separator:ac9933becc834cf36846601034ea22fe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="af674f99ba816712fa345aa6ad126c5ed" name="af674f99ba816712fa345aa6ad126c5ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af674f99ba816712fa345aa6ad126c5ed">&#9670;&#160;</a></span>data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Fixture returning parametrized array from given dtype, including integer,
float and boolean
</pre> <div class="fragment"><div class="line"><span class="lineno">   17</span><span class="keyword">def </span>data(request):</div>
<div class="line"><span class="lineno">   18</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   19</span><span class="stringliteral">    Fixture returning parametrized array from given dtype, including integer,</span></div>
<div class="line"><span class="lineno">   20</span><span class="stringliteral">    float and boolean</span></div>
<div class="line"><span class="lineno">   21</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">return</span> request.param</div>
<div class="line"><span class="lineno">   23</span> </div>
<div class="line"><span class="lineno">   24</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab575b447963626b2380e9f765d18dc19" name="ab575b447963626b2380e9f765d18dc19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab575b447963626b2380e9f765d18dc19">&#9670;&#160;</a></span>np_dtype_to_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.np_dtype_to_arrays </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>any_real_numpy_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Fixture returning actual and expected dtype, pandas and numpy arrays and
mask from a given numpy dtype
</pre> <div class="fragment"><div class="line"><span class="lineno">  107</span><span class="keyword">def </span>np_dtype_to_arrays(any_real_numpy_dtype):</div>
<div class="line"><span class="lineno">  108</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">    Fixture returning actual and expected dtype, pandas and numpy arrays and</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">    mask from a given numpy dtype</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  112</span>    np_dtype = np.dtype(any_real_numpy_dtype)</div>
<div class="line"><span class="lineno">  113</span>    pa_type = pa.from_numpy_dtype(np_dtype)</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <span class="comment"># None ensures the creation of a bitmask buffer.</span></div>
<div class="line"><span class="lineno">  116</span>    pa_array = pa.array([0, 1, 2, <span class="keywordtype">None</span>], type=pa_type)</div>
<div class="line"><span class="lineno">  117</span>    <span class="comment"># Since masked Arrow buffer slots are not required to contain a specific</span></div>
<div class="line"><span class="lineno">  118</span>    <span class="comment"># value, assert only the first three values of the created np.array</span></div>
<div class="line"><span class="lineno">  119</span>    np_expected = np.array([0, 1, 2], dtype=np_dtype)</div>
<div class="line"><span class="lineno">  120</span>    mask_expected = np.array([<span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">False</span>])</div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">return</span> np_dtype, pa_array, np_expected, mask_expected</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afe277c238ef019d3bd8f8a1435364873" name="afe277c238ef019d3bd8f8a1435364873"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe277c238ef019d3bd8f8a1435364873">&#9670;&#160;</a></span>test_arrow_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.test_arrow_array </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   25</span><span class="keyword">def </span>test_arrow_array(data):</div>
<div class="line"><span class="lineno">   26</span>    arr = pa.array(data)</div>
<div class="line"><span class="lineno">   27</span>    expected = pa.array(</div>
<div class="line"><span class="lineno">   28</span>        data.to_numpy(object, na_value=<span class="keywordtype">None</span>),</div>
<div class="line"><span class="lineno">   29</span>        type=pa.from_numpy_dtype(data.dtype.numpy_dtype),</div>
<div class="line"><span class="lineno">   30</span>    )</div>
<div class="line"><span class="lineno">   31</span>    <span class="keyword">assert</span> arr.equals(expected)</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ce6bc3e923dbe428bbea83eb5a69cfb" name="a3ce6bc3e923dbe428bbea83eb5a69cfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ce6bc3e923dbe428bbea83eb5a69cfb">&#9670;&#160;</a></span>test_arrow_from_arrow_uint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.test_arrow_from_arrow_uint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   78</span><span class="keyword">def </span>test_arrow_from_arrow_uint():</div>
<div class="line"><span class="lineno">   79</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/31896</span></div>
<div class="line"><span class="lineno">   80</span>    <span class="comment"># possible mismatch in types</span></div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    dtype = pd.UInt32Dtype()</div>
<div class="line"><span class="lineno">   83</span>    result = dtype.__from_arrow__(pa.array([1, 2, 3, 4, <span class="keywordtype">None</span>], type=<span class="stringliteral">&quot;int64&quot;</span>))</div>
<div class="line"><span class="lineno">   84</span>    expected = pd.array([1, 2, 3, 4, <span class="keywordtype">None</span>], dtype=<span class="stringliteral">&quot;UInt32&quot;</span>)</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>    tm.assert_extension_array_equal(result, expected)</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a93a27920b7dbcd35ca83481474c00d" name="a1a93a27920b7dbcd35ca83481474c00d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a93a27920b7dbcd35ca83481474c00d">&#9670;&#160;</a></span>test_arrow_load_from_zero_chunks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.test_arrow_load_from_zero_chunks </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   64</span><span class="keyword">def </span>test_arrow_load_from_zero_chunks(data):</div>
<div class="line"><span class="lineno">   65</span>    <span class="comment"># GH-41040</span></div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    df = pd.DataFrame({<span class="stringliteral">&quot;a&quot;</span>: data[0:0]})</div>
<div class="line"><span class="lineno">   68</span>    table = pa.table(df)</div>
<div class="line"><span class="lineno">   69</span>    <span class="keyword">assert</span> table.field(<span class="stringliteral">&quot;a&quot;</span>).type == str(data.dtype.numpy_dtype)</div>
<div class="line"><span class="lineno">   70</span>    table = pa.table(</div>
<div class="line"><span class="lineno">   71</span>        [pa.chunked_array([], type=table.field(<span class="stringliteral">&quot;a&quot;</span>).type)], schema=table.schema</div>
<div class="line"><span class="lineno">   72</span>    )</div>
<div class="line"><span class="lineno">   73</span>    result = table.to_pandas()</div>
<div class="line"><span class="lineno">   74</span>    <span class="keyword">assert</span> result[<span class="stringliteral">&quot;a&quot;</span>].dtype == data.dtype</div>
<div class="line"><span class="lineno">   75</span>    tm.assert_frame_equal(result, df)</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a853e88352692a8803bacf4220f62e975" name="a853e88352692a8803bacf4220f62e975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a853e88352692a8803bacf4220f62e975">&#9670;&#160;</a></span>test_arrow_roundtrip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.test_arrow_roundtrip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   34</span><span class="keyword">def </span>test_arrow_roundtrip(data):</div>
<div class="line"><span class="lineno">   35</span>    df = pd.DataFrame({<span class="stringliteral">&quot;a&quot;</span>: data})</div>
<div class="line"><span class="lineno">   36</span>    table = pa.table(df)</div>
<div class="line"><span class="lineno">   37</span>    <span class="keyword">assert</span> table.field(<span class="stringliteral">&quot;a&quot;</span>).type == str(data.dtype.numpy_dtype)</div>
<div class="line"><span class="lineno">   38</span>    result = table.to_pandas()</div>
<div class="line"><span class="lineno">   39</span>    <span class="keyword">assert</span> result[<span class="stringliteral">&quot;a&quot;</span>].dtype == data.dtype</div>
<div class="line"><span class="lineno">   40</span>    tm.assert_frame_equal(result, df)</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7db321d6c3b1fce60a595517897c6a47" name="a7db321d6c3b1fce60a595517897c6a47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7db321d6c3b1fce60a595517897c6a47">&#9670;&#160;</a></span>test_arrow_sliced()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.test_arrow_sliced </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   89</span><span class="keyword">def </span>test_arrow_sliced(data):</div>
<div class="line"><span class="lineno">   90</span>    <span class="comment"># https://github.com/pandas-dev/pandas/issues/38525</span></div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>    df = pd.DataFrame({<span class="stringliteral">&quot;a&quot;</span>: data})</div>
<div class="line"><span class="lineno">   93</span>    table = pa.table(df)</div>
<div class="line"><span class="lineno">   94</span>    result = table.slice(2, <span class="keywordtype">None</span>).to_pandas()</div>
<div class="line"><span class="lineno">   95</span>    expected = df.iloc[2:].reset_index(drop=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   96</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="comment"># no missing values</span></div>
<div class="line"><span class="lineno">   99</span>    df2 = df.fillna(data[0])</div>
<div class="line"><span class="lineno">  100</span>    table = pa.table(df2)</div>
<div class="line"><span class="lineno">  101</span>    result = table.slice(2, <span class="keywordtype">None</span>).to_pandas()</div>
<div class="line"><span class="lineno">  102</span>    expected = df2.iloc[2:].reset_index(drop=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  103</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span><span class="preprocessor">@pytest.fixture</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac236f25d389ca47a4ec48c42665ddb6f" name="ac236f25d389ca47a4ec48c42665ddb6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac236f25d389ca47a4ec48c42665ddb6f">&#9670;&#160;</a></span>test_dataframe_from_arrow_types_mapper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.test_dataframe_from_arrow_types_mapper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   43</span><span class="keyword">def </span>test_dataframe_from_arrow_types_mapper():</div>
<div class="line"><span class="lineno">   44</span>    <span class="keyword">def </span>types_mapper(arrow_type):</div>
<div class="line"><span class="lineno">   45</span>        <span class="keywordflow">if</span> pa.types.is_boolean(arrow_type):</div>
<div class="line"><span class="lineno">   46</span>            <span class="keywordflow">return</span> pd.BooleanDtype()</div>
<div class="line"><span class="lineno">   47</span>        <span class="keywordflow">elif</span> pa.types.is_integer(arrow_type):</div>
<div class="line"><span class="lineno">   48</span>            <span class="keywordflow">return</span> pd.Int64Dtype()</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span>    bools_array = pa.array([<span class="keyword">True</span>, <span class="keywordtype">None</span>, <span class="keyword">False</span>], type=pa.bool_())</div>
<div class="line"><span class="lineno">   51</span>    ints_array = pa.array([1, <span class="keywordtype">None</span>, 2], type=pa.int64())</div>
<div class="line"><span class="lineno">   52</span>    small_ints_array = pa.array([-1, 0, 7], type=pa.int8())</div>
<div class="line"><span class="lineno">   53</span>    record_batch = pa.RecordBatch.from_arrays(</div>
<div class="line"><span class="lineno">   54</span>        [bools_array, ints_array, small_ints_array], [<span class="stringliteral">&quot;bools&quot;</span>, <span class="stringliteral">&quot;ints&quot;</span>, <span class="stringliteral">&quot;small_ints&quot;</span>]</div>
<div class="line"><span class="lineno">   55</span>    )</div>
<div class="line"><span class="lineno">   56</span>    result = record_batch.to_pandas(types_mapper=types_mapper)</div>
<div class="line"><span class="lineno">   57</span>    bools = pd.Series([<span class="keyword">True</span>, <span class="keywordtype">None</span>, <span class="keyword">False</span>], dtype=<span class="stringliteral">&quot;boolean&quot;</span>)</div>
<div class="line"><span class="lineno">   58</span>    ints = pd.Series([1, <span class="keywordtype">None</span>, 2], dtype=<span class="stringliteral">&quot;Int64&quot;</span>)</div>
<div class="line"><span class="lineno">   59</span>    small_ints = pd.Series([-1, 0, 7], dtype=<span class="stringliteral">&quot;Int64&quot;</span>)</div>
<div class="line"><span class="lineno">   60</span>    expected = pd.DataFrame({<span class="stringliteral">&quot;bools&quot;</span>: bools, <span class="stringliteral">&quot;ints&quot;</span>: ints, <span class="stringliteral">&quot;small_ints&quot;</span>: small_ints})</div>
<div class="line"><span class="lineno">   61</span>    tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abdd098b7c951e8ea5e5fad203deab4dc" name="abdd098b7c951e8ea5e5fad203deab4dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdd098b7c951e8ea5e5fad203deab4dc">&#9670;&#160;</a></span>test_from_arrow_type_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.test_from_arrow_type_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  187</span><span class="keyword">def </span>test_from_arrow_type_error(data):</div>
<div class="line"><span class="lineno">  188</span>    <span class="comment"># ensure that __from_arrow__ returns a TypeError when getting a wrong</span></div>
<div class="line"><span class="lineno">  189</span>    <span class="comment"># array type</span></div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    arr = pa.array(data).cast(<span class="stringliteral">&quot;string&quot;</span>)</div>
<div class="line"><span class="lineno">  192</span>    <span class="keyword">with</span> pytest.raises(TypeError, match=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  193</span>        <span class="comment"># we don&#39;t test the exact error message, only the fact that it raises</span></div>
<div class="line"><span class="lineno">  194</span>        <span class="comment"># a TypeError is relevant</span></div>
<div class="line"><span class="lineno">  195</span>        data.dtype.__from_arrow__(arr)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aee1ef2e8f09faa64ba27ade942913316" name="aee1ef2e8f09faa64ba27ade942913316"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee1ef2e8f09faa64ba27ade942913316">&#9670;&#160;</a></span>test_pyarrow_array_to_numpy_and_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.test_pyarrow_array_to_numpy_and_mask </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>np_dtype_to_arrays</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test conversion from pyarrow array to numpy array.

Modifies the pyarrow buffer to contain padding and offset, which are
considered valid buffers by pyarrow.

Also tests empty pyarrow arrays with non empty buffers.
See https://github.com/pandas-dev/pandas/issues/40896
</pre> <div class="fragment"><div class="line"><span class="lineno">  124</span><span class="keyword">def </span>test_pyarrow_array_to_numpy_and_mask(np_dtype_to_arrays):</div>
<div class="line"><span class="lineno">  125</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">    Test conversion from pyarrow array to numpy array.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    Modifies the pyarrow buffer to contain padding and offset, which are</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    considered valid buffers by pyarrow.</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    Also tests empty pyarrow arrays with non empty buffers.</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">    See https://github.com/pandas-dev/pandas/issues/40896</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  134</span>    np_dtype, pa_array, np_expected, mask_expected = np_dtype_to_arrays</div>
<div class="line"><span class="lineno">  135</span>    data, mask = pyarrow_array_to_numpy_and_mask(pa_array, np_dtype)</div>
<div class="line"><span class="lineno">  136</span>    tm.assert_numpy_array_equal(data[:3], np_expected)</div>
<div class="line"><span class="lineno">  137</span>    tm.assert_numpy_array_equal(mask, mask_expected)</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    mask_buffer = pa_array.buffers()[0]</div>
<div class="line"><span class="lineno">  140</span>    data_buffer = pa_array.buffers()[1]</div>
<div class="line"><span class="lineno">  141</span>    data_buffer_bytes = pa_array.buffers()[1].to_pybytes()</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    <span class="comment"># Add trailing padding to the buffer.</span></div>
<div class="line"><span class="lineno">  144</span>    data_buffer_trail = pa.py_buffer(data_buffer_bytes + b<span class="stringliteral">&quot;\x00&quot;</span>)</div>
<div class="line"><span class="lineno">  145</span>    pa_array_trail = pa.Array.from_buffers(</div>
<div class="line"><span class="lineno">  146</span>        type=pa_array.type,</div>
<div class="line"><span class="lineno">  147</span>        length=len(pa_array),</div>
<div class="line"><span class="lineno">  148</span>        buffers=[mask_buffer, data_buffer_trail],</div>
<div class="line"><span class="lineno">  149</span>        offset=pa_array.offset,</div>
<div class="line"><span class="lineno">  150</span>    )</div>
<div class="line"><span class="lineno">  151</span>    pa_array_trail.validate()</div>
<div class="line"><span class="lineno">  152</span>    data, mask = pyarrow_array_to_numpy_and_mask(pa_array_trail, np_dtype)</div>
<div class="line"><span class="lineno">  153</span>    tm.assert_numpy_array_equal(data[:3], np_expected)</div>
<div class="line"><span class="lineno">  154</span>    tm.assert_numpy_array_equal(mask, mask_expected)</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>    <span class="comment"># Add offset to the buffer.</span></div>
<div class="line"><span class="lineno">  157</span>    offset = b<span class="stringliteral">&quot;\x00&quot;</span> * (pa_array.type.bit_width // 8)</div>
<div class="line"><span class="lineno">  158</span>    data_buffer_offset = pa.py_buffer(offset + data_buffer_bytes)</div>
<div class="line"><span class="lineno">  159</span>    mask_buffer_offset = pa.py_buffer(b<span class="stringliteral">&quot;\x0E&quot;</span>)</div>
<div class="line"><span class="lineno">  160</span>    pa_array_offset = pa.Array.from_buffers(</div>
<div class="line"><span class="lineno">  161</span>        type=pa_array.type,</div>
<div class="line"><span class="lineno">  162</span>        length=len(pa_array),</div>
<div class="line"><span class="lineno">  163</span>        buffers=[mask_buffer_offset, data_buffer_offset],</div>
<div class="line"><span class="lineno">  164</span>        offset=pa_array.offset + 1,</div>
<div class="line"><span class="lineno">  165</span>    )</div>
<div class="line"><span class="lineno">  166</span>    pa_array_offset.validate()</div>
<div class="line"><span class="lineno">  167</span>    data, mask = pyarrow_array_to_numpy_and_mask(pa_array_offset, np_dtype)</div>
<div class="line"><span class="lineno">  168</span>    tm.assert_numpy_array_equal(data[:3], np_expected)</div>
<div class="line"><span class="lineno">  169</span>    tm.assert_numpy_array_equal(mask, mask_expected)</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <span class="comment"># Empty array</span></div>
<div class="line"><span class="lineno">  172</span>    np_expected_empty = np.array([], dtype=np_dtype)</div>
<div class="line"><span class="lineno">  173</span>    mask_expected_empty = np.array([], dtype=np.bool_)</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    pa_array_offset = pa.Array.from_buffers(</div>
<div class="line"><span class="lineno">  176</span>        type=pa_array.type,</div>
<div class="line"><span class="lineno">  177</span>        length=0,</div>
<div class="line"><span class="lineno">  178</span>        buffers=[mask_buffer, data_buffer],</div>
<div class="line"><span class="lineno">  179</span>        offset=pa_array.offset,</div>
<div class="line"><span class="lineno">  180</span>    )</div>
<div class="line"><span class="lineno">  181</span>    pa_array_offset.validate()</div>
<div class="line"><span class="lineno">  182</span>    data, mask = pyarrow_array_to_numpy_and_mask(pa_array_offset, np_dtype)</div>
<div class="line"><span class="lineno">  183</span>    tm.assert_numpy_array_equal(data[:3], np_expected_empty)</div>
<div class="line"><span class="lineno">  184</span>    tm.assert_numpy_array_equal(mask, mask_expected_empty)</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aff10927d5716d6fdb40d06e1196ae349" name="aff10927d5716d6fdb40d06e1196ae349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff10927d5716d6fdb40d06e1196ae349">&#9670;&#160;</a></span>arrays</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list pandas.tests.arrays.masked.test_arrow_compat.arrays = [pd.array([1, 2, 3, None], <a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ac9933becc834cf36846601034ea22fe7">dtype</a>=<a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ac9933becc834cf36846601034ea22fe7">dtype</a>) for <a class="el" href="namespacepandas_1_1tests_1_1arrays_1_1masked_1_1test__arrow__compat.html#ac9933becc834cf36846601034ea22fe7">dtype</a> <a class="el" href="__lapack__subroutines_8h.html#aa83d4778c28341ab79b01b2371f666fe">in</a> tm.ALL_INT_EA_DTYPES]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9933becc834cf36846601034ea22fe7" name="ac9933becc834cf36846601034ea22fe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9933becc834cf36846601034ea22fe7">&#9670;&#160;</a></span>dtype</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.dtype</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afade1ef490d17fa7690ceb912383e476" name="afade1ef490d17fa7690ceb912383e476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afade1ef490d17fa7690ceb912383e476">&#9670;&#160;</a></span>pa</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.arrays.masked.test_arrow_compat.pa = pytest.importorskip(&quot;pyarrow&quot;, minversion=&quot;1.0.1&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
