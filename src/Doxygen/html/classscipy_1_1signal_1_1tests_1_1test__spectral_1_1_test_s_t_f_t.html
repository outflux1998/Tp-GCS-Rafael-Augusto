<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.signal.tests.test_spectral.TestSTFT Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1signal.html">signal</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1signal_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1signal_1_1tests_1_1test__spectral.html">test_spectral</a></li><li class="navelem"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html">TestSTFT</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scipy.signal.tests.test_spectral.TestSTFT Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2e206a0f3abe47b906ef6b3e47592df1" id="r_a2e206a0f3abe47b906ef6b3e47592df1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#a2e206a0f3abe47b906ef6b3e47592df1">test_input_validation</a> (self)</td></tr>
<tr class="separator:a2e206a0f3abe47b906ef6b3e47592df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab2ffc1efb4b015f0cabf20ddb065b5" id="r_a2ab2ffc1efb4b015f0cabf20ddb065b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#a2ab2ffc1efb4b015f0cabf20ddb065b5">test_check_COLA</a> (self)</td></tr>
<tr class="separator:a2ab2ffc1efb4b015f0cabf20ddb065b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b52804068f2cd4e0285649e4108a3ef" id="r_a9b52804068f2cd4e0285649e4108a3ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#a9b52804068f2cd4e0285649e4108a3ef">test_check_NOLA</a> (self)</td></tr>
<tr class="separator:a9b52804068f2cd4e0285649e4108a3ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb2ef813007be6c867c9cd30abbf17c1" id="r_aeb2ef813007be6c867c9cd30abbf17c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#aeb2ef813007be6c867c9cd30abbf17c1">test_average_all_segments</a> (self)</td></tr>
<tr class="separator:aeb2ef813007be6c867c9cd30abbf17c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af520e0e4352d4cf60466ebc412b7b6f3" id="r_af520e0e4352d4cf60466ebc412b7b6f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#af520e0e4352d4cf60466ebc412b7b6f3">test_permute_axes</a> (self)</td></tr>
<tr class="separator:af520e0e4352d4cf60466ebc412b7b6f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b227823f9e301963bfa91c218084e7d" id="r_a5b227823f9e301963bfa91c218084e7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#a5b227823f9e301963bfa91c218084e7d">test_roundtrip_real</a> (self, scaling)</td></tr>
<tr class="separator:a5b227823f9e301963bfa91c218084e7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb3f02b7e2d4ff1eb9fbaab3e96e8f0c" id="r_acb3f02b7e2d4ff1eb9fbaab3e96e8f0c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#acb3f02b7e2d4ff1eb9fbaab3e96e8f0c">test_roundtrip_not_nola</a> (self)</td></tr>
<tr class="separator:acb3f02b7e2d4ff1eb9fbaab3e96e8f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a625b4db4ae21b14ac9629ffdd32122e7" id="r_a625b4db4ae21b14ac9629ffdd32122e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#a625b4db4ae21b14ac9629ffdd32122e7">test_roundtrip_nola_not_cola</a> (self)</td></tr>
<tr class="separator:a625b4db4ae21b14ac9629ffdd32122e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7a8f6e26ec66f8a0e8df709ddc0c936" id="r_ab7a8f6e26ec66f8a0e8df709ddc0c936"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#ab7a8f6e26ec66f8a0e8df709ddc0c936">test_roundtrip_float32</a> (self)</td></tr>
<tr class="separator:ab7a8f6e26ec66f8a0e8df709ddc0c936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ef30f5cb8ae3e0605ac24ee7c956a4c" id="r_a5ef30f5cb8ae3e0605ac24ee7c956a4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#a5ef30f5cb8ae3e0605ac24ee7c956a4c">test_roundtrip_complex</a> (self, scaling)</td></tr>
<tr class="separator:a5ef30f5cb8ae3e0605ac24ee7c956a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1492229b00efd49b015c7cc8a0649db2" id="r_a1492229b00efd49b015c7cc8a0649db2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#a1492229b00efd49b015c7cc8a0649db2">test_roundtrip_boundary_extension</a> (self)</td></tr>
<tr class="separator:a1492229b00efd49b015c7cc8a0649db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8bf987c8aa09645d958e46b574062d3" id="r_ab8bf987c8aa09645d958e46b574062d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#ab8bf987c8aa09645d958e46b574062d3">test_roundtrip_padded_signal</a> (self)</td></tr>
<tr class="separator:ab8bf987c8aa09645d958e46b574062d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abacc230cfb23efc08d0afeff9ad97c46" id="r_abacc230cfb23efc08d0afeff9ad97c46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#abacc230cfb23efc08d0afeff9ad97c46">test_roundtrip_padded_FFT</a> (self)</td></tr>
<tr class="separator:abacc230cfb23efc08d0afeff9ad97c46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a620e751d82e53c8643cc78bfad7f687c" id="r_a620e751d82e53c8643cc78bfad7f687c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#a620e751d82e53c8643cc78bfad7f687c">test_axis_rolling</a> (self)</td></tr>
<tr class="separator:a620e751d82e53c8643cc78bfad7f687c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5fea82f204bc5847c32251676609eef" id="r_ae5fea82f204bc5847c32251676609eef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__spectral_1_1_test_s_t_f_t.html#ae5fea82f204bc5847c32251676609eef">test_roundtrip_scaling</a> (self)</td></tr>
<tr class="separator:ae5fea82f204bc5847c32251676609eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aeb2ef813007be6c867c9cd30abbf17c1" name="aeb2ef813007be6c867c9cd30abbf17c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb2ef813007be6c867c9cd30abbf17c1">&#9670;&#160;</a></span>test_average_all_segments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_average_all_segments </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1221</span>    <span class="keyword">def </span>test_average_all_segments(self):</div>
<div class="line"><span class="lineno"> 1222</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1223</span>        x = np.random.randn(1024)</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span>        fs = 1.0</div>
<div class="line"><span class="lineno"> 1226</span>        window = <span class="stringliteral">&#39;hann&#39;</span></div>
<div class="line"><span class="lineno"> 1227</span>        nperseg = 16</div>
<div class="line"><span class="lineno"> 1228</span>        noverlap = 8</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>        <span class="comment"># Compare twosided, because onesided welch doubles non-DC terms to</span></div>
<div class="line"><span class="lineno"> 1231</span>        <span class="comment"># account for power at negative frequencies. stft doesn&#39;t do this,</span></div>
<div class="line"><span class="lineno"> 1232</span>        <span class="comment"># because it breaks invertibility.</span></div>
<div class="line"><span class="lineno"> 1233</span>        f, _, Z = stft(x, fs, window, nperseg, noverlap, padded=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1234</span>                       return_onesided=<span class="keyword">False</span>, boundary=<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1235</span>        fw, Pw = welch(x, fs, window, nperseg, noverlap, return_onesided=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1236</span>                       scaling=<span class="stringliteral">&#39;spectrum&#39;</span>, detrend=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1237</span> </div>
<div class="line"><span class="lineno"> 1238</span>        assert_allclose(f, fw)</div>
<div class="line"><span class="lineno"> 1239</span>        assert_allclose(np.mean(np.abs(Z)**2, axis=-1), Pw)</div>
<div class="line"><span class="lineno"> 1240</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a620e751d82e53c8643cc78bfad7f687c" name="a620e751d82e53c8643cc78bfad7f687c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a620e751d82e53c8643cc78bfad7f687c">&#9670;&#160;</a></span>test_axis_rolling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_axis_rolling </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1504</span>    <span class="keyword">def </span>test_axis_rolling(self):</div>
<div class="line"><span class="lineno"> 1505</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1506</span> </div>
<div class="line"><span class="lineno"> 1507</span>        x_flat = np.random.randn(1024)</div>
<div class="line"><span class="lineno"> 1508</span>        _, _, z_flat = stft(x_flat)</div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span>        <span class="keywordflow">for</span> a <span class="keywordflow">in</span> range(3):</div>
<div class="line"><span class="lineno"> 1511</span>            newshape = [1,]*3</div>
<div class="line"><span class="lineno"> 1512</span>            newshape[a] = -1</div>
<div class="line"><span class="lineno"> 1513</span>            x = x_flat.reshape(newshape)</div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>            _, _, z_plus = stft(x, axis=a)  <span class="comment"># Positive axis index</span></div>
<div class="line"><span class="lineno"> 1516</span>            _, _, z_minus = stft(x, axis=a-x.ndim)  <span class="comment"># Negative axis index</span></div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>            assert_equal(z_flat, z_plus.squeeze(), err_msg=a)</div>
<div class="line"><span class="lineno"> 1519</span>            assert_equal(z_flat, z_minus.squeeze(), err_msg=a-x.ndim)</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span>        <span class="comment"># z_flat has shape [n_freq, n_time]</span></div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>        <span class="comment"># Test vs. transpose</span></div>
<div class="line"><span class="lineno"> 1524</span>        _, x_transpose_m = istft(z_flat.T, time_axis=-2, freq_axis=-1)</div>
<div class="line"><span class="lineno"> 1525</span>        _, x_transpose_p = istft(z_flat.T, time_axis=0, freq_axis=1)</div>
<div class="line"><span class="lineno"> 1526</span> </div>
<div class="line"><span class="lineno"> 1527</span>        assert_allclose(x_flat, x_transpose_m, err_msg=<span class="stringliteral">&#39;istft transpose minus&#39;</span>)</div>
<div class="line"><span class="lineno"> 1528</span>        assert_allclose(x_flat, x_transpose_p, err_msg=<span class="stringliteral">&#39;istft transpose plus&#39;</span>)</div>
<div class="line"><span class="lineno"> 1529</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ab2ffc1efb4b015f0cabf20ddb065b5" name="a2ab2ffc1efb4b015f0cabf20ddb065b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab2ffc1efb4b015f0cabf20ddb065b5">&#9670;&#160;</a></span>test_check_COLA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_check_COLA </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1174</span>    <span class="keyword">def </span>test_check_COLA(self):</div>
<div class="line"><span class="lineno"> 1175</span>        settings = [</div>
<div class="line"><span class="lineno"> 1176</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 10, 0),</div>
<div class="line"><span class="lineno"> 1177</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 10, 9),</div>
<div class="line"><span class="lineno"> 1178</span>                    (<span class="stringliteral">&#39;bartlett&#39;</span>, 51, 26),</div>
<div class="line"><span class="lineno"> 1179</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 128),</div>
<div class="line"><span class="lineno"> 1180</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 192),</div>
<div class="line"><span class="lineno"> 1181</span>                    (<span class="stringliteral">&#39;blackman&#39;</span>, 300, 200),</div>
<div class="line"><span class="lineno"> 1182</span>                    ((<span class="stringliteral">&#39;tukey&#39;</span>, 0.5), 256, 64),</div>
<div class="line"><span class="lineno"> 1183</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 255),</div>
<div class="line"><span class="lineno"> 1184</span>                    ]</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>        <span class="keywordflow">for</span> setting <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1187</span>            msg = <span class="stringliteral">&#39;{0}, {1}, {2}&#39;</span>.format(*setting)</div>
<div class="line"><span class="lineno"> 1188</span>            assert_equal(<span class="keyword">True</span>, check_COLA(*setting), err_msg=msg)</div>
<div class="line"><span class="lineno"> 1189</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b52804068f2cd4e0285649e4108a3ef" name="a9b52804068f2cd4e0285649e4108a3ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b52804068f2cd4e0285649e4108a3ef">&#9670;&#160;</a></span>test_check_NOLA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_check_NOLA </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1190</span>    <span class="keyword">def </span>test_check_NOLA(self):</div>
<div class="line"><span class="lineno"> 1191</span>        settings_pass = [</div>
<div class="line"><span class="lineno"> 1192</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 10, 0),</div>
<div class="line"><span class="lineno"> 1193</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 10, 9),</div>
<div class="line"><span class="lineno"> 1194</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 10, 7),</div>
<div class="line"><span class="lineno"> 1195</span>                    (<span class="stringliteral">&#39;bartlett&#39;</span>, 51, 26),</div>
<div class="line"><span class="lineno"> 1196</span>                    (<span class="stringliteral">&#39;bartlett&#39;</span>, 51, 10),</div>
<div class="line"><span class="lineno"> 1197</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 128),</div>
<div class="line"><span class="lineno"> 1198</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 192),</div>
<div class="line"><span class="lineno"> 1199</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 37),</div>
<div class="line"><span class="lineno"> 1200</span>                    (<span class="stringliteral">&#39;blackman&#39;</span>, 300, 200),</div>
<div class="line"><span class="lineno"> 1201</span>                    (<span class="stringliteral">&#39;blackman&#39;</span>, 300, 123),</div>
<div class="line"><span class="lineno"> 1202</span>                    ((<span class="stringliteral">&#39;tukey&#39;</span>, 0.5), 256, 64),</div>
<div class="line"><span class="lineno"> 1203</span>                    ((<span class="stringliteral">&#39;tukey&#39;</span>, 0.5), 256, 38),</div>
<div class="line"><span class="lineno"> 1204</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 255),</div>
<div class="line"><span class="lineno"> 1205</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 39),</div>
<div class="line"><span class="lineno"> 1206</span>                    ]</div>
<div class="line"><span class="lineno"> 1207</span>        <span class="keywordflow">for</span> setting <span class="keywordflow">in</span> settings_pass:</div>
<div class="line"><span class="lineno"> 1208</span>            msg = <span class="stringliteral">&#39;{0}, {1}, {2}&#39;</span>.format(*setting)</div>
<div class="line"><span class="lineno"> 1209</span>            assert_equal(<span class="keyword">True</span>, check_NOLA(*setting), err_msg=msg)</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>        w_fail = np.ones(16)</div>
<div class="line"><span class="lineno"> 1212</span>        w_fail[::2] = 0</div>
<div class="line"><span class="lineno"> 1213</span>        settings_fail = [</div>
<div class="line"><span class="lineno"> 1214</span>                    (w_fail, len(w_fail), len(w_fail) // 2),</div>
<div class="line"><span class="lineno"> 1215</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 64, 0),</div>
<div class="line"><span class="lineno"> 1216</span>        ]</div>
<div class="line"><span class="lineno"> 1217</span>        <span class="keywordflow">for</span> setting <span class="keywordflow">in</span> settings_fail:</div>
<div class="line"><span class="lineno"> 1218</span>            msg = <span class="stringliteral">&#39;{0}, {1}, {2}&#39;</span>.format(*setting)</div>
<div class="line"><span class="lineno"> 1219</span>            assert_equal(<span class="keyword">False</span>, check_NOLA(*setting), err_msg=msg)</div>
<div class="line"><span class="lineno"> 1220</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e206a0f3abe47b906ef6b3e47592df1" name="a2e206a0f3abe47b906ef6b3e47592df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e206a0f3abe47b906ef6b3e47592df1">&#9670;&#160;</a></span>test_input_validation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_input_validation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1092</span>    <span class="keyword">def </span>test_input_validation(self):</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>        <span class="keyword">def </span>chk_VE(match):</div>
<div class="line"><span class="lineno"> 1095</span>            <span class="stringliteral">&quot;&quot;&quot;Assert for a ValueError matching regexp `match`.</span></div>
<div class="line"><span class="lineno"> 1096</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1097</span><span class="stringliteral">            This little wrapper allows a more concise code layout.</span></div>
<div class="line"><span class="lineno"> 1098</span><span class="stringliteral">            &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1099</span>            <span class="keywordflow">return</span> pytest.raises(ValueError, match=match)</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>        <span class="comment"># Checks for check_COLA():</span></div>
<div class="line"><span class="lineno"> 1102</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;nperseg must be a positive integer&#39;</span>):</div>
<div class="line"><span class="lineno"> 1103</span>            check_COLA(<span class="stringliteral">&#39;hann&#39;</span>, -10, 0)</div>
<div class="line"><span class="lineno"> 1104</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;noverlap must be less than nperseg.&#39;</span>):</div>
<div class="line"><span class="lineno"> 1105</span>            check_COLA(<span class="stringliteral">&#39;hann&#39;</span>, 10, 20)</div>
<div class="line"><span class="lineno"> 1106</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;window must be 1-D&#39;</span>):</div>
<div class="line"><span class="lineno"> 1107</span>            check_COLA(np.ones((2, 2)), 10, 0)</div>
<div class="line"><span class="lineno"> 1108</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;window must have length of nperseg&#39;</span>):</div>
<div class="line"><span class="lineno"> 1109</span>            check_COLA(np.ones(20), 10, 0)</div>
<div class="line"><span class="lineno"> 1110</span> </div>
<div class="line"><span class="lineno"> 1111</span>        <span class="comment"># Checks for check_NOLA():</span></div>
<div class="line"><span class="lineno"> 1112</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;nperseg must be a positive integer&#39;</span>):</div>
<div class="line"><span class="lineno"> 1113</span>            check_NOLA(<span class="stringliteral">&#39;hann&#39;</span>, -10, 0)</div>
<div class="line"><span class="lineno"> 1114</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;noverlap must be less than nperseg&#39;</span>):</div>
<div class="line"><span class="lineno"> 1115</span>            check_NOLA(<span class="stringliteral">&#39;hann&#39;</span>, 10, 20)</div>
<div class="line"><span class="lineno"> 1116</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;window must be 1-D&#39;</span>):</div>
<div class="line"><span class="lineno"> 1117</span>            check_NOLA(np.ones((2, 2)), 10, 0)</div>
<div class="line"><span class="lineno"> 1118</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;window must have length of nperseg&#39;</span>):</div>
<div class="line"><span class="lineno"> 1119</span>            check_NOLA(np.ones(20), 10, 0)</div>
<div class="line"><span class="lineno"> 1120</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;noverlap must be a nonnegative integer&#39;</span>):</div>
<div class="line"><span class="lineno"> 1121</span>            check_NOLA(<span class="stringliteral">&#39;hann&#39;</span>, 64, -32)</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>        x = np.zeros(1024)</div>
<div class="line"><span class="lineno"> 1124</span>        z = stft(x)[2]</div>
<div class="line"><span class="lineno"> 1125</span> </div>
<div class="line"><span class="lineno"> 1126</span>        <span class="comment"># Checks for stft():</span></div>
<div class="line"><span class="lineno"> 1127</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;window must be 1-D&#39;</span>):</div>
<div class="line"><span class="lineno"> 1128</span>            stft(x, window=np.ones((2, 2)))</div>
<div class="line"><span class="lineno"> 1129</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;value specified for nperseg is different &#39;</span> +</div>
<div class="line"><span class="lineno"> 1130</span>                    <span class="stringliteral">&#39;from length of window&#39;</span>):</div>
<div class="line"><span class="lineno"> 1131</span>            stft(x, window=np.ones(10), nperseg=256)</div>
<div class="line"><span class="lineno"> 1132</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;nperseg must be a positive integer&#39;</span>):</div>
<div class="line"><span class="lineno"> 1133</span>            stft(x, nperseg=-256)</div>
<div class="line"><span class="lineno"> 1134</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;noverlap must be less than nperseg.&#39;</span>):</div>
<div class="line"><span class="lineno"> 1135</span>            stft(x, nperseg=256, noverlap=1024)</div>
<div class="line"><span class="lineno"> 1136</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;nfft must be greater than or equal to nperseg.&#39;</span>):</div>
<div class="line"><span class="lineno"> 1137</span>            stft(x, nperseg=256, nfft=8)</div>
<div class="line"><span class="lineno"> 1138</span> </div>
<div class="line"><span class="lineno"> 1139</span>        <span class="comment"># Checks for istft():</span></div>
<div class="line"><span class="lineno"> 1140</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;Input stft must be at least 2d!&#39;</span>):</div>
<div class="line"><span class="lineno"> 1141</span>            istft(x)</div>
<div class="line"><span class="lineno"> 1142</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;window must be 1-D&#39;</span>):</div>
<div class="line"><span class="lineno"> 1143</span>            istft(z, window=np.ones((2, 2)))</div>
<div class="line"><span class="lineno"> 1144</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;window must have length of 256&#39;</span>):</div>
<div class="line"><span class="lineno"> 1145</span>            istft(z, window=np.ones(10), nperseg=256)</div>
<div class="line"><span class="lineno"> 1146</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;nperseg must be a positive integer&#39;</span>):</div>
<div class="line"><span class="lineno"> 1147</span>            istft(z, nperseg=-256)</div>
<div class="line"><span class="lineno"> 1148</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;noverlap must be less than nperseg.&#39;</span>):</div>
<div class="line"><span class="lineno"> 1149</span>            istft(z, nperseg=256, noverlap=1024)</div>
<div class="line"><span class="lineno"> 1150</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;nfft must be greater than or equal to nperseg.&#39;</span>):</div>
<div class="line"><span class="lineno"> 1151</span>            istft(z, nperseg=256, nfft=8)</div>
<div class="line"><span class="lineno"> 1152</span>        <span class="keyword">with</span> pytest.warns(UserWarning, match=<span class="stringliteral">&quot;NOLA condition failed, &quot;</span> +</div>
<div class="line"><span class="lineno"> 1153</span>                          <span class="stringliteral">&quot;STFT may not be invertible&quot;</span>):</div>
<div class="line"><span class="lineno"> 1154</span>            istft(z, nperseg=256, noverlap=0, window=<span class="stringliteral">&#39;hann&#39;</span>)</div>
<div class="line"><span class="lineno"> 1155</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&#39;Must specify differing time and frequency axes!&#39;</span>):</div>
<div class="line"><span class="lineno"> 1156</span>            istft(z, time_axis=0, freq_axis=0)</div>
<div class="line"><span class="lineno"> 1157</span> </div>
<div class="line"><span class="lineno"> 1158</span>        <span class="comment"># Checks for _spectral_helper():</span></div>
<div class="line"><span class="lineno"> 1159</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&quot;Unknown value for mode foo, must be one of: &quot;</span> +</div>
<div class="line"><span class="lineno"> 1160</span>                    <span class="stringliteral">r&quot;\{&#39;psd&#39;, &#39;stft&#39;\}&quot;</span>):</div>
<div class="line"><span class="lineno"> 1161</span>            _spectral_helper(x, x, mode=<span class="stringliteral">&#39;foo&#39;</span>)</div>
<div class="line"><span class="lineno"> 1162</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&quot;x and y must be equal if mode is &#39;stft&#39;&quot;</span>):</div>
<div class="line"><span class="lineno"> 1163</span>            _spectral_helper(x[:512], x[512:], mode=<span class="stringliteral">&#39;stft&#39;</span>)</div>
<div class="line"><span class="lineno"> 1164</span>        <span class="keyword">with</span> chk_VE(<span class="stringliteral">&quot;Unknown boundary option &#39;foo&#39;, must be one of: &quot;</span> +</div>
<div class="line"><span class="lineno"> 1165</span>                    <span class="stringliteral">r&quot;\[&#39;even&#39;, &#39;odd&#39;, &#39;constant&#39;, &#39;zeros&#39;, None\]&quot;</span>):</div>
<div class="line"><span class="lineno"> 1166</span>            _spectral_helper(x, x, boundary=<span class="stringliteral">&#39;foo&#39;</span>)</div>
<div class="line"><span class="lineno"> 1167</span> </div>
<div class="line"><span class="lineno"> 1168</span>        scaling = <span class="stringliteral">&quot;not_valid&quot;</span></div>
<div class="line"><span class="lineno"> 1169</span>        <span class="keyword">with</span> chk_VE(fr<span class="stringliteral">&quot;Parameter {scaling=} not in \[&#39;spectrum&#39;, &#39;psd&#39;\]!&quot;</span>):</div>
<div class="line"><span class="lineno"> 1170</span>            stft(x, scaling=scaling)</div>
<div class="line"><span class="lineno"> 1171</span>        <span class="keyword">with</span> chk_VE(fr<span class="stringliteral">&quot;Parameter {scaling=} not in \[&#39;spectrum&#39;, &#39;psd&#39;\]!&quot;</span>):</div>
<div class="line"><span class="lineno"> 1172</span>            istft(z, scaling=scaling)</div>
<div class="line"><span class="lineno"> 1173</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af520e0e4352d4cf60466ebc412b7b6f3" name="af520e0e4352d4cf60466ebc412b7b6f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af520e0e4352d4cf60466ebc412b7b6f3">&#9670;&#160;</a></span>test_permute_axes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_permute_axes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1241</span>    <span class="keyword">def </span>test_permute_axes(self):</div>
<div class="line"><span class="lineno"> 1242</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1243</span>        x = np.random.randn(1024)</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>        fs = 1.0</div>
<div class="line"><span class="lineno"> 1246</span>        window = <span class="stringliteral">&#39;hann&#39;</span></div>
<div class="line"><span class="lineno"> 1247</span>        nperseg = 16</div>
<div class="line"><span class="lineno"> 1248</span>        noverlap = 8</div>
<div class="line"><span class="lineno"> 1249</span> </div>
<div class="line"><span class="lineno"> 1250</span>        f1, t1, Z1 = stft(x, fs, window, nperseg, noverlap)</div>
<div class="line"><span class="lineno"> 1251</span>        f2, t2, Z2 = stft(x.reshape((-1, 1, 1)), fs, window, nperseg, noverlap,</div>
<div class="line"><span class="lineno"> 1252</span>                          axis=0)</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>        t3, x1 = istft(Z1, fs, window, nperseg, noverlap)</div>
<div class="line"><span class="lineno"> 1255</span>        t4, x2 = istft(Z2.T, fs, window, nperseg, noverlap, time_axis=0,</div>
<div class="line"><span class="lineno"> 1256</span>                       freq_axis=-1)</div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span>        assert_allclose(f1, f2)</div>
<div class="line"><span class="lineno"> 1259</span>        assert_allclose(t1, t2)</div>
<div class="line"><span class="lineno"> 1260</span>        assert_allclose(t3, t4)</div>
<div class="line"><span class="lineno"> 1261</span>        assert_allclose(Z1, Z2[:, 0, 0, :])</div>
<div class="line"><span class="lineno"> 1262</span>        assert_allclose(x1, x2[:, 0, 0])</div>
<div class="line"><span class="lineno"> 1263</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1492229b00efd49b015c7cc8a0649db2" name="a1492229b00efd49b015c7cc8a0649db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1492229b00efd49b015c7cc8a0649db2">&#9670;&#160;</a></span>test_roundtrip_boundary_extension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_boundary_extension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1414</span>    <span class="keyword">def </span>test_roundtrip_boundary_extension(self):</div>
<div class="line"><span class="lineno"> 1415</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>        <span class="comment"># Test against boxcar, since window is all ones, and thus can be fully</span></div>
<div class="line"><span class="lineno"> 1418</span>        <span class="comment"># recovered with no boundary extension</span></div>
<div class="line"><span class="lineno"> 1419</span> </div>
<div class="line"><span class="lineno"> 1420</span>        settings = [</div>
<div class="line"><span class="lineno"> 1421</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 100, 10, 0),           <span class="comment"># Test no overlap</span></div>
<div class="line"><span class="lineno"> 1422</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 100, 10, 9),           <span class="comment"># Test high overlap</span></div>
<div class="line"><span class="lineno"> 1423</span>                    ]</div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>        <span class="keywordflow">for</span> window, N, nperseg, noverlap <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1426</span>            t = np.arange(N)</div>
<div class="line"><span class="lineno"> 1427</span>            x = 10*np.random.randn(t.size)</div>
<div class="line"><span class="lineno"> 1428</span> </div>
<div class="line"><span class="lineno"> 1429</span>            _, _, zz = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1430</span>                           window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1431</span>                           boundary=<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>            _, xr = istft(zz, noverlap=noverlap, window=window, boundary=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1434</span> </div>
<div class="line"><span class="lineno"> 1435</span>            <span class="keywordflow">for</span> boundary <span class="keywordflow">in</span> [<span class="stringliteral">&#39;even&#39;</span>, <span class="stringliteral">&#39;odd&#39;</span>, <span class="stringliteral">&#39;constant&#39;</span>, <span class="stringliteral">&#39;zeros&#39;</span>]:</div>
<div class="line"><span class="lineno"> 1436</span>                _, _, zz_ext = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1437</span>                                window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1438</span>                                boundary=boundary)</div>
<div class="line"><span class="lineno"> 1439</span> </div>
<div class="line"><span class="lineno"> 1440</span>                _, xr_ext = istft(zz_ext, noverlap=noverlap, window=window,</div>
<div class="line"><span class="lineno"> 1441</span>                                boundary=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1442</span> </div>
<div class="line"><span class="lineno"> 1443</span>                msg = <span class="stringliteral">&#39;{0}, {1}, {2}&#39;</span>.format(window, noverlap, boundary)</div>
<div class="line"><span class="lineno"> 1444</span>                assert_allclose(x, xr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1445</span>                assert_allclose(x, xr_ext, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1446</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ef30f5cb8ae3e0605ac24ee7c956a4c" name="a5ef30f5cb8ae3e0605ac24ee7c956a4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ef30f5cb8ae3e0605ac24ee7c956a4c">&#9670;&#160;</a></span>test_roundtrip_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_complex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scaling</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1371</span>    <span class="keyword">def </span>test_roundtrip_complex(self, scaling):</div>
<div class="line"><span class="lineno"> 1372</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>        settings = [</div>
<div class="line"><span class="lineno"> 1375</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 100, 10, 0),           <span class="comment"># Test no overlap</span></div>
<div class="line"><span class="lineno"> 1376</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 100, 10, 9),           <span class="comment"># Test high overlap</span></div>
<div class="line"><span class="lineno"> 1377</span>                    (<span class="stringliteral">&#39;bartlett&#39;</span>, 101, 51, 26),        <span class="comment"># Test odd nperseg</span></div>
<div class="line"><span class="lineno"> 1378</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 128),         <span class="comment"># Test defaults</span></div>
<div class="line"><span class="lineno"> 1379</span>                    ((<span class="stringliteral">&#39;tukey&#39;</span>, 0.5), 1152, 256, 64),  <span class="comment"># Test Tukey</span></div>
<div class="line"><span class="lineno"> 1380</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 255),         <span class="comment"># Test overlapped hann</span></div>
<div class="line"><span class="lineno"> 1381</span>                    ]</div>
<div class="line"><span class="lineno"> 1382</span> </div>
<div class="line"><span class="lineno"> 1383</span>        <span class="keywordflow">for</span> window, N, nperseg, noverlap <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1384</span>            t = np.arange(N)</div>
<div class="line"><span class="lineno"> 1385</span>            x = 10*np.random.randn(t.size) + 10j*np.random.randn(t.size)</div>
<div class="line"><span class="lineno"> 1386</span> </div>
<div class="line"><span class="lineno"> 1387</span>            _, _, zz = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1388</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1389</span>                            return_onesided=<span class="keyword">False</span>, scaling=scaling)</div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span>            tr, xr = istft(zz, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1392</span>                           window=window, input_onesided=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1393</span>                           scaling=scaling)</div>
<div class="line"><span class="lineno"> 1394</span> </div>
<div class="line"><span class="lineno"> 1395</span>            msg = <span class="stringliteral">&#39;{0}, {1}, {2}&#39;</span>.format(window, nperseg, noverlap)</div>
<div class="line"><span class="lineno"> 1396</span>            assert_allclose(t, tr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1397</span>            assert_allclose(x, xr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span>        <span class="comment"># Check that asking for onesided switches to twosided</span></div>
<div class="line"><span class="lineno"> 1400</span>        <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno"> 1401</span>            sup.filter(UserWarning,</div>
<div class="line"><span class="lineno"> 1402</span>                       <span class="stringliteral">&quot;Input data is complex, switching to return_onesided=False&quot;</span>)</div>
<div class="line"><span class="lineno"> 1403</span>            _, _, zz = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1404</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1405</span>                            return_onesided=<span class="keyword">True</span>, scaling=scaling)</div>
<div class="line"><span class="lineno"> 1406</span> </div>
<div class="line"><span class="lineno"> 1407</span>        tr, xr = istft(zz, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1408</span>                       window=window, input_onesided=<span class="keyword">False</span>, scaling=scaling)</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>        msg = <span class="stringliteral">&#39;{0}, {1}, {2}&#39;</span>.format(window, nperseg, noverlap)</div>
<div class="line"><span class="lineno"> 1411</span>        assert_allclose(t, tr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1412</span>        assert_allclose(x, xr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1413</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7a8f6e26ec66f8a0e8df709ddc0c936" name="ab7a8f6e26ec66f8a0e8df709ddc0c936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7a8f6e26ec66f8a0e8df709ddc0c936">&#9670;&#160;</a></span>test_roundtrip_float32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_float32 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1349</span>    <span class="keyword">def </span>test_roundtrip_float32(self):</div>
<div class="line"><span class="lineno"> 1350</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>        settings = [(<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 128)]</div>
<div class="line"><span class="lineno"> 1353</span> </div>
<div class="line"><span class="lineno"> 1354</span>        <span class="keywordflow">for</span> window, N, nperseg, noverlap <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1355</span>            t = np.arange(N)</div>
<div class="line"><span class="lineno"> 1356</span>            x = 10*np.random.randn(t.size)</div>
<div class="line"><span class="lineno"> 1357</span>            x = x.astype(np.float32)</div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span>            _, _, zz = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1360</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>            tr, xr = istft(zz, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1363</span>                           window=window)</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>            msg = <span class="stringliteral">&#39;{0}, {1}&#39;</span>.format(window, noverlap)</div>
<div class="line"><span class="lineno"> 1366</span>            assert_allclose(t, t, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1367</span>            assert_allclose(x, xr, err_msg=msg, rtol=1e-4, atol=1e-5)</div>
<div class="line"><span class="lineno"> 1368</span>            assert_(x.dtype == xr.dtype)</div>
<div class="line"><span class="lineno"> 1369</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a625b4db4ae21b14ac9629ffdd32122e7" name="a625b4db4ae21b14ac9629ffdd32122e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a625b4db4ae21b14ac9629ffdd32122e7">&#9670;&#160;</a></span>test_roundtrip_nola_not_cola()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_nola_not_cola </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1319</span>    <span class="keyword">def </span>test_roundtrip_nola_not_cola(self):</div>
<div class="line"><span class="lineno"> 1320</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>        settings = [</div>
<div class="line"><span class="lineno"> 1323</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 100, 10, 3),           <span class="comment"># NOLA True, COLA False</span></div>
<div class="line"><span class="lineno"> 1324</span>                    (<span class="stringliteral">&#39;bartlett&#39;</span>, 101, 51, 37),        <span class="comment"># NOLA True, COLA False</span></div>
<div class="line"><span class="lineno"> 1325</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 127),         <span class="comment"># NOLA True, COLA False</span></div>
<div class="line"><span class="lineno"> 1326</span>                    ((<span class="stringliteral">&#39;tukey&#39;</span>, 0.5), 1152, 256, 14),  <span class="comment"># NOLA True, COLA False</span></div>
<div class="line"><span class="lineno"> 1327</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 5),           <span class="comment"># NOLA True, COLA False</span></div>
<div class="line"><span class="lineno"> 1328</span>                    ]</div>
<div class="line"><span class="lineno"> 1329</span> </div>
<div class="line"><span class="lineno"> 1330</span>        <span class="keywordflow">for</span> window, N, nperseg, noverlap <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1331</span>            msg = <span class="stringliteral">&#39;{0}, {1}, {2}&#39;</span>.format(window, nperseg, noverlap)</div>
<div class="line"><span class="lineno"> 1332</span>            <span class="keyword">assert</span> check_NOLA(window, nperseg, noverlap), msg</div>
<div class="line"><span class="lineno"> 1333</span>            <span class="keyword">assert</span> <span class="keywordflow">not</span> check_COLA(window, nperseg, noverlap), msg</div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>            t = np.arange(N)</div>
<div class="line"><span class="lineno"> 1336</span>            x = 10 * np.random.randn(t.size)</div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span>            _, _, zz = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1339</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1340</span>                            boundary=<span class="stringliteral">&#39;zeros&#39;</span>)</div>
<div class="line"><span class="lineno"> 1341</span> </div>
<div class="line"><span class="lineno"> 1342</span>            tr, xr = istft(zz, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1343</span>                           window=window, boundary=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>            msg = <span class="stringliteral">&#39;{0}, {1}&#39;</span>.format(window, noverlap)</div>
<div class="line"><span class="lineno"> 1346</span>            assert_allclose(t, tr[:len(t)], err_msg=msg)</div>
<div class="line"><span class="lineno"> 1347</span>            assert_allclose(x, xr[:len(x)], err_msg=msg)</div>
<div class="line"><span class="lineno"> 1348</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acb3f02b7e2d4ff1eb9fbaab3e96e8f0c" name="acb3f02b7e2d4ff1eb9fbaab3e96e8f0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb3f02b7e2d4ff1eb9fbaab3e96e8f0c">&#9670;&#160;</a></span>test_roundtrip_not_nola()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_not_nola </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1292</span>    <span class="keyword">def </span>test_roundtrip_not_nola(self):</div>
<div class="line"><span class="lineno"> 1293</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>        w_fail = np.ones(16)</div>
<div class="line"><span class="lineno"> 1296</span>        w_fail[::2] = 0</div>
<div class="line"><span class="lineno"> 1297</span>        settings = [</div>
<div class="line"><span class="lineno"> 1298</span>                    (w_fail, 256, len(w_fail), len(w_fail) // 2),</div>
<div class="line"><span class="lineno"> 1299</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 256, 64, 0),</div>
<div class="line"><span class="lineno"> 1300</span>        ]</div>
<div class="line"><span class="lineno"> 1301</span> </div>
<div class="line"><span class="lineno"> 1302</span>        <span class="keywordflow">for</span> window, N, nperseg, noverlap <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1303</span>            msg = <span class="stringliteral">&#39;{0}, {1}, {2}, {3}&#39;</span>.format(window, N, nperseg, noverlap)</div>
<div class="line"><span class="lineno"> 1304</span>            <span class="keyword">assert</span> <span class="keywordflow">not</span> check_NOLA(window, nperseg, noverlap), msg</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>            t = np.arange(N)</div>
<div class="line"><span class="lineno"> 1307</span>            x = 10 * np.random.randn(t.size)</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>            _, _, zz = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1310</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1311</span>                            boundary=<span class="stringliteral">&#39;zeros&#39;</span>)</div>
<div class="line"><span class="lineno"> 1312</span>            <span class="keyword">with</span> pytest.warns(UserWarning, match=<span class="stringliteral">&#39;NOLA&#39;</span>):</div>
<div class="line"><span class="lineno"> 1313</span>                tr, xr = istft(zz, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1314</span>                               window=window, boundary=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>            <span class="keyword">assert</span> np.allclose(t, tr[:len(t)]), msg</div>
<div class="line"><span class="lineno"> 1317</span>            <span class="keyword">assert</span> <span class="keywordflow">not</span> np.allclose(x, xr[:len(x)]), msg</div>
<div class="line"><span class="lineno"> 1318</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abacc230cfb23efc08d0afeff9ad97c46" name="abacc230cfb23efc08d0afeff9ad97c46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abacc230cfb23efc08d0afeff9ad97c46">&#9670;&#160;</a></span>test_roundtrip_padded_FFT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_padded_FFT </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1469</span>    <span class="keyword">def </span>test_roundtrip_padded_FFT(self):</div>
<div class="line"><span class="lineno"> 1470</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1471</span> </div>
<div class="line"><span class="lineno"> 1472</span>        settings = [</div>
<div class="line"><span class="lineno"> 1473</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 128, 512),</div>
<div class="line"><span class="lineno"> 1474</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 128, 501),</div>
<div class="line"><span class="lineno"> 1475</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 100, 10, 0, 33),</div>
<div class="line"><span class="lineno"> 1476</span>                    ((<span class="stringliteral">&#39;tukey&#39;</span>, 0.5), 1152, 256, 64, 1024),</div>
<div class="line"><span class="lineno"> 1477</span>                    ]</div>
<div class="line"><span class="lineno"> 1478</span> </div>
<div class="line"><span class="lineno"> 1479</span>        <span class="keywordflow">for</span> window, N, nperseg, noverlap, nfft <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1480</span>            t = np.arange(N)</div>
<div class="line"><span class="lineno"> 1481</span>            x = 10*np.random.randn(t.size)</div>
<div class="line"><span class="lineno"> 1482</span>            xc = x*np.exp(1j*np.pi/4)</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>            <span class="comment"># real signal</span></div>
<div class="line"><span class="lineno"> 1485</span>            _, _, z = stft(x, nperseg=nperseg, noverlap=noverlap, nfft=nfft,</div>
<div class="line"><span class="lineno"> 1486</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>            <span class="comment"># complex signal</span></div>
<div class="line"><span class="lineno"> 1489</span>            _, _, zc = stft(xc, nperseg=nperseg, noverlap=noverlap, nfft=nfft,</div>
<div class="line"><span class="lineno"> 1490</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1491</span>                            return_onesided=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1492</span> </div>
<div class="line"><span class="lineno"> 1493</span>            tr, xr = istft(z, nperseg=nperseg, noverlap=noverlap, nfft=nfft,</div>
<div class="line"><span class="lineno"> 1494</span>                           window=window)</div>
<div class="line"><span class="lineno"> 1495</span> </div>
<div class="line"><span class="lineno"> 1496</span>            tr, xcr = istft(zc, nperseg=nperseg, noverlap=noverlap, nfft=nfft,</div>
<div class="line"><span class="lineno"> 1497</span>                            window=window, input_onesided=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1498</span> </div>
<div class="line"><span class="lineno"> 1499</span>            msg = <span class="stringliteral">&#39;{0}, {1}&#39;</span>.format(window, noverlap)</div>
<div class="line"><span class="lineno"> 1500</span>            assert_allclose(t, tr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1501</span>            assert_allclose(x, xr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1502</span>            assert_allclose(xc, xcr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1503</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8bf987c8aa09645d958e46b574062d3" name="ab8bf987c8aa09645d958e46b574062d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8bf987c8aa09645d958e46b574062d3">&#9670;&#160;</a></span>test_roundtrip_padded_signal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_padded_signal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1447</span>    <span class="keyword">def </span>test_roundtrip_padded_signal(self):</div>
<div class="line"><span class="lineno"> 1448</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1449</span> </div>
<div class="line"><span class="lineno"> 1450</span>        settings = [</div>
<div class="line"><span class="lineno"> 1451</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 101, 10, 0),</div>
<div class="line"><span class="lineno"> 1452</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1000, 256, 128),</div>
<div class="line"><span class="lineno"> 1453</span>                    ]</div>
<div class="line"><span class="lineno"> 1454</span> </div>
<div class="line"><span class="lineno"> 1455</span>        <span class="keywordflow">for</span> window, N, nperseg, noverlap <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1456</span>            t = np.arange(N)</div>
<div class="line"><span class="lineno"> 1457</span>            x = 10*np.random.randn(t.size)</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>            _, _, zz = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1460</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1461</span> </div>
<div class="line"><span class="lineno"> 1462</span>            tr, xr = istft(zz, noverlap=noverlap, window=window)</div>
<div class="line"><span class="lineno"> 1463</span> </div>
<div class="line"><span class="lineno"> 1464</span>            msg = <span class="stringliteral">&#39;{0}, {1}&#39;</span>.format(window, noverlap)</div>
<div class="line"><span class="lineno"> 1465</span>            <span class="comment"># Account for possible zero-padding at the end</span></div>
<div class="line"><span class="lineno"> 1466</span>            assert_allclose(t, tr[:t.size], err_msg=msg)</div>
<div class="line"><span class="lineno"> 1467</span>            assert_allclose(x, xr[:x.size], err_msg=msg)</div>
<div class="line"><span class="lineno"> 1468</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b227823f9e301963bfa91c218084e7d" name="a5b227823f9e301963bfa91c218084e7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b227823f9e301963bfa91c218084e7d">&#9670;&#160;</a></span>test_roundtrip_real()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_real </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scaling</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1265</span>    <span class="keyword">def </span>test_roundtrip_real(self, scaling):</div>
<div class="line"><span class="lineno"> 1266</span>        np.random.seed(1234)</div>
<div class="line"><span class="lineno"> 1267</span> </div>
<div class="line"><span class="lineno"> 1268</span>        settings = [</div>
<div class="line"><span class="lineno"> 1269</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 100, 10, 0),           <span class="comment"># Test no overlap</span></div>
<div class="line"><span class="lineno"> 1270</span>                    (<span class="stringliteral">&#39;boxcar&#39;</span>, 100, 10, 9),           <span class="comment"># Test high overlap</span></div>
<div class="line"><span class="lineno"> 1271</span>                    (<span class="stringliteral">&#39;bartlett&#39;</span>, 101, 51, 26),        <span class="comment"># Test odd nperseg</span></div>
<div class="line"><span class="lineno"> 1272</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 128),         <span class="comment"># Test defaults</span></div>
<div class="line"><span class="lineno"> 1273</span>                    ((<span class="stringliteral">&#39;tukey&#39;</span>, 0.5), 1152, 256, 64),  <span class="comment"># Test Tukey</span></div>
<div class="line"><span class="lineno"> 1274</span>                    (<span class="stringliteral">&#39;hann&#39;</span>, 1024, 256, 255),         <span class="comment"># Test overlapped hann</span></div>
<div class="line"><span class="lineno"> 1275</span>                    ]</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>        <span class="keywordflow">for</span> window, N, nperseg, noverlap <span class="keywordflow">in</span> settings:</div>
<div class="line"><span class="lineno"> 1278</span>            t = np.arange(N)</div>
<div class="line"><span class="lineno"> 1279</span>            x = 10*np.random.randn(t.size)</div>
<div class="line"><span class="lineno"> 1280</span> </div>
<div class="line"><span class="lineno"> 1281</span>            _, _, zz = stft(x, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1282</span>                            window=window, detrend=<span class="keywordtype">None</span>, padded=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1283</span>                            scaling=scaling)</div>
<div class="line"><span class="lineno"> 1284</span> </div>
<div class="line"><span class="lineno"> 1285</span>            tr, xr = istft(zz, nperseg=nperseg, noverlap=noverlap,</div>
<div class="line"><span class="lineno"> 1286</span>                           window=window, scaling=scaling)</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span>            msg = <span class="stringliteral">&#39;{0}, {1}&#39;</span>.format(window, noverlap)</div>
<div class="line"><span class="lineno"> 1289</span>            assert_allclose(t, tr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1290</span>            assert_allclose(x, xr, err_msg=msg)</div>
<div class="line"><span class="lineno"> 1291</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5fea82f204bc5847c32251676609eef" name="ae5fea82f204bc5847c32251676609eef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5fea82f204bc5847c32251676609eef">&#9670;&#160;</a></span>test_roundtrip_scaling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_spectral.TestSTFT.test_roundtrip_scaling </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Verify behavior of scaling parameter. </pre> <div class="fragment"><div class="line"><span class="lineno"> 1530</span>    <span class="keyword">def </span>test_roundtrip_scaling(self):</div>
<div class="line"><span class="lineno"> 1531</span>        <span class="stringliteral">&quot;&quot;&quot;Verify behavior of scaling parameter. &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1532</span>        <span class="comment"># Create 1024 sample cosine signal with amplitude 2:</span></div>
<div class="line"><span class="lineno"> 1533</span>        X = np.zeros(513, dtype=complex)</div>
<div class="line"><span class="lineno"> 1534</span>        X[256] = 1024</div>
<div class="line"><span class="lineno"> 1535</span>        x = np.fft.irfft(X)</div>
<div class="line"><span class="lineno"> 1536</span>        power_x = sum(x**2) / len(x)  <span class="comment"># power of signal x is 2</span></div>
<div class="line"><span class="lineno"> 1537</span> </div>
<div class="line"><span class="lineno"> 1538</span>        <span class="comment"># Calculate magnitude-scaled STFT:</span></div>
<div class="line"><span class="lineno"> 1539</span>        Zs = stft(x, boundary=<span class="stringliteral">&#39;even&#39;</span>, scaling=<span class="stringliteral">&#39;spectrum&#39;</span>)[2]</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>        <span class="comment"># Test round trip:</span></div>
<div class="line"><span class="lineno"> 1542</span>        x1 = istft(Zs, boundary=<span class="keyword">True</span>, scaling=<span class="stringliteral">&#39;spectrum&#39;</span>)[1]</div>
<div class="line"><span class="lineno"> 1543</span>        assert_allclose(x1, x)</div>
<div class="line"><span class="lineno"> 1544</span> </div>
<div class="line"><span class="lineno"> 1545</span>        <span class="comment"># For a Hann-windowed 256 sample length FFT, we expect a peak at</span></div>
<div class="line"><span class="lineno"> 1546</span>        <span class="comment"># frequency 64 (since it is 1/4 the length of X) with a height of 1</span></div>
<div class="line"><span class="lineno"> 1547</span>        <span class="comment"># (half the amplitude). A Hann window of a perfectly centered sine has</span></div>
<div class="line"><span class="lineno"> 1548</span>        <span class="comment"># the magnitude [..., 0, 0, 0.5, 1, 0.5, 0, 0, ...].</span></div>
<div class="line"><span class="lineno"> 1549</span>        <span class="comment"># Note that in this case the &#39;even&#39; padding works for the beginning</span></div>
<div class="line"><span class="lineno"> 1550</span>        <span class="comment"># but not for the end of the STFT.</span></div>
<div class="line"><span class="lineno"> 1551</span>        assert_allclose(abs(Zs[63, :-1]), 0.5)</div>
<div class="line"><span class="lineno"> 1552</span>        assert_allclose(abs(Zs[64, :-1]), 1)</div>
<div class="line"><span class="lineno"> 1553</span>        assert_allclose(abs(Zs[65, :-1]), 0.5)</div>
<div class="line"><span class="lineno"> 1554</span>        <span class="comment"># All other values should be zero:</span></div>
<div class="line"><span class="lineno"> 1555</span>        Zs[63:66, :-1] = 0</div>
<div class="line"><span class="lineno"> 1556</span>        <span class="comment"># Note since &#39;rtol&#39; does not have influence here, atol needs to be set:</span></div>
<div class="line"><span class="lineno"> 1557</span>        assert_allclose(Zs[:, :-1], 0, atol=np.finfo(Zs.dtype).resolution)</div>
<div class="line"><span class="lineno"> 1558</span> </div>
<div class="line"><span class="lineno"> 1559</span>        <span class="comment"># Calculate two-sided psd-scaled STFT:</span></div>
<div class="line"><span class="lineno"> 1560</span>        <span class="comment">#  - using &#39;even&#39; padding since signal is axis symmetric - this ensures</span></div>
<div class="line"><span class="lineno"> 1561</span>        <span class="comment">#    stationary behavior on the boundaries</span></div>
<div class="line"><span class="lineno"> 1562</span>        <span class="comment">#  - using the two-sided transform allows determining the spectral</span></div>
<div class="line"><span class="lineno"> 1563</span>        <span class="comment">#    power by `sum(abs(Zp[:, k])**2) / len(f)` for the k-th time slot.</span></div>
<div class="line"><span class="lineno"> 1564</span>        Zp = stft(x, return_onesided=<span class="keyword">False</span>, boundary=<span class="stringliteral">&#39;even&#39;</span>, scaling=<span class="stringliteral">&#39;psd&#39;</span>)[2]</div>
<div class="line"><span class="lineno"> 1565</span> </div>
<div class="line"><span class="lineno"> 1566</span>        <span class="comment"># Calculate spectral power of Zd by summing over the frequency axis:</span></div>
<div class="line"><span class="lineno"> 1567</span>        psd_Zp = np.sum(Zp.real**2 + Zp.imag**2, axis=0) / Zp.shape[0]</div>
<div class="line"><span class="lineno"> 1568</span>        <span class="comment"># Spectral power of Zp should be equal to the signal&#39;s power:</span></div>
<div class="line"><span class="lineno"> 1569</span>        assert_allclose(psd_Zp, power_x)</div>
<div class="line"><span class="lineno"> 1570</span> </div>
<div class="line"><span class="lineno"> 1571</span>        <span class="comment"># Test round trip:</span></div>
<div class="line"><span class="lineno"> 1572</span>        x1 = istft(Zp, input_onesided=<span class="keyword">False</span>, boundary=<span class="keyword">True</span>, scaling=<span class="stringliteral">&#39;psd&#39;</span>)[1]</div>
<div class="line"><span class="lineno"> 1573</span>        assert_allclose(x1, x)</div>
<div class="line"><span class="lineno"> 1574</span> </div>
<div class="line"><span class="lineno"> 1575</span>        <span class="comment"># The power of the one-sided psd-scaled STFT can be determined</span></div>
<div class="line"><span class="lineno"> 1576</span>        <span class="comment"># analogously (note that the two sides are not of equal shape):</span></div>
<div class="line"><span class="lineno"> 1577</span>        Zp0 = stft(x, return_onesided=<span class="keyword">True</span>, boundary=<span class="stringliteral">&#39;even&#39;</span>, scaling=<span class="stringliteral">&#39;psd&#39;</span>)[2]</div>
<div class="line"><span class="lineno"> 1578</span> </div>
<div class="line"><span class="lineno"> 1579</span>        <span class="comment"># Since x is real, its Fourier transform is conjugate symmetric, i.e.,</span></div>
<div class="line"><span class="lineno"> 1580</span>        <span class="comment"># the missing &#39;second side&#39; can be expressed through the &#39;first side&#39;:</span></div>
<div class="line"><span class="lineno"> 1581</span>        Zp1 = np.conj(Zp0[-2:0:-1, :])  <span class="comment"># &#39;second side&#39; is conjugate reversed</span></div>
<div class="line"><span class="lineno"> 1582</span>        assert_allclose(Zp[:129, :], Zp0)</div>
<div class="line"><span class="lineno"> 1583</span>        assert_allclose(Zp[129:, :], Zp1)</div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span>        <span class="comment"># Calculate the spectral power:</span></div>
<div class="line"><span class="lineno"> 1586</span>        s2 = (np.sum(Zp0.real ** 2 + Zp0.imag ** 2, axis=0) +</div>
<div class="line"><span class="lineno"> 1587</span>              np.sum(Zp1.real ** 2 + Zp1.imag ** 2, axis=0))</div>
<div class="line"><span class="lineno"> 1588</span>        psd_Zp01 = s2 / (Zp0.shape[0] + Zp1.shape[0])</div>
<div class="line"><span class="lineno"> 1589</span>        assert_allclose(psd_Zp01, power_x)</div>
<div class="line"><span class="lineno"> 1590</span> </div>
<div class="line"><span class="lineno"> 1591</span>        <span class="comment"># Test round trip:</span></div>
<div class="line"><span class="lineno"> 1592</span>        x1 = istft(Zp0, input_onesided=<span class="keyword">True</span>, boundary=<span class="keyword">True</span>, scaling=<span class="stringliteral">&#39;psd&#39;</span>)[1]</div>
<div class="line"><span class="lineno"> 1593</span>        assert_allclose(x1, x)</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/scipy/signal/tests/<a class="el" href="scipy_2signal_2tests_2test__spectral_8py.html">test_spectral.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
