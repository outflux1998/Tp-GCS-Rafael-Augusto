<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.stats.tests.test_resampling Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html">test_resampling</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats.tests.test_resampling Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_monte_carlo_hypothesis_test.html">TestMonteCarloHypothesisTest</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1tests_1_1test__resampling_1_1_test_permutation_test.html">TestPermutationTest</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a41d17f840f680a2a6e8270feb9791cc0" id="r_a41d17f840f680a2a6e8270feb9791cc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a41d17f840f680a2a6e8270feb9791cc0">test_bootstrap_iv</a> ()</td></tr>
<tr class="separator:a41d17f840f680a2a6e8270feb9791cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb23c45b8b59332d55e857620576745" id="r_a7eb23c45b8b59332d55e857620576745"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a7eb23c45b8b59332d55e857620576745">test_bootstrap_batch</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>, axis)</td></tr>
<tr class="separator:a7eb23c45b8b59332d55e857620576745"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a659b5b77698b86800fa88c6b4cba4f06" id="r_a659b5b77698b86800fa88c6b4cba4f06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a659b5b77698b86800fa88c6b4cba4f06">test_bootstrap_paired</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>)</td></tr>
<tr class="separator:a659b5b77698b86800fa88c6b4cba4f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d660403312636cc6531dc3ac6819a2" id="r_a51d660403312636cc6531dc3ac6819a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a51d660403312636cc6531dc3ac6819a2">test_bootstrap_vectorized</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>, axis, paired)</td></tr>
<tr class="separator:a51d660403312636cc6531dc3ac6819a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840f4c7b6659554886f359700c1a368a" id="r_a840f4c7b6659554886f359700c1a368a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a840f4c7b6659554886f359700c1a368a">test_bootstrap_against_theory</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>)</td></tr>
<tr class="separator:a840f4c7b6659554886f359700c1a368a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb97862937e7ec5e03bd04a377591e91" id="r_aeb97862937e7ec5e03bd04a377591e91"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#aeb97862937e7ec5e03bd04a377591e91">test_bootstrap_against_R</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>, expected)</td></tr>
<tr class="separator:aeb97862937e7ec5e03bd04a377591e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ea248407976d5ed76177379aa065bd3" id="r_a0ea248407976d5ed76177379aa065bd3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a0ea248407976d5ed76177379aa065bd3">test_bootstrap_against_itself_1samp</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>, expected)</td></tr>
<tr class="separator:a0ea248407976d5ed76177379aa065bd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fd8bd82346b5919835194d6a3c1118f" id="r_a5fd8bd82346b5919835194d6a3c1118f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a5fd8bd82346b5919835194d6a3c1118f">test_bootstrap_against_itself_2samp</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>, expected)</td></tr>
<tr class="separator:a5fd8bd82346b5919835194d6a3c1118f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc43daaff9befaf19da8fb552ffb40a4" id="r_afc43daaff9befaf19da8fb552ffb40a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#afc43daaff9befaf19da8fb552ffb40a4">test_bootstrap_vectorized_3samp</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>, axis)</td></tr>
<tr class="separator:afc43daaff9befaf19da8fb552ffb40a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad3cdff4968af81f4086cbb178a8a4da" id="r_aad3cdff4968af81f4086cbb178a8a4da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#aad3cdff4968af81f4086cbb178a8a4da">test_bootstrap_vectorized_1samp</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>, axis)</td></tr>
<tr class="separator:aad3cdff4968af81f4086cbb178a8a4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f1b17249bb9296b8f0903e36a5086e1" id="r_a1f1b17249bb9296b8f0903e36a5086e1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a1f1b17249bb9296b8f0903e36a5086e1">test_bootstrap_degenerate</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>)</td></tr>
<tr class="separator:a1f1b17249bb9296b8f0903e36a5086e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5911c9b002c5383d3064be0d59541474" id="r_a5911c9b002c5383d3064be0d59541474"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a5911c9b002c5383d3064be0d59541474">test_bootstrap_gh15678</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>)</td></tr>
<tr class="separator:a5911c9b002c5383d3064be0d59541474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c2227c79727bbc37dc7b0ff52122af1" id="r_a1c2227c79727bbc37dc7b0ff52122af1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a1c2227c79727bbc37dc7b0ff52122af1">test_jackknife_resample</a> ()</td></tr>
<tr class="separator:a1c2227c79727bbc37dc7b0ff52122af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c4a0090bfcaea9a471ae75f685e7c3" id="r_a28c4a0090bfcaea9a471ae75f685e7c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a28c4a0090bfcaea9a471ae75f685e7c3">test_bootstrap_resample</a> (rng_name)</td></tr>
<tr class="separator:a28c4a0090bfcaea9a471ae75f685e7c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02a676cac08afed725edc52a8f91566b" id="r_a02a676cac08afed725edc52a8f91566b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a02a676cac08afed725edc52a8f91566b">test_percentile_of_score</a> (score, axis)</td></tr>
<tr class="separator:a02a676cac08afed725edc52a8f91566b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475c4333879c7aa2500ed7ce30f71958" id="r_a475c4333879c7aa2500ed7ce30f71958"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a475c4333879c7aa2500ed7ce30f71958">test_percentile_along_axis</a> ()</td></tr>
<tr class="separator:a475c4333879c7aa2500ed7ce30f71958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f1f66639139eda22c0b438783836bb5" id="r_a0f1f66639139eda22c0b438783836bb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a0f1f66639139eda22c0b438783836bb5">test_vectorize_statistic</a> (axis)</td></tr>
<tr class="separator:a0f1f66639139eda22c0b438783836bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44f3c6bf999acaeaf3847e565298c249" id="r_a44f3c6bf999acaeaf3847e565298c249"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a44f3c6bf999acaeaf3847e565298c249">test_vector_valued_statistic</a> (<a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>)</td></tr>
<tr class="separator:a44f3c6bf999acaeaf3847e565298c249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab40e58ace1992d9e76755a26382e2f3e" id="r_ab40e58ace1992d9e76755a26382e2f3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#ab40e58ace1992d9e76755a26382e2f3e">test_all_partitions_concatenated</a> ()</td></tr>
<tr class="separator:ab40e58ace1992d9e76755a26382e2f3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3dbd1758265f8335a5331dbc30b51f41" id="r_a3dbd1758265f8335a5331dbc30b51f41"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a3dbd1758265f8335a5331dbc30b51f41">tests_R</a></td></tr>
<tr class="separator:a3dbd1758265f8335a5331dbc30b51f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afce90938d9b43b639f5a241752310a84" id="r_afce90938d9b43b639f5a241752310a84"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#afce90938d9b43b639f5a241752310a84">tests_against_itself_1samp</a></td></tr>
<tr class="separator:afce90938d9b43b639f5a241752310a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96449910872d0ea27abe83b43f7dfbf5" id="r_a96449910872d0ea27abe83b43f7dfbf5"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1tests_1_1test__resampling.html#a96449910872d0ea27abe83b43f7dfbf5">tests_against_itself_2samp</a></td></tr>
<tr class="separator:a96449910872d0ea27abe83b43f7dfbf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab40e58ace1992d9e76755a26382e2f3e" name="ab40e58ace1992d9e76755a26382e2f3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab40e58ace1992d9e76755a26382e2f3e">&#9670;&#160;</a></span>test_all_partitions_concatenated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_all_partitions_concatenated </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1423</span><span class="keyword">def </span>test_all_partitions_concatenated():</div>
<div class="line"><span class="lineno"> 1424</span>    <span class="comment"># make sure that _all_paritions_concatenated produces the correct number</span></div>
<div class="line"><span class="lineno"> 1425</span>    <span class="comment"># of partitions of the data into samples of the given sizes and that</span></div>
<div class="line"><span class="lineno"> 1426</span>    <span class="comment"># all are unique</span></div>
<div class="line"><span class="lineno"> 1427</span>    n = np.array([3, 2, 4], dtype=int)</div>
<div class="line"><span class="lineno"> 1428</span>    nc = np.cumsum(n)</div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>    all_partitions = set()</div>
<div class="line"><span class="lineno"> 1431</span>    counter = 0</div>
<div class="line"><span class="lineno"> 1432</span>    <span class="keywordflow">for</span> partition_concatenated <span class="keywordflow">in</span> _resampling._all_partitions_concatenated(n):</div>
<div class="line"><span class="lineno"> 1433</span>        counter += 1</div>
<div class="line"><span class="lineno"> 1434</span>        partitioning = np.split(partition_concatenated, nc[:-1])</div>
<div class="line"><span class="lineno"> 1435</span>        all_partitions.add(tuple([frozenset(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> partitioning]))</div>
<div class="line"><span class="lineno"> 1436</span> </div>
<div class="line"><span class="lineno"> 1437</span>    expected = np.product([special.binom(sum(n[i:]), sum(n[i+1:]))</div>
<div class="line"><span class="lineno"> 1438</span>                           <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(n)-1)])</div>
<div class="line"><span class="lineno"> 1439</span> </div>
<div class="line"><span class="lineno"> 1440</span>    assert_equal(counter, expected)</div>
<div class="line"><span class="lineno"> 1441</span>    assert_equal(len(all_partitions), expected)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ea248407976d5ed76177379aa065bd3" name="a0ea248407976d5ed76177379aa065bd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ea248407976d5ed76177379aa065bd3">&#9670;&#160;</a></span>test_bootstrap_against_itself_1samp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_against_itself_1samp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  219</span><span class="keyword">def </span>test_bootstrap_against_itself_1samp(method, expected):</div>
<div class="line"><span class="lineno">  220</span>    <span class="comment"># The expected values in this test were generated using bootstrap</span></div>
<div class="line"><span class="lineno">  221</span>    <span class="comment"># to check for unintended changes in behavior. The test also makes sure</span></div>
<div class="line"><span class="lineno">  222</span>    <span class="comment"># that bootstrap works with multi-sample statistics and that the</span></div>
<div class="line"><span class="lineno">  223</span>    <span class="comment"># `axis` argument works as expected / function is vectorized.</span></div>
<div class="line"><span class="lineno">  224</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    n = 100  <span class="comment"># size of sample</span></div>
<div class="line"><span class="lineno">  227</span>    n_resamples = 999  <span class="comment"># number of bootstrap resamples used to form each CI</span></div>
<div class="line"><span class="lineno">  228</span>    confidence_level = 0.9</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="comment"># The true mean is 5</span></div>
<div class="line"><span class="lineno">  231</span>    dist = stats.norm(loc=5, scale=1)</div>
<div class="line"><span class="lineno">  232</span>    stat_true = dist.mean()</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    <span class="comment"># Do the same thing 2000 times. (The code is fully vectorized.)</span></div>
<div class="line"><span class="lineno">  235</span>    n_replications = 2000</div>
<div class="line"><span class="lineno">  236</span>    data = dist.rvs(size=(n_replications, n))</div>
<div class="line"><span class="lineno">  237</span>    res = bootstrap((data,),</div>
<div class="line"><span class="lineno">  238</span>                    statistic=np.mean,</div>
<div class="line"><span class="lineno">  239</span>                    confidence_level=confidence_level,</div>
<div class="line"><span class="lineno">  240</span>                    n_resamples=n_resamples,</div>
<div class="line"><span class="lineno">  241</span>                    batch=50,</div>
<div class="line"><span class="lineno">  242</span>                    method=method,</div>
<div class="line"><span class="lineno">  243</span>                    axis=-1)</div>
<div class="line"><span class="lineno">  244</span>    ci = res.confidence_interval</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    <span class="comment"># ci contains vectors of lower and upper confidence interval bounds</span></div>
<div class="line"><span class="lineno">  247</span>    ci_contains_true = np.sum((ci[0] &lt; stat_true) &amp; (stat_true &lt; ci[1]))</div>
<div class="line"><span class="lineno">  248</span>    <span class="keyword">assert</span> ci_contains_true == expected</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    <span class="comment"># ci_contains_true is not inconsistent with confidence_level</span></div>
<div class="line"><span class="lineno">  251</span>    pvalue = stats.binomtest(ci_contains_true, n_replications,</div>
<div class="line"><span class="lineno">  252</span>                             confidence_level).pvalue</div>
<div class="line"><span class="lineno">  253</span>    <span class="keyword">assert</span> pvalue &gt; 0.1</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fd8bd82346b5919835194d6a3c1118f" name="a5fd8bd82346b5919835194d6a3c1118f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fd8bd82346b5919835194d6a3c1118f">&#9670;&#160;</a></span>test_bootstrap_against_itself_2samp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_against_itself_2samp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  262</span><span class="keyword">def </span>test_bootstrap_against_itself_2samp(method, expected):</div>
<div class="line"><span class="lineno">  263</span>    <span class="comment"># The expected values in this test were generated using bootstrap</span></div>
<div class="line"><span class="lineno">  264</span>    <span class="comment"># to check for unintended changes in behavior. The test also makes sure</span></div>
<div class="line"><span class="lineno">  265</span>    <span class="comment"># that bootstrap works with multi-sample statistics and that the</span></div>
<div class="line"><span class="lineno">  266</span>    <span class="comment"># `axis` argument works as expected / function is vectorized.</span></div>
<div class="line"><span class="lineno">  267</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    n1 = 100  <span class="comment"># size of sample 1</span></div>
<div class="line"><span class="lineno">  270</span>    n2 = 120  <span class="comment"># size of sample 2</span></div>
<div class="line"><span class="lineno">  271</span>    n_resamples = 999  <span class="comment"># number of bootstrap resamples used to form each CI</span></div>
<div class="line"><span class="lineno">  272</span>    confidence_level = 0.9</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="comment"># The statistic we&#39;re interested in is the difference in means</span></div>
<div class="line"><span class="lineno">  275</span>    <span class="keyword">def </span>my_stat(data1, data2, axis=-1):</div>
<div class="line"><span class="lineno">  276</span>        mean1 = np.mean(data1, axis=axis)</div>
<div class="line"><span class="lineno">  277</span>        mean2 = np.mean(data2, axis=axis)</div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">return</span> mean1 - mean2</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>    <span class="comment"># The true difference in the means is -0.1</span></div>
<div class="line"><span class="lineno">  281</span>    dist1 = stats.norm(loc=0, scale=1)</div>
<div class="line"><span class="lineno">  282</span>    dist2 = stats.norm(loc=0.1, scale=1)</div>
<div class="line"><span class="lineno">  283</span>    stat_true = dist1.mean() - dist2.mean()</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    <span class="comment"># Do the same thing 1000 times. (The code is fully vectorized.)</span></div>
<div class="line"><span class="lineno">  286</span>    n_replications = 1000</div>
<div class="line"><span class="lineno">  287</span>    data1 = dist1.rvs(size=(n_replications, n1))</div>
<div class="line"><span class="lineno">  288</span>    data2 = dist2.rvs(size=(n_replications, n2))</div>
<div class="line"><span class="lineno">  289</span>    res = bootstrap((data1, data2),</div>
<div class="line"><span class="lineno">  290</span>                    statistic=my_stat,</div>
<div class="line"><span class="lineno">  291</span>                    confidence_level=confidence_level,</div>
<div class="line"><span class="lineno">  292</span>                    n_resamples=n_resamples,</div>
<div class="line"><span class="lineno">  293</span>                    batch=50,</div>
<div class="line"><span class="lineno">  294</span>                    method=method,</div>
<div class="line"><span class="lineno">  295</span>                    axis=-1)</div>
<div class="line"><span class="lineno">  296</span>    ci = res.confidence_interval</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    <span class="comment"># ci contains vectors of lower and upper confidence interval bounds</span></div>
<div class="line"><span class="lineno">  299</span>    ci_contains_true = np.sum((ci[0] &lt; stat_true) &amp; (stat_true &lt; ci[1]))</div>
<div class="line"><span class="lineno">  300</span>    <span class="keyword">assert</span> ci_contains_true == expected</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="comment"># ci_contains_true is not inconsistent with confidence_level</span></div>
<div class="line"><span class="lineno">  303</span>    pvalue = stats.binomtest(ci_contains_true, n_replications,</div>
<div class="line"><span class="lineno">  304</span>                             confidence_level).pvalue</div>
<div class="line"><span class="lineno">  305</span>    <span class="keyword">assert</span> pvalue &gt; 0.1</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;basic&quot;, &quot;percentile&quot;])</span></div>
<div class="line"><span class="lineno">  309</span><span class="preprocessor">@pytest.mark.parametrize(&quot;axis&quot;, [0, 1])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb97862937e7ec5e03bd04a377591e91" name="aeb97862937e7ec5e03bd04a377591e91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb97862937e7ec5e03bd04a377591e91">&#9670;&#160;</a></span>test_bootstrap_against_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_against_R </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  189</span><span class="keyword">def </span>test_bootstrap_against_R(method, expected):</div>
<div class="line"><span class="lineno">  190</span>    <span class="comment"># Compare against R&#39;s &quot;boot&quot; library</span></div>
<div class="line"><span class="lineno">  191</span>    <span class="comment"># library(boot)</span></div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    <span class="comment"># stat &lt;- function (x, a) {</span></div>
<div class="line"><span class="lineno">  194</span>    <span class="comment">#     mean(x[a])</span></div>
<div class="line"><span class="lineno">  195</span>    <span class="comment"># }</span></div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>    <span class="comment"># x &lt;- c(10, 12, 12.5, 12.5, 13.9, 15, 21, 22,</span></div>
<div class="line"><span class="lineno">  198</span>    <span class="comment">#        23, 34, 50, 81, 89, 121, 134, 213)</span></div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    <span class="comment"># # Use a large value so we get a few significant digits for the CI.</span></div>
<div class="line"><span class="lineno">  201</span>    <span class="comment"># n = 1000000</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="comment"># bootresult = boot(x, stat, n)</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="comment"># result &lt;- boot.ci(bootresult)</span></div>
<div class="line"><span class="lineno">  204</span>    <span class="comment"># print(result)</span></div>
<div class="line"><span class="lineno">  205</span>    x = np.array([10, 12, 12.5, 12.5, 13.9, 15, 21, 22,</div>
<div class="line"><span class="lineno">  206</span>                  23, 34, 50, 81, 89, 121, 134, 213])</div>
<div class="line"><span class="lineno">  207</span>    res = bootstrap((x,), np.mean, n_resamples=1000000, method=method,</div>
<div class="line"><span class="lineno">  208</span>                    random_state=0)</div>
<div class="line"><span class="lineno">  209</span>    assert_allclose(res.confidence_interval, expected, rtol=0.005)</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a840f4c7b6659554886f359700c1a368a" name="a840f4c7b6659554886f359700c1a368a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840f4c7b6659554886f359700c1a368a">&#9670;&#160;</a></span>test_bootstrap_against_theory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_against_theory </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  168</span><span class="keyword">def </span>test_bootstrap_against_theory(method):</div>
<div class="line"><span class="lineno">  169</span>    <span class="comment"># based on https://www.statology.org/confidence-intervals-python/</span></div>
<div class="line"><span class="lineno">  170</span>    data = stats.norm.rvs(loc=5, scale=2, size=5000, random_state=0)</div>
<div class="line"><span class="lineno">  171</span>    alpha = 0.95</div>
<div class="line"><span class="lineno">  172</span>    dist = stats.t(df=len(data)-1, loc=np.mean(data), scale=stats.sem(data))</div>
<div class="line"><span class="lineno">  173</span>    expected_interval = dist.interval(confidence=alpha)</div>
<div class="line"><span class="lineno">  174</span>    expected_se = dist.std()</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    res = bootstrap((data,), np.mean, n_resamples=5000,</div>
<div class="line"><span class="lineno">  177</span>                    confidence_level=alpha, method=method,</div>
<div class="line"><span class="lineno">  178</span>                    random_state=0)</div>
<div class="line"><span class="lineno">  179</span>    assert_allclose(res.confidence_interval, expected_interval, rtol=5e-4)</div>
<div class="line"><span class="lineno">  180</span>    assert_allclose(res.standard_error, expected_se, atol=3e-4)</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7eb23c45b8b59332d55e857620576745" name="a7eb23c45b8b59332d55e857620576745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb23c45b8b59332d55e857620576745">&#9670;&#160;</a></span>test_bootstrap_batch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_batch </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   79</span><span class="keyword">def </span>test_bootstrap_batch(method, axis):</div>
<div class="line"><span class="lineno">   80</span>    <span class="comment"># for one-sample statistics, batch size shouldn&#39;t affect the result</span></div>
<div class="line"><span class="lineno">   81</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    x = np.random.rand(10, 11, 12)</div>
<div class="line"><span class="lineno">   84</span>    res1 = bootstrap((x,), np.mean, batch=<span class="keywordtype">None</span>, method=method,</div>
<div class="line"><span class="lineno">   85</span>                     random_state=0, axis=axis, n_resamples=100)</div>
<div class="line"><span class="lineno">   86</span>    res2 = bootstrap((x,), np.mean, batch=10, method=method,</div>
<div class="line"><span class="lineno">   87</span>                     random_state=0, axis=axis, n_resamples=100)</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>    assert_equal(res2.confidence_interval.low, res1.confidence_interval.low)</div>
<div class="line"><span class="lineno">   90</span>    assert_equal(res2.confidence_interval.high, res1.confidence_interval.high)</div>
<div class="line"><span class="lineno">   91</span>    assert_equal(res2.standard_error, res1.standard_error)</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&#39;basic&#39;, &#39;percentile&#39;, &#39;BCa&#39;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f1b17249bb9296b8f0903e36a5086e1" name="a1f1b17249bb9296b8f0903e36a5086e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f1b17249bb9296b8f0903e36a5086e1">&#9670;&#160;</a></span>test_bootstrap_degenerate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_degenerate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  359</span><span class="keyword">def </span>test_bootstrap_degenerate(method):</div>
<div class="line"><span class="lineno">  360</span>    data = 35 * [10000.]</div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;BCa&quot;</span>:</div>
<div class="line"><span class="lineno">  362</span>        <span class="keyword">with</span> np.errstate(invalid=<span class="stringliteral">&#39;ignore&#39;</span>):</div>
<div class="line"><span class="lineno">  363</span>            msg = <span class="stringliteral">&quot;The bootstrap distribution is degenerate&quot;</span></div>
<div class="line"><span class="lineno">  364</span>            <span class="keyword">with</span> pytest.warns(stats.DegenerateDataWarning, match=msg):</div>
<div class="line"><span class="lineno">  365</span>                res = bootstrap([data, ], np.mean, method=method)</div>
<div class="line"><span class="lineno">  366</span>                assert_equal(res.confidence_interval, (np.nan, np.nan))</div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  368</span>        res = bootstrap([data, ], np.mean, method=method)</div>
<div class="line"><span class="lineno">  369</span>        assert_equal(res.confidence_interval, (10000., 10000.))</div>
<div class="line"><span class="lineno">  370</span>    assert_equal(res.standard_error, 0)</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;basic&quot;, &quot;percentile&quot;, &quot;BCa&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5911c9b002c5383d3064be0d59541474" name="a5911c9b002c5383d3064be0d59541474"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5911c9b002c5383d3064be0d59541474">&#9670;&#160;</a></span>test_bootstrap_gh15678()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_gh15678 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  374</span><span class="keyword">def </span>test_bootstrap_gh15678(method):</div>
<div class="line"><span class="lineno">  375</span>    <span class="comment"># Check that gh-15678 is fixed: when statistic function returned a Python</span></div>
<div class="line"><span class="lineno">  376</span>    <span class="comment"># float, method=&quot;BCa&quot; failed when trying to add a dimension to the float</span></div>
<div class="line"><span class="lineno">  377</span>    rng = np.random.default_rng(354645618886684)</div>
<div class="line"><span class="lineno">  378</span>    dist = stats.norm(loc=2, scale=4)</div>
<div class="line"><span class="lineno">  379</span>    data = dist.rvs(size=100, random_state=rng)</div>
<div class="line"><span class="lineno">  380</span>    data = (data,)</div>
<div class="line"><span class="lineno">  381</span>    res = bootstrap(data, stats.skew, method=method, n_resamples=100,</div>
<div class="line"><span class="lineno">  382</span>                    random_state=np.random.default_rng(9563))</div>
<div class="line"><span class="lineno">  383</span>    <span class="comment"># this always worked because np.apply_along_axis returns NumPy data type</span></div>
<div class="line"><span class="lineno">  384</span>    ref = bootstrap(data, stats.skew, method=method, n_resamples=100,</div>
<div class="line"><span class="lineno">  385</span>                    random_state=np.random.default_rng(9563), vectorized=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  386</span>    assert_allclose(res.confidence_interval, ref.confidence_interval)</div>
<div class="line"><span class="lineno">  387</span>    assert_allclose(res.standard_error, ref.standard_error)</div>
<div class="line"><span class="lineno">  388</span>    <span class="keyword">assert</span> isinstance(res.standard_error, np.float64)</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a41d17f840f680a2a6e8270feb9791cc0" name="a41d17f840f680a2a6e8270feb9791cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41d17f840f680a2a6e8270feb9791cc0">&#9670;&#160;</a></span>test_bootstrap_iv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_iv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   12</span><span class="keyword">def </span>test_bootstrap_iv():</div>
<div class="line"><span class="lineno">   13</span> </div>
<div class="line"><span class="lineno">   14</span>    message = <span class="stringliteral">&quot;`data` must be a sequence of samples.&quot;</span></div>
<div class="line"><span class="lineno">   15</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   16</span>        bootstrap(1, np.mean)</div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span>    message = <span class="stringliteral">&quot;`data` must contain at least one sample.&quot;</span></div>
<div class="line"><span class="lineno">   19</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   20</span>        bootstrap(tuple(), np.mean)</div>
<div class="line"><span class="lineno">   21</span> </div>
<div class="line"><span class="lineno">   22</span>    message = <span class="stringliteral">&quot;each sample in `data` must contain two or more observations...&quot;</span></div>
<div class="line"><span class="lineno">   23</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   24</span>        bootstrap(([1, 2, 3], [1]), np.mean)</div>
<div class="line"><span class="lineno">   25</span> </div>
<div class="line"><span class="lineno">   26</span>    message = (<span class="stringliteral">&quot;When `paired is True`, all samples must have the same length &quot;</span>)</div>
<div class="line"><span class="lineno">   27</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   28</span>        bootstrap(([1, 2, 3], [1, 2, 3, 4]), np.mean, paired=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>    message = <span class="stringliteral">&quot;`vectorized` must be `True` or `False`.&quot;</span></div>
<div class="line"><span class="lineno">   31</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   32</span>        bootstrap(1, np.mean, vectorized=<span class="stringliteral">&#39;ekki&#39;</span>)</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>    message = <span class="stringliteral">&quot;`axis` must be an integer.&quot;</span></div>
<div class="line"><span class="lineno">   35</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   36</span>        bootstrap(([1, 2, 3],), np.mean, axis=1.5)</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>    message = <span class="stringliteral">&quot;could not convert string to float&quot;</span></div>
<div class="line"><span class="lineno">   39</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   40</span>        bootstrap(([1, 2, 3],), np.mean, confidence_level=<span class="stringliteral">&#39;ni&#39;</span>)</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>    message = <span class="stringliteral">&quot;`n_resamples` must be a positive integer.&quot;</span></div>
<div class="line"><span class="lineno">   43</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   44</span>        bootstrap(([1, 2, 3],), np.mean, n_resamples=-1000)</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    message = <span class="stringliteral">&quot;`n_resamples` must be a positive integer.&quot;</span></div>
<div class="line"><span class="lineno">   47</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   48</span>        bootstrap(([1, 2, 3],), np.mean, n_resamples=1000.5)</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span>    message = <span class="stringliteral">&quot;`batch` must be a positive integer or None.&quot;</span></div>
<div class="line"><span class="lineno">   51</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   52</span>        bootstrap(([1, 2, 3],), np.mean, batch=-1000)</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    message = <span class="stringliteral">&quot;`batch` must be a positive integer or None.&quot;</span></div>
<div class="line"><span class="lineno">   55</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   56</span>        bootstrap(([1, 2, 3],), np.mean, batch=1000.5)</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    message = <span class="stringliteral">&quot;`method` must be in&quot;</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   60</span>        bootstrap(([1, 2, 3],), np.mean, method=<span class="stringliteral">&#39;ekki&#39;</span>)</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    message = <span class="stringliteral">&quot;`method = &#39;BCa&#39; is only available for one-sample statistics&quot;</span></div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>    <span class="keyword">def </span>statistic(x, y, axis):</div>
<div class="line"><span class="lineno">   65</span>        mean1 = np.mean(x, axis)</div>
<div class="line"><span class="lineno">   66</span>        mean2 = np.mean(y, axis)</div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">return</span> mean1 - mean2</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   70</span>        bootstrap(([.1, .2, .3], [.1, .2, .3]), statistic, method=<span class="stringliteral">&#39;BCa&#39;</span>)</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    message = <span class="stringliteral">&quot;&#39;herring&#39; cannot be used to seed a&quot;</span></div>
<div class="line"><span class="lineno">   73</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=message):</div>
<div class="line"><span class="lineno">   74</span>        bootstrap(([1, 2, 3],), np.mean, random_state=<span class="stringliteral">&#39;herring&#39;</span>)</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&#39;basic&#39;, &#39;percentile&#39;, &#39;BCa&#39;])</span></div>
<div class="line"><span class="lineno">   78</span><span class="preprocessor">@pytest.mark.parametrize(&quot;axis&quot;, [0, 1, 2])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a659b5b77698b86800fa88c6b4cba4f06" name="a659b5b77698b86800fa88c6b4cba4f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a659b5b77698b86800fa88c6b4cba4f06">&#9670;&#160;</a></span>test_bootstrap_paired()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_paired </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   95</span><span class="keyword">def </span>test_bootstrap_paired(method):</div>
<div class="line"><span class="lineno">   96</span>    <span class="comment"># test that `paired` works as expected</span></div>
<div class="line"><span class="lineno">   97</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">   98</span>    n = 100</div>
<div class="line"><span class="lineno">   99</span>    x = np.random.rand(n)</div>
<div class="line"><span class="lineno">  100</span>    y = np.random.rand(n)</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <span class="keyword">def </span>my_statistic(x, y, axis=-1):</div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">return</span> ((x-y)**2).mean(axis=axis)</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    <span class="keyword">def </span>my_paired_statistic(i, axis=-1):</div>
<div class="line"><span class="lineno">  106</span>        a = x[i]</div>
<div class="line"><span class="lineno">  107</span>        b = y[i]</div>
<div class="line"><span class="lineno">  108</span>        res = my_statistic(a, b)</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">return</span> res</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    i = np.arange(len(x))</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    res1 = bootstrap((i,), my_paired_statistic, random_state=0)</div>
<div class="line"><span class="lineno">  114</span>    res2 = bootstrap((x, y), my_statistic, paired=<span class="keyword">True</span>, random_state=0)</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    assert_allclose(res1.confidence_interval, res2.confidence_interval)</div>
<div class="line"><span class="lineno">  117</span>    assert_allclose(res1.standard_error, res2.standard_error)</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&#39;basic&#39;, &#39;percentile&#39;, &#39;BCa&#39;])</span></div>
<div class="line"><span class="lineno">  121</span><span class="preprocessor">@pytest.mark.parametrize(&quot;axis&quot;, [0, 1, 2])</span></div>
<div class="line"><span class="lineno">  122</span><span class="preprocessor">@pytest.mark.parametrize(&quot;paired&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28c4a0090bfcaea9a471ae75f685e7c3" name="a28c4a0090bfcaea9a471ae75f685e7c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c4a0090bfcaea9a471ae75f685e7c3">&#9670;&#160;</a></span>test_bootstrap_resample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_resample </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rng_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  411</span><span class="keyword">def </span>test_bootstrap_resample(rng_name):</div>
<div class="line"><span class="lineno">  412</span>    rng = getattr(np.random, rng_name, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">if</span> rng <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  414</span>        pytest.skip(f<span class="stringliteral">&quot;{rng_name} not available.&quot;</span>)</div>
<div class="line"><span class="lineno">  415</span>    rng1 = rng(0)</div>
<div class="line"><span class="lineno">  416</span>    rng2 = rng(0)</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    n_resamples = 10</div>
<div class="line"><span class="lineno">  419</span>    shape = 3, 4, 5, 6</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  422</span>    x = np.random.rand(*shape)</div>
<div class="line"><span class="lineno">  423</span>    y = _resampling._bootstrap_resample(x, n_resamples, random_state=rng1)</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n_resamples):</div>
<div class="line"><span class="lineno">  426</span>        <span class="comment"># each resample is indexed along second to last axis</span></div>
<div class="line"><span class="lineno">  427</span>        <span class="comment"># (last axis is the one the statistic will be taken over / consumed)</span></div>
<div class="line"><span class="lineno">  428</span>        slc = y[..., i, :]</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>        js = rng_integers(rng2, 0, shape[-1], shape[-1])</div>
<div class="line"><span class="lineno">  431</span>        expected = x[..., js]</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>        <span class="keyword">assert</span> np.array_equal(slc, expected)</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span><span class="preprocessor">@pytest.mark.parametrize(&quot;score&quot;, [0, 0.5, 1])</span></div>
<div class="line"><span class="lineno">  437</span><span class="preprocessor">@pytest.mark.parametrize(&quot;axis&quot;, [0, 1, 2])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a51d660403312636cc6531dc3ac6819a2" name="a51d660403312636cc6531dc3ac6819a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d660403312636cc6531dc3ac6819a2">&#9670;&#160;</a></span>test_bootstrap_vectorized()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_vectorized </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>paired</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  123</span><span class="keyword">def </span>test_bootstrap_vectorized(method, axis, paired):</div>
<div class="line"><span class="lineno">  124</span>    <span class="comment"># test that paired is vectorized as expected: when samples are tiled,</span></div>
<div class="line"><span class="lineno">  125</span>    <span class="comment"># CI and standard_error of each axis-slice is the same as those of the</span></div>
<div class="line"><span class="lineno">  126</span>    <span class="comment"># original 1d sample</span></div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> paired <span class="keywordflow">and</span> method == <span class="stringliteral">&#39;BCa&#39;</span>:</div>
<div class="line"><span class="lineno">  129</span>        <span class="comment"># should re-assess when BCa is extended</span></div>
<div class="line"><span class="lineno">  130</span>        pytest.xfail(reason=<span class="stringliteral">&quot;BCa currently for 1-sample statistics only&quot;</span>)</div>
<div class="line"><span class="lineno">  131</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>    <span class="keyword">def </span>my_statistic(x, y, z, axis=-1):</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">return</span> x.mean(axis=axis) + y.mean(axis=axis) + z.mean(axis=axis)</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    shape = 10, 11, 12</div>
<div class="line"><span class="lineno">  137</span>    n_samples = shape[axis]</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    x = np.random.rand(n_samples)</div>
<div class="line"><span class="lineno">  140</span>    y = np.random.rand(n_samples)</div>
<div class="line"><span class="lineno">  141</span>    z = np.random.rand(n_samples)</div>
<div class="line"><span class="lineno">  142</span>    res1 = bootstrap((x, y, z), my_statistic, paired=paired, method=method,</div>
<div class="line"><span class="lineno">  143</span>                     random_state=0, axis=0, n_resamples=100)</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    reshape = [1, 1, 1]</div>
<div class="line"><span class="lineno">  146</span>    reshape[axis] = n_samples</div>
<div class="line"><span class="lineno">  147</span>    x = np.broadcast_to(x.reshape(reshape), shape)</div>
<div class="line"><span class="lineno">  148</span>    y = np.broadcast_to(y.reshape(reshape), shape)</div>
<div class="line"><span class="lineno">  149</span>    z = np.broadcast_to(z.reshape(reshape), shape)</div>
<div class="line"><span class="lineno">  150</span>    res2 = bootstrap((x, y, z), my_statistic, paired=paired, method=method,</div>
<div class="line"><span class="lineno">  151</span>                     random_state=0, axis=axis, n_resamples=100)</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    assert_allclose(res2.confidence_interval.low,</div>
<div class="line"><span class="lineno">  154</span>                    res1.confidence_interval.low)</div>
<div class="line"><span class="lineno">  155</span>    assert_allclose(res2.confidence_interval.high,</div>
<div class="line"><span class="lineno">  156</span>                    res1.confidence_interval.high)</div>
<div class="line"><span class="lineno">  157</span>    assert_allclose(res2.standard_error, res1.standard_error)</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>    result_shape = list(shape)</div>
<div class="line"><span class="lineno">  160</span>    result_shape.pop(axis)</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    assert_equal(res2.confidence_interval.low.shape, result_shape)</div>
<div class="line"><span class="lineno">  163</span>    assert_equal(res2.confidence_interval.high.shape, result_shape)</div>
<div class="line"><span class="lineno">  164</span>    assert_equal(res2.standard_error.shape, result_shape)</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&#39;basic&#39;, &#39;percentile&#39;, &#39;BCa&#39;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aad3cdff4968af81f4086cbb178a8a4da" name="aad3cdff4968af81f4086cbb178a8a4da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad3cdff4968af81f4086cbb178a8a4da">&#9670;&#160;</a></span>test_bootstrap_vectorized_1samp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_vectorized_1samp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  336</span><span class="keyword">def </span>test_bootstrap_vectorized_1samp(method, axis):</div>
<div class="line"><span class="lineno">  337</span>    <span class="keyword">def </span>statistic(x, axis=0):</div>
<div class="line"><span class="lineno">  338</span>        <span class="comment"># an arbitrary, vectorized statistic</span></div>
<div class="line"><span class="lineno">  339</span>        <span class="keywordflow">return</span> x.mean(axis=axis)</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <span class="keyword">def </span>statistic_1d(x):</div>
<div class="line"><span class="lineno">  342</span>        <span class="comment"># the same statistic, not vectorized</span></div>
<div class="line"><span class="lineno">  343</span>        <span class="keyword">assert</span> x.ndim == 1</div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">return</span> statistic(x, axis=0)</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  347</span>    x = np.random.rand(4, 5)</div>
<div class="line"><span class="lineno">  348</span>    res1 = bootstrap((x,), statistic, vectorized=<span class="keyword">True</span>, axis=axis,</div>
<div class="line"><span class="lineno">  349</span>                     n_resamples=100, batch=<span class="keywordtype">None</span>, method=method,</div>
<div class="line"><span class="lineno">  350</span>                     random_state=0)</div>
<div class="line"><span class="lineno">  351</span>    res2 = bootstrap((x,), statistic_1d, vectorized=<span class="keyword">False</span>, axis=axis,</div>
<div class="line"><span class="lineno">  352</span>                     n_resamples=100, batch=10, method=method,</div>
<div class="line"><span class="lineno">  353</span>                     random_state=0)</div>
<div class="line"><span class="lineno">  354</span>    assert_allclose(res1.confidence_interval, res2.confidence_interval)</div>
<div class="line"><span class="lineno">  355</span>    assert_allclose(res1.standard_error, res2.standard_error)</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;basic&quot;, &quot;percentile&quot;, &quot;BCa&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc43daaff9befaf19da8fb552ffb40a4" name="afc43daaff9befaf19da8fb552ffb40a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc43daaff9befaf19da8fb552ffb40a4">&#9670;&#160;</a></span>test_bootstrap_vectorized_3samp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_bootstrap_vectorized_3samp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  310</span><span class="keyword">def </span>test_bootstrap_vectorized_3samp(method, axis):</div>
<div class="line"><span class="lineno">  311</span>    <span class="keyword">def </span>statistic(*data, axis=0):</div>
<div class="line"><span class="lineno">  312</span>        <span class="comment"># an arbitrary, vectorized statistic</span></div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">return</span> sum((sample.mean(axis) <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> data))</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    <span class="keyword">def </span>statistic_1d(*data):</div>
<div class="line"><span class="lineno">  316</span>        <span class="comment"># the same statistic, not vectorized</span></div>
<div class="line"><span class="lineno">  317</span>        <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> data:</div>
<div class="line"><span class="lineno">  318</span>            <span class="keyword">assert</span> sample.ndim == 1</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">return</span> statistic(*data, axis=0)</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  322</span>    x = np.random.rand(4, 5)</div>
<div class="line"><span class="lineno">  323</span>    y = np.random.rand(4, 5)</div>
<div class="line"><span class="lineno">  324</span>    z = np.random.rand(4, 5)</div>
<div class="line"><span class="lineno">  325</span>    res1 = bootstrap((x, y, z), statistic, vectorized=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  326</span>                     axis=axis, n_resamples=100, method=method, random_state=0)</div>
<div class="line"><span class="lineno">  327</span>    res2 = bootstrap((x, y, z), statistic_1d, vectorized=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  328</span>                     axis=axis, n_resamples=100, method=method, random_state=0)</div>
<div class="line"><span class="lineno">  329</span>    assert_allclose(res1.confidence_interval, res2.confidence_interval)</div>
<div class="line"><span class="lineno">  330</span>    assert_allclose(res1.standard_error, res2.standard_error)</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span><span class="preprocessor">@pytest.mark.xfail_on_32bit(&quot;Failure is not concerning; see gh-14107&quot;)</span></div>
<div class="line"><span class="lineno">  334</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;basic&quot;, &quot;percentile&quot;, &quot;BCa&quot;])</span></div>
<div class="line"><span class="lineno">  335</span><span class="preprocessor">@pytest.mark.parametrize(&quot;axis&quot;, [0, 1])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c2227c79727bbc37dc7b0ff52122af1" name="a1c2227c79727bbc37dc7b0ff52122af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c2227c79727bbc37dc7b0ff52122af1">&#9670;&#160;</a></span>test_jackknife_resample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_jackknife_resample </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  391</span><span class="keyword">def </span>test_jackknife_resample():</div>
<div class="line"><span class="lineno">  392</span>    shape = 3, 4, 5, 6</div>
<div class="line"><span class="lineno">  393</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  394</span>    x = np.random.rand(*shape)</div>
<div class="line"><span class="lineno">  395</span>    y = next(_resampling._jackknife_resample(x))</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(shape[-1]):</div>
<div class="line"><span class="lineno">  398</span>        <span class="comment"># each resample is indexed along second to last axis</span></div>
<div class="line"><span class="lineno">  399</span>        <span class="comment"># (last axis is the one the statistic will be taken over / consumed)</span></div>
<div class="line"><span class="lineno">  400</span>        slc = y[..., i, :]</div>
<div class="line"><span class="lineno">  401</span>        expected = np.delete(x, i, axis=-1)</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>        <span class="keyword">assert</span> np.array_equal(slc, expected)</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>    y2 = np.concatenate(list(_resampling._jackknife_resample(x, batch=2)),</div>
<div class="line"><span class="lineno">  406</span>                        axis=-2)</div>
<div class="line"><span class="lineno">  407</span>    <span class="keyword">assert</span> np.array_equal(y2, y)</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span><span class="preprocessor">@pytest.mark.parametrize(&quot;rng_name&quot;, [&quot;RandomState&quot;, &quot;default_rng&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a475c4333879c7aa2500ed7ce30f71958" name="a475c4333879c7aa2500ed7ce30f71958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a475c4333879c7aa2500ed7ce30f71958">&#9670;&#160;</a></span>test_percentile_along_axis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_percentile_along_axis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  452</span><span class="keyword">def </span>test_percentile_along_axis():</div>
<div class="line"><span class="lineno">  453</span>    <span class="comment"># the difference between _percentile_along_axis and np.percentile is that</span></div>
<div class="line"><span class="lineno">  454</span>    <span class="comment"># np.percentile gets _all_ the qs for each axis slice, whereas</span></div>
<div class="line"><span class="lineno">  455</span>    <span class="comment"># _percentile_along_axis gets the q corresponding with each axis slice</span></div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    shape = 10, 20</div>
<div class="line"><span class="lineno">  458</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  459</span>    x = np.random.rand(*shape)</div>
<div class="line"><span class="lineno">  460</span>    q = np.random.rand(*shape[:-1]) * 100</div>
<div class="line"><span class="lineno">  461</span>    y = _resampling._percentile_along_axis(x, q)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(shape[0]):</div>
<div class="line"><span class="lineno">  464</span>        res = y[i]</div>
<div class="line"><span class="lineno">  465</span>        expected = np.percentile(x[i], q[i], axis=-1)</div>
<div class="line"><span class="lineno">  466</span>        assert_allclose(res, expected, 1e-15)</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span><span class="preprocessor">@pytest.mark.parametrize(&quot;axis&quot;, [0, 1, 2])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a02a676cac08afed725edc52a8f91566b" name="a02a676cac08afed725edc52a8f91566b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02a676cac08afed725edc52a8f91566b">&#9670;&#160;</a></span>test_percentile_of_score()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_percentile_of_score </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  438</span><span class="keyword">def </span>test_percentile_of_score(score, axis):</div>
<div class="line"><span class="lineno">  439</span>    shape = 10, 20, 30</div>
<div class="line"><span class="lineno">  440</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  441</span>    x = np.random.rand(*shape)</div>
<div class="line"><span class="lineno">  442</span>    p = _resampling._percentile_of_score(x, score, axis=-1)</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>    <span class="keyword">def </span>vectorized_pos(a, score, axis):</div>
<div class="line"><span class="lineno">  445</span>        <span class="keywordflow">return</span> np.apply_along_axis(stats.percentileofscore, axis, a, score)</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    p2 = vectorized_pos(x, score, axis=-1)/100</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    assert_allclose(p, p2, 1e-15)</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a44f3c6bf999acaeaf3847e565298c249" name="a44f3c6bf999acaeaf3847e565298c249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44f3c6bf999acaeaf3847e565298c249">&#9670;&#160;</a></span>test_vector_valued_statistic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_vector_valued_statistic </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  498</span><span class="keyword">def </span>test_vector_valued_statistic(method):</div>
<div class="line"><span class="lineno">  499</span>    <span class="comment"># Generate 95% confidence interval around MLE of normal distribution</span></div>
<div class="line"><span class="lineno">  500</span>    <span class="comment"># parameters. Repeat 100 times, each time on sample of size 100.</span></div>
<div class="line"><span class="lineno">  501</span>    <span class="comment"># Check that confidence interval contains true parameters ~95 times.</span></div>
<div class="line"><span class="lineno">  502</span>    <span class="comment"># Confidence intervals are estimated and stochastic; a test failure</span></div>
<div class="line"><span class="lineno">  503</span>    <span class="comment"># does not necessarily indicate that something is wrong. More important</span></div>
<div class="line"><span class="lineno">  504</span>    <span class="comment"># than values of `counts` below is that the shapes of the outputs are</span></div>
<div class="line"><span class="lineno">  505</span>    <span class="comment"># correct.</span></div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>    rng = np.random.default_rng(2196847219)</div>
<div class="line"><span class="lineno">  508</span>    params = 1, 0.5</div>
<div class="line"><span class="lineno">  509</span>    sample = stats.norm.rvs(*params, size=(100, 100), random_state=rng)</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>    <span class="keyword">def </span>statistic(data):</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">return</span> stats.norm.fit(data)</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    res = bootstrap((sample,), statistic, method=method, axis=-1,</div>
<div class="line"><span class="lineno">  515</span>                    vectorized=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    counts = np.sum((res.confidence_interval.low.T &lt; params)</div>
<div class="line"><span class="lineno">  518</span>                    &amp; (res.confidence_interval.high.T &gt; params),</div>
<div class="line"><span class="lineno">  519</span>                    axis=0)</div>
<div class="line"><span class="lineno">  520</span>    <span class="keyword">assert</span> np.all(counts &gt;= 90)</div>
<div class="line"><span class="lineno">  521</span>    <span class="keyword">assert</span> np.all(counts &lt;= 100)</div>
<div class="line"><span class="lineno">  522</span>    <span class="keyword">assert</span> res.confidence_interval.low.shape == (2, 100)</div>
<div class="line"><span class="lineno">  523</span>    <span class="keyword">assert</span> res.confidence_interval.high.shape == (2, 100)</div>
<div class="line"><span class="lineno">  524</span>    <span class="keyword">assert</span> res.standard_error.shape == (2, 100)</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span><span class="comment"># --- Test Monte Carlo Hypothesis Test --- #</span></div>
<div class="line"><span class="lineno">  528</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f1f66639139eda22c0b438783836bb5" name="a0f1f66639139eda22c0b438783836bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f1f66639139eda22c0b438783836bb5">&#9670;&#160;</a></span>test_vectorize_statistic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats.tests.test_resampling.test_vectorize_statistic </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  470</span><span class="keyword">def </span>test_vectorize_statistic(axis):</div>
<div class="line"><span class="lineno">  471</span>    <span class="comment"># test that _vectorize_statistic vectorizes a statistic along `axis`</span></div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    <span class="keyword">def </span>statistic(*data, axis):</div>
<div class="line"><span class="lineno">  474</span>        <span class="comment"># an arbitrary, vectorized statistic</span></div>
<div class="line"><span class="lineno">  475</span>        <span class="keywordflow">return</span> sum((sample.mean(axis) <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> data))</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    <span class="keyword">def </span>statistic_1d(*data):</div>
<div class="line"><span class="lineno">  478</span>        <span class="comment"># the same statistic, not vectorized</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> data:</div>
<div class="line"><span class="lineno">  480</span>            <span class="keyword">assert</span> sample.ndim == 1</div>
<div class="line"><span class="lineno">  481</span>        <span class="keywordflow">return</span> statistic(*data, axis=0)</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="comment"># vectorize the non-vectorized statistic</span></div>
<div class="line"><span class="lineno">  484</span>    statistic2 = _resampling._vectorize_statistic(statistic_1d)</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  487</span>    x = np.random.rand(4, 5, 6)</div>
<div class="line"><span class="lineno">  488</span>    y = np.random.rand(4, 1, 6)</div>
<div class="line"><span class="lineno">  489</span>    z = np.random.rand(1, 5, 6)</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    res1 = statistic(x, y, z, axis=axis)</div>
<div class="line"><span class="lineno">  492</span>    res2 = statistic2(x, y, z, axis=axis)</div>
<div class="line"><span class="lineno">  493</span>    assert_allclose(res1, res2)</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span><span class="preprocessor">@pytest.mark.xslow()</span></div>
<div class="line"><span class="lineno">  497</span><span class="preprocessor">@pytest.mark.parametrize(&quot;method&quot;, [&quot;basic&quot;, &quot;percentile&quot;, &quot;BCa&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="afce90938d9b43b639f5a241752310a84" name="afce90938d9b43b639f5a241752310a84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afce90938d9b43b639f5a241752310a84">&#9670;&#160;</a></span>tests_against_itself_1samp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.stats.tests.test_resampling.tests_against_itself_1samp</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {<span class="stringliteral">&quot;basic&quot;</span>: 1780,</div>
<div class="line"><span class="lineno">    2</span>                              <span class="stringliteral">&quot;percentile&quot;</span>: 1784,</div>
<div class="line"><span class="lineno">    3</span>                              <span class="stringliteral">&quot;BCa&quot;</span>: 1784}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a96449910872d0ea27abe83b43f7dfbf5" name="a96449910872d0ea27abe83b43f7dfbf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96449910872d0ea27abe83b43f7dfbf5">&#9670;&#160;</a></span>tests_against_itself_2samp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.stats.tests.test_resampling.tests_against_itself_2samp</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {<span class="stringliteral">&quot;basic&quot;</span>: 892,</div>
<div class="line"><span class="lineno">    2</span>                              <span class="stringliteral">&quot;percentile&quot;</span>: 890}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dbd1758265f8335a5331dbc30b51f41" name="a3dbd1758265f8335a5331dbc30b51f41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dbd1758265f8335a5331dbc30b51f41">&#9670;&#160;</a></span>tests_R</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.stats.tests.test_resampling.tests_R</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {<span class="stringliteral">&quot;basic&quot;</span>: (23.77, 79.12),</div>
<div class="line"><span class="lineno">    2</span>           <span class="stringliteral">&quot;percentile&quot;</span>: (28.86, 84.21),</div>
<div class="line"><span class="lineno">    3</span>           <span class="stringliteral">&quot;BCa&quot;</span>: (32.31, 91.43)}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
