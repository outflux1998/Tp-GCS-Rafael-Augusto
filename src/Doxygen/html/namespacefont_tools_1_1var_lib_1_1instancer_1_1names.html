<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: fontTools.varLib.instancer.names Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacefont_tools.html">fontTools</a></li><li class="navelem"><a class="el" href="namespacefont_tools_1_1var_lib.html">varLib</a></li><li class="navelem"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer.html">instancer</a></li><li class="navelem"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html">names</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">fontTools.varLib.instancer.names Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfont_tools_1_1var_lib_1_1instancer_1_1names_1_1_name_i_d.html">NameID</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5d53e8da590db5a6dc7a37cfc4ce239a" id="r_a5d53e8da590db5a6dc7a37cfc4ce239a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#a5d53e8da590db5a6dc7a37cfc4ce239a">getVariationNameIDs</a> (varfont)</td></tr>
<tr class="separator:a5d53e8da590db5a6dc7a37cfc4ce239a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2654cf9546f06c06aead1484735ef8d1" id="r_a2654cf9546f06c06aead1484735ef8d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#a2654cf9546f06c06aead1484735ef8d1">pruningUnusedNames</a> (varfont)</td></tr>
<tr class="separator:a2654cf9546f06c06aead1484735ef8d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac7a84a63b5435d043a049b9f7f305d9" id="r_aac7a84a63b5435d043a049b9f7f305d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#aac7a84a63b5435d043a049b9f7f305d9">updateNameTable</a> (varfont, axisLimits)</td></tr>
<tr class="separator:aac7a84a63b5435d043a049b9f7f305d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5acb1173e6f5d351037f4ff1d31e5e" id="r_acd5acb1173e6f5d351037f4ff1d31e5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#acd5acb1173e6f5d351037f4ff1d31e5e">checkAxisValuesExist</a> (stat, axisValues, axisCoords)</td></tr>
<tr class="separator:acd5acb1173e6f5d351037f4ff1d31e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbdf0135f0617ebd1d097241dc98ad24" id="r_abbdf0135f0617ebd1d097241dc98ad24"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#abbdf0135f0617ebd1d097241dc98ad24">_sortAxisValues</a> (axisValues)</td></tr>
<tr class="separator:abbdf0135f0617ebd1d097241dc98ad24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89e7e72c5ccddd171bfd172621b21f9c" id="r_a89e7e72c5ccddd171bfd172621b21f9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#a89e7e72c5ccddd171bfd172621b21f9c">_updateNameRecords</a> (varfont, axisValues)</td></tr>
<tr class="separator:a89e7e72c5ccddd171bfd172621b21f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab84fbfa230231182b4f2ad6e09e9a2ab" id="r_ab84fbfa230231182b4f2ad6e09e9a2ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#ab84fbfa230231182b4f2ad6e09e9a2ab">_isRibbi</a> (nametable, nameID)</td></tr>
<tr class="separator:ab84fbfa230231182b4f2ad6e09e9a2ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a3cb82e4976fb002b06b67c050e2712" id="r_a6a3cb82e4976fb002b06b67c050e2712"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#a6a3cb82e4976fb002b06b67c050e2712">_updateNameTableStyleRecords</a> (varfont, familyNameSuffix, subFamilyName, typoSubFamilyName, platformID=3, platEncID=1, langID=0x409)</td></tr>
<tr class="separator:a6a3cb82e4976fb002b06b67c050e2712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82899959ebae5631adaf49d9bd34d46" id="r_ab82899959ebae5631adaf49d9bd34d46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#ab82899959ebae5631adaf49d9bd34d46">_updatePSNameRecord</a> (varfont, familyName, styleName, platform)</td></tr>
<tr class="separator:ab82899959ebae5631adaf49d9bd34d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a806636746a149e138f9cfd6c21c03d26" id="r_a806636746a149e138f9cfd6c21c03d26"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#a806636746a149e138f9cfd6c21c03d26">_updateUniqueIdNameRecord</a> (varfont, nameIDs, platform)</td></tr>
<tr class="separator:a806636746a149e138f9cfd6c21c03d26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62575ba47623f668b5a27a49b36252af" id="r_a62575ba47623f668b5a27a49b36252af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#a62575ba47623f668b5a27a49b36252af">_fontVersion</a> (font, platform=(3, 1, 0x409))</td></tr>
<tr class="separator:a62575ba47623f668b5a27a49b36252af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aba4596e3f578f0d1c168d7f1f09638e6" id="r_aba4596e3f578f0d1c168d7f1f09638e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1var_lib_1_1instancer_1_1names.html#aba4596e3f578f0d1c168d7f1f09638e6">ELIDABLE_AXIS_VALUE_NAME</a> = 2</td></tr>
<tr class="separator:aba4596e3f578f0d1c168d7f1f09638e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Helpers for instantiating name table records.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a62575ba47623f668b5a27a49b36252af" name="a62575ba47623f668b5a27a49b36252af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62575ba47623f668b5a27a49b36252af">&#9670;&#160;</a></span>_fontVersion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names._fontVersion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>font</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>platform</em> = <code>(3,&#160;1,&#160;0x409)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  373</span><span class="keyword">def </span>_fontVersion(font, platform=(3, 1, 0x409)):</div>
<div class="line"><span class="lineno">  374</span>    nameRecord = font[<span class="stringliteral">&quot;name&quot;</span>].getName(NameID.VERSION_STRING, *platform)</div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">if</span> nameRecord <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  376</span>        <span class="keywordflow">return</span> f<span class="stringliteral">&#39;{font[&quot;head&quot;].fontRevision:.3f}&#39;</span></div>
<div class="line"><span class="lineno">  377</span>    <span class="comment"># &quot;Version 1.101; ttfautohint (v1.8.1.43-b0c9)&quot; --&gt; &quot;1.101&quot;</span></div>
<div class="line"><span class="lineno">  378</span>    <span class="comment"># Also works fine with inputs &quot;Version 1.101&quot; or &quot;1.101&quot; etc</span></div>
<div class="line"><span class="lineno">  379</span>    versionNumber = nameRecord.toUnicode().split(<span class="stringliteral">&quot;;&quot;</span>)[0]</div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">return</span> versionNumber.lstrip(<span class="stringliteral">&quot;Version &quot;</span>).strip()</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab84fbfa230231182b4f2ad6e09e9a2ab" name="ab84fbfa230231182b4f2ad6e09e9a2ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab84fbfa230231182b4f2ad6e09e9a2ab">&#9670;&#160;</a></span>_isRibbi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names._isRibbi </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nametable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nameID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  243</span><span class="keyword">def </span>_isRibbi(nametable, nameID):</div>
<div class="line"><span class="lineno">  244</span>    englishRecord = nametable.getName(nameID, 3, 1, 0x409)</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  246</span>        <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">if</span> englishRecord <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  248</span>        <span class="keywordflow">and</span> englishRecord.toUnicode() <span class="keywordflow">in</span> (<span class="stringliteral">&quot;Regular&quot;</span>, <span class="stringliteral">&quot;Italic&quot;</span>, <span class="stringliteral">&quot;Bold&quot;</span>, <span class="stringliteral">&quot;Bold Italic&quot;</span>)</div>
<div class="line"><span class="lineno">  249</span>        <span class="keywordflow">else</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  250</span>    )</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abbdf0135f0617ebd1d097241dc98ad24" name="abbdf0135f0617ebd1d097241dc98ad24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbdf0135f0617ebd1d097241dc98ad24">&#9670;&#160;</a></span>_sortAxisValues()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names._sortAxisValues </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisValues</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  159</span><span class="keyword">def </span>_sortAxisValues(axisValues):</div>
<div class="line"><span class="lineno">  160</span>    <span class="comment"># Sort by axis index, remove duplicates and ensure that format 4 AxisValues</span></div>
<div class="line"><span class="lineno">  161</span>    <span class="comment"># are dominant.</span></div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># The MS Spec states: &quot;if a format 1, format 2 or format 3 table has a</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="comment"># (nominal) value used in a format 4 table that also has values for</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="comment"># other axes, the format 4 table, being the more specific match, is used&quot;,</span></div>
<div class="line"><span class="lineno">  165</span>    <span class="comment"># https://docs.microsoft.com/en-us/typography/opentype/spec/stat#axis-value-table-format-4</span></div>
<div class="line"><span class="lineno">  166</span>    results = []</div>
<div class="line"><span class="lineno">  167</span>    seenAxes = set()</div>
<div class="line"><span class="lineno">  168</span>    <span class="comment"># Sort format 4 axes so the tables with the most AxisValueRecords are first</span></div>
<div class="line"><span class="lineno">  169</span>    format4 = sorted(</div>
<div class="line"><span class="lineno">  170</span>        [v <span class="keywordflow">for</span> v <span class="keywordflow">in</span> axisValues <span class="keywordflow">if</span> v.Format == 4],</div>
<div class="line"><span class="lineno">  171</span>        key=<span class="keyword">lambda</span> v: len(v.AxisValueRecord),</div>
<div class="line"><span class="lineno">  172</span>        reverse=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  173</span>    )</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">for</span> val <span class="keywordflow">in</span> format4:</div>
<div class="line"><span class="lineno">  176</span>        axisIndexes = set(r.AxisIndex <span class="keywordflow">for</span> r <span class="keywordflow">in</span> val.AxisValueRecord)</div>
<div class="line"><span class="lineno">  177</span>        minIndex = min(axisIndexes)</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> seenAxes &amp; axisIndexes:</div>
<div class="line"><span class="lineno">  179</span>            seenAxes |= axisIndexes</div>
<div class="line"><span class="lineno">  180</span>            results.append((minIndex, val))</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">for</span> val <span class="keywordflow">in</span> axisValues:</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">if</span> val <span class="keywordflow">in</span> format4:</div>
<div class="line"><span class="lineno">  184</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  185</span>        axisIndex = val.AxisIndex</div>
<div class="line"><span class="lineno">  186</span>        <span class="keywordflow">if</span> axisIndex <span class="keywordflow">not</span> <span class="keywordflow">in</span> seenAxes:</div>
<div class="line"><span class="lineno">  187</span>            seenAxes.add(axisIndex)</div>
<div class="line"><span class="lineno">  188</span>            results.append((axisIndex, val))</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">return</span> [axisValue <span class="keywordflow">for</span> _, axisValue <span class="keywordflow">in</span> sorted(results)]</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a89e7e72c5ccddd171bfd172621b21f9c" name="a89e7e72c5ccddd171bfd172621b21f9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89e7e72c5ccddd171bfd172621b21f9c">&#9670;&#160;</a></span>_updateNameRecords()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names._updateNameRecords </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>varfont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisValues</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  193</span><span class="keyword">def </span>_updateNameRecords(varfont, axisValues):</div>
<div class="line"><span class="lineno">  194</span>    <span class="comment"># Update nametable based on the axisValues using the R/I/B/BI model.</span></div>
<div class="line"><span class="lineno">  195</span>    nametable = varfont[<span class="stringliteral">&quot;name&quot;</span>]</div>
<div class="line"><span class="lineno">  196</span>    stat = varfont[<span class="stringliteral">&quot;STAT&quot;</span>].table</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    axisValueNameIDs = [a.ValueNameID <span class="keywordflow">for</span> a <span class="keywordflow">in</span> axisValues]</div>
<div class="line"><span class="lineno">  199</span>    ribbiNameIDs = [n <span class="keywordflow">for</span> n <span class="keywordflow">in</span> axisValueNameIDs <span class="keywordflow">if</span> _isRibbi(nametable, n)]</div>
<div class="line"><span class="lineno">  200</span>    nonRibbiNameIDs = [n <span class="keywordflow">for</span> n <span class="keywordflow">in</span> axisValueNameIDs <span class="keywordflow">if</span> n <span class="keywordflow">not</span> <span class="keywordflow">in</span> ribbiNameIDs]</div>
<div class="line"><span class="lineno">  201</span>    elidedNameID = stat.ElidedFallbackNameID</div>
<div class="line"><span class="lineno">  202</span>    elidedNameIsRibbi = _isRibbi(nametable, elidedNameID)</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    getName = nametable.getName</div>
<div class="line"><span class="lineno">  205</span>    platforms = set((r.platformID, r.platEncID, r.langID) <span class="keywordflow">for</span> r <span class="keywordflow">in</span> nametable.names)</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">for</span> platform <span class="keywordflow">in</span> platforms:</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> all(getName(i, *platform) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> (1, 2, elidedNameID)):</div>
<div class="line"><span class="lineno">  208</span>            <span class="comment"># Since no family name and subfamily name records were found,</span></div>
<div class="line"><span class="lineno">  209</span>            <span class="comment"># we cannot update this set of name Records.</span></div>
<div class="line"><span class="lineno">  210</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>        subFamilyName = <span class="stringliteral">&quot; &quot;</span>.join(</div>
<div class="line"><span class="lineno">  213</span>            getName(n, *platform).toUnicode() <span class="keywordflow">for</span> n <span class="keywordflow">in</span> ribbiNameIDs</div>
<div class="line"><span class="lineno">  214</span>        )</div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">if</span> nonRibbiNameIDs:</div>
<div class="line"><span class="lineno">  216</span>            typoSubFamilyName = <span class="stringliteral">&quot; &quot;</span>.join(</div>
<div class="line"><span class="lineno">  217</span>                getName(n, *platform).toUnicode() <span class="keywordflow">for</span> n <span class="keywordflow">in</span> axisValueNameIDs</div>
<div class="line"><span class="lineno">  218</span>            )</div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  220</span>            typoSubFamilyName = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>        <span class="comment"># If neither subFamilyName and typographic SubFamilyName exist,</span></div>
<div class="line"><span class="lineno">  223</span>        <span class="comment"># we will use the STAT&#39;s elidedFallbackName</span></div>
<div class="line"><span class="lineno">  224</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> typoSubFamilyName <span class="keywordflow">and</span> <span class="keywordflow">not</span> subFamilyName:</div>
<div class="line"><span class="lineno">  225</span>            <span class="keywordflow">if</span> elidedNameIsRibbi:</div>
<div class="line"><span class="lineno">  226</span>                subFamilyName = getName(elidedNameID, *platform).toUnicode()</div>
<div class="line"><span class="lineno">  227</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  228</span>                typoSubFamilyName = getName(elidedNameID, *platform).toUnicode()</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>        familyNameSuffix = <span class="stringliteral">&quot; &quot;</span>.join(</div>
<div class="line"><span class="lineno">  231</span>            getName(n, *platform).toUnicode() <span class="keywordflow">for</span> n <span class="keywordflow">in</span> nonRibbiNameIDs</div>
<div class="line"><span class="lineno">  232</span>        )</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>        _updateNameTableStyleRecords(</div>
<div class="line"><span class="lineno">  235</span>            varfont,</div>
<div class="line"><span class="lineno">  236</span>            familyNameSuffix,</div>
<div class="line"><span class="lineno">  237</span>            subFamilyName,</div>
<div class="line"><span class="lineno">  238</span>            typoSubFamilyName,</div>
<div class="line"><span class="lineno">  239</span>            *platform,</div>
<div class="line"><span class="lineno">  240</span>        )</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a3cb82e4976fb002b06b67c050e2712" name="a6a3cb82e4976fb002b06b67c050e2712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a3cb82e4976fb002b06b67c050e2712">&#9670;&#160;</a></span>_updateNameTableStyleRecords()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names._updateNameTableStyleRecords </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>varfont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>familyNameSuffix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>subFamilyName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>typoSubFamilyName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>platformID</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>platEncID</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>langID</em> = <code>0x409</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  261</span>):</div>
<div class="line"><span class="lineno">  262</span>    <span class="comment"># TODO (Marc F) It may be nice to make this part a standalone</span></div>
<div class="line"><span class="lineno">  263</span>    <span class="comment"># font renamer in the future.</span></div>
<div class="line"><span class="lineno">  264</span>    nametable = varfont[<span class="stringliteral">&quot;name&quot;</span>]</div>
<div class="line"><span class="lineno">  265</span>    platform = (platformID, platEncID, langID)</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>    currentFamilyName = nametable.getName(</div>
<div class="line"><span class="lineno">  268</span>        NameID.TYPOGRAPHIC_FAMILY_NAME, *platform</div>
<div class="line"><span class="lineno">  269</span>    ) <span class="keywordflow">or</span> nametable.getName(NameID.FAMILY_NAME, *platform)</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>    currentStyleName = nametable.getName(</div>
<div class="line"><span class="lineno">  272</span>        NameID.TYPOGRAPHIC_SUBFAMILY_NAME, *platform</div>
<div class="line"><span class="lineno">  273</span>    ) <span class="keywordflow">or</span> nametable.getName(NameID.SUBFAMILY_NAME, *platform)</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> all([currentFamilyName, currentStyleName]):</div>
<div class="line"><span class="lineno">  276</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Missing required NameIDs 1 and 2 for platform {platform}&quot;</span>)</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>    currentFamilyName = currentFamilyName.toUnicode()</div>
<div class="line"><span class="lineno">  279</span>    currentStyleName = currentStyleName.toUnicode()</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    nameIDs = {</div>
<div class="line"><span class="lineno">  282</span>        NameID.FAMILY_NAME: currentFamilyName,</div>
<div class="line"><span class="lineno">  283</span>        NameID.SUBFAMILY_NAME: subFamilyName <span class="keywordflow">or</span> <span class="stringliteral">&quot;Regular&quot;</span>,</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">if</span> typoSubFamilyName:</div>
<div class="line"><span class="lineno">  286</span>        nameIDs[NameID.FAMILY_NAME] = f<span class="stringliteral">&quot;{currentFamilyName} {familyNameSuffix}&quot;</span>.strip()</div>
<div class="line"><span class="lineno">  287</span>        nameIDs[NameID.TYPOGRAPHIC_FAMILY_NAME] = currentFamilyName</div>
<div class="line"><span class="lineno">  288</span>        nameIDs[NameID.TYPOGRAPHIC_SUBFAMILY_NAME] = typoSubFamilyName</div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  290</span>        <span class="comment"># Remove previous Typographic Family and SubFamily names since they&#39;re</span></div>
<div class="line"><span class="lineno">  291</span>        <span class="comment"># no longer required</span></div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">for</span> nameID <span class="keywordflow">in</span> (</div>
<div class="line"><span class="lineno">  293</span>            NameID.TYPOGRAPHIC_FAMILY_NAME,</div>
<div class="line"><span class="lineno">  294</span>            NameID.TYPOGRAPHIC_SUBFAMILY_NAME,</div>
<div class="line"><span class="lineno">  295</span>        ):</div>
<div class="line"><span class="lineno">  296</span>            nametable.removeNames(nameID=nameID)</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    newFamilyName = (</div>
<div class="line"><span class="lineno">  299</span>        nameIDs.get(NameID.TYPOGRAPHIC_FAMILY_NAME) <span class="keywordflow">or</span> nameIDs[NameID.FAMILY_NAME]</div>
<div class="line"><span class="lineno">  300</span>    )</div>
<div class="line"><span class="lineno">  301</span>    newStyleName = (</div>
<div class="line"><span class="lineno">  302</span>        nameIDs.get(NameID.TYPOGRAPHIC_SUBFAMILY_NAME) <span class="keywordflow">or</span> nameIDs[NameID.SUBFAMILY_NAME]</div>
<div class="line"><span class="lineno">  303</span>    )</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>    nameIDs[NameID.FULL_FONT_NAME] = f<span class="stringliteral">&quot;{newFamilyName} {newStyleName}&quot;</span></div>
<div class="line"><span class="lineno">  306</span>    nameIDs[NameID.POSTSCRIPT_NAME] = _updatePSNameRecord(</div>
<div class="line"><span class="lineno">  307</span>        varfont, newFamilyName, newStyleName, platform</div>
<div class="line"><span class="lineno">  308</span>    )</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    uniqueID = _updateUniqueIdNameRecord(varfont, nameIDs, platform)</div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordflow">if</span> uniqueID:</div>
<div class="line"><span class="lineno">  312</span>        nameIDs[NameID.UNIQUE_FONT_IDENTIFIER] = uniqueID</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">for</span> nameID, string <span class="keywordflow">in</span> nameIDs.items():</div>
<div class="line"><span class="lineno">  315</span>        <span class="keyword">assert</span> string, nameID</div>
<div class="line"><span class="lineno">  316</span>        nametable.setName(string, nameID, *platform)</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;fvar&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> varfont:</div>
<div class="line"><span class="lineno">  319</span>        nametable.removeNames(NameID.VARIATIONS_POSTSCRIPT_NAME_PREFIX)</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab82899959ebae5631adaf49d9bd34d46" name="ab82899959ebae5631adaf49d9bd34d46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab82899959ebae5631adaf49d9bd34d46">&#9670;&#160;</a></span>_updatePSNameRecord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names._updatePSNameRecord </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>varfont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>familyName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>styleName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>platform</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  322</span><span class="keyword">def </span>_updatePSNameRecord(varfont, familyName, styleName, platform):</div>
<div class="line"><span class="lineno">  323</span>    <span class="comment"># Implementation based on Adobe Technical Note #5902 :</span></div>
<div class="line"><span class="lineno">  324</span>    <span class="comment"># https://wwwimages2.adobe.com/content/dam/acom/en/devnet/font/pdfs/5902.AdobePSNameGeneration.pdf</span></div>
<div class="line"><span class="lineno">  325</span>    nametable = varfont[<span class="stringliteral">&quot;name&quot;</span>]</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    family_prefix = nametable.getName(</div>
<div class="line"><span class="lineno">  328</span>        NameID.VARIATIONS_POSTSCRIPT_NAME_PREFIX, *platform</div>
<div class="line"><span class="lineno">  329</span>    )</div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">if</span> family_prefix:</div>
<div class="line"><span class="lineno">  331</span>        family_prefix = family_prefix.toUnicode()</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  333</span>        family_prefix = familyName</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    psName = f<span class="stringliteral">&quot;{family_prefix}-{styleName}&quot;</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="comment"># Remove any characters other than uppercase Latin letters, lowercase</span></div>
<div class="line"><span class="lineno">  337</span>    <span class="comment"># Latin letters, digits and hyphens.</span></div>
<div class="line"><span class="lineno">  338</span>    psName = re.sub(<span class="stringliteral">r&quot;[^A-Za-z0-9-]&quot;</span>, <span class="stringliteral">r&quot;&quot;</span>, psName)</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">if</span> len(psName) &gt; 127:</div>
<div class="line"><span class="lineno">  341</span>        <span class="comment"># Abbreviating the stylename so it fits within 127 characters whilst</span></div>
<div class="line"><span class="lineno">  342</span>        <span class="comment"># conforming to every vendor&#39;s specification is too complex. Instead</span></div>
<div class="line"><span class="lineno">  343</span>        <span class="comment"># we simply truncate the psname and add the required &quot;...&quot;</span></div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">return</span> f<span class="stringliteral">&quot;{psName[:124]}...&quot;</span></div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">return</span> psName</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a806636746a149e138f9cfd6c21c03d26" name="a806636746a149e138f9cfd6c21c03d26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a806636746a149e138f9cfd6c21c03d26">&#9670;&#160;</a></span>_updateUniqueIdNameRecord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names._updateUniqueIdNameRecord </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>varfont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nameIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>platform</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  348</span><span class="keyword">def </span>_updateUniqueIdNameRecord(varfont, nameIDs, platform):</div>
<div class="line"><span class="lineno">  349</span>    nametable = varfont[<span class="stringliteral">&quot;name&quot;</span>]</div>
<div class="line"><span class="lineno">  350</span>    currentRecord = nametable.getName(NameID.UNIQUE_FONT_IDENTIFIER, *platform)</div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> currentRecord:</div>
<div class="line"><span class="lineno">  352</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="comment"># Check if full name and postscript name are a substring of currentRecord</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">for</span> nameID <span class="keywordflow">in</span> (NameID.FULL_FONT_NAME, NameID.POSTSCRIPT_NAME):</div>
<div class="line"><span class="lineno">  356</span>        nameRecord = nametable.getName(nameID, *platform)</div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> nameRecord:</div>
<div class="line"><span class="lineno">  358</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  359</span>        <span class="keywordflow">if</span> nameRecord.toUnicode() <span class="keywordflow">in</span> currentRecord.toUnicode():</div>
<div class="line"><span class="lineno">  360</span>            <span class="keywordflow">return</span> currentRecord.toUnicode().replace(</div>
<div class="line"><span class="lineno">  361</span>                nameRecord.toUnicode(), nameIDs[nameRecord.nameID]</div>
<div class="line"><span class="lineno">  362</span>            )</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>    <span class="comment"># Create a new string since we couldn&#39;t find any substrings.</span></div>
<div class="line"><span class="lineno">  365</span>    fontVersion = _fontVersion(varfont, platform)</div>
<div class="line"><span class="lineno">  366</span>    achVendID = varfont[<span class="stringliteral">&quot;OS/2&quot;</span>].achVendID</div>
<div class="line"><span class="lineno">  367</span>    <span class="comment"># Remove non-ASCII characers and trailing spaces</span></div>
<div class="line"><span class="lineno">  368</span>    vendor = re.sub(<span class="stringliteral">r&quot;[^\x00-\x7F]&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, achVendID).strip()</div>
<div class="line"><span class="lineno">  369</span>    psName = nameIDs[NameID.POSTSCRIPT_NAME]</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">return</span> f<span class="stringliteral">&quot;{fontVersion};{vendor};{psName}&quot;</span></div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acd5acb1173e6f5d351037f4ff1d31e5e" name="acd5acb1173e6f5d351037f4ff1d31e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5acb1173e6f5d351037f4ff1d31e5e">&#9670;&#160;</a></span>checkAxisValuesExist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names.checkAxisValuesExist </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisCoords</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  134</span><span class="keyword">def </span>checkAxisValuesExist(stat, axisValues, axisCoords):</div>
<div class="line"><span class="lineno">  135</span>    seen = set()</div>
<div class="line"><span class="lineno">  136</span>    designAxes = stat.DesignAxisRecord.Axis</div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">for</span> axisValueTable <span class="keywordflow">in</span> axisValues:</div>
<div class="line"><span class="lineno">  138</span>        axisValueFormat = axisValueTable.Format</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">if</span> axisValueTable.Format <span class="keywordflow">in</span> (1, 2, 3):</div>
<div class="line"><span class="lineno">  140</span>            axisTag = designAxes[axisValueTable.AxisIndex].AxisTag</div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">if</span> axisValueFormat == 2:</div>
<div class="line"><span class="lineno">  142</span>                axisValue = axisValueTable.NominalValue</div>
<div class="line"><span class="lineno">  143</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  144</span>                axisValue = axisValueTable.Value</div>
<div class="line"><span class="lineno">  145</span>            <span class="keywordflow">if</span> axisTag <span class="keywordflow">in</span> axisCoords <span class="keywordflow">and</span> axisValue == axisCoords[axisTag]:</div>
<div class="line"><span class="lineno">  146</span>                seen.add(axisTag)</div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">elif</span> axisValueTable.Format == 4:</div>
<div class="line"><span class="lineno">  148</span>            <span class="keywordflow">for</span> rec <span class="keywordflow">in</span> axisValueTable.AxisValueRecord:</div>
<div class="line"><span class="lineno">  149</span>                axisTag = designAxes[rec.AxisIndex].AxisTag</div>
<div class="line"><span class="lineno">  150</span>                <span class="keywordflow">if</span> axisTag <span class="keywordflow">in</span> axisCoords <span class="keywordflow">and</span> rec.Value == axisCoords[axisTag]:</div>
<div class="line"><span class="lineno">  151</span>                    seen.add(axisTag)</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    missingAxes = set(axisCoords) - seen</div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">if</span> missingAxes:</div>
<div class="line"><span class="lineno">  155</span>        missing = <span class="stringliteral">&quot;, &quot;</span>.join(f<span class="stringliteral">&quot;&#39;{i}&#39;: {axisCoords[i]}&quot;</span> <span class="keywordflow">for</span> i <span class="keywordflow">in</span> missingAxes)</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Cannot find Axis Values {{{missing}}}&quot;</span>)</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d53e8da590db5a6dc7a37cfc4ce239a" name="a5d53e8da590db5a6dc7a37cfc4ce239a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d53e8da590db5a6dc7a37cfc4ce239a">&#9670;&#160;</a></span>getVariationNameIDs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names.getVariationNameIDs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>varfont</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   24</span><span class="keyword">def </span>getVariationNameIDs(varfont):</div>
<div class="line"><span class="lineno">   25</span>    used = []</div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;fvar&quot;</span> <span class="keywordflow">in</span> varfont:</div>
<div class="line"><span class="lineno">   27</span>        fvar = varfont[<span class="stringliteral">&quot;fvar&quot;</span>]</div>
<div class="line"><span class="lineno">   28</span>        <span class="keywordflow">for</span> axis <span class="keywordflow">in</span> fvar.axes:</div>
<div class="line"><span class="lineno">   29</span>            used.append(axis.axisNameID)</div>
<div class="line"><span class="lineno">   30</span>        <span class="keywordflow">for</span> instance <span class="keywordflow">in</span> fvar.instances:</div>
<div class="line"><span class="lineno">   31</span>            used.append(instance.subfamilyNameID)</div>
<div class="line"><span class="lineno">   32</span>            <span class="keywordflow">if</span> instance.postscriptNameID != 0xFFFF:</div>
<div class="line"><span class="lineno">   33</span>                used.append(instance.postscriptNameID)</div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;STAT&quot;</span> <span class="keywordflow">in</span> varfont:</div>
<div class="line"><span class="lineno">   35</span>        stat = varfont[<span class="stringliteral">&quot;STAT&quot;</span>].table</div>
<div class="line"><span class="lineno">   36</span>        <span class="keywordflow">for</span> axis <span class="keywordflow">in</span> stat.DesignAxisRecord.Axis <span class="keywordflow">if</span> stat.DesignAxisRecord <span class="keywordflow">else</span> ():</div>
<div class="line"><span class="lineno">   37</span>            used.append(axis.AxisNameID)</div>
<div class="line"><span class="lineno">   38</span>        <span class="keywordflow">for</span> value <span class="keywordflow">in</span> stat.AxisValueArray.AxisValue <span class="keywordflow">if</span> stat.AxisValueArray <span class="keywordflow">else</span> ():</div>
<div class="line"><span class="lineno">   39</span>            used.append(value.ValueNameID)</div>
<div class="line"><span class="lineno">   40</span>        elidedFallbackNameID = getattr(stat, <span class="stringliteral">&quot;ElidedFallbackNameID&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">   41</span>        <span class="keywordflow">if</span> elidedFallbackNameID <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   42</span>            used.append(elidedFallbackNameID)</div>
<div class="line"><span class="lineno">   43</span>    <span class="comment"># nameIDs &lt;= 255 are reserved by OT spec so we don&#39;t touch them</span></div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">return</span> {nameID <span class="keywordflow">for</span> nameID <span class="keywordflow">in</span> used <span class="keywordflow">if</span> nameID &gt; 255}</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span><span class="preprocessor">@contextmanager</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2654cf9546f06c06aead1484735ef8d1" name="a2654cf9546f06c06aead1484735ef8d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2654cf9546f06c06aead1484735ef8d1">&#9670;&#160;</a></span>pruningUnusedNames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names.pruningUnusedNames </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>varfont</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   48</span><span class="keyword">def </span>pruningUnusedNames(varfont):</div>
<div class="line"><span class="lineno">   49</span>    <span class="keyword">from</span> . <span class="keyword">import</span> log</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    origNameIDs = getVariationNameIDs(varfont)</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordflow">yield</span></div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    log.info(<span class="stringliteral">&quot;Pruning name table&quot;</span>)</div>
<div class="line"><span class="lineno">   56</span>    exclude = origNameIDs - getVariationNameIDs(varfont)</div>
<div class="line"><span class="lineno">   57</span>    varfont[<span class="stringliteral">&quot;name&quot;</span>].names[:] = [</div>
<div class="line"><span class="lineno">   58</span>        record <span class="keywordflow">for</span> record <span class="keywordflow">in</span> varfont[<span class="stringliteral">&quot;name&quot;</span>].names <span class="keywordflow">if</span> record.nameID <span class="keywordflow">not</span> <span class="keywordflow">in</span> exclude</div>
<div class="line"><span class="lineno">   59</span>    ]</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;ltag&quot;</span> <span class="keywordflow">in</span> varfont:</div>
<div class="line"><span class="lineno">   61</span>        <span class="comment"># Drop the whole &#39;ltag&#39; table if all the language-dependent Unicode name</span></div>
<div class="line"><span class="lineno">   62</span>        <span class="comment"># records that reference it have been dropped.</span></div>
<div class="line"><span class="lineno">   63</span>        <span class="comment"># TODO: Only prune unused ltag tags, renumerating langIDs accordingly.</span></div>
<div class="line"><span class="lineno">   64</span>        <span class="comment"># Note ltag can also be used by feat or morx tables, so check those too.</span></div>
<div class="line"><span class="lineno">   65</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> any(</div>
<div class="line"><span class="lineno">   66</span>            record</div>
<div class="line"><span class="lineno">   67</span>            <span class="keywordflow">for</span> record <span class="keywordflow">in</span> varfont[<span class="stringliteral">&quot;name&quot;</span>].names</div>
<div class="line"><span class="lineno">   68</span>            <span class="keywordflow">if</span> record.platformID == 0 <span class="keywordflow">and</span> record.langID != 0xFFFF</div>
<div class="line"><span class="lineno">   69</span>        ):</div>
<div class="line"><span class="lineno">   70</span>            del varfont[<span class="stringliteral">&quot;ltag&quot;</span>]</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aac7a84a63b5435d043a049b9f7f305d9" name="aac7a84a63b5435d043a049b9f7f305d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac7a84a63b5435d043a049b9f7f305d9">&#9670;&#160;</a></span>updateNameTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.varLib.instancer.names.updateNameTable </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>varfont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axisLimits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Update instatiated variable font's name table using STAT AxisValues.

Raises ValueError if the STAT table is missing or an Axis Value table is
missing for requested axis locations.

First, collect all STAT AxisValues that match the new default axis locations
(excluding "elided" ones); concatenate the strings in design axis order,
while giving priority to "synthetic" values (Format 4), to form the
typographic subfamily name associated with the new default instance.
Finally, update all related records in the name table, making sure that
legacy family/sub-family names conform to the the R/I/B/BI (Regular, Italic,
Bold, Bold Italic) naming model.

Example: Updating a partial variable font:
| &gt;&gt;&gt; ttFont = TTFont("OpenSans[wdth,wght].ttf")
| &gt;&gt;&gt; updateNameTable(ttFont, {"wght": (400, 900), "wdth": 75})

The name table records will be updated in the following manner:
NameID 1 familyName: "Open Sans" --&gt; "Open Sans Condensed"
NameID 2 subFamilyName: "Regular" --&gt; "Regular"
NameID 3 Unique font identifier: "3.000;GOOG;OpenSans-Regular" --&gt; \
    "3.000;GOOG;OpenSans-Condensed"
NameID 4 Full font name: "Open Sans Regular" --&gt; "Open Sans Condensed"
NameID 6 PostScript name: "OpenSans-Regular" --&gt; "OpenSans-Condensed"
NameID 16 Typographic Family name: None --&gt; "Open Sans"
NameID 17 Typographic Subfamily name: None --&gt; "Condensed"

References:
https://docs.microsoft.com/en-us/typography/opentype/spec/stat
https://docs.microsoft.com/en-us/typography/opentype/spec/name#name-ids
</pre> <div class="fragment"><div class="line"><span class="lineno">   73</span><span class="keyword">def </span>updateNameTable(varfont, axisLimits):</div>
<div class="line"><span class="lineno">   74</span>    <span class="stringliteral">&quot;&quot;&quot;Update instatiated variable font&#39;s name table using STAT AxisValues.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">    Raises ValueError if the STAT table is missing or an Axis Value table is</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    missing for requested axis locations.</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    First, collect all STAT AxisValues that match the new default axis locations</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    (excluding &quot;elided&quot; ones); concatenate the strings in design axis order,</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    while giving priority to &quot;synthetic&quot; values (Format 4), to form the</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    typographic subfamily name associated with the new default instance.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    Finally, update all related records in the name table, making sure that</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    legacy family/sub-family names conform to the the R/I/B/BI (Regular, Italic,</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">    Bold, Bold Italic) naming model.</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">    Example: Updating a partial variable font:</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    | &gt;&gt;&gt; ttFont = TTFont(&quot;OpenSans[wdth,wght].ttf&quot;)</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    | &gt;&gt;&gt; updateNameTable(ttFont, {&quot;wght&quot;: (400, 900), &quot;wdth&quot;: 75})</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    The name table records will be updated in the following manner:</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    NameID 1 familyName: &quot;Open Sans&quot; --&gt; &quot;Open Sans Condensed&quot;</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    NameID 2 subFamilyName: &quot;Regular&quot; --&gt; &quot;Regular&quot;</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    NameID 3 Unique font identifier: &quot;3.000;GOOG;OpenSans-Regular&quot; --&gt; \</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">        &quot;3.000;GOOG;OpenSans-Condensed&quot;</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    NameID 4 Full font name: &quot;Open Sans Regular&quot; --&gt; &quot;Open Sans Condensed&quot;</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    NameID 6 PostScript name: &quot;OpenSans-Regular&quot; --&gt; &quot;OpenSans-Condensed&quot;</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    NameID 16 Typographic Family name: None --&gt; &quot;Open Sans&quot;</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    NameID 17 Typographic Subfamily name: None --&gt; &quot;Condensed&quot;</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    References:</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    https://docs.microsoft.com/en-us/typography/opentype/spec/stat</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    https://docs.microsoft.com/en-us/typography/opentype/spec/name#name-ids</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  105</span>    <span class="keyword">from</span> . <span class="keyword">import</span> AxisLimits, axisValuesFromAxisLimits</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;STAT&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> varfont:</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Cannot update name table since there is no STAT table.&quot;</span>)</div>
<div class="line"><span class="lineno">  109</span>    stat = varfont[<span class="stringliteral">&quot;STAT&quot;</span>].table</div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> stat.AxisValueArray:</div>
<div class="line"><span class="lineno">  111</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Cannot update name table since there are no STAT Axis Values&quot;</span>)</div>
<div class="line"><span class="lineno">  112</span>    fvar = varfont[<span class="stringliteral">&quot;fvar&quot;</span>]</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>    <span class="comment"># The updated name table will reflect the new &#39;zero origin&#39; of the font.</span></div>
<div class="line"><span class="lineno">  115</span>    <span class="comment"># If we&#39;re instantiating a partial font, we will populate the unpinned</span></div>
<div class="line"><span class="lineno">  116</span>    <span class="comment"># axes with their default axis values from fvar.</span></div>
<div class="line"><span class="lineno">  117</span>    axisLimits = AxisLimits(axisLimits).populateDefaults(varfont)</div>
<div class="line"><span class="lineno">  118</span>    partialDefaults = {k: v.default <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> axisLimits.items()}</div>
<div class="line"><span class="lineno">  119</span>    fvarDefaults = {a.axisTag: a.defaultValue <span class="keywordflow">for</span> a <span class="keywordflow">in</span> fvar.axes}</div>
<div class="line"><span class="lineno">  120</span>    defaultAxisCoords = AxisLimits({**fvarDefaults, **partialDefaults})</div>
<div class="line"><span class="lineno">  121</span>    <span class="keyword">assert</span> all(v.minimum == v.maximum <span class="keywordflow">for</span> v <span class="keywordflow">in</span> defaultAxisCoords.values())</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    axisValueTables = axisValuesFromAxisLimits(stat, defaultAxisCoords)</div>
<div class="line"><span class="lineno">  124</span>    checkAxisValuesExist(stat, axisValueTables, defaultAxisCoords.pinnedLocation())</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <span class="comment"># ignore &quot;elidable&quot; axis values, should be omitted in application font menus.</span></div>
<div class="line"><span class="lineno">  127</span>    axisValueTables = [</div>
<div class="line"><span class="lineno">  128</span>        v <span class="keywordflow">for</span> v <span class="keywordflow">in</span> axisValueTables <span class="keywordflow">if</span> <span class="keywordflow">not</span> v.Flags &amp; ELIDABLE_AXIS_VALUE_NAME</div>
<div class="line"><span class="lineno">  129</span>    ]</div>
<div class="line"><span class="lineno">  130</span>    axisValueTables = _sortAxisValues(axisValueTables)</div>
<div class="line"><span class="lineno">  131</span>    _updateNameRecords(varfont, axisValueTables)</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aba4596e3f578f0d1c168d7f1f09638e6" name="aba4596e3f578f0d1c168d7f1f09638e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba4596e3f578f0d1c168d7f1f09638e6">&#9670;&#160;</a></span>ELIDABLE_AXIS_VALUE_NAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fontTools.varLib.instancer.names.ELIDABLE_AXIS_VALUE_NAME = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
