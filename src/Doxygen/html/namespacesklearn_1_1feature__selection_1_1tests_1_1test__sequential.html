<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.feature_selection.tests.test_sequential Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1feature__selection.html">feature_selection</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html">test_sequential</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.feature_selection.tests.test_sequential Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac8df940dd613ca3d0e6b02d17e72fa1e" id="r_ac8df940dd613ca3d0e6b02d17e72fa1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#ac8df940dd613ca3d0e6b02d17e72fa1e">test_bad_n_features_to_select</a> ()</td></tr>
<tr class="separator:ac8df940dd613ca3d0e6b02d17e72fa1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7141a1ae2b98d419674a055ef1aa897" id="r_ab7141a1ae2b98d419674a055ef1aa897"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#ab7141a1ae2b98d419674a055ef1aa897">test_n_features_to_select</a> (direction, n_features_to_select)</td></tr>
<tr class="separator:ab7141a1ae2b98d419674a055ef1aa897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3281da956ef09fedb42ddaabb6fc2df7" id="r_a3281da956ef09fedb42ddaabb6fc2df7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#a3281da956ef09fedb42ddaabb6fc2df7">test_n_features_to_select_auto</a> (direction)</td></tr>
<tr class="separator:a3281da956ef09fedb42ddaabb6fc2df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cfab1cf2e55bd79c92761cb2173f7e4" id="r_a6cfab1cf2e55bd79c92761cb2173f7e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#a6cfab1cf2e55bd79c92761cb2173f7e4">test_n_features_to_select_stopping_criterion</a> (direction)</td></tr>
<tr class="separator:a6cfab1cf2e55bd79c92761cb2173f7e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8251ab4500a133cf6b7ed524a99a6db" id="r_af8251ab4500a133cf6b7ed524a99a6db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#af8251ab4500a133cf6b7ed524a99a6db">test_n_features_to_select_float</a> (direction, n_features_to_select, expected)</td></tr>
<tr class="separator:af8251ab4500a133cf6b7ed524a99a6db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb5178f8aa2b9061e58a8307e3588406" id="r_acb5178f8aa2b9061e58a8307e3588406"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#acb5178f8aa2b9061e58a8307e3588406">test_sanity</a> (seed, direction, n_features_to_select, expected_selected_features)</td></tr>
<tr class="separator:acb5178f8aa2b9061e58a8307e3588406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca3091f39f67d59c3bb6d4e93f64cca8" id="r_aca3091f39f67d59c3bb6d4e93f64cca8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#aca3091f39f67d59c3bb6d4e93f64cca8">test_sparse_support</a> ()</td></tr>
<tr class="separator:aca3091f39f67d59c3bb6d4e93f64cca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e29631c8e42e91bf9902928b4f4beaf" id="r_a9e29631c8e42e91bf9902928b4f4beaf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#a9e29631c8e42e91bf9902928b4f4beaf">test_nan_support</a> ()</td></tr>
<tr class="separator:a9e29631c8e42e91bf9902928b4f4beaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af112007d2d3c312272c4f709b714d544" id="r_af112007d2d3c312272c4f709b714d544"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#af112007d2d3c312272c4f709b714d544">test_pipeline_support</a> ()</td></tr>
<tr class="separator:af112007d2d3c312272c4f709b714d544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f49d0a2a0a68ea1c9efe203df66437" id="r_a43f49d0a2a0a68ea1c9efe203df66437"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#a43f49d0a2a0a68ea1c9efe203df66437">test_raise_deprecation_warning</a> ()</td></tr>
<tr class="separator:a43f49d0a2a0a68ea1c9efe203df66437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87bbdf909f17ed467737dd7f20d43fb2" id="r_a87bbdf909f17ed467737dd7f20d43fb2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#a87bbdf909f17ed467737dd7f20d43fb2">test_unsupervised_model_fit</a> (n_features_to_select)</td></tr>
<tr class="separator:a87bbdf909f17ed467737dd7f20d43fb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3d987b796a8ab4f1cb90835b3e3c3cf" id="r_ab3d987b796a8ab4f1cb90835b3e3c3cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1feature__selection_1_1tests_1_1test__sequential.html#ab3d987b796a8ab4f1cb90835b3e3c3cf">test_no_y_validation_model_fit</a> (y)</td></tr>
<tr class="separator:ab3d987b796a8ab4f1cb90835b3e3c3cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac8df940dd613ca3d0e6b02d17e72fa1e" name="ac8df940dd613ca3d0e6b02d17e72fa1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8df940dd613ca3d0e6b02d17e72fa1e">&#9670;&#160;</a></span>test_bad_n_features_to_select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_bad_n_features_to_select </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   16</span><span class="keyword">def </span>test_bad_n_features_to_select():</div>
<div class="line"><span class="lineno">   17</span>    n_features = 5</div>
<div class="line"><span class="lineno">   18</span>    X, y = make_regression(n_features=n_features)</div>
<div class="line"><span class="lineno">   19</span>    sfs = SequentialFeatureSelector(LinearRegression(), n_features_to_select=n_features)</div>
<div class="line"><span class="lineno">   20</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;n_features_to_select must be either&quot;</span>):</div>
<div class="line"><span class="lineno">   21</span>        sfs.fit(X, y)</div>
<div class="line"><span class="lineno">   22</span> </div>
<div class="line"><span class="lineno">   23</span> </div>
<div class="line"><span class="lineno">   24</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:Leaving `n_features_to_select` to &quot;)</span></div>
<div class="line"><span class="lineno">   25</span><span class="preprocessor">@pytest.mark.parametrize(&quot;direction&quot;, (&quot;forward&quot;, &quot;backward&quot;)</span>)</div>
<div class="line"><span class="lineno">   26</span><span class="preprocessor">@pytest.mark.parametrize(&quot;n_features_to_select&quot;, (1, 5, 9, &quot;auto&quot;)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7141a1ae2b98d419674a055ef1aa897" name="ab7141a1ae2b98d419674a055ef1aa897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7141a1ae2b98d419674a055ef1aa897">&#9670;&#160;</a></span>test_n_features_to_select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_n_features_to_select </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_features_to_select</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   27</span><span class="keyword">def </span>test_n_features_to_select(direction, n_features_to_select):</div>
<div class="line"><span class="lineno">   28</span>    <span class="comment"># Make sure n_features_to_select is respected</span></div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>    n_features = 10</div>
<div class="line"><span class="lineno">   31</span>    X, y = make_regression(n_features=n_features, random_state=0)</div>
<div class="line"><span class="lineno">   32</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">   33</span>        LinearRegression(),</div>
<div class="line"><span class="lineno">   34</span>        n_features_to_select=n_features_to_select,</div>
<div class="line"><span class="lineno">   35</span>        direction=direction,</div>
<div class="line"><span class="lineno">   36</span>        cv=2,</div>
<div class="line"><span class="lineno">   37</span>    )</div>
<div class="line"><span class="lineno">   38</span>    sfs.fit(X, y)</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">if</span> n_features_to_select <span class="keywordflow">in</span> (<span class="stringliteral">&quot;auto&quot;</span>, <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">   41</span>        n_features_to_select = n_features // 2</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    <span class="keyword">assert</span> sfs.get_support(indices=<span class="keyword">True</span>).shape[0] == n_features_to_select</div>
<div class="line"><span class="lineno">   44</span>    <span class="keyword">assert</span> sfs.n_features_to_select_ == n_features_to_select</div>
<div class="line"><span class="lineno">   45</span>    <span class="keyword">assert</span> sfs.transform(X).shape[1] == n_features_to_select</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span><span class="preprocessor">@pytest.mark.parametrize(&quot;direction&quot;, (&quot;forward&quot;, &quot;backward&quot;)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3281da956ef09fedb42ddaabb6fc2df7" name="a3281da956ef09fedb42ddaabb6fc2df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3281da956ef09fedb42ddaabb6fc2df7">&#9670;&#160;</a></span>test_n_features_to_select_auto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_n_features_to_select_auto </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the behaviour of `n_features_to_select="auto"` with different
values for the parameter `tol`.
</pre> <div class="fragment"><div class="line"><span class="lineno">   49</span><span class="keyword">def </span>test_n_features_to_select_auto(direction):</div>
<div class="line"><span class="lineno">   50</span>    <span class="stringliteral">&quot;&quot;&quot;Check the behaviour of `n_features_to_select=&quot;auto&quot;` with different</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">    values for the parameter `tol`.</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    n_features = 10</div>
<div class="line"><span class="lineno">   55</span>    tol = 1e-3</div>
<div class="line"><span class="lineno">   56</span>    X, y = make_regression(n_features=n_features, random_state=0)</div>
<div class="line"><span class="lineno">   57</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">   58</span>        LinearRegression(),</div>
<div class="line"><span class="lineno">   59</span>        n_features_to_select=<span class="stringliteral">&quot;auto&quot;</span>,</div>
<div class="line"><span class="lineno">   60</span>        tol=tol,</div>
<div class="line"><span class="lineno">   61</span>        direction=direction,</div>
<div class="line"><span class="lineno">   62</span>        cv=2,</div>
<div class="line"><span class="lineno">   63</span>    )</div>
<div class="line"><span class="lineno">   64</span>    sfs.fit(X, y)</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    max_features_to_select = n_features - 1</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="keyword">assert</span> sfs.get_support(indices=<span class="keyword">True</span>).shape[0] &lt;= max_features_to_select</div>
<div class="line"><span class="lineno">   69</span>    <span class="keyword">assert</span> sfs.n_features_to_select_ &lt;= max_features_to_select</div>
<div class="line"><span class="lineno">   70</span>    <span class="keyword">assert</span> sfs.transform(X).shape[1] &lt;= max_features_to_select</div>
<div class="line"><span class="lineno">   71</span>    <span class="keyword">assert</span> sfs.get_support(indices=<span class="keyword">True</span>).shape[0] == sfs.n_features_to_select_</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span><span class="preprocessor">@pytest.mark.parametrize(&quot;direction&quot;, (&quot;forward&quot;, &quot;backward&quot;)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8251ab4500a133cf6b7ed524a99a6db" name="af8251ab4500a133cf6b7ed524a99a6db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8251ab4500a133cf6b7ed524a99a6db">&#9670;&#160;</a></span>test_n_features_to_select_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_n_features_to_select_float </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_features_to_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  146</span><span class="keyword">def </span>test_n_features_to_select_float(direction, n_features_to_select, expected):</div>
<div class="line"><span class="lineno">  147</span>    <span class="comment"># Test passing a float as n_features_to_select</span></div>
<div class="line"><span class="lineno">  148</span>    X, y = make_regression(n_features=10)</div>
<div class="line"><span class="lineno">  149</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">  150</span>        LinearRegression(),</div>
<div class="line"><span class="lineno">  151</span>        n_features_to_select=n_features_to_select,</div>
<div class="line"><span class="lineno">  152</span>        direction=direction,</div>
<div class="line"><span class="lineno">  153</span>        cv=2,</div>
<div class="line"><span class="lineno">  154</span>    )</div>
<div class="line"><span class="lineno">  155</span>    sfs.fit(X, y)</div>
<div class="line"><span class="lineno">  156</span>    <span class="keyword">assert</span> sfs.n_features_to_select_ == expected</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span><span class="preprocessor">@pytest.mark.parametrize(&quot;seed&quot;, range(10)</span>)</div>
<div class="line"><span class="lineno">  160</span><span class="preprocessor">@pytest.mark.parametrize(&quot;direction&quot;, (&quot;forward&quot;, &quot;backward&quot;)</span>)</div>
<div class="line"><span class="lineno">  161</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  162</span>    <span class="stringliteral">&quot;n_features_to_select, expected_selected_features&quot;</span>,</div>
<div class="line"><span class="lineno">  163</span>    [</div>
<div class="line"><span class="lineno">  164</span>        (2, [0, 2]),  <span class="comment"># f1 is dropped since it has no predictive power</span></div>
<div class="line"><span class="lineno">  165</span>        (1, [2]),  <span class="comment"># f2 is more predictive than f0 so it&#39;s kept</span></div>
<div class="line"><span class="lineno">  166</span>    ],</div>
<div class="line"><span class="lineno">  167</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cfab1cf2e55bd79c92761cb2173f7e4" name="a6cfab1cf2e55bd79c92761cb2173f7e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfab1cf2e55bd79c92761cb2173f7e4">&#9670;&#160;</a></span>test_n_features_to_select_stopping_criterion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_n_features_to_select_stopping_criterion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the behaviour stopping criterion for feature selection
depending on the values of `n_features_to_select` and `tol`.

When `direction` is `'forward'`, select a new features at random
among those not currently selected in selector.support_,
build a new version of the data that includes all the features
in selector.support_ + this newly selected feature.
And check that the cross-validation score of the model trained on
this new dataset variant is lower than the model with
the selected forward selected features or at least does not improve
by more than the tol margin.

When `direction` is `'backward'`, instead of adding a new feature
to selector.support_, try to remove one of those selected features at random
And check that the cross-validation score is either decreasing or
not improving by more than the tol margin.
</pre> <div class="fragment"><div class="line"><span class="lineno">   75</span><span class="keyword">def </span>test_n_features_to_select_stopping_criterion(direction):</div>
<div class="line"><span class="lineno">   76</span>    <span class="stringliteral">&quot;&quot;&quot;Check the behaviour stopping criterion for feature selection</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    depending on the values of `n_features_to_select` and `tol`.</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    When `direction` is `&#39;forward&#39;`, select a new features at random</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    among those not currently selected in selector.support_,</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    build a new version of the data that includes all the features</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    in selector.support_ + this newly selected feature.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    And check that the cross-validation score of the model trained on</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    this new dataset variant is lower than the model with</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">    the selected forward selected features or at least does not improve</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">    by more than the tol margin.</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    When `direction` is `&#39;backward&#39;`, instead of adding a new feature</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    to selector.support_, try to remove one of those selected features at random</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    And check that the cross-validation score is either decreasing or</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    not improving by more than the tol margin.</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    X, y = make_regression(n_features=50, n_informative=10, random_state=0)</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    tol = 1e-3</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">   99</span>        LinearRegression(),</div>
<div class="line"><span class="lineno">  100</span>        n_features_to_select=<span class="stringliteral">&quot;auto&quot;</span>,</div>
<div class="line"><span class="lineno">  101</span>        tol=tol,</div>
<div class="line"><span class="lineno">  102</span>        direction=direction,</div>
<div class="line"><span class="lineno">  103</span>        cv=2,</div>
<div class="line"><span class="lineno">  104</span>    )</div>
<div class="line"><span class="lineno">  105</span>    sfs.fit(X, y)</div>
<div class="line"><span class="lineno">  106</span>    selected_X = sfs.transform(X)</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    added_candidates = list(set(range(X.shape[1])) - set(sfs.get_support(indices=<span class="keyword">True</span>)))</div>
<div class="line"><span class="lineno">  111</span>    added_X = np.hstack(</div>
<div class="line"><span class="lineno">  112</span>        [</div>
<div class="line"><span class="lineno">  113</span>            selected_X,</div>
<div class="line"><span class="lineno">  114</span>            (X[:, rng.choice(added_candidates)])[:, np.newaxis],</div>
<div class="line"><span class="lineno">  115</span>        ]</div>
<div class="line"><span class="lineno">  116</span>    )</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    removed_candidate = rng.choice(list(range(sfs.n_features_to_select_)))</div>
<div class="line"><span class="lineno">  119</span>    removed_X = np.delete(selected_X, removed_candidate, axis=1)</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    plain_cv_score = cross_val_score(LinearRegression(), X, y, cv=2).mean()</div>
<div class="line"><span class="lineno">  122</span>    sfs_cv_score = cross_val_score(LinearRegression(), selected_X, y, cv=2).mean()</div>
<div class="line"><span class="lineno">  123</span>    added_cv_score = cross_val_score(LinearRegression(), added_X, y, cv=2).mean()</div>
<div class="line"><span class="lineno">  124</span>    removed_cv_score = cross_val_score(LinearRegression(), removed_X, y, cv=2).mean()</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <span class="keyword">assert</span> sfs_cv_score &gt;= plain_cv_score</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">if</span> direction == <span class="stringliteral">&quot;forward&quot;</span>:</div>
<div class="line"><span class="lineno">  129</span>        <span class="keyword">assert</span> (sfs_cv_score - added_cv_score) &lt;= tol</div>
<div class="line"><span class="lineno">  130</span>        <span class="keyword">assert</span> (sfs_cv_score - removed_cv_score) &gt;= tol</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  132</span>        <span class="keyword">assert</span> (added_cv_score - sfs_cv_score) &lt;= tol</div>
<div class="line"><span class="lineno">  133</span>        <span class="keyword">assert</span> (removed_cv_score - sfs_cv_score) &lt;= tol</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:Leaving `n_features_to_select` to &quot;)</span></div>
<div class="line"><span class="lineno">  137</span><span class="preprocessor">@pytest.mark.parametrize(&quot;direction&quot;, (&quot;forward&quot;, &quot;backward&quot;)</span>)</div>
<div class="line"><span class="lineno">  138</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  139</span>    <span class="stringliteral">&quot;n_features_to_select, expected&quot;</span>,</div>
<div class="line"><span class="lineno">  140</span>    (</div>
<div class="line"><span class="lineno">  141</span>        (0.1, 1),</div>
<div class="line"><span class="lineno">  142</span>        (1.0, 10),</div>
<div class="line"><span class="lineno">  143</span>        (0.5, 5),</div>
<div class="line"><span class="lineno">  144</span>    ),</div>
<div class="line"><span class="lineno">  145</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e29631c8e42e91bf9902928b4f4beaf" name="a9e29631c8e42e91bf9902928b4f4beaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e29631c8e42e91bf9902928b4f4beaf">&#9670;&#160;</a></span>test_nan_support()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_nan_support </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  201</span><span class="keyword">def </span>test_nan_support():</div>
<div class="line"><span class="lineno">  202</span>    <span class="comment"># Make sure nans are OK if the underlying estimator supports nans</span></div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  205</span>    n_samples, n_features = 40, 4</div>
<div class="line"><span class="lineno">  206</span>    X, y = make_regression(n_samples, n_features, random_state=0)</div>
<div class="line"><span class="lineno">  207</span>    nan_mask = rng.randint(0, 2, size=(n_samples, n_features), dtype=bool)</div>
<div class="line"><span class="lineno">  208</span>    X[nan_mask] = np.nan</div>
<div class="line"><span class="lineno">  209</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">  210</span>        HistGradientBoostingRegressor(), n_features_to_select=<span class="stringliteral">&quot;auto&quot;</span>, cv=2</div>
<div class="line"><span class="lineno">  211</span>    )</div>
<div class="line"><span class="lineno">  212</span>    sfs.fit(X, y)</div>
<div class="line"><span class="lineno">  213</span>    sfs.transform(X)</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;Input X contains NaN&quot;</span>):</div>
<div class="line"><span class="lineno">  216</span>        <span class="comment"># LinearRegression does not support nans</span></div>
<div class="line"><span class="lineno">  217</span>        SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">  218</span>            LinearRegression(), n_features_to_select=<span class="stringliteral">&quot;auto&quot;</span>, cv=2</div>
<div class="line"><span class="lineno">  219</span>        ).fit(X, y)</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3d987b796a8ab4f1cb90835b3e3c3cf" name="ab3d987b796a8ab4f1cb90835b3e3c3cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3d987b796a8ab4f1cb90835b3e3c3cf">&#9670;&#160;</a></span>test_no_y_validation_model_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_no_y_validation_model_fit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  270</span><span class="keyword">def </span>test_no_y_validation_model_fit(y):</div>
<div class="line"><span class="lineno">  271</span>    <span class="comment"># Make sure that other non-conventional y labels are not accepted</span></div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>    X, clusters = make_blobs(n_features=6)</div>
<div class="line"><span class="lineno">  274</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">  275</span>        KMeans(),</div>
<div class="line"><span class="lineno">  276</span>        n_features_to_select=3,</div>
<div class="line"><span class="lineno">  277</span>    )</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>    <span class="keyword">with</span> pytest.raises((TypeError, ValueError)):</div>
<div class="line"><span class="lineno">  280</span>        sfs.fit(X, y)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af112007d2d3c312272c4f709b714d544" name="af112007d2d3c312272c4f709b714d544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af112007d2d3c312272c4f709b714d544">&#9670;&#160;</a></span>test_pipeline_support()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_pipeline_support </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  222</span><span class="keyword">def </span>test_pipeline_support():</div>
<div class="line"><span class="lineno">  223</span>    <span class="comment"># Make sure that pipelines can be passed into SFS and that SFS can be</span></div>
<div class="line"><span class="lineno">  224</span>    <span class="comment"># passed into a pipeline</span></div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    n_samples, n_features = 50, 3</div>
<div class="line"><span class="lineno">  227</span>    X, y = make_regression(n_samples, n_features, random_state=0)</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>    <span class="comment"># pipeline in SFS</span></div>
<div class="line"><span class="lineno">  230</span>    pipe = make_pipeline(StandardScaler(), LinearRegression())</div>
<div class="line"><span class="lineno">  231</span>    sfs = SequentialFeatureSelector(pipe, n_features_to_select=<span class="stringliteral">&quot;auto&quot;</span>, cv=2)</div>
<div class="line"><span class="lineno">  232</span>    sfs.fit(X, y)</div>
<div class="line"><span class="lineno">  233</span>    sfs.transform(X)</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    <span class="comment"># SFS in pipeline</span></div>
<div class="line"><span class="lineno">  236</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">  237</span>        LinearRegression(), n_features_to_select=<span class="stringliteral">&quot;auto&quot;</span>, cv=2</div>
<div class="line"><span class="lineno">  238</span>    )</div>
<div class="line"><span class="lineno">  239</span>    pipe = make_pipeline(StandardScaler(), sfs)</div>
<div class="line"><span class="lineno">  240</span>    pipe.fit(X, y)</div>
<div class="line"><span class="lineno">  241</span>    pipe.transform(X)</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span><span class="comment"># FIXME : to be removed in 1.3</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43f49d0a2a0a68ea1c9efe203df66437" name="a43f49d0a2a0a68ea1c9efe203df66437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f49d0a2a0a68ea1c9efe203df66437">&#9670;&#160;</a></span>test_raise_deprecation_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_raise_deprecation_warning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that we raise a FutureWarning with `n_features_to_select`.</pre> <div class="fragment"><div class="line"><span class="lineno">  245</span><span class="keyword">def </span>test_raise_deprecation_warning():</div>
<div class="line"><span class="lineno">  246</span>    <span class="stringliteral">&quot;&quot;&quot;Check that we raise a FutureWarning with `n_features_to_select`.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  247</span>    n_samples, n_features = 50, 3</div>
<div class="line"><span class="lineno">  248</span>    X, y = make_regression(n_samples, n_features, random_state=0)</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    warn_msg = <span class="stringliteral">&quot;Leaving `n_features_to_select` to None is deprecated&quot;</span></div>
<div class="line"><span class="lineno">  251</span>    <span class="keyword">with</span> pytest.warns(FutureWarning, match=warn_msg):</div>
<div class="line"><span class="lineno">  252</span>        SequentialFeatureSelector(LinearRegression()).fit(X, y)</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span><span class="preprocessor">@pytest.mark.parametrize(&quot;n_features_to_select&quot;, (2, 3)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="acb5178f8aa2b9061e58a8307e3588406" name="acb5178f8aa2b9061e58a8307e3588406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb5178f8aa2b9061e58a8307e3588406">&#9670;&#160;</a></span>test_sanity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_sanity </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_features_to_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_selected_features</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  168</span><span class="keyword">def </span>test_sanity(seed, direction, n_features_to_select, expected_selected_features):</div>
<div class="line"><span class="lineno">  169</span>    <span class="comment"># Basic sanity check: 3 features, only f0 and f2 are correlated with the</span></div>
<div class="line"><span class="lineno">  170</span>    <span class="comment"># target, f2 having a stronger correlation than f0. We expect f1 to be</span></div>
<div class="line"><span class="lineno">  171</span>    <span class="comment"># dropped, and f2 to always be selected.</span></div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    rng = np.random.RandomState(seed)</div>
<div class="line"><span class="lineno">  174</span>    n_samples = 100</div>
<div class="line"><span class="lineno">  175</span>    X = rng.randn(n_samples, 3)</div>
<div class="line"><span class="lineno">  176</span>    y = 3 * X[:, 0] - 10 * X[:, 2]</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">  179</span>        LinearRegression(),</div>
<div class="line"><span class="lineno">  180</span>        n_features_to_select=n_features_to_select,</div>
<div class="line"><span class="lineno">  181</span>        direction=direction,</div>
<div class="line"><span class="lineno">  182</span>        cv=2,</div>
<div class="line"><span class="lineno">  183</span>    )</div>
<div class="line"><span class="lineno">  184</span>    sfs.fit(X, y)</div>
<div class="line"><span class="lineno">  185</span>    assert_array_equal(sfs.get_support(indices=<span class="keyword">True</span>), expected_selected_features)</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:Leaving `n_features_to_select` to &quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca3091f39f67d59c3bb6d4e93f64cca8" name="aca3091f39f67d59c3bb6d4e93f64cca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca3091f39f67d59c3bb6d4e93f64cca8">&#9670;&#160;</a></span>test_sparse_support()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_sparse_support </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  189</span><span class="keyword">def </span>test_sparse_support():</div>
<div class="line"><span class="lineno">  190</span>    <span class="comment"># Make sure sparse data is supported</span></div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    X, y = make_regression(n_features=10)</div>
<div class="line"><span class="lineno">  193</span>    X = <a class="code hl_class" href="classscipy_1_1sparse_1_1__csr_1_1csr__matrix.html">scipy.sparse.csr_matrix</a>(X)</div>
<div class="line"><span class="lineno">  194</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">  195</span>        LinearRegression(), n_features_to_select=<span class="stringliteral">&quot;auto&quot;</span>, cv=2</div>
<div class="line"><span class="lineno">  196</span>    )</div>
<div class="line"><span class="lineno">  197</span>    sfs.fit(X, y)</div>
<div class="line"><span class="lineno">  198</span>    sfs.transform(X)</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="ttc" id="aclassscipy_1_1sparse_1_1__csr_1_1csr__matrix_html"><div class="ttname"><a href="classscipy_1_1sparse_1_1__csr_1_1csr__matrix.html">scipy.sparse._csr.csr_matrix</a></div><div class="ttdef"><b>Definition</b> _csr.py:17</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87bbdf909f17ed467737dd7f20d43fb2" name="a87bbdf909f17ed467737dd7f20d43fb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87bbdf909f17ed467737dd7f20d43fb2">&#9670;&#160;</a></span>test_unsupervised_model_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.feature_selection.tests.test_sequential.test_unsupervised_model_fit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_features_to_select</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  256</span><span class="keyword">def </span>test_unsupervised_model_fit(n_features_to_select):</div>
<div class="line"><span class="lineno">  257</span>    <span class="comment"># Make sure that models without classification labels are not being</span></div>
<div class="line"><span class="lineno">  258</span>    <span class="comment"># validated</span></div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    X, y = make_blobs(n_features=4)</div>
<div class="line"><span class="lineno">  261</span>    sfs = SequentialFeatureSelector(</div>
<div class="line"><span class="lineno">  262</span>        KMeans(n_init=1),</div>
<div class="line"><span class="lineno">  263</span>        n_features_to_select=n_features_to_select,</div>
<div class="line"><span class="lineno">  264</span>    )</div>
<div class="line"><span class="lineno">  265</span>    sfs.fit(X)</div>
<div class="line"><span class="lineno">  266</span>    <span class="keyword">assert</span> sfs.transform(X).shape[1] == n_features_to_select</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span><span class="preprocessor">@pytest.mark.parametrize(&quot;y&quot;, (&quot;no_validation&quot;, 1j, 99.9, np.nan, 3)</span>)</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
