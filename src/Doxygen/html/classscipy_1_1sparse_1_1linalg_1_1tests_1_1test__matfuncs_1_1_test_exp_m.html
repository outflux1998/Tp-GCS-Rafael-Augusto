<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.sparse.linalg.tests.test_matfuncs.TestExpM Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1sparse.html">sparse</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1sparse_1_1linalg.html">linalg</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1sparse_1_1linalg_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs.html">test_matfuncs</a></li><li class="navelem"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html">TestExpM</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scipy.sparse.linalg.tests.test_matfuncs.TestExpM Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8dcf956ade75310968f00acc7c756c68" id="r_a8dcf956ade75310968f00acc7c756c68"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a8dcf956ade75310968f00acc7c756c68">test_zero_ndarray</a> (self)</td></tr>
<tr class="separator:a8dcf956ade75310968f00acc7c756c68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4723f9876f45da9d2f22c580f7583be" id="r_ae4723f9876f45da9d2f22c580f7583be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#ae4723f9876f45da9d2f22c580f7583be">test_zero_sparse</a> (self)</td></tr>
<tr class="separator:ae4723f9876f45da9d2f22c580f7583be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a928f1a896fd21a736a267d0a7eb24c9b" id="r_a928f1a896fd21a736a267d0a7eb24c9b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a928f1a896fd21a736a267d0a7eb24c9b">test_zero_matrix</a> (self)</td></tr>
<tr class="separator:a928f1a896fd21a736a267d0a7eb24c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2004b8983065f9fc3c2933b9038ae1" id="r_aba2004b8983065f9fc3c2933b9038ae1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#aba2004b8983065f9fc3c2933b9038ae1">test_misc_types</a> (self)</td></tr>
<tr class="separator:aba2004b8983065f9fc3c2933b9038ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77b1872d1c68d0a7ed6c9c1db811dd56" id="r_a77b1872d1c68d0a7ed6c9c1db811dd56"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a77b1872d1c68d0a7ed6c9c1db811dd56">test_bidiagonal_sparse</a> (self)</td></tr>
<tr class="separator:a77b1872d1c68d0a7ed6c9c1db811dd56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b290aa6d61a32336d81896a2f2240f7" id="r_a1b290aa6d61a32336d81896a2f2240f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a1b290aa6d61a32336d81896a2f2240f7">test_padecases_dtype_float</a> (self)</td></tr>
<tr class="separator:a1b290aa6d61a32336d81896a2f2240f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12246a45e07fa3f4548952d0f2703fb5" id="r_a12246a45e07fa3f4548952d0f2703fb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a12246a45e07fa3f4548952d0f2703fb5">test_padecases_dtype_complex</a> (self)</td></tr>
<tr class="separator:a12246a45e07fa3f4548952d0f2703fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af55020d1ca313118b309fe8a057fa581" id="r_af55020d1ca313118b309fe8a057fa581"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#af55020d1ca313118b309fe8a057fa581">test_padecases_dtype_sparse_float</a> (self)</td></tr>
<tr class="separator:af55020d1ca313118b309fe8a057fa581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57876857cc4c0fdfd06439ca2f99840f" id="r_a57876857cc4c0fdfd06439ca2f99840f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a57876857cc4c0fdfd06439ca2f99840f">test_padecases_dtype_sparse_complex</a> (self)</td></tr>
<tr class="separator:a57876857cc4c0fdfd06439ca2f99840f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342ac465a17baf8c7032a044f32f74de" id="r_a342ac465a17baf8c7032a044f32f74de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a342ac465a17baf8c7032a044f32f74de">test_logm_consistency</a> (self)</td></tr>
<tr class="separator:a342ac465a17baf8c7032a044f32f74de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1535de277f08815dfef510dbebb32e9f" id="r_a1535de277f08815dfef510dbebb32e9f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a1535de277f08815dfef510dbebb32e9f">test_integer_matrix</a> (self)</td></tr>
<tr class="separator:a1535de277f08815dfef510dbebb32e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af98126766d8e9bca986b867b7eb080d1" id="r_af98126766d8e9bca986b867b7eb080d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#af98126766d8e9bca986b867b7eb080d1">test_integer_matrix_2</a> (self)</td></tr>
<tr class="separator:af98126766d8e9bca986b867b7eb080d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb64a7df0a61165a562058ec8d1a5f22" id="r_adb64a7df0a61165a562058ec8d1a5f22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#adb64a7df0a61165a562058ec8d1a5f22">test_triangularity_perturbation</a> (self)</td></tr>
<tr class="separator:adb64a7df0a61165a562058ec8d1a5f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e89d00971e4f4bf07089060b3e0e532" id="r_a8e89d00971e4f4bf07089060b3e0e532"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a8e89d00971e4f4bf07089060b3e0e532">test_burkardt_1</a> (self)</td></tr>
<tr class="separator:a8e89d00971e4f4bf07089060b3e0e532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add965e0eaada710bc5fd02cb24db153a" id="r_add965e0eaada710bc5fd02cb24db153a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#add965e0eaada710bc5fd02cb24db153a">test_burkardt_2</a> (self)</td></tr>
<tr class="separator:add965e0eaada710bc5fd02cb24db153a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1ae96c754dd116de6a2dd6997b8d6d8" id="r_aa1ae96c754dd116de6a2dd6997b8d6d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#aa1ae96c754dd116de6a2dd6997b8d6d8">test_burkardt_3</a> (self)</td></tr>
<tr class="separator:aa1ae96c754dd116de6a2dd6997b8d6d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c6fc585a5f2cc271f482e833990d438" id="r_a5c6fc585a5f2cc271f482e833990d438"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a5c6fc585a5f2cc271f482e833990d438">test_burkardt_4</a> (self)</td></tr>
<tr class="separator:a5c6fc585a5f2cc271f482e833990d438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d65990da34af25222345b47d4b7e64a" id="r_a1d65990da34af25222345b47d4b7e64a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a1d65990da34af25222345b47d4b7e64a">test_burkardt_5</a> (self)</td></tr>
<tr class="separator:a1d65990da34af25222345b47d4b7e64a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2641b6aa2b03cabb60be6bd07e3d7d36" id="r_a2641b6aa2b03cabb60be6bd07e3d7d36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a2641b6aa2b03cabb60be6bd07e3d7d36">test_burkardt_6</a> (self)</td></tr>
<tr class="separator:a2641b6aa2b03cabb60be6bd07e3d7d36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f03cd1a9d23ee3383d12234f276b3c" id="r_ad0f03cd1a9d23ee3383d12234f276b3c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#ad0f03cd1a9d23ee3383d12234f276b3c">test_burkardt_7</a> (self)</td></tr>
<tr class="separator:ad0f03cd1a9d23ee3383d12234f276b3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8184f5147542abf251f4ed3da438b5e" id="r_ab8184f5147542abf251f4ed3da438b5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#ab8184f5147542abf251f4ed3da438b5e">test_burkardt_8</a> (self)</td></tr>
<tr class="separator:ab8184f5147542abf251f4ed3da438b5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6aad90f0d22378b055294250d83cf14" id="r_ab6aad90f0d22378b055294250d83cf14"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#ab6aad90f0d22378b055294250d83cf14">test_burkardt_9</a> (self)</td></tr>
<tr class="separator:ab6aad90f0d22378b055294250d83cf14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5352521e5640a888cba24f2d3711ca42" id="r_a5352521e5640a888cba24f2d3711ca42"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a5352521e5640a888cba24f2d3711ca42">test_burkardt_10</a> (self)</td></tr>
<tr class="separator:a5352521e5640a888cba24f2d3711ca42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd22b4b123a4ab33d2d1b1010a909c09" id="r_afd22b4b123a4ab33d2d1b1010a909c09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#afd22b4b123a4ab33d2d1b1010a909c09">test_burkardt_11</a> (self)</td></tr>
<tr class="separator:afd22b4b123a4ab33d2d1b1010a909c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a815c68d6679a7e0ca5a25e6913b2aed9" id="r_a815c68d6679a7e0ca5a25e6913b2aed9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a815c68d6679a7e0ca5a25e6913b2aed9">test_burkardt_12</a> (self)</td></tr>
<tr class="separator:a815c68d6679a7e0ca5a25e6913b2aed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdfc4ebb8bbc66c2ab5d2f78c8704558" id="r_afdfc4ebb8bbc66c2ab5d2f78c8704558"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#afdfc4ebb8bbc66c2ab5d2f78c8704558">test_burkardt_13</a> (self)</td></tr>
<tr class="separator:afdfc4ebb8bbc66c2ab5d2f78c8704558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace70ae7d686d32ef8101b22bc99e0350" id="r_ace70ae7d686d32ef8101b22bc99e0350"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#ace70ae7d686d32ef8101b22bc99e0350">test_burkardt_14</a> (self)</td></tr>
<tr class="separator:ace70ae7d686d32ef8101b22bc99e0350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26ddabd3a53736b7e265f917297c5fc6" id="r_a26ddabd3a53736b7e265f917297c5fc6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a26ddabd3a53736b7e265f917297c5fc6">test_pascal</a> (self)</td></tr>
<tr class="separator:a26ddabd3a53736b7e265f917297c5fc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223a60823ea42881d75e2a1021bbc3a8" id="r_a223a60823ea42881d75e2a1021bbc3a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a223a60823ea42881d75e2a1021bbc3a8">test_matrix_input</a> (self)</td></tr>
<tr class="separator:a223a60823ea42881d75e2a1021bbc3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a3106c9ef186304501bf4252d3bba66" id="r_a9a3106c9ef186304501bf4252d3bba66"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__matfuncs_1_1_test_exp_m.html#a9a3106c9ef186304501bf4252d3bba66">test_exp_sinch_overflow</a> (self)</td></tr>
<tr class="separator:a9a3106c9ef186304501bf4252d3bba66"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a77b1872d1c68d0a7ed6c9c1db811dd56" name="a77b1872d1c68d0a7ed6c9c1db811dd56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77b1872d1c68d0a7ed6c9c1db811dd56">&#9670;&#160;</a></span>test_bidiagonal_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_bidiagonal_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   97</span>    <span class="keyword">def </span>test_bidiagonal_sparse(self):</div>
<div class="line"><span class="lineno">   98</span>        A = csc_matrix([</div>
<div class="line"><span class="lineno">   99</span>            [1, 3, 0],</div>
<div class="line"><span class="lineno">  100</span>            [0, 1, 5],</div>
<div class="line"><span class="lineno">  101</span>            [0, 0, 2]], dtype=float)</div>
<div class="line"><span class="lineno">  102</span>        e1 = math.exp(1)</div>
<div class="line"><span class="lineno">  103</span>        e2 = math.exp(2)</div>
<div class="line"><span class="lineno">  104</span>        expected = np.array([</div>
<div class="line"><span class="lineno">  105</span>            [e1, 3*e1, 15*(e2 - 2*e1)],</div>
<div class="line"><span class="lineno">  106</span>            [0, e1, 5*(e2 - e1)],</div>
<div class="line"><span class="lineno">  107</span>            [0, 0, e2]], dtype=float)</div>
<div class="line"><span class="lineno">  108</span>        observed = expm(A).toarray()</div>
<div class="line"><span class="lineno">  109</span>        assert_array_almost_equal(observed, expected)</div>
<div class="line"><span class="lineno">  110</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e89d00971e4f4bf07089060b3e0e532" name="a8e89d00971e4f4bf07089060b3e0e532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e89d00971e4f4bf07089060b3e0e532">&#9670;&#160;</a></span>test_burkardt_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  218</span>    <span class="keyword">def </span>test_burkardt_1(self):</div>
<div class="line"><span class="lineno">  219</span>        <span class="comment"># This matrix is diagonal.</span></div>
<div class="line"><span class="lineno">  220</span>        <span class="comment"># The calculation of the matrix exponential is simple.</span></div>
<div class="line"><span class="lineno">  221</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno">  222</span>        <span class="comment"># This is the first of a series of matrix exponential tests</span></div>
<div class="line"><span class="lineno">  223</span>        <span class="comment"># collected by John Burkardt from the following sources.</span></div>
<div class="line"><span class="lineno">  224</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno">  225</span>        <span class="comment"># Alan Laub,</span></div>
<div class="line"><span class="lineno">  226</span>        <span class="comment"># Review of &quot;Linear System Theory&quot; by Joao Hespanha,</span></div>
<div class="line"><span class="lineno">  227</span>        <span class="comment"># SIAM Review,</span></div>
<div class="line"><span class="lineno">  228</span>        <span class="comment"># Volume 52, Number 4, December 2010, pages 779--781.</span></div>
<div class="line"><span class="lineno">  229</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno">  230</span>        <span class="comment"># Cleve Moler and Charles Van Loan,</span></div>
<div class="line"><span class="lineno">  231</span>        <span class="comment"># Nineteen Dubious Ways to Compute the Exponential of a Matrix,</span></div>
<div class="line"><span class="lineno">  232</span>        <span class="comment"># Twenty-Five Years Later,</span></div>
<div class="line"><span class="lineno">  233</span>        <span class="comment"># SIAM Review,</span></div>
<div class="line"><span class="lineno">  234</span>        <span class="comment"># Volume 45, Number 1, March 2003, pages 3--49.</span></div>
<div class="line"><span class="lineno">  235</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno">  236</span>        <span class="comment"># Cleve Moler,</span></div>
<div class="line"><span class="lineno">  237</span>        <span class="comment"># Cleve&#39;s Corner: A Balancing Act for the Matrix Exponential,</span></div>
<div class="line"><span class="lineno">  238</span>        <span class="comment"># 23 July 2012.</span></div>
<div class="line"><span class="lineno">  239</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno">  240</span>        <span class="comment"># Robert Ward,</span></div>
<div class="line"><span class="lineno">  241</span>        <span class="comment"># Numerical computation of the matrix exponential</span></div>
<div class="line"><span class="lineno">  242</span>        <span class="comment"># with accuracy estimate,</span></div>
<div class="line"><span class="lineno">  243</span>        <span class="comment"># SIAM Journal on Numerical Analysis,</span></div>
<div class="line"><span class="lineno">  244</span>        <span class="comment"># Volume 14, Number 4, September 1977, pages 600--610.</span></div>
<div class="line"><span class="lineno">  245</span>        exp1 = np.exp(1)</div>
<div class="line"><span class="lineno">  246</span>        exp2 = np.exp(2)</div>
<div class="line"><span class="lineno">  247</span>        A = np.array([</div>
<div class="line"><span class="lineno">  248</span>            [1, 0],</div>
<div class="line"><span class="lineno">  249</span>            [0, 2],</div>
<div class="line"><span class="lineno">  250</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  251</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  252</span>            [exp1, 0],</div>
<div class="line"><span class="lineno">  253</span>            [0, exp2],</div>
<div class="line"><span class="lineno">  254</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  255</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  256</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  257</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5352521e5640a888cba24f2d3711ca42" name="a5352521e5640a888cba24f2d3711ca42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5352521e5640a888cba24f2d3711ca42">&#9670;&#160;</a></span>test_burkardt_10()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_10 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  397</span>    <span class="keyword">def </span>test_burkardt_10(self):</div>
<div class="line"><span class="lineno">  398</span>        <span class="comment"># This is Ward&#39;s example #1.</span></div>
<div class="line"><span class="lineno">  399</span>        <span class="comment"># It is defective and nonderogatory.</span></div>
<div class="line"><span class="lineno">  400</span>        A = np.array([</div>
<div class="line"><span class="lineno">  401</span>            [4, 2, 0],</div>
<div class="line"><span class="lineno">  402</span>            [1, 4, 1],</div>
<div class="line"><span class="lineno">  403</span>            [1, 1, 4],</div>
<div class="line"><span class="lineno">  404</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  405</span>        assert_allclose(sorted(scipy.linalg.eigvals(A)), (3, 3, 6))</div>
<div class="line"><span class="lineno">  406</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  407</span>            [147.8666224463699, 183.7651386463682, 71.79703239999647],</div>
<div class="line"><span class="lineno">  408</span>            [127.7810855231823, 183.7651386463682, 91.88256932318415],</div>
<div class="line"><span class="lineno">  409</span>            [127.7810855231824, 163.6796017231806, 111.9681062463718],</div>
<div class="line"><span class="lineno">  410</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  411</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  412</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  413</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afd22b4b123a4ab33d2d1b1010a909c09" name="afd22b4b123a4ab33d2d1b1010a909c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd22b4b123a4ab33d2d1b1010a909c09">&#9670;&#160;</a></span>test_burkardt_11()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_11 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  414</span>    <span class="keyword">def </span>test_burkardt_11(self):</div>
<div class="line"><span class="lineno">  415</span>        <span class="comment"># This is Ward&#39;s example #2.</span></div>
<div class="line"><span class="lineno">  416</span>        <span class="comment"># It is a symmetric matrix.</span></div>
<div class="line"><span class="lineno">  417</span>        A = np.array([</div>
<div class="line"><span class="lineno">  418</span>            [29.87942128909879, 0.7815750847907159, -2.289519314033932],</div>
<div class="line"><span class="lineno">  419</span>            [0.7815750847907159, 25.72656945571064, 8.680737820540137],</div>
<div class="line"><span class="lineno">  420</span>            [-2.289519314033932, 8.680737820540137, 34.39400925519054],</div>
<div class="line"><span class="lineno">  421</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  422</span>        assert_allclose(scipy.linalg.eigvalsh(A), (20, 30, 40))</div>
<div class="line"><span class="lineno">  423</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  424</span>             [</div>
<div class="line"><span class="lineno">  425</span>                 5.496313853692378E+15,</div>
<div class="line"><span class="lineno">  426</span>                 -1.823188097200898E+16,</div>
<div class="line"><span class="lineno">  427</span>                 -3.047577080858001E+16],</div>
<div class="line"><span class="lineno">  428</span>             [</div>
<div class="line"><span class="lineno">  429</span>                -1.823188097200899E+16,</div>
<div class="line"><span class="lineno">  430</span>                6.060522870222108E+16,</div>
<div class="line"><span class="lineno">  431</span>                1.012918429302482E+17],</div>
<div class="line"><span class="lineno">  432</span>             [</div>
<div class="line"><span class="lineno">  433</span>                -3.047577080858001E+16,</div>
<div class="line"><span class="lineno">  434</span>                1.012918429302482E+17,</div>
<div class="line"><span class="lineno">  435</span>                1.692944112408493E+17],</div>
<div class="line"><span class="lineno">  436</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  437</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  438</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  439</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a815c68d6679a7e0ca5a25e6913b2aed9" name="a815c68d6679a7e0ca5a25e6913b2aed9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a815c68d6679a7e0ca5a25e6913b2aed9">&#9670;&#160;</a></span>test_burkardt_12()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_12 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  440</span>    <span class="keyword">def </span>test_burkardt_12(self):</div>
<div class="line"><span class="lineno">  441</span>        <span class="comment"># This is Ward&#39;s example #3.</span></div>
<div class="line"><span class="lineno">  442</span>        <span class="comment"># Ward&#39;s algorithm has difficulty estimating the accuracy</span></div>
<div class="line"><span class="lineno">  443</span>        <span class="comment"># of its results.</span></div>
<div class="line"><span class="lineno">  444</span>        A = np.array([</div>
<div class="line"><span class="lineno">  445</span>            [-131, 19, 18],</div>
<div class="line"><span class="lineno">  446</span>            [-390, 56, 54],</div>
<div class="line"><span class="lineno">  447</span>            [-387, 57, 52],</div>
<div class="line"><span class="lineno">  448</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  449</span>        assert_allclose(sorted(scipy.linalg.eigvals(A)), (-20, -2, -1))</div>
<div class="line"><span class="lineno">  450</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  451</span>            [-1.509644158793135, 0.3678794391096522, 0.1353352811751005],</div>
<div class="line"><span class="lineno">  452</span>            [-5.632570799891469, 1.471517758499875, 0.4060058435250609],</div>
<div class="line"><span class="lineno">  453</span>            [-4.934938326088363, 1.103638317328798, 0.5413411267617766],</div>
<div class="line"><span class="lineno">  454</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  455</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  456</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  457</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afdfc4ebb8bbc66c2ab5d2f78c8704558" name="afdfc4ebb8bbc66c2ab5d2f78c8704558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdfc4ebb8bbc66c2ab5d2f78c8704558">&#9670;&#160;</a></span>test_burkardt_13()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_13 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  458</span>    <span class="keyword">def </span>test_burkardt_13(self):</div>
<div class="line"><span class="lineno">  459</span>        <span class="comment"># This is Ward&#39;s example #4.</span></div>
<div class="line"><span class="lineno">  460</span>        <span class="comment"># This is a version of the Forsythe matrix.</span></div>
<div class="line"><span class="lineno">  461</span>        <span class="comment"># The eigenvector problem is badly conditioned.</span></div>
<div class="line"><span class="lineno">  462</span>        <span class="comment"># Ward&#39;s algorithm has difficulty esimating the accuracy</span></div>
<div class="line"><span class="lineno">  463</span>        <span class="comment"># of its results for this problem.</span></div>
<div class="line"><span class="lineno">  464</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno">  465</span>        <span class="comment"># Check the construction of one instance of this family of matrices.</span></div>
<div class="line"><span class="lineno">  466</span>        A4_actual = _burkardt_13_power(4, 1)</div>
<div class="line"><span class="lineno">  467</span>        A4_desired = [[0, 1, 0, 0],</div>
<div class="line"><span class="lineno">  468</span>                      [0, 0, 1, 0],</div>
<div class="line"><span class="lineno">  469</span>                      [0, 0, 0, 1],</div>
<div class="line"><span class="lineno">  470</span>                      [1e-4, 0, 0, 0]]</div>
<div class="line"><span class="lineno">  471</span>        assert_allclose(A4_actual, A4_desired)</div>
<div class="line"><span class="lineno">  472</span>        <span class="comment"># Check the expm for a few instances.</span></div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">for</span> n <span class="keywordflow">in</span> (2, 3, 4, 10):</div>
<div class="line"><span class="lineno">  474</span>            <span class="comment"># Approximate expm using Taylor series.</span></div>
<div class="line"><span class="lineno">  475</span>            <span class="comment"># This works well for this matrix family</span></div>
<div class="line"><span class="lineno">  476</span>            <span class="comment"># because each matrix in the summation,</span></div>
<div class="line"><span class="lineno">  477</span>            <span class="comment"># even before dividing by the factorial,</span></div>
<div class="line"><span class="lineno">  478</span>            <span class="comment"># is entrywise positive with max entry 10**(-floor(p/n)*n).</span></div>
<div class="line"><span class="lineno">  479</span>            k = max(1, int(np.ceil(16/n)))</div>
<div class="line"><span class="lineno">  480</span>            desired = np.zeros((n, n), dtype=float)</div>
<div class="line"><span class="lineno">  481</span>            <span class="keywordflow">for</span> p <span class="keywordflow">in</span> range(n*k):</div>
<div class="line"><span class="lineno">  482</span>                Ap = _burkardt_13_power(n, p)</div>
<div class="line"><span class="lineno">  483</span>                assert_equal(np.min(Ap), 0)</div>
<div class="line"><span class="lineno">  484</span>                assert_allclose(np.max(Ap), np.power(10, -np.floor(p/n)*n))</div>
<div class="line"><span class="lineno">  485</span>                desired += Ap / factorial(p)</div>
<div class="line"><span class="lineno">  486</span>            actual = expm(_burkardt_13_power(n, 1))</div>
<div class="line"><span class="lineno">  487</span>            assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  488</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ace70ae7d686d32ef8101b22bc99e0350" name="ace70ae7d686d32ef8101b22bc99e0350"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace70ae7d686d32ef8101b22bc99e0350">&#9670;&#160;</a></span>test_burkardt_14()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_14 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  489</span>    <span class="keyword">def </span>test_burkardt_14(self):</div>
<div class="line"><span class="lineno">  490</span>        <span class="comment"># This is Moler&#39;s example.</span></div>
<div class="line"><span class="lineno">  491</span>        <span class="comment"># This badly scaled matrix caused problems for MATLAB&#39;s expm().</span></div>
<div class="line"><span class="lineno">  492</span>        A = np.array([</div>
<div class="line"><span class="lineno">  493</span>            [0, 1e-8, 0],</div>
<div class="line"><span class="lineno">  494</span>            [-(2e10 + 4e8/6.), -3, 2e10],</div>
<div class="line"><span class="lineno">  495</span>            [200./3., 0, -200./3.],</div>
<div class="line"><span class="lineno">  496</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  497</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  498</span>            [0.446849468283175, 1.54044157383952e-09, 0.462811453558774],</div>
<div class="line"><span class="lineno">  499</span>            [-5743067.77947947, -0.0152830038686819, -4526542.71278401],</div>
<div class="line"><span class="lineno">  500</span>            [0.447722977849494, 1.54270484519591e-09, 0.463480648837651],</div>
<div class="line"><span class="lineno">  501</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  502</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  503</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  504</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="add965e0eaada710bc5fd02cb24db153a" name="add965e0eaada710bc5fd02cb24db153a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add965e0eaada710bc5fd02cb24db153a">&#9670;&#160;</a></span>test_burkardt_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  258</span>    <span class="keyword">def </span>test_burkardt_2(self):</div>
<div class="line"><span class="lineno">  259</span>        <span class="comment"># This matrix is symmetric.</span></div>
<div class="line"><span class="lineno">  260</span>        <span class="comment"># The calculation of the matrix exponential is straightforward.</span></div>
<div class="line"><span class="lineno">  261</span>        A = np.array([</div>
<div class="line"><span class="lineno">  262</span>            [1, 3],</div>
<div class="line"><span class="lineno">  263</span>            [3, 2],</div>
<div class="line"><span class="lineno">  264</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  265</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  266</span>            [39.322809708033859, 46.166301438885753],</div>
<div class="line"><span class="lineno">  267</span>            [46.166301438885768, 54.711576854329110],</div>
<div class="line"><span class="lineno">  268</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  269</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  270</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  271</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1ae96c754dd116de6a2dd6997b8d6d8" name="aa1ae96c754dd116de6a2dd6997b8d6d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1ae96c754dd116de6a2dd6997b8d6d8">&#9670;&#160;</a></span>test_burkardt_3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_3 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  272</span>    <span class="keyword">def </span>test_burkardt_3(self):</div>
<div class="line"><span class="lineno">  273</span>        <span class="comment"># This example is due to Laub.</span></div>
<div class="line"><span class="lineno">  274</span>        <span class="comment"># This matrix is ill-suited for the Taylor series approach.</span></div>
<div class="line"><span class="lineno">  275</span>        <span class="comment"># As powers of A are computed, the entries blow up too quickly.</span></div>
<div class="line"><span class="lineno">  276</span>        exp1 = np.exp(1)</div>
<div class="line"><span class="lineno">  277</span>        exp39 = np.exp(39)</div>
<div class="line"><span class="lineno">  278</span>        A = np.array([</div>
<div class="line"><span class="lineno">  279</span>            [0, 1],</div>
<div class="line"><span class="lineno">  280</span>            [-39, -40],</div>
<div class="line"><span class="lineno">  281</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  282</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  283</span>            [</div>
<div class="line"><span class="lineno">  284</span>                39/(38*exp1) - 1/(38*exp39),</div>
<div class="line"><span class="lineno">  285</span>                -np.expm1(-38) / (38*exp1)],</div>
<div class="line"><span class="lineno">  286</span>            [</div>
<div class="line"><span class="lineno">  287</span>                39*np.expm1(-38) / (38*exp1),</div>
<div class="line"><span class="lineno">  288</span>                -1/(38*exp1) + 39/(38*exp39)],</div>
<div class="line"><span class="lineno">  289</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  290</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  291</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  292</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c6fc585a5f2cc271f482e833990d438" name="a5c6fc585a5f2cc271f482e833990d438"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c6fc585a5f2cc271f482e833990d438">&#9670;&#160;</a></span>test_burkardt_4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_4 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  293</span>    <span class="keyword">def </span>test_burkardt_4(self):</div>
<div class="line"><span class="lineno">  294</span>        <span class="comment"># This example is due to Moler and Van Loan.</span></div>
<div class="line"><span class="lineno">  295</span>        <span class="comment"># The example will cause problems for the series summation approach,</span></div>
<div class="line"><span class="lineno">  296</span>        <span class="comment"># as well as for diagonal Pade approximations.</span></div>
<div class="line"><span class="lineno">  297</span>        A = np.array([</div>
<div class="line"><span class="lineno">  298</span>            [-49, 24],</div>
<div class="line"><span class="lineno">  299</span>            [-64, 31],</div>
<div class="line"><span class="lineno">  300</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  301</span>        U = np.array([[3, 1], [4, 2]], dtype=float)</div>
<div class="line"><span class="lineno">  302</span>        V = np.array([[1, -1/2], [-2, 3/2]], dtype=float)</div>
<div class="line"><span class="lineno">  303</span>        w = np.array([-17, -1], dtype=float)</div>
<div class="line"><span class="lineno">  304</span>        desired = np.dot(U * np.exp(w), V)</div>
<div class="line"><span class="lineno">  305</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  306</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  307</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d65990da34af25222345b47d4b7e64a" name="a1d65990da34af25222345b47d4b7e64a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d65990da34af25222345b47d4b7e64a">&#9670;&#160;</a></span>test_burkardt_5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_5 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  308</span>    <span class="keyword">def </span>test_burkardt_5(self):</div>
<div class="line"><span class="lineno">  309</span>        <span class="comment"># This example is due to Moler and Van Loan.</span></div>
<div class="line"><span class="lineno">  310</span>        <span class="comment"># This matrix is strictly upper triangular</span></div>
<div class="line"><span class="lineno">  311</span>        <span class="comment"># All powers of A are zero beyond some (low) limit.</span></div>
<div class="line"><span class="lineno">  312</span>        <span class="comment"># This example will cause problems for Pade approximations.</span></div>
<div class="line"><span class="lineno">  313</span>        A = np.array([</div>
<div class="line"><span class="lineno">  314</span>            [0, 6, 0, 0],</div>
<div class="line"><span class="lineno">  315</span>            [0, 0, 6, 0],</div>
<div class="line"><span class="lineno">  316</span>            [0, 0, 0, 6],</div>
<div class="line"><span class="lineno">  317</span>            [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  318</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  319</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  320</span>            [1, 6, 18, 36],</div>
<div class="line"><span class="lineno">  321</span>            [0, 1, 6, 18],</div>
<div class="line"><span class="lineno">  322</span>            [0, 0, 1, 6],</div>
<div class="line"><span class="lineno">  323</span>            [0, 0, 0, 1],</div>
<div class="line"><span class="lineno">  324</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  325</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  326</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  327</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2641b6aa2b03cabb60be6bd07e3d7d36" name="a2641b6aa2b03cabb60be6bd07e3d7d36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2641b6aa2b03cabb60be6bd07e3d7d36">&#9670;&#160;</a></span>test_burkardt_6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_6 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  328</span>    <span class="keyword">def </span>test_burkardt_6(self):</div>
<div class="line"><span class="lineno">  329</span>        <span class="comment"># This example is due to Moler and Van Loan.</span></div>
<div class="line"><span class="lineno">  330</span>        <span class="comment"># This matrix does not have a complete set of eigenvectors.</span></div>
<div class="line"><span class="lineno">  331</span>        <span class="comment"># That means the eigenvector approach will fail.</span></div>
<div class="line"><span class="lineno">  332</span>        exp1 = np.exp(1)</div>
<div class="line"><span class="lineno">  333</span>        A = np.array([</div>
<div class="line"><span class="lineno">  334</span>            [1, 1],</div>
<div class="line"><span class="lineno">  335</span>            [0, 1],</div>
<div class="line"><span class="lineno">  336</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  337</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  338</span>            [exp1, exp1],</div>
<div class="line"><span class="lineno">  339</span>            [0, exp1],</div>
<div class="line"><span class="lineno">  340</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  341</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  342</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  343</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0f03cd1a9d23ee3383d12234f276b3c" name="ad0f03cd1a9d23ee3383d12234f276b3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0f03cd1a9d23ee3383d12234f276b3c">&#9670;&#160;</a></span>test_burkardt_7()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_7 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  344</span>    <span class="keyword">def </span>test_burkardt_7(self):</div>
<div class="line"><span class="lineno">  345</span>        <span class="comment"># This example is due to Moler and Van Loan.</span></div>
<div class="line"><span class="lineno">  346</span>        <span class="comment"># This matrix is very close to example 5.</span></div>
<div class="line"><span class="lineno">  347</span>        <span class="comment"># Mathematically, it has a complete set of eigenvectors.</span></div>
<div class="line"><span class="lineno">  348</span>        <span class="comment"># Numerically, however, the calculation will be suspect.</span></div>
<div class="line"><span class="lineno">  349</span>        exp1 = np.exp(1)</div>
<div class="line"><span class="lineno">  350</span>        eps = np.spacing(1)</div>
<div class="line"><span class="lineno">  351</span>        A = np.array([</div>
<div class="line"><span class="lineno">  352</span>            [1 + eps, 1],</div>
<div class="line"><span class="lineno">  353</span>            [0, 1 - eps],</div>
<div class="line"><span class="lineno">  354</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  355</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  356</span>            [exp1, exp1],</div>
<div class="line"><span class="lineno">  357</span>            [0, exp1],</div>
<div class="line"><span class="lineno">  358</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  359</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  360</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  361</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8184f5147542abf251f4ed3da438b5e" name="ab8184f5147542abf251f4ed3da438b5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8184f5147542abf251f4ed3da438b5e">&#9670;&#160;</a></span>test_burkardt_8()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_8 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  362</span>    <span class="keyword">def </span>test_burkardt_8(self):</div>
<div class="line"><span class="lineno">  363</span>        <span class="comment"># This matrix was an example in Wikipedia.</span></div>
<div class="line"><span class="lineno">  364</span>        exp4 = np.exp(4)</div>
<div class="line"><span class="lineno">  365</span>        exp16 = np.exp(16)</div>
<div class="line"><span class="lineno">  366</span>        A = np.array([</div>
<div class="line"><span class="lineno">  367</span>            [21, 17, 6],</div>
<div class="line"><span class="lineno">  368</span>            [-5, -1, -6],</div>
<div class="line"><span class="lineno">  369</span>            [4, 4, 16],</div>
<div class="line"><span class="lineno">  370</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  371</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  372</span>            [13*exp16 - exp4, 13*exp16 - 5*exp4, 2*exp16 - 2*exp4],</div>
<div class="line"><span class="lineno">  373</span>            [-9*exp16 + exp4, -9*exp16 + 5*exp4, -2*exp16 + 2*exp4],</div>
<div class="line"><span class="lineno">  374</span>            [16*exp16, 16*exp16, 4*exp16],</div>
<div class="line"><span class="lineno">  375</span>            ], dtype=float) * 0.25</div>
<div class="line"><span class="lineno">  376</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  377</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  378</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6aad90f0d22378b055294250d83cf14" name="ab6aad90f0d22378b055294250d83cf14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6aad90f0d22378b055294250d83cf14">&#9670;&#160;</a></span>test_burkardt_9()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_burkardt_9 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  379</span>    <span class="keyword">def </span>test_burkardt_9(self):</div>
<div class="line"><span class="lineno">  380</span>        <span class="comment"># This matrix is due to the NAG Library.</span></div>
<div class="line"><span class="lineno">  381</span>        <span class="comment"># It is an example for function F01ECF.</span></div>
<div class="line"><span class="lineno">  382</span>        A = np.array([</div>
<div class="line"><span class="lineno">  383</span>            [1, 2, 2, 2],</div>
<div class="line"><span class="lineno">  384</span>            [3, 1, 1, 2],</div>
<div class="line"><span class="lineno">  385</span>            [3, 2, 1, 2],</div>
<div class="line"><span class="lineno">  386</span>            [3, 3, 3, 1],</div>
<div class="line"><span class="lineno">  387</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  388</span>        desired = np.array([</div>
<div class="line"><span class="lineno">  389</span>            [740.7038, 610.8500, 542.2743, 549.1753],</div>
<div class="line"><span class="lineno">  390</span>            [731.2510, 603.5524, 535.0884, 542.2743],</div>
<div class="line"><span class="lineno">  391</span>            [823.7630, 679.4257, 603.5524, 610.8500],</div>
<div class="line"><span class="lineno">  392</span>            [998.4355, 823.7630, 731.2510, 740.7038],</div>
<div class="line"><span class="lineno">  393</span>            ], dtype=float)</div>
<div class="line"><span class="lineno">  394</span>        actual = expm(A)</div>
<div class="line"><span class="lineno">  395</span>        assert_allclose(actual, desired)</div>
<div class="line"><span class="lineno">  396</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a3106c9ef186304501bf4252d3bba66" name="a9a3106c9ef186304501bf4252d3bba66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a3106c9ef186304501bf4252d3bba66">&#9670;&#160;</a></span>test_exp_sinch_overflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_exp_sinch_overflow </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  535</span>    <span class="keyword">def </span>test_exp_sinch_overflow(self):</div>
<div class="line"><span class="lineno">  536</span>        <span class="comment"># Check overflow in intermediate steps is fixed (gh-11839)</span></div>
<div class="line"><span class="lineno">  537</span>        L = np.array([[1.0, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">  538</span>                      [0.0, 1.0, 0.0, -0.5, -0.5, 0.0, 0.0],</div>
<div class="line"><span class="lineno">  539</span>                      [0.0, 0.0, 1.0, 0.0, 0.0, -0.5, -0.5],</div>
<div class="line"><span class="lineno">  540</span>                      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">  541</span>                      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">  542</span>                      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">  543</span>                      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]])</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>        E0 = expm(-L)</div>
<div class="line"><span class="lineno">  546</span>        E1 = expm(-2**11 * L)</div>
<div class="line"><span class="lineno">  547</span>        E2 = E0</div>
<div class="line"><span class="lineno">  548</span>        <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(11):</div>
<div class="line"><span class="lineno">  549</span>            E2 = E2 @ E2</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>        assert_allclose(E1, E2)</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1535de277f08815dfef510dbebb32e9f" name="a1535de277f08815dfef510dbebb32e9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1535de277f08815dfef510dbebb32e9f">&#9670;&#160;</a></span>test_integer_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_integer_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  163</span>    <span class="keyword">def </span>test_integer_matrix(self):</div>
<div class="line"><span class="lineno">  164</span>        Q = np.array([</div>
<div class="line"><span class="lineno">  165</span>            [-3, 1, 1, 1],</div>
<div class="line"><span class="lineno">  166</span>            [1, -3, 1, 1],</div>
<div class="line"><span class="lineno">  167</span>            [1, 1, -3, 1],</div>
<div class="line"><span class="lineno">  168</span>            [1, 1, 1, -3]])</div>
<div class="line"><span class="lineno">  169</span>        assert_allclose(expm(Q), expm(1.0 * Q))</div>
<div class="line"><span class="lineno">  170</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af98126766d8e9bca986b867b7eb080d1" name="af98126766d8e9bca986b867b7eb080d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af98126766d8e9bca986b867b7eb080d1">&#9670;&#160;</a></span>test_integer_matrix_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_integer_matrix_2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  171</span>    <span class="keyword">def </span>test_integer_matrix_2(self):</div>
<div class="line"><span class="lineno">  172</span>        <span class="comment"># Check for integer overflows</span></div>
<div class="line"><span class="lineno">  173</span>        Q = np.array([[-500, 500, 0, 0],</div>
<div class="line"><span class="lineno">  174</span>                      [0, -550, 360, 190],</div>
<div class="line"><span class="lineno">  175</span>                      [0, 630, -630, 0],</div>
<div class="line"><span class="lineno">  176</span>                      [0, 0, 0, 0]], dtype=np.int16)</div>
<div class="line"><span class="lineno">  177</span>        assert_allclose(expm(Q), expm(1.0 * Q))</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>        Q = csc_matrix(Q)</div>
<div class="line"><span class="lineno">  180</span>        assert_allclose(expm(Q).A, expm(1.0 * Q).A)</div>
<div class="line"><span class="lineno">  181</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a342ac465a17baf8c7032a044f32f74de" name="a342ac465a17baf8c7032a044f32f74de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342ac465a17baf8c7032a044f32f74de">&#9670;&#160;</a></span>test_logm_consistency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_logm_consistency </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  152</span>    <span class="keyword">def </span>test_logm_consistency(self):</div>
<div class="line"><span class="lineno">  153</span>        random.seed(1234)</div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">for</span> dtype <span class="keywordflow">in</span> [np.float64, np.complex128]:</div>
<div class="line"><span class="lineno">  155</span>            <span class="keywordflow">for</span> n <span class="keywordflow">in</span> range(1, 10):</div>
<div class="line"><span class="lineno">  156</span>                <span class="keywordflow">for</span> scale <span class="keywordflow">in</span> [1e-4, 1e-3, 1e-2, 1e-1, 1, 1e1, 1e2]:</div>
<div class="line"><span class="lineno">  157</span>                    <span class="comment"># make logm(A) be of a given scale</span></div>
<div class="line"><span class="lineno">  158</span>                    A = (eye(n) + random.rand(n, n) * scale).astype(dtype)</div>
<div class="line"><span class="lineno">  159</span>                    <span class="keywordflow">if</span> np.iscomplexobj(A):</div>
<div class="line"><span class="lineno">  160</span>                        A = A + 1j * random.rand(n, n) * scale</div>
<div class="line"><span class="lineno">  161</span>                    assert_array_almost_equal(expm(logm(A)), A)</div>
<div class="line"><span class="lineno">  162</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a223a60823ea42881d75e2a1021bbc3a8" name="a223a60823ea42881d75e2a1021bbc3a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a223a60823ea42881d75e2a1021bbc3a8">&#9670;&#160;</a></span>test_matrix_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_matrix_input </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  524</span>    <span class="keyword">def </span>test_matrix_input(self):</div>
<div class="line"><span class="lineno">  525</span>        <span class="comment"># Large np.matrix inputs should work, gh-5546</span></div>
<div class="line"><span class="lineno">  526</span>        A = np.zeros((200, 200))</div>
<div class="line"><span class="lineno">  527</span>        A[-1,0] = 1</div>
<div class="line"><span class="lineno">  528</span>        B0 = expm(A)</div>
<div class="line"><span class="lineno">  529</span>        <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno">  530</span>            sup.filter(DeprecationWarning, <span class="stringliteral">&quot;the matrix subclass.*&quot;</span>)</div>
<div class="line"><span class="lineno">  531</span>            sup.filter(PendingDeprecationWarning, <span class="stringliteral">&quot;the matrix subclass.*&quot;</span>)</div>
<div class="line"><span class="lineno">  532</span>            B = expm(np.matrix(A))</div>
<div class="line"><span class="lineno">  533</span>        assert_allclose(B, B0)</div>
<div class="line"><span class="lineno">  534</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aba2004b8983065f9fc3c2933b9038ae1" name="aba2004b8983065f9fc3c2933b9038ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba2004b8983065f9fc3c2933b9038ae1">&#9670;&#160;</a></span>test_misc_types()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_misc_types </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   84</span>    <span class="keyword">def </span>test_misc_types(self):</div>
<div class="line"><span class="lineno">   85</span>        A = expm(np.array([[1]]))</div>
<div class="line"><span class="lineno">   86</span>        assert_allclose(expm(((1,),)), A)</div>
<div class="line"><span class="lineno">   87</span>        assert_allclose(expm([[1]]), A)</div>
<div class="line"><span class="lineno">   88</span>        assert_allclose(expm(matrix([[1]])), A)</div>
<div class="line"><span class="lineno">   89</span>        assert_allclose(expm(np.array([[1]])), A)</div>
<div class="line"><span class="lineno">   90</span>        assert_allclose(expm(csc_matrix([[1]])).A, A)</div>
<div class="line"><span class="lineno">   91</span>        B = expm(np.array([[1j]]))</div>
<div class="line"><span class="lineno">   92</span>        assert_allclose(expm(((1j,),)), B)</div>
<div class="line"><span class="lineno">   93</span>        assert_allclose(expm([[1j]]), B)</div>
<div class="line"><span class="lineno">   94</span>        assert_allclose(expm(matrix([[1j]])), B)</div>
<div class="line"><span class="lineno">   95</span>        assert_allclose(expm(csc_matrix([[1j]])).A, B)</div>
<div class="line"><span class="lineno">   96</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a12246a45e07fa3f4548952d0f2703fb5" name="a12246a45e07fa3f4548952d0f2703fb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12246a45e07fa3f4548952d0f2703fb5">&#9670;&#160;</a></span>test_padecases_dtype_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_padecases_dtype_complex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  119</span>    <span class="keyword">def </span>test_padecases_dtype_complex(self):</div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordflow">for</span> dtype <span class="keywordflow">in</span> [np.complex64, np.complex128]:</div>
<div class="line"><span class="lineno">  121</span>            <span class="keywordflow">for</span> scale <span class="keywordflow">in</span> [1e-2, 1e-1, 5e-1, 1, 10]:</div>
<div class="line"><span class="lineno">  122</span>                A = scale * eye(3, dtype=dtype)</div>
<div class="line"><span class="lineno">  123</span>                observed = expm(A)</div>
<div class="line"><span class="lineno">  124</span>                expected = exp(scale) * eye(3, dtype=dtype)</div>
<div class="line"><span class="lineno">  125</span>                assert_array_almost_equal_nulp(observed, expected, nulp=100)</div>
<div class="line"><span class="lineno">  126</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b290aa6d61a32336d81896a2f2240f7" name="a1b290aa6d61a32336d81896a2f2240f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b290aa6d61a32336d81896a2f2240f7">&#9670;&#160;</a></span>test_padecases_dtype_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_padecases_dtype_float </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  111</span>    <span class="keyword">def </span>test_padecases_dtype_float(self):</div>
<div class="line"><span class="lineno">  112</span>        <span class="keywordflow">for</span> dtype <span class="keywordflow">in</span> [np.float32, np.float64]:</div>
<div class="line"><span class="lineno">  113</span>            <span class="keywordflow">for</span> scale <span class="keywordflow">in</span> [1e-2, 1e-1, 5e-1, 1, 10]:</div>
<div class="line"><span class="lineno">  114</span>                A = scale * eye(3, dtype=dtype)</div>
<div class="line"><span class="lineno">  115</span>                observed = expm(A)</div>
<div class="line"><span class="lineno">  116</span>                expected = exp(scale) * eye(3, dtype=dtype)</div>
<div class="line"><span class="lineno">  117</span>                assert_array_almost_equal_nulp(observed, expected, nulp=100)</div>
<div class="line"><span class="lineno">  118</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a57876857cc4c0fdfd06439ca2f99840f" name="a57876857cc4c0fdfd06439ca2f99840f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57876857cc4c0fdfd06439ca2f99840f">&#9670;&#160;</a></span>test_padecases_dtype_sparse_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_padecases_dtype_sparse_complex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  141</span>    <span class="keyword">def </span>test_padecases_dtype_sparse_complex(self):</div>
<div class="line"><span class="lineno">  142</span>        <span class="comment"># float32 and complex64 lead to errors in spsolve/UMFpack</span></div>
<div class="line"><span class="lineno">  143</span>        dtype = np.complex128</div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">for</span> scale <span class="keywordflow">in</span> [1e-2, 1e-1, 5e-1, 1, 10]:</div>
<div class="line"><span class="lineno">  145</span>            a = scale * speye(3, 3, dtype=dtype, format=<span class="stringliteral">&#39;csc&#39;</span>)</div>
<div class="line"><span class="lineno">  146</span>            e = exp(scale) * eye(3, dtype=dtype)</div>
<div class="line"><span class="lineno">  147</span>            <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno">  148</span>                sup.filter(SparseEfficiencyWarning,</div>
<div class="line"><span class="lineno">  149</span>                           <span class="stringliteral">&quot;Changing the sparsity structure of a csc_matrix is expensive.&quot;</span>)</div>
<div class="line"><span class="lineno">  150</span>                assert_array_almost_equal_nulp(expm(a).toarray(), e, nulp=100)</div>
<div class="line"><span class="lineno">  151</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af55020d1ca313118b309fe8a057fa581" name="af55020d1ca313118b309fe8a057fa581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af55020d1ca313118b309fe8a057fa581">&#9670;&#160;</a></span>test_padecases_dtype_sparse_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_padecases_dtype_sparse_float </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  127</span>    <span class="keyword">def </span>test_padecases_dtype_sparse_float(self):</div>
<div class="line"><span class="lineno">  128</span>        <span class="comment"># float32 and complex64 lead to errors in spsolve/UMFpack</span></div>
<div class="line"><span class="lineno">  129</span>        dtype = np.float64</div>
<div class="line"><span class="lineno">  130</span>        <span class="keywordflow">for</span> scale <span class="keywordflow">in</span> [1e-2, 1e-1, 5e-1, 1, 10]:</div>
<div class="line"><span class="lineno">  131</span>            a = scale * speye(3, 3, dtype=dtype, format=<span class="stringliteral">&#39;csc&#39;</span>)</div>
<div class="line"><span class="lineno">  132</span>            e = exp(scale) * eye(3, dtype=dtype)</div>
<div class="line"><span class="lineno">  133</span>            <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno">  134</span>                sup.filter(SparseEfficiencyWarning,</div>
<div class="line"><span class="lineno">  135</span>                           <span class="stringliteral">&quot;Changing the sparsity structure of a csc_matrix is expensive.&quot;</span>)</div>
<div class="line"><span class="lineno">  136</span>                exact_onenorm = _expm(a, use_exact_onenorm=<span class="keyword">True</span>).toarray()</div>
<div class="line"><span class="lineno">  137</span>                inexact_onenorm = _expm(a, use_exact_onenorm=<span class="keyword">False</span>).toarray()</div>
<div class="line"><span class="lineno">  138</span>            assert_array_almost_equal_nulp(exact_onenorm, e, nulp=100)</div>
<div class="line"><span class="lineno">  139</span>            assert_array_almost_equal_nulp(inexact_onenorm, e, nulp=100)</div>
<div class="line"><span class="lineno">  140</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a26ddabd3a53736b7e265f917297c5fc6" name="a26ddabd3a53736b7e265f917297c5fc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26ddabd3a53736b7e265f917297c5fc6">&#9670;&#160;</a></span>test_pascal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_pascal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  505</span>    <span class="keyword">def </span>test_pascal(self):</div>
<div class="line"><span class="lineno">  506</span>        <span class="comment"># Test pascal triangle.</span></div>
<div class="line"><span class="lineno">  507</span>        <span class="comment"># Nilpotent exponential, used to trigger a failure (gh-8029)</span></div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">for</span> scale <span class="keywordflow">in</span> [1.0, 1e-3, 1e-6]:</div>
<div class="line"><span class="lineno">  510</span>            <span class="keywordflow">for</span> n <span class="keywordflow">in</span> range(0, 80, 3):</div>
<div class="line"><span class="lineno">  511</span>                sc = scale ** np.arange(n, -1, -1)</div>
<div class="line"><span class="lineno">  512</span>                <span class="keywordflow">if</span> np.any(sc &lt; 1e-300):</div>
<div class="line"><span class="lineno">  513</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>                A = np.diag(np.arange(1, n + 1), -1) * scale</div>
<div class="line"><span class="lineno">  516</span>                B = expm(A)</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>                got = B</div>
<div class="line"><span class="lineno">  519</span>                expected = binom(np.arange(n + 1)[:,<span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  520</span>                                 np.arange(n + 1)[<span class="keywordtype">None</span>,:]) * sc[<span class="keywordtype">None</span>,:] / sc[:,<span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  521</span>                atol = 1e-13 * abs(expected).max()</div>
<div class="line"><span class="lineno">  522</span>                assert_allclose(got, expected, atol=atol)</div>
<div class="line"><span class="lineno">  523</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adb64a7df0a61165a562058ec8d1a5f22" name="adb64a7df0a61165a562058ec8d1a5f22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb64a7df0a61165a562058ec8d1a5f22">&#9670;&#160;</a></span>test_triangularity_perturbation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_triangularity_perturbation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  182</span>    <span class="keyword">def </span>test_triangularity_perturbation(self):</div>
<div class="line"><span class="lineno">  183</span>        <span class="comment"># Experiment (1) of</span></div>
<div class="line"><span class="lineno">  184</span>        <span class="comment"># Awad H. Al-Mohy and Nicholas J. Higham (2012)</span></div>
<div class="line"><span class="lineno">  185</span>        <span class="comment"># Improved Inverse Scaling and Squaring Algorithms</span></div>
<div class="line"><span class="lineno">  186</span>        <span class="comment"># for the Matrix Logarithm.</span></div>
<div class="line"><span class="lineno">  187</span>        A = np.array([</div>
<div class="line"><span class="lineno">  188</span>            [3.2346e-1, 3e4, 3e4, 3e4],</div>
<div class="line"><span class="lineno">  189</span>            [0, 3.0089e-1, 3e4, 3e4],</div>
<div class="line"><span class="lineno">  190</span>            [0, 0, 3.221e-1, 3e4],</div>
<div class="line"><span class="lineno">  191</span>            [0, 0, 0, 3.0744e-1]],</div>
<div class="line"><span class="lineno">  192</span>            dtype=float)</div>
<div class="line"><span class="lineno">  193</span>        A_logm = np.array([</div>
<div class="line"><span class="lineno">  194</span>            [-1.12867982029050462e+00, 9.61418377142025565e+04,</div>
<div class="line"><span class="lineno">  195</span>             -4.52485573953179264e+09, 2.92496941103871812e+14],</div>
<div class="line"><span class="lineno">  196</span>            [0.00000000000000000e+00, -1.20101052953082288e+00,</div>
<div class="line"><span class="lineno">  197</span>             9.63469687211303099e+04, -4.68104828911105442e+09],</div>
<div class="line"><span class="lineno">  198</span>            [0.00000000000000000e+00, 0.00000000000000000e+00,</div>
<div class="line"><span class="lineno">  199</span>             -1.13289322264498393e+00, 9.53249183094775653e+04],</div>
<div class="line"><span class="lineno">  200</span>            [0.00000000000000000e+00, 0.00000000000000000e+00,</div>
<div class="line"><span class="lineno">  201</span>             0.00000000000000000e+00, -1.17947533272554850e+00]],</div>
<div class="line"><span class="lineno">  202</span>            dtype=float)</div>
<div class="line"><span class="lineno">  203</span>        assert_allclose(expm(A_logm), A, rtol=1e-4)</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>        <span class="comment"># Perturb the upper triangular matrix by tiny amounts,</span></div>
<div class="line"><span class="lineno">  206</span>        <span class="comment"># so that it becomes technically not upper triangular.</span></div>
<div class="line"><span class="lineno">  207</span>        random.seed(1234)</div>
<div class="line"><span class="lineno">  208</span>        tiny = 1e-17</div>
<div class="line"><span class="lineno">  209</span>        A_logm_perturbed = A_logm.copy()</div>
<div class="line"><span class="lineno">  210</span>        A_logm_perturbed[1, 0] = tiny</div>
<div class="line"><span class="lineno">  211</span>        <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno">  212</span>            sup.filter(RuntimeWarning, <span class="stringliteral">&quot;Ill-conditioned.*&quot;</span>)</div>
<div class="line"><span class="lineno">  213</span>            A_expm_logm_perturbed = expm(A_logm_perturbed)</div>
<div class="line"><span class="lineno">  214</span>        rtol = 1e-4</div>
<div class="line"><span class="lineno">  215</span>        atol = 100 * tiny</div>
<div class="line"><span class="lineno">  216</span>        assert_(<span class="keywordflow">not</span> np.allclose(A_expm_logm_perturbed, A, rtol=rtol, atol=atol))</div>
<div class="line"><span class="lineno">  217</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a928f1a896fd21a736a267d0a7eb24c9b" name="a928f1a896fd21a736a267d0a7eb24c9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a928f1a896fd21a736a267d0a7eb24c9b">&#9670;&#160;</a></span>test_zero_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_zero_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   80</span>    <span class="keyword">def </span>test_zero_matrix(self):</div>
<div class="line"><span class="lineno">   81</span>        a = matrix([[0.,0],[0,0]])</div>
<div class="line"><span class="lineno">   82</span>        assert_array_almost_equal(expm(a),[[1,0],[0,1]])</div>
<div class="line"><span class="lineno">   83</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8dcf956ade75310968f00acc7c756c68" name="a8dcf956ade75310968f00acc7c756c68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dcf956ade75310968f00acc7c756c68">&#9670;&#160;</a></span>test_zero_ndarray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_zero_ndarray </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   72</span>    <span class="keyword">def </span>test_zero_ndarray(self):</div>
<div class="line"><span class="lineno">   73</span>        a = array([[0.,0],[0,0]])</div>
<div class="line"><span class="lineno">   74</span>        assert_array_almost_equal(expm(a),[[1,0],[0,1]])</div>
<div class="line"><span class="lineno">   75</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4723f9876f45da9d2f22c580f7583be" name="ae4723f9876f45da9d2f22c580f7583be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4723f9876f45da9d2f22c580f7583be">&#9670;&#160;</a></span>test_zero_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg.tests.test_matfuncs.TestExpM.test_zero_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   76</span>    <span class="keyword">def </span>test_zero_sparse(self):</div>
<div class="line"><span class="lineno">   77</span>        a = csc_matrix([[0.,0],[0,0]])</div>
<div class="line"><span class="lineno">   78</span>        assert_array_almost_equal(expm(a).toarray(),[[1,0],[0,1]])</div>
<div class="line"><span class="lineno">   79</span> </div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/scipy/sparse/linalg/tests/<a class="el" href="sparse_2linalg_2tests_2test__matfuncs_8py.html">test_matfuncs.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
