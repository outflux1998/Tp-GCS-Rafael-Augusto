<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.cluster.tests.test_k_means Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1cluster.html">cluster</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1cluster_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html">test_k_means</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sklearn.cluster.tests.test_k_means Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a469c403060eea4fcbda0850fae03a5e6" id="r_a469c403060eea4fcbda0850fae03a5e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a469c403060eea4fcbda0850fae03a5e6">test_kmeans_results</a> (array_constr, algo, dtype)</td></tr>
<tr class="separator:a469c403060eea4fcbda0850fae03a5e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ebafdf54702a24bb7dfb856d24128eb" id="r_a7ebafdf54702a24bb7dfb856d24128eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a7ebafdf54702a24bb7dfb856d24128eb">test_kmeans_relocated_clusters</a> (array_constr, algo)</td></tr>
<tr class="separator:a7ebafdf54702a24bb7dfb856d24128eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c0c54948be9aba741ef5a1b2d4b408" id="r_a98c0c54948be9aba741ef5a1b2d4b408"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a98c0c54948be9aba741ef5a1b2d4b408">test_relocate_empty_clusters</a> (array_constr)</td></tr>
<tr class="separator:a98c0c54948be9aba741ef5a1b2d4b408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25613257604a7c19e044ec33ee5042cc" id="r_a25613257604a7c19e044ec33ee5042cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a25613257604a7c19e044ec33ee5042cc">test_kmeans_elkan_results</a> (distribution, array_constr, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>, global_random_seed)</td></tr>
<tr class="separator:a25613257604a7c19e044ec33ee5042cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31eeecd9b44095699b379deb8734b60" id="r_af31eeecd9b44095699b379deb8734b60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#af31eeecd9b44095699b379deb8734b60">test_kmeans_convergence</a> (algorithm, global_random_seed)</td></tr>
<tr class="separator:af31eeecd9b44095699b379deb8734b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac489e5f43d4a4b16825385afbc677b46" id="r_ac489e5f43d4a4b16825385afbc677b46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ac489e5f43d4a4b16825385afbc677b46">test_algorithm_auto_full_deprecation_warning</a> (algorithm)</td></tr>
<tr class="separator:ac489e5f43d4a4b16825385afbc677b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a680e4b7bd70d5a3fa79d3e55f9dc84ca" id="r_a680e4b7bd70d5a3fa79d3e55f9dc84ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a680e4b7bd70d5a3fa79d3e55f9dc84ca">test_minibatch_update_consistency</a> (global_random_seed)</td></tr>
<tr class="separator:a680e4b7bd70d5a3fa79d3e55f9dc84ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade63a61587460325ff162067d4789556" id="r_ade63a61587460325ff162067d4789556"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ade63a61587460325ff162067d4789556">_check_fitted_model</a> (km)</td></tr>
<tr class="separator:ade63a61587460325ff162067d4789556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c5f86307ab3685a434e56785d9c5520" id="r_a4c5f86307ab3685a434e56785d9c5520"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a4c5f86307ab3685a434e56785d9c5520">test_all_init</a> (Estimator, data, init)</td></tr>
<tr class="separator:a4c5f86307ab3685a434e56785d9c5520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa393ca95e1017b89b1233ffc764b9e" id="r_a5fa393ca95e1017b89b1233ffc764b9e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a5fa393ca95e1017b89b1233ffc764b9e">test_minibatch_kmeans_partial_fit_init</a> (init)</td></tr>
<tr class="separator:a5fa393ca95e1017b89b1233ffc764b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae907d4ea0029b0756f475b78b91b4a60" id="r_ae907d4ea0029b0756f475b78b91b4a60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ae907d4ea0029b0756f475b78b91b4a60">test_fortran_aligned_data</a> (Estimator, global_random_seed)</td></tr>
<tr class="separator:ae907d4ea0029b0756f475b78b91b4a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6646124bdd39f6f8f5717a24163cf15" id="r_ae6646124bdd39f6f8f5717a24163cf15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ae6646124bdd39f6f8f5717a24163cf15">test_minibatch_kmeans_verbose</a> ()</td></tr>
<tr class="separator:ae6646124bdd39f6f8f5717a24163cf15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a200f1ff9768ae299ed6f7aaf04e9d4ac" id="r_a200f1ff9768ae299ed6f7aaf04e9d4ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a200f1ff9768ae299ed6f7aaf04e9d4ac">test_kmeans_verbose</a> (algorithm, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>, capsys)</td></tr>
<tr class="separator:a200f1ff9768ae299ed6f7aaf04e9d4ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6d8f2bfd39f3f5c9d3ffc7471dd2cc" id="r_a3a6d8f2bfd39f3f5c9d3ffc7471dd2cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a3a6d8f2bfd39f3f5c9d3ffc7471dd2cc">test_minibatch_kmeans_warning_init_size</a> ()</td></tr>
<tr class="separator:a3a6d8f2bfd39f3f5c9d3ffc7471dd2cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc8c99d9c3431e7be093ed3fcf4e606" id="r_aedc8c99d9c3431e7be093ed3fcf4e606"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#aedc8c99d9c3431e7be093ed3fcf4e606">test_warning_n_init_precomputed_centers</a> (Estimator)</td></tr>
<tr class="separator:aedc8c99d9c3431e7be093ed3fcf4e606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5622f0be284cad4744300ca6e38473c9" id="r_a5622f0be284cad4744300ca6e38473c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a5622f0be284cad4744300ca6e38473c9">test_minibatch_sensible_reassign</a> (global_random_seed)</td></tr>
<tr class="separator:a5622f0be284cad4744300ca6e38473c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589cc6bad96255443fdf6442a0b774f7" id="r_a589cc6bad96255443fdf6442a0b774f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a589cc6bad96255443fdf6442a0b774f7">test_minibatch_reassign</a> (data, global_random_seed)</td></tr>
<tr class="separator:a589cc6bad96255443fdf6442a0b774f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad3043c701bed45ab76a9cca3f55cf36" id="r_aad3043c701bed45ab76a9cca3f55cf36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#aad3043c701bed45ab76a9cca3f55cf36">test_minibatch_with_many_reassignments</a> ()</td></tr>
<tr class="separator:aad3043c701bed45ab76a9cca3f55cf36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39fb8417561f61df369a83519adea244" id="r_a39fb8417561f61df369a83519adea244"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a39fb8417561f61df369a83519adea244">test_minibatch_kmeans_init_size</a> ()</td></tr>
<tr class="separator:a39fb8417561f61df369a83519adea244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ce538f29d664ae1125a457495e42846" id="r_a3ce538f29d664ae1125a457495e42846"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a3ce538f29d664ae1125a457495e42846">test_minibatch_declared_convergence</a> (capsys, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>, max_no_improvement)</td></tr>
<tr class="separator:a3ce538f29d664ae1125a457495e42846"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5585fd3630085549c667340bd3cac25" id="r_ad5585fd3630085549c667340bd3cac25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ad5585fd3630085549c667340bd3cac25">test_minibatch_iter_steps</a> ()</td></tr>
<tr class="separator:ad5585fd3630085549c667340bd3cac25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d61b5aa8647e4c373f5e9497cbf583a" id="r_a8d61b5aa8647e4c373f5e9497cbf583a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a8d61b5aa8647e4c373f5e9497cbf583a">test_kmeans_copyx</a> ()</td></tr>
<tr class="separator:a8d61b5aa8647e4c373f5e9497cbf583a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9984fa359e9ca33fa1028c9fae6bdf0" id="r_ae9984fa359e9ca33fa1028c9fae6bdf0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ae9984fa359e9ca33fa1028c9fae6bdf0">test_score_max_iter</a> (Estimator, global_random_seed)</td></tr>
<tr class="separator:ae9984fa359e9ca33fa1028c9fae6bdf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0205c34c5acdafc712493d306f24e29" id="r_ac0205c34c5acdafc712493d306f24e29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ac0205c34c5acdafc712493d306f24e29">test_kmeans_predict</a> (Estimator, algorithm, array_constr, max_iter, global_dtype, global_random_seed)</td></tr>
<tr class="separator:ac0205c34c5acdafc712493d306f24e29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb780865ac86412e6b03bd74e9ee414" id="r_aceb780865ac86412e6b03bd74e9ee414"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#aceb780865ac86412e6b03bd74e9ee414">test_dense_sparse</a> (Estimator, global_random_seed)</td></tr>
<tr class="separator:aceb780865ac86412e6b03bd74e9ee414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb5d300a0851452e99f759db215d6065" id="r_afb5d300a0851452e99f759db215d6065"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#afb5d300a0851452e99f759db215d6065">test_predict_dense_sparse</a> (Estimator, init)</td></tr>
<tr class="separator:afb5d300a0851452e99f759db215d6065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec4874dc85da95cb6d3b8fe953c7210" id="r_a8ec4874dc85da95cb6d3b8fe953c7210"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a8ec4874dc85da95cb6d3b8fe953c7210">test_integer_input</a> (Estimator, array_constr, dtype, init, global_random_seed)</td></tr>
<tr class="separator:a8ec4874dc85da95cb6d3b8fe953c7210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747fc017b1759a6f24bdde6ac9482ea7" id="r_a747fc017b1759a6f24bdde6ac9482ea7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a747fc017b1759a6f24bdde6ac9482ea7">test_transform</a> (Estimator, global_random_seed)</td></tr>
<tr class="separator:a747fc017b1759a6f24bdde6ac9482ea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae54a171e0129abc0c17ee6dcbf81ecd1" id="r_ae54a171e0129abc0c17ee6dcbf81ecd1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ae54a171e0129abc0c17ee6dcbf81ecd1">test_fit_transform</a> (Estimator, global_random_seed)</td></tr>
<tr class="separator:ae54a171e0129abc0c17ee6dcbf81ecd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a662372405f3ce681d108e121ddc74fcc" id="r_a662372405f3ce681d108e121ddc74fcc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a662372405f3ce681d108e121ddc74fcc">test_n_init</a> (global_random_seed)</td></tr>
<tr class="separator:a662372405f3ce681d108e121ddc74fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94c1b6f8b90f0024c0f009b044554b92" id="r_a94c1b6f8b90f0024c0f009b044554b92"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a94c1b6f8b90f0024c0f009b044554b92">test_k_means_function</a> (global_random_seed)</td></tr>
<tr class="separator:a94c1b6f8b90f0024c0f009b044554b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3051702a377aac12d65dd6455f0e1e61" id="r_a3051702a377aac12d65dd6455f0e1e61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a3051702a377aac12d65dd6455f0e1e61">test_float_precision</a> (Estimator, data, global_random_seed)</td></tr>
<tr class="separator:a3051702a377aac12d65dd6455f0e1e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5532048fbe9e5a95575ca58c21861b07" id="r_a5532048fbe9e5a95575ca58c21861b07"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a5532048fbe9e5a95575ca58c21861b07">test_centers_not_mutated</a> (Estimator, dtype)</td></tr>
<tr class="separator:a5532048fbe9e5a95575ca58c21861b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa08ddd432740987eaed9b89b036070a9" id="r_aa08ddd432740987eaed9b89b036070a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#aa08ddd432740987eaed9b89b036070a9">test_kmeans_init_fitted_centers</a> (data)</td></tr>
<tr class="separator:aa08ddd432740987eaed9b89b036070a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e8ec3453f99093c5debc829e244f72" id="r_a08e8ec3453f99093c5debc829e244f72"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a08e8ec3453f99093c5debc829e244f72">test_kmeans_warns_less_centers_than_unique_points</a> (global_random_seed)</td></tr>
<tr class="separator:a08e8ec3453f99093c5debc829e244f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e98c2058f3eb7c91c92b73089032b78" id="r_a0e98c2058f3eb7c91c92b73089032b78"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a0e98c2058f3eb7c91c92b73089032b78">_sort_centers</a> (<a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a318463e35d5921c87e6560caa1740d94">centers</a>)</td></tr>
<tr class="separator:a0e98c2058f3eb7c91c92b73089032b78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ca5953c5c2ac5c351afec21484ba33" id="r_ae2ca5953c5c2ac5c351afec21484ba33"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ae2ca5953c5c2ac5c351afec21484ba33">test_weighted_vs_repeated</a> (global_random_seed)</td></tr>
<tr class="separator:ae2ca5953c5c2ac5c351afec21484ba33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af993bd5f350780f8a8d76a6dae56fa20" id="r_af993bd5f350780f8a8d76a6dae56fa20"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#af993bd5f350780f8a8d76a6dae56fa20">test_unit_weights_vs_no_weights</a> (Estimator, data, global_random_seed)</td></tr>
<tr class="separator:af993bd5f350780f8a8d76a6dae56fa20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf1d37a05f9ed080a99744b0254b44a6" id="r_adf1d37a05f9ed080a99744b0254b44a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#adf1d37a05f9ed080a99744b0254b44a6">test_scaled_weights</a> (Estimator, data, global_random_seed)</td></tr>
<tr class="separator:adf1d37a05f9ed080a99744b0254b44a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad687346e8fdc519e0e658111177b70ff" id="r_ad687346e8fdc519e0e658111177b70ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ad687346e8fdc519e0e658111177b70ff">test_kmeans_elkan_iter_attribute</a> ()</td></tr>
<tr class="separator:ad687346e8fdc519e0e658111177b70ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a435294f67c844932e29688e4bf1ed1" id="r_a5a435294f67c844932e29688e4bf1ed1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a5a435294f67c844932e29688e4bf1ed1">test_kmeans_empty_cluster_relocated</a> (array_constr)</td></tr>
<tr class="separator:a5a435294f67c844932e29688e4bf1ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85e5e62f0a9647930746e1778359fdc3" id="r_a85e5e62f0a9647930746e1778359fdc3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a85e5e62f0a9647930746e1778359fdc3">test_result_equal_in_diff_n_threads</a> (Estimator, global_random_seed)</td></tr>
<tr class="separator:a85e5e62f0a9647930746e1778359fdc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38b9018508a17aa316fe89487a9e4db9" id="r_a38b9018508a17aa316fe89487a9e4db9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a38b9018508a17aa316fe89487a9e4db9">test_warning_elkan_1_cluster</a> ()</td></tr>
<tr class="separator:a38b9018508a17aa316fe89487a9e4db9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adced8adbc5ac00bd6778f4a7bd91818e" id="r_adced8adbc5ac00bd6778f4a7bd91818e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#adced8adbc5ac00bd6778f4a7bd91818e">test_k_means_1_iteration</a> (array_constr, algo, global_random_seed)</td></tr>
<tr class="separator:adced8adbc5ac00bd6778f4a7bd91818e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae284b336aa47d7bff11dba5a4b9b3b5b" id="r_ae284b336aa47d7bff11dba5a4b9b3b5b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ae284b336aa47d7bff11dba5a4b9b3b5b">test_euclidean_distance</a> (dtype, squared, global_random_seed)</td></tr>
<tr class="separator:ae284b336aa47d7bff11dba5a4b9b3b5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3a981ed16c7be44e504ea731d1d735" id="r_a5e3a981ed16c7be44e504ea731d1d735"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a5e3a981ed16c7be44e504ea731d1d735">test_inertia</a> (dtype, global_random_seed)</td></tr>
<tr class="separator:a5e3a981ed16c7be44e504ea731d1d735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b8a14b873045c9074e6759f6854cc1" id="r_ae8b8a14b873045c9074e6759f6854cc1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ae8b8a14b873045c9074e6759f6854cc1">test_change_n_init_future_warning</a> (Klass, default_n_init)</td></tr>
<tr class="separator:ae8b8a14b873045c9074e6759f6854cc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47be48da36279285298bd1ebb74664c0" id="r_a47be48da36279285298bd1ebb74664c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a47be48da36279285298bd1ebb74664c0">test_n_init_auto</a> (Klass, default_n_init)</td></tr>
<tr class="separator:a47be48da36279285298bd1ebb74664c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5257c6214d0f42939fdd67920ea3bf1a" id="r_a5257c6214d0f42939fdd67920ea3bf1a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a5257c6214d0f42939fdd67920ea3bf1a">test_sample_weight_unchanged</a> (Estimator)</td></tr>
<tr class="separator:a5257c6214d0f42939fdd67920ea3bf1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa69e78e5c884c1b6785e13e6f8d5f733" id="r_aa69e78e5c884c1b6785e13e6f8d5f733"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#aa69e78e5c884c1b6785e13e6f8d5f733">test_wrong_params</a> (Estimator, param, match)</td></tr>
<tr class="separator:aa69e78e5c884c1b6785e13e6f8d5f733"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab979daa7195328a977b1c807b3be747f" id="r_ab979daa7195328a977b1c807b3be747f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ab979daa7195328a977b1c807b3be747f">test_kmeans_plusplus_wrong_params</a> (param, match)</td></tr>
<tr class="separator:ab979daa7195328a977b1c807b3be747f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec4d5d9cffb4fe84dbdcfa6364c546fc" id="r_aec4d5d9cffb4fe84dbdcfa6364c546fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#aec4d5d9cffb4fe84dbdcfa6364c546fc">test_kmeans_plusplus_output</a> (data, dtype, global_random_seed)</td></tr>
<tr class="separator:aec4d5d9cffb4fe84dbdcfa6364c546fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a977f85b1ca44256e83c0db070194c0ac" id="r_a977f85b1ca44256e83c0db070194c0ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a977f85b1ca44256e83c0db070194c0ac">test_kmeans_plusplus_norms</a> (x_squared_norms)</td></tr>
<tr class="separator:a977f85b1ca44256e83c0db070194c0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae820722633c710b844344cc0d1738aa0" id="r_ae820722633c710b844344cc0d1738aa0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ae820722633c710b844344cc0d1738aa0">test_kmeans_plusplus_dataorder</a> (global_random_seed)</td></tr>
<tr class="separator:ae820722633c710b844344cc0d1738aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf29baa33945831f2b20fbdfd377590" id="r_a2cf29baa33945831f2b20fbdfd377590"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a2cf29baa33945831f2b20fbdfd377590">test_is_same_clustering</a> ()</td></tr>
<tr class="separator:a2cf29baa33945831f2b20fbdfd377590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e395e8f001c005654bf8c85cba7ef95" id="r_a3e395e8f001c005654bf8c85cba7ef95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a3e395e8f001c005654bf8c85cba7ef95">test_kmeans_with_array_like_or_np_scalar_init</a> (kwargs)</td></tr>
<tr class="separator:a3e395e8f001c005654bf8c85cba7ef95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6f1c50a2068401bcf1b9a20d056e717" id="r_aa6f1c50a2068401bcf1b9a20d056e717"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#aa6f1c50a2068401bcf1b9a20d056e717">test_feature_names_out</a> (Klass, method)</td></tr>
<tr class="separator:aa6f1c50a2068401bcf1b9a20d056e717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf38cf0c07f0ce449d2606a30f2eede0" id="r_acf38cf0c07f0ce449d2606a30f2eede0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#acf38cf0c07f0ce449d2606a30f2eede0">test_predict_does_not_change_cluster_centers</a> (is_sparse)</td></tr>
<tr class="separator:acf38cf0c07f0ce449d2606a30f2eede0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a442ff0c3f08d79c1648582cfea794716" id="r_a442ff0c3f08d79c1648582cfea794716"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a442ff0c3f08d79c1648582cfea794716">msg</a></td></tr>
<tr class="separator:a442ff0c3f08d79c1648582cfea794716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21947288fd4ad5ed038e8f0ad6a68cc4" id="r_a21947288fd4ad5ed038e8f0ad6a68cc4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a21947288fd4ad5ed038e8f0ad6a68cc4">pytestmark</a> = pytest.mark.filterwarnings(&quot;ignore:&quot; + <a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a442ff0c3f08d79c1648582cfea794716">msg</a>)</td></tr>
<tr class="separator:a21947288fd4ad5ed038e8f0ad6a68cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318463e35d5921c87e6560caa1740d94" id="r_a318463e35d5921c87e6560caa1740d94"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a318463e35d5921c87e6560caa1740d94">centers</a></td></tr>
<tr class="separator:a318463e35d5921c87e6560caa1740d94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66a1cf824285f08ca382adc2d1e0ac5b" id="r_a66a1cf824285f08ca382adc2d1e0ac5b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a66a1cf824285f08ca382adc2d1e0ac5b">n_samples</a> = 100</td></tr>
<tr class="separator:a66a1cf824285f08ca382adc2d1e0ac5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d4c66c93b70ea0b703009d377f652b" id="r_ac7d4c66c93b70ea0b703009d377f652b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ac7d4c66c93b70ea0b703009d377f652b">n_clusters</a></td></tr>
<tr class="separator:ac7d4c66c93b70ea0b703009d377f652b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2251722219587876aed804cab5b0097" id="r_ad2251722219587876aed804cab5b0097"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#ad2251722219587876aed804cab5b0097">n_features</a></td></tr>
<tr class="separator:ad2251722219587876aed804cab5b0097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41596f08e7b65afd0b216535aaebc40a" id="r_a41596f08e7b65afd0b216535aaebc40a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a41596f08e7b65afd0b216535aaebc40a">X</a></td></tr>
<tr class="separator:a41596f08e7b65afd0b216535aaebc40a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ee9a68457d8be74955a9d2840737229" id="r_a2ee9a68457d8be74955a9d2840737229"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a2ee9a68457d8be74955a9d2840737229">true_labels</a></td></tr>
<tr class="separator:a2ee9a68457d8be74955a9d2840737229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a581fa769ccd975ba5188f3f57f5234" id="r_a2a581fa769ccd975ba5188f3f57f5234"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a2a581fa769ccd975ba5188f3f57f5234">cluster_std</a></td></tr>
<tr class="separator:a2a581fa769ccd975ba5188f3f57f5234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15f1f840c98eb54b1ecfaf35a224d4da" id="r_a15f1f840c98eb54b1ecfaf35a224d4da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a15f1f840c98eb54b1ecfaf35a224d4da">random_state</a></td></tr>
<tr class="separator:a15f1f840c98eb54b1ecfaf35a224d4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9df262e3c5c5f6e55c12bcfc6d4a199f" id="r_a9df262e3c5c5f6e55c12bcfc6d4a199f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a9df262e3c5c5f6e55c12bcfc6d4a199f">X_csr</a> = sp.csr_matrix(<a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a41596f08e7b65afd0b216535aaebc40a">X</a>)</td></tr>
<tr class="separator:a9df262e3c5c5f6e55c12bcfc6d4a199f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Testing for K-means</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ade63a61587460325ff162067d4789556" name="ade63a61587460325ff162067d4789556"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade63a61587460325ff162067d4789556">&#9670;&#160;</a></span>_check_fitted_model()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means._check_fitted_model </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>km</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  291</span><span class="keyword">def </span>_check_fitted_model(km):</div>
<div class="line"><span class="lineno">  292</span>    <span class="comment"># check that the number of clusters centers and distinct labels match</span></div>
<div class="line"><span class="lineno">  293</span>    <span class="comment"># the expectation</span></div>
<div class="line"><span class="lineno">  294</span>    centers = km.cluster_centers_</div>
<div class="line"><span class="lineno">  295</span>    <span class="keyword">assert</span> centers.shape == (n_clusters, n_features)</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    labels = km.labels_</div>
<div class="line"><span class="lineno">  298</span>    <span class="keyword">assert</span> np.unique(labels).shape[0] == n_clusters</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="comment"># check that the labels assignment are perfect (up to a permutation)</span></div>
<div class="line"><span class="lineno">  301</span>    assert_allclose(v_measure_score(true_labels, labels), 1.0)</div>
<div class="line"><span class="lineno">  302</span>    <span class="keyword">assert</span> km.inertia_ &gt; 0.0</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span><span class="preprocessor">@pytest.mark.parametrize(&quot;data&quot;, [X, X_csr], ids=[&quot;dense&quot;, &quot;sparse&quot;])</span></div>
<div class="line"><span class="lineno">  306</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  307</span>    <span class="stringliteral">&quot;init&quot;</span>,</div>
<div class="line"><span class="lineno">  308</span>    [<span class="stringliteral">&quot;random&quot;</span>, <span class="stringliteral">&quot;k-means++&quot;</span>, centers, <span class="keyword">lambda</span> X, k, random_state: centers],</div>
<div class="line"><span class="lineno">  309</span>    ids=[<span class="stringliteral">&quot;random&quot;</span>, <span class="stringliteral">&quot;k-means++&quot;</span>, <span class="stringliteral">&quot;ndarray&quot;</span>, <span class="stringliteral">&quot;callable&quot;</span>],</div>
<div class="line"><span class="lineno">  310</span>)</div>
<div class="line"><span class="lineno">  311</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e98c2058f3eb7c91c92b73089032b78" name="a0e98c2058f3eb7c91c92b73089032b78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e98c2058f3eb7c91c92b73089032b78">&#9670;&#160;</a></span>_sort_centers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means._sort_centers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>centers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  849</span><span class="keyword">def </span>_sort_centers(centers):</div>
<div class="line"><span class="lineno">  850</span>    <span class="keywordflow">return</span> np.sort(centers, axis=0)</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac489e5f43d4a4b16825385afbc677b46" name="ac489e5f43d4a4b16825385afbc677b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac489e5f43d4a4b16825385afbc677b46">&#9670;&#160;</a></span>test_algorithm_auto_full_deprecation_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_algorithm_auto_full_deprecation_warning </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algorithm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  214</span><span class="keyword">def </span>test_algorithm_auto_full_deprecation_warning(algorithm):</div>
<div class="line"><span class="lineno">  215</span>    X = np.random.rand(100, 2)</div>
<div class="line"><span class="lineno">  216</span>    kmeans = KMeans(algorithm=algorithm)</div>
<div class="line"><span class="lineno">  217</span>    <span class="keyword">with</span> pytest.warns(</div>
<div class="line"><span class="lineno">  218</span>        FutureWarning,</div>
<div class="line"><span class="lineno">  219</span>        match=(</div>
<div class="line"><span class="lineno">  220</span>            f<span class="stringliteral">&quot;algorithm=&#39;{algorithm}&#39; is deprecated, it will &quot;</span></div>
<div class="line"><span class="lineno">  221</span>            <span class="stringliteral">&quot;be removed in 1.3. Using &#39;lloyd&#39; instead.&quot;</span></div>
<div class="line"><span class="lineno">  222</span>        ),</div>
<div class="line"><span class="lineno">  223</span>    ):</div>
<div class="line"><span class="lineno">  224</span>        kmeans.fit(X)</div>
<div class="line"><span class="lineno">  225</span>        <span class="keyword">assert</span> kmeans._algorithm == <span class="stringliteral">&quot;lloyd&quot;</span></div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c5f86307ab3685a434e56785d9c5520" name="a4c5f86307ab3685a434e56785d9c5520"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c5f86307ab3685a434e56785d9c5520">&#9670;&#160;</a></span>test_all_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_all_init </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  312</span><span class="keyword">def </span>test_all_init(Estimator, data, init):</div>
<div class="line"><span class="lineno">  313</span>    <span class="comment"># Check KMeans and MiniBatchKMeans with all possible init.</span></div>
<div class="line"><span class="lineno">  314</span>    n_init = 10 <span class="keywordflow">if</span> isinstance(init, str) <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  315</span>    km = Estimator(</div>
<div class="line"><span class="lineno">  316</span>        init=init, n_clusters=n_clusters, random_state=42, n_init=n_init</div>
<div class="line"><span class="lineno">  317</span>    ).fit(data)</div>
<div class="line"><span class="lineno">  318</span>    _check_fitted_model(km)</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  322</span>    <span class="stringliteral">&quot;init&quot;</span>,</div>
<div class="line"><span class="lineno">  323</span>    [<span class="stringliteral">&quot;random&quot;</span>, <span class="stringliteral">&quot;k-means++&quot;</span>, centers, <span class="keyword">lambda</span> X, k, random_state: centers],</div>
<div class="line"><span class="lineno">  324</span>    ids=[<span class="stringliteral">&quot;random&quot;</span>, <span class="stringliteral">&quot;k-means++&quot;</span>, <span class="stringliteral">&quot;ndarray&quot;</span>, <span class="stringliteral">&quot;callable&quot;</span>],</div>
<div class="line"><span class="lineno">  325</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5532048fbe9e5a95575ca58c21861b07" name="a5532048fbe9e5a95575ca58c21861b07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5532048fbe9e5a95575ca58c21861b07">&#9670;&#160;</a></span>test_centers_not_mutated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_centers_not_mutated </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  809</span><span class="keyword">def </span>test_centers_not_mutated(Estimator, dtype):</div>
<div class="line"><span class="lineno">  810</span>    <span class="comment"># Check that KMeans and MiniBatchKMeans won&#39;t mutate the user provided</span></div>
<div class="line"><span class="lineno">  811</span>    <span class="comment"># init centers silently even if input data and init centers have the same</span></div>
<div class="line"><span class="lineno">  812</span>    <span class="comment"># type.</span></div>
<div class="line"><span class="lineno">  813</span>    X_new_type = X.astype(dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  814</span>    centers_new_type = centers.astype(dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>    km = Estimator(init=centers_new_type, n_clusters=n_clusters, n_init=1)</div>
<div class="line"><span class="lineno">  817</span>    km.fit(X_new_type)</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> np.may_share_memory(km.cluster_centers_, centers_new_type)</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span><span class="preprocessor">@pytest.mark.parametrize(&quot;data&quot;, [X, X_csr], ids=[&quot;dense&quot;, &quot;sparse&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8b8a14b873045c9074e6759f6854cc1" name="ae8b8a14b873045c9074e6759f6854cc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8b8a14b873045c9074e6759f6854cc1">&#9670;&#160;</a></span>test_change_n_init_future_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_change_n_init_future_warning </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Klass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>default_n_init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1067</span><span class="keyword">def </span>test_change_n_init_future_warning(Klass, default_n_init):</div>
<div class="line"><span class="lineno"> 1068</span>    est = Klass(n_init=1)</div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno"> 1070</span>        warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, FutureWarning)</div>
<div class="line"><span class="lineno"> 1071</span>        est.fit(X)</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>    default_n_init = 10 <span class="keywordflow">if</span> Klass.__name__ == <span class="stringliteral">&quot;KMeans&quot;</span> <span class="keywordflow">else</span> 3</div>
<div class="line"><span class="lineno"> 1074</span>    msg = (</div>
<div class="line"><span class="lineno"> 1075</span>        f<span class="stringliteral">&quot;The default value of `n_init` will change from {default_n_init} to &#39;auto&#39;&quot;</span></div>
<div class="line"><span class="lineno"> 1076</span>        <span class="stringliteral">&quot; in 1.4&quot;</span></div>
<div class="line"><span class="lineno"> 1077</span>    )</div>
<div class="line"><span class="lineno"> 1078</span>    est = Klass()</div>
<div class="line"><span class="lineno"> 1079</span>    <span class="keyword">with</span> pytest.warns(FutureWarning, match=msg):</div>
<div class="line"><span class="lineno"> 1080</span>        est.fit(X)</div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Klass, default_n_init&quot;, [(KMeans, 10)</span>, (MiniBatchKMeans, 3)])</div>
</div><!-- fragment -->
</div>
</div>
<a id="aceb780865ac86412e6b03bd74e9ee414" name="aceb780865ac86412e6b03bd74e9ee414"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceb780865ac86412e6b03bd74e9ee414">&#9670;&#160;</a></span>test_dense_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_dense_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  644</span><span class="keyword">def </span>test_dense_sparse(Estimator, global_random_seed):</div>
<div class="line"><span class="lineno">  645</span>    <span class="comment"># Check that the results are the same for dense and sparse input.</span></div>
<div class="line"><span class="lineno">  646</span>    sample_weight = np.random.RandomState(global_random_seed).random_sample(</div>
<div class="line"><span class="lineno">  647</span>        (n_samples,)</div>
<div class="line"><span class="lineno">  648</span>    )</div>
<div class="line"><span class="lineno">  649</span>    km_dense = Estimator(</div>
<div class="line"><span class="lineno">  650</span>        n_clusters=n_clusters, random_state=global_random_seed, n_init=1</div>
<div class="line"><span class="lineno">  651</span>    )</div>
<div class="line"><span class="lineno">  652</span>    km_dense.fit(X, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">  653</span>    km_sparse = Estimator(</div>
<div class="line"><span class="lineno">  654</span>        n_clusters=n_clusters, random_state=global_random_seed, n_init=1</div>
<div class="line"><span class="lineno">  655</span>    )</div>
<div class="line"><span class="lineno">  656</span>    km_sparse.fit(X_csr, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>    assert_array_equal(km_dense.labels_, km_sparse.labels_)</div>
<div class="line"><span class="lineno">  659</span>    assert_allclose(km_dense.cluster_centers_, km_sparse.cluster_centers_)</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  663</span>    <span class="stringliteral">&quot;init&quot;</span>, [<span class="stringliteral">&quot;random&quot;</span>, <span class="stringliteral">&quot;k-means++&quot;</span>, centers], ids=[<span class="stringliteral">&quot;random&quot;</span>, <span class="stringliteral">&quot;k-means++&quot;</span>, <span class="stringliteral">&quot;ndarray&quot;</span>]</div>
<div class="line"><span class="lineno">  664</span>)</div>
<div class="line"><span class="lineno">  665</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae284b336aa47d7bff11dba5a4b9b3b5b" name="ae284b336aa47d7bff11dba5a4b9b3b5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae284b336aa47d7bff11dba5a4b9b3b5b">&#9670;&#160;</a></span>test_euclidean_distance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_euclidean_distance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>squared</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  997</span><span class="keyword">def </span>test_euclidean_distance(dtype, squared, global_random_seed):</div>
<div class="line"><span class="lineno">  998</span>    <span class="comment"># Check that the _euclidean_(dense/sparse)_dense helpers produce correct</span></div>
<div class="line"><span class="lineno">  999</span>    <span class="comment"># results</span></div>
<div class="line"><span class="lineno"> 1000</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno"> 1001</span>    a_sparse = sp.random(</div>
<div class="line"><span class="lineno"> 1002</span>        1, 100, density=0.5, format=<span class="stringliteral">&quot;csr&quot;</span>, random_state=rng, dtype=dtype</div>
<div class="line"><span class="lineno"> 1003</span>    )</div>
<div class="line"><span class="lineno"> 1004</span>    a_dense = a_sparse.toarray().reshape(-1)</div>
<div class="line"><span class="lineno"> 1005</span>    b = rng.randn(100).astype(dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1006</span>    b_squared_norm = (b**2).sum()</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span>    expected = ((a_dense - b) ** 2).sum()</div>
<div class="line"><span class="lineno"> 1009</span>    expected = expected <span class="keywordflow">if</span> squared <span class="keywordflow">else</span> np.sqrt(expected)</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>    distance_dense_dense = _euclidean_dense_dense_wrapper(a_dense, b, squared)</div>
<div class="line"><span class="lineno"> 1012</span>    distance_sparse_dense = _euclidean_sparse_dense_wrapper(</div>
<div class="line"><span class="lineno"> 1013</span>        a_sparse.data, a_sparse.indices, b, b_squared_norm, squared</div>
<div class="line"><span class="lineno"> 1014</span>    )</div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span>    rtol = 1e-4 <span class="keywordflow">if</span> dtype == np.float32 <span class="keywordflow">else</span> 1e-7</div>
<div class="line"><span class="lineno"> 1017</span>    assert_allclose(distance_dense_dense, distance_sparse_dense, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1018</span>    assert_allclose(distance_dense_dense, expected, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1019</span>    assert_allclose(distance_sparse_dense, expected, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1020</span> </div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [np.float32, np.float64])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6f1c50a2068401bcf1b9a20d056e717" name="aa6f1c50a2068401bcf1b9a20d056e717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6f1c50a2068401bcf1b9a20d056e717">&#9670;&#160;</a></span>test_feature_names_out()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_feature_names_out </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Klass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check `feature_names_out` for `KMeans` and `MiniBatchKMeans`.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1237</span><span class="keyword">def </span>test_feature_names_out(Klass, method):</div>
<div class="line"><span class="lineno"> 1238</span>    <span class="stringliteral">&quot;&quot;&quot;Check `feature_names_out` for `KMeans` and `MiniBatchKMeans`.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1239</span>    class_name = Klass.__name__.lower()</div>
<div class="line"><span class="lineno"> 1240</span>    kmeans = Klass()</div>
<div class="line"><span class="lineno"> 1241</span>    getattr(kmeans, method)(X)</div>
<div class="line"><span class="lineno"> 1242</span>    n_clusters = kmeans.cluster_centers_.shape[0]</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>    names_out = kmeans.get_feature_names_out()</div>
<div class="line"><span class="lineno"> 1245</span>    assert_array_equal([f<span class="stringliteral">&quot;{class_name}{i}&quot;</span> <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n_clusters)], names_out)</div>
<div class="line"><span class="lineno"> 1246</span> </div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span><span class="preprocessor">@pytest.mark.parametrize(&quot;is_sparse&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae54a171e0129abc0c17ee6dcbf81ecd1" name="ae54a171e0129abc0c17ee6dcbf81ecd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae54a171e0129abc0c17ee6dcbf81ecd1">&#9670;&#160;</a></span>test_fit_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_fit_transform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  732</span><span class="keyword">def </span>test_fit_transform(Estimator, global_random_seed):</div>
<div class="line"><span class="lineno">  733</span>    <span class="comment"># Check equivalence between fit.transform and fit_transform</span></div>
<div class="line"><span class="lineno">  734</span>    X1 = Estimator(random_state=global_random_seed, n_init=1).fit(X).transform(X)</div>
<div class="line"><span class="lineno">  735</span>    X2 = Estimator(random_state=global_random_seed, n_init=1).fit_transform(X)</div>
<div class="line"><span class="lineno">  736</span>    assert_allclose(X1, X2)</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3051702a377aac12d65dd6455f0e1e61" name="a3051702a377aac12d65dd6455f0e1e61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3051702a377aac12d65dd6455f0e1e61">&#9670;&#160;</a></span>test_float_precision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_float_precision </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  771</span><span class="keyword">def </span>test_float_precision(Estimator, data, global_random_seed):</div>
<div class="line"><span class="lineno">  772</span>    <span class="comment"># Check that the results are the same for single and double precision.</span></div>
<div class="line"><span class="lineno">  773</span>    km = Estimator(n_init=1, random_state=global_random_seed)</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span>    inertia = {}</div>
<div class="line"><span class="lineno">  776</span>    Xt = {}</div>
<div class="line"><span class="lineno">  777</span>    centers = {}</div>
<div class="line"><span class="lineno">  778</span>    labels = {}</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">for</span> dtype <span class="keywordflow">in</span> [np.float64, np.float32]:</div>
<div class="line"><span class="lineno">  781</span>        X = data.astype(dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  782</span>        km.fit(X)</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>        inertia[dtype] = km.inertia_</div>
<div class="line"><span class="lineno">  785</span>        Xt[dtype] = km.transform(X)</div>
<div class="line"><span class="lineno">  786</span>        centers[dtype] = km.cluster_centers_</div>
<div class="line"><span class="lineno">  787</span>        labels[dtype] = km.labels_</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>        <span class="comment"># dtype of cluster centers has to be the dtype of the input data</span></div>
<div class="line"><span class="lineno">  790</span>        <span class="keyword">assert</span> km.cluster_centers_.dtype == dtype</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>        <span class="comment"># same with partial_fit</span></div>
<div class="line"><span class="lineno">  793</span>        <span class="keywordflow">if</span> Estimator <span class="keywordflow">is</span> MiniBatchKMeans:</div>
<div class="line"><span class="lineno">  794</span>            km.partial_fit(X[0:3])</div>
<div class="line"><span class="lineno">  795</span>            <span class="keyword">assert</span> km.cluster_centers_.dtype == dtype</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    <span class="comment"># compare arrays with low precision since the difference between 32 and</span></div>
<div class="line"><span class="lineno">  798</span>    <span class="comment"># 64 bit comes from an accumulation of rounding errors.</span></div>
<div class="line"><span class="lineno">  799</span>    assert_allclose(inertia[np.float32], inertia[np.float64], rtol=1e-4)</div>
<div class="line"><span class="lineno">  800</span>    assert_allclose(Xt[np.float32], Xt[np.float64], atol=Xt[np.float64].max() * 1e-4)</div>
<div class="line"><span class="lineno">  801</span>    assert_allclose(</div>
<div class="line"><span class="lineno">  802</span>        centers[np.float32], centers[np.float64], atol=centers[np.float64].max() * 1e-4</div>
<div class="line"><span class="lineno">  803</span>    )</div>
<div class="line"><span class="lineno">  804</span>    assert_array_equal(labels[np.float32], labels[np.float64])</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [np.int32, np.int64, np.float32, np.float64])</span></div>
<div class="line"><span class="lineno">  808</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae907d4ea0029b0756f475b78b91b4a60" name="ae907d4ea0029b0756f475b78b91b4a60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae907d4ea0029b0756f475b78b91b4a60">&#9670;&#160;</a></span>test_fortran_aligned_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_fortran_aligned_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  339</span><span class="keyword">def </span>test_fortran_aligned_data(Estimator, global_random_seed):</div>
<div class="line"><span class="lineno">  340</span>    <span class="comment"># Check that KMeans works with fortran-aligned data.</span></div>
<div class="line"><span class="lineno">  341</span>    X_fortran = np.asfortranarray(X)</div>
<div class="line"><span class="lineno">  342</span>    centers_fortran = np.asfortranarray(centers)</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>    km_c = Estimator(</div>
<div class="line"><span class="lineno">  345</span>        n_clusters=n_clusters, init=centers, n_init=1, random_state=global_random_seed</div>
<div class="line"><span class="lineno">  346</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  347</span>    km_f = Estimator(</div>
<div class="line"><span class="lineno">  348</span>        n_clusters=n_clusters,</div>
<div class="line"><span class="lineno">  349</span>        init=centers_fortran,</div>
<div class="line"><span class="lineno">  350</span>        n_init=1,</div>
<div class="line"><span class="lineno">  351</span>        random_state=global_random_seed,</div>
<div class="line"><span class="lineno">  352</span>    ).fit(X_fortran)</div>
<div class="line"><span class="lineno">  353</span>    assert_allclose(km_c.cluster_centers_, km_f.cluster_centers_)</div>
<div class="line"><span class="lineno">  354</span>    assert_array_equal(km_c.labels_, km_f.labels_)</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e3a981ed16c7be44e504ea731d1d735" name="a5e3a981ed16c7be44e504ea731d1d735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3a981ed16c7be44e504ea731d1d735">&#9670;&#160;</a></span>test_inertia()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_inertia </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1023</span><span class="keyword">def </span>test_inertia(dtype, global_random_seed):</div>
<div class="line"><span class="lineno"> 1024</span>    <span class="comment"># Check that the _inertia_(dense/sparse) helpers produce correct results.</span></div>
<div class="line"><span class="lineno"> 1025</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno"> 1026</span>    X_sparse = sp.random(</div>
<div class="line"><span class="lineno"> 1027</span>        100, 10, density=0.5, format=<span class="stringliteral">&quot;csr&quot;</span>, random_state=rng, dtype=dtype</div>
<div class="line"><span class="lineno"> 1028</span>    )</div>
<div class="line"><span class="lineno"> 1029</span>    X_dense = X_sparse.toarray()</div>
<div class="line"><span class="lineno"> 1030</span>    sample_weight = rng.randn(100).astype(dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1031</span>    centers = rng.randn(5, 10).astype(dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1032</span>    labels = rng.randint(5, size=100, dtype=np.int32)</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>    distances = ((X_dense - centers[labels]) ** 2).sum(axis=1)</div>
<div class="line"><span class="lineno"> 1035</span>    expected = np.sum(distances * sample_weight)</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>    inertia_dense = _inertia_dense(X_dense, sample_weight, centers, labels, n_threads=1)</div>
<div class="line"><span class="lineno"> 1038</span>    inertia_sparse = _inertia_sparse(</div>
<div class="line"><span class="lineno"> 1039</span>        X_sparse, sample_weight, centers, labels, n_threads=1</div>
<div class="line"><span class="lineno"> 1040</span>    )</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>    rtol = 1e-4 <span class="keywordflow">if</span> dtype == np.float32 <span class="keywordflow">else</span> 1e-6</div>
<div class="line"><span class="lineno"> 1043</span>    assert_allclose(inertia_dense, inertia_sparse, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1044</span>    assert_allclose(inertia_dense, expected, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1045</span>    assert_allclose(inertia_sparse, expected, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>    <span class="comment"># Check the single_label parameter.</span></div>
<div class="line"><span class="lineno"> 1048</span>    label = 1</div>
<div class="line"><span class="lineno"> 1049</span>    mask = labels == label</div>
<div class="line"><span class="lineno"> 1050</span>    distances = ((X_dense[mask] - centers[label]) ** 2).sum(axis=1)</div>
<div class="line"><span class="lineno"> 1051</span>    expected = np.sum(distances * sample_weight[mask])</div>
<div class="line"><span class="lineno"> 1052</span> </div>
<div class="line"><span class="lineno"> 1053</span>    inertia_dense = _inertia_dense(</div>
<div class="line"><span class="lineno"> 1054</span>        X_dense, sample_weight, centers, labels, n_threads=1, single_label=label</div>
<div class="line"><span class="lineno"> 1055</span>    )</div>
<div class="line"><span class="lineno"> 1056</span>    inertia_sparse = _inertia_sparse(</div>
<div class="line"><span class="lineno"> 1057</span>        X_sparse, sample_weight, centers, labels, n_threads=1, single_label=label</div>
<div class="line"><span class="lineno"> 1058</span>    )</div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span>    assert_allclose(inertia_dense, inertia_sparse, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1061</span>    assert_allclose(inertia_dense, expected, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1062</span>    assert_allclose(inertia_sparse, expected, rtol=rtol)</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span><span class="comment"># TODO(1.4): Remove</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Klass, default_n_init&quot;, [(KMeans, 10)</span>, (MiniBatchKMeans, 3)])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ec4874dc85da95cb6d3b8fe953c7210" name="a8ec4874dc85da95cb6d3b8fe953c7210"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ec4874dc85da95cb6d3b8fe953c7210">&#9670;&#160;</a></span>test_integer_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_integer_input </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  685</span><span class="keyword">def </span>test_integer_input(Estimator, array_constr, dtype, init, global_random_seed):</div>
<div class="line"><span class="lineno">  686</span>    <span class="comment"># Check that KMeans and MiniBatchKMeans work with integer input.</span></div>
<div class="line"><span class="lineno">  687</span>    X_dense = np.array([[0, 0], [10, 10], [12, 9], [-1, 1], [2, 0], [8, 10]])</div>
<div class="line"><span class="lineno">  688</span>    X = array_constr(X_dense, dtype=dtype)</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>    n_init = 1 <span class="keywordflow">if</span> init == <span class="stringliteral">&quot;ndarray&quot;</span> <span class="keywordflow">else</span> 10</div>
<div class="line"><span class="lineno">  691</span>    init = X_dense[:2] <span class="keywordflow">if</span> init == <span class="stringliteral">&quot;ndarray&quot;</span> <span class="keywordflow">else</span> init</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>    km = Estimator(</div>
<div class="line"><span class="lineno">  694</span>        n_clusters=2, init=init, n_init=n_init, random_state=global_random_seed</div>
<div class="line"><span class="lineno">  695</span>    )</div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">if</span> Estimator <span class="keywordflow">is</span> MiniBatchKMeans:</div>
<div class="line"><span class="lineno">  697</span>        km.set_params(batch_size=2)</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    km.fit(X)</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>    <span class="comment"># Internally integer input should be converted to float64</span></div>
<div class="line"><span class="lineno">  702</span>    <span class="keyword">assert</span> km.cluster_centers_.dtype == np.float64</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    expected_labels = [0, 1, 1, 0, 0, 1]</div>
<div class="line"><span class="lineno">  705</span>    assert_allclose(v_measure_score(km.labels_, expected_labels), 1.0)</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="comment"># Same with partial_fit (#14314)</span></div>
<div class="line"><span class="lineno">  708</span>    <span class="keywordflow">if</span> Estimator <span class="keywordflow">is</span> MiniBatchKMeans:</div>
<div class="line"><span class="lineno">  709</span>        km = clone(km).partial_fit(X)</div>
<div class="line"><span class="lineno">  710</span>        <span class="keyword">assert</span> km.cluster_centers_.dtype == np.float64</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cf29baa33945831f2b20fbdfd377590" name="a2cf29baa33945831f2b20fbdfd377590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cf29baa33945831f2b20fbdfd377590">&#9670;&#160;</a></span>test_is_same_clustering()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_is_same_clustering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1202</span><span class="keyword">def </span>test_is_same_clustering():</div>
<div class="line"><span class="lineno"> 1203</span>    <span class="comment"># Sanity check for the _is_same_clustering utility function</span></div>
<div class="line"><span class="lineno"> 1204</span>    labels1 = np.array([1, 0, 0, 1, 2, 0, 2, 1], dtype=np.int32)</div>
<div class="line"><span class="lineno"> 1205</span>    <span class="keyword">assert</span> _is_same_clustering(labels1, labels1, 3)</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>    <span class="comment"># these other labels represent the same clustering since we can retrieve the first</span></div>
<div class="line"><span class="lineno"> 1208</span>    <span class="comment"># labels by simply renaming the labels: 0 -&gt; 1, 1 -&gt; 2, 2 -&gt; 0.</span></div>
<div class="line"><span class="lineno"> 1209</span>    labels2 = np.array([0, 2, 2, 0, 1, 2, 1, 0], dtype=np.int32)</div>
<div class="line"><span class="lineno"> 1210</span>    <span class="keyword">assert</span> _is_same_clustering(labels1, labels2, 3)</div>
<div class="line"><span class="lineno"> 1211</span> </div>
<div class="line"><span class="lineno"> 1212</span>    <span class="comment"># these other labels do not represent the same clustering since not all ones are</span></div>
<div class="line"><span class="lineno"> 1213</span>    <span class="comment"># mapped to a same value</span></div>
<div class="line"><span class="lineno"> 1214</span>    labels3 = np.array([1, 0, 0, 2, 2, 0, 2, 1], dtype=np.int32)</div>
<div class="line"><span class="lineno"> 1215</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> _is_same_clustering(labels1, labels3, 3)</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1219</span>    <span class="stringliteral">&quot;kwargs&quot;</span>, ({<span class="stringliteral">&quot;init&quot;</span>: np.str_(<span class="stringliteral">&quot;k-means++&quot;</span>)}, {<span class="stringliteral">&quot;init&quot;</span>: [[0, 0], [1, 1]], <span class="stringliteral">&quot;n_init&quot;</span>: 1})</div>
<div class="line"><span class="lineno"> 1220</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="adced8adbc5ac00bd6778f4a7bd91818e" name="adced8adbc5ac00bd6778f4a7bd91818e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adced8adbc5ac00bd6778f4a7bd91818e">&#9670;&#160;</a></span>test_k_means_1_iteration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_k_means_1_iteration </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  968</span><span class="keyword">def </span>test_k_means_1_iteration(array_constr, algo, global_random_seed):</div>
<div class="line"><span class="lineno">  969</span>    <span class="comment"># check the results after a single iteration (E-step M-step E-step) by</span></div>
<div class="line"><span class="lineno">  970</span>    <span class="comment"># comparing against a pure python implementation.</span></div>
<div class="line"><span class="lineno">  971</span>    X = np.random.RandomState(global_random_seed).uniform(size=(100, 5))</div>
<div class="line"><span class="lineno">  972</span>    init_centers = X[:5]</div>
<div class="line"><span class="lineno">  973</span>    X = array_constr(X)</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>    <span class="keyword">def </span>py_kmeans(X, init):</div>
<div class="line"><span class="lineno">  976</span>        new_centers = init.copy()</div>
<div class="line"><span class="lineno">  977</span>        labels = pairwise_distances_argmin(X, init)</div>
<div class="line"><span class="lineno">  978</span>        <span class="keywordflow">for</span> label <span class="keywordflow">in</span> range(init.shape[0]):</div>
<div class="line"><span class="lineno">  979</span>            new_centers[label] = X[labels == label].mean(axis=0)</div>
<div class="line"><span class="lineno">  980</span>        labels = pairwise_distances_argmin(X, new_centers)</div>
<div class="line"><span class="lineno">  981</span>        <span class="keywordflow">return</span> labels, new_centers</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>    py_labels, py_centers = py_kmeans(X, init_centers)</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>    cy_kmeans = KMeans(</div>
<div class="line"><span class="lineno">  986</span>        n_clusters=5, n_init=1, init=init_centers, algorithm=algo, max_iter=1</div>
<div class="line"><span class="lineno">  987</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  988</span>    cy_labels = cy_kmeans.labels_</div>
<div class="line"><span class="lineno">  989</span>    cy_centers = cy_kmeans.cluster_centers_</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>    assert_array_equal(py_labels, cy_labels)</div>
<div class="line"><span class="lineno">  992</span>    assert_allclose(py_centers, cy_centers)</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span> </div>
<div class="line"><span class="lineno">  995</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [np.float32, np.float64])</span></div>
<div class="line"><span class="lineno">  996</span><span class="preprocessor">@pytest.mark.parametrize(&quot;squared&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94c1b6f8b90f0024c0f009b044554b92" name="a94c1b6f8b90f0024c0f009b044554b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94c1b6f8b90f0024c0f009b044554b92">&#9670;&#160;</a></span>test_k_means_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_k_means_function </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  755</span><span class="keyword">def </span>test_k_means_function(global_random_seed):</div>
<div class="line"><span class="lineno">  756</span>    <span class="comment"># test calling the k_means function directly</span></div>
<div class="line"><span class="lineno">  757</span>    cluster_centers, labels, inertia = k_means(</div>
<div class="line"><span class="lineno">  758</span>        X, n_clusters=n_clusters, sample_weight=<span class="keywordtype">None</span>, random_state=global_random_seed</div>
<div class="line"><span class="lineno">  759</span>    )</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>    <span class="keyword">assert</span> cluster_centers.shape == (n_clusters, n_features)</div>
<div class="line"><span class="lineno">  762</span>    <span class="keyword">assert</span> np.unique(labels).shape[0] == n_clusters</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>    <span class="comment"># check that the labels assignment are perfect (up to a permutation)</span></div>
<div class="line"><span class="lineno">  765</span>    assert_allclose(v_measure_score(true_labels, labels), 1.0)</div>
<div class="line"><span class="lineno">  766</span>    <span class="keyword">assert</span> inertia &gt; 0.0</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span><span class="preprocessor">@pytest.mark.parametrize(&quot;data&quot;, [X, X_csr], ids=[&quot;dense&quot;, &quot;sparse&quot;])</span></div>
<div class="line"><span class="lineno">  770</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af31eeecd9b44095699b379deb8734b60" name="af31eeecd9b44095699b379deb8734b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31eeecd9b44095699b379deb8734b60">&#9670;&#160;</a></span>test_kmeans_convergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_convergence </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  195</span><span class="keyword">def </span>test_kmeans_convergence(algorithm, global_random_seed):</div>
<div class="line"><span class="lineno">  196</span>    <span class="comment"># Check that KMeans stops when convergence is reached when tol=0. (#16075)</span></div>
<div class="line"><span class="lineno">  197</span>    rnd = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">  198</span>    X = rnd.normal(size=(5000, 10))</div>
<div class="line"><span class="lineno">  199</span>    max_iter = 300</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    km = KMeans(</div>
<div class="line"><span class="lineno">  202</span>        algorithm=algorithm,</div>
<div class="line"><span class="lineno">  203</span>        n_clusters=5,</div>
<div class="line"><span class="lineno">  204</span>        random_state=global_random_seed,</div>
<div class="line"><span class="lineno">  205</span>        n_init=1,</div>
<div class="line"><span class="lineno">  206</span>        tol=0,</div>
<div class="line"><span class="lineno">  207</span>        max_iter=max_iter,</div>
<div class="line"><span class="lineno">  208</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>    <span class="keyword">assert</span> km.n_iter_ &lt; max_iter</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span><span class="preprocessor">@pytest.mark.parametrize(&quot;algorithm&quot;, [&quot;auto&quot;, &quot;full&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d61b5aa8647e4c373f5e9497cbf583a" name="a8d61b5aa8647e4c373f5e9497cbf583a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d61b5aa8647e4c373f5e9497cbf583a">&#9670;&#160;</a></span>test_kmeans_copyx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_copyx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  576</span><span class="keyword">def </span>test_kmeans_copyx():</div>
<div class="line"><span class="lineno">  577</span>    <span class="comment"># Check that copy_x=False returns nearly equal X after de-centering.</span></div>
<div class="line"><span class="lineno">  578</span>    my_X = X.copy()</div>
<div class="line"><span class="lineno">  579</span>    km = KMeans(copy_x=<span class="keyword">False</span>, n_clusters=n_clusters, random_state=42)</div>
<div class="line"><span class="lineno">  580</span>    km.fit(my_X)</div>
<div class="line"><span class="lineno">  581</span>    _check_fitted_model(km)</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    <span class="comment"># check that my_X is de-centered</span></div>
<div class="line"><span class="lineno">  584</span>    assert_allclose(my_X, X)</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad687346e8fdc519e0e658111177b70ff" name="ad687346e8fdc519e0e658111177b70ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad687346e8fdc519e0e658111177b70ff">&#9670;&#160;</a></span>test_kmeans_elkan_iter_attribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_elkan_iter_attribute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  909</span><span class="keyword">def </span>test_kmeans_elkan_iter_attribute():</div>
<div class="line"><span class="lineno">  910</span>    <span class="comment"># Regression test on bad n_iter_ value. Previous bug n_iter_ was one off</span></div>
<div class="line"><span class="lineno">  911</span>    <span class="comment"># it&#39;s right value (#11340).</span></div>
<div class="line"><span class="lineno">  912</span>    km = KMeans(algorithm=<span class="stringliteral">&quot;elkan&quot;</span>, max_iter=1).fit(X)</div>
<div class="line"><span class="lineno">  913</span>    <span class="keyword">assert</span> km.n_iter_ == 1</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  917</span>    <span class="stringliteral">&quot;array_constr&quot;</span>, [np.array, sp.csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  918</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a25613257604a7c19e044ec33ee5042cc" name="a25613257604a7c19e044ec33ee5042cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25613257604a7c19e044ec33ee5042cc">&#9670;&#160;</a></span>test_kmeans_elkan_results()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_elkan_results </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distribution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  167</span><span class="keyword">def </span>test_kmeans_elkan_results(distribution, array_constr, tol, global_random_seed):</div>
<div class="line"><span class="lineno">  168</span>    <span class="comment"># Check that results are identical between lloyd and elkan algorithms</span></div>
<div class="line"><span class="lineno">  169</span>    rnd = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordflow">if</span> distribution == <span class="stringliteral">&quot;normal&quot;</span>:</div>
<div class="line"><span class="lineno">  171</span>        X = rnd.normal(size=(5000, 10))</div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  173</span>        X, _ = make_blobs(random_state=rnd)</div>
<div class="line"><span class="lineno">  174</span>    X[X &lt; 0] = 0</div>
<div class="line"><span class="lineno">  175</span>    X = array_constr(X)</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    km_lloyd = KMeans(n_clusters=5, random_state=global_random_seed, n_init=1, tol=tol)</div>
<div class="line"><span class="lineno">  178</span>    km_elkan = KMeans(</div>
<div class="line"><span class="lineno">  179</span>        algorithm=<span class="stringliteral">&quot;elkan&quot;</span>,</div>
<div class="line"><span class="lineno">  180</span>        n_clusters=5,</div>
<div class="line"><span class="lineno">  181</span>        random_state=global_random_seed,</div>
<div class="line"><span class="lineno">  182</span>        n_init=1,</div>
<div class="line"><span class="lineno">  183</span>        tol=tol,</div>
<div class="line"><span class="lineno">  184</span>    )</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    km_lloyd.fit(X)</div>
<div class="line"><span class="lineno">  187</span>    km_elkan.fit(X)</div>
<div class="line"><span class="lineno">  188</span>    assert_allclose(km_elkan.cluster_centers_, km_lloyd.cluster_centers_)</div>
<div class="line"><span class="lineno">  189</span>    assert_array_equal(km_elkan.labels_, km_lloyd.labels_)</div>
<div class="line"><span class="lineno">  190</span>    <span class="keyword">assert</span> km_elkan.n_iter_ == km_lloyd.n_iter_</div>
<div class="line"><span class="lineno">  191</span>    <span class="keyword">assert</span> km_elkan.inertia_ == pytest.approx(km_lloyd.inertia_, rel=1e-6)</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span><span class="preprocessor">@pytest.mark.parametrize(&quot;algorithm&quot;, [&quot;lloyd&quot;, &quot;elkan&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a435294f67c844932e29688e4bf1ed1" name="a5a435294f67c844932e29688e4bf1ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a435294f67c844932e29688e4bf1ed1">&#9670;&#160;</a></span>test_kmeans_empty_cluster_relocated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_empty_cluster_relocated </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array_constr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  919</span><span class="keyword">def </span>test_kmeans_empty_cluster_relocated(array_constr):</div>
<div class="line"><span class="lineno">  920</span>    <span class="comment"># check that empty clusters are correctly relocated when using sample</span></div>
<div class="line"><span class="lineno">  921</span>    <span class="comment"># weights (#13486)</span></div>
<div class="line"><span class="lineno">  922</span>    X = array_constr([[-1], [1]])</div>
<div class="line"><span class="lineno">  923</span>    sample_weight = [1.9, 0.1]</div>
<div class="line"><span class="lineno">  924</span>    init = np.array([[-1], [10]])</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span>    km = KMeans(n_clusters=2, init=init, n_init=1)</div>
<div class="line"><span class="lineno">  927</span>    km.fit(X, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>    <span class="keyword">assert</span> len(set(km.labels_)) == 2</div>
<div class="line"><span class="lineno">  930</span>    assert_allclose(km.cluster_centers_, [[-1], [1]])</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa08ddd432740987eaed9b89b036070a9" name="aa08ddd432740987eaed9b89b036070a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa08ddd432740987eaed9b89b036070a9">&#9670;&#160;</a></span>test_kmeans_init_fitted_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_init_fitted_centers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  823</span><span class="keyword">def </span>test_kmeans_init_fitted_centers(data):</div>
<div class="line"><span class="lineno">  824</span>    <span class="comment"># Check that starting fitting from a local optimum shouldn&#39;t change the</span></div>
<div class="line"><span class="lineno">  825</span>    <span class="comment"># solution</span></div>
<div class="line"><span class="lineno">  826</span>    km1 = KMeans(n_clusters=n_clusters).fit(data)</div>
<div class="line"><span class="lineno">  827</span>    km2 = KMeans(n_clusters=n_clusters, init=km1.cluster_centers_, n_init=1).fit(data)</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>    assert_allclose(km1.cluster_centers_, km2.cluster_centers_)</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae820722633c710b844344cc0d1738aa0" name="ae820722633c710b844344cc0d1738aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae820722633c710b844344cc0d1738aa0">&#9670;&#160;</a></span>test_kmeans_plusplus_dataorder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_plusplus_dataorder </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1189</span><span class="keyword">def </span>test_kmeans_plusplus_dataorder(global_random_seed):</div>
<div class="line"><span class="lineno"> 1190</span>    <span class="comment"># Check that memory layout does not effect result</span></div>
<div class="line"><span class="lineno"> 1191</span>    centers_c, _ = kmeans_plusplus(X, n_clusters, random_state=global_random_seed)</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>    X_fortran = np.asfortranarray(X)</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>    centers_fortran, _ = kmeans_plusplus(</div>
<div class="line"><span class="lineno"> 1196</span>        X_fortran, n_clusters, random_state=global_random_seed</div>
<div class="line"><span class="lineno"> 1197</span>    )</div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>    assert_allclose(centers_c, centers_fortran)</div>
<div class="line"><span class="lineno"> 1200</span> </div>
<div class="line"><span class="lineno"> 1201</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a977f85b1ca44256e83c0db070194c0ac" name="a977f85b1ca44256e83c0db070194c0ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a977f85b1ca44256e83c0db070194c0ac">&#9670;&#160;</a></span>test_kmeans_plusplus_norms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_plusplus_norms </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_squared_norms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1182</span><span class="keyword">def </span>test_kmeans_plusplus_norms(x_squared_norms):</div>
<div class="line"><span class="lineno"> 1183</span>    <span class="comment"># Check that defining x_squared_norms returns the same as default=None.</span></div>
<div class="line"><span class="lineno"> 1184</span>    centers, indices = kmeans_plusplus(X, n_clusters, x_squared_norms=x_squared_norms)</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>    assert_allclose(X[indices], centers)</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aec4d5d9cffb4fe84dbdcfa6364c546fc" name="aec4d5d9cffb4fe84dbdcfa6364c546fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec4d5d9cffb4fe84dbdcfa6364c546fc">&#9670;&#160;</a></span>test_kmeans_plusplus_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_plusplus_output </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1157</span><span class="keyword">def </span>test_kmeans_plusplus_output(data, dtype, global_random_seed):</div>
<div class="line"><span class="lineno"> 1158</span>    <span class="comment"># Check for the correct number of seeds and all positive values</span></div>
<div class="line"><span class="lineno"> 1159</span>    data = data.astype(dtype)</div>
<div class="line"><span class="lineno"> 1160</span>    centers, indices = kmeans_plusplus(</div>
<div class="line"><span class="lineno"> 1161</span>        data, n_clusters, random_state=global_random_seed</div>
<div class="line"><span class="lineno"> 1162</span>    )</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>    <span class="comment"># Check there are the correct number of indices and that all indices are</span></div>
<div class="line"><span class="lineno"> 1165</span>    <span class="comment"># positive and within the number of samples</span></div>
<div class="line"><span class="lineno"> 1166</span>    <span class="keyword">assert</span> indices.shape[0] == n_clusters</div>
<div class="line"><span class="lineno"> 1167</span>    <span class="keyword">assert</span> (indices &gt;= 0).all()</div>
<div class="line"><span class="lineno"> 1168</span>    <span class="keyword">assert</span> (indices &lt;= data.shape[0]).all()</div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span>    <span class="comment"># Check for the correct number of seeds and that they are bound by the data</span></div>
<div class="line"><span class="lineno"> 1171</span>    <span class="keyword">assert</span> centers.shape[0] == n_clusters</div>
<div class="line"><span class="lineno"> 1172</span>    <span class="keyword">assert</span> (centers.max(axis=0) &lt;= data.max(axis=0)).all()</div>
<div class="line"><span class="lineno"> 1173</span>    <span class="keyword">assert</span> (centers.min(axis=0) &gt;= data.min(axis=0)).all()</div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span>    <span class="comment"># Check that indices correspond to reported centers</span></div>
<div class="line"><span class="lineno"> 1176</span>    <span class="comment"># Use X for comparison rather than data, test still works against centers</span></div>
<div class="line"><span class="lineno"> 1177</span>    <span class="comment"># calculated with sparse data.</span></div>
<div class="line"><span class="lineno"> 1178</span>    assert_allclose(X[indices].astype(dtype), centers)</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span><span class="preprocessor">@pytest.mark.parametrize(&quot;x_squared_norms&quot;, [row_norms(X, squared=True)</span>, <span class="keywordtype">None</span>])</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab979daa7195328a977b1c807b3be747f" name="ab979daa7195328a977b1c807b3be747f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab979daa7195328a977b1c807b3be747f">&#9670;&#160;</a></span>test_kmeans_plusplus_wrong_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_plusplus_wrong_params </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>match</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1150</span><span class="keyword">def </span>test_kmeans_plusplus_wrong_params(param, match):</div>
<div class="line"><span class="lineno"> 1151</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=match):</div>
<div class="line"><span class="lineno"> 1152</span>        kmeans_plusplus(X, n_clusters, **param)</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span><span class="preprocessor">@pytest.mark.parametrize(&quot;data&quot;, [X, X_csr])</span></div>
<div class="line"><span class="lineno"> 1156</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [np.float64, np.float32])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0205c34c5acdafc712493d306f24e29" name="ac0205c34c5acdafc712493d306f24e29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0205c34c5acdafc712493d306f24e29">&#9670;&#160;</a></span>test_kmeans_predict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_predict </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  610</span>):</div>
<div class="line"><span class="lineno">  611</span>    <span class="comment"># Check the predict method and the equivalence between fit.predict and</span></div>
<div class="line"><span class="lineno">  612</span>    <span class="comment"># fit_predict.</span></div>
<div class="line"><span class="lineno">  613</span>    X, _ = make_blobs(</div>
<div class="line"><span class="lineno">  614</span>        n_samples=200, n_features=10, centers=10, random_state=global_random_seed</div>
<div class="line"><span class="lineno">  615</span>    )</div>
<div class="line"><span class="lineno">  616</span>    X = array_constr(X, dtype=global_dtype)</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>    km = Estimator(</div>
<div class="line"><span class="lineno">  619</span>        n_clusters=10,</div>
<div class="line"><span class="lineno">  620</span>        init=<span class="stringliteral">&quot;random&quot;</span>,</div>
<div class="line"><span class="lineno">  621</span>        n_init=10,</div>
<div class="line"><span class="lineno">  622</span>        max_iter=max_iter,</div>
<div class="line"><span class="lineno">  623</span>        random_state=global_random_seed,</div>
<div class="line"><span class="lineno">  624</span>    )</div>
<div class="line"><span class="lineno">  625</span>    <span class="keywordflow">if</span> algorithm <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  626</span>        km.set_params(algorithm=algorithm)</div>
<div class="line"><span class="lineno">  627</span>    km.fit(X)</div>
<div class="line"><span class="lineno">  628</span>    labels = km.labels_</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>    <span class="comment"># re-predict labels for training set using predict</span></div>
<div class="line"><span class="lineno">  631</span>    pred = km.predict(X)</div>
<div class="line"><span class="lineno">  632</span>    assert_array_equal(pred, labels)</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>    <span class="comment"># re-predict labels for training set using fit_predict</span></div>
<div class="line"><span class="lineno">  635</span>    pred = km.fit_predict(X)</div>
<div class="line"><span class="lineno">  636</span>    assert_array_equal(pred, labels)</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>    <span class="comment"># predict centroid labels</span></div>
<div class="line"><span class="lineno">  639</span>    pred = km.predict(km.cluster_centers_)</div>
<div class="line"><span class="lineno">  640</span>    assert_array_equal(pred, np.arange(10))</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ebafdf54702a24bb7dfb856d24128eb" name="a7ebafdf54702a24bb7dfb856d24128eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ebafdf54702a24bb7dfb856d24128eb">&#9670;&#160;</a></span>test_kmeans_relocated_clusters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_relocated_clusters </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   89</span><span class="keyword">def </span>test_kmeans_relocated_clusters(array_constr, algo):</div>
<div class="line"><span class="lineno">   90</span>    <span class="comment"># check that empty clusters are relocated as expected</span></div>
<div class="line"><span class="lineno">   91</span>    X = array_constr([[0, 0], [0.5, 0], [0.5, 1], [1, 1]])</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="comment"># second center too far from others points will be empty at first iter</span></div>
<div class="line"><span class="lineno">   94</span>    init_centers = np.array([[0.5, 0.5], [3, 3]])</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    kmeans = KMeans(n_clusters=2, n_init=1, init=init_centers, algorithm=algo)</div>
<div class="line"><span class="lineno">   97</span>    kmeans.fit(X)</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    expected_n_iter = 3</div>
<div class="line"><span class="lineno">  100</span>    expected_inertia = 0.25</div>
<div class="line"><span class="lineno">  101</span>    assert_allclose(kmeans.inertia_, expected_inertia)</div>
<div class="line"><span class="lineno">  102</span>    <span class="keyword">assert</span> kmeans.n_iter_ == expected_n_iter</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    <span class="comment"># There are two acceptable ways of relocating clusters in this example, the output</span></div>
<div class="line"><span class="lineno">  105</span>    <span class="comment"># depends on how the argpartition strategy breaks ties. We accept both outputs.</span></div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  107</span>        expected_labels = [0, 0, 1, 1]</div>
<div class="line"><span class="lineno">  108</span>        expected_centers = [[0.25, 0], [0.75, 1]]</div>
<div class="line"><span class="lineno">  109</span>        assert_array_equal(kmeans.labels_, expected_labels)</div>
<div class="line"><span class="lineno">  110</span>        assert_allclose(kmeans.cluster_centers_, expected_centers)</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">except</span> AssertionError:</div>
<div class="line"><span class="lineno">  112</span>        expected_labels = [1, 1, 0, 0]</div>
<div class="line"><span class="lineno">  113</span>        expected_centers = [[0.75, 1.0], [0.25, 0.0]]</div>
<div class="line"><span class="lineno">  114</span>        assert_array_equal(kmeans.labels_, expected_labels)</div>
<div class="line"><span class="lineno">  115</span>        assert_allclose(kmeans.cluster_centers_, expected_centers)</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  119</span>    <span class="stringliteral">&quot;array_constr&quot;</span>, [np.array, sp.csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  120</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a469c403060eea4fcbda0850fae03a5e6" name="a469c403060eea4fcbda0850fae03a5e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a469c403060eea4fcbda0850fae03a5e6">&#9670;&#160;</a></span>test_kmeans_results()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_results </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   64</span><span class="keyword">def </span>test_kmeans_results(array_constr, algo, dtype):</div>
<div class="line"><span class="lineno">   65</span>    <span class="comment"># Checks that KMeans works as intended on toy dataset by comparing with</span></div>
<div class="line"><span class="lineno">   66</span>    <span class="comment"># expected results computed by hand.</span></div>
<div class="line"><span class="lineno">   67</span>    X = array_constr([[0, 0], [0.5, 0], [0.5, 1], [1, 1]], dtype=dtype)</div>
<div class="line"><span class="lineno">   68</span>    sample_weight = [3, 1, 1, 3]</div>
<div class="line"><span class="lineno">   69</span>    init_centers = np.array([[0, 0], [1, 1]], dtype=dtype)</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    expected_labels = [0, 0, 1, 1]</div>
<div class="line"><span class="lineno">   72</span>    expected_inertia = 0.375</div>
<div class="line"><span class="lineno">   73</span>    expected_centers = np.array([[0.125, 0], [0.875, 1]], dtype=dtype)</div>
<div class="line"><span class="lineno">   74</span>    expected_n_iter = 2</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    kmeans = KMeans(n_clusters=2, n_init=1, init=init_centers, algorithm=algo)</div>
<div class="line"><span class="lineno">   77</span>    kmeans.fit(X, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>    assert_array_equal(kmeans.labels_, expected_labels)</div>
<div class="line"><span class="lineno">   80</span>    assert_allclose(kmeans.inertia_, expected_inertia)</div>
<div class="line"><span class="lineno">   81</span>    assert_allclose(kmeans.cluster_centers_, expected_centers)</div>
<div class="line"><span class="lineno">   82</span>    <span class="keyword">assert</span> kmeans.n_iter_ == expected_n_iter</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">   86</span>    <span class="stringliteral">&quot;array_constr&quot;</span>, [np.array, sp.csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">   87</span>)</div>
<div class="line"><span class="lineno">   88</span><span class="preprocessor">@pytest.mark.parametrize(&quot;algo&quot;, [&quot;lloyd&quot;, &quot;elkan&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a200f1ff9768ae299ed6f7aaf04e9d4ac" name="a200f1ff9768ae299ed6f7aaf04e9d4ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a200f1ff9768ae299ed6f7aaf04e9d4ac">&#9670;&#160;</a></span>test_kmeans_verbose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_verbose </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>capsys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  370</span><span class="keyword">def </span>test_kmeans_verbose(algorithm, tol, capsys):</div>
<div class="line"><span class="lineno">  371</span>    <span class="comment"># Check verbose mode of KMeans for better coverage.</span></div>
<div class="line"><span class="lineno">  372</span>    X = np.random.RandomState(0).normal(size=(5000, 10))</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>    KMeans(</div>
<div class="line"><span class="lineno">  375</span>        algorithm=algorithm,</div>
<div class="line"><span class="lineno">  376</span>        n_clusters=n_clusters,</div>
<div class="line"><span class="lineno">  377</span>        random_state=42,</div>
<div class="line"><span class="lineno">  378</span>        init=<span class="stringliteral">&quot;random&quot;</span>,</div>
<div class="line"><span class="lineno">  379</span>        n_init=1,</div>
<div class="line"><span class="lineno">  380</span>        tol=tol,</div>
<div class="line"><span class="lineno">  381</span>        verbose=1,</div>
<div class="line"><span class="lineno">  382</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    captured = capsys.readouterr()</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>    <span class="keyword">assert</span> re.search(<span class="stringliteral">r&quot;Initialization complete&quot;</span>, captured.out)</div>
<div class="line"><span class="lineno">  387</span>    <span class="keyword">assert</span> re.search(<span class="stringliteral">r&quot;Iteration [0-9]+, inertia&quot;</span>, captured.out)</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>    <span class="keywordflow">if</span> tol == 0:</div>
<div class="line"><span class="lineno">  390</span>        <span class="keyword">assert</span> re.search(<span class="stringliteral">r&quot;strict convergence&quot;</span>, captured.out)</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  392</span>        <span class="keyword">assert</span> re.search(<span class="stringliteral">r&quot;center shift .* within tolerance&quot;</span>, captured.out)</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a08e8ec3453f99093c5debc829e244f72" name="a08e8ec3453f99093c5debc829e244f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08e8ec3453f99093c5debc829e244f72">&#9670;&#160;</a></span>test_kmeans_warns_less_centers_than_unique_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_warns_less_centers_than_unique_points </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  832</span><span class="keyword">def </span>test_kmeans_warns_less_centers_than_unique_points(global_random_seed):</div>
<div class="line"><span class="lineno">  833</span>    <span class="comment"># Check KMeans when the number of found clusters is smaller than expected</span></div>
<div class="line"><span class="lineno">  834</span>    X = np.asarray([[0, 0], [0, 1], [1, 0], [1, 0]])  <span class="comment"># last point is duplicated</span></div>
<div class="line"><span class="lineno">  835</span>    km = KMeans(n_clusters=4, random_state=global_random_seed)</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>    <span class="comment"># KMeans should warn that fewer labels than cluster centers have been used</span></div>
<div class="line"><span class="lineno">  838</span>    msg = (</div>
<div class="line"><span class="lineno">  839</span>        <span class="stringliteral">r&quot;Number of distinct clusters \&zwj;(3\&zwj;) found smaller than &quot;</span></div>
<div class="line"><span class="lineno">  840</span>        <span class="stringliteral">r&quot;n_clusters \&zwj;(4\&zwj;). Possibly due to duplicate points in X.&quot;</span></div>
<div class="line"><span class="lineno">  841</span>    )</div>
<div class="line"><span class="lineno">  842</span>    <span class="keyword">with</span> pytest.warns(ConvergenceWarning, match=msg):</div>
<div class="line"><span class="lineno">  843</span>        km.fit(X)</div>
<div class="line"><span class="lineno">  844</span>        <span class="comment"># only three distinct points, so only three clusters</span></div>
<div class="line"><span class="lineno">  845</span>        <span class="comment"># can have points assigned to them</span></div>
<div class="line"><span class="lineno">  846</span>        <span class="keyword">assert</span> set(km.labels_) == set(range(3))</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e395e8f001c005654bf8c85cba7ef95" name="a3e395e8f001c005654bf8c85cba7ef95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e395e8f001c005654bf8c85cba7ef95">&#9670;&#160;</a></span>test_kmeans_with_array_like_or_np_scalar_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_kmeans_with_array_like_or_np_scalar_init </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that init works with numpy scalar strings.

Non-regression test for #21964.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1221</span><span class="keyword">def </span>test_kmeans_with_array_like_or_np_scalar_init(kwargs):</div>
<div class="line"><span class="lineno"> 1222</span>    <span class="stringliteral">&quot;&quot;&quot;Check that init works with numpy scalar strings.</span></div>
<div class="line"><span class="lineno"> 1223</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1224</span><span class="stringliteral">    Non-regression test for #21964.</span></div>
<div class="line"><span class="lineno"> 1225</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1226</span>    X = np.asarray([[0, 0], [0.5, 0], [0.5, 1], [1, 1]], dtype=np.float64)</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>    clustering = KMeans(n_clusters=2, **kwargs)</div>
<div class="line"><span class="lineno"> 1229</span>    <span class="comment"># Does not raise</span></div>
<div class="line"><span class="lineno"> 1230</span>    clustering.fit(X)</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1234</span>    <span class="stringliteral">&quot;Klass, method&quot;</span>,</div>
<div class="line"><span class="lineno"> 1235</span>    [(KMeans, <span class="stringliteral">&quot;fit&quot;</span>), (MiniBatchKMeans, <span class="stringliteral">&quot;fit&quot;</span>), (MiniBatchKMeans, <span class="stringliteral">&quot;partial_fit&quot;</span>)],</div>
<div class="line"><span class="lineno"> 1236</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ce538f29d664ae1125a457495e42846" name="a3ce538f29d664ae1125a457495e42846"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ce538f29d664ae1125a457495e42846">&#9670;&#160;</a></span>test_minibatch_declared_convergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_declared_convergence </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>capsys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_no_improvement</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  524</span><span class="keyword">def </span>test_minibatch_declared_convergence(capsys, tol, max_no_improvement):</div>
<div class="line"><span class="lineno">  525</span>    <span class="comment"># Check convergence detection based on ewa batch inertia or on</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="comment"># small center change.</span></div>
<div class="line"><span class="lineno">  527</span>    X, _, centers = make_blobs(centers=3, random_state=0, return_centers=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>    km = MiniBatchKMeans(</div>
<div class="line"><span class="lineno">  530</span>        n_clusters=3,</div>
<div class="line"><span class="lineno">  531</span>        init=centers,</div>
<div class="line"><span class="lineno">  532</span>        batch_size=20,</div>
<div class="line"><span class="lineno">  533</span>        tol=tol,</div>
<div class="line"><span class="lineno">  534</span>        random_state=0,</div>
<div class="line"><span class="lineno">  535</span>        max_iter=10,</div>
<div class="line"><span class="lineno">  536</span>        n_init=1,</div>
<div class="line"><span class="lineno">  537</span>        verbose=1,</div>
<div class="line"><span class="lineno">  538</span>        max_no_improvement=max_no_improvement,</div>
<div class="line"><span class="lineno">  539</span>    )</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>    km.fit(X)</div>
<div class="line"><span class="lineno">  542</span>    <span class="keyword">assert</span> 1 &lt; km.n_iter_ &lt; 10</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    captured = capsys.readouterr()</div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">if</span> max_no_improvement <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  546</span>        <span class="keyword">assert</span> <span class="stringliteral">&quot;Converged (small centers change)&quot;</span> <span class="keywordflow">in</span> captured.out</div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">if</span> tol == 0:</div>
<div class="line"><span class="lineno">  548</span>        <span class="keyword">assert</span> <span class="stringliteral">&quot;Converged (lack of improvement in inertia)&quot;</span> <span class="keywordflow">in</span> captured.out</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5585fd3630085549c667340bd3cac25" name="ad5585fd3630085549c667340bd3cac25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5585fd3630085549c667340bd3cac25">&#9670;&#160;</a></span>test_minibatch_iter_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_iter_steps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  551</span><span class="keyword">def </span>test_minibatch_iter_steps():</div>
<div class="line"><span class="lineno">  552</span>    <span class="comment"># Check consistency of n_iter_ and n_steps_ attributes.</span></div>
<div class="line"><span class="lineno">  553</span>    batch_size = 30</div>
<div class="line"><span class="lineno">  554</span>    n_samples = X.shape[0]</div>
<div class="line"><span class="lineno">  555</span>    km = MiniBatchKMeans(n_clusters=3, batch_size=batch_size, random_state=0).fit(X)</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>    <span class="comment"># n_iter_ is the number of started epochs</span></div>
<div class="line"><span class="lineno">  558</span>    <span class="keyword">assert</span> km.n_iter_ == np.ceil((km.n_steps_ * batch_size) / n_samples)</div>
<div class="line"><span class="lineno">  559</span>    <span class="keyword">assert</span> isinstance(km.n_iter_, int)</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>    <span class="comment"># without stopping condition, max_iter should be reached</span></div>
<div class="line"><span class="lineno">  562</span>    km = MiniBatchKMeans(</div>
<div class="line"><span class="lineno">  563</span>        n_clusters=3,</div>
<div class="line"><span class="lineno">  564</span>        batch_size=batch_size,</div>
<div class="line"><span class="lineno">  565</span>        random_state=0,</div>
<div class="line"><span class="lineno">  566</span>        tol=0,</div>
<div class="line"><span class="lineno">  567</span>        max_no_improvement=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  568</span>        max_iter=10,</div>
<div class="line"><span class="lineno">  569</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>    <span class="keyword">assert</span> km.n_iter_ == 10</div>
<div class="line"><span class="lineno">  572</span>    <span class="keyword">assert</span> km.n_steps_ == (10 * n_samples) // batch_size</div>
<div class="line"><span class="lineno">  573</span>    <span class="keyword">assert</span> isinstance(km.n_steps_, int)</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a39fb8417561f61df369a83519adea244" name="a39fb8417561f61df369a83519adea244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39fb8417561f61df369a83519adea244">&#9670;&#160;</a></span>test_minibatch_kmeans_init_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_kmeans_init_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  505</span><span class="keyword">def </span>test_minibatch_kmeans_init_size():</div>
<div class="line"><span class="lineno">  506</span>    <span class="comment"># Check the internal _init_size attribute of MiniBatchKMeans</span></div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>    <span class="comment"># default init size should be 3 * batch_size</span></div>
<div class="line"><span class="lineno">  509</span>    km = MiniBatchKMeans(n_clusters=10, batch_size=5, n_init=1).fit(X)</div>
<div class="line"><span class="lineno">  510</span>    <span class="keyword">assert</span> km._init_size == 15</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    <span class="comment"># if 3 * batch size &lt; n_clusters, it should then be 3 * n_clusters</span></div>
<div class="line"><span class="lineno">  513</span>    km = MiniBatchKMeans(n_clusters=10, batch_size=1, n_init=1).fit(X)</div>
<div class="line"><span class="lineno">  514</span>    <span class="keyword">assert</span> km._init_size == 30</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>    <span class="comment"># it should not be larger than n_samples</span></div>
<div class="line"><span class="lineno">  517</span>    km = MiniBatchKMeans(</div>
<div class="line"><span class="lineno">  518</span>        n_clusters=10, batch_size=5, n_init=1, init_size=n_samples + 1</div>
<div class="line"><span class="lineno">  519</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  520</span>    <span class="keyword">assert</span> km._init_size == n_samples</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span><span class="preprocessor">@pytest.mark.parametrize(&quot;tol, max_no_improvement&quot;, [(1e-4, None)</span>, (0, 10)])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fa393ca95e1017b89b1233ffc764b9e" name="a5fa393ca95e1017b89b1233ffc764b9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fa393ca95e1017b89b1233ffc764b9e">&#9670;&#160;</a></span>test_minibatch_kmeans_partial_fit_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_kmeans_partial_fit_init </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  326</span><span class="keyword">def </span>test_minibatch_kmeans_partial_fit_init(init):</div>
<div class="line"><span class="lineno">  327</span>    <span class="comment"># Check MiniBatchKMeans init with partial_fit</span></div>
<div class="line"><span class="lineno">  328</span>    n_init = 10 <span class="keywordflow">if</span> isinstance(init, str) <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  329</span>    km = MiniBatchKMeans(</div>
<div class="line"><span class="lineno">  330</span>        init=init, n_clusters=n_clusters, random_state=0, n_init=n_init</div>
<div class="line"><span class="lineno">  331</span>    )</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(100):</div>
<div class="line"><span class="lineno">  333</span>        <span class="comment"># &quot;random&quot; init requires many batches to recover the true labels.</span></div>
<div class="line"><span class="lineno">  334</span>        km.partial_fit(X)</div>
<div class="line"><span class="lineno">  335</span>    _check_fitted_model(km)</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6646124bdd39f6f8f5717a24163cf15" name="ae6646124bdd39f6f8f5717a24163cf15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6646124bdd39f6f8f5717a24163cf15">&#9670;&#160;</a></span>test_minibatch_kmeans_verbose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_kmeans_verbose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  357</span><span class="keyword">def </span>test_minibatch_kmeans_verbose():</div>
<div class="line"><span class="lineno">  358</span>    <span class="comment"># Check verbose mode of MiniBatchKMeans for better coverage.</span></div>
<div class="line"><span class="lineno">  359</span>    km = MiniBatchKMeans(n_clusters=n_clusters, random_state=42, verbose=1)</div>
<div class="line"><span class="lineno">  360</span>    old_stdout = sys.stdout</div>
<div class="line"><span class="lineno">  361</span>    sys.stdout = StringIO()</div>
<div class="line"><span class="lineno">  362</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  363</span>        km.fit(X)</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  365</span>        sys.stdout = old_stdout</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span><span class="preprocessor">@pytest.mark.parametrize(&quot;algorithm&quot;, [&quot;lloyd&quot;, &quot;elkan&quot;])</span></div>
<div class="line"><span class="lineno">  369</span><span class="preprocessor">@pytest.mark.parametrize(&quot;tol&quot;, [1e-2, 0])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a6d8f2bfd39f3f5c9d3ffc7471dd2cc" name="a3a6d8f2bfd39f3f5c9d3ffc7471dd2cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a6d8f2bfd39f3f5c9d3ffc7471dd2cc">&#9670;&#160;</a></span>test_minibatch_kmeans_warning_init_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_kmeans_warning_init_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  395</span><span class="keyword">def </span>test_minibatch_kmeans_warning_init_size():</div>
<div class="line"><span class="lineno">  396</span>    <span class="comment"># Check that a warning is raised when init_size is smaller than n_clusters</span></div>
<div class="line"><span class="lineno">  397</span>    <span class="keyword">with</span> pytest.warns(</div>
<div class="line"><span class="lineno">  398</span>        RuntimeWarning, match=<span class="stringliteral">r&quot;init_size.* should be larger than n_clusters&quot;</span></div>
<div class="line"><span class="lineno">  399</span>    ):</div>
<div class="line"><span class="lineno">  400</span>        MiniBatchKMeans(init_size=10, n_clusters=20).fit(X)</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a589cc6bad96255443fdf6442a0b774f7" name="a589cc6bad96255443fdf6442a0b774f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a589cc6bad96255443fdf6442a0b774f7">&#9670;&#160;</a></span>test_minibatch_reassign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_reassign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  445</span><span class="keyword">def </span>test_minibatch_reassign(data, global_random_seed):</div>
<div class="line"><span class="lineno">  446</span>    <span class="comment"># Check the reassignment part of the minibatch step with very high or very</span></div>
<div class="line"><span class="lineno">  447</span>    <span class="comment"># low reassignment ratio.</span></div>
<div class="line"><span class="lineno">  448</span>    perfect_centers = np.empty((n_clusters, n_features))</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n_clusters):</div>
<div class="line"><span class="lineno">  450</span>        perfect_centers[i] = X[true_labels == i].mean(axis=0)</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>    sample_weight = np.ones(n_samples)</div>
<div class="line"><span class="lineno">  453</span>    centers_new = np.empty_like(perfect_centers)</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <span class="comment"># Give a perfect initialization, but a large reassignment_ratio, as a</span></div>
<div class="line"><span class="lineno">  456</span>    <span class="comment"># result many centers should be reassigned and the model should no longer</span></div>
<div class="line"><span class="lineno">  457</span>    <span class="comment"># be good</span></div>
<div class="line"><span class="lineno">  458</span>    score_before = -_labels_inertia(data, sample_weight, perfect_centers, 1)[1]</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    _mini_batch_step(</div>
<div class="line"><span class="lineno">  461</span>        data,</div>
<div class="line"><span class="lineno">  462</span>        sample_weight,</div>
<div class="line"><span class="lineno">  463</span>        perfect_centers,</div>
<div class="line"><span class="lineno">  464</span>        centers_new,</div>
<div class="line"><span class="lineno">  465</span>        np.zeros(n_clusters),</div>
<div class="line"><span class="lineno">  466</span>        np.random.RandomState(global_random_seed),</div>
<div class="line"><span class="lineno">  467</span>        random_reassign=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  468</span>        reassignment_ratio=1,</div>
<div class="line"><span class="lineno">  469</span>    )</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    score_after = -_labels_inertia(data, sample_weight, centers_new, 1)[1]</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    <span class="keyword">assert</span> score_before &gt; score_after</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="comment"># Give a perfect initialization, with a small reassignment_ratio,</span></div>
<div class="line"><span class="lineno">  476</span>    <span class="comment"># no center should be reassigned.</span></div>
<div class="line"><span class="lineno">  477</span>    _mini_batch_step(</div>
<div class="line"><span class="lineno">  478</span>        data,</div>
<div class="line"><span class="lineno">  479</span>        sample_weight,</div>
<div class="line"><span class="lineno">  480</span>        perfect_centers,</div>
<div class="line"><span class="lineno">  481</span>        centers_new,</div>
<div class="line"><span class="lineno">  482</span>        np.zeros(n_clusters),</div>
<div class="line"><span class="lineno">  483</span>        np.random.RandomState(global_random_seed),</div>
<div class="line"><span class="lineno">  484</span>        random_reassign=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  485</span>        reassignment_ratio=1e-15,</div>
<div class="line"><span class="lineno">  486</span>    )</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    assert_allclose(centers_new, perfect_centers)</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5622f0be284cad4744300ca6e38473c9" name="a5622f0be284cad4744300ca6e38473c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5622f0be284cad4744300ca6e38473c9">&#9670;&#160;</a></span>test_minibatch_sensible_reassign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_sensible_reassign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  414</span><span class="keyword">def </span>test_minibatch_sensible_reassign(global_random_seed):</div>
<div class="line"><span class="lineno">  415</span>    <span class="comment"># check that identical initial clusters are reassigned</span></div>
<div class="line"><span class="lineno">  416</span>    <span class="comment"># also a regression test for when there are more desired reassignments than</span></div>
<div class="line"><span class="lineno">  417</span>    <span class="comment"># samples.</span></div>
<div class="line"><span class="lineno">  418</span>    zeroed_X, true_labels = make_blobs(</div>
<div class="line"><span class="lineno">  419</span>        n_samples=100, centers=5, random_state=global_random_seed</div>
<div class="line"><span class="lineno">  420</span>    )</div>
<div class="line"><span class="lineno">  421</span>    zeroed_X[::2, :] = 0</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    km = MiniBatchKMeans(</div>
<div class="line"><span class="lineno">  424</span>        n_clusters=20, batch_size=10, random_state=global_random_seed, init=<span class="stringliteral">&quot;random&quot;</span></div>
<div class="line"><span class="lineno">  425</span>    ).fit(zeroed_X)</div>
<div class="line"><span class="lineno">  426</span>    <span class="comment"># there should not be too many exact zero cluster centers</span></div>
<div class="line"><span class="lineno">  427</span>    <span class="keyword">assert</span> km.cluster_centers_.any(axis=1).sum() &gt; 10</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    <span class="comment"># do the same with batch-size &gt; X.shape[0] (regression test)</span></div>
<div class="line"><span class="lineno">  430</span>    km = MiniBatchKMeans(</div>
<div class="line"><span class="lineno">  431</span>        n_clusters=20, batch_size=200, random_state=global_random_seed, init=<span class="stringliteral">&quot;random&quot;</span></div>
<div class="line"><span class="lineno">  432</span>    ).fit(zeroed_X)</div>
<div class="line"><span class="lineno">  433</span>    <span class="comment"># there should not be too many exact zero cluster centers</span></div>
<div class="line"><span class="lineno">  434</span>    <span class="keyword">assert</span> km.cluster_centers_.any(axis=1).sum() &gt; 10</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    <span class="comment"># do the same with partial_fit API</span></div>
<div class="line"><span class="lineno">  437</span>    km = MiniBatchKMeans(n_clusters=20, random_state=global_random_seed, init=<span class="stringliteral">&quot;random&quot;</span>)</div>
<div class="line"><span class="lineno">  438</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(100):</div>
<div class="line"><span class="lineno">  439</span>        km.partial_fit(zeroed_X)</div>
<div class="line"><span class="lineno">  440</span>    <span class="comment"># there should not be too many exact zero cluster centers</span></div>
<div class="line"><span class="lineno">  441</span>    <span class="keyword">assert</span> km.cluster_centers_.any(axis=1).sum() &gt; 10</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span><span class="preprocessor">@pytest.mark.parametrize(&quot;data&quot;, [X, X_csr], ids=[&quot;dense&quot;, &quot;sparse&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a680e4b7bd70d5a3fa79d3e55f9dc84ca" name="a680e4b7bd70d5a3fa79d3e55f9dc84ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a680e4b7bd70d5a3fa79d3e55f9dc84ca">&#9670;&#160;</a></span>test_minibatch_update_consistency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_update_consistency </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  228</span><span class="keyword">def </span>test_minibatch_update_consistency(global_random_seed):</div>
<div class="line"><span class="lineno">  229</span>    <span class="comment"># Check that dense and sparse minibatch update give the same results</span></div>
<div class="line"><span class="lineno">  230</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    centers_old = centers + rng.normal(size=centers.shape)</div>
<div class="line"><span class="lineno">  233</span>    centers_old_csr = centers_old.copy()</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    centers_new = np.zeros_like(centers_old)</div>
<div class="line"><span class="lineno">  236</span>    centers_new_csr = np.zeros_like(centers_old_csr)</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    weight_sums = np.zeros(centers_old.shape[0], dtype=X.dtype)</div>
<div class="line"><span class="lineno">  239</span>    weight_sums_csr = np.zeros(centers_old.shape[0], dtype=X.dtype)</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    sample_weight = np.ones(X.shape[0], dtype=X.dtype)</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>    <span class="comment"># extract a small minibatch</span></div>
<div class="line"><span class="lineno">  244</span>    X_mb = X[:10]</div>
<div class="line"><span class="lineno">  245</span>    X_mb_csr = X_csr[:10]</div>
<div class="line"><span class="lineno">  246</span>    sample_weight_mb = sample_weight[:10]</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="comment"># step 1: compute the dense minibatch update</span></div>
<div class="line"><span class="lineno">  249</span>    old_inertia = _mini_batch_step(</div>
<div class="line"><span class="lineno">  250</span>        X_mb,</div>
<div class="line"><span class="lineno">  251</span>        sample_weight_mb,</div>
<div class="line"><span class="lineno">  252</span>        centers_old,</div>
<div class="line"><span class="lineno">  253</span>        centers_new,</div>
<div class="line"><span class="lineno">  254</span>        weight_sums,</div>
<div class="line"><span class="lineno">  255</span>        np.random.RandomState(global_random_seed),</div>
<div class="line"><span class="lineno">  256</span>        random_reassign=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  257</span>    )</div>
<div class="line"><span class="lineno">  258</span>    <span class="keyword">assert</span> old_inertia &gt; 0.0</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="comment"># compute the new inertia on the same batch to check that it decreased</span></div>
<div class="line"><span class="lineno">  261</span>    labels, new_inertia = _labels_inertia(X_mb, sample_weight_mb, centers_new)</div>
<div class="line"><span class="lineno">  262</span>    <span class="keyword">assert</span> new_inertia &gt; 0.0</div>
<div class="line"><span class="lineno">  263</span>    <span class="keyword">assert</span> new_inertia &lt; old_inertia</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="comment"># step 2: compute the sparse minibatch update</span></div>
<div class="line"><span class="lineno">  266</span>    old_inertia_csr = _mini_batch_step(</div>
<div class="line"><span class="lineno">  267</span>        X_mb_csr,</div>
<div class="line"><span class="lineno">  268</span>        sample_weight_mb,</div>
<div class="line"><span class="lineno">  269</span>        centers_old_csr,</div>
<div class="line"><span class="lineno">  270</span>        centers_new_csr,</div>
<div class="line"><span class="lineno">  271</span>        weight_sums_csr,</div>
<div class="line"><span class="lineno">  272</span>        np.random.RandomState(global_random_seed),</div>
<div class="line"><span class="lineno">  273</span>        random_reassign=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  274</span>    )</div>
<div class="line"><span class="lineno">  275</span>    <span class="keyword">assert</span> old_inertia_csr &gt; 0.0</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>    <span class="comment"># compute the new inertia on the same batch to check that it decreased</span></div>
<div class="line"><span class="lineno">  278</span>    labels_csr, new_inertia_csr = _labels_inertia(</div>
<div class="line"><span class="lineno">  279</span>        X_mb_csr, sample_weight_mb, centers_new_csr</div>
<div class="line"><span class="lineno">  280</span>    )</div>
<div class="line"><span class="lineno">  281</span>    <span class="keyword">assert</span> new_inertia_csr &gt; 0.0</div>
<div class="line"><span class="lineno">  282</span>    <span class="keyword">assert</span> new_inertia_csr &lt; old_inertia_csr</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    <span class="comment"># step 3: check that sparse and dense updates lead to the same results</span></div>
<div class="line"><span class="lineno">  285</span>    assert_array_equal(labels, labels_csr)</div>
<div class="line"><span class="lineno">  286</span>    assert_allclose(centers_new, centers_new_csr)</div>
<div class="line"><span class="lineno">  287</span>    assert_allclose(old_inertia, old_inertia_csr)</div>
<div class="line"><span class="lineno">  288</span>    assert_allclose(new_inertia, new_inertia_csr)</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aad3043c701bed45ab76a9cca3f55cf36" name="aad3043c701bed45ab76a9cca3f55cf36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad3043c701bed45ab76a9cca3f55cf36">&#9670;&#160;</a></span>test_minibatch_with_many_reassignments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_minibatch_with_many_reassignments </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  491</span><span class="keyword">def </span>test_minibatch_with_many_reassignments():</div>
<div class="line"><span class="lineno">  492</span>    <span class="comment"># Test for the case that the number of clusters to reassign is bigger</span></div>
<div class="line"><span class="lineno">  493</span>    <span class="comment"># than the batch_size. Run the test with 100 clusters and a batch_size of</span></div>
<div class="line"><span class="lineno">  494</span>    <span class="comment"># 10 because it turned out that these values ensure that the number of</span></div>
<div class="line"><span class="lineno">  495</span>    <span class="comment"># clusters to reassign is always bigger than the batch_size.</span></div>
<div class="line"><span class="lineno">  496</span>    MiniBatchKMeans(</div>
<div class="line"><span class="lineno">  497</span>        n_clusters=100,</div>
<div class="line"><span class="lineno">  498</span>        batch_size=10,</div>
<div class="line"><span class="lineno">  499</span>        init_size=n_samples,</div>
<div class="line"><span class="lineno">  500</span>        random_state=42,</div>
<div class="line"><span class="lineno">  501</span>        verbose=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  502</span>    ).fit(X)</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a662372405f3ce681d108e121ddc74fcc" name="a662372405f3ce681d108e121ddc74fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a662372405f3ce681d108e121ddc74fcc">&#9670;&#160;</a></span>test_n_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_n_init </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  739</span><span class="keyword">def </span>test_n_init(global_random_seed):</div>
<div class="line"><span class="lineno">  740</span>    <span class="comment"># Check that increasing the number of init increases the quality</span></div>
<div class="line"><span class="lineno">  741</span>    previous_inertia = np.inf</div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">for</span> n_init <span class="keywordflow">in</span> [1, 5, 10]:</div>
<div class="line"><span class="lineno">  743</span>        <span class="comment"># set max_iter=1 to avoid finding the global minimum and get the same</span></div>
<div class="line"><span class="lineno">  744</span>        <span class="comment"># inertia each time</span></div>
<div class="line"><span class="lineno">  745</span>        km = KMeans(</div>
<div class="line"><span class="lineno">  746</span>            n_clusters=n_clusters,</div>
<div class="line"><span class="lineno">  747</span>            init=<span class="stringliteral">&quot;random&quot;</span>,</div>
<div class="line"><span class="lineno">  748</span>            n_init=n_init,</div>
<div class="line"><span class="lineno">  749</span>            random_state=global_random_seed,</div>
<div class="line"><span class="lineno">  750</span>            max_iter=1,</div>
<div class="line"><span class="lineno">  751</span>        ).fit(X)</div>
<div class="line"><span class="lineno">  752</span>        <span class="keyword">assert</span> km.inertia_ &lt;= previous_inertia</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a47be48da36279285298bd1ebb74664c0" name="a47be48da36279285298bd1ebb74664c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47be48da36279285298bd1ebb74664c0">&#9670;&#160;</a></span>test_n_init_auto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_n_init_auto </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Klass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>default_n_init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1084</span><span class="keyword">def </span>test_n_init_auto(Klass, default_n_init):</div>
<div class="line"><span class="lineno"> 1085</span>    est = Klass(n_init=<span class="stringliteral">&quot;auto&quot;</span>, init=<span class="stringliteral">&quot;k-means++&quot;</span>)</div>
<div class="line"><span class="lineno"> 1086</span>    est.fit(X)</div>
<div class="line"><span class="lineno"> 1087</span>    <span class="keyword">assert</span> est._n_init == 1</div>
<div class="line"><span class="lineno"> 1088</span> </div>
<div class="line"><span class="lineno"> 1089</span>    est = Klass(n_init=<span class="stringliteral">&quot;auto&quot;</span>, init=<span class="stringliteral">&quot;random&quot;</span>)</div>
<div class="line"><span class="lineno"> 1090</span>    est.fit(X)</div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keyword">assert</span> est._n_init == 10 <span class="keywordflow">if</span> Klass.__name__ == <span class="stringliteral">&quot;KMeans&quot;</span> <span class="keywordflow">else</span> 3</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afb5d300a0851452e99f759db215d6065" name="afb5d300a0851452e99f759db215d6065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb5d300a0851452e99f759db215d6065">&#9670;&#160;</a></span>test_predict_dense_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_predict_dense_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  666</span><span class="keyword">def </span>test_predict_dense_sparse(Estimator, init):</div>
<div class="line"><span class="lineno">  667</span>    <span class="comment"># check that models trained on sparse input also works for dense input at</span></div>
<div class="line"><span class="lineno">  668</span>    <span class="comment"># predict time and vice versa.</span></div>
<div class="line"><span class="lineno">  669</span>    n_init = 10 <span class="keywordflow">if</span> isinstance(init, str) <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  670</span>    km = Estimator(n_clusters=n_clusters, init=init, n_init=n_init, random_state=0)</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>    km.fit(X_csr)</div>
<div class="line"><span class="lineno">  673</span>    assert_array_equal(km.predict(X), km.labels_)</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>    km.fit(X)</div>
<div class="line"><span class="lineno">  676</span>    assert_array_equal(km.predict(X_csr), km.labels_)</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  680</span>    <span class="stringliteral">&quot;array_constr&quot;</span>, [np.array, sp.csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  681</span>)</div>
<div class="line"><span class="lineno">  682</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [np.int32, np.int64])</span></div>
<div class="line"><span class="lineno">  683</span><span class="preprocessor">@pytest.mark.parametrize(&quot;init&quot;, [&quot;k-means++&quot;, &quot;ndarray&quot;])</span></div>
<div class="line"><span class="lineno">  684</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="acf38cf0c07f0ce449d2606a30f2eede0" name="acf38cf0c07f0ce449d2606a30f2eede0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf38cf0c07f0ce449d2606a30f2eede0">&#9670;&#160;</a></span>test_predict_does_not_change_cluster_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_predict_does_not_change_cluster_centers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>is_sparse</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that predict does not change cluster centers.

Non-regression test for gh-24253.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1249</span><span class="keyword">def </span>test_predict_does_not_change_cluster_centers(is_sparse):</div>
<div class="line"><span class="lineno"> 1250</span>    <span class="stringliteral">&quot;&quot;&quot;Check that predict does not change cluster centers.</span></div>
<div class="line"><span class="lineno"> 1251</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1252</span><span class="stringliteral">    Non-regression test for gh-24253.</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1254</span>    X, _ = make_blobs(n_samples=200, n_features=10, centers=10, random_state=0)</div>
<div class="line"><span class="lineno"> 1255</span>    <span class="keywordflow">if</span> is_sparse:</div>
<div class="line"><span class="lineno"> 1256</span>        X = sp.csr_matrix(X)</div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span>    kmeans = KMeans()</div>
<div class="line"><span class="lineno"> 1259</span>    y_pred1 = kmeans.fit_predict(X)</div>
<div class="line"><span class="lineno"> 1260</span>    <span class="comment"># Make cluster_centers readonly</span></div>
<div class="line"><span class="lineno"> 1261</span>    kmeans.cluster_centers_ = create_memmap_backed_data(kmeans.cluster_centers_)</div>
<div class="line"><span class="lineno"> 1262</span>    kmeans.labels_ = create_memmap_backed_data(kmeans.labels_)</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>    y_pred2 = kmeans.predict(X)</div>
<div class="line"><span class="lineno"> 1265</span>    assert_array_equal(y_pred1, y_pred2)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a98c0c54948be9aba741ef5a1b2d4b408" name="a98c0c54948be9aba741ef5a1b2d4b408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c0c54948be9aba741ef5a1b2d4b408">&#9670;&#160;</a></span>test_relocate_empty_clusters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_relocate_empty_clusters </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>array_constr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  121</span><span class="keyword">def </span>test_relocate_empty_clusters(array_constr):</div>
<div class="line"><span class="lineno">  122</span>    <span class="comment"># test for the _relocate_empty_clusters_(dense/sparse) helpers</span></div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    <span class="comment"># Synthetic dataset with 3 obvious clusters of different sizes</span></div>
<div class="line"><span class="lineno">  125</span>    X = np.array([-10.0, -9.5, -9, -8.5, -8, -1, 1, 9, 9.5, 10]).reshape(-1, 1)</div>
<div class="line"><span class="lineno">  126</span>    X = array_constr(X)</div>
<div class="line"><span class="lineno">  127</span>    sample_weight = np.ones(10)</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>    <span class="comment"># centers all initialized to the first point of X</span></div>
<div class="line"><span class="lineno">  130</span>    centers_old = np.array([-10.0, -10, -10]).reshape(-1, 1)</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="comment"># With this initialization, all points will be assigned to the first center</span></div>
<div class="line"><span class="lineno">  133</span>    <span class="comment"># At this point a center in centers_new is the weighted sum of the points</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="comment"># it contains if it&#39;s not empty, otherwise it is the same as before.</span></div>
<div class="line"><span class="lineno">  135</span>    centers_new = np.array([-16.5, -10, -10]).reshape(-1, 1)</div>
<div class="line"><span class="lineno">  136</span>    weight_in_clusters = np.array([10.0, 0, 0])</div>
<div class="line"><span class="lineno">  137</span>    labels = np.zeros(10, dtype=np.int32)</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">if</span> array_constr <span class="keywordflow">is</span> np.array:</div>
<div class="line"><span class="lineno">  140</span>        _relocate_empty_clusters_dense(</div>
<div class="line"><span class="lineno">  141</span>            X, sample_weight, centers_old, centers_new, weight_in_clusters, labels</div>
<div class="line"><span class="lineno">  142</span>        )</div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  144</span>        _relocate_empty_clusters_sparse(</div>
<div class="line"><span class="lineno">  145</span>            X.data,</div>
<div class="line"><span class="lineno">  146</span>            X.indices,</div>
<div class="line"><span class="lineno">  147</span>            X.indptr,</div>
<div class="line"><span class="lineno">  148</span>            sample_weight,</div>
<div class="line"><span class="lineno">  149</span>            centers_old,</div>
<div class="line"><span class="lineno">  150</span>            centers_new,</div>
<div class="line"><span class="lineno">  151</span>            weight_in_clusters,</div>
<div class="line"><span class="lineno">  152</span>            labels,</div>
<div class="line"><span class="lineno">  153</span>        )</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="comment"># The relocation scheme will take the 2 points farthest from the center and</span></div>
<div class="line"><span class="lineno">  156</span>    <span class="comment"># assign them to the 2 empty clusters, i.e. points at 10 and at 9.9. The</span></div>
<div class="line"><span class="lineno">  157</span>    <span class="comment"># first center will be updated to contain the other 8 points.</span></div>
<div class="line"><span class="lineno">  158</span>    assert_array_equal(weight_in_clusters, [8, 1, 1])</div>
<div class="line"><span class="lineno">  159</span>    assert_allclose(centers_new, [[-36], [10], [9.5]])</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span><span class="preprocessor">@pytest.mark.parametrize(&quot;distribution&quot;, [&quot;normal&quot;, &quot;blobs&quot;])</span></div>
<div class="line"><span class="lineno">  163</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  164</span>    <span class="stringliteral">&quot;array_constr&quot;</span>, [np.array, sp.csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  165</span>)</div>
<div class="line"><span class="lineno">  166</span><span class="preprocessor">@pytest.mark.parametrize(&quot;tol&quot;, [1e-2, 1e-8, 1e-100, 0])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85e5e62f0a9647930746e1778359fdc3" name="a85e5e62f0a9647930746e1778359fdc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85e5e62f0a9647930746e1778359fdc3">&#9670;&#160;</a></span>test_result_equal_in_diff_n_threads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_result_equal_in_diff_n_threads </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  934</span><span class="keyword">def </span>test_result_equal_in_diff_n_threads(Estimator, global_random_seed):</div>
<div class="line"><span class="lineno">  935</span>    <span class="comment"># Check that KMeans/MiniBatchKMeans give the same results in parallel mode</span></div>
<div class="line"><span class="lineno">  936</span>    <span class="comment"># than in sequential mode.</span></div>
<div class="line"><span class="lineno">  937</span>    rnd = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">  938</span>    X = rnd.normal(size=(50, 10))</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>    <span class="keyword">with</span> threadpool_limits(limits=1, user_api=<span class="stringliteral">&quot;openmp&quot;</span>):</div>
<div class="line"><span class="lineno">  941</span>        result_1 = (</div>
<div class="line"><span class="lineno">  942</span>            Estimator(n_clusters=n_clusters, random_state=global_random_seed)</div>
<div class="line"><span class="lineno">  943</span>            .fit(X)</div>
<div class="line"><span class="lineno">  944</span>            .labels_</div>
<div class="line"><span class="lineno">  945</span>        )</div>
<div class="line"><span class="lineno">  946</span>    <span class="keyword">with</span> threadpool_limits(limits=2, user_api=<span class="stringliteral">&quot;openmp&quot;</span>):</div>
<div class="line"><span class="lineno">  947</span>        result_2 = (</div>
<div class="line"><span class="lineno">  948</span>            Estimator(n_clusters=n_clusters, random_state=global_random_seed)</div>
<div class="line"><span class="lineno">  949</span>            .fit(X)</div>
<div class="line"><span class="lineno">  950</span>            .labels_</div>
<div class="line"><span class="lineno">  951</span>        )</div>
<div class="line"><span class="lineno">  952</span>    assert_array_equal(result_1, result_2)</div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5257c6214d0f42939fdd67920ea3bf1a" name="a5257c6214d0f42939fdd67920ea3bf1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5257c6214d0f42939fdd67920ea3bf1a">&#9670;&#160;</a></span>test_sample_weight_unchanged()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_sample_weight_unchanged </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1095</span><span class="keyword">def </span>test_sample_weight_unchanged(Estimator):</div>
<div class="line"><span class="lineno"> 1096</span>    <span class="comment"># Check that sample_weight is not modified in place by KMeans (#17204)</span></div>
<div class="line"><span class="lineno"> 1097</span>    X = np.array([[1], [2], [4]])</div>
<div class="line"><span class="lineno"> 1098</span>    sample_weight = np.array([0.5, 0.2, 0.3])</div>
<div class="line"><span class="lineno"> 1099</span>    Estimator(n_clusters=2, random_state=0).fit(X, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>    assert_array_equal(sample_weight, np.array([0.5, 0.2, 0.3]))</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
<div class="line"><span class="lineno"> 1105</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1106</span>    <span class="stringliteral">&quot;param, match&quot;</span>,</div>
<div class="line"><span class="lineno"> 1107</span>    [</div>
<div class="line"><span class="lineno"> 1108</span>        ({<span class="stringliteral">&quot;n_clusters&quot;</span>: n_samples + 1}, <span class="stringliteral">r&quot;n_samples.* should be &gt;= n_clusters&quot;</span>),</div>
<div class="line"><span class="lineno"> 1109</span>        (</div>
<div class="line"><span class="lineno"> 1110</span>            {<span class="stringliteral">&quot;init&quot;</span>: X[:2]},</div>
<div class="line"><span class="lineno"> 1111</span>            <span class="stringliteral">r&quot;The shape of the initial centers .* does not match &quot;</span></div>
<div class="line"><span class="lineno"> 1112</span>            <span class="stringliteral">r&quot;the number of clusters&quot;</span>,</div>
<div class="line"><span class="lineno"> 1113</span>        ),</div>
<div class="line"><span class="lineno"> 1114</span>        (</div>
<div class="line"><span class="lineno"> 1115</span>            {<span class="stringliteral">&quot;init&quot;</span>: <span class="keyword">lambda</span> X_, k, random_state: X_[:2]},</div>
<div class="line"><span class="lineno"> 1116</span>            <span class="stringliteral">r&quot;The shape of the initial centers .* does not match &quot;</span></div>
<div class="line"><span class="lineno"> 1117</span>            <span class="stringliteral">r&quot;the number of clusters&quot;</span>,</div>
<div class="line"><span class="lineno"> 1118</span>        ),</div>
<div class="line"><span class="lineno"> 1119</span>        (</div>
<div class="line"><span class="lineno"> 1120</span>            {<span class="stringliteral">&quot;init&quot;</span>: X[:8, :2]},</div>
<div class="line"><span class="lineno"> 1121</span>            <span class="stringliteral">r&quot;The shape of the initial centers .* does not match &quot;</span></div>
<div class="line"><span class="lineno"> 1122</span>            <span class="stringliteral">r&quot;the number of features of the data&quot;</span>,</div>
<div class="line"><span class="lineno"> 1123</span>        ),</div>
<div class="line"><span class="lineno"> 1124</span>        (</div>
<div class="line"><span class="lineno"> 1125</span>            {<span class="stringliteral">&quot;init&quot;</span>: <span class="keyword">lambda</span> X_, k, random_state: X_[:8, :2]},</div>
<div class="line"><span class="lineno"> 1126</span>            <span class="stringliteral">r&quot;The shape of the initial centers .* does not match &quot;</span></div>
<div class="line"><span class="lineno"> 1127</span>            <span class="stringliteral">r&quot;the number of features of the data&quot;</span>,</div>
<div class="line"><span class="lineno"> 1128</span>        ),</div>
<div class="line"><span class="lineno"> 1129</span>    ],</div>
<div class="line"><span class="lineno"> 1130</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="adf1d37a05f9ed080a99744b0254b44a6" name="adf1d37a05f9ed080a99744b0254b44a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf1d37a05f9ed080a99744b0254b44a6">&#9670;&#160;</a></span>test_scaled_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_scaled_weights </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  896</span><span class="keyword">def </span>test_scaled_weights(Estimator, data, global_random_seed):</div>
<div class="line"><span class="lineno">  897</span>    <span class="comment"># Check that scaling all sample weights by a common factor</span></div>
<div class="line"><span class="lineno">  898</span>    <span class="comment"># shouldn&#39;t change the result</span></div>
<div class="line"><span class="lineno">  899</span>    sample_weight = np.random.RandomState(global_random_seed).uniform(size=n_samples)</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>    km = Estimator(n_clusters=n_clusters, random_state=global_random_seed, n_init=1)</div>
<div class="line"><span class="lineno">  902</span>    km_orig = clone(km).fit(data, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">  903</span>    km_scaled = clone(km).fit(data, sample_weight=0.5 * sample_weight)</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>    assert_array_equal(km_orig.labels_, km_scaled.labels_)</div>
<div class="line"><span class="lineno">  906</span>    assert_allclose(km_orig.cluster_centers_, km_scaled.cluster_centers_)</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9984fa359e9ca33fa1028c9fae6bdf0" name="ae9984fa359e9ca33fa1028c9fae6bdf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9984fa359e9ca33fa1028c9fae6bdf0">&#9670;&#160;</a></span>test_score_max_iter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_score_max_iter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  588</span><span class="keyword">def </span>test_score_max_iter(Estimator, global_random_seed):</div>
<div class="line"><span class="lineno">  589</span>    <span class="comment"># Check that fitting KMeans or MiniBatchKMeans with more iterations gives</span></div>
<div class="line"><span class="lineno">  590</span>    <span class="comment"># better score</span></div>
<div class="line"><span class="lineno">  591</span>    X = np.random.RandomState(global_random_seed).randn(100, 10)</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>    km1 = Estimator(n_init=1, random_state=global_random_seed, max_iter=1)</div>
<div class="line"><span class="lineno">  594</span>    s1 = km1.fit(X).score(X)</div>
<div class="line"><span class="lineno">  595</span>    km2 = Estimator(n_init=1, random_state=global_random_seed, max_iter=10)</div>
<div class="line"><span class="lineno">  596</span>    s2 = km2.fit(X).score(X)</div>
<div class="line"><span class="lineno">  597</span>    <span class="keyword">assert</span> s2 &gt; s1</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  601</span>    <span class="stringliteral">&quot;array_constr&quot;</span>, [np.array, sp.csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  602</span>)</div>
<div class="line"><span class="lineno">  603</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  604</span>    <span class="stringliteral">&quot;Estimator, algorithm&quot;</span>,</div>
<div class="line"><span class="lineno">  605</span>    [(KMeans, <span class="stringliteral">&quot;lloyd&quot;</span>), (KMeans, <span class="stringliteral">&quot;elkan&quot;</span>), (MiniBatchKMeans, <span class="keywordtype">None</span>)],</div>
<div class="line"><span class="lineno">  606</span>)</div>
<div class="line"><span class="lineno">  607</span><span class="preprocessor">@pytest.mark.parametrize(&quot;max_iter&quot;, [2, 100])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a747fc017b1759a6f24bdde6ac9482ea7" name="a747fc017b1759a6f24bdde6ac9482ea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a747fc017b1759a6f24bdde6ac9482ea7">&#9670;&#160;</a></span>test_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_transform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  714</span><span class="keyword">def </span>test_transform(Estimator, global_random_seed):</div>
<div class="line"><span class="lineno">  715</span>    <span class="comment"># Check the transform method</span></div>
<div class="line"><span class="lineno">  716</span>    km = Estimator(n_clusters=n_clusters, random_state=global_random_seed).fit(X)</div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>    <span class="comment"># Transorfming cluster_centers_ should return the pairwise distances</span></div>
<div class="line"><span class="lineno">  719</span>    <span class="comment"># between centers</span></div>
<div class="line"><span class="lineno">  720</span>    Xt = km.transform(km.cluster_centers_)</div>
<div class="line"><span class="lineno">  721</span>    assert_allclose(Xt, pairwise_distances(km.cluster_centers_))</div>
<div class="line"><span class="lineno">  722</span>    <span class="comment"># In particular, diagonal must be 0</span></div>
<div class="line"><span class="lineno">  723</span>    assert_array_equal(Xt.diagonal(), np.zeros(n_clusters))</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>    <span class="comment"># Transorfming X should return the pairwise distances between X and the</span></div>
<div class="line"><span class="lineno">  726</span>    <span class="comment"># centers</span></div>
<div class="line"><span class="lineno">  727</span>    Xt = km.transform(X)</div>
<div class="line"><span class="lineno">  728</span>    assert_allclose(Xt, pairwise_distances(X, km.cluster_centers_))</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af993bd5f350780f8a8d76a6dae56fa20" name="af993bd5f350780f8a8d76a6dae56fa20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af993bd5f350780f8a8d76a6dae56fa20">&#9670;&#160;</a></span>test_unit_weights_vs_no_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_unit_weights_vs_no_weights </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  881</span><span class="keyword">def </span>test_unit_weights_vs_no_weights(Estimator, data, global_random_seed):</div>
<div class="line"><span class="lineno">  882</span>    <span class="comment"># Check that not passing sample weights should be equivalent to passing</span></div>
<div class="line"><span class="lineno">  883</span>    <span class="comment"># sample weights all equal to one.</span></div>
<div class="line"><span class="lineno">  884</span>    sample_weight = np.ones(n_samples)</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>    km = Estimator(n_clusters=n_clusters, random_state=global_random_seed, n_init=1)</div>
<div class="line"><span class="lineno">  887</span>    km_none = clone(km).fit(data, sample_weight=<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  888</span>    km_ones = clone(km).fit(data, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>    assert_array_equal(km_none.labels_, km_ones.labels_)</div>
<div class="line"><span class="lineno">  891</span>    assert_allclose(km_none.cluster_centers_, km_ones.cluster_centers_)</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span> </div>
<div class="line"><span class="lineno">  894</span><span class="preprocessor">@pytest.mark.parametrize(&quot;data&quot;, [X, X_csr], ids=[&quot;dense&quot;, &quot;sparse&quot;])</span></div>
<div class="line"><span class="lineno">  895</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38b9018508a17aa316fe89487a9e4db9" name="a38b9018508a17aa316fe89487a9e4db9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38b9018508a17aa316fe89487a9e4db9">&#9670;&#160;</a></span>test_warning_elkan_1_cluster()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_warning_elkan_1_cluster </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  955</span><span class="keyword">def </span>test_warning_elkan_1_cluster():</div>
<div class="line"><span class="lineno">  956</span>    <span class="comment"># Check warning messages specific to KMeans</span></div>
<div class="line"><span class="lineno">  957</span>    <span class="keyword">with</span> pytest.warns(</div>
<div class="line"><span class="lineno">  958</span>        RuntimeWarning,</div>
<div class="line"><span class="lineno">  959</span>        match=<span class="stringliteral">&quot;algorithm=&#39;elkan&#39; doesn&#39;t make sense for a single cluster&quot;</span>,</div>
<div class="line"><span class="lineno">  960</span>    ):</div>
<div class="line"><span class="lineno">  961</span>        KMeans(n_clusters=1, algorithm=<span class="stringliteral">&quot;elkan&quot;</span>).fit(X)</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span> </div>
<div class="line"><span class="lineno">  964</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  965</span>    <span class="stringliteral">&quot;array_constr&quot;</span>, [np.array, sp.csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  966</span>)</div>
<div class="line"><span class="lineno">  967</span><span class="preprocessor">@pytest.mark.parametrize(&quot;algo&quot;, [&quot;lloyd&quot;, &quot;elkan&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aedc8c99d9c3431e7be093ed3fcf4e606" name="aedc8c99d9c3431e7be093ed3fcf4e606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedc8c99d9c3431e7be093ed3fcf4e606">&#9670;&#160;</a></span>test_warning_n_init_precomputed_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_warning_n_init_precomputed_centers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  404</span><span class="keyword">def </span>test_warning_n_init_precomputed_centers(Estimator):</div>
<div class="line"><span class="lineno">  405</span>    <span class="comment"># Check that a warning is raised when n_init &gt; 1 and an array is passed for</span></div>
<div class="line"><span class="lineno">  406</span>    <span class="comment"># the init parameter.</span></div>
<div class="line"><span class="lineno">  407</span>    <span class="keyword">with</span> pytest.warns(</div>
<div class="line"><span class="lineno">  408</span>        RuntimeWarning,</div>
<div class="line"><span class="lineno">  409</span>        match=<span class="stringliteral">&quot;Explicit initial center position passed: performing only one init&quot;</span>,</div>
<div class="line"><span class="lineno">  410</span>    ):</div>
<div class="line"><span class="lineno">  411</span>        Estimator(init=centers, n_clusters=n_clusters, n_init=10).fit(X)</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2ca5953c5c2ac5c351afec21484ba33" name="ae2ca5953c5c2ac5c351afec21484ba33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2ca5953c5c2ac5c351afec21484ba33">&#9670;&#160;</a></span>test_weighted_vs_repeated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_weighted_vs_repeated </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  853</span><span class="keyword">def </span>test_weighted_vs_repeated(global_random_seed):</div>
<div class="line"><span class="lineno">  854</span>    <span class="comment"># Check that a sample weight of N should yield the same result as an N-fold</span></div>
<div class="line"><span class="lineno">  855</span>    <span class="comment"># repetition of the sample. Valid only if init is precomputed, otherwise</span></div>
<div class="line"><span class="lineno">  856</span>    <span class="comment"># rng produces different results. Not valid for MinibatchKMeans due to rng</span></div>
<div class="line"><span class="lineno">  857</span>    <span class="comment"># to extract minibatches.</span></div>
<div class="line"><span class="lineno">  858</span>    sample_weight = np.random.RandomState(global_random_seed).randint(</div>
<div class="line"><span class="lineno">  859</span>        1, 5, size=n_samples</div>
<div class="line"><span class="lineno">  860</span>    )</div>
<div class="line"><span class="lineno">  861</span>    X_repeat = np.repeat(X, sample_weight, axis=0)</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>    km = KMeans(</div>
<div class="line"><span class="lineno">  864</span>        init=centers, n_init=1, n_clusters=n_clusters, random_state=global_random_seed</div>
<div class="line"><span class="lineno">  865</span>    )</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>    km_weighted = clone(km).fit(X, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">  868</span>    repeated_labels = np.repeat(km_weighted.labels_, sample_weight)</div>
<div class="line"><span class="lineno">  869</span>    km_repeated = clone(km).fit(X_repeat)</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>    assert_array_equal(km_repeated.labels_, repeated_labels)</div>
<div class="line"><span class="lineno">  872</span>    assert_allclose(km_weighted.inertia_, km_repeated.inertia_)</div>
<div class="line"><span class="lineno">  873</span>    assert_allclose(</div>
<div class="line"><span class="lineno">  874</span>        _sort_centers(km_weighted.cluster_centers_),</div>
<div class="line"><span class="lineno">  875</span>        _sort_centers(km_repeated.cluster_centers_),</div>
<div class="line"><span class="lineno">  876</span>    )</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span><span class="preprocessor">@pytest.mark.parametrize(&quot;data&quot;, [X, X_csr], ids=[&quot;dense&quot;, &quot;sparse&quot;])</span></div>
<div class="line"><span class="lineno">  880</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Estimator&quot;, [KMeans, MiniBatchKMeans])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa69e78e5c884c1b6785e13e6f8d5f733" name="aa69e78e5c884c1b6785e13e6f8d5f733"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa69e78e5c884c1b6785e13e6f8d5f733">&#9670;&#160;</a></span>test_wrong_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.test_wrong_params </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>match</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1131</span><span class="keyword">def </span>test_wrong_params(Estimator, param, match):</div>
<div class="line"><span class="lineno"> 1132</span>    <span class="comment"># Check that error are raised with clear error message when wrong values</span></div>
<div class="line"><span class="lineno"> 1133</span>    <span class="comment"># are passed for the parameters</span></div>
<div class="line"><span class="lineno"> 1134</span>    <span class="comment"># Set n_init=1 by default to avoid warning with precomputed init</span></div>
<div class="line"><span class="lineno"> 1135</span>    km = Estimator(n_init=1)</div>
<div class="line"><span class="lineno"> 1136</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=match):</div>
<div class="line"><span class="lineno"> 1137</span>        km.set_params(**param).fit(X)</div>
<div class="line"><span class="lineno"> 1138</span> </div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1141</span>    <span class="stringliteral">&quot;param, match&quot;</span>,</div>
<div class="line"><span class="lineno"> 1142</span>    [</div>
<div class="line"><span class="lineno"> 1143</span>        (</div>
<div class="line"><span class="lineno"> 1144</span>            {<span class="stringliteral">&quot;x_squared_norms&quot;</span>: X[:2]},</div>
<div class="line"><span class="lineno"> 1145</span>            <span class="stringliteral">r&quot;The length of x_squared_norms .* should &quot;</span></div>
<div class="line"><span class="lineno"> 1146</span>            <span class="stringliteral">r&quot;be equal to the length of n_samples&quot;</span>,</div>
<div class="line"><span class="lineno"> 1147</span>        ),</div>
<div class="line"><span class="lineno"> 1148</span>    ],</div>
<div class="line"><span class="lineno"> 1149</span>)</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a318463e35d5921c87e6560caa1740d94" name="a318463e35d5921c87e6560caa1740d94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a318463e35d5921c87e6560caa1740d94">&#9670;&#160;</a></span>centers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.centers</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  np.array(</div>
<div class="line"><span class="lineno">    2</span>    [</div>
<div class="line"><span class="lineno">    3</span>        [0.0, 5.0, 0.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">    4</span>        [1.0, 1.0, 4.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">    5</span>        [1.0, 0.0, 0.0, 5.0, 1.0],</div>
<div class="line"><span class="lineno">    6</span>    ]</div>
<div class="line"><span class="lineno">    7</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a581fa769ccd975ba5188f3f57f5234" name="a2a581fa769ccd975ba5188f3f57f5234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a581fa769ccd975ba5188f3f57f5234">&#9670;&#160;</a></span>cluster_std</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.cluster_std</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a442ff0c3f08d79c1648582cfea794716" name="a442ff0c3f08d79c1648582cfea794716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a442ff0c3f08d79c1648582cfea794716">&#9670;&#160;</a></span>msg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple sklearn.cluster.tests.test_k_means.msg</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">r&quot;The default value of `n_init` will change from \d* to &#39;auto&#39; in 1.4. Set the&quot;</span></div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">r&quot; value of `n_init` explicitly to suppress the warning:FutureWarning&quot;</span></div>
<div class="line"><span class="lineno">    4</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7d4c66c93b70ea0b703009d377f652b" name="ac7d4c66c93b70ea0b703009d377f652b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7d4c66c93b70ea0b703009d377f652b">&#9670;&#160;</a></span>n_clusters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.n_clusters</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad2251722219587876aed804cab5b0097" name="ad2251722219587876aed804cab5b0097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2251722219587876aed804cab5b0097">&#9670;&#160;</a></span>n_features</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.n_features</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a66a1cf824285f08ca382adc2d1e0ac5b" name="a66a1cf824285f08ca382adc2d1e0ac5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66a1cf824285f08ca382adc2d1e0ac5b">&#9670;&#160;</a></span>n_samples</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.n_samples = 100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a21947288fd4ad5ed038e8f0ad6a68cc4" name="a21947288fd4ad5ed038e8f0ad6a68cc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21947288fd4ad5ed038e8f0ad6a68cc4">&#9670;&#160;</a></span>pytestmark</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.pytestmark = pytest.mark.filterwarnings(&quot;ignore:&quot; + <a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a442ff0c3f08d79c1648582cfea794716">msg</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a15f1f840c98eb54b1ecfaf35a224d4da" name="a15f1f840c98eb54b1ecfaf35a224d4da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15f1f840c98eb54b1ecfaf35a224d4da">&#9670;&#160;</a></span>random_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.random_state</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2ee9a68457d8be74955a9d2840737229" name="a2ee9a68457d8be74955a9d2840737229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ee9a68457d8be74955a9d2840737229">&#9670;&#160;</a></span>true_labels</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.true_labels</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a41596f08e7b65afd0b216535aaebc40a" name="a41596f08e7b65afd0b216535aaebc40a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41596f08e7b65afd0b216535aaebc40a">&#9670;&#160;</a></span>X</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.X</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9df262e3c5c5f6e55c12bcfc6d4a199f" name="a9df262e3c5c5f6e55c12bcfc6d4a199f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9df262e3c5c5f6e55c12bcfc6d4a199f">&#9670;&#160;</a></span>X_csr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_k_means.X_csr = sp.csr_matrix(<a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__k__means.html#a41596f08e7b65afd0b216535aaebc40a">X</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
