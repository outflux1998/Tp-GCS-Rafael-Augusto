<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.decomposition._dict_learning Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1decomposition.html">decomposition</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1decomposition_1_1__dict__learning.html">_dict_learning</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.decomposition._dict_learning Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1decomposition_1_1__dict__learning_1_1___base_sparse_coding.html">_BaseSparseCoding</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1decomposition_1_1__dict__learning_1_1_dictionary_learning.html">DictionaryLearning</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1decomposition_1_1__dict__learning_1_1_mini_batch_dictionary_learning.html">MiniBatchDictionaryLearning</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1decomposition_1_1__dict__learning_1_1_sparse_coder.html">SparseCoder</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4fbda6e353295e4595a13e5b76dca5ad" id="r_a4fbda6e353295e4595a13e5b76dca5ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1__dict__learning.html#a4fbda6e353295e4595a13e5b76dca5ad">_check_positive_coding</a> (method, positive)</td></tr>
<tr class="separator:a4fbda6e353295e4595a13e5b76dca5ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54ed6e48e9cda4418682c4a1e40873fe" id="r_a54ed6e48e9cda4418682c4a1e40873fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1__dict__learning.html#a54ed6e48e9cda4418682c4a1e40873fe">_sparse_encode</a> (X, dictionary, gram, cov=None, algorithm=&quot;lasso_lars&quot;, regularization=None, copy_cov=True, init=None, max_iter=1000, check_input=True, verbose=0, positive=False)</td></tr>
<tr class="separator:a54ed6e48e9cda4418682c4a1e40873fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7ac8ff5d643119fcb991a4fc5bb094f" id="r_af7ac8ff5d643119fcb991a4fc5bb094f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1__dict__learning.html#af7ac8ff5d643119fcb991a4fc5bb094f">sparse_encode</a> (X, dictionary, *gram=None, cov=None, algorithm=&quot;lasso_lars&quot;, n_nonzero_coefs=None, <a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>=None, copy_cov=True, init=None, max_iter=1000, n_jobs=None, check_input=True, verbose=0, positive=False)</td></tr>
<tr class="separator:af7ac8ff5d643119fcb991a4fc5bb094f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530997e2d539e5bc2aa7ce8e4846d1cd" id="r_a530997e2d539e5bc2aa7ce8e4846d1cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1__dict__learning.html#a530997e2d539e5bc2aa7ce8e4846d1cd">_update_dict</a> (dictionary, Y, code, A=None, B=None, verbose=False, random_state=None, positive=False)</td></tr>
<tr class="separator:a530997e2d539e5bc2aa7ce8e4846d1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e6b6b8f9579eee2889e03bd139ecb49" id="r_a3e6b6b8f9579eee2889e03bd139ecb49"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1__dict__learning.html#a3e6b6b8f9579eee2889e03bd139ecb49">dict_learning</a> (X, n_components, *<a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>, max_iter=100, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-8, method=&quot;lars&quot;, n_jobs=None, dict_init=None, code_init=None, callback=None, verbose=False, random_state=None, return_n_iter=False, positive_dict=False, positive_code=False, method_max_iter=1000)</td></tr>
<tr class="separator:a3e6b6b8f9579eee2889e03bd139ecb49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7be8a48c194acc81a27af96a935a80c" id="r_aa7be8a48c194acc81a27af96a935a80c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1__dict__learning.html#aa7be8a48c194acc81a27af96a935a80c">_check_warn_deprecated</a> (param, name, default, additional_message=None)</td></tr>
<tr class="separator:aa7be8a48c194acc81a27af96a935a80c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a457f05767c59f73be62dee22c615e3d8" id="r_a457f05767c59f73be62dee22c615e3d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1__dict__learning.html#a457f05767c59f73be62dee22c615e3d8">dict_learning_online</a> (X, n_components=2, *<a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>=1, n_iter=&quot;deprecated&quot;, max_iter=None, return_code=True, dict_init=None, callback=None, batch_size=&quot;warn&quot;, verbose=False, shuffle=True, n_jobs=None, method=&quot;lars&quot;, iter_offset=&quot;deprecated&quot;, random_state=None, return_inner_stats=&quot;deprecated&quot;, inner_stats=&quot;deprecated&quot;, return_n_iter=&quot;deprecated&quot;, positive_dict=False, positive_code=False, method_max_iter=1000, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-3, max_no_improvement=10)</td></tr>
<tr class="separator:a457f05767c59f73be62dee22c615e3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment"> Dictionary learning.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a4fbda6e353295e4595a13e5b76dca5ad" name="a4fbda6e353295e4595a13e5b76dca5ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fbda6e353295e4595a13e5b76dca5ad">&#9670;&#160;</a></span>_check_positive_coding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition._dict_learning._check_positive_coding </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   28</span><span class="keyword">def </span>_check_positive_coding(method, positive):</div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">if</span> positive <span class="keywordflow">and</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&quot;omp&quot;</span>, <span class="stringliteral">&quot;lars&quot;</span>]:</div>
<div class="line"><span class="lineno">   30</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">   31</span>            <span class="stringliteral">&quot;Positive constraint not supported for &#39;{}&#39; coding method.&quot;</span>.format(method)</div>
<div class="line"><span class="lineno">   32</span>        )</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7be8a48c194acc81a27af96a935a80c" name="aa7be8a48c194acc81a27af96a935a80c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7be8a48c194acc81a27af96a935a80c">&#9670;&#160;</a></span>_check_warn_deprecated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition._dict_learning._check_warn_deprecated </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>default</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>additional_message</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  725</span><span class="keyword">def </span>_check_warn_deprecated(param, name, default, additional_message=None):</div>
<div class="line"><span class="lineno">  726</span>    <span class="keywordflow">if</span> param != <span class="stringliteral">&quot;deprecated&quot;</span>:</div>
<div class="line"><span class="lineno">  727</span>        msg = (</div>
<div class="line"><span class="lineno">  728</span>            f<span class="stringliteral">&quot;&#39;{name}&#39; is deprecated in version 1.1 and will be removed in version 1.3.&quot;</span></div>
<div class="line"><span class="lineno">  729</span>        )</div>
<div class="line"><span class="lineno">  730</span>        <span class="keywordflow">if</span> additional_message:</div>
<div class="line"><span class="lineno">  731</span>            msg += f<span class="stringliteral">&quot; {additional_message}&quot;</span></div>
<div class="line"><span class="lineno">  732</span>        warnings.warn(msg, FutureWarning)</div>
<div class="line"><span class="lineno">  733</span>        <span class="keywordflow">return</span> param</div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  735</span>        <span class="keywordflow">return</span> default</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a54ed6e48e9cda4418682c4a1e40873fe" name="a54ed6e48e9cda4418682c4a1e40873fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54ed6e48e9cda4418682c4a1e40873fe">&#9670;&#160;</a></span>_sparse_encode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition._dict_learning._sparse_encode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dictionary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cov</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algorithm</em> = <code>&quot;lasso_lars&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>regularization</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>copy_cov</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_input</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Generic sparse coding.

Each column of the result is the solution to a Lasso problem.

Parameters
----------
X : ndarray of shape (n_samples, n_features)
    Data matrix.

dictionary : ndarray of shape (n_components, n_features)
    The dictionary matrix against which to solve the sparse coding of
    the data. Some of the algorithms assume normalized rows.

gram : ndarray of shape (n_components, n_components) or None
    Precomputed Gram matrix, `dictionary * dictionary'`
    gram can be `None` if method is 'threshold'.

cov : ndarray of shape (n_components, n_samples), default=None
    Precomputed covariance, `dictionary * X'`.

algorithm : {'lasso_lars', 'lasso_cd', 'lars', 'omp', 'threshold'}, \
        default='lasso_lars'
    The algorithm used:

    * `'lars'`: uses the least angle regression method
      (`linear_model.lars_path`);
    * `'lasso_lars'`: uses Lars to compute the Lasso solution;
    * `'lasso_cd'`: uses the coordinate descent method to compute the
      Lasso solution (`linear_model.Lasso`). lasso_lars will be faster if
      the estimated components are sparse;
    * `'omp'`: uses orthogonal matching pursuit to estimate the sparse
      solution;
    * `'threshold'`: squashes to zero all coefficients less than
      regularization from the projection `dictionary * data'`.

regularization : int or float, default=None
    The regularization parameter. It corresponds to alpha when
    algorithm is `'lasso_lars'`, `'lasso_cd'` or `'threshold'`.
    Otherwise it corresponds to `n_nonzero_coefs`.

init : ndarray of shape (n_samples, n_components), default=None
    Initialization value of the sparse code. Only used if
    `algorithm='lasso_cd'`.

max_iter : int, default=1000
    Maximum number of iterations to perform if `algorithm='lasso_cd'` or
    `'lasso_lars'`.

copy_cov : bool, default=True
    Whether to copy the precomputed covariance matrix; if `False`, it may
    be overwritten.

check_input : bool, default=True
    If `False`, the input arrays `X` and dictionary will not be checked.

verbose : int, default=0
    Controls the verbosity; the higher, the more messages.

positive: bool, default=False
    Whether to enforce a positivity constraint on the sparse code.

    .. versionadded:: 0.20

Returns
-------
code : ndarray of shape (n_components, n_features)
    The sparse codes.

See Also
--------
sklearn.linear_model.lars_path
sklearn.linear_model.orthogonal_mp
sklearn.linear_model.Lasso
SparseCoder
</pre> <div class="fragment"><div class="line"><span class="lineno">   48</span>):</div>
<div class="line"><span class="lineno">   49</span>    <span class="stringliteral">&quot;&quot;&quot;Generic sparse coding.</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">    Each column of the result is the solution to a Lasso problem.</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    X : ndarray of shape (n_samples, n_features)</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">        Data matrix.</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    dictionary : ndarray of shape (n_components, n_features)</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">        The dictionary matrix against which to solve the sparse coding of</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">        the data. Some of the algorithms assume normalized rows.</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">    gram : ndarray of shape (n_components, n_components) or None</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">        Precomputed Gram matrix, `dictionary * dictionary&#39;`</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">        gram can be `None` if method is &#39;threshold&#39;.</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    cov : ndarray of shape (n_components, n_samples), default=None</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">        Precomputed covariance, `dictionary * X&#39;`.</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    algorithm : {&#39;lasso_lars&#39;, &#39;lasso_cd&#39;, &#39;lars&#39;, &#39;omp&#39;, &#39;threshold&#39;}, \</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">            default=&#39;lasso_lars&#39;</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">        The algorithm used:</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        * `&#39;lars&#39;`: uses the least angle regression method</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">          (`linear_model.lars_path`);</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        * `&#39;lasso_lars&#39;`: uses Lars to compute the Lasso solution;</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        * `&#39;lasso_cd&#39;`: uses the coordinate descent method to compute the</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">          Lasso solution (`linear_model.Lasso`). lasso_lars will be faster if</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">          the estimated components are sparse;</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">        * `&#39;omp&#39;`: uses orthogonal matching pursuit to estimate the sparse</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">          solution;</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">        * `&#39;threshold&#39;`: squashes to zero all coefficients less than</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">          regularization from the projection `dictionary * data&#39;`.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    regularization : int or float, default=None</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        The regularization parameter. It corresponds to alpha when</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        algorithm is `&#39;lasso_lars&#39;`, `&#39;lasso_cd&#39;` or `&#39;threshold&#39;`.</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        Otherwise it corresponds to `n_nonzero_coefs`.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    init : ndarray of shape (n_samples, n_components), default=None</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">        Initialization value of the sparse code. Only used if</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">        `algorithm=&#39;lasso_cd&#39;`.</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    max_iter : int, default=1000</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">        Maximum number of iterations to perform if `algorithm=&#39;lasso_cd&#39;` or</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">        `&#39;lasso_lars&#39;`.</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    copy_cov : bool, default=True</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">        Whether to copy the precomputed covariance matrix; if `False`, it may</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">        be overwritten.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    check_input : bool, default=True</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">        If `False`, the input arrays `X` and dictionary will not be checked.</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    verbose : int, default=0</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">        Controls the verbosity; the higher, the more messages.</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    positive: bool, default=False</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">        Whether to enforce a positivity constraint on the sparse code.</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">        .. versionadded:: 0.20</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">    code : ndarray of shape (n_components, n_features)</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">        The sparse codes.</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    sklearn.linear_model.lars_path</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    sklearn.linear_model.orthogonal_mp</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    sklearn.linear_model.Lasso</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    SparseCoder</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span> X.ndim == 1:</div>
<div class="line"><span class="lineno">  125</span>        X = X[:, np.newaxis]</div>
<div class="line"><span class="lineno">  126</span>    n_samples, n_features = X.shape</div>
<div class="line"><span class="lineno">  127</span>    n_components = dictionary.shape[0]</div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">if</span> dictionary.shape[1] != X.shape[1]:</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  130</span>            <span class="stringliteral">&quot;Dictionary and X have different numbers of features:&quot;</span></div>
<div class="line"><span class="lineno">  131</span>            <span class="stringliteral">&quot;dictionary.shape: {} X.shape{}&quot;</span>.format(dictionary.shape, X.shape)</div>
<div class="line"><span class="lineno">  132</span>        )</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">if</span> cov <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> algorithm != <span class="stringliteral">&quot;lasso_cd&quot;</span>:</div>
<div class="line"><span class="lineno">  134</span>        <span class="comment"># overwriting cov is safe</span></div>
<div class="line"><span class="lineno">  135</span>        copy_cov = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  136</span>        cov = np.dot(dictionary, X.T)</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    _check_positive_coding(algorithm, positive)</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">if</span> algorithm == <span class="stringliteral">&quot;lasso_lars&quot;</span>:</div>
<div class="line"><span class="lineno">  141</span>        alpha = float(regularization) / n_features  <span class="comment"># account for scaling</span></div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  143</span>            err_mgt = np.seterr(all=<span class="stringliteral">&quot;ignore&quot;</span>)</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>            <span class="comment"># Not passing in verbose=max(0, verbose-1) because Lars.fit already</span></div>
<div class="line"><span class="lineno">  146</span>            <span class="comment"># corrects the verbosity level.</span></div>
<div class="line"><span class="lineno">  147</span>            lasso_lars = LassoLars(</div>
<div class="line"><span class="lineno">  148</span>                alpha=alpha,</div>
<div class="line"><span class="lineno">  149</span>                fit_intercept=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  150</span>                verbose=verbose,</div>
<div class="line"><span class="lineno">  151</span>                precompute=gram,</div>
<div class="line"><span class="lineno">  152</span>                fit_path=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  153</span>                positive=positive,</div>
<div class="line"><span class="lineno">  154</span>                max_iter=max_iter,</div>
<div class="line"><span class="lineno">  155</span>            )</div>
<div class="line"><span class="lineno">  156</span>            lasso_lars.fit(dictionary.T, X.T, Xy=cov)</div>
<div class="line"><span class="lineno">  157</span>            new_code = lasso_lars.coef_</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  159</span>            np.seterr(**err_mgt)</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">elif</span> algorithm == <span class="stringliteral">&quot;lasso_cd&quot;</span>:</div>
<div class="line"><span class="lineno">  162</span>        alpha = float(regularization) / n_features  <span class="comment"># account for scaling</span></div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>        <span class="comment"># TODO: Make verbosity argument for Lasso?</span></div>
<div class="line"><span class="lineno">  165</span>        <span class="comment"># sklearn.linear_model.coordinate_descent.enet_path has a verbosity</span></div>
<div class="line"><span class="lineno">  166</span>        <span class="comment"># argument that we could pass in from Lasso.</span></div>
<div class="line"><span class="lineno">  167</span>        clf = Lasso(</div>
<div class="line"><span class="lineno">  168</span>            alpha=alpha,</div>
<div class="line"><span class="lineno">  169</span>            fit_intercept=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  170</span>            precompute=gram,</div>
<div class="line"><span class="lineno">  171</span>            max_iter=max_iter,</div>
<div class="line"><span class="lineno">  172</span>            warm_start=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  173</span>            positive=positive,</div>
<div class="line"><span class="lineno">  174</span>        )</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">if</span> init <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  177</span>            clf.coef_ = init</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>        clf.fit(dictionary.T, X.T, check_input=check_input)</div>
<div class="line"><span class="lineno">  180</span>        new_code = clf.coef_</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">elif</span> algorithm == <span class="stringliteral">&quot;lars&quot;</span>:</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  184</span>            err_mgt = np.seterr(all=<span class="stringliteral">&quot;ignore&quot;</span>)</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>            <span class="comment"># Not passing in verbose=max(0, verbose-1) because Lars.fit already</span></div>
<div class="line"><span class="lineno">  187</span>            <span class="comment"># corrects the verbosity level.</span></div>
<div class="line"><span class="lineno">  188</span>            lars = Lars(</div>
<div class="line"><span class="lineno">  189</span>                fit_intercept=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  190</span>                verbose=verbose,</div>
<div class="line"><span class="lineno">  191</span>                precompute=gram,</div>
<div class="line"><span class="lineno">  192</span>                n_nonzero_coefs=int(regularization),</div>
<div class="line"><span class="lineno">  193</span>                fit_path=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  194</span>            )</div>
<div class="line"><span class="lineno">  195</span>            lars.fit(dictionary.T, X.T, Xy=cov)</div>
<div class="line"><span class="lineno">  196</span>            new_code = lars.coef_</div>
<div class="line"><span class="lineno">  197</span>        <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  198</span>            np.seterr(**err_mgt)</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">elif</span> algorithm == <span class="stringliteral">&quot;threshold&quot;</span>:</div>
<div class="line"><span class="lineno">  201</span>        new_code = (np.sign(cov) * np.maximum(np.abs(cov) - regularization, 0)).T</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">if</span> positive:</div>
<div class="line"><span class="lineno">  203</span>            np.clip(new_code, 0, <span class="keywordtype">None</span>, out=new_code)</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">elif</span> algorithm == <span class="stringliteral">&quot;omp&quot;</span>:</div>
<div class="line"><span class="lineno">  206</span>        new_code = orthogonal_mp_gram(</div>
<div class="line"><span class="lineno">  207</span>            Gram=gram,</div>
<div class="line"><span class="lineno">  208</span>            Xy=cov,</div>
<div class="line"><span class="lineno">  209</span>            n_nonzero_coefs=int(regularization),</div>
<div class="line"><span class="lineno">  210</span>            tol=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  211</span>            norms_squared=row_norms(X, squared=<span class="keyword">True</span>),</div>
<div class="line"><span class="lineno">  212</span>            copy_Xy=copy_cov,</div>
<div class="line"><span class="lineno">  213</span>        ).T</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  216</span>            <span class="stringliteral">&#39;Sparse coding method must be &quot;lasso_lars&quot; &#39;</span></div>
<div class="line"><span class="lineno">  217</span>            <span class="stringliteral">&#39;&quot;lasso_cd&quot;, &quot;lasso&quot;, &quot;threshold&quot; or &quot;omp&quot;, got %s.&#39;</span> % algorithm</div>
<div class="line"><span class="lineno">  218</span>        )</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">if</span> new_code.ndim != 2:</div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">return</span> new_code.reshape(n_samples, n_components)</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordflow">return</span> new_code</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span><span class="comment"># XXX : could be moved to the linear_model module</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a530997e2d539e5bc2aa7ce8e4846d1cd" name="a530997e2d539e5bc2aa7ce8e4846d1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530997e2d539e5bc2aa7ce8e4846d1cd">&#9670;&#160;</a></span>_update_dict()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition._dict_learning._update_dict </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dictionary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>B</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Update the dense dictionary factor in place.

Parameters
----------
dictionary : ndarray of shape (n_components, n_features)
    Value of the dictionary at the previous iteration.

Y : ndarray of shape (n_samples, n_features)
    Data matrix.

code : ndarray of shape (n_samples, n_components)
    Sparse coding of the data against which to optimize the dictionary.

A : ndarray of shape (n_components, n_components), default=None
    Together with `B`, sufficient stats of the online model to update the
    dictionary.

B : ndarray of shape (n_features, n_components), default=None
    Together with `A`, sufficient stats of the online model to update the
    dictionary.

verbose: bool, default=False
    Degree of output the procedure will print.

random_state : int, RandomState instance or None, default=None
    Used for randomly initializing the dictionary. Pass an int for
    reproducible results across multiple function calls.
    See :term:`Glossary &lt;random_state&gt;`.

positive : bool, default=False
    Whether to enforce positivity when finding the dictionary.

    .. versionadded:: 0.20
</pre> <div class="fragment"><div class="line"><span class="lineno">  422</span>):</div>
<div class="line"><span class="lineno">  423</span>    <span class="stringliteral">&quot;&quot;&quot;Update the dense dictionary factor in place.</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">    dictionary : ndarray of shape (n_components, n_features)</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">        Value of the dictionary at the previous iteration.</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">    Y : ndarray of shape (n_samples, n_features)</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">        Data matrix.</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    code : ndarray of shape (n_samples, n_components)</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">        Sparse coding of the data against which to optimize the dictionary.</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">    A : ndarray of shape (n_components, n_components), default=None</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">        Together with `B`, sufficient stats of the online model to update the</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">        dictionary.</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">    B : ndarray of shape (n_features, n_components), default=None</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">        Together with `A`, sufficient stats of the online model to update the</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">        dictionary.</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">    verbose: bool, default=False</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">        Degree of output the procedure will print.</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">    random_state : int, RandomState instance or None, default=None</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral">        Used for randomly initializing the dictionary. Pass an int for</span></div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral">        reproducible results across multiple function calls.</span></div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">        See :term:`Glossary &lt;random_state&gt;`.</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">    positive : bool, default=False</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral">        Whether to enforce positivity when finding the dictionary.</span></div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">        .. versionadded:: 0.20</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  457</span>    n_samples, n_components = code.shape</div>
<div class="line"><span class="lineno">  458</span>    random_state = check_random_state(random_state)</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">if</span> A <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  461</span>        A = code.T @ code</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordflow">if</span> B <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  463</span>        B = Y.T @ code</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>    n_unused = 0</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(n_components):</div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordflow">if</span> A[k, k] &gt; 1e-6:</div>
<div class="line"><span class="lineno">  469</span>            <span class="comment"># 1e-6 is arbitrary but consistent with the spams implementation</span></div>
<div class="line"><span class="lineno">  470</span>            dictionary[k] += (B[:, k] - A[k] @ dictionary) / A[k, k]</div>
<div class="line"><span class="lineno">  471</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  472</span>            <span class="comment"># kth atom is almost never used -&gt; sample a new one from the data</span></div>
<div class="line"><span class="lineno">  473</span>            newd = Y[random_state.choice(n_samples)]</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>            <span class="comment"># add small noise to avoid making the sparse coding ill conditioned</span></div>
<div class="line"><span class="lineno">  476</span>            noise_level = 0.01 * (newd.std() <span class="keywordflow">or</span> 1)  <span class="comment"># avoid 0 std</span></div>
<div class="line"><span class="lineno">  477</span>            noise = random_state.normal(0, noise_level, size=len(newd))</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>            dictionary[k] = newd + noise</div>
<div class="line"><span class="lineno">  480</span>            code[:, k] = 0</div>
<div class="line"><span class="lineno">  481</span>            n_unused += 1</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>        <span class="keywordflow">if</span> positive:</div>
<div class="line"><span class="lineno">  484</span>            np.clip(dictionary[k], 0, <span class="keywordtype">None</span>, out=dictionary[k])</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>        <span class="comment"># Projection on the constraint set ||V_k|| &lt;= 1</span></div>
<div class="line"><span class="lineno">  487</span>        dictionary[k] /= max(linalg.norm(dictionary[k]), 1)</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">if</span> verbose <span class="keywordflow">and</span> n_unused &gt; 0:</div>
<div class="line"><span class="lineno">  490</span>        print(f<span class="stringliteral">&quot;{n_unused} unused atoms resampled.&quot;</span>)</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e6b6b8f9579eee2889e03bd139ecb49" name="a3e6b6b8f9579eee2889e03bd139ecb49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e6b6b8f9579eee2889e03bd139ecb49">&#9670;&#160;</a></span>dict_learning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition._dict_learning.dict_learning </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_components</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>&quot;lars&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_jobs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dict_init</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code_init</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_n_iter</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive_dict</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive_code</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method_max_iter</em> = <code>1000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solve a dictionary learning matrix factorization problem.

Finds the best dictionary and the corresponding sparse code for
approximating the data matrix X by solving::

    (U^*, V^*) = argmin 0.5 || X - U V ||_Fro^2 + alpha * || U ||_1,1
                 (U,V)
                with || V_k ||_2 = 1 for all  0 &lt;= k &lt; n_components

where V is the dictionary and U is the sparse code. ||.||_Fro stands for
the Frobenius norm and ||.||_1,1 stands for the entry-wise matrix norm
which is the sum of the absolute values of all the entries in the matrix.

Read more in the :ref:`User Guide &lt;DictionaryLearning&gt;`.

Parameters
----------
X : ndarray of shape (n_samples, n_features)
    Data matrix.

n_components : int
    Number of dictionary atoms to extract.

alpha : int
    Sparsity controlling parameter.

max_iter : int, default=100
    Maximum number of iterations to perform.

tol : float, default=1e-8
    Tolerance for the stopping condition.

method : {'lars', 'cd'}, default='lars'
    The method used:

    * `'lars'`: uses the least angle regression method to solve the lasso
       problem (`linear_model.lars_path`);
    * `'cd'`: uses the coordinate descent method to compute the
      Lasso solution (`linear_model.Lasso`). Lars will be faster if
      the estimated components are sparse.

n_jobs : int, default=None
    Number of parallel jobs to run.
    ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.
    ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`
    for more details.

dict_init : ndarray of shape (n_components, n_features), default=None
    Initial value for the dictionary for warm restart scenarios. Only used
    if `code_init` and `dict_init` are not None.

code_init : ndarray of shape (n_samples, n_components), default=None
    Initial value for the sparse code for warm restart scenarios. Only used
    if `code_init` and `dict_init` are not None.

callback : callable, default=None
    Callable that gets invoked every five iterations.

verbose : bool, default=False
    To control the verbosity of the procedure.

random_state : int, RandomState instance or None, default=None
    Used for randomly initializing the dictionary. Pass an int for
    reproducible results across multiple function calls.
    See :term:`Glossary &lt;random_state&gt;`.

return_n_iter : bool, default=False
    Whether or not to return the number of iterations.

positive_dict : bool, default=False
    Whether to enforce positivity when finding the dictionary.

    .. versionadded:: 0.20

positive_code : bool, default=False
    Whether to enforce positivity when finding the code.

    .. versionadded:: 0.20

method_max_iter : int, default=1000
    Maximum number of iterations to perform.

    .. versionadded:: 0.22

Returns
-------
code : ndarray of shape (n_samples, n_components)
    The sparse code factor in the matrix factorization.

dictionary : ndarray of shape (n_components, n_features),
    The dictionary factor in the matrix factorization.

errors : array
    Vector of errors at each iteration.

n_iter : int
    Number of iterations run. Returned only if `return_n_iter` is
    set to True.

See Also
--------
dict_learning_online : Solve a dictionary learning matrix factorization
    problem online.
DictionaryLearning : Find a dictionary that sparsely encodes data.
MiniBatchDictionaryLearning : A faster, less accurate version
    of the dictionary learning algorithm.
SparsePCA : Sparse Principal Components Analysis.
MiniBatchSparsePCA : Mini-batch Sparse Principal Components Analysis.
</pre> <div class="fragment"><div class="line"><span class="lineno">  511</span>):</div>
<div class="line"><span class="lineno">  512</span>    <span class="stringliteral">&quot;&quot;&quot;Solve a dictionary learning matrix factorization problem.</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">    Finds the best dictionary and the corresponding sparse code for</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">    approximating the data matrix X by solving::</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">        (U^*, V^*) = argmin 0.5 || X - U V ||_Fro^2 + alpha * || U ||_1,1</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">                     (U,V)</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">                    with || V_k ||_2 = 1 for all  0 &lt;= k &lt; n_components</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">    where V is the dictionary and U is the sparse code. ||.||_Fro stands for</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">    the Frobenius norm and ||.||_1,1 stands for the entry-wise matrix norm</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">    which is the sum of the absolute values of all the entries in the matrix.</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">    Read more in the :ref:`User Guide &lt;DictionaryLearning&gt;`.</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">    X : ndarray of shape (n_samples, n_features)</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">        Data matrix.</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">    n_components : int</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">        Number of dictionary atoms to extract.</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral">    alpha : int</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">        Sparsity controlling parameter.</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral">    max_iter : int, default=100</span></div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">    tol : float, default=1e-8</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">        Tolerance for the stopping condition.</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">    method : {&#39;lars&#39;, &#39;cd&#39;}, default=&#39;lars&#39;</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">        The method used:</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">        * `&#39;lars&#39;`: uses the least angle regression method to solve the lasso</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">           problem (`linear_model.lars_path`);</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">        * `&#39;cd&#39;`: uses the coordinate descent method to compute the</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">          Lasso solution (`linear_model.Lasso`). Lars will be faster if</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">          the estimated components are sparse.</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral">    n_jobs : int, default=None</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">        Number of parallel jobs to run.</span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">        ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">        for more details.</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">    dict_init : ndarray of shape (n_components, n_features), default=None</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">        Initial value for the dictionary for warm restart scenarios. Only used</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        if `code_init` and `dict_init` are not None.</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">    code_init : ndarray of shape (n_samples, n_components), default=None</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">        Initial value for the sparse code for warm restart scenarios. Only used</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">        if `code_init` and `dict_init` are not None.</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">    callback : callable, default=None</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">        Callable that gets invoked every five iterations.</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">    verbose : bool, default=False</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">        To control the verbosity of the procedure.</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">    random_state : int, RandomState instance or None, default=None</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">        Used for randomly initializing the dictionary. Pass an int for</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">        reproducible results across multiple function calls.</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">        See :term:`Glossary &lt;random_state&gt;`.</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">    return_n_iter : bool, default=False</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">        Whether or not to return the number of iterations.</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">    positive_dict : bool, default=False</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">        Whether to enforce positivity when finding the dictionary.</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">        .. versionadded:: 0.20</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">    positive_code : bool, default=False</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">        Whether to enforce positivity when finding the code.</span></div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">        .. versionadded:: 0.20</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral">    method_max_iter : int, default=1000</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">        Maximum number of iterations to perform.</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">        .. versionadded:: 0.22</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">    code : ndarray of shape (n_samples, n_components)</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">        The sparse code factor in the matrix factorization.</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral">    dictionary : ndarray of shape (n_components, n_features),</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">        The dictionary factor in the matrix factorization.</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">    errors : array</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">        Vector of errors at each iteration.</span></div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">    n_iter : int</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">        Number of iterations run. Returned only if `return_n_iter` is</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral">        set to True.</span></div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">    dict_learning_online : Solve a dictionary learning matrix factorization</span></div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral">        problem online.</span></div>
<div class="line"><span class="lineno">  615</span><span class="stringliteral">    DictionaryLearning : Find a dictionary that sparsely encodes data.</span></div>
<div class="line"><span class="lineno">  616</span><span class="stringliteral">    MiniBatchDictionaryLearning : A faster, less accurate version</span></div>
<div class="line"><span class="lineno">  617</span><span class="stringliteral">        of the dictionary learning algorithm.</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">    SparsePCA : Sparse Principal Components Analysis.</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral">    MiniBatchSparsePCA : Mini-batch Sparse Principal Components Analysis.</span></div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">if</span> method <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&quot;lars&quot;</span>, <span class="stringliteral">&quot;cd&quot;</span>):</div>
<div class="line"><span class="lineno">  622</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Coding method %r not supported as a fit algorithm.&quot;</span> % method)</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    _check_positive_coding(method, positive_code)</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>    method = <span class="stringliteral">&quot;lasso_&quot;</span> + method</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>    t0 = time.time()</div>
<div class="line"><span class="lineno">  629</span>    <span class="comment"># Avoid integer division problems</span></div>
<div class="line"><span class="lineno">  630</span>    alpha = float(alpha)</div>
<div class="line"><span class="lineno">  631</span>    random_state = check_random_state(random_state)</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>    <span class="comment"># Init the code and the dictionary with SVD of Y</span></div>
<div class="line"><span class="lineno">  634</span>    <span class="keywordflow">if</span> code_init <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> dict_init <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  635</span>        code = np.array(code_init, order=<span class="stringliteral">&quot;F&quot;</span>)</div>
<div class="line"><span class="lineno">  636</span>        <span class="comment"># Don&#39;t copy V, it will happen below</span></div>
<div class="line"><span class="lineno">  637</span>        dictionary = dict_init</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  639</span>        code, S, dictionary = linalg.svd(X, full_matrices=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  640</span>        <span class="comment"># flip the initial code&#39;s sign to enforce deterministic output</span></div>
<div class="line"><span class="lineno">  641</span>        code, dictionary = svd_flip(code, dictionary)</div>
<div class="line"><span class="lineno">  642</span>        dictionary = S[:, np.newaxis] * dictionary</div>
<div class="line"><span class="lineno">  643</span>    r = len(dictionary)</div>
<div class="line"><span class="lineno">  644</span>    <span class="keywordflow">if</span> n_components &lt;= r:  <span class="comment"># True even if n_components=None</span></div>
<div class="line"><span class="lineno">  645</span>        code = code[:, :n_components]</div>
<div class="line"><span class="lineno">  646</span>        dictionary = dictionary[:n_components, :]</div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  648</span>        code = np.c_[code, np.zeros((len(code), n_components - r))]</div>
<div class="line"><span class="lineno">  649</span>        dictionary = np.r_[</div>
<div class="line"><span class="lineno">  650</span>            dictionary, np.zeros((n_components - r, dictionary.shape[1]))</div>
<div class="line"><span class="lineno">  651</span>        ]</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>    <span class="comment"># Fortran-order dict better suited for the sparse coding which is the</span></div>
<div class="line"><span class="lineno">  654</span>    <span class="comment"># bottleneck of this algorithm.</span></div>
<div class="line"><span class="lineno">  655</span>    dictionary = np.asfortranarray(dictionary)</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    errors = []</div>
<div class="line"><span class="lineno">  658</span>    current_cost = np.nan</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">if</span> verbose == 1:</div>
<div class="line"><span class="lineno">  661</span>        print(<span class="stringliteral">&quot;[dict_learning]&quot;</span>, end=<span class="stringliteral">&quot; &quot;</span>)</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="comment"># If max_iter is 0, number of iterations returned should be zero</span></div>
<div class="line"><span class="lineno">  664</span>    ii = -1</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>    <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(max_iter):</div>
<div class="line"><span class="lineno">  667</span>        dt = time.time() - t0</div>
<div class="line"><span class="lineno">  668</span>        <span class="keywordflow">if</span> verbose == 1:</div>
<div class="line"><span class="lineno">  669</span>            sys.stdout.write(<span class="stringliteral">&quot;.&quot;</span>)</div>
<div class="line"><span class="lineno">  670</span>            sys.stdout.flush()</div>
<div class="line"><span class="lineno">  671</span>        <span class="keywordflow">elif</span> verbose:</div>
<div class="line"><span class="lineno">  672</span>            print(</div>
<div class="line"><span class="lineno">  673</span>                <span class="stringliteral">&quot;Iteration % 3i (elapsed time: % 3is, % 4.1fmn, current cost % 7.3f)&quot;</span></div>
<div class="line"><span class="lineno">  674</span>                % (ii, dt, dt / 60, current_cost)</div>
<div class="line"><span class="lineno">  675</span>            )</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>        <span class="comment"># Update code</span></div>
<div class="line"><span class="lineno">  678</span>        code = sparse_encode(</div>
<div class="line"><span class="lineno">  679</span>            X,</div>
<div class="line"><span class="lineno">  680</span>            dictionary,</div>
<div class="line"><span class="lineno">  681</span>            algorithm=method,</div>
<div class="line"><span class="lineno">  682</span>            alpha=alpha,</div>
<div class="line"><span class="lineno">  683</span>            init=code,</div>
<div class="line"><span class="lineno">  684</span>            n_jobs=n_jobs,</div>
<div class="line"><span class="lineno">  685</span>            positive=positive_code,</div>
<div class="line"><span class="lineno">  686</span>            max_iter=method_max_iter,</div>
<div class="line"><span class="lineno">  687</span>            verbose=verbose,</div>
<div class="line"><span class="lineno">  688</span>        )</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>        <span class="comment"># Update dictionary in place</span></div>
<div class="line"><span class="lineno">  691</span>        _update_dict(</div>
<div class="line"><span class="lineno">  692</span>            dictionary,</div>
<div class="line"><span class="lineno">  693</span>            X,</div>
<div class="line"><span class="lineno">  694</span>            code,</div>
<div class="line"><span class="lineno">  695</span>            verbose=verbose,</div>
<div class="line"><span class="lineno">  696</span>            random_state=random_state,</div>
<div class="line"><span class="lineno">  697</span>            positive=positive_dict,</div>
<div class="line"><span class="lineno">  698</span>        )</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>        <span class="comment"># Cost function</span></div>
<div class="line"><span class="lineno">  701</span>        current_cost = 0.5 * np.sum((X - code @ dictionary) ** 2) + alpha * np.sum(</div>
<div class="line"><span class="lineno">  702</span>            np.abs(code)</div>
<div class="line"><span class="lineno">  703</span>        )</div>
<div class="line"><span class="lineno">  704</span>        errors.append(current_cost)</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>        <span class="keywordflow">if</span> ii &gt; 0:</div>
<div class="line"><span class="lineno">  707</span>            dE = errors[-2] - errors[-1]</div>
<div class="line"><span class="lineno">  708</span>            <span class="comment"># assert(dE &gt;= -tol * errors[-1])</span></div>
<div class="line"><span class="lineno">  709</span>            <span class="keywordflow">if</span> dE &lt; tol * errors[-1]:</div>
<div class="line"><span class="lineno">  710</span>                <span class="keywordflow">if</span> verbose == 1:</div>
<div class="line"><span class="lineno">  711</span>                    <span class="comment"># A line return</span></div>
<div class="line"><span class="lineno">  712</span>                    print(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  713</span>                <span class="keywordflow">elif</span> verbose:</div>
<div class="line"><span class="lineno">  714</span>                    print(<span class="stringliteral">&quot;--- Convergence reached after %d iterations&quot;</span> % ii)</div>
<div class="line"><span class="lineno">  715</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  716</span>        <span class="keywordflow">if</span> ii % 5 == 0 <span class="keywordflow">and</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  717</span>            callback(locals())</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> return_n_iter:</div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">return</span> code, dictionary, errors, ii + 1</div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  722</span>        <span class="keywordflow">return</span> code, dictionary, errors</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a457f05767c59f73be62dee22c615e3d8" name="a457f05767c59f73be62dee22c615e3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a457f05767c59f73be62dee22c615e3d8">&#9670;&#160;</a></span>dict_learning_online()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition._dict_learning.dict_learning_online </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_components</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_iter</em> = <code>&quot;deprecated&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_code</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dict_init</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch_size</em> = <code>&quot;warn&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shuffle</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_jobs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>&quot;lars&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iter_offset</em> = <code>&quot;deprecated&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_inner_stats</em> = <code>&quot;deprecated&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>inner_stats</em> = <code>&quot;deprecated&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_n_iter</em> = <code>&quot;deprecated&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive_dict</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive_code</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method_max_iter</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_no_improvement</em> = <code>10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Solve a dictionary learning matrix factorization problem online.

Finds the best dictionary and the corresponding sparse code for
approximating the data matrix X by solving::

    (U^*, V^*) = argmin 0.5 || X - U V ||_Fro^2 + alpha * || U ||_1,1
                 (U,V)
                 with || V_k ||_2 = 1 for all  0 &lt;= k &lt; n_components

where V is the dictionary and U is the sparse code. ||.||_Fro stands for
the Frobenius norm and ||.||_1,1 stands for the entry-wise matrix norm
which is the sum of the absolute values of all the entries in the matrix.
This is accomplished by repeatedly iterating over mini-batches by slicing
the input data.

Read more in the :ref:`User Guide &lt;DictionaryLearning&gt;`.

Parameters
----------
X : ndarray of shape (n_samples, n_features)
    Data matrix.

n_components : int or None, default=2
    Number of dictionary atoms to extract. If None, then ``n_components``
    is set to ``n_features``.

alpha : float, default=1
    Sparsity controlling parameter.

n_iter : int, default=100
    Number of mini-batch iterations to perform.

    .. deprecated:: 1.1
       `n_iter` is deprecated in 1.1 and will be removed in 1.4. Use
       `max_iter` instead.

max_iter : int, default=None
    Maximum number of iterations over the complete dataset before
    stopping independently of any early stopping criterion heuristics.
    If ``max_iter`` is not None, ``n_iter`` is ignored.

    .. versionadded:: 1.1

return_code : bool, default=True
    Whether to also return the code U or just the dictionary `V`.

dict_init : ndarray of shape (n_components, n_features), default=None
    Initial values for the dictionary for warm restart scenarios.
    If `None`, the initial values for the dictionary are created
    with an SVD decomposition of the data via :func:`~sklearn.utils.randomized_svd`.

callback : callable, default=None
    A callable that gets invoked at the end of each iteration.

batch_size : int, default=3
    The number of samples to take in each batch.

    .. versionchanged:: 1.3
       The default value of `batch_size` will change from 3 to 256 in version 1.3.

verbose : bool, default=False
    To control the verbosity of the procedure.

shuffle : bool, default=True
    Whether to shuffle the data before splitting it in batches.

n_jobs : int, default=None
    Number of parallel jobs to run.
    ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.
    ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`
    for more details.

method : {'lars', 'cd'}, default='lars'
    * `'lars'`: uses the least angle regression method to solve the lasso
      problem (`linear_model.lars_path`);
    * `'cd'`: uses the coordinate descent method to compute the
      Lasso solution (`linear_model.Lasso`). Lars will be faster if
      the estimated components are sparse.

iter_offset : int, default=0
    Number of previous iterations completed on the dictionary used for
    initialization.

    .. deprecated:: 1.1
       `iter_offset` serves internal purpose only and will be removed in 1.3.

random_state : int, RandomState instance or None, default=None
    Used for initializing the dictionary when ``dict_init`` is not
    specified, randomly shuffling the data when ``shuffle`` is set to
    ``True``, and updating the dictionary. Pass an int for reproducible
    results across multiple function calls.
    See :term:`Glossary &lt;random_state&gt;`.

return_inner_stats : bool, default=False
    Return the inner statistics A (dictionary covariance) and B
    (data approximation). Useful to restart the algorithm in an
    online setting. If `return_inner_stats` is `True`, `return_code` is
    ignored.

    .. deprecated:: 1.1
       `return_inner_stats` serves internal purpose only and will be removed in 1.3.

inner_stats : tuple of (A, B) ndarrays, default=None
    Inner sufficient statistics that are kept by the algorithm.
    Passing them at initialization is useful in online settings, to
    avoid losing the history of the evolution.
    `A` `(n_components, n_components)` is the dictionary covariance matrix.
    `B` `(n_features, n_components)` is the data approximation matrix.

    .. deprecated:: 1.1
       `inner_stats` serves internal purpose only and will be removed in 1.3.

return_n_iter : bool, default=False
    Whether or not to return the number of iterations.

    .. deprecated:: 1.1
       `return_n_iter` will be removed in 1.3 and n_iter will always be returned.

positive_dict : bool, default=False
    Whether to enforce positivity when finding the dictionary.

    .. versionadded:: 0.20

positive_code : bool, default=False
    Whether to enforce positivity when finding the code.

    .. versionadded:: 0.20

method_max_iter : int, default=1000
    Maximum number of iterations to perform when solving the lasso problem.

    .. versionadded:: 0.22

tol : float, default=1e-3
    Control early stopping based on the norm of the differences in the
    dictionary between 2 steps. Used only if `max_iter` is not None.

    To disable early stopping based on changes in the dictionary, set
    `tol` to 0.0.

    .. versionadded:: 1.1

max_no_improvement : int, default=10
    Control early stopping based on the consecutive number of mini batches
    that does not yield an improvement on the smoothed cost function. Used only if
    `max_iter` is not None.

    To disable convergence detection based on cost function, set
    `max_no_improvement` to None.

    .. versionadded:: 1.1

Returns
-------
code : ndarray of shape (n_samples, n_components),
    The sparse code (only returned if `return_code=True`).

dictionary : ndarray of shape (n_components, n_features),
    The solutions to the dictionary learning problem.

n_iter : int
    Number of iterations run. Returned only if `return_n_iter` is
    set to `True`.

See Also
--------
dict_learning : Solve a dictionary learning matrix factorization problem.
DictionaryLearning : Find a dictionary that sparsely encodes data.
MiniBatchDictionaryLearning : A faster, less accurate, version of the dictionary
    learning algorithm.
SparsePCA : Sparse Principal Components Analysis.
MiniBatchSparsePCA : Mini-batch Sparse Principal Components Analysis.
</pre> <div class="fragment"><div class="line"><span class="lineno">  763</span>):</div>
<div class="line"><span class="lineno">  764</span>    <span class="stringliteral">&quot;&quot;&quot;Solve a dictionary learning matrix factorization problem online.</span></div>
<div class="line"><span class="lineno">  765</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  766</span><span class="stringliteral">    Finds the best dictionary and the corresponding sparse code for</span></div>
<div class="line"><span class="lineno">  767</span><span class="stringliteral">    approximating the data matrix X by solving::</span></div>
<div class="line"><span class="lineno">  768</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  769</span><span class="stringliteral">        (U^*, V^*) = argmin 0.5 || X - U V ||_Fro^2 + alpha * || U ||_1,1</span></div>
<div class="line"><span class="lineno">  770</span><span class="stringliteral">                     (U,V)</span></div>
<div class="line"><span class="lineno">  771</span><span class="stringliteral">                     with || V_k ||_2 = 1 for all  0 &lt;= k &lt; n_components</span></div>
<div class="line"><span class="lineno">  772</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  773</span><span class="stringliteral">    where V is the dictionary and U is the sparse code. ||.||_Fro stands for</span></div>
<div class="line"><span class="lineno">  774</span><span class="stringliteral">    the Frobenius norm and ||.||_1,1 stands for the entry-wise matrix norm</span></div>
<div class="line"><span class="lineno">  775</span><span class="stringliteral">    which is the sum of the absolute values of all the entries in the matrix.</span></div>
<div class="line"><span class="lineno">  776</span><span class="stringliteral">    This is accomplished by repeatedly iterating over mini-batches by slicing</span></div>
<div class="line"><span class="lineno">  777</span><span class="stringliteral">    the input data.</span></div>
<div class="line"><span class="lineno">  778</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  779</span><span class="stringliteral">    Read more in the :ref:`User Guide &lt;DictionaryLearning&gt;`.</span></div>
<div class="line"><span class="lineno">  780</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  781</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  782</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  783</span><span class="stringliteral">    X : ndarray of shape (n_samples, n_features)</span></div>
<div class="line"><span class="lineno">  784</span><span class="stringliteral">        Data matrix.</span></div>
<div class="line"><span class="lineno">  785</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  786</span><span class="stringliteral">    n_components : int or None, default=2</span></div>
<div class="line"><span class="lineno">  787</span><span class="stringliteral">        Number of dictionary atoms to extract. If None, then ``n_components``</span></div>
<div class="line"><span class="lineno">  788</span><span class="stringliteral">        is set to ``n_features``.</span></div>
<div class="line"><span class="lineno">  789</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  790</span><span class="stringliteral">    alpha : float, default=1</span></div>
<div class="line"><span class="lineno">  791</span><span class="stringliteral">        Sparsity controlling parameter.</span></div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">    n_iter : int, default=100</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral">        Number of mini-batch iterations to perform.</span></div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">        .. deprecated:: 1.1</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">           `n_iter` is deprecated in 1.1 and will be removed in 1.4. Use</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral">           `max_iter` instead.</span></div>
<div class="line"><span class="lineno">  799</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  800</span><span class="stringliteral">    max_iter : int, default=None</span></div>
<div class="line"><span class="lineno">  801</span><span class="stringliteral">        Maximum number of iterations over the complete dataset before</span></div>
<div class="line"><span class="lineno">  802</span><span class="stringliteral">        stopping independently of any early stopping criterion heuristics.</span></div>
<div class="line"><span class="lineno">  803</span><span class="stringliteral">        If ``max_iter`` is not None, ``n_iter`` is ignored.</span></div>
<div class="line"><span class="lineno">  804</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  805</span><span class="stringliteral">        .. versionadded:: 1.1</span></div>
<div class="line"><span class="lineno">  806</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  807</span><span class="stringliteral">    return_code : bool, default=True</span></div>
<div class="line"><span class="lineno">  808</span><span class="stringliteral">        Whether to also return the code U or just the dictionary `V`.</span></div>
<div class="line"><span class="lineno">  809</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  810</span><span class="stringliteral">    dict_init : ndarray of shape (n_components, n_features), default=None</span></div>
<div class="line"><span class="lineno">  811</span><span class="stringliteral">        Initial values for the dictionary for warm restart scenarios.</span></div>
<div class="line"><span class="lineno">  812</span><span class="stringliteral">        If `None`, the initial values for the dictionary are created</span></div>
<div class="line"><span class="lineno">  813</span><span class="stringliteral">        with an SVD decomposition of the data via :func:`~sklearn.utils.randomized_svd`.</span></div>
<div class="line"><span class="lineno">  814</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral">    callback : callable, default=None</span></div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">        A callable that gets invoked at the end of each iteration.</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">    batch_size : int, default=3</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral">        The number of samples to take in each batch.</span></div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">        .. versionchanged:: 1.3</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">           The default value of `batch_size` will change from 3 to 256 in version 1.3.</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">    verbose : bool, default=False</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">        To control the verbosity of the procedure.</span></div>
<div class="line"><span class="lineno">  826</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral">    shuffle : bool, default=True</span></div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral">        Whether to shuffle the data before splitting it in batches.</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">    n_jobs : int, default=None</span></div>
<div class="line"><span class="lineno">  831</span><span class="stringliteral">        Number of parallel jobs to run.</span></div>
<div class="line"><span class="lineno">  832</span><span class="stringliteral">        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.</span></div>
<div class="line"><span class="lineno">  833</span><span class="stringliteral">        ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`</span></div>
<div class="line"><span class="lineno">  834</span><span class="stringliteral">        for more details.</span></div>
<div class="line"><span class="lineno">  835</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  836</span><span class="stringliteral">    method : {&#39;lars&#39;, &#39;cd&#39;}, default=&#39;lars&#39;</span></div>
<div class="line"><span class="lineno">  837</span><span class="stringliteral">        * `&#39;lars&#39;`: uses the least angle regression method to solve the lasso</span></div>
<div class="line"><span class="lineno">  838</span><span class="stringliteral">          problem (`linear_model.lars_path`);</span></div>
<div class="line"><span class="lineno">  839</span><span class="stringliteral">        * `&#39;cd&#39;`: uses the coordinate descent method to compute the</span></div>
<div class="line"><span class="lineno">  840</span><span class="stringliteral">          Lasso solution (`linear_model.Lasso`). Lars will be faster if</span></div>
<div class="line"><span class="lineno">  841</span><span class="stringliteral">          the estimated components are sparse.</span></div>
<div class="line"><span class="lineno">  842</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  843</span><span class="stringliteral">    iter_offset : int, default=0</span></div>
<div class="line"><span class="lineno">  844</span><span class="stringliteral">        Number of previous iterations completed on the dictionary used for</span></div>
<div class="line"><span class="lineno">  845</span><span class="stringliteral">        initialization.</span></div>
<div class="line"><span class="lineno">  846</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  847</span><span class="stringliteral">        .. deprecated:: 1.1</span></div>
<div class="line"><span class="lineno">  848</span><span class="stringliteral">           `iter_offset` serves internal purpose only and will be removed in 1.3.</span></div>
<div class="line"><span class="lineno">  849</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  850</span><span class="stringliteral">    random_state : int, RandomState instance or None, default=None</span></div>
<div class="line"><span class="lineno">  851</span><span class="stringliteral">        Used for initializing the dictionary when ``dict_init`` is not</span></div>
<div class="line"><span class="lineno">  852</span><span class="stringliteral">        specified, randomly shuffling the data when ``shuffle`` is set to</span></div>
<div class="line"><span class="lineno">  853</span><span class="stringliteral">        ``True``, and updating the dictionary. Pass an int for reproducible</span></div>
<div class="line"><span class="lineno">  854</span><span class="stringliteral">        results across multiple function calls.</span></div>
<div class="line"><span class="lineno">  855</span><span class="stringliteral">        See :term:`Glossary &lt;random_state&gt;`.</span></div>
<div class="line"><span class="lineno">  856</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  857</span><span class="stringliteral">    return_inner_stats : bool, default=False</span></div>
<div class="line"><span class="lineno">  858</span><span class="stringliteral">        Return the inner statistics A (dictionary covariance) and B</span></div>
<div class="line"><span class="lineno">  859</span><span class="stringliteral">        (data approximation). Useful to restart the algorithm in an</span></div>
<div class="line"><span class="lineno">  860</span><span class="stringliteral">        online setting. If `return_inner_stats` is `True`, `return_code` is</span></div>
<div class="line"><span class="lineno">  861</span><span class="stringliteral">        ignored.</span></div>
<div class="line"><span class="lineno">  862</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  863</span><span class="stringliteral">        .. deprecated:: 1.1</span></div>
<div class="line"><span class="lineno">  864</span><span class="stringliteral">           `return_inner_stats` serves internal purpose only and will be removed in 1.3.</span></div>
<div class="line"><span class="lineno">  865</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  866</span><span class="stringliteral">    inner_stats : tuple of (A, B) ndarrays, default=None</span></div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">        Inner sufficient statistics that are kept by the algorithm.</span></div>
<div class="line"><span class="lineno">  868</span><span class="stringliteral">        Passing them at initialization is useful in online settings, to</span></div>
<div class="line"><span class="lineno">  869</span><span class="stringliteral">        avoid losing the history of the evolution.</span></div>
<div class="line"><span class="lineno">  870</span><span class="stringliteral">        `A` `(n_components, n_components)` is the dictionary covariance matrix.</span></div>
<div class="line"><span class="lineno">  871</span><span class="stringliteral">        `B` `(n_features, n_components)` is the data approximation matrix.</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  873</span><span class="stringliteral">        .. deprecated:: 1.1</span></div>
<div class="line"><span class="lineno">  874</span><span class="stringliteral">           `inner_stats` serves internal purpose only and will be removed in 1.3.</span></div>
<div class="line"><span class="lineno">  875</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  876</span><span class="stringliteral">    return_n_iter : bool, default=False</span></div>
<div class="line"><span class="lineno">  877</span><span class="stringliteral">        Whether or not to return the number of iterations.</span></div>
<div class="line"><span class="lineno">  878</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  879</span><span class="stringliteral">        .. deprecated:: 1.1</span></div>
<div class="line"><span class="lineno">  880</span><span class="stringliteral">           `return_n_iter` will be removed in 1.3 and n_iter will always be returned.</span></div>
<div class="line"><span class="lineno">  881</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  882</span><span class="stringliteral">    positive_dict : bool, default=False</span></div>
<div class="line"><span class="lineno">  883</span><span class="stringliteral">        Whether to enforce positivity when finding the dictionary.</span></div>
<div class="line"><span class="lineno">  884</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  885</span><span class="stringliteral">        .. versionadded:: 0.20</span></div>
<div class="line"><span class="lineno">  886</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  887</span><span class="stringliteral">    positive_code : bool, default=False</span></div>
<div class="line"><span class="lineno">  888</span><span class="stringliteral">        Whether to enforce positivity when finding the code.</span></div>
<div class="line"><span class="lineno">  889</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  890</span><span class="stringliteral">        .. versionadded:: 0.20</span></div>
<div class="line"><span class="lineno">  891</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral">    method_max_iter : int, default=1000</span></div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">        Maximum number of iterations to perform when solving the lasso problem.</span></div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">        .. versionadded:: 0.22</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">    tol : float, default=1e-3</span></div>
<div class="line"><span class="lineno">  898</span><span class="stringliteral">        Control early stopping based on the norm of the differences in the</span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral">        dictionary between 2 steps. Used only if `max_iter` is not None.</span></div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">        To disable early stopping based on changes in the dictionary, set</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">        `tol` to 0.0.</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">        .. versionadded:: 1.1</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">    max_no_improvement : int, default=10</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">        Control early stopping based on the consecutive number of mini batches</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">        that does not yield an improvement on the smoothed cost function. Used only if</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral">        `max_iter` is not None.</span></div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral">        To disable convergence detection based on cost function, set</span></div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">        `max_no_improvement` to None.</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">        .. versionadded:: 1.1</span></div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">    code : ndarray of shape (n_samples, n_components),</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">        The sparse code (only returned if `return_code=True`).</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral">    dictionary : ndarray of shape (n_components, n_features),</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">        The solutions to the dictionary learning problem.</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral">    n_iter : int</span></div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral">        Number of iterations run. Returned only if `return_n_iter` is</span></div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">        set to `True`.</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral">    dict_learning : Solve a dictionary learning matrix factorization problem.</span></div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral">    DictionaryLearning : Find a dictionary that sparsely encodes data.</span></div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral">    MiniBatchDictionaryLearning : A faster, less accurate, version of the dictionary</span></div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral">        learning algorithm.</span></div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral">    SparsePCA : Sparse Principal Components Analysis.</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral">    MiniBatchSparsePCA : Mini-batch Sparse Principal Components Analysis.</span></div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  937</span>    deps = (return_n_iter, return_inner_stats, iter_offset, inner_stats)</div>
<div class="line"><span class="lineno">  938</span>    <span class="keywordflow">if</span> max_iter <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> <span class="keywordflow">not</span> all(arg == <span class="stringliteral">&quot;deprecated&quot;</span> <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> deps):</div>
<div class="line"><span class="lineno">  939</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  940</span>            <span class="stringliteral">&quot;The following arguments are incompatible with &#39;max_iter&#39;: &quot;</span></div>
<div class="line"><span class="lineno">  941</span>            <span class="stringliteral">&quot;return_n_iter, return_inner_stats, iter_offset, inner_stats&quot;</span></div>
<div class="line"><span class="lineno">  942</span>        )</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>    iter_offset = _check_warn_deprecated(iter_offset, <span class="stringliteral">&quot;iter_offset&quot;</span>, default=0)</div>
<div class="line"><span class="lineno">  945</span>    return_inner_stats = _check_warn_deprecated(</div>
<div class="line"><span class="lineno">  946</span>        return_inner_stats,</div>
<div class="line"><span class="lineno">  947</span>        <span class="stringliteral">&quot;return_inner_stats&quot;</span>,</div>
<div class="line"><span class="lineno">  948</span>        default=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  949</span>        additional_message=<span class="stringliteral">&quot;From 1.3 inner_stats will never be returned.&quot;</span>,</div>
<div class="line"><span class="lineno">  950</span>    )</div>
<div class="line"><span class="lineno">  951</span>    inner_stats = _check_warn_deprecated(inner_stats, <span class="stringliteral">&quot;inner_stats&quot;</span>, default=<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  952</span>    return_n_iter = _check_warn_deprecated(</div>
<div class="line"><span class="lineno">  953</span>        return_n_iter,</div>
<div class="line"><span class="lineno">  954</span>        <span class="stringliteral">&quot;return_n_iter&quot;</span>,</div>
<div class="line"><span class="lineno">  955</span>        default=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  956</span>        additional_message=(</div>
<div class="line"><span class="lineno">  957</span>            <span class="stringliteral">&quot;From 1.3 &#39;n_iter&#39; will never be returned. Refer to the &#39;n_iter_&#39; and &quot;</span></div>
<div class="line"><span class="lineno">  958</span>            <span class="stringliteral">&quot;&#39;n_steps_&#39; attributes of the MiniBatchDictionaryLearning object instead.&quot;</span></div>
<div class="line"><span class="lineno">  959</span>        ),</div>
<div class="line"><span class="lineno">  960</span>    )</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>    <span class="keywordflow">if</span> max_iter <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  963</span>        transform_algorithm = <span class="stringliteral">&quot;lasso_&quot;</span> + method</div>
<div class="line"><span class="lineno">  964</span> </div>
<div class="line"><span class="lineno">  965</span>        est = MiniBatchDictionaryLearning(</div>
<div class="line"><span class="lineno">  966</span>            n_components=n_components,</div>
<div class="line"><span class="lineno">  967</span>            alpha=alpha,</div>
<div class="line"><span class="lineno">  968</span>            n_iter=n_iter,</div>
<div class="line"><span class="lineno">  969</span>            n_jobs=n_jobs,</div>
<div class="line"><span class="lineno">  970</span>            fit_algorithm=method,</div>
<div class="line"><span class="lineno">  971</span>            batch_size=batch_size,</div>
<div class="line"><span class="lineno">  972</span>            shuffle=shuffle,</div>
<div class="line"><span class="lineno">  973</span>            dict_init=dict_init,</div>
<div class="line"><span class="lineno">  974</span>            random_state=random_state,</div>
<div class="line"><span class="lineno">  975</span>            transform_algorithm=transform_algorithm,</div>
<div class="line"><span class="lineno">  976</span>            transform_alpha=alpha,</div>
<div class="line"><span class="lineno">  977</span>            positive_code=positive_code,</div>
<div class="line"><span class="lineno">  978</span>            positive_dict=positive_dict,</div>
<div class="line"><span class="lineno">  979</span>            transform_max_iter=method_max_iter,</div>
<div class="line"><span class="lineno">  980</span>            verbose=verbose,</div>
<div class="line"><span class="lineno">  981</span>            callback=callback,</div>
<div class="line"><span class="lineno">  982</span>            tol=tol,</div>
<div class="line"><span class="lineno">  983</span>            max_no_improvement=max_no_improvement,</div>
<div class="line"><span class="lineno">  984</span>        ).fit(X)</div>
<div class="line"><span class="lineno">  985</span> </div>
<div class="line"><span class="lineno">  986</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> return_code:</div>
<div class="line"><span class="lineno">  987</span>            <span class="keywordflow">return</span> est.components_</div>
<div class="line"><span class="lineno">  988</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  989</span>            code = est.transform(X)</div>
<div class="line"><span class="lineno">  990</span>            <span class="keywordflow">return</span> code, est.components_</div>
<div class="line"><span class="lineno">  991</span> </div>
<div class="line"><span class="lineno">  992</span>    <span class="comment"># TODO remove the whole old behavior in 1.3</span></div>
<div class="line"><span class="lineno">  993</span>    <span class="comment"># Fallback to old behavior</span></div>
<div class="line"><span class="lineno">  994</span> </div>
<div class="line"><span class="lineno">  995</span>    n_iter = _check_warn_deprecated(</div>
<div class="line"><span class="lineno">  996</span>        n_iter, <span class="stringliteral">&quot;n_iter&quot;</span>, default=100, additional_message=<span class="stringliteral">&quot;Use &#39;max_iter&#39; instead.&quot;</span></div>
<div class="line"><span class="lineno">  997</span>    )</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>    <span class="keywordflow">if</span> batch_size == <span class="stringliteral">&quot;warn&quot;</span>:</div>
<div class="line"><span class="lineno"> 1000</span>        warnings.warn(</div>
<div class="line"><span class="lineno"> 1001</span>            <span class="stringliteral">&quot;The default value of batch_size will change from 3 to 256 in 1.3.&quot;</span>,</div>
<div class="line"><span class="lineno"> 1002</span>            FutureWarning,</div>
<div class="line"><span class="lineno"> 1003</span>        )</div>
<div class="line"><span class="lineno"> 1004</span>        batch_size = 3</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>    <span class="keywordflow">if</span> n_components <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1007</span>        n_components = X.shape[1]</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span>    <span class="keywordflow">if</span> method <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&quot;lars&quot;</span>, <span class="stringliteral">&quot;cd&quot;</span>):</div>
<div class="line"><span class="lineno"> 1010</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Coding method not supported as a fit algorithm.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1011</span> </div>
<div class="line"><span class="lineno"> 1012</span>    _check_positive_coding(method, positive_code)</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>    method = <span class="stringliteral">&quot;lasso_&quot;</span> + method</div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span>    t0 = time.time()</div>
<div class="line"><span class="lineno"> 1017</span>    n_samples, n_features = X.shape</div>
<div class="line"><span class="lineno"> 1018</span>    <span class="comment"># Avoid integer division problems</span></div>
<div class="line"><span class="lineno"> 1019</span>    alpha = float(alpha)</div>
<div class="line"><span class="lineno"> 1020</span>    random_state = check_random_state(random_state)</div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span>    <span class="comment"># Init V with SVD of X</span></div>
<div class="line"><span class="lineno"> 1023</span>    <span class="keywordflow">if</span> dict_init <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1024</span>        dictionary = dict_init</div>
<div class="line"><span class="lineno"> 1025</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1026</span>        _, S, dictionary = randomized_svd(X, n_components, random_state=random_state)</div>
<div class="line"><span class="lineno"> 1027</span>        dictionary = S[:, np.newaxis] * dictionary</div>
<div class="line"><span class="lineno"> 1028</span>    r = len(dictionary)</div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keywordflow">if</span> n_components &lt;= r:</div>
<div class="line"><span class="lineno"> 1030</span>        dictionary = dictionary[:n_components, :]</div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1032</span>        dictionary = np.r_[</div>
<div class="line"><span class="lineno"> 1033</span>            dictionary,</div>
<div class="line"><span class="lineno"> 1034</span>            np.zeros((n_components - r, dictionary.shape[1]), dtype=dictionary.dtype),</div>
<div class="line"><span class="lineno"> 1035</span>        ]</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">if</span> verbose == 1:</div>
<div class="line"><span class="lineno"> 1038</span>        print(<span class="stringliteral">&quot;[dict_learning]&quot;</span>, end=<span class="stringliteral">&quot; &quot;</span>)</div>
<div class="line"><span class="lineno"> 1039</span> </div>
<div class="line"><span class="lineno"> 1040</span>    <span class="keywordflow">if</span> shuffle:</div>
<div class="line"><span class="lineno"> 1041</span>        X_train = X.copy()</div>
<div class="line"><span class="lineno"> 1042</span>        random_state.shuffle(X_train)</div>
<div class="line"><span class="lineno"> 1043</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1044</span>        X_train = X</div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span>    X_train = check_array(</div>
<div class="line"><span class="lineno"> 1047</span>        X_train, order=<span class="stringliteral">&quot;C&quot;</span>, dtype=[np.float64, np.float32], copy=<span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1048</span>    )</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>    <span class="comment"># Fortran-order dict better suited for the sparse coding which is the</span></div>
<div class="line"><span class="lineno"> 1051</span>    <span class="comment"># bottleneck of this algorithm.</span></div>
<div class="line"><span class="lineno"> 1052</span>    dictionary = check_array(dictionary, order=<span class="stringliteral">&quot;F&quot;</span>, dtype=X_train.dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1053</span>    dictionary = np.require(dictionary, requirements=<span class="stringliteral">&quot;W&quot;</span>)</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>    batches = gen_batches(n_samples, batch_size)</div>
<div class="line"><span class="lineno"> 1056</span>    batches = itertools.cycle(batches)</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>    <span class="comment"># The covariance of the dictionary</span></div>
<div class="line"><span class="lineno"> 1059</span>    <span class="keywordflow">if</span> inner_stats <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1060</span>        A = np.zeros((n_components, n_components), dtype=X_train.dtype)</div>
<div class="line"><span class="lineno"> 1061</span>        <span class="comment"># The data approximation</span></div>
<div class="line"><span class="lineno"> 1062</span>        B = np.zeros((n_features, n_components), dtype=X_train.dtype)</div>
<div class="line"><span class="lineno"> 1063</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1064</span>        A = inner_stats[0].copy()</div>
<div class="line"><span class="lineno"> 1065</span>        B = inner_stats[1].copy()</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>    <span class="comment"># If n_iter is zero, we need to return zero.</span></div>
<div class="line"><span class="lineno"> 1068</span>    ii = iter_offset - 1</div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>    <span class="keywordflow">for</span> ii, batch <span class="keywordflow">in</span> zip(range(iter_offset, iter_offset + n_iter), batches):</div>
<div class="line"><span class="lineno"> 1071</span>        this_X = X_train[batch]</div>
<div class="line"><span class="lineno"> 1072</span>        dt = time.time() - t0</div>
<div class="line"><span class="lineno"> 1073</span>        <span class="keywordflow">if</span> verbose == 1:</div>
<div class="line"><span class="lineno"> 1074</span>            sys.stdout.write(<span class="stringliteral">&quot;.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1075</span>            sys.stdout.flush()</div>
<div class="line"><span class="lineno"> 1076</span>        <span class="keywordflow">elif</span> verbose:</div>
<div class="line"><span class="lineno"> 1077</span>            <span class="keywordflow">if</span> verbose &gt; 10 <span class="keywordflow">or</span> ii % ceil(100.0 / verbose) == 0:</div>
<div class="line"><span class="lineno"> 1078</span>                print(</div>
<div class="line"><span class="lineno"> 1079</span>                    <span class="stringliteral">&quot;Iteration % 3i (elapsed time: % 3is, % 4.1fmn)&quot;</span> % (ii, dt, dt / 60)</div>
<div class="line"><span class="lineno"> 1080</span>                )</div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span>        this_code = sparse_encode(</div>
<div class="line"><span class="lineno"> 1083</span>            this_X,</div>
<div class="line"><span class="lineno"> 1084</span>            dictionary,</div>
<div class="line"><span class="lineno"> 1085</span>            algorithm=method,</div>
<div class="line"><span class="lineno"> 1086</span>            alpha=alpha,</div>
<div class="line"><span class="lineno"> 1087</span>            n_jobs=n_jobs,</div>
<div class="line"><span class="lineno"> 1088</span>            check_input=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1089</span>            positive=positive_code,</div>
<div class="line"><span class="lineno"> 1090</span>            max_iter=method_max_iter,</div>
<div class="line"><span class="lineno"> 1091</span>            verbose=verbose,</div>
<div class="line"><span class="lineno"> 1092</span>        )</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>        <span class="comment"># Update the auxiliary variables</span></div>
<div class="line"><span class="lineno"> 1095</span>        <span class="keywordflow">if</span> ii &lt; batch_size - 1:</div>
<div class="line"><span class="lineno"> 1096</span>            theta = float((ii + 1) * batch_size)</div>
<div class="line"><span class="lineno"> 1097</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1098</span>            theta = float(batch_size**2 + ii + 1 - batch_size)</div>
<div class="line"><span class="lineno"> 1099</span>        beta = (theta + 1 - batch_size) / (theta + 1)</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>        A *= beta</div>
<div class="line"><span class="lineno"> 1102</span>        A += np.dot(this_code.T, this_code)</div>
<div class="line"><span class="lineno"> 1103</span>        B *= beta</div>
<div class="line"><span class="lineno"> 1104</span>        B += np.dot(this_X.T, this_code)</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>        <span class="comment"># Update dictionary in place</span></div>
<div class="line"><span class="lineno"> 1107</span>        _update_dict(</div>
<div class="line"><span class="lineno"> 1108</span>            dictionary,</div>
<div class="line"><span class="lineno"> 1109</span>            this_X,</div>
<div class="line"><span class="lineno"> 1110</span>            this_code,</div>
<div class="line"><span class="lineno"> 1111</span>            A,</div>
<div class="line"><span class="lineno"> 1112</span>            B,</div>
<div class="line"><span class="lineno"> 1113</span>            verbose=verbose,</div>
<div class="line"><span class="lineno"> 1114</span>            random_state=random_state,</div>
<div class="line"><span class="lineno"> 1115</span>            positive=positive_dict,</div>
<div class="line"><span class="lineno"> 1116</span>        )</div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span>        <span class="comment"># Maybe we need a stopping criteria based on the amount of</span></div>
<div class="line"><span class="lineno"> 1119</span>        <span class="comment"># modification in the dictionary</span></div>
<div class="line"><span class="lineno"> 1120</span>        <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1121</span>            callback(locals())</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>    <span class="keywordflow">if</span> return_inner_stats:</div>
<div class="line"><span class="lineno"> 1124</span>        <span class="keywordflow">if</span> return_n_iter:</div>
<div class="line"><span class="lineno"> 1125</span>            <span class="keywordflow">return</span> dictionary, (A, B), ii - iter_offset + 1</div>
<div class="line"><span class="lineno"> 1126</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1127</span>            <span class="keywordflow">return</span> dictionary, (A, B)</div>
<div class="line"><span class="lineno"> 1128</span>    <span class="keywordflow">if</span> return_code:</div>
<div class="line"><span class="lineno"> 1129</span>        <span class="keywordflow">if</span> verbose &gt; 1:</div>
<div class="line"><span class="lineno"> 1130</span>            print(<span class="stringliteral">&quot;Learning code...&quot;</span>, end=<span class="stringliteral">&quot; &quot;</span>)</div>
<div class="line"><span class="lineno"> 1131</span>        <span class="keywordflow">elif</span> verbose == 1:</div>
<div class="line"><span class="lineno"> 1132</span>            print(<span class="stringliteral">&quot;|&quot;</span>, end=<span class="stringliteral">&quot; &quot;</span>)</div>
<div class="line"><span class="lineno"> 1133</span>        code = sparse_encode(</div>
<div class="line"><span class="lineno"> 1134</span>            X,</div>
<div class="line"><span class="lineno"> 1135</span>            dictionary,</div>
<div class="line"><span class="lineno"> 1136</span>            algorithm=method,</div>
<div class="line"><span class="lineno"> 1137</span>            alpha=alpha,</div>
<div class="line"><span class="lineno"> 1138</span>            n_jobs=n_jobs,</div>
<div class="line"><span class="lineno"> 1139</span>            check_input=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1140</span>            positive=positive_code,</div>
<div class="line"><span class="lineno"> 1141</span>            max_iter=method_max_iter,</div>
<div class="line"><span class="lineno"> 1142</span>            verbose=verbose,</div>
<div class="line"><span class="lineno"> 1143</span>        )</div>
<div class="line"><span class="lineno"> 1144</span>        <span class="keywordflow">if</span> verbose &gt; 1:</div>
<div class="line"><span class="lineno"> 1145</span>            dt = time.time() - t0</div>
<div class="line"><span class="lineno"> 1146</span>            print(<span class="stringliteral">&quot;done (total time: % 3is, % 4.1fmn)&quot;</span> % (dt, dt / 60))</div>
<div class="line"><span class="lineno"> 1147</span>        <span class="keywordflow">if</span> return_n_iter:</div>
<div class="line"><span class="lineno"> 1148</span>            <span class="keywordflow">return</span> code, dictionary, ii - iter_offset + 1</div>
<div class="line"><span class="lineno"> 1149</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1150</span>            <span class="keywordflow">return</span> code, dictionary</div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span>    <span class="keywordflow">if</span> return_n_iter:</div>
<div class="line"><span class="lineno"> 1153</span>        <span class="keywordflow">return</span> dictionary, ii - iter_offset + 1</div>
<div class="line"><span class="lineno"> 1154</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1155</span>        <span class="keywordflow">return</span> dictionary</div>
<div class="line"><span class="lineno"> 1156</span> </div>
<div class="line"><span class="lineno"> 1157</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af7ac8ff5d643119fcb991a4fc5bb094f" name="af7ac8ff5d643119fcb991a4fc5bb094f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7ac8ff5d643119fcb991a4fc5bb094f">&#9670;&#160;</a></span>sparse_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition._dict_learning.sparse_encode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dictionary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>gram</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cov</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>algorithm</em> = <code>&quot;lasso_lars&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_nonzero_coefs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>copy_cov</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_jobs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_input</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Sparse coding.

Each row of the result is the solution to a sparse coding problem.
The goal is to find a sparse array `code` such that::

    X ~= code * dictionary

Read more in the :ref:`User Guide &lt;SparseCoder&gt;`.

Parameters
----------
X : ndarray of shape (n_samples, n_features)
    Data matrix.

dictionary : ndarray of shape (n_components, n_features)
    The dictionary matrix against which to solve the sparse coding of
    the data. Some of the algorithms assume normalized rows for meaningful
    output.

gram : ndarray of shape (n_components, n_components), default=None
    Precomputed Gram matrix, `dictionary * dictionary'`.

cov : ndarray of shape (n_components, n_samples), default=None
    Precomputed covariance, `dictionary' * X`.

algorithm : {'lasso_lars', 'lasso_cd', 'lars', 'omp', 'threshold'}, \
        default='lasso_lars'
    The algorithm used:

    * `'lars'`: uses the least angle regression method
      (`linear_model.lars_path`);
    * `'lasso_lars'`: uses Lars to compute the Lasso solution;
    * `'lasso_cd'`: uses the coordinate descent method to compute the
      Lasso solution (`linear_model.Lasso`). lasso_lars will be faster if
      the estimated components are sparse;
    * `'omp'`: uses orthogonal matching pursuit to estimate the sparse
      solution;
    * `'threshold'`: squashes to zero all coefficients less than
      regularization from the projection `dictionary * data'`.

n_nonzero_coefs : int, default=None
    Number of nonzero coefficients to target in each column of the
    solution. This is only used by `algorithm='lars'` and `algorithm='omp'`
    and is overridden by `alpha` in the `omp` case. If `None`, then
    `n_nonzero_coefs=int(n_features / 10)`.

alpha : float, default=None
    If `algorithm='lasso_lars'` or `algorithm='lasso_cd'`, `alpha` is the
    penalty applied to the L1 norm.
    If `algorithm='threshold'`, `alpha` is the absolute value of the
    threshold below which coefficients will be squashed to zero.
    If `algorithm='omp'`, `alpha` is the tolerance parameter: the value of
    the reconstruction error targeted. In this case, it overrides
    `n_nonzero_coefs`.
    If `None`, default to 1.

copy_cov : bool, default=True
    Whether to copy the precomputed covariance matrix; if `False`, it may
    be overwritten.

init : ndarray of shape (n_samples, n_components), default=None
    Initialization value of the sparse codes. Only used if
    `algorithm='lasso_cd'`.

max_iter : int, default=1000
    Maximum number of iterations to perform if `algorithm='lasso_cd'` or
    `'lasso_lars'`.

n_jobs : int, default=None
    Number of parallel jobs to run.
    ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.
    ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`
    for more details.

check_input : bool, default=True
    If `False`, the input arrays X and dictionary will not be checked.

verbose : int, default=0
    Controls the verbosity; the higher, the more messages.

positive : bool, default=False
    Whether to enforce positivity when finding the encoding.

    .. versionadded:: 0.20

Returns
-------
code : ndarray of shape (n_samples, n_components)
    The sparse codes.

See Also
--------
sklearn.linear_model.lars_path : Compute Least Angle Regression or Lasso
    path using LARS algorithm.
sklearn.linear_model.orthogonal_mp : Solves Orthogonal Matching Pursuit problems.
sklearn.linear_model.Lasso : Train Linear Model with L1 prior as regularizer.
SparseCoder : Find a sparse representation of data from a fixed precomputed
    dictionary.
</pre> <div class="fragment"><div class="line"><span class="lineno">  241</span>):</div>
<div class="line"><span class="lineno">  242</span>    <span class="stringliteral">&quot;&quot;&quot;Sparse coding.</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    Each row of the result is the solution to a sparse coding problem.</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    The goal is to find a sparse array `code` such that::</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">        X ~= code * dictionary</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    Read more in the :ref:`User Guide &lt;SparseCoder&gt;`.</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    X : ndarray of shape (n_samples, n_features)</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">        Data matrix.</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    dictionary : ndarray of shape (n_components, n_features)</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">        The dictionary matrix against which to solve the sparse coding of</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">        the data. Some of the algorithms assume normalized rows for meaningful</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">        output.</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    gram : ndarray of shape (n_components, n_components), default=None</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">        Precomputed Gram matrix, `dictionary * dictionary&#39;`.</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    cov : ndarray of shape (n_components, n_samples), default=None</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">        Precomputed covariance, `dictionary&#39; * X`.</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    algorithm : {&#39;lasso_lars&#39;, &#39;lasso_cd&#39;, &#39;lars&#39;, &#39;omp&#39;, &#39;threshold&#39;}, \</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">            default=&#39;lasso_lars&#39;</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">        The algorithm used:</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">        * `&#39;lars&#39;`: uses the least angle regression method</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">          (`linear_model.lars_path`);</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">        * `&#39;lasso_lars&#39;`: uses Lars to compute the Lasso solution;</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">        * `&#39;lasso_cd&#39;`: uses the coordinate descent method to compute the</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">          Lasso solution (`linear_model.Lasso`). lasso_lars will be faster if</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">          the estimated components are sparse;</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">        * `&#39;omp&#39;`: uses orthogonal matching pursuit to estimate the sparse</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">          solution;</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">        * `&#39;threshold&#39;`: squashes to zero all coefficients less than</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">          regularization from the projection `dictionary * data&#39;`.</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    n_nonzero_coefs : int, default=None</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">        Number of nonzero coefficients to target in each column of the</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">        solution. This is only used by `algorithm=&#39;lars&#39;` and `algorithm=&#39;omp&#39;`</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">        and is overridden by `alpha` in the `omp` case. If `None`, then</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">        `n_nonzero_coefs=int(n_features / 10)`.</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">    alpha : float, default=None</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">        If `algorithm=&#39;lasso_lars&#39;` or `algorithm=&#39;lasso_cd&#39;`, `alpha` is the</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">        penalty applied to the L1 norm.</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">        If `algorithm=&#39;threshold&#39;`, `alpha` is the absolute value of the</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">        threshold below which coefficients will be squashed to zero.</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">        If `algorithm=&#39;omp&#39;`, `alpha` is the tolerance parameter: the value of</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">        the reconstruction error targeted. In this case, it overrides</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">        `n_nonzero_coefs`.</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">        If `None`, default to 1.</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">    copy_cov : bool, default=True</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">        Whether to copy the precomputed covariance matrix; if `False`, it may</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">        be overwritten.</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">    init : ndarray of shape (n_samples, n_components), default=None</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">        Initialization value of the sparse codes. Only used if</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        `algorithm=&#39;lasso_cd&#39;`.</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">    max_iter : int, default=1000</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">        Maximum number of iterations to perform if `algorithm=&#39;lasso_cd&#39;` or</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">        `&#39;lasso_lars&#39;`.</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    n_jobs : int, default=None</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">        Number of parallel jobs to run.</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">        ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">        for more details.</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    check_input : bool, default=True</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">        If `False`, the input arrays X and dictionary will not be checked.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    verbose : int, default=0</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        Controls the verbosity; the higher, the more messages.</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">    positive : bool, default=False</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">        Whether to enforce positivity when finding the encoding.</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">        .. versionadded:: 0.20</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">    code : ndarray of shape (n_samples, n_components)</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">        The sparse codes.</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    sklearn.linear_model.lars_path : Compute Least Angle Regression or Lasso</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">        path using LARS algorithm.</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    sklearn.linear_model.orthogonal_mp : Solves Orthogonal Matching Pursuit problems.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    sklearn.linear_model.Lasso : Train Linear Model with L1 prior as regularizer.</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    SparseCoder : Find a sparse representation of data from a fixed precomputed</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">        dictionary.</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">if</span> check_input:</div>
<div class="line"><span class="lineno">  342</span>        <span class="keywordflow">if</span> algorithm == <span class="stringliteral">&quot;lasso_cd&quot;</span>:</div>
<div class="line"><span class="lineno">  343</span>            dictionary = check_array(</div>
<div class="line"><span class="lineno">  344</span>                dictionary, order=<span class="stringliteral">&quot;C&quot;</span>, dtype=[np.float64, np.float32]</div>
<div class="line"><span class="lineno">  345</span>            )</div>
<div class="line"><span class="lineno">  346</span>            X = check_array(X, order=<span class="stringliteral">&quot;C&quot;</span>, dtype=[np.float64, np.float32])</div>
<div class="line"><span class="lineno">  347</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  348</span>            dictionary = check_array(dictionary)</div>
<div class="line"><span class="lineno">  349</span>            X = check_array(X)</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    n_samples, n_features = X.shape</div>
<div class="line"><span class="lineno">  352</span>    n_components = dictionary.shape[0]</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">if</span> gram <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> algorithm != <span class="stringliteral">&quot;threshold&quot;</span>:</div>
<div class="line"><span class="lineno">  355</span>        gram = np.dot(dictionary, dictionary.T)</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordflow">if</span> cov <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> algorithm != <span class="stringliteral">&quot;lasso_cd&quot;</span>:</div>
<div class="line"><span class="lineno">  358</span>        copy_cov = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  359</span>        cov = np.dot(dictionary, X.T)</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">if</span> algorithm <span class="keywordflow">in</span> (<span class="stringliteral">&quot;lars&quot;</span>, <span class="stringliteral">&quot;omp&quot;</span>):</div>
<div class="line"><span class="lineno">  362</span>        regularization = n_nonzero_coefs</div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordflow">if</span> regularization <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  364</span>            regularization = min(max(n_features / 10, 1), n_components)</div>
<div class="line"><span class="lineno">  365</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  366</span>        regularization = alpha</div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordflow">if</span> regularization <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  368</span>            regularization = 1.0</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> effective_n_jobs(n_jobs) == 1 <span class="keywordflow">or</span> algorithm == <span class="stringliteral">&quot;threshold&quot;</span>:</div>
<div class="line"><span class="lineno">  371</span>        code = _sparse_encode(</div>
<div class="line"><span class="lineno">  372</span>            X,</div>
<div class="line"><span class="lineno">  373</span>            dictionary,</div>
<div class="line"><span class="lineno">  374</span>            gram,</div>
<div class="line"><span class="lineno">  375</span>            cov=cov,</div>
<div class="line"><span class="lineno">  376</span>            algorithm=algorithm,</div>
<div class="line"><span class="lineno">  377</span>            regularization=regularization,</div>
<div class="line"><span class="lineno">  378</span>            copy_cov=copy_cov,</div>
<div class="line"><span class="lineno">  379</span>            init=init,</div>
<div class="line"><span class="lineno">  380</span>            max_iter=max_iter,</div>
<div class="line"><span class="lineno">  381</span>            check_input=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  382</span>            verbose=verbose,</div>
<div class="line"><span class="lineno">  383</span>            positive=positive,</div>
<div class="line"><span class="lineno">  384</span>        )</div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">return</span> code</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    <span class="comment"># Enter parallel code block</span></div>
<div class="line"><span class="lineno">  388</span>    code = np.empty((n_samples, n_components))</div>
<div class="line"><span class="lineno">  389</span>    slices = list(gen_even_slices(n_samples, effective_n_jobs(n_jobs)))</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>    code_views = Parallel(n_jobs=n_jobs, verbose=verbose)(</div>
<div class="line"><span class="lineno">  392</span>        delayed(_sparse_encode)(</div>
<div class="line"><span class="lineno">  393</span>            X[this_slice],</div>
<div class="line"><span class="lineno">  394</span>            dictionary,</div>
<div class="line"><span class="lineno">  395</span>            gram,</div>
<div class="line"><span class="lineno">  396</span>            cov[:, this_slice] <span class="keywordflow">if</span> cov <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  397</span>            algorithm,</div>
<div class="line"><span class="lineno">  398</span>            regularization=regularization,</div>
<div class="line"><span class="lineno">  399</span>            copy_cov=copy_cov,</div>
<div class="line"><span class="lineno">  400</span>            init=init[this_slice] <span class="keywordflow">if</span> init <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  401</span>            max_iter=max_iter,</div>
<div class="line"><span class="lineno">  402</span>            check_input=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  403</span>            verbose=verbose,</div>
<div class="line"><span class="lineno">  404</span>            positive=positive,</div>
<div class="line"><span class="lineno">  405</span>        )</div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">for</span> this_slice <span class="keywordflow">in</span> slices</div>
<div class="line"><span class="lineno">  407</span>    )</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordflow">for</span> this_slice, this_view <span class="keywordflow">in</span> zip(slices, code_views):</div>
<div class="line"><span class="lineno">  409</span>        code[this_slice] = this_view</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">return</span> code</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
