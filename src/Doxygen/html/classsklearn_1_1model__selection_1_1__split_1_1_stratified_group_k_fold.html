<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.model_selection._split.StratifiedGroupKFold Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1model__selection.html">model_selection</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1model__selection_1_1__split.html">_split</a></li><li class="navelem"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_stratified_group_k_fold.html">StratifiedGroupKFold</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classsklearn_1_1model__selection_1_1__split_1_1_stratified_group_k_fold-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">sklearn.model_selection._split.StratifiedGroupKFold Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for sklearn.model_selection._split.StratifiedGroupKFold:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classsklearn_1_1model__selection_1_1__split_1_1_stratified_group_k_fold.png" usemap="#sklearn.model_5Fselection._5Fsplit.StratifiedGroupKFold_map" alt=""/>
  <map id="sklearn.model_5Fselection._5Fsplit.StratifiedGroupKFold_map" name="sklearn.model_5Fselection._5Fsplit.StratifiedGroupKFold_map">
<area href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html" alt="sklearn.model_selection._split._BaseKFold" shape="rect" coords="468,112,770,136"/>
<area href="classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator.html" alt="sklearn.model_selection._split.BaseCrossValidator" shape="rect" coords="156,56,458,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afb6491161a6645270eaf19227167df33" id="r_afb6491161a6645270eaf19227167df33"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_stratified_group_k_fold.html#afb6491161a6645270eaf19227167df33">__init__</a> (self, <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_stratified_group_k_fold.html#aba9783a86a39f998296267771317ed1e">n_splits</a>=5, <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html#a53396d1c2501e0bd915b5453d4abcdfa">shuffle</a>=False, <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html#a6ce1095444349bde5eeba4aa66932905">random_state</a>=None)</td></tr>
<tr class="separator:afb6491161a6645270eaf19227167df33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html">sklearn.model_selection._split._BaseKFold</a></td></tr>
<tr class="memitem:a46fe1172d77c54b0680a380afa362301 inherit pub_methods_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold" id="r_a46fe1172d77c54b0680a380afa362301"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html#a46fe1172d77c54b0680a380afa362301">split</a> (self, X, y=None, groups=None)</td></tr>
<tr class="separator:a46fe1172d77c54b0680a380afa362301 inherit pub_methods_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b06e6e270e1808e9ccbf2ff504fc5c1 inherit pub_methods_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold" id="r_a3b06e6e270e1808e9ccbf2ff504fc5c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html#a3b06e6e270e1808e9ccbf2ff504fc5c1">get_n_splits</a> (self, X=None, y=None, groups=None)</td></tr>
<tr class="separator:a3b06e6e270e1808e9ccbf2ff504fc5c1 inherit pub_methods_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator.html">sklearn.model_selection._split.BaseCrossValidator</a></td></tr>
<tr class="memitem:aa2ace774111187e05e744716df71b61f inherit pub_methods_classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator" id="r_aa2ace774111187e05e744716df71b61f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator.html#aa2ace774111187e05e744716df71b61f">__repr__</a> (self)</td></tr>
<tr class="separator:aa2ace774111187e05e744716df71b61f inherit pub_methods_classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:aba9783a86a39f998296267771317ed1e" id="r_aba9783a86a39f998296267771317ed1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_stratified_group_k_fold.html#aba9783a86a39f998296267771317ed1e">n_splits</a></td></tr>
<tr class="separator:aba9783a86a39f998296267771317ed1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html">sklearn.model_selection._split._BaseKFold</a></td></tr>
<tr class="memitem:ac2e1b3a55b21df4cf574d8ffb9cb61bc inherit pub_attribs_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold" id="r_ac2e1b3a55b21df4cf574d8ffb9cb61bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html#ac2e1b3a55b21df4cf574d8ffb9cb61bc">n_splits</a></td></tr>
<tr class="separator:ac2e1b3a55b21df4cf574d8ffb9cb61bc inherit pub_attribs_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53396d1c2501e0bd915b5453d4abcdfa inherit pub_attribs_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold" id="r_a53396d1c2501e0bd915b5453d4abcdfa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html#a53396d1c2501e0bd915b5453d4abcdfa">shuffle</a></td></tr>
<tr class="separator:a53396d1c2501e0bd915b5453d4abcdfa inherit pub_attribs_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ce1095444349bde5eeba4aa66932905 inherit pub_attribs_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold" id="r_a6ce1095444349bde5eeba4aa66932905"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html#a6ce1095444349bde5eeba4aa66932905">random_state</a></td></tr>
<tr class="separator:a6ce1095444349bde5eeba4aa66932905 inherit pub_attribs_classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ae1dc301f58eb0b394b55f3fbb3cfd4fe" id="r_ae1dc301f58eb0b394b55f3fbb3cfd4fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_stratified_group_k_fold.html#ae1dc301f58eb0b394b55f3fbb3cfd4fe">_iter_test_indices</a> (self, X, y, groups)</td></tr>
<tr class="separator:ae1dc301f58eb0b394b55f3fbb3cfd4fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a962482ea2a426369915fc053c041619d" id="r_a962482ea2a426369915fc053c041619d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_stratified_group_k_fold.html#a962482ea2a426369915fc053c041619d">_find_best_fold</a> (self, y_counts_per_fold, y_cnt, group_y_counts)</td></tr>
<tr class="separator:a962482ea2a426369915fc053c041619d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator.html">sklearn.model_selection._split.BaseCrossValidator</a></td></tr>
<tr class="memitem:af04eeac18402b2ac5c5d7a81bc179908 inherit pro_methods_classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator" id="r_af04eeac18402b2ac5c5d7a81bc179908"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator.html#af04eeac18402b2ac5c5d7a81bc179908">_iter_test_masks</a> (self, X=None, y=None, groups=None)</td></tr>
<tr class="separator:af04eeac18402b2ac5c5d7a81bc179908 inherit pro_methods_classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Stratified K-Folds iterator variant with non-overlapping groups.

This cross-validation object is a variation of StratifiedKFold attempts to
return stratified folds with non-overlapping groups. The folds are made by
preserving the percentage of samples for each class.

Each group will appear exactly once in the test set across all folds (the
number of distinct groups has to be at least equal to the number of folds).

The difference between :class:`~sklearn.model_selection.GroupKFold`
and :class:`~sklearn.model_selection.StratifiedGroupKFold` is that
the former attempts to create balanced folds such that the number of
distinct groups is approximately the same in each fold, whereas
StratifiedGroupKFold attempts to create folds which preserve the
percentage of samples for each class as much as possible given the
constraint of non-overlapping groups between splits.

Read more in the :ref:`User Guide &lt;cross_validation&gt;`.

Parameters
----------
n_splits : int, default=5
    Number of folds. Must be at least 2.

shuffle : bool, default=False
    Whether to shuffle each class's samples before splitting into batches.
    Note that the samples within each split will not be shuffled.
    This implementation can only shuffle groups that have approximately the
    same y distribution, no global shuffle will be performed.

random_state : int or RandomState instance, default=None
    When `shuffle` is True, `random_state` affects the ordering of the
    indices, which controls the randomness of each fold for each class.
    Otherwise, leave `random_state` as `None`.
    Pass an int for reproducible output across multiple function calls.
    See :term:`Glossary &lt;random_state&gt;`.

Examples
--------
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.model_selection import StratifiedGroupKFold
&gt;&gt;&gt; X = np.ones((17, 2))
&gt;&gt;&gt; y = np.array([0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0])
&gt;&gt;&gt; groups = np.array([1, 1, 2, 2, 3, 3, 3, 4, 5, 5, 5, 5, 6, 6, 7, 8, 8])
&gt;&gt;&gt; sgkf = StratifiedGroupKFold(n_splits=3)
&gt;&gt;&gt; sgkf.get_n_splits(X, y)
3
&gt;&gt;&gt; print(sgkf)
StratifiedGroupKFold(n_splits=3, random_state=None, shuffle=False)
&gt;&gt;&gt; for i, (train_index, test_index) in enumerate(sgkf.split(X, y, groups)):
...     print(f"Fold {i}:")
...     print(f"  Train: index={train_index}")
...     print(f"         group={groups[train_index]}")
...     print(f"  Test:  index={test_index}")
...     print(f"         group={groups[test_index]}")
Fold 0:
  Train: index=[ 0  1  2  3  7  8  9 10 11 15 16]
         group=[1 1 2 2 4 5 5 5 5 8 8]
  Test:  index=[ 4  5  6 12 13 14]
         group=[3 3 3 6 6 7]
Fold 1:
  Train: index=[ 4  5  6  7  8  9 10 11 12 13 14]
         group=[3 3 3 4 5 5 5 5 6 6 7]
  Test:  index=[ 0  1  2  3 15 16]
         group=[1 1 2 2 8 8]
Fold 2:
  Train: index=[ 0  1  2  3  4  5  6 12 13 14 15 16]
         group=[1 1 2 2 3 3 3 6 6 7 8 8]
  Test:  index=[ 7  8  9 10 11]
         group=[4 5 5 5 5]

Notes
-----
The implementation is designed to:

* Mimic the behavior of StratifiedKFold as much as possible for trivial
  groups (e.g. when each group contains only one sample).
* Be invariant to class label: relabelling ``y = ["Happy", "Sad"]`` to
  ``y = [1, 0]`` should not change the indices generated.
* Stratify based on samples as much as possible while keeping
  non-overlapping groups constraint. That means that in some cases when
  there is a small number of groups containing a large number of samples
  the stratification will not be possible and the behavior will be close
  to GroupKFold.

See also
--------
StratifiedKFold: Takes class information into account to build folds which
    retain class distributions (for binary or multiclass classification
    tasks).

GroupKFold: K-fold iterator variant with non-overlapping groups.
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afb6491161a6645270eaf19227167df33" name="afb6491161a6645270eaf19227167df33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb6491161a6645270eaf19227167df33">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection._split.StratifiedGroupKFold.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_splits</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shuffle</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1___base_k_fold.html#a7284065eea27c94a01a75a367156d4d2">sklearn.model_selection._split._BaseKFold</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  870</span>    <span class="keyword">def </span>__init__(self, n_splits=5, shuffle=False, random_state=None):</div>
<div class="line"><span class="lineno">  871</span>        super().__init__(n_splits=n_splits, shuffle=shuffle, random_state=random_state)</div>
<div class="line"><span class="lineno">  872</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a962482ea2a426369915fc053c041619d" name="a962482ea2a426369915fc053c041619d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a962482ea2a426369915fc053c041619d">&#9670;&#160;</a></span>_find_best_fold()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection._split.StratifiedGroupKFold._find_best_fold </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_counts_per_fold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_cnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>group_y_counts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  954</span>    <span class="keyword">def </span>_find_best_fold(self, y_counts_per_fold, y_cnt, group_y_counts):</div>
<div class="line"><span class="lineno">  955</span>        best_fold = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  956</span>        min_eval = np.inf</div>
<div class="line"><span class="lineno">  957</span>        min_samples_in_fold = np.inf</div>
<div class="line"><span class="lineno">  958</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.n_splits):</div>
<div class="line"><span class="lineno">  959</span>            y_counts_per_fold[i] += group_y_counts</div>
<div class="line"><span class="lineno">  960</span>            <span class="comment"># Summarise the distribution over classes in each proposed fold</span></div>
<div class="line"><span class="lineno">  961</span>            std_per_class = np.std(y_counts_per_fold / y_cnt.reshape(1, -1), axis=0)</div>
<div class="line"><span class="lineno">  962</span>            y_counts_per_fold[i] -= group_y_counts</div>
<div class="line"><span class="lineno">  963</span>            fold_eval = np.mean(std_per_class)</div>
<div class="line"><span class="lineno">  964</span>            samples_in_fold = np.sum(y_counts_per_fold[i])</div>
<div class="line"><span class="lineno">  965</span>            is_current_fold_better = (</div>
<div class="line"><span class="lineno">  966</span>                fold_eval &lt; min_eval</div>
<div class="line"><span class="lineno">  967</span>                <span class="keywordflow">or</span> np.isclose(fold_eval, min_eval)</div>
<div class="line"><span class="lineno">  968</span>                <span class="keywordflow">and</span> samples_in_fold &lt; min_samples_in_fold</div>
<div class="line"><span class="lineno">  969</span>            )</div>
<div class="line"><span class="lineno">  970</span>            <span class="keywordflow">if</span> is_current_fold_better:</div>
<div class="line"><span class="lineno">  971</span>                min_eval = fold_eval</div>
<div class="line"><span class="lineno">  972</span>                min_samples_in_fold = samples_in_fold</div>
<div class="line"><span class="lineno">  973</span>                best_fold = i</div>
<div class="line"><span class="lineno">  974</span>        <span class="keywordflow">return</span> best_fold</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1dc301f58eb0b394b55f3fbb3cfd4fe" name="ae1dc301f58eb0b394b55f3fbb3cfd4fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1dc301f58eb0b394b55f3fbb3cfd4fe">&#9670;&#160;</a></span>_iter_test_indices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection._split.StratifiedGroupKFold._iter_test_indices </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groups</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Generates integer indices corresponding to test sets.</pre> 
<p>Reimplemented from <a class="el" href="classsklearn_1_1model__selection_1_1__split_1_1_base_cross_validator.html#a377e0cc027afabdb1e5e4a04c6ad3ecb">sklearn.model_selection._split.BaseCrossValidator</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  873</span>    <span class="keyword">def </span>_iter_test_indices(self, X, y, groups):</div>
<div class="line"><span class="lineno">  874</span>        <span class="comment"># Implementation is based on this kaggle kernel:</span></div>
<div class="line"><span class="lineno">  875</span>        <span class="comment"># https://www.kaggle.com/jakubwasikowski/stratified-group-k-fold-cross-validation</span></div>
<div class="line"><span class="lineno">  876</span>        <span class="comment"># and is a subject to Apache 2.0 License. You may obtain a copy of the</span></div>
<div class="line"><span class="lineno">  877</span>        <span class="comment"># License at http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><span class="lineno">  878</span>        <span class="comment"># Changelist:</span></div>
<div class="line"><span class="lineno">  879</span>        <span class="comment"># - Refactored function to a class following scikit-learn KFold</span></div>
<div class="line"><span class="lineno">  880</span>        <span class="comment">#   interface.</span></div>
<div class="line"><span class="lineno">  881</span>        <span class="comment"># - Added heuristic for assigning group to the least populated fold in</span></div>
<div class="line"><span class="lineno">  882</span>        <span class="comment">#   cases when all other criteria are equal</span></div>
<div class="line"><span class="lineno">  883</span>        <span class="comment"># - Swtch from using python ``Counter`` to ``np.unique`` to get class</span></div>
<div class="line"><span class="lineno">  884</span>        <span class="comment">#   distribution</span></div>
<div class="line"><span class="lineno">  885</span>        <span class="comment"># - Added scikit-learn checks for input: checking that target is binary</span></div>
<div class="line"><span class="lineno">  886</span>        <span class="comment">#   or multiclass, checking passed random state, checking that number</span></div>
<div class="line"><span class="lineno">  887</span>        <span class="comment">#   of splits is less than number of members in each class, checking</span></div>
<div class="line"><span class="lineno">  888</span>        <span class="comment">#   that least populated class has more members than there are splits.</span></div>
<div class="line"><span class="lineno">  889</span>        rng = check_random_state(self.random_state)</div>
<div class="line"><span class="lineno">  890</span>        y = np.asarray(y)</div>
<div class="line"><span class="lineno">  891</span>        type_of_target_y = type_of_target(y)</div>
<div class="line"><span class="lineno">  892</span>        allowed_target_types = (<span class="stringliteral">&quot;binary&quot;</span>, <span class="stringliteral">&quot;multiclass&quot;</span>)</div>
<div class="line"><span class="lineno">  893</span>        <span class="keywordflow">if</span> type_of_target_y <span class="keywordflow">not</span> <span class="keywordflow">in</span> allowed_target_types:</div>
<div class="line"><span class="lineno">  894</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  895</span>                <span class="stringliteral">&quot;Supported target types are: {}. Got {!r} instead.&quot;</span>.format(</div>
<div class="line"><span class="lineno">  896</span>                    allowed_target_types, type_of_target_y</div>
<div class="line"><span class="lineno">  897</span>                )</div>
<div class="line"><span class="lineno">  898</span>            )</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>        y = column_or_1d(y)</div>
<div class="line"><span class="lineno">  901</span>        _, y_inv, y_cnt = np.unique(y, return_inverse=<span class="keyword">True</span>, return_counts=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  902</span>        <span class="keywordflow">if</span> np.all(self.n_splits &gt; y_cnt):</div>
<div class="line"><span class="lineno">  903</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  904</span>                <span class="stringliteral">&quot;n_splits=%d cannot be greater than the&quot;</span></div>
<div class="line"><span class="lineno">  905</span>                <span class="stringliteral">&quot; number of members in each class.&quot;</span> % (self.n_splits)</div>
<div class="line"><span class="lineno">  906</span>            )</div>
<div class="line"><span class="lineno">  907</span>        n_smallest_class = np.min(y_cnt)</div>
<div class="line"><span class="lineno">  908</span>        <span class="keywordflow">if</span> self.n_splits &gt; n_smallest_class:</div>
<div class="line"><span class="lineno">  909</span>            warnings.warn(</div>
<div class="line"><span class="lineno">  910</span>                <span class="stringliteral">&quot;The least populated class in y has only %d&quot;</span></div>
<div class="line"><span class="lineno">  911</span>                <span class="stringliteral">&quot; members, which is less than n_splits=%d.&quot;</span></div>
<div class="line"><span class="lineno">  912</span>                % (n_smallest_class, self.n_splits),</div>
<div class="line"><span class="lineno">  913</span>                UserWarning,</div>
<div class="line"><span class="lineno">  914</span>            )</div>
<div class="line"><span class="lineno">  915</span>        n_classes = len(y_cnt)</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>        _, groups_inv, groups_cnt = np.unique(</div>
<div class="line"><span class="lineno">  918</span>            groups, return_inverse=<span class="keyword">True</span>, return_counts=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">  919</span>        )</div>
<div class="line"><span class="lineno">  920</span>        y_counts_per_group = np.zeros((len(groups_cnt), n_classes))</div>
<div class="line"><span class="lineno">  921</span>        <span class="keywordflow">for</span> class_idx, group_idx <span class="keywordflow">in</span> zip(y_inv, groups_inv):</div>
<div class="line"><span class="lineno">  922</span>            y_counts_per_group[group_idx, class_idx] += 1</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>        y_counts_per_fold = np.zeros((self.n_splits, n_classes))</div>
<div class="line"><span class="lineno">  925</span>        groups_per_fold = defaultdict(set)</div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span>        <span class="keywordflow">if</span> self.shuffle:</div>
<div class="line"><span class="lineno">  928</span>            rng.shuffle(y_counts_per_group)</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span>        <span class="comment"># Stable sort to keep shuffled order for groups with the same</span></div>
<div class="line"><span class="lineno">  931</span>        <span class="comment"># class distribution variance</span></div>
<div class="line"><span class="lineno">  932</span>        sorted_groups_idx = np.argsort(</div>
<div class="line"><span class="lineno">  933</span>            -np.std(y_counts_per_group, axis=1), kind=<span class="stringliteral">&quot;mergesort&quot;</span></div>
<div class="line"><span class="lineno">  934</span>        )</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>        <span class="keywordflow">for</span> group_idx <span class="keywordflow">in</span> sorted_groups_idx:</div>
<div class="line"><span class="lineno">  937</span>            group_y_counts = y_counts_per_group[group_idx]</div>
<div class="line"><span class="lineno">  938</span>            best_fold = self._find_best_fold(</div>
<div class="line"><span class="lineno">  939</span>                y_counts_per_fold=y_counts_per_fold,</div>
<div class="line"><span class="lineno">  940</span>                y_cnt=y_cnt,</div>
<div class="line"><span class="lineno">  941</span>                group_y_counts=group_y_counts,</div>
<div class="line"><span class="lineno">  942</span>            )</div>
<div class="line"><span class="lineno">  943</span>            y_counts_per_fold[best_fold] += group_y_counts</div>
<div class="line"><span class="lineno">  944</span>            groups_per_fold[best_fold].add(group_idx)</div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.n_splits):</div>
<div class="line"><span class="lineno">  947</span>            test_indices = [</div>
<div class="line"><span class="lineno">  948</span>                idx</div>
<div class="line"><span class="lineno">  949</span>                <span class="keywordflow">for</span> idx, group_idx <span class="keywordflow">in</span> enumerate(groups_inv)</div>
<div class="line"><span class="lineno">  950</span>                <span class="keywordflow">if</span> group_idx <span class="keywordflow">in</span> groups_per_fold[i]</div>
<div class="line"><span class="lineno">  951</span>            ]</div>
<div class="line"><span class="lineno">  952</span>            <span class="keywordflow">yield</span> test_indices</div>
<div class="line"><span class="lineno">  953</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aba9783a86a39f998296267771317ed1e" name="aba9783a86a39f998296267771317ed1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba9783a86a39f998296267771317ed1e">&#9670;&#160;</a></span>n_splits</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection._split.StratifiedGroupKFold.n_splits</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/sklearn/model_selection/<a class="el" href="__split_8py.html">_split.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
