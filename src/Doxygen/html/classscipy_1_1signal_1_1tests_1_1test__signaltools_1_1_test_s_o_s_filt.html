<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.signal.tests.test_signaltools.TestSOSFilt Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1signal.html">signal</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1signal_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1signal_1_1tests_1_1test__signaltools.html">test_signaltools</a></li><li class="navelem"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt.html">TestSOSFilt</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scipy.signal.tests.test_signaltools.TestSOSFilt Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afc8b96e317e89c741c6e82e8e4465905" id="r_afc8b96e317e89c741c6e82e8e4465905"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt.html#afc8b96e317e89c741c6e82e8e4465905">test_rank1</a> (self, dt)</td></tr>
<tr class="separator:afc8b96e317e89c741c6e82e8e4465905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a800a35e21726bafe5764b80144ea400f" id="r_a800a35e21726bafe5764b80144ea400f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt.html#a800a35e21726bafe5764b80144ea400f">test_rank2</a> (self, dt)</td></tr>
<tr class="separator:a800a35e21726bafe5764b80144ea400f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8f77fa663f566c1e1917437f77bb83" id="r_a0d8f77fa663f566c1e1917437f77bb83"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt.html#a0d8f77fa663f566c1e1917437f77bb83">test_rank3</a> (self, dt)</td></tr>
<tr class="separator:a0d8f77fa663f566c1e1917437f77bb83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1ab0d2abf05f7e5fdf3e4418d71659" id="r_ade1ab0d2abf05f7e5fdf3e4418d71659"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt.html#ade1ab0d2abf05f7e5fdf3e4418d71659">test_initial_conditions</a> (self, dt)</td></tr>
<tr class="separator:ade1ab0d2abf05f7e5fdf3e4418d71659"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883abf62f8cd713d280e57d639ca9e38" id="r_a883abf62f8cd713d280e57d639ca9e38"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt.html#a883abf62f8cd713d280e57d639ca9e38">test_initial_conditions_3d_axis1</a> (self, dt)</td></tr>
<tr class="separator:a883abf62f8cd713d280e57d639ca9e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e92b4196296e0a9ced37d137e02fa55" id="r_a8e92b4196296e0a9ced37d137e02fa55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt.html#a8e92b4196296e0a9ced37d137e02fa55">test_bad_zi_shape</a> (self, dt)</td></tr>
<tr class="separator:a8e92b4196296e0a9ced37d137e02fa55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74bf90f2e8bb2f74445f1351c8e50e63" id="r_a74bf90f2e8bb2f74445f1351c8e50e63"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1tests_1_1test__signaltools_1_1_test_s_o_s_filt.html#a74bf90f2e8bb2f74445f1351c8e50e63">test_sosfilt_zi</a> (self, dt)</td></tr>
<tr class="separator:a74bf90f2e8bb2f74445f1351c8e50e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8e92b4196296e0a9ced37d137e02fa55" name="a8e92b4196296e0a9ced37d137e02fa55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e92b4196296e0a9ced37d137e02fa55">&#9670;&#160;</a></span>test_bad_zi_shape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_signaltools.TestSOSFilt.test_bad_zi_shape </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3427</span>    <span class="keyword">def </span>test_bad_zi_shape(self, dt):</div>
<div class="line"><span class="lineno"> 3428</span>        <span class="comment"># The shape of zi is checked before using any values in the</span></div>
<div class="line"><span class="lineno"> 3429</span>        <span class="comment"># arguments, so np.empty is fine for creating the arguments.</span></div>
<div class="line"><span class="lineno"> 3430</span>        x = np.empty((3, 15, 3), dt)</div>
<div class="line"><span class="lineno"> 3431</span>        sos = np.zeros((4, 6))</div>
<div class="line"><span class="lineno"> 3432</span>        zi = np.empty((4, 3, 3, 2))  <span class="comment"># Correct shape is (4, 3, 2, 3)</span></div>
<div class="line"><span class="lineno"> 3433</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&#39;should be all ones&#39;</span>):</div>
<div class="line"><span class="lineno"> 3434</span>            sosfilt(sos, x, zi=zi, axis=1)</div>
<div class="line"><span class="lineno"> 3435</span>        sos[:, 3] = 1.</div>
<div class="line"><span class="lineno"> 3436</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&#39;Invalid zi shape&#39;</span>):</div>
<div class="line"><span class="lineno"> 3437</span>            sosfilt(sos, x, zi=zi, axis=1)</div>
<div class="line"><span class="lineno"> 3438</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ade1ab0d2abf05f7e5fdf3e4418d71659" name="ade1ab0d2abf05f7e5fdf3e4418d71659"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade1ab0d2abf05f7e5fdf3e4418d71659">&#9670;&#160;</a></span>test_initial_conditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_signaltools.TestSOSFilt.test_initial_conditions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3343</span>    <span class="keyword">def </span>test_initial_conditions(self, dt):</div>
<div class="line"><span class="lineno"> 3344</span>        b1, a1 = signal.butter(2, 0.25, <span class="stringliteral">&#39;low&#39;</span>)</div>
<div class="line"><span class="lineno"> 3345</span>        b2, a2 = signal.butter(2, 0.75, <span class="stringliteral">&#39;low&#39;</span>)</div>
<div class="line"><span class="lineno"> 3346</span>        b3, a3 = signal.butter(2, 0.75, <span class="stringliteral">&#39;low&#39;</span>)</div>
<div class="line"><span class="lineno"> 3347</span>        b = np.convolve(np.convolve(b1, b2), b3)</div>
<div class="line"><span class="lineno"> 3348</span>        a = np.convolve(np.convolve(a1, a2), a3)</div>
<div class="line"><span class="lineno"> 3349</span>        sos = np.array((np.r_[b1, a1], np.r_[b2, a2], np.r_[b3, a3]))</div>
<div class="line"><span class="lineno"> 3350</span> </div>
<div class="line"><span class="lineno"> 3351</span>        x = np.random.rand(50).astype(dt)</div>
<div class="line"><span class="lineno"> 3352</span> </div>
<div class="line"><span class="lineno"> 3353</span>        <span class="comment"># Stopping filtering and continuing</span></div>
<div class="line"><span class="lineno"> 3354</span>        y_true, zi = lfilter(b, a, x[:20], zi=np.zeros(6))</div>
<div class="line"><span class="lineno"> 3355</span>        y_true = np.r_[y_true, lfilter(b, a, x[20:], zi=zi)[0]]</div>
<div class="line"><span class="lineno"> 3356</span>        assert_allclose_cast(y_true, lfilter(b, a, x))</div>
<div class="line"><span class="lineno"> 3357</span> </div>
<div class="line"><span class="lineno"> 3358</span>        y_sos, zi = sosfilt(sos, x[:20], zi=np.zeros((3, 2)))</div>
<div class="line"><span class="lineno"> 3359</span>        y_sos = np.r_[y_sos, sosfilt(sos, x[20:], zi=zi)[0]]</div>
<div class="line"><span class="lineno"> 3360</span>        assert_allclose_cast(y_true, y_sos)</div>
<div class="line"><span class="lineno"> 3361</span> </div>
<div class="line"><span class="lineno"> 3362</span>        <span class="comment"># Use a step function</span></div>
<div class="line"><span class="lineno"> 3363</span>        zi = sosfilt_zi(sos)</div>
<div class="line"><span class="lineno"> 3364</span>        x = np.ones(8, dt)</div>
<div class="line"><span class="lineno"> 3365</span>        y, zf = sosfilt(sos, x, zi=zi)</div>
<div class="line"><span class="lineno"> 3366</span> </div>
<div class="line"><span class="lineno"> 3367</span>        assert_allclose_cast(y, np.ones(8))</div>
<div class="line"><span class="lineno"> 3368</span>        assert_allclose_cast(zf, zi)</div>
<div class="line"><span class="lineno"> 3369</span> </div>
<div class="line"><span class="lineno"> 3370</span>        <span class="comment"># Initial condition shape matching</span></div>
<div class="line"><span class="lineno"> 3371</span>        x.shape = (1, 1) + x.shape  <span class="comment"># 3D</span></div>
<div class="line"><span class="lineno"> 3372</span>        assert_raises(ValueError, sosfilt, sos, x, zi=zi)</div>
<div class="line"><span class="lineno"> 3373</span>        zi_nd = zi.copy()</div>
<div class="line"><span class="lineno"> 3374</span>        zi_nd.shape = (zi.shape[0], 1, 1, zi.shape[-1])</div>
<div class="line"><span class="lineno"> 3375</span>        assert_raises(ValueError, sosfilt, sos, x,</div>
<div class="line"><span class="lineno"> 3376</span>                      zi=zi_nd[:, :, :, [0, 1, 1]])</div>
<div class="line"><span class="lineno"> 3377</span>        y, zf = sosfilt(sos, x, zi=zi_nd)</div>
<div class="line"><span class="lineno"> 3378</span>        assert_allclose_cast(y[0, 0], np.ones(8))</div>
<div class="line"><span class="lineno"> 3379</span>        assert_allclose_cast(zf[:, 0, 0, :], zi)</div>
<div class="line"><span class="lineno"> 3380</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a883abf62f8cd713d280e57d639ca9e38" name="a883abf62f8cd713d280e57d639ca9e38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883abf62f8cd713d280e57d639ca9e38">&#9670;&#160;</a></span>test_initial_conditions_3d_axis1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_signaltools.TestSOSFilt.test_initial_conditions_3d_axis1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3381</span>    <span class="keyword">def </span>test_initial_conditions_3d_axis1(self, dt):</div>
<div class="line"><span class="lineno"> 3382</span>        <span class="comment"># Test the use of zi when sosfilt is applied to axis 1 of a 3-d input.</span></div>
<div class="line"><span class="lineno"> 3383</span> </div>
<div class="line"><span class="lineno"> 3384</span>        <span class="comment"># Input array is x.</span></div>
<div class="line"><span class="lineno"> 3385</span>        x = np.random.RandomState(159).randint(0, 5, size=(2, 15, 3))</div>
<div class="line"><span class="lineno"> 3386</span>        x = x.astype(dt)</div>
<div class="line"><span class="lineno"> 3387</span> </div>
<div class="line"><span class="lineno"> 3388</span>        <span class="comment"># Design a filter in ZPK format and convert to SOS</span></div>
<div class="line"><span class="lineno"> 3389</span>        zpk = signal.butter(6, 0.35, output=<span class="stringliteral">&#39;zpk&#39;</span>)</div>
<div class="line"><span class="lineno"> 3390</span>        sos = zpk2sos(*zpk)</div>
<div class="line"><span class="lineno"> 3391</span>        nsections = sos.shape[0]</div>
<div class="line"><span class="lineno"> 3392</span> </div>
<div class="line"><span class="lineno"> 3393</span>        <span class="comment"># Filter along this axis.</span></div>
<div class="line"><span class="lineno"> 3394</span>        axis = 1</div>
<div class="line"><span class="lineno"> 3395</span> </div>
<div class="line"><span class="lineno"> 3396</span>        <span class="comment"># Initial conditions, all zeros.</span></div>
<div class="line"><span class="lineno"> 3397</span>        shp = list(x.shape)</div>
<div class="line"><span class="lineno"> 3398</span>        shp[axis] = 2</div>
<div class="line"><span class="lineno"> 3399</span>        shp = [nsections] + shp</div>
<div class="line"><span class="lineno"> 3400</span>        z0 = np.zeros(shp)</div>
<div class="line"><span class="lineno"> 3401</span> </div>
<div class="line"><span class="lineno"> 3402</span>        <span class="comment"># Apply the filter to x.</span></div>
<div class="line"><span class="lineno"> 3403</span>        yf, zf = sosfilt(sos, x, axis=axis, zi=z0)</div>
<div class="line"><span class="lineno"> 3404</span> </div>
<div class="line"><span class="lineno"> 3405</span>        <span class="comment"># Apply the filter to x in two stages.</span></div>
<div class="line"><span class="lineno"> 3406</span>        y1, z1 = sosfilt(sos, x[:, :5, :], axis=axis, zi=z0)</div>
<div class="line"><span class="lineno"> 3407</span>        y2, z2 = sosfilt(sos, x[:, 5:, :], axis=axis, zi=z1)</div>
<div class="line"><span class="lineno"> 3408</span> </div>
<div class="line"><span class="lineno"> 3409</span>        <span class="comment"># y should equal yf, and z2 should equal zf.</span></div>
<div class="line"><span class="lineno"> 3410</span>        y = np.concatenate((y1, y2), axis=axis)</div>
<div class="line"><span class="lineno"> 3411</span>        assert_allclose_cast(y, yf, rtol=1e-10, atol=1e-13)</div>
<div class="line"><span class="lineno"> 3412</span>        assert_allclose_cast(z2, zf, rtol=1e-10, atol=1e-13)</div>
<div class="line"><span class="lineno"> 3413</span> </div>
<div class="line"><span class="lineno"> 3414</span>        <span class="comment"># let&#39;s try the &quot;step&quot; initial condition</span></div>
<div class="line"><span class="lineno"> 3415</span>        zi = sosfilt_zi(sos)</div>
<div class="line"><span class="lineno"> 3416</span>        zi.shape = [nsections, 1, 2, 1]</div>
<div class="line"><span class="lineno"> 3417</span>        zi = zi * x[:, 0:1, :]</div>
<div class="line"><span class="lineno"> 3418</span>        y = sosfilt(sos, x, axis=axis, zi=zi)[0]</div>
<div class="line"><span class="lineno"> 3419</span>        <span class="comment"># check it against the TF form</span></div>
<div class="line"><span class="lineno"> 3420</span>        b, a = zpk2tf(*zpk)</div>
<div class="line"><span class="lineno"> 3421</span>        zi = lfilter_zi(b, a)</div>
<div class="line"><span class="lineno"> 3422</span>        zi.shape = [1, zi.size, 1]</div>
<div class="line"><span class="lineno"> 3423</span>        zi = zi * x[:, 0:1, :]</div>
<div class="line"><span class="lineno"> 3424</span>        y_tf = lfilter(b, a, x, axis=axis, zi=zi)[0]</div>
<div class="line"><span class="lineno"> 3425</span>        assert_allclose_cast(y, y_tf, rtol=1e-10, atol=1e-13)</div>
<div class="line"><span class="lineno"> 3426</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afc8b96e317e89c741c6e82e8e4465905" name="afc8b96e317e89c741c6e82e8e4465905"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc8b96e317e89c741c6e82e8e4465905">&#9670;&#160;</a></span>test_rank1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_signaltools.TestSOSFilt.test_rank1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3285</span>    <span class="keyword">def </span>test_rank1(self, dt):</div>
<div class="line"><span class="lineno"> 3286</span>        x = np.linspace(0, 5, 6).astype(dt)</div>
<div class="line"><span class="lineno"> 3287</span>        b = np.array([1, -1]).astype(dt)</div>
<div class="line"><span class="lineno"> 3288</span>        a = np.array([0.5, -0.5]).astype(dt)</div>
<div class="line"><span class="lineno"> 3289</span> </div>
<div class="line"><span class="lineno"> 3290</span>        <span class="comment"># Test simple IIR</span></div>
<div class="line"><span class="lineno"> 3291</span>        y_r = np.array([0, 2, 4, 6, 8, 10.]).astype(dt)</div>
<div class="line"><span class="lineno"> 3292</span>        sos = cast_tf2sos(b, a)</div>
<div class="line"><span class="lineno"> 3293</span>        assert_array_almost_equal(sosfilt(cast_tf2sos(b, a), x), y_r)</div>
<div class="line"><span class="lineno"> 3294</span> </div>
<div class="line"><span class="lineno"> 3295</span>        <span class="comment"># Test simple FIR</span></div>
<div class="line"><span class="lineno"> 3296</span>        b = np.array([1, 1]).astype(dt)</div>
<div class="line"><span class="lineno"> 3297</span>        <span class="comment"># NOTE: This was changed (rel. to TestLinear...) to add a pole @zero:</span></div>
<div class="line"><span class="lineno"> 3298</span>        a = np.array([1, 0]).astype(dt)</div>
<div class="line"><span class="lineno"> 3299</span>        y_r = np.array([0, 1, 3, 5, 7, 9.]).astype(dt)</div>
<div class="line"><span class="lineno"> 3300</span>        assert_array_almost_equal(sosfilt(cast_tf2sos(b, a), x), y_r)</div>
<div class="line"><span class="lineno"> 3301</span> </div>
<div class="line"><span class="lineno"> 3302</span>        b = [1, 1, 0]</div>
<div class="line"><span class="lineno"> 3303</span>        a = [1, 0, 0]</div>
<div class="line"><span class="lineno"> 3304</span>        x = np.ones(8)</div>
<div class="line"><span class="lineno"> 3305</span>        sos = np.concatenate((b, a))</div>
<div class="line"><span class="lineno"> 3306</span>        sos.shape = (1, 6)</div>
<div class="line"><span class="lineno"> 3307</span>        y = sosfilt(sos, x)</div>
<div class="line"><span class="lineno"> 3308</span>        assert_allclose(y, [1, 2, 2, 2, 2, 2, 2, 2])</div>
<div class="line"><span class="lineno"> 3309</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a800a35e21726bafe5764b80144ea400f" name="a800a35e21726bafe5764b80144ea400f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a800a35e21726bafe5764b80144ea400f">&#9670;&#160;</a></span>test_rank2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_signaltools.TestSOSFilt.test_rank2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3310</span>    <span class="keyword">def </span>test_rank2(self, dt):</div>
<div class="line"><span class="lineno"> 3311</span>        shape = (4, 3)</div>
<div class="line"><span class="lineno"> 3312</span>        x = np.linspace(0, np.prod(shape) - 1, np.prod(shape)).reshape(shape)</div>
<div class="line"><span class="lineno"> 3313</span>        x = x.astype(dt)</div>
<div class="line"><span class="lineno"> 3314</span> </div>
<div class="line"><span class="lineno"> 3315</span>        b = np.array([1, -1]).astype(dt)</div>
<div class="line"><span class="lineno"> 3316</span>        a = np.array([0.5, 0.5]).astype(dt)</div>
<div class="line"><span class="lineno"> 3317</span> </div>
<div class="line"><span class="lineno"> 3318</span>        y_r2_a0 = np.array([[0, 2, 4], [6, 4, 2], [0, 2, 4], [6, 4, 2]],</div>
<div class="line"><span class="lineno"> 3319</span>                           dtype=dt)</div>
<div class="line"><span class="lineno"> 3320</span> </div>
<div class="line"><span class="lineno"> 3321</span>        y_r2_a1 = np.array([[0, 2, 0], [6, -4, 6], [12, -10, 12],</div>
<div class="line"><span class="lineno"> 3322</span>                            [18, -16, 18]], dtype=dt)</div>
<div class="line"><span class="lineno"> 3323</span> </div>
<div class="line"><span class="lineno"> 3324</span>        y = sosfilt(cast_tf2sos(b, a), x, axis=0)</div>
<div class="line"><span class="lineno"> 3325</span>        assert_array_almost_equal(y_r2_a0, y)</div>
<div class="line"><span class="lineno"> 3326</span> </div>
<div class="line"><span class="lineno"> 3327</span>        y = sosfilt(cast_tf2sos(b, a), x, axis=1)</div>
<div class="line"><span class="lineno"> 3328</span>        assert_array_almost_equal(y_r2_a1, y)</div>
<div class="line"><span class="lineno"> 3329</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d8f77fa663f566c1e1917437f77bb83" name="a0d8f77fa663f566c1e1917437f77bb83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d8f77fa663f566c1e1917437f77bb83">&#9670;&#160;</a></span>test_rank3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_signaltools.TestSOSFilt.test_rank3 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3330</span>    <span class="keyword">def </span>test_rank3(self, dt):</div>
<div class="line"><span class="lineno"> 3331</span>        shape = (4, 3, 2)</div>
<div class="line"><span class="lineno"> 3332</span>        x = np.linspace(0, np.prod(shape) - 1, np.prod(shape)).reshape(shape)</div>
<div class="line"><span class="lineno"> 3333</span> </div>
<div class="line"><span class="lineno"> 3334</span>        b = np.array([1, -1]).astype(dt)</div>
<div class="line"><span class="lineno"> 3335</span>        a = np.array([0.5, 0.5]).astype(dt)</div>
<div class="line"><span class="lineno"> 3336</span> </div>
<div class="line"><span class="lineno"> 3337</span>        <span class="comment"># Test last axis</span></div>
<div class="line"><span class="lineno"> 3338</span>        y = sosfilt(cast_tf2sos(b, a), x)</div>
<div class="line"><span class="lineno"> 3339</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(x.shape[0]):</div>
<div class="line"><span class="lineno"> 3340</span>            <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(x.shape[1]):</div>
<div class="line"><span class="lineno"> 3341</span>                assert_array_almost_equal(y[i, j], lfilter(b, a, x[i, j]))</div>
<div class="line"><span class="lineno"> 3342</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a74bf90f2e8bb2f74445f1351c8e50e63" name="a74bf90f2e8bb2f74445f1351c8e50e63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74bf90f2e8bb2f74445f1351c8e50e63">&#9670;&#160;</a></span>test_sosfilt_zi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal.tests.test_signaltools.TestSOSFilt.test_sosfilt_zi </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3439</span>    <span class="keyword">def </span>test_sosfilt_zi(self, dt):</div>
<div class="line"><span class="lineno"> 3440</span>        sos = signal.butter(6, 0.2, output=<span class="stringliteral">&#39;sos&#39;</span>)</div>
<div class="line"><span class="lineno"> 3441</span>        zi = sosfilt_zi(sos)</div>
<div class="line"><span class="lineno"> 3442</span> </div>
<div class="line"><span class="lineno"> 3443</span>        y, zf = sosfilt(sos, np.ones(40, dt), zi=zi)</div>
<div class="line"><span class="lineno"> 3444</span>        assert_allclose_cast(zf, zi, rtol=1e-13)</div>
<div class="line"><span class="lineno"> 3445</span> </div>
<div class="line"><span class="lineno"> 3446</span>        <span class="comment"># Expected steady state value of the step response of this filter:</span></div>
<div class="line"><span class="lineno"> 3447</span>        ss = np.prod(sos[:, :3].sum(axis=-1) / sos[:, 3:].sum(axis=-1))</div>
<div class="line"><span class="lineno"> 3448</span>        assert_allclose_cast(y, ss, rtol=1e-13)</div>
<div class="line"><span class="lineno"> 3449</span> </div>
<div class="line"><span class="lineno"> 3450</span>        <span class="comment"># zi as array-like</span></div>
<div class="line"><span class="lineno"> 3451</span>        _, zf = sosfilt(sos, np.ones(40, dt), zi=zi.tolist())</div>
<div class="line"><span class="lineno"> 3452</span>        assert_allclose_cast(zf, zi, rtol=1e-13)</div>
<div class="line"><span class="lineno"> 3453</span> </div>
<div class="line"><span class="lineno"> 3454</span> </div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/scipy/signal/tests/<a class="el" href="test__signaltools_8py.html">test_signaltools.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
