<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.stats._page_trend_test Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1__page__trend__test.html">_page_trend_test</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats._page_trend_test Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__page__trend__test_1_1___page_l.html">_PageL</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9625b7377856497ffe0c17b6cf9335ae" id="r_a9625b7377856497ffe0c17b6cf9335ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__page__trend__test.html#a9625b7377856497ffe0c17b6cf9335ae">page_trend_test</a> (data, ranked=False, predicted_ranks=None, <a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>='auto')</td></tr>
<tr class="separator:a9625b7377856497ffe0c17b6cf9335ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cdbebd3b6974884f629744928a02430" id="r_a7cdbebd3b6974884f629744928a02430"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__page__trend__test.html#a7cdbebd3b6974884f629744928a02430">_choose_method</a> (ranks)</td></tr>
<tr class="separator:a7cdbebd3b6974884f629744928a02430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5896ae98ac6ab806b38d4ff305be4ac0" id="r_a5896ae98ac6ab806b38d4ff305be4ac0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__page__trend__test.html#a5896ae98ac6ab806b38d4ff305be4ac0">_l_vectorized</a> (ranks, predicted_ranks)</td></tr>
<tr class="separator:a5896ae98ac6ab806b38d4ff305be4ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda1d1b6bcdc61080a1f4952c618b380" id="r_acda1d1b6bcdc61080a1f4952c618b380"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__page__trend__test.html#acda1d1b6bcdc61080a1f4952c618b380">_l_p_asymptotic</a> (L, m, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:acda1d1b6bcdc61080a1f4952c618b380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90ad1aaf60143410c395ed15df550df9" id="r_a90ad1aaf60143410c395ed15df550df9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__page__trend__test.html#a90ad1aaf60143410c395ed15df550df9">_l_p_exact</a> (L, m, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a90ad1aaf60143410c395ed15df550df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aadd229e1b0433c5b0b46b48542139af2" id="r_aadd229e1b0433c5b0b46b48542139af2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__page__trend__test.html#aadd229e1b0433c5b0b46b48542139af2">PageTrendTestResult</a></td></tr>
<tr class="separator:aadd229e1b0433c5b0b46b48542139af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3574b85f6a3dfe5ac256a7451dcbc7ad" id="r_a3574b85f6a3dfe5ac256a7451dcbc7ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__page__trend__test.html#a3574b85f6a3dfe5ac256a7451dcbc7ad">_pagel_state</a> = <a class="el" href="classscipy_1_1stats_1_1__page__trend__test_1_1___page_l.html">_PageL</a>()</td></tr>
<tr class="separator:a3574b85f6a3dfe5ac256a7451dcbc7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7cdbebd3b6974884f629744928a02430" name="a7cdbebd3b6974884f629744928a02430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cdbebd3b6974884f629744928a02430">&#9670;&#160;</a></span>_choose_method()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._page_trend_test._choose_method </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ranks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Choose method for computing p-value automatically</pre> <div class="fragment"><div class="line"><span class="lineno">  364</span><span class="keyword">def </span>_choose_method(ranks):</div>
<div class="line"><span class="lineno">  365</span>    <span class="stringliteral">&#39;&#39;&#39;Choose method for computing p-value automatically&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  366</span>    m, n = ranks.shape</div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">if</span> n &gt; 8 <span class="keywordflow">or</span> (m &gt; 12 <span class="keywordflow">and</span> n &gt; 3) <span class="keywordflow">or</span> m &gt; 20:  <span class="comment"># as in [1], [4]</span></div>
<div class="line"><span class="lineno">  368</span>        method = <span class="stringliteral">&quot;asymptotic&quot;</span></div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  370</span>        method = <span class="stringliteral">&quot;exact&quot;</span></div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">return</span> method</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acda1d1b6bcdc61080a1f4952c618b380" name="acda1d1b6bcdc61080a1f4952c618b380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda1d1b6bcdc61080a1f4952c618b380">&#9670;&#160;</a></span>_l_p_asymptotic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._page_trend_test._l_p_asymptotic </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Calculate the p-value of Page's L from the asymptotic distribution</pre> <div class="fragment"><div class="line"><span class="lineno">  383</span><span class="keyword">def </span>_l_p_asymptotic(L, m, n):</div>
<div class="line"><span class="lineno">  384</span>    <span class="stringliteral">&#39;&#39;&#39;Calculate the p-value of Page&#39;s L from the asymptotic distribution&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  385</span>    <span class="comment"># Using [1] as a reference, the asymptotic p-value would be calculated as:</span></div>
<div class="line"><span class="lineno">  386</span>    <span class="comment"># chi_L = (12*L - 3*m*n*(n+1)**2)**2/(m*n**2*(n**2-1)*(n+1))</span></div>
<div class="line"><span class="lineno">  387</span>    <span class="comment"># p = chi2.sf(chi_L, df=1, loc=0, scale=1)/2</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="comment"># but this is insentive to the direction of the hypothesized ranking</span></div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="comment"># See [2] page 151</span></div>
<div class="line"><span class="lineno">  391</span>    E0 = (m*n*(n+1)**2)/4</div>
<div class="line"><span class="lineno">  392</span>    V0 = (m*n**2*(n+1)*(n**2-1))/144</div>
<div class="line"><span class="lineno">  393</span>    Lambda = (L-E0)/np.sqrt(V0)</div>
<div class="line"><span class="lineno">  394</span>    <span class="comment"># This is a one-sided &quot;greater&quot; test - calculate the probability that the</span></div>
<div class="line"><span class="lineno">  395</span>    <span class="comment"># L statistic under H0 would be greater than the observed L statistic</span></div>
<div class="line"><span class="lineno">  396</span>    p = norm.sf(Lambda)</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">return</span> p</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a90ad1aaf60143410c395ed15df550df9" name="a90ad1aaf60143410c395ed15df550df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90ad1aaf60143410c395ed15df550df9">&#9670;&#160;</a></span>_l_p_exact()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._page_trend_test._l_p_exact </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Calculate the p-value of Page's L exactly</pre> <div class="fragment"><div class="line"><span class="lineno">  400</span><span class="keyword">def </span>_l_p_exact(L, m, n):</div>
<div class="line"><span class="lineno">  401</span>    <span class="stringliteral">&#39;&#39;&#39;Calculate the p-value of Page&#39;s L exactly&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  402</span>    <span class="comment"># [1] uses m, n; [5] uses n, k.</span></div>
<div class="line"><span class="lineno">  403</span>    <span class="comment"># Switch convention here because exact calculation code references [5].</span></div>
<div class="line"><span class="lineno">  404</span>    L, n, k = int(L), int(m), int(n)</div>
<div class="line"><span class="lineno">  405</span>    _pagel_state.set_k(k)</div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordflow">return</span> _pagel_state.sf(L, n)</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5896ae98ac6ab806b38d4ff305be4ac0" name="a5896ae98ac6ab806b38d4ff305be4ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5896ae98ac6ab806b38d4ff305be4ac0">&#9670;&#160;</a></span>_l_vectorized()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._page_trend_test._l_vectorized </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ranks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>predicted_ranks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Calculate's Page's L statistic for each page of a 3d array</pre> <div class="fragment"><div class="line"><span class="lineno">  374</span><span class="keyword">def </span>_l_vectorized(ranks, predicted_ranks):</div>
<div class="line"><span class="lineno">  375</span>    <span class="stringliteral">&#39;&#39;&#39;Calculate&#39;s Page&#39;s L statistic for each page of a 3d array&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  376</span>    colsums = ranks.sum(axis=-2, keepdims=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  377</span>    products = predicted_ranks * colsums</div>
<div class="line"><span class="lineno">  378</span>    Ls = products.sum(axis=-1)</div>
<div class="line"><span class="lineno">  379</span>    Ls = Ls[0] <span class="keywordflow">if</span> Ls.size == 1 <span class="keywordflow">else</span> Ls.ravel()</div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">return</span> Ls</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9625b7377856497ffe0c17b6cf9335ae" name="a9625b7377856497ffe0c17b6cf9335ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9625b7377856497ffe0c17b6cf9335ae">&#9670;&#160;</a></span>page_trend_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._page_trend_test.page_trend_test </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ranked</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>predicted_ranks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>'auto'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Perform Page's Test, a measure of trend in observations between treatments.

    Page's Test (also known as Page's :math:`L` test) is useful when:

    * there are :math:`n \geq 3` treatments,
    * :math:`m \geq 2` subjects are observed for each treatment, and
    * the observations are hypothesized to have a particular order.

    Specifically, the test considers the null hypothesis that

    .. math::

        m_1 = m_2 = m_3 \cdots = m_n,

    where :math:`m_j` is the mean of the observed quantity under treatment
    :math:`j`, against the alternative hypothesis that

    .. math::

        m_1 \leq m_2 \leq m_3 \leq \cdots \leq m_n,

    where at least one inequality is strict.

    As noted by [4]_, Page's :math:`L` test has greater statistical power than
    the Friedman test against the alternative that there is a difference in
    trend, as Friedman's test only considers a difference in the means of the
    observations without considering their order. Whereas Spearman :math:`\rho`
    considers the correlation between the ranked observations of two variables
    (e.g. the airspeed velocity of a swallow vs. the weight of the coconut it
    carries), Page's :math:`L` is concerned with a trend in an observation
    (e.g. the airspeed velocity of a swallow) across several distinct
    treatments (e.g. carrying each of five coconuts of different weight) even
    as the observation is repeated with multiple subjects (e.g. one European
    swallow and one African swallow).

    Parameters
    ----------
    data : array-like
        A :math:`m \times n` array; the element in row :math:`i` and
        column :math:`j` is the observation corresponding with subject
        :math:`i` and treatment :math:`j`. By default, the columns are
        assumed to be arranged in order of increasing predicted mean.

    ranked : boolean, optional
        By default, `data` is assumed to be observations rather than ranks;
        it will be ranked with `scipy.stats.rankdata` along ``axis=1``. If
        `data` is provided in the form of ranks, pass argument ``True``.

    predicted_ranks : array-like, optional
        The predicted ranks of the column means. If not specified,
        the columns are assumed to be arranged in order of increasing
        predicted mean, so the default `predicted_ranks` are
        :math:`[1, 2, \dots, n-1, n]`.

    method : {'auto', 'asymptotic', 'exact'}, optional
        Selects the method used to calculate the *p*-value. The following
        options are available.

        * 'auto': selects between 'exact' and 'asymptotic' to
          achieve reasonably accurate results in reasonable time (default)
        * 'asymptotic': compares the standardized test statistic against
          the normal distribution
        * 'exact': computes the exact *p*-value by comparing the observed
          :math:`L` statistic against those realized by all possible
          permutations of ranks (under the null hypothesis that each
          permutation is equally likely)

    Returns
    -------
    res : PageTrendTestResult
        An object containing attributes:

        statistic : float
            Page's :math:`L` test statistic.
        pvalue : float
            The associated *p*-value
        method : {'asymptotic', 'exact'}
            The method used to compute the *p*-value

    See Also
    --------
    rankdata, friedmanchisquare, spearmanr

    Notes
    -----
    As noted in [1]_, "the :math:`n` 'treatments' could just as well represent
    :math:`n` objects or events or performances or persons or trials ranked."
    Similarly, the :math:`m` 'subjects' could equally stand for :math:`m`
    "groupings by ability or some other control variable, or judges doing
    the ranking, or random replications of some other sort."

    The procedure for calculating the :math:`L` statistic, adapted from
    [1]_, is:

    1. "Predetermine with careful logic the appropriate hypotheses
       concerning the predicted ording of the experimental results.
       If no reasonable basis for ordering any treatments is known, the
       :math:`L` test is not appropriate."
    2. "As in other experiments, determine at what level of confidence
       you will reject the null hypothesis that there is no agreement of
       experimental results with the monotonic hypothesis."
    3. "Cast the experimental material into a two-way table of :math:`n`
       columns (treatments, objects ranked, conditions) and :math:`m`
       rows (subjects, replication groups, levels of control variables)."
    4. "When experimental observations are recorded, rank them across each
       row", e.g. ``ranks = scipy.stats.rankdata(data, axis=1)``.
    5. "Add the ranks in each column", e.g.
       ``colsums = np.sum(ranks, axis=0)``.
    6. "Multiply each sum of ranks by the predicted rank for that same
       column", e.g. ``products = predicted_ranks * colsums``.
    7. "Sum all such products", e.g. ``L = products.sum()``.

    [1]_ continues by suggesting use of the standardized statistic

    .. math::

        \chi_L^2 = \frac{\left[12L-3mn(n+1)^2\right]^2}{mn^2(n^2-1)(n+1)}

    "which is distributed approximately as chi-square with 1 degree of
    freedom. The ordinary use of :math:`\chi^2` tables would be
    equivalent to a two-sided test of agreement. If a one-sided test
    is desired, *as will almost always be the case*, the probability
    discovered in the chi-square table should be *halved*."

    However, this standardized statistic does not distinguish between the
    observed values being well correlated with the predicted ranks and being
    _anti_-correlated with the predicted ranks. Instead, we follow [2]_
    and calculate the standardized statistic

    .. math::

        \Lambda = \frac{L - E_0}{\sqrt{V_0}},

    where :math:`E_0 = \frac{1}{4} mn(n+1)^2` and
    :math:`V_0 = \frac{1}{144} mn^2(n+1)(n^2-1)`, "which is asymptotically
    normal under the null hypothesis".

    The *p*-value for ``method='exact'`` is generated by comparing the observed
    value of :math:`L` against the :math:`L` values generated for all
    :math:`(n!)^m` possible permutations of ranks. The calculation is performed
    using the recursive method of [5].

    The *p*-values are not adjusted for the possibility of ties. When
    ties are present, the reported  ``'exact'`` *p*-values may be somewhat
    larger (i.e. more conservative) than the true *p*-value [2]_. The
    ``'asymptotic'``` *p*-values, however, tend to be smaller (i.e. less
    conservative) than the ``'exact'`` *p*-values.

    References
    ----------
    .. [1] Ellis Batten Page, "Ordered hypotheses for multiple treatments:
       a significant test for linear ranks", *Journal of the American
       Statistical Association* 58(301), p. 216--230, 1963.

    .. [2] Markus Neuhauser, *Nonparametric Statistical Test: A computational
       approach*, CRC Press, p. 150--152, 2012.

    .. [3] Statext LLC, "Page's L Trend Test - Easy Statistics", *Statext -
       Statistics Study*, https://www.statext.com/practice/PageTrendTest03.php,
       Accessed July 12, 2020.

    .. [4] "Page's Trend Test", *Wikipedia*, WikimediaFoundation,
       https://en.wikipedia.org/wiki/Page%27s_trend_test,
       Accessed July 12, 2020.

    .. [5] Robert E. Odeh, "The exact distribution of Page's L-statistic in
       the two-way layout", *Communications in Statistics - Simulation and
       Computation*,  6(1), p. 49--61, 1977.

    Examples
    --------
    We use the example from [3]_: 10 students are asked to rate three
    teaching methods - tutorial, lecture, and seminar - on a scale of 1-5,
    with 1 being the lowest and 5 being the highest. We have decided that
    a confidence level of 99% is required to reject the null hypothesis in
    favor of our alternative: that the seminar will have the highest ratings
    and the tutorial will have the lowest. Initially, the data have been
    tabulated with each row representing an individual student's ratings of
    the three methods in the following order: tutorial, lecture, seminar.

    &gt;&gt;&gt; table = [[3, 4, 3],
    ...          [2, 2, 4],
    ...          [3, 3, 5],
    ...          [1, 3, 2],
    ...          [2, 3, 2],
    ...          [2, 4, 5],
    ...          [1, 2, 4],
    ...          [3, 4, 4],
    ...          [2, 4, 5],
    ...          [1, 3, 4]]

    Because the tutorial is hypothesized to have the lowest ratings, the
    column corresponding with tutorial rankings should be first; the seminar
    is hypothesized to have the highest ratings, so its column should be last.
    Since the columns are already arranged in this order of increasing
    predicted mean, we can pass the table directly into `page_trend_test`.

    &gt;&gt;&gt; from scipy.stats import page_trend_test
    &gt;&gt;&gt; res = page_trend_test(table)
    &gt;&gt;&gt; res
    PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,
                        method='exact')

    This *p*-value indicates that there is a 0.1819% chance that
    the :math:`L` statistic would reach such an extreme value under the null
    hypothesis. Because 0.1819% is less than 1%, we have evidence to reject
    the null hypothesis in favor of our alternative at a 99% confidence level.

    The value of the :math:`L` statistic is 133.5. To check this manually,
    we rank the data such that high scores correspond with high ranks, settling
    ties with an average rank:

    &gt;&gt;&gt; from scipy.stats import rankdata
    &gt;&gt;&gt; ranks = rankdata(table, axis=1)
    &gt;&gt;&gt; ranks
    array([[1.5, 3. , 1.5],
           [1.5, 1.5, 3. ],
           [1.5, 1.5, 3. ],
           [1. , 3. , 2. ],
           [1.5, 3. , 1.5],
           [1. , 2. , 3. ],
           [1. , 2. , 3. ],
           [1. , 2.5, 2.5],
           [1. , 2. , 3. ],
           [1. , 2. , 3. ]])

    We add the ranks within each column, multiply the sums by the
    predicted ranks, and sum the products.

    &gt;&gt;&gt; import numpy as np
    &gt;&gt;&gt; m, n = ranks.shape
    &gt;&gt;&gt; predicted_ranks = np.arange(1, n+1)
    &gt;&gt;&gt; L = (predicted_ranks * np.sum(ranks, axis=0)).sum()
    &gt;&gt;&gt; res.statistic == L
    True

    As presented in [3]_, the asymptotic approximation of the *p*-value is the
    survival function of the normal distribution evaluated at the standardized
    test statistic:

    &gt;&gt;&gt; from scipy.stats import norm
    &gt;&gt;&gt; E0 = (m*n*(n+1)**2)/4
    &gt;&gt;&gt; V0 = (m*n**2*(n+1)*(n**2-1))/144
    &gt;&gt;&gt; Lambda = (L-E0)/np.sqrt(V0)
    &gt;&gt;&gt; p = norm.sf(Lambda)
    &gt;&gt;&gt; p
    0.0012693433690751756

    This does not precisely match the *p*-value reported by `page_trend_test`
    above. The asymptotic distribution is not very accurate, nor conservative,
    for :math:`m \leq 12` and :math:`n \leq 8`, so `page_trend_test` chose to
    use ``method='exact'`` based on the dimensions of the table and the
    recommendations in Page's original paper [1]_. To override
    `page_trend_test`'s choice, provide the `method` argument.

    &gt;&gt;&gt; res = page_trend_test(table, method="asymptotic")
    &gt;&gt;&gt; res
    PageTrendTestResult(statistic=133.5, pvalue=0.0012693433690751756,
                        method='asymptotic')

    If the data are already ranked, we can pass in the ``ranks`` instead of
    the ``table`` to save computation time.

    &gt;&gt;&gt; res = page_trend_test(ranks,             # ranks of data
    ...                       ranked=True,       # data is already ranked
    ...                       )
    &gt;&gt;&gt; res
    PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,
                        method='exact')

    Suppose the raw data had been tabulated in an order different from the
    order of predicted means, say lecture, seminar, tutorial.

    &gt;&gt;&gt; table = np.asarray(table)[:, [1, 2, 0]]

    Since the arrangement of this table is not consistent with the assumed
    ordering, we can either rearrange the table or provide the
    `predicted_ranks`. Remembering that the lecture is predicted
    to have the middle rank, the seminar the highest, and tutorial the lowest,
    we pass:

    &gt;&gt;&gt; res = page_trend_test(table,             # data as originally tabulated
    ...                       predicted_ranks=[2, 3, 1],  # our predicted order
    ...                       )
    &gt;&gt;&gt; res
    PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,
                        method='exact')</pre> <div class="fragment"><div class="line"><span class="lineno">   13</span><span class="keyword">def </span>page_trend_test(data, ranked=False, predicted_ranks=None, method=&#39;auto&#39;):</div>
<div class="line"><span class="lineno">   14</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   15</span><span class="stringliteral">    Perform Page&#39;s Test, a measure of trend in observations between treatments.</span></div>
<div class="line"><span class="lineno">   16</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   17</span><span class="stringliteral">    Page&#39;s Test (also known as Page&#39;s :math:`L` test) is useful when:</span></div>
<div class="line"><span class="lineno">   18</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   19</span><span class="stringliteral">    * there are :math:`n \geq 3` treatments,</span></div>
<div class="line"><span class="lineno">   20</span><span class="stringliteral">    * :math:`m \geq 2` subjects are observed for each treatment, and</span></div>
<div class="line"><span class="lineno">   21</span><span class="stringliteral">    * the observations are hypothesized to have a particular order.</span></div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral">    Specifically, the test considers the null hypothesis that</span></div>
<div class="line"><span class="lineno">   24</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   25</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">        m_1 = m_2 = m_3 \cdots = m_n,</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">    where :math:`m_j` is the mean of the observed quantity under treatment</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    :math:`j`, against the alternative hypothesis that</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">        m_1 \leq m_2 \leq m_3 \leq \cdots \leq m_n,</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    where at least one inequality is strict.</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    As noted by [4]_, Page&#39;s :math:`L` test has greater statistical power than</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">    the Friedman test against the alternative that there is a difference in</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">    trend, as Friedman&#39;s test only considers a difference in the means of the</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">    observations without considering their order. Whereas Spearman :math:`\rho`</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">    considers the correlation between the ranked observations of two variables</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">    (e.g. the airspeed velocity of a swallow vs. the weight of the coconut it</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    carries), Page&#39;s :math:`L` is concerned with a trend in an observation</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    (e.g. the airspeed velocity of a swallow) across several distinct</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    treatments (e.g. carrying each of five coconuts of different weight) even</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">    as the observation is repeated with multiple subjects (e.g. one European</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    swallow and one African swallow).</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    data : array-like</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">        A :math:`m \times n` array; the element in row :math:`i` and</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">        column :math:`j` is the observation corresponding with subject</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">        :math:`i` and treatment :math:`j`. By default, the columns are</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">        assumed to be arranged in order of increasing predicted mean.</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    ranked : boolean, optional</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">        By default, `data` is assumed to be observations rather than ranks;</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">        it will be ranked with `scipy.stats.rankdata` along ``axis=1``. If</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">        `data` is provided in the form of ranks, pass argument ``True``.</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    predicted_ranks : array-like, optional</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">        The predicted ranks of the column means. If not specified,</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        the columns are assumed to be arranged in order of increasing</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">        predicted mean, so the default `predicted_ranks` are</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">        :math:`[1, 2, \dots, n-1, n]`.</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    method : {&#39;auto&#39;, &#39;asymptotic&#39;, &#39;exact&#39;}, optional</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        Selects the method used to calculate the *p*-value. The following</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">        options are available.</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        * &#39;auto&#39;: selects between &#39;exact&#39; and &#39;asymptotic&#39; to</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">          achieve reasonably accurate results in reasonable time (default)</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        * &#39;asymptotic&#39;: compares the standardized test statistic against</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">          the normal distribution</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">        * &#39;exact&#39;: computes the exact *p*-value by comparing the observed</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">          :math:`L` statistic against those realized by all possible</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">          permutations of ranks (under the null hypothesis that each</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">          permutation is equally likely)</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    res : PageTrendTestResult</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        An object containing attributes:</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        statistic : float</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">            Page&#39;s :math:`L` test statistic.</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">        pvalue : float</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">            The associated *p*-value</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">        method : {&#39;asymptotic&#39;, &#39;exact&#39;}</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">            The method used to compute the *p*-value</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    rankdata, friedmanchisquare, spearmanr</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">    As noted in [1]_, &quot;the :math:`n` &#39;treatments&#39; could just as well represent</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    :math:`n` objects or events or performances or persons or trials ranked.&quot;</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    Similarly, the :math:`m` &#39;subjects&#39; could equally stand for :math:`m`</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    &quot;groupings by ability or some other control variable, or judges doing</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    the ranking, or random replications of some other sort.&quot;</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    The procedure for calculating the :math:`L` statistic, adapted from</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    [1]_, is:</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">    1. &quot;Predetermine with careful logic the appropriate hypotheses</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">       concerning the predicted ording of the experimental results.</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">       If no reasonable basis for ordering any treatments is known, the</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">       :math:`L` test is not appropriate.&quot;</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    2. &quot;As in other experiments, determine at what level of confidence</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">       you will reject the null hypothesis that there is no agreement of</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">       experimental results with the monotonic hypothesis.&quot;</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">    3. &quot;Cast the experimental material into a two-way table of :math:`n`</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">       columns (treatments, objects ranked, conditions) and :math:`m`</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">       rows (subjects, replication groups, levels of control variables).&quot;</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    4. &quot;When experimental observations are recorded, rank them across each</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">       row&quot;, e.g. ``ranks = scipy.stats.rankdata(data, axis=1)``.</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    5. &quot;Add the ranks in each column&quot;, e.g.</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">       ``colsums = np.sum(ranks, axis=0)``.</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    6. &quot;Multiply each sum of ranks by the predicted rank for that same</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">       column&quot;, e.g. ``products = predicted_ranks * colsums``.</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    7. &quot;Sum all such products&quot;, e.g. ``L = products.sum()``.</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    [1]_ continues by suggesting use of the standardized statistic</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">        \chi_L^2 = \frac{\left[12L-3mn(n+1)^2\right]^2}{mn^2(n^2-1)(n+1)}</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    &quot;which is distributed approximately as chi-square with 1 degree of</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    freedom. The ordinary use of :math:`\chi^2` tables would be</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    equivalent to a two-sided test of agreement. If a one-sided test</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    is desired, *as will almost always be the case*, the probability</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    discovered in the chi-square table should be *halved*.&quot;</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    However, this standardized statistic does not distinguish between the</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    observed values being well correlated with the predicted ranks and being</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    _anti_-correlated with the predicted ranks. Instead, we follow [2]_</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">    and calculate the standardized statistic</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">        \Lambda = \frac{L - E_0}{\sqrt{V_0}},</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    where :math:`E_0 = \frac{1}{4} mn(n+1)^2` and</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    :math:`V_0 = \frac{1}{144} mn^2(n+1)(n^2-1)`, &quot;which is asymptotically</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">    normal under the null hypothesis&quot;.</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    The *p*-value for ``method=&#39;exact&#39;`` is generated by comparing the observed</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    value of :math:`L` against the :math:`L` values generated for all</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    :math:`(n!)^m` possible permutations of ranks. The calculation is performed</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">    using the recursive method of [5].</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    The *p*-values are not adjusted for the possibility of ties. When</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    ties are present, the reported  ``&#39;exact&#39;`` *p*-values may be somewhat</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    larger (i.e. more conservative) than the true *p*-value [2]_. The</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">    ``&#39;asymptotic&#39;``` *p*-values, however, tend to be smaller (i.e. less</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    conservative) than the ``&#39;exact&#39;`` *p*-values.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">    .. [1] Ellis Batten Page, &quot;Ordered hypotheses for multiple treatments:</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">       a significant test for linear ranks&quot;, *Journal of the American</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">       Statistical Association* 58(301), p. 216--230, 1963.</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">    .. [2] Markus Neuhauser, *Nonparametric Statistical Test: A computational</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">       approach*, CRC Press, p. 150--152, 2012.</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">    .. [3] Statext LLC, &quot;Page&#39;s L Trend Test - Easy Statistics&quot;, *Statext -</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">       Statistics Study*, https://www.statext.com/practice/PageTrendTest03.php,</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">       Accessed July 12, 2020.</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    .. [4] &quot;Page&#39;s Trend Test&quot;, *Wikipedia*, WikimediaFoundation,</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">       https://en.wikipedia.org/wiki/Page%27s_trend_test,</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">       Accessed July 12, 2020.</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    .. [5] Robert E. Odeh, &quot;The exact distribution of Page&#39;s L-statistic in</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">       the two-way layout&quot;, *Communications in Statistics - Simulation and</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">       Computation*,  6(1), p. 49--61, 1977.</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    We use the example from [3]_: 10 students are asked to rate three</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    teaching methods - tutorial, lecture, and seminar - on a scale of 1-5,</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    with 1 being the lowest and 5 being the highest. We have decided that</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    a confidence level of 99% is required to reject the null hypothesis in</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    favor of our alternative: that the seminar will have the highest ratings</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    and the tutorial will have the lowest. Initially, the data have been</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">    tabulated with each row representing an individual student&#39;s ratings of</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    the three methods in the following order: tutorial, lecture, seminar.</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    &gt;&gt;&gt; table = [[3, 4, 3],</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">    ...          [2, 2, 4],</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    ...          [3, 3, 5],</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    ...          [1, 3, 2],</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    ...          [2, 3, 2],</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    ...          [2, 4, 5],</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">    ...          [1, 2, 4],</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">    ...          [3, 4, 4],</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">    ...          [2, 4, 5],</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    ...          [1, 3, 4]]</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    Because the tutorial is hypothesized to have the lowest ratings, the</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    column corresponding with tutorial rankings should be first; the seminar</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">    is hypothesized to have the highest ratings, so its column should be last.</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    Since the columns are already arranged in this order of increasing</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    predicted mean, we can pass the table directly into `page_trend_test`.</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import page_trend_test</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    &gt;&gt;&gt; res = page_trend_test(table)</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">    &gt;&gt;&gt; res</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">                        method=&#39;exact&#39;)</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">    This *p*-value indicates that there is a 0.1819% chance that</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    the :math:`L` statistic would reach such an extreme value under the null</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    hypothesis. Because 0.1819% is less than 1%, we have evidence to reject</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">    the null hypothesis in favor of our alternative at a 99% confidence level.</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">    The value of the :math:`L` statistic is 133.5. To check this manually,</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">    we rank the data such that high scores correspond with high ranks, settling</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">    ties with an average rank:</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import rankdata</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">    &gt;&gt;&gt; ranks = rankdata(table, axis=1)</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">    &gt;&gt;&gt; ranks</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    array([[1.5, 3. , 1.5],</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">           [1.5, 1.5, 3. ],</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">           [1.5, 1.5, 3. ],</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">           [1. , 3. , 2. ],</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">           [1.5, 3. , 1.5],</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">           [1. , 2. , 3. ],</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">           [1. , 2. , 3. ],</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">           [1. , 2.5, 2.5],</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">           [1. , 2. , 3. ],</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">           [1. , 2. , 3. ]])</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    We add the ranks within each column, multiply the sums by the</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">    predicted ranks, and sum the products.</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    &gt;&gt;&gt; import numpy as np</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    &gt;&gt;&gt; m, n = ranks.shape</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">    &gt;&gt;&gt; predicted_ranks = np.arange(1, n+1)</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    &gt;&gt;&gt; L = (predicted_ranks * np.sum(ranks, axis=0)).sum()</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    &gt;&gt;&gt; res.statistic == L</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    True</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    As presented in [3]_, the asymptotic approximation of the *p*-value is the</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    survival function of the normal distribution evaluated at the standardized</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    test statistic:</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import norm</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    &gt;&gt;&gt; E0 = (m*n*(n+1)**2)/4</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    &gt;&gt;&gt; V0 = (m*n**2*(n+1)*(n**2-1))/144</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">    &gt;&gt;&gt; Lambda = (L-E0)/np.sqrt(V0)</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">    &gt;&gt;&gt; p = norm.sf(Lambda)</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    &gt;&gt;&gt; p</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    0.0012693433690751756</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">    This does not precisely match the *p*-value reported by `page_trend_test`</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    above. The asymptotic distribution is not very accurate, nor conservative,</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    for :math:`m \leq 12` and :math:`n \leq 8`, so `page_trend_test` chose to</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    use ``method=&#39;exact&#39;`` based on the dimensions of the table and the</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    recommendations in Page&#39;s original paper [1]_. To override</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    `page_trend_test`&#39;s choice, provide the `method` argument.</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    &gt;&gt;&gt; res = page_trend_test(table, method=&quot;asymptotic&quot;)</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">    &gt;&gt;&gt; res</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    PageTrendTestResult(statistic=133.5, pvalue=0.0012693433690751756,</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">                        method=&#39;asymptotic&#39;)</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    If the data are already ranked, we can pass in the ``ranks`` instead of</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    the ``table`` to save computation time.</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    &gt;&gt;&gt; res = page_trend_test(ranks,             # ranks of data</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">    ...                       ranked=True,       # data is already ranked</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">    ...                       )</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">    &gt;&gt;&gt; res</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">                        method=&#39;exact&#39;)</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    Suppose the raw data had been tabulated in an order different from the</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">    order of predicted means, say lecture, seminar, tutorial.</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">    &gt;&gt;&gt; table = np.asarray(table)[:, [1, 2, 0]]</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">    Since the arrangement of this table is not consistent with the assumed</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    ordering, we can either rearrange the table or provide the</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    `predicted_ranks`. Remembering that the lecture is predicted</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">    to have the middle rank, the seminar the highest, and tutorial the lowest,</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">    we pass:</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">    &gt;&gt;&gt; res = page_trend_test(table,             # data as originally tabulated</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">    ...                       predicted_ranks=[2, 3, 1],  # our predicted order</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">    ...                       )</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">    &gt;&gt;&gt; res</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">    PageTrendTestResult(statistic=133.5, pvalue=0.0018191161948127822,</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">                        method=&#39;exact&#39;)</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>    <span class="comment"># Possible values of the method parameter and the corresponding function</span></div>
<div class="line"><span class="lineno">  306</span>    <span class="comment"># used to evaluate the p value</span></div>
<div class="line"><span class="lineno">  307</span>    methods = {<span class="stringliteral">&quot;asymptotic&quot;</span>: _l_p_asymptotic,</div>
<div class="line"><span class="lineno">  308</span>               <span class="stringliteral">&quot;exact&quot;</span>: _l_p_exact,</div>
<div class="line"><span class="lineno">  309</span>               <span class="stringliteral">&quot;auto&quot;</span>: <span class="keywordtype">None</span>}</div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">if</span> method <span class="keywordflow">not</span> <span class="keywordflow">in</span> methods:</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;`method` must be in {set(methods)}&quot;</span>)</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    ranks = np.array(data, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">if</span> ranks.ndim != 2:  <span class="comment"># TODO: relax this to accept 3d arrays?</span></div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`data` must be a 2d array.&quot;</span>)</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    m, n = ranks.shape</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">if</span> m &lt; 2 <span class="keywordflow">or</span> n &lt; 3:</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Page&#39;s L is only appropriate for data with two &quot;</span></div>
<div class="line"><span class="lineno">  320</span>                         <span class="stringliteral">&quot;or more rows and three or more columns.&quot;</span>)</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordflow">if</span> np.any(np.isnan(data)):</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`data` contains NaNs, which cannot be ranked &quot;</span></div>
<div class="line"><span class="lineno">  324</span>                         <span class="stringliteral">&quot;meaningfully&quot;</span>)</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    <span class="comment"># ensure NumPy array and rank the data if it&#39;s not already ranked</span></div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">if</span> ranked:</div>
<div class="line"><span class="lineno">  328</span>        <span class="comment"># Only a basic check on whether data is ranked. Checking that the data</span></div>
<div class="line"><span class="lineno">  329</span>        <span class="comment"># is properly ranked could take as much time as ranking it.</span></div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> (ranks.min() &gt;= 1 <span class="keywordflow">and</span> ranks.max() &lt;= ranks.shape[1]):</div>
<div class="line"><span class="lineno">  331</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`data` is not properly ranked. Rank the data or &quot;</span></div>
<div class="line"><span class="lineno">  332</span>                             <span class="stringliteral">&quot;pass `ranked=False`.&quot;</span>)</div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  334</span>        ranks = scipy.stats.rankdata(data, axis=-1)</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    <span class="comment"># generate predicted ranks if not provided, ensure valid NumPy array</span></div>
<div class="line"><span class="lineno">  337</span>    <span class="keywordflow">if</span> predicted_ranks <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  338</span>        predicted_ranks = np.arange(1, n+1)</div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  340</span>        predicted_ranks = np.array(predicted_ranks, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">if</span> (predicted_ranks.ndim &lt; 1 <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  342</span>                (set(predicted_ranks) != set(range(1, n+1)) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  343</span>                 len(predicted_ranks) != n)):</div>
<div class="line"><span class="lineno">  344</span>            <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;`predicted_ranks` must include each integer &quot;</span></div>
<div class="line"><span class="lineno">  345</span>                             f<span class="stringliteral">&quot;from 1 to {n} (the number of columns in &quot;</span></div>
<div class="line"><span class="lineno">  346</span>                             f<span class="stringliteral">&quot;`data`) exactly once.&quot;</span>)</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">if</span> type(ranked) <span class="keywordflow">is</span> <span class="keywordflow">not</span> bool:</div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&quot;`ranked` must be boolean.&quot;</span>)</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    <span class="comment"># Calculate the L statistic</span></div>
<div class="line"><span class="lineno">  352</span>    L = _l_vectorized(ranks, predicted_ranks)</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="comment"># Calculate the p-value</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;auto&quot;</span>:</div>
<div class="line"><span class="lineno">  356</span>        method = _choose_method(ranks)</div>
<div class="line"><span class="lineno">  357</span>    p_fun = methods[method]  <span class="comment"># get the function corresponding with the method</span></div>
<div class="line"><span class="lineno">  358</span>    p = p_fun(L, m, n)</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    page_result = PageTrendTestResult(statistic=L, pvalue=p, method=method)</div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">return</span> page_result</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3574b85f6a3dfe5ac256a7451dcbc7ad" name="a3574b85f6a3dfe5ac256a7451dcbc7ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3574b85f6a3dfe5ac256a7451dcbc7ad">&#9670;&#160;</a></span>_pagel_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._page_trend_test._pagel_state = <a class="el" href="classscipy_1_1stats_1_1__page__trend__test_1_1___page_l.html">_PageL</a>()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aadd229e1b0433c5b0b46b48542139af2" name="aadd229e1b0433c5b0b46b48542139af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadd229e1b0433c5b0b46b48542139af2">&#9670;&#160;</a></span>PageTrendTestResult</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._page_trend_test.PageTrendTestResult</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  make_dataclass(<span class="stringliteral">&quot;PageTrendTestResult&quot;</span>,</div>
<div class="line"><span class="lineno">    2</span>                                     (<span class="stringliteral">&quot;statistic&quot;</span>, <span class="stringliteral">&quot;pvalue&quot;</span>, <span class="stringliteral">&quot;method&quot;</span>))</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
