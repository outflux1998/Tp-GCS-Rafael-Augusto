<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._minpack_py Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html">_minpack_py</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._minpack_py Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3393478f83d8ffa5644b78a1f6288501" id="r_a3393478f83d8ffa5644b78a1f6288501"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a3393478f83d8ffa5644b78a1f6288501">_check_func</a> (checker, argname, thefunc, x0, args, numinputs, output_shape=None)</td></tr>
<tr class="separator:a3393478f83d8ffa5644b78a1f6288501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99eb46becd5efacbaa56201c25a40039" id="r_a99eb46becd5efacbaa56201c25a40039"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a99eb46becd5efacbaa56201c25a40039">fsolve</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args=(), fprime=None, full_output=0, col_deriv=0, xtol=1.49012e-8, maxfev=0, band=None, epsfcn=None, factor=100, diag=None)</td></tr>
<tr class="separator:a99eb46becd5efacbaa56201c25a40039"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad63900349ce05baf9219995d2c7c974f" id="r_ad63900349ce05baf9219995d2c7c974f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#ad63900349ce05baf9219995d2c7c974f">_root_hybr</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args=(), jac=None, col_deriv=0, xtol=1.49012e-08, maxfev=0, band=None, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=None, factor=100, diag=None, **unknown_options)</td></tr>
<tr class="separator:ad63900349ce05baf9219995d2c7c974f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f776bd622214934efcfc4fed5fd183d" id="r_a0f776bd622214934efcfc4fed5fd183d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a0f776bd622214934efcfc4fed5fd183d">leastsq</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args=(), Dfun=None, full_output=0, col_deriv=0, ftol=1.49012e-8, xtol=1.49012e-8, gtol=0.0, maxfev=0, epsfcn=None, factor=100, diag=None)</td></tr>
<tr class="separator:a0f776bd622214934efcfc4fed5fd183d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4bd6dad43c084a1d76e0b253257f5c" id="r_a4f4bd6dad43c084a1d76e0b253257f5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a4f4bd6dad43c084a1d76e0b253257f5c">_wrap_func</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, xdata, ydata, transform)</td></tr>
<tr class="separator:a4f4bd6dad43c084a1d76e0b253257f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6ae4f52aeed582dbd315aa288970096" id="r_ac6ae4f52aeed582dbd315aa288970096"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#ac6ae4f52aeed582dbd315aa288970096">_wrap_jac</a> (jac, xdata, transform)</td></tr>
<tr class="separator:ac6ae4f52aeed582dbd315aa288970096"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1fa5c1a79e4cdc68faa93a6bc569065" id="r_ae1fa5c1a79e4cdc68faa93a6bc569065"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#ae1fa5c1a79e4cdc68faa93a6bc569065">_initialize_feasible</a> (lb, ub)</td></tr>
<tr class="separator:ae1fa5c1a79e4cdc68faa93a6bc569065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e83f6b5d343fa6f3038f9dcf01b3f1" id="r_a95e83f6b5d343fa6f3038f9dcf01b3f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a95e83f6b5d343fa6f3038f9dcf01b3f1">curve_fit</a> (<a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, xdata, ydata, p0=None, <a class="el" href="__lapack__subroutines_8h.html#a3f5a2708d2ade2dfb7391aeb4543c133">sigma</a>=None, absolute_sigma=False, check_finite=True, bounds=(-np.inf, np.inf), method=None, jac=None, *full_output=False, **kwargs)</td></tr>
<tr class="separator:a95e83f6b5d343fa6f3038f9dcf01b3f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a8386efd904c9a52d844210ec9a5b2" id="r_a73a8386efd904c9a52d844210ec9a5b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a73a8386efd904c9a52d844210ec9a5b2">check_gradient</a> (fcn, Dfcn, x0, args=(), col_deriv=0)</td></tr>
<tr class="separator:a73a8386efd904c9a52d844210ec9a5b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21cf014fb3b6e42a8473e254d6f0f52f" id="r_a21cf014fb3b6e42a8473e254d6f0f52f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a21cf014fb3b6e42a8473e254d6f0f52f">_del2</a> (p0, p1, <a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>)</td></tr>
<tr class="separator:a21cf014fb3b6e42a8473e254d6f0f52f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54585950876e6b1ef7cdcfb9111bca4c" id="r_a54585950876e6b1ef7cdcfb9111bca4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a54585950876e6b1ef7cdcfb9111bca4c">_relerr</a> (actual, desired)</td></tr>
<tr class="separator:a54585950876e6b1ef7cdcfb9111bca4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a97c9de0ba2c6509c1c8ecaaa999f1c" id="r_a6a97c9de0ba2c6509c1c8ecaaa999f1c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a6a97c9de0ba2c6509c1c8ecaaa999f1c">_fixed_point_helper</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args, xtol, maxiter, use_accel)</td></tr>
<tr class="separator:a6a97c9de0ba2c6509c1c8ecaaa999f1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3921803645e1d6711f394f3130a53134" id="r_a3921803645e1d6711f394f3130a53134"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a3921803645e1d6711f394f3130a53134">fixed_point</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, args=(), xtol=1e-8, maxiter=500, method='del2')</td></tr>
<tr class="separator:a3921803645e1d6711f394f3130a53134"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1bbbcae076659d8fb7ef47b694715cde" id="r_a1bbbcae076659d8fb7ef47b694715cde"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a1bbbcae076659d8fb7ef47b694715cde">error</a> = _minpack.error</td></tr>
<tr class="separator:a1bbbcae076659d8fb7ef47b694715cde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e93cbae2af241ffb978bc54d4834b2" id="r_a95e93cbae2af241ffb978bc54d4834b2"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a95e93cbae2af241ffb978bc54d4834b2">LEASTSQ_SUCCESS</a> = [1, 2, 3, 4]</td></tr>
<tr class="separator:a95e93cbae2af241ffb978bc54d4834b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20efa43ed57b2cb1186752b5ddb6e717" id="r_a20efa43ed57b2cb1186752b5ddb6e717"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__minpack__py.html#a20efa43ed57b2cb1186752b5ddb6e717">LEASTSQ_FAILURE</a> = [5, 6, 7, 8]</td></tr>
<tr class="separator:a20efa43ed57b2cb1186752b5ddb6e717"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3393478f83d8ffa5644b78a1f6288501" name="a3393478f83d8ffa5644b78a1f6288501"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3393478f83d8ffa5644b78a1f6288501">&#9670;&#160;</a></span>_check_func()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py._check_func </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>checker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>argname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>thefunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>numinputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output_shape</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   23</span>                output_shape=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">   24</span>    res = atleast_1d(thefunc(*((x0[:numinputs],) + args)))</div>
<div class="line"><span class="lineno">   25</span>    <span class="keywordflow">if</span> (output_shape <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>) <span class="keywordflow">and</span> (shape(res) != output_shape):</div>
<div class="line"><span class="lineno">   26</span>        <span class="keywordflow">if</span> (output_shape[0] != 1):</div>
<div class="line"><span class="lineno">   27</span>            <span class="keywordflow">if</span> len(output_shape) &gt; 1:</div>
<div class="line"><span class="lineno">   28</span>                <span class="keywordflow">if</span> output_shape[1] == 1:</div>
<div class="line"><span class="lineno">   29</span>                    <span class="keywordflow">return</span> shape(res)</div>
<div class="line"><span class="lineno">   30</span>            msg = <span class="stringliteral">&quot;%s: there is a mismatch between the input and output &quot;</span> \</div>
<div class="line"><span class="lineno">   31</span>                  <span class="stringliteral">&quot;shape of the &#39;%s&#39; argument&quot;</span> % (checker, argname)</div>
<div class="line"><span class="lineno">   32</span>            func_name = getattr(thefunc, <span class="stringliteral">&#39;__name__&#39;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">   33</span>            <span class="keywordflow">if</span> func_name:</div>
<div class="line"><span class="lineno">   34</span>                msg += <span class="stringliteral">&quot; &#39;%s&#39;.&quot;</span> % func_name</div>
<div class="line"><span class="lineno">   35</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   36</span>                msg += <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line"><span class="lineno">   37</span>            msg += <span class="stringliteral">&#39;Shape should be %s but it is %s.&#39;</span> % (output_shape, shape(res))</div>
<div class="line"><span class="lineno">   38</span>            <span class="keywordflow">raise</span> TypeError(msg)</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> issubdtype(res.dtype, inexact):</div>
<div class="line"><span class="lineno">   40</span>        dt = res.dtype</div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   42</span>        dt = <a class="code hl_namespace" href="namespacedtype.html">dtype</a>(float)</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">return</span> shape(res), dt</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="ttc" id="anamespacedtype_html"><div class="ttname"><a href="namespacedtype.html">dtype</a></div><div class="ttdef"><b>Definition</b> dtype.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a21cf014fb3b6e42a8473e254d6f0f52f" name="a21cf014fb3b6e42a8473e254d6f0f52f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21cf014fb3b6e42a8473e254d6f0f52f">&#9670;&#160;</a></span>_del2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py._del2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  921</span><span class="keyword">def </span>_del2(p0, p1, d):</div>
<div class="line"><span class="lineno">  922</span>    <span class="keywordflow">return</span> p0 - np.square(p1 - p0) / d</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a97c9de0ba2c6509c1c8ecaaa999f1c" name="a6a97c9de0ba2c6509c1c8ecaaa999f1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a97c9de0ba2c6509c1c8ecaaa999f1c">&#9670;&#160;</a></span>_fixed_point_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py._fixed_point_helper </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_accel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  929</span><span class="keyword">def </span>_fixed_point_helper(func, x0, args, xtol, maxiter, use_accel):</div>
<div class="line"><span class="lineno">  930</span>    p0 = x0</div>
<div class="line"><span class="lineno">  931</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(maxiter):</div>
<div class="line"><span class="lineno">  932</span>        p1 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p0, *args)</div>
<div class="line"><span class="lineno">  933</span>        <span class="keywordflow">if</span> use_accel:</div>
<div class="line"><span class="lineno">  934</span>            p2 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(p1, *args)</div>
<div class="line"><span class="lineno">  935</span>            d = p2 - 2.0 * p1 + p0</div>
<div class="line"><span class="lineno">  936</span>            p = _lazywhere(d != 0, (p0, p1, d), f=_del2, fillvalue=p2)</div>
<div class="line"><span class="lineno">  937</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  938</span>            p = p1</div>
<div class="line"><span class="lineno">  939</span>        relerr = _lazywhere(p0 != 0, (p, p0), f=_relerr, fillvalue=p)</div>
<div class="line"><span class="lineno">  940</span>        <span class="keywordflow">if</span> np.all(np.abs(relerr) &lt; xtol):</div>
<div class="line"><span class="lineno">  941</span>            <span class="keywordflow">return</span> p</div>
<div class="line"><span class="lineno">  942</span>        p0 = p</div>
<div class="line"><span class="lineno">  943</span>    msg = <span class="stringliteral">&quot;Failed to converge after %d iterations, value is %s&quot;</span> % (maxiter, p)</div>
<div class="line"><span class="lineno">  944</span>    <span class="keywordflow">raise</span> RuntimeError(msg)</div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1fa5c1a79e4cdc68faa93a6bc569065" name="ae1fa5c1a79e4cdc68faa93a6bc569065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1fa5c1a79e4cdc68faa93a6bc569065">&#9670;&#160;</a></span>_initialize_feasible()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py._initialize_feasible </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  516</span><span class="keyword">def </span>_initialize_feasible(lb, ub):</div>
<div class="line"><span class="lineno">  517</span>    p0 = np.ones_like(lb)</div>
<div class="line"><span class="lineno">  518</span>    lb_finite = np.isfinite(lb)</div>
<div class="line"><span class="lineno">  519</span>    ub_finite = np.isfinite(ub)</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>    mask = lb_finite &amp; ub_finite</div>
<div class="line"><span class="lineno">  522</span>    p0[mask] = 0.5 * (lb[mask] + ub[mask])</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>    mask = lb_finite &amp; ~ub_finite</div>
<div class="line"><span class="lineno">  525</span>    p0[mask] = lb[mask] + 1</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>    mask = ~lb_finite &amp; ub_finite</div>
<div class="line"><span class="lineno">  528</span>    p0[mask] = ub[mask] - 1</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordflow">return</span> p0</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a54585950876e6b1ef7cdcfb9111bca4c" name="a54585950876e6b1ef7cdcfb9111bca4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54585950876e6b1ef7cdcfb9111bca4c">&#9670;&#160;</a></span>_relerr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py._relerr </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>actual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>desired</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  925</span><span class="keyword">def </span>_relerr(actual, desired):</div>
<div class="line"><span class="lineno">  926</span>    <span class="keywordflow">return</span> (actual - desired) / desired</div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad63900349ce05baf9219995d2c7c974f" name="ad63900349ce05baf9219995d2c7c974f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad63900349ce05baf9219995d2c7c974f">&#9670;&#160;</a></span>_root_hybr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py._root_hybr </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>col_deriv</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1.49012e-08</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfev</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>band</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>factor</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>diag</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Find the roots of a multivariate function using MINPACK's hybrd and
hybrj routines (modified Powell method).

Options
-------
col_deriv : bool
    Specify whether the Jacobian function computes derivatives down
    the columns (faster, because there is no transpose operation).
xtol : float
    The calculation will terminate if the relative error between two
    consecutive iterates is at most `xtol`.
maxfev : int
    The maximum number of calls to the function. If zero, then
    ``100*(N+1)`` is the maximum where N is the number of elements
    in `x0`.
band : tuple
    If set to a two-sequence containing the number of sub- and
    super-diagonals within the band of the Jacobi matrix, the
    Jacobi matrix is considered banded (only for ``fprime=None``).
eps : float
    A suitable step length for the forward-difference
    approximation of the Jacobian (for ``fprime=None``). If
    `eps` is less than the machine precision, it is assumed
    that the relative errors in the functions are of the order of
    the machine precision.
factor : float
    A parameter determining the initial step bound
    (``factor * || diag * x||``). Should be in the interval
    ``(0.1, 100)``.
diag : sequence
    N positive entries that serve as a scale factors for the
    variables.</pre> <div class="fragment"><div class="line"><span class="lineno">  183</span>               factor=100, diag=<span class="keywordtype">None</span>, **unknown_options):</div>
<div class="line"><span class="lineno">  184</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">    Find the roots of a multivariate function using MINPACK&#39;s hybrd and</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    hybrj routines (modified Powell method).</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    col_deriv : bool</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">        Specify whether the Jacobian function computes derivatives down</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">        the columns (faster, because there is no transpose operation).</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    xtol : float</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">        The calculation will terminate if the relative error between two</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">        consecutive iterates is at most `xtol`.</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">    maxfev : int</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">        The maximum number of calls to the function. If zero, then</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">        ``100*(N+1)`` is the maximum where N is the number of elements</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">        in `x0`.</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    band : tuple</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">        If set to a two-sequence containing the number of sub- and</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">        super-diagonals within the band of the Jacobi matrix, the</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">        Jacobi matrix is considered banded (only for ``fprime=None``).</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    eps : float</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">        A suitable step length for the forward-difference</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">        approximation of the Jacobian (for ``fprime=None``). If</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">        `eps` is less than the machine precision, it is assumed</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">        that the relative errors in the functions are of the order of</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">        the machine precision.</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    factor : float</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">        A parameter determining the initial step bound</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">        (``factor * || diag * x||``). Should be in the interval</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">        ``(0.1, 100)``.</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">    diag : sequence</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">        N positive entries that serve as a scale factors for the</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">        variables.</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  219</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno">  220</span>    epsfcn = eps</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    x0 = asarray(x0).flatten()</div>
<div class="line"><span class="lineno">  223</span>    n = len(x0)</div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(args, tuple):</div>
<div class="line"><span class="lineno">  225</span>        args = (args,)</div>
<div class="line"><span class="lineno">  226</span>    shape, dtype = _check_func(<span class="stringliteral">&#39;fsolve&#39;</span>, <span class="stringliteral">&#39;func&#39;</span>, func, x0, args, n, (n,))</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">if</span> epsfcn <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  228</span>        epsfcn = finfo(dtype).eps</div>
<div class="line"><span class="lineno">  229</span>    Dfun = jac</div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">if</span> Dfun <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">if</span> band <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  232</span>            ml, mu = -10, -10</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  234</span>            ml, mu = band[:2]</div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordflow">if</span> maxfev == 0:</div>
<div class="line"><span class="lineno">  236</span>            maxfev = 200 * (n + 1)</div>
<div class="line"><span class="lineno">  237</span>        retval = _minpack._hybrd(func, x0, args, 1, xtol, maxfev,</div>
<div class="line"><span class="lineno">  238</span>                                 ml, mu, epsfcn, factor, diag)</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  240</span>        _check_func(<span class="stringliteral">&#39;fsolve&#39;</span>, <span class="stringliteral">&#39;fprime&#39;</span>, Dfun, x0, args, n, (n, n))</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">if</span> (maxfev == 0):</div>
<div class="line"><span class="lineno">  242</span>            maxfev = 100 * (n + 1)</div>
<div class="line"><span class="lineno">  243</span>        retval = _minpack._hybrj(func, Dfun, x0, args, 1,</div>
<div class="line"><span class="lineno">  244</span>                                 col_deriv, xtol, maxfev, factor, diag)</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    x, status = retval[0], retval[-1]</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    errors = {0: <span class="stringliteral">&quot;Improper input parameters were entered.&quot;</span>,</div>
<div class="line"><span class="lineno">  249</span>              1: <span class="stringliteral">&quot;The solution converged.&quot;</span>,</div>
<div class="line"><span class="lineno">  250</span>              2: <span class="stringliteral">&quot;The number of calls to function has &quot;</span></div>
<div class="line"><span class="lineno">  251</span>                  <span class="stringliteral">&quot;reached maxfev = %d.&quot;</span> % maxfev,</div>
<div class="line"><span class="lineno">  252</span>              3: <span class="stringliteral">&quot;xtol=%f is too small, no further improvement &quot;</span></div>
<div class="line"><span class="lineno">  253</span>                  <span class="stringliteral">&quot;in the approximate\n  solution &quot;</span></div>
<div class="line"><span class="lineno">  254</span>                  <span class="stringliteral">&quot;is possible.&quot;</span> % xtol,</div>
<div class="line"><span class="lineno">  255</span>              4: <span class="stringliteral">&quot;The iteration is not making good progress, as measured &quot;</span></div>
<div class="line"><span class="lineno">  256</span>                  <span class="stringliteral">&quot;by the \n  improvement from the last five &quot;</span></div>
<div class="line"><span class="lineno">  257</span>                  <span class="stringliteral">&quot;Jacobian evaluations.&quot;</span>,</div>
<div class="line"><span class="lineno">  258</span>              5: <span class="stringliteral">&quot;The iteration is not making good progress, &quot;</span></div>
<div class="line"><span class="lineno">  259</span>                  <span class="stringliteral">&quot;as measured by the \n  improvement from the last &quot;</span></div>
<div class="line"><span class="lineno">  260</span>                  <span class="stringliteral">&quot;ten iterations.&quot;</span>,</div>
<div class="line"><span class="lineno">  261</span>              <span class="stringliteral">&#39;unknown&#39;</span>: <span class="stringliteral">&quot;An error occurred.&quot;</span>}</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    info = retval[1]</div>
<div class="line"><span class="lineno">  264</span>    info[<span class="stringliteral">&#39;fun&#39;</span>] = info.pop(<span class="stringliteral">&#39;fvec&#39;</span>)</div>
<div class="line"><span class="lineno">  265</span>    sol = OptimizeResult(x=x, success=(status == 1), status=status)</div>
<div class="line"><span class="lineno">  266</span>    sol.update(info)</div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  268</span>        sol[<span class="stringliteral">&#39;message&#39;</span>] = errors[status]</div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">except</span> KeyError:</div>
<div class="line"><span class="lineno">  270</span>        sol[<span class="stringliteral">&#39;message&#39;</span>] = errors[<span class="stringliteral">&#39;unknown&#39;</span>]</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">return</span> sol</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f4bd6dad43c084a1d76e0b253257f5c" name="a4f4bd6dad43c084a1d76e0b253257f5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f4bd6dad43c084a1d76e0b253257f5c">&#9670;&#160;</a></span>_wrap_func()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py._wrap_func </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ydata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>transform</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  482</span><span class="keyword">def </span>_wrap_func(func, xdata, ydata, transform):</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">if</span> transform <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  484</span>        <span class="keyword">def </span>func_wrapped(params):</div>
<div class="line"><span class="lineno">  485</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xdata, *params) - ydata</div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">elif</span> transform.ndim == 1:</div>
<div class="line"><span class="lineno">  487</span>        <span class="keyword">def </span>func_wrapped(params):</div>
<div class="line"><span class="lineno">  488</span>            <span class="keywordflow">return</span> transform * (<a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xdata, *params) - ydata)</div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  490</span>        <span class="comment"># Chisq = (y - yd)^T C^{-1} (y-yd)</span></div>
<div class="line"><span class="lineno">  491</span>        <span class="comment"># transform = L such that C = L L^T</span></div>
<div class="line"><span class="lineno">  492</span>        <span class="comment"># C^{-1} = L^{-T} L^{-1}</span></div>
<div class="line"><span class="lineno">  493</span>        <span class="comment"># Chisq = (y - yd)^T L^{-T} L^{-1} (y-yd)</span></div>
<div class="line"><span class="lineno">  494</span>        <span class="comment"># Define (y-yd)&#39; = L^{-1} (y-yd)</span></div>
<div class="line"><span class="lineno">  495</span>        <span class="comment"># by solving</span></div>
<div class="line"><span class="lineno">  496</span>        <span class="comment"># L (y-yd)&#39; = (y-yd)</span></div>
<div class="line"><span class="lineno">  497</span>        <span class="comment"># and minimize (y-yd)&#39;^T (y-yd)&#39;</span></div>
<div class="line"><span class="lineno">  498</span>        <span class="keyword">def </span>func_wrapped(params):</div>
<div class="line"><span class="lineno">  499</span>            <span class="keywordflow">return</span> solve_triangular(transform, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xdata, *params) - ydata, lower=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordflow">return</span> func_wrapped</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6ae4f52aeed582dbd315aa288970096" name="ac6ae4f52aeed582dbd315aa288970096"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6ae4f52aeed582dbd315aa288970096">&#9670;&#160;</a></span>_wrap_jac()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py._wrap_jac </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>transform</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  503</span><span class="keyword">def </span>_wrap_jac(jac, xdata, transform):</div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">if</span> transform <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  505</span>        <span class="keyword">def </span>jac_wrapped(params):</div>
<div class="line"><span class="lineno">  506</span>            <span class="keywordflow">return</span> jac(xdata, *params)</div>
<div class="line"><span class="lineno">  507</span>    <span class="keywordflow">elif</span> transform.ndim == 1:</div>
<div class="line"><span class="lineno">  508</span>        <span class="keyword">def </span>jac_wrapped(params):</div>
<div class="line"><span class="lineno">  509</span>            <span class="keywordflow">return</span> transform[:, np.newaxis] * np.asarray(jac(xdata, *params))</div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  511</span>        <span class="keyword">def </span>jac_wrapped(params):</div>
<div class="line"><span class="lineno">  512</span>            <span class="keywordflow">return</span> solve_triangular(transform, np.asarray(jac(xdata, *params)), lower=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">return</span> jac_wrapped</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a73a8386efd904c9a52d844210ec9a5b2" name="a73a8386efd904c9a52d844210ec9a5b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a8386efd904c9a52d844210ec9a5b2">&#9670;&#160;</a></span>check_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py.check_gradient </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Dfcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>col_deriv</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Perform a simple check on the gradient for correctness.</pre> <div class="fragment"><div class="line"><span class="lineno">  890</span><span class="keyword">def </span>check_gradient(fcn, Dfcn, x0, args=(), col_deriv=0):</div>
<div class="line"><span class="lineno">  891</span>    <span class="stringliteral">&quot;&quot;&quot;Perform a simple check on the gradient for correctness.</span></div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>    x = atleast_1d(x0)</div>
<div class="line"><span class="lineno">  896</span>    n = len(x)</div>
<div class="line"><span class="lineno">  897</span>    x = x.reshape((n,))</div>
<div class="line"><span class="lineno">  898</span>    fvec = atleast_1d(fcn(x, *args))</div>
<div class="line"><span class="lineno">  899</span>    m = len(fvec)</div>
<div class="line"><span class="lineno">  900</span>    fvec = fvec.reshape((m,))</div>
<div class="line"><span class="lineno">  901</span>    ldfjac = m</div>
<div class="line"><span class="lineno">  902</span>    fjac = atleast_1d(Dfcn(x, *args))</div>
<div class="line"><span class="lineno">  903</span>    fjac = fjac.reshape((m, n))</div>
<div class="line"><span class="lineno">  904</span>    <span class="keywordflow">if</span> col_deriv == 0:</div>
<div class="line"><span class="lineno">  905</span>        fjac = transpose(fjac)</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>    xp = zeros((n,), float)</div>
<div class="line"><span class="lineno">  908</span>    err = zeros((m,), float)</div>
<div class="line"><span class="lineno">  909</span>    fvecp = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  910</span>    _minpack._chkder(m, n, x, fvec, fjac, ldfjac, xp, fvecp, 1, err)</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>    fvecp = atleast_1d(fcn(xp, *args))</div>
<div class="line"><span class="lineno">  913</span>    fvecp = fvecp.reshape((m,))</div>
<div class="line"><span class="lineno">  914</span>    _minpack._chkder(m, n, x, fvec, fjac, ldfjac, xp, fvecp, 2, err)</div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span>    good = (prod(greater(err, 0.5), axis=0))</div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>    <span class="keywordflow">return</span> (good, err)</div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a95e83f6b5d343fa6f3038f9dcf01b3f1" name="a95e83f6b5d343fa6f3038f9dcf01b3f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95e83f6b5d343fa6f3038f9dcf01b3f1">&#9670;&#160;</a></span>curve_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py.curve_fit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ydata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p0</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sigma</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>absolute_sigma</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_finite</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em> = <code>(-np.inf,&#160;np.inf)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Use non-linear least squares to fit a function, f, to data.

Assumes ``ydata = f(xdata, *params) + eps``.

Parameters
----------
f : callable
    The model function, f(x, ...). It must take the independent
    variable as the first argument and the parameters to fit as
    separate remaining arguments.
xdata : array_like or object
    The independent variable where the data is measured.
    Should usually be an M-length sequence or an (k,M)-shaped array for
    functions with k predictors, but can actually be any object.
ydata : array_like
    The dependent data, a length M array - nominally ``f(xdata, ...)``.
p0 : array_like, optional
    Initial guess for the parameters (length N). If None, then the
    initial values will all be 1 (if the number of parameters for the
    function can be determined using introspection, otherwise a
    ValueError is raised).
sigma : None or M-length sequence or MxM array, optional
    Determines the uncertainty in `ydata`. If we define residuals as
    ``r = ydata - f(xdata, *popt)``, then the interpretation of `sigma`
    depends on its number of dimensions:

        - A 1-D `sigma` should contain values of standard deviations of
          errors in `ydata`. In this case, the optimized function is
          ``chisq = sum((r / sigma) ** 2)``.

        - A 2-D `sigma` should contain the covariance matrix of
          errors in `ydata`. In this case, the optimized function is
          ``chisq = r.T @ inv(sigma) @ r``.

          .. versionadded:: 0.19

    None (default) is equivalent of 1-D `sigma` filled with ones.
absolute_sigma : bool, optional
    If True, `sigma` is used in an absolute sense and the estimated parameter
    covariance `pcov` reflects these absolute values.

    If False (default), only the relative magnitudes of the `sigma` values matter.
    The returned parameter covariance matrix `pcov` is based on scaling
    `sigma` by a constant factor. This constant is set by demanding that the
    reduced `chisq` for the optimal parameters `popt` when using the
    *scaled* `sigma` equals unity. In other words, `sigma` is scaled to
    match the sample variance of the residuals after the fit. Default is False.
    Mathematically,
    ``pcov(absolute_sigma=False) = pcov(absolute_sigma=True) * chisq(popt)/(M-N)``
check_finite : bool, optional
    If True, check that the input arrays do not contain nans of infs,
    and raise a ValueError if they do. Setting this parameter to
    False may silently produce nonsensical results if the input arrays
    do contain nans. Default is True.
bounds : 2-tuple of array_like, optional
    Lower and upper bounds on parameters. Defaults to no bounds.
    Each element of the tuple must be either an array with the length equal
    to the number of parameters, or a scalar (in which case the bound is
    taken to be the same for all parameters). Use ``np.inf`` with an
    appropriate sign to disable bounds on all or some parameters.

    .. versionadded:: 0.17
method : {'lm', 'trf', 'dogbox'}, optional
    Method to use for optimization. See `least_squares` for more details.
    Default is 'lm' for unconstrained problems and 'trf' if `bounds` are
    provided. The method 'lm' won't work when the number of observations
    is less than the number of variables, use 'trf' or 'dogbox' in this
    case.

    .. versionadded:: 0.17
jac : callable, string or None, optional
    Function with signature ``jac(x, ...)`` which computes the Jacobian
    matrix of the model function with respect to parameters as a dense
    array_like structure. It will be scaled according to provided `sigma`.
    If None (default), the Jacobian will be estimated numerically.
    String keywords for 'trf' and 'dogbox' methods can be used to select
    a finite difference scheme, see `least_squares`.

    .. versionadded:: 0.18
full_output : boolean, optional
    If True, this function returns additioal information: `infodict`,
    `mesg`, and `ier`.

    .. versionadded:: 1.9
**kwargs
    Keyword arguments passed to `leastsq` for ``method='lm'`` or
    `least_squares` otherwise.

Returns
-------
popt : array
    Optimal values for the parameters so that the sum of the squared
    residuals of ``f(xdata, *popt) - ydata`` is minimized.
pcov : 2-D array
    The estimated covariance of popt. The diagonals provide the variance
    of the parameter estimate. To compute one standard deviation errors
    on the parameters use ``perr = np.sqrt(np.diag(pcov))``.

    How the `sigma` parameter affects the estimated covariance
    depends on `absolute_sigma` argument, as described above.

    If the Jacobian matrix at the solution doesn't have a full rank, then
    'lm' method returns a matrix filled with ``np.inf``, on the other hand
    'trf'  and 'dogbox' methods use Moore-Penrose pseudoinverse to compute
    the covariance matrix.
infodict : dict (returned only if `full_output` is True)
    a dictionary of optional outputs with the keys:

    ``nfev``
        The number of function calls. Methods 'trf' and 'dogbox' do not
        count function calls for numerical Jacobian approximation,
        as opposed to 'lm' method.
    ``fvec``
        The function values evaluated at the solution.
    ``fjac``
        A permutation of the R matrix of a QR
        factorization of the final approximate
        Jacobian matrix, stored column wise.
        Together with ipvt, the covariance of the
        estimate can be approximated.
        Method 'lm' only provides this information.
    ``ipvt``
        An integer array of length N which defines
        a permutation matrix, p, such that
        fjac*p = q*r, where r is upper triangular
        with diagonal elements of nonincreasing
        magnitude. Column j of p is column ipvt(j)
        of the identity matrix.
        Method 'lm' only provides this information.
    ``qtf``
        The vector (transpose(q) * fvec).
        Method 'lm' only provides this information.

    .. versionadded:: 1.9
mesg : str (returned only if `full_output` is True)
    A string message giving information about the solution.

    .. versionadded:: 1.9
ier : int (returnned only if `full_output` is True)
    An integer flag. If it is equal to 1, 2, 3 or 4, the solution was
    found. Otherwise, the solution was not found. In either case, the
    optional output variable `mesg` gives more information.

    .. versionadded:: 1.9

Raises
------
ValueError
    if either `ydata` or `xdata` contain NaNs, or if incompatible options
    are used.

RuntimeError
    if the least-squares minimization fails.

OptimizeWarning
    if covariance of the parameters can not be estimated.

See Also
--------
least_squares : Minimize the sum of squares of nonlinear functions.
scipy.stats.linregress : Calculate a linear least squares regression for
                         two sets of measurements.

Notes
-----
Users should ensure that inputs `xdata`, `ydata`, and the output of `f`
are ``float64``, or else the optimization may return incorrect results.

With ``method='lm'``, the algorithm uses the Levenberg-Marquardt algorithm
through `leastsq`. Note that this algorithm can only deal with
unconstrained problems.

Box constraints can be handled by methods 'trf' and 'dogbox'. Refer to
the docstring of `least_squares` for more information.

Examples
--------
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; from scipy.optimize import curve_fit

&gt;&gt;&gt; def func(x, a, b, c):
...     return a * np.exp(-b * x) + c

Define the data to be fit with some noise:

&gt;&gt;&gt; xdata = np.linspace(0, 4, 50)
&gt;&gt;&gt; y = func(xdata, 2.5, 1.3, 0.5)
&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; y_noise = 0.2 * rng.normal(size=xdata.size)
&gt;&gt;&gt; ydata = y + y_noise
&gt;&gt;&gt; plt.plot(xdata, ydata, 'b-', label='data')

Fit for the parameters a, b, c of the function `func`:

&gt;&gt;&gt; popt, pcov = curve_fit(func, xdata, ydata)
&gt;&gt;&gt; popt
array([2.56274217, 1.37268521, 0.47427475])
&gt;&gt;&gt; plt.plot(xdata, func(xdata, *popt), 'r-',
...          label='fit: a=%5.3f, b=%5.3f, c=%5.3f' % tuple(popt))

Constrain the optimization to the region of ``0 &lt;= a &lt;= 3``,
``0 &lt;= b &lt;= 1`` and ``0 &lt;= c &lt;= 0.5``:

&gt;&gt;&gt; popt, pcov = curve_fit(func, xdata, ydata, bounds=(0, [3., 1., 0.5]))
&gt;&gt;&gt; popt
array([2.43736712, 1.        , 0.34463856])
&gt;&gt;&gt; plt.plot(xdata, func(xdata, *popt), 'g--',
...          label='fit: a=%5.3f, b=%5.3f, c=%5.3f' % tuple(popt))

&gt;&gt;&gt; plt.xlabel('x')
&gt;&gt;&gt; plt.ylabel('y')
&gt;&gt;&gt; plt.legend()
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  535</span>              jac=<span class="keywordtype">None</span>, *, full_output=<span class="keyword">False</span>, **kwargs):</div>
<div class="line"><span class="lineno">  536</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral">    Use non-linear least squares to fit a function, f, to data.</span></div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">    Assumes ``ydata = f(xdata, *params) + eps``.</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral">    f : callable</span></div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">        The model function, f(x, ...). It must take the independent</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">        variable as the first argument and the parameters to fit as</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">        separate remaining arguments.</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">    xdata : array_like or object</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">        The independent variable where the data is measured.</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">        Should usually be an M-length sequence or an (k,M)-shaped array for</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">        functions with k predictors, but can actually be any object.</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">    ydata : array_like</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">        The dependent data, a length M array - nominally ``f(xdata, ...)``.</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral">    p0 : array_like, optional</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">        Initial guess for the parameters (length N). If None, then the</span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">        initial values will all be 1 (if the number of parameters for the</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">        function can be determined using introspection, otherwise a</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">        ValueError is raised).</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">    sigma : None or M-length sequence or MxM array, optional</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">        Determines the uncertainty in `ydata`. If we define residuals as</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">        ``r = ydata - f(xdata, *popt)``, then the interpretation of `sigma`</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        depends on its number of dimensions:</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">            - A 1-D `sigma` should contain values of standard deviations of</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">              errors in `ydata`. In this case, the optimized function is</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">              ``chisq = sum((r / sigma) ** 2)``.</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">            - A 2-D `sigma` should contain the covariance matrix of</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">              errors in `ydata`. In this case, the optimized function is</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">              ``chisq = r.T @ inv(sigma) @ r``.</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">              .. versionadded:: 0.19</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">        None (default) is equivalent of 1-D `sigma` filled with ones.</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">    absolute_sigma : bool, optional</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">        If True, `sigma` is used in an absolute sense and the estimated parameter</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">        covariance `pcov` reflects these absolute values.</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">        If False (default), only the relative magnitudes of the `sigma` values matter.</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">        The returned parameter covariance matrix `pcov` is based on scaling</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">        `sigma` by a constant factor. This constant is set by demanding that the</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">        reduced `chisq` for the optimal parameters `popt` when using the</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">        *scaled* `sigma` equals unity. In other words, `sigma` is scaled to</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral">        match the sample variance of the residuals after the fit. Default is False.</span></div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">        Mathematically,</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">        ``pcov(absolute_sigma=False) = pcov(absolute_sigma=True) * chisq(popt)/(M-N)``</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">    check_finite : bool, optional</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">        If True, check that the input arrays do not contain nans of infs,</span></div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">        and raise a ValueError if they do. Setting this parameter to</span></div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">        False may silently produce nonsensical results if the input arrays</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">        do contain nans. Default is True.</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral">    bounds : 2-tuple of array_like, optional</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">        Lower and upper bounds on parameters. Defaults to no bounds.</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral">        Each element of the tuple must be either an array with the length equal</span></div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">        to the number of parameters, or a scalar (in which case the bound is</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">        taken to be the same for all parameters). Use ``np.inf`` with an</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral">        appropriate sign to disable bounds on all or some parameters.</span></div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">        .. versionadded:: 0.17</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">    method : {&#39;lm&#39;, &#39;trf&#39;, &#39;dogbox&#39;}, optional</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral">        Method to use for optimization. See `least_squares` for more details.</span></div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral">        Default is &#39;lm&#39; for unconstrained problems and &#39;trf&#39; if `bounds` are</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">        provided. The method &#39;lm&#39; won&#39;t work when the number of observations</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">        is less than the number of variables, use &#39;trf&#39; or &#39;dogbox&#39; in this</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">        case.</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral">        .. versionadded:: 0.17</span></div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">    jac : callable, string or None, optional</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">        Function with signature ``jac(x, ...)`` which computes the Jacobian</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral">        matrix of the model function with respect to parameters as a dense</span></div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral">        array_like structure. It will be scaled according to provided `sigma`.</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">        If None (default), the Jacobian will be estimated numerically.</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral">        String keywords for &#39;trf&#39; and &#39;dogbox&#39; methods can be used to select</span></div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">        a finite difference scheme, see `least_squares`.</span></div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  615</span><span class="stringliteral">        .. versionadded:: 0.18</span></div>
<div class="line"><span class="lineno">  616</span><span class="stringliteral">    full_output : boolean, optional</span></div>
<div class="line"><span class="lineno">  617</span><span class="stringliteral">        If True, this function returns additioal information: `infodict`,</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">        `mesg`, and `ier`.</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral">        .. versionadded:: 1.9</span></div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral">    **kwargs</span></div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral">        Keyword arguments passed to `leastsq` for ``method=&#39;lm&#39;`` or</span></div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral">        `least_squares` otherwise.</span></div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">    popt : array</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">        Optimal values for the parameters so that the sum of the squared</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral">        residuals of ``f(xdata, *popt) - ydata`` is minimized.</span></div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">    pcov : 2-D array</span></div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral">        The estimated covariance of popt. The diagonals provide the variance</span></div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">        of the parameter estimate. To compute one standard deviation errors</span></div>
<div class="line"><span class="lineno">  633</span><span class="stringliteral">        on the parameters use ``perr = np.sqrt(np.diag(pcov))``.</span></div>
<div class="line"><span class="lineno">  634</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  635</span><span class="stringliteral">        How the `sigma` parameter affects the estimated covariance</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral">        depends on `absolute_sigma` argument, as described above.</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral">        If the Jacobian matrix at the solution doesn&#39;t have a full rank, then</span></div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral">        &#39;lm&#39; method returns a matrix filled with ``np.inf``, on the other hand</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">        &#39;trf&#39;  and &#39;dogbox&#39; methods use Moore-Penrose pseudoinverse to compute</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">        the covariance matrix.</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">    infodict : dict (returned only if `full_output` is True)</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral">        a dictionary of optional outputs with the keys:</span></div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">        ``nfev``</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">            The number of function calls. Methods &#39;trf&#39; and &#39;dogbox&#39; do not</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral">            count function calls for numerical Jacobian approximation,</span></div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral">            as opposed to &#39;lm&#39; method.</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">        ``fvec``</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral">            The function values evaluated at the solution.</span></div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">        ``fjac``</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral">            A permutation of the R matrix of a QR</span></div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">            factorization of the final approximate</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">            Jacobian matrix, stored column wise.</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">            Together with ipvt, the covariance of the</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">            estimate can be approximated.</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">            Method &#39;lm&#39; only provides this information.</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral">        ``ipvt``</span></div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">            An integer array of length N which defines</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">            a permutation matrix, p, such that</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">            fjac*p = q*r, where r is upper triangular</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">            with diagonal elements of nonincreasing</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">            magnitude. Column j of p is column ipvt(j)</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">            of the identity matrix.</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">            Method &#39;lm&#39; only provides this information.</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">        ``qtf``</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">            The vector (transpose(q) * fvec).</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">            Method &#39;lm&#39; only provides this information.</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral">        .. versionadded:: 1.9</span></div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">    mesg : str (returned only if `full_output` is True)</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">        A string message giving information about the solution.</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">        .. versionadded:: 1.9</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral">    ier : int (returnned only if `full_output` is True)</span></div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral">        An integer flag. If it is equal to 1, 2, 3 or 4, the solution was</span></div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral">        found. Otherwise, the solution was not found. In either case, the</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">        optional output variable `mesg` gives more information.</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral">        .. versionadded:: 1.9</span></div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">    ValueError</span></div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral">        if either `ydata` or `xdata` contain NaNs, or if incompatible options</span></div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral">        are used.</span></div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral">    RuntimeError</span></div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral">        if the least-squares minimization fails.</span></div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral">    OptimizeWarning</span></div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral">        if covariance of the parameters can not be estimated.</span></div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral">    least_squares : Minimize the sum of squares of nonlinear functions.</span></div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">    scipy.stats.linregress : Calculate a linear least squares regression for</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">                             two sets of measurements.</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral">    Users should ensure that inputs `xdata`, `ydata`, and the output of `f`</span></div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">    are ``float64``, or else the optimization may return incorrect results.</span></div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral">    With ``method=&#39;lm&#39;``, the algorithm uses the Levenberg-Marquardt algorithm</span></div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral">    through `leastsq`. Note that this algorithm can only deal with</span></div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral">    unconstrained problems.</span></div>
<div class="line"><span class="lineno">  708</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  709</span><span class="stringliteral">    Box constraints can be handled by methods &#39;trf&#39; and &#39;dogbox&#39;. Refer to</span></div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral">    the docstring of `least_squares` for more information.</span></div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  712</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  713</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import curve_fit</span></div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">    &gt;&gt;&gt; def func(x, a, b, c):</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">    ...     return a * np.exp(-b * x) + c</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral">    Define the data to be fit with some noise:</span></div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">    &gt;&gt;&gt; xdata = np.linspace(0, 4, 50)</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">    &gt;&gt;&gt; y = func(xdata, 2.5, 1.3, 0.5)</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral">    &gt;&gt;&gt; rng = np.random.default_rng()</span></div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">    &gt;&gt;&gt; y_noise = 0.2 * rng.normal(size=xdata.size)</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">    &gt;&gt;&gt; ydata = y + y_noise</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(xdata, ydata, &#39;b-&#39;, label=&#39;data&#39;)</span></div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">    Fit for the parameters a, b, c of the function `func`:</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">    &gt;&gt;&gt; popt, pcov = curve_fit(func, xdata, ydata)</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">    &gt;&gt;&gt; popt</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">    array([2.56274217, 1.37268521, 0.47427475])</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(xdata, func(xdata, *popt), &#39;r-&#39;,</span></div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">    ...          label=&#39;fit: a=%5.3f, b=%5.3f, c=%5.3f&#39; % tuple(popt))</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">    Constrain the optimization to the region of ``0 &lt;= a &lt;= 3``,</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">    ``0 &lt;= b &lt;= 1`` and ``0 &lt;= c &lt;= 0.5``:</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">    &gt;&gt;&gt; popt, pcov = curve_fit(func, xdata, ydata, bounds=(0, [3., 1., 0.5]))</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">    &gt;&gt;&gt; popt</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">    array([2.43736712, 1.        , 0.34463856])</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(xdata, func(xdata, *popt), &#39;g--&#39;,</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">    ...          label=&#39;fit: a=%5.3f, b=%5.3f, c=%5.3f&#39; % tuple(popt))</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;x&#39;)</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;y&#39;)</span></div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">    &gt;&gt;&gt; plt.legend()</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">if</span> p0 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  753</span>        <span class="comment"># determine number of parameters by inspecting the function</span></div>
<div class="line"><span class="lineno">  754</span>        sig = _getfullargspec(f)</div>
<div class="line"><span class="lineno">  755</span>        args = sig.args</div>
<div class="line"><span class="lineno">  756</span>        <span class="keywordflow">if</span> len(args) &lt; 2:</div>
<div class="line"><span class="lineno">  757</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unable to determine number of fit parameters.&quot;</span>)</div>
<div class="line"><span class="lineno">  758</span>        n = len(args) - 1</div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  760</span>        p0 = np.atleast_1d(p0)</div>
<div class="line"><span class="lineno">  761</span>        n = p0.size</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>    lb, ub = prepare_bounds(bounds, n)</div>
<div class="line"><span class="lineno">  764</span>    <span class="keywordflow">if</span> p0 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  765</span>        p0 = _initialize_feasible(lb, ub)</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    bounded_problem = np.any((lb &gt; -np.inf) | (ub &lt; np.inf))</div>
<div class="line"><span class="lineno">  768</span>    <span class="keywordflow">if</span> method <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  769</span>        <span class="keywordflow">if</span> bounded_problem:</div>
<div class="line"><span class="lineno">  770</span>            method = <span class="stringliteral">&#39;trf&#39;</span></div>
<div class="line"><span class="lineno">  771</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  772</span>            method = <span class="stringliteral">&#39;lm&#39;</span></div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;lm&#39;</span> <span class="keywordflow">and</span> bounded_problem:</div>
<div class="line"><span class="lineno">  775</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Method &#39;lm&#39; only works for unconstrained problems. &quot;</span></div>
<div class="line"><span class="lineno">  776</span>                         <span class="stringliteral">&quot;Use &#39;trf&#39; or &#39;dogbox&#39; instead.&quot;</span>)</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>    <span class="comment"># optimization may produce garbage for float32 inputs, cast them to float64</span></div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>    <span class="comment"># NaNs cannot be handled</span></div>
<div class="line"><span class="lineno">  781</span>    <span class="keywordflow">if</span> check_finite:</div>
<div class="line"><span class="lineno">  782</span>        ydata = np.asarray_chkfinite(ydata, float)</div>
<div class="line"><span class="lineno">  783</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  784</span>        ydata = np.asarray(ydata, float)</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>    <span class="keywordflow">if</span> isinstance(xdata, (list, tuple, np.ndarray)):</div>
<div class="line"><span class="lineno">  787</span>        <span class="comment"># `xdata` is passed straight to the user-defined `f`, so allow</span></div>
<div class="line"><span class="lineno">  788</span>        <span class="comment"># non-array_like `xdata`.</span></div>
<div class="line"><span class="lineno">  789</span>        <span class="keywordflow">if</span> check_finite:</div>
<div class="line"><span class="lineno">  790</span>            xdata = np.asarray_chkfinite(xdata, float)</div>
<div class="line"><span class="lineno">  791</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  792</span>            xdata = np.asarray(xdata, float)</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>    <span class="keywordflow">if</span> ydata.size == 0:</div>
<div class="line"><span class="lineno">  795</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`ydata` must not be empty!&quot;</span>)</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    <span class="comment"># Determine type of sigma</span></div>
<div class="line"><span class="lineno">  798</span>    <span class="keywordflow">if</span> sigma <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  799</span>        sigma = np.asarray(sigma)</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>        <span class="comment"># if 1-D, sigma are errors, define transform = 1/sigma</span></div>
<div class="line"><span class="lineno">  802</span>        <span class="keywordflow">if</span> sigma.shape == (ydata.size, ):</div>
<div class="line"><span class="lineno">  803</span>            transform = 1.0 / sigma</div>
<div class="line"><span class="lineno">  804</span>        <span class="comment"># if 2-D, sigma is the covariance matrix,</span></div>
<div class="line"><span class="lineno">  805</span>        <span class="comment"># define transform = L such that L L^T = C</span></div>
<div class="line"><span class="lineno">  806</span>        <span class="keywordflow">elif</span> sigma.shape == (ydata.size, ydata.size):</div>
<div class="line"><span class="lineno">  807</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  808</span>                <span class="comment"># scipy.linalg.cholesky requires lower=True to return L L^T = A</span></div>
<div class="line"><span class="lineno">  809</span>                transform = cholesky(sigma, lower=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  810</span>            <span class="keywordflow">except</span> LinAlgError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  811</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`sigma` must be positive definite.&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  812</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  813</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`sigma` has incorrect shape.&quot;</span>)</div>
<div class="line"><span class="lineno">  814</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  815</span>        transform = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    func = _wrap_func(f, xdata, ydata, transform)</div>
<div class="line"><span class="lineno">  818</span>    <span class="keywordflow">if</span> callable(jac):</div>
<div class="line"><span class="lineno">  819</span>        jac = _wrap_jac(jac, xdata, transform)</div>
<div class="line"><span class="lineno">  820</span>    <span class="keywordflow">elif</span> jac <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> method != <span class="stringliteral">&#39;lm&#39;</span>:</div>
<div class="line"><span class="lineno">  821</span>        jac = <span class="stringliteral">&#39;2-point&#39;</span></div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>    <span class="keywordflow">if</span> <span class="stringliteral">&#39;args&#39;</span> <span class="keywordflow">in</span> kwargs:</div>
<div class="line"><span class="lineno">  824</span>        <span class="comment"># The specification for the model function `f` does not support</span></div>
<div class="line"><span class="lineno">  825</span>        <span class="comment"># additional arguments. Refer to the `curve_fit` docstring for</span></div>
<div class="line"><span class="lineno">  826</span>        <span class="comment"># acceptable call signatures of `f`.</span></div>
<div class="line"><span class="lineno">  827</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;args&#39; is not a supported keyword argument.&quot;</span>)</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;lm&#39;</span>:</div>
<div class="line"><span class="lineno">  830</span>        <span class="comment"># if ydata.size == 1, this might be used for broadcast.</span></div>
<div class="line"><span class="lineno">  831</span>        <span class="keywordflow">if</span> ydata.size != 1 <span class="keywordflow">and</span> n &gt; ydata.size:</div>
<div class="line"><span class="lineno">  832</span>            <span class="keywordflow">raise</span> TypeError(f<span class="stringliteral">&quot;The number of func parameters={n} must not&quot;</span></div>
<div class="line"><span class="lineno">  833</span>                            f<span class="stringliteral">&quot; exceed the number of data points={ydata.size}&quot;</span>)</div>
<div class="line"><span class="lineno">  834</span>        res = leastsq(func, p0, Dfun=jac, full_output=1, **kwargs)</div>
<div class="line"><span class="lineno">  835</span>        popt, pcov, infodict, errmsg, ier = res</div>
<div class="line"><span class="lineno">  836</span>        ysize = len(infodict[<span class="stringliteral">&#39;fvec&#39;</span>])</div>
<div class="line"><span class="lineno">  837</span>        cost = np.sum(infodict[<span class="stringliteral">&#39;fvec&#39;</span>] ** 2)</div>
<div class="line"><span class="lineno">  838</span>        <span class="keywordflow">if</span> ier <span class="keywordflow">not</span> <span class="keywordflow">in</span> [1, 2, 3, 4]:</div>
<div class="line"><span class="lineno">  839</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;Optimal parameters not found: &quot;</span> + errmsg)</div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  841</span>        <span class="comment"># Rename maxfev (leastsq) to max_nfev (least_squares), if specified.</span></div>
<div class="line"><span class="lineno">  842</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;max_nfev&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> kwargs:</div>
<div class="line"><span class="lineno">  843</span>            kwargs[<span class="stringliteral">&#39;max_nfev&#39;</span>] = kwargs.pop(<span class="stringliteral">&#39;maxfev&#39;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>        res = least_squares(func, p0, jac=jac, bounds=bounds, method=method,</div>
<div class="line"><span class="lineno">  846</span>                            **kwargs)</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> res.success:</div>
<div class="line"><span class="lineno">  849</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;Optimal parameters not found: &quot;</span> + res.message)</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>        infodict = dict(nfev=res.nfev, fvec=res.fun)</div>
<div class="line"><span class="lineno">  852</span>        ier = res.status</div>
<div class="line"><span class="lineno">  853</span>        errmsg = res.message</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>        ysize = len(res.fun)</div>
<div class="line"><span class="lineno">  856</span>        cost = 2 * res.cost  <span class="comment"># res.cost is half sum of squares!</span></div>
<div class="line"><span class="lineno">  857</span>        popt = res.x</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>        <span class="comment"># Do Moore-Penrose inverse discarding zero singular values.</span></div>
<div class="line"><span class="lineno">  860</span>        _, s, VT = svd(res.jac, full_matrices=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  861</span>        threshold = np.finfo(float).eps * max(res.jac.shape) * s[0]</div>
<div class="line"><span class="lineno">  862</span>        s = s[s &gt; threshold]</div>
<div class="line"><span class="lineno">  863</span>        VT = VT[:s.size]</div>
<div class="line"><span class="lineno">  864</span>        pcov = np.dot(VT.T / s**2, VT)</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>    warn_cov = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  867</span>    <span class="keywordflow">if</span> pcov <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  868</span>        <span class="comment"># indeterminate covariance</span></div>
<div class="line"><span class="lineno">  869</span>        pcov = zeros((len(popt), len(popt)), dtype=float)</div>
<div class="line"><span class="lineno">  870</span>        pcov.fill(inf)</div>
<div class="line"><span class="lineno">  871</span>        warn_cov = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  872</span>    <span class="keywordflow">elif</span> <span class="keywordflow">not</span> absolute_sigma:</div>
<div class="line"><span class="lineno">  873</span>        <span class="keywordflow">if</span> ysize &gt; p0.size:</div>
<div class="line"><span class="lineno">  874</span>            s_sq = cost / (ysize - p0.size)</div>
<div class="line"><span class="lineno">  875</span>            pcov = pcov * s_sq</div>
<div class="line"><span class="lineno">  876</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  877</span>            pcov.fill(inf)</div>
<div class="line"><span class="lineno">  878</span>            warn_cov = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>    <span class="keywordflow">if</span> warn_cov:</div>
<div class="line"><span class="lineno">  881</span>        warnings.warn(<span class="stringliteral">&#39;Covariance of the parameters could not be estimated&#39;</span>,</div>
<div class="line"><span class="lineno">  882</span>                      category=OptimizeWarning)</div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno">  885</span>        <span class="keywordflow">return</span> popt, pcov, infodict, errmsg, ier</div>
<div class="line"><span class="lineno">  886</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  887</span>        <span class="keywordflow">return</span> popt, pcov</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3921803645e1d6711f394f3130a53134" name="a3921803645e1d6711f394f3130a53134"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3921803645e1d6711f394f3130a53134">&#9670;&#160;</a></span>fixed_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py.fixed_point </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>'del2'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find a fixed point of the function.

Given a function of one or more variables and a starting point, find a
fixed point of the function: i.e., where ``func(x0) == x0``.

Parameters
----------
func : function
    Function to evaluate.
x0 : array_like
    Fixed point of function.
args : tuple, optional
    Extra arguments to `func`.
xtol : float, optional
    Convergence tolerance, defaults to 1e-08.
maxiter : int, optional
    Maximum number of iterations, defaults to 500.
method : {"del2", "iteration"}, optional
    Method of finding the fixed-point, defaults to "del2",
    which uses Steffensen's Method with Aitken's ``Del^2``
    convergence acceleration [1]_. The "iteration" method simply iterates
    the function until convergence is detected, without attempting to
    accelerate the convergence.

References
----------
.. [1] Burden, Faires, "Numerical Analysis", 5th edition, pg. 80

Examples
--------
&gt;&gt;&gt; from scipy import optimize
&gt;&gt;&gt; def func(x, c1, c2):
...    return np.sqrt(c1/(x+c2))
&gt;&gt;&gt; c1 = np.array([10,12.])
&gt;&gt;&gt; c2 = np.array([3, 5.])
&gt;&gt;&gt; optimize.fixed_point(func, [1.2, 1.3], args=(c1,c2))
array([ 1.4920333 ,  1.37228132])</pre> <div class="fragment"><div class="line"><span class="lineno">  947</span><span class="keyword">def </span>fixed_point(func, x0, args=(), xtol=1e-8, maxiter=500, method=<span class="stringliteral">&#39;del2&#39;</span>):</div>
<div class="line"><span class="lineno">  948</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">    Find a fixed point of the function.</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    Given a function of one or more variables and a starting point, find a</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">    fixed point of the function: i.e., where ``func(x0) == x0``.</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">    func : function</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">        Function to evaluate.</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">    x0 : array_like</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral">        Fixed point of function.</span></div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">        Extra arguments to `func`.</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">    xtol : float, optional</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">        Convergence tolerance, defaults to 1e-08.</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral">        Maximum number of iterations, defaults to 500.</span></div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">    method : {&quot;del2&quot;, &quot;iteration&quot;}, optional</span></div>
<div class="line"><span class="lineno">  967</span><span class="stringliteral">        Method of finding the fixed-point, defaults to &quot;del2&quot;,</span></div>
<div class="line"><span class="lineno">  968</span><span class="stringliteral">        which uses Steffensen&#39;s Method with Aitken&#39;s ``Del^2``</span></div>
<div class="line"><span class="lineno">  969</span><span class="stringliteral">        convergence acceleration [1]_. The &quot;iteration&quot; method simply iterates</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral">        the function until convergence is detected, without attempting to</span></div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral">        accelerate the convergence.</span></div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">    .. [1] Burden, Faires, &quot;Numerical Analysis&quot;, 5th edition, pg. 80</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import optimize</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">    &gt;&gt;&gt; def func(x, c1, c2):</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">    ...    return np.sqrt(c1/(x+c2))</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">    &gt;&gt;&gt; c1 = np.array([10,12.])</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">    &gt;&gt;&gt; c2 = np.array([3, 5.])</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">    &gt;&gt;&gt; optimize.fixed_point(func, [1.2, 1.3], args=(c1,c2))</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">    array([ 1.4920333 ,  1.37228132])</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  988</span>    use_accel = {<span class="stringliteral">&#39;del2&#39;</span>: <span class="keyword">True</span>, <span class="stringliteral">&#39;iteration&#39;</span>: <span class="keyword">False</span>}[method]</div>
<div class="line"><span class="lineno">  989</span>    x0 = _asarray_validated(x0, as_inexact=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  990</span>    <span class="keywordflow">return</span> _fixed_point_helper(func, x0, args, xtol, maxiter, use_accel)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a99eb46becd5efacbaa56201c25a40039" name="a99eb46becd5efacbaa56201c25a40039"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99eb46becd5efacbaa56201c25a40039">&#9670;&#160;</a></span>fsolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py.fsolve </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fprime</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>col_deriv</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1.49012e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfev</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>band</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsfcn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>factor</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>diag</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find the roots of a function.

Return the roots of the (non-linear) equations defined by
``func(x) = 0`` given a starting estimate.

Parameters
----------
func : callable ``f(x, *args)``
    A function that takes at least one (possibly vector) argument,
    and returns a value of the same length.
x0 : ndarray
    The starting estimate for the roots of ``func(x) = 0``.
args : tuple, optional
    Any extra arguments to `func`.
fprime : callable ``f(x, *args)``, optional
    A function to compute the Jacobian of `func` with derivatives
    across the rows. By default, the Jacobian will be estimated.
full_output : bool, optional
    If True, return optional outputs.
col_deriv : bool, optional
    Specify whether the Jacobian function computes derivatives down
    the columns (faster, because there is no transpose operation).
xtol : float, optional
    The calculation will terminate if the relative error between two
    consecutive iterates is at most `xtol`.
maxfev : int, optional
    The maximum number of calls to the function. If zero, then
    ``100*(N+1)`` is the maximum where N is the number of elements
    in `x0`.
band : tuple, optional
    If set to a two-sequence containing the number of sub- and
    super-diagonals within the band of the Jacobi matrix, the
    Jacobi matrix is considered banded (only for ``fprime=None``).
epsfcn : float, optional
    A suitable step length for the forward-difference
    approximation of the Jacobian (for ``fprime=None``). If
    `epsfcn` is less than the machine precision, it is assumed
    that the relative errors in the functions are of the order of
    the machine precision.
factor : float, optional
    A parameter determining the initial step bound
    (``factor * || diag * x||``). Should be in the interval
    ``(0.1, 100)``.
diag : sequence, optional
    N positive entries that serve as a scale factors for the
    variables.

Returns
-------
x : ndarray
    The solution (or the result of the last iteration for
    an unsuccessful call).
infodict : dict
    A dictionary of optional outputs with the keys:

    ``nfev``
        number of function calls
    ``njev``
        number of Jacobian calls
    ``fvec``
        function evaluated at the output
    ``fjac``
        the orthogonal matrix, q, produced by the QR
        factorization of the final approximate Jacobian
        matrix, stored column wise
    ``r``
        upper triangular matrix produced by QR factorization
        of the same matrix
    ``qtf``
        the vector ``(transpose(q) * fvec)``

ier : int
    An integer flag.  Set to 1 if a solution was found, otherwise refer
    to `mesg` for more information.
mesg : str
    If no solution is found, `mesg` details the cause of failure.

See Also
--------
root : Interface to root finding algorithms for multivariate
       functions. See the ``method=='hybr'`` in particular.

Notes
-----
``fsolve`` is a wrapper around MINPACK's hybrd and hybrj algorithms.

Examples
--------
Find a solution to the system of equations:
``x0*cos(x1) = 4,  x1*x0 - x1 = 5``.

&gt;&gt;&gt; from scipy.optimize import fsolve
&gt;&gt;&gt; def func(x):
...     return [x[0] * np.cos(x[1]) - 4,
...             x[1] * x[0] - x[1] - 5]
&gt;&gt;&gt; root = fsolve(func, [1, 1])
&gt;&gt;&gt; root
array([6.50409711, 0.90841421])
&gt;&gt;&gt; np.isclose(func(root), [0.0, 0.0])  # func(root) should be almost 0.0.
array([ True,  True])</pre> <div class="fragment"><div class="line"><span class="lineno">   48</span>           epsfcn=<span class="keywordtype">None</span>, factor=100, diag=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">   49</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    Find the roots of a function.</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    Return the roots of the (non-linear) equations defined by</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">    ``func(x) = 0`` given a starting estimate.</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    func : callable ``f(x, *args)``</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">        A function that takes at least one (possibly vector) argument,</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">        and returns a value of the same length.</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">        The starting estimate for the roots of ``func(x) = 0``.</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">        Any extra arguments to `func`.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">    fprime : callable ``f(x, *args)``, optional</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        A function to compute the Jacobian of `func` with derivatives</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">        across the rows. By default, the Jacobian will be estimated.</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        If True, return optional outputs.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    col_deriv : bool, optional</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        Specify whether the Jacobian function computes derivatives down</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">        the columns (faster, because there is no transpose operation).</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    xtol : float, optional</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        The calculation will terminate if the relative error between two</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        consecutive iterates is at most `xtol`.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    maxfev : int, optional</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        The maximum number of calls to the function. If zero, then</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">        ``100*(N+1)`` is the maximum where N is the number of elements</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        in `x0`.</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    band : tuple, optional</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">        If set to a two-sequence containing the number of sub- and</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">        super-diagonals within the band of the Jacobi matrix, the</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">        Jacobi matrix is considered banded (only for ``fprime=None``).</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    epsfcn : float, optional</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">        A suitable step length for the forward-difference</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        approximation of the Jacobian (for ``fprime=None``). If</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        `epsfcn` is less than the machine precision, it is assumed</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        that the relative errors in the functions are of the order of</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">        the machine precision.</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    factor : float, optional</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">        A parameter determining the initial step bound</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">        (``factor * || diag * x||``). Should be in the interval</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">        ``(0.1, 100)``.</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    diag : sequence, optional</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">        N positive entries that serve as a scale factors for the</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">        variables.</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    x : ndarray</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">        The solution (or the result of the last iteration for</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">        an unsuccessful call).</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    infodict : dict</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">        A dictionary of optional outputs with the keys:</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">        ``nfev``</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">            number of function calls</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">        ``njev``</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">            number of Jacobian calls</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">        ``fvec``</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">            function evaluated at the output</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">        ``fjac``</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">            the orthogonal matrix, q, produced by the QR</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">            factorization of the final approximate Jacobian</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">            matrix, stored column wise</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">        ``r``</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">            upper triangular matrix produced by QR factorization</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">            of the same matrix</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">        ``qtf``</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">            the vector ``(transpose(q) * fvec)``</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    ier : int</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">        An integer flag.  Set to 1 if a solution was found, otherwise refer</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">        to `mesg` for more information.</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    mesg : str</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">        If no solution is found, `mesg` details the cause of failure.</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    root : Interface to root finding algorithms for multivariate</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">           functions. See the ``method==&#39;hybr&#39;`` in particular.</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    ``fsolve`` is a wrapper around MINPACK&#39;s hybrd and hybrj algorithms.</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    Find a solution to the system of equations:</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    ``x0*cos(x1) = 4,  x1*x0 - x1 = 5``.</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import fsolve</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">    &gt;&gt;&gt; def func(x):</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    ...     return [x[0] * np.cos(x[1]) - 4,</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    ...             x[1] * x[0] - x[1] - 5]</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    &gt;&gt;&gt; root = fsolve(func, [1, 1])</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    &gt;&gt;&gt; root</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    array([6.50409711, 0.90841421])</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    &gt;&gt;&gt; np.isclose(func(root), [0.0, 0.0])  # func(root) should be almost 0.0.</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    array([ True,  True])</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  152</span>    options = {<span class="stringliteral">&#39;col_deriv&#39;</span>: col_deriv,</div>
<div class="line"><span class="lineno">  153</span>               <span class="stringliteral">&#39;xtol&#39;</span>: xtol,</div>
<div class="line"><span class="lineno">  154</span>               <span class="stringliteral">&#39;maxfev&#39;</span>: maxfev,</div>
<div class="line"><span class="lineno">  155</span>               <span class="stringliteral">&#39;band&#39;</span>: band,</div>
<div class="line"><span class="lineno">  156</span>               <span class="stringliteral">&#39;eps&#39;</span>: epsfcn,</div>
<div class="line"><span class="lineno">  157</span>               <span class="stringliteral">&#39;factor&#39;</span>: factor,</div>
<div class="line"><span class="lineno">  158</span>               <span class="stringliteral">&#39;diag&#39;</span>: diag}</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    res = _root_hybr(func, x0, args, jac=fprime, **options)</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno">  162</span>        x = res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno">  163</span>        info = dict((k, res.get(k))</div>
<div class="line"><span class="lineno">  164</span>                    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> (<span class="stringliteral">&#39;nfev&#39;</span>, <span class="stringliteral">&#39;njev&#39;</span>, <span class="stringliteral">&#39;fjac&#39;</span>, <span class="stringliteral">&#39;r&#39;</span>, <span class="stringliteral">&#39;qtf&#39;</span>) <span class="keywordflow">if</span> k <span class="keywordflow">in</span> res)</div>
<div class="line"><span class="lineno">  165</span>        info[<span class="stringliteral">&#39;fvec&#39;</span>] = res[<span class="stringliteral">&#39;fun&#39;</span>]</div>
<div class="line"><span class="lineno">  166</span>        <span class="keywordflow">return</span> x, info, res[<span class="stringliteral">&#39;status&#39;</span>], res[<span class="stringliteral">&#39;message&#39;</span>]</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  168</span>        status = res[<span class="stringliteral">&#39;status&#39;</span>]</div>
<div class="line"><span class="lineno">  169</span>        msg = res[<span class="stringliteral">&#39;message&#39;</span>]</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">if</span> status == 0:</div>
<div class="line"><span class="lineno">  171</span>            <span class="keywordflow">raise</span> TypeError(msg)</div>
<div class="line"><span class="lineno">  172</span>        <span class="keywordflow">elif</span> status == 1:</div>
<div class="line"><span class="lineno">  173</span>            <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">elif</span> status <span class="keywordflow">in</span> [2, 3, 4, 5]:</div>
<div class="line"><span class="lineno">  175</span>            warnings.warn(msg, RuntimeWarning)</div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  177</span>            <span class="keywordflow">raise</span> TypeError(msg)</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">return</span> res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f776bd622214934efcfc4fed5fd183d" name="a0f776bd622214934efcfc4fed5fd183d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f776bd622214934efcfc4fed5fd183d">&#9670;&#160;</a></span>leastsq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py.leastsq </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Dfun</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>col_deriv</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftol</em> = <code>1.49012e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtol</em> = <code>1.49012e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gtol</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfev</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsfcn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>factor</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>diag</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Minimize the sum of squares of a set of equations.

::

    x = arg min(sum(func(y)**2,axis=0))
             y

Parameters
----------
func : callable
    Should take at least one (possibly length ``N`` vector) argument and
    returns ``M`` floating point numbers. It must not return NaNs or
    fitting might fail. ``M`` must be greater than or equal to ``N``.
x0 : ndarray
    The starting estimate for the minimization.
args : tuple, optional
    Any extra arguments to func are placed in this tuple.
Dfun : callable, optional
    A function or method to compute the Jacobian of func with derivatives
    across the rows. If this is None, the Jacobian will be estimated.
full_output : bool, optional
    non-zero to return all optional outputs.
col_deriv : bool, optional
    non-zero to specify that the Jacobian function computes derivatives
    down the columns (faster, because there is no transpose operation).
ftol : float, optional
    Relative error desired in the sum of squares.
xtol : float, optional
    Relative error desired in the approximate solution.
gtol : float, optional
    Orthogonality desired between the function vector and the columns of
    the Jacobian.
maxfev : int, optional
    The maximum number of calls to the function. If `Dfun` is provided,
    then the default `maxfev` is 100*(N+1) where N is the number of elements
    in x0, otherwise the default `maxfev` is 200*(N+1).
epsfcn : float, optional
    A variable used in determining a suitable step length for the forward-
    difference approximation of the Jacobian (for Dfun=None).
    Normally the actual step length will be sqrt(epsfcn)*x
    If epsfcn is less than the machine precision, it is assumed that the
    relative errors are of the order of the machine precision.
factor : float, optional
    A parameter determining the initial step bound
    (``factor * || diag * x||``). Should be in interval ``(0.1, 100)``.
diag : sequence, optional
    N positive entries that serve as a scale factors for the variables.

Returns
-------
x : ndarray
    The solution (or the result of the last iteration for an unsuccessful
    call).
cov_x : ndarray
    The inverse of the Hessian. `fjac` and `ipvt` are used to construct an
    estimate of the Hessian. A value of None indicates a singular matrix,
    which means the curvature in parameters `x` is numerically flat. To
    obtain the covariance matrix of the parameters `x`, `cov_x` must be
    multiplied by the variance of the residuals -- see curve_fit.
infodict : dict
    a dictionary of optional outputs with the keys:

    ``nfev``
        The number of function calls
    ``fvec``
        The function evaluated at the output
    ``fjac``
        A permutation of the R matrix of a QR
        factorization of the final approximate
        Jacobian matrix, stored column wise.
        Together with ipvt, the covariance of the
        estimate can be approximated.
    ``ipvt``
        An integer array of length N which defines
        a permutation matrix, p, such that
        fjac*p = q*r, where r is upper triangular
        with diagonal elements of nonincreasing
        magnitude. Column j of p is column ipvt(j)
        of the identity matrix.
    ``qtf``
        The vector (transpose(q) * fvec).

mesg : str
    A string message giving information about the cause of failure.
ier : int
    An integer flag. If it is equal to 1, 2, 3 or 4, the solution was
    found. Otherwise, the solution was not found. In either case, the
    optional output variable 'mesg' gives more information.

See Also
--------
least_squares : Newer interface to solve nonlinear least-squares problems
    with bounds on the variables. See ``method=='lm'`` in particular.

Notes
-----
"leastsq" is a wrapper around MINPACK's lmdif and lmder algorithms.

cov_x is a Jacobian approximation to the Hessian of the least squares
objective function.
This approximation assumes that the objective function is based on the
difference between some observed target data (ydata) and a (non-linear)
function of the parameters `f(xdata, params)` ::

       func(params) = ydata - f(xdata, params)

so that the objective function is ::

       min   sum((ydata - f(xdata, params))**2, axis=0)
     params

The solution, `x`, is always a 1-D array, regardless of the shape of `x0`,
or whether `x0` is a scalar.

Examples
--------
&gt;&gt;&gt; from scipy.optimize import leastsq
&gt;&gt;&gt; def func(x):
...     return 2*(x-3)**2+1
&gt;&gt;&gt; leastsq(func, 0)
(array([2.99999999]), 1)</pre> <div class="fragment"><div class="line"><span class="lineno">  281</span>            gtol=0.0, maxfev=0, epsfcn=<span class="keywordtype">None</span>, factor=100, diag=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  282</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">    Minimize the sum of squares of a set of equations.</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    ::</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">        x = arg min(sum(func(y)**2,axis=0))</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">                 y</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    func : callable</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">        Should take at least one (possibly length ``N`` vector) argument and</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">        returns ``M`` floating point numbers. It must not return NaNs or</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">        fitting might fail. ``M`` must be greater than or equal to ``N``.</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">        The starting estimate for the minimization.</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">        Any extra arguments to func are placed in this tuple.</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">    Dfun : callable, optional</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">        A function or method to compute the Jacobian of func with derivatives</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">        across the rows. If this is None, the Jacobian will be estimated.</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        non-zero to return all optional outputs.</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">    col_deriv : bool, optional</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">        non-zero to specify that the Jacobian function computes derivatives</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">        down the columns (faster, because there is no transpose operation).</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">    ftol : float, optional</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">        Relative error desired in the sum of squares.</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    xtol : float, optional</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">        Relative error desired in the approximate solution.</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">    gtol : float, optional</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">        Orthogonality desired between the function vector and the columns of</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">        the Jacobian.</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">    maxfev : int, optional</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">        The maximum number of calls to the function. If `Dfun` is provided,</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">        then the default `maxfev` is 100*(N+1) where N is the number of elements</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">        in x0, otherwise the default `maxfev` is 200*(N+1).</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    epsfcn : float, optional</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        A variable used in determining a suitable step length for the forward-</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">        difference approximation of the Jacobian (for Dfun=None).</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">        Normally the actual step length will be sqrt(epsfcn)*x</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">        If epsfcn is less than the machine precision, it is assumed that the</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        relative errors are of the order of the machine precision.</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    factor : float, optional</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">        A parameter determining the initial step bound</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        (``factor * || diag * x||``). Should be in interval ``(0.1, 100)``.</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">    diag : sequence, optional</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">        N positive entries that serve as a scale factors for the variables.</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">    x : ndarray</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">        The solution (or the result of the last iteration for an unsuccessful</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">        call).</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    cov_x : ndarray</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">        The inverse of the Hessian. `fjac` and `ipvt` are used to construct an</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">        estimate of the Hessian. A value of None indicates a singular matrix,</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">        which means the curvature in parameters `x` is numerically flat. To</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">        obtain the covariance matrix of the parameters `x`, `cov_x` must be</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">        multiplied by the variance of the residuals -- see curve_fit.</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    infodict : dict</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">        a dictionary of optional outputs with the keys:</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">        ``nfev``</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">            The number of function calls</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">        ``fvec``</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">            The function evaluated at the output</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">        ``fjac``</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">            A permutation of the R matrix of a QR</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">            factorization of the final approximate</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">            Jacobian matrix, stored column wise.</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">            Together with ipvt, the covariance of the</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">            estimate can be approximated.</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">        ``ipvt``</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">            An integer array of length N which defines</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">            a permutation matrix, p, such that</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">            fjac*p = q*r, where r is upper triangular</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">            with diagonal elements of nonincreasing</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">            magnitude. Column j of p is column ipvt(j)</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">            of the identity matrix.</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">        ``qtf``</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">            The vector (transpose(q) * fvec).</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">    mesg : str</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">        A string message giving information about the cause of failure.</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    ier : int</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">        An integer flag. If it is equal to 1, 2, 3 or 4, the solution was</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">        found. Otherwise, the solution was not found. In either case, the</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">        optional output variable &#39;mesg&#39; gives more information.</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">    least_squares : Newer interface to solve nonlinear least-squares problems</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">        with bounds on the variables. See ``method==&#39;lm&#39;`` in particular.</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">    &quot;leastsq&quot; is a wrapper around MINPACK&#39;s lmdif and lmder algorithms.</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">    cov_x is a Jacobian approximation to the Hessian of the least squares</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">    objective function.</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">    This approximation assumes that the objective function is based on the</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">    difference between some observed target data (ydata) and a (non-linear)</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">    function of the parameters `f(xdata, params)` ::</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">           func(params) = ydata - f(xdata, params)</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">    so that the objective function is ::</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">           min   sum((ydata - f(xdata, params))**2, axis=0)</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">         params</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">    The solution, `x`, is always a 1-D array, regardless of the shape of `x0`,</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    or whether `x0` is a scalar.</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.optimize import leastsq</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    &gt;&gt;&gt; def func(x):</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    ...     return 2*(x-3)**2+1</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">    &gt;&gt;&gt; leastsq(func, 0)</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">    (array([2.99999999]), 1)</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  406</span>    x0 = asarray(x0).flatten()</div>
<div class="line"><span class="lineno">  407</span>    n = len(x0)</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(args, tuple):</div>
<div class="line"><span class="lineno">  409</span>        args = (args,)</div>
<div class="line"><span class="lineno">  410</span>    shape, dtype = _check_func(<span class="stringliteral">&#39;leastsq&#39;</span>, <span class="stringliteral">&#39;func&#39;</span>, func, x0, args, n)</div>
<div class="line"><span class="lineno">  411</span>    m = shape[0]</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">if</span> n &gt; m:</div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">raise</span> TypeError(f<span class="stringliteral">&quot;Improper input: func input vector length N={n} must&quot;</span></div>
<div class="line"><span class="lineno">  415</span>                        f<span class="stringliteral">&quot; not exceed func output vector length M={m}&quot;</span>)</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordflow">if</span> epsfcn <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  418</span>        epsfcn = finfo(dtype).eps</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">if</span> Dfun <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  421</span>        <span class="keywordflow">if</span> maxfev == 0:</div>
<div class="line"><span class="lineno">  422</span>            maxfev = 200*(n + 1)</div>
<div class="line"><span class="lineno">  423</span>        retval = _minpack._lmdif(func, x0, args, full_output, ftol, xtol,</div>
<div class="line"><span class="lineno">  424</span>                                 gtol, maxfev, epsfcn, factor, diag)</div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">if</span> col_deriv:</div>
<div class="line"><span class="lineno">  427</span>            _check_func(<span class="stringliteral">&#39;leastsq&#39;</span>, <span class="stringliteral">&#39;Dfun&#39;</span>, Dfun, x0, args, n, (n, m))</div>
<div class="line"><span class="lineno">  428</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  429</span>            _check_func(<span class="stringliteral">&#39;leastsq&#39;</span>, <span class="stringliteral">&#39;Dfun&#39;</span>, Dfun, x0, args, n, (m, n))</div>
<div class="line"><span class="lineno">  430</span>        <span class="keywordflow">if</span> maxfev == 0:</div>
<div class="line"><span class="lineno">  431</span>            maxfev = 100 * (n + 1)</div>
<div class="line"><span class="lineno">  432</span>        retval = _minpack._lmder(func, Dfun, x0, args, full_output,</div>
<div class="line"><span class="lineno">  433</span>                                 col_deriv, ftol, xtol, gtol, maxfev,</div>
<div class="line"><span class="lineno">  434</span>                                 factor, diag)</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    errors = {0: [<span class="stringliteral">&quot;Improper input parameters.&quot;</span>, TypeError],</div>
<div class="line"><span class="lineno">  437</span>              1: [<span class="stringliteral">&quot;Both actual and predicted relative reductions &quot;</span></div>
<div class="line"><span class="lineno">  438</span>                  <span class="stringliteral">&quot;in the sum of squares\n  are at most %f&quot;</span> % ftol, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  439</span>              2: [<span class="stringliteral">&quot;The relative error between two consecutive &quot;</span></div>
<div class="line"><span class="lineno">  440</span>                  <span class="stringliteral">&quot;iterates is at most %f&quot;</span> % xtol, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  441</span>              3: [<span class="stringliteral">&quot;Both actual and predicted relative reductions in &quot;</span></div>
<div class="line"><span class="lineno">  442</span>                  <span class="stringliteral">&quot;the sum of squares\n  are at most %f and the &quot;</span></div>
<div class="line"><span class="lineno">  443</span>                  <span class="stringliteral">&quot;relative error between two consecutive &quot;</span></div>
<div class="line"><span class="lineno">  444</span>                  <span class="stringliteral">&quot;iterates is at \n  most %f&quot;</span> % (ftol, xtol), <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  445</span>              4: [<span class="stringliteral">&quot;The cosine of the angle between func(x) and any &quot;</span></div>
<div class="line"><span class="lineno">  446</span>                  <span class="stringliteral">&quot;column of the\n  Jacobian is at most %f in &quot;</span></div>
<div class="line"><span class="lineno">  447</span>                  <span class="stringliteral">&quot;absolute value&quot;</span> % gtol, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  448</span>              5: [<span class="stringliteral">&quot;Number of calls to function has reached &quot;</span></div>
<div class="line"><span class="lineno">  449</span>                  <span class="stringliteral">&quot;maxfev = %d.&quot;</span> % maxfev, ValueError],</div>
<div class="line"><span class="lineno">  450</span>              6: [<span class="stringliteral">&quot;ftol=%f is too small, no further reduction &quot;</span></div>
<div class="line"><span class="lineno">  451</span>                  <span class="stringliteral">&quot;in the sum of squares\n  is possible.&quot;</span> % ftol,</div>
<div class="line"><span class="lineno">  452</span>                  ValueError],</div>
<div class="line"><span class="lineno">  453</span>              7: [<span class="stringliteral">&quot;xtol=%f is too small, no further improvement in &quot;</span></div>
<div class="line"><span class="lineno">  454</span>                  <span class="stringliteral">&quot;the approximate\n  solution is possible.&quot;</span> % xtol,</div>
<div class="line"><span class="lineno">  455</span>                  ValueError],</div>
<div class="line"><span class="lineno">  456</span>              8: [<span class="stringliteral">&quot;gtol=%f is too small, func(x) is orthogonal to the &quot;</span></div>
<div class="line"><span class="lineno">  457</span>                  <span class="stringliteral">&quot;columns of\n  the Jacobian to machine &quot;</span></div>
<div class="line"><span class="lineno">  458</span>                  <span class="stringliteral">&quot;precision.&quot;</span> % gtol, ValueError]}</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    <span class="comment"># The FORTRAN return value (possible return values are &gt;= 0 and &lt;= 8)</span></div>
<div class="line"><span class="lineno">  461</span>    info = retval[-1]</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno">  464</span>        cov_x = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">if</span> info <span class="keywordflow">in</span> LEASTSQ_SUCCESS:</div>
<div class="line"><span class="lineno">  466</span>            perm = take(eye(n), retval[1][<span class="stringliteral">&#39;ipvt&#39;</span>] - 1, 0)</div>
<div class="line"><span class="lineno">  467</span>            r = triu(transpose(retval[1][<span class="stringliteral">&#39;fjac&#39;</span>])[:n, :])</div>
<div class="line"><span class="lineno">  468</span>            R = dot(r, perm)</div>
<div class="line"><span class="lineno">  469</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  470</span>                cov_x = inv(dot(transpose(R), R))</div>
<div class="line"><span class="lineno">  471</span>            <span class="keywordflow">except</span> (LinAlgError, ValueError):</div>
<div class="line"><span class="lineno">  472</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">return</span> (retval[0], cov_x) + retval[1:-1] + (errors[info][0], info)</div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  475</span>        <span class="keywordflow">if</span> info <span class="keywordflow">in</span> LEASTSQ_FAILURE:</div>
<div class="line"><span class="lineno">  476</span>            warnings.warn(errors[info][0], RuntimeWarning)</div>
<div class="line"><span class="lineno">  477</span>        <span class="keywordflow">elif</span> info == 0:</div>
<div class="line"><span class="lineno">  478</span>            <span class="keywordflow">raise</span> errors[info][1](errors[info][0])</div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">return</span> retval[0], info</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1bbbcae076659d8fb7ef47b694715cde" name="a1bbbcae076659d8fb7ef47b694715cde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bbbcae076659d8fb7ef47b694715cde">&#9670;&#160;</a></span>error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._minpack_py.error = _minpack.error</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a20efa43ed57b2cb1186752b5ddb6e717" name="a20efa43ed57b2cb1186752b5ddb6e717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20efa43ed57b2cb1186752b5ddb6e717">&#9670;&#160;</a></span>LEASTSQ_FAILURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.optimize._minpack_py.LEASTSQ_FAILURE = [5, 6, 7, 8]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a95e93cbae2af241ffb978bc54d4834b2" name="a95e93cbae2af241ffb978bc54d4834b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95e93cbae2af241ffb978bc54d4834b2">&#9670;&#160;</a></span>LEASTSQ_SUCCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.optimize._minpack_py.LEASTSQ_SUCCESS = [1, 2, 3, 4]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
