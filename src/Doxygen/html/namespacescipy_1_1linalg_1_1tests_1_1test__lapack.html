<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.linalg.tests.test_lapack Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1linalg.html">linalg</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1linalg_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html">test_lapack</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.linalg.tests.test_lapack Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_blocked_q_r.html">TestBlockedQR</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_dlasd4.html">TestDlasd4</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_dpotr.html">TestDpotr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_flapack_simple.html">TestFlapackSimple</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_hetrd.html">TestHetrd</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_lapack.html">TestLapack</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_least_squares_solvers.html">TestLeastSquaresSolvers</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_regression.html">TestRegression</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_sytrd.html">TestSytrd</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1linalg_1_1tests_1_1test__lapack_1_1_test_tbtrs.html">TestTbtrs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a438f9892c24645769813f24d1a78011f" id="r_a438f9892c24645769813f24d1a78011f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a438f9892c24645769813f24d1a78011f">generate_random_dtype_array</a> (shape, dtype)</td></tr>
<tr class="separator:a438f9892c24645769813f24d1a78011f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed5123e4f5b14d7fd9570d6f62897dd2" id="r_aed5123e4f5b14d7fd9570d6f62897dd2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#aed5123e4f5b14d7fd9570d6f62897dd2">test_lapack_documented</a> ()</td></tr>
<tr class="separator:aed5123e4f5b14d7fd9570d6f62897dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aadb42a0bcb8978a70cb7963e47bb55" id="r_a6aadb42a0bcb8978a70cb7963e47bb55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a6aadb42a0bcb8978a70cb7963e47bb55">test_geqrf_lwork</a> (dtype, shape)</td></tr>
<tr class="separator:a6aadb42a0bcb8978a70cb7963e47bb55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3327961f1b8e813fa93986372a2edaf1" id="r_a3327961f1b8e813fa93986372a2edaf1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a3327961f1b8e813fa93986372a2edaf1">test_lartg</a> ()</td></tr>
<tr class="separator:a3327961f1b8e813fa93986372a2edaf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac4d8bf3ec3afc357eef5b27c11ef79" id="r_acac4d8bf3ec3afc357eef5b27c11ef79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#acac4d8bf3ec3afc357eef5b27c11ef79">test_rot</a> ()</td></tr>
<tr class="separator:acac4d8bf3ec3afc357eef5b27c11ef79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac18097ea2143ace6101e98164e94db74" id="r_ac18097ea2143ace6101e98164e94db74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ac18097ea2143ace6101e98164e94db74">test_larfg_larf</a> ()</td></tr>
<tr class="separator:ac18097ea2143ace6101e98164e94db74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab13b092137e8ebf6d2282cb818e3c399" id="r_ab13b092137e8ebf6d2282cb818e3c399"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ab13b092137e8ebf6d2282cb818e3c399">test_sgesdd_lwork_bug_workaround</a> ()</td></tr>
<tr class="separator:ab13b092137e8ebf6d2282cb818e3c399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af839d440bb60c1ec968d03b92e481985" id="r_af839d440bb60c1ec968d03b92e481985"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#af839d440bb60c1ec968d03b92e481985">test_gglse</a> ()</td></tr>
<tr class="separator:af839d440bb60c1ec968d03b92e481985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e17c0a63b49109e7f8eb84b0bf290d4" id="r_a7e17c0a63b49109e7f8eb84b0bf290d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a7e17c0a63b49109e7f8eb84b0bf290d4">test_sycon_hecon</a> ()</td></tr>
<tr class="separator:a7e17c0a63b49109e7f8eb84b0bf290d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2ddc967721910fd74e288a196d29945" id="r_af2ddc967721910fd74e288a196d29945"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#af2ddc967721910fd74e288a196d29945">test_sygst</a> ()</td></tr>
<tr class="separator:af2ddc967721910fd74e288a196d29945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3851eef77e07e0103802d63ea8962d31" id="r_a3851eef77e07e0103802d63ea8962d31"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a3851eef77e07e0103802d63ea8962d31">test_hegst</a> ()</td></tr>
<tr class="separator:a3851eef77e07e0103802d63ea8962d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaf4ae6ed9889081f45e861491dee0ec" id="r_aaaf4ae6ed9889081f45e861491dee0ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#aaaf4ae6ed9889081f45e861491dee0ec">test_tzrzf</a> ()</td></tr>
<tr class="separator:aaaf4ae6ed9889081f45e861491dee0ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc67183349aa41f6d8b12cc0a2ce5df" id="r_afdc67183349aa41f6d8b12cc0a2ce5df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#afdc67183349aa41f6d8b12cc0a2ce5df">test_tfsm</a> ()</td></tr>
<tr class="separator:afdc67183349aa41f6d8b12cc0a2ce5df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cc0db4e3285f2b894b124b3c1ef7eff" id="r_a8cc0db4e3285f2b894b124b3c1ef7eff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a8cc0db4e3285f2b894b124b3c1ef7eff">test_ormrz_unmrz</a> ()</td></tr>
<tr class="separator:a8cc0db4e3285f2b894b124b3c1ef7eff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a69f1ee0d2fae9324aa3b38bda7578d" id="r_a9a69f1ee0d2fae9324aa3b38bda7578d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a9a69f1ee0d2fae9324aa3b38bda7578d">test_tfttr_trttf</a> ()</td></tr>
<tr class="separator:a9a69f1ee0d2fae9324aa3b38bda7578d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4897f0bb6b1ae582799a6bc65fd730d1" id="r_a4897f0bb6b1ae582799a6bc65fd730d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a4897f0bb6b1ae582799a6bc65fd730d1">test_tpttr_trttp</a> ()</td></tr>
<tr class="separator:a4897f0bb6b1ae582799a6bc65fd730d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9dc2e4711e5bf6daef635d7c1dd5541" id="r_ac9dc2e4711e5bf6daef635d7c1dd5541"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ac9dc2e4711e5bf6daef635d7c1dd5541">test_pftrf</a> ()</td></tr>
<tr class="separator:ac9dc2e4711e5bf6daef635d7c1dd5541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6dc8afcc55171e47450dbf0c897c349" id="r_ab6dc8afcc55171e47450dbf0c897c349"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ab6dc8afcc55171e47450dbf0c897c349">test_pftri</a> ()</td></tr>
<tr class="separator:ab6dc8afcc55171e47450dbf0c897c349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afebf9a411a3dea84f5194b21e8fe39ef" id="r_afebf9a411a3dea84f5194b21e8fe39ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#afebf9a411a3dea84f5194b21e8fe39ef">test_pftrs</a> ()</td></tr>
<tr class="separator:afebf9a411a3dea84f5194b21e8fe39ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a1916ff26ec9399044512d9dd605e07" id="r_a7a1916ff26ec9399044512d9dd605e07"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a7a1916ff26ec9399044512d9dd605e07">test_sfrk_hfrk</a> ()</td></tr>
<tr class="separator:a7a1916ff26ec9399044512d9dd605e07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81d785ca58992dde6002e0c65e734c0a" id="r_a81d785ca58992dde6002e0c65e734c0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a81d785ca58992dde6002e0c65e734c0a">test_syconv</a> ()</td></tr>
<tr class="separator:a81d785ca58992dde6002e0c65e734c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e83aa1cd8da88f3a9e2634b1fc8bc29" id="r_a4e83aa1cd8da88f3a9e2634b1fc8bc29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a4e83aa1cd8da88f3a9e2634b1fc8bc29">test_pstrf</a> ()</td></tr>
<tr class="separator:a4e83aa1cd8da88f3a9e2634b1fc8bc29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1349c0f06a26438599c1773a9952bbe3" id="r_a1349c0f06a26438599c1773a9952bbe3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a1349c0f06a26438599c1773a9952bbe3">test_pstf2</a> ()</td></tr>
<tr class="separator:a1349c0f06a26438599c1773a9952bbe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed156cce64cd7afb726bf642df77604" id="r_a6ed156cce64cd7afb726bf642df77604"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a6ed156cce64cd7afb726bf642df77604">test_geequ</a> ()</td></tr>
<tr class="separator:a6ed156cce64cd7afb726bf642df77604"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1f93794762075ec56bcf037a9ae1415" id="r_af1f93794762075ec56bcf037a9ae1415"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#af1f93794762075ec56bcf037a9ae1415">test_syequb</a> ()</td></tr>
<tr class="separator:af1f93794762075ec56bcf037a9ae1415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc3cba1e7e007659ee6cb192487db5f" id="r_a7cc3cba1e7e007659ee6cb192487db5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a7cc3cba1e7e007659ee6cb192487db5f">test_heequb</a> ()</td></tr>
<tr class="separator:a7cc3cba1e7e007659ee6cb192487db5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53813b7747d6cddd68ed627d1ecc919" id="r_ac53813b7747d6cddd68ed627d1ecc919"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ac53813b7747d6cddd68ed627d1ecc919">test_getc2_gesc2</a> ()</td></tr>
<tr class="separator:ac53813b7747d6cddd68ed627d1ecc919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad395a80c6d4593b840218a9280f888a2" id="r_ad395a80c6d4593b840218a9280f888a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ad395a80c6d4593b840218a9280f888a2">test_gejsv_general</a> (size, dtype, joba, <a class="el" href="__lapack__subroutines_8h.html#af5d3cfe829844f69f78a3efdce9214f8">jobu</a>, <a class="el" href="__lapack__subroutines_8h.html#a2daea009b70bd9ee4192e85610a7ea45">jobv</a>, <a class="el" href="__lapack__subroutines_8h.html#aa0f836096e6927086ba3575ce204cd9d">jobr</a>, <a class="el" href="__lapack__subroutines_8h.html#a98a18ed7908a162067d193153a5a85a3">jobp</a>, <a class="el" href="__lapack__subroutines_8h.html#a8707191ac3a3addf4532a164f7c9ab29">jobt</a>=0)</td></tr>
<tr class="separator:ad395a80c6d4593b840218a9280f888a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5edfd044862f672d76fa991ae1d85384" id="r_a5edfd044862f672d76fa991ae1d85384"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a5edfd044862f672d76fa991ae1d85384">test_gejsv_edge_arguments</a> (dtype)</td></tr>
<tr class="separator:a5edfd044862f672d76fa991ae1d85384"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa86dde3df054133f1e98d0d42cf01f22" id="r_aa86dde3df054133f1e98d0d42cf01f22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#aa86dde3df054133f1e98d0d42cf01f22">test_gejsv_invalid_job_arguments</a> (kwargs)</td></tr>
<tr class="separator:aa86dde3df054133f1e98d0d42cf01f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31a0e9930d2eabadfa7ca5d0f6192977" id="r_a31a0e9930d2eabadfa7ca5d0f6192977"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a31a0e9930d2eabadfa7ca5d0f6192977">test_gejsv_NAG</a> (A, sva_expect, u_expect, v_expect)</td></tr>
<tr class="separator:a31a0e9930d2eabadfa7ca5d0f6192977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af82c1dd606d511fa671f8245082407ca" id="r_af82c1dd606d511fa671f8245082407ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#af82c1dd606d511fa671f8245082407ca">test_gttrf_gttrs</a> (dtype)</td></tr>
<tr class="separator:af82c1dd606d511fa671f8245082407ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4906a02dc932f4fadb3ed8a6b5322d84" id="r_a4906a02dc932f4fadb3ed8a6b5322d84"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a4906a02dc932f4fadb3ed8a6b5322d84">test_gttrf_gttrs_NAG_f07cdf_f07cef_f07crf_f07csf</a> (<a class="el" href="__lapack__subroutines_8h.html#abe29c68b71f84412aba987704b527541">du</a>, <a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>, dl, du_exp, d_exp, du2_exp, ipiv_exp, b, x)</td></tr>
<tr class="separator:a4906a02dc932f4fadb3ed8a6b5322d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb5958b11023e8fc44fe378eb51a712a" id="r_abb5958b11023e8fc44fe378eb51a712a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#abb5958b11023e8fc44fe378eb51a712a">test_geqrfp_lwork</a> (dtype, shape)</td></tr>
<tr class="separator:abb5958b11023e8fc44fe378eb51a712a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6c60d396b5ba30aa13b12f363ee6b0" id="r_a6d6c60d396b5ba30aa13b12f363ee6b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a6d6c60d396b5ba30aa13b12f363ee6b0">test_pttrf_pttrs</a> (ddtype, dtype)</td></tr>
<tr class="separator:a6d6c60d396b5ba30aa13b12f363ee6b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b3cdf0f962def70069051653d6ec01f" id="r_a2b3cdf0f962def70069051653d6ec01f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a2b3cdf0f962def70069051653d6ec01f">test_pttrf_pttrs_errors_incompatible_shape</a> (ddtype, dtype)</td></tr>
<tr class="separator:a2b3cdf0f962def70069051653d6ec01f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab09b6b00107285bcbc234534e9e772de" id="r_ab09b6b00107285bcbc234534e9e772de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ab09b6b00107285bcbc234534e9e772de">test_pttrf_pttrs_errors_singular_nonSPD</a> (ddtype, dtype)</td></tr>
<tr class="separator:ab09b6b00107285bcbc234534e9e772de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d0ab776cca7b822ccee1105a4f25a88" id="r_a0d0ab776cca7b822ccee1105a4f25a88"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a0d0ab776cca7b822ccee1105a4f25a88">test_pttrf_pttrs_NAG</a> (<a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>, e, d_expect, e_expect, b, x_expect)</td></tr>
<tr class="separator:a0d0ab776cca7b822ccee1105a4f25a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a166fa55c9056576ba11540cf83685ce5" id="r_a166fa55c9056576ba11540cf83685ce5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a166fa55c9056576ba11540cf83685ce5">pteqr_get_d_e_A_z</a> (dtype, realtype, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, compute_z)</td></tr>
<tr class="separator:a166fa55c9056576ba11540cf83685ce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a678112f6aa115913acb68ab5ba29b4a9" id="r_a678112f6aa115913acb68ab5ba29b4a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a678112f6aa115913acb68ab5ba29b4a9">test_pteqr</a> (dtype, realtype, compute_z)</td></tr>
<tr class="separator:a678112f6aa115913acb68ab5ba29b4a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2872d1bce66c9e200d297c48557b6f09" id="r_a2872d1bce66c9e200d297c48557b6f09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a2872d1bce66c9e200d297c48557b6f09">test_pteqr_error_non_spd</a> (dtype, realtype, compute_z)</td></tr>
<tr class="separator:a2872d1bce66c9e200d297c48557b6f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df6e97dd1cadcc709043653a453186a" id="r_a6df6e97dd1cadcc709043653a453186a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a6df6e97dd1cadcc709043653a453186a">test_pteqr_raise_error_wrong_shape</a> (dtype, realtype, compute_z)</td></tr>
<tr class="separator:a6df6e97dd1cadcc709043653a453186a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96726a341a27d96d36b67f0a9a8769d4" id="r_a96726a341a27d96d36b67f0a9a8769d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a96726a341a27d96d36b67f0a9a8769d4">test_pteqr_error_singular</a> (dtype, realtype, compute_z)</td></tr>
<tr class="separator:a96726a341a27d96d36b67f0a9a8769d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d67b7ca946fcc5d1a4f9c7a5de3568d" id="r_a9d67b7ca946fcc5d1a4f9c7a5de3568d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a9d67b7ca946fcc5d1a4f9c7a5de3568d">test_pteqr_NAG_f08jgf</a> (compute_z, <a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>, e, d_expect, z_expect)</td></tr>
<tr class="separator:a9d67b7ca946fcc5d1a4f9c7a5de3568d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa45dec3a4002a1a7a2b694253184d9" id="r_acfa45dec3a4002a1a7a2b694253184d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#acfa45dec3a4002a1a7a2b694253184d9">test_geqrfp</a> (dtype, matrix_size)</td></tr>
<tr class="separator:acfa45dec3a4002a1a7a2b694253184d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3559d55984314a1257a1614aae695b5" id="r_af3559d55984314a1257a1614aae695b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#af3559d55984314a1257a1614aae695b5">test_geqrfp_errors_with_empty_array</a> ()</td></tr>
<tr class="separator:af3559d55984314a1257a1614aae695b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed9f498017cee84657df3a23c6f2e92" id="r_afed9f498017cee84657df3a23c6f2e92"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#afed9f498017cee84657df3a23c6f2e92">test_standard_eigh_lworks</a> (pfx, driver)</td></tr>
<tr class="separator:afed9f498017cee84657df3a23c6f2e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc856b8b9f1fa38fb018095ea7ac84ef" id="r_acc856b8b9f1fa38fb018095ea7ac84ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#acc856b8b9f1fa38fb018095ea7ac84ef">test_generalized_eigh_lworks</a> (pfx, driver)</td></tr>
<tr class="separator:acc856b8b9f1fa38fb018095ea7ac84ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace8cc8b96aa2058e6ed90f26ea17f826" id="r_ace8cc8b96aa2058e6ed90f26ea17f826"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ace8cc8b96aa2058e6ed90f26ea17f826">test_orcsd_uncsd_lwork</a> (dtype_, m)</td></tr>
<tr class="separator:ace8cc8b96aa2058e6ed90f26ea17f826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a176f42ac83317f5f4003113186176907" id="r_a176f42ac83317f5f4003113186176907"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a176f42ac83317f5f4003113186176907">test_orcsd_uncsd</a> (dtype_)</td></tr>
<tr class="separator:a176f42ac83317f5f4003113186176907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5f68a2ec6e96be7452ede3a1b37b6cb" id="r_ac5f68a2ec6e96be7452ede3a1b37b6cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ac5f68a2ec6e96be7452ede3a1b37b6cb">test_gtsvx</a> (dtype, trans_bool, fact)</td></tr>
<tr class="separator:ac5f68a2ec6e96be7452ede3a1b37b6cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d7d8c2fadf2929ce3c9115aaa313fcc" id="r_a5d7d8c2fadf2929ce3c9115aaa313fcc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a5d7d8c2fadf2929ce3c9115aaa313fcc">test_gtsvx_error_singular</a> (dtype, trans_bool, fact)</td></tr>
<tr class="separator:a5d7d8c2fadf2929ce3c9115aaa313fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04cb291252bad1d5437fbf0346e8ff6e" id="r_a04cb291252bad1d5437fbf0346e8ff6e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a04cb291252bad1d5437fbf0346e8ff6e">test_gtsvx_error_incompatible_size</a> (dtype, trans_bool, fact)</td></tr>
<tr class="separator:a04cb291252bad1d5437fbf0346e8ff6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b55629246742b3da3db89bfa377178" id="r_ad1b55629246742b3da3db89bfa377178"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#ad1b55629246742b3da3db89bfa377178">test_gtsvx_NAG</a> (<a class="el" href="__lapack__subroutines_8h.html#abe29c68b71f84412aba987704b527541">du</a>, <a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>, dl, b, x)</td></tr>
<tr class="separator:ad1b55629246742b3da3db89bfa377178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a6043b5e29d58f551fe2872a0ce8d10" id="r_a6a6043b5e29d58f551fe2872a0ce8d10"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a6a6043b5e29d58f551fe2872a0ce8d10">test_ptsvx</a> (dtype, realtype, fact, df_de_lambda)</td></tr>
<tr class="separator:a6a6043b5e29d58f551fe2872a0ce8d10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b85594f0a42640eb2c1c9a4f14233c" id="r_a14b85594f0a42640eb2c1c9a4f14233c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a14b85594f0a42640eb2c1c9a4f14233c">test_ptsvx_error_raise_errors</a> (dtype, realtype, fact, df_de_lambda)</td></tr>
<tr class="separator:a14b85594f0a42640eb2c1c9a4f14233c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1048c52178f29b094282d14d4c2f1ec2" id="r_a1048c52178f29b094282d14d4c2f1ec2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a1048c52178f29b094282d14d4c2f1ec2">test_ptsvx_non_SPD_singular</a> (dtype, realtype, fact, df_de_lambda)</td></tr>
<tr class="separator:a1048c52178f29b094282d14d4c2f1ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6adaf7bcc4d43ee43d056c10c986b874" id="r_a6adaf7bcc4d43ee43d056c10c986b874"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a6adaf7bcc4d43ee43d056c10c986b874">test_ptsvx_NAG</a> (<a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>, e, b, x)</td></tr>
<tr class="separator:a6adaf7bcc4d43ee43d056c10c986b874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a011c51021e2790376e7a7b045ee5b14a" id="r_a011c51021e2790376e7a7b045ee5b14a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a011c51021e2790376e7a7b045ee5b14a">test_pptrs_pptri_pptrf_ppsv_ppcon</a> (dtype, lower)</td></tr>
<tr class="separator:a011c51021e2790376e7a7b045ee5b14a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d25adecc2ebb220fe69b310fe84b807" id="r_a4d25adecc2ebb220fe69b310fe84b807"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a4d25adecc2ebb220fe69b310fe84b807">test_gges_tgexc</a> (dtype)</td></tr>
<tr class="separator:a4d25adecc2ebb220fe69b310fe84b807"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af7ce0dc1f845c58e9b44fa2f16ff288c" id="r_af7ce0dc1f845c58e9b44fa2f16ff288c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#af7ce0dc1f845c58e9b44fa2f16ff288c">clapack</a> = None</td></tr>
<tr class="separator:af7ce0dc1f845c58e9b44fa2f16ff288c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68c537e8dac43687de21b7402d08dade" id="r_a68c537e8dac43687de21b7402d08dade"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a68c537e8dac43687de21b7402d08dade">REAL_DTYPES</a> = [np.float32, np.float64]</td></tr>
<tr class="separator:a68c537e8dac43687de21b7402d08dade"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb1e4e3b373e0a3e1fca854aabd8daf" id="r_a4fb1e4e3b373e0a3e1fca854aabd8daf"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a4fb1e4e3b373e0a3e1fca854aabd8daf">COMPLEX_DTYPES</a> = [np.complex64, np.complex128]</td></tr>
<tr class="separator:a4fb1e4e3b373e0a3e1fca854aabd8daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c821594c0afbacc39ba795499047516" id="r_a7c821594c0afbacc39ba795499047516"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a7c821594c0afbacc39ba795499047516">DTYPES</a> = <a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a68c537e8dac43687de21b7402d08dade">REAL_DTYPES</a> + <a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a4fb1e4e3b373e0a3e1fca854aabd8daf">COMPLEX_DTYPES</a></td></tr>
<tr class="separator:a7c821594c0afbacc39ba795499047516"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a438f9892c24645769813f24d1a78011f" name="a438f9892c24645769813f24d1a78011f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a438f9892c24645769813f24d1a78011f">&#9670;&#160;</a></span>generate_random_dtype_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.generate_random_dtype_array </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   41</span><span class="keyword">def </span>generate_random_dtype_array(shape, dtype):</div>
<div class="line"><span class="lineno">   42</span>    <span class="comment"># generates a random matrix of desired data type of shape</span></div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> COMPLEX_DTYPES:</div>
<div class="line"><span class="lineno">   44</span>        <span class="keywordflow">return</span> (np.random.rand(*shape)</div>
<div class="line"><span class="lineno">   45</span>                + np.random.rand(*shape)*1.0j).astype(dtype)</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">return</span> np.random.rand(*shape).astype(dtype)</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a166fa55c9056576ba11540cf83685ce5" name="a166fa55c9056576ba11540cf83685ce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a166fa55c9056576ba11540cf83685ce5">&#9670;&#160;</a></span>pteqr_get_d_e_A_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.pteqr_get_d_e_A_z </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compute_z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2275</span><span class="keyword">def </span>pteqr_get_d_e_A_z(dtype, realtype, n, compute_z):</div>
<div class="line"><span class="lineno"> 2276</span>    <span class="comment"># used by ?pteqr tests to build parameters</span></div>
<div class="line"><span class="lineno"> 2277</span>    <span class="comment"># returns tuple of (d, e, A, z)</span></div>
<div class="line"><span class="lineno"> 2278</span>    <span class="keywordflow">if</span> compute_z == 1:</div>
<div class="line"><span class="lineno"> 2279</span>        <span class="comment"># build Hermitian A from Q**T * tri * Q = A by creating Q and tri</span></div>
<div class="line"><span class="lineno"> 2280</span>        A_eig = generate_random_dtype_array((n, n), dtype)</div>
<div class="line"><span class="lineno"> 2281</span>        A_eig = A_eig + np.diag(np.zeros(n) + 4*n)</div>
<div class="line"><span class="lineno"> 2282</span>        A_eig = (A_eig + A_eig.conj().T) / 2</div>
<div class="line"><span class="lineno"> 2283</span>        <span class="comment"># obtain right eigenvectors (orthogonal)</span></div>
<div class="line"><span class="lineno"> 2284</span>        vr = eigh(A_eig)[1]</div>
<div class="line"><span class="lineno"> 2285</span>        <span class="comment"># create tridiagonal matrix</span></div>
<div class="line"><span class="lineno"> 2286</span>        d = generate_random_dtype_array((n,), realtype) + 4</div>
<div class="line"><span class="lineno"> 2287</span>        e = generate_random_dtype_array((n-1,), realtype)</div>
<div class="line"><span class="lineno"> 2288</span>        tri = np.diag(d) + np.diag(e, 1) + np.diag(e, -1)</div>
<div class="line"><span class="lineno"> 2289</span>        <span class="comment"># Build A using these factors that sytrd would: (Q**T * tri * Q = A)</span></div>
<div class="line"><span class="lineno"> 2290</span>        A = vr @ tri @ vr.conj().T</div>
<div class="line"><span class="lineno"> 2291</span>        <span class="comment"># vr is orthogonal</span></div>
<div class="line"><span class="lineno"> 2292</span>        z = vr</div>
<div class="line"><span class="lineno"> 2293</span> </div>
<div class="line"><span class="lineno"> 2294</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2295</span>        <span class="comment"># d and e are always real per lapack docs.</span></div>
<div class="line"><span class="lineno"> 2296</span>        d = generate_random_dtype_array((n,), realtype)</div>
<div class="line"><span class="lineno"> 2297</span>        e = generate_random_dtype_array((n-1,), realtype)</div>
<div class="line"><span class="lineno"> 2298</span> </div>
<div class="line"><span class="lineno"> 2299</span>        <span class="comment"># make SPD</span></div>
<div class="line"><span class="lineno"> 2300</span>        d = d + 4</div>
<div class="line"><span class="lineno"> 2301</span>        A = np.diag(d) + np.diag(e, 1) + np.diag(e, -1)</div>
<div class="line"><span class="lineno"> 2302</span>        z = np.diag(d) + np.diag(e, -1) + np.diag(e, 1)</div>
<div class="line"><span class="lineno"> 2303</span>    <span class="keywordflow">return</span> (d, e, A, z)</div>
<div class="line"><span class="lineno"> 2304</span> </div>
<div class="line"><span class="lineno"> 2305</span> </div>
<div class="line"><span class="lineno"> 2306</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;dtype,realtype&quot;</span>,</div>
<div class="line"><span class="lineno"> 2307</span>                         zip(DTYPES, REAL_DTYPES + REAL_DTYPES))</div>
<div class="line"><span class="lineno"> 2308</span><span class="preprocessor">@pytest.mark.parametrize(&quot;compute_z&quot;, range(3)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ed156cce64cd7afb726bf642df77604" name="a6ed156cce64cd7afb726bf642df77604"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed156cce64cd7afb726bf642df77604">&#9670;&#160;</a></span>test_geequ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_geequ </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1682</span><span class="keyword">def </span>test_geequ():</div>
<div class="line"><span class="lineno"> 1683</span>    desired_real = np.array([[0.6250, 1.0000, 0.0393, -0.4269],</div>
<div class="line"><span class="lineno"> 1684</span>                             [1.0000, -0.5619, -1.0000, -1.0000],</div>
<div class="line"><span class="lineno"> 1685</span>                             [0.5874, -1.0000, -0.0596, -0.5341],</div>
<div class="line"><span class="lineno"> 1686</span>                             [-1.0000, -0.5946, -0.0294, 0.9957]])</div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span>    desired_cplx = np.array([[-0.2816+0.5359*1j,</div>
<div class="line"><span class="lineno"> 1689</span>                              0.0812+0.9188*1j,</div>
<div class="line"><span class="lineno"> 1690</span>                              -0.7439-0.2561*1j],</div>
<div class="line"><span class="lineno"> 1691</span>                             [-0.3562-0.2954*1j,</div>
<div class="line"><span class="lineno"> 1692</span>                              0.9566-0.0434*1j,</div>
<div class="line"><span class="lineno"> 1693</span>                              -0.0174+0.1555*1j],</div>
<div class="line"><span class="lineno"> 1694</span>                             [0.8607+0.1393*1j,</div>
<div class="line"><span class="lineno"> 1695</span>                              -0.2759+0.7241*1j,</div>
<div class="line"><span class="lineno"> 1696</span>                              -0.1642-0.1365*1j]])</div>
<div class="line"><span class="lineno"> 1697</span> </div>
<div class="line"><span class="lineno"> 1698</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1699</span>        <span class="keywordflow">if</span> ind &lt; 2:</div>
<div class="line"><span class="lineno"> 1700</span>            <span class="comment"># Use examples from the NAG documentation</span></div>
<div class="line"><span class="lineno"> 1701</span>            A = np.array([[1.80e+10, 2.88e+10, 2.05e+00, -8.90e+09],</div>
<div class="line"><span class="lineno"> 1702</span>                          [5.25e+00, -2.95e+00, -9.50e-09, -3.80e+00],</div>
<div class="line"><span class="lineno"> 1703</span>                          [1.58e+00, -2.69e+00, -2.90e-10, -1.04e+00],</div>
<div class="line"><span class="lineno"> 1704</span>                          [-1.11e+00, -6.60e-01, -5.90e-11, 8.00e-01]])</div>
<div class="line"><span class="lineno"> 1705</span>            A = A.astype(dtype)</div>
<div class="line"><span class="lineno"> 1706</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1707</span>            A = np.array([[-1.34e+00, 0.28e+10, -6.39e+00],</div>
<div class="line"><span class="lineno"> 1708</span>                          [-1.70e+00, 3.31e+10, -0.15e+00],</div>
<div class="line"><span class="lineno"> 1709</span>                          [2.41e-10, -0.56e+00, -0.83e-10]], dtype=dtype)</div>
<div class="line"><span class="lineno"> 1710</span>            A += np.array([[2.55e+00, 3.17e+10, -2.20e+00],</div>
<div class="line"><span class="lineno"> 1711</span>                           [-1.41e+00, -0.15e+10, 1.34e+00],</div>
<div class="line"><span class="lineno"> 1712</span>                           [0.39e-10, 1.47e+00, -0.69e-10]])*1j</div>
<div class="line"><span class="lineno"> 1713</span> </div>
<div class="line"><span class="lineno"> 1714</span>            A = A.astype(dtype)</div>
<div class="line"><span class="lineno"> 1715</span> </div>
<div class="line"><span class="lineno"> 1716</span>        geequ = get_lapack_funcs(<span class="stringliteral">&#39;geequ&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1717</span>        r, c, rowcnd, colcnd, amax, info = geequ(A)</div>
<div class="line"><span class="lineno"> 1718</span> </div>
<div class="line"><span class="lineno"> 1719</span>        <span class="keywordflow">if</span> ind &lt; 2:</div>
<div class="line"><span class="lineno"> 1720</span>            assert_allclose(desired_real.astype(dtype), r[:, <span class="keywordtype">None</span>]*A*c,</div>
<div class="line"><span class="lineno"> 1721</span>                            rtol=0, atol=1e-4)</div>
<div class="line"><span class="lineno"> 1722</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1723</span>            assert_allclose(desired_cplx.astype(dtype), r[:, <span class="keywordtype">None</span>]*A*c,</div>
<div class="line"><span class="lineno"> 1724</span>                            rtol=0, atol=1e-4)</div>
<div class="line"><span class="lineno"> 1725</span> </div>
<div class="line"><span class="lineno"> 1726</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5edfd044862f672d76fa991ae1d85384" name="a5edfd044862f672d76fa991ae1d85384"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5edfd044862f672d76fa991ae1d85384">&#9670;&#160;</a></span>test_gejsv_edge_arguments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gejsv_edge_arguments </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test edge arguments return expected status</pre> <div class="fragment"><div class="line"><span class="lineno"> 1902</span><span class="keyword">def </span>test_gejsv_edge_arguments(dtype):</div>
<div class="line"><span class="lineno"> 1903</span>    <span class="stringliteral">&quot;&quot;&quot;Test edge arguments return expected status&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1904</span>    gejsv = get_lapack_funcs(<span class="stringliteral">&#39;gejsv&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1905</span> </div>
<div class="line"><span class="lineno"> 1906</span>    <span class="comment"># scalar A</span></div>
<div class="line"><span class="lineno"> 1907</span>    sva, u, v, work, iwork, info = gejsv(1.)</div>
<div class="line"><span class="lineno"> 1908</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 1909</span>    assert_equal(u.shape, (1, 1))</div>
<div class="line"><span class="lineno"> 1910</span>    assert_equal(v.shape, (1, 1))</div>
<div class="line"><span class="lineno"> 1911</span>    assert_equal(sva, np.array([1.], dtype=dtype))</div>
<div class="line"><span class="lineno"> 1912</span> </div>
<div class="line"><span class="lineno"> 1913</span>    <span class="comment"># 1d A</span></div>
<div class="line"><span class="lineno"> 1914</span>    A = np.ones((1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1915</span>    sva, u, v, work, iwork, info = gejsv(A)</div>
<div class="line"><span class="lineno"> 1916</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 1917</span>    assert_equal(u.shape, (1, 1))</div>
<div class="line"><span class="lineno"> 1918</span>    assert_equal(v.shape, (1, 1))</div>
<div class="line"><span class="lineno"> 1919</span>    assert_equal(sva, np.array([1.], dtype=dtype))</div>
<div class="line"><span class="lineno"> 1920</span> </div>
<div class="line"><span class="lineno"> 1921</span>    <span class="comment"># 2d empty A</span></div>
<div class="line"><span class="lineno"> 1922</span>    A = np.ones((1, 0), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1923</span>    sva, u, v, work, iwork, info = gejsv(A)</div>
<div class="line"><span class="lineno"> 1924</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 1925</span>    assert_equal(u.shape, (1, 0))</div>
<div class="line"><span class="lineno"> 1926</span>    assert_equal(v.shape, (1, 0))</div>
<div class="line"><span class="lineno"> 1927</span>    assert_equal(sva, np.array([], dtype=dtype))</div>
<div class="line"><span class="lineno"> 1928</span> </div>
<div class="line"><span class="lineno"> 1929</span>    <span class="comment"># make sure &quot;overwrite_a&quot; is respected - user reported in gh-13191</span></div>
<div class="line"><span class="lineno"> 1930</span>    A = np.sin(np.arange(100).reshape(10, 10)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1931</span>    A = np.asfortranarray(A + A.T)  <span class="comment"># make it symmetric and column major</span></div>
<div class="line"><span class="lineno"> 1932</span>    Ac = A.copy(<span class="stringliteral">&#39;A&#39;</span>)</div>
<div class="line"><span class="lineno"> 1933</span>    _ = gejsv(A)</div>
<div class="line"><span class="lineno"> 1934</span>    assert_allclose(A, Ac)</div>
<div class="line"><span class="lineno"> 1935</span> </div>
<div class="line"><span class="lineno"> 1936</span> </div>
<div class="line"><span class="lineno"> 1937</span><span class="preprocessor">@pytest.mark.parametrize((&#39;kwargs&#39;)</span>,</div>
<div class="line"><span class="lineno"> 1938</span>                         ({<span class="stringliteral">&#39;joba&#39;</span>: 9},</div>
<div class="line"><span class="lineno"> 1939</span>                          {<span class="stringliteral">&#39;jobu&#39;</span>: 9},</div>
<div class="line"><span class="lineno"> 1940</span>                          {<span class="stringliteral">&#39;jobv&#39;</span>: 9},</div>
<div class="line"><span class="lineno"> 1941</span>                          {<span class="stringliteral">&#39;jobr&#39;</span>: 9},</div>
<div class="line"><span class="lineno"> 1942</span>                          {<span class="stringliteral">&#39;jobt&#39;</span>: 9},</div>
<div class="line"><span class="lineno"> 1943</span>                          {<span class="stringliteral">&#39;jobp&#39;</span>: 9})</div>
<div class="line"><span class="lineno"> 1944</span>                         )</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad395a80c6d4593b840218a9280f888a2" name="ad395a80c6d4593b840218a9280f888a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad395a80c6d4593b840218a9280f888a2">&#9670;&#160;</a></span>test_gejsv_general()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gejsv_general </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>joba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jobu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jobv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jobr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jobp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jobt</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test the lapack routine ?gejsv.

This function tests that a singular value decomposition can be performed
on the random M-by-N matrix A. The test performs the SVD using ?gejsv
then performs the following checks:

* ?gejsv exist successfully (info == 0)
* The returned singular values are correct
* `A` can be reconstructed from `u`, `SIGMA`, `v`
* Ensure that u.T @ u is the identity matrix
* Ensure that v.T @ v is the identity matrix
* The reported matrix rank
* The reported number of singular values
* If denormalized floats are required

Notes
-----
joba specifies several choices effecting the calculation's accuracy
Although all arguments are tested, the tests only check that the correct
solution is returned - NOT that the prescribed actions are performed
internally.

jobt is, as of v3.9.0, still experimental and removed to cut down number of
test cases. However keyword itself is tested externally.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1800</span><span class="keyword">def </span>test_gejsv_general(size, dtype, joba, jobu, jobv, jobr, jobp, jobt=0):</div>
<div class="line"><span class="lineno"> 1801</span>    <span class="stringliteral">&quot;&quot;&quot;Test the lapack routine ?gejsv.</span></div>
<div class="line"><span class="lineno"> 1802</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1803</span><span class="stringliteral">    This function tests that a singular value decomposition can be performed</span></div>
<div class="line"><span class="lineno"> 1804</span><span class="stringliteral">    on the random M-by-N matrix A. The test performs the SVD using ?gejsv</span></div>
<div class="line"><span class="lineno"> 1805</span><span class="stringliteral">    then performs the following checks:</span></div>
<div class="line"><span class="lineno"> 1806</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1807</span><span class="stringliteral">    * ?gejsv exist successfully (info == 0)</span></div>
<div class="line"><span class="lineno"> 1808</span><span class="stringliteral">    * The returned singular values are correct</span></div>
<div class="line"><span class="lineno"> 1809</span><span class="stringliteral">    * `A` can be reconstructed from `u`, `SIGMA`, `v`</span></div>
<div class="line"><span class="lineno"> 1810</span><span class="stringliteral">    * Ensure that u.T @ u is the identity matrix</span></div>
<div class="line"><span class="lineno"> 1811</span><span class="stringliteral">    * Ensure that v.T @ v is the identity matrix</span></div>
<div class="line"><span class="lineno"> 1812</span><span class="stringliteral">    * The reported matrix rank</span></div>
<div class="line"><span class="lineno"> 1813</span><span class="stringliteral">    * The reported number of singular values</span></div>
<div class="line"><span class="lineno"> 1814</span><span class="stringliteral">    * If denormalized floats are required</span></div>
<div class="line"><span class="lineno"> 1815</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1816</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1817</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1818</span><span class="stringliteral">    joba specifies several choices effecting the calculation&#39;s accuracy</span></div>
<div class="line"><span class="lineno"> 1819</span><span class="stringliteral">    Although all arguments are tested, the tests only check that the correct</span></div>
<div class="line"><span class="lineno"> 1820</span><span class="stringliteral">    solution is returned - NOT that the prescribed actions are performed</span></div>
<div class="line"><span class="lineno"> 1821</span><span class="stringliteral">    internally.</span></div>
<div class="line"><span class="lineno"> 1822</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1823</span><span class="stringliteral">    jobt is, as of v3.9.0, still experimental and removed to cut down number of</span></div>
<div class="line"><span class="lineno"> 1824</span><span class="stringliteral">    test cases. However keyword itself is tested externally.</span></div>
<div class="line"><span class="lineno"> 1825</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1826</span>    seed(42)</div>
<div class="line"><span class="lineno"> 1827</span> </div>
<div class="line"><span class="lineno"> 1828</span>    <span class="comment"># Define some constants for later use:</span></div>
<div class="line"><span class="lineno"> 1829</span>    m, n = size</div>
<div class="line"><span class="lineno"> 1830</span>    atol = 100 * np.finfo(dtype).eps</div>
<div class="line"><span class="lineno"> 1831</span>    A = generate_random_dtype_array(size, dtype)</div>
<div class="line"><span class="lineno"> 1832</span>    gejsv = get_lapack_funcs(<span class="stringliteral">&#39;gejsv&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1833</span> </div>
<div class="line"><span class="lineno"> 1834</span>    <span class="comment"># Set up checks for invalid job? combinations</span></div>
<div class="line"><span class="lineno"> 1835</span>    <span class="comment"># if an invalid combination occurs we set the appropriate</span></div>
<div class="line"><span class="lineno"> 1836</span>    <span class="comment"># exit status.</span></div>
<div class="line"><span class="lineno"> 1837</span>    lsvec = jobu &lt; 2  <span class="comment"># Calculate left singular vectors</span></div>
<div class="line"><span class="lineno"> 1838</span>    rsvec = jobv &lt; 2  <span class="comment"># Calculate right singular vectors</span></div>
<div class="line"><span class="lineno"> 1839</span>    l2tran = (jobt == 1) <span class="keywordflow">and</span> (m == n)</div>
<div class="line"><span class="lineno"> 1840</span>    is_complex = np.iscomplexobj(A)</div>
<div class="line"><span class="lineno"> 1841</span> </div>
<div class="line"><span class="lineno"> 1842</span>    invalid_real_jobv = (jobv == 1) <span class="keywordflow">and</span> (<span class="keywordflow">not</span> lsvec) <span class="keywordflow">and</span> (<span class="keywordflow">not</span> is_complex)</div>
<div class="line"><span class="lineno"> 1843</span>    invalid_cplx_jobu = (jobu == 2) <span class="keywordflow">and</span> <span class="keywordflow">not</span> (rsvec <span class="keywordflow">and</span> l2tran) <span class="keywordflow">and</span> is_complex</div>
<div class="line"><span class="lineno"> 1844</span>    invalid_cplx_jobv = (jobv == 2) <span class="keywordflow">and</span> <span class="keywordflow">not</span> (lsvec <span class="keywordflow">and</span> l2tran) <span class="keywordflow">and</span> is_complex</div>
<div class="line"><span class="lineno"> 1845</span> </div>
<div class="line"><span class="lineno"> 1846</span>    <span class="comment"># Set the exit status to the expected value.</span></div>
<div class="line"><span class="lineno"> 1847</span>    <span class="comment"># Here we only check for invalid combinations, not individual</span></div>
<div class="line"><span class="lineno"> 1848</span>    <span class="comment"># parameters.</span></div>
<div class="line"><span class="lineno"> 1849</span>    <span class="keywordflow">if</span> invalid_cplx_jobu:</div>
<div class="line"><span class="lineno"> 1850</span>        exit_status = -2</div>
<div class="line"><span class="lineno"> 1851</span>    <span class="keywordflow">elif</span> invalid_real_jobv <span class="keywordflow">or</span> invalid_cplx_jobv:</div>
<div class="line"><span class="lineno"> 1852</span>        exit_status = -3</div>
<div class="line"><span class="lineno"> 1853</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1854</span>        exit_status = 0</div>
<div class="line"><span class="lineno"> 1855</span> </div>
<div class="line"><span class="lineno"> 1856</span>    <span class="keywordflow">if</span> (jobu &gt; 1) <span class="keywordflow">and</span> (jobv == 1):</div>
<div class="line"><span class="lineno"> 1857</span>        assert_raises(Exception, gejsv, A, joba, jobu, jobv, jobr, jobt, jobp)</div>
<div class="line"><span class="lineno"> 1858</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1859</span>        sva, u, v, work, iwork, info = gejsv(A,</div>
<div class="line"><span class="lineno"> 1860</span>                                             joba=joba,</div>
<div class="line"><span class="lineno"> 1861</span>                                             jobu=jobu,</div>
<div class="line"><span class="lineno"> 1862</span>                                             jobv=jobv,</div>
<div class="line"><span class="lineno"> 1863</span>                                             jobr=jobr,</div>
<div class="line"><span class="lineno"> 1864</span>                                             jobt=jobt,</div>
<div class="line"><span class="lineno"> 1865</span>                                             jobp=jobp)</div>
<div class="line"><span class="lineno"> 1866</span> </div>
<div class="line"><span class="lineno"> 1867</span>        <span class="comment"># Check that ?gejsv exited successfully/as expected</span></div>
<div class="line"><span class="lineno"> 1868</span>        assert_equal(info, exit_status)</div>
<div class="line"><span class="lineno"> 1869</span> </div>
<div class="line"><span class="lineno"> 1870</span>        <span class="comment"># If exit_status is non-zero the combination of jobs is invalid.</span></div>
<div class="line"><span class="lineno"> 1871</span>        <span class="comment"># We test this above but no calculations are performed.</span></div>
<div class="line"><span class="lineno"> 1872</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> exit_status:</div>
<div class="line"><span class="lineno"> 1873</span> </div>
<div class="line"><span class="lineno"> 1874</span>            <span class="comment"># Check the returned singular values</span></div>
<div class="line"><span class="lineno"> 1875</span>            sigma = (work[0] / work[1]) * sva[:n]</div>
<div class="line"><span class="lineno"> 1876</span>            assert_allclose(sigma, svd(A, compute_uv=<span class="keyword">False</span>), atol=atol)</div>
<div class="line"><span class="lineno"> 1877</span> </div>
<div class="line"><span class="lineno"> 1878</span>            <span class="keywordflow">if</span> jobu == 1:</div>
<div class="line"><span class="lineno"> 1879</span>                <span class="comment"># If JOBU = &#39;F&#39;, then u contains the M-by-M matrix of</span></div>
<div class="line"><span class="lineno"> 1880</span>                <span class="comment"># the left singular vectors, including an ONB of the orthogonal</span></div>
<div class="line"><span class="lineno"> 1881</span>                <span class="comment"># complement of the Range(A)</span></div>
<div class="line"><span class="lineno"> 1882</span>                <span class="comment"># However, to recalculate A we are concerned about the</span></div>
<div class="line"><span class="lineno"> 1883</span>                <span class="comment"># first n singular values and so can ignore the latter.</span></div>
<div class="line"><span class="lineno"> 1884</span>                <span class="comment"># TODO: Add a test for ONB?</span></div>
<div class="line"><span class="lineno"> 1885</span>                u = u[:, :n]</div>
<div class="line"><span class="lineno"> 1886</span> </div>
<div class="line"><span class="lineno"> 1887</span>            <span class="keywordflow">if</span> lsvec <span class="keywordflow">and</span> rsvec:</div>
<div class="line"><span class="lineno"> 1888</span>                assert_allclose(u @ np.diag(sigma) @ v.conj().T, A, atol=atol)</div>
<div class="line"><span class="lineno"> 1889</span>            <span class="keywordflow">if</span> lsvec:</div>
<div class="line"><span class="lineno"> 1890</span>                assert_allclose(u.conj().T @ u, np.identity(n), atol=atol)</div>
<div class="line"><span class="lineno"> 1891</span>            <span class="keywordflow">if</span> rsvec:</div>
<div class="line"><span class="lineno"> 1892</span>                assert_allclose(v.conj().T @ v, np.identity(n), atol=atol)</div>
<div class="line"><span class="lineno"> 1893</span> </div>
<div class="line"><span class="lineno"> 1894</span>            assert_equal(iwork[0], np.linalg.matrix_rank(A))</div>
<div class="line"><span class="lineno"> 1895</span>            assert_equal(iwork[1], np.count_nonzero(sigma))</div>
<div class="line"><span class="lineno"> 1896</span>            <span class="comment"># iwork[2] is non-zero if requested accuracy is not warranted for</span></div>
<div class="line"><span class="lineno"> 1897</span>            <span class="comment"># the data. This should never occur for these tests.</span></div>
<div class="line"><span class="lineno"> 1898</span>            assert_equal(iwork[2], 0)</div>
<div class="line"><span class="lineno"> 1899</span> </div>
<div class="line"><span class="lineno"> 1900</span> </div>
<div class="line"><span class="lineno"> 1901</span><span class="preprocessor">@pytest.mark.parametrize(&#39;dtype&#39;, REAL_DTYPES)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa86dde3df054133f1e98d0d42cf01f22" name="aa86dde3df054133f1e98d0d42cf01f22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa86dde3df054133f1e98d0d42cf01f22">&#9670;&#160;</a></span>test_gejsv_invalid_job_arguments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gejsv_invalid_job_arguments </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test invalid job arguments raise an Exception</pre> <div class="fragment"><div class="line"><span class="lineno"> 1945</span><span class="keyword">def </span>test_gejsv_invalid_job_arguments(kwargs):</div>
<div class="line"><span class="lineno"> 1946</span>    <span class="stringliteral">&quot;&quot;&quot;Test invalid job arguments raise an Exception&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1947</span>    A = np.ones((2, 2), dtype=float)</div>
<div class="line"><span class="lineno"> 1948</span>    gejsv = get_lapack_funcs(<span class="stringliteral">&#39;gejsv&#39;</span>, dtype=float)</div>
<div class="line"><span class="lineno"> 1949</span>    assert_raises(Exception, gejsv, A, **kwargs)</div>
<div class="line"><span class="lineno"> 1950</span> </div>
<div class="line"><span class="lineno"> 1951</span> </div>
<div class="line"><span class="lineno"> 1952</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;A,sva_expect,u_expect,v_expect&quot;</span>,</div>
<div class="line"><span class="lineno"> 1953</span>                         [(np.array([[2.27, -1.54, 1.15, -1.94],</div>
<div class="line"><span class="lineno"> 1954</span>                                     [0.28, -1.67, 0.94, -0.78],</div>
<div class="line"><span class="lineno"> 1955</span>                                     [-0.48, -3.09, 0.99, -0.21],</div>
<div class="line"><span class="lineno"> 1956</span>                                     [1.07, 1.22, 0.79, 0.63],</div>
<div class="line"><span class="lineno"> 1957</span>                                     [-2.35, 2.93, -1.45, 2.30],</div>
<div class="line"><span class="lineno"> 1958</span>                                     [0.62, -7.39, 1.03, -2.57]]),</div>
<div class="line"><span class="lineno"> 1959</span>                           np.array([9.9966, 3.6831, 1.3569, 0.5000]),</div>
<div class="line"><span class="lineno"> 1960</span>                           np.array([[0.2774, -0.6003, -0.1277, 0.1323],</div>
<div class="line"><span class="lineno"> 1961</span>                                     [0.2020, -0.0301, 0.2805, 0.7034],</div>
<div class="line"><span class="lineno"> 1962</span>                                     [0.2918, 0.3348, 0.6453, 0.1906],</div>
<div class="line"><span class="lineno"> 1963</span>                                     [-0.0938, -0.3699, 0.6781, -0.5399],</div>
<div class="line"><span class="lineno"> 1964</span>                                     [-0.4213, 0.5266, 0.0413, -0.0575],</div>
<div class="line"><span class="lineno"> 1965</span>                                     [0.7816, 0.3353, -0.1645, -0.3957]]),</div>
<div class="line"><span class="lineno"> 1966</span>                           np.array([[0.1921, -0.8030, 0.0041, -0.5642],</div>
<div class="line"><span class="lineno"> 1967</span>                                     [-0.8794, -0.3926, -0.0752, 0.2587],</div>
<div class="line"><span class="lineno"> 1968</span>                                     [0.2140, -0.2980, 0.7827, 0.5027],</div>
<div class="line"><span class="lineno"> 1969</span>                                     [-0.3795, 0.3351, 0.6178, -0.6017]]))])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a31a0e9930d2eabadfa7ca5d0f6192977" name="a31a0e9930d2eabadfa7ca5d0f6192977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31a0e9930d2eabadfa7ca5d0f6192977">&#9670;&#160;</a></span>test_gejsv_NAG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gejsv_NAG </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sva_expect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>u_expect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v_expect</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This test implements the example found in the NAG manual, f08khf.
An example was not found for the complex case.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1970</span><span class="keyword">def </span>test_gejsv_NAG(A, sva_expect, u_expect, v_expect):</div>
<div class="line"><span class="lineno"> 1971</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1972</span><span class="stringliteral">    This test implements the example found in the NAG manual, f08khf.</span></div>
<div class="line"><span class="lineno"> 1973</span><span class="stringliteral">    An example was not found for the complex case.</span></div>
<div class="line"><span class="lineno"> 1974</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1975</span>    <span class="comment"># NAG manual provides accuracy up to 4 decimals</span></div>
<div class="line"><span class="lineno"> 1976</span>    atol = 1e-4</div>
<div class="line"><span class="lineno"> 1977</span>    gejsv = get_lapack_funcs(<span class="stringliteral">&#39;gejsv&#39;</span>, dtype=A.dtype)</div>
<div class="line"><span class="lineno"> 1978</span> </div>
<div class="line"><span class="lineno"> 1979</span>    sva, u, v, work, iwork, info = gejsv(A)</div>
<div class="line"><span class="lineno"> 1980</span> </div>
<div class="line"><span class="lineno"> 1981</span>    assert_allclose(sva_expect, sva, atol=atol)</div>
<div class="line"><span class="lineno"> 1982</span>    assert_allclose(u_expect, u, atol=atol)</div>
<div class="line"><span class="lineno"> 1983</span>    assert_allclose(v_expect, v, atol=atol)</div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span> </div>
<div class="line"><span class="lineno"> 1986</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, DTYPES)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc856b8b9f1fa38fb018095ea7ac84ef" name="acc856b8b9f1fa38fb018095ea7ac84ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc856b8b9f1fa38fb018095ea7ac84ef">&#9670;&#160;</a></span>test_generalized_eigh_lworks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_generalized_eigh_lworks </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pfx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>driver</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2499</span><span class="keyword">def </span>test_generalized_eigh_lworks(pfx, driver):</div>
<div class="line"><span class="lineno"> 2500</span>    n = 1200  <span class="comment"># Some sufficiently big arbitrary number</span></div>
<div class="line"><span class="lineno"> 2501</span>    dtype = REAL_DTYPES <span class="keywordflow">if</span> pfx == <span class="stringliteral">&#39;sy&#39;</span> <span class="keywordflow">else</span> COMPLEX_DTYPES</div>
<div class="line"><span class="lineno"> 2502</span>    sc_dlw = get_lapack_funcs(pfx+driver+<span class="stringliteral">&#39;_lwork&#39;</span>, dtype=dtype[0])</div>
<div class="line"><span class="lineno"> 2503</span>    dz_dlw = get_lapack_funcs(pfx+driver+<span class="stringliteral">&#39;_lwork&#39;</span>, dtype=dtype[1])</div>
<div class="line"><span class="lineno"> 2504</span>    <span class="comment"># Shouldn&#39;t raise any exceptions</span></div>
<div class="line"><span class="lineno"> 2505</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2506</span>        _compute_lwork(sc_dlw, n, uplo=<span class="stringliteral">&quot;L&quot;</span>)</div>
<div class="line"><span class="lineno"> 2507</span>        _compute_lwork(dz_dlw, n, uplo=<span class="stringliteral">&quot;L&quot;</span>)</div>
<div class="line"><span class="lineno"> 2508</span>    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2509</span>        pytest.fail(<span class="stringliteral">&quot;{}_lwork raised unexpected exception: {}&quot;</span></div>
<div class="line"><span class="lineno"> 2510</span>                    <span class="stringliteral">&quot;&quot;</span>.format(pfx+driver, e))</div>
<div class="line"><span class="lineno"> 2511</span> </div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype_&quot;, DTYPES)</span></div>
<div class="line"><span class="lineno"> 2514</span><span class="preprocessor">@pytest.mark.parametrize(&quot;m&quot;, [1, 10, 100, 1000])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6aadb42a0bcb8978a70cb7963e47bb55" name="a6aadb42a0bcb8978a70cb7963e47bb55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aadb42a0bcb8978a70cb7963e47bb55">&#9670;&#160;</a></span>test_geqrf_lwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_geqrf_lwork </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shape</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  420</span><span class="keyword">def </span>test_geqrf_lwork(dtype, shape):</div>
<div class="line"><span class="lineno">  421</span>    geqrf_lwork = get_lapack_funcs((<span class="stringliteral">&#39;geqrf_lwork&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno">  422</span>    m, n = shape</div>
<div class="line"><span class="lineno">  423</span>    lwork, info = geqrf_lwork(m=m, n=n)</div>
<div class="line"><span class="lineno">  424</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acfa45dec3a4002a1a7a2b694253184d9" name="acfa45dec3a4002a1a7a2b694253184d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfa45dec3a4002a1a7a2b694253184d9">&#9670;&#160;</a></span>test_geqrfp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_geqrfp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>matrix_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2411</span><span class="keyword">def </span>test_geqrfp(dtype, matrix_size):</div>
<div class="line"><span class="lineno"> 2412</span>    <span class="comment"># Tests for all dytpes, tall, wide, and square matrices.</span></div>
<div class="line"><span class="lineno"> 2413</span>    <span class="comment"># Using the routine with random matrix A, Q and R are obtained and then</span></div>
<div class="line"><span class="lineno"> 2414</span>    <span class="comment"># tested such that R is upper triangular and non-negative on the diagonal,</span></div>
<div class="line"><span class="lineno"> 2415</span>    <span class="comment"># and Q is an orthagonal matrix. Verifies that A=Q@R. It also</span></div>
<div class="line"><span class="lineno"> 2416</span>    <span class="comment"># tests against a matrix that for which the  linalg.qr method returns</span></div>
<div class="line"><span class="lineno"> 2417</span>    <span class="comment"># negative diagonals, and for error messaging.</span></div>
<div class="line"><span class="lineno"> 2418</span> </div>
<div class="line"><span class="lineno"> 2419</span>    <span class="comment"># set test tolerance appropriate for dtype</span></div>
<div class="line"><span class="lineno"> 2420</span>    np.random.seed(42)</div>
<div class="line"><span class="lineno"> 2421</span>    rtol = 250*np.finfo(dtype).eps</div>
<div class="line"><span class="lineno"> 2422</span>    atol = 100*np.finfo(dtype).eps</div>
<div class="line"><span class="lineno"> 2423</span>    <span class="comment"># get appropriate ?geqrfp for dtype</span></div>
<div class="line"><span class="lineno"> 2424</span>    geqrfp = get_lapack_funcs((<span class="stringliteral">&#39;geqrfp&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2425</span>    gqr = get_lapack_funcs((<span class="stringliteral">&quot;orgqr&quot;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2426</span> </div>
<div class="line"><span class="lineno"> 2427</span>    m, n = matrix_size</div>
<div class="line"><span class="lineno"> 2428</span> </div>
<div class="line"><span class="lineno"> 2429</span>    <span class="comment"># create random matrix of dimentions m x n</span></div>
<div class="line"><span class="lineno"> 2430</span>    A = generate_random_dtype_array((m, n), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2431</span>    <span class="comment"># create qr matrix using geqrfp</span></div>
<div class="line"><span class="lineno"> 2432</span>    qr_A, tau, info = geqrfp(A)</div>
<div class="line"><span class="lineno"> 2433</span> </div>
<div class="line"><span class="lineno"> 2434</span>    <span class="comment"># obtain r from the upper triangular area</span></div>
<div class="line"><span class="lineno"> 2435</span>    r = np.triu(qr_A)</div>
<div class="line"><span class="lineno"> 2436</span> </div>
<div class="line"><span class="lineno"> 2437</span>    <span class="comment"># obtain q from the orgqr lapack routine</span></div>
<div class="line"><span class="lineno"> 2438</span>    <span class="comment"># based on linalg.qr&#39;s extraction strategy of q with orgqr</span></div>
<div class="line"><span class="lineno"> 2439</span> </div>
<div class="line"><span class="lineno"> 2440</span>    <span class="keywordflow">if</span> m &gt; n:</div>
<div class="line"><span class="lineno"> 2441</span>        <span class="comment"># this adds an extra column to the end of qr_A</span></div>
<div class="line"><span class="lineno"> 2442</span>        <span class="comment"># let qqr be an empty m x m matrix</span></div>
<div class="line"><span class="lineno"> 2443</span>        qqr = np.zeros((m, m), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2444</span>        <span class="comment"># set first n columns of qqr to qr_A</span></div>
<div class="line"><span class="lineno"> 2445</span>        qqr[:, :n] = qr_A</div>
<div class="line"><span class="lineno"> 2446</span>        <span class="comment"># determine q from this qqr</span></div>
<div class="line"><span class="lineno"> 2447</span>        <span class="comment"># note that m is a sufficient for lwork based on LAPACK documentation</span></div>
<div class="line"><span class="lineno"> 2448</span>        q = gqr(qqr, tau=tau, lwork=m)[0]</div>
<div class="line"><span class="lineno"> 2449</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2450</span>        q = gqr(qr_A[:, :m], tau=tau, lwork=m)[0]</div>
<div class="line"><span class="lineno"> 2451</span> </div>
<div class="line"><span class="lineno"> 2452</span>    <span class="comment"># test that q and r still make A</span></div>
<div class="line"><span class="lineno"> 2453</span>    assert_allclose(q<span class="preprocessor">@r</span>, A, rtol=rtol)</div>
<div class="line"><span class="lineno"> 2454</span>    <span class="comment"># ensure that q is orthogonal (that q @ transposed q is the identity)</span></div>
<div class="line"><span class="lineno"> 2455</span>    assert_allclose(np.eye(q.shape[0]), q@(q.conj().T), rtol=rtol,</div>
<div class="line"><span class="lineno"> 2456</span>                    atol=atol)</div>
<div class="line"><span class="lineno"> 2457</span>    <span class="comment"># ensure r is upper tri by comparing original r to r as upper triangular</span></div>
<div class="line"><span class="lineno"> 2458</span>    assert_allclose(r, np.triu(r), rtol=rtol)</div>
<div class="line"><span class="lineno"> 2459</span>    <span class="comment"># make sure diagonals of r are positive for this random solution</span></div>
<div class="line"><span class="lineno"> 2460</span>    assert_(np.all(np.diag(r) &gt; np.zeros(len(np.diag(r)))))</div>
<div class="line"><span class="lineno"> 2461</span>    <span class="comment"># ensure that info is zero for this success</span></div>
<div class="line"><span class="lineno"> 2462</span>    assert_(info == 0)</div>
<div class="line"><span class="lineno"> 2463</span> </div>
<div class="line"><span class="lineno"> 2464</span>    <span class="comment"># test that this routine gives r diagonals that are positive for a</span></div>
<div class="line"><span class="lineno"> 2465</span>    <span class="comment"># matrix that returns negatives in the diagonal with scipy.linalg.rq</span></div>
<div class="line"><span class="lineno"> 2466</span>    A_negative = generate_random_dtype_array((n, m), dtype=dtype) * -1</div>
<div class="line"><span class="lineno"> 2467</span>    r_rq_neg, q_rq_neg = qr(A_negative)</div>
<div class="line"><span class="lineno"> 2468</span>    rq_A_neg, tau_neg, info_neg = geqrfp(A_negative)</div>
<div class="line"><span class="lineno"> 2469</span>    <span class="comment"># assert that any of the entries on the diagonal from linalg.qr</span></div>
<div class="line"><span class="lineno"> 2470</span>    <span class="comment">#   are negative and that all of geqrfp are positive.</span></div>
<div class="line"><span class="lineno"> 2471</span>    assert_(np.any(np.diag(r_rq_neg) &lt; 0) <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno"> 2472</span>            np.all(np.diag(r) &gt; 0))</div>
<div class="line"><span class="lineno"> 2473</span> </div>
<div class="line"><span class="lineno"> 2474</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af3559d55984314a1257a1614aae695b5" name="af3559d55984314a1257a1614aae695b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3559d55984314a1257a1614aae695b5">&#9670;&#160;</a></span>test_geqrfp_errors_with_empty_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_geqrfp_errors_with_empty_array </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2475</span><span class="keyword">def </span>test_geqrfp_errors_with_empty_array():</div>
<div class="line"><span class="lineno"> 2476</span>    <span class="comment"># check that empty array raises good error message</span></div>
<div class="line"><span class="lineno"> 2477</span>    A_empty = np.array([])</div>
<div class="line"><span class="lineno"> 2478</span>    geqrfp = get_lapack_funcs(<span class="stringliteral">&#39;geqrfp&#39;</span>, dtype=A_empty.dtype)</div>
<div class="line"><span class="lineno"> 2479</span>    assert_raises(Exception, geqrfp, A_empty)</div>
<div class="line"><span class="lineno"> 2480</span> </div>
<div class="line"><span class="lineno"> 2481</span> </div>
<div class="line"><span class="lineno"> 2482</span><span class="preprocessor">@pytest.mark.parametrize(&quot;driver&quot;, [&#39;ev&#39;, &#39;evd&#39;, &#39;evr&#39;, &#39;evx&#39;])</span></div>
<div class="line"><span class="lineno"> 2483</span><span class="preprocessor">@pytest.mark.parametrize(&quot;pfx&quot;, [&#39;sy&#39;, &#39;he&#39;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb5958b11023e8fc44fe378eb51a712a" name="abb5958b11023e8fc44fe378eb51a712a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb5958b11023e8fc44fe378eb51a712a">&#9670;&#160;</a></span>test_geqrfp_lwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_geqrfp_lwork </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shape</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2144</span><span class="keyword">def </span>test_geqrfp_lwork(dtype, shape):</div>
<div class="line"><span class="lineno"> 2145</span>    geqrfp_lwork = get_lapack_funcs((<span class="stringliteral">&#39;geqrfp_lwork&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2146</span>    m, n = shape</div>
<div class="line"><span class="lineno"> 2147</span>    lwork, info = geqrfp_lwork(m=m, n=n)</div>
<div class="line"><span class="lineno"> 2148</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 2149</span> </div>
<div class="line"><span class="lineno"> 2150</span> </div>
<div class="line"><span class="lineno"> 2151</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;ddtype,dtype&quot;</span>,</div>
<div class="line"><span class="lineno"> 2152</span>                         zip(REAL_DTYPES + REAL_DTYPES, DTYPES))</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac53813b7747d6cddd68ed627d1ecc919" name="ac53813b7747d6cddd68ed627d1ecc919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac53813b7747d6cddd68ed627d1ecc919">&#9670;&#160;</a></span>test_getc2_gesc2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_getc2_gesc2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1762</span><span class="keyword">def </span>test_getc2_gesc2():</div>
<div class="line"><span class="lineno"> 1763</span>    np.random.seed(42)</div>
<div class="line"><span class="lineno"> 1764</span>    n = 10</div>
<div class="line"><span class="lineno"> 1765</span>    desired_real = np.random.rand(n)</div>
<div class="line"><span class="lineno"> 1766</span>    desired_cplx = np.random.rand(n) + np.random.rand(n)*1j</div>
<div class="line"><span class="lineno"> 1767</span> </div>
<div class="line"><span class="lineno"> 1768</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1769</span>        <span class="keywordflow">if</span> ind &lt; 2:</div>
<div class="line"><span class="lineno"> 1770</span>            A = np.random.rand(n, n)</div>
<div class="line"><span class="lineno"> 1771</span>            A = A.astype(dtype)</div>
<div class="line"><span class="lineno"> 1772</span>            b = A @ desired_real</div>
<div class="line"><span class="lineno"> 1773</span>            b = b.astype(dtype)</div>
<div class="line"><span class="lineno"> 1774</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1775</span>            A = np.random.rand(n, n) + np.random.rand(n, n)*1j</div>
<div class="line"><span class="lineno"> 1776</span>            A = A.astype(dtype)</div>
<div class="line"><span class="lineno"> 1777</span>            b = A @ desired_cplx</div>
<div class="line"><span class="lineno"> 1778</span>            b = b.astype(dtype)</div>
<div class="line"><span class="lineno"> 1779</span> </div>
<div class="line"><span class="lineno"> 1780</span>        getc2 = get_lapack_funcs(<span class="stringliteral">&#39;getc2&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1781</span>        gesc2 = get_lapack_funcs(<span class="stringliteral">&#39;gesc2&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1782</span>        lu, ipiv, jpiv, info = getc2(A, overwrite_a=0)</div>
<div class="line"><span class="lineno"> 1783</span>        x, scale = gesc2(lu, b, ipiv, jpiv, overwrite_rhs=0)</div>
<div class="line"><span class="lineno"> 1784</span> </div>
<div class="line"><span class="lineno"> 1785</span>        <span class="keywordflow">if</span> ind &lt; 2:</div>
<div class="line"><span class="lineno"> 1786</span>            assert_array_almost_equal(desired_real.astype(dtype),</div>
<div class="line"><span class="lineno"> 1787</span>                                      x/scale, decimal=4)</div>
<div class="line"><span class="lineno"> 1788</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1789</span>            assert_array_almost_equal(desired_cplx.astype(dtype),</div>
<div class="line"><span class="lineno"> 1790</span>                                      x/scale, decimal=4)</div>
<div class="line"><span class="lineno"> 1791</span> </div>
<div class="line"><span class="lineno"> 1792</span> </div>
<div class="line"><span class="lineno"> 1793</span><span class="preprocessor">@pytest.mark.parametrize(&#39;size&#39;, [(6, 5)</span>, (5, 5)])</div>
<div class="line"><span class="lineno"> 1794</span><span class="preprocessor">@pytest.mark.parametrize(&#39;dtype&#39;, REAL_DTYPES)</span></div>
<div class="line"><span class="lineno"> 1795</span><span class="preprocessor">@pytest.mark.parametrize(&#39;joba&#39;, range(6)</span>)  <span class="comment"># &#39;C&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;A&#39;, &#39;R&#39;</span></div>
<div class="line"><span class="lineno"> 1796</span><span class="preprocessor">@pytest.mark.parametrize(&#39;jobu&#39;, range(4)</span>)  <span class="comment"># &#39;U&#39;, &#39;F&#39;, &#39;W&#39;, &#39;N&#39;</span></div>
<div class="line"><span class="lineno"> 1797</span><span class="preprocessor">@pytest.mark.parametrize(&#39;jobv&#39;, range(4)</span>)  <span class="comment"># &#39;V&#39;, &#39;J&#39;, &#39;W&#39;, &#39;N&#39;</span></div>
<div class="line"><span class="lineno"> 1798</span><span class="preprocessor">@pytest.mark.parametrize(&#39;jobr&#39;, [0, 1])</span></div>
<div class="line"><span class="lineno"> 1799</span><span class="preprocessor">@pytest.mark.parametrize(&#39;jobp&#39;, [0, 1])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d25adecc2ebb220fe69b310fe84b807" name="a4d25adecc2ebb220fe69b310fe84b807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d25adecc2ebb220fe69b310fe84b807">&#9670;&#160;</a></span>test_gges_tgexc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gges_tgexc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2977</span><span class="keyword">def </span>test_gges_tgexc(dtype):</div>
<div class="line"><span class="lineno"> 2978</span>    <span class="keywordflow">if</span> dtype == np.float32 <span class="keywordflow">and</span> sys.platform == <span class="stringliteral">&#39;darwin&#39;</span>:</div>
<div class="line"><span class="lineno"> 2979</span>        pytest.xfail(<span class="stringliteral">&quot;gges[float32] broken for OpenBLAS on macOS, see gh-16949&quot;</span>)</div>
<div class="line"><span class="lineno"> 2980</span> </div>
<div class="line"><span class="lineno"> 2981</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 2982</span>    atol = np.finfo(dtype).eps*100</div>
<div class="line"><span class="lineno"> 2983</span> </div>
<div class="line"><span class="lineno"> 2984</span>    n = 10</div>
<div class="line"><span class="lineno"> 2985</span>    a = generate_random_dtype_array([n, n], dtype=dtype)</div>
<div class="line"><span class="lineno"> 2986</span>    b = generate_random_dtype_array([n, n], dtype=dtype)</div>
<div class="line"><span class="lineno"> 2987</span> </div>
<div class="line"><span class="lineno"> 2988</span>    gges, tgexc = get_lapack_funcs((<span class="stringliteral">&#39;gges&#39;</span>, <span class="stringliteral">&#39;tgexc&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2989</span> </div>
<div class="line"><span class="lineno"> 2990</span>    result = gges(<span class="keyword">lambda</span> x: <span class="keywordtype">None</span>, a, b, overwrite_a=<span class="keyword">False</span>, overwrite_b=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 2991</span>    assert_equal(result[-1], 0)</div>
<div class="line"><span class="lineno"> 2992</span> </div>
<div class="line"><span class="lineno"> 2993</span>    s = result[0]</div>
<div class="line"><span class="lineno"> 2994</span>    t = result[1]</div>
<div class="line"><span class="lineno"> 2995</span>    q = result[-4]</div>
<div class="line"><span class="lineno"> 2996</span>    z = result[-3]</div>
<div class="line"><span class="lineno"> 2997</span> </div>
<div class="line"><span class="lineno"> 2998</span>    d1 = s[0, 0] / t[0, 0]</div>
<div class="line"><span class="lineno"> 2999</span>    d2 = s[6, 6] / t[6, 6]</div>
<div class="line"><span class="lineno"> 3000</span> </div>
<div class="line"><span class="lineno"> 3001</span>    <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> COMPLEX_DTYPES:</div>
<div class="line"><span class="lineno"> 3002</span>        assert_allclose(s, np.triu(s), rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3003</span>        assert_allclose(t, np.triu(t), rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3004</span> </div>
<div class="line"><span class="lineno"> 3005</span>    assert_allclose(q @ s @ z.conj().T, a, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3006</span>    assert_allclose(q @ t @ z.conj().T, b, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3007</span> </div>
<div class="line"><span class="lineno"> 3008</span>    result = tgexc(s, t, q, z, 6, 0)</div>
<div class="line"><span class="lineno"> 3009</span>    assert_equal(result[-1], 0)</div>
<div class="line"><span class="lineno"> 3010</span> </div>
<div class="line"><span class="lineno"> 3011</span>    s = result[0]</div>
<div class="line"><span class="lineno"> 3012</span>    t = result[1]</div>
<div class="line"><span class="lineno"> 3013</span>    q = result[2]</div>
<div class="line"><span class="lineno"> 3014</span>    z = result[3]</div>
<div class="line"><span class="lineno"> 3015</span> </div>
<div class="line"><span class="lineno"> 3016</span>    <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> COMPLEX_DTYPES:</div>
<div class="line"><span class="lineno"> 3017</span>        assert_allclose(s, np.triu(s), rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3018</span>        assert_allclose(t, np.triu(t), rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3019</span> </div>
<div class="line"><span class="lineno"> 3020</span>    assert_allclose(q @ s @ z.conj().T, a, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3021</span>    assert_allclose(q @ t @ z.conj().T, b, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3022</span> </div>
<div class="line"><span class="lineno"> 3023</span>    assert_allclose(s[0, 0] / t[0, 0], d2, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 3024</span>    assert_allclose(s[1, 1] / t[1, 1], d1, rtol=0, atol=atol)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af839d440bb60c1ec968d03b92e481985" name="af839d440bb60c1ec968d03b92e481985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af839d440bb60c1ec968d03b92e481985">&#9670;&#160;</a></span>test_gglse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gglse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  922</span><span class="keyword">def </span>test_gglse():</div>
<div class="line"><span class="lineno">  923</span>    <span class="comment"># Example data taken from NAG manual</span></div>
<div class="line"><span class="lineno">  924</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno">  925</span>        <span class="comment"># DTYPES = &lt;s,d,c,z&gt; gglse</span></div>
<div class="line"><span class="lineno">  926</span>        func, func_lwork = get_lapack_funcs((<span class="stringliteral">&#39;gglse&#39;</span>, <span class="stringliteral">&#39;gglse_lwork&#39;</span>),</div>
<div class="line"><span class="lineno">  927</span>                                            dtype=dtype)</div>
<div class="line"><span class="lineno">  928</span>        lwork = _compute_lwork(func_lwork, m=6, n=4, p=2)</div>
<div class="line"><span class="lineno">  929</span>        <span class="comment"># For &lt;s,d&gt;gglse</span></div>
<div class="line"><span class="lineno">  930</span>        <span class="keywordflow">if</span> ind &lt; 2:</div>
<div class="line"><span class="lineno">  931</span>            a = np.array([[-0.57, -1.28, -0.39, 0.25],</div>
<div class="line"><span class="lineno">  932</span>                          [-1.93, 1.08, -0.31, -2.14],</div>
<div class="line"><span class="lineno">  933</span>                          [2.30, 0.24, 0.40, -0.35],</div>
<div class="line"><span class="lineno">  934</span>                          [-1.93, 0.64, -0.66, 0.08],</div>
<div class="line"><span class="lineno">  935</span>                          [0.15, 0.30, 0.15, -2.13],</div>
<div class="line"><span class="lineno">  936</span>                          [-0.02, 1.03, -1.43, 0.50]], dtype=dtype)</div>
<div class="line"><span class="lineno">  937</span>            c = np.array([-1.50, -2.14, 1.23, -0.54, -1.68, 0.82], dtype=dtype)</div>
<div class="line"><span class="lineno">  938</span>            d = np.array([0., 0.], dtype=dtype)</div>
<div class="line"><span class="lineno">  939</span>        <span class="comment"># For &lt;s,d&gt;gglse</span></div>
<div class="line"><span class="lineno">  940</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  941</span>            a = np.array([[0.96-0.81j, -0.03+0.96j, -0.91+2.06j, -0.05+0.41j],</div>
<div class="line"><span class="lineno">  942</span>                          [-0.98+1.98j, -1.20+0.19j, -0.66+0.42j, -0.81+0.56j],</div>
<div class="line"><span class="lineno">  943</span>                          [0.62-0.46j, 1.01+0.02j, 0.63-0.17j, -1.11+0.60j],</div>
<div class="line"><span class="lineno">  944</span>                          [0.37+0.38j, 0.19-0.54j, -0.98-0.36j, 0.22-0.20j],</div>
<div class="line"><span class="lineno">  945</span>                          [0.83+0.51j, 0.20+0.01j, -0.17-0.46j, 1.47+1.59j],</div>
<div class="line"><span class="lineno">  946</span>                          [1.08-0.28j, 0.20-0.12j, -0.07+1.23j, 0.26+0.26j]])</div>
<div class="line"><span class="lineno">  947</span>            c = np.array([[-2.54+0.09j],</div>
<div class="line"><span class="lineno">  948</span>                          [1.65-2.26j],</div>
<div class="line"><span class="lineno">  949</span>                          [-2.11-3.96j],</div>
<div class="line"><span class="lineno">  950</span>                          [1.82+3.30j],</div>
<div class="line"><span class="lineno">  951</span>                          [-6.41+3.77j],</div>
<div class="line"><span class="lineno">  952</span>                          [2.07+0.66j]])</div>
<div class="line"><span class="lineno">  953</span>            d = np.zeros(2, dtype=dtype)</div>
<div class="line"><span class="lineno">  954</span> </div>
<div class="line"><span class="lineno">  955</span>        b = np.array([[1., 0., -1., 0.], [0., 1., 0., -1.]], dtype=dtype)</div>
<div class="line"><span class="lineno">  956</span> </div>
<div class="line"><span class="lineno">  957</span>        _, _, _, result, _ = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(a, b, c, d, lwork=lwork)</div>
<div class="line"><span class="lineno">  958</span>        <span class="keywordflow">if</span> ind &lt; 2:</div>
<div class="line"><span class="lineno">  959</span>            expected = np.array([0.48904455,</div>
<div class="line"><span class="lineno">  960</span>                                 0.99754786,</div>
<div class="line"><span class="lineno">  961</span>                                 0.48904455,</div>
<div class="line"><span class="lineno">  962</span>                                 0.99754786])</div>
<div class="line"><span class="lineno">  963</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  964</span>            expected = np.array([1.08742917-1.96205783j,</div>
<div class="line"><span class="lineno">  965</span>                                 -0.74093902+3.72973919j,</div>
<div class="line"><span class="lineno">  966</span>                                 1.08742917-1.96205759j,</div>
<div class="line"><span class="lineno">  967</span>                                 -0.74093896+3.72973895j])</div>
<div class="line"><span class="lineno">  968</span>        assert_array_almost_equal(result, expected, decimal=4)</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5f68a2ec6e96be7452ede3a1b37b6cb" name="ac5f68a2ec6e96be7452ede3a1b37b6cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5f68a2ec6e96be7452ede3a1b37b6cb">&#9670;&#160;</a></span>test_gtsvx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gtsvx </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>trans_bool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fact</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">These tests uses ?gtsvx to solve a random Ax=b system for each dtype.
It tests that the outputs define an LU matrix, that inputs are unmodified,
transposal options, incompatible shapes, singular matrices, and
singular factorizations. It parametrizes DTYPES and the 'fact' value along
with the fact related inputs.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2577</span><span class="keyword">def </span>test_gtsvx(dtype, trans_bool, fact):</div>
<div class="line"><span class="lineno"> 2578</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2579</span><span class="stringliteral">    These tests uses ?gtsvx to solve a random Ax=b system for each dtype.</span></div>
<div class="line"><span class="lineno"> 2580</span><span class="stringliteral">    It tests that the outputs define an LU matrix, that inputs are unmodified,</span></div>
<div class="line"><span class="lineno"> 2581</span><span class="stringliteral">    transposal options, incompatible shapes, singular matrices, and</span></div>
<div class="line"><span class="lineno"> 2582</span><span class="stringliteral">    singular factorizations. It parametrizes DTYPES and the &#39;fact&#39; value along</span></div>
<div class="line"><span class="lineno"> 2583</span><span class="stringliteral">    with the fact related inputs.</span></div>
<div class="line"><span class="lineno"> 2584</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2585</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2586</span>    <span class="comment"># set test tolerance appropriate for dtype</span></div>
<div class="line"><span class="lineno"> 2587</span>    atol = 100 * np.finfo(dtype).eps</div>
<div class="line"><span class="lineno"> 2588</span>    <span class="comment"># obtain routine</span></div>
<div class="line"><span class="lineno"> 2589</span>    gtsvx, gttrf = get_lapack_funcs((<span class="stringliteral">&#39;gtsvx&#39;</span>, <span class="stringliteral">&#39;gttrf&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2590</span>    <span class="comment"># Generate random tridiagonal matrix A</span></div>
<div class="line"><span class="lineno"> 2591</span>    n = 10</div>
<div class="line"><span class="lineno"> 2592</span>    dl = generate_random_dtype_array((n-1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2593</span>    d = generate_random_dtype_array((n,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2594</span>    du = generate_random_dtype_array((n-1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2595</span>    A = np.diag(dl, -1) + np.diag(d) + np.diag(du, 1)</div>
<div class="line"><span class="lineno"> 2596</span>    <span class="comment"># generate random solution x</span></div>
<div class="line"><span class="lineno"> 2597</span>    x = generate_random_dtype_array((n, 2), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2598</span>    <span class="comment"># create b from x for equation Ax=b</span></div>
<div class="line"><span class="lineno"> 2599</span>    trans = (<span class="stringliteral">&quot;T&quot;</span> <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> REAL_DTYPES <span class="keywordflow">else</span> <span class="stringliteral">&quot;C&quot;</span>) <span class="keywordflow">if</span> trans_bool <span class="keywordflow">else</span> <span class="stringliteral">&quot;N&quot;</span></div>
<div class="line"><span class="lineno"> 2600</span>    b = (A.conj().T <span class="keywordflow">if</span> trans_bool <span class="keywordflow">else</span> A) @ x</div>
<div class="line"><span class="lineno"> 2601</span> </div>
<div class="line"><span class="lineno"> 2602</span>    <span class="comment"># store a copy of the inputs to check they haven&#39;t been modified later</span></div>
<div class="line"><span class="lineno"> 2603</span>    inputs_cpy = [dl.copy(), d.copy(), du.copy(), b.copy()]</div>
<div class="line"><span class="lineno"> 2604</span> </div>
<div class="line"><span class="lineno"> 2605</span>    <span class="comment"># set these to None if fact = &#39;N&#39;, or the output of gttrf is fact = &#39;F&#39;</span></div>
<div class="line"><span class="lineno"> 2606</span>    dlf_, df_, duf_, du2f_, ipiv_, info_ = \</div>
<div class="line"><span class="lineno"> 2607</span>        gttrf(dl, d, du) <span class="keywordflow">if</span> fact == <span class="stringliteral">&#39;F&#39;</span> <span class="keywordflow">else</span> [<span class="keywordtype">None</span>]*6</div>
<div class="line"><span class="lineno"> 2608</span> </div>
<div class="line"><span class="lineno"> 2609</span>    gtsvx_out = gtsvx(dl, d, du, b, fact=fact, trans=trans, dlf=dlf_, df=df_,</div>
<div class="line"><span class="lineno"> 2610</span>                      duf=duf_, du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2611</span>    dlf, df, duf, du2f, ipiv, x_soln, rcond, ferr, berr, info = gtsvx_out</div>
<div class="line"><span class="lineno"> 2612</span>    assert_(info == 0, <span class="stringliteral">&quot;?gtsvx info = {}, should be zero&quot;</span>.format(info))</div>
<div class="line"><span class="lineno"> 2613</span> </div>
<div class="line"><span class="lineno"> 2614</span>    <span class="comment"># assure that inputs are unmodified</span></div>
<div class="line"><span class="lineno"> 2615</span>    assert_array_equal(dl, inputs_cpy[0])</div>
<div class="line"><span class="lineno"> 2616</span>    assert_array_equal(d, inputs_cpy[1])</div>
<div class="line"><span class="lineno"> 2617</span>    assert_array_equal(du, inputs_cpy[2])</div>
<div class="line"><span class="lineno"> 2618</span>    assert_array_equal(b, inputs_cpy[3])</div>
<div class="line"><span class="lineno"> 2619</span> </div>
<div class="line"><span class="lineno"> 2620</span>    <span class="comment"># test that x_soln matches the expected x</span></div>
<div class="line"><span class="lineno"> 2621</span>    assert_allclose(x, x_soln, atol=atol)</div>
<div class="line"><span class="lineno"> 2622</span> </div>
<div class="line"><span class="lineno"> 2623</span>    <span class="comment"># assert that the outputs are of correct type or shape</span></div>
<div class="line"><span class="lineno"> 2624</span>    <span class="comment"># rcond should be a scalar</span></div>
<div class="line"><span class="lineno"> 2625</span>    assert_(hasattr(rcond, <span class="stringliteral">&quot;__len__&quot;</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 2626</span>            <span class="stringliteral">&quot;rcond should be scalar but is {}&quot;</span>.format(rcond))</div>
<div class="line"><span class="lineno"> 2627</span>    <span class="comment"># ferr should be length of # of cols in x</span></div>
<div class="line"><span class="lineno"> 2628</span>    assert_(ferr.shape[0] == b.shape[1], <span class="stringliteral">&quot;ferr.shape is {} but shoud be {},&quot;</span></div>
<div class="line"><span class="lineno"> 2629</span>            .format(ferr.shape[0], b.shape[1]))</div>
<div class="line"><span class="lineno"> 2630</span>    <span class="comment"># berr should be length of # of cols in x</span></div>
<div class="line"><span class="lineno"> 2631</span>    assert_(berr.shape[0] == b.shape[1], <span class="stringliteral">&quot;berr.shape is {} but shoud be {},&quot;</span></div>
<div class="line"><span class="lineno"> 2632</span>            .format(berr.shape[0], b.shape[1]))</div>
<div class="line"><span class="lineno"> 2633</span> </div>
<div class="line"><span class="lineno"> 2634</span> </div>
<div class="line"><span class="lineno"> 2635</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, DTYPES)</span></div>
<div class="line"><span class="lineno"> 2636</span><span class="preprocessor">@pytest.mark.parametrize(&quot;trans_bool&quot;, [0, 1])</span></div>
<div class="line"><span class="lineno"> 2637</span><span class="preprocessor">@pytest.mark.parametrize(&quot;fact&quot;, [&quot;F&quot;, &quot;N&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04cb291252bad1d5437fbf0346e8ff6e" name="a04cb291252bad1d5437fbf0346e8ff6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04cb291252bad1d5437fbf0346e8ff6e">&#9670;&#160;</a></span>test_gtsvx_error_incompatible_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gtsvx_error_incompatible_size </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>trans_bool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fact</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2689</span><span class="keyword">def </span>test_gtsvx_error_incompatible_size(dtype, trans_bool, fact):</div>
<div class="line"><span class="lineno"> 2690</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2691</span>    <span class="comment"># obtain routine</span></div>
<div class="line"><span class="lineno"> 2692</span>    gtsvx, gttrf = get_lapack_funcs((<span class="stringliteral">&#39;gtsvx&#39;</span>, <span class="stringliteral">&#39;gttrf&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2693</span>    <span class="comment"># Generate random tridiagonal matrix A</span></div>
<div class="line"><span class="lineno"> 2694</span>    n = 10</div>
<div class="line"><span class="lineno"> 2695</span>    dl = generate_random_dtype_array((n-1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2696</span>    d = generate_random_dtype_array((n,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2697</span>    du = generate_random_dtype_array((n-1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2698</span>    A = np.diag(dl, -1) + np.diag(d) + np.diag(du, 1)</div>
<div class="line"><span class="lineno"> 2699</span>    <span class="comment"># generate random solution x</span></div>
<div class="line"><span class="lineno"> 2700</span>    x = generate_random_dtype_array((n, 2), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2701</span>    <span class="comment"># create b from x for equation Ax=b</span></div>
<div class="line"><span class="lineno"> 2702</span>    trans = <span class="stringliteral">&quot;T&quot;</span> <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> REAL_DTYPES <span class="keywordflow">else</span> <span class="stringliteral">&quot;C&quot;</span></div>
<div class="line"><span class="lineno"> 2703</span>    b = (A.conj().T <span class="keywordflow">if</span> trans_bool <span class="keywordflow">else</span> A) @ x</div>
<div class="line"><span class="lineno"> 2704</span> </div>
<div class="line"><span class="lineno"> 2705</span>    <span class="comment"># set these to None if fact = &#39;N&#39;, or the output of gttrf is fact = &#39;F&#39;</span></div>
<div class="line"><span class="lineno"> 2706</span>    dlf_, df_, duf_, du2f_, ipiv_, info_ = \</div>
<div class="line"><span class="lineno"> 2707</span>        gttrf(dl, d, du) <span class="keywordflow">if</span> fact == <span class="stringliteral">&#39;F&#39;</span> <span class="keywordflow">else</span> [<span class="keywordtype">None</span>]*6</div>
<div class="line"><span class="lineno"> 2708</span> </div>
<div class="line"><span class="lineno"> 2709</span>    <span class="keywordflow">if</span> fact == <span class="stringliteral">&quot;N&quot;</span>:</div>
<div class="line"><span class="lineno"> 2710</span>        assert_raises(ValueError, gtsvx, dl[:-1], d, du, b,</div>
<div class="line"><span class="lineno"> 2711</span>                      fact=fact, trans=trans, dlf=dlf_, df=df_,</div>
<div class="line"><span class="lineno"> 2712</span>                      duf=duf_, du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2713</span>        assert_raises(ValueError, gtsvx, dl, d[:-1], du, b,</div>
<div class="line"><span class="lineno"> 2714</span>                      fact=fact, trans=trans, dlf=dlf_, df=df_,</div>
<div class="line"><span class="lineno"> 2715</span>                      duf=duf_, du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2716</span>        assert_raises(ValueError, gtsvx, dl, d, du[:-1], b,</div>
<div class="line"><span class="lineno"> 2717</span>                      fact=fact, trans=trans, dlf=dlf_, df=df_,</div>
<div class="line"><span class="lineno"> 2718</span>                      duf=duf_, du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2719</span>        assert_raises(Exception, gtsvx, dl, d, du, b[:-1],</div>
<div class="line"><span class="lineno"> 2720</span>                      fact=fact, trans=trans, dlf=dlf_, df=df_,</div>
<div class="line"><span class="lineno"> 2721</span>                      duf=duf_, du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2722</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2723</span>        assert_raises(ValueError, gtsvx, dl, d, du, b,</div>
<div class="line"><span class="lineno"> 2724</span>                      fact=fact, trans=trans, dlf=dlf_[:-1], df=df_,</div>
<div class="line"><span class="lineno"> 2725</span>                      duf=duf_, du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2726</span>        assert_raises(ValueError, gtsvx, dl, d, du, b,</div>
<div class="line"><span class="lineno"> 2727</span>                      fact=fact, trans=trans, dlf=dlf_, df=df_[:-1],</div>
<div class="line"><span class="lineno"> 2728</span>                      duf=duf_, du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2729</span>        assert_raises(ValueError, gtsvx, dl, d, du, b,</div>
<div class="line"><span class="lineno"> 2730</span>                      fact=fact, trans=trans, dlf=dlf_, df=df_,</div>
<div class="line"><span class="lineno"> 2731</span>                      duf=duf_[:-1], du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2732</span>        assert_raises(ValueError, gtsvx, dl, d, du, b,</div>
<div class="line"><span class="lineno"> 2733</span>                      fact=fact, trans=trans, dlf=dlf_, df=df_,</div>
<div class="line"><span class="lineno"> 2734</span>                      duf=duf_, du2=du2f_[:-1], ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2735</span> </div>
<div class="line"><span class="lineno"> 2736</span> </div>
<div class="line"><span class="lineno"> 2737</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;du,d,dl,b,x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2738</span>                         [(np.array([2.1, -1.0, 1.9, 8.0]),</div>
<div class="line"><span class="lineno"> 2739</span>                           np.array([3.0, 2.3, -5.0, -0.9, 7.1]),</div>
<div class="line"><span class="lineno"> 2740</span>                           np.array([3.4, 3.6, 7.0, -6.0]),</div>
<div class="line"><span class="lineno"> 2741</span>                           np.array([[2.7, 6.6], [-.5, 10.8], [2.6, -3.2],</div>
<div class="line"><span class="lineno"> 2742</span>                                     [.6, -11.2], [2.7, 19.1]]),</div>
<div class="line"><span class="lineno"> 2743</span>                           np.array([[-4, 5], [7, -4], [3, -3], [-4, -2],</div>
<div class="line"><span class="lineno"> 2744</span>                                     [-3, 1]])),</div>
<div class="line"><span class="lineno"> 2745</span>                          (np.array([2 - 1j, 2 + 1j, -1 + 1j, 1 - 1j]),</div>
<div class="line"><span class="lineno"> 2746</span>                           np.array([-1.3 + 1.3j, -1.3 + 1.3j, -1.3 + 3.3j,</div>
<div class="line"><span class="lineno"> 2747</span>                                     -.3 + 4.3j, -3.3 + 1.3j]),</div>
<div class="line"><span class="lineno"> 2748</span>                           np.array([1 - 2j, 1 + 1j, 2 - 3j, 1 + 1j]),</div>
<div class="line"><span class="lineno"> 2749</span>                           np.array([[2.4 - 5j, 2.7 + 6.9j],</div>
<div class="line"><span class="lineno"> 2750</span>                                     [3.4 + 18.2j, -6.9 - 5.3j],</div>
<div class="line"><span class="lineno"> 2751</span>                                     [-14.7 + 9.7j, -6 - .6j],</div>
<div class="line"><span class="lineno"> 2752</span>                                     [31.9 - 7.7j, -3.9 + 9.3j],</div>
<div class="line"><span class="lineno"> 2753</span>                                     [-1 + 1.6j, -3 + 12.2j]]),</div>
<div class="line"><span class="lineno"> 2754</span>                           np.array([[1 + 1j, 2 - 1j], [3 - 1j, 1 + 2j],</div>
<div class="line"><span class="lineno"> 2755</span>                                     [4 + 5j, -1 + 1j], [-1 - 2j, 2 + 1j],</div>
<div class="line"><span class="lineno"> 2756</span>                                     [1 - 1j, 2 - 2j]]))])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d7d8c2fadf2929ce3c9115aaa313fcc" name="a5d7d8c2fadf2929ce3c9115aaa313fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d7d8c2fadf2929ce3c9115aaa313fcc">&#9670;&#160;</a></span>test_gtsvx_error_singular()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gtsvx_error_singular </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>trans_bool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fact</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2638</span><span class="keyword">def </span>test_gtsvx_error_singular(dtype, trans_bool, fact):</div>
<div class="line"><span class="lineno"> 2639</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2640</span>    <span class="comment"># obtain routine</span></div>
<div class="line"><span class="lineno"> 2641</span>    gtsvx, gttrf = get_lapack_funcs((<span class="stringliteral">&#39;gtsvx&#39;</span>, <span class="stringliteral">&#39;gttrf&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2642</span>    <span class="comment"># Generate random tridiagonal matrix A</span></div>
<div class="line"><span class="lineno"> 2643</span>    n = 10</div>
<div class="line"><span class="lineno"> 2644</span>    dl = generate_random_dtype_array((n-1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2645</span>    d = generate_random_dtype_array((n,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2646</span>    du = generate_random_dtype_array((n-1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2647</span>    A = np.diag(dl, -1) + np.diag(d) + np.diag(du, 1)</div>
<div class="line"><span class="lineno"> 2648</span>    <span class="comment"># generate random solution x</span></div>
<div class="line"><span class="lineno"> 2649</span>    x = generate_random_dtype_array((n, 2), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2650</span>    <span class="comment"># create b from x for equation Ax=b</span></div>
<div class="line"><span class="lineno"> 2651</span>    trans = <span class="stringliteral">&quot;T&quot;</span> <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> REAL_DTYPES <span class="keywordflow">else</span> <span class="stringliteral">&quot;C&quot;</span></div>
<div class="line"><span class="lineno"> 2652</span>    b = (A.conj().T <span class="keywordflow">if</span> trans_bool <span class="keywordflow">else</span> A) @ x</div>
<div class="line"><span class="lineno"> 2653</span> </div>
<div class="line"><span class="lineno"> 2654</span>    <span class="comment"># set these to None if fact = &#39;N&#39;, or the output of gttrf is fact = &#39;F&#39;</span></div>
<div class="line"><span class="lineno"> 2655</span>    dlf_, df_, duf_, du2f_, ipiv_, info_ = \</div>
<div class="line"><span class="lineno"> 2656</span>        gttrf(dl, d, du) <span class="keywordflow">if</span> fact == <span class="stringliteral">&#39;F&#39;</span> <span class="keywordflow">else</span> [<span class="keywordtype">None</span>]*6</div>
<div class="line"><span class="lineno"> 2657</span> </div>
<div class="line"><span class="lineno"> 2658</span>    gtsvx_out = gtsvx(dl, d, du, b, fact=fact, trans=trans, dlf=dlf_, df=df_,</div>
<div class="line"><span class="lineno"> 2659</span>                      duf=duf_, du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2660</span>    dlf, df, duf, du2f, ipiv, x_soln, rcond, ferr, berr, info = gtsvx_out</div>
<div class="line"><span class="lineno"> 2661</span>    <span class="comment"># test with singular matrix</span></div>
<div class="line"><span class="lineno"> 2662</span>    <span class="comment"># no need to test inputs with fact &quot;F&quot; since ?gttrf already does.</span></div>
<div class="line"><span class="lineno"> 2663</span>    <span class="keywordflow">if</span> fact == <span class="stringliteral">&quot;N&quot;</span>:</div>
<div class="line"><span class="lineno"> 2664</span>        <span class="comment"># Construct a singular example manually</span></div>
<div class="line"><span class="lineno"> 2665</span>        d[-1] = 0</div>
<div class="line"><span class="lineno"> 2666</span>        dl[-1] = 0</div>
<div class="line"><span class="lineno"> 2667</span>        <span class="comment"># solve using routine</span></div>
<div class="line"><span class="lineno"> 2668</span>        gtsvx_out = gtsvx(dl, d, du, b)</div>
<div class="line"><span class="lineno"> 2669</span>        dlf, df, duf, du2f, ipiv, x_soln, rcond, ferr, berr, info = gtsvx_out</div>
<div class="line"><span class="lineno"> 2670</span>        <span class="comment"># test for the singular matrix.</span></div>
<div class="line"><span class="lineno"> 2671</span>        <span class="keyword">assert</span> info &gt; 0, <span class="stringliteral">&quot;info should be &gt; 0 for singular matrix&quot;</span></div>
<div class="line"><span class="lineno"> 2672</span> </div>
<div class="line"><span class="lineno"> 2673</span>    <span class="keywordflow">elif</span> fact == <span class="stringliteral">&#39;F&#39;</span>:</div>
<div class="line"><span class="lineno"> 2674</span>        <span class="comment"># assuming that a singular factorization is input</span></div>
<div class="line"><span class="lineno"> 2675</span>        df_[-1] = 0</div>
<div class="line"><span class="lineno"> 2676</span>        duf_[-1] = 0</div>
<div class="line"><span class="lineno"> 2677</span>        du2f_[-1] = 0</div>
<div class="line"><span class="lineno"> 2678</span> </div>
<div class="line"><span class="lineno"> 2679</span>        gtsvx_out = gtsvx(dl, d, du, b, fact=fact, dlf=dlf_, df=df_, duf=duf_,</div>
<div class="line"><span class="lineno"> 2680</span>                          du2=du2f_, ipiv=ipiv_)</div>
<div class="line"><span class="lineno"> 2681</span>        dlf, df, duf, du2f, ipiv, x_soln, rcond, ferr, berr, info = gtsvx_out</div>
<div class="line"><span class="lineno"> 2682</span>        <span class="comment"># info should not be zero and should provide index of illegal value</span></div>
<div class="line"><span class="lineno"> 2683</span>        <span class="keyword">assert</span> info &gt; 0, <span class="stringliteral">&quot;info should be &gt; 0 for singular matrix&quot;</span></div>
<div class="line"><span class="lineno"> 2684</span> </div>
<div class="line"><span class="lineno"> 2685</span> </div>
<div class="line"><span class="lineno"> 2686</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, DTYPES*2)</span></div>
<div class="line"><span class="lineno"> 2687</span><span class="preprocessor">@pytest.mark.parametrize(&quot;trans_bool&quot;, [False, True])</span></div>
<div class="line"><span class="lineno"> 2688</span><span class="preprocessor">@pytest.mark.parametrize(&quot;fact&quot;, [&quot;F&quot;, &quot;N&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1b55629246742b3da3db89bfa377178" name="ad1b55629246742b3da3db89bfa377178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1b55629246742b3da3db89bfa377178">&#9670;&#160;</a></span>test_gtsvx_NAG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gtsvx_NAG </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>du</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2757</span><span class="keyword">def </span>test_gtsvx_NAG(du, d, dl, b, x):</div>
<div class="line"><span class="lineno"> 2758</span>    <span class="comment"># Test to ensure wrapper is consistent with NAG Manual Mark 26</span></div>
<div class="line"><span class="lineno"> 2759</span>    <span class="comment"># example problems: real (f07cbf) and complex (f07cpf)</span></div>
<div class="line"><span class="lineno"> 2760</span>    gtsvx = get_lapack_funcs(<span class="stringliteral">&#39;gtsvx&#39;</span>, dtype=d.dtype)</div>
<div class="line"><span class="lineno"> 2761</span> </div>
<div class="line"><span class="lineno"> 2762</span>    gtsvx_out = gtsvx(dl, d, du, b)</div>
<div class="line"><span class="lineno"> 2763</span>    dlf, df, duf, du2f, ipiv, x_soln, rcond, ferr, berr, info = gtsvx_out</div>
<div class="line"><span class="lineno"> 2764</span> </div>
<div class="line"><span class="lineno"> 2765</span>    assert_array_almost_equal(x, x_soln)</div>
<div class="line"><span class="lineno"> 2766</span> </div>
<div class="line"><span class="lineno"> 2767</span> </div>
<div class="line"><span class="lineno"> 2768</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;dtype,realtype&quot;</span>, zip(DTYPES, REAL_DTYPES</div>
<div class="line"><span class="lineno"> 2769</span>                                               + REAL_DTYPES))</div>
<div class="line"><span class="lineno"> 2770</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;fact,df_de_lambda&quot;</span>,</div>
<div class="line"><span class="lineno"> 2771</span>                         [(<span class="stringliteral">&quot;F&quot;</span>,</div>
<div class="line"><span class="lineno"> 2772</span>                           <span class="keyword">lambda</span> d, e:get_lapack_funcs(<span class="stringliteral">&#39;pttrf&#39;</span>,</div>
<div class="line"><span class="lineno"> 2773</span>                                                        dtype=e.dtype)(d, e)),</div>
<div class="line"><span class="lineno"> 2774</span>                          (<span class="stringliteral">&quot;N&quot;</span>, <span class="keyword">lambda</span> d, e: (<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>))])</div>
</div><!-- fragment -->
</div>
</div>
<a id="af82c1dd606d511fa671f8245082407ca" name="af82c1dd606d511fa671f8245082407ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af82c1dd606d511fa671f8245082407ca">&#9670;&#160;</a></span>test_gttrf_gttrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gttrf_gttrs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1987</span><span class="keyword">def </span>test_gttrf_gttrs(dtype):</div>
<div class="line"><span class="lineno"> 1988</span>    <span class="comment"># The test uses ?gttrf and ?gttrs to solve a random system for each dtype,</span></div>
<div class="line"><span class="lineno"> 1989</span>    <span class="comment"># tests that the output of ?gttrf define LU matricies, that input</span></div>
<div class="line"><span class="lineno"> 1990</span>    <span class="comment"># parameters are unmodified, transposal options function correctly, that</span></div>
<div class="line"><span class="lineno"> 1991</span>    <span class="comment"># incompatible matrix shapes raise an error, and singular matrices return</span></div>
<div class="line"><span class="lineno"> 1992</span>    <span class="comment"># non zero info.</span></div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span>    seed(42)</div>
<div class="line"><span class="lineno"> 1995</span>    n = 10</div>
<div class="line"><span class="lineno"> 1996</span>    atol = 100 * np.finfo(dtype).eps</div>
<div class="line"><span class="lineno"> 1997</span> </div>
<div class="line"><span class="lineno"> 1998</span>    <span class="comment"># create the matrix in accordance with the data type</span></div>
<div class="line"><span class="lineno"> 1999</span>    du = generate_random_dtype_array((n-1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2000</span>    d = generate_random_dtype_array((n,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2001</span>    dl = generate_random_dtype_array((n-1,), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2002</span> </div>
<div class="line"><span class="lineno"> 2003</span>    diag_cpy = [dl.copy(), d.copy(), du.copy()]</div>
<div class="line"><span class="lineno"> 2004</span> </div>
<div class="line"><span class="lineno"> 2005</span>    A = np.diag(d) + np.diag(dl, -1) + np.diag(du, 1)</div>
<div class="line"><span class="lineno"> 2006</span>    x = np.random.rand(n)</div>
<div class="line"><span class="lineno"> 2007</span>    b = A @ x</div>
<div class="line"><span class="lineno"> 2008</span> </div>
<div class="line"><span class="lineno"> 2009</span>    gttrf, gttrs = get_lapack_funcs((<span class="stringliteral">&#39;gttrf&#39;</span>, <span class="stringliteral">&#39;gttrs&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2010</span> </div>
<div class="line"><span class="lineno"> 2011</span>    _dl, _d, _du, du2, ipiv, info = gttrf(dl, d, du)</div>
<div class="line"><span class="lineno"> 2012</span>    <span class="comment"># test to assure that the inputs of ?gttrf are unmodified</span></div>
<div class="line"><span class="lineno"> 2013</span>    assert_array_equal(dl, diag_cpy[0])</div>
<div class="line"><span class="lineno"> 2014</span>    assert_array_equal(d, diag_cpy[1])</div>
<div class="line"><span class="lineno"> 2015</span>    assert_array_equal(du, diag_cpy[2])</div>
<div class="line"><span class="lineno"> 2016</span> </div>
<div class="line"><span class="lineno"> 2017</span>    <span class="comment"># generate L and U factors from ?gttrf return values</span></div>
<div class="line"><span class="lineno"> 2018</span>    <span class="comment"># L/U are lower/upper triangular by construction (initially and at end)</span></div>
<div class="line"><span class="lineno"> 2019</span>    U = np.diag(_d, 0) + np.diag(_du, 1) + np.diag(du2, 2)</div>
<div class="line"><span class="lineno"> 2020</span>    L = np.eye(n, dtype=dtype)</div>
<div class="line"><span class="lineno"> 2021</span> </div>
<div class="line"><span class="lineno"> 2022</span>    <span class="keywordflow">for</span> i, m <span class="keywordflow">in</span> enumerate(_dl):</div>
<div class="line"><span class="lineno"> 2023</span>        <span class="comment"># L is given in a factored form.</span></div>
<div class="line"><span class="lineno"> 2024</span>        <span class="comment"># See</span></div>
<div class="line"><span class="lineno"> 2025</span>        <span class="comment"># www.hpcavf.uclan.ac.uk/softwaredoc/sgi_scsl_html/sgi_html/ch03.html</span></div>
<div class="line"><span class="lineno"> 2026</span>        piv = ipiv[i] - 1</div>
<div class="line"><span class="lineno"> 2027</span>        <span class="comment"># right multiply by permutation matrix</span></div>
<div class="line"><span class="lineno"> 2028</span>        L[:, [i, piv]] = L[:, [piv, i]]</div>
<div class="line"><span class="lineno"> 2029</span>        <span class="comment"># right multiply by Li, rank-one modification of identity</span></div>
<div class="line"><span class="lineno"> 2030</span>        L[:, i] += L[:, i+1]*m</div>
<div class="line"><span class="lineno"> 2031</span> </div>
<div class="line"><span class="lineno"> 2032</span>    <span class="comment"># one last permutation</span></div>
<div class="line"><span class="lineno"> 2033</span>    i, piv = -1, ipiv[-1] - 1</div>
<div class="line"><span class="lineno"> 2034</span>    <span class="comment"># right multiply by final permutation matrix</span></div>
<div class="line"><span class="lineno"> 2035</span>    L[:, [i, piv]] = L[:, [piv, i]]</div>
<div class="line"><span class="lineno"> 2036</span> </div>
<div class="line"><span class="lineno"> 2037</span>    <span class="comment"># check that the outputs of ?gttrf define an LU decomposition of A</span></div>
<div class="line"><span class="lineno"> 2038</span>    assert_allclose(A, L @ U, atol=atol)</div>
<div class="line"><span class="lineno"> 2039</span> </div>
<div class="line"><span class="lineno"> 2040</span>    b_cpy = b.copy()</div>
<div class="line"><span class="lineno"> 2041</span>    x_gttrs, info = gttrs(_dl, _d, _du, du2, ipiv, b)</div>
<div class="line"><span class="lineno"> 2042</span>    <span class="comment"># test that the inputs of ?gttrs are unmodified</span></div>
<div class="line"><span class="lineno"> 2043</span>    assert_array_equal(b, b_cpy)</div>
<div class="line"><span class="lineno"> 2044</span>    <span class="comment"># test that the result of ?gttrs matches the expected input</span></div>
<div class="line"><span class="lineno"> 2045</span>    assert_allclose(x, x_gttrs, atol=atol)</div>
<div class="line"><span class="lineno"> 2046</span> </div>
<div class="line"><span class="lineno"> 2047</span>    <span class="comment"># test that ?gttrf and ?gttrs work with transposal options</span></div>
<div class="line"><span class="lineno"> 2048</span>    <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> REAL_DTYPES:</div>
<div class="line"><span class="lineno"> 2049</span>        trans = <span class="stringliteral">&quot;T&quot;</span></div>
<div class="line"><span class="lineno"> 2050</span>        b_trans = A.T @ x</div>
<div class="line"><span class="lineno"> 2051</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2052</span>        trans = <span class="stringliteral">&quot;C&quot;</span></div>
<div class="line"><span class="lineno"> 2053</span>        b_trans = A.conj().T @ x</div>
<div class="line"><span class="lineno"> 2054</span> </div>
<div class="line"><span class="lineno"> 2055</span>    x_gttrs, info = gttrs(_dl, _d, _du, du2, ipiv, b_trans, trans=trans)</div>
<div class="line"><span class="lineno"> 2056</span>    assert_allclose(x, x_gttrs, atol=atol)</div>
<div class="line"><span class="lineno"> 2057</span> </div>
<div class="line"><span class="lineno"> 2058</span>    <span class="comment"># test that ValueError is raised with incompatible matrix shapes</span></div>
<div class="line"><span class="lineno"> 2059</span>    <span class="keyword">with</span> assert_raises(ValueError):</div>
<div class="line"><span class="lineno"> 2060</span>        gttrf(dl[:-1], d, du)</div>
<div class="line"><span class="lineno"> 2061</span>    <span class="keyword">with</span> assert_raises(ValueError):</div>
<div class="line"><span class="lineno"> 2062</span>        gttrf(dl, d[:-1], du)</div>
<div class="line"><span class="lineno"> 2063</span>    <span class="keyword">with</span> assert_raises(ValueError):</div>
<div class="line"><span class="lineno"> 2064</span>        gttrf(dl, d, du[:-1])</div>
<div class="line"><span class="lineno"> 2065</span> </div>
<div class="line"><span class="lineno"> 2066</span>    <span class="comment"># test that matrix of size n=2 raises exception</span></div>
<div class="line"><span class="lineno"> 2067</span>    <span class="keyword">with</span> assert_raises(Exception):</div>
<div class="line"><span class="lineno"> 2068</span>        gttrf(dl[0], d[:1], du[0])</div>
<div class="line"><span class="lineno"> 2069</span> </div>
<div class="line"><span class="lineno"> 2070</span>    <span class="comment"># test that singular (row of all zeroes) matrix fails via info</span></div>
<div class="line"><span class="lineno"> 2071</span>    du[0] = 0</div>
<div class="line"><span class="lineno"> 2072</span>    d[0] = 0</div>
<div class="line"><span class="lineno"> 2073</span>    __dl, __d, __du, _du2, _ipiv, _info = gttrf(dl, d, du)</div>
<div class="line"><span class="lineno"> 2074</span>    np.testing.assert_(__d[info - 1] == 0,</div>
<div class="line"><span class="lineno"> 2075</span>                       <span class="stringliteral">&quot;?gttrf: _d[info-1] is {}, not the illegal value :0.&quot;</span></div>
<div class="line"><span class="lineno"> 2076</span>                       .format(__d[info - 1]))</div>
<div class="line"><span class="lineno"> 2077</span> </div>
<div class="line"><span class="lineno"> 2078</span> </div>
<div class="line"><span class="lineno"> 2079</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;du, d, dl, du_exp, d_exp, du2_exp, ipiv_exp, b, x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2080</span>                         [(np.array([2.1, -1.0, 1.9, 8.0]),</div>
<div class="line"><span class="lineno"> 2081</span>                             np.array([3.0, 2.3, -5.0, -.9, 7.1]),</div>
<div class="line"><span class="lineno"> 2082</span>                             np.array([3.4, 3.6, 7.0, -6.0]),</div>
<div class="line"><span class="lineno"> 2083</span>                             np.array([2.3, -5, -.9, 7.1]),</div>
<div class="line"><span class="lineno"> 2084</span>                             np.array([3.4, 3.6, 7, -6, -1.015373]),</div>
<div class="line"><span class="lineno"> 2085</span>                             np.array([-1, 1.9, 8]),</div>
<div class="line"><span class="lineno"> 2086</span>                             np.array([2, 3, 4, 5, 5]),</div>
<div class="line"><span class="lineno"> 2087</span>                             np.array([[2.7, 6.6],</div>
<div class="line"><span class="lineno"> 2088</span>                                       [-0.5, 10.8],</div>
<div class="line"><span class="lineno"> 2089</span>                                       [2.6, -3.2],</div>
<div class="line"><span class="lineno"> 2090</span>                                       [0.6, -11.2],</div>
<div class="line"><span class="lineno"> 2091</span>                                       [2.7, 19.1]</div>
<div class="line"><span class="lineno"> 2092</span>                                       ]),</div>
<div class="line"><span class="lineno"> 2093</span>                             np.array([[-4, 5],</div>
<div class="line"><span class="lineno"> 2094</span>                                       [7, -4],</div>
<div class="line"><span class="lineno"> 2095</span>                                       [3, -3],</div>
<div class="line"><span class="lineno"> 2096</span>                                       [-4, -2],</div>
<div class="line"><span class="lineno"> 2097</span>                                       [-3, 1]])),</div>
<div class="line"><span class="lineno"> 2098</span>                          (</div>
<div class="line"><span class="lineno"> 2099</span>                             np.array([2 - 1j, 2 + 1j, -1 + 1j, 1 - 1j]),</div>
<div class="line"><span class="lineno"> 2100</span>                             np.array([-1.3 + 1.3j, -1.3 + 1.3j,</div>
<div class="line"><span class="lineno"> 2101</span>                                       -1.3 + 3.3j, - .3 + 4.3j,</div>
<div class="line"><span class="lineno"> 2102</span>                                       -3.3 + 1.3j]),</div>
<div class="line"><span class="lineno"> 2103</span>                             np.array([1 - 2j, 1 + 1j, 2 - 3j, 1 + 1j]),</div>
<div class="line"><span class="lineno"> 2104</span>                             <span class="comment"># du exp</span></div>
<div class="line"><span class="lineno"> 2105</span>                             np.array([-1.3 + 1.3j, -1.3 + 3.3j,</div>
<div class="line"><span class="lineno"> 2106</span>                                       -0.3 + 4.3j, -3.3 + 1.3j]),</div>
<div class="line"><span class="lineno"> 2107</span>                             np.array([1 - 2j, 1 + 1j, 2 - 3j, 1 + 1j,</div>
<div class="line"><span class="lineno"> 2108</span>                                       -1.3399 + 0.2875j]),</div>
<div class="line"><span class="lineno"> 2109</span>                             np.array([2 + 1j, -1 + 1j, 1 - 1j]),</div>
<div class="line"><span class="lineno"> 2110</span>                             np.array([2, 3, 4, 5, 5]),</div>
<div class="line"><span class="lineno"> 2111</span>                             np.array([[2.4 - 5j, 2.7 + 6.9j],</div>
<div class="line"><span class="lineno"> 2112</span>                                       [3.4 + 18.2j, - 6.9 - 5.3j],</div>
<div class="line"><span class="lineno"> 2113</span>                                       [-14.7 + 9.7j, - 6 - .6j],</div>
<div class="line"><span class="lineno"> 2114</span>                                       [31.9 - 7.7j, -3.9 + 9.3j],</div>
<div class="line"><span class="lineno"> 2115</span>                                       [-1 + 1.6j, -3 + 12.2j]]),</div>
<div class="line"><span class="lineno"> 2116</span>                             np.array([[1 + 1j, 2 - 1j],</div>
<div class="line"><span class="lineno"> 2117</span>                                       [3 - 1j, 1 + 2j],</div>
<div class="line"><span class="lineno"> 2118</span>                                       [4 + 5j, -1 + 1j],</div>
<div class="line"><span class="lineno"> 2119</span>                                       [-1 - 2j, 2 + 1j],</div>
<div class="line"><span class="lineno"> 2120</span>                                       [1 - 1j, 2 - 2j]])</div>
<div class="line"><span class="lineno"> 2121</span>                            )])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4906a02dc932f4fadb3ed8a6b5322d84" name="a4906a02dc932f4fadb3ed8a6b5322d84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4906a02dc932f4fadb3ed8a6b5322d84">&#9670;&#160;</a></span>test_gttrf_gttrs_NAG_f07cdf_f07cef_f07crf_f07csf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_gttrf_gttrs_NAG_f07cdf_f07cef_f07crf_f07csf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>du</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>du_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>du2_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ipiv_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2123</span>                                                     du2_exp, ipiv_exp, b, x):</div>
<div class="line"><span class="lineno"> 2124</span>    <span class="comment"># test to assure that wrapper is consistent with NAG Library Manual Mark 26</span></div>
<div class="line"><span class="lineno"> 2125</span>    <span class="comment"># example problems: f07cdf and f07cef (real)</span></div>
<div class="line"><span class="lineno"> 2126</span>    <span class="comment"># examples: f07crf and f07csf (complex)</span></div>
<div class="line"><span class="lineno"> 2127</span>    <span class="comment"># (Links may expire, so search for &quot;NAG Library Manual Mark 26&quot; online)</span></div>
<div class="line"><span class="lineno"> 2128</span> </div>
<div class="line"><span class="lineno"> 2129</span>    gttrf, gttrs = get_lapack_funcs((<span class="stringliteral">&#39;gttrf&#39;</span>, <span class="stringliteral">&quot;gttrs&quot;</span>), (du[0], du[0]))</div>
<div class="line"><span class="lineno"> 2130</span> </div>
<div class="line"><span class="lineno"> 2131</span>    _dl, _d, _du, du2, ipiv, info = gttrf(dl, d, du)</div>
<div class="line"><span class="lineno"> 2132</span>    assert_allclose(du2, du2_exp)</div>
<div class="line"><span class="lineno"> 2133</span>    assert_allclose(_du, du_exp)</div>
<div class="line"><span class="lineno"> 2134</span>    assert_allclose(_d, d_exp, atol=1e-4)  <span class="comment"># NAG examples provide 4 decimals.</span></div>
<div class="line"><span class="lineno"> 2135</span>    assert_allclose(ipiv, ipiv_exp)</div>
<div class="line"><span class="lineno"> 2136</span> </div>
<div class="line"><span class="lineno"> 2137</span>    x_gttrs, info = gttrs(_dl, _d, _du, du2, ipiv, b)</div>
<div class="line"><span class="lineno"> 2138</span> </div>
<div class="line"><span class="lineno"> 2139</span>    assert_allclose(x_gttrs, x)</div>
<div class="line"><span class="lineno"> 2140</span> </div>
<div class="line"><span class="lineno"> 2141</span> </div>
<div class="line"><span class="lineno"> 2142</span><span class="preprocessor">@pytest.mark.parametrize(&#39;dtype&#39;, DTYPES)</span></div>
<div class="line"><span class="lineno"> 2143</span><span class="preprocessor">@pytest.mark.parametrize(&#39;shape&#39;, [(3, 7)</span>, (7, 3), (2**18, 2**18)])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cc3cba1e7e007659ee6cb192487db5f" name="a7cc3cba1e7e007659ee6cb192487db5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc3cba1e7e007659ee6cb192487db5f">&#9670;&#160;</a></span>test_heequb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_heequb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1744</span><span class="keyword">def </span>test_heequb():</div>
<div class="line"><span class="lineno"> 1745</span>    <span class="comment"># zheequb has a bug for versions =&lt; LAPACK 3.9.0</span></div>
<div class="line"><span class="lineno"> 1746</span>    <span class="comment"># See Reference-LAPACK gh-61 and gh-408</span></div>
<div class="line"><span class="lineno"> 1747</span>    <span class="comment"># Hence the zheequb test is customized accordingly to avoid</span></div>
<div class="line"><span class="lineno"> 1748</span>    <span class="comment"># work scaling.</span></div>
<div class="line"><span class="lineno"> 1749</span>    A = np.diag([2]*5 + [1002]*5) + np.diag(np.ones(9), k=1)*1j</div>
<div class="line"><span class="lineno"> 1750</span>    s, scond, amax, info = lapack.zheequb(A)</div>
<div class="line"><span class="lineno"> 1751</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 1752</span>    assert_allclose(np.log2(s), [0., -1.]*2 + [0.] + [-4]*5)</div>
<div class="line"><span class="lineno"> 1753</span> </div>
<div class="line"><span class="lineno"> 1754</span>    A = np.diag(2**np.abs(np.arange(-5, 6)) + 0j)</div>
<div class="line"><span class="lineno"> 1755</span>    A[5, 5] = 1024</div>
<div class="line"><span class="lineno"> 1756</span>    A[5, 0] = 16j</div>
<div class="line"><span class="lineno"> 1757</span>    s, scond, amax, info = lapack.cheequb(A.astype(np.complex64), lower=1)</div>
<div class="line"><span class="lineno"> 1758</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 1759</span>    assert_allclose(np.log2(s), [-2, -1, -1, 0, 0, -5, 0, -1, -1, -2, -2])</div>
<div class="line"><span class="lineno"> 1760</span> </div>
<div class="line"><span class="lineno"> 1761</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3851eef77e07e0103802d63ea8962d31" name="a3851eef77e07e0103802d63ea8962d31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3851eef77e07e0103802d63ea8962d31">&#9670;&#160;</a></span>test_hegst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_hegst </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1029</span><span class="keyword">def </span>test_hegst():</div>
<div class="line"><span class="lineno"> 1030</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(COMPLEX_DTYPES):</div>
<div class="line"><span class="lineno"> 1032</span>        <span class="comment"># DTYPES = &lt;c,z&gt; hegst</span></div>
<div class="line"><span class="lineno"> 1033</span>        n = 10</div>
<div class="line"><span class="lineno"> 1034</span> </div>
<div class="line"><span class="lineno"> 1035</span>        potrf, hegst, heevd, hegvd = get_lapack_funcs((<span class="stringliteral">&#39;potrf&#39;</span>, <span class="stringliteral">&#39;hegst&#39;</span>,</div>
<div class="line"><span class="lineno"> 1036</span>                                                       <span class="stringliteral">&#39;heevd&#39;</span>, <span class="stringliteral">&#39;hegvd&#39;</span>),</div>
<div class="line"><span class="lineno"> 1037</span>                                                      dtype=dtype)</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>        A = rand(n, n).astype(dtype) + 1j * rand(n, n).astype(dtype)</div>
<div class="line"><span class="lineno"> 1040</span>        A = (A + A.conj().T)/2</div>
<div class="line"><span class="lineno"> 1041</span>        <span class="comment"># B must be positive definite</span></div>
<div class="line"><span class="lineno"> 1042</span>        B = rand(n, n).astype(dtype) + 1j * rand(n, n).astype(dtype)</div>
<div class="line"><span class="lineno"> 1043</span>        B = (B + B.conj().T)/2 + 2 * np.eye(n, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>        <span class="comment"># Perform eig (hegvd)</span></div>
<div class="line"><span class="lineno"> 1046</span>        eig_gvd, _, info = hegvd(A, B)</div>
<div class="line"><span class="lineno"> 1047</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1048</span> </div>
<div class="line"><span class="lineno"> 1049</span>        <span class="comment"># Convert to std problem potrf</span></div>
<div class="line"><span class="lineno"> 1050</span>        b, info = potrf(B)</div>
<div class="line"><span class="lineno"> 1051</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1052</span>        a, info = hegst(A, b)</div>
<div class="line"><span class="lineno"> 1053</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>        eig, _, info = heevd(a)</div>
<div class="line"><span class="lineno"> 1056</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1057</span>        assert_allclose(eig, eig_gvd, rtol=1e-4)</div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aed5123e4f5b14d7fd9570d6f62897dd2" name="aed5123e4f5b14d7fd9570d6f62897dd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed5123e4f5b14d7fd9570d6f62897dd2">&#9670;&#160;</a></span>test_lapack_documented()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_lapack_documented </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that all entries are in the doc.</pre> <div class="fragment"><div class="line"><span class="lineno">   49</span><span class="keyword">def </span>test_lapack_documented():</div>
<div class="line"><span class="lineno">   50</span>    <span class="stringliteral">&quot;&quot;&quot;Test that all entries are in the doc.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">if</span> lapack.__doc__ <span class="keywordflow">is</span> <span class="keywordtype">None</span>:  <span class="comment"># just in case there is a python -OO</span></div>
<div class="line"><span class="lineno">   52</span>        pytest.skip(<span class="stringliteral">&#39;lapack.__doc__ is None&#39;</span>)</div>
<div class="line"><span class="lineno">   53</span>    names = set(lapack.__doc__.split())</div>
<div class="line"><span class="lineno">   54</span>    ignore_list = set([</div>
<div class="line"><span class="lineno">   55</span>        <span class="stringliteral">&#39;absolute_import&#39;</span>, <span class="stringliteral">&#39;clapack&#39;</span>, <span class="stringliteral">&#39;division&#39;</span>, <span class="stringliteral">&#39;find_best_lapack_type&#39;</span>,</div>
<div class="line"><span class="lineno">   56</span>        <span class="stringliteral">&#39;flapack&#39;</span>, <span class="stringliteral">&#39;print_function&#39;</span>, <span class="stringliteral">&#39;HAS_ILP64&#39;</span>,</div>
<div class="line"><span class="lineno">   57</span>    ])</div>
<div class="line"><span class="lineno">   58</span>    missing = list()</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">for</span> name <span class="keywordflow">in</span> dir(lapack):</div>
<div class="line"><span class="lineno">   60</span>        <span class="keywordflow">if</span> (<span class="keywordflow">not</span> name.startswith(<span class="stringliteral">&#39;_&#39;</span>) <span class="keywordflow">and</span> name <span class="keywordflow">not</span> <span class="keywordflow">in</span> ignore_list <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">   61</span>                name <span class="keywordflow">not</span> <span class="keywordflow">in</span> names):</div>
<div class="line"><span class="lineno">   62</span>            missing.append(name)</div>
<div class="line"><span class="lineno">   63</span>    <span class="keyword">assert</span> missing == [], <span class="stringliteral">&#39;Name(s) missing from lapack.__doc__ or ignore_list&#39;</span></div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac18097ea2143ace6101e98164e94db74" name="ac18097ea2143ace6101e98164e94db74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac18097ea2143ace6101e98164e94db74">&#9670;&#160;</a></span>test_larfg_larf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_larfg_larf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  705</span><span class="keyword">def </span>test_larfg_larf():</div>
<div class="line"><span class="lineno">  706</span>    np.random.seed(1234)</div>
<div class="line"><span class="lineno">  707</span>    a0 = np.random.random((4, 4))</div>
<div class="line"><span class="lineno">  708</span>    a0 = a0.T.dot(a0)</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>    a0j = np.random.random((4, 4)) + 1j*np.random.random((4, 4))</div>
<div class="line"><span class="lineno">  711</span>    a0j = a0j.T.conj().dot(a0j)</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>    <span class="comment"># our test here will be to do one step of reducing a hermetian matrix to</span></div>
<div class="line"><span class="lineno">  714</span>    <span class="comment"># tridiagonal form using householder transforms.</span></div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>    <span class="keywordflow">for</span> dtype <span class="keywordflow">in</span> <span class="stringliteral">&#39;fdFD&#39;</span>:</div>
<div class="line"><span class="lineno">  717</span>        larfg, larf = get_lapack_funcs([<span class="stringliteral">&#39;larfg&#39;</span>, <span class="stringliteral">&#39;larf&#39;</span>], dtype=dtype)</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>        <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> <span class="stringliteral">&#39;FD&#39;</span>:</div>
<div class="line"><span class="lineno">  720</span>            a = a0j.copy()</div>
<div class="line"><span class="lineno">  721</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  722</span>            a = a0.copy()</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>        <span class="comment"># generate a householder transform to clear a[2:,0]</span></div>
<div class="line"><span class="lineno">  725</span>        alpha, x, tau = larfg(a.shape[0]-1, a[1, 0], a[2:, 0])</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>        <span class="comment"># create expected output</span></div>
<div class="line"><span class="lineno">  728</span>        expected = np.zeros_like(a[:, 0])</div>
<div class="line"><span class="lineno">  729</span>        expected[0] = a[0, 0]</div>
<div class="line"><span class="lineno">  730</span>        expected[1] = alpha</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>        <span class="comment"># assemble householder vector</span></div>
<div class="line"><span class="lineno">  733</span>        v = np.zeros_like(a[1:, 0])</div>
<div class="line"><span class="lineno">  734</span>        v[0] = 1.0</div>
<div class="line"><span class="lineno">  735</span>        v[1:] = x</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>        <span class="comment"># apply transform from the left</span></div>
<div class="line"><span class="lineno">  738</span>        a[1:, :] = larf(v, tau.conjugate(), a[1:, :], np.zeros(a.shape[1]))</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>        <span class="comment"># apply transform from the right</span></div>
<div class="line"><span class="lineno">  741</span>        a[:, 1:] = larf(v, tau, a[:, 1:], np.zeros(a.shape[0]), side=<span class="stringliteral">&#39;R&#39;</span>)</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>        assert_allclose(a[:, 0], expected, atol=1e-5)</div>
<div class="line"><span class="lineno">  744</span>        assert_allclose(a[0, :], expected, atol=1e-5)</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3327961f1b8e813fa93986372a2edaf1" name="a3327961f1b8e813fa93986372a2edaf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3327961f1b8e813fa93986372a2edaf1">&#9670;&#160;</a></span>test_lartg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_lartg </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  640</span><span class="keyword">def </span>test_lartg():</div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordflow">for</span> dtype <span class="keywordflow">in</span> <span class="stringliteral">&#39;fdFD&#39;</span>:</div>
<div class="line"><span class="lineno">  642</span>        lartg = get_lapack_funcs(<span class="stringliteral">&#39;lartg&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>        f = np.array(3, dtype)</div>
<div class="line"><span class="lineno">  645</span>        g = np.array(4, dtype)</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>        <span class="keywordflow">if</span> np.iscomplexobj(g):</div>
<div class="line"><span class="lineno">  648</span>            g *= 1j</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>        cs, sn, r = lartg(f, g)</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>        assert_allclose(cs, 3.0/5.0)</div>
<div class="line"><span class="lineno">  653</span>        assert_allclose(r, 5.0)</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>        <span class="keywordflow">if</span> np.iscomplexobj(g):</div>
<div class="line"><span class="lineno">  656</span>            assert_allclose(sn, -4.0j/5.0)</div>
<div class="line"><span class="lineno">  657</span>            assert_(type(r) == complex)</div>
<div class="line"><span class="lineno">  658</span>            assert_(type(cs) == float)</div>
<div class="line"><span class="lineno">  659</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  660</span>            assert_allclose(sn, 4.0/5.0)</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a176f42ac83317f5f4003113186176907" name="a176f42ac83317f5f4003113186176907"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a176f42ac83317f5f4003113186176907">&#9670;&#160;</a></span>test_orcsd_uncsd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_orcsd_uncsd </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype_</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2528</span><span class="keyword">def </span>test_orcsd_uncsd(dtype_):</div>
<div class="line"><span class="lineno"> 2529</span>    m, p, q = 250, 80, 170</div>
<div class="line"><span class="lineno"> 2530</span> </div>
<div class="line"><span class="lineno"> 2531</span>    pfx = <span class="stringliteral">&#39;or&#39;</span> <span class="keywordflow">if</span> dtype_ <span class="keywordflow">in</span> REAL_DTYPES <span class="keywordflow">else</span> <span class="stringliteral">&#39;un&#39;</span></div>
<div class="line"><span class="lineno"> 2532</span>    X = ortho_group.rvs(m) <span class="keywordflow">if</span> pfx == <span class="stringliteral">&#39;or&#39;</span> <span class="keywordflow">else</span> unitary_group.rvs(m)</div>
<div class="line"><span class="lineno"> 2533</span> </div>
<div class="line"><span class="lineno"> 2534</span>    drv, dlw = get_lapack_funcs((pfx + <span class="stringliteral">&#39;csd&#39;</span>, pfx + <span class="stringliteral">&#39;csd_lwork&#39;</span>), dtype=dtype_)</div>
<div class="line"><span class="lineno"> 2535</span>    lwval = _compute_lwork(dlw, m, p, q)</div>
<div class="line"><span class="lineno"> 2536</span>    lwvals = {<span class="stringliteral">&#39;lwork&#39;</span>: lwval} <span class="keywordflow">if</span> pfx == <span class="stringliteral">&#39;or&#39;</span> <span class="keywordflow">else</span> dict(zip([<span class="stringliteral">&#39;lwork&#39;</span>,</div>
<div class="line"><span class="lineno"> 2537</span>                                                            <span class="stringliteral">&#39;lrwork&#39;</span>], lwval))</div>
<div class="line"><span class="lineno"> 2538</span> </div>
<div class="line"><span class="lineno"> 2539</span>    cs11, cs12, cs21, cs22, theta, u1, u2, v1t, v2t, info =\</div>
<div class="line"><span class="lineno"> 2540</span>        drv(X[:p, :q], X[:p, q:], X[p:, :q], X[p:, q:], **lwvals)</div>
<div class="line"><span class="lineno"> 2541</span> </div>
<div class="line"><span class="lineno"> 2542</span>    <span class="keyword">assert</span> info == 0</div>
<div class="line"><span class="lineno"> 2543</span> </div>
<div class="line"><span class="lineno"> 2544</span>    U = block_diag(u1, u2)</div>
<div class="line"><span class="lineno"> 2545</span>    VH = block_diag(v1t, v2t)</div>
<div class="line"><span class="lineno"> 2546</span>    r = min(min(p, q), min(m-p, m-q))</div>
<div class="line"><span class="lineno"> 2547</span>    n11 = min(p, q) - r</div>
<div class="line"><span class="lineno"> 2548</span>    n12 = min(p, m-q) - r</div>
<div class="line"><span class="lineno"> 2549</span>    n21 = min(m-p, q) - r</div>
<div class="line"><span class="lineno"> 2550</span>    n22 = min(m-p, m-q) - r</div>
<div class="line"><span class="lineno"> 2551</span> </div>
<div class="line"><span class="lineno"> 2552</span>    S = np.zeros((m, m), dtype=dtype_)</div>
<div class="line"><span class="lineno"> 2553</span>    one = dtype_(1.)</div>
<div class="line"><span class="lineno"> 2554</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n11):</div>
<div class="line"><span class="lineno"> 2555</span>        S[i, i] = one</div>
<div class="line"><span class="lineno"> 2556</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n22):</div>
<div class="line"><span class="lineno"> 2557</span>        S[p+i, q+i] = one</div>
<div class="line"><span class="lineno"> 2558</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n12):</div>
<div class="line"><span class="lineno"> 2559</span>        S[i+n11+r, i+n11+r+n21+n22+r] = -one</div>
<div class="line"><span class="lineno"> 2560</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n21):</div>
<div class="line"><span class="lineno"> 2561</span>        S[p+n22+r+i, n11+r+i] = one</div>
<div class="line"><span class="lineno"> 2562</span> </div>
<div class="line"><span class="lineno"> 2563</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(r):</div>
<div class="line"><span class="lineno"> 2564</span>        S[i+n11, i+n11] = np.cos(theta[i])</div>
<div class="line"><span class="lineno"> 2565</span>        S[p+n22+i, i+r+n21+n22] = np.cos(theta[i])</div>
<div class="line"><span class="lineno"> 2566</span> </div>
<div class="line"><span class="lineno"> 2567</span>        S[i+n11, i+n11+n21+n22+r] = -np.sin(theta[i])</div>
<div class="line"><span class="lineno"> 2568</span>        S[p+n22+i, i+n11] = np.sin(theta[i])</div>
<div class="line"><span class="lineno"> 2569</span> </div>
<div class="line"><span class="lineno"> 2570</span>    Xc = U @ S @ VH</div>
<div class="line"><span class="lineno"> 2571</span>    assert_allclose(X, Xc, rtol=0., atol=1e4*np.finfo(dtype_).eps)</div>
<div class="line"><span class="lineno"> 2572</span> </div>
<div class="line"><span class="lineno"> 2573</span> </div>
<div class="line"><span class="lineno"> 2574</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, DTYPES)</span></div>
<div class="line"><span class="lineno"> 2575</span><span class="preprocessor">@pytest.mark.parametrize(&quot;trans_bool&quot;, [False, True])</span></div>
<div class="line"><span class="lineno"> 2576</span><span class="preprocessor">@pytest.mark.parametrize(&quot;fact&quot;, [&quot;F&quot;, &quot;N&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace8cc8b96aa2058e6ed90f26ea17f826" name="ace8cc8b96aa2058e6ed90f26ea17f826"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace8cc8b96aa2058e6ed90f26ea17f826">&#9670;&#160;</a></span>test_orcsd_uncsd_lwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_orcsd_uncsd_lwork </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2515</span><span class="keyword">def </span>test_orcsd_uncsd_lwork(dtype_, m):</div>
<div class="line"><span class="lineno"> 2516</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 2517</span>    p = randint(0, m)</div>
<div class="line"><span class="lineno"> 2518</span>    q = m - p</div>
<div class="line"><span class="lineno"> 2519</span>    pfx = <span class="stringliteral">&#39;or&#39;</span> <span class="keywordflow">if</span> dtype_ <span class="keywordflow">in</span> REAL_DTYPES <span class="keywordflow">else</span> <span class="stringliteral">&#39;un&#39;</span></div>
<div class="line"><span class="lineno"> 2520</span>    dlw = pfx + <span class="stringliteral">&#39;csd_lwork&#39;</span></div>
<div class="line"><span class="lineno"> 2521</span>    lw = get_lapack_funcs(dlw, dtype=dtype_)</div>
<div class="line"><span class="lineno"> 2522</span>    lwval = _compute_lwork(lw, m, p, q)</div>
<div class="line"><span class="lineno"> 2523</span>    lwval = lwval <span class="keywordflow">if</span> pfx == <span class="stringliteral">&#39;un&#39;</span> <span class="keywordflow">else</span> (lwval,)</div>
<div class="line"><span class="lineno"> 2524</span>    <span class="keyword">assert</span> all([x &gt; 0 <span class="keywordflow">for</span> x <span class="keywordflow">in</span> lwval])</div>
<div class="line"><span class="lineno"> 2525</span> </div>
<div class="line"><span class="lineno"> 2526</span> </div>
<div class="line"><span class="lineno"> 2527</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype_&quot;, DTYPES)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8cc0db4e3285f2b894b124b3c1ef7eff" name="a8cc0db4e3285f2b894b124b3c1ef7eff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cc0db4e3285f2b894b124b3c1ef7eff">&#9670;&#160;</a></span>test_ormrz_unmrz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_ormrz_unmrz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This test performs a matrix multiplication with an arbitrary m x n matric C
and a unitary matrix Q without explicitly forming the array. The array data
is encoded in the rectangular part of A which is obtained from ?TZRZF. Q
size is inferred by m, n, side keywords.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1135</span><span class="keyword">def </span>test_ormrz_unmrz():</div>
<div class="line"><span class="lineno"> 1136</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1137</span><span class="stringliteral">    This test performs a matrix multiplication with an arbitrary m x n matric C</span></div>
<div class="line"><span class="lineno"> 1138</span><span class="stringliteral">    and a unitary matrix Q without explicitly forming the array. The array data</span></div>
<div class="line"><span class="lineno"> 1139</span><span class="stringliteral">    is encoded in the rectangular part of A which is obtained from ?TZRZF. Q</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="stringliteral">    size is inferred by m, n, side keywords.</span></div>
<div class="line"><span class="lineno"> 1141</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1142</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1143</span>    qm, qn, cn = 10, 15, 15</div>
<div class="line"><span class="lineno"> 1144</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1145</span>        tzrzf, tzrzf_lw = get_lapack_funcs((<span class="stringliteral">&#39;tzrzf&#39;</span>, <span class="stringliteral">&#39;tzrzf_lwork&#39;</span>),</div>
<div class="line"><span class="lineno"> 1146</span>                                           dtype=dtype)</div>
<div class="line"><span class="lineno"> 1147</span>        lwork_rz = _compute_lwork(tzrzf_lw, qm, qn)</div>
<div class="line"><span class="lineno"> 1148</span> </div>
<div class="line"><span class="lineno"> 1149</span>        <span class="keywordflow">if</span> ind &lt; 2:</div>
<div class="line"><span class="lineno"> 1150</span>            A = triu(rand(qm, qn).astype(dtype))</div>
<div class="line"><span class="lineno"> 1151</span>            C = rand(cn, cn).astype(dtype)</div>
<div class="line"><span class="lineno"> 1152</span>            orun_mrz, orun_mrz_lw = get_lapack_funcs((<span class="stringliteral">&#39;ormrz&#39;</span>, <span class="stringliteral">&#39;ormrz_lwork&#39;</span>),</div>
<div class="line"><span class="lineno"> 1153</span>                                                     dtype=dtype)</div>
<div class="line"><span class="lineno"> 1154</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1155</span>            A = triu((rand(qm, qn) + rand(qm, qn)*1j).astype(dtype))</div>
<div class="line"><span class="lineno"> 1156</span>            C = (rand(cn, cn) + rand(cn, cn)*1j).astype(dtype)</div>
<div class="line"><span class="lineno"> 1157</span>            orun_mrz, orun_mrz_lw = get_lapack_funcs((<span class="stringliteral">&#39;unmrz&#39;</span>, <span class="stringliteral">&#39;unmrz_lwork&#39;</span>),</div>
<div class="line"><span class="lineno"> 1158</span>                                                     dtype=dtype)</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>        lwork_mrz = _compute_lwork(orun_mrz_lw, cn, cn)</div>
<div class="line"><span class="lineno"> 1161</span>        rz, tau, info = tzrzf(A, lwork=lwork_rz)</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>        <span class="comment"># Get Q manually for comparison</span></div>
<div class="line"><span class="lineno"> 1164</span>        V = np.hstack((np.eye(qm, dtype=dtype), rz[:, qm:]))</div>
<div class="line"><span class="lineno"> 1165</span>        Id = np.eye(qn, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1166</span>        ref = [Id-tau[x]*V[[x], :].T.dot(V[[x], :].conj()) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> range(qm)]</div>
<div class="line"><span class="lineno"> 1167</span>        Q = reduce(np.dot, ref)</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>        <span class="comment"># Now that we have Q, we can test whether lapack results agree with</span></div>
<div class="line"><span class="lineno"> 1170</span>        <span class="comment"># each case of CQ, CQ^H, QC, and QC^H</span></div>
<div class="line"><span class="lineno"> 1171</span>        trans = <span class="stringliteral">&#39;T&#39;</span> <span class="keywordflow">if</span> ind &lt; 2 <span class="keywordflow">else</span> <span class="stringliteral">&#39;C&#39;</span></div>
<div class="line"><span class="lineno"> 1172</span>        tol = 10*np.spacing(<a class="code hl_namespace" href="namespacedtype.html">dtype</a>(1.0).real)</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="line"><span class="lineno"> 1174</span>        cq, info = orun_mrz(rz, tau, C, lwork=lwork_mrz)</div>
<div class="line"><span class="lineno"> 1175</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1176</span>        assert_allclose(cq - Q.dot(C), zeros_like(C), atol=tol, rtol=0.)</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>        cq, info = orun_mrz(rz, tau, C, trans=trans, lwork=lwork_mrz)</div>
<div class="line"><span class="lineno"> 1179</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1180</span>        assert_allclose(cq - Q.conj().T.dot(C), zeros_like(C), atol=tol,</div>
<div class="line"><span class="lineno"> 1181</span>                        rtol=0.)</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>        cq, info = orun_mrz(rz, tau, C, side=<span class="stringliteral">&#39;R&#39;</span>, lwork=lwork_mrz)</div>
<div class="line"><span class="lineno"> 1184</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1185</span>        assert_allclose(cq - C.dot(Q), zeros_like(C), atol=tol, rtol=0.)</div>
<div class="line"><span class="lineno"> 1186</span> </div>
<div class="line"><span class="lineno"> 1187</span>        cq, info = orun_mrz(rz, tau, C, side=<span class="stringliteral">&#39;R&#39;</span>, trans=trans, lwork=lwork_mrz)</div>
<div class="line"><span class="lineno"> 1188</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1189</span>        assert_allclose(cq - C.dot(Q.conj().T), zeros_like(C), atol=tol,</div>
<div class="line"><span class="lineno"> 1190</span>                        rtol=0.)</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="ttc" id="anamespacedtype_html"><div class="ttname"><a href="namespacedtype.html">dtype</a></div><div class="ttdef"><b>Definition</b> dtype.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9dc2e4711e5bf6daef635d7c1dd5541" name="ac9dc2e4711e5bf6daef635d7c1dd5541"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9dc2e4711e5bf6daef635d7c1dd5541">&#9670;&#160;</a></span>test_pftrf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pftrf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test Cholesky factorization of a positive definite Rectengular Full
Packed (RFP) format array
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1292</span><span class="keyword">def </span>test_pftrf():</div>
<div class="line"><span class="lineno"> 1293</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1294</span><span class="stringliteral">    Test Cholesky factorization of a positive definite Rectengular Full</span></div>
<div class="line"><span class="lineno"> 1295</span><span class="stringliteral">    Packed (RFP) format array</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1297</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1298</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1299</span>        n = 20</div>
<div class="line"><span class="lineno"> 1300</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1301</span>            A = (rand(n, n) + rand(n, n)*1j).astype(dtype)</div>
<div class="line"><span class="lineno"> 1302</span>            A = A + A.conj().T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1303</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1304</span>            A = (rand(n, n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1305</span>            A = A + A.T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1306</span> </div>
<div class="line"><span class="lineno"> 1307</span>        pftrf, trttf, tfttr = get_lapack_funcs((<span class="stringliteral">&#39;pftrf&#39;</span>, <span class="stringliteral">&#39;trttf&#39;</span>, <span class="stringliteral">&#39;tfttr&#39;</span>),</div>
<div class="line"><span class="lineno"> 1308</span>                                               dtype=dtype)</div>
<div class="line"><span class="lineno"> 1309</span> </div>
<div class="line"><span class="lineno"> 1310</span>        <span class="comment"># Get the original array from TP</span></div>
<div class="line"><span class="lineno"> 1311</span>        Afp, info = trttf(A)</div>
<div class="line"><span class="lineno"> 1312</span>        Achol_rfp, info = pftrf(n, Afp)</div>
<div class="line"><span class="lineno"> 1313</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1314</span>        A_chol_r, _ = tfttr(n, Achol_rfp)</div>
<div class="line"><span class="lineno"> 1315</span>        Achol = cholesky(A)</div>
<div class="line"><span class="lineno"> 1316</span>        assert_array_almost_equal(A_chol_r, Achol)</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6dc8afcc55171e47450dbf0c897c349" name="ab6dc8afcc55171e47450dbf0c897c349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6dc8afcc55171e47450dbf0c897c349">&#9670;&#160;</a></span>test_pftri()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pftri </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test Cholesky factorization of a positive definite Rectengular Full
Packed (RFP) format array to find its inverse
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1319</span><span class="keyword">def </span>test_pftri():</div>
<div class="line"><span class="lineno"> 1320</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1321</span><span class="stringliteral">    Test Cholesky factorization of a positive definite Rectengular Full</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="stringliteral">    Packed (RFP) format array to find its inverse</span></div>
<div class="line"><span class="lineno"> 1323</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1324</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1325</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1326</span>        n = 20</div>
<div class="line"><span class="lineno"> 1327</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1328</span>            A = (rand(n, n) + rand(n, n)*1j).astype(dtype)</div>
<div class="line"><span class="lineno"> 1329</span>            A = A + A.conj().T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1330</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1331</span>            A = (rand(n, n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1332</span>            A = A + A.T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>        pftri, pftrf, trttf, tfttr = get_lapack_funcs((<span class="stringliteral">&#39;pftri&#39;</span>,</div>
<div class="line"><span class="lineno"> 1335</span>                                                       <span class="stringliteral">&#39;pftrf&#39;</span>,</div>
<div class="line"><span class="lineno"> 1336</span>                                                       <span class="stringliteral">&#39;trttf&#39;</span>,</div>
<div class="line"><span class="lineno"> 1337</span>                                                       <span class="stringliteral">&#39;tfttr&#39;</span>),</div>
<div class="line"><span class="lineno"> 1338</span>                                                      dtype=dtype)</div>
<div class="line"><span class="lineno"> 1339</span> </div>
<div class="line"><span class="lineno"> 1340</span>        <span class="comment"># Get the original array from TP</span></div>
<div class="line"><span class="lineno"> 1341</span>        Afp, info = trttf(A)</div>
<div class="line"><span class="lineno"> 1342</span>        A_chol_rfp, info = pftrf(n, Afp)</div>
<div class="line"><span class="lineno"> 1343</span>        A_inv_rfp, info = pftri(n, A_chol_rfp)</div>
<div class="line"><span class="lineno"> 1344</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1345</span>        A_inv_r, _ = tfttr(n, A_inv_rfp)</div>
<div class="line"><span class="lineno"> 1346</span>        Ainv = inv(A)</div>
<div class="line"><span class="lineno"> 1347</span>        assert_array_almost_equal(A_inv_r, triu(Ainv),</div>
<div class="line"><span class="lineno"> 1348</span>                                  decimal=4 <span class="keywordflow">if</span> ind % 2 == 0 <span class="keywordflow">else</span> 6)</div>
<div class="line"><span class="lineno"> 1349</span> </div>
<div class="line"><span class="lineno"> 1350</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afebf9a411a3dea84f5194b21e8fe39ef" name="afebf9a411a3dea84f5194b21e8fe39ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afebf9a411a3dea84f5194b21e8fe39ef">&#9670;&#160;</a></span>test_pftrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pftrs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test Cholesky factorization of a positive definite Rectengular Full
Packed (RFP) format array and solve a linear system
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1351</span><span class="keyword">def </span>test_pftrs():</div>
<div class="line"><span class="lineno"> 1352</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1353</span><span class="stringliteral">    Test Cholesky factorization of a positive definite Rectengular Full</span></div>
<div class="line"><span class="lineno"> 1354</span><span class="stringliteral">    Packed (RFP) format array and solve a linear system</span></div>
<div class="line"><span class="lineno"> 1355</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1356</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1357</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1358</span>        n = 20</div>
<div class="line"><span class="lineno"> 1359</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1360</span>            A = (rand(n, n) + rand(n, n)*1j).astype(dtype)</div>
<div class="line"><span class="lineno"> 1361</span>            A = A + A.conj().T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1362</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1363</span>            A = (rand(n, n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1364</span>            A = A + A.T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1365</span> </div>
<div class="line"><span class="lineno"> 1366</span>        B = ones((n, 3), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1367</span>        Bf1 = ones((n+2, 3), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1368</span>        Bf2 = ones((n-2, 3), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1369</span>        pftrs, pftrf, trttf, tfttr = get_lapack_funcs((<span class="stringliteral">&#39;pftrs&#39;</span>,</div>
<div class="line"><span class="lineno"> 1370</span>                                                       <span class="stringliteral">&#39;pftrf&#39;</span>,</div>
<div class="line"><span class="lineno"> 1371</span>                                                       <span class="stringliteral">&#39;trttf&#39;</span>,</div>
<div class="line"><span class="lineno"> 1372</span>                                                       <span class="stringliteral">&#39;tfttr&#39;</span>),</div>
<div class="line"><span class="lineno"> 1373</span>                                                      dtype=dtype)</div>
<div class="line"><span class="lineno"> 1374</span> </div>
<div class="line"><span class="lineno"> 1375</span>        <span class="comment"># Get the original array from TP</span></div>
<div class="line"><span class="lineno"> 1376</span>        Afp, info = trttf(A)</div>
<div class="line"><span class="lineno"> 1377</span>        A_chol_rfp, info = pftrf(n, Afp)</div>
<div class="line"><span class="lineno"> 1378</span>        <span class="comment"># larger B arrays shouldn&#39;t segfault</span></div>
<div class="line"><span class="lineno"> 1379</span>        soln, info = pftrs(n, A_chol_rfp, Bf1)</div>
<div class="line"><span class="lineno"> 1380</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1381</span>        assert_raises(Exception, pftrs, n, A_chol_rfp, Bf2)</div>
<div class="line"><span class="lineno"> 1382</span>        soln, info = pftrs(n, A_chol_rfp, B)</div>
<div class="line"><span class="lineno"> 1383</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1384</span>        assert_array_almost_equal(solve(A, B), soln,</div>
<div class="line"><span class="lineno"> 1385</span>                                  decimal=4 <span class="keywordflow">if</span> ind % 2 == 0 <span class="keywordflow">else</span> 6)</div>
<div class="line"><span class="lineno"> 1386</span> </div>
<div class="line"><span class="lineno"> 1387</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a011c51021e2790376e7a7b045ee5b14a" name="a011c51021e2790376e7a7b045ee5b14a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a011c51021e2790376e7a7b045ee5b14a">&#9670;&#160;</a></span>test_pptrs_pptri_pptrf_ppsv_ppcon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pptrs_pptri_pptrf_ppsv_ppcon </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lower</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2930</span><span class="keyword">def </span>test_pptrs_pptri_pptrf_ppsv_ppcon(dtype, lower):</div>
<div class="line"><span class="lineno"> 2931</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 2932</span>    atol = np.finfo(dtype).eps*100</div>
<div class="line"><span class="lineno"> 2933</span>    <span class="comment"># Manual conversion to/from packed format is feasible here.</span></div>
<div class="line"><span class="lineno"> 2934</span>    n, nrhs = 10, 4</div>
<div class="line"><span class="lineno"> 2935</span>    a = generate_random_dtype_array([n, n], dtype=dtype)</div>
<div class="line"><span class="lineno"> 2936</span>    b = generate_random_dtype_array([n, nrhs], dtype=dtype)</div>
<div class="line"><span class="lineno"> 2937</span> </div>
<div class="line"><span class="lineno"> 2938</span>    a = a.conj().T + a + np.eye(n, dtype=dtype) * <a class="code hl_namespace" href="namespacedtype.html">dtype</a>(5.)</div>
<div class="line"><span class="lineno"> 2939</span>    <span class="keywordflow">if</span> lower:</div>
<div class="line"><span class="lineno"> 2940</span>        inds = ([x <span class="keywordflow">for</span> y <span class="keywordflow">in</span> range(n) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> range(y, n)],</div>
<div class="line"><span class="lineno"> 2941</span>                [y <span class="keywordflow">for</span> y <span class="keywordflow">in</span> range(n) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> range(y, n)])</div>
<div class="line"><span class="lineno"> 2942</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2943</span>        inds = ([x <span class="keywordflow">for</span> y <span class="keywordflow">in</span> range(1, n+1) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> range(y)],</div>
<div class="line"><span class="lineno"> 2944</span>                [y-1 <span class="keywordflow">for</span> y <span class="keywordflow">in</span> range(1, n+1) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> range(y)])</div>
<div class="line"><span class="lineno"> 2945</span>    ap = a[inds]</div>
<div class="line"><span class="lineno"> 2946</span>    ppsv, pptrf, pptrs, pptri, ppcon = get_lapack_funcs(</div>
<div class="line"><span class="lineno"> 2947</span>        (<span class="stringliteral">&#39;ppsv&#39;</span>, <span class="stringliteral">&#39;pptrf&#39;</span>, <span class="stringliteral">&#39;pptrs&#39;</span>, <span class="stringliteral">&#39;pptri&#39;</span>, <span class="stringliteral">&#39;ppcon&#39;</span>),</div>
<div class="line"><span class="lineno"> 2948</span>        dtype=dtype,</div>
<div class="line"><span class="lineno"> 2949</span>        ilp64=<span class="stringliteral">&quot;preferred&quot;</span>)</div>
<div class="line"><span class="lineno"> 2950</span> </div>
<div class="line"><span class="lineno"> 2951</span>    ul, info = pptrf(n, ap, lower=lower)</div>
<div class="line"><span class="lineno"> 2952</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 2953</span>    aul = cholesky(a, lower=lower)[inds]</div>
<div class="line"><span class="lineno"> 2954</span>    assert_allclose(ul, aul, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 2955</span> </div>
<div class="line"><span class="lineno"> 2956</span>    uli, info = pptri(n, ul, lower=lower)</div>
<div class="line"><span class="lineno"> 2957</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 2958</span>    auli = inv(a)[inds]</div>
<div class="line"><span class="lineno"> 2959</span>    assert_allclose(uli, auli, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 2960</span> </div>
<div class="line"><span class="lineno"> 2961</span>    x, info = pptrs(n, ul, b, lower=lower)</div>
<div class="line"><span class="lineno"> 2962</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 2963</span>    bx = solve(a, b)</div>
<div class="line"><span class="lineno"> 2964</span>    assert_allclose(x, bx, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 2965</span> </div>
<div class="line"><span class="lineno"> 2966</span>    xv, info = ppsv(n, ap, b, lower=lower)</div>
<div class="line"><span class="lineno"> 2967</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 2968</span>    assert_allclose(xv, bx, rtol=0, atol=atol)</div>
<div class="line"><span class="lineno"> 2969</span> </div>
<div class="line"><span class="lineno"> 2970</span>    anorm = np.linalg.norm(a, 1)</div>
<div class="line"><span class="lineno"> 2971</span>    rcond, info = ppcon(n, ap, anorm=anorm, lower=lower)</div>
<div class="line"><span class="lineno"> 2972</span>    assert_equal(info, 0)</div>
<div class="line"><span class="lineno"> 2973</span>    assert_(abs(1/rcond - np.linalg.cond(a, p=1))*rcond &lt; 1)</div>
<div class="line"><span class="lineno"> 2974</span> </div>
<div class="line"><span class="lineno"> 2975</span> </div>
<div class="line"><span class="lineno"> 2976</span><span class="preprocessor">@pytest.mark.parametrize(&#39;dtype&#39;, DTYPES)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1349c0f06a26438599c1773a9952bbe3" name="a1349c0f06a26438599c1773a9952bbe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1349c0f06a26438599c1773a9952bbe3">&#9670;&#160;</a></span>test_pstf2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pstf2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1642</span><span class="keyword">def </span>test_pstf2():</div>
<div class="line"><span class="lineno"> 1643</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1644</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1645</span>        <span class="comment"># DTYPES = &lt;s, d, c, z&gt; pstf2</span></div>
<div class="line"><span class="lineno"> 1646</span>        n = 10</div>
<div class="line"><span class="lineno"> 1647</span>        r = 2</div>
<div class="line"><span class="lineno"> 1648</span>        pstf2 = get_lapack_funcs(<span class="stringliteral">&#39;pstf2&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1649</span> </div>
<div class="line"><span class="lineno"> 1650</span>        <span class="comment"># Create positive semidefinite A</span></div>
<div class="line"><span class="lineno"> 1651</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1652</span>            A = rand(n, n-r).astype(dtype) + 1j * rand(n, n-r).astype(dtype)</div>
<div class="line"><span class="lineno"> 1653</span>            A = A @ A.conj().T</div>
<div class="line"><span class="lineno"> 1654</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1655</span>            A = rand(n, n-r).astype(dtype)</div>
<div class="line"><span class="lineno"> 1656</span>            A = A @ A.T</div>
<div class="line"><span class="lineno"> 1657</span> </div>
<div class="line"><span class="lineno"> 1658</span>        c, piv, r_c, info = pstf2(A)</div>
<div class="line"><span class="lineno"> 1659</span>        U = triu(c)</div>
<div class="line"><span class="lineno"> 1660</span>        U[r_c - n:, r_c - n:] = 0.</div>
<div class="line"><span class="lineno"> 1661</span> </div>
<div class="line"><span class="lineno"> 1662</span>        assert_equal(info, 1)</div>
<div class="line"><span class="lineno"> 1663</span>        <span class="comment"># python-dbg 3.5.2 runs cause trouble with the commented assertions.</span></div>
<div class="line"><span class="lineno"> 1664</span>        <span class="comment"># assert_equal(r_c, n - r)</span></div>
<div class="line"><span class="lineno"> 1665</span>        single_atol = 1000 * np.finfo(np.float32).eps</div>
<div class="line"><span class="lineno"> 1666</span>        double_atol = 1000 * np.finfo(np.float64).eps</div>
<div class="line"><span class="lineno"> 1667</span>        atol = single_atol <span class="keywordflow">if</span> ind <span class="keywordflow">in</span> [0, 2] <span class="keywordflow">else</span> double_atol</div>
<div class="line"><span class="lineno"> 1668</span>        assert_allclose(A[piv-1][:, piv-1], U.conj().T @ U, rtol=0., atol=atol)</div>
<div class="line"><span class="lineno"> 1669</span> </div>
<div class="line"><span class="lineno"> 1670</span>        c, piv, r_c, info = pstf2(A, lower=1)</div>
<div class="line"><span class="lineno"> 1671</span>        L = tril(c)</div>
<div class="line"><span class="lineno"> 1672</span>        L[r_c - n:, r_c - n:] = 0.</div>
<div class="line"><span class="lineno"> 1673</span> </div>
<div class="line"><span class="lineno"> 1674</span>        assert_equal(info, 1)</div>
<div class="line"><span class="lineno"> 1675</span>        <span class="comment"># assert_equal(r_c, n - r)</span></div>
<div class="line"><span class="lineno"> 1676</span>        single_atol = 1000 * np.finfo(np.float32).eps</div>
<div class="line"><span class="lineno"> 1677</span>        double_atol = 1000 * np.finfo(np.float64).eps</div>
<div class="line"><span class="lineno"> 1678</span>        atol = single_atol <span class="keywordflow">if</span> ind <span class="keywordflow">in</span> [0, 2] <span class="keywordflow">else</span> double_atol</div>
<div class="line"><span class="lineno"> 1679</span>        assert_allclose(A[piv-1][:, piv-1], L @ L.conj().T, rtol=0., atol=atol)</div>
<div class="line"><span class="lineno"> 1680</span> </div>
<div class="line"><span class="lineno"> 1681</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e83aa1cd8da88f3a9e2634b1fc8bc29" name="a4e83aa1cd8da88f3a9e2634b1fc8bc29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e83aa1cd8da88f3a9e2634b1fc8bc29">&#9670;&#160;</a></span>test_pstrf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pstrf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1602</span><span class="keyword">def </span>test_pstrf():</div>
<div class="line"><span class="lineno"> 1603</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1604</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1605</span>        <span class="comment"># DTYPES = &lt;s, d, c, z&gt; pstrf</span></div>
<div class="line"><span class="lineno"> 1606</span>        n = 10</div>
<div class="line"><span class="lineno"> 1607</span>        r = 2</div>
<div class="line"><span class="lineno"> 1608</span>        pstrf = get_lapack_funcs(<span class="stringliteral">&#39;pstrf&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>        <span class="comment"># Create positive semidefinite A</span></div>
<div class="line"><span class="lineno"> 1611</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1612</span>            A = rand(n, n-r).astype(dtype) + 1j * rand(n, n-r).astype(dtype)</div>
<div class="line"><span class="lineno"> 1613</span>            A = A @ A.conj().T</div>
<div class="line"><span class="lineno"> 1614</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1615</span>            A = rand(n, n-r).astype(dtype)</div>
<div class="line"><span class="lineno"> 1616</span>            A = A @ A.T</div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>        c, piv, r_c, info = pstrf(A)</div>
<div class="line"><span class="lineno"> 1619</span>        U = triu(c)</div>
<div class="line"><span class="lineno"> 1620</span>        U[r_c - n:, r_c - n:] = 0.</div>
<div class="line"><span class="lineno"> 1621</span> </div>
<div class="line"><span class="lineno"> 1622</span>        assert_equal(info, 1)</div>
<div class="line"><span class="lineno"> 1623</span>        <span class="comment"># python-dbg 3.5.2 runs cause trouble with the following assertion.</span></div>
<div class="line"><span class="lineno"> 1624</span>        <span class="comment"># assert_equal(r_c, n - r)</span></div>
<div class="line"><span class="lineno"> 1625</span>        single_atol = 1000 * np.finfo(np.float32).eps</div>
<div class="line"><span class="lineno"> 1626</span>        double_atol = 1000 * np.finfo(np.float64).eps</div>
<div class="line"><span class="lineno"> 1627</span>        atol = single_atol <span class="keywordflow">if</span> ind <span class="keywordflow">in</span> [0, 2] <span class="keywordflow">else</span> double_atol</div>
<div class="line"><span class="lineno"> 1628</span>        assert_allclose(A[piv-1][:, piv-1], U.conj().T @ U, rtol=0., atol=atol)</div>
<div class="line"><span class="lineno"> 1629</span> </div>
<div class="line"><span class="lineno"> 1630</span>        c, piv, r_c, info = pstrf(A, lower=1)</div>
<div class="line"><span class="lineno"> 1631</span>        L = tril(c)</div>
<div class="line"><span class="lineno"> 1632</span>        L[r_c - n:, r_c - n:] = 0.</div>
<div class="line"><span class="lineno"> 1633</span> </div>
<div class="line"><span class="lineno"> 1634</span>        assert_equal(info, 1)</div>
<div class="line"><span class="lineno"> 1635</span>        <span class="comment"># assert_equal(r_c, n - r)</span></div>
<div class="line"><span class="lineno"> 1636</span>        single_atol = 1000 * np.finfo(np.float32).eps</div>
<div class="line"><span class="lineno"> 1637</span>        double_atol = 1000 * np.finfo(np.float64).eps</div>
<div class="line"><span class="lineno"> 1638</span>        atol = single_atol <span class="keywordflow">if</span> ind <span class="keywordflow">in</span> [0, 2] <span class="keywordflow">else</span> double_atol</div>
<div class="line"><span class="lineno"> 1639</span>        assert_allclose(A[piv-1][:, piv-1], L @ L.conj().T, rtol=0., atol=atol)</div>
<div class="line"><span class="lineno"> 1640</span> </div>
<div class="line"><span class="lineno"> 1641</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a678112f6aa115913acb68ab5ba29b4a9" name="a678112f6aa115913acb68ab5ba29b4a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a678112f6aa115913acb68ab5ba29b4a9">&#9670;&#160;</a></span>test_pteqr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pteqr </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compute_z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Tests the ?pteqr lapack routine for all dtypes and compute_z parameters.
It generates random SPD matrix diagonals d and e, and then confirms
correct eigenvalues with scipy.linalg.eig. With applicable compute_z=2 it
tests that z can reform A.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2309</span><span class="keyword">def </span>test_pteqr(dtype, realtype, compute_z):</div>
<div class="line"><span class="lineno"> 2310</span>    <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2311</span><span class="stringliteral">    Tests the ?pteqr lapack routine for all dtypes and compute_z parameters.</span></div>
<div class="line"><span class="lineno"> 2312</span><span class="stringliteral">    It generates random SPD matrix diagonals d and e, and then confirms</span></div>
<div class="line"><span class="lineno"> 2313</span><span class="stringliteral">    correct eigenvalues with scipy.linalg.eig. With applicable compute_z=2 it</span></div>
<div class="line"><span class="lineno"> 2314</span><span class="stringliteral">    tests that z can reform A.</span></div>
<div class="line"><span class="lineno"> 2315</span><span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2316</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2317</span>    atol = 1000*np.finfo(dtype).eps</div>
<div class="line"><span class="lineno"> 2318</span>    pteqr = get_lapack_funcs((<span class="stringliteral">&#39;pteqr&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2319</span> </div>
<div class="line"><span class="lineno"> 2320</span>    n = 10</div>
<div class="line"><span class="lineno"> 2321</span> </div>
<div class="line"><span class="lineno"> 2322</span>    d, e, A, z = pteqr_get_d_e_A_z(dtype, realtype, n, compute_z)</div>
<div class="line"><span class="lineno"> 2323</span> </div>
<div class="line"><span class="lineno"> 2324</span>    d_pteqr, e_pteqr, z_pteqr, info = pteqr(d=d, e=e, z=z, compute_z=compute_z)</div>
<div class="line"><span class="lineno"> 2325</span>    assert_equal(info, 0, <span class="stringliteral">&quot;info = {}, should be 0.&quot;</span>.format(info))</div>
<div class="line"><span class="lineno"> 2326</span> </div>
<div class="line"><span class="lineno"> 2327</span>    <span class="comment"># compare the routine&#39;s eigenvalues with scipy.linalg.eig&#39;s.</span></div>
<div class="line"><span class="lineno"> 2328</span>    assert_allclose(np.sort(eigh(A)[0]), np.sort(d_pteqr), atol=atol)</div>
<div class="line"><span class="lineno"> 2329</span> </div>
<div class="line"><span class="lineno"> 2330</span>    <span class="keywordflow">if</span> compute_z:</div>
<div class="line"><span class="lineno"> 2331</span>        <span class="comment"># verify z_pteqr as orthogonal</span></div>
<div class="line"><span class="lineno"> 2332</span>        assert_allclose(z_pteqr @ np.conj(z_pteqr).T, np.identity(n),</div>
<div class="line"><span class="lineno"> 2333</span>                        atol=atol)</div>
<div class="line"><span class="lineno"> 2334</span>        <span class="comment"># verify that z_pteqr recombines to A</span></div>
<div class="line"><span class="lineno"> 2335</span>        assert_allclose(z_pteqr @ np.diag(d_pteqr) @ np.conj(z_pteqr).T,</div>
<div class="line"><span class="lineno"> 2336</span>                        A, atol=atol)</div>
<div class="line"><span class="lineno"> 2337</span> </div>
<div class="line"><span class="lineno"> 2338</span> </div>
<div class="line"><span class="lineno"> 2339</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;dtype,realtype&quot;</span>,</div>
<div class="line"><span class="lineno"> 2340</span>                         zip(DTYPES, REAL_DTYPES + REAL_DTYPES))</div>
<div class="line"><span class="lineno"> 2341</span><span class="preprocessor">@pytest.mark.parametrize(&quot;compute_z&quot;, range(3)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2872d1bce66c9e200d297c48557b6f09" name="a2872d1bce66c9e200d297c48557b6f09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2872d1bce66c9e200d297c48557b6f09">&#9670;&#160;</a></span>test_pteqr_error_non_spd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pteqr_error_non_spd </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compute_z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2342</span><span class="keyword">def </span>test_pteqr_error_non_spd(dtype, realtype, compute_z):</div>
<div class="line"><span class="lineno"> 2343</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2344</span>    pteqr = get_lapack_funcs((<span class="stringliteral">&#39;pteqr&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2345</span> </div>
<div class="line"><span class="lineno"> 2346</span>    n = 10</div>
<div class="line"><span class="lineno"> 2347</span>    d, e, A, z = pteqr_get_d_e_A_z(dtype, realtype, n, compute_z)</div>
<div class="line"><span class="lineno"> 2348</span> </div>
<div class="line"><span class="lineno"> 2349</span>    <span class="comment"># test with non-spd matrix</span></div>
<div class="line"><span class="lineno"> 2350</span>    d_pteqr, e_pteqr, z_pteqr, info = pteqr(d - 4, e, z=z, compute_z=compute_z)</div>
<div class="line"><span class="lineno"> 2351</span>    <span class="keyword">assert</span> info &gt; 0</div>
<div class="line"><span class="lineno"> 2352</span> </div>
<div class="line"><span class="lineno"> 2353</span> </div>
<div class="line"><span class="lineno"> 2354</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;dtype,realtype&quot;</span>,</div>
<div class="line"><span class="lineno"> 2355</span>                         zip(DTYPES, REAL_DTYPES + REAL_DTYPES))</div>
<div class="line"><span class="lineno"> 2356</span><span class="preprocessor">@pytest.mark.parametrize(&quot;compute_z&quot;, range(3)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a96726a341a27d96d36b67f0a9a8769d4" name="a96726a341a27d96d36b67f0a9a8769d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96726a341a27d96d36b67f0a9a8769d4">&#9670;&#160;</a></span>test_pteqr_error_singular()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pteqr_error_singular </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compute_z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2372</span><span class="keyword">def </span>test_pteqr_error_singular(dtype, realtype, compute_z):</div>
<div class="line"><span class="lineno"> 2373</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2374</span>    pteqr = get_lapack_funcs((<span class="stringliteral">&#39;pteqr&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2375</span>    n = 10</div>
<div class="line"><span class="lineno"> 2376</span>    d, e, A, z = pteqr_get_d_e_A_z(dtype, realtype, n, compute_z)</div>
<div class="line"><span class="lineno"> 2377</span>    <span class="comment"># test with singular matrix</span></div>
<div class="line"><span class="lineno"> 2378</span>    d[0] = 0</div>
<div class="line"><span class="lineno"> 2379</span>    e[0] = 0</div>
<div class="line"><span class="lineno"> 2380</span>    d_pteqr, e_pteqr, z_pteqr, info = pteqr(d, e, z=z, compute_z=compute_z)</div>
<div class="line"><span class="lineno"> 2381</span>    <span class="keyword">assert</span> info &gt; 0</div>
<div class="line"><span class="lineno"> 2382</span> </div>
<div class="line"><span class="lineno"> 2383</span> </div>
<div class="line"><span class="lineno"> 2384</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;compute_z,d,e,d_expect,z_expect&quot;</span>,</div>
<div class="line"><span class="lineno"> 2385</span>                         [(2,  <span class="comment"># &quot;I&quot;</span></div>
<div class="line"><span class="lineno"> 2386</span>                           np.array([4.16, 5.25, 1.09, .62]),</div>
<div class="line"><span class="lineno"> 2387</span>                           np.array([3.17, -.97, .55]),</div>
<div class="line"><span class="lineno"> 2388</span>                           np.array([8.0023, 1.9926, 1.0014, 0.1237]),</div>
<div class="line"><span class="lineno"> 2389</span>                           np.array([[0.6326, 0.6245, -0.4191, 0.1847],</div>
<div class="line"><span class="lineno"> 2390</span>                                     [0.7668, -0.4270, 0.4176, -0.2352],</div>
<div class="line"><span class="lineno"> 2391</span>                                     [-0.1082, 0.6071, 0.4594, -0.6393],</div>
<div class="line"><span class="lineno"> 2392</span>                                     [-0.0081, 0.2432, 0.6625, 0.7084]])),</div>
<div class="line"><span class="lineno"> 2393</span>                          ])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d67b7ca946fcc5d1a4f9c7a5de3568d" name="a9d67b7ca946fcc5d1a4f9c7a5de3568d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d67b7ca946fcc5d1a4f9c7a5de3568d">&#9670;&#160;</a></span>test_pteqr_NAG_f08jgf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pteqr_NAG_f08jgf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compute_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_expect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z_expect</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Implements real (f08jgf) example from NAG Manual Mark 26.
Tests for correct outputs.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2394</span><span class="keyword">def </span>test_pteqr_NAG_f08jgf(compute_z, d, e, d_expect, z_expect):</div>
<div class="line"><span class="lineno"> 2395</span>    <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2396</span><span class="stringliteral">    Implements real (f08jgf) example from NAG Manual Mark 26.</span></div>
<div class="line"><span class="lineno"> 2397</span><span class="stringliteral">    Tests for correct outputs.</span></div>
<div class="line"><span class="lineno"> 2398</span><span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2399</span>    <span class="comment"># the NAG manual has 4 decimals accuracy</span></div>
<div class="line"><span class="lineno"> 2400</span>    atol = 1e-4</div>
<div class="line"><span class="lineno"> 2401</span>    pteqr = get_lapack_funcs((<span class="stringliteral">&#39;pteqr&#39;</span>), dtype=d.dtype)</div>
<div class="line"><span class="lineno"> 2402</span> </div>
<div class="line"><span class="lineno"> 2403</span>    z = np.diag(d) + np.diag(e, 1) + np.diag(e, -1)</div>
<div class="line"><span class="lineno"> 2404</span>    _d, _e, _z, info = pteqr(d=d, e=e, z=z, compute_z=compute_z)</div>
<div class="line"><span class="lineno"> 2405</span>    assert_allclose(_d, d_expect, atol=atol)</div>
<div class="line"><span class="lineno"> 2406</span>    assert_allclose(np.abs(_z), np.abs(z_expect), atol=atol)</div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span> </div>
<div class="line"><span class="lineno"> 2409</span><span class="preprocessor">@pytest.mark.parametrize(&#39;dtype&#39;, DTYPES)</span></div>
<div class="line"><span class="lineno"> 2410</span><span class="preprocessor">@pytest.mark.parametrize(&#39;matrix_size&#39;, [(3, 4)</span>, (7, 6), (6, 6)])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6df6e97dd1cadcc709043653a453186a" name="a6df6e97dd1cadcc709043653a453186a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df6e97dd1cadcc709043653a453186a">&#9670;&#160;</a></span>test_pteqr_raise_error_wrong_shape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pteqr_raise_error_wrong_shape </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compute_z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2357</span><span class="keyword">def </span>test_pteqr_raise_error_wrong_shape(dtype, realtype, compute_z):</div>
<div class="line"><span class="lineno"> 2358</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2359</span>    pteqr = get_lapack_funcs((<span class="stringliteral">&#39;pteqr&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2360</span>    n = 10</div>
<div class="line"><span class="lineno"> 2361</span>    d, e, A, z = pteqr_get_d_e_A_z(dtype, realtype, n, compute_z)</div>
<div class="line"><span class="lineno"> 2362</span>    <span class="comment"># test with incorrect/incompatible array sizes</span></div>
<div class="line"><span class="lineno"> 2363</span>    assert_raises(ValueError, pteqr, d[:-1], e, z=z, compute_z=compute_z)</div>
<div class="line"><span class="lineno"> 2364</span>    assert_raises(ValueError, pteqr, d, e[:-1], z=z, compute_z=compute_z)</div>
<div class="line"><span class="lineno"> 2365</span>    <span class="keywordflow">if</span> compute_z:</div>
<div class="line"><span class="lineno"> 2366</span>        assert_raises(ValueError, pteqr, d, e, z=z[:-1], compute_z=compute_z)</div>
<div class="line"><span class="lineno"> 2367</span> </div>
<div class="line"><span class="lineno"> 2368</span> </div>
<div class="line"><span class="lineno"> 2369</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;dtype,realtype&quot;</span>,</div>
<div class="line"><span class="lineno"> 2370</span>                         zip(DTYPES, REAL_DTYPES + REAL_DTYPES))</div>
<div class="line"><span class="lineno"> 2371</span><span class="preprocessor">@pytest.mark.parametrize(&quot;compute_z&quot;, range(3)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a6043b5e29d58f551fe2872a0ce8d10" name="a6a6043b5e29d58f551fe2872a0ce8d10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a6043b5e29d58f551fe2872a0ce8d10">&#9670;&#160;</a></span>test_ptsvx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_ptsvx </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df_de_lambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This tests the ?ptsvx lapack routine wrapper to solve a random system
Ax = b for all dtypes and input variations. Tests for: unmodified
input parameters, fact options, incompatible matrix shapes raise an error,
and singular matrices return info of illegal value.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2775</span><span class="keyword">def </span>test_ptsvx(dtype, realtype, fact, df_de_lambda):</div>
<div class="line"><span class="lineno"> 2776</span>    <span class="stringliteral">&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2777</span><span class="stringliteral">    This tests the ?ptsvx lapack routine wrapper to solve a random system</span></div>
<div class="line"><span class="lineno"> 2778</span><span class="stringliteral">    Ax = b for all dtypes and input variations. Tests for: unmodified</span></div>
<div class="line"><span class="lineno"> 2779</span><span class="stringliteral">    input parameters, fact options, incompatible matrix shapes raise an error,</span></div>
<div class="line"><span class="lineno"> 2780</span><span class="stringliteral">    and singular matrices return info of illegal value.</span></div>
<div class="line"><span class="lineno"> 2781</span><span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 2782</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2783</span>    <span class="comment"># set test tolerance appropriate for dtype</span></div>
<div class="line"><span class="lineno"> 2784</span>    atol = 100 * np.finfo(dtype).eps</div>
<div class="line"><span class="lineno"> 2785</span>    ptsvx = get_lapack_funcs(<span class="stringliteral">&#39;ptsvx&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 2786</span>    n = 5</div>
<div class="line"><span class="lineno"> 2787</span>    <span class="comment"># create diagonals according to size and dtype</span></div>
<div class="line"><span class="lineno"> 2788</span>    d = generate_random_dtype_array((n,), realtype) + 4</div>
<div class="line"><span class="lineno"> 2789</span>    e = generate_random_dtype_array((n-1,), dtype)</div>
<div class="line"><span class="lineno"> 2790</span>    A = np.diag(d) + np.diag(e, -1) + np.diag(np.conj(e), 1)</div>
<div class="line"><span class="lineno"> 2791</span>    x_soln = generate_random_dtype_array((n, 2), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2792</span>    b = A @ x_soln</div>
<div class="line"><span class="lineno"> 2793</span> </div>
<div class="line"><span class="lineno"> 2794</span>    <span class="comment"># use lambda to determine what df, ef are</span></div>
<div class="line"><span class="lineno"> 2795</span>    df, ef, info = df_de_lambda(d, e)</div>
<div class="line"><span class="lineno"> 2796</span> </div>
<div class="line"><span class="lineno"> 2797</span>    <span class="comment"># create copy to later test that they are unmodified</span></div>
<div class="line"><span class="lineno"> 2798</span>    diag_cpy = [d.copy(), e.copy(), b.copy()]</div>
<div class="line"><span class="lineno"> 2799</span> </div>
<div class="line"><span class="lineno"> 2800</span>    <span class="comment"># solve using routine</span></div>
<div class="line"><span class="lineno"> 2801</span>    df, ef, x, rcond, ferr, berr, info = ptsvx(d, e, b, fact=fact,</div>
<div class="line"><span class="lineno"> 2802</span>                                               df=df, ef=ef)</div>
<div class="line"><span class="lineno"> 2803</span>    <span class="comment"># d, e, and b should be unmodified</span></div>
<div class="line"><span class="lineno"> 2804</span>    assert_array_equal(d, diag_cpy[0])</div>
<div class="line"><span class="lineno"> 2805</span>    assert_array_equal(e, diag_cpy[1])</div>
<div class="line"><span class="lineno"> 2806</span>    assert_array_equal(b, diag_cpy[2])</div>
<div class="line"><span class="lineno"> 2807</span>    assert_(info == 0, <span class="stringliteral">&quot;info should be 0 but is {}.&quot;</span>.format(info))</div>
<div class="line"><span class="lineno"> 2808</span>    assert_array_almost_equal(x_soln, x)</div>
<div class="line"><span class="lineno"> 2809</span> </div>
<div class="line"><span class="lineno"> 2810</span>    <span class="comment"># test that the factors from ptsvx can be recombined to make A</span></div>
<div class="line"><span class="lineno"> 2811</span>    L = np.diag(ef, -1) + np.diag(np.ones(n))</div>
<div class="line"><span class="lineno"> 2812</span>    D = np.diag(df)</div>
<div class="line"><span class="lineno"> 2813</span>    assert_allclose(A, L<span class="preprocessor">@D</span>@(np.conj(L).T), atol=atol)</div>
<div class="line"><span class="lineno"> 2814</span> </div>
<div class="line"><span class="lineno"> 2815</span>    <span class="comment"># assert that the outputs are of correct type or shape</span></div>
<div class="line"><span class="lineno"> 2816</span>    <span class="comment"># rcond should be a scalar</span></div>
<div class="line"><span class="lineno"> 2817</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> hasattr(rcond, <span class="stringliteral">&quot;__len__&quot;</span>), \</div>
<div class="line"><span class="lineno"> 2818</span>        <span class="stringliteral">&quot;rcond should be scalar but is {}&quot;</span>.format(rcond)</div>
<div class="line"><span class="lineno"> 2819</span>    <span class="comment"># ferr should be length of # of cols in x</span></div>
<div class="line"><span class="lineno"> 2820</span>    assert_(ferr.shape == (2,), <span class="stringliteral">&quot;ferr.shape is {} but shoud be ({},)&quot;</span></div>
<div class="line"><span class="lineno"> 2821</span>            .format(ferr.shape, x_soln.shape[1]))</div>
<div class="line"><span class="lineno"> 2822</span>    <span class="comment"># berr should be length of # of cols in x</span></div>
<div class="line"><span class="lineno"> 2823</span>    assert_(berr.shape == (2,), <span class="stringliteral">&quot;berr.shape is {} but shoud be ({},)&quot;</span></div>
<div class="line"><span class="lineno"> 2824</span>            .format(berr.shape, x_soln.shape[1]))</div>
<div class="line"><span class="lineno"> 2825</span> </div>
<div class="line"><span class="lineno"> 2826</span> </div>
<div class="line"><span class="lineno"> 2827</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;dtype,realtype&quot;</span>, zip(DTYPES, REAL_DTYPES</div>
<div class="line"><span class="lineno"> 2828</span>                                               + REAL_DTYPES))</div>
<div class="line"><span class="lineno"> 2829</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;fact,df_de_lambda&quot;</span>,</div>
<div class="line"><span class="lineno"> 2830</span>                         [(<span class="stringliteral">&quot;F&quot;</span>,</div>
<div class="line"><span class="lineno"> 2831</span>                           <span class="keyword">lambda</span> d, e:get_lapack_funcs(<span class="stringliteral">&#39;pttrf&#39;</span>,</div>
<div class="line"><span class="lineno"> 2832</span>                                                        dtype=e.dtype)(d, e)),</div>
<div class="line"><span class="lineno"> 2833</span>                          (<span class="stringliteral">&quot;N&quot;</span>, <span class="keyword">lambda</span> d, e: (<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>))])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14b85594f0a42640eb2c1c9a4f14233c" name="a14b85594f0a42640eb2c1c9a4f14233c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b85594f0a42640eb2c1c9a4f14233c">&#9670;&#160;</a></span>test_ptsvx_error_raise_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_ptsvx_error_raise_errors </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df_de_lambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2834</span><span class="keyword">def </span>test_ptsvx_error_raise_errors(dtype, realtype, fact, df_de_lambda):</div>
<div class="line"><span class="lineno"> 2835</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2836</span>    ptsvx = get_lapack_funcs(<span class="stringliteral">&#39;ptsvx&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 2837</span>    n = 5</div>
<div class="line"><span class="lineno"> 2838</span>    <span class="comment"># create diagonals according to size and dtype</span></div>
<div class="line"><span class="lineno"> 2839</span>    d = generate_random_dtype_array((n,), realtype) + 4</div>
<div class="line"><span class="lineno"> 2840</span>    e = generate_random_dtype_array((n-1,), dtype)</div>
<div class="line"><span class="lineno"> 2841</span>    A = np.diag(d) + np.diag(e, -1) + np.diag(np.conj(e), 1)</div>
<div class="line"><span class="lineno"> 2842</span>    x_soln = generate_random_dtype_array((n, 2), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2843</span>    b = A @ x_soln</div>
<div class="line"><span class="lineno"> 2844</span> </div>
<div class="line"><span class="lineno"> 2845</span>    <span class="comment"># use lambda to determine what df, ef are</span></div>
<div class="line"><span class="lineno"> 2846</span>    df, ef, info = df_de_lambda(d, e)</div>
<div class="line"><span class="lineno"> 2847</span> </div>
<div class="line"><span class="lineno"> 2848</span>    <span class="comment"># test with malformatted array sizes</span></div>
<div class="line"><span class="lineno"> 2849</span>    assert_raises(ValueError, ptsvx, d[:-1], e, b, fact=fact, df=df, ef=ef)</div>
<div class="line"><span class="lineno"> 2850</span>    assert_raises(ValueError, ptsvx, d, e[:-1], b, fact=fact, df=df, ef=ef)</div>
<div class="line"><span class="lineno"> 2851</span>    assert_raises(Exception, ptsvx, d, e, b[:-1], fact=fact, df=df, ef=ef)</div>
<div class="line"><span class="lineno"> 2852</span> </div>
<div class="line"><span class="lineno"> 2853</span> </div>
<div class="line"><span class="lineno"> 2854</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;dtype,realtype&quot;</span>, zip(DTYPES, REAL_DTYPES</div>
<div class="line"><span class="lineno"> 2855</span>                                               + REAL_DTYPES))</div>
<div class="line"><span class="lineno"> 2856</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;fact,df_de_lambda&quot;</span>,</div>
<div class="line"><span class="lineno"> 2857</span>                         [(<span class="stringliteral">&quot;F&quot;</span>,</div>
<div class="line"><span class="lineno"> 2858</span>                           <span class="keyword">lambda</span> d, e:get_lapack_funcs(<span class="stringliteral">&#39;pttrf&#39;</span>,</div>
<div class="line"><span class="lineno"> 2859</span>                                                        dtype=e.dtype)(d, e)),</div>
<div class="line"><span class="lineno"> 2860</span>                          (<span class="stringliteral">&quot;N&quot;</span>, <span class="keyword">lambda</span> d, e: (<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>))])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6adaf7bcc4d43ee43d056c10c986b874" name="a6adaf7bcc4d43ee43d056c10c986b874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6adaf7bcc4d43ee43d056c10c986b874">&#9670;&#160;</a></span>test_ptsvx_NAG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_ptsvx_NAG </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2915</span><span class="keyword">def </span>test_ptsvx_NAG(d, e, b, x):</div>
<div class="line"><span class="lineno"> 2916</span>    <span class="comment"># test to assure that wrapper is consistent with NAG Manual Mark 26</span></div>
<div class="line"><span class="lineno"> 2917</span>    <span class="comment"># example problemss: f07jbf, f07jpf</span></div>
<div class="line"><span class="lineno"> 2918</span>    <span class="comment"># (Links expire, so please search for &quot;NAG Library Manual Mark 26&quot; online)</span></div>
<div class="line"><span class="lineno"> 2919</span> </div>
<div class="line"><span class="lineno"> 2920</span>    <span class="comment"># obtain routine with correct type based on e.dtype</span></div>
<div class="line"><span class="lineno"> 2921</span>    ptsvx = get_lapack_funcs(<span class="stringliteral">&#39;ptsvx&#39;</span>, dtype=e.dtype)</div>
<div class="line"><span class="lineno"> 2922</span>    <span class="comment"># solve using routine</span></div>
<div class="line"><span class="lineno"> 2923</span>    df, ef, x_ptsvx, rcond, ferr, berr, info = ptsvx(d, e, b)</div>
<div class="line"><span class="lineno"> 2924</span>    <span class="comment"># determine ptsvx&#39;s solution and x are the same.</span></div>
<div class="line"><span class="lineno"> 2925</span>    assert_array_almost_equal(x, x_ptsvx)</div>
<div class="line"><span class="lineno"> 2926</span> </div>
<div class="line"><span class="lineno"> 2927</span> </div>
<div class="line"><span class="lineno"> 2928</span><span class="preprocessor">@pytest.mark.parametrize(&#39;lower&#39;, [False, True])</span></div>
<div class="line"><span class="lineno"> 2929</span><span class="preprocessor">@pytest.mark.parametrize(&#39;dtype&#39;, DTYPES)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1048c52178f29b094282d14d4c2f1ec2" name="a1048c52178f29b094282d14d4c2f1ec2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1048c52178f29b094282d14d4c2f1ec2">&#9670;&#160;</a></span>test_ptsvx_non_SPD_singular()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_ptsvx_non_SPD_singular </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df_de_lambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2861</span><span class="keyword">def </span>test_ptsvx_non_SPD_singular(dtype, realtype, fact, df_de_lambda):</div>
<div class="line"><span class="lineno"> 2862</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2863</span>    ptsvx = get_lapack_funcs(<span class="stringliteral">&#39;ptsvx&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 2864</span>    n = 5</div>
<div class="line"><span class="lineno"> 2865</span>    <span class="comment"># create diagonals according to size and dtype</span></div>
<div class="line"><span class="lineno"> 2866</span>    d = generate_random_dtype_array((n,), realtype) + 4</div>
<div class="line"><span class="lineno"> 2867</span>    e = generate_random_dtype_array((n-1,), dtype)</div>
<div class="line"><span class="lineno"> 2868</span>    A = np.diag(d) + np.diag(e, -1) + np.diag(np.conj(e), 1)</div>
<div class="line"><span class="lineno"> 2869</span>    x_soln = generate_random_dtype_array((n, 2), dtype=dtype)</div>
<div class="line"><span class="lineno"> 2870</span>    b = A @ x_soln</div>
<div class="line"><span class="lineno"> 2871</span> </div>
<div class="line"><span class="lineno"> 2872</span>    <span class="comment"># use lambda to determine what df, ef are</span></div>
<div class="line"><span class="lineno"> 2873</span>    df, ef, info = df_de_lambda(d, e)</div>
<div class="line"><span class="lineno"> 2874</span> </div>
<div class="line"><span class="lineno"> 2875</span>    <span class="keywordflow">if</span> fact == <span class="stringliteral">&quot;N&quot;</span>:</div>
<div class="line"><span class="lineno"> 2876</span>        d[3] = 0</div>
<div class="line"><span class="lineno"> 2877</span>        <span class="comment"># obtain new df, ef</span></div>
<div class="line"><span class="lineno"> 2878</span>        df, ef, info = df_de_lambda(d, e)</div>
<div class="line"><span class="lineno"> 2879</span>        <span class="comment"># solve using routine</span></div>
<div class="line"><span class="lineno"> 2880</span>        df, ef, x, rcond, ferr, berr, info = ptsvx(d, e, b)</div>
<div class="line"><span class="lineno"> 2881</span>        <span class="comment"># test for the singular matrix.</span></div>
<div class="line"><span class="lineno"> 2882</span>        <span class="keyword">assert</span> info &gt; 0 <span class="keywordflow">and</span> info &lt;= n</div>
<div class="line"><span class="lineno"> 2883</span> </div>
<div class="line"><span class="lineno"> 2884</span>        <span class="comment"># non SPD matrix</span></div>
<div class="line"><span class="lineno"> 2885</span>        d = generate_random_dtype_array((n,), realtype)</div>
<div class="line"><span class="lineno"> 2886</span>        df, ef, x, rcond, ferr, berr, info = ptsvx(d, e, b)</div>
<div class="line"><span class="lineno"> 2887</span>        <span class="keyword">assert</span> info &gt; 0 <span class="keywordflow">and</span> info &lt;= n</div>
<div class="line"><span class="lineno"> 2888</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2889</span>        <span class="comment"># assuming that someone is using a singular factorization</span></div>
<div class="line"><span class="lineno"> 2890</span>        df, ef, info = df_de_lambda(d, e)</div>
<div class="line"><span class="lineno"> 2891</span>        df[0] = 0</div>
<div class="line"><span class="lineno"> 2892</span>        ef[0] = 0</div>
<div class="line"><span class="lineno"> 2893</span>        df, ef, x, rcond, ferr, berr, info = ptsvx(d, e, b, fact=fact,</div>
<div class="line"><span class="lineno"> 2894</span>                                                   df=df, ef=ef)</div>
<div class="line"><span class="lineno"> 2895</span>        <span class="keyword">assert</span> info &gt; 0</div>
<div class="line"><span class="lineno"> 2896</span> </div>
<div class="line"><span class="lineno"> 2897</span> </div>
<div class="line"><span class="lineno"> 2898</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&#39;d,e,b,x&#39;</span>,</div>
<div class="line"><span class="lineno"> 2899</span>                         [(np.array([4, 10, 29, 25, 5]),</div>
<div class="line"><span class="lineno"> 2900</span>                           np.array([-2, -6, 15, 8]),</div>
<div class="line"><span class="lineno"> 2901</span>                           np.array([[6, 10], [9, 4], [2, 9], [14, 65],</div>
<div class="line"><span class="lineno"> 2902</span>                                     [7, 23]]),</div>
<div class="line"><span class="lineno"> 2903</span>                           np.array([[2.5, 2], [2, -1], [1, -3],</div>
<div class="line"><span class="lineno"> 2904</span>                                     [-1, 6], [3, -5]])),</div>
<div class="line"><span class="lineno"> 2905</span>                          (np.array([16, 41, 46, 21]),</div>
<div class="line"><span class="lineno"> 2906</span>                           np.array([16 + 16j, 18 - 9j, 1 - 4j]),</div>
<div class="line"><span class="lineno"> 2907</span>                           np.array([[64 + 16j, -16 - 32j],</div>
<div class="line"><span class="lineno"> 2908</span>                                     [93 + 62j, 61 - 66j],</div>
<div class="line"><span class="lineno"> 2909</span>                                     [78 - 80j, 71 - 74j],</div>
<div class="line"><span class="lineno"> 2910</span>                                     [14 - 27j, 35 + 15j]]),</div>
<div class="line"><span class="lineno"> 2911</span>                           np.array([[2 + 1j, -3 - 2j],</div>
<div class="line"><span class="lineno"> 2912</span>                                     [1 + 1j, 1 + 1j],</div>
<div class="line"><span class="lineno"> 2913</span>                                     [1 - 2j, 1 - 2j],</div>
<div class="line"><span class="lineno"> 2914</span>                                     [1 - 1j, 2 + 1j]]))])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d6c60d396b5ba30aa13b12f363ee6b0" name="a6d6c60d396b5ba30aa13b12f363ee6b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6c60d396b5ba30aa13b12f363ee6b0">&#9670;&#160;</a></span>test_pttrf_pttrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pttrf_pttrs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ddtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2153</span><span class="keyword">def </span>test_pttrf_pttrs(ddtype, dtype):</div>
<div class="line"><span class="lineno"> 2154</span>    seed(42)</div>
<div class="line"><span class="lineno"> 2155</span>    <span class="comment"># set test tolerance appropriate for dtype</span></div>
<div class="line"><span class="lineno"> 2156</span>    atol = 100*np.finfo(dtype).eps</div>
<div class="line"><span class="lineno"> 2157</span>    <span class="comment"># n is the length diagonal of A</span></div>
<div class="line"><span class="lineno"> 2158</span>    n = 10</div>
<div class="line"><span class="lineno"> 2159</span>    <span class="comment"># create diagonals according to size and dtype</span></div>
<div class="line"><span class="lineno"> 2160</span> </div>
<div class="line"><span class="lineno"> 2161</span>    <span class="comment"># diagonal d should always be real.</span></div>
<div class="line"><span class="lineno"> 2162</span>    <span class="comment"># add 4 to d so it will be dominant for all dtypes</span></div>
<div class="line"><span class="lineno"> 2163</span>    d = generate_random_dtype_array((n,), ddtype) + 4</div>
<div class="line"><span class="lineno"> 2164</span>    <span class="comment"># diagonal e may be real or complex.</span></div>
<div class="line"><span class="lineno"> 2165</span>    e = generate_random_dtype_array((n-1,), dtype)</div>
<div class="line"><span class="lineno"> 2166</span> </div>
<div class="line"><span class="lineno"> 2167</span>    <span class="comment"># assemble diagonals together into matrix</span></div>
<div class="line"><span class="lineno"> 2168</span>    A = np.diag(d) + np.diag(e, -1) + np.diag(np.conj(e), 1)</div>
<div class="line"><span class="lineno"> 2169</span>    <span class="comment"># store a copy of diagonals to later verify</span></div>
<div class="line"><span class="lineno"> 2170</span>    diag_cpy = [d.copy(), e.copy()]</div>
<div class="line"><span class="lineno"> 2171</span> </div>
<div class="line"><span class="lineno"> 2172</span>    pttrf = get_lapack_funcs(<span class="stringliteral">&#39;pttrf&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 2173</span> </div>
<div class="line"><span class="lineno"> 2174</span>    _d, _e, info = pttrf(d, e)</div>
<div class="line"><span class="lineno"> 2175</span>    <span class="comment"># test to assure that the inputs of ?pttrf are unmodified</span></div>
<div class="line"><span class="lineno"> 2176</span>    assert_array_equal(d, diag_cpy[0])</div>
<div class="line"><span class="lineno"> 2177</span>    assert_array_equal(e, diag_cpy[1])</div>
<div class="line"><span class="lineno"> 2178</span>    assert_equal(info, 0, err_msg=<span class="stringliteral">&quot;pttrf: info = {}, should be 0&quot;</span>.format(info))</div>
<div class="line"><span class="lineno"> 2179</span> </div>
<div class="line"><span class="lineno"> 2180</span>    <span class="comment"># test that the factors from pttrf can be recombined to make A</span></div>
<div class="line"><span class="lineno"> 2181</span>    L = np.diag(_e, -1) + np.diag(np.ones(n))</div>
<div class="line"><span class="lineno"> 2182</span>    D = np.diag(_d)</div>
<div class="line"><span class="lineno"> 2183</span> </div>
<div class="line"><span class="lineno"> 2184</span>    assert_allclose(A, L<span class="preprocessor">@D</span><span class="preprocessor">@L.conjugate()</span>.T, atol=atol)</div>
<div class="line"><span class="lineno"> 2185</span> </div>
<div class="line"><span class="lineno"> 2186</span>    <span class="comment"># generate random solution x</span></div>
<div class="line"><span class="lineno"> 2187</span>    x = generate_random_dtype_array((n,), dtype)</div>
<div class="line"><span class="lineno"> 2188</span>    <span class="comment"># determine accompanying b to get soln x</span></div>
<div class="line"><span class="lineno"> 2189</span>    b = A<span class="preprocessor">@x</span></div>
<div class="line"><span class="lineno"> 2190</span> </div>
<div class="line"><span class="lineno"> 2191</span>    <span class="comment"># determine _x from pttrs</span></div>
<div class="line"><span class="lineno"> 2192</span>    pttrs = get_lapack_funcs(<span class="stringliteral">&#39;pttrs&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 2193</span>    _x, info = pttrs(_d, _e.conj(), b)</div>
<div class="line"><span class="lineno"> 2194</span>    assert_equal(info, 0, err_msg=<span class="stringliteral">&quot;pttrs: info = {}, should be 0&quot;</span>.format(info))</div>
<div class="line"><span class="lineno"> 2195</span> </div>
<div class="line"><span class="lineno"> 2196</span>    <span class="comment"># test that _x from pttrs matches the expected x</span></div>
<div class="line"><span class="lineno"> 2197</span>    assert_allclose(x, _x, atol=atol)</div>
<div class="line"><span class="lineno"> 2198</span> </div>
<div class="line"><span class="lineno"> 2199</span> </div>
<div class="line"><span class="lineno"> 2200</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;ddtype,dtype&quot;</span>,</div>
<div class="line"><span class="lineno"> 2201</span>                         zip(REAL_DTYPES + REAL_DTYPES, DTYPES))</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b3cdf0f962def70069051653d6ec01f" name="a2b3cdf0f962def70069051653d6ec01f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b3cdf0f962def70069051653d6ec01f">&#9670;&#160;</a></span>test_pttrf_pttrs_errors_incompatible_shape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pttrf_pttrs_errors_incompatible_shape </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ddtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2202</span><span class="keyword">def </span>test_pttrf_pttrs_errors_incompatible_shape(ddtype, dtype):</div>
<div class="line"><span class="lineno"> 2203</span>    n = 10</div>
<div class="line"><span class="lineno"> 2204</span>    pttrf = get_lapack_funcs(<span class="stringliteral">&#39;pttrf&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 2205</span>    d = generate_random_dtype_array((n,), ddtype) + 2</div>
<div class="line"><span class="lineno"> 2206</span>    e = generate_random_dtype_array((n-1,), dtype)</div>
<div class="line"><span class="lineno"> 2207</span>    <span class="comment"># test that ValueError is raised with incompatible matrix shapes</span></div>
<div class="line"><span class="lineno"> 2208</span>    assert_raises(ValueError, pttrf, d[:-1], e)</div>
<div class="line"><span class="lineno"> 2209</span>    assert_raises(ValueError, pttrf, d, e[:-1])</div>
<div class="line"><span class="lineno"> 2210</span> </div>
<div class="line"><span class="lineno"> 2211</span> </div>
<div class="line"><span class="lineno"> 2212</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;ddtype,dtype&quot;</span>,</div>
<div class="line"><span class="lineno"> 2213</span>                         zip(REAL_DTYPES + REAL_DTYPES, DTYPES))</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab09b6b00107285bcbc234534e9e772de" name="ab09b6b00107285bcbc234534e9e772de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab09b6b00107285bcbc234534e9e772de">&#9670;&#160;</a></span>test_pttrf_pttrs_errors_singular_nonSPD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pttrf_pttrs_errors_singular_nonSPD </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ddtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2214</span><span class="keyword">def </span>test_pttrf_pttrs_errors_singular_nonSPD(ddtype, dtype):</div>
<div class="line"><span class="lineno"> 2215</span>    n = 10</div>
<div class="line"><span class="lineno"> 2216</span>    pttrf = get_lapack_funcs(<span class="stringliteral">&#39;pttrf&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 2217</span>    d = generate_random_dtype_array((n,), ddtype) + 2</div>
<div class="line"><span class="lineno"> 2218</span>    e = generate_random_dtype_array((n-1,), dtype)</div>
<div class="line"><span class="lineno"> 2219</span>    <span class="comment"># test that singular (row of all zeroes) matrix fails via info</span></div>
<div class="line"><span class="lineno"> 2220</span>    d[0] = 0</div>
<div class="line"><span class="lineno"> 2221</span>    e[0] = 0</div>
<div class="line"><span class="lineno"> 2222</span>    _d, _e, info = pttrf(d, e)</div>
<div class="line"><span class="lineno"> 2223</span>    assert_equal(_d[info - 1], 0,</div>
<div class="line"><span class="lineno"> 2224</span>                 <span class="stringliteral">&quot;?pttrf: _d[info-1] is {}, not the illegal value :0.&quot;</span></div>
<div class="line"><span class="lineno"> 2225</span>                 .format(_d[info - 1]))</div>
<div class="line"><span class="lineno"> 2226</span> </div>
<div class="line"><span class="lineno"> 2227</span>    <span class="comment"># test with non-spd matrix</span></div>
<div class="line"><span class="lineno"> 2228</span>    d = generate_random_dtype_array((n,), ddtype)</div>
<div class="line"><span class="lineno"> 2229</span>    _d, _e, info = pttrf(d, e)</div>
<div class="line"><span class="lineno"> 2230</span>    assert_(info != 0, <span class="stringliteral">&quot;?pttrf should fail with non-spd matrix, but didn&#39;t&quot;</span>)</div>
<div class="line"><span class="lineno"> 2231</span> </div>
<div class="line"><span class="lineno"> 2232</span> </div>
<div class="line"><span class="lineno"> 2233</span><span class="preprocessor">@pytest.mark.parametrize((&quot;d, e, d_expect, e_expect, b, x_expect&quot;)</span>, [</div>
<div class="line"><span class="lineno"> 2234</span>                         (np.array([4, 10, 29, 25, 5]),</div>
<div class="line"><span class="lineno"> 2235</span>                          np.array([-2, -6, 15, 8]),</div>
<div class="line"><span class="lineno"> 2236</span>                          np.array([4, 9, 25, 16, 1]),</div>
<div class="line"><span class="lineno"> 2237</span>                          np.array([-.5, -.6667, .6, .5]),</div>
<div class="line"><span class="lineno"> 2238</span>                          np.array([[6, 10], [9, 4], [2, 9], [14, 65],</div>
<div class="line"><span class="lineno"> 2239</span>                                    [7, 23]]),</div>
<div class="line"><span class="lineno"> 2240</span>                          np.array([[2.5, 2], [2, -1], [1, -3], [-1, 6],</div>
<div class="line"><span class="lineno"> 2241</span>                                    [3, -5]])</div>
<div class="line"><span class="lineno"> 2242</span>                          ), (</div>
<div class="line"><span class="lineno"> 2243</span>                          np.array([16, 41, 46, 21]),</div>
<div class="line"><span class="lineno"> 2244</span>                          np.array([16 + 16j, 18 - 9j, 1 - 4j]),</div>
<div class="line"><span class="lineno"> 2245</span>                          np.array([16, 9, 1, 4]),</div>
<div class="line"><span class="lineno"> 2246</span>                          np.array([1+1j, 2-1j, 1-4j]),</div>
<div class="line"><span class="lineno"> 2247</span>                          np.array([[64+16j, -16-32j], [93+62j, 61-66j],</div>
<div class="line"><span class="lineno"> 2248</span>                                    [78-80j, 71-74j], [14-27j, 35+15j]]),</div>
<div class="line"><span class="lineno"> 2249</span>                          np.array([[2+1j, -3-2j], [1+1j, 1+1j], [1-2j, 1-2j],</div>
<div class="line"><span class="lineno"> 2250</span>                                    [1-1j, 2+1j]])</div>
<div class="line"><span class="lineno"> 2251</span>                         )])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d0ab776cca7b822ccee1105a4f25a88" name="a0d0ab776cca7b822ccee1105a4f25a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d0ab776cca7b822ccee1105a4f25a88">&#9670;&#160;</a></span>test_pttrf_pttrs_NAG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_pttrf_pttrs_NAG </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_expect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>e_expect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_expect</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2252</span><span class="keyword">def </span>test_pttrf_pttrs_NAG(d, e, d_expect, e_expect, b, x_expect):</div>
<div class="line"><span class="lineno"> 2253</span>    <span class="comment"># test to assure that wrapper is consistent with NAG Manual Mark 26</span></div>
<div class="line"><span class="lineno"> 2254</span>    <span class="comment"># example problems: f07jdf and f07jef (real)</span></div>
<div class="line"><span class="lineno"> 2255</span>    <span class="comment"># examples: f07jrf and f07csf (complex)</span></div>
<div class="line"><span class="lineno"> 2256</span>    <span class="comment"># NAG examples provide 4 decimals.</span></div>
<div class="line"><span class="lineno"> 2257</span>    <span class="comment"># (Links expire, so please search for &quot;NAG Library Manual Mark 26&quot; online)</span></div>
<div class="line"><span class="lineno"> 2258</span> </div>
<div class="line"><span class="lineno"> 2259</span>    atol = 1e-4</div>
<div class="line"><span class="lineno"> 2260</span>    pttrf = get_lapack_funcs(<span class="stringliteral">&#39;pttrf&#39;</span>, dtype=e[0])</div>
<div class="line"><span class="lineno"> 2261</span>    _d, _e, info = pttrf(d, e)</div>
<div class="line"><span class="lineno"> 2262</span>    assert_allclose(_d, d_expect, atol=atol)</div>
<div class="line"><span class="lineno"> 2263</span>    assert_allclose(_e, e_expect, atol=atol)</div>
<div class="line"><span class="lineno"> 2264</span> </div>
<div class="line"><span class="lineno"> 2265</span>    pttrs = get_lapack_funcs(<span class="stringliteral">&#39;pttrs&#39;</span>, dtype=e[0])</div>
<div class="line"><span class="lineno"> 2266</span>    _x, info = pttrs(_d, _e.conj(), b)</div>
<div class="line"><span class="lineno"> 2267</span>    assert_allclose(_x, x_expect, atol=atol)</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span>    <span class="comment"># also test option `lower`</span></div>
<div class="line"><span class="lineno"> 2270</span>    <span class="keywordflow">if</span> e.dtype <span class="keywordflow">in</span> COMPLEX_DTYPES:</div>
<div class="line"><span class="lineno"> 2271</span>        _x, info = pttrs(_d, _e, b, lower=1)</div>
<div class="line"><span class="lineno"> 2272</span>        assert_allclose(_x, x_expect, atol=atol)</div>
<div class="line"><span class="lineno"> 2273</span> </div>
<div class="line"><span class="lineno"> 2274</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acac4d8bf3ec3afc357eef5b27c11ef79" name="acac4d8bf3ec3afc357eef5b27c11ef79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac4d8bf3ec3afc357eef5b27c11ef79">&#9670;&#160;</a></span>test_rot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_rot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  663</span><span class="keyword">def </span>test_rot():</div>
<div class="line"><span class="lineno">  664</span>    <span class="comment"># srot, drot from blas and crot and zrot from lapack.</span></div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>    <span class="keywordflow">for</span> dtype <span class="keywordflow">in</span> <span class="stringliteral">&#39;fdFD&#39;</span>:</div>
<div class="line"><span class="lineno">  667</span>        c = 0.6</div>
<div class="line"><span class="lineno">  668</span>        s = 0.8</div>
<div class="line"><span class="lineno">  669</span> </div>
<div class="line"><span class="lineno">  670</span>        u = np.full(4, 3, dtype)</div>
<div class="line"><span class="lineno">  671</span>        v = np.full(4, 4, dtype)</div>
<div class="line"><span class="lineno">  672</span>        atol = 10**-(np.finfo(dtype).precision-1)</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>        <span class="keywordflow">if</span> dtype <span class="keywordflow">in</span> <span class="stringliteral">&#39;fd&#39;</span>:</div>
<div class="line"><span class="lineno">  675</span>            rot = get_blas_funcs(<span class="stringliteral">&#39;rot&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno">  676</span>            f = 4</div>
<div class="line"><span class="lineno">  677</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  678</span>            rot = get_lapack_funcs(<span class="stringliteral">&#39;rot&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno">  679</span>            s *= -1j</div>
<div class="line"><span class="lineno">  680</span>            v *= 1j</div>
<div class="line"><span class="lineno">  681</span>            f = 4j</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>        assert_allclose(rot(u, v, c, s), [[5, 5, 5, 5],</div>
<div class="line"><span class="lineno">  684</span>                                          [0, 0, 0, 0]], atol=atol)</div>
<div class="line"><span class="lineno">  685</span>        assert_allclose(rot(u, v, c, s, n=2), [[5, 5, 3, 3],</div>
<div class="line"><span class="lineno">  686</span>                                               [0, 0, f, f]], atol=atol)</div>
<div class="line"><span class="lineno">  687</span>        assert_allclose(rot(u, v, c, s, offx=2, offy=2),</div>
<div class="line"><span class="lineno">  688</span>                        [[3, 3, 5, 5], [f, f, 0, 0]], atol=atol)</div>
<div class="line"><span class="lineno">  689</span>        assert_allclose(rot(u, v, c, s, incx=2, offy=2, n=2),</div>
<div class="line"><span class="lineno">  690</span>                        [[5, 3, 5, 3], [f, f, 0, 0]], atol=atol)</div>
<div class="line"><span class="lineno">  691</span>        assert_allclose(rot(u, v, c, s, offx=2, incy=2, n=2),</div>
<div class="line"><span class="lineno">  692</span>                        [[3, 3, 5, 5], [0, f, 0, f]], atol=atol)</div>
<div class="line"><span class="lineno">  693</span>        assert_allclose(rot(u, v, c, s, offx=2, incx=2, offy=2, incy=2, n=1),</div>
<div class="line"><span class="lineno">  694</span>                        [[3, 3, 5, 3], [f, f, 0, f]], atol=atol)</div>
<div class="line"><span class="lineno">  695</span>        assert_allclose(rot(u, v, c, s, incx=-2, incy=-2, n=2),</div>
<div class="line"><span class="lineno">  696</span>                        [[5, 3, 5, 3], [0, f, 0, f]], atol=atol)</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>        a, b = rot(u, v, c, s, overwrite_x=1, overwrite_y=1)</div>
<div class="line"><span class="lineno">  699</span>        assert_(a <span class="keywordflow">is</span> u)</div>
<div class="line"><span class="lineno">  700</span>        assert_(b <span class="keywordflow">is</span> v)</div>
<div class="line"><span class="lineno">  701</span>        assert_allclose(a, [5, 5, 5, 5], atol=atol)</div>
<div class="line"><span class="lineno">  702</span>        assert_allclose(b, [0, 0, 0, 0], atol=atol)</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a1916ff26ec9399044512d9dd605e07" name="a7a1916ff26ec9399044512d9dd605e07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a1916ff26ec9399044512d9dd605e07">&#9670;&#160;</a></span>test_sfrk_hfrk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_sfrk_hfrk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test for performing a symmetric rank-k operation for matrix in RFP format.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1388</span><span class="keyword">def </span>test_sfrk_hfrk():</div>
<div class="line"><span class="lineno"> 1389</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1390</span><span class="stringliteral">    Test for performing a symmetric rank-k operation for matrix in RFP format.</span></div>
<div class="line"><span class="lineno"> 1391</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1392</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1393</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1394</span>        n = 20</div>
<div class="line"><span class="lineno"> 1395</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1396</span>            A = (rand(n, n) + rand(n, n)*1j).astype(dtype)</div>
<div class="line"><span class="lineno"> 1397</span>            A = A + A.conj().T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1398</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1399</span>            A = (rand(n, n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1400</span>            A = A + A.T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span>        prefix = <span class="stringliteral">&#39;s&#39;</span><span class="keywordflow">if</span> ind &lt; 2 <span class="keywordflow">else</span> <span class="stringliteral">&#39;h&#39;</span></div>
<div class="line"><span class="lineno"> 1403</span>        trttf, tfttr, shfrk = get_lapack_funcs((<span class="stringliteral">&#39;trttf&#39;</span>, <span class="stringliteral">&#39;tfttr&#39;</span>, <span class="stringliteral">&#39;{}frk&#39;</span></div>
<div class="line"><span class="lineno"> 1404</span>                                                <span class="stringliteral">&#39;&#39;</span>.format(prefix)),</div>
<div class="line"><span class="lineno"> 1405</span>                                               dtype=dtype)</div>
<div class="line"><span class="lineno"> 1406</span> </div>
<div class="line"><span class="lineno"> 1407</span>        Afp, _ = trttf(A)</div>
<div class="line"><span class="lineno"> 1408</span>        C = np.random.rand(n, 2).astype(dtype)</div>
<div class="line"><span class="lineno"> 1409</span>        Afp_out = shfrk(n, 2, -1, C, 2, Afp)</div>
<div class="line"><span class="lineno"> 1410</span>        A_out, _ = tfttr(n, Afp_out)</div>
<div class="line"><span class="lineno"> 1411</span>        assert_array_almost_equal(A_out, triu(-C.dot(C.conj().T) + 2*A),</div>
<div class="line"><span class="lineno"> 1412</span>                                  decimal=4 <span class="keywordflow">if</span> ind % 2 == 0 <span class="keywordflow">else</span> 6)</div>
<div class="line"><span class="lineno"> 1413</span> </div>
<div class="line"><span class="lineno"> 1414</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab13b092137e8ebf6d2282cb818e3c399" name="ab13b092137e8ebf6d2282cb818e3c399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab13b092137e8ebf6d2282cb818e3c399">&#9670;&#160;</a></span>test_sgesdd_lwork_bug_workaround()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_sgesdd_lwork_bug_workaround </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  747</span><span class="keyword">def </span>test_sgesdd_lwork_bug_workaround():</div>
<div class="line"><span class="lineno">  748</span>    <span class="comment"># Test that SGESDD lwork is sufficiently large for LAPACK.</span></div>
<div class="line"><span class="lineno">  749</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  750</span>    <span class="comment"># This checks that _compute_lwork() correctly works around a bug in</span></div>
<div class="line"><span class="lineno">  751</span>    <span class="comment"># LAPACK versions older than 3.10.1.</span></div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>    sgesdd_lwork = get_lapack_funcs(<span class="stringliteral">&#39;gesdd_lwork&#39;</span>, dtype=np.float32,</div>
<div class="line"><span class="lineno">  754</span>                                    ilp64=<span class="stringliteral">&#39;preferred&#39;</span>)</div>
<div class="line"><span class="lineno">  755</span>    n = 9537</div>
<div class="line"><span class="lineno">  756</span>    lwork = _compute_lwork(sgesdd_lwork, n, n,</div>
<div class="line"><span class="lineno">  757</span>                           compute_uv=<span class="keyword">True</span>, full_matrices=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  758</span>    <span class="comment"># If we called the Fortran function SGESDD directly with IWORK=-1, the</span></div>
<div class="line"><span class="lineno">  759</span>    <span class="comment"># LAPACK bug would result in lwork being 272929856, which was too small.</span></div>
<div class="line"><span class="lineno">  760</span>    <span class="comment"># (The result was returned in a single precision float, which does not</span></div>
<div class="line"><span class="lineno">  761</span>    <span class="comment"># have sufficient precision to represent the exact integer value that it</span></div>
<div class="line"><span class="lineno">  762</span>    <span class="comment"># computed internally.)  The work-around implemented in _compute_lwork()</span></div>
<div class="line"><span class="lineno">  763</span>    <span class="comment"># will convert that to 272929888.  If we are using LAPACK 3.10.1 or later</span></div>
<div class="line"><span class="lineno">  764</span>    <span class="comment"># (such as in OpenBLAS 0.3.21 or later), the work-around will return</span></div>
<div class="line"><span class="lineno">  765</span>    <span class="comment"># 272929920, because it does not know which version of LAPACK is being</span></div>
<div class="line"><span class="lineno">  766</span>    <span class="comment"># used, so it always applies the correction to whatever it is given.  We</span></div>
<div class="line"><span class="lineno">  767</span>    <span class="comment"># will accept either 272929888 or 272929920.</span></div>
<div class="line"><span class="lineno">  768</span>    <span class="comment"># Note that the acceptable values are a LAPACK implementation detail.</span></div>
<div class="line"><span class="lineno">  769</span>    <span class="comment"># If a future version of LAPACK changes how SGESDD works, and therefore</span></div>
<div class="line"><span class="lineno">  770</span>    <span class="comment"># changes the required LWORK size, the acceptable values might have to</span></div>
<div class="line"><span class="lineno">  771</span>    <span class="comment"># be updated.</span></div>
<div class="line"><span class="lineno">  772</span>    <span class="keyword">assert</span> lwork == 272929888 <span class="keywordflow">or</span> lwork == 272929920</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afed9f498017cee84657df3a23c6f2e92" name="afed9f498017cee84657df3a23c6f2e92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afed9f498017cee84657df3a23c6f2e92">&#9670;&#160;</a></span>test_standard_eigh_lworks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_standard_eigh_lworks </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pfx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>driver</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2484</span><span class="keyword">def </span>test_standard_eigh_lworks(pfx, driver):</div>
<div class="line"><span class="lineno"> 2485</span>    n = 1200  <span class="comment"># Some sufficiently big arbitrary number</span></div>
<div class="line"><span class="lineno"> 2486</span>    dtype = REAL_DTYPES <span class="keywordflow">if</span> pfx == <span class="stringliteral">&#39;sy&#39;</span> <span class="keywordflow">else</span> COMPLEX_DTYPES</div>
<div class="line"><span class="lineno"> 2487</span>    sc_dlw = get_lapack_funcs(pfx+driver+<span class="stringliteral">&#39;_lwork&#39;</span>, dtype=dtype[0])</div>
<div class="line"><span class="lineno"> 2488</span>    dz_dlw = get_lapack_funcs(pfx+driver+<span class="stringliteral">&#39;_lwork&#39;</span>, dtype=dtype[1])</div>
<div class="line"><span class="lineno"> 2489</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2490</span>        _compute_lwork(sc_dlw, n, lower=1)</div>
<div class="line"><span class="lineno"> 2491</span>        _compute_lwork(dz_dlw, n, lower=1)</div>
<div class="line"><span class="lineno"> 2492</span>    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2493</span>        pytest.fail(<span class="stringliteral">&quot;{}_lwork raised unexpected exception: {}&quot;</span></div>
<div class="line"><span class="lineno"> 2494</span>                    <span class="stringliteral">&quot;&quot;</span>.format(pfx+driver, e))</div>
<div class="line"><span class="lineno"> 2495</span> </div>
<div class="line"><span class="lineno"> 2496</span> </div>
<div class="line"><span class="lineno"> 2497</span><span class="preprocessor">@pytest.mark.parametrize(&quot;driver&quot;, [&#39;gv&#39;, &#39;gvx&#39;])</span></div>
<div class="line"><span class="lineno"> 2498</span><span class="preprocessor">@pytest.mark.parametrize(&quot;pfx&quot;, [&#39;sy&#39;, &#39;he&#39;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e17c0a63b49109e7f8eb84b0bf290d4" name="a7e17c0a63b49109e7f8eb84b0bf290d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e17c0a63b49109e7f8eb84b0bf290d4">&#9670;&#160;</a></span>test_sycon_hecon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_sycon_hecon </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  971</span><span class="keyword">def </span>test_sycon_hecon():</div>
<div class="line"><span class="lineno">  972</span>    seed(1234)</div>
<div class="line"><span class="lineno">  973</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES+COMPLEX_DTYPES):</div>
<div class="line"><span class="lineno">  974</span>        <span class="comment"># DTYPES + COMPLEX DTYPES = &lt;s,d,c,z&gt; sycon + &lt;c,z&gt;hecon</span></div>
<div class="line"><span class="lineno">  975</span>        n = 10</div>
<div class="line"><span class="lineno">  976</span>        <span class="comment"># For &lt;s,d,c,z&gt;sycon</span></div>
<div class="line"><span class="lineno">  977</span>        <span class="keywordflow">if</span> ind &lt; 4:</div>
<div class="line"><span class="lineno">  978</span>            func_lwork = get_lapack_funcs(<span class="stringliteral">&#39;sytrf_lwork&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno">  979</span>            funcon, functrf = get_lapack_funcs((<span class="stringliteral">&#39;sycon&#39;</span>, <span class="stringliteral">&#39;sytrf&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno">  980</span>            A = (rand(n, n)).astype(dtype)</div>
<div class="line"><span class="lineno">  981</span>        <span class="comment"># For &lt;c,z&gt;hecon</span></div>
<div class="line"><span class="lineno">  982</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  983</span>            func_lwork = get_lapack_funcs(<span class="stringliteral">&#39;hetrf_lwork&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno">  984</span>            funcon, functrf = get_lapack_funcs((<span class="stringliteral">&#39;hecon&#39;</span>, <span class="stringliteral">&#39;hetrf&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno">  985</span>            A = (rand(n, n) + rand(n, n)*1j).astype(dtype)</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>        <span class="comment"># Since sycon only refers to upper/lower part, conj() is safe here.</span></div>
<div class="line"><span class="lineno">  988</span>        A = (A + A.conj().T)/2 + 2*np.eye(n, dtype=dtype)</div>
<div class="line"><span class="lineno">  989</span> </div>
<div class="line"><span class="lineno">  990</span>        anorm = norm(A, 1)</div>
<div class="line"><span class="lineno">  991</span>        lwork = _compute_lwork(func_lwork, n)</div>
<div class="line"><span class="lineno">  992</span>        ldu, ipiv, _ = functrf(A, lwork=lwork, lower=1)</div>
<div class="line"><span class="lineno">  993</span>        rcond, _ = funcon(a=ldu, ipiv=ipiv, anorm=anorm, lower=1)</div>
<div class="line"><span class="lineno">  994</span>        <span class="comment"># The error is at most 1-fold</span></div>
<div class="line"><span class="lineno">  995</span>        assert_(abs(1/rcond - np.linalg.cond(A, p=1))*rcond &lt; 1)</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a81d785ca58992dde6002e0c65e734c0a" name="a81d785ca58992dde6002e0c65e734c0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81d785ca58992dde6002e0c65e734c0a">&#9670;&#160;</a></span>test_syconv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_syconv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test for going back and forth between the returned format of he/sytrf to
L and D factors/permutations.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1415</span><span class="keyword">def </span>test_syconv():</div>
<div class="line"><span class="lineno"> 1416</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1417</span><span class="stringliteral">    Test for going back and forth between the returned format of he/sytrf to</span></div>
<div class="line"><span class="lineno"> 1418</span><span class="stringliteral">    L and D factors/permutations.</span></div>
<div class="line"><span class="lineno"> 1419</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1420</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1421</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1422</span>        n = 10</div>
<div class="line"><span class="lineno"> 1423</span> </div>
<div class="line"><span class="lineno"> 1424</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1425</span>            A = (randint(-30, 30, (n, n)) +</div>
<div class="line"><span class="lineno"> 1426</span>                 randint(-30, 30, (n, n))*1j).astype(dtype)</div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>            A = A + A.conj().T</div>
<div class="line"><span class="lineno"> 1429</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1430</span>            A = randint(-30, 30, (n, n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1431</span>            A = A + A.T + n*eye(n)</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>        tol = 100*np.spacing(<a class="code hl_namespace" href="namespacedtype.html">dtype</a>(1.0).real)</div>
<div class="line"><span class="lineno"> 1434</span>        syconv, trf, trf_lwork = get_lapack_funcs((<span class="stringliteral">&#39;syconv&#39;</span>, <span class="stringliteral">&#39;sytrf&#39;</span>,</div>
<div class="line"><span class="lineno"> 1435</span>                                                   <span class="stringliteral">&#39;sytrf_lwork&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1436</span>        lw = _compute_lwork(trf_lwork, n, lower=1)</div>
<div class="line"><span class="lineno"> 1437</span>        L, D, perm = ldl(A, lower=1, hermitian=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1438</span>        lw = _compute_lwork(trf_lwork, n, lower=1)</div>
<div class="line"><span class="lineno"> 1439</span>        ldu, ipiv, info = trf(A, lower=1, lwork=lw)</div>
<div class="line"><span class="lineno"> 1440</span>        a, e, info = syconv(ldu, ipiv, lower=1)</div>
<div class="line"><span class="lineno"> 1441</span>        assert_allclose(tril(a, -1,), tril(L[perm, :], -1), atol=tol, rtol=0.)</div>
<div class="line"><span class="lineno"> 1442</span> </div>
<div class="line"><span class="lineno"> 1443</span>        <span class="comment"># Test also upper</span></div>
<div class="line"><span class="lineno"> 1444</span>        U, D, perm = ldl(A, lower=0, hermitian=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1445</span>        ldu, ipiv, info = trf(A, lower=0)</div>
<div class="line"><span class="lineno"> 1446</span>        a, e, info = syconv(ldu, ipiv, lower=0)</div>
<div class="line"><span class="lineno"> 1447</span>        assert_allclose(triu(a, 1), triu(U[perm, :], 1), atol=tol, rtol=0.)</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af1f93794762075ec56bcf037a9ae1415" name="af1f93794762075ec56bcf037a9ae1415"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1f93794762075ec56bcf037a9ae1415">&#9670;&#160;</a></span>test_syequb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_syequb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1727</span><span class="keyword">def </span>test_syequb():</div>
<div class="line"><span class="lineno"> 1728</span>    desired_log2s = np.array([0, 0, 0, 0, 0, 0, -1, -1, -2, -3])</div>
<div class="line"><span class="lineno"> 1729</span> </div>
<div class="line"><span class="lineno"> 1730</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1731</span>        A = np.eye(10, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1732</span>        alpha = <a class="code hl_namespace" href="namespacedtype.html">dtype</a>(1. <span class="keywordflow">if</span> ind &lt; 2 <span class="keywordflow">else</span> 1.j)</div>
<div class="line"><span class="lineno"> 1733</span>        d = np.array([alpha * 2.**x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> range(-5, 5)], dtype=dtype)</div>
<div class="line"><span class="lineno"> 1734</span>        A += np.rot90(np.diag(d))</div>
<div class="line"><span class="lineno"> 1735</span> </div>
<div class="line"><span class="lineno"> 1736</span>        syequb = get_lapack_funcs(<span class="stringliteral">&#39;syequb&#39;</span>, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1737</span>        s, scond, amax, info = syequb(A)</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>        assert_equal(np.log2(s).astype(int), desired_log2s)</div>
<div class="line"><span class="lineno"> 1740</span> </div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span><span class="preprocessor">@pytest.mark.skipif</span>(<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1743</span>                    reason=<span class="stringliteral">&quot;Failing on some OpenBLAS version, see gh-12276&quot;</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2ddc967721910fd74e288a196d29945" name="af2ddc967721910fd74e288a196d29945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2ddc967721910fd74e288a196d29945">&#9670;&#160;</a></span>test_sygst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_sygst </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  998</span><span class="keyword">def </span>test_sygst():</div>
<div class="line"><span class="lineno">  999</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1000</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(REAL_DTYPES):</div>
<div class="line"><span class="lineno"> 1001</span>        <span class="comment"># DTYPES = &lt;s,d&gt; sygst</span></div>
<div class="line"><span class="lineno"> 1002</span>        n = 10</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span>        potrf, sygst, syevd, sygvd = get_lapack_funcs((<span class="stringliteral">&#39;potrf&#39;</span>, <span class="stringliteral">&#39;sygst&#39;</span>,</div>
<div class="line"><span class="lineno"> 1005</span>                                                       <span class="stringliteral">&#39;syevd&#39;</span>, <span class="stringliteral">&#39;sygvd&#39;</span>),</div>
<div class="line"><span class="lineno"> 1006</span>                                                      dtype=dtype)</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span>        A = rand(n, n).astype(dtype)</div>
<div class="line"><span class="lineno"> 1009</span>        A = (A + A.T)/2</div>
<div class="line"><span class="lineno"> 1010</span>        <span class="comment"># B must be positive definite</span></div>
<div class="line"><span class="lineno"> 1011</span>        B = rand(n, n).astype(dtype)</div>
<div class="line"><span class="lineno"> 1012</span>        B = (B + B.T)/2 + 2 * np.eye(n, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>        <span class="comment"># Perform eig (sygvd)</span></div>
<div class="line"><span class="lineno"> 1015</span>        eig_gvd, _, info = sygvd(A, B)</div>
<div class="line"><span class="lineno"> 1016</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>        <span class="comment"># Convert to std problem potrf</span></div>
<div class="line"><span class="lineno"> 1019</span>        b, info = potrf(B)</div>
<div class="line"><span class="lineno"> 1020</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1021</span>        a, info = sygst(A, b)</div>
<div class="line"><span class="lineno"> 1022</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>        eig, _, info = syevd(a)</div>
<div class="line"><span class="lineno"> 1025</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1026</span>        assert_allclose(eig, eig_gvd, rtol=1e-4)</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afdc67183349aa41f6d8b12cc0a2ce5df" name="afdc67183349aa41f6d8b12cc0a2ce5df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdc67183349aa41f6d8b12cc0a2ce5df">&#9670;&#160;</a></span>test_tfsm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_tfsm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test for solving a linear system with the coefficient matrix is a
triangular array stored in Full Packed (RFP) format.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1094</span><span class="keyword">def </span>test_tfsm():</div>
<div class="line"><span class="lineno"> 1095</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1096</span><span class="stringliteral">    Test for solving a linear system with the coefficient matrix is a</span></div>
<div class="line"><span class="lineno"> 1097</span><span class="stringliteral">    triangular array stored in Full Packed (RFP) format.</span></div>
<div class="line"><span class="lineno"> 1098</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1099</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1100</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1101</span>        n = 20</div>
<div class="line"><span class="lineno"> 1102</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1103</span>            A = triu(rand(n, n) + rand(n, n)*1j + eye(n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1104</span>            trans = <span class="stringliteral">&#39;C&#39;</span></div>
<div class="line"><span class="lineno"> 1105</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1106</span>            A = triu(rand(n, n) + eye(n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1107</span>            trans = <span class="stringliteral">&#39;T&#39;</span></div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>        trttf, tfttr, tfsm = get_lapack_funcs((<span class="stringliteral">&#39;trttf&#39;</span>, <span class="stringliteral">&#39;tfttr&#39;</span>, <span class="stringliteral">&#39;tfsm&#39;</span>),</div>
<div class="line"><span class="lineno"> 1110</span>                                              dtype=dtype)</div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span>        Afp, _ = trttf(A)</div>
<div class="line"><span class="lineno"> 1113</span>        B = rand(n, 2).astype(dtype)</div>
<div class="line"><span class="lineno"> 1114</span>        soln = tfsm(-1, Afp, B)</div>
<div class="line"><span class="lineno"> 1115</span>        assert_array_almost_equal(soln, solve(-A, B),</div>
<div class="line"><span class="lineno"> 1116</span>                                  decimal=4 <span class="keywordflow">if</span> ind % 2 == 0 <span class="keywordflow">else</span> 6)</div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span>        soln = tfsm(-1, Afp, B, trans=trans)</div>
<div class="line"><span class="lineno"> 1119</span>        assert_array_almost_equal(soln, solve(-A.conj().T, B),</div>
<div class="line"><span class="lineno"> 1120</span>                                  decimal=4 <span class="keywordflow">if</span> ind % 2 == 0 <span class="keywordflow">else</span> 6)</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>        <span class="comment"># Make A, unit diagonal</span></div>
<div class="line"><span class="lineno"> 1123</span>        A[np.arange(n), np.arange(n)] = <a class="code hl_namespace" href="namespacedtype.html">dtype</a>(1.)</div>
<div class="line"><span class="lineno"> 1124</span>        soln = tfsm(-1, Afp, B, trans=trans, diag=<span class="stringliteral">&#39;U&#39;</span>)</div>
<div class="line"><span class="lineno"> 1125</span>        assert_array_almost_equal(soln, solve(-A.conj().T, B),</div>
<div class="line"><span class="lineno"> 1126</span>                                  decimal=4 <span class="keywordflow">if</span> ind % 2 == 0 <span class="keywordflow">else</span> 6)</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>        <span class="comment"># Change side</span></div>
<div class="line"><span class="lineno"> 1129</span>        B2 = rand(3, n).astype(dtype)</div>
<div class="line"><span class="lineno"> 1130</span>        soln = tfsm(-1, Afp, B2, trans=trans, diag=<span class="stringliteral">&#39;U&#39;</span>, side=<span class="stringliteral">&#39;R&#39;</span>)</div>
<div class="line"><span class="lineno"> 1131</span>        assert_array_almost_equal(soln, solve(-A, B2.T).conj().T,</div>
<div class="line"><span class="lineno"> 1132</span>                                  decimal=4 <span class="keywordflow">if</span> ind % 2 == 0 <span class="keywordflow">else</span> 6)</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a69f1ee0d2fae9324aa3b38bda7578d" name="a9a69f1ee0d2fae9324aa3b38bda7578d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a69f1ee0d2fae9324aa3b38bda7578d">&#9670;&#160;</a></span>test_tfttr_trttf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_tfttr_trttf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test conversion routines between the Rectengular Full Packed (RFP) format
and Standard Triangular Array (TR)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1193</span><span class="keyword">def </span>test_tfttr_trttf():</div>
<div class="line"><span class="lineno"> 1194</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1195</span><span class="stringliteral">    Test conversion routines between the Rectengular Full Packed (RFP) format</span></div>
<div class="line"><span class="lineno"> 1196</span><span class="stringliteral">    and Standard Triangular Array (TR)</span></div>
<div class="line"><span class="lineno"> 1197</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1198</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1199</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1200</span>        n = 20</div>
<div class="line"><span class="lineno"> 1201</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1202</span>            A_full = (rand(n, n) + rand(n, n)*1j).astype(dtype)</div>
<div class="line"><span class="lineno"> 1203</span>            transr = <span class="stringliteral">&#39;C&#39;</span></div>
<div class="line"><span class="lineno"> 1204</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1205</span>            A_full = (rand(n, n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1206</span>            transr = <span class="stringliteral">&#39;T&#39;</span></div>
<div class="line"><span class="lineno"> 1207</span> </div>
<div class="line"><span class="lineno"> 1208</span>        trttf, tfttr = get_lapack_funcs((<span class="stringliteral">&#39;trttf&#39;</span>, <span class="stringliteral">&#39;tfttr&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1209</span>        A_tf_U, info = trttf(A_full)</div>
<div class="line"><span class="lineno"> 1210</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1211</span>        A_tf_L, info = trttf(A_full, uplo=<span class="stringliteral">&#39;L&#39;</span>)</div>
<div class="line"><span class="lineno"> 1212</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1213</span>        A_tf_U_T, info = trttf(A_full, transr=transr, uplo=<span class="stringliteral">&#39;U&#39;</span>)</div>
<div class="line"><span class="lineno"> 1214</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1215</span>        A_tf_L_T, info = trttf(A_full, transr=transr, uplo=<span class="stringliteral">&#39;L&#39;</span>)</div>
<div class="line"><span class="lineno"> 1216</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>        <span class="comment"># Create the RFP array manually (n is even!)</span></div>
<div class="line"><span class="lineno"> 1219</span>        A_tf_U_m = zeros((n+1, n//2), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1220</span>        A_tf_U_m[:-1, :] = triu(A_full)[:, n//2:]</div>
<div class="line"><span class="lineno"> 1221</span>        A_tf_U_m[n//2+1:, :] += triu(A_full)[:n//2, :n//2].conj().T</div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span>        A_tf_L_m = zeros((n+1, n//2), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1224</span>        A_tf_L_m[1:, :] = tril(A_full)[:, :n//2]</div>
<div class="line"><span class="lineno"> 1225</span>        A_tf_L_m[:n//2, :] += tril(A_full)[n//2:, n//2:].conj().T</div>
<div class="line"><span class="lineno"> 1226</span> </div>
<div class="line"><span class="lineno"> 1227</span>        assert_array_almost_equal(A_tf_U, A_tf_U_m.reshape(-1, order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno"> 1228</span>        assert_array_almost_equal(A_tf_U_T,</div>
<div class="line"><span class="lineno"> 1229</span>                                  A_tf_U_m.conj().T.reshape(-1, order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno"> 1230</span> </div>
<div class="line"><span class="lineno"> 1231</span>        assert_array_almost_equal(A_tf_L, A_tf_L_m.reshape(-1, order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno"> 1232</span>        assert_array_almost_equal(A_tf_L_T,</div>
<div class="line"><span class="lineno"> 1233</span>                                  A_tf_L_m.conj().T.reshape(-1, order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>        <span class="comment"># Get the original array from RFP</span></div>
<div class="line"><span class="lineno"> 1236</span>        A_tr_U, info = tfttr(n, A_tf_U)</div>
<div class="line"><span class="lineno"> 1237</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1238</span>        A_tr_L, info = tfttr(n, A_tf_L, uplo=<span class="stringliteral">&#39;L&#39;</span>)</div>
<div class="line"><span class="lineno"> 1239</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1240</span>        A_tr_U_T, info = tfttr(n, A_tf_U_T, transr=transr, uplo=<span class="stringliteral">&#39;U&#39;</span>)</div>
<div class="line"><span class="lineno"> 1241</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1242</span>        A_tr_L_T, info = tfttr(n, A_tf_L_T, transr=transr, uplo=<span class="stringliteral">&#39;L&#39;</span>)</div>
<div class="line"><span class="lineno"> 1243</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>        assert_array_almost_equal(A_tr_U, triu(A_full))</div>
<div class="line"><span class="lineno"> 1246</span>        assert_array_almost_equal(A_tr_U_T, triu(A_full))</div>
<div class="line"><span class="lineno"> 1247</span>        assert_array_almost_equal(A_tr_L, tril(A_full))</div>
<div class="line"><span class="lineno"> 1248</span>        assert_array_almost_equal(A_tr_L_T, tril(A_full))</div>
<div class="line"><span class="lineno"> 1249</span> </div>
<div class="line"><span class="lineno"> 1250</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4897f0bb6b1ae582799a6bc65fd730d1" name="a4897f0bb6b1ae582799a6bc65fd730d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4897f0bb6b1ae582799a6bc65fd730d1">&#9670;&#160;</a></span>test_tpttr_trttp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_tpttr_trttp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test conversion routines between the Rectengular Full Packed (RFP) format
and Standard Triangular Array (TR)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1251</span><span class="keyword">def </span>test_tpttr_trttp():</div>
<div class="line"><span class="lineno"> 1252</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral">    Test conversion routines between the Rectengular Full Packed (RFP) format</span></div>
<div class="line"><span class="lineno"> 1254</span><span class="stringliteral">    and Standard Triangular Array (TR)</span></div>
<div class="line"><span class="lineno"> 1255</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1256</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1257</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1258</span>        n = 20</div>
<div class="line"><span class="lineno"> 1259</span>        <span class="keywordflow">if</span> ind &gt; 1:</div>
<div class="line"><span class="lineno"> 1260</span>            A_full = (rand(n, n) + rand(n, n)*1j).astype(dtype)</div>
<div class="line"><span class="lineno"> 1261</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1262</span>            A_full = (rand(n, n)).astype(dtype)</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>        trttp, tpttr = get_lapack_funcs((<span class="stringliteral">&#39;trttp&#39;</span>, <span class="stringliteral">&#39;tpttr&#39;</span>), dtype=dtype)</div>
<div class="line"><span class="lineno"> 1265</span>        A_tp_U, info = trttp(A_full)</div>
<div class="line"><span class="lineno"> 1266</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1267</span>        A_tp_L, info = trttp(A_full, uplo=<span class="stringliteral">&#39;L&#39;</span>)</div>
<div class="line"><span class="lineno"> 1268</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>        <span class="comment"># Create the TP array manually</span></div>
<div class="line"><span class="lineno"> 1271</span>        inds = tril_indices(n)</div>
<div class="line"><span class="lineno"> 1272</span>        A_tp_U_m = zeros(n*(n+1)//2, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1273</span>        A_tp_U_m[:] = (triu(A_full).T)[inds]</div>
<div class="line"><span class="lineno"> 1274</span> </div>
<div class="line"><span class="lineno"> 1275</span>        inds = triu_indices(n)</div>
<div class="line"><span class="lineno"> 1276</span>        A_tp_L_m = zeros(n*(n+1)//2, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1277</span>        A_tp_L_m[:] = (tril(A_full).T)[inds]</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>        assert_array_almost_equal(A_tp_U, A_tp_U_m)</div>
<div class="line"><span class="lineno"> 1280</span>        assert_array_almost_equal(A_tp_L, A_tp_L_m)</div>
<div class="line"><span class="lineno"> 1281</span> </div>
<div class="line"><span class="lineno"> 1282</span>        <span class="comment"># Get the original array from TP</span></div>
<div class="line"><span class="lineno"> 1283</span>        A_tr_U, info = tpttr(n, A_tp_U)</div>
<div class="line"><span class="lineno"> 1284</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1285</span>        A_tr_L, info = tpttr(n, A_tp_L, uplo=<span class="stringliteral">&#39;L&#39;</span>)</div>
<div class="line"><span class="lineno"> 1286</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span>        assert_array_almost_equal(A_tr_U, triu(A_full))</div>
<div class="line"><span class="lineno"> 1289</span>        assert_array_almost_equal(A_tr_L, tril(A_full))</div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aaaf4ae6ed9889081f45e861491dee0ec" name="aaaf4ae6ed9889081f45e861491dee0ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaf4ae6ed9889081f45e861491dee0ec">&#9670;&#160;</a></span>test_tzrzf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.test_tzrzf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This test performs an RZ decomposition in which an m x n upper trapezoidal
array M (m &lt;= n) is factorized as M = [R 0] * Z where R is upper triangular
and Z is unitary.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1060</span><span class="keyword">def </span>test_tzrzf():</div>
<div class="line"><span class="lineno"> 1061</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">    This test performs an RZ decomposition in which an m x n upper trapezoidal</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral">    array M (m &lt;= n) is factorized as M = [R 0] * Z where R is upper triangular</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral">    and Z is unitary.</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1066</span>    seed(1234)</div>
<div class="line"><span class="lineno"> 1067</span>    m, n = 10, 15</div>
<div class="line"><span class="lineno"> 1068</span>    <span class="keywordflow">for</span> ind, dtype <span class="keywordflow">in</span> enumerate(DTYPES):</div>
<div class="line"><span class="lineno"> 1069</span>        tzrzf, tzrzf_lw = get_lapack_funcs((<span class="stringliteral">&#39;tzrzf&#39;</span>, <span class="stringliteral">&#39;tzrzf_lwork&#39;</span>),</div>
<div class="line"><span class="lineno"> 1070</span>                                           dtype=dtype)</div>
<div class="line"><span class="lineno"> 1071</span>        lwork = _compute_lwork(tzrzf_lw, m, n)</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>        <span class="keywordflow">if</span> ind &lt; 2:</div>
<div class="line"><span class="lineno"> 1074</span>            A = triu(rand(m, n).astype(dtype))</div>
<div class="line"><span class="lineno"> 1075</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1076</span>            A = triu((rand(m, n) + rand(m, n)*1j).astype(dtype))</div>
<div class="line"><span class="lineno"> 1077</span> </div>
<div class="line"><span class="lineno"> 1078</span>        <span class="comment"># assert wrong shape arg, f2py returns generic error</span></div>
<div class="line"><span class="lineno"> 1079</span>        assert_raises(Exception, tzrzf, A.T)</div>
<div class="line"><span class="lineno"> 1080</span>        rz, tau, info = tzrzf(A, lwork=lwork)</div>
<div class="line"><span class="lineno"> 1081</span>        <span class="comment"># Check success</span></div>
<div class="line"><span class="lineno"> 1082</span>        assert_(info == 0)</div>
<div class="line"><span class="lineno"> 1083</span> </div>
<div class="line"><span class="lineno"> 1084</span>        <span class="comment"># Get Z manually for comparison</span></div>
<div class="line"><span class="lineno"> 1085</span>        R = np.hstack((rz[:, :m], np.zeros((m, n-m), dtype=dtype)))</div>
<div class="line"><span class="lineno"> 1086</span>        V = np.hstack((np.eye(m, dtype=dtype), rz[:, m:]))</div>
<div class="line"><span class="lineno"> 1087</span>        Id = np.eye(n, dtype=dtype)</div>
<div class="line"><span class="lineno"> 1088</span>        ref = [Id-tau[x]*V[[x], :].T.dot(V[[x], :].conj()) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> range(m)]</div>
<div class="line"><span class="lineno"> 1089</span>        Z = reduce(np.dot, ref)</div>
<div class="line"><span class="lineno"> 1090</span>        assert_allclose(R.dot(Z) - A, zeros_like(A, dtype=dtype),</div>
<div class="line"><span class="lineno"> 1091</span>                        atol=10*np.spacing(<a class="code hl_namespace" href="namespacedtype.html">dtype</a>(1.0).real), rtol=0.)</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af7ce0dc1f845c58e9b44fa2f16ff288c" name="af7ce0dc1f845c58e9b44fa2f16ff288c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7ce0dc1f845c58e9b44fa2f16ff288c">&#9670;&#160;</a></span>clapack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.linalg.tests.test_lapack.clapack = None</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4fb1e4e3b373e0a3e1fca854aabd8daf" name="a4fb1e4e3b373e0a3e1fca854aabd8daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb1e4e3b373e0a3e1fca854aabd8daf">&#9670;&#160;</a></span>COMPLEX_DTYPES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.linalg.tests.test_lapack.COMPLEX_DTYPES = [np.complex64, np.complex128]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c821594c0afbacc39ba795499047516" name="a7c821594c0afbacc39ba795499047516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c821594c0afbacc39ba795499047516">&#9670;&#160;</a></span>DTYPES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.linalg.tests.test_lapack.DTYPES = <a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a68c537e8dac43687de21b7402d08dade">REAL_DTYPES</a> + <a class="el" href="namespacescipy_1_1linalg_1_1tests_1_1test__lapack.html#a4fb1e4e3b373e0a3e1fca854aabd8daf">COMPLEX_DTYPES</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a68c537e8dac43687de21b7402d08dade" name="a68c537e8dac43687de21b7402d08dade"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68c537e8dac43687de21b7402d08dade">&#9670;&#160;</a></span>REAL_DTYPES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.linalg.tests.test_lapack.REAL_DTYPES = [np.float32, np.float64]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
