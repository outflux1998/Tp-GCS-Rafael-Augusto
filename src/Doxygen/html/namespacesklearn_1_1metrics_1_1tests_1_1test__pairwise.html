<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.metrics.tests.test_pairwise Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1metrics.html">metrics</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1metrics_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html">test_pairwise</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sklearn.metrics.tests.test_pairwise Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a302120f8084a9ac190d20b580aa3a990" id="r_a302120f8084a9ac190d20b580aa3a990"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a302120f8084a9ac190d20b580aa3a990">test_pairwise_distances</a> (global_dtype)</td></tr>
<tr class="separator:a302120f8084a9ac190d20b580aa3a990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93fc4e253d2c81c0f0c764e677219f84" id="r_a93fc4e253d2c81c0f0c764e677219f84"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a93fc4e253d2c81c0f0c764e677219f84">test_manhattan_distances_deprecated_sum_over_features</a> (sum_over_features)</td></tr>
<tr class="separator:a93fc4e253d2c81c0f0c764e677219f84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69ca9e0126f16b75f3f027ebd81e2d18" id="r_a69ca9e0126f16b75f3f027ebd81e2d18"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a69ca9e0126f16b75f3f027ebd81e2d18">test_pairwise_boolean_distance</a> (metric)</td></tr>
<tr class="separator:a69ca9e0126f16b75f3f027ebd81e2d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c32d7e5e06d1ac9ba0a2d7ee2c91d0e" id="r_a9c32d7e5e06d1ac9ba0a2d7ee2c91d0e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a9c32d7e5e06d1ac9ba0a2d7ee2c91d0e">test_no_data_conversion_warning</a> ()</td></tr>
<tr class="separator:a9c32d7e5e06d1ac9ba0a2d7ee2c91d0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad437a0aabc275592f638712239bf145" id="r_aad437a0aabc275592f638712239bf145"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#aad437a0aabc275592f638712239bf145">test_pairwise_precomputed</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:aad437a0aabc275592f638712239bf145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499ea6383b45dbc4ff6911989b772100" id="r_a499ea6383b45dbc4ff6911989b772100"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a499ea6383b45dbc4ff6911989b772100">test_pairwise_precomputed_non_negative</a> ()</td></tr>
<tr class="separator:a499ea6383b45dbc4ff6911989b772100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a785458d0c5fb2cffd1eb020fcd199ab3" id="r_a785458d0c5fb2cffd1eb020fcd199ab3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a785458d0c5fb2cffd1eb020fcd199ab3">callable_rbf_kernel</a> (x, y, **kwds)</td></tr>
<tr class="separator:a785458d0c5fb2cffd1eb020fcd199ab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa765a5ebc94e52a3bc5dbed38d716a55" id="r_aa765a5ebc94e52a3bc5dbed38d716a55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#aa765a5ebc94e52a3bc5dbed38d716a55">test_pairwise_parallel</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, metric, kwds, dtype)</td></tr>
<tr class="separator:aa765a5ebc94e52a3bc5dbed38d716a55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8134a134fd6ebd4ea53d49b9cad35d" id="r_a5d8134a134fd6ebd4ea53d49b9cad35d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a5d8134a134fd6ebd4ea53d49b9cad35d">test_pairwise_callable_nonstrict_metric</a> ()</td></tr>
<tr class="separator:a5d8134a134fd6ebd4ea53d49b9cad35d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a35bf9b7b866c432c5e7224623de09" id="r_a43a35bf9b7b866c432c5e7224623de09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a43a35bf9b7b866c432c5e7224623de09">test_pairwise_kernels</a> (metric)</td></tr>
<tr class="separator:a43a35bf9b7b866c432c5e7224623de09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ddec6f72ac8a68e3bcf9fca631cd455" id="r_a8ddec6f72ac8a68e3bcf9fca631cd455"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a8ddec6f72ac8a68e3bcf9fca631cd455">test_pairwise_kernels_callable</a> ()</td></tr>
<tr class="separator:a8ddec6f72ac8a68e3bcf9fca631cd455"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdcb2526f5f8a350b80045a5bbe280c6" id="r_acdcb2526f5f8a350b80045a5bbe280c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#acdcb2526f5f8a350b80045a5bbe280c6">test_pairwise_kernels_filter_param</a> ()</td></tr>
<tr class="separator:acdcb2526f5f8a350b80045a5bbe280c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae07538f5a73d6c700dd6a668cc72293" id="r_aae07538f5a73d6c700dd6a668cc72293"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#aae07538f5a73d6c700dd6a668cc72293">test_paired_distances</a> (metric, <a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>)</td></tr>
<tr class="separator:aae07538f5a73d6c700dd6a668cc72293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08171f5ba00bec0517d308e6738b8ab8" id="r_a08171f5ba00bec0517d308e6738b8ab8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a08171f5ba00bec0517d308e6738b8ab8">test_paired_distances_callable</a> (global_dtype)</td></tr>
<tr class="separator:a08171f5ba00bec0517d308e6738b8ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f2d99df4781afeddd1899ed6481533" id="r_ab2f2d99df4781afeddd1899ed6481533"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ab2f2d99df4781afeddd1899ed6481533">test_pairwise_distances_argmin_min</a> (global_dtype)</td></tr>
<tr class="separator:ab2f2d99df4781afeddd1899ed6481533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0870f26b75a01461ef96c643620bb7bc" id="r_a0870f26b75a01461ef96c643620bb7bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a0870f26b75a01461ef96c643620bb7bc">_reduce_func</a> (dist, start)</td></tr>
<tr class="separator:a0870f26b75a01461ef96c643620bb7bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75cc88d18a481ce5832b5fd70341f567" id="r_a75cc88d18a481ce5832b5fd70341f567"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a75cc88d18a481ce5832b5fd70341f567">test_pairwise_distances_chunked_reduce</a> (global_dtype)</td></tr>
<tr class="separator:a75cc88d18a481ce5832b5fd70341f567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e4f559c05b4feefe36eaa801b3eb864" id="r_a1e4f559c05b4feefe36eaa801b3eb864"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a1e4f559c05b4feefe36eaa801b3eb864">test_pairwise_distances_chunked_reduce_none</a> (global_dtype)</td></tr>
<tr class="separator:a1e4f559c05b4feefe36eaa801b3eb864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fae58f9974f0ab1bec88831c5cd3906" id="r_a8fae58f9974f0ab1bec88831c5cd3906"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a8fae58f9974f0ab1bec88831c5cd3906">test_pairwise_distances_chunked_reduce_valid</a> (good_reduce)</td></tr>
<tr class="separator:a8fae58f9974f0ab1bec88831c5cd3906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f89df60e4c3ee63b9ce064a0d4fa4e" id="r_ac9f89df60e4c3ee63b9ce064a0d4fa4e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ac9f89df60e4c3ee63b9ce064a0d4fa4e">test_pairwise_distances_chunked_reduce_invalid</a> (global_dtype, bad_reduce, err_type, message)</td></tr>
<tr class="separator:ac9f89df60e4c3ee63b9ce064a0d4fa4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a645a59f9981c22eb6488aa2f83eb6961" id="r_a645a59f9981c22eb6488aa2f83eb6961"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a645a59f9981c22eb6488aa2f83eb6961">check_pairwise_distances_chunked</a> (X, Y, working_memory, metric=&quot;euclidean&quot;)</td></tr>
<tr class="separator:a645a59f9981c22eb6488aa2f83eb6961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0edc9e9c95a17a7e8df56704573e5122" id="r_a0edc9e9c95a17a7e8df56704573e5122"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a0edc9e9c95a17a7e8df56704573e5122">test_pairwise_distances_chunked_diagonal</a> (metric, global_dtype)</td></tr>
<tr class="separator:a0edc9e9c95a17a7e8df56704573e5122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac06d71bd875dd87d42ea6263f2174aaa" id="r_ac06d71bd875dd87d42ea6263f2174aaa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ac06d71bd875dd87d42ea6263f2174aaa">test_parallel_pairwise_distances_diagonal</a> (metric, global_dtype)</td></tr>
<tr class="separator:ac06d71bd875dd87d42ea6263f2174aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f9fa21abd07e727b62104fbb15f0184" id="r_a4f9fa21abd07e727b62104fbb15f0184"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a4f9fa21abd07e727b62104fbb15f0184">test_pairwise_distances_chunked</a> (global_dtype)</td></tr>
<tr class="separator:a4f9fa21abd07e727b62104fbb15f0184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66e455761acf87381e32a6b2a2d876f" id="r_ad66e455761acf87381e32a6b2a2d876f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ad66e455761acf87381e32a6b2a2d876f">test_euclidean_distances_known_result</a> (x_array_constr, y_array_constr)</td></tr>
<tr class="separator:ad66e455761acf87381e32a6b2a2d876f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac395f0f6fa093d4b9f2a9f2ab7f1c71b" id="r_ac395f0f6fa093d4b9f2a9f2ab7f1c71b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ac395f0f6fa093d4b9f2a9f2ab7f1c71b">test_euclidean_distances_with_norms</a> (global_dtype, y_array_constr)</td></tr>
<tr class="separator:ac395f0f6fa093d4b9f2a9f2ab7f1c71b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dcfbccdad503752e4244c6f00bef9d5" id="r_a6dcfbccdad503752e4244c6f00bef9d5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a6dcfbccdad503752e4244c6f00bef9d5">test_euclidean_distances_norm_shapes</a> ()</td></tr>
<tr class="separator:a6dcfbccdad503752e4244c6f00bef9d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86173199d0fef029d090579ee00fd693" id="r_a86173199d0fef029d090579ee00fd693"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a86173199d0fef029d090579ee00fd693">test_euclidean_distances</a> (global_dtype, x_array_constr, y_array_constr)</td></tr>
<tr class="separator:a86173199d0fef029d090579ee00fd693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ce526a2520e7e2b8aafdbc9ff2e3b1a" id="r_a5ce526a2520e7e2b8aafdbc9ff2e3b1a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a5ce526a2520e7e2b8aafdbc9ff2e3b1a">test_euclidean_distances_sym</a> (global_dtype, x_array_constr)</td></tr>
<tr class="separator:a5ce526a2520e7e2b8aafdbc9ff2e3b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41fdded1fb3c6f5003d4ad6406581e3c" id="r_a41fdded1fb3c6f5003d4ad6406581e3c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a41fdded1fb3c6f5003d4ad6406581e3c">test_euclidean_distances_upcast</a> (batch_size, x_array_constr, y_array_constr)</td></tr>
<tr class="separator:a41fdded1fb3c6f5003d4ad6406581e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a711c876a565d2382ba748aa7b1e0a33f" id="r_a711c876a565d2382ba748aa7b1e0a33f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a711c876a565d2382ba748aa7b1e0a33f">test_euclidean_distances_upcast_sym</a> (batch_size, x_array_constr)</td></tr>
<tr class="separator:a711c876a565d2382ba748aa7b1e0a33f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f9eb725d44fac8749de25846a652d09" id="r_a0f9eb725d44fac8749de25846a652d09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a0f9eb725d44fac8749de25846a652d09">test_euclidean_distances_extreme_values</a> (dtype, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>, <a class="el" href="__lapack__subroutines_8h.html#aa4a017e91ee751f9803a1bdb6caf1c06">rtol</a>, dim)</td></tr>
<tr class="separator:a0f9eb725d44fac8749de25846a652d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac02888dec707452ef2c9193f0dcd3cb2" id="r_ac02888dec707452ef2c9193f0dcd3cb2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ac02888dec707452ef2c9193f0dcd3cb2">test_nan_euclidean_distances_equal_to_euclidean_distance</a> (squared)</td></tr>
<tr class="separator:ac02888dec707452ef2c9193f0dcd3cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ca114cd0699d81893aa282560304891" id="r_a0ca114cd0699d81893aa282560304891"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a0ca114cd0699d81893aa282560304891">test_nan_euclidean_distances_infinite_values</a> (X, Y)</td></tr>
<tr class="separator:a0ca114cd0699d81893aa282560304891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8d6c2cef784c5992edfe11eaa9c0fa5" id="r_ad8d6c2cef784c5992edfe11eaa9c0fa5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ad8d6c2cef784c5992edfe11eaa9c0fa5">test_nan_euclidean_distances_2x2</a> (X, X_diag, missing_value)</td></tr>
<tr class="separator:ad8d6c2cef784c5992edfe11eaa9c0fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cb418b4ef5c228883d8cbcbbde5f0dc" id="r_a5cb418b4ef5c228883d8cbcbbde5f0dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a5cb418b4ef5c228883d8cbcbbde5f0dc">test_nan_euclidean_distances_complete_nan</a> (missing_value)</td></tr>
<tr class="separator:a5cb418b4ef5c228883d8cbcbbde5f0dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e63fc6831565737efb531ae0a1bee2f" id="r_a4e63fc6831565737efb531ae0a1bee2f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a4e63fc6831565737efb531ae0a1bee2f">test_nan_euclidean_distances_not_trival</a> (missing_value)</td></tr>
<tr class="separator:a4e63fc6831565737efb531ae0a1bee2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee181e07cdfbf1532cbb563525c7b17" id="r_abee181e07cdfbf1532cbb563525c7b17"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#abee181e07cdfbf1532cbb563525c7b17">test_nan_euclidean_distances_one_feature_match_positive</a> (missing_value)</td></tr>
<tr class="separator:abee181e07cdfbf1532cbb563525c7b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b281dbbf4917682d7db30e7971361e" id="r_af2b281dbbf4917682d7db30e7971361e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#af2b281dbbf4917682d7db30e7971361e">test_cosine_distances</a> ()</td></tr>
<tr class="separator:af2b281dbbf4917682d7db30e7971361e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf373f41b77dffe551006c941111628" id="r_a7cf373f41b77dffe551006c941111628"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a7cf373f41b77dffe551006c941111628">test_haversine_distances</a> ()</td></tr>
<tr class="separator:a7cf373f41b77dffe551006c941111628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa01779ff08f395e8a4c1993949275327" id="r_aa01779ff08f395e8a4c1993949275327"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#aa01779ff08f395e8a4c1993949275327">test_paired_euclidean_distances</a> ()</td></tr>
<tr class="separator:aa01779ff08f395e8a4c1993949275327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f0bc58d3f1f5445d2bc4c17a16fdf5" id="r_aa9f0bc58d3f1f5445d2bc4c17a16fdf5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#aa9f0bc58d3f1f5445d2bc4c17a16fdf5">test_paired_manhattan_distances</a> ()</td></tr>
<tr class="separator:aa9f0bc58d3f1f5445d2bc4c17a16fdf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23826d89a26e68d73bbaedfae3fd641e" id="r_a23826d89a26e68d73bbaedfae3fd641e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a23826d89a26e68d73bbaedfae3fd641e">test_chi_square_kernel</a> ()</td></tr>
<tr class="separator:a23826d89a26e68d73bbaedfae3fd641e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac567a2cddfcde0a609f35dbe07bd18bd" id="r_ac567a2cddfcde0a609f35dbe07bd18bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ac567a2cddfcde0a609f35dbe07bd18bd">test_kernel_symmetry</a> (kernel)</td></tr>
<tr class="separator:ac567a2cddfcde0a609f35dbe07bd18bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e69e67feed1137bf90536e5b7c2864" id="r_a65e69e67feed1137bf90536e5b7c2864"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a65e69e67feed1137bf90536e5b7c2864">test_kernel_sparse</a> (kernel)</td></tr>
<tr class="separator:a65e69e67feed1137bf90536e5b7c2864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f0c5a4b7fab206d2a85f23c355fa75" id="r_a68f0c5a4b7fab206d2a85f23c355fa75"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a68f0c5a4b7fab206d2a85f23c355fa75">test_linear_kernel</a> ()</td></tr>
<tr class="separator:a68f0c5a4b7fab206d2a85f23c355fa75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a069e06ddb41f55e94d9ae532e834659e" id="r_a069e06ddb41f55e94d9ae532e834659e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a069e06ddb41f55e94d9ae532e834659e">test_rbf_kernel</a> ()</td></tr>
<tr class="separator:a069e06ddb41f55e94d9ae532e834659e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4093a7dc87327121876c055abbfadaa" id="r_ac4093a7dc87327121876c055abbfadaa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ac4093a7dc87327121876c055abbfadaa">test_laplacian_kernel</a> ()</td></tr>
<tr class="separator:ac4093a7dc87327121876c055abbfadaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886b0db790a2d09f876eb3ac05dff837" id="r_a886b0db790a2d09f876eb3ac05dff837"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a886b0db790a2d09f876eb3ac05dff837">test_pairwise_similarity_sparse_output</a> (metric, pairwise_func)</td></tr>
<tr class="separator:a886b0db790a2d09f876eb3ac05dff837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a305d6d0629d9054681fb1b02e0301a0a" id="r_a305d6d0629d9054681fb1b02e0301a0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a305d6d0629d9054681fb1b02e0301a0a">test_cosine_similarity</a> ()</td></tr>
<tr class="separator:a305d6d0629d9054681fb1b02e0301a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc0c2cd1b6b00bea681669b306cb8366" id="r_abc0c2cd1b6b00bea681669b306cb8366"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#abc0c2cd1b6b00bea681669b306cb8366">test_check_dense_matrices</a> ()</td></tr>
<tr class="separator:abc0c2cd1b6b00bea681669b306cb8366"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba5fc935c0b26ae43e2a2406198b995" id="r_adba5fc935c0b26ae43e2a2406198b995"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#adba5fc935c0b26ae43e2a2406198b995">test_check_XB_returned</a> ()</td></tr>
<tr class="separator:adba5fc935c0b26ae43e2a2406198b995"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c38a4670fbfa2838dc3fc47e5002f4" id="r_a60c38a4670fbfa2838dc3fc47e5002f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a60c38a4670fbfa2838dc3fc47e5002f4">test_check_different_dimensions</a> ()</td></tr>
<tr class="separator:a60c38a4670fbfa2838dc3fc47e5002f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba48791fe0877d90a980cbc813bdb02" id="r_abba48791fe0877d90a980cbc813bdb02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#abba48791fe0877d90a980cbc813bdb02">test_check_invalid_dimensions</a> ()</td></tr>
<tr class="separator:abba48791fe0877d90a980cbc813bdb02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9511484b5e9f77ecc913a3a57d01464a" id="r_a9511484b5e9f77ecc913a3a57d01464a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a9511484b5e9f77ecc913a3a57d01464a">test_check_sparse_arrays</a> ()</td></tr>
<tr class="separator:a9511484b5e9f77ecc913a3a57d01464a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66785c9d27cb8f122ac5293b026b387a" id="r_a66785c9d27cb8f122ac5293b026b387a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a66785c9d27cb8f122ac5293b026b387a">tuplify</a> (X)</td></tr>
<tr class="separator:a66785c9d27cb8f122ac5293b026b387a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4057ed66fcc85eaba4b68e60eda1cbe3" id="r_a4057ed66fcc85eaba4b68e60eda1cbe3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a4057ed66fcc85eaba4b68e60eda1cbe3">test_check_tuple_input</a> ()</td></tr>
<tr class="separator:a4057ed66fcc85eaba4b68e60eda1cbe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aa498e2ac3c572c62b83d82ebe1f015" id="r_a2aa498e2ac3c572c62b83d82ebe1f015"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a2aa498e2ac3c572c62b83d82ebe1f015">test_check_preserve_type</a> ()</td></tr>
<tr class="separator:a2aa498e2ac3c572c62b83d82ebe1f015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60254b9aef7dfdfb7ca74d7985fe8503" id="r_a60254b9aef7dfdfb7ca74d7985fe8503"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a60254b9aef7dfdfb7ca74d7985fe8503">test_pairwise_distances_data_derived_params</a> (n_jobs, metric, dist_function)</td></tr>
<tr class="separator:a60254b9aef7dfdfb7ca74d7985fe8503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab78cb361439277ed6033741a47c49a5d" id="r_ab78cb361439277ed6033741a47c49a5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#ab78cb361439277ed6033741a47c49a5d">test_pairwise_distances_data_derived_params_error</a> (metric)</td></tr>
<tr class="separator:ab78cb361439277ed6033741a47c49a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c1bee6b30c6bcdce6435db4803b581" id="r_a69c1bee6b30c6bcdce6435db4803b581"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#a69c1bee6b30c6bcdce6435db4803b581">test_numeric_pairwise_distances_datatypes</a> (metric, global_dtype, y_is_x)</td></tr>
<tr class="separator:a69c1bee6b30c6bcdce6435db4803b581"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afee96f45c000c45e1b5574b09fb47f69" id="r_afee96f45c000c45e1b5574b09fb47f69"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#afee96f45c000c45e1b5574b09fb47f69">_minkowski_kwds</a> = {&quot;w&quot;: np.arange(1, 5).astype(&quot;double&quot;, copy=False), &quot;p&quot;: 1}</td></tr>
<tr class="separator:afee96f45c000c45e1b5574b09fb47f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed7b349fa5e347bb189140504c84300f" id="r_aed7b349fa5e347bb189140504c84300f"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1metrics_1_1tests_1_1test__pairwise.html#aed7b349fa5e347bb189140504c84300f">_wminkowski_kwds</a> = {&quot;w&quot;: np.arange(1, 5).astype(&quot;double&quot;, copy=False), &quot;p&quot;: 1}</td></tr>
<tr class="separator:aed7b349fa5e347bb189140504c84300f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0870f26b75a01461ef96c643620bb7bc" name="a0870f26b75a01461ef96c643620bb7bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0870f26b75a01461ef96c643620bb7bc">&#9670;&#160;</a></span>_reduce_func()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise._reduce_func </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  595</span><span class="keyword">def </span>_reduce_func(dist, start):</div>
<div class="line"><span class="lineno">  596</span>    <span class="keywordflow">return</span> dist[:, :100]</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a785458d0c5fb2cffd1eb020fcd199ab3" name="a785458d0c5fb2cffd1eb020fcd199ab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a785458d0c5fb2cffd1eb020fcd199ab3">&#9670;&#160;</a></span>callable_rbf_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.callable_rbf_kernel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  296</span><span class="keyword">def </span>callable_rbf_kernel(x, y, **kwds):</div>
<div class="line"><span class="lineno">  297</span>    <span class="comment"># Callable version of pairwise.rbf_kernel.</span></div>
<div class="line"><span class="lineno">  298</span>    K = rbf_kernel(np.atleast_2d(x), np.atleast_2d(y), **kwds)</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">return</span> K</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span><span class="comment"># TODO: Remove filterwarnings in 1.3 when wminkowski is removed</span></div>
<div class="line"><span class="lineno">  303</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:WMinkowskiDistance:FutureWarning:sklearn&quot;)</span></div>
<div class="line"><span class="lineno">  304</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  305</span>    <span class="stringliteral">&quot;func, metric, kwds&quot;</span>,</div>
<div class="line"><span class="lineno">  306</span>    [</div>
<div class="line"><span class="lineno">  307</span>        (pairwise_distances, <span class="stringliteral">&quot;euclidean&quot;</span>, {}),</div>
<div class="line"><span class="lineno">  308</span>        pytest.param(</div>
<div class="line"><span class="lineno">  309</span>            pairwise_distances,</div>
<div class="line"><span class="lineno">  310</span>            minkowski,</div>
<div class="line"><span class="lineno">  311</span>            _minkowski_kwds,</div>
<div class="line"><span class="lineno">  312</span>        ),</div>
<div class="line"><span class="lineno">  313</span>        pytest.param(</div>
<div class="line"><span class="lineno">  314</span>            pairwise_distances,</div>
<div class="line"><span class="lineno">  315</span>            <span class="stringliteral">&quot;minkowski&quot;</span>,</div>
<div class="line"><span class="lineno">  316</span>            _minkowski_kwds,</div>
<div class="line"><span class="lineno">  317</span>        ),</div>
<div class="line"><span class="lineno">  318</span>        pytest.param(</div>
<div class="line"><span class="lineno">  319</span>            pairwise_distances,</div>
<div class="line"><span class="lineno">  320</span>            wminkowski,</div>
<div class="line"><span class="lineno">  321</span>            _wminkowski_kwds,</div>
<div class="line"><span class="lineno">  322</span>            marks=pytest.mark.skipif(</div>
<div class="line"><span class="lineno">  323</span>                sp_version &gt;= parse_version(<span class="stringliteral">&quot;1.6.0&quot;</span>),</div>
<div class="line"><span class="lineno">  324</span>                reason=<span class="stringliteral">&quot;wminkowski is now minkowski and it has been already tested.&quot;</span>,</div>
<div class="line"><span class="lineno">  325</span>            ),</div>
<div class="line"><span class="lineno">  326</span>        ),</div>
<div class="line"><span class="lineno">  327</span>        pytest.param(</div>
<div class="line"><span class="lineno">  328</span>            pairwise_distances,</div>
<div class="line"><span class="lineno">  329</span>            <span class="stringliteral">&quot;wminkowski&quot;</span>,</div>
<div class="line"><span class="lineno">  330</span>            _wminkowski_kwds,</div>
<div class="line"><span class="lineno">  331</span>            marks=pytest.mark.skipif(</div>
<div class="line"><span class="lineno">  332</span>                sp_version &gt;= parse_version(<span class="stringliteral">&quot;1.6.0&quot;</span>),</div>
<div class="line"><span class="lineno">  333</span>                reason=<span class="stringliteral">&quot;wminkowski is now minkowski and it has been already tested.&quot;</span>,</div>
<div class="line"><span class="lineno">  334</span>            ),</div>
<div class="line"><span class="lineno">  335</span>        ),</div>
<div class="line"><span class="lineno">  336</span>        (pairwise_kernels, <span class="stringliteral">&quot;polynomial&quot;</span>, {<span class="stringliteral">&quot;degree&quot;</span>: 1}),</div>
<div class="line"><span class="lineno">  337</span>        (pairwise_kernels, callable_rbf_kernel, {<span class="stringliteral">&quot;gamma&quot;</span>: 0.1}),</div>
<div class="line"><span class="lineno">  338</span>    ],</div>
<div class="line"><span class="lineno">  339</span>)</div>
<div class="line"><span class="lineno">  340</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, [np.float64, np.float32, int])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a645a59f9981c22eb6488aa2f83eb6961" name="a645a59f9981c22eb6488aa2f83eb6961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a645a59f9981c22eb6488aa2f83eb6961">&#9670;&#160;</a></span>check_pairwise_distances_chunked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.check_pairwise_distances_chunked </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>working_memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em> = <code>&quot;euclidean&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  689</span><span class="keyword">def </span>check_pairwise_distances_chunked(X, Y, working_memory, metric=&quot;euclidean&quot;):</div>
<div class="line"><span class="lineno">  690</span>    gen = pairwise_distances_chunked(X, Y, working_memory=working_memory, metric=metric)</div>
<div class="line"><span class="lineno">  691</span>    <span class="keyword">assert</span> isinstance(gen, GeneratorType)</div>
<div class="line"><span class="lineno">  692</span>    blockwise_distances = list(gen)</div>
<div class="line"><span class="lineno">  693</span>    Y = X <span class="keywordflow">if</span> Y <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> Y</div>
<div class="line"><span class="lineno">  694</span>    min_block_mib = len(Y) * 8 * 2**-20</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">for</span> block <span class="keywordflow">in</span> blockwise_distances:</div>
<div class="line"><span class="lineno">  697</span>        memory_used = block.nbytes</div>
<div class="line"><span class="lineno">  698</span>        <span class="keyword">assert</span> memory_used &lt;= max(working_memory, min_block_mib) * 2**20</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>    blockwise_distances = np.vstack(blockwise_distances)</div>
<div class="line"><span class="lineno">  701</span>    S = pairwise_distances(X, Y, metric=metric)</div>
<div class="line"><span class="lineno">  702</span>    assert_allclose(blockwise_distances, S, atol=1e-7)</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span><span class="preprocessor">@pytest.mark.parametrize(&quot;metric&quot;, (&quot;euclidean&quot;, &quot;l2&quot;, &quot;sqeuclidean&quot;)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="abc0c2cd1b6b00bea681669b306cb8366" name="abc0c2cd1b6b00bea681669b306cb8366"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc0c2cd1b6b00bea681669b306cb8366">&#9670;&#160;</a></span>test_check_dense_matrices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_check_dense_matrices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1352</span><span class="keyword">def </span>test_check_dense_matrices():</div>
<div class="line"><span class="lineno"> 1353</span>    <span class="comment"># Ensure that pairwise array check works for dense matrices.</span></div>
<div class="line"><span class="lineno"> 1354</span>    <span class="comment"># Check that if XB is None, XB is returned as reference to XA</span></div>
<div class="line"><span class="lineno"> 1355</span>    XA = np.resize(np.arange(40), (5, 8))</div>
<div class="line"><span class="lineno"> 1356</span>    XA_checked, XB_checked = check_pairwise_arrays(XA, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1357</span>    <span class="keyword">assert</span> XA_checked <span class="keywordflow">is</span> XB_checked</div>
<div class="line"><span class="lineno"> 1358</span>    assert_array_equal(XA, XA_checked)</div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a60c38a4670fbfa2838dc3fc47e5002f4" name="a60c38a4670fbfa2838dc3fc47e5002f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60c38a4670fbfa2838dc3fc47e5002f4">&#9670;&#160;</a></span>test_check_different_dimensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_check_different_dimensions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1377</span><span class="keyword">def </span>test_check_different_dimensions():</div>
<div class="line"><span class="lineno"> 1378</span>    <span class="comment"># Ensure an error is raised if the dimensions are different.</span></div>
<div class="line"><span class="lineno"> 1379</span>    XA = np.resize(np.arange(45), (5, 9))</div>
<div class="line"><span class="lineno"> 1380</span>    XB = np.resize(np.arange(32), (4, 8))</div>
<div class="line"><span class="lineno"> 1381</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1382</span>        check_pairwise_arrays(XA, XB)</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span>    XB = np.resize(np.arange(4 * 9), (4, 9))</div>
<div class="line"><span class="lineno"> 1385</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1386</span>        check_paired_arrays(XA, XB)</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abba48791fe0877d90a980cbc813bdb02" name="abba48791fe0877d90a980cbc813bdb02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba48791fe0877d90a980cbc813bdb02">&#9670;&#160;</a></span>test_check_invalid_dimensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_check_invalid_dimensions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1389</span><span class="keyword">def </span>test_check_invalid_dimensions():</div>
<div class="line"><span class="lineno"> 1390</span>    <span class="comment"># Ensure an error is raised on 1D input arrays.</span></div>
<div class="line"><span class="lineno"> 1391</span>    <span class="comment"># The modified tests are not 1D. In the old test, the array was internally</span></div>
<div class="line"><span class="lineno"> 1392</span>    <span class="comment"># converted to 2D anyways</span></div>
<div class="line"><span class="lineno"> 1393</span>    XA = np.arange(45).reshape(9, 5)</div>
<div class="line"><span class="lineno"> 1394</span>    XB = np.arange(32).reshape(4, 8)</div>
<div class="line"><span class="lineno"> 1395</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1396</span>        check_pairwise_arrays(XA, XB)</div>
<div class="line"><span class="lineno"> 1397</span>    XA = np.arange(45).reshape(9, 5)</div>
<div class="line"><span class="lineno"> 1398</span>    XB = np.arange(32).reshape(4, 8)</div>
<div class="line"><span class="lineno"> 1399</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1400</span>        check_pairwise_arrays(XA, XB)</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2aa498e2ac3c572c62b83d82ebe1f015" name="a2aa498e2ac3c572c62b83d82ebe1f015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aa498e2ac3c572c62b83d82ebe1f015">&#9670;&#160;</a></span>test_check_preserve_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_check_preserve_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1448</span><span class="keyword">def </span>test_check_preserve_type():</div>
<div class="line"><span class="lineno"> 1449</span>    <span class="comment"># Ensures that type float32 is preserved.</span></div>
<div class="line"><span class="lineno"> 1450</span>    XA = np.resize(np.arange(40), (5, 8)).astype(np.float32)</div>
<div class="line"><span class="lineno"> 1451</span>    XB = np.resize(np.arange(40), (5, 8)).astype(np.float32)</div>
<div class="line"><span class="lineno"> 1452</span> </div>
<div class="line"><span class="lineno"> 1453</span>    XA_checked, XB_checked = check_pairwise_arrays(XA, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1454</span>    <span class="keyword">assert</span> XA_checked.dtype == np.float32</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>    <span class="comment"># both float32</span></div>
<div class="line"><span class="lineno"> 1457</span>    XA_checked, XB_checked = check_pairwise_arrays(XA, XB)</div>
<div class="line"><span class="lineno"> 1458</span>    <span class="keyword">assert</span> XA_checked.dtype == np.float32</div>
<div class="line"><span class="lineno"> 1459</span>    <span class="keyword">assert</span> XB_checked.dtype == np.float32</div>
<div class="line"><span class="lineno"> 1460</span> </div>
<div class="line"><span class="lineno"> 1461</span>    <span class="comment"># mismatched A</span></div>
<div class="line"><span class="lineno"> 1462</span>    XA_checked, XB_checked = check_pairwise_arrays(XA.astype(float), XB)</div>
<div class="line"><span class="lineno"> 1463</span>    <span class="keyword">assert</span> XA_checked.dtype == float</div>
<div class="line"><span class="lineno"> 1464</span>    <span class="keyword">assert</span> XB_checked.dtype == float</div>
<div class="line"><span class="lineno"> 1465</span> </div>
<div class="line"><span class="lineno"> 1466</span>    <span class="comment"># mismatched B</span></div>
<div class="line"><span class="lineno"> 1467</span>    XA_checked, XB_checked = check_pairwise_arrays(XA, XB.astype(float))</div>
<div class="line"><span class="lineno"> 1468</span>    <span class="keyword">assert</span> XA_checked.dtype == float</div>
<div class="line"><span class="lineno"> 1469</span>    <span class="keyword">assert</span> XB_checked.dtype == float</div>
<div class="line"><span class="lineno"> 1470</span> </div>
<div class="line"><span class="lineno"> 1471</span> </div>
<div class="line"><span class="lineno"> 1472</span><span class="preprocessor">@pytest.mark.parametrize(&quot;n_jobs&quot;, [1, 2])</span></div>
<div class="line"><span class="lineno"> 1473</span><span class="preprocessor">@pytest.mark.parametrize(&quot;metric&quot;, [&quot;seuclidean&quot;, &quot;mahalanobis&quot;])</span></div>
<div class="line"><span class="lineno"> 1474</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1475</span>    <span class="stringliteral">&quot;dist_function&quot;</span>, [pairwise_distances, pairwise_distances_chunked]</div>
<div class="line"><span class="lineno"> 1476</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9511484b5e9f77ecc913a3a57d01464a" name="a9511484b5e9f77ecc913a3a57d01464a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9511484b5e9f77ecc913a3a57d01464a">&#9670;&#160;</a></span>test_check_sparse_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_check_sparse_arrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1403</span><span class="keyword">def </span>test_check_sparse_arrays():</div>
<div class="line"><span class="lineno"> 1404</span>    <span class="comment"># Ensures that checks return valid sparse matrices.</span></div>
<div class="line"><span class="lineno"> 1405</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1406</span>    XA = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1407</span>    XA_sparse = csr_matrix(XA)</div>
<div class="line"><span class="lineno"> 1408</span>    XB = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1409</span>    XB_sparse = csr_matrix(XB)</div>
<div class="line"><span class="lineno"> 1410</span>    XA_checked, XB_checked = check_pairwise_arrays(XA_sparse, XB_sparse)</div>
<div class="line"><span class="lineno"> 1411</span>    <span class="comment"># compare their difference because testing csr matrices for</span></div>
<div class="line"><span class="lineno"> 1412</span>    <span class="comment"># equality with &#39;==&#39; does not work as expected.</span></div>
<div class="line"><span class="lineno"> 1413</span>    <span class="keyword">assert</span> issparse(XA_checked)</div>
<div class="line"><span class="lineno"> 1414</span>    <span class="keyword">assert</span> abs(XA_sparse - XA_checked).sum() == 0</div>
<div class="line"><span class="lineno"> 1415</span>    <span class="keyword">assert</span> issparse(XB_checked)</div>
<div class="line"><span class="lineno"> 1416</span>    <span class="keyword">assert</span> abs(XB_sparse - XB_checked).sum() == 0</div>
<div class="line"><span class="lineno"> 1417</span> </div>
<div class="line"><span class="lineno"> 1418</span>    XA_checked, XA_2_checked = check_pairwise_arrays(XA_sparse, XA_sparse)</div>
<div class="line"><span class="lineno"> 1419</span>    <span class="keyword">assert</span> issparse(XA_checked)</div>
<div class="line"><span class="lineno"> 1420</span>    <span class="keyword">assert</span> abs(XA_sparse - XA_checked).sum() == 0</div>
<div class="line"><span class="lineno"> 1421</span>    <span class="keyword">assert</span> issparse(XA_2_checked)</div>
<div class="line"><span class="lineno"> 1422</span>    <span class="keyword">assert</span> abs(XA_2_checked - XA_checked).sum() == 0</div>
<div class="line"><span class="lineno"> 1423</span> </div>
<div class="line"><span class="lineno"> 1424</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4057ed66fcc85eaba4b68e60eda1cbe3" name="a4057ed66fcc85eaba4b68e60eda1cbe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4057ed66fcc85eaba4b68e60eda1cbe3">&#9670;&#160;</a></span>test_check_tuple_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_check_tuple_input </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1436</span><span class="keyword">def </span>test_check_tuple_input():</div>
<div class="line"><span class="lineno"> 1437</span>    <span class="comment"># Ensures that checks return valid tuples.</span></div>
<div class="line"><span class="lineno"> 1438</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1439</span>    XA = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1440</span>    XA_tuples = tuplify(XA)</div>
<div class="line"><span class="lineno"> 1441</span>    XB = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1442</span>    XB_tuples = tuplify(XB)</div>
<div class="line"><span class="lineno"> 1443</span>    XA_checked, XB_checked = check_pairwise_arrays(XA_tuples, XB_tuples)</div>
<div class="line"><span class="lineno"> 1444</span>    assert_array_equal(XA_tuples, XA_checked)</div>
<div class="line"><span class="lineno"> 1445</span>    assert_array_equal(XB_tuples, XB_checked)</div>
<div class="line"><span class="lineno"> 1446</span> </div>
<div class="line"><span class="lineno"> 1447</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adba5fc935c0b26ae43e2a2406198b995" name="adba5fc935c0b26ae43e2a2406198b995"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba5fc935c0b26ae43e2a2406198b995">&#9670;&#160;</a></span>test_check_XB_returned()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_check_XB_returned </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1361</span><span class="keyword">def </span>test_check_XB_returned():</div>
<div class="line"><span class="lineno"> 1362</span>    <span class="comment"># Ensure that if XA and XB are given correctly, they return as equal.</span></div>
<div class="line"><span class="lineno"> 1363</span>    <span class="comment"># Check that if XB is not None, it is returned equal.</span></div>
<div class="line"><span class="lineno"> 1364</span>    <span class="comment"># Note that the second dimension of XB is the same as XA.</span></div>
<div class="line"><span class="lineno"> 1365</span>    XA = np.resize(np.arange(40), (5, 8))</div>
<div class="line"><span class="lineno"> 1366</span>    XB = np.resize(np.arange(32), (4, 8))</div>
<div class="line"><span class="lineno"> 1367</span>    XA_checked, XB_checked = check_pairwise_arrays(XA, XB)</div>
<div class="line"><span class="lineno"> 1368</span>    assert_array_equal(XA, XA_checked)</div>
<div class="line"><span class="lineno"> 1369</span>    assert_array_equal(XB, XB_checked)</div>
<div class="line"><span class="lineno"> 1370</span> </div>
<div class="line"><span class="lineno"> 1371</span>    XB = np.resize(np.arange(40), (5, 8))</div>
<div class="line"><span class="lineno"> 1372</span>    XA_checked, XB_checked = check_paired_arrays(XA, XB)</div>
<div class="line"><span class="lineno"> 1373</span>    assert_array_equal(XA, XA_checked)</div>
<div class="line"><span class="lineno"> 1374</span>    assert_array_equal(XB, XB_checked)</div>
<div class="line"><span class="lineno"> 1375</span> </div>
<div class="line"><span class="lineno"> 1376</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a23826d89a26e68d73bbaedfae3fd641e" name="a23826d89a26e68d73bbaedfae3fd641e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23826d89a26e68d73bbaedfae3fd641e">&#9670;&#160;</a></span>test_chi_square_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_chi_square_kernel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1181</span><span class="keyword">def </span>test_chi_square_kernel():</div>
<div class="line"><span class="lineno"> 1182</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1183</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1184</span>    Y = rng.random_sample((10, 4))</div>
<div class="line"><span class="lineno"> 1185</span>    K_add = additive_chi2_kernel(X, Y)</div>
<div class="line"><span class="lineno"> 1186</span>    gamma = 0.1</div>
<div class="line"><span class="lineno"> 1187</span>    K = chi2_kernel(X, Y, gamma=gamma)</div>
<div class="line"><span class="lineno"> 1188</span>    <span class="keyword">assert</span> K.dtype == float</div>
<div class="line"><span class="lineno"> 1189</span>    <span class="keywordflow">for</span> i, x <span class="keywordflow">in</span> enumerate(X):</div>
<div class="line"><span class="lineno"> 1190</span>        <span class="keywordflow">for</span> j, y <span class="keywordflow">in</span> enumerate(Y):</div>
<div class="line"><span class="lineno"> 1191</span>            chi2 = -np.sum((x - y) ** 2 / (x + y))</div>
<div class="line"><span class="lineno"> 1192</span>            chi2_exp = np.exp(gamma * chi2)</div>
<div class="line"><span class="lineno"> 1193</span>            assert_almost_equal(K_add[i, j], chi2)</div>
<div class="line"><span class="lineno"> 1194</span>            assert_almost_equal(K[i, j], chi2_exp)</div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>    <span class="comment"># check diagonal is ones for data with itself</span></div>
<div class="line"><span class="lineno"> 1197</span>    K = chi2_kernel(Y)</div>
<div class="line"><span class="lineno"> 1198</span>    assert_array_equal(np.diag(K), 1)</div>
<div class="line"><span class="lineno"> 1199</span>    <span class="comment"># check off-diagonal is &lt; 1 but &gt; 0:</span></div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keyword">assert</span> np.all(K &gt; 0)</div>
<div class="line"><span class="lineno"> 1201</span>    <span class="keyword">assert</span> np.all(K - np.diag(np.diag(K)) &lt; 1)</div>
<div class="line"><span class="lineno"> 1202</span>    <span class="comment"># check that float32 is preserved</span></div>
<div class="line"><span class="lineno"> 1203</span>    X = rng.random_sample((5, 4)).astype(np.float32)</div>
<div class="line"><span class="lineno"> 1204</span>    Y = rng.random_sample((10, 4)).astype(np.float32)</div>
<div class="line"><span class="lineno"> 1205</span>    K = chi2_kernel(X, Y)</div>
<div class="line"><span class="lineno"> 1206</span>    <span class="keyword">assert</span> K.dtype == np.float32</div>
<div class="line"><span class="lineno"> 1207</span> </div>
<div class="line"><span class="lineno"> 1208</span>    <span class="comment"># check integer type gets converted,</span></div>
<div class="line"><span class="lineno"> 1209</span>    <span class="comment"># check that zeros are handled</span></div>
<div class="line"><span class="lineno"> 1210</span>    X = rng.random_sample((10, 4)).astype(np.int32)</div>
<div class="line"><span class="lineno"> 1211</span>    K = chi2_kernel(X, X)</div>
<div class="line"><span class="lineno"> 1212</span>    <span class="keyword">assert</span> np.isfinite(K).all()</div>
<div class="line"><span class="lineno"> 1213</span>    <span class="keyword">assert</span> K.dtype == float</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>    <span class="comment"># check that kernel of similar things is greater than dissimilar ones</span></div>
<div class="line"><span class="lineno"> 1216</span>    X = [[0.3, 0.7], [1.0, 0]]</div>
<div class="line"><span class="lineno"> 1217</span>    Y = [[0, 1], [0.9, 0.1]]</div>
<div class="line"><span class="lineno"> 1218</span>    K = chi2_kernel(X, Y)</div>
<div class="line"><span class="lineno"> 1219</span>    <span class="keyword">assert</span> K[0, 0] &gt; K[0, 1]</div>
<div class="line"><span class="lineno"> 1220</span>    <span class="keyword">assert</span> K[1, 1] &gt; K[1, 0]</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>    <span class="comment"># test negative input</span></div>
<div class="line"><span class="lineno"> 1223</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1224</span>        chi2_kernel([[0, -1]])</div>
<div class="line"><span class="lineno"> 1225</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1226</span>        chi2_kernel([[0, -1]], [[-1, -1]])</div>
<div class="line"><span class="lineno"> 1227</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1228</span>        chi2_kernel([[0, 1]], [[-1, -1]])</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>    <span class="comment"># different n_features in X and Y</span></div>
<div class="line"><span class="lineno"> 1231</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1232</span>        chi2_kernel([[0, 1]], [[0.2, 0.2, 0.6]])</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>    <span class="comment"># sparse matrices</span></div>
<div class="line"><span class="lineno"> 1235</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1236</span>        chi2_kernel(csr_matrix(X), csr_matrix(Y))</div>
<div class="line"><span class="lineno"> 1237</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1238</span>        additive_chi2_kernel(csr_matrix(X), csr_matrix(Y))</div>
<div class="line"><span class="lineno"> 1239</span> </div>
<div class="line"><span class="lineno"> 1240</span> </div>
<div class="line"><span class="lineno"> 1241</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1242</span>    <span class="stringliteral">&quot;kernel&quot;</span>,</div>
<div class="line"><span class="lineno"> 1243</span>    (</div>
<div class="line"><span class="lineno"> 1244</span>        linear_kernel,</div>
<div class="line"><span class="lineno"> 1245</span>        polynomial_kernel,</div>
<div class="line"><span class="lineno"> 1246</span>        rbf_kernel,</div>
<div class="line"><span class="lineno"> 1247</span>        laplacian_kernel,</div>
<div class="line"><span class="lineno"> 1248</span>        sigmoid_kernel,</div>
<div class="line"><span class="lineno"> 1249</span>        cosine_similarity,</div>
<div class="line"><span class="lineno"> 1250</span>    ),</div>
<div class="line"><span class="lineno"> 1251</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2b281dbbf4917682d7db30e7971361e" name="af2b281dbbf4917682d7db30e7971361e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2b281dbbf4917682d7db30e7971361e">&#9670;&#160;</a></span>test_cosine_distances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_cosine_distances </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1108</span><span class="keyword">def </span>test_cosine_distances():</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="comment"># Check the pairwise Cosine distances computation</span></div>
<div class="line"><span class="lineno"> 1110</span>    rng = np.random.RandomState(1337)</div>
<div class="line"><span class="lineno"> 1111</span>    x = np.abs(rng.rand(910))</div>
<div class="line"><span class="lineno"> 1112</span>    XA = np.vstack([x, x])</div>
<div class="line"><span class="lineno"> 1113</span>    D = cosine_distances(XA)</div>
<div class="line"><span class="lineno"> 1114</span>    assert_allclose(D, [[0.0, 0.0], [0.0, 0.0]], atol=1e-10)</div>
<div class="line"><span class="lineno"> 1115</span>    <span class="comment"># check that all elements are in [0, 2]</span></div>
<div class="line"><span class="lineno"> 1116</span>    <span class="keyword">assert</span> np.all(D &gt;= 0.0)</div>
<div class="line"><span class="lineno"> 1117</span>    <span class="keyword">assert</span> np.all(D &lt;= 2.0)</div>
<div class="line"><span class="lineno"> 1118</span>    <span class="comment"># check that diagonal elements are equal to 0</span></div>
<div class="line"><span class="lineno"> 1119</span>    assert_allclose(D[np.diag_indices_from(D)], [0.0, 0.0])</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>    XB = np.vstack([x, -x])</div>
<div class="line"><span class="lineno"> 1122</span>    D2 = cosine_distances(XB)</div>
<div class="line"><span class="lineno"> 1123</span>    <span class="comment"># check that all elements are in [0, 2]</span></div>
<div class="line"><span class="lineno"> 1124</span>    <span class="keyword">assert</span> np.all(D2 &gt;= 0.0)</div>
<div class="line"><span class="lineno"> 1125</span>    <span class="keyword">assert</span> np.all(D2 &lt;= 2.0)</div>
<div class="line"><span class="lineno"> 1126</span>    <span class="comment"># check that diagonal elements are equal to 0 and non diagonal to 2</span></div>
<div class="line"><span class="lineno"> 1127</span>    assert_allclose(D2, [[0.0, 2.0], [2.0, 0.0]])</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment"># check large random matrix</span></div>
<div class="line"><span class="lineno"> 1130</span>    X = np.abs(rng.rand(1000, 5000))</div>
<div class="line"><span class="lineno"> 1131</span>    D = cosine_distances(X)</div>
<div class="line"><span class="lineno"> 1132</span>    <span class="comment"># check that diagonal elements are equal to 0</span></div>
<div class="line"><span class="lineno"> 1133</span>    assert_allclose(D[np.diag_indices_from(D)], [0.0] * D.shape[0])</div>
<div class="line"><span class="lineno"> 1134</span>    <span class="keyword">assert</span> np.all(D &gt;= 0.0)</div>
<div class="line"><span class="lineno"> 1135</span>    <span class="keyword">assert</span> np.all(D &lt;= 2.0)</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a305d6d0629d9054681fb1b02e0301a0a" name="a305d6d0629d9054681fb1b02e0301a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a305d6d0629d9054681fb1b02e0301a0a">&#9670;&#160;</a></span>test_cosine_similarity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_cosine_similarity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1332</span><span class="keyword">def </span>test_cosine_similarity():</div>
<div class="line"><span class="lineno"> 1333</span>    <span class="comment"># Test the cosine_similarity.</span></div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1336</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1337</span>    Y = rng.random_sample((3, 4))</div>
<div class="line"><span class="lineno"> 1338</span>    Xcsr = csr_matrix(X)</div>
<div class="line"><span class="lineno"> 1339</span>    Ycsr = csr_matrix(Y)</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>    <span class="keywordflow">for</span> X_, Y_ <span class="keywordflow">in</span> ((X, <span class="keywordtype">None</span>), (X, Y), (Xcsr, <span class="keywordtype">None</span>), (Xcsr, Ycsr)):</div>
<div class="line"><span class="lineno"> 1342</span>        <span class="comment"># Test that the cosine is kernel is equal to a linear kernel when data</span></div>
<div class="line"><span class="lineno"> 1343</span>        <span class="comment"># has been previously normalized by L2-norm.</span></div>
<div class="line"><span class="lineno"> 1344</span>        K1 = pairwise_kernels(X_, Y=Y_, metric=<span class="stringliteral">&quot;cosine&quot;</span>)</div>
<div class="line"><span class="lineno"> 1345</span>        X_ = normalize(X_)</div>
<div class="line"><span class="lineno"> 1346</span>        <span class="keywordflow">if</span> Y_ <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1347</span>            Y_ = normalize(Y_)</div>
<div class="line"><span class="lineno"> 1348</span>        K2 = pairwise_kernels(X_, Y=Y_, metric=<span class="stringliteral">&quot;linear&quot;</span>)</div>
<div class="line"><span class="lineno"> 1349</span>        assert_allclose(K1, K2)</div>
<div class="line"><span class="lineno"> 1350</span> </div>
<div class="line"><span class="lineno"> 1351</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a86173199d0fef029d090579ee00fd693" name="a86173199d0fef029d090579ee00fd693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86173199d0fef029d090579ee00fd693">&#9670;&#160;</a></span>test_euclidean_distances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_euclidean_distances </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_array_constr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  851</span><span class="keyword">def </span>test_euclidean_distances(global_dtype, x_array_constr, y_array_constr):</div>
<div class="line"><span class="lineno">  852</span>    <span class="comment"># check that euclidean distances gives same result as scipy cdist</span></div>
<div class="line"><span class="lineno">  853</span>    <span class="comment"># when X and Y != X are provided</span></div>
<div class="line"><span class="lineno">  854</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  855</span>    X = rng.random_sample((100, 10)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  856</span>    X[X &lt; 0.8] = 0</div>
<div class="line"><span class="lineno">  857</span>    Y = rng.random_sample((10, 10)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  858</span>    Y[Y &lt; 0.8] = 0</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>    expected = cdist(X, Y)</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>    X = x_array_constr(X)</div>
<div class="line"><span class="lineno">  863</span>    Y = y_array_constr(Y)</div>
<div class="line"><span class="lineno">  864</span>    distances = euclidean_distances(X, Y)</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>    <span class="comment"># the default rtol=1e-7 is too close to the float32 precision</span></div>
<div class="line"><span class="lineno">  867</span>    <span class="comment"># and fails due to rounding errors.</span></div>
<div class="line"><span class="lineno">  868</span>    assert_allclose(distances, expected, rtol=1e-6)</div>
<div class="line"><span class="lineno">  869</span>    <span class="keyword">assert</span> distances.dtype == global_dtype</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  873</span>    <span class="stringliteral">&quot;x_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  874</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f9eb725d44fac8749de25846a652d09" name="a0f9eb725d44fac8749de25846a652d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f9eb725d44fac8749de25846a652d09">&#9670;&#160;</a></span>test_euclidean_distances_extreme_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_euclidean_distances_extreme_values </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  954</span><span class="keyword">def </span>test_euclidean_distances_extreme_values(dtype, eps, rtol, dim):</div>
<div class="line"><span class="lineno">  955</span>    <span class="comment"># check that euclidean distances is correct with float32 input thanks to</span></div>
<div class="line"><span class="lineno">  956</span>    <span class="comment"># upcasting. On float64 there are still precision issues.</span></div>
<div class="line"><span class="lineno">  957</span>    X = np.array([[1.0] * dim], dtype=dtype)</div>
<div class="line"><span class="lineno">  958</span>    Y = np.array([[1.0 + eps] * dim], dtype=dtype)</div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>    distances = euclidean_distances(X, Y)</div>
<div class="line"><span class="lineno">  961</span>    expected = cdist(X, Y)</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span>    assert_allclose(distances, expected, rtol=1e-5)</div>
<div class="line"><span class="lineno">  964</span> </div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span><span class="preprocessor">@pytest.mark.parametrize(&quot;squared&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad66e455761acf87381e32a6b2a2d876f" name="ad66e455761acf87381e32a6b2a2d876f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad66e455761acf87381e32a6b2a2d876f">&#9670;&#160;</a></span>test_euclidean_distances_known_result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_euclidean_distances_known_result </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_array_constr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  768</span><span class="keyword">def </span>test_euclidean_distances_known_result(x_array_constr, y_array_constr):</div>
<div class="line"><span class="lineno">  769</span>    <span class="comment"># Check the pairwise Euclidean distances computation on known result</span></div>
<div class="line"><span class="lineno">  770</span>    X = x_array_constr([[0]])</div>
<div class="line"><span class="lineno">  771</span>    Y = y_array_constr([[1], [2]])</div>
<div class="line"><span class="lineno">  772</span>    D = euclidean_distances(X, Y)</div>
<div class="line"><span class="lineno">  773</span>    assert_allclose(D, [[1.0, 2.0]])</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  777</span>    <span class="stringliteral">&quot;y_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  778</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6dcfbccdad503752e4244c6f00bef9d5" name="a6dcfbccdad503752e4244c6f00bef9d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dcfbccdad503752e4244c6f00bef9d5">&#9670;&#160;</a></span>test_euclidean_distances_norm_shapes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_euclidean_distances_norm_shapes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  811</span><span class="keyword">def </span>test_euclidean_distances_norm_shapes():</div>
<div class="line"><span class="lineno">  812</span>    <span class="comment"># Check all accepted shapes for the norms or appropriate error messages.</span></div>
<div class="line"><span class="lineno">  813</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  814</span>    X = rng.random_sample((10, 10))</div>
<div class="line"><span class="lineno">  815</span>    Y = rng.random_sample((20, 10))</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    X_norm_squared = (X**2).sum(axis=1)</div>
<div class="line"><span class="lineno">  818</span>    Y_norm_squared = (Y**2).sum(axis=1)</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>    D1 = euclidean_distances(</div>
<div class="line"><span class="lineno">  821</span>        X, Y, X_norm_squared=X_norm_squared, Y_norm_squared=Y_norm_squared</div>
<div class="line"><span class="lineno">  822</span>    )</div>
<div class="line"><span class="lineno">  823</span>    D2 = euclidean_distances(</div>
<div class="line"><span class="lineno">  824</span>        X,</div>
<div class="line"><span class="lineno">  825</span>        Y,</div>
<div class="line"><span class="lineno">  826</span>        X_norm_squared=X_norm_squared.reshape(-1, 1),</div>
<div class="line"><span class="lineno">  827</span>        Y_norm_squared=Y_norm_squared.reshape(-1, 1),</div>
<div class="line"><span class="lineno">  828</span>    )</div>
<div class="line"><span class="lineno">  829</span>    D3 = euclidean_distances(</div>
<div class="line"><span class="lineno">  830</span>        X,</div>
<div class="line"><span class="lineno">  831</span>        Y,</div>
<div class="line"><span class="lineno">  832</span>        X_norm_squared=X_norm_squared.reshape(1, -1),</div>
<div class="line"><span class="lineno">  833</span>        Y_norm_squared=Y_norm_squared.reshape(1, -1),</div>
<div class="line"><span class="lineno">  834</span>    )</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>    assert_allclose(D2, D1)</div>
<div class="line"><span class="lineno">  837</span>    assert_allclose(D3, D1)</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;Incompatible dimensions for X&quot;</span>):</div>
<div class="line"><span class="lineno">  840</span>        euclidean_distances(X, Y, X_norm_squared=X_norm_squared[:5])</div>
<div class="line"><span class="lineno">  841</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;Incompatible dimensions for Y&quot;</span>):</div>
<div class="line"><span class="lineno">  842</span>        euclidean_distances(X, Y, Y_norm_squared=Y_norm_squared[:5])</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  846</span>    <span class="stringliteral">&quot;x_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  847</span>)</div>
<div class="line"><span class="lineno">  848</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  849</span>    <span class="stringliteral">&quot;y_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  850</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ce526a2520e7e2b8aafdbc9ff2e3b1a" name="a5ce526a2520e7e2b8aafdbc9ff2e3b1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ce526a2520e7e2b8aafdbc9ff2e3b1a">&#9670;&#160;</a></span>test_euclidean_distances_sym()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_euclidean_distances_sym </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_array_constr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  875</span><span class="keyword">def </span>test_euclidean_distances_sym(global_dtype, x_array_constr):</div>
<div class="line"><span class="lineno">  876</span>    <span class="comment"># check that euclidean distances gives same result as scipy pdist</span></div>
<div class="line"><span class="lineno">  877</span>    <span class="comment"># when only X is provided</span></div>
<div class="line"><span class="lineno">  878</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  879</span>    X = rng.random_sample((100, 10)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  880</span>    X[X &lt; 0.8] = 0</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>    expected = squareform(pdist(X))</div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>    X = x_array_constr(X)</div>
<div class="line"><span class="lineno">  885</span>    distances = euclidean_distances(X)</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span>    <span class="comment"># the default rtol=1e-7 is too close to the float32 precision</span></div>
<div class="line"><span class="lineno">  888</span>    <span class="comment"># and fails due to rounding errors.</span></div>
<div class="line"><span class="lineno">  889</span>    assert_allclose(distances, expected, rtol=1e-6)</div>
<div class="line"><span class="lineno">  890</span>    <span class="keyword">assert</span> distances.dtype == global_dtype</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span><span class="preprocessor">@pytest.mark.parametrize(&quot;batch_size&quot;, [None, 5, 7, 101])</span></div>
<div class="line"><span class="lineno">  894</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  895</span>    <span class="stringliteral">&quot;x_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  896</span>)</div>
<div class="line"><span class="lineno">  897</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  898</span>    <span class="stringliteral">&quot;y_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  899</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a41fdded1fb3c6f5003d4ad6406581e3c" name="a41fdded1fb3c6f5003d4ad6406581e3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41fdded1fb3c6f5003d4ad6406581e3c">&#9670;&#160;</a></span>test_euclidean_distances_upcast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_euclidean_distances_upcast </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_array_constr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_array_constr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  900</span><span class="keyword">def </span>test_euclidean_distances_upcast(batch_size, x_array_constr, y_array_constr):</div>
<div class="line"><span class="lineno">  901</span>    <span class="comment"># check batches handling when Y != X (#13910)</span></div>
<div class="line"><span class="lineno">  902</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  903</span>    X = rng.random_sample((100, 10)).astype(np.float32)</div>
<div class="line"><span class="lineno">  904</span>    X[X &lt; 0.8] = 0</div>
<div class="line"><span class="lineno">  905</span>    Y = rng.random_sample((10, 10)).astype(np.float32)</div>
<div class="line"><span class="lineno">  906</span>    Y[Y &lt; 0.8] = 0</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>    expected = cdist(X, Y)</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>    X = x_array_constr(X)</div>
<div class="line"><span class="lineno">  911</span>    Y = y_array_constr(Y)</div>
<div class="line"><span class="lineno">  912</span>    distances = _euclidean_distances_upcast(X, Y=Y, batch_size=batch_size)</div>
<div class="line"><span class="lineno">  913</span>    distances = np.sqrt(np.maximum(distances, 0))</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>    <span class="comment"># the default rtol=1e-7 is too close to the float32 precision</span></div>
<div class="line"><span class="lineno">  916</span>    <span class="comment"># and fails due to rounding errors.</span></div>
<div class="line"><span class="lineno">  917</span>    assert_allclose(distances, expected, rtol=1e-6)</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span><span class="preprocessor">@pytest.mark.parametrize(&quot;batch_size&quot;, [None, 5, 7, 101])</span></div>
<div class="line"><span class="lineno">  921</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  922</span>    <span class="stringliteral">&quot;x_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  923</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a711c876a565d2382ba748aa7b1e0a33f" name="a711c876a565d2382ba748aa7b1e0a33f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a711c876a565d2382ba748aa7b1e0a33f">&#9670;&#160;</a></span>test_euclidean_distances_upcast_sym()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_euclidean_distances_upcast_sym </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_array_constr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  924</span><span class="keyword">def </span>test_euclidean_distances_upcast_sym(batch_size, x_array_constr):</div>
<div class="line"><span class="lineno">  925</span>    <span class="comment"># check batches handling when X is Y (#13910)</span></div>
<div class="line"><span class="lineno">  926</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  927</span>    X = rng.random_sample((100, 10)).astype(np.float32)</div>
<div class="line"><span class="lineno">  928</span>    X[X &lt; 0.8] = 0</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span>    expected = squareform(pdist(X))</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>    X = x_array_constr(X)</div>
<div class="line"><span class="lineno">  933</span>    distances = _euclidean_distances_upcast(X, Y=X, batch_size=batch_size)</div>
<div class="line"><span class="lineno">  934</span>    distances = np.sqrt(np.maximum(distances, 0))</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>    <span class="comment"># the default rtol=1e-7 is too close to the float32 precision</span></div>
<div class="line"><span class="lineno">  937</span>    <span class="comment"># and fails due to rounding errors.</span></div>
<div class="line"><span class="lineno">  938</span>    assert_allclose(distances, expected, rtol=1e-6)</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  942</span>    <span class="stringliteral">&quot;dtype, eps, rtol&quot;</span>,</div>
<div class="line"><span class="lineno">  943</span>    [</div>
<div class="line"><span class="lineno">  944</span>        (np.float32, 1e-4, 1e-5),</div>
<div class="line"><span class="lineno">  945</span>        pytest.param(</div>
<div class="line"><span class="lineno">  946</span>            np.float64,</div>
<div class="line"><span class="lineno">  947</span>            1e-8,</div>
<div class="line"><span class="lineno">  948</span>            0.99,</div>
<div class="line"><span class="lineno">  949</span>            marks=pytest.mark.xfail(reason=<span class="stringliteral">&quot;failing due to lack of precision&quot;</span>),</div>
<div class="line"><span class="lineno">  950</span>        ),</div>
<div class="line"><span class="lineno">  951</span>    ],</div>
<div class="line"><span class="lineno">  952</span>)</div>
<div class="line"><span class="lineno">  953</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dim&quot;, [1, 1000000])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac395f0f6fa093d4b9f2a9f2ab7f1c71b" name="ac395f0f6fa093d4b9f2a9f2ab7f1c71b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac395f0f6fa093d4b9f2a9f2ab7f1c71b">&#9670;&#160;</a></span>test_euclidean_distances_with_norms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_euclidean_distances_with_norms </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_array_constr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  779</span><span class="keyword">def </span>test_euclidean_distances_with_norms(global_dtype, y_array_constr):</div>
<div class="line"><span class="lineno">  780</span>    <span class="comment"># check that we still get the right answers with {X,Y}_norm_squared</span></div>
<div class="line"><span class="lineno">  781</span>    <span class="comment"># and that we get a wrong answer with wrong {X,Y}_norm_squared</span></div>
<div class="line"><span class="lineno">  782</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  783</span>    X = rng.random_sample((10, 10)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  784</span>    Y = rng.random_sample((20, 10)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>    <span class="comment"># norms will only be used if their dtype is float64</span></div>
<div class="line"><span class="lineno">  787</span>    X_norm_sq = (X.astype(np.float64) ** 2).sum(axis=1).reshape(1, -1)</div>
<div class="line"><span class="lineno">  788</span>    Y_norm_sq = (Y.astype(np.float64) ** 2).sum(axis=1).reshape(1, -1)</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>    Y = y_array_constr(Y)</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    D1 = euclidean_distances(X, Y)</div>
<div class="line"><span class="lineno">  793</span>    D2 = euclidean_distances(X, Y, X_norm_squared=X_norm_sq)</div>
<div class="line"><span class="lineno">  794</span>    D3 = euclidean_distances(X, Y, Y_norm_squared=Y_norm_sq)</div>
<div class="line"><span class="lineno">  795</span>    D4 = euclidean_distances(X, Y, X_norm_squared=X_norm_sq, Y_norm_squared=Y_norm_sq)</div>
<div class="line"><span class="lineno">  796</span>    assert_allclose(D2, D1)</div>
<div class="line"><span class="lineno">  797</span>    assert_allclose(D3, D1)</div>
<div class="line"><span class="lineno">  798</span>    assert_allclose(D4, D1)</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    <span class="comment"># check we get the wrong answer with wrong {X,Y}_norm_squared</span></div>
<div class="line"><span class="lineno">  801</span>    wrong_D = euclidean_distances(</div>
<div class="line"><span class="lineno">  802</span>        X,</div>
<div class="line"><span class="lineno">  803</span>        Y,</div>
<div class="line"><span class="lineno">  804</span>        X_norm_squared=np.zeros_like(X_norm_sq),</div>
<div class="line"><span class="lineno">  805</span>        Y_norm_squared=np.zeros_like(Y_norm_sq),</div>
<div class="line"><span class="lineno">  806</span>    )</div>
<div class="line"><span class="lineno">  807</span>    <span class="keyword">with</span> pytest.raises(AssertionError):</div>
<div class="line"><span class="lineno">  808</span>        assert_allclose(wrong_D, D1)</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cf373f41b77dffe551006c941111628" name="a7cf373f41b77dffe551006c941111628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cf373f41b77dffe551006c941111628">&#9670;&#160;</a></span>test_haversine_distances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_haversine_distances </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1138</span><span class="keyword">def </span>test_haversine_distances():</div>
<div class="line"><span class="lineno"> 1139</span>    <span class="comment"># Check haversine distance with distances computation</span></div>
<div class="line"><span class="lineno"> 1140</span>    <span class="keyword">def </span>slow_haversine_distances(x, y):</div>
<div class="line"><span class="lineno"> 1141</span>        diff_lat = y[0] - x[0]</div>
<div class="line"><span class="lineno"> 1142</span>        diff_lon = y[1] - x[1]</div>
<div class="line"><span class="lineno"> 1143</span>        a = np.sin(diff_lat / 2) ** 2 + (</div>
<div class="line"><span class="lineno"> 1144</span>            np.cos(x[0]) * np.cos(y[0]) * np.sin(diff_lon / 2) ** 2</div>
<div class="line"><span class="lineno"> 1145</span>        )</div>
<div class="line"><span class="lineno"> 1146</span>        c = 2 * np.arcsin(np.sqrt(a))</div>
<div class="line"><span class="lineno"> 1147</span>        <span class="keywordflow">return</span> c</div>
<div class="line"><span class="lineno"> 1148</span> </div>
<div class="line"><span class="lineno"> 1149</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1150</span>    X = rng.random_sample((5, 2))</div>
<div class="line"><span class="lineno"> 1151</span>    Y = rng.random_sample((10, 2))</div>
<div class="line"><span class="lineno"> 1152</span>    D1 = np.array([[slow_haversine_distances(x, y) <span class="keywordflow">for</span> y <span class="keywordflow">in</span> Y] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> X])</div>
<div class="line"><span class="lineno"> 1153</span>    D2 = haversine_distances(X, Y)</div>
<div class="line"><span class="lineno"> 1154</span>    assert_allclose(D1, D2)</div>
<div class="line"><span class="lineno"> 1155</span>    <span class="comment"># Test haversine distance does not accept X where n_feature != 2</span></div>
<div class="line"><span class="lineno"> 1156</span>    X = rng.random_sample((10, 3))</div>
<div class="line"><span class="lineno"> 1157</span>    err_msg = <span class="stringliteral">&quot;Haversine distance only valid in 2 dimensions&quot;</span></div>
<div class="line"><span class="lineno"> 1158</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=err_msg):</div>
<div class="line"><span class="lineno"> 1159</span>        haversine_distances(X)</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span><span class="comment"># Paired distances</span></div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a65e69e67feed1137bf90536e5b7c2864" name="a65e69e67feed1137bf90536e5b7c2864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65e69e67feed1137bf90536e5b7c2864">&#9670;&#160;</a></span>test_kernel_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_kernel_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1271</span><span class="keyword">def </span>test_kernel_sparse(kernel):</div>
<div class="line"><span class="lineno"> 1272</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1273</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1274</span>    X_sparse = csr_matrix(X)</div>
<div class="line"><span class="lineno"> 1275</span>    K = kernel(X, X)</div>
<div class="line"><span class="lineno"> 1276</span>    K2 = kernel(X_sparse, X_sparse)</div>
<div class="line"><span class="lineno"> 1277</span>    assert_allclose(K, K2)</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac567a2cddfcde0a609f35dbe07bd18bd" name="ac567a2cddfcde0a609f35dbe07bd18bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac567a2cddfcde0a609f35dbe07bd18bd">&#9670;&#160;</a></span>test_kernel_symmetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_kernel_symmetry </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1252</span><span class="keyword">def </span>test_kernel_symmetry(kernel):</div>
<div class="line"><span class="lineno"> 1253</span>    <span class="comment"># Valid kernels should be symmetric</span></div>
<div class="line"><span class="lineno"> 1254</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1255</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1256</span>    K = kernel(X, X)</div>
<div class="line"><span class="lineno"> 1257</span>    assert_allclose(K, K.T, 15)</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1261</span>    <span class="stringliteral">&quot;kernel&quot;</span>,</div>
<div class="line"><span class="lineno"> 1262</span>    (</div>
<div class="line"><span class="lineno"> 1263</span>        linear_kernel,</div>
<div class="line"><span class="lineno"> 1264</span>        polynomial_kernel,</div>
<div class="line"><span class="lineno"> 1265</span>        rbf_kernel,</div>
<div class="line"><span class="lineno"> 1266</span>        laplacian_kernel,</div>
<div class="line"><span class="lineno"> 1267</span>        sigmoid_kernel,</div>
<div class="line"><span class="lineno"> 1268</span>        cosine_similarity,</div>
<div class="line"><span class="lineno"> 1269</span>    ),</div>
<div class="line"><span class="lineno"> 1270</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4093a7dc87327121876c055abbfadaa" name="ac4093a7dc87327121876c055abbfadaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4093a7dc87327121876c055abbfadaa">&#9670;&#160;</a></span>test_laplacian_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_laplacian_kernel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1296</span><span class="keyword">def </span>test_laplacian_kernel():</div>
<div class="line"><span class="lineno"> 1297</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1298</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1299</span>    K = laplacian_kernel(X, X)</div>
<div class="line"><span class="lineno"> 1300</span>    <span class="comment"># the diagonal elements of a laplacian kernel are 1</span></div>
<div class="line"><span class="lineno"> 1301</span>    assert_allclose(np.diag(K), np.ones(5))</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span>    <span class="comment"># off-diagonal elements are &lt; 1 but &gt; 0:</span></div>
<div class="line"><span class="lineno"> 1304</span>    <span class="keyword">assert</span> np.all(K &gt; 0)</div>
<div class="line"><span class="lineno"> 1305</span>    <span class="keyword">assert</span> np.all(K - np.diag(np.diag(K)) &lt; 1)</div>
<div class="line"><span class="lineno"> 1306</span> </div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1309</span>    <span class="stringliteral">&quot;metric, pairwise_func&quot;</span>, [(<span class="stringliteral">&quot;linear&quot;</span>, linear_kernel), (<span class="stringliteral">&quot;cosine&quot;</span>, cosine_similarity)]</div>
<div class="line"><span class="lineno"> 1310</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a68f0c5a4b7fab206d2a85f23c355fa75" name="a68f0c5a4b7fab206d2a85f23c355fa75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68f0c5a4b7fab206d2a85f23c355fa75">&#9670;&#160;</a></span>test_linear_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_linear_kernel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1280</span><span class="keyword">def </span>test_linear_kernel():</div>
<div class="line"><span class="lineno"> 1281</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1282</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1283</span>    K = linear_kernel(X, X)</div>
<div class="line"><span class="lineno"> 1284</span>    <span class="comment"># the diagonal elements of a linear kernel are their squared norm</span></div>
<div class="line"><span class="lineno"> 1285</span>    assert_allclose(K.flat[::6], [linalg.norm(x) ** 2 <span class="keywordflow">for</span> x <span class="keywordflow">in</span> X])</div>
<div class="line"><span class="lineno"> 1286</span> </div>
<div class="line"><span class="lineno"> 1287</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a93fc4e253d2c81c0f0c764e677219f84" name="a93fc4e253d2c81c0f0c764e677219f84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93fc4e253d2c81c0f0c764e677219f84">&#9670;&#160;</a></span>test_manhattan_distances_deprecated_sum_over_features()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_manhattan_distances_deprecated_sum_over_features </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sum_over_features</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  201</span><span class="keyword">def </span>test_manhattan_distances_deprecated_sum_over_features(sum_over_features):</div>
<div class="line"><span class="lineno">  202</span>    <span class="comment"># Check that future warning is raised when user</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="comment"># enters `sum_over_features` argument.</span></div>
<div class="line"><span class="lineno">  204</span>    X = [[1, 2], [3, 4]]</div>
<div class="line"><span class="lineno">  205</span>    Y = [[1, 2], [0, 3]]</div>
<div class="line"><span class="lineno">  206</span>    <span class="keyword">with</span> pytest.warns(</div>
<div class="line"><span class="lineno">  207</span>        FutureWarning,</div>
<div class="line"><span class="lineno">  208</span>        match=(</div>
<div class="line"><span class="lineno">  209</span>            <span class="stringliteral">&quot;`sum_over_features` is deprecated in version 1.2 and will be&quot;</span></div>
<div class="line"><span class="lineno">  210</span>            <span class="stringliteral">&quot; removed in version 1.4.&quot;</span></div>
<div class="line"><span class="lineno">  211</span>        ),</div>
<div class="line"><span class="lineno">  212</span>    ):</div>
<div class="line"><span class="lineno">  213</span>        manhattan_distances(X, Y, sum_over_features=sum_over_features)</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span><span class="preprocessor">@pytest.mark.parametrize(&quot;metric&quot;, PAIRWISE_BOOLEAN_FUNCTIONS)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8d6c2cef784c5992edfe11eaa9c0fa5" name="ad8d6c2cef784c5992edfe11eaa9c0fa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8d6c2cef784c5992edfe11eaa9c0fa5">&#9670;&#160;</a></span>test_nan_euclidean_distances_2x2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_nan_euclidean_distances_2x2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X_diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>missing_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1004</span><span class="keyword">def </span>test_nan_euclidean_distances_2x2(X, X_diag, missing_value):</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>    exp_dist = np.array([[0.0, X_diag], [X_diag, 0]])</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span>    dist = nan_euclidean_distances(X, missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1009</span>    assert_allclose(exp_dist, dist)</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>    dist_sq = nan_euclidean_distances(X, squared=<span class="keyword">True</span>, missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1012</span>    assert_allclose(exp_dist**2, dist_sq)</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>    dist_two = nan_euclidean_distances(X, X, missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1015</span>    assert_allclose(exp_dist, dist_two)</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>    dist_two_copy = nan_euclidean_distances(X, X.copy(), missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1018</span>    assert_allclose(exp_dist, dist_two_copy)</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span> </div>
<div class="line"><span class="lineno"> 1021</span><span class="preprocessor">@pytest.mark.parametrize(&quot;missing_value&quot;, [np.nan, -1])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5cb418b4ef5c228883d8cbcbbde5f0dc" name="a5cb418b4ef5c228883d8cbcbbde5f0dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cb418b4ef5c228883d8cbcbbde5f0dc">&#9670;&#160;</a></span>test_nan_euclidean_distances_complete_nan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_nan_euclidean_distances_complete_nan </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>missing_value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1022</span><span class="keyword">def </span>test_nan_euclidean_distances_complete_nan(missing_value):</div>
<div class="line"><span class="lineno"> 1023</span>    X = np.array([[missing_value, missing_value], [0, 1]])</div>
<div class="line"><span class="lineno"> 1024</span> </div>
<div class="line"><span class="lineno"> 1025</span>    exp_dist = np.array([[np.nan, np.nan], [np.nan, 0]])</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>    dist = nan_euclidean_distances(X, missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1028</span>    assert_allclose(exp_dist, dist)</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>    dist = nan_euclidean_distances(X, X.copy(), missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1031</span>    assert_allclose(exp_dist, dist)</div>
<div class="line"><span class="lineno"> 1032</span> </div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span><span class="preprocessor">@pytest.mark.parametrize(&quot;missing_value&quot;, [np.nan, -1])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac02888dec707452ef2c9193f0dcd3cb2" name="ac02888dec707452ef2c9193f0dcd3cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac02888dec707452ef2c9193f0dcd3cb2">&#9670;&#160;</a></span>test_nan_euclidean_distances_equal_to_euclidean_distance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_nan_euclidean_distances_equal_to_euclidean_distance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>squared</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  967</span><span class="keyword">def </span>test_nan_euclidean_distances_equal_to_euclidean_distance(squared):</div>
<div class="line"><span class="lineno">  968</span>    <span class="comment"># with no nan values</span></div>
<div class="line"><span class="lineno">  969</span>    rng = np.random.RandomState(1337)</div>
<div class="line"><span class="lineno">  970</span>    X = rng.randn(3, 4)</div>
<div class="line"><span class="lineno">  971</span>    Y = rng.randn(4, 4)</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>    normal_distance = euclidean_distances(X, Y=Y, squared=squared)</div>
<div class="line"><span class="lineno">  974</span>    nan_distance = nan_euclidean_distances(X, Y=Y, squared=squared)</div>
<div class="line"><span class="lineno">  975</span>    assert_allclose(normal_distance, nan_distance)</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span><span class="preprocessor">@pytest.mark.parametrize(&quot;X&quot;, [np.array([[np.inf, 0]])</span>, np.array([[0, -np.inf]])])</div>
<div class="line"><span class="lineno">  979</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Y&quot;, [np.array([[np.inf, 0]])</span>, np.array([[0, -np.inf]]), <span class="keywordtype">None</span>])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ca114cd0699d81893aa282560304891" name="a0ca114cd0699d81893aa282560304891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ca114cd0699d81893aa282560304891">&#9670;&#160;</a></span>test_nan_euclidean_distances_infinite_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_nan_euclidean_distances_infinite_values </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  980</span><span class="keyword">def </span>test_nan_euclidean_distances_infinite_values(X, Y):</div>
<div class="line"><span class="lineno">  981</span> </div>
<div class="line"><span class="lineno">  982</span>    <span class="keyword">with</span> pytest.raises(ValueError) <span class="keyword">as</span> excinfo:</div>
<div class="line"><span class="lineno">  983</span>        nan_euclidean_distances(X, Y=Y)</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>    exp_msg = <span class="stringliteral">&quot;Input contains infinity or a value too large for dtype(&#39;float64&#39;).&quot;</span></div>
<div class="line"><span class="lineno">  986</span>    <span class="keyword">assert</span> exp_msg == str(excinfo.value)</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  990</span>    <span class="stringliteral">&quot;X, X_diag, missing_value&quot;</span>,</div>
<div class="line"><span class="lineno">  991</span>    [</div>
<div class="line"><span class="lineno">  992</span>        (np.array([[0, 1], [1, 0]]), np.sqrt(2), np.nan),</div>
<div class="line"><span class="lineno">  993</span>        (np.array([[0, 1], [1, np.nan]]), np.sqrt(2), np.nan),</div>
<div class="line"><span class="lineno">  994</span>        (np.array([[np.nan, 1], [1, np.nan]]), np.nan, np.nan),</div>
<div class="line"><span class="lineno">  995</span>        (np.array([[np.nan, 1], [np.nan, 0]]), np.sqrt(2), np.nan),</div>
<div class="line"><span class="lineno">  996</span>        (np.array([[0, np.nan], [1, np.nan]]), np.sqrt(2), np.nan),</div>
<div class="line"><span class="lineno">  997</span>        (np.array([[0, 1], [1, 0]]), np.sqrt(2), -1),</div>
<div class="line"><span class="lineno">  998</span>        (np.array([[0, 1], [1, -1]]), np.sqrt(2), -1),</div>
<div class="line"><span class="lineno">  999</span>        (np.array([[-1, 1], [1, -1]]), np.nan, -1),</div>
<div class="line"><span class="lineno"> 1000</span>        (np.array([[-1, 1], [-1, 0]]), np.sqrt(2), -1),</div>
<div class="line"><span class="lineno"> 1001</span>        (np.array([[0, -1], [1, -1]]), np.sqrt(2), -1),</div>
<div class="line"><span class="lineno"> 1002</span>    ],</div>
<div class="line"><span class="lineno"> 1003</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e63fc6831565737efb531ae0a1bee2f" name="a4e63fc6831565737efb531ae0a1bee2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e63fc6831565737efb531ae0a1bee2f">&#9670;&#160;</a></span>test_nan_euclidean_distances_not_trival()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_nan_euclidean_distances_not_trival </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>missing_value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1035</span><span class="keyword">def </span>test_nan_euclidean_distances_not_trival(missing_value):</div>
<div class="line"><span class="lineno"> 1036</span>    X = np.array(</div>
<div class="line"><span class="lineno"> 1037</span>        [</div>
<div class="line"><span class="lineno"> 1038</span>            [1.0, missing_value, 3.0, 4.0, 2.0],</div>
<div class="line"><span class="lineno"> 1039</span>            [missing_value, 4.0, 6.0, 1.0, missing_value],</div>
<div class="line"><span class="lineno"> 1040</span>            [3.0, missing_value, missing_value, missing_value, 1.0],</div>
<div class="line"><span class="lineno"> 1041</span>        ]</div>
<div class="line"><span class="lineno"> 1042</span>    )</div>
<div class="line"><span class="lineno"> 1043</span> </div>
<div class="line"><span class="lineno"> 1044</span>    Y = np.array(</div>
<div class="line"><span class="lineno"> 1045</span>        [</div>
<div class="line"><span class="lineno"> 1046</span>            [missing_value, 7.0, 7.0, missing_value, 2.0],</div>
<div class="line"><span class="lineno"> 1047</span>            [missing_value, missing_value, 5.0, 4.0, 7.0],</div>
<div class="line"><span class="lineno"> 1048</span>            [missing_value, missing_value, missing_value, 4.0, 5.0],</div>
<div class="line"><span class="lineno"> 1049</span>        ]</div>
<div class="line"><span class="lineno"> 1050</span>    )</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>    <span class="comment"># Check for symmetry</span></div>
<div class="line"><span class="lineno"> 1053</span>    D1 = nan_euclidean_distances(X, Y, missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1054</span>    D2 = nan_euclidean_distances(Y, X, missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>    assert_almost_equal(D1, D2.T)</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>    <span class="comment"># Check with explicit formula and squared=True</span></div>
<div class="line"><span class="lineno"> 1059</span>    assert_allclose(</div>
<div class="line"><span class="lineno"> 1060</span>        nan_euclidean_distances(</div>
<div class="line"><span class="lineno"> 1061</span>            X[:1], Y[:1], squared=<span class="keyword">True</span>, missing_values=missing_value</div>
<div class="line"><span class="lineno"> 1062</span>        ),</div>
<div class="line"><span class="lineno"> 1063</span>        [[5.0 / 2.0 * ((7 - 3) ** 2 + (2 - 2) ** 2)]],</div>
<div class="line"><span class="lineno"> 1064</span>    )</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>    <span class="comment"># Check with explicit formula and squared=False</span></div>
<div class="line"><span class="lineno"> 1067</span>    assert_allclose(</div>
<div class="line"><span class="lineno"> 1068</span>        nan_euclidean_distances(</div>
<div class="line"><span class="lineno"> 1069</span>            X[1:2], Y[1:2], squared=<span class="keyword">False</span>, missing_values=missing_value</div>
<div class="line"><span class="lineno"> 1070</span>        ),</div>
<div class="line"><span class="lineno"> 1071</span>        [[np.sqrt(5.0 / 2.0 * ((6 - 5) ** 2 + (1 - 4) ** 2))]],</div>
<div class="line"><span class="lineno"> 1072</span>    )</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>    <span class="comment"># Check when Y = X is explicitly passed</span></div>
<div class="line"><span class="lineno"> 1075</span>    D3 = nan_euclidean_distances(X, missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1076</span>    D4 = nan_euclidean_distances(X, X, missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1077</span>    D5 = nan_euclidean_distances(X, X.copy(), missing_values=missing_value)</div>
<div class="line"><span class="lineno"> 1078</span>    assert_allclose(D3, D4)</div>
<div class="line"><span class="lineno"> 1079</span>    assert_allclose(D4, D5)</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>    <span class="comment"># Check copy = True against copy = False</span></div>
<div class="line"><span class="lineno"> 1082</span>    D6 = nan_euclidean_distances(X, Y, copy=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1083</span>    D7 = nan_euclidean_distances(X, Y, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1084</span>    assert_allclose(D6, D7)</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span><span class="preprocessor">@pytest.mark.parametrize(&quot;missing_value&quot;, [np.nan, -1])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abee181e07cdfbf1532cbb563525c7b17" name="abee181e07cdfbf1532cbb563525c7b17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee181e07cdfbf1532cbb563525c7b17">&#9670;&#160;</a></span>test_nan_euclidean_distances_one_feature_match_positive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_nan_euclidean_distances_one_feature_match_positive </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>missing_value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1088</span><span class="keyword">def </span>test_nan_euclidean_distances_one_feature_match_positive(missing_value):</div>
<div class="line"><span class="lineno"> 1089</span>    <span class="comment"># First feature is the only feature that is non-nan and in both</span></div>
<div class="line"><span class="lineno"> 1090</span>    <span class="comment"># samples. The result of `nan_euclidean_distances` with squared=True</span></div>
<div class="line"><span class="lineno"> 1091</span>    <span class="comment"># should be non-negative. The non-squared version should all be close to 0.</span></div>
<div class="line"><span class="lineno"> 1092</span>    X = np.array(</div>
<div class="line"><span class="lineno"> 1093</span>        [</div>
<div class="line"><span class="lineno"> 1094</span>            [-122.27, 648.0, missing_value, 37.85],</div>
<div class="line"><span class="lineno"> 1095</span>            [-122.27, missing_value, 2.34701493, missing_value],</div>
<div class="line"><span class="lineno"> 1096</span>        ]</div>
<div class="line"><span class="lineno"> 1097</span>    )</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>    dist_squared = nan_euclidean_distances(</div>
<div class="line"><span class="lineno"> 1100</span>        X, missing_values=missing_value, squared=<span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 1101</span>    )</div>
<div class="line"><span class="lineno"> 1102</span>    <span class="keyword">assert</span> np.all(dist_squared &gt;= 0)</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span>    dist = nan_euclidean_distances(X, missing_values=missing_value, squared=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1105</span>    assert_allclose(dist, 0.0)</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c32d7e5e06d1ac9ba0a2d7ee2c91d0e" name="a9c32d7e5e06d1ac9ba0a2d7ee2c91d0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c32d7e5e06d1ac9ba0a2d7ee2c91d0e">&#9670;&#160;</a></span>test_no_data_conversion_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_no_data_conversion_warning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  247</span><span class="keyword">def </span>test_no_data_conversion_warning():</div>
<div class="line"><span class="lineno">  248</span>    <span class="comment"># No warnings issued if metric is not a boolean distance function</span></div>
<div class="line"><span class="lineno">  249</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  250</span>    X = rng.randn(5, 4)</div>
<div class="line"><span class="lineno">  251</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  252</span>        warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, DataConversionWarning)</div>
<div class="line"><span class="lineno">  253</span>        pairwise_distances(X, metric=<span class="stringliteral">&quot;minkowski&quot;</span>)</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span><span class="preprocessor">@pytest.mark.parametrize(&quot;func&quot;, [pairwise_distances, pairwise_kernels])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a69c1bee6b30c6bcdce6435db4803b581" name="a69c1bee6b30c6bcdce6435db4803b581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c1bee6b30c6bcdce6435db4803b581">&#9670;&#160;</a></span>test_numeric_pairwise_distances_datatypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_numeric_pairwise_distances_datatypes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_is_x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1523</span><span class="keyword">def </span>test_numeric_pairwise_distances_datatypes(metric, global_dtype, y_is_x):</div>
<div class="line"><span class="lineno"> 1524</span>    <span class="comment"># Check that pairwise distances gives the same result as pdist and cdist</span></div>
<div class="line"><span class="lineno"> 1525</span>    <span class="comment"># regardless of input datatype when using any scipy metric for comparing</span></div>
<div class="line"><span class="lineno"> 1526</span>    <span class="comment"># numeric vectors</span></div>
<div class="line"><span class="lineno"> 1527</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 1528</span>    <span class="comment"># This test is necessary because pairwise_distances used to throw an</span></div>
<div class="line"><span class="lineno"> 1529</span>    <span class="comment"># error when using metric=&#39;seuclidean&#39; and the input data was not</span></div>
<div class="line"><span class="lineno"> 1530</span>    <span class="comment"># of type np.float64 (#15730)</span></div>
<div class="line"><span class="lineno"> 1531</span> </div>
<div class="line"><span class="lineno"> 1532</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1533</span> </div>
<div class="line"><span class="lineno"> 1534</span>    X = rng.random_sample((5, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>    params = {}</div>
<div class="line"><span class="lineno"> 1537</span>    <span class="keywordflow">if</span> y_is_x:</div>
<div class="line"><span class="lineno"> 1538</span>        Y = X</div>
<div class="line"><span class="lineno"> 1539</span>        expected_dist = squareform(pdist(X, metric=metric))</div>
<div class="line"><span class="lineno"> 1540</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1541</span>        Y = rng.random_sample((5, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1542</span>        expected_dist = cdist(X, Y, metric=metric)</div>
<div class="line"><span class="lineno"> 1543</span>        <span class="comment"># precompute parameters for seuclidean &amp; mahalanobis when x is not y</span></div>
<div class="line"><span class="lineno"> 1544</span>        <span class="keywordflow">if</span> metric == <span class="stringliteral">&quot;seuclidean&quot;</span>:</div>
<div class="line"><span class="lineno"> 1545</span>            params = {<span class="stringliteral">&quot;V&quot;</span>: np.var(np.vstack([X, Y]), axis=0, ddof=1, dtype=np.float64)}</div>
<div class="line"><span class="lineno"> 1546</span>        <span class="keywordflow">elif</span> metric == <span class="stringliteral">&quot;mahalanobis&quot;</span>:</div>
<div class="line"><span class="lineno"> 1547</span>            params = {<span class="stringliteral">&quot;VI&quot;</span>: np.linalg.inv(np.cov(np.vstack([X, Y]).T)).T}</div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>    dist = pairwise_distances(X, Y, metric=metric, **params)</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>    assert_allclose(dist, expected_dist)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae07538f5a73d6c700dd6a668cc72293" name="aae07538f5a73d6c700dd6a668cc72293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae07538f5a73d6c700dd6a668cc72293">&#9670;&#160;</a></span>test_paired_distances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_paired_distances </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  433</span><span class="keyword">def </span>test_paired_distances(metric, func):</div>
<div class="line"><span class="lineno">  434</span>    <span class="comment"># Test the pairwise_distance helper function.</span></div>
<div class="line"><span class="lineno">  435</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  436</span>    <span class="comment"># Euclidean distance should be equivalent to calling the function.</span></div>
<div class="line"><span class="lineno">  437</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno">  438</span>    <span class="comment"># Euclidean distance, with Y != X.</span></div>
<div class="line"><span class="lineno">  439</span>    Y = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    S = paired_distances(X, Y, metric=metric)</div>
<div class="line"><span class="lineno">  442</span>    S2 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(X, Y)</div>
<div class="line"><span class="lineno">  443</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  444</span>    S3 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(csr_matrix(X), csr_matrix(Y))</div>
<div class="line"><span class="lineno">  445</span>    assert_allclose(S, S3)</div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordflow">if</span> metric <span class="keywordflow">in</span> PAIRWISE_DISTANCE_FUNCTIONS:</div>
<div class="line"><span class="lineno">  447</span>        <span class="comment"># Check the pairwise_distances implementation</span></div>
<div class="line"><span class="lineno">  448</span>        <span class="comment"># gives the same value</span></div>
<div class="line"><span class="lineno">  449</span>        distances = PAIRWISE_DISTANCE_FUNCTIONS[metric](X, Y)</div>
<div class="line"><span class="lineno">  450</span>        distances = np.diag(distances)</div>
<div class="line"><span class="lineno">  451</span>        assert_allclose(distances, S)</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a08171f5ba00bec0517d308e6738b8ab8" name="a08171f5ba00bec0517d308e6738b8ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08171f5ba00bec0517d308e6738b8ab8">&#9670;&#160;</a></span>test_paired_distances_callable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_paired_distances_callable </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  454</span><span class="keyword">def </span>test_paired_distances_callable(global_dtype):</div>
<div class="line"><span class="lineno">  455</span>    <span class="comment"># Test the paired_distance helper function</span></div>
<div class="line"><span class="lineno">  456</span>    <span class="comment"># with the callable implementation</span></div>
<div class="line"><span class="lineno">  457</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  458</span>    <span class="comment"># Euclidean distance should be equivalent to calling the function.</span></div>
<div class="line"><span class="lineno">  459</span>    X = rng.random_sample((5, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  460</span>    <span class="comment"># Euclidean distance, with Y != X.</span></div>
<div class="line"><span class="lineno">  461</span>    Y = rng.random_sample((5, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    S = paired_distances(X, Y, metric=<span class="stringliteral">&quot;manhattan&quot;</span>)</div>
<div class="line"><span class="lineno">  464</span>    S2 = paired_distances(X, Y, metric=<span class="keyword">lambda</span> x, y: np.abs(x - y).sum(axis=0))</div>
<div class="line"><span class="lineno">  465</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    <span class="comment"># Test that a value error is raised when the lengths of X and Y should not</span></div>
<div class="line"><span class="lineno">  468</span>    <span class="comment"># differ</span></div>
<div class="line"><span class="lineno">  469</span>    Y = rng.random_sample((3, 4))</div>
<div class="line"><span class="lineno">  470</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  471</span>        paired_distances(X, Y)</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa01779ff08f395e8a4c1993949275327" name="aa01779ff08f395e8a4c1993949275327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa01779ff08f395e8a4c1993949275327">&#9670;&#160;</a></span>test_paired_euclidean_distances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_paired_euclidean_distances </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1165</span><span class="keyword">def </span>test_paired_euclidean_distances():</div>
<div class="line"><span class="lineno"> 1166</span>    <span class="comment"># Check the paired Euclidean distances computation</span></div>
<div class="line"><span class="lineno"> 1167</span>    X = [[0], [0]]</div>
<div class="line"><span class="lineno"> 1168</span>    Y = [[1], [2]]</div>
<div class="line"><span class="lineno"> 1169</span>    D = paired_euclidean_distances(X, Y)</div>
<div class="line"><span class="lineno"> 1170</span>    assert_allclose(D, [1.0, 2.0])</div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9f0bc58d3f1f5445d2bc4c17a16fdf5" name="aa9f0bc58d3f1f5445d2bc4c17a16fdf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9f0bc58d3f1f5445d2bc4c17a16fdf5">&#9670;&#160;</a></span>test_paired_manhattan_distances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_paired_manhattan_distances </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1173</span><span class="keyword">def </span>test_paired_manhattan_distances():</div>
<div class="line"><span class="lineno"> 1174</span>    <span class="comment"># Check the paired manhattan distances computation</span></div>
<div class="line"><span class="lineno"> 1175</span>    X = [[0], [0]]</div>
<div class="line"><span class="lineno"> 1176</span>    Y = [[1], [2]]</div>
<div class="line"><span class="lineno"> 1177</span>    D = paired_manhattan_distances(X, Y)</div>
<div class="line"><span class="lineno"> 1178</span>    assert_allclose(D, [1.0, 2.0])</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a69ca9e0126f16b75f3f027ebd81e2d18" name="a69ca9e0126f16b75f3f027ebd81e2d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69ca9e0126f16b75f3f027ebd81e2d18">&#9670;&#160;</a></span>test_pairwise_boolean_distance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_boolean_distance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  217</span><span class="keyword">def </span>test_pairwise_boolean_distance(metric):</div>
<div class="line"><span class="lineno">  218</span>    <span class="comment"># test that we convert to boolean arrays for boolean distances</span></div>
<div class="line"><span class="lineno">  219</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  220</span>    X = rng.randn(5, 4)</div>
<div class="line"><span class="lineno">  221</span>    Y = X.copy()</div>
<div class="line"><span class="lineno">  222</span>    Y[0, 0] = 1 - Y[0, 0]</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="comment"># ignore conversion to boolean in pairwise_distances</span></div>
<div class="line"><span class="lineno">  225</span>    <span class="keyword">with</span> ignore_warnings(category=DataConversionWarning):</div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordflow">for</span> Z <span class="keywordflow">in</span> [Y, <span class="keywordtype">None</span>]:</div>
<div class="line"><span class="lineno">  227</span>            res = pairwise_distances(X, Z, metric=metric)</div>
<div class="line"><span class="lineno">  228</span>            res[np.isnan(res)] = 0</div>
<div class="line"><span class="lineno">  229</span>            <span class="keyword">assert</span> np.sum(res != 0) == 0</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># non-boolean arrays are converted to boolean for boolean</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="comment"># distance metrics with a data conversion warning</span></div>
<div class="line"><span class="lineno">  233</span>    msg = <span class="stringliteral">&quot;Data was converted to boolean for metric %s&quot;</span> % metric</div>
<div class="line"><span class="lineno">  234</span>    <span class="keyword">with</span> pytest.warns(DataConversionWarning, match=msg):</div>
<div class="line"><span class="lineno">  235</span>        pairwise_distances(X, metric=metric)</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    <span class="comment"># Check that the warning is raised if X is boolean by Y is not boolean:</span></div>
<div class="line"><span class="lineno">  238</span>    <span class="keyword">with</span> pytest.warns(DataConversionWarning, match=msg):</div>
<div class="line"><span class="lineno">  239</span>        pairwise_distances(X.astype(bool), Y=Y, metric=metric)</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    <span class="comment"># Check that no warning is raised if X is already boolean and Y is None:</span></div>
<div class="line"><span class="lineno">  242</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  243</span>        warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, DataConversionWarning)</div>
<div class="line"><span class="lineno">  244</span>        pairwise_distances(X.astype(bool), metric=metric)</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d8134a134fd6ebd4ea53d49b9cad35d" name="a5d8134a134fd6ebd4ea53d49b9cad35d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d8134a134fd6ebd4ea53d49b9cad35d">&#9670;&#160;</a></span>test_pairwise_callable_nonstrict_metric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_callable_nonstrict_metric </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  355</span><span class="keyword">def </span>test_pairwise_callable_nonstrict_metric():</div>
<div class="line"><span class="lineno">  356</span>    <span class="comment"># paired_distances should allow callable metric where metric(x, x) != 0</span></div>
<div class="line"><span class="lineno">  357</span>    <span class="comment"># Knowing that the callable is a strict metric would allow the diagonal to</span></div>
<div class="line"><span class="lineno">  358</span>    <span class="comment"># be left uncalculated and set to 0.</span></div>
<div class="line"><span class="lineno">  359</span>    <span class="keyword">assert</span> pairwise_distances([[1.0]], metric=<span class="keyword">lambda</span> x, y: 5)[0, 0] == 5</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span><span class="comment"># Test with all metrics that should be in PAIRWISE_KERNEL_FUNCTIONS.</span></div>
<div class="line"><span class="lineno">  363</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  364</span>    <span class="stringliteral">&quot;metric&quot;</span>,</div>
<div class="line"><span class="lineno">  365</span>    [<span class="stringliteral">&quot;rbf&quot;</span>, <span class="stringliteral">&quot;laplacian&quot;</span>, <span class="stringliteral">&quot;sigmoid&quot;</span>, <span class="stringliteral">&quot;polynomial&quot;</span>, <span class="stringliteral">&quot;linear&quot;</span>, <span class="stringliteral">&quot;chi2&quot;</span>, <span class="stringliteral">&quot;additive_chi2&quot;</span>],</div>
<div class="line"><span class="lineno">  366</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a302120f8084a9ac190d20b580aa3a990" name="a302120f8084a9ac190d20b580aa3a990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a302120f8084a9ac190d20b580aa3a990">&#9670;&#160;</a></span>test_pairwise_distances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   60</span><span class="keyword">def </span>test_pairwise_distances(global_dtype):</div>
<div class="line"><span class="lineno">   61</span>    <span class="comment"># Test the pairwise_distance helper function.</span></div>
<div class="line"><span class="lineno">   62</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>    <span class="comment"># Euclidean distance should be equivalent to calling the function.</span></div>
<div class="line"><span class="lineno">   65</span>    X = rng.random_sample((5, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">   66</span>    S = pairwise_distances(X, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">   67</span>    S2 = euclidean_distances(X)</div>
<div class="line"><span class="lineno">   68</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">   69</span>    <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <span class="comment"># Euclidean distance, with Y != X.</span></div>
<div class="line"><span class="lineno">   72</span>    Y = rng.random_sample((2, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">   73</span>    S = pairwise_distances(X, Y, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">   74</span>    S2 = euclidean_distances(X, Y)</div>
<div class="line"><span class="lineno">   75</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">   76</span>    <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    <span class="comment"># Check to ensure NaNs work with pairwise_distances.</span></div>
<div class="line"><span class="lineno">   79</span>    X_masked = rng.random_sample((5, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">   80</span>    Y_masked = rng.random_sample((2, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">   81</span>    X_masked[0, 0] = np.nan</div>
<div class="line"><span class="lineno">   82</span>    Y_masked[0, 0] = np.nan</div>
<div class="line"><span class="lineno">   83</span>    S_masked = pairwise_distances(X_masked, Y_masked, metric=<span class="stringliteral">&quot;nan_euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">   84</span>    S2_masked = nan_euclidean_distances(X_masked, Y_masked)</div>
<div class="line"><span class="lineno">   85</span>    assert_allclose(S_masked, S2_masked)</div>
<div class="line"><span class="lineno">   86</span>    <span class="keyword">assert</span> S_masked.dtype == S2_masked.dtype == global_dtype</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    <span class="comment"># Test with tuples as X and Y</span></div>
<div class="line"><span class="lineno">   89</span>    X_tuples = tuple([tuple([v <span class="keywordflow">for</span> v <span class="keywordflow">in</span> row]) <span class="keywordflow">for</span> row <span class="keywordflow">in</span> X])</div>
<div class="line"><span class="lineno">   90</span>    Y_tuples = tuple([tuple([v <span class="keywordflow">for</span> v <span class="keywordflow">in</span> row]) <span class="keywordflow">for</span> row <span class="keywordflow">in</span> Y])</div>
<div class="line"><span class="lineno">   91</span>    S2 = pairwise_distances(X_tuples, Y_tuples, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">   92</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">   93</span>    <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>    <span class="comment"># Test haversine distance</span></div>
<div class="line"><span class="lineno">   96</span>    <span class="comment"># The data should be valid latitude and longitude</span></div>
<div class="line"><span class="lineno">   97</span>    <span class="comment"># haversine converts to float64 currently so we don&#39;t check dtypes.</span></div>
<div class="line"><span class="lineno">   98</span>    X = rng.random_sample((5, 2)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">   99</span>    X[:, 0] = (X[:, 0] - 0.5) * 2 * np.pi / 2</div>
<div class="line"><span class="lineno">  100</span>    X[:, 1] = (X[:, 1] - 0.5) * 2 * np.pi</div>
<div class="line"><span class="lineno">  101</span>    S = pairwise_distances(X, metric=<span class="stringliteral">&quot;haversine&quot;</span>)</div>
<div class="line"><span class="lineno">  102</span>    S2 = haversine_distances(X)</div>
<div class="line"><span class="lineno">  103</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    <span class="comment"># Test haversine distance, with Y != X</span></div>
<div class="line"><span class="lineno">  106</span>    Y = rng.random_sample((2, 2)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  107</span>    Y[:, 0] = (Y[:, 0] - 0.5) * 2 * np.pi / 2</div>
<div class="line"><span class="lineno">  108</span>    Y[:, 1] = (Y[:, 1] - 0.5) * 2 * np.pi</div>
<div class="line"><span class="lineno">  109</span>    S = pairwise_distances(X, Y, metric=<span class="stringliteral">&quot;haversine&quot;</span>)</div>
<div class="line"><span class="lineno">  110</span>    S2 = haversine_distances(X, Y)</div>
<div class="line"><span class="lineno">  111</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    <span class="comment"># &quot;cityblock&quot; uses scikit-learn metric, cityblock (function) is</span></div>
<div class="line"><span class="lineno">  114</span>    <span class="comment"># scipy.spatial.</span></div>
<div class="line"><span class="lineno">  115</span>    <span class="comment"># The metric functions from scipy converts to float64 so we don&#39;t check the dtypes.</span></div>
<div class="line"><span class="lineno">  116</span>    S = pairwise_distances(X, metric=<span class="stringliteral">&quot;cityblock&quot;</span>)</div>
<div class="line"><span class="lineno">  117</span>    S2 = pairwise_distances(X, metric=cityblock)</div>
<div class="line"><span class="lineno">  118</span>    <span class="keyword">assert</span> S.shape[0] == S.shape[1]</div>
<div class="line"><span class="lineno">  119</span>    <span class="keyword">assert</span> S.shape[0] == X.shape[0]</div>
<div class="line"><span class="lineno">  120</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    <span class="comment"># The manhattan metric should be equivalent to cityblock.</span></div>
<div class="line"><span class="lineno">  123</span>    S = pairwise_distances(X, Y, metric=<span class="stringliteral">&quot;manhattan&quot;</span>)</div>
<div class="line"><span class="lineno">  124</span>    S2 = pairwise_distances(X, Y, metric=cityblock)</div>
<div class="line"><span class="lineno">  125</span>    <span class="keyword">assert</span> S.shape[0] == X.shape[0]</div>
<div class="line"><span class="lineno">  126</span>    <span class="keyword">assert</span> S.shape[1] == Y.shape[0]</div>
<div class="line"><span class="lineno">  127</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>    <span class="comment"># Test cosine as a string metric versus cosine callable</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="comment"># The string &quot;cosine&quot; uses sklearn.metric,</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="comment"># while the function cosine is scipy.spatial</span></div>
<div class="line"><span class="lineno">  132</span>    S = pairwise_distances(X, Y, metric=<span class="stringliteral">&quot;cosine&quot;</span>)</div>
<div class="line"><span class="lineno">  133</span>    S2 = pairwise_distances(X, Y, metric=cosine)</div>
<div class="line"><span class="lineno">  134</span>    <span class="keyword">assert</span> S.shape[0] == X.shape[0]</div>
<div class="line"><span class="lineno">  135</span>    <span class="keyword">assert</span> S.shape[1] == Y.shape[0]</div>
<div class="line"><span class="lineno">  136</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="comment"># Test with sparse X and Y,</span></div>
<div class="line"><span class="lineno">  139</span>    <span class="comment"># currently only supported for Euclidean, L1 and cosine.</span></div>
<div class="line"><span class="lineno">  140</span>    X_sparse = csr_matrix(X)</div>
<div class="line"><span class="lineno">  141</span>    Y_sparse = csr_matrix(Y)</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    S = pairwise_distances(X_sparse, Y_sparse, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  144</span>    S2 = euclidean_distances(X_sparse, Y_sparse)</div>
<div class="line"><span class="lineno">  145</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  146</span>    <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>    S = pairwise_distances(X_sparse, Y_sparse, metric=<span class="stringliteral">&quot;cosine&quot;</span>)</div>
<div class="line"><span class="lineno">  149</span>    S2 = cosine_distances(X_sparse, Y_sparse)</div>
<div class="line"><span class="lineno">  150</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  151</span>    <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    S = pairwise_distances(X_sparse, Y_sparse.tocsc(), metric=<span class="stringliteral">&quot;manhattan&quot;</span>)</div>
<div class="line"><span class="lineno">  154</span>    S2 = manhattan_distances(X_sparse.tobsr(), Y_sparse.tocoo())</div>
<div class="line"><span class="lineno">  155</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">if</span> global_dtype == np.float64:</div>
<div class="line"><span class="lineno">  157</span>        <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  159</span>        <span class="comment"># TODO Fix manhattan_distances to preserve dtype.</span></div>
<div class="line"><span class="lineno">  160</span>        <span class="comment"># currently pairwise_distances uses manhattan_distances but converts the result</span></div>
<div class="line"><span class="lineno">  161</span>        <span class="comment"># back to the input dtype</span></div>
<div class="line"><span class="lineno">  162</span>        <span class="keyword">with</span> pytest.raises(AssertionError):</div>
<div class="line"><span class="lineno">  163</span>            <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    S2 = manhattan_distances(X, Y)</div>
<div class="line"><span class="lineno">  166</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">if</span> global_dtype == np.float64:</div>
<div class="line"><span class="lineno">  168</span>        <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  170</span>        <span class="comment"># TODO Fix manhattan_distances to preserve dtype.</span></div>
<div class="line"><span class="lineno">  171</span>        <span class="comment"># currently pairwise_distances uses manhattan_distances but converts the result</span></div>
<div class="line"><span class="lineno">  172</span>        <span class="comment"># back to the input dtype</span></div>
<div class="line"><span class="lineno">  173</span>        <span class="keyword">with</span> pytest.raises(AssertionError):</div>
<div class="line"><span class="lineno">  174</span>            <span class="keyword">assert</span> S.dtype == S2.dtype == global_dtype</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <span class="comment"># Test with scipy.spatial.distance metric, with a kwd</span></div>
<div class="line"><span class="lineno">  177</span>    kwds = {<span class="stringliteral">&quot;p&quot;</span>: 2.0}</div>
<div class="line"><span class="lineno">  178</span>    S = pairwise_distances(X, Y, metric=<span class="stringliteral">&quot;minkowski&quot;</span>, **kwds)</div>
<div class="line"><span class="lineno">  179</span>    S2 = pairwise_distances(X, Y, metric=minkowski, **kwds)</div>
<div class="line"><span class="lineno">  180</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <span class="comment"># same with Y = None</span></div>
<div class="line"><span class="lineno">  183</span>    kwds = {<span class="stringliteral">&quot;p&quot;</span>: 2.0}</div>
<div class="line"><span class="lineno">  184</span>    S = pairwise_distances(X, metric=<span class="stringliteral">&quot;minkowski&quot;</span>, **kwds)</div>
<div class="line"><span class="lineno">  185</span>    S2 = pairwise_distances(X, metric=minkowski, **kwds)</div>
<div class="line"><span class="lineno">  186</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="comment"># Test that scipy distance metrics throw an error if sparse matrix given</span></div>
<div class="line"><span class="lineno">  189</span>    <span class="keyword">with</span> pytest.raises(TypeError):</div>
<div class="line"><span class="lineno">  190</span>        pairwise_distances(X_sparse, metric=<span class="stringliteral">&quot;minkowski&quot;</span>)</div>
<div class="line"><span class="lineno">  191</span>    <span class="keyword">with</span> pytest.raises(TypeError):</div>
<div class="line"><span class="lineno">  192</span>        pairwise_distances(X, Y_sparse, metric=<span class="stringliteral">&quot;minkowski&quot;</span>)</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>    <span class="comment"># Test that a value error is raised if the metric is unknown</span></div>
<div class="line"><span class="lineno">  195</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  196</span>        pairwise_distances(X, Y, metric=<span class="stringliteral">&quot;blah&quot;</span>)</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span><span class="comment"># TODO(1.4): Remove test when `sum_over_features` parameter is removed</span></div>
<div class="line"><span class="lineno">  200</span><span class="preprocessor">@pytest.mark.parametrize(&quot;sum_over_features&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2f2d99df4781afeddd1899ed6481533" name="ab2f2d99df4781afeddd1899ed6481533"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2f2d99df4781afeddd1899ed6481533">&#9670;&#160;</a></span>test_pairwise_distances_argmin_min()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_argmin_min </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  474</span><span class="keyword">def </span>test_pairwise_distances_argmin_min(global_dtype):</div>
<div class="line"><span class="lineno">  475</span>    <span class="comment"># Check pairwise minimum distances computation for any metric</span></div>
<div class="line"><span class="lineno">  476</span>    X = np.asarray([[0], [1]], dtype=global_dtype)</div>
<div class="line"><span class="lineno">  477</span>    Y = np.asarray([[-2], [3]], dtype=global_dtype)</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>    Xsp = dok_matrix(X)</div>
<div class="line"><span class="lineno">  480</span>    Ysp = csr_matrix(Y, dtype=global_dtype)</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    expected_idx = [0, 1]</div>
<div class="line"><span class="lineno">  483</span>    expected_vals = [2, 2]</div>
<div class="line"><span class="lineno">  484</span>    expected_vals_sq = [4, 4]</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    <span class="comment"># euclidean metric</span></div>
<div class="line"><span class="lineno">  487</span>    idx, vals = pairwise_distances_argmin_min(X, Y, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  488</span>    idx2 = pairwise_distances_argmin(X, Y, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  489</span>    assert_allclose(idx, expected_idx)</div>
<div class="line"><span class="lineno">  490</span>    assert_allclose(idx2, expected_idx)</div>
<div class="line"><span class="lineno">  491</span>    assert_allclose(vals, expected_vals)</div>
<div class="line"><span class="lineno">  492</span>    <span class="comment"># sparse matrix case</span></div>
<div class="line"><span class="lineno">  493</span>    idxsp, valssp = pairwise_distances_argmin_min(Xsp, Ysp, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  494</span>    idxsp2 = pairwise_distances_argmin(Xsp, Ysp, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  495</span>    assert_allclose(idxsp, expected_idx)</div>
<div class="line"><span class="lineno">  496</span>    assert_allclose(idxsp2, expected_idx)</div>
<div class="line"><span class="lineno">  497</span>    assert_allclose(valssp, expected_vals)</div>
<div class="line"><span class="lineno">  498</span>    <span class="comment"># We don&#39;t want np.matrix here</span></div>
<div class="line"><span class="lineno">  499</span>    <span class="keyword">assert</span> type(idxsp) == np.ndarray</div>
<div class="line"><span class="lineno">  500</span>    <span class="keyword">assert</span> type(valssp) == np.ndarray</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>    <span class="comment"># Squared Euclidean metric</span></div>
<div class="line"><span class="lineno">  503</span>    idx, vals = pairwise_distances_argmin_min(X, Y, metric=<span class="stringliteral">&quot;sqeuclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  504</span>    idx2, vals2 = pairwise_distances_argmin_min(</div>
<div class="line"><span class="lineno">  505</span>        X, Y, metric=<span class="stringliteral">&quot;euclidean&quot;</span>, metric_kwargs={<span class="stringliteral">&quot;squared&quot;</span>: <span class="keyword">True</span>}</div>
<div class="line"><span class="lineno">  506</span>    )</div>
<div class="line"><span class="lineno">  507</span>    idx3 = pairwise_distances_argmin(X, Y, metric=<span class="stringliteral">&quot;sqeuclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  508</span>    idx4 = pairwise_distances_argmin(</div>
<div class="line"><span class="lineno">  509</span>        X, Y, metric=<span class="stringliteral">&quot;euclidean&quot;</span>, metric_kwargs={<span class="stringliteral">&quot;squared&quot;</span>: <span class="keyword">True</span>}</div>
<div class="line"><span class="lineno">  510</span>    )</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    assert_allclose(vals, expected_vals_sq)</div>
<div class="line"><span class="lineno">  513</span>    assert_allclose(vals2, expected_vals_sq)</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>    assert_allclose(idx, expected_idx)</div>
<div class="line"><span class="lineno">  516</span>    assert_allclose(idx2, expected_idx)</div>
<div class="line"><span class="lineno">  517</span>    assert_allclose(idx3, expected_idx)</div>
<div class="line"><span class="lineno">  518</span>    assert_allclose(idx4, expected_idx)</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>    <span class="comment"># Non-euclidean scikit-learn metric</span></div>
<div class="line"><span class="lineno">  521</span>    idx, vals = pairwise_distances_argmin_min(X, Y, metric=<span class="stringliteral">&quot;manhattan&quot;</span>)</div>
<div class="line"><span class="lineno">  522</span>    idx2 = pairwise_distances_argmin(X, Y, metric=<span class="stringliteral">&quot;manhattan&quot;</span>)</div>
<div class="line"><span class="lineno">  523</span>    assert_allclose(idx, expected_idx)</div>
<div class="line"><span class="lineno">  524</span>    assert_allclose(idx2, expected_idx)</div>
<div class="line"><span class="lineno">  525</span>    assert_allclose(vals, expected_vals)</div>
<div class="line"><span class="lineno">  526</span>    <span class="comment"># sparse matrix case</span></div>
<div class="line"><span class="lineno">  527</span>    idxsp, valssp = pairwise_distances_argmin_min(Xsp, Ysp, metric=<span class="stringliteral">&quot;manhattan&quot;</span>)</div>
<div class="line"><span class="lineno">  528</span>    idxsp2 = pairwise_distances_argmin(Xsp, Ysp, metric=<span class="stringliteral">&quot;manhattan&quot;</span>)</div>
<div class="line"><span class="lineno">  529</span>    assert_allclose(idxsp, expected_idx)</div>
<div class="line"><span class="lineno">  530</span>    assert_allclose(idxsp2, expected_idx)</div>
<div class="line"><span class="lineno">  531</span>    assert_allclose(valssp, expected_vals)</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    <span class="comment"># Non-euclidean Scipy distance (callable)</span></div>
<div class="line"><span class="lineno">  534</span>    idx, vals = pairwise_distances_argmin_min(</div>
<div class="line"><span class="lineno">  535</span>        X, Y, metric=minkowski, metric_kwargs={<span class="stringliteral">&quot;p&quot;</span>: 2}</div>
<div class="line"><span class="lineno">  536</span>    )</div>
<div class="line"><span class="lineno">  537</span>    assert_allclose(idx, expected_idx)</div>
<div class="line"><span class="lineno">  538</span>    assert_allclose(vals, expected_vals)</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <span class="comment"># Non-euclidean Scipy distance (string)</span></div>
<div class="line"><span class="lineno">  541</span>    idx, vals = pairwise_distances_argmin_min(</div>
<div class="line"><span class="lineno">  542</span>        X, Y, metric=<span class="stringliteral">&quot;minkowski&quot;</span>, metric_kwargs={<span class="stringliteral">&quot;p&quot;</span>: 2}</div>
<div class="line"><span class="lineno">  543</span>    )</div>
<div class="line"><span class="lineno">  544</span>    assert_allclose(idx, expected_idx)</div>
<div class="line"><span class="lineno">  545</span>    assert_allclose(vals, expected_vals)</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>    <span class="comment"># Compare with naive implementation</span></div>
<div class="line"><span class="lineno">  548</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  549</span>    X = rng.randn(97, 149)</div>
<div class="line"><span class="lineno">  550</span>    Y = rng.randn(111, 149)</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>    dist = pairwise_distances(X, Y, metric=<span class="stringliteral">&quot;manhattan&quot;</span>)</div>
<div class="line"><span class="lineno">  553</span>    dist_orig_ind = dist.argmin(axis=0)</div>
<div class="line"><span class="lineno">  554</span>    dist_orig_val = dist[dist_orig_ind, range(len(dist_orig_ind))]</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>    dist_chunked_ind, dist_chunked_val = pairwise_distances_argmin_min(</div>
<div class="line"><span class="lineno">  557</span>        X, Y, axis=0, metric=<span class="stringliteral">&quot;manhattan&quot;</span></div>
<div class="line"><span class="lineno">  558</span>    )</div>
<div class="line"><span class="lineno">  559</span>    assert_allclose(dist_orig_ind, dist_chunked_ind, rtol=1e-7)</div>
<div class="line"><span class="lineno">  560</span>    assert_allclose(dist_orig_val, dist_chunked_val, rtol=1e-7)</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>    <span class="comment"># Changing the axis and permuting datasets must give the same results</span></div>
<div class="line"><span class="lineno">  563</span>    argmin_0, dist_0 = pairwise_distances_argmin_min(X, Y, axis=0)</div>
<div class="line"><span class="lineno">  564</span>    argmin_1, dist_1 = pairwise_distances_argmin_min(Y, X, axis=1)</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>    assert_allclose(dist_0, dist_1)</div>
<div class="line"><span class="lineno">  567</span>    assert_array_equal(argmin_0, argmin_1)</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>    argmin_0, dist_0 = pairwise_distances_argmin_min(X, X, axis=0)</div>
<div class="line"><span class="lineno">  570</span>    argmin_1, dist_1 = pairwise_distances_argmin_min(X, X, axis=1)</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>    assert_allclose(dist_0, dist_1)</div>
<div class="line"><span class="lineno">  573</span>    assert_array_equal(argmin_0, argmin_1)</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>    <span class="comment"># Changing the axis and permuting datasets must give the same results</span></div>
<div class="line"><span class="lineno">  576</span>    argmin_0 = pairwise_distances_argmin(X, Y, axis=0)</div>
<div class="line"><span class="lineno">  577</span>    argmin_1 = pairwise_distances_argmin(Y, X, axis=1)</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    assert_array_equal(argmin_0, argmin_1)</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    argmin_0 = pairwise_distances_argmin(X, X, axis=0)</div>
<div class="line"><span class="lineno">  582</span>    argmin_1 = pairwise_distances_argmin(X, X, axis=1)</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    assert_array_equal(argmin_0, argmin_1)</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    <span class="comment"># F-contiguous arrays must be supported and must return identical results.</span></div>
<div class="line"><span class="lineno">  587</span>    argmin_C_contiguous = pairwise_distances_argmin(X, Y)</div>
<div class="line"><span class="lineno">  588</span>    argmin_F_contiguous = pairwise_distances_argmin(</div>
<div class="line"><span class="lineno">  589</span>        np.asfortranarray(X), np.asfortranarray(Y)</div>
<div class="line"><span class="lineno">  590</span>    )</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>    assert_array_equal(argmin_C_contiguous, argmin_F_contiguous)</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f9fa21abd07e727b62104fbb15f0184" name="a4f9fa21abd07e727b62104fbb15f0184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f9fa21abd07e727b62104fbb15f0184">&#9670;&#160;</a></span>test_pairwise_distances_chunked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_chunked </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  723</span><span class="keyword">def </span>test_pairwise_distances_chunked(global_dtype):</div>
<div class="line"><span class="lineno">  724</span>    <span class="comment"># Test the pairwise_distance helper function.</span></div>
<div class="line"><span class="lineno">  725</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  726</span>    <span class="comment"># Euclidean distance should be equivalent to calling the function.</span></div>
<div class="line"><span class="lineno">  727</span>    X = rng.random_sample((200, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  728</span>    check_pairwise_distances_chunked(X, <span class="keywordtype">None</span>, working_memory=1, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  729</span>    <span class="comment"># Test small amounts of memory</span></div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordflow">for</span> power <span class="keywordflow">in</span> range(-16, 0):</div>
<div class="line"><span class="lineno">  731</span>        check_pairwise_distances_chunked(</div>
<div class="line"><span class="lineno">  732</span>            X, <span class="keywordtype">None</span>, working_memory=2**power, metric=<span class="stringliteral">&quot;euclidean&quot;</span></div>
<div class="line"><span class="lineno">  733</span>        )</div>
<div class="line"><span class="lineno">  734</span>    <span class="comment"># X as list</span></div>
<div class="line"><span class="lineno">  735</span>    check_pairwise_distances_chunked(</div>
<div class="line"><span class="lineno">  736</span>        X.tolist(), <span class="keywordtype">None</span>, working_memory=1, metric=<span class="stringliteral">&quot;euclidean&quot;</span></div>
<div class="line"><span class="lineno">  737</span>    )</div>
<div class="line"><span class="lineno">  738</span>    <span class="comment"># Euclidean distance, with Y != X.</span></div>
<div class="line"><span class="lineno">  739</span>    Y = rng.random_sample((100, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  740</span>    check_pairwise_distances_chunked(X, Y, working_memory=1, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  741</span>    check_pairwise_distances_chunked(</div>
<div class="line"><span class="lineno">  742</span>        X.tolist(), Y.tolist(), working_memory=1, metric=<span class="stringliteral">&quot;euclidean&quot;</span></div>
<div class="line"><span class="lineno">  743</span>    )</div>
<div class="line"><span class="lineno">  744</span>    <span class="comment"># absurdly large working_memory</span></div>
<div class="line"><span class="lineno">  745</span>    check_pairwise_distances_chunked(X, Y, working_memory=10000, metric=<span class="stringliteral">&quot;euclidean&quot;</span>)</div>
<div class="line"><span class="lineno">  746</span>    <span class="comment"># &quot;cityblock&quot; uses scikit-learn metric, cityblock (function) is</span></div>
<div class="line"><span class="lineno">  747</span>    <span class="comment"># scipy.spatial.</span></div>
<div class="line"><span class="lineno">  748</span>    check_pairwise_distances_chunked(X, Y, working_memory=1, metric=<span class="stringliteral">&quot;cityblock&quot;</span>)</div>
<div class="line"><span class="lineno">  749</span>    <span class="comment"># Test that a value error is raised if the metric is unknown</span></div>
<div class="line"><span class="lineno">  750</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  751</span>        next(pairwise_distances_chunked(X, Y, metric=<span class="stringliteral">&quot;blah&quot;</span>))</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>    <span class="comment"># Test precomputed returns all at once</span></div>
<div class="line"><span class="lineno">  754</span>    D = pairwise_distances(X)</div>
<div class="line"><span class="lineno">  755</span>    gen = pairwise_distances_chunked(D, working_memory=2**-16, metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  756</span>    <span class="keyword">assert</span> isinstance(gen, GeneratorType)</div>
<div class="line"><span class="lineno">  757</span>    <span class="keyword">assert</span> next(gen) <span class="keywordflow">is</span> D</div>
<div class="line"><span class="lineno">  758</span>    <span class="keyword">with</span> pytest.raises(StopIteration):</div>
<div class="line"><span class="lineno">  759</span>        next(gen)</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  763</span>    <span class="stringliteral">&quot;x_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  764</span>)</div>
<div class="line"><span class="lineno">  765</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  766</span>    <span class="stringliteral">&quot;y_array_constr&quot;</span>, [np.array, csr_matrix], ids=[<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;sparse&quot;</span>]</div>
<div class="line"><span class="lineno">  767</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0edc9e9c95a17a7e8df56704573e5122" name="a0edc9e9c95a17a7e8df56704573e5122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0edc9e9c95a17a7e8df56704573e5122">&#9670;&#160;</a></span>test_pairwise_distances_chunked_diagonal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_chunked_diagonal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  706</span><span class="keyword">def </span>test_pairwise_distances_chunked_diagonal(metric, global_dtype):</div>
<div class="line"><span class="lineno">  707</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  708</span>    X = rng.normal(size=(1000, 10), scale=1e10).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  709</span>    chunks = list(pairwise_distances_chunked(X, working_memory=1, metric=metric))</div>
<div class="line"><span class="lineno">  710</span>    <span class="keyword">assert</span> len(chunks) &gt; 1</div>
<div class="line"><span class="lineno">  711</span>    assert_allclose(np.diag(np.vstack(chunks)), 0, rtol=1e-10)</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span><span class="preprocessor">@pytest.mark.parametrize(&quot;metric&quot;, (&quot;euclidean&quot;, &quot;l2&quot;, &quot;sqeuclidean&quot;)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a75cc88d18a481ce5832b5fd70341f567" name="a75cc88d18a481ce5832b5fd70341f567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75cc88d18a481ce5832b5fd70341f567">&#9670;&#160;</a></span>test_pairwise_distances_chunked_reduce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_chunked_reduce </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  599</span><span class="keyword">def </span>test_pairwise_distances_chunked_reduce(global_dtype):</div>
<div class="line"><span class="lineno">  600</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  601</span>    X = rng.random_sample((400, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  602</span>    <span class="comment"># Reduced Euclidean distance</span></div>
<div class="line"><span class="lineno">  603</span>    S = pairwise_distances(X)[:, :100]</div>
<div class="line"><span class="lineno">  604</span>    S_chunks = pairwise_distances_chunked(</div>
<div class="line"><span class="lineno">  605</span>        X, <span class="keywordtype">None</span>, reduce_func=_reduce_func, working_memory=2**-16</div>
<div class="line"><span class="lineno">  606</span>    )</div>
<div class="line"><span class="lineno">  607</span>    <span class="keyword">assert</span> isinstance(S_chunks, GeneratorType)</div>
<div class="line"><span class="lineno">  608</span>    S_chunks = list(S_chunks)</div>
<div class="line"><span class="lineno">  609</span>    <span class="keyword">assert</span> len(S_chunks) &gt; 1</div>
<div class="line"><span class="lineno">  610</span>    <span class="keyword">assert</span> S_chunks[0].dtype == X.dtype</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>    <span class="comment"># atol is for diagonal where S is explicitly zeroed on the diagonal</span></div>
<div class="line"><span class="lineno">  613</span>    assert_allclose(np.vstack(S_chunks), S, atol=1e-7)</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9f89df60e4c3ee63b9ce064a0d4fa4e" name="ac9f89df60e4c3ee63b9ce064a0d4fa4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f89df60e4c3ee63b9ce064a0d4fa4e">&#9670;&#160;</a></span>test_pairwise_distances_chunked_reduce_invalid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_chunked_reduce_invalid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bad_reduce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>err_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  680</span>):</div>
<div class="line"><span class="lineno">  681</span>    X = np.arange(10).reshape(-1, 1).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  682</span>    S_chunks = pairwise_distances_chunked(</div>
<div class="line"><span class="lineno">  683</span>        X, <span class="keywordtype">None</span>, reduce_func=bad_reduce, working_memory=64</div>
<div class="line"><span class="lineno">  684</span>    )</div>
<div class="line"><span class="lineno">  685</span>    <span class="keyword">with</span> pytest.raises(err_type, match=message):</div>
<div class="line"><span class="lineno">  686</span>        next(S_chunks)</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e4f559c05b4feefe36eaa801b3eb864" name="a1e4f559c05b4feefe36eaa801b3eb864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e4f559c05b4feefe36eaa801b3eb864">&#9670;&#160;</a></span>test_pairwise_distances_chunked_reduce_none()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_chunked_reduce_none </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  616</span><span class="keyword">def </span>test_pairwise_distances_chunked_reduce_none(global_dtype):</div>
<div class="line"><span class="lineno">  617</span>    <span class="comment"># check that the reduce func is allowed to return None</span></div>
<div class="line"><span class="lineno">  618</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  619</span>    X = rng.random_sample((10, 4)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  620</span>    S_chunks = pairwise_distances_chunked(</div>
<div class="line"><span class="lineno">  621</span>        X, <span class="keywordtype">None</span>, reduce_func=<span class="keyword">lambda</span> dist, start: <span class="keywordtype">None</span>, working_memory=2**-16</div>
<div class="line"><span class="lineno">  622</span>    )</div>
<div class="line"><span class="lineno">  623</span>    <span class="keyword">assert</span> isinstance(S_chunks, GeneratorType)</div>
<div class="line"><span class="lineno">  624</span>    S_chunks = list(S_chunks)</div>
<div class="line"><span class="lineno">  625</span>    <span class="keyword">assert</span> len(S_chunks) &gt; 1</div>
<div class="line"><span class="lineno">  626</span>    <span class="keyword">assert</span> all(chunk <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">for</span> chunk <span class="keywordflow">in</span> S_chunks)</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  630</span>    <span class="stringliteral">&quot;good_reduce&quot;</span>,</div>
<div class="line"><span class="lineno">  631</span>    [</div>
<div class="line"><span class="lineno">  632</span>        <span class="keyword">lambda</span> D, start: list(D),</div>
<div class="line"><span class="lineno">  633</span>        <span class="keyword">lambda</span> D, start: np.array(D),</div>
<div class="line"><span class="lineno">  634</span>        <span class="keyword">lambda</span> D, start: csr_matrix(D),</div>
<div class="line"><span class="lineno">  635</span>        <span class="keyword">lambda</span> D, start: (list(D), list(D)),</div>
<div class="line"><span class="lineno">  636</span>        <span class="keyword">lambda</span> D, start: (dok_matrix(D), np.array(D), list(D)),</div>
<div class="line"><span class="lineno">  637</span>    ],</div>
<div class="line"><span class="lineno">  638</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8fae58f9974f0ab1bec88831c5cd3906" name="a8fae58f9974f0ab1bec88831c5cd3906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fae58f9974f0ab1bec88831c5cd3906">&#9670;&#160;</a></span>test_pairwise_distances_chunked_reduce_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_chunked_reduce_valid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>good_reduce</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  639</span><span class="keyword">def </span>test_pairwise_distances_chunked_reduce_valid(good_reduce):</div>
<div class="line"><span class="lineno">  640</span>    X = np.arange(10).reshape(-1, 1)</div>
<div class="line"><span class="lineno">  641</span>    S_chunks = pairwise_distances_chunked(</div>
<div class="line"><span class="lineno">  642</span>        X, <span class="keywordtype">None</span>, reduce_func=good_reduce, working_memory=64</div>
<div class="line"><span class="lineno">  643</span>    )</div>
<div class="line"><span class="lineno">  644</span>    next(S_chunks)</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  648</span>    (<span class="stringliteral">&quot;bad_reduce&quot;</span>, <span class="stringliteral">&quot;err_type&quot;</span>, <span class="stringliteral">&quot;message&quot;</span>),</div>
<div class="line"><span class="lineno">  649</span>    [</div>
<div class="line"><span class="lineno">  650</span>        (</div>
<div class="line"><span class="lineno">  651</span>            <span class="keyword">lambda</span> D, s: np.concatenate([D, D[-1:]]),</div>
<div class="line"><span class="lineno">  652</span>            ValueError,</div>
<div class="line"><span class="lineno">  653</span>            <span class="stringliteral">r&quot;length 11\..* input: 10\.&quot;</span>,</div>
<div class="line"><span class="lineno">  654</span>        ),</div>
<div class="line"><span class="lineno">  655</span>        (</div>
<div class="line"><span class="lineno">  656</span>            <span class="keyword">lambda</span> D, s: (D, np.concatenate([D, D[-1:]])),</div>
<div class="line"><span class="lineno">  657</span>            ValueError,</div>
<div class="line"><span class="lineno">  658</span>            <span class="stringliteral">r&quot;length \&zwj;(10, 11\&zwj;)\..* input: 10\.&quot;</span>,</div>
<div class="line"><span class="lineno">  659</span>        ),</div>
<div class="line"><span class="lineno">  660</span>        (<span class="keyword">lambda</span> D, s: (D[:9], D), ValueError, <span class="stringliteral">r&quot;length \&zwj;(9, 10\&zwj;)\..* input: 10\.&quot;</span>),</div>
<div class="line"><span class="lineno">  661</span>        (</div>
<div class="line"><span class="lineno">  662</span>            <span class="keyword">lambda</span> D, s: 7,</div>
<div class="line"><span class="lineno">  663</span>            TypeError,</div>
<div class="line"><span class="lineno">  664</span>            <span class="stringliteral">r&quot;returned 7\. Expected sequence\&zwj;(s\&zwj;) of length 10\.&quot;</span>,</div>
<div class="line"><span class="lineno">  665</span>        ),</div>
<div class="line"><span class="lineno">  666</span>        (</div>
<div class="line"><span class="lineno">  667</span>            <span class="keyword">lambda</span> D, s: (7, 8),</div>
<div class="line"><span class="lineno">  668</span>            TypeError,</div>
<div class="line"><span class="lineno">  669</span>            <span class="stringliteral">r&quot;returned \&zwj;(7, 8\&zwj;)\. Expected sequence\&zwj;(s\&zwj;) of length 10\.&quot;</span>,</div>
<div class="line"><span class="lineno">  670</span>        ),</div>
<div class="line"><span class="lineno">  671</span>        (</div>
<div class="line"><span class="lineno">  672</span>            <span class="keyword">lambda</span> D, s: (np.arange(10), 9),</div>
<div class="line"><span class="lineno">  673</span>            TypeError,</div>
<div class="line"><span class="lineno">  674</span>            <span class="stringliteral">r&quot;, 9\&zwj;)\. Expected sequence\&zwj;(s\&zwj;) of length 10\.&quot;</span>,</div>
<div class="line"><span class="lineno">  675</span>        ),</div>
<div class="line"><span class="lineno">  676</span>    ],</div>
<div class="line"><span class="lineno">  677</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a60254b9aef7dfdfb7ca74d7985fe8503" name="a60254b9aef7dfdfb7ca74d7985fe8503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60254b9aef7dfdfb7ca74d7985fe8503">&#9670;&#160;</a></span>test_pairwise_distances_data_derived_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_data_derived_params </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_jobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dist_function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1477</span><span class="keyword">def </span>test_pairwise_distances_data_derived_params(n_jobs, metric, dist_function):</div>
<div class="line"><span class="lineno"> 1478</span>    <span class="comment"># check that pairwise_distances give the same result in sequential and</span></div>
<div class="line"><span class="lineno"> 1479</span>    <span class="comment"># parallel, when metric has data-derived parameters.</span></div>
<div class="line"><span class="lineno"> 1480</span>    <span class="keyword">with</span> config_context(working_memory=0.1):  <span class="comment"># to have more than 1 chunk</span></div>
<div class="line"><span class="lineno"> 1481</span>        rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1482</span>        X = rng.random_sample((100, 10))</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>        expected_dist = squareform(pdist(X, metric=metric))</div>
<div class="line"><span class="lineno"> 1485</span>        dist = np.vstack(tuple(dist_function(X, metric=metric, n_jobs=n_jobs)))</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>        assert_allclose(dist, expected_dist)</div>
<div class="line"><span class="lineno"> 1488</span> </div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span><span class="preprocessor">@pytest.mark.parametrize(&quot;metric&quot;, [&quot;seuclidean&quot;, &quot;mahalanobis&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab78cb361439277ed6033741a47c49a5d" name="ab78cb361439277ed6033741a47c49a5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab78cb361439277ed6033741a47c49a5d">&#9670;&#160;</a></span>test_pairwise_distances_data_derived_params_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_distances_data_derived_params_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1491</span><span class="keyword">def </span>test_pairwise_distances_data_derived_params_error(metric):</div>
<div class="line"><span class="lineno"> 1492</span>    <span class="comment"># check that pairwise_distances raises an error when Y is passed but</span></div>
<div class="line"><span class="lineno"> 1493</span>    <span class="comment"># metric has data-derived params that are not provided by the user.</span></div>
<div class="line"><span class="lineno"> 1494</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1495</span>    X = rng.random_sample((100, 10))</div>
<div class="line"><span class="lineno"> 1496</span>    Y = rng.random_sample((100, 10))</div>
<div class="line"><span class="lineno"> 1497</span> </div>
<div class="line"><span class="lineno"> 1498</span>    <span class="keyword">with</span> pytest.raises(</div>
<div class="line"><span class="lineno"> 1499</span>        ValueError,</div>
<div class="line"><span class="lineno"> 1500</span>        match=rf<span class="stringliteral">&quot;The &#39;(V|VI)&#39; parameter is required for the &quot;</span> rf<span class="stringliteral">&quot;{metric} metric&quot;</span>,</div>
<div class="line"><span class="lineno"> 1501</span>    ):</div>
<div class="line"><span class="lineno"> 1502</span>        pairwise_distances(X, Y, metric=metric)</div>
<div class="line"><span class="lineno"> 1503</span> </div>
<div class="line"><span class="lineno"> 1504</span> </div>
<div class="line"><span class="lineno"> 1505</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1506</span>    <span class="stringliteral">&quot;metric&quot;</span>,</div>
<div class="line"><span class="lineno"> 1507</span>    [</div>
<div class="line"><span class="lineno"> 1508</span>        <span class="stringliteral">&quot;braycurtis&quot;</span>,</div>
<div class="line"><span class="lineno"> 1509</span>        <span class="stringliteral">&quot;canberra&quot;</span>,</div>
<div class="line"><span class="lineno"> 1510</span>        <span class="stringliteral">&quot;chebyshev&quot;</span>,</div>
<div class="line"><span class="lineno"> 1511</span>        <span class="stringliteral">&quot;correlation&quot;</span>,</div>
<div class="line"><span class="lineno"> 1512</span>        <span class="stringliteral">&quot;hamming&quot;</span>,</div>
<div class="line"><span class="lineno"> 1513</span>        <span class="stringliteral">&quot;mahalanobis&quot;</span>,</div>
<div class="line"><span class="lineno"> 1514</span>        <span class="stringliteral">&quot;minkowski&quot;</span>,</div>
<div class="line"><span class="lineno"> 1515</span>        <span class="stringliteral">&quot;seuclidean&quot;</span>,</div>
<div class="line"><span class="lineno"> 1516</span>        <span class="stringliteral">&quot;sqeuclidean&quot;</span>,</div>
<div class="line"><span class="lineno"> 1517</span>        <span class="stringliteral">&quot;cityblock&quot;</span>,</div>
<div class="line"><span class="lineno"> 1518</span>        <span class="stringliteral">&quot;cosine&quot;</span>,</div>
<div class="line"><span class="lineno"> 1519</span>        <span class="stringliteral">&quot;euclidean&quot;</span>,</div>
<div class="line"><span class="lineno"> 1520</span>    ],</div>
<div class="line"><span class="lineno"> 1521</span>)</div>
<div class="line"><span class="lineno"> 1522</span><span class="preprocessor">@pytest.mark.parametrize(&quot;y_is_x&quot;, [True, False], ids=[&quot;Y is X&quot;, &quot;Y is not X&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43a35bf9b7b866c432c5e7224623de09" name="a43a35bf9b7b866c432c5e7224623de09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43a35bf9b7b866c432c5e7224623de09">&#9670;&#160;</a></span>test_pairwise_kernels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_kernels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  367</span><span class="keyword">def </span>test_pairwise_kernels(metric):</div>
<div class="line"><span class="lineno">  368</span>    <span class="comment"># Test the pairwise_kernels helper function.</span></div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  371</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno">  372</span>    Y = rng.random_sample((2, 4))</div>
<div class="line"><span class="lineno">  373</span>    function = PAIRWISE_KERNEL_FUNCTIONS[metric]</div>
<div class="line"><span class="lineno">  374</span>    <span class="comment"># Test with Y=None</span></div>
<div class="line"><span class="lineno">  375</span>    K1 = pairwise_kernels(X, metric=metric)</div>
<div class="line"><span class="lineno">  376</span>    K2 = function(X)</div>
<div class="line"><span class="lineno">  377</span>    assert_allclose(K1, K2)</div>
<div class="line"><span class="lineno">  378</span>    <span class="comment"># Test with Y=Y</span></div>
<div class="line"><span class="lineno">  379</span>    K1 = pairwise_kernels(X, Y=Y, metric=metric)</div>
<div class="line"><span class="lineno">  380</span>    K2 = function(X, Y=Y)</div>
<div class="line"><span class="lineno">  381</span>    assert_allclose(K1, K2)</div>
<div class="line"><span class="lineno">  382</span>    <span class="comment"># Test with tuples as X and Y</span></div>
<div class="line"><span class="lineno">  383</span>    X_tuples = tuple([tuple([v <span class="keywordflow">for</span> v <span class="keywordflow">in</span> row]) <span class="keywordflow">for</span> row <span class="keywordflow">in</span> X])</div>
<div class="line"><span class="lineno">  384</span>    Y_tuples = tuple([tuple([v <span class="keywordflow">for</span> v <span class="keywordflow">in</span> row]) <span class="keywordflow">for</span> row <span class="keywordflow">in</span> Y])</div>
<div class="line"><span class="lineno">  385</span>    K2 = pairwise_kernels(X_tuples, Y_tuples, metric=metric)</div>
<div class="line"><span class="lineno">  386</span>    assert_allclose(K1, K2)</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    <span class="comment"># Test with sparse X and Y</span></div>
<div class="line"><span class="lineno">  389</span>    X_sparse = csr_matrix(X)</div>
<div class="line"><span class="lineno">  390</span>    Y_sparse = csr_matrix(Y)</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">if</span> metric <span class="keywordflow">in</span> [<span class="stringliteral">&quot;chi2&quot;</span>, <span class="stringliteral">&quot;additive_chi2&quot;</span>]:</div>
<div class="line"><span class="lineno">  392</span>        <span class="comment"># these don&#39;t support sparse matrices yet</span></div>
<div class="line"><span class="lineno">  393</span>        <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  394</span>            pairwise_kernels(X_sparse, Y=Y_sparse, metric=metric)</div>
<div class="line"><span class="lineno">  395</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  396</span>    K1 = pairwise_kernels(X_sparse, Y=Y_sparse, metric=metric)</div>
<div class="line"><span class="lineno">  397</span>    assert_allclose(K1, K2)</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ddec6f72ac8a68e3bcf9fca631cd455" name="a8ddec6f72ac8a68e3bcf9fca631cd455"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ddec6f72ac8a68e3bcf9fca631cd455">&#9670;&#160;</a></span>test_pairwise_kernels_callable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_kernels_callable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  400</span><span class="keyword">def </span>test_pairwise_kernels_callable():</div>
<div class="line"><span class="lineno">  401</span>    <span class="comment"># Test the pairwise_kernels helper function</span></div>
<div class="line"><span class="lineno">  402</span>    <span class="comment"># with a callable function, with given keywords.</span></div>
<div class="line"><span class="lineno">  403</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  404</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno">  405</span>    Y = rng.random_sample((2, 4))</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    metric = callable_rbf_kernel</div>
<div class="line"><span class="lineno">  408</span>    kwds = {<span class="stringliteral">&quot;gamma&quot;</span>: 0.1}</div>
<div class="line"><span class="lineno">  409</span>    K1 = pairwise_kernels(X, Y=Y, metric=metric, **kwds)</div>
<div class="line"><span class="lineno">  410</span>    K2 = rbf_kernel(X, Y=Y, **kwds)</div>
<div class="line"><span class="lineno">  411</span>    assert_allclose(K1, K2)</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    <span class="comment"># callable function, X=Y</span></div>
<div class="line"><span class="lineno">  414</span>    K1 = pairwise_kernels(X, Y=X, metric=metric, **kwds)</div>
<div class="line"><span class="lineno">  415</span>    K2 = rbf_kernel(X, Y=X, **kwds)</div>
<div class="line"><span class="lineno">  416</span>    assert_allclose(K1, K2)</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acdcb2526f5f8a350b80045a5bbe280c6" name="acdcb2526f5f8a350b80045a5bbe280c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdcb2526f5f8a350b80045a5bbe280c6">&#9670;&#160;</a></span>test_pairwise_kernels_filter_param()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_kernels_filter_param </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  419</span><span class="keyword">def </span>test_pairwise_kernels_filter_param():</div>
<div class="line"><span class="lineno">  420</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  421</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno">  422</span>    Y = rng.random_sample((2, 4))</div>
<div class="line"><span class="lineno">  423</span>    K = rbf_kernel(X, Y, gamma=0.1)</div>
<div class="line"><span class="lineno">  424</span>    params = {<span class="stringliteral">&quot;gamma&quot;</span>: 0.1, <span class="stringliteral">&quot;blabla&quot;</span>: <span class="stringliteral">&quot;:)&quot;</span>}</div>
<div class="line"><span class="lineno">  425</span>    K2 = pairwise_kernels(X, Y, metric=<span class="stringliteral">&quot;rbf&quot;</span>, filter_params=<span class="keyword">True</span>, **params)</div>
<div class="line"><span class="lineno">  426</span>    assert_allclose(K, K2)</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    <span class="keyword">with</span> pytest.raises(TypeError):</div>
<div class="line"><span class="lineno">  429</span>        pairwise_kernels(X, Y, metric=<span class="stringliteral">&quot;rbf&quot;</span>, **params)</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span><span class="preprocessor">@pytest.mark.parametrize(&quot;metric, func&quot;, PAIRED_DISTANCES.items()</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa765a5ebc94e52a3bc5dbed38d716a55" name="aa765a5ebc94e52a3bc5dbed38d716a55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa765a5ebc94e52a3bc5dbed38d716a55">&#9670;&#160;</a></span>test_pairwise_parallel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_parallel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  341</span><span class="keyword">def </span>test_pairwise_parallel(func, metric, kwds, dtype):</div>
<div class="line"><span class="lineno">  342</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  343</span>    X = np.array(5 * rng.random_sample((5, 4)), dtype=dtype)</div>
<div class="line"><span class="lineno">  344</span>    Y = np.array(5 * rng.random_sample((3, 4)), dtype=dtype)</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    S = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(X, metric=metric, n_jobs=1, **kwds)</div>
<div class="line"><span class="lineno">  347</span>    S2 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(X, metric=metric, n_jobs=2, **kwds)</div>
<div class="line"><span class="lineno">  348</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>    S = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(X, Y, metric=metric, n_jobs=1, **kwds)</div>
<div class="line"><span class="lineno">  351</span>    S2 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(X, Y, metric=metric, n_jobs=2, **kwds)</div>
<div class="line"><span class="lineno">  352</span>    assert_allclose(S, S2)</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aad437a0aabc275592f638712239bf145" name="aad437a0aabc275592f638712239bf145"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad437a0aabc275592f638712239bf145">&#9670;&#160;</a></span>test_pairwise_precomputed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_precomputed </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  257</span><span class="keyword">def </span>test_pairwise_precomputed(func):</div>
<div class="line"><span class="lineno">  258</span>    <span class="comment"># Test correct shape</span></div>
<div class="line"><span class="lineno">  259</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;.* shape .*&quot;</span>):</div>
<div class="line"><span class="lineno">  260</span>        <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(np.zeros((5, 3)), metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  261</span>    <span class="comment"># with two args</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;.* shape .*&quot;</span>):</div>
<div class="line"><span class="lineno">  263</span>        <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(np.zeros((5, 3)), np.zeros((4, 4)), metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  264</span>    <span class="comment"># even if shape[1] agrees (although thus second arg is spurious)</span></div>
<div class="line"><span class="lineno">  265</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;.* shape .*&quot;</span>):</div>
<div class="line"><span class="lineno">  266</span>        <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(np.zeros((5, 3)), np.zeros((4, 3)), metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    <span class="comment"># Test not copied (if appropriate dtype)</span></div>
<div class="line"><span class="lineno">  269</span>    S = np.zeros((5, 5))</div>
<div class="line"><span class="lineno">  270</span>    S2 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(S, metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  271</span>    <span class="keyword">assert</span> S <span class="keywordflow">is</span> S2</div>
<div class="line"><span class="lineno">  272</span>    <span class="comment"># with two args</span></div>
<div class="line"><span class="lineno">  273</span>    S = np.zeros((5, 3))</div>
<div class="line"><span class="lineno">  274</span>    S2 = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(S, np.zeros((3, 3)), metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  275</span>    <span class="keyword">assert</span> S <span class="keywordflow">is</span> S2</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>    <span class="comment"># Test always returns float dtype</span></div>
<div class="line"><span class="lineno">  278</span>    S = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(np.array([[1]], dtype=<span class="stringliteral">&quot;int&quot;</span>), metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  279</span>    <span class="keyword">assert</span> <span class="stringliteral">&quot;f&quot;</span> == S.dtype.kind</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="comment"># Test converts list to array-like</span></div>
<div class="line"><span class="lineno">  282</span>    S = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>([[1.0]], metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  283</span>    <span class="keyword">assert</span> isinstance(S, np.ndarray)</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a499ea6383b45dbc4ff6911989b772100" name="a499ea6383b45dbc4ff6911989b772100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a499ea6383b45dbc4ff6911989b772100">&#9670;&#160;</a></span>test_pairwise_precomputed_non_negative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_precomputed_non_negative </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  286</span><span class="keyword">def </span>test_pairwise_precomputed_non_negative():</div>
<div class="line"><span class="lineno">  287</span>    <span class="comment"># Test non-negative values</span></div>
<div class="line"><span class="lineno">  288</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;.* non-negative values.*&quot;</span>):</div>
<div class="line"><span class="lineno">  289</span>        pairwise_distances(np.full((5, 5), -1), metric=<span class="stringliteral">&quot;precomputed&quot;</span>)</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a886b0db790a2d09f876eb3ac05dff837" name="a886b0db790a2d09f876eb3ac05dff837"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886b0db790a2d09f876eb3ac05dff837">&#9670;&#160;</a></span>test_pairwise_similarity_sparse_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_pairwise_similarity_sparse_output </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pairwise_func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1311</span><span class="keyword">def </span>test_pairwise_similarity_sparse_output(metric, pairwise_func):</div>
<div class="line"><span class="lineno"> 1312</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1313</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1314</span>    Y = rng.random_sample((3, 4))</div>
<div class="line"><span class="lineno"> 1315</span>    Xcsr = csr_matrix(X)</div>
<div class="line"><span class="lineno"> 1316</span>    Ycsr = csr_matrix(Y)</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span>    <span class="comment"># should be sparse</span></div>
<div class="line"><span class="lineno"> 1319</span>    K1 = pairwise_func(Xcsr, Ycsr, dense_output=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1320</span>    <span class="keyword">assert</span> issparse(K1)</div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>    <span class="comment"># should be dense, and equal to K1</span></div>
<div class="line"><span class="lineno"> 1323</span>    K2 = pairwise_func(X, Y, dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1324</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> issparse(K2)</div>
<div class="line"><span class="lineno"> 1325</span>    assert_allclose(K1.toarray(), K2)</div>
<div class="line"><span class="lineno"> 1326</span> </div>
<div class="line"><span class="lineno"> 1327</span>    <span class="comment"># show the kernel output equal to the sparse.toarray()</span></div>
<div class="line"><span class="lineno"> 1328</span>    K3 = pairwise_kernels(X, Y=Y, metric=metric)</div>
<div class="line"><span class="lineno"> 1329</span>    assert_allclose(K1.toarray(), K3)</div>
<div class="line"><span class="lineno"> 1330</span> </div>
<div class="line"><span class="lineno"> 1331</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac06d71bd875dd87d42ea6263f2174aaa" name="ac06d71bd875dd87d42ea6263f2174aaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac06d71bd875dd87d42ea6263f2174aaa">&#9670;&#160;</a></span>test_parallel_pairwise_distances_diagonal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_parallel_pairwise_distances_diagonal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  715</span><span class="keyword">def </span>test_parallel_pairwise_distances_diagonal(metric, global_dtype):</div>
<div class="line"><span class="lineno">  716</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  717</span>    X = rng.normal(size=(1000, 10), scale=1e10).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  718</span>    distances = pairwise_distances(X, metric=metric, n_jobs=2)</div>
<div class="line"><span class="lineno">  719</span>    assert_allclose(np.diag(distances), 0, atol=1e-10)</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span><span class="preprocessor">@ignore_warnings</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a069e06ddb41f55e94d9ae532e834659e" name="a069e06ddb41f55e94d9ae532e834659e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a069e06ddb41f55e94d9ae532e834659e">&#9670;&#160;</a></span>test_rbf_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.test_rbf_kernel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1288</span><span class="keyword">def </span>test_rbf_kernel():</div>
<div class="line"><span class="lineno"> 1289</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1290</span>    X = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno"> 1291</span>    K = rbf_kernel(X, X)</div>
<div class="line"><span class="lineno"> 1292</span>    <span class="comment"># the diagonal elements of a rbf kernel are 1</span></div>
<div class="line"><span class="lineno"> 1293</span>    assert_allclose(K.flat[::6], np.ones(5))</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a66785c9d27cb8f122ac5293b026b387a" name="a66785c9d27cb8f122ac5293b026b387a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66785c9d27cb8f122ac5293b026b387a">&#9670;&#160;</a></span>tuplify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.metrics.tests.test_pairwise.tuplify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1425</span><span class="keyword">def </span>tuplify(X):</div>
<div class="line"><span class="lineno"> 1426</span>    <span class="comment"># Turns a numpy matrix (any n-dimensional array) into tuples.</span></div>
<div class="line"><span class="lineno"> 1427</span>    s = X.shape</div>
<div class="line"><span class="lineno"> 1428</span>    <span class="keywordflow">if</span> len(s) &gt; 1:</div>
<div class="line"><span class="lineno"> 1429</span>        <span class="comment"># Tuplify each sub-array in the input.</span></div>
<div class="line"><span class="lineno"> 1430</span>        <span class="keywordflow">return</span> tuple(tuplify(row) <span class="keywordflow">for</span> row <span class="keywordflow">in</span> X)</div>
<div class="line"><span class="lineno"> 1431</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1432</span>        <span class="comment"># Single dimension input, just return tuple of contents.</span></div>
<div class="line"><span class="lineno"> 1433</span>        <span class="keywordflow">return</span> tuple(r <span class="keywordflow">for</span> r <span class="keywordflow">in</span> X)</div>
<div class="line"><span class="lineno"> 1434</span> </div>
<div class="line"><span class="lineno"> 1435</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="afee96f45c000c45e1b5574b09fb47f69" name="afee96f45c000c45e1b5574b09fb47f69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afee96f45c000c45e1b5574b09fb47f69">&#9670;&#160;</a></span>_minkowski_kwds</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict sklearn.metrics.tests.test_pairwise._minkowski_kwds = {&quot;w&quot;: np.arange(1, 5).astype(&quot;double&quot;, copy=False), &quot;p&quot;: 1}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aed7b349fa5e347bb189140504c84300f" name="aed7b349fa5e347bb189140504c84300f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed7b349fa5e347bb189140504c84300f">&#9670;&#160;</a></span>_wminkowski_kwds</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dict sklearn.metrics.tests.test_pairwise._wminkowski_kwds = {&quot;w&quot;: np.arange(1, 5).astype(&quot;double&quot;, copy=False), &quot;p&quot;: 1}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
