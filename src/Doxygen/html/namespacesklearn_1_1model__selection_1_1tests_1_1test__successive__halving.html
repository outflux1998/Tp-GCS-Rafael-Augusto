<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.model_selection.tests.test_successive_halving Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1model__selection.html">model_selection</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html">test_successive_halving</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.model_selection.tests.test_successive_halving Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1tests_1_1test__successive__halving_1_1_fast_classifier.html">FastClassifier</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1model__selection_1_1tests_1_1test__successive__halving_1_1_sometimes_fail_classifier.html">SometimesFailClassifier</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a07dc982f965d66df67f03c321c2db2cf" id="r_a07dc982f965d66df67f03c321c2db2cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#a07dc982f965d66df67f03c321c2db2cf">test_nan_handling</a> (HalvingSearch, fail_at)</td></tr>
<tr class="separator:a07dc982f965d66df67f03c321c2db2cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afca4361c40c432c72efb057e880076d1" id="r_afca4361c40c432c72efb057e880076d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#afca4361c40c432c72efb057e880076d1">test_aggressive_elimination</a> (Est, aggressive_elimination, max_resources, expected_n_iterations, expected_n_required_iterations, expected_n_possible_iterations, expected_n_remaining_candidates, expected_n_candidates, expected_n_resources)</td></tr>
<tr class="separator:afca4361c40c432c72efb057e880076d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49504835917a7481aa10d46c21704159" id="r_a49504835917a7481aa10d46c21704159"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#a49504835917a7481aa10d46c21704159">test_min_max_resources</a> (Est, min_resources, max_resources, expected_n_iterations, expected_n_possible_iterations, expected_n_resources)</td></tr>
<tr class="separator:a49504835917a7481aa10d46c21704159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c4edd67cbfd263d439b39d716ba9cfc" id="r_a5c4edd67cbfd263d439b39d716ba9cfc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#a5c4edd67cbfd263d439b39d716ba9cfc">test_n_iterations</a> (Est, max_resources, n_iterations, n_possible_iterations)</td></tr>
<tr class="separator:a5c4edd67cbfd263d439b39d716ba9cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca315ad61450e1525a00949244b6b7a" id="r_aaca315ad61450e1525a00949244b6b7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#aaca315ad61450e1525a00949244b6b7a">test_resource_parameter</a> (Est)</td></tr>
<tr class="separator:aaca315ad61450e1525a00949244b6b7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62fb5fa91e4e8409de98c78c8dc2718e" id="r_a62fb5fa91e4e8409de98c78c8dc2718e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#a62fb5fa91e4e8409de98c78c8dc2718e">test_random_search</a> (max_resources, n_candidates, expected_n_candidates)</td></tr>
<tr class="separator:a62fb5fa91e4e8409de98c78c8dc2718e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf1d9e3b474de259fd41c6589839138e" id="r_aaf1d9e3b474de259fd41c6589839138e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#aaf1d9e3b474de259fd41c6589839138e">test_random_search_discrete_distributions</a> (param_distributions, expected_n_candidates)</td></tr>
<tr class="separator:aaf1d9e3b474de259fd41c6589839138e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74d120502cea8001d5912ff52a3c84b1" id="r_a74d120502cea8001d5912ff52a3c84b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#a74d120502cea8001d5912ff52a3c84b1">test_input_errors</a> (Est, params, expected_error_message)</td></tr>
<tr class="separator:a74d120502cea8001d5912ff52a3c84b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabac22c3274e1b769651e4ba3c0d5915" id="r_aabac22c3274e1b769651e4ba3c0d5915"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#aabac22c3274e1b769651e4ba3c0d5915">test_input_errors_randomized</a> (params, expected_error_message)</td></tr>
<tr class="separator:aabac22c3274e1b769651e4ba3c0d5915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af675696570a8b0d6c2fe4ff7915ffd6c" id="r_af675696570a8b0d6c2fe4ff7915ffd6c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#af675696570a8b0d6c2fe4ff7915ffd6c">test_subsample_splitter_shapes</a> (fraction, subsample_test, expected_train_size, expected_test_size)</td></tr>
<tr class="separator:af675696570a8b0d6c2fe4ff7915ffd6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aa51ae8462fc9763182c86ab948db80" id="r_a6aa51ae8462fc9763182c86ab948db80"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#a6aa51ae8462fc9763182c86ab948db80">test_subsample_splitter_determinism</a> (subsample_test)</td></tr>
<tr class="separator:a6aa51ae8462fc9763182c86ab948db80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f18af8ef20beb193314b1aba0dd268" id="r_a37f18af8ef20beb193314b1aba0dd268"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#a37f18af8ef20beb193314b1aba0dd268">test_top_k</a> (<a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, itr, expected)</td></tr>
<tr class="separator:a37f18af8ef20beb193314b1aba0dd268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca5f7132ea9022fef04fb67c04fe546d" id="r_aca5f7132ea9022fef04fb67c04fe546d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#aca5f7132ea9022fef04fb67c04fe546d">test_cv_results</a> (Est)</td></tr>
<tr class="separator:aca5f7132ea9022fef04fb67c04fe546d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab584f55a088c0ea30cdd3eca55700525" id="r_ab584f55a088c0ea30cdd3eca55700525"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#ab584f55a088c0ea30cdd3eca55700525">test_base_estimator_inputs</a> (Est)</td></tr>
<tr class="separator:ab584f55a088c0ea30cdd3eca55700525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58d73e7314568e649c5ee017ca7e47c0" id="r_a58d73e7314568e649c5ee017ca7e47c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#a58d73e7314568e649c5ee017ca7e47c0">test_groups_support</a> (Est)</td></tr>
<tr class="separator:a58d73e7314568e649c5ee017ca7e47c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1571a1e26b6c38b1337ceceec446f5a" id="r_af1571a1e26b6c38b1337ceceec446f5a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#af1571a1e26b6c38b1337ceceec446f5a">test_min_resources_null</a> (SearchCV)</td></tr>
<tr class="separator:af1571a1e26b6c38b1337ceceec446f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af901b1c3c1d03d5afb29e4a268fbc9b0" id="r_af901b1c3c1d03d5afb29e4a268fbc9b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1model__selection_1_1tests_1_1test__successive__halving.html#af901b1c3c1d03d5afb29e4a268fbc9b0">test_select_best_index</a> (SearchCV)</td></tr>
<tr class="separator:af901b1c3c1d03d5afb29e4a268fbc9b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="afca4361c40c432c72efb057e880076d1" name="afca4361c40c432c72efb057e880076d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afca4361c40c432c72efb057e880076d1">&#9670;&#160;</a></span>test_aggressive_elimination()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_aggressive_elimination </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aggressive_elimination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_required_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_possible_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_remaining_candidates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_candidates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_resources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  160</span>):</div>
<div class="line"><span class="lineno">  161</span>    <span class="comment"># Test the aggressive_elimination parameter.</span></div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    n_samples = 1000</div>
<div class="line"><span class="lineno">  164</span>    X, y = make_classification(n_samples=n_samples, random_state=0)</div>
<div class="line"><span class="lineno">  165</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: (<span class="stringliteral">&quot;l1&quot;</span>, <span class="stringliteral">&quot;l2&quot;</span>), <span class="stringliteral">&quot;b&quot;</span>: list(range(30))}</div>
<div class="line"><span class="lineno">  166</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">if</span> max_resources == <span class="stringliteral">&quot;limited&quot;</span>:</div>
<div class="line"><span class="lineno">  169</span>        max_resources = 180</div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  171</span>        max_resources = n_samples</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    sh = Est(</div>
<div class="line"><span class="lineno">  174</span>        base_estimator,</div>
<div class="line"><span class="lineno">  175</span>        param_grid,</div>
<div class="line"><span class="lineno">  176</span>        aggressive_elimination=aggressive_elimination,</div>
<div class="line"><span class="lineno">  177</span>        max_resources=max_resources,</div>
<div class="line"><span class="lineno">  178</span>        factor=3,</div>
<div class="line"><span class="lineno">  179</span>    )</div>
<div class="line"><span class="lineno">  180</span>    sh.set_params(verbose=<span class="keyword">True</span>)  <span class="comment"># just for test coverage</span></div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">if</span> Est <span class="keywordflow">is</span> HalvingRandomSearchCV:</div>
<div class="line"><span class="lineno">  183</span>        <span class="comment"># same number of candidates as with the grid</span></div>
<div class="line"><span class="lineno">  184</span>        sh.set_params(n_candidates=2 * 30, min_resources=<span class="stringliteral">&quot;exhaust&quot;</span>)</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    sh.fit(X, y)</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="keyword">assert</span> sh.n_iterations_ == expected_n_iterations</div>
<div class="line"><span class="lineno">  189</span>    <span class="keyword">assert</span> sh.n_required_iterations_ == expected_n_required_iterations</div>
<div class="line"><span class="lineno">  190</span>    <span class="keyword">assert</span> sh.n_possible_iterations_ == expected_n_possible_iterations</div>
<div class="line"><span class="lineno">  191</span>    <span class="keyword">assert</span> sh.n_resources_ == expected_n_resources</div>
<div class="line"><span class="lineno">  192</span>    <span class="keyword">assert</span> sh.n_candidates_ == expected_n_candidates</div>
<div class="line"><span class="lineno">  193</span>    <span class="keyword">assert</span> sh.n_remaining_candidates_ == expected_n_remaining_candidates</div>
<div class="line"><span class="lineno">  194</span>    <span class="keyword">assert</span> ceil(sh.n_candidates_[-1] / sh.factor) == sh.n_remaining_candidates_</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Est&quot;, (HalvingGridSearchCV, HalvingRandomSearchCV)</span>)</div>
<div class="line"><span class="lineno">  198</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  199</span>    <span class="stringliteral">&quot;min_resources,&quot;</span></div>
<div class="line"><span class="lineno">  200</span>    <span class="stringliteral">&quot;max_resources,&quot;</span></div>
<div class="line"><span class="lineno">  201</span>    <span class="stringliteral">&quot;expected_n_iterations,&quot;</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="stringliteral">&quot;expected_n_possible_iterations,&quot;</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="stringliteral">&quot;expected_n_resources,&quot;</span>,</div>
<div class="line"><span class="lineno">  204</span>    [</div>
<div class="line"><span class="lineno">  205</span>        <span class="comment"># with enough resources</span></div>
<div class="line"><span class="lineno">  206</span>        (<span class="stringliteral">&quot;smallest&quot;</span>, <span class="stringliteral">&quot;auto&quot;</span>, 2, 4, [20, 60]),</div>
<div class="line"><span class="lineno">  207</span>        <span class="comment"># with enough resources but min_resources set manually</span></div>
<div class="line"><span class="lineno">  208</span>        (50, <span class="stringliteral">&quot;auto&quot;</span>, 2, 3, [50, 150]),</div>
<div class="line"><span class="lineno">  209</span>        <span class="comment"># without enough resources, only one iteration can be done</span></div>
<div class="line"><span class="lineno">  210</span>        (<span class="stringliteral">&quot;smallest&quot;</span>, 30, 1, 1, [20]),</div>
<div class="line"><span class="lineno">  211</span>        <span class="comment"># with exhaust: use as much resources as possible at the last iter</span></div>
<div class="line"><span class="lineno">  212</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, <span class="stringliteral">&quot;auto&quot;</span>, 2, 2, [333, 999]),</div>
<div class="line"><span class="lineno">  213</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, 1000, 2, 2, [333, 999]),</div>
<div class="line"><span class="lineno">  214</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, 999, 2, 2, [333, 999]),</div>
<div class="line"><span class="lineno">  215</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, 600, 2, 2, [200, 600]),</div>
<div class="line"><span class="lineno">  216</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, 599, 2, 2, [199, 597]),</div>
<div class="line"><span class="lineno">  217</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, 300, 2, 2, [100, 300]),</div>
<div class="line"><span class="lineno">  218</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, 60, 2, 2, [20, 60]),</div>
<div class="line"><span class="lineno">  219</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, 50, 1, 1, [20]),</div>
<div class="line"><span class="lineno">  220</span>        (<span class="stringliteral">&quot;exhaust&quot;</span>, 20, 1, 1, [20]),</div>
<div class="line"><span class="lineno">  221</span>    ],</div>
<div class="line"><span class="lineno">  222</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab584f55a088c0ea30cdd3eca55700525" name="ab584f55a088c0ea30cdd3eca55700525"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab584f55a088c0ea30cdd3eca55700525">&#9670;&#160;</a></span>test_base_estimator_inputs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_base_estimator_inputs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Est</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  659</span><span class="keyword">def </span>test_base_estimator_inputs(Est):</div>
<div class="line"><span class="lineno">  660</span>    <span class="comment"># make sure that the base estimators are passed the correct parameters and</span></div>
<div class="line"><span class="lineno">  661</span>    <span class="comment"># number of samples at each iteration.</span></div>
<div class="line"><span class="lineno">  662</span>    pd = pytest.importorskip(<span class="stringliteral">&quot;pandas&quot;</span>)</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    passed_n_samples_fit = []</div>
<div class="line"><span class="lineno">  665</span>    passed_n_samples_predict = []</div>
<div class="line"><span class="lineno">  666</span>    passed_params = []</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    <span class="keyword">class </span>FastClassifierBookKeeping(FastClassifier):</div>
<div class="line"><span class="lineno">  669</span>        <span class="keyword">def </span>fit(self, X, y):</div>
<div class="line"><span class="lineno">  670</span>            passed_n_samples_fit.append(X.shape[0])</div>
<div class="line"><span class="lineno">  671</span>            <span class="keywordflow">return</span> super().fit(X, y)</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>        <span class="keyword">def </span>predict(self, X):</div>
<div class="line"><span class="lineno">  674</span>            passed_n_samples_predict.append(X.shape[0])</div>
<div class="line"><span class="lineno">  675</span>            <span class="keywordflow">return</span> super().predict(X)</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>        <span class="keyword">def </span>set_params(self, **params):</div>
<div class="line"><span class="lineno">  678</span>            passed_params.append(params)</div>
<div class="line"><span class="lineno">  679</span>            <span class="keywordflow">return</span> super().set_params(**params)</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>    n_samples = 1024</div>
<div class="line"><span class="lineno">  682</span>    n_splits = 2</div>
<div class="line"><span class="lineno">  683</span>    X, y = make_classification(n_samples=n_samples, random_state=0)</div>
<div class="line"><span class="lineno">  684</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: (<span class="stringliteral">&quot;l1&quot;</span>, <span class="stringliteral">&quot;l2&quot;</span>), <span class="stringliteral">&quot;b&quot;</span>: list(range(30))}</div>
<div class="line"><span class="lineno">  685</span>    base_estimator = FastClassifierBookKeeping()</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>    sh = Est(</div>
<div class="line"><span class="lineno">  688</span>        base_estimator,</div>
<div class="line"><span class="lineno">  689</span>        param_grid,</div>
<div class="line"><span class="lineno">  690</span>        factor=2,</div>
<div class="line"><span class="lineno">  691</span>        cv=n_splits,</div>
<div class="line"><span class="lineno">  692</span>        return_train_score=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  693</span>        refit=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  694</span>    )</div>
<div class="line"><span class="lineno">  695</span>    <span class="keywordflow">if</span> Est <span class="keywordflow">is</span> HalvingRandomSearchCV:</div>
<div class="line"><span class="lineno">  696</span>        <span class="comment"># same number of candidates as with the grid</span></div>
<div class="line"><span class="lineno">  697</span>        sh.set_params(n_candidates=2 * 30, min_resources=<span class="stringliteral">&quot;exhaust&quot;</span>)</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    sh.fit(X, y)</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>    <span class="keyword">assert</span> len(passed_n_samples_fit) == len(passed_n_samples_predict)</div>
<div class="line"><span class="lineno">  702</span>    passed_n_samples = [</div>
<div class="line"><span class="lineno">  703</span>        x + y <span class="keywordflow">for</span> (x, y) <span class="keywordflow">in</span> zip(passed_n_samples_fit, passed_n_samples_predict)</div>
<div class="line"><span class="lineno">  704</span>    ]</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>    <span class="comment"># Lists are of length n_splits * n_iter * n_candidates_at_i.</span></div>
<div class="line"><span class="lineno">  707</span>    <span class="comment"># Each chunk of size n_splits corresponds to the n_splits folds for the</span></div>
<div class="line"><span class="lineno">  708</span>    <span class="comment"># same candidate at the same iteration, so they contain equal values. We</span></div>
<div class="line"><span class="lineno">  709</span>    <span class="comment"># subsample such that the lists are of length n_iter * n_candidates_at_it</span></div>
<div class="line"><span class="lineno">  710</span>    passed_n_samples = passed_n_samples[::n_splits]</div>
<div class="line"><span class="lineno">  711</span>    passed_params = passed_params[::n_splits]</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>    cv_results_df = pd.DataFrame(sh.cv_results_)</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>    <span class="keyword">assert</span> len(passed_params) == len(passed_n_samples) == len(cv_results_df)</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>    uniques, counts = np.unique(passed_n_samples, return_counts=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  718</span>    <span class="keyword">assert</span> (sh.n_resources_ == uniques).all()</div>
<div class="line"><span class="lineno">  719</span>    <span class="keyword">assert</span> (sh.n_candidates_ == counts).all()</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>    <span class="keyword">assert</span> (cv_results_df[<span class="stringliteral">&quot;params&quot;</span>] == passed_params).all()</div>
<div class="line"><span class="lineno">  722</span>    <span class="keyword">assert</span> (cv_results_df[<span class="stringliteral">&quot;n_resources&quot;</span>] == passed_n_samples).all()</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Est&quot;, (HalvingGridSearchCV, HalvingRandomSearchCV)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aca5f7132ea9022fef04fb67c04fe546d" name="aca5f7132ea9022fef04fb67c04fe546d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca5f7132ea9022fef04fb67c04fe546d">&#9670;&#160;</a></span>test_cv_results()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_cv_results </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Est</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  558</span><span class="keyword">def </span>test_cv_results(Est):</div>
<div class="line"><span class="lineno">  559</span>    <span class="comment"># test that the cv_results_ matches correctly the logic of the</span></div>
<div class="line"><span class="lineno">  560</span>    <span class="comment"># tournament: in particular that the candidates continued in each</span></div>
<div class="line"><span class="lineno">  561</span>    <span class="comment"># successive iteration are those that were best in the previous iteration</span></div>
<div class="line"><span class="lineno">  562</span>    pd = pytest.importorskip(<span class="stringliteral">&quot;pandas&quot;</span>)</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>    n_samples = 1000</div>
<div class="line"><span class="lineno">  567</span>    X, y = make_classification(n_samples=n_samples, random_state=0)</div>
<div class="line"><span class="lineno">  568</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: (<span class="stringliteral">&quot;l1&quot;</span>, <span class="stringliteral">&quot;l2&quot;</span>), <span class="stringliteral">&quot;b&quot;</span>: list(range(30))}</div>
<div class="line"><span class="lineno">  569</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>    <span class="comment"># generate random scores: we want to avoid ties, which would otherwise</span></div>
<div class="line"><span class="lineno">  572</span>    <span class="comment"># mess with the ordering and make testing harder</span></div>
<div class="line"><span class="lineno">  573</span>    <span class="keyword">def </span>scorer(est, X, y):</div>
<div class="line"><span class="lineno">  574</span>        <span class="keywordflow">return</span> rng.rand()</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>    sh = Est(base_estimator, param_grid, factor=2, scoring=scorer)</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> Est <span class="keywordflow">is</span> HalvingRandomSearchCV:</div>
<div class="line"><span class="lineno">  578</span>        <span class="comment"># same number of candidates as with the grid</span></div>
<div class="line"><span class="lineno">  579</span>        sh.set_params(n_candidates=2 * 30, min_resources=<span class="stringliteral">&quot;exhaust&quot;</span>)</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    sh.fit(X, y)</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    <span class="comment"># non-regression check for</span></div>
<div class="line"><span class="lineno">  584</span>    <span class="comment"># https://github.com/scikit-learn/scikit-learn/issues/19203</span></div>
<div class="line"><span class="lineno">  585</span>    <span class="keyword">assert</span> isinstance(sh.cv_results_[<span class="stringliteral">&quot;iter&quot;</span>], np.ndarray)</div>
<div class="line"><span class="lineno">  586</span>    <span class="keyword">assert</span> isinstance(sh.cv_results_[<span class="stringliteral">&quot;n_resources&quot;</span>], np.ndarray)</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    cv_results_df = pd.DataFrame(sh.cv_results_)</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    <span class="comment"># just make sure we don&#39;t have ties</span></div>
<div class="line"><span class="lineno">  591</span>    <span class="keyword">assert</span> len(cv_results_df[<span class="stringliteral">&quot;mean_test_score&quot;</span>].unique()) == len(cv_results_df)</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>    cv_results_df[<span class="stringliteral">&quot;params_str&quot;</span>] = cv_results_df[<span class="stringliteral">&quot;params&quot;</span>].apply(str)</div>
<div class="line"><span class="lineno">  594</span>    table = cv_results_df.pivot(</div>
<div class="line"><span class="lineno">  595</span>        index=<span class="stringliteral">&quot;params_str&quot;</span>, columns=<span class="stringliteral">&quot;iter&quot;</span>, values=<span class="stringliteral">&quot;mean_test_score&quot;</span></div>
<div class="line"><span class="lineno">  596</span>    )</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>    <span class="comment"># table looks like something like this:</span></div>
<div class="line"><span class="lineno">  599</span>    <span class="comment"># iter                    0      1       2        3   4   5</span></div>
<div class="line"><span class="lineno">  600</span>    <span class="comment"># params_str</span></div>
<div class="line"><span class="lineno">  601</span>    <span class="comment"># {&#39;a&#39;: &#39;l2&#39;, &#39;b&#39;: 23} 0.75    NaN     NaN      NaN NaN NaN</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="comment"># {&#39;a&#39;: &#39;l1&#39;, &#39;b&#39;: 30} 0.90  0.875     NaN      NaN NaN NaN</span></div>
<div class="line"><span class="lineno">  603</span>    <span class="comment"># {&#39;a&#39;: &#39;l1&#39;, &#39;b&#39;: 0}  0.75    NaN     NaN      NaN NaN NaN</span></div>
<div class="line"><span class="lineno">  604</span>    <span class="comment"># {&#39;a&#39;: &#39;l2&#39;, &#39;b&#39;: 3}  0.85  0.925  0.9125  0.90625 NaN NaN</span></div>
<div class="line"><span class="lineno">  605</span>    <span class="comment"># {&#39;a&#39;: &#39;l1&#39;, &#39;b&#39;: 5}  0.80    NaN     NaN      NaN NaN NaN</span></div>
<div class="line"><span class="lineno">  606</span>    <span class="comment"># ...</span></div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>    <span class="comment"># where a NaN indicates that the candidate wasn&#39;t evaluated at a given</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="comment"># iteration, because it wasn&#39;t part of the top-K at some previous</span></div>
<div class="line"><span class="lineno">  610</span>    <span class="comment"># iteration. We here make sure that candidates that aren&#39;t in the top-k at</span></div>
<div class="line"><span class="lineno">  611</span>    <span class="comment"># any given iteration are indeed not evaluated at the subsequent</span></div>
<div class="line"><span class="lineno">  612</span>    <span class="comment"># iterations.</span></div>
<div class="line"><span class="lineno">  613</span>    nan_mask = pd.isna(table)</div>
<div class="line"><span class="lineno">  614</span>    n_iter = sh.n_iterations_</div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordflow">for</span> it <span class="keywordflow">in</span> range(n_iter - 1):</div>
<div class="line"><span class="lineno">  616</span>        already_discarded_mask = nan_mask[it]</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>        <span class="comment"># make sure that if a candidate is already discarded, we don&#39;t evaluate</span></div>
<div class="line"><span class="lineno">  619</span>        <span class="comment"># it later</span></div>
<div class="line"><span class="lineno">  620</span>        <span class="keyword">assert</span> (</div>
<div class="line"><span class="lineno">  621</span>            already_discarded_mask &amp; nan_mask[it + 1] == already_discarded_mask</div>
<div class="line"><span class="lineno">  622</span>        ).all()</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>        <span class="comment"># make sure that the number of discarded candidate is correct</span></div>
<div class="line"><span class="lineno">  625</span>        discarded_now_mask = ~already_discarded_mask &amp; nan_mask[it + 1]</div>
<div class="line"><span class="lineno">  626</span>        kept_mask = ~already_discarded_mask &amp; ~discarded_now_mask</div>
<div class="line"><span class="lineno">  627</span>        <span class="keyword">assert</span> kept_mask.sum() == sh.n_candidates_[it + 1]</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>        <span class="comment"># make sure that all discarded candidates have a lower score than the</span></div>
<div class="line"><span class="lineno">  630</span>        <span class="comment"># kept candidates</span></div>
<div class="line"><span class="lineno">  631</span>        discarded_max_score = table[it].where(discarded_now_mask).max()</div>
<div class="line"><span class="lineno">  632</span>        kept_min_score = table[it].where(kept_mask).min()</div>
<div class="line"><span class="lineno">  633</span>        <span class="keyword">assert</span> discarded_max_score &lt; kept_min_score</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>    <span class="comment"># We now make sure that the best candidate is chosen only from the last</span></div>
<div class="line"><span class="lineno">  636</span>    <span class="comment"># iteration.</span></div>
<div class="line"><span class="lineno">  637</span>    <span class="comment"># We also make sure this is true even if there were higher scores in</span></div>
<div class="line"><span class="lineno">  638</span>    <span class="comment"># earlier rounds (this isn&#39;t generally the case, but worth ensuring it&#39;s</span></div>
<div class="line"><span class="lineno">  639</span>    <span class="comment"># possible).</span></div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>    last_iter = cv_results_df[<span class="stringliteral">&quot;iter&quot;</span>].max()</div>
<div class="line"><span class="lineno">  642</span>    idx_best_last_iter = cv_results_df[cv_results_df[<span class="stringliteral">&quot;iter&quot;</span>] == last_iter][</div>
<div class="line"><span class="lineno">  643</span>        <span class="stringliteral">&quot;mean_test_score&quot;</span></div>
<div class="line"><span class="lineno">  644</span>    ].idxmax()</div>
<div class="line"><span class="lineno">  645</span>    idx_best_all_iters = cv_results_df[<span class="stringliteral">&quot;mean_test_score&quot;</span>].idxmax()</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>    <span class="keyword">assert</span> sh.best_params_ == cv_results_df.iloc[idx_best_last_iter][<span class="stringliteral">&quot;params&quot;</span>]</div>
<div class="line"><span class="lineno">  648</span>    <span class="keyword">assert</span> (</div>
<div class="line"><span class="lineno">  649</span>        cv_results_df.iloc[idx_best_last_iter][<span class="stringliteral">&quot;mean_test_score&quot;</span>]</div>
<div class="line"><span class="lineno">  650</span>        &lt; cv_results_df.iloc[idx_best_all_iters][<span class="stringliteral">&quot;mean_test_score&quot;</span>]</div>
<div class="line"><span class="lineno">  651</span>    )</div>
<div class="line"><span class="lineno">  652</span>    <span class="keyword">assert</span> (</div>
<div class="line"><span class="lineno">  653</span>        cv_results_df.iloc[idx_best_last_iter][<span class="stringliteral">&quot;params&quot;</span>]</div>
<div class="line"><span class="lineno">  654</span>        != cv_results_df.iloc[idx_best_all_iters][<span class="stringliteral">&quot;params&quot;</span>]</div>
<div class="line"><span class="lineno">  655</span>    )</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Est&quot;, (HalvingGridSearchCV, HalvingRandomSearchCV)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a58d73e7314568e649c5ee017ca7e47c0" name="a58d73e7314568e649c5ee017ca7e47c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58d73e7314568e649c5ee017ca7e47c0">&#9670;&#160;</a></span>test_groups_support()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_groups_support </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Est</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  726</span><span class="keyword">def </span>test_groups_support(Est):</div>
<div class="line"><span class="lineno">  727</span>    <span class="comment"># Check if ValueError (when groups is None) propagates to</span></div>
<div class="line"><span class="lineno">  728</span>    <span class="comment"># HalvingGridSearchCV and HalvingRandomSearchCV</span></div>
<div class="line"><span class="lineno">  729</span>    <span class="comment"># And also check if groups is correctly passed to the cv object</span></div>
<div class="line"><span class="lineno">  730</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>    X, y = make_classification(n_samples=50, n_classes=2, random_state=0)</div>
<div class="line"><span class="lineno">  733</span>    groups = rng.randint(0, 3, 50)</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>    clf = LinearSVC(random_state=0)</div>
<div class="line"><span class="lineno">  736</span>    grid = {<span class="stringliteral">&quot;C&quot;</span>: [1]}</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>    group_cvs = [</div>
<div class="line"><span class="lineno">  739</span>        LeaveOneGroupOut(),</div>
<div class="line"><span class="lineno">  740</span>        LeavePGroupsOut(2),</div>
<div class="line"><span class="lineno">  741</span>        GroupKFold(n_splits=3),</div>
<div class="line"><span class="lineno">  742</span>        GroupShuffleSplit(random_state=0),</div>
<div class="line"><span class="lineno">  743</span>    ]</div>
<div class="line"><span class="lineno">  744</span>    error_msg = <span class="stringliteral">&quot;The &#39;groups&#39; parameter should not be None.&quot;</span></div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">for</span> cv <span class="keywordflow">in</span> group_cvs:</div>
<div class="line"><span class="lineno">  746</span>        gs = Est(clf, grid, cv=cv, random_state=0)</div>
<div class="line"><span class="lineno">  747</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=error_msg):</div>
<div class="line"><span class="lineno">  748</span>            gs.fit(X, y)</div>
<div class="line"><span class="lineno">  749</span>        gs.fit(X, y, groups=groups)</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>    non_group_cvs = [StratifiedKFold(), StratifiedShuffleSplit(random_state=0)]</div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">for</span> cv <span class="keywordflow">in</span> non_group_cvs:</div>
<div class="line"><span class="lineno">  753</span>        gs = Est(clf, grid, cv=cv)</div>
<div class="line"><span class="lineno">  754</span>        <span class="comment"># Should not raise an error</span></div>
<div class="line"><span class="lineno">  755</span>        gs.fit(X, y)</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span><span class="preprocessor">@pytest.mark.parametrize(&quot;SearchCV&quot;, [HalvingRandomSearchCV, HalvingGridSearchCV])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a74d120502cea8001d5912ff52a3c84b1" name="a74d120502cea8001d5912ff52a3c84b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74d120502cea8001d5912ff52a3c84b1">&#9670;&#160;</a></span>test_input_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_input_errors </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_error_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  433</span><span class="keyword">def </span>test_input_errors(Est, params, expected_error_message):</div>
<div class="line"><span class="lineno">  434</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  435</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: [1]}</div>
<div class="line"><span class="lineno">  436</span>    X, y = make_classification(100)</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    sh = Est(base_estimator, param_grid, **params)</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=expected_error_message):</div>
<div class="line"><span class="lineno">  441</span>        sh.fit(X, y)</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  445</span>    <span class="stringliteral">&quot;params, expected_error_message&quot;</span>,</div>
<div class="line"><span class="lineno">  446</span>    [</div>
<div class="line"><span class="lineno">  447</span>        (</div>
<div class="line"><span class="lineno">  448</span>            {<span class="stringliteral">&quot;n_candidates&quot;</span>: <span class="stringliteral">&quot;exhaust&quot;</span>, <span class="stringliteral">&quot;min_resources&quot;</span>: <span class="stringliteral">&quot;exhaust&quot;</span>},</div>
<div class="line"><span class="lineno">  449</span>            <span class="stringliteral">&quot;cannot be both set to &#39;exhaust&#39;&quot;</span>,</div>
<div class="line"><span class="lineno">  450</span>        ),</div>
<div class="line"><span class="lineno">  451</span>        ({<span class="stringliteral">&quot;n_candidates&quot;</span>: <span class="stringliteral">&quot;bad&quot;</span>}, <span class="stringliteral">&quot;either &#39;exhaust&#39; or a positive integer&quot;</span>),</div>
<div class="line"><span class="lineno">  452</span>        ({<span class="stringliteral">&quot;n_candidates&quot;</span>: 0}, <span class="stringliteral">&quot;either &#39;exhaust&#39; or a positive integer&quot;</span>),</div>
<div class="line"><span class="lineno">  453</span>    ],</div>
<div class="line"><span class="lineno">  454</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aabac22c3274e1b769651e4ba3c0d5915" name="aabac22c3274e1b769651e4ba3c0d5915"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabac22c3274e1b769651e4ba3c0d5915">&#9670;&#160;</a></span>test_input_errors_randomized()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_input_errors_randomized </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_error_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  455</span><span class="keyword">def </span>test_input_errors_randomized(params, expected_error_message):</div>
<div class="line"><span class="lineno">  456</span>    <span class="comment"># tests specific to HalvingRandomSearchCV</span></div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  459</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: [1]}</div>
<div class="line"><span class="lineno">  460</span>    X, y = make_classification(100)</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    sh = HalvingRandomSearchCV(base_estimator, param_grid, **params)</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=expected_error_message):</div>
<div class="line"><span class="lineno">  465</span>        sh.fit(X, y)</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  469</span>    <span class="stringliteral">&quot;fraction, subsample_test, expected_train_size, expected_test_size&quot;</span>,</div>
<div class="line"><span class="lineno">  470</span>    [</div>
<div class="line"><span class="lineno">  471</span>        (0.5, <span class="keyword">True</span>, 40, 10),</div>
<div class="line"><span class="lineno">  472</span>        (0.5, <span class="keyword">False</span>, 40, 20),</div>
<div class="line"><span class="lineno">  473</span>        (0.2, <span class="keyword">True</span>, 16, 4),</div>
<div class="line"><span class="lineno">  474</span>        (0.2, <span class="keyword">False</span>, 16, 20),</div>
<div class="line"><span class="lineno">  475</span>    ],</div>
<div class="line"><span class="lineno">  476</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a49504835917a7481aa10d46c21704159" name="a49504835917a7481aa10d46c21704159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49504835917a7481aa10d46c21704159">&#9670;&#160;</a></span>test_min_max_resources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_min_max_resources </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_possible_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_resources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  230</span>):</div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># Test the min_resources and max_resources parameters, and how they affect</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="comment"># the number of resources used at each iteration</span></div>
<div class="line"><span class="lineno">  233</span>    n_samples = 1000</div>
<div class="line"><span class="lineno">  234</span>    X, y = make_classification(n_samples=n_samples, random_state=0)</div>
<div class="line"><span class="lineno">  235</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: [1, 2], <span class="stringliteral">&quot;b&quot;</span>: [1, 2, 3]}</div>
<div class="line"><span class="lineno">  236</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    sh = Est(</div>
<div class="line"><span class="lineno">  239</span>        base_estimator,</div>
<div class="line"><span class="lineno">  240</span>        param_grid,</div>
<div class="line"><span class="lineno">  241</span>        factor=3,</div>
<div class="line"><span class="lineno">  242</span>        min_resources=min_resources,</div>
<div class="line"><span class="lineno">  243</span>        max_resources=max_resources,</div>
<div class="line"><span class="lineno">  244</span>    )</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">if</span> Est <span class="keywordflow">is</span> HalvingRandomSearchCV:</div>
<div class="line"><span class="lineno">  246</span>        sh.set_params(n_candidates=6)  <span class="comment"># same number as with the grid</span></div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    sh.fit(X, y)</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    expected_n_required_iterations = 2  <span class="comment"># given 6 combinations and factor = 3</span></div>
<div class="line"><span class="lineno">  251</span>    <span class="keyword">assert</span> sh.n_iterations_ == expected_n_iterations</div>
<div class="line"><span class="lineno">  252</span>    <span class="keyword">assert</span> sh.n_required_iterations_ == expected_n_required_iterations</div>
<div class="line"><span class="lineno">  253</span>    <span class="keyword">assert</span> sh.n_possible_iterations_ == expected_n_possible_iterations</div>
<div class="line"><span class="lineno">  254</span>    <span class="keyword">assert</span> sh.n_resources_ == expected_n_resources</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">if</span> min_resources == <span class="stringliteral">&quot;exhaust&quot;</span>:</div>
<div class="line"><span class="lineno">  256</span>        <span class="keyword">assert</span> sh.n_possible_iterations_ == sh.n_iterations_ == len(sh.n_resources_)</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Est&quot;, (HalvingRandomSearchCV, HalvingGridSearchCV)</span>)</div>
<div class="line"><span class="lineno">  260</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  261</span>    <span class="stringliteral">&quot;max_resources, n_iterations, n_possible_iterations&quot;</span>,</div>
<div class="line"><span class="lineno">  262</span>    [</div>
<div class="line"><span class="lineno">  263</span>        (<span class="stringliteral">&quot;auto&quot;</span>, 5, 9),  <span class="comment"># all resources are used</span></div>
<div class="line"><span class="lineno">  264</span>        (1024, 5, 9),</div>
<div class="line"><span class="lineno">  265</span>        (700, 5, 8),</div>
<div class="line"><span class="lineno">  266</span>        (512, 5, 8),</div>
<div class="line"><span class="lineno">  267</span>        (511, 5, 7),</div>
<div class="line"><span class="lineno">  268</span>        (32, 4, 4),</div>
<div class="line"><span class="lineno">  269</span>        (31, 3, 3),</div>
<div class="line"><span class="lineno">  270</span>        (16, 3, 3),</div>
<div class="line"><span class="lineno">  271</span>        (4, 1, 1),  <span class="comment"># max_resources == min_resources, only one iteration is</span></div>
<div class="line"><span class="lineno">  272</span>        <span class="comment"># possible</span></div>
<div class="line"><span class="lineno">  273</span>    ],</div>
<div class="line"><span class="lineno">  274</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af1571a1e26b6c38b1337ceceec446f5a" name="af1571a1e26b6c38b1337ceceec446f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1571a1e26b6c38b1337ceceec446f5a">&#9670;&#160;</a></span>test_min_resources_null()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_min_resources_null </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>SearchCV</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that we raise an error if the minimum resources is set to 0.</pre> <div class="fragment"><div class="line"><span class="lineno">  759</span><span class="keyword">def </span>test_min_resources_null(SearchCV):</div>
<div class="line"><span class="lineno">  760</span>    <span class="stringliteral">&quot;&quot;&quot;Check that we raise an error if the minimum resources is set to 0.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  761</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  762</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: [1]}</div>
<div class="line"><span class="lineno">  763</span>    X = np.empty(0).reshape(0, 3)</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>    search = SearchCV(base_estimator, param_grid, min_resources=<span class="stringliteral">&quot;smallest&quot;</span>)</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    err_msg = <span class="stringliteral">&quot;min_resources_=0: you might have passed an empty dataset X.&quot;</span></div>
<div class="line"><span class="lineno">  768</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=err_msg):</div>
<div class="line"><span class="lineno">  769</span>        search.fit(X, [])</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span><span class="preprocessor">@pytest.mark.parametrize(&quot;SearchCV&quot;, [HalvingGridSearchCV, HalvingRandomSearchCV])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c4edd67cbfd263d439b39d716ba9cfc" name="a5c4edd67cbfd263d439b39d716ba9cfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c4edd67cbfd263d439b39d716ba9cfc">&#9670;&#160;</a></span>test_n_iterations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_n_iterations </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_possible_iterations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  275</span><span class="keyword">def </span>test_n_iterations(Est, max_resources, n_iterations, n_possible_iterations):</div>
<div class="line"><span class="lineno">  276</span>    <span class="comment"># test the number of actual iterations that were run depending on</span></div>
<div class="line"><span class="lineno">  277</span>    <span class="comment"># max_resources</span></div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>    n_samples = 1024</div>
<div class="line"><span class="lineno">  280</span>    X, y = make_classification(n_samples=n_samples, random_state=1)</div>
<div class="line"><span class="lineno">  281</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: [1, 2], <span class="stringliteral">&quot;b&quot;</span>: list(range(10))}</div>
<div class="line"><span class="lineno">  282</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  283</span>    factor = 2</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    sh = Est(</div>
<div class="line"><span class="lineno">  286</span>        base_estimator,</div>
<div class="line"><span class="lineno">  287</span>        param_grid,</div>
<div class="line"><span class="lineno">  288</span>        cv=2,</div>
<div class="line"><span class="lineno">  289</span>        factor=factor,</div>
<div class="line"><span class="lineno">  290</span>        max_resources=max_resources,</div>
<div class="line"><span class="lineno">  291</span>        min_resources=4,</div>
<div class="line"><span class="lineno">  292</span>    )</div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">if</span> Est <span class="keywordflow">is</span> HalvingRandomSearchCV:</div>
<div class="line"><span class="lineno">  294</span>        sh.set_params(n_candidates=20)  <span class="comment"># same as for HalvingGridSearchCV</span></div>
<div class="line"><span class="lineno">  295</span>    sh.fit(X, y)</div>
<div class="line"><span class="lineno">  296</span>    <span class="keyword">assert</span> sh.n_required_iterations_ == 5</div>
<div class="line"><span class="lineno">  297</span>    <span class="keyword">assert</span> sh.n_iterations_ == n_iterations</div>
<div class="line"><span class="lineno">  298</span>    <span class="keyword">assert</span> sh.n_possible_iterations_ == n_possible_iterations</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Est&quot;, (HalvingRandomSearchCV, HalvingGridSearchCV)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a07dc982f965d66df67f03c321c2db2cf" name="a07dc982f965d66df67f03c321c2db2cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07dc982f965d66df67f03c321c2db2cf">&#9670;&#160;</a></span>test_nan_handling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_nan_handling </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>HalvingSearch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fail_at</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the selection of the best scores in presence of failure represented by
NaN values.</pre> <div class="fragment"><div class="line"><span class="lineno">   91</span><span class="keyword">def </span>test_nan_handling(HalvingSearch, fail_at):</div>
<div class="line"><span class="lineno">   92</span>    <span class="stringliteral">&quot;&quot;&quot;Check the selection of the best scores in presence of failure represented by</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    NaN values.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   94</span>    n_samples = 1_000</div>
<div class="line"><span class="lineno">   95</span>    X, y = make_classification(n_samples=n_samples, random_state=0)</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    search = HalvingSearch(</div>
<div class="line"><span class="lineno">   98</span>        SometimesFailClassifier(),</div>
<div class="line"><span class="lineno">   99</span>        {f<span class="stringliteral">&quot;fail_{fail_at}&quot;</span>: [<span class="keyword">False</span>, <span class="keyword">True</span>], <span class="stringliteral">&quot;a&quot;</span>: range(3)},</div>
<div class="line"><span class="lineno">  100</span>        resource=<span class="stringliteral">&quot;n_estimators&quot;</span>,</div>
<div class="line"><span class="lineno">  101</span>        max_resources=6,</div>
<div class="line"><span class="lineno">  102</span>        min_resources=1,</div>
<div class="line"><span class="lineno">  103</span>        factor=2,</div>
<div class="line"><span class="lineno">  104</span>    )</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    search.fit(X, y)</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="comment"># estimators that failed during fit/predict should always rank lower</span></div>
<div class="line"><span class="lineno">  109</span>    <span class="comment"># than ones where the fit/predict succeeded</span></div>
<div class="line"><span class="lineno">  110</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> search.best_params_[f<span class="stringliteral">&quot;fail_{fail_at}&quot;</span>]</div>
<div class="line"><span class="lineno">  111</span>    scores = search.cv_results_[<span class="stringliteral">&quot;mean_test_score&quot;</span>]</div>
<div class="line"><span class="lineno">  112</span>    ranks = search.cv_results_[<span class="stringliteral">&quot;rank_test_score&quot;</span>]</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>    <span class="comment"># some scores should be NaN</span></div>
<div class="line"><span class="lineno">  115</span>    <span class="keyword">assert</span> np.isnan(scores).any()</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>    unique_nan_ranks = np.unique(ranks[np.isnan(scores)])</div>
<div class="line"><span class="lineno">  118</span>    <span class="comment"># all NaN scores should have the same rank</span></div>
<div class="line"><span class="lineno">  119</span>    <span class="keyword">assert</span> unique_nan_ranks.shape[0] == 1</div>
<div class="line"><span class="lineno">  120</span>    <span class="comment"># NaNs should have the lowest rank</span></div>
<div class="line"><span class="lineno">  121</span>    <span class="keyword">assert</span> (unique_nan_ranks[0] &gt;= ranks).all()</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Est&quot;, (HalvingGridSearchCV, HalvingRandomSearchCV)</span>)</div>
<div class="line"><span class="lineno">  125</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  126</span>    <span class="stringliteral">&quot;aggressive_elimination,&quot;</span></div>
<div class="line"><span class="lineno">  127</span>    <span class="stringliteral">&quot;max_resources,&quot;</span></div>
<div class="line"><span class="lineno">  128</span>    <span class="stringliteral">&quot;expected_n_iterations,&quot;</span></div>
<div class="line"><span class="lineno">  129</span>    <span class="stringliteral">&quot;expected_n_required_iterations,&quot;</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="stringliteral">&quot;expected_n_possible_iterations,&quot;</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="stringliteral">&quot;expected_n_remaining_candidates,&quot;</span></div>
<div class="line"><span class="lineno">  132</span>    <span class="stringliteral">&quot;expected_n_candidates,&quot;</span></div>
<div class="line"><span class="lineno">  133</span>    <span class="stringliteral">&quot;expected_n_resources,&quot;</span>,</div>
<div class="line"><span class="lineno">  134</span>    [</div>
<div class="line"><span class="lineno">  135</span>        <span class="comment"># notice how it loops at the beginning</span></div>
<div class="line"><span class="lineno">  136</span>        <span class="comment"># also, the number of candidates evaluated at the last iteration is</span></div>
<div class="line"><span class="lineno">  137</span>        <span class="comment"># &lt;= factor</span></div>
<div class="line"><span class="lineno">  138</span>        (<span class="keyword">True</span>, <span class="stringliteral">&quot;limited&quot;</span>, 4, 4, 3, 1, [60, 20, 7, 3], [20, 20, 60, 180]),</div>
<div class="line"><span class="lineno">  139</span>        <span class="comment"># no aggressive elimination: we end up with less iterations, and</span></div>
<div class="line"><span class="lineno">  140</span>        <span class="comment"># the number of candidates at the last iter is &gt; factor, which isn&#39;t</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="comment"># ideal</span></div>
<div class="line"><span class="lineno">  142</span>        (<span class="keyword">False</span>, <span class="stringliteral">&quot;limited&quot;</span>, 3, 4, 3, 3, [60, 20, 7], [20, 60, 180]),</div>
<div class="line"><span class="lineno">  143</span>        <span class="comment">#  # When the amount of resource isn&#39;t limited, aggressive_elimination</span></div>
<div class="line"><span class="lineno">  144</span>        <span class="comment">#  # has no effect. Here the default min_resources=&#39;exhaust&#39; will take</span></div>
<div class="line"><span class="lineno">  145</span>        <span class="comment">#  # over.</span></div>
<div class="line"><span class="lineno">  146</span>        (<span class="keyword">True</span>, <span class="stringliteral">&quot;unlimited&quot;</span>, 4, 4, 4, 1, [60, 20, 7, 3], [37, 111, 333, 999]),</div>
<div class="line"><span class="lineno">  147</span>        (<span class="keyword">False</span>, <span class="stringliteral">&quot;unlimited&quot;</span>, 4, 4, 4, 1, [60, 20, 7, 3], [37, 111, 333, 999]),</div>
<div class="line"><span class="lineno">  148</span>    ],</div>
<div class="line"><span class="lineno">  149</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62fb5fa91e4e8409de98c78c8dc2718e" name="a62fb5fa91e4e8409de98c78c8dc2718e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62fb5fa91e4e8409de98c78c8dc2718e">&#9670;&#160;</a></span>test_random_search()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_random_search </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_candidates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_candidates</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  351</span><span class="keyword">def </span>test_random_search(max_resources, n_candidates, expected_n_candidates):</div>
<div class="line"><span class="lineno">  352</span>    <span class="comment"># Test random search and make sure the number of generated candidates is</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="comment"># as expected</span></div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>    n_samples = 1024</div>
<div class="line"><span class="lineno">  356</span>    X, y = make_classification(n_samples=n_samples, random_state=0)</div>
<div class="line"><span class="lineno">  357</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: norm, <span class="stringliteral">&quot;b&quot;</span>: norm}</div>
<div class="line"><span class="lineno">  358</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  359</span>    sh = HalvingRandomSearchCV(</div>
<div class="line"><span class="lineno">  360</span>        base_estimator,</div>
<div class="line"><span class="lineno">  361</span>        param_grid,</div>
<div class="line"><span class="lineno">  362</span>        n_candidates=n_candidates,</div>
<div class="line"><span class="lineno">  363</span>        cv=2,</div>
<div class="line"><span class="lineno">  364</span>        max_resources=max_resources,</div>
<div class="line"><span class="lineno">  365</span>        factor=2,</div>
<div class="line"><span class="lineno">  366</span>        min_resources=4,</div>
<div class="line"><span class="lineno">  367</span>    )</div>
<div class="line"><span class="lineno">  368</span>    sh.fit(X, y)</div>
<div class="line"><span class="lineno">  369</span>    <span class="keyword">assert</span> sh.n_candidates_[0] == expected_n_candidates</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> n_candidates == <span class="stringliteral">&quot;exhaust&quot;</span>:</div>
<div class="line"><span class="lineno">  371</span>        <span class="comment"># Make sure &#39;exhaust&#39; makes the last iteration use as much resources as</span></div>
<div class="line"><span class="lineno">  372</span>        <span class="comment"># we can</span></div>
<div class="line"><span class="lineno">  373</span>        <span class="keyword">assert</span> sh.n_resources_[-1] == max_resources</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  377</span>    <span class="stringliteral">&quot;param_distributions, expected_n_candidates&quot;</span>,</div>
<div class="line"><span class="lineno">  378</span>    [</div>
<div class="line"><span class="lineno">  379</span>        ({<span class="stringliteral">&quot;a&quot;</span>: [1, 2]}, 2),  <span class="comment"># all lists, sample less than n_candidates</span></div>
<div class="line"><span class="lineno">  380</span>        ({<span class="stringliteral">&quot;a&quot;</span>: randint(1, 3)}, 10),  <span class="comment"># not all list, respect n_candidates</span></div>
<div class="line"><span class="lineno">  381</span>    ],</div>
<div class="line"><span class="lineno">  382</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf1d9e3b474de259fd41c6589839138e" name="aaf1d9e3b474de259fd41c6589839138e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf1d9e3b474de259fd41c6589839138e">&#9670;&#160;</a></span>test_random_search_discrete_distributions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_random_search_discrete_distributions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>param_distributions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_n_candidates</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  385</span>):</div>
<div class="line"><span class="lineno">  386</span>    <span class="comment"># Make sure random search samples the appropriate number of candidates when</span></div>
<div class="line"><span class="lineno">  387</span>    <span class="comment"># we ask for more than what&#39;s possible. How many parameters are sampled</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="comment"># depends whether the distributions are &#39;all lists&#39; or not (see</span></div>
<div class="line"><span class="lineno">  389</span>    <span class="comment"># ParameterSampler for details). This is somewhat redundant with the checks</span></div>
<div class="line"><span class="lineno">  390</span>    <span class="comment"># in ParameterSampler but interaction bugs were discovered during</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="comment"># development of SH</span></div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>    n_samples = 1024</div>
<div class="line"><span class="lineno">  394</span>    X, y = make_classification(n_samples=n_samples, random_state=0)</div>
<div class="line"><span class="lineno">  395</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  396</span>    sh = HalvingRandomSearchCV(base_estimator, param_distributions, n_candidates=10)</div>
<div class="line"><span class="lineno">  397</span>    sh.fit(X, y)</div>
<div class="line"><span class="lineno">  398</span>    <span class="keyword">assert</span> sh.n_candidates_[0] == expected_n_candidates</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Est&quot;, (HalvingGridSearchCV, HalvingRandomSearchCV)</span>)</div>
<div class="line"><span class="lineno">  402</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  403</span>    <span class="stringliteral">&quot;params, expected_error_message&quot;</span>,</div>
<div class="line"><span class="lineno">  404</span>    [</div>
<div class="line"><span class="lineno">  405</span>        ({<span class="stringliteral">&quot;scoring&quot;</span>: {<span class="stringliteral">&quot;accuracy&quot;</span>, <span class="stringliteral">&quot;accuracy&quot;</span>}}, <span class="stringliteral">&quot;Multimetric scoring is not supported&quot;</span>),</div>
<div class="line"><span class="lineno">  406</span>        (</div>
<div class="line"><span class="lineno">  407</span>            {<span class="stringliteral">&quot;resource&quot;</span>: <span class="stringliteral">&quot;not_a_parameter&quot;</span>},</div>
<div class="line"><span class="lineno">  408</span>            <span class="stringliteral">&quot;Cannot use resource=not_a_parameter which is not supported&quot;</span>,</div>
<div class="line"><span class="lineno">  409</span>        ),</div>
<div class="line"><span class="lineno">  410</span>        (</div>
<div class="line"><span class="lineno">  411</span>            {<span class="stringliteral">&quot;resource&quot;</span>: <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;max_resources&quot;</span>: 100},</div>
<div class="line"><span class="lineno">  412</span>            <span class="stringliteral">&quot;Cannot use parameter a as the resource since it is part of&quot;</span>,</div>
<div class="line"><span class="lineno">  413</span>        ),</div>
<div class="line"><span class="lineno">  414</span>        ({<span class="stringliteral">&quot;max_resources&quot;</span>: <span class="stringliteral">&quot;not_auto&quot;</span>}, <span class="stringliteral">&quot;max_resources must be either&quot;</span>),</div>
<div class="line"><span class="lineno">  415</span>        ({<span class="stringliteral">&quot;max_resources&quot;</span>: 100.5}, <span class="stringliteral">&quot;max_resources must be either&quot;</span>),</div>
<div class="line"><span class="lineno">  416</span>        ({<span class="stringliteral">&quot;max_resources&quot;</span>: -10}, <span class="stringliteral">&quot;max_resources must be either&quot;</span>),</div>
<div class="line"><span class="lineno">  417</span>        ({<span class="stringliteral">&quot;min_resources&quot;</span>: <span class="stringliteral">&quot;bad str&quot;</span>}, <span class="stringliteral">&quot;min_resources must be either&quot;</span>),</div>
<div class="line"><span class="lineno">  418</span>        ({<span class="stringliteral">&quot;min_resources&quot;</span>: 0.5}, <span class="stringliteral">&quot;min_resources must be either&quot;</span>),</div>
<div class="line"><span class="lineno">  419</span>        ({<span class="stringliteral">&quot;min_resources&quot;</span>: -10}, <span class="stringliteral">&quot;min_resources must be either&quot;</span>),</div>
<div class="line"><span class="lineno">  420</span>        (</div>
<div class="line"><span class="lineno">  421</span>            {<span class="stringliteral">&quot;max_resources&quot;</span>: <span class="stringliteral">&quot;auto&quot;</span>, <span class="stringliteral">&quot;resource&quot;</span>: <span class="stringliteral">&quot;b&quot;</span>},</div>
<div class="line"><span class="lineno">  422</span>            <span class="stringliteral">&quot;resource can only be &#39;n_samples&#39; when max_resources=&#39;auto&#39;&quot;</span>,</div>
<div class="line"><span class="lineno">  423</span>        ),</div>
<div class="line"><span class="lineno">  424</span>        (</div>
<div class="line"><span class="lineno">  425</span>            {<span class="stringliteral">&quot;min_resources&quot;</span>: 15, <span class="stringliteral">&quot;max_resources&quot;</span>: 14},</div>
<div class="line"><span class="lineno">  426</span>            <span class="stringliteral">&quot;min_resources_=15 is greater than max_resources_=14&quot;</span>,</div>
<div class="line"><span class="lineno">  427</span>        ),</div>
<div class="line"><span class="lineno">  428</span>        ({<span class="stringliteral">&quot;cv&quot;</span>: KFold(shuffle=<span class="keyword">True</span>)}, <span class="stringliteral">&quot;must yield consistent folds&quot;</span>),</div>
<div class="line"><span class="lineno">  429</span>        ({<span class="stringliteral">&quot;cv&quot;</span>: ShuffleSplit()}, <span class="stringliteral">&quot;must yield consistent folds&quot;</span>),</div>
<div class="line"><span class="lineno">  430</span>        ({<span class="stringliteral">&quot;refit&quot;</span>: <span class="stringliteral">&quot;whatever&quot;</span>}, <span class="stringliteral">&quot;refit is expected to be a boolean&quot;</span>),</div>
<div class="line"><span class="lineno">  431</span>    ],</div>
<div class="line"><span class="lineno">  432</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaca315ad61450e1525a00949244b6b7a" name="aaca315ad61450e1525a00949244b6b7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaca315ad61450e1525a00949244b6b7a">&#9670;&#160;</a></span>test_resource_parameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_resource_parameter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Est</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  302</span><span class="keyword">def </span>test_resource_parameter(Est):</div>
<div class="line"><span class="lineno">  303</span>    <span class="comment"># Test the resource parameter</span></div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>    n_samples = 1000</div>
<div class="line"><span class="lineno">  306</span>    X, y = make_classification(n_samples=n_samples, random_state=0)</div>
<div class="line"><span class="lineno">  307</span>    param_grid = {<span class="stringliteral">&quot;a&quot;</span>: [1, 2], <span class="stringliteral">&quot;b&quot;</span>: list(range(10))}</div>
<div class="line"><span class="lineno">  308</span>    base_estimator = FastClassifier()</div>
<div class="line"><span class="lineno">  309</span>    sh = Est(base_estimator, param_grid, cv=2, resource=<span class="stringliteral">&quot;c&quot;</span>, max_resources=10, factor=3)</div>
<div class="line"><span class="lineno">  310</span>    sh.fit(X, y)</div>
<div class="line"><span class="lineno">  311</span>    <span class="keyword">assert</span> set(sh.n_resources_) == set([1, 3, 9])</div>
<div class="line"><span class="lineno">  312</span>    <span class="keywordflow">for</span> r_i, params, param_c <span class="keywordflow">in</span> zip(</div>
<div class="line"><span class="lineno">  313</span>        sh.cv_results_[<span class="stringliteral">&quot;n_resources&quot;</span>],</div>
<div class="line"><span class="lineno">  314</span>        sh.cv_results_[<span class="stringliteral">&quot;params&quot;</span>],</div>
<div class="line"><span class="lineno">  315</span>        sh.cv_results_[<span class="stringliteral">&quot;param_c&quot;</span>],</div>
<div class="line"><span class="lineno">  316</span>    ):</div>
<div class="line"><span class="lineno">  317</span>        <span class="keyword">assert</span> r_i == params[<span class="stringliteral">&quot;c&quot;</span>] == param_c</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>    <span class="keyword">with</span> pytest.raises(</div>
<div class="line"><span class="lineno">  320</span>        ValueError, match=<span class="stringliteral">&quot;Cannot use resource=1234 which is not supported &quot;</span></div>
<div class="line"><span class="lineno">  321</span>    ):</div>
<div class="line"><span class="lineno">  322</span>        sh = HalvingGridSearchCV(</div>
<div class="line"><span class="lineno">  323</span>            base_estimator, param_grid, cv=2, resource=<span class="stringliteral">&quot;1234&quot;</span>, max_resources=10</div>
<div class="line"><span class="lineno">  324</span>        )</div>
<div class="line"><span class="lineno">  325</span>        sh.fit(X, y)</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    <span class="keyword">with</span> pytest.raises(</div>
<div class="line"><span class="lineno">  328</span>        ValueError,</div>
<div class="line"><span class="lineno">  329</span>        match=(</div>
<div class="line"><span class="lineno">  330</span>            <span class="stringliteral">&quot;Cannot use parameter c as the resource since it is part &quot;</span></div>
<div class="line"><span class="lineno">  331</span>            <span class="stringliteral">&quot;of the searched parameters.&quot;</span></div>
<div class="line"><span class="lineno">  332</span>        ),</div>
<div class="line"><span class="lineno">  333</span>    ):</div>
<div class="line"><span class="lineno">  334</span>        param_grid = {<span class="stringliteral">&quot;a&quot;</span>: [1, 2], <span class="stringliteral">&quot;b&quot;</span>: [1, 2], <span class="stringliteral">&quot;c&quot;</span>: [1, 3]}</div>
<div class="line"><span class="lineno">  335</span>        sh = HalvingGridSearchCV(</div>
<div class="line"><span class="lineno">  336</span>            base_estimator, param_grid, cv=2, resource=<span class="stringliteral">&quot;c&quot;</span>, max_resources=10</div>
<div class="line"><span class="lineno">  337</span>        )</div>
<div class="line"><span class="lineno">  338</span>        sh.fit(X, y)</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  342</span>    <span class="stringliteral">&quot;max_resources, n_candidates, expected_n_candidates&quot;</span>,</div>
<div class="line"><span class="lineno">  343</span>    [</div>
<div class="line"><span class="lineno">  344</span>        (512, <span class="stringliteral">&quot;exhaust&quot;</span>, 128),  <span class="comment"># generate exactly as much as needed</span></div>
<div class="line"><span class="lineno">  345</span>        (32, <span class="stringliteral">&quot;exhaust&quot;</span>, 8),</div>
<div class="line"><span class="lineno">  346</span>        (32, 8, 8),</div>
<div class="line"><span class="lineno">  347</span>        (32, 7, 7),  <span class="comment"># ask for less than what we could</span></div>
<div class="line"><span class="lineno">  348</span>        (32, 9, 9),  <span class="comment"># ask for more than &#39;reasonable&#39;</span></div>
<div class="line"><span class="lineno">  349</span>    ],</div>
<div class="line"><span class="lineno">  350</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af901b1c3c1d03d5afb29e4a268fbc9b0" name="af901b1c3c1d03d5afb29e4a268fbc9b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af901b1c3c1d03d5afb29e4a268fbc9b0">&#9670;&#160;</a></span>test_select_best_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_select_best_index </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>SearchCV</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the selection strategy of the halving search.</pre> <div class="fragment"><div class="line"><span class="lineno">  773</span><span class="keyword">def </span>test_select_best_index(SearchCV):</div>
<div class="line"><span class="lineno">  774</span>    <span class="stringliteral">&quot;&quot;&quot;Check the selection strategy of the halving search.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  775</span>    results = {  <span class="comment"># this isn&#39;t a &#39;real world&#39; result dict</span></div>
<div class="line"><span class="lineno">  776</span>        <span class="stringliteral">&quot;iter&quot;</span>: np.array([0, 0, 0, 0, 1, 1, 2, 2, 2]),</div>
<div class="line"><span class="lineno">  777</span>        <span class="stringliteral">&quot;mean_test_score&quot;</span>: np.array([4, 3, 5, 1, 11, 10, 5, 6, 9]),</div>
<div class="line"><span class="lineno">  778</span>        <span class="stringliteral">&quot;params&quot;</span>: np.array([<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>, <span class="stringliteral">&quot;f&quot;</span>, <span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>]),</div>
<div class="line"><span class="lineno">  779</span>    }</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>    <span class="comment"># we expect the index of &#39;i&#39;</span></div>
<div class="line"><span class="lineno">  782</span>    best_index = SearchCV._select_best_index(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, results)</div>
<div class="line"><span class="lineno">  783</span>    <span class="keyword">assert</span> best_index == 8</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6aa51ae8462fc9763182c86ab948db80" name="a6aa51ae8462fc9763182c86ab948db80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aa51ae8462fc9763182c86ab948db80">&#9670;&#160;</a></span>test_subsample_splitter_determinism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_subsample_splitter_determinism </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>subsample_test</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  502</span><span class="keyword">def </span>test_subsample_splitter_determinism(subsample_test):</div>
<div class="line"><span class="lineno">  503</span>    <span class="comment"># Make sure _SubsampleMetaSplitter is consistent across calls to split():</span></div>
<div class="line"><span class="lineno">  504</span>    <span class="comment"># - we&#39;re OK having training sets differ (they&#39;re always sampled with a</span></div>
<div class="line"><span class="lineno">  505</span>    <span class="comment">#   different fraction anyway)</span></div>
<div class="line"><span class="lineno">  506</span>    <span class="comment"># - when we don&#39;t subsample the test set, we want it to be always the same.</span></div>
<div class="line"><span class="lineno">  507</span>    <span class="comment">#   This check is the most important. This is ensured by the determinism</span></div>
<div class="line"><span class="lineno">  508</span>    <span class="comment">#   of the base_cv.</span></div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="comment"># Note: we could force both train and test splits to be always the same if</span></div>
<div class="line"><span class="lineno">  511</span>    <span class="comment"># we drew an int seed in _SubsampleMetaSplitter.__init__</span></div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>    n_samples = 100</div>
<div class="line"><span class="lineno">  514</span>    X, y = make_classification(n_samples)</div>
<div class="line"><span class="lineno">  515</span>    cv = _SubsampleMetaSplitter(</div>
<div class="line"><span class="lineno">  516</span>        base_cv=KFold(5), fraction=0.5, subsample_test=subsample_test, random_state=<span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  517</span>    )</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    folds_a = list(cv.split(X, y, groups=<span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  520</span>    folds_b = list(cv.split(X, y, groups=<span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">for</span> (train_a, test_a), (train_b, test_b) <span class="keywordflow">in</span> zip(folds_a, folds_b):</div>
<div class="line"><span class="lineno">  523</span>        <span class="keyword">assert</span> <span class="keywordflow">not</span> np.all(train_a == train_b)</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>        <span class="keywordflow">if</span> subsample_test:</div>
<div class="line"><span class="lineno">  526</span>            <span class="keyword">assert</span> <span class="keywordflow">not</span> np.all(test_a == test_b)</div>
<div class="line"><span class="lineno">  527</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  528</span>            <span class="keyword">assert</span> np.all(test_a == test_b)</div>
<div class="line"><span class="lineno">  529</span>            <span class="keyword">assert</span> np.all(X[test_a] == X[test_b])</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  533</span>    <span class="stringliteral">&quot;k, itr, expected&quot;</span>,</div>
<div class="line"><span class="lineno">  534</span>    [</div>
<div class="line"><span class="lineno">  535</span>        (1, 0, [<span class="stringliteral">&quot;c&quot;</span>]),</div>
<div class="line"><span class="lineno">  536</span>        (2, 0, [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]),</div>
<div class="line"><span class="lineno">  537</span>        (4, 0, [<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]),</div>
<div class="line"><span class="lineno">  538</span>        (10, 0, [<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>]),</div>
<div class="line"><span class="lineno">  539</span>        (1, 1, [<span class="stringliteral">&quot;e&quot;</span>]),</div>
<div class="line"><span class="lineno">  540</span>        (2, 1, [<span class="stringliteral">&quot;f&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>]),</div>
<div class="line"><span class="lineno">  541</span>        (10, 1, [<span class="stringliteral">&quot;f&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>]),</div>
<div class="line"><span class="lineno">  542</span>        (1, 2, [<span class="stringliteral">&quot;i&quot;</span>]),</div>
<div class="line"><span class="lineno">  543</span>        (10, 2, [<span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>]),</div>
<div class="line"><span class="lineno">  544</span>    ],</div>
<div class="line"><span class="lineno">  545</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af675696570a8b0d6c2fe4ff7915ffd6c" name="af675696570a8b0d6c2fe4ff7915ffd6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af675696570a8b0d6c2fe4ff7915ffd6c">&#9670;&#160;</a></span>test_subsample_splitter_shapes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_subsample_splitter_shapes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>subsample_test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_train_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_test_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  479</span>):</div>
<div class="line"><span class="lineno">  480</span>    <span class="comment"># Make sure splits returned by SubsampleMetaSplitter are of appropriate</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="comment"># size</span></div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    n_samples = 100</div>
<div class="line"><span class="lineno">  484</span>    X, y = make_classification(n_samples)</div>
<div class="line"><span class="lineno">  485</span>    cv = _SubsampleMetaSplitter(</div>
<div class="line"><span class="lineno">  486</span>        base_cv=KFold(5),</div>
<div class="line"><span class="lineno">  487</span>        fraction=fraction,</div>
<div class="line"><span class="lineno">  488</span>        subsample_test=subsample_test,</div>
<div class="line"><span class="lineno">  489</span>        random_state=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  490</span>    )</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">for</span> train, test <span class="keywordflow">in</span> cv.split(X, y):</div>
<div class="line"><span class="lineno">  493</span>        <span class="keyword">assert</span> train.shape[0] == expected_train_size</div>
<div class="line"><span class="lineno">  494</span>        <span class="keyword">assert</span> test.shape[0] == expected_test_size</div>
<div class="line"><span class="lineno">  495</span>        <span class="keywordflow">if</span> subsample_test:</div>
<div class="line"><span class="lineno">  496</span>            <span class="keyword">assert</span> train.shape[0] + test.shape[0] == int(n_samples * fraction)</div>
<div class="line"><span class="lineno">  497</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  498</span>            <span class="keyword">assert</span> test.shape[0] == n_samples // cv.base_cv.get_n_splits()</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span><span class="preprocessor">@pytest.mark.parametrize(&quot;subsample_test&quot;, (True, False)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a37f18af8ef20beb193314b1aba0dd268" name="a37f18af8ef20beb193314b1aba0dd268"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37f18af8ef20beb193314b1aba0dd268">&#9670;&#160;</a></span>test_top_k()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.model_selection.tests.test_successive_halving.test_top_k </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>itr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  546</span><span class="keyword">def </span>test_top_k(k, itr, expected):</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    results = {  <span class="comment"># this isn&#39;t a &#39;real world&#39; result dict</span></div>
<div class="line"><span class="lineno">  549</span>        <span class="stringliteral">&quot;iter&quot;</span>: [0, 0, 0, 0, 1, 1, 2, 2, 2],</div>
<div class="line"><span class="lineno">  550</span>        <span class="stringliteral">&quot;mean_test_score&quot;</span>: [4, 3, 5, 1, 11, 10, 5, 6, 9],</div>
<div class="line"><span class="lineno">  551</span>        <span class="stringliteral">&quot;params&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>, <span class="stringliteral">&quot;f&quot;</span>, <span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>],</div>
<div class="line"><span class="lineno">  552</span>    }</div>
<div class="line"><span class="lineno">  553</span>    got = _top_k(results, k=k, itr=itr)</div>
<div class="line"><span class="lineno">  554</span>    <span class="keyword">assert</span> np.all(got == expected)</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span><span class="preprocessor">@pytest.mark.parametrize(&quot;Est&quot;, (HalvingRandomSearchCV, HalvingGridSearchCV)</span>)</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
