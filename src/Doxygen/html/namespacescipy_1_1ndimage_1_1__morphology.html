<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.ndimage._morphology Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1ndimage.html">ndimage</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html">_morphology</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.ndimage._morphology Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2851a9e4d44123be02f0ea9d3c67e7ce" id="r_a2851a9e4d44123be02f0ea9d3c67e7ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a2851a9e4d44123be02f0ea9d3c67e7ce">_center_is_true</a> (structure, origin)</td></tr>
<tr class="separator:a2851a9e4d44123be02f0ea9d3c67e7ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dd391da5464b292a7b7880e7df2ec8c" id="r_a9dd391da5464b292a7b7880e7df2ec8c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a9dd391da5464b292a7b7880e7df2ec8c">iterate_structure</a> (structure, iterations, origin=None)</td></tr>
<tr class="separator:a9dd391da5464b292a7b7880e7df2ec8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4cec95e8f208f65adb2a23ae10daccb" id="r_ac4cec95e8f208f65adb2a23ae10daccb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#ac4cec95e8f208f65adb2a23ae10daccb">generate_binary_structure</a> (rank, connectivity)</td></tr>
<tr class="separator:ac4cec95e8f208f65adb2a23ae10daccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f859d5303e7c6616469d6dfa3c3f3c6" id="r_a3f859d5303e7c6616469d6dfa3c3f3c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a3f859d5303e7c6616469d6dfa3c3f3c6">_binary_erosion</a> (input, structure, iterations, mask, output, border_value, origin, invert, brute_force)</td></tr>
<tr class="separator:a3f859d5303e7c6616469d6dfa3c3f3c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf4c69d471160e40476e1ec891e5e17b" id="r_aaf4c69d471160e40476e1ec891e5e17b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#aaf4c69d471160e40476e1ec891e5e17b">binary_erosion</a> (input, structure=None, iterations=1, mask=None, output=None, border_value=0, origin=0, brute_force=False)</td></tr>
<tr class="separator:aaf4c69d471160e40476e1ec891e5e17b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6f306301c649c5d9e9536bfd2151847" id="r_ad6f306301c649c5d9e9536bfd2151847"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#ad6f306301c649c5d9e9536bfd2151847">binary_dilation</a> (input, structure=None, iterations=1, mask=None, output=None, border_value=0, origin=0, brute_force=False)</td></tr>
<tr class="separator:ad6f306301c649c5d9e9536bfd2151847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf7eda4cc0b9e687f14c5eb1ccaf023" id="r_a3cf7eda4cc0b9e687f14c5eb1ccaf023"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a3cf7eda4cc0b9e687f14c5eb1ccaf023">binary_opening</a> (input, structure=None, iterations=1, output=None, origin=0, mask=None, border_value=0, brute_force=False)</td></tr>
<tr class="separator:a3cf7eda4cc0b9e687f14c5eb1ccaf023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af141f355eae9ec61ee36be125178cbb1" id="r_af141f355eae9ec61ee36be125178cbb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#af141f355eae9ec61ee36be125178cbb1">binary_closing</a> (input, structure=None, iterations=1, output=None, origin=0, mask=None, border_value=0, brute_force=False)</td></tr>
<tr class="separator:af141f355eae9ec61ee36be125178cbb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7bef98325ff647bb1260c97597bf2bd" id="r_aa7bef98325ff647bb1260c97597bf2bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#aa7bef98325ff647bb1260c97597bf2bd">binary_hit_or_miss</a> (input, structure1=None, structure2=None, output=None, origin1=0, origin2=None)</td></tr>
<tr class="separator:aa7bef98325ff647bb1260c97597bf2bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a064495983f3cea84941fba854c6b4212" id="r_a064495983f3cea84941fba854c6b4212"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a064495983f3cea84941fba854c6b4212">binary_propagation</a> (input, structure=None, mask=None, output=None, border_value=0, origin=0)</td></tr>
<tr class="separator:a064495983f3cea84941fba854c6b4212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdcb01b54ec069de14c06f87202f4792" id="r_abdcb01b54ec069de14c06f87202f4792"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#abdcb01b54ec069de14c06f87202f4792">binary_fill_holes</a> (input, structure=None, output=None, origin=0)</td></tr>
<tr class="separator:abdcb01b54ec069de14c06f87202f4792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea52fca905158ab16412ce44ef86515" id="r_adea52fca905158ab16412ce44ef86515"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#adea52fca905158ab16412ce44ef86515">grey_erosion</a> (input, size=None, footprint=None, structure=None, output=None, mode=&quot;reflect&quot;, cval=0.0, origin=0)</td></tr>
<tr class="separator:adea52fca905158ab16412ce44ef86515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f19f05960e0438e963d6cb1bbf53765" id="r_a2f19f05960e0438e963d6cb1bbf53765"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a2f19f05960e0438e963d6cb1bbf53765">grey_dilation</a> (input, size=None, footprint=None, structure=None, output=None, mode=&quot;reflect&quot;, cval=0.0, origin=0)</td></tr>
<tr class="separator:a2f19f05960e0438e963d6cb1bbf53765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d6712a86de6eb485961fc8726fcc52" id="r_a22d6712a86de6eb485961fc8726fcc52"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a22d6712a86de6eb485961fc8726fcc52">grey_opening</a> (input, size=None, footprint=None, structure=None, output=None, mode=&quot;reflect&quot;, cval=0.0, origin=0)</td></tr>
<tr class="separator:a22d6712a86de6eb485961fc8726fcc52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad138cae4d72e92ba608d5ba082f7865a" id="r_ad138cae4d72e92ba608d5ba082f7865a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#ad138cae4d72e92ba608d5ba082f7865a">grey_closing</a> (input, size=None, footprint=None, structure=None, output=None, mode=&quot;reflect&quot;, cval=0.0, origin=0)</td></tr>
<tr class="separator:ad138cae4d72e92ba608d5ba082f7865a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2adc01fa7bd196f6b4e192bea82c7766" id="r_a2adc01fa7bd196f6b4e192bea82c7766"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a2adc01fa7bd196f6b4e192bea82c7766">morphological_gradient</a> (input, size=None, footprint=None, structure=None, output=None, mode=&quot;reflect&quot;, cval=0.0, origin=0)</td></tr>
<tr class="separator:a2adc01fa7bd196f6b4e192bea82c7766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fff8ab8112efaac5e8468232ef05fc5" id="r_a0fff8ab8112efaac5e8468232ef05fc5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a0fff8ab8112efaac5e8468232ef05fc5">morphological_laplace</a> (input, size=None, footprint=None, structure=None, output=None, mode=&quot;reflect&quot;, cval=0.0, origin=0)</td></tr>
<tr class="separator:a0fff8ab8112efaac5e8468232ef05fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc672dbc002ca4d3046d93c4f97917df" id="r_afc672dbc002ca4d3046d93c4f97917df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#afc672dbc002ca4d3046d93c4f97917df">white_tophat</a> (input, size=None, footprint=None, structure=None, output=None, mode=&quot;reflect&quot;, cval=0.0, origin=0)</td></tr>
<tr class="separator:afc672dbc002ca4d3046d93c4f97917df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72f0812aaf64f0ecf601fe13285a0773" id="r_a72f0812aaf64f0ecf601fe13285a0773"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a72f0812aaf64f0ecf601fe13285a0773">black_tophat</a> (input, size=None, footprint=None, structure=None, output=None, mode=&quot;reflect&quot;, cval=0.0, origin=0)</td></tr>
<tr class="separator:a72f0812aaf64f0ecf601fe13285a0773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee604cc266e7e18fdd063bbbb4982b3a" id="r_aee604cc266e7e18fdd063bbbb4982b3a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#aee604cc266e7e18fdd063bbbb4982b3a">distance_transform_bf</a> (input, metric=&quot;euclidean&quot;, sampling=None, return_distances=True, return_indices=False, distances=None, indices=None)</td></tr>
<tr class="separator:aee604cc266e7e18fdd063bbbb4982b3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c50783191be8546186187b4a6fac0c4" id="r_a4c50783191be8546186187b4a6fac0c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a4c50783191be8546186187b4a6fac0c4">distance_transform_cdt</a> (input, metric='chessboard', return_distances=True, return_indices=False, distances=None, indices=None)</td></tr>
<tr class="separator:a4c50783191be8546186187b4a6fac0c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b7e191882073a63602a80343313ea3" id="r_ae4b7e191882073a63602a80343313ea3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#ae4b7e191882073a63602a80343313ea3">distance_transform_edt</a> (input, sampling=None, return_distances=True, return_indices=False, distances=None, indices=None)</td></tr>
<tr class="separator:ae4b7e191882073a63602a80343313ea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919de6e43201c152f1b085b5e9380222" id="r_a919de6e43201c152f1b085b5e9380222"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__morphology.html#a919de6e43201c152f1b085b5e9380222">_distance_tranform_arg_check</a> (distances_out, indices_out, return_distances, return_indices)</td></tr>
<tr class="separator:a919de6e43201c152f1b085b5e9380222"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3f859d5303e7c6616469d6dfa3c3f3c6" name="a3f859d5303e7c6616469d6dfa3c3f3c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f859d5303e7c6616469d6dfa3c3f3c6">&#9670;&#160;</a></span>_binary_erosion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology._binary_erosion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>border_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>invert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brute_force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  216</span>                    border_value, origin, invert, brute_force):</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  218</span>        iterations = operator.index(iterations)</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">except</span> TypeError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;iterations parameter should be an integer&#39;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">if</span> numpy.iscomplexobj(input):</div>
<div class="line"><span class="lineno">  224</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;Complex type not supported&#39;</span>)</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">if</span> structure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  226</span>        structure = generate_binary_structure(input.ndim, 1)</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  228</span>        structure = numpy.asarray(structure, dtype=bool)</div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">if</span> structure.ndim != input.ndim:</div>
<div class="line"><span class="lineno">  230</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;structure and input must have same dimensionality&#39;</span>)</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> structure.flags.contiguous:</div>
<div class="line"><span class="lineno">  232</span>        structure = structure.copy()</div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">if</span> numpy.prod(structure.shape, axis=0) &lt; 1:</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;structure must not be empty&#39;</span>)</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> mask <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  236</span>        mask = numpy.asarray(mask)</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">if</span> mask.shape != input.shape:</div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;mask and input must have equal sizes&#39;</span>)</div>
<div class="line"><span class="lineno">  239</span>    origin = _ni_support._normalize_sequence(origin, input.ndim)</div>
<div class="line"><span class="lineno">  240</span>    cit = _center_is_true(structure, origin)</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">if</span> isinstance(output, numpy.ndarray):</div>
<div class="line"><span class="lineno">  242</span>        <span class="keywordflow">if</span> numpy.iscomplexobj(output):</div>
<div class="line"><span class="lineno">  243</span>            <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;Complex output type not supported&#39;</span>)</div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  245</span>        output = bool</div>
<div class="line"><span class="lineno">  246</span>    output = _ni_support._get_output(output, input)</div>
<div class="line"><span class="lineno">  247</span>    temp_needed = numpy.may_share_memory(input, output)</div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">if</span> temp_needed:</div>
<div class="line"><span class="lineno">  249</span>        <span class="comment"># input and output arrays cannot share memory</span></div>
<div class="line"><span class="lineno">  250</span>        temp = output</div>
<div class="line"><span class="lineno">  251</span>        output = _ni_support._get_output(output.dtype, input)</div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">if</span> iterations == 1:</div>
<div class="line"><span class="lineno">  253</span>        _nd_image.binary_erosion(input, structure, mask, output,</div>
<div class="line"><span class="lineno">  254</span>                                 border_value, origin, invert, cit, 0)</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">elif</span> cit <span class="keywordflow">and</span> <span class="keywordflow">not</span> brute_force:</div>
<div class="line"><span class="lineno">  256</span>        changed, coordinate_list = _nd_image.binary_erosion(</div>
<div class="line"><span class="lineno">  257</span>            input, structure, mask, output,</div>
<div class="line"><span class="lineno">  258</span>            border_value, origin, invert, cit, 1)</div>
<div class="line"><span class="lineno">  259</span>        structure = structure[tuple([slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)] *</div>
<div class="line"><span class="lineno">  260</span>                                    structure.ndim)]</div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(len(origin)):</div>
<div class="line"><span class="lineno">  262</span>            origin[ii] = -origin[ii]</div>
<div class="line"><span class="lineno">  263</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> structure.shape[ii] &amp; 1:</div>
<div class="line"><span class="lineno">  264</span>                origin[ii] -= 1</div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">if</span> mask <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  266</span>            mask = numpy.asarray(mask, dtype=numpy.int8)</div>
<div class="line"><span class="lineno">  267</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> structure.flags.contiguous:</div>
<div class="line"><span class="lineno">  268</span>            structure = structure.copy()</div>
<div class="line"><span class="lineno">  269</span>        _nd_image.binary_erosion2(output, structure, mask, iterations - 1,</div>
<div class="line"><span class="lineno">  270</span>                                  origin, invert, coordinate_list)</div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  272</span>        tmp_in = numpy.empty_like(input, dtype=bool)</div>
<div class="line"><span class="lineno">  273</span>        tmp_out = output</div>
<div class="line"><span class="lineno">  274</span>        <span class="keywordflow">if</span> iterations &gt;= 1 <span class="keywordflow">and</span> <span class="keywordflow">not</span> iterations &amp; 1:</div>
<div class="line"><span class="lineno">  275</span>            tmp_in, tmp_out = tmp_out, tmp_in</div>
<div class="line"><span class="lineno">  276</span>        changed = _nd_image.binary_erosion(</div>
<div class="line"><span class="lineno">  277</span>            input, structure, mask, tmp_out,</div>
<div class="line"><span class="lineno">  278</span>            border_value, origin, invert, cit, 0)</div>
<div class="line"><span class="lineno">  279</span>        ii = 1</div>
<div class="line"><span class="lineno">  280</span>        <span class="keywordflow">while</span> ii &lt; iterations <span class="keywordflow">or</span> (iterations &lt; 1 <span class="keywordflow">and</span> changed):</div>
<div class="line"><span class="lineno">  281</span>            tmp_in, tmp_out = tmp_out, tmp_in</div>
<div class="line"><span class="lineno">  282</span>            changed = _nd_image.binary_erosion(</div>
<div class="line"><span class="lineno">  283</span>                tmp_in, structure, mask, tmp_out,</div>
<div class="line"><span class="lineno">  284</span>                border_value, origin, invert, cit, 0)</div>
<div class="line"><span class="lineno">  285</span>            ii += 1</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">if</span> temp_needed:</div>
<div class="line"><span class="lineno">  287</span>        temp[...] = output</div>
<div class="line"><span class="lineno">  288</span>        output = temp</div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">return</span> output</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2851a9e4d44123be02f0ea9d3c67e7ce" name="a2851a9e4d44123be02f0ea9d3c67e7ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2851a9e4d44123be02f0ea9d3c67e7ce">&#9670;&#160;</a></span>_center_is_true()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology._center_is_true </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   48</span><span class="keyword">def </span>_center_is_true(structure, origin):</div>
<div class="line"><span class="lineno">   49</span>    structure = numpy.array(structure)</div>
<div class="line"><span class="lineno">   50</span>    coor = tuple([oo + ss // 2 <span class="keywordflow">for</span> ss, oo <span class="keywordflow">in</span> zip(structure.shape,</div>
<div class="line"><span class="lineno">   51</span>                                                 origin)])</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">return</span> bool(structure[coor])</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a919de6e43201c152f1b085b5e9380222" name="a919de6e43201c152f1b085b5e9380222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a919de6e43201c152f1b085b5e9380222">&#9670;&#160;</a></span>_distance_tranform_arg_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology._distance_tranform_arg_check </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distances_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>indices_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_distances</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Raise a RuntimeError if the arguments are invalid</pre> <div class="fragment"><div class="line"><span class="lineno"> 2313</span>                                 return_distances, return_indices):</div>
<div class="line"><span class="lineno"> 2314</span>    <span class="stringliteral">&quot;&quot;&quot;Raise a RuntimeError if the arguments are invalid&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2315</span>    error_msgs = []</div>
<div class="line"><span class="lineno"> 2316</span>    <span class="keywordflow">if</span> (<span class="keywordflow">not</span> return_distances) <span class="keywordflow">and</span> (<span class="keywordflow">not</span> return_indices):</div>
<div class="line"><span class="lineno"> 2317</span>        error_msgs.append(</div>
<div class="line"><span class="lineno"> 2318</span>            <span class="stringliteral">&#39;at least one of return_distances/return_indices must be True&#39;</span>)</div>
<div class="line"><span class="lineno"> 2319</span>    <span class="keywordflow">if</span> distances_out <span class="keywordflow">and</span> <span class="keywordflow">not</span> return_distances:</div>
<div class="line"><span class="lineno"> 2320</span>        error_msgs.append(</div>
<div class="line"><span class="lineno"> 2321</span>            <span class="stringliteral">&#39;return_distances must be True if distances is supplied&#39;</span></div>
<div class="line"><span class="lineno"> 2322</span>        )</div>
<div class="line"><span class="lineno"> 2323</span>    <span class="keywordflow">if</span> indices_out <span class="keywordflow">and</span> <span class="keywordflow">not</span> return_indices:</div>
<div class="line"><span class="lineno"> 2324</span>        error_msgs.append(<span class="stringliteral">&#39;return_indices must be True if indices is supplied&#39;</span>)</div>
<div class="line"><span class="lineno"> 2325</span>    <span class="keywordflow">if</span> error_msgs:</div>
<div class="line"><span class="lineno"> 2326</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;, &#39;</span>.join(error_msgs))</div>
</div><!-- fragment -->
</div>
</div>
<a id="af141f355eae9ec61ee36be125178cbb1" name="af141f355eae9ec61ee36be125178cbb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af141f355eae9ec61ee36be125178cbb1">&#9670;&#160;</a></span>binary_closing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.binary_closing </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>border_value</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brute_force</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional binary closing with the given structuring element.

The *closing* of an input image by a structuring element is the
*erosion* of the *dilation* of the image by the structuring element.

Parameters
----------
input : array_like
    Binary array_like to be closed. Non-zero (True) elements form
    the subset to be closed.
structure : array_like, optional
    Structuring element used for the closing. Non-zero elements are
    considered True. If no structuring element is provided an element
    is generated with a square connectivity equal to one (i.e., only
    nearest neighbors are connected to the center, diagonally-connected
    elements are not considered neighbors).
iterations : int, optional
    The dilation step of the closing, then the erosion step are each
    repeated `iterations` times (one, by default). If iterations is
    less than 1, each operations is repeated until the result does
    not change anymore. Only an integer of iterations is accepted.
output : ndarray, optional
    Array of the same shape as input, into which the output is placed.
    By default, a new array is created.
origin : int or tuple of ints, optional
    Placement of the filter, by default 0.
mask : array_like, optional
    If a mask is given, only those elements with a True value at
    the corresponding mask element are modified at each iteration.

    .. versionadded:: 1.1.0
border_value : int (cast to 0 or 1), optional
    Value at the border in the output array.

    .. versionadded:: 1.1.0
brute_force : boolean, optional
    Memory condition: if False, only the pixels whose value was changed in
    the last iteration are tracked as candidates to be updated in the
    current iteration; if true al pixels are considered as candidates for
    update, regardless of what happened in the previous iteration.
    False by default.

    .. versionadded:: 1.1.0

Returns
-------
binary_closing : ndarray of bools
    Closing of the input by the structuring element.

See also
--------
grey_closing, binary_opening, binary_dilation, binary_erosion,
generate_binary_structure

Notes
-----
*Closing* [1]_ is a mathematical morphology operation [2]_ that
consists in the succession of a dilation and an erosion of the
input with the same structuring element. Closing therefore fills
holes smaller than the structuring element.

Together with *opening* (`binary_opening`), closing can be used for
noise removal.

References
----------
.. [1] https://en.wikipedia.org/wiki/Closing_%28morphology%29
.. [2] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((5,5), dtype=int)
&gt;&gt;&gt; a[1:-1, 1:-1] = 1; a[2,2] = 0
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 0, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0]])
&gt;&gt;&gt; # Closing removes small holes
&gt;&gt;&gt; ndimage.binary_closing(a).astype(int)
array([[0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0]])
&gt;&gt;&gt; # Closing is the erosion of the dilation of the input
&gt;&gt;&gt; ndimage.binary_dilation(a).astype(int)
array([[0, 1, 1, 1, 0],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [0, 1, 1, 1, 0]])
&gt;&gt;&gt; ndimage.binary_erosion(ndimage.binary_dilation(a)).astype(int)
array([[0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0]])


&gt;&gt;&gt; a = np.zeros((7,7), dtype=int)
&gt;&gt;&gt; a[1:6, 2:5] = 1; a[1:3,3] = 0
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 0, 1, 0, 0],
       [0, 0, 1, 0, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; # In addition to removing holes, closing can also
&gt;&gt;&gt; # coarsen boundaries with fine hollows.
&gt;&gt;&gt; ndimage.binary_closing(a).astype(int)
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 0, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.binary_closing(a, structure=np.ones((2,2))).astype(int)
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno">  645</span>                   origin=0, mask=<span class="keywordtype">None</span>, border_value=0, brute_force=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  646</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral">    Multidimensional binary closing with the given structuring element.</span></div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">    The *closing* of an input image by a structuring element is the</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral">    *erosion* of the *dilation* of the image by the structuring element.</span></div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">        Binary array_like to be closed. Non-zero (True) elements form</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">        the subset to be closed.</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">    structure : array_like, optional</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral">        Structuring element used for the closing. Non-zero elements are</span></div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">        considered True. If no structuring element is provided an element</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">        is generated with a square connectivity equal to one (i.e., only</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">        nearest neighbors are connected to the center, diagonally-connected</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">        elements are not considered neighbors).</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">    iterations : int, optional</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">        The dilation step of the closing, then the erosion step are each</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">        repeated `iterations` times (one, by default). If iterations is</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">        less than 1, each operations is repeated until the result does</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">        not change anymore. Only an integer of iterations is accepted.</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral">        Array of the same shape as input, into which the output is placed.</span></div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral">        By default, a new array is created.</span></div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">    origin : int or tuple of ints, optional</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">        Placement of the filter, by default 0.</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">    mask : array_like, optional</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">        If a mask is given, only those elements with a True value at</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral">        the corresponding mask element are modified at each iteration.</span></div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral">        .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">    border_value : int (cast to 0 or 1), optional</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">        Value at the border in the output array.</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">        .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    brute_force : boolean, optional</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">        Memory condition: if False, only the pixels whose value was changed in</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">        the last iteration are tracked as candidates to be updated in the</span></div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral">        current iteration; if true al pixels are considered as candidates for</span></div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral">        update, regardless of what happened in the previous iteration.</span></div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral">        False by default.</span></div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral">        .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral">    binary_closing : ndarray of bools</span></div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">        Closing of the input by the structuring element.</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">    grey_closing, binary_opening, binary_dilation, binary_erosion,</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">    generate_binary_structure</span></div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">    *Closing* [1]_ is a mathematical morphology operation [2]_ that</span></div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral">    consists in the succession of a dilation and an erosion of the</span></div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral">    input with the same structuring element. Closing therefore fills</span></div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral">    holes smaller than the structuring element.</span></div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  708</span><span class="stringliteral">    Together with *opening* (`binary_opening`), closing can be used for</span></div>
<div class="line"><span class="lineno">  709</span><span class="stringliteral">    noise removal.</span></div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  712</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  713</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Closing_%28morphology%29</span></div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">    .. [2] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((5,5), dtype=int)</span></div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral">    &gt;&gt;&gt; a[1:-1, 1:-1] = 1; a[2,2] = 0</span></div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral">           [0, 1, 0, 1, 0],</span></div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral">    &gt;&gt;&gt; # Closing removes small holes</span></div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_closing(a).astype(int)</span></div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">    &gt;&gt;&gt; # Closing is the erosion of the dilation of the input</span></div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_dilation(a).astype(int)</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral">    array([[0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">           [1, 1, 1, 1, 1],</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">           [1, 1, 1, 1, 1],</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">           [1, 1, 1, 1, 1],</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">           [0, 1, 1, 1, 0]])</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_erosion(ndimage.binary_dilation(a)).astype(int)</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((7,7), dtype=int)</span></div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral">    &gt;&gt;&gt; a[1:6, 2:5] = 1; a[1:3,3] = 0</span></div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  752</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  753</span><span class="stringliteral">           [0, 0, 1, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  754</span><span class="stringliteral">           [0, 0, 1, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  755</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  756</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  757</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  758</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  759</span><span class="stringliteral">    &gt;&gt;&gt; # In addition to removing holes, closing can also</span></div>
<div class="line"><span class="lineno">  760</span><span class="stringliteral">    &gt;&gt;&gt; # coarsen boundaries with fine hollows.</span></div>
<div class="line"><span class="lineno">  761</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_closing(a).astype(int)</span></div>
<div class="line"><span class="lineno">  762</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  763</span><span class="stringliteral">           [0, 0, 1, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  764</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  765</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  766</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  767</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  768</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  769</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_closing(a, structure=np.ones((2,2))).astype(int)</span></div>
<div class="line"><span class="lineno">  770</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  771</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  772</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  773</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  774</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  775</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  776</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  777</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  778</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  779</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">if</span> structure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  781</span>        rank = input.ndim</div>
<div class="line"><span class="lineno">  782</span>        structure = generate_binary_structure(rank, 1)</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    tmp = binary_dilation(input, structure, iterations, mask, <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  785</span>                          border_value, origin, brute_force)</div>
<div class="line"><span class="lineno">  786</span>    <span class="keywordflow">return</span> binary_erosion(tmp, structure, iterations, mask, output,</div>
<div class="line"><span class="lineno">  787</span>                          border_value, origin, brute_force)</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6f306301c649c5d9e9536bfd2151847" name="ad6f306301c649c5d9e9536bfd2151847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6f306301c649c5d9e9536bfd2151847">&#9670;&#160;</a></span>binary_dilation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.binary_dilation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>border_value</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brute_force</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional binary dilation with the given structuring element.

Parameters
----------
input : array_like
    Binary array_like to be dilated. Non-zero (True) elements form
    the subset to be dilated.
structure : array_like, optional
    Structuring element used for the dilation. Non-zero elements are
    considered True. If no structuring element is provided an element
    is generated with a square connectivity equal to one.
iterations : int, optional
    The dilation is repeated `iterations` times (one, by default).
    If iterations is less than 1, the dilation is repeated until the
    result does not change anymore. Only an integer of iterations is
    accepted.
mask : array_like, optional
    If a mask is given, only those elements with a True value at
    the corresponding mask element are modified at each iteration.
output : ndarray, optional
    Array of the same shape as input, into which the output is placed.
    By default, a new array is created.
border_value : int (cast to 0 or 1), optional
    Value at the border in the output array.
origin : int or tuple of ints, optional
    Placement of the filter, by default 0.
brute_force : boolean, optional
    Memory condition: if False, only the pixels whose value was changed in
    the last iteration are tracked as candidates to be updated (dilated)
    in the current iteration; if True all pixels are considered as
    candidates for dilation, regardless of what happened in the previous
    iteration. False by default.

Returns
-------
binary_dilation : ndarray of bools
    Dilation of the input by the structuring element.

See also
--------
grey_dilation, binary_erosion, binary_closing, binary_opening,
generate_binary_structure

Notes
-----
Dilation [1]_ is a mathematical morphology operation [2]_ that uses a
structuring element for expanding the shapes in an image. The binary
dilation of an image by a structuring element is the locus of the points
covered by the structuring element, when its center lies within the
non-zero points of the image.

References
----------
.. [1] https://en.wikipedia.org/wiki/Dilation_%28morphology%29
.. [2] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((5, 5))
&gt;&gt;&gt; a[2, 2] = 1
&gt;&gt;&gt; a
array([[ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.]])
&gt;&gt;&gt; ndimage.binary_dilation(a)
array([[False, False, False, False, False],
       [False, False,  True, False, False],
       [False,  True,  True,  True, False],
       [False, False,  True, False, False],
       [False, False, False, False, False]], dtype=bool)
&gt;&gt;&gt; ndimage.binary_dilation(a).astype(a.dtype)
array([[ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.]])
&gt;&gt;&gt; # 3x3 structuring element with connectivity 1, used by default
&gt;&gt;&gt; struct1 = ndimage.generate_binary_structure(2, 1)
&gt;&gt;&gt; struct1
array([[False,  True, False],
       [ True,  True,  True],
       [False,  True, False]], dtype=bool)
&gt;&gt;&gt; # 3x3 structuring element with connectivity 2
&gt;&gt;&gt; struct2 = ndimage.generate_binary_structure(2, 2)
&gt;&gt;&gt; struct2
array([[ True,  True,  True],
       [ True,  True,  True],
       [ True,  True,  True]], dtype=bool)
&gt;&gt;&gt; ndimage.binary_dilation(a, structure=struct1).astype(a.dtype)
array([[ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.]])
&gt;&gt;&gt; ndimage.binary_dilation(a, structure=struct2).astype(a.dtype)
array([[ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 0.,  0.,  0.,  0.,  0.]])
&gt;&gt;&gt; ndimage.binary_dilation(a, structure=struct1,\\
... iterations=2).astype(a.dtype)
array([[ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 0.,  0.,  1.,  0.,  0.]])</pre> <div class="fragment"><div class="line"><span class="lineno">  391</span>                    brute_force=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  392</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    Multidimensional binary dilation with the given structuring element.</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">        Binary array_like to be dilated. Non-zero (True) elements form</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">        the subset to be dilated.</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    structure : array_like, optional</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">        Structuring element used for the dilation. Non-zero elements are</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">        considered True. If no structuring element is provided an element</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">        is generated with a square connectivity equal to one.</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">    iterations : int, optional</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">        The dilation is repeated `iterations` times (one, by default).</span></div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral">        If iterations is less than 1, the dilation is repeated until the</span></div>
<div class="line"><span class="lineno">  407</span><span class="stringliteral">        result does not change anymore. Only an integer of iterations is</span></div>
<div class="line"><span class="lineno">  408</span><span class="stringliteral">        accepted.</span></div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral">    mask : array_like, optional</span></div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral">        If a mask is given, only those elements with a True value at</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">        the corresponding mask element are modified at each iteration.</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral">        Array of the same shape as input, into which the output is placed.</span></div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral">        By default, a new array is created.</span></div>
<div class="line"><span class="lineno">  415</span><span class="stringliteral">    border_value : int (cast to 0 or 1), optional</span></div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral">        Value at the border in the output array.</span></div>
<div class="line"><span class="lineno">  417</span><span class="stringliteral">    origin : int or tuple of ints, optional</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">        Placement of the filter, by default 0.</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral">    brute_force : boolean, optional</span></div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">        Memory condition: if False, only the pixels whose value was changed in</span></div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">        the last iteration are tracked as candidates to be updated (dilated)</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">        in the current iteration; if True all pixels are considered as</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">        candidates for dilation, regardless of what happened in the previous</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">        iteration. False by default.</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">    binary_dilation : ndarray of bools</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral">        Dilation of the input by the structuring element.</span></div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    grey_dilation, binary_erosion, binary_closing, binary_opening,</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    generate_binary_structure</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">    Dilation [1]_ is a mathematical morphology operation [2]_ that uses a</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">    structuring element for expanding the shapes in an image. The binary</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">    dilation of an image by a structuring element is the locus of the points</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">    covered by the structuring element, when its center lies within the</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    non-zero points of the image.</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Dilation_%28morphology%29</span></div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">    .. [2] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((5, 5))</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral">    &gt;&gt;&gt; a[2, 2] = 1</span></div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">    array([[ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  458</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.]])</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_dilation(a)</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral">    array([[False, False, False, False, False],</span></div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">           [False, False,  True, False, False],</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral">           [False,  True,  True,  True, False],</span></div>
<div class="line"><span class="lineno">  464</span><span class="stringliteral">           [False, False,  True, False, False],</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral">           [False, False, False, False, False]], dtype=bool)</span></div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_dilation(a).astype(a.dtype)</span></div>
<div class="line"><span class="lineno">  467</span><span class="stringliteral">    array([[ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.]])</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral">    &gt;&gt;&gt; # 3x3 structuring element with connectivity 1, used by default</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">    &gt;&gt;&gt; struct1 = ndimage.generate_binary_structure(2, 1)</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">    &gt;&gt;&gt; struct1</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">    array([[False,  True, False],</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">           [ True,  True,  True],</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">           [False,  True, False]], dtype=bool)</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    &gt;&gt;&gt; # 3x3 structuring element with connectivity 2</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">    &gt;&gt;&gt; struct2 = ndimage.generate_binary_structure(2, 2)</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">    &gt;&gt;&gt; struct2</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">    array([[ True,  True,  True],</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">           [ True,  True,  True],</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">           [ True,  True,  True]], dtype=bool)</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_dilation(a, structure=struct1).astype(a.dtype)</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">    array([[ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.]])</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_dilation(a, structure=struct2).astype(a.dtype)</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">    array([[ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.]])</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_dilation(a, structure=struct1,\\</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral">    ... iterations=2).astype(a.dtype)</span></div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">    array([[ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">           [ 1.,  1.,  1.,  1.,  1.],</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.]])</span></div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  505</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordflow">if</span> structure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  507</span>        structure = generate_binary_structure(input.ndim, 1)</div>
<div class="line"><span class="lineno">  508</span>    origin = _ni_support._normalize_sequence(origin, input.ndim)</div>
<div class="line"><span class="lineno">  509</span>    structure = numpy.asarray(structure)</div>
<div class="line"><span class="lineno">  510</span>    structure = structure[tuple([slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)] *</div>
<div class="line"><span class="lineno">  511</span>                                structure.ndim)]</div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(len(origin)):</div>
<div class="line"><span class="lineno">  513</span>        origin[ii] = -origin[ii]</div>
<div class="line"><span class="lineno">  514</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> structure.shape[ii] &amp; 1:</div>
<div class="line"><span class="lineno">  515</span>            origin[ii] -= 1</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    <span class="keywordflow">return</span> _binary_erosion(input, structure, iterations, mask,</div>
<div class="line"><span class="lineno">  518</span>                           output, border_value, origin, 1, brute_force)</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf4c69d471160e40476e1ec891e5e17b" name="aaf4c69d471160e40476e1ec891e5e17b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf4c69d471160e40476e1ec891e5e17b">&#9670;&#160;</a></span>binary_erosion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.binary_erosion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>border_value</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brute_force</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional binary erosion with a given structuring element.

Binary erosion is a mathematical morphology operation used for image
processing.

Parameters
----------
input : array_like
    Binary image to be eroded. Non-zero (True) elements form
    the subset to be eroded.
structure : array_like, optional
    Structuring element used for the erosion. Non-zero elements are
    considered True. If no structuring element is provided, an element
    is generated with a square connectivity equal to one.
iterations : int, optional
    The erosion is repeated `iterations` times (one, by default).
    If iterations is less than 1, the erosion is repeated until the
    result does not change anymore.
mask : array_like, optional
    If a mask is given, only those elements with a True value at
    the corresponding mask element are modified at each iteration.
output : ndarray, optional
    Array of the same shape as input, into which the output is placed.
    By default, a new array is created.
border_value : int (cast to 0 or 1), optional
    Value at the border in the output array.
origin : int or tuple of ints, optional
    Placement of the filter, by default 0.
brute_force : boolean, optional
    Memory condition: if False, only the pixels whose value was changed in
    the last iteration are tracked as candidates to be updated (eroded) in
    the current iteration; if True all pixels are considered as candidates
    for erosion, regardless of what happened in the previous iteration.
    False by default.

Returns
-------
binary_erosion : ndarray of bools
    Erosion of the input by the structuring element.

See also
--------
grey_erosion, binary_dilation, binary_closing, binary_opening,
generate_binary_structure

Notes
-----
Erosion [1]_ is a mathematical morphology operation [2]_ that uses a
structuring element for shrinking the shapes in an image. The binary
erosion of an image by a structuring element is the locus of the points
where a superimposition of the structuring element centered on the point
is entirely contained in the set of non-zero elements of the image.

References
----------
.. [1] https://en.wikipedia.org/wiki/Erosion_%28morphology%29
.. [2] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((7,7), dtype=int)
&gt;&gt;&gt; a[1:6, 2:5] = 1
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.binary_erosion(a).astype(a.dtype)
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; #Erosion removes objects smaller than the structure
&gt;&gt;&gt; ndimage.binary_erosion(a, structure=np.ones((5,5))).astype(a.dtype)
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno">  293</span>                   border_value=0, origin=0, brute_force=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  294</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">    Multidimensional binary erosion with a given structuring element.</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">    Binary erosion is a mathematical morphology operation used for image</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">    processing.</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">        Binary image to be eroded. Non-zero (True) elements form</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        the subset to be eroded.</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">    structure : array_like, optional</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">        Structuring element used for the erosion. Non-zero elements are</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">        considered True. If no structuring element is provided, an element</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">        is generated with a square connectivity equal to one.</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">    iterations : int, optional</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">        The erosion is repeated `iterations` times (one, by default).</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">        If iterations is less than 1, the erosion is repeated until the</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">        result does not change anymore.</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">    mask : array_like, optional</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">        If a mask is given, only those elements with a True value at</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">        the corresponding mask element are modified at each iteration.</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">        Array of the same shape as input, into which the output is placed.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">        By default, a new array is created.</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    border_value : int (cast to 0 or 1), optional</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        Value at the border in the output array.</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    origin : int or tuple of ints, optional</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">        Placement of the filter, by default 0.</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    brute_force : boolean, optional</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        Memory condition: if False, only the pixels whose value was changed in</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">        the last iteration are tracked as candidates to be updated (eroded) in</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">        the current iteration; if True all pixels are considered as candidates</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        for erosion, regardless of what happened in the previous iteration.</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">        False by default.</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    binary_erosion : ndarray of bools</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">        Erosion of the input by the structuring element.</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    grey_erosion, binary_dilation, binary_closing, binary_opening,</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    generate_binary_structure</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    Erosion [1]_ is a mathematical morphology operation [2]_ that uses a</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    structuring element for shrinking the shapes in an image. The binary</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    erosion of an image by a structuring element is the locus of the points</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    where a superimposition of the structuring element centered on the point</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    is entirely contained in the set of non-zero elements of the image.</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Erosion_%28morphology%29</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    .. [2] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((7,7), dtype=int)</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">    &gt;&gt;&gt; a[1:6, 2:5] = 1</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_erosion(a).astype(a.dtype)</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">    &gt;&gt;&gt; #Erosion removes objects smaller than the structure</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_erosion(a, structure=np.ones((5,5))).astype(a.dtype)</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  385</span>    <span class="keywordflow">return</span> _binary_erosion(input, structure, iterations, mask,</div>
<div class="line"><span class="lineno">  386</span>                           output, border_value, origin, 0, brute_force)</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abdcb01b54ec069de14c06f87202f4792" name="abdcb01b54ec069de14c06f87202f4792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdcb01b54ec069de14c06f87202f4792">&#9670;&#160;</a></span>binary_fill_holes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.binary_fill_holes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Fill the holes in binary objects.


Parameters
----------
input : array_like
    N-D binary array with holes to be filled
structure : array_like, optional
    Structuring element used in the computation; large-size elements
    make computations faster but may miss holes separated from the
    background by thin regions. The default element (with a square
    connectivity equal to one) yields the intuitive result where all
    holes in the input have been filled.
output : ndarray, optional
    Array of the same shape as input, into which the output is placed.
    By default, a new array is created.
origin : int, tuple of ints, optional
    Position of the structuring element.

Returns
-------
out : ndarray
    Transformation of the initial image `input` where holes have been
    filled.

See also
--------
binary_dilation, binary_propagation, label

Notes
-----
The algorithm used in this function consists in invading the complementary
of the shapes in `input` from the outer boundary of the image,
using binary dilations. Holes are not connected to the boundary and are
therefore not invaded. The result is the complementary subset of the
invaded region.

References
----------
.. [1] https://en.wikipedia.org/wiki/Mathematical_morphology


Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((5, 5), dtype=int)
&gt;&gt;&gt; a[1:4, 1:4] = 1
&gt;&gt;&gt; a[2,2] = 0
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 0, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.binary_fill_holes(a).astype(int)
array([[0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0]])
&gt;&gt;&gt; # Too big structuring element
&gt;&gt;&gt; ndimage.binary_fill_holes(a, structure=np.ones((5,5))).astype(int)
array([[0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 0, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1030</span><span class="keyword">def </span>binary_fill_holes(input, structure=None, output=None, origin=0):</div>
<div class="line"><span class="lineno"> 1031</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1032</span><span class="stringliteral">    Fill the holes in binary objects.</span></div>
<div class="line"><span class="lineno"> 1033</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">        N-D binary array with holes to be filled</span></div>
<div class="line"><span class="lineno"> 1039</span><span class="stringliteral">    structure : array_like, optional</span></div>
<div class="line"><span class="lineno"> 1040</span><span class="stringliteral">        Structuring element used in the computation; large-size elements</span></div>
<div class="line"><span class="lineno"> 1041</span><span class="stringliteral">        make computations faster but may miss holes separated from the</span></div>
<div class="line"><span class="lineno"> 1042</span><span class="stringliteral">        background by thin regions. The default element (with a square</span></div>
<div class="line"><span class="lineno"> 1043</span><span class="stringliteral">        connectivity equal to one) yields the intuitive result where all</span></div>
<div class="line"><span class="lineno"> 1044</span><span class="stringliteral">        holes in the input have been filled.</span></div>
<div class="line"><span class="lineno"> 1045</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1046</span><span class="stringliteral">        Array of the same shape as input, into which the output is placed.</span></div>
<div class="line"><span class="lineno"> 1047</span><span class="stringliteral">        By default, a new array is created.</span></div>
<div class="line"><span class="lineno"> 1048</span><span class="stringliteral">    origin : int, tuple of ints, optional</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral">        Position of the structuring element.</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">    out : ndarray</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">        Transformation of the initial image `input` where holes have been</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral">        filled.</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral">    binary_dilation, binary_propagation, label</span></div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral">    The algorithm used in this function consists in invading the complementary</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral">    of the shapes in `input` from the outer boundary of the image,</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral">    using binary dilations. Holes are not connected to the boundary and are</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="stringliteral">    therefore not invaded. The result is the complementary subset of the</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="stringliteral">    invaded region.</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1069</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1073</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((5, 5), dtype=int)</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">    &gt;&gt;&gt; a[1:4, 1:4] = 1</span></div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral">    &gt;&gt;&gt; a[2,2] = 0</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral">           [0, 1, 0, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1084</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1085</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1086</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_fill_holes(a).astype(int)</span></div>
<div class="line"><span class="lineno"> 1087</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1088</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1089</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1090</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1091</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1092</span><span class="stringliteral">    &gt;&gt;&gt; # Too big structuring element</span></div>
<div class="line"><span class="lineno"> 1093</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_fill_holes(a, structure=np.ones((5,5))).astype(int)</span></div>
<div class="line"><span class="lineno"> 1094</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1095</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1096</span><span class="stringliteral">           [0, 1, 0, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1097</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1098</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1099</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1100</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1101</span>    mask = numpy.logical_not(input)</div>
<div class="line"><span class="lineno"> 1102</span>    tmp = numpy.zeros(mask.shape, bool)</div>
<div class="line"><span class="lineno"> 1103</span>    inplace = isinstance(output, numpy.ndarray)</div>
<div class="line"><span class="lineno"> 1104</span>    <span class="keywordflow">if</span> inplace:</div>
<div class="line"><span class="lineno"> 1105</span>        binary_dilation(tmp, structure, -1, mask, output, 1, origin)</div>
<div class="line"><span class="lineno"> 1106</span>        numpy.logical_not(output, output)</div>
<div class="line"><span class="lineno"> 1107</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1108</span>        output = binary_dilation(tmp, structure, -1, mask, <span class="keywordtype">None</span>, 1,</div>
<div class="line"><span class="lineno"> 1109</span>                                 origin)</div>
<div class="line"><span class="lineno"> 1110</span>        numpy.logical_not(output, output)</div>
<div class="line"><span class="lineno"> 1111</span>        <span class="keywordflow">return</span> output</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7bef98325ff647bb1260c97597bf2bd" name="aa7bef98325ff647bb1260c97597bf2bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7bef98325ff647bb1260c97597bf2bd">&#9670;&#160;</a></span>binary_hit_or_miss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.binary_hit_or_miss </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure1</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure2</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin1</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin2</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional binary hit-or-miss transform.

The hit-or-miss transform finds the locations of a given pattern
inside the input image.

Parameters
----------
input : array_like (cast to booleans)
    Binary image where a pattern is to be detected.
structure1 : array_like (cast to booleans), optional
    Part of the structuring element to be fitted to the foreground
    (non-zero elements) of `input`. If no value is provided, a
    structure of square connectivity 1 is chosen.
structure2 : array_like (cast to booleans), optional
    Second part of the structuring element that has to miss completely
    the foreground. If no value is provided, the complementary of
    `structure1` is taken.
output : ndarray, optional
    Array of the same shape as input, into which the output is placed.
    By default, a new array is created.
origin1 : int or tuple of ints, optional
    Placement of the first part of the structuring element `structure1`,
    by default 0 for a centered structure.
origin2 : int or tuple of ints, optional
    Placement of the second part of the structuring element `structure2`,
    by default 0 for a centered structure. If a value is provided for
    `origin1` and not for `origin2`, then `origin2` is set to `origin1`.

Returns
-------
binary_hit_or_miss : ndarray
    Hit-or-miss transform of `input` with the given structuring
    element (`structure1`, `structure2`).

See also
--------
binary_erosion

References
----------
.. [1] https://en.wikipedia.org/wiki/Hit-or-miss_transform

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((7,7), dtype=int)
&gt;&gt;&gt; a[1, 1] = 1; a[2:4, 2:4] = 1; a[4:6, 4:6] = 1
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 1, 0, 0, 0, 0, 0],
       [0, 0, 1, 1, 0, 0, 0],
       [0, 0, 1, 1, 0, 0, 0],
       [0, 0, 0, 0, 1, 1, 0],
       [0, 0, 0, 0, 1, 1, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; structure1 = np.array([[1, 0, 0], [0, 1, 1], [0, 1, 1]])
&gt;&gt;&gt; structure1
array([[1, 0, 0],
       [0, 1, 1],
       [0, 1, 1]])
&gt;&gt;&gt; # Find the matches of structure1 in the array a
&gt;&gt;&gt; ndimage.binary_hit_or_miss(a, structure1=structure1).astype(int)
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; # Change the origin of the filter
&gt;&gt;&gt; # origin1=1 is equivalent to origin1=(1,1) here
&gt;&gt;&gt; ndimage.binary_hit_or_miss(a, structure1=structure1,\\
... origin1=1).astype(int)
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 1, 0],
       [0, 0, 0, 0, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno">  791</span>                       output=<span class="keywordtype">None</span>, origin1=0, origin2=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  792</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">    Multidimensional binary hit-or-miss transform.</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral">    The hit-or-miss transform finds the locations of a given pattern</span></div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">    inside the input image.</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  799</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  800</span><span class="stringliteral">    input : array_like (cast to booleans)</span></div>
<div class="line"><span class="lineno">  801</span><span class="stringliteral">        Binary image where a pattern is to be detected.</span></div>
<div class="line"><span class="lineno">  802</span><span class="stringliteral">    structure1 : array_like (cast to booleans), optional</span></div>
<div class="line"><span class="lineno">  803</span><span class="stringliteral">        Part of the structuring element to be fitted to the foreground</span></div>
<div class="line"><span class="lineno">  804</span><span class="stringliteral">        (non-zero elements) of `input`. If no value is provided, a</span></div>
<div class="line"><span class="lineno">  805</span><span class="stringliteral">        structure of square connectivity 1 is chosen.</span></div>
<div class="line"><span class="lineno">  806</span><span class="stringliteral">    structure2 : array_like (cast to booleans), optional</span></div>
<div class="line"><span class="lineno">  807</span><span class="stringliteral">        Second part of the structuring element that has to miss completely</span></div>
<div class="line"><span class="lineno">  808</span><span class="stringliteral">        the foreground. If no value is provided, the complementary of</span></div>
<div class="line"><span class="lineno">  809</span><span class="stringliteral">        `structure1` is taken.</span></div>
<div class="line"><span class="lineno">  810</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno">  811</span><span class="stringliteral">        Array of the same shape as input, into which the output is placed.</span></div>
<div class="line"><span class="lineno">  812</span><span class="stringliteral">        By default, a new array is created.</span></div>
<div class="line"><span class="lineno">  813</span><span class="stringliteral">    origin1 : int or tuple of ints, optional</span></div>
<div class="line"><span class="lineno">  814</span><span class="stringliteral">        Placement of the first part of the structuring element `structure1`,</span></div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral">        by default 0 for a centered structure.</span></div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">    origin2 : int or tuple of ints, optional</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral">        Placement of the second part of the structuring element `structure2`,</span></div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">        by default 0 for a centered structure. If a value is provided for</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral">        `origin1` and not for `origin2`, then `origin2` is set to `origin1`.</span></div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">    binary_hit_or_miss : ndarray</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">        Hit-or-miss transform of `input` with the given structuring</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">        element (`structure1`, `structure2`).</span></div>
<div class="line"><span class="lineno">  826</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">    binary_erosion</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  831</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  832</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  833</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Hit-or-miss_transform</span></div>
<div class="line"><span class="lineno">  834</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  835</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  836</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  837</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  838</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((7,7), dtype=int)</span></div>
<div class="line"><span class="lineno">  839</span><span class="stringliteral">    &gt;&gt;&gt; a[1, 1] = 1; a[2:4, 2:4] = 1; a[4:6, 4:6] = 1</span></div>
<div class="line"><span class="lineno">  840</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  841</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  842</span><span class="stringliteral">           [0, 1, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  843</span><span class="stringliteral">           [0, 0, 1, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  844</span><span class="stringliteral">           [0, 0, 1, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  845</span><span class="stringliteral">           [0, 0, 0, 0, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  846</span><span class="stringliteral">           [0, 0, 0, 0, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  847</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  848</span><span class="stringliteral">    &gt;&gt;&gt; structure1 = np.array([[1, 0, 0], [0, 1, 1], [0, 1, 1]])</span></div>
<div class="line"><span class="lineno">  849</span><span class="stringliteral">    &gt;&gt;&gt; structure1</span></div>
<div class="line"><span class="lineno">  850</span><span class="stringliteral">    array([[1, 0, 0],</span></div>
<div class="line"><span class="lineno">  851</span><span class="stringliteral">           [0, 1, 1],</span></div>
<div class="line"><span class="lineno">  852</span><span class="stringliteral">           [0, 1, 1]])</span></div>
<div class="line"><span class="lineno">  853</span><span class="stringliteral">    &gt;&gt;&gt; # Find the matches of structure1 in the array a</span></div>
<div class="line"><span class="lineno">  854</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_hit_or_miss(a, structure1=structure1).astype(int)</span></div>
<div class="line"><span class="lineno">  855</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  856</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  857</span><span class="stringliteral">           [0, 0, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  858</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  859</span><span class="stringliteral">           [0, 0, 0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  860</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  861</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  862</span><span class="stringliteral">    &gt;&gt;&gt; # Change the origin of the filter</span></div>
<div class="line"><span class="lineno">  863</span><span class="stringliteral">    &gt;&gt;&gt; # origin1=1 is equivalent to origin1=(1,1) here</span></div>
<div class="line"><span class="lineno">  864</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_hit_or_miss(a, structure1=structure1,\\</span></div>
<div class="line"><span class="lineno">  865</span><span class="stringliteral">    ... origin1=1).astype(int)</span></div>
<div class="line"><span class="lineno">  866</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  868</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  869</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  870</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  871</span><span class="stringliteral">           [0, 0, 0, 0, 0, 1, 0],</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  873</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  874</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  875</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno">  876</span>    <span class="keywordflow">if</span> structure1 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  877</span>        structure1 = generate_binary_structure(input.ndim, 1)</div>
<div class="line"><span class="lineno">  878</span>    <span class="keywordflow">if</span> structure2 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  879</span>        structure2 = numpy.logical_not(structure1)</div>
<div class="line"><span class="lineno">  880</span>    origin1 = _ni_support._normalize_sequence(origin1, input.ndim)</div>
<div class="line"><span class="lineno">  881</span>    <span class="keywordflow">if</span> origin2 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  882</span>        origin2 = origin1</div>
<div class="line"><span class="lineno">  883</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  884</span>        origin2 = _ni_support._normalize_sequence(origin2, input.ndim)</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>    tmp1 = _binary_erosion(input, structure1, 1, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, 0, origin1,</div>
<div class="line"><span class="lineno">  887</span>                           0, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  888</span>    inplace = isinstance(output, numpy.ndarray)</div>
<div class="line"><span class="lineno">  889</span>    result = _binary_erosion(input, structure2, 1, <span class="keywordtype">None</span>, output, 0,</div>
<div class="line"><span class="lineno">  890</span>                             origin2, 1, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  891</span>    <span class="keywordflow">if</span> inplace:</div>
<div class="line"><span class="lineno">  892</span>        numpy.logical_not(output, output)</div>
<div class="line"><span class="lineno">  893</span>        numpy.logical_and(tmp1, output, output)</div>
<div class="line"><span class="lineno">  894</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  895</span>        numpy.logical_not(result, result)</div>
<div class="line"><span class="lineno">  896</span>        <span class="keywordflow">return</span> numpy.logical_and(tmp1, result)</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3cf7eda4cc0b9e687f14c5eb1ccaf023" name="a3cf7eda4cc0b9e687f14c5eb1ccaf023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf7eda4cc0b9e687f14c5eb1ccaf023">&#9670;&#160;</a></span>binary_opening()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.binary_opening </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>border_value</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>brute_force</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional binary opening with the given structuring element.

The *opening* of an input image by a structuring element is the
*dilation* of the *erosion* of the image by the structuring element.

Parameters
----------
input : array_like
    Binary array_like to be opened. Non-zero (True) elements form
    the subset to be opened.
structure : array_like, optional
    Structuring element used for the opening. Non-zero elements are
    considered True. If no structuring element is provided an element
    is generated with a square connectivity equal to one (i.e., only
    nearest neighbors are connected to the center, diagonally-connected
    elements are not considered neighbors).
iterations : int, optional
    The erosion step of the opening, then the dilation step are each
    repeated `iterations` times (one, by default). If `iterations` is
    less than 1, each operation is repeated until the result does
    not change anymore. Only an integer of iterations is accepted.
output : ndarray, optional
    Array of the same shape as input, into which the output is placed.
    By default, a new array is created.
origin : int or tuple of ints, optional
    Placement of the filter, by default 0.
mask : array_like, optional
    If a mask is given, only those elements with a True value at
    the corresponding mask element are modified at each iteration.

    .. versionadded:: 1.1.0
border_value : int (cast to 0 or 1), optional
    Value at the border in the output array.

    .. versionadded:: 1.1.0
brute_force : boolean, optional
    Memory condition: if False, only the pixels whose value was changed in
    the last iteration are tracked as candidates to be updated in the
    current iteration; if true all pixels are considered as candidates for
    update, regardless of what happened in the previous iteration.
    False by default.

    .. versionadded:: 1.1.0

Returns
-------
binary_opening : ndarray of bools
    Opening of the input by the structuring element.

See also
--------
grey_opening, binary_closing, binary_erosion, binary_dilation,
generate_binary_structure

Notes
-----
*Opening* [1]_ is a mathematical morphology operation [2]_ that
consists in the succession of an erosion and a dilation of the
input with the same structuring element. Opening, therefore, removes
objects smaller than the structuring element.

Together with *closing* (`binary_closing`), opening can be used for
noise removal.

References
----------
.. [1] https://en.wikipedia.org/wiki/Opening_%28morphology%29
.. [2] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((5,5), dtype=int)
&gt;&gt;&gt; a[1:4, 1:4] = 1; a[4, 4] = 1
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 0, 0, 1]])
&gt;&gt;&gt; # Opening removes small objects
&gt;&gt;&gt; ndimage.binary_opening(a, structure=np.ones((3,3))).astype(int)
array([[0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0]])
&gt;&gt;&gt; # Opening can also smooth corners
&gt;&gt;&gt; ndimage.binary_opening(a).astype(int)
array([[0, 0, 0, 0, 0],
       [0, 0, 1, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0]])
&gt;&gt;&gt; # Opening is the dilation of the erosion of the input
&gt;&gt;&gt; ndimage.binary_erosion(a).astype(int)
array([[0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.binary_dilation(ndimage.binary_erosion(a)).astype(int)
array([[0, 0, 0, 0, 0],
       [0, 0, 1, 0, 0],
       [0, 1, 1, 1, 0],
       [0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno">  522</span>                   origin=0, mask=<span class="keywordtype">None</span>, border_value=0, brute_force=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  523</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">    Multidimensional binary opening with the given structuring element.</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">    The *opening* of an input image by a structuring element is the</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    *dilation* of the *erosion* of the image by the structuring element.</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">        Binary array_like to be opened. Non-zero (True) elements form</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">        the subset to be opened.</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">    structure : array_like, optional</span></div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral">        Structuring element used for the opening. Non-zero elements are</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">        considered True. If no structuring element is provided an element</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral">        is generated with a square connectivity equal to one (i.e., only</span></div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral">        nearest neighbors are connected to the center, diagonally-connected</span></div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">        elements are not considered neighbors).</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral">    iterations : int, optional</span></div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">        The erosion step of the opening, then the dilation step are each</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">        repeated `iterations` times (one, by default). If `iterations` is</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral">        less than 1, each operation is repeated until the result does</span></div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">        not change anymore. Only an integer of iterations is accepted.</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">        Array of the same shape as input, into which the output is placed.</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">        By default, a new array is created.</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">    origin : int or tuple of ints, optional</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">        Placement of the filter, by default 0.</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">    mask : array_like, optional</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">        If a mask is given, only those elements with a True value at</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">        the corresponding mask element are modified at each iteration.</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">        .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">    border_value : int (cast to 0 or 1), optional</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">        Value at the border in the output array.</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">        .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">    brute_force : boolean, optional</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">        Memory condition: if False, only the pixels whose value was changed in</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        the last iteration are tracked as candidates to be updated in the</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">        current iteration; if true all pixels are considered as candidates for</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">        update, regardless of what happened in the previous iteration.</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">        False by default.</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">        .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">    binary_opening : ndarray of bools</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">        Opening of the input by the structuring element.</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">    grey_opening, binary_closing, binary_erosion, binary_dilation,</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">    generate_binary_structure</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">    *Opening* [1]_ is a mathematical morphology operation [2]_ that</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">    consists in the succession of an erosion and a dilation of the</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">    input with the same structuring element. Opening, therefore, removes</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral">    objects smaller than the structuring element.</span></div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">    Together with *closing* (`binary_closing`), opening can be used for</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">    noise removal.</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Opening_%28morphology%29</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral">    .. [2] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((5,5), dtype=int)</span></div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral">    &gt;&gt;&gt; a[1:4, 1:4] = 1; a[4, 4] = 1</span></div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">           [0, 0, 0, 0, 1]])</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">    &gt;&gt;&gt; # Opening removes small objects</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_opening(a, structure=np.ones((3,3))).astype(int)</span></div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">    &gt;&gt;&gt; # Opening can also smooth corners</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_opening(a).astype(int)</span></div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  615</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  616</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  617</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">    &gt;&gt;&gt; # Opening is the dilation of the erosion of the input</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_erosion(a).astype(int)</span></div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral">           [0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral">           [0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_dilation(ndimage.binary_erosion(a)).astype(int)</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  633</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno">  634</span>    <span class="keywordflow">if</span> structure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  635</span>        rank = input.ndim</div>
<div class="line"><span class="lineno">  636</span>        structure = generate_binary_structure(rank, 1)</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>    tmp = binary_erosion(input, structure, iterations, mask, <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  639</span>                         border_value, origin, brute_force)</div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordflow">return</span> binary_dilation(tmp, structure, iterations, mask, output,</div>
<div class="line"><span class="lineno">  641</span>                           border_value, origin, brute_force)</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a064495983f3cea84941fba854c6b4212" name="a064495983f3cea84941fba854c6b4212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a064495983f3cea84941fba854c6b4212">&#9670;&#160;</a></span>binary_propagation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.binary_propagation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>border_value</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional binary propagation with the given structuring element.

Parameters
----------
input : array_like
    Binary image to be propagated inside `mask`.
structure : array_like, optional
    Structuring element used in the successive dilations. The output
    may depend on the structuring element, especially if `mask` has
    several connex components. If no structuring element is
    provided, an element is generated with a squared connectivity equal
    to one.
mask : array_like, optional
    Binary mask defining the region into which `input` is allowed to
    propagate.
output : ndarray, optional
    Array of the same shape as input, into which the output is placed.
    By default, a new array is created.
border_value : int (cast to 0 or 1), optional
    Value at the border in the output array.
origin : int or tuple of ints, optional
    Placement of the filter, by default 0.

Returns
-------
binary_propagation : ndarray
    Binary propagation of `input` inside `mask`.

Notes
-----
This function is functionally equivalent to calling binary_dilation
with the number of iterations less than one: iterative dilation until
the result does not change anymore.

The succession of an erosion and propagation inside the original image
can be used instead of an *opening* for deleting small objects while
keeping the contours of larger objects untouched.

References
----------
.. [1] http://cmm.ensmp.fr/~serra/cours/pdf/en/ch6en.pdf, slide 15.
.. [2] I.T. Young, J.J. Gerbrands, and L.J. van Vliet, "Fundamentals of
    image processing", 1998
    ftp://qiftp.tudelft.nl/DIPimage/docs/FIP2.3.pdf

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; input = np.zeros((8, 8), dtype=int)
&gt;&gt;&gt; input[2, 2] = 1
&gt;&gt;&gt; mask = np.zeros((8, 8), dtype=int)
&gt;&gt;&gt; mask[1:4, 1:4] = mask[4, 4]  = mask[6:8, 6:8] = 1
&gt;&gt;&gt; input
array([[0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; mask
array([[0, 0, 0, 0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 1, 1],
       [0, 0, 0, 0, 0, 0, 1, 1]])
&gt;&gt;&gt; ndimage.binary_propagation(input, mask=mask).astype(int)
array([[0, 0, 0, 0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.binary_propagation(input, mask=mask,\\
... structure=np.ones((3,3))).astype(int)
array([[0, 0, 0, 0, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 1, 1, 1, 0, 0, 0, 0],
       [0, 0, 0, 0, 1, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0]])

&gt;&gt;&gt; # Comparison between opening and erosion+propagation
&gt;&gt;&gt; a = np.zeros((6,6), dtype=int)
&gt;&gt;&gt; a[2:5, 2:5] = 1; a[0, 0] = 1; a[5, 5] = 1
&gt;&gt;&gt; a
array([[1, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0],
       [0, 0, 1, 1, 1, 0],
       [0, 0, 1, 1, 1, 0],
       [0, 0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0, 1]])
&gt;&gt;&gt; ndimage.binary_opening(a).astype(int)
array([[0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0],
       [0, 0, 0, 1, 0, 0],
       [0, 0, 1, 1, 1, 0],
       [0, 0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; b = ndimage.binary_erosion(a)
&gt;&gt;&gt; b.astype(int)
array([[0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0],
       [0, 0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.binary_propagation(b, mask=a).astype(int)
array([[0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0],
       [0, 0, 1, 1, 1, 0],
       [0, 0, 1, 1, 1, 0],
       [0, 0, 1, 1, 1, 0],
       [0, 0, 0, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno">  900</span>                       output=<span class="keywordtype">None</span>, border_value=0, origin=0):</div>
<div class="line"><span class="lineno">  901</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">    Multidimensional binary propagation with the given structuring element.</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">        Binary image to be propagated inside `mask`.</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">    structure : array_like, optional</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral">        Structuring element used in the successive dilations. The output</span></div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">        may depend on the structuring element, especially if `mask` has</span></div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral">        several connex components. If no structuring element is</span></div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">        provided, an element is generated with a squared connectivity equal</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral">        to one.</span></div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">    mask : array_like, optional</span></div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral">        Binary mask defining the region into which `input` is allowed to</span></div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral">        propagate.</span></div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">        Array of the same shape as input, into which the output is placed.</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">        By default, a new array is created.</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral">    border_value : int (cast to 0 or 1), optional</span></div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral">        Value at the border in the output array.</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">    origin : int or tuple of ints, optional</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral">        Placement of the filter, by default 0.</span></div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">    binary_propagation : ndarray</span></div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral">        Binary propagation of `input` inside `mask`.</span></div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral">    This function is functionally equivalent to calling binary_dilation</span></div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral">    with the number of iterations less than one: iterative dilation until</span></div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral">    the result does not change anymore.</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">    The succession of an erosion and propagation inside the original image</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">    can be used instead of an *opening* for deleting small objects while</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral">    keeping the contours of larger objects untouched.</span></div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  940</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  941</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  942</span><span class="stringliteral">    .. [1] http://cmm.ensmp.fr/~serra/cours/pdf/en/ch6en.pdf, slide 15.</span></div>
<div class="line"><span class="lineno">  943</span><span class="stringliteral">    .. [2] I.T. Young, J.J. Gerbrands, and L.J. van Vliet, &quot;Fundamentals of</span></div>
<div class="line"><span class="lineno">  944</span><span class="stringliteral">        image processing&quot;, 1998</span></div>
<div class="line"><span class="lineno">  945</span><span class="stringliteral">        ftp://qiftp.tudelft.nl/DIPimage/docs/FIP2.3.pdf</span></div>
<div class="line"><span class="lineno">  946</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">    &gt;&gt;&gt; input = np.zeros((8, 8), dtype=int)</span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    &gt;&gt;&gt; input[2, 2] = 1</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">    &gt;&gt;&gt; mask = np.zeros((8, 8), dtype=int)</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral">    &gt;&gt;&gt; mask[1:4, 1:4] = mask[4, 4]  = mask[6:8, 6:8] = 1</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">    &gt;&gt;&gt; input</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">           [0, 0, 1, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">    &gt;&gt;&gt; mask</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  967</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  968</span><span class="stringliteral">           [0, 0, 0, 0, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  969</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 1, 1],</span></div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 1, 1]])</span></div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_propagation(input, mask=mask).astype(int)</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_propagation(input, mask=mask,\\</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">    ... structure=np.ones((3,3))).astype(int)</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral">           [0, 1, 1, 1, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">           [0, 0, 0, 0, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">    &gt;&gt;&gt; # Comparison between opening and erosion+propagation</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((6,6), dtype=int)</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">    &gt;&gt;&gt; a[2:5, 2:5] = 1; a[0, 0] = 1; a[5, 5] = 1</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">    array([[1, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1001</span><span class="stringliteral">           [0, 0, 0, 0, 0, 1]])</span></div>
<div class="line"><span class="lineno"> 1002</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_opening(a).astype(int)</span></div>
<div class="line"><span class="lineno"> 1003</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1004</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1006</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1007</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1008</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1009</span><span class="stringliteral">    &gt;&gt;&gt; b = ndimage.binary_erosion(a)</span></div>
<div class="line"><span class="lineno"> 1010</span><span class="stringliteral">    &gt;&gt;&gt; b.astype(int)</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1016</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1017</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_propagation(b, mask=a).astype(int)</span></div>
<div class="line"><span class="lineno"> 1018</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1019</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1026</span>    <span class="keywordflow">return</span> binary_dilation(input, structure, -1, mask, output,</div>
<div class="line"><span class="lineno"> 1027</span>                           border_value, origin)</div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a72f0812aaf64f0ecf601fe13285a0773" name="a72f0812aaf64f0ecf601fe13285a0773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72f0812aaf64f0ecf601fe13285a0773">&#9670;&#160;</a></span>black_tophat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.black_tophat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>footprint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>&quot;reflect&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cval</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional black tophat filter.

Parameters
----------
input : array_like
    Input.
size : tuple of ints, optional
    Shape of a flat and full structuring element used for the filter.
    Optional if `footprint` or `structure` is provided.
footprint : array of ints, optional
    Positions of non-infinite elements of a flat structuring element
    used for the black tophat filter.
structure : array of ints, optional
    Structuring element used for the filter. `structure`
    may be a non-flat structuring element.
output : array, optional
    An array used for storing the output of the filter may be provided.
mode : {'reflect', 'constant', 'nearest', 'mirror', 'wrap'}, optional
    The `mode` parameter determines how the array borders are
    handled, where `cval` is the value when mode is equal to
    'constant'. Default is 'reflect'
cval : scalar, optional
    Value to fill past edges of input if `mode` is 'constant'. Default
    is 0.0.
origin : scalar, optional
    The `origin` parameter controls the placement of the filter.
    Default 0

Returns
-------
black_tophat : ndarray
    Result of the filter of `input` with `structure`.

Examples
--------
Change dark peak to bright peak and subtract background.

&gt;&gt;&gt; from scipy.ndimage import generate_binary_structure, black_tophat
&gt;&gt;&gt; square = generate_binary_structure(rank=2, connectivity=3)
&gt;&gt;&gt; dark_on_gray = np.array([[7, 6, 6, 6, 7],
...                          [6, 5, 4, 5, 6],
...                          [6, 4, 0, 4, 6],
...                          [6, 5, 4, 5, 6],
...                          [7, 6, 6, 6, 7]])
&gt;&gt;&gt; black_tophat(input=dark_on_gray, structure=square)
array([[0, 0, 0, 0, 0],
       [0, 0, 1, 0, 0],
       [0, 1, 5, 1, 0],
       [0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0]])

See also
--------
white_tophat, grey_opening, grey_closing</pre> <div class="fragment"><div class="line"><span class="lineno"> 1779</span>                 cval=0.0, origin=0):</div>
<div class="line"><span class="lineno"> 1780</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1781</span><span class="stringliteral">    Multidimensional black tophat filter.</span></div>
<div class="line"><span class="lineno"> 1782</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1783</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1784</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1785</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1786</span><span class="stringliteral">        Input.</span></div>
<div class="line"><span class="lineno"> 1787</span><span class="stringliteral">    size : tuple of ints, optional</span></div>
<div class="line"><span class="lineno"> 1788</span><span class="stringliteral">        Shape of a flat and full structuring element used for the filter.</span></div>
<div class="line"><span class="lineno"> 1789</span><span class="stringliteral">        Optional if `footprint` or `structure` is provided.</span></div>
<div class="line"><span class="lineno"> 1790</span><span class="stringliteral">    footprint : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1791</span><span class="stringliteral">        Positions of non-infinite elements of a flat structuring element</span></div>
<div class="line"><span class="lineno"> 1792</span><span class="stringliteral">        used for the black tophat filter.</span></div>
<div class="line"><span class="lineno"> 1793</span><span class="stringliteral">    structure : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1794</span><span class="stringliteral">        Structuring element used for the filter. `structure`</span></div>
<div class="line"><span class="lineno"> 1795</span><span class="stringliteral">        may be a non-flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1796</span><span class="stringliteral">    output : array, optional</span></div>
<div class="line"><span class="lineno"> 1797</span><span class="stringliteral">        An array used for storing the output of the filter may be provided.</span></div>
<div class="line"><span class="lineno"> 1798</span><span class="stringliteral">    mode : {&#39;reflect&#39;, &#39;constant&#39;, &#39;nearest&#39;, &#39;mirror&#39;, &#39;wrap&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1799</span><span class="stringliteral">        The `mode` parameter determines how the array borders are</span></div>
<div class="line"><span class="lineno"> 1800</span><span class="stringliteral">        handled, where `cval` is the value when mode is equal to</span></div>
<div class="line"><span class="lineno"> 1801</span><span class="stringliteral">        &#39;constant&#39;. Default is &#39;reflect&#39;</span></div>
<div class="line"><span class="lineno"> 1802</span><span class="stringliteral">    cval : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1803</span><span class="stringliteral">        Value to fill past edges of input if `mode` is &#39;constant&#39;. Default</span></div>
<div class="line"><span class="lineno"> 1804</span><span class="stringliteral">        is 0.0.</span></div>
<div class="line"><span class="lineno"> 1805</span><span class="stringliteral">    origin : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1806</span><span class="stringliteral">        The `origin` parameter controls the placement of the filter.</span></div>
<div class="line"><span class="lineno"> 1807</span><span class="stringliteral">        Default 0</span></div>
<div class="line"><span class="lineno"> 1808</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1809</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1810</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1811</span><span class="stringliteral">    black_tophat : ndarray</span></div>
<div class="line"><span class="lineno"> 1812</span><span class="stringliteral">        Result of the filter of `input` with `structure`.</span></div>
<div class="line"><span class="lineno"> 1813</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1814</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1815</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1816</span><span class="stringliteral">    Change dark peak to bright peak and subtract background.</span></div>
<div class="line"><span class="lineno"> 1817</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1818</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.ndimage import generate_binary_structure, black_tophat</span></div>
<div class="line"><span class="lineno"> 1819</span><span class="stringliteral">    &gt;&gt;&gt; square = generate_binary_structure(rank=2, connectivity=3)</span></div>
<div class="line"><span class="lineno"> 1820</span><span class="stringliteral">    &gt;&gt;&gt; dark_on_gray = np.array([[7, 6, 6, 6, 7],</span></div>
<div class="line"><span class="lineno"> 1821</span><span class="stringliteral">    ...                          [6, 5, 4, 5, 6],</span></div>
<div class="line"><span class="lineno"> 1822</span><span class="stringliteral">    ...                          [6, 4, 0, 4, 6],</span></div>
<div class="line"><span class="lineno"> 1823</span><span class="stringliteral">    ...                          [6, 5, 4, 5, 6],</span></div>
<div class="line"><span class="lineno"> 1824</span><span class="stringliteral">    ...                          [7, 6, 6, 6, 7]])</span></div>
<div class="line"><span class="lineno"> 1825</span><span class="stringliteral">    &gt;&gt;&gt; black_tophat(input=dark_on_gray, structure=square)</span></div>
<div class="line"><span class="lineno"> 1826</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1827</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1828</span><span class="stringliteral">           [0, 1, 5, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1829</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1830</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1831</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1832</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1833</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1834</span><span class="stringliteral">    white_tophat, grey_opening, grey_closing</span></div>
<div class="line"><span class="lineno"> 1835</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1836</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1837</span>    <span class="keywordflow">if</span> (size <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>) <span class="keywordflow">and</span> (footprint <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1838</span>        warnings.warn(<span class="stringliteral">&quot;ignoring size because footprint is set&quot;</span>, UserWarning, stacklevel=2)</div>
<div class="line"><span class="lineno"> 1839</span>    tmp = grey_dilation(input, size, footprint, structure, <span class="keywordtype">None</span>, mode,</div>
<div class="line"><span class="lineno"> 1840</span>                        cval, origin)</div>
<div class="line"><span class="lineno"> 1841</span>    tmp = grey_erosion(tmp, size, footprint, structure, output, mode,</div>
<div class="line"><span class="lineno"> 1842</span>                       cval, origin)</div>
<div class="line"><span class="lineno"> 1843</span>    <span class="keywordflow">if</span> tmp <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1844</span>        tmp = output</div>
<div class="line"><span class="lineno"> 1845</span> </div>
<div class="line"><span class="lineno"> 1846</span>    <span class="keywordflow">if</span> input.dtype == numpy.bool_ <span class="keywordflow">and</span> tmp.dtype == numpy.bool_:</div>
<div class="line"><span class="lineno"> 1847</span>        numpy.bitwise_xor(tmp, input, out=tmp)</div>
<div class="line"><span class="lineno"> 1848</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1849</span>        numpy.subtract(tmp, input, out=tmp)</div>
<div class="line"><span class="lineno"> 1850</span>    <span class="keywordflow">return</span> tmp</div>
<div class="line"><span class="lineno"> 1851</span> </div>
<div class="line"><span class="lineno"> 1852</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aee604cc266e7e18fdd063bbbb4982b3a" name="aee604cc266e7e18fdd063bbbb4982b3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee604cc266e7e18fdd063bbbb4982b3a">&#9670;&#160;</a></span>distance_transform_bf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.distance_transform_bf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em> = <code>&quot;euclidean&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sampling</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_distances</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_indices</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distances</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>indices</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Distance transform function by a brute force algorithm.

This function calculates the distance transform of the `input`, by
replacing each foreground (non-zero) element, with its
shortest distance to the background (any zero-valued element).

In addition to the distance transform, the feature transform can
be calculated. In this case the index of the closest background
element to each foreground element is returned in a separate array.

Parameters
----------
input : array_like
    Input
metric : {'euclidean', 'taxicab', 'chessboard'}, optional
    'cityblock' and 'manhattan' are also valid, and map to 'taxicab'.
    The default is 'euclidean'.
sampling : float, or sequence of float, optional
    This parameter is only used when `metric` is 'euclidean'.
    Spacing of elements along each dimension. If a sequence, must be of
    length equal to the input rank; if a single number, this is used for
    all axes. If not specified, a grid spacing of unity is implied.
return_distances : bool, optional
    Whether to calculate the distance transform.
    Default is True.
return_indices : bool, optional
    Whether to calculate the feature transform.
    Default is False.
distances : ndarray, optional
    An output array to store the calculated distance transform, instead of
    returning it.
    `return_distances` must be True.
    It must be the same shape as `input`, and of type float64 if `metric`
    is 'euclidean', uint32 otherwise.
indices : int32 ndarray, optional
    An output array to store the calculated feature transform, instead of
    returning it.
    `return_indicies` must be True.
    Its shape must be `(input.ndim,) + input.shape`.

Returns
-------
distances : ndarray, optional
    The calculated distance transform. Returned only when
    `return_distances` is True and `distances` is not supplied.
    It will have the same shape as the input array.
indices : int32 ndarray, optional
    The calculated feature transform. It has an input-shaped array for each
    dimension of the input. See distance_transform_edt documentation for an
    example.
    Returned only when `return_indices` is True and `indices` is not
    supplied.

Notes
-----
This function employs a slow brute force algorithm, see also the
function distance_transform_cdt for more efficient taxicab and
chessboard algorithms.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1855</span>                          distances=<span class="keywordtype">None</span>, indices=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1856</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1857</span><span class="stringliteral">    Distance transform function by a brute force algorithm.</span></div>
<div class="line"><span class="lineno"> 1858</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1859</span><span class="stringliteral">    This function calculates the distance transform of the `input`, by</span></div>
<div class="line"><span class="lineno"> 1860</span><span class="stringliteral">    replacing each foreground (non-zero) element, with its</span></div>
<div class="line"><span class="lineno"> 1861</span><span class="stringliteral">    shortest distance to the background (any zero-valued element).</span></div>
<div class="line"><span class="lineno"> 1862</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1863</span><span class="stringliteral">    In addition to the distance transform, the feature transform can</span></div>
<div class="line"><span class="lineno"> 1864</span><span class="stringliteral">    be calculated. In this case the index of the closest background</span></div>
<div class="line"><span class="lineno"> 1865</span><span class="stringliteral">    element to each foreground element is returned in a separate array.</span></div>
<div class="line"><span class="lineno"> 1866</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1867</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1868</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1869</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1870</span><span class="stringliteral">        Input</span></div>
<div class="line"><span class="lineno"> 1871</span><span class="stringliteral">    metric : {&#39;euclidean&#39;, &#39;taxicab&#39;, &#39;chessboard&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1872</span><span class="stringliteral">        &#39;cityblock&#39; and &#39;manhattan&#39; are also valid, and map to &#39;taxicab&#39;.</span></div>
<div class="line"><span class="lineno"> 1873</span><span class="stringliteral">        The default is &#39;euclidean&#39;.</span></div>
<div class="line"><span class="lineno"> 1874</span><span class="stringliteral">    sampling : float, or sequence of float, optional</span></div>
<div class="line"><span class="lineno"> 1875</span><span class="stringliteral">        This parameter is only used when `metric` is &#39;euclidean&#39;.</span></div>
<div class="line"><span class="lineno"> 1876</span><span class="stringliteral">        Spacing of elements along each dimension. If a sequence, must be of</span></div>
<div class="line"><span class="lineno"> 1877</span><span class="stringliteral">        length equal to the input rank; if a single number, this is used for</span></div>
<div class="line"><span class="lineno"> 1878</span><span class="stringliteral">        all axes. If not specified, a grid spacing of unity is implied.</span></div>
<div class="line"><span class="lineno"> 1879</span><span class="stringliteral">    return_distances : bool, optional</span></div>
<div class="line"><span class="lineno"> 1880</span><span class="stringliteral">        Whether to calculate the distance transform.</span></div>
<div class="line"><span class="lineno"> 1881</span><span class="stringliteral">        Default is True.</span></div>
<div class="line"><span class="lineno"> 1882</span><span class="stringliteral">    return_indices : bool, optional</span></div>
<div class="line"><span class="lineno"> 1883</span><span class="stringliteral">        Whether to calculate the feature transform.</span></div>
<div class="line"><span class="lineno"> 1884</span><span class="stringliteral">        Default is False.</span></div>
<div class="line"><span class="lineno"> 1885</span><span class="stringliteral">    distances : ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1886</span><span class="stringliteral">        An output array to store the calculated distance transform, instead of</span></div>
<div class="line"><span class="lineno"> 1887</span><span class="stringliteral">        returning it.</span></div>
<div class="line"><span class="lineno"> 1888</span><span class="stringliteral">        `return_distances` must be True.</span></div>
<div class="line"><span class="lineno"> 1889</span><span class="stringliteral">        It must be the same shape as `input`, and of type float64 if `metric`</span></div>
<div class="line"><span class="lineno"> 1890</span><span class="stringliteral">        is &#39;euclidean&#39;, uint32 otherwise.</span></div>
<div class="line"><span class="lineno"> 1891</span><span class="stringliteral">    indices : int32 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1892</span><span class="stringliteral">        An output array to store the calculated feature transform, instead of</span></div>
<div class="line"><span class="lineno"> 1893</span><span class="stringliteral">        returning it.</span></div>
<div class="line"><span class="lineno"> 1894</span><span class="stringliteral">        `return_indicies` must be True.</span></div>
<div class="line"><span class="lineno"> 1895</span><span class="stringliteral">        Its shape must be `(input.ndim,) + input.shape`.</span></div>
<div class="line"><span class="lineno"> 1896</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1897</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1898</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1899</span><span class="stringliteral">    distances : ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1900</span><span class="stringliteral">        The calculated distance transform. Returned only when</span></div>
<div class="line"><span class="lineno"> 1901</span><span class="stringliteral">        `return_distances` is True and `distances` is not supplied.</span></div>
<div class="line"><span class="lineno"> 1902</span><span class="stringliteral">        It will have the same shape as the input array.</span></div>
<div class="line"><span class="lineno"> 1903</span><span class="stringliteral">    indices : int32 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1904</span><span class="stringliteral">        The calculated feature transform. It has an input-shaped array for each</span></div>
<div class="line"><span class="lineno"> 1905</span><span class="stringliteral">        dimension of the input. See distance_transform_edt documentation for an</span></div>
<div class="line"><span class="lineno"> 1906</span><span class="stringliteral">        example.</span></div>
<div class="line"><span class="lineno"> 1907</span><span class="stringliteral">        Returned only when `return_indices` is True and `indices` is not</span></div>
<div class="line"><span class="lineno"> 1908</span><span class="stringliteral">        supplied.</span></div>
<div class="line"><span class="lineno"> 1909</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1910</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1911</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1912</span><span class="stringliteral">    This function employs a slow brute force algorithm, see also the</span></div>
<div class="line"><span class="lineno"> 1913</span><span class="stringliteral">    function distance_transform_cdt for more efficient taxicab and</span></div>
<div class="line"><span class="lineno"> 1914</span><span class="stringliteral">    chessboard algorithms.</span></div>
<div class="line"><span class="lineno"> 1915</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1916</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1917</span>    ft_inplace = isinstance(indices, numpy.ndarray)</div>
<div class="line"><span class="lineno"> 1918</span>    dt_inplace = isinstance(distances, numpy.ndarray)</div>
<div class="line"><span class="lineno"> 1919</span>    _distance_tranform_arg_check(</div>
<div class="line"><span class="lineno"> 1920</span>        dt_inplace, ft_inplace, return_distances, return_indices</div>
<div class="line"><span class="lineno"> 1921</span>    )</div>
<div class="line"><span class="lineno"> 1922</span> </div>
<div class="line"><span class="lineno"> 1923</span>    tmp1 = numpy.asarray(input) != 0</div>
<div class="line"><span class="lineno"> 1924</span>    struct = generate_binary_structure(tmp1.ndim, tmp1.ndim)</div>
<div class="line"><span class="lineno"> 1925</span>    tmp2 = binary_dilation(tmp1, struct)</div>
<div class="line"><span class="lineno"> 1926</span>    tmp2 = numpy.logical_xor(tmp1, tmp2)</div>
<div class="line"><span class="lineno"> 1927</span>    tmp1 = tmp1.astype(numpy.int8) - tmp2.astype(numpy.int8)</div>
<div class="line"><span class="lineno"> 1928</span>    metric = metric.lower()</div>
<div class="line"><span class="lineno"> 1929</span>    <span class="keywordflow">if</span> metric == <span class="stringliteral">&#39;euclidean&#39;</span>:</div>
<div class="line"><span class="lineno"> 1930</span>        metric = 1</div>
<div class="line"><span class="lineno"> 1931</span>    <span class="keywordflow">elif</span> metric <span class="keywordflow">in</span> [<span class="stringliteral">&#39;taxicab&#39;</span>, <span class="stringliteral">&#39;cityblock&#39;</span>, <span class="stringliteral">&#39;manhattan&#39;</span>]:</div>
<div class="line"><span class="lineno"> 1932</span>        metric = 2</div>
<div class="line"><span class="lineno"> 1933</span>    <span class="keywordflow">elif</span> metric == <span class="stringliteral">&#39;chessboard&#39;</span>:</div>
<div class="line"><span class="lineno"> 1934</span>        metric = 3</div>
<div class="line"><span class="lineno"> 1935</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1936</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;distance metric not supported&#39;</span>)</div>
<div class="line"><span class="lineno"> 1937</span>    <span class="keywordflow">if</span> sampling <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1938</span>        sampling = _ni_support._normalize_sequence(sampling, tmp1.ndim)</div>
<div class="line"><span class="lineno"> 1939</span>        sampling = numpy.asarray(sampling, dtype=numpy.float64)</div>
<div class="line"><span class="lineno"> 1940</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> sampling.flags.contiguous:</div>
<div class="line"><span class="lineno"> 1941</span>            sampling = sampling.copy()</div>
<div class="line"><span class="lineno"> 1942</span>    <span class="keywordflow">if</span> return_indices:</div>
<div class="line"><span class="lineno"> 1943</span>        ft = numpy.zeros(tmp1.shape, dtype=numpy.int32)</div>
<div class="line"><span class="lineno"> 1944</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1945</span>        ft = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1946</span>    <span class="keywordflow">if</span> return_distances:</div>
<div class="line"><span class="lineno"> 1947</span>        <span class="keywordflow">if</span> distances <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1948</span>            <span class="keywordflow">if</span> metric == 1:</div>
<div class="line"><span class="lineno"> 1949</span>                dt = numpy.zeros(tmp1.shape, dtype=numpy.float64)</div>
<div class="line"><span class="lineno"> 1950</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1951</span>                dt = numpy.zeros(tmp1.shape, dtype=numpy.uint32)</div>
<div class="line"><span class="lineno"> 1952</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1953</span>            <span class="keywordflow">if</span> distances.shape != tmp1.shape:</div>
<div class="line"><span class="lineno"> 1954</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;distances array has wrong shape&#39;</span>)</div>
<div class="line"><span class="lineno"> 1955</span>            <span class="keywordflow">if</span> metric == 1:</div>
<div class="line"><span class="lineno"> 1956</span>                <span class="keywordflow">if</span> distances.dtype.type != numpy.float64:</div>
<div class="line"><span class="lineno"> 1957</span>                    <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;distances array must be float64&#39;</span>)</div>
<div class="line"><span class="lineno"> 1958</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1959</span>                <span class="keywordflow">if</span> distances.dtype.type != numpy.uint32:</div>
<div class="line"><span class="lineno"> 1960</span>                    <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;distances array must be uint32&#39;</span>)</div>
<div class="line"><span class="lineno"> 1961</span>            dt = distances</div>
<div class="line"><span class="lineno"> 1962</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1963</span>        dt = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1964</span> </div>
<div class="line"><span class="lineno"> 1965</span>    _nd_image.distance_transform_bf(tmp1, metric, sampling, dt, ft)</div>
<div class="line"><span class="lineno"> 1966</span>    <span class="keywordflow">if</span> return_indices:</div>
<div class="line"><span class="lineno"> 1967</span>        <span class="keywordflow">if</span> isinstance(indices, numpy.ndarray):</div>
<div class="line"><span class="lineno"> 1968</span>            <span class="keywordflow">if</span> indices.dtype.type != numpy.int32:</div>
<div class="line"><span class="lineno"> 1969</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;indices array must be int32&#39;</span>)</div>
<div class="line"><span class="lineno"> 1970</span>            <span class="keywordflow">if</span> indices.shape != (tmp1.ndim,) + tmp1.shape:</div>
<div class="line"><span class="lineno"> 1971</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;indices array has wrong shape&#39;</span>)</div>
<div class="line"><span class="lineno"> 1972</span>            tmp2 = indices</div>
<div class="line"><span class="lineno"> 1973</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1974</span>            tmp2 = numpy.indices(tmp1.shape, dtype=numpy.int32)</div>
<div class="line"><span class="lineno"> 1975</span>        ft = numpy.ravel(ft)</div>
<div class="line"><span class="lineno"> 1976</span>        <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(tmp2.shape[0]):</div>
<div class="line"><span class="lineno"> 1977</span>            rtmp = numpy.ravel(tmp2[ii, ...])[ft]</div>
<div class="line"><span class="lineno"> 1978</span>            rtmp.shape = tmp1.shape</div>
<div class="line"><span class="lineno"> 1979</span>            tmp2[ii, ...] = rtmp</div>
<div class="line"><span class="lineno"> 1980</span>        ft = tmp2</div>
<div class="line"><span class="lineno"> 1981</span> </div>
<div class="line"><span class="lineno"> 1982</span>    <span class="comment"># construct and return the result</span></div>
<div class="line"><span class="lineno"> 1983</span>    result = []</div>
<div class="line"><span class="lineno"> 1984</span>    <span class="keywordflow">if</span> return_distances <span class="keywordflow">and</span> <span class="keywordflow">not</span> dt_inplace:</div>
<div class="line"><span class="lineno"> 1985</span>        result.append(dt)</div>
<div class="line"><span class="lineno"> 1986</span>    <span class="keywordflow">if</span> return_indices <span class="keywordflow">and</span> <span class="keywordflow">not</span> ft_inplace:</div>
<div class="line"><span class="lineno"> 1987</span>        result.append(ft)</div>
<div class="line"><span class="lineno"> 1988</span> </div>
<div class="line"><span class="lineno"> 1989</span>    <span class="keywordflow">if</span> len(result) == 2:</div>
<div class="line"><span class="lineno"> 1990</span>        <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno"> 1991</span>    <span class="keywordflow">elif</span> len(result) == 1:</div>
<div class="line"><span class="lineno"> 1992</span>        <span class="keywordflow">return</span> result[0]</div>
<div class="line"><span class="lineno"> 1993</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1994</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1995</span> </div>
<div class="line"><span class="lineno"> 1996</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c50783191be8546186187b4a6fac0c4" name="a4c50783191be8546186187b4a6fac0c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c50783191be8546186187b4a6fac0c4">&#9670;&#160;</a></span>distance_transform_cdt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.distance_transform_cdt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em> = <code>'chessboard'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_distances</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_indices</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distances</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>indices</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Distance transform for chamfer type of transforms.

In addition to the distance transform, the feature transform can
be calculated. In this case the index of the closest background
element to each foreground element is returned in a separate array.

Parameters
----------
input : array_like
    Input
metric : {'chessboard', 'taxicab'} or array_like, optional
    The `metric` determines the type of chamfering that is done. If the
    `metric` is equal to 'taxicab' a structure is generated using
    generate_binary_structure with a squared distance equal to 1. If
    the `metric` is equal to 'chessboard', a `metric` is generated
    using generate_binary_structure with a squared distance equal to
    the dimensionality of the array. These choices correspond to the
    common interpretations of the 'taxicab' and the 'chessboard'
    distance metrics in two dimensions.
    A custom metric may be provided, in the form of a matrix where
    each dimension has a length of three.
    'cityblock' and 'manhattan' are also valid, and map to 'taxicab'.
    The default is 'chessboard'.
return_distances : bool, optional
    Whether to calculate the distance transform.
    Default is True.
return_indices : bool, optional
    Whether to calculate the feature transform.
    Default is False.
distances : int32 ndarray, optional
    An output array to store the calculated distance transform, instead of
    returning it.
    `return_distances` must be True.
    It must be the same shape as `input`.
indices : int32 ndarray, optional
    An output array to store the calculated feature transform, instead of
    returning it.
    `return_indicies` must be True.
    Its shape must be `(input.ndim,) + input.shape`.

Returns
-------
distances : int32 ndarray, optional
    The calculated distance transform. Returned only when
    `return_distances` is True, and `distances` is not supplied.
    It will have the same shape as the input array.
indices : int32 ndarray, optional
    The calculated feature transform. It has an input-shaped array for each
    dimension of the input. See distance_transform_edt documentation for an
    example.
    Returned only when `return_indices` is True, and `indices` is not
    supplied.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1998</span>                           return_indices=<span class="keyword">False</span>, distances=<span class="keywordtype">None</span>, indices=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1999</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2000</span><span class="stringliteral">    Distance transform for chamfer type of transforms.</span></div>
<div class="line"><span class="lineno"> 2001</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2002</span><span class="stringliteral">    In addition to the distance transform, the feature transform can</span></div>
<div class="line"><span class="lineno"> 2003</span><span class="stringliteral">    be calculated. In this case the index of the closest background</span></div>
<div class="line"><span class="lineno"> 2004</span><span class="stringliteral">    element to each foreground element is returned in a separate array.</span></div>
<div class="line"><span class="lineno"> 2005</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2006</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2007</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2008</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 2009</span><span class="stringliteral">        Input</span></div>
<div class="line"><span class="lineno"> 2010</span><span class="stringliteral">    metric : {&#39;chessboard&#39;, &#39;taxicab&#39;} or array_like, optional</span></div>
<div class="line"><span class="lineno"> 2011</span><span class="stringliteral">        The `metric` determines the type of chamfering that is done. If the</span></div>
<div class="line"><span class="lineno"> 2012</span><span class="stringliteral">        `metric` is equal to &#39;taxicab&#39; a structure is generated using</span></div>
<div class="line"><span class="lineno"> 2013</span><span class="stringliteral">        generate_binary_structure with a squared distance equal to 1. If</span></div>
<div class="line"><span class="lineno"> 2014</span><span class="stringliteral">        the `metric` is equal to &#39;chessboard&#39;, a `metric` is generated</span></div>
<div class="line"><span class="lineno"> 2015</span><span class="stringliteral">        using generate_binary_structure with a squared distance equal to</span></div>
<div class="line"><span class="lineno"> 2016</span><span class="stringliteral">        the dimensionality of the array. These choices correspond to the</span></div>
<div class="line"><span class="lineno"> 2017</span><span class="stringliteral">        common interpretations of the &#39;taxicab&#39; and the &#39;chessboard&#39;</span></div>
<div class="line"><span class="lineno"> 2018</span><span class="stringliteral">        distance metrics in two dimensions.</span></div>
<div class="line"><span class="lineno"> 2019</span><span class="stringliteral">        A custom metric may be provided, in the form of a matrix where</span></div>
<div class="line"><span class="lineno"> 2020</span><span class="stringliteral">        each dimension has a length of three.</span></div>
<div class="line"><span class="lineno"> 2021</span><span class="stringliteral">        &#39;cityblock&#39; and &#39;manhattan&#39; are also valid, and map to &#39;taxicab&#39;.</span></div>
<div class="line"><span class="lineno"> 2022</span><span class="stringliteral">        The default is &#39;chessboard&#39;.</span></div>
<div class="line"><span class="lineno"> 2023</span><span class="stringliteral">    return_distances : bool, optional</span></div>
<div class="line"><span class="lineno"> 2024</span><span class="stringliteral">        Whether to calculate the distance transform.</span></div>
<div class="line"><span class="lineno"> 2025</span><span class="stringliteral">        Default is True.</span></div>
<div class="line"><span class="lineno"> 2026</span><span class="stringliteral">    return_indices : bool, optional</span></div>
<div class="line"><span class="lineno"> 2027</span><span class="stringliteral">        Whether to calculate the feature transform.</span></div>
<div class="line"><span class="lineno"> 2028</span><span class="stringliteral">        Default is False.</span></div>
<div class="line"><span class="lineno"> 2029</span><span class="stringliteral">    distances : int32 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2030</span><span class="stringliteral">        An output array to store the calculated distance transform, instead of</span></div>
<div class="line"><span class="lineno"> 2031</span><span class="stringliteral">        returning it.</span></div>
<div class="line"><span class="lineno"> 2032</span><span class="stringliteral">        `return_distances` must be True.</span></div>
<div class="line"><span class="lineno"> 2033</span><span class="stringliteral">        It must be the same shape as `input`.</span></div>
<div class="line"><span class="lineno"> 2034</span><span class="stringliteral">    indices : int32 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2035</span><span class="stringliteral">        An output array to store the calculated feature transform, instead of</span></div>
<div class="line"><span class="lineno"> 2036</span><span class="stringliteral">        returning it.</span></div>
<div class="line"><span class="lineno"> 2037</span><span class="stringliteral">        `return_indicies` must be True.</span></div>
<div class="line"><span class="lineno"> 2038</span><span class="stringliteral">        Its shape must be `(input.ndim,) + input.shape`.</span></div>
<div class="line"><span class="lineno"> 2039</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2040</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2041</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2042</span><span class="stringliteral">    distances : int32 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2043</span><span class="stringliteral">        The calculated distance transform. Returned only when</span></div>
<div class="line"><span class="lineno"> 2044</span><span class="stringliteral">        `return_distances` is True, and `distances` is not supplied.</span></div>
<div class="line"><span class="lineno"> 2045</span><span class="stringliteral">        It will have the same shape as the input array.</span></div>
<div class="line"><span class="lineno"> 2046</span><span class="stringliteral">    indices : int32 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2047</span><span class="stringliteral">        The calculated feature transform. It has an input-shaped array for each</span></div>
<div class="line"><span class="lineno"> 2048</span><span class="stringliteral">        dimension of the input. See distance_transform_edt documentation for an</span></div>
<div class="line"><span class="lineno"> 2049</span><span class="stringliteral">        example.</span></div>
<div class="line"><span class="lineno"> 2050</span><span class="stringliteral">        Returned only when `return_indices` is True, and `indices` is not</span></div>
<div class="line"><span class="lineno"> 2051</span><span class="stringliteral">        supplied.</span></div>
<div class="line"><span class="lineno"> 2052</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2053</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2054</span>    ft_inplace = isinstance(indices, numpy.ndarray)</div>
<div class="line"><span class="lineno"> 2055</span>    dt_inplace = isinstance(distances, numpy.ndarray)</div>
<div class="line"><span class="lineno"> 2056</span>    _distance_tranform_arg_check(</div>
<div class="line"><span class="lineno"> 2057</span>        dt_inplace, ft_inplace, return_distances, return_indices</div>
<div class="line"><span class="lineno"> 2058</span>    )</div>
<div class="line"><span class="lineno"> 2059</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno"> 2060</span>    <span class="keywordflow">if</span> metric <span class="keywordflow">in</span> [<span class="stringliteral">&#39;taxicab&#39;</span>, <span class="stringliteral">&#39;cityblock&#39;</span>, <span class="stringliteral">&#39;manhattan&#39;</span>]:</div>
<div class="line"><span class="lineno"> 2061</span>        rank = input.ndim</div>
<div class="line"><span class="lineno"> 2062</span>        metric = generate_binary_structure(rank, 1)</div>
<div class="line"><span class="lineno"> 2063</span>    <span class="keywordflow">elif</span> metric == <span class="stringliteral">&#39;chessboard&#39;</span>:</div>
<div class="line"><span class="lineno"> 2064</span>        rank = input.ndim</div>
<div class="line"><span class="lineno"> 2065</span>        metric = generate_binary_structure(rank, rank)</div>
<div class="line"><span class="lineno"> 2066</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2067</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2068</span>            metric = numpy.asarray(metric)</div>
<div class="line"><span class="lineno"> 2069</span>        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2070</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;invalid metric provided&#39;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno"> 2071</span>        <span class="keywordflow">for</span> s <span class="keywordflow">in</span> metric.shape:</div>
<div class="line"><span class="lineno"> 2072</span>            <span class="keywordflow">if</span> s != 3:</div>
<div class="line"><span class="lineno"> 2073</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;metric sizes must be equal to 3&#39;</span>)</div>
<div class="line"><span class="lineno"> 2074</span> </div>
<div class="line"><span class="lineno"> 2075</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> metric.flags.contiguous:</div>
<div class="line"><span class="lineno"> 2076</span>        metric = metric.copy()</div>
<div class="line"><span class="lineno"> 2077</span>    <span class="keywordflow">if</span> dt_inplace:</div>
<div class="line"><span class="lineno"> 2078</span>        <span class="keywordflow">if</span> distances.dtype.type != numpy.int32:</div>
<div class="line"><span class="lineno"> 2079</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;distances must be of int32 type&#39;</span>)</div>
<div class="line"><span class="lineno"> 2080</span>        <span class="keywordflow">if</span> distances.shape != input.shape:</div>
<div class="line"><span class="lineno"> 2081</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;distances has wrong shape&#39;</span>)</div>
<div class="line"><span class="lineno"> 2082</span>        dt = distances</div>
<div class="line"><span class="lineno"> 2083</span>        dt[...] = numpy.where(input, -1, 0).astype(numpy.int32)</div>
<div class="line"><span class="lineno"> 2084</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2085</span>        dt = numpy.where(input, -1, 0).astype(numpy.int32)</div>
<div class="line"><span class="lineno"> 2086</span> </div>
<div class="line"><span class="lineno"> 2087</span>    rank = dt.ndim</div>
<div class="line"><span class="lineno"> 2088</span>    <span class="keywordflow">if</span> return_indices:</div>
<div class="line"><span class="lineno"> 2089</span>        sz = numpy.prod(dt.shape, axis=0)</div>
<div class="line"><span class="lineno"> 2090</span>        ft = numpy.arange(sz, dtype=numpy.int32)</div>
<div class="line"><span class="lineno"> 2091</span>        ft.shape = dt.shape</div>
<div class="line"><span class="lineno"> 2092</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2093</span>        ft = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2094</span> </div>
<div class="line"><span class="lineno"> 2095</span>    _nd_image.distance_transform_op(metric, dt, ft)</div>
<div class="line"><span class="lineno"> 2096</span>    dt = dt[tuple([slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)] * rank)]</div>
<div class="line"><span class="lineno"> 2097</span>    <span class="keywordflow">if</span> return_indices:</div>
<div class="line"><span class="lineno"> 2098</span>        ft = ft[tuple([slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)] * rank)]</div>
<div class="line"><span class="lineno"> 2099</span>    _nd_image.distance_transform_op(metric, dt, ft)</div>
<div class="line"><span class="lineno"> 2100</span>    dt = dt[tuple([slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)] * rank)]</div>
<div class="line"><span class="lineno"> 2101</span>    <span class="keywordflow">if</span> return_indices:</div>
<div class="line"><span class="lineno"> 2102</span>        ft = ft[tuple([slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)] * rank)]</div>
<div class="line"><span class="lineno"> 2103</span>        ft = numpy.ravel(ft)</div>
<div class="line"><span class="lineno"> 2104</span>        <span class="keywordflow">if</span> ft_inplace:</div>
<div class="line"><span class="lineno"> 2105</span>            <span class="keywordflow">if</span> indices.dtype.type != numpy.int32:</div>
<div class="line"><span class="lineno"> 2106</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;indices array must be int32&#39;</span>)</div>
<div class="line"><span class="lineno"> 2107</span>            <span class="keywordflow">if</span> indices.shape != (dt.ndim,) + dt.shape:</div>
<div class="line"><span class="lineno"> 2108</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;indices array has wrong shape&#39;</span>)</div>
<div class="line"><span class="lineno"> 2109</span>            tmp = indices</div>
<div class="line"><span class="lineno"> 2110</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2111</span>            tmp = numpy.indices(dt.shape, dtype=numpy.int32)</div>
<div class="line"><span class="lineno"> 2112</span>        <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(tmp.shape[0]):</div>
<div class="line"><span class="lineno"> 2113</span>            rtmp = numpy.ravel(tmp[ii, ...])[ft]</div>
<div class="line"><span class="lineno"> 2114</span>            rtmp.shape = dt.shape</div>
<div class="line"><span class="lineno"> 2115</span>            tmp[ii, ...] = rtmp</div>
<div class="line"><span class="lineno"> 2116</span>        ft = tmp</div>
<div class="line"><span class="lineno"> 2117</span> </div>
<div class="line"><span class="lineno"> 2118</span>    <span class="comment"># construct and return the result</span></div>
<div class="line"><span class="lineno"> 2119</span>    result = []</div>
<div class="line"><span class="lineno"> 2120</span>    <span class="keywordflow">if</span> return_distances <span class="keywordflow">and</span> <span class="keywordflow">not</span> dt_inplace:</div>
<div class="line"><span class="lineno"> 2121</span>        result.append(dt)</div>
<div class="line"><span class="lineno"> 2122</span>    <span class="keywordflow">if</span> return_indices <span class="keywordflow">and</span> <span class="keywordflow">not</span> ft_inplace:</div>
<div class="line"><span class="lineno"> 2123</span>        result.append(ft)</div>
<div class="line"><span class="lineno"> 2124</span> </div>
<div class="line"><span class="lineno"> 2125</span>    <span class="keywordflow">if</span> len(result) == 2:</div>
<div class="line"><span class="lineno"> 2126</span>        <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno"> 2127</span>    <span class="keywordflow">elif</span> len(result) == 1:</div>
<div class="line"><span class="lineno"> 2128</span>        <span class="keywordflow">return</span> result[0]</div>
<div class="line"><span class="lineno"> 2129</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2130</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2131</span> </div>
<div class="line"><span class="lineno"> 2132</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4b7e191882073a63602a80343313ea3" name="ae4b7e191882073a63602a80343313ea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b7e191882073a63602a80343313ea3">&#9670;&#160;</a></span>distance_transform_edt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.distance_transform_edt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sampling</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_distances</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_indices</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distances</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>indices</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Exact Euclidean distance transform.

In addition to the distance transform, the feature transform can
be calculated. In this case the index of the closest background
element to each foreground element is returned in a separate array.

Parameters
----------
input : array_like
    Input data to transform. Can be any type but will be converted
    into binary: 1 wherever input equates to True, 0 elsewhere.
sampling : float, or sequence of float, optional
    Spacing of elements along each dimension. If a sequence, must be of
    length equal to the input rank; if a single number, this is used for
    all axes. If not specified, a grid spacing of unity is implied.
return_distances : bool, optional
    Whether to calculate the distance transform.
    Default is True.
return_indices : bool, optional
    Whether to calculate the feature transform.
    Default is False.
distances : float64 ndarray, optional
    An output array to store the calculated distance transform, instead of
    returning it.
    `return_distances` must be True.
    It must be the same shape as `input`.
indices : int32 ndarray, optional
    An output array to store the calculated feature transform, instead of
    returning it.
    `return_indicies` must be True.
    Its shape must be `(input.ndim,) + input.shape`.

Returns
-------
distances : float64 ndarray, optional
    The calculated distance transform. Returned only when
    `return_distances` is True and `distances` is not supplied.
    It will have the same shape as the input array.
indices : int32 ndarray, optional
    The calculated feature transform. It has an input-shaped array for each
    dimension of the input. See example below.
    Returned only when `return_indices` is True and `indices` is not
    supplied.

Notes
-----
The Euclidean distance transform gives values of the Euclidean
distance::

                n
  y_i = sqrt(sum (x[i]-b[i])**2)
                i

where b[i] is the background point (value 0) with the smallest
Euclidean distance to input points x[i], and n is the
number of dimensions.

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.array(([0,1,1,1,1],
...               [0,0,1,1,1],
...               [0,1,1,1,1],
...               [0,1,1,1,0],
...               [0,1,1,0,0]))
&gt;&gt;&gt; ndimage.distance_transform_edt(a)
array([[ 0.    ,  1.    ,  1.4142,  2.2361,  3.    ],
       [ 0.    ,  0.    ,  1.    ,  2.    ,  2.    ],
       [ 0.    ,  1.    ,  1.4142,  1.4142,  1.    ],
       [ 0.    ,  1.    ,  1.4142,  1.    ,  0.    ],
       [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])

With a sampling of 2 units along x, 1 along y:

&gt;&gt;&gt; ndimage.distance_transform_edt(a, sampling=[2,1])
array([[ 0.    ,  1.    ,  2.    ,  2.8284,  3.6056],
       [ 0.    ,  0.    ,  1.    ,  2.    ,  3.    ],
       [ 0.    ,  1.    ,  2.    ,  2.2361,  2.    ],
       [ 0.    ,  1.    ,  2.    ,  1.    ,  0.    ],
       [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])

Asking for indices as well:

&gt;&gt;&gt; edt, inds = ndimage.distance_transform_edt(a, return_indices=True)
&gt;&gt;&gt; inds
array([[[0, 0, 1, 1, 3],
        [1, 1, 1, 1, 3],
        [2, 2, 1, 3, 3],
        [3, 3, 4, 4, 3],
        [4, 4, 4, 4, 4]],
       [[0, 0, 1, 1, 4],
        [0, 1, 1, 1, 4],
        [0, 0, 1, 4, 4],
        [0, 0, 3, 3, 4],
        [0, 0, 3, 3, 4]]])

With arrays provided for inplace outputs:

&gt;&gt;&gt; indices = np.zeros(((np.ndim(a),) + a.shape), dtype=np.int32)
&gt;&gt;&gt; ndimage.distance_transform_edt(a, return_indices=True, indices=indices)
array([[ 0.    ,  1.    ,  1.4142,  2.2361,  3.    ],
       [ 0.    ,  0.    ,  1.    ,  2.    ,  2.    ],
       [ 0.    ,  1.    ,  1.4142,  1.4142,  1.    ],
       [ 0.    ,  1.    ,  1.4142,  1.    ,  0.    ],
       [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])
&gt;&gt;&gt; indices
array([[[0, 0, 1, 1, 3],
        [1, 1, 1, 1, 3],
        [2, 2, 1, 3, 3],
        [3, 3, 4, 4, 3],
        [4, 4, 4, 4, 4]],
       [[0, 0, 1, 1, 4],
        [0, 1, 1, 1, 4],
        [0, 0, 1, 4, 4],
        [0, 0, 3, 3, 4],
        [0, 0, 3, 3, 4]]])</pre> <div class="fragment"><div class="line"><span class="lineno"> 2134</span>                           return_indices=<span class="keyword">False</span>, distances=<span class="keywordtype">None</span>, indices=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2135</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2136</span><span class="stringliteral">    Exact Euclidean distance transform.</span></div>
<div class="line"><span class="lineno"> 2137</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2138</span><span class="stringliteral">    In addition to the distance transform, the feature transform can</span></div>
<div class="line"><span class="lineno"> 2139</span><span class="stringliteral">    be calculated. In this case the index of the closest background</span></div>
<div class="line"><span class="lineno"> 2140</span><span class="stringliteral">    element to each foreground element is returned in a separate array.</span></div>
<div class="line"><span class="lineno"> 2141</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2142</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2143</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2144</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 2145</span><span class="stringliteral">        Input data to transform. Can be any type but will be converted</span></div>
<div class="line"><span class="lineno"> 2146</span><span class="stringliteral">        into binary: 1 wherever input equates to True, 0 elsewhere.</span></div>
<div class="line"><span class="lineno"> 2147</span><span class="stringliteral">    sampling : float, or sequence of float, optional</span></div>
<div class="line"><span class="lineno"> 2148</span><span class="stringliteral">        Spacing of elements along each dimension. If a sequence, must be of</span></div>
<div class="line"><span class="lineno"> 2149</span><span class="stringliteral">        length equal to the input rank; if a single number, this is used for</span></div>
<div class="line"><span class="lineno"> 2150</span><span class="stringliteral">        all axes. If not specified, a grid spacing of unity is implied.</span></div>
<div class="line"><span class="lineno"> 2151</span><span class="stringliteral">    return_distances : bool, optional</span></div>
<div class="line"><span class="lineno"> 2152</span><span class="stringliteral">        Whether to calculate the distance transform.</span></div>
<div class="line"><span class="lineno"> 2153</span><span class="stringliteral">        Default is True.</span></div>
<div class="line"><span class="lineno"> 2154</span><span class="stringliteral">    return_indices : bool, optional</span></div>
<div class="line"><span class="lineno"> 2155</span><span class="stringliteral">        Whether to calculate the feature transform.</span></div>
<div class="line"><span class="lineno"> 2156</span><span class="stringliteral">        Default is False.</span></div>
<div class="line"><span class="lineno"> 2157</span><span class="stringliteral">    distances : float64 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2158</span><span class="stringliteral">        An output array to store the calculated distance transform, instead of</span></div>
<div class="line"><span class="lineno"> 2159</span><span class="stringliteral">        returning it.</span></div>
<div class="line"><span class="lineno"> 2160</span><span class="stringliteral">        `return_distances` must be True.</span></div>
<div class="line"><span class="lineno"> 2161</span><span class="stringliteral">        It must be the same shape as `input`.</span></div>
<div class="line"><span class="lineno"> 2162</span><span class="stringliteral">    indices : int32 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2163</span><span class="stringliteral">        An output array to store the calculated feature transform, instead of</span></div>
<div class="line"><span class="lineno"> 2164</span><span class="stringliteral">        returning it.</span></div>
<div class="line"><span class="lineno"> 2165</span><span class="stringliteral">        `return_indicies` must be True.</span></div>
<div class="line"><span class="lineno"> 2166</span><span class="stringliteral">        Its shape must be `(input.ndim,) + input.shape`.</span></div>
<div class="line"><span class="lineno"> 2167</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2168</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2169</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2170</span><span class="stringliteral">    distances : float64 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2171</span><span class="stringliteral">        The calculated distance transform. Returned only when</span></div>
<div class="line"><span class="lineno"> 2172</span><span class="stringliteral">        `return_distances` is True and `distances` is not supplied.</span></div>
<div class="line"><span class="lineno"> 2173</span><span class="stringliteral">        It will have the same shape as the input array.</span></div>
<div class="line"><span class="lineno"> 2174</span><span class="stringliteral">    indices : int32 ndarray, optional</span></div>
<div class="line"><span class="lineno"> 2175</span><span class="stringliteral">        The calculated feature transform. It has an input-shaped array for each</span></div>
<div class="line"><span class="lineno"> 2176</span><span class="stringliteral">        dimension of the input. See example below.</span></div>
<div class="line"><span class="lineno"> 2177</span><span class="stringliteral">        Returned only when `return_indices` is True and `indices` is not</span></div>
<div class="line"><span class="lineno"> 2178</span><span class="stringliteral">        supplied.</span></div>
<div class="line"><span class="lineno"> 2179</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2180</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2181</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2182</span><span class="stringliteral">    The Euclidean distance transform gives values of the Euclidean</span></div>
<div class="line"><span class="lineno"> 2183</span><span class="stringliteral">    distance::</span></div>
<div class="line"><span class="lineno"> 2184</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2185</span><span class="stringliteral">                    n</span></div>
<div class="line"><span class="lineno"> 2186</span><span class="stringliteral">      y_i = sqrt(sum (x[i]-b[i])**2)</span></div>
<div class="line"><span class="lineno"> 2187</span><span class="stringliteral">                    i</span></div>
<div class="line"><span class="lineno"> 2188</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2189</span><span class="stringliteral">    where b[i] is the background point (value 0) with the smallest</span></div>
<div class="line"><span class="lineno"> 2190</span><span class="stringliteral">    Euclidean distance to input points x[i], and n is the</span></div>
<div class="line"><span class="lineno"> 2191</span><span class="stringliteral">    number of dimensions.</span></div>
<div class="line"><span class="lineno"> 2192</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2193</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2194</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2195</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 2196</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array(([0,1,1,1,1],</span></div>
<div class="line"><span class="lineno"> 2197</span><span class="stringliteral">    ...               [0,0,1,1,1],</span></div>
<div class="line"><span class="lineno"> 2198</span><span class="stringliteral">    ...               [0,1,1,1,1],</span></div>
<div class="line"><span class="lineno"> 2199</span><span class="stringliteral">    ...               [0,1,1,1,0],</span></div>
<div class="line"><span class="lineno"> 2200</span><span class="stringliteral">    ...               [0,1,1,0,0]))</span></div>
<div class="line"><span class="lineno"> 2201</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.distance_transform_edt(a)</span></div>
<div class="line"><span class="lineno"> 2202</span><span class="stringliteral">    array([[ 0.    ,  1.    ,  1.4142,  2.2361,  3.    ],</span></div>
<div class="line"><span class="lineno"> 2203</span><span class="stringliteral">           [ 0.    ,  0.    ,  1.    ,  2.    ,  2.    ],</span></div>
<div class="line"><span class="lineno"> 2204</span><span class="stringliteral">           [ 0.    ,  1.    ,  1.4142,  1.4142,  1.    ],</span></div>
<div class="line"><span class="lineno"> 2205</span><span class="stringliteral">           [ 0.    ,  1.    ,  1.4142,  1.    ,  0.    ],</span></div>
<div class="line"><span class="lineno"> 2206</span><span class="stringliteral">           [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])</span></div>
<div class="line"><span class="lineno"> 2207</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2208</span><span class="stringliteral">    With a sampling of 2 units along x, 1 along y:</span></div>
<div class="line"><span class="lineno"> 2209</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2210</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.distance_transform_edt(a, sampling=[2,1])</span></div>
<div class="line"><span class="lineno"> 2211</span><span class="stringliteral">    array([[ 0.    ,  1.    ,  2.    ,  2.8284,  3.6056],</span></div>
<div class="line"><span class="lineno"> 2212</span><span class="stringliteral">           [ 0.    ,  0.    ,  1.    ,  2.    ,  3.    ],</span></div>
<div class="line"><span class="lineno"> 2213</span><span class="stringliteral">           [ 0.    ,  1.    ,  2.    ,  2.2361,  2.    ],</span></div>
<div class="line"><span class="lineno"> 2214</span><span class="stringliteral">           [ 0.    ,  1.    ,  2.    ,  1.    ,  0.    ],</span></div>
<div class="line"><span class="lineno"> 2215</span><span class="stringliteral">           [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])</span></div>
<div class="line"><span class="lineno"> 2216</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2217</span><span class="stringliteral">    Asking for indices as well:</span></div>
<div class="line"><span class="lineno"> 2218</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2219</span><span class="stringliteral">    &gt;&gt;&gt; edt, inds = ndimage.distance_transform_edt(a, return_indices=True)</span></div>
<div class="line"><span class="lineno"> 2220</span><span class="stringliteral">    &gt;&gt;&gt; inds</span></div>
<div class="line"><span class="lineno"> 2221</span><span class="stringliteral">    array([[[0, 0, 1, 1, 3],</span></div>
<div class="line"><span class="lineno"> 2222</span><span class="stringliteral">            [1, 1, 1, 1, 3],</span></div>
<div class="line"><span class="lineno"> 2223</span><span class="stringliteral">            [2, 2, 1, 3, 3],</span></div>
<div class="line"><span class="lineno"> 2224</span><span class="stringliteral">            [3, 3, 4, 4, 3],</span></div>
<div class="line"><span class="lineno"> 2225</span><span class="stringliteral">            [4, 4, 4, 4, 4]],</span></div>
<div class="line"><span class="lineno"> 2226</span><span class="stringliteral">           [[0, 0, 1, 1, 4],</span></div>
<div class="line"><span class="lineno"> 2227</span><span class="stringliteral">            [0, 1, 1, 1, 4],</span></div>
<div class="line"><span class="lineno"> 2228</span><span class="stringliteral">            [0, 0, 1, 4, 4],</span></div>
<div class="line"><span class="lineno"> 2229</span><span class="stringliteral">            [0, 0, 3, 3, 4],</span></div>
<div class="line"><span class="lineno"> 2230</span><span class="stringliteral">            [0, 0, 3, 3, 4]]])</span></div>
<div class="line"><span class="lineno"> 2231</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2232</span><span class="stringliteral">    With arrays provided for inplace outputs:</span></div>
<div class="line"><span class="lineno"> 2233</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2234</span><span class="stringliteral">    &gt;&gt;&gt; indices = np.zeros(((np.ndim(a),) + a.shape), dtype=np.int32)</span></div>
<div class="line"><span class="lineno"> 2235</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.distance_transform_edt(a, return_indices=True, indices=indices)</span></div>
<div class="line"><span class="lineno"> 2236</span><span class="stringliteral">    array([[ 0.    ,  1.    ,  1.4142,  2.2361,  3.    ],</span></div>
<div class="line"><span class="lineno"> 2237</span><span class="stringliteral">           [ 0.    ,  0.    ,  1.    ,  2.    ,  2.    ],</span></div>
<div class="line"><span class="lineno"> 2238</span><span class="stringliteral">           [ 0.    ,  1.    ,  1.4142,  1.4142,  1.    ],</span></div>
<div class="line"><span class="lineno"> 2239</span><span class="stringliteral">           [ 0.    ,  1.    ,  1.4142,  1.    ,  0.    ],</span></div>
<div class="line"><span class="lineno"> 2240</span><span class="stringliteral">           [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])</span></div>
<div class="line"><span class="lineno"> 2241</span><span class="stringliteral">    &gt;&gt;&gt; indices</span></div>
<div class="line"><span class="lineno"> 2242</span><span class="stringliteral">    array([[[0, 0, 1, 1, 3],</span></div>
<div class="line"><span class="lineno"> 2243</span><span class="stringliteral">            [1, 1, 1, 1, 3],</span></div>
<div class="line"><span class="lineno"> 2244</span><span class="stringliteral">            [2, 2, 1, 3, 3],</span></div>
<div class="line"><span class="lineno"> 2245</span><span class="stringliteral">            [3, 3, 4, 4, 3],</span></div>
<div class="line"><span class="lineno"> 2246</span><span class="stringliteral">            [4, 4, 4, 4, 4]],</span></div>
<div class="line"><span class="lineno"> 2247</span><span class="stringliteral">           [[0, 0, 1, 1, 4],</span></div>
<div class="line"><span class="lineno"> 2248</span><span class="stringliteral">            [0, 1, 1, 1, 4],</span></div>
<div class="line"><span class="lineno"> 2249</span><span class="stringliteral">            [0, 0, 1, 4, 4],</span></div>
<div class="line"><span class="lineno"> 2250</span><span class="stringliteral">            [0, 0, 3, 3, 4],</span></div>
<div class="line"><span class="lineno"> 2251</span><span class="stringliteral">            [0, 0, 3, 3, 4]]])</span></div>
<div class="line"><span class="lineno"> 2252</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2253</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2254</span>    ft_inplace = isinstance(indices, numpy.ndarray)</div>
<div class="line"><span class="lineno"> 2255</span>    dt_inplace = isinstance(distances, numpy.ndarray)</div>
<div class="line"><span class="lineno"> 2256</span>    _distance_tranform_arg_check(</div>
<div class="line"><span class="lineno"> 2257</span>        dt_inplace, ft_inplace, return_distances, return_indices</div>
<div class="line"><span class="lineno"> 2258</span>    )</div>
<div class="line"><span class="lineno"> 2259</span> </div>
<div class="line"><span class="lineno"> 2260</span>    <span class="comment"># calculate the feature transform</span></div>
<div class="line"><span class="lineno"> 2261</span>    input = numpy.atleast_1d(numpy.where(input, 1, 0).astype(numpy.int8))</div>
<div class="line"><span class="lineno"> 2262</span>    <span class="keywordflow">if</span> sampling <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2263</span>        sampling = _ni_support._normalize_sequence(sampling, input.ndim)</div>
<div class="line"><span class="lineno"> 2264</span>        sampling = numpy.asarray(sampling, dtype=numpy.float64)</div>
<div class="line"><span class="lineno"> 2265</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> sampling.flags.contiguous:</div>
<div class="line"><span class="lineno"> 2266</span>            sampling = sampling.copy()</div>
<div class="line"><span class="lineno"> 2267</span> </div>
<div class="line"><span class="lineno"> 2268</span>    <span class="keywordflow">if</span> ft_inplace:</div>
<div class="line"><span class="lineno"> 2269</span>        ft = indices</div>
<div class="line"><span class="lineno"> 2270</span>        <span class="keywordflow">if</span> ft.shape != (input.ndim,) + input.shape:</div>
<div class="line"><span class="lineno"> 2271</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;indices array has wrong shape&#39;</span>)</div>
<div class="line"><span class="lineno"> 2272</span>        <span class="keywordflow">if</span> ft.dtype.type != numpy.int32:</div>
<div class="line"><span class="lineno"> 2273</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;indices array must be int32&#39;</span>)</div>
<div class="line"><span class="lineno"> 2274</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2275</span>        ft = numpy.zeros((input.ndim,) + input.shape, dtype=numpy.int32)</div>
<div class="line"><span class="lineno"> 2276</span> </div>
<div class="line"><span class="lineno"> 2277</span>    _nd_image.euclidean_feature_transform(input, sampling, ft)</div>
<div class="line"><span class="lineno"> 2278</span>    <span class="comment"># if requested, calculate the distance transform</span></div>
<div class="line"><span class="lineno"> 2279</span>    <span class="keywordflow">if</span> return_distances:</div>
<div class="line"><span class="lineno"> 2280</span>        dt = ft - numpy.indices(input.shape, dtype=ft.dtype)</div>
<div class="line"><span class="lineno"> 2281</span>        dt = dt.astype(numpy.float64)</div>
<div class="line"><span class="lineno"> 2282</span>        <span class="keywordflow">if</span> sampling <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2283</span>            <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(len(sampling)):</div>
<div class="line"><span class="lineno"> 2284</span>                dt[ii, ...] *= sampling[ii]</div>
<div class="line"><span class="lineno"> 2285</span>        numpy.multiply(dt, dt, dt)</div>
<div class="line"><span class="lineno"> 2286</span>        <span class="keywordflow">if</span> dt_inplace:</div>
<div class="line"><span class="lineno"> 2287</span>            dt = numpy.add.reduce(dt, axis=0)</div>
<div class="line"><span class="lineno"> 2288</span>            <span class="keywordflow">if</span> distances.shape != dt.shape:</div>
<div class="line"><span class="lineno"> 2289</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;distances array has wrong shape&#39;</span>)</div>
<div class="line"><span class="lineno"> 2290</span>            <span class="keywordflow">if</span> distances.dtype.type != numpy.float64:</div>
<div class="line"><span class="lineno"> 2291</span>                <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;distances array must be float64&#39;</span>)</div>
<div class="line"><span class="lineno"> 2292</span>            numpy.sqrt(dt, distances)</div>
<div class="line"><span class="lineno"> 2293</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2294</span>            dt = numpy.add.reduce(dt, axis=0)</div>
<div class="line"><span class="lineno"> 2295</span>            dt = numpy.sqrt(dt)</div>
<div class="line"><span class="lineno"> 2296</span> </div>
<div class="line"><span class="lineno"> 2297</span>    <span class="comment"># construct and return the result</span></div>
<div class="line"><span class="lineno"> 2298</span>    result = []</div>
<div class="line"><span class="lineno"> 2299</span>    <span class="keywordflow">if</span> return_distances <span class="keywordflow">and</span> <span class="keywordflow">not</span> dt_inplace:</div>
<div class="line"><span class="lineno"> 2300</span>        result.append(dt)</div>
<div class="line"><span class="lineno"> 2301</span>    <span class="keywordflow">if</span> return_indices <span class="keywordflow">and</span> <span class="keywordflow">not</span> ft_inplace:</div>
<div class="line"><span class="lineno"> 2302</span>        result.append(ft)</div>
<div class="line"><span class="lineno"> 2303</span> </div>
<div class="line"><span class="lineno"> 2304</span>    <span class="keywordflow">if</span> len(result) == 2:</div>
<div class="line"><span class="lineno"> 2305</span>        <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno"> 2306</span>    <span class="keywordflow">elif</span> len(result) == 1:</div>
<div class="line"><span class="lineno"> 2307</span>        <span class="keywordflow">return</span> result[0]</div>
<div class="line"><span class="lineno"> 2308</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2309</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4cec95e8f208f65adb2a23ae10daccb" name="ac4cec95e8f208f65adb2a23ae10daccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4cec95e8f208f65adb2a23ae10daccb">&#9670;&#160;</a></span>generate_binary_structure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.generate_binary_structure </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>connectivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generate a binary structure for binary morphological operations.

Parameters
----------
rank : int
     Number of dimensions of the array to which the structuring element
     will be applied, as returned by `np.ndim`.
connectivity : int
     `connectivity` determines which elements of the output array belong
     to the structure, i.e., are considered as neighbors of the central
     element. Elements up to a squared distance of `connectivity` from
     the center are considered neighbors. `connectivity` may range from 1
     (no diagonal elements are neighbors) to `rank` (all elements are
     neighbors).

Returns
-------
output : ndarray of bools
     Structuring element which may be used for binary morphological
     operations, with `rank` dimensions and all dimensions equal to 3.

See also
--------
iterate_structure, binary_dilation, binary_erosion

Notes
-----
`generate_binary_structure` can only create structuring elements with
dimensions equal to 3, i.e., minimal dimensions. For larger structuring
elements, that are useful e.g., for eroding large objects, one may either
use `iterate_structure`, or create directly custom arrays with
numpy functions such as `numpy.ones`.

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; struct = ndimage.generate_binary_structure(2, 1)
&gt;&gt;&gt; struct
array([[False,  True, False],
       [ True,  True,  True],
       [False,  True, False]], dtype=bool)
&gt;&gt;&gt; a = np.zeros((5,5))
&gt;&gt;&gt; a[2, 2] = 1
&gt;&gt;&gt; a
array([[ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.]])
&gt;&gt;&gt; b = ndimage.binary_dilation(a, structure=struct).astype(a.dtype)
&gt;&gt;&gt; b
array([[ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.]])
&gt;&gt;&gt; ndimage.binary_dilation(b, structure=struct).astype(a.dtype)
array([[ 0.,  0.,  1.,  0.,  0.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 0.,  1.,  1.,  1.,  0.],
       [ 0.,  0.,  1.,  0.,  0.]])
&gt;&gt;&gt; struct = ndimage.generate_binary_structure(2, 2)
&gt;&gt;&gt; struct
array([[ True,  True,  True],
       [ True,  True,  True],
       [ True,  True,  True]], dtype=bool)
&gt;&gt;&gt; struct = ndimage.generate_binary_structure(3, 1)
&gt;&gt;&gt; struct # no diagonal elements
array([[[False, False, False],
        [False,  True, False],
        [False, False, False]],
       [[False,  True, False],
        [ True,  True,  True],
        [False,  True, False]],
       [[False, False, False],
        [False,  True, False],
        [False, False, False]]], dtype=bool)</pre> <div class="fragment"><div class="line"><span class="lineno">  124</span><span class="keyword">def </span>generate_binary_structure(rank, connectivity):</div>
<div class="line"><span class="lineno">  125</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">    Generate a binary structure for binary morphological operations.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">    rank : int</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">         Number of dimensions of the array to which the structuring element</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">         will be applied, as returned by `np.ndim`.</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    connectivity : int</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">         `connectivity` determines which elements of the output array belong</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">         to the structure, i.e., are considered as neighbors of the central</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">         element. Elements up to a squared distance of `connectivity` from</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">         the center are considered neighbors. `connectivity` may range from 1</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">         (no diagonal elements are neighbors) to `rank` (all elements are</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">         neighbors).</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    output : ndarray of bools</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">         Structuring element which may be used for binary morphological</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">         operations, with `rank` dimensions and all dimensions equal to 3.</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    iterate_structure, binary_dilation, binary_erosion</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    `generate_binary_structure` can only create structuring elements with</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    dimensions equal to 3, i.e., minimal dimensions. For larger structuring</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">    elements, that are useful e.g., for eroding large objects, one may either</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    use `iterate_structure`, or create directly custom arrays with</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    numpy functions such as `numpy.ones`.</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">    &gt;&gt;&gt; struct = ndimage.generate_binary_structure(2, 1)</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    &gt;&gt;&gt; struct</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    array([[False,  True, False],</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">           [ True,  True,  True],</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">           [False,  True, False]], dtype=bool)</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((5,5))</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">    &gt;&gt;&gt; a[2, 2] = 1</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    array([[ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.]])</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    &gt;&gt;&gt; b = ndimage.binary_dilation(a, structure=struct).astype(a.dtype)</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    &gt;&gt;&gt; b</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">    array([[ 0.,  0.,  0.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">           [ 0.,  0.,  0.,  0.,  0.]])</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.binary_dilation(b, structure=struct).astype(a.dtype)</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">    array([[ 0.,  0.,  1.,  0.,  0.],</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">           [ 1.,  1.,  1.,  1.,  1.],</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">           [ 0.,  1.,  1.,  1.,  0.],</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">           [ 0.,  0.,  1.,  0.,  0.]])</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    &gt;&gt;&gt; struct = ndimage.generate_binary_structure(2, 2)</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    &gt;&gt;&gt; struct</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    array([[ True,  True,  True],</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">           [ True,  True,  True],</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">           [ True,  True,  True]], dtype=bool)</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    &gt;&gt;&gt; struct = ndimage.generate_binary_structure(3, 1)</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    &gt;&gt;&gt; struct # no diagonal elements</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    array([[[False, False, False],</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">            [False,  True, False],</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">            [False, False, False]],</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">           [[False,  True, False],</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">            [ True,  True,  True],</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">            [False,  True, False]],</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">           [[False, False, False],</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">            [False,  True, False],</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">            [False, False, False]]], dtype=bool)</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">if</span> connectivity &lt; 1:</div>
<div class="line"><span class="lineno">  207</span>        connectivity = 1</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">if</span> rank &lt; 1:</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">return</span> numpy.array(<span class="keyword">True</span>, dtype=bool)</div>
<div class="line"><span class="lineno">  210</span>    output = numpy.fabs(numpy.indices([3] * rank) - 1)</div>
<div class="line"><span class="lineno">  211</span>    output = numpy.add.reduce(output, 0)</div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">return</span> output &lt;= connectivity</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad138cae4d72e92ba608d5ba082f7865a" name="ad138cae4d72e92ba608d5ba082f7865a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad138cae4d72e92ba608d5ba082f7865a">&#9670;&#160;</a></span>grey_closing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.grey_closing </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>footprint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>&quot;reflect&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cval</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional grayscale closing.

A grayscale closing consists in the succession of a grayscale dilation,
and a grayscale erosion.

Parameters
----------
input : array_like
    Array over which the grayscale closing is to be computed.
size : tuple of ints
    Shape of a flat and full structuring element used for the grayscale
    closing. Optional if `footprint` or `structure` is provided.
footprint : array of ints, optional
    Positions of non-infinite elements of a flat structuring element
    used for the grayscale closing.
structure : array of ints, optional
    Structuring element used for the grayscale closing. `structure`
    may be a non-flat structuring element.
output : array, optional
    An array used for storing the output of the closing may be provided.
mode : {'reflect', 'constant', 'nearest', 'mirror', 'wrap'}, optional
    The `mode` parameter determines how the array borders are
    handled, where `cval` is the value when mode is equal to
    'constant'. Default is 'reflect'
cval : scalar, optional
    Value to fill past edges of input if `mode` is 'constant'. Default
    is 0.0.
origin : scalar, optional
    The `origin` parameter controls the placement of the filter.
    Default 0

Returns
-------
grey_closing : ndarray
    Result of the grayscale closing of `input` with `structure`.

See also
--------
binary_closing, grey_dilation, grey_erosion, grey_opening,
generate_binary_structure

Notes
-----
The action of a grayscale closing with a flat structuring element amounts
to smoothen deep local minima, whereas binary closing fills small holes.

References
----------
.. [1] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.arange(36).reshape((6,6))
&gt;&gt;&gt; a[3,3] = 0
&gt;&gt;&gt; a
array([[ 0,  1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10, 11],
       [12, 13, 14, 15, 16, 17],
       [18, 19, 20,  0, 22, 23],
       [24, 25, 26, 27, 28, 29],
       [30, 31, 32, 33, 34, 35]])
&gt;&gt;&gt; ndimage.grey_closing(a, size=(3,3))
array([[ 7,  7,  8,  9, 10, 11],
       [ 7,  7,  8,  9, 10, 11],
       [13, 13, 14, 15, 16, 17],
       [19, 19, 20, 20, 22, 23],
       [25, 25, 26, 27, 28, 29],
       [31, 31, 32, 33, 34, 35]])
&gt;&gt;&gt; # Note that the local minimum a[3,3] has disappeared</pre> <div class="fragment"><div class="line"><span class="lineno"> 1456</span>                 output=<span class="keywordtype">None</span>, mode=<span class="stringliteral">&quot;reflect&quot;</span>, cval=0.0, origin=0):</div>
<div class="line"><span class="lineno"> 1457</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1458</span><span class="stringliteral">    Multidimensional grayscale closing.</span></div>
<div class="line"><span class="lineno"> 1459</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1460</span><span class="stringliteral">    A grayscale closing consists in the succession of a grayscale dilation,</span></div>
<div class="line"><span class="lineno"> 1461</span><span class="stringliteral">    and a grayscale erosion.</span></div>
<div class="line"><span class="lineno"> 1462</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1463</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1464</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1465</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1466</span><span class="stringliteral">        Array over which the grayscale closing is to be computed.</span></div>
<div class="line"><span class="lineno"> 1467</span><span class="stringliteral">    size : tuple of ints</span></div>
<div class="line"><span class="lineno"> 1468</span><span class="stringliteral">        Shape of a flat and full structuring element used for the grayscale</span></div>
<div class="line"><span class="lineno"> 1469</span><span class="stringliteral">        closing. Optional if `footprint` or `structure` is provided.</span></div>
<div class="line"><span class="lineno"> 1470</span><span class="stringliteral">    footprint : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1471</span><span class="stringliteral">        Positions of non-infinite elements of a flat structuring element</span></div>
<div class="line"><span class="lineno"> 1472</span><span class="stringliteral">        used for the grayscale closing.</span></div>
<div class="line"><span class="lineno"> 1473</span><span class="stringliteral">    structure : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1474</span><span class="stringliteral">        Structuring element used for the grayscale closing. `structure`</span></div>
<div class="line"><span class="lineno"> 1475</span><span class="stringliteral">        may be a non-flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1476</span><span class="stringliteral">    output : array, optional</span></div>
<div class="line"><span class="lineno"> 1477</span><span class="stringliteral">        An array used for storing the output of the closing may be provided.</span></div>
<div class="line"><span class="lineno"> 1478</span><span class="stringliteral">    mode : {&#39;reflect&#39;, &#39;constant&#39;, &#39;nearest&#39;, &#39;mirror&#39;, &#39;wrap&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1479</span><span class="stringliteral">        The `mode` parameter determines how the array borders are</span></div>
<div class="line"><span class="lineno"> 1480</span><span class="stringliteral">        handled, where `cval` is the value when mode is equal to</span></div>
<div class="line"><span class="lineno"> 1481</span><span class="stringliteral">        &#39;constant&#39;. Default is &#39;reflect&#39;</span></div>
<div class="line"><span class="lineno"> 1482</span><span class="stringliteral">    cval : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1483</span><span class="stringliteral">        Value to fill past edges of input if `mode` is &#39;constant&#39;. Default</span></div>
<div class="line"><span class="lineno"> 1484</span><span class="stringliteral">        is 0.0.</span></div>
<div class="line"><span class="lineno"> 1485</span><span class="stringliteral">    origin : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1486</span><span class="stringliteral">        The `origin` parameter controls the placement of the filter.</span></div>
<div class="line"><span class="lineno"> 1487</span><span class="stringliteral">        Default 0</span></div>
<div class="line"><span class="lineno"> 1488</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1489</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1490</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1491</span><span class="stringliteral">    grey_closing : ndarray</span></div>
<div class="line"><span class="lineno"> 1492</span><span class="stringliteral">        Result of the grayscale closing of `input` with `structure`.</span></div>
<div class="line"><span class="lineno"> 1493</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1494</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1495</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1496</span><span class="stringliteral">    binary_closing, grey_dilation, grey_erosion, grey_opening,</span></div>
<div class="line"><span class="lineno"> 1497</span><span class="stringliteral">    generate_binary_structure</span></div>
<div class="line"><span class="lineno"> 1498</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1499</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1500</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1501</span><span class="stringliteral">    The action of a grayscale closing with a flat structuring element amounts</span></div>
<div class="line"><span class="lineno"> 1502</span><span class="stringliteral">    to smoothen deep local minima, whereas binary closing fills small holes.</span></div>
<div class="line"><span class="lineno"> 1503</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1504</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1505</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1506</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno"> 1507</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1508</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1509</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1510</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1511</span><span class="stringliteral">    &gt;&gt;&gt; a = np.arange(36).reshape((6,6))</span></div>
<div class="line"><span class="lineno"> 1512</span><span class="stringliteral">    &gt;&gt;&gt; a[3,3] = 0</span></div>
<div class="line"><span class="lineno"> 1513</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno"> 1514</span><span class="stringliteral">    array([[ 0,  1,  2,  3,  4,  5],</span></div>
<div class="line"><span class="lineno"> 1515</span><span class="stringliteral">           [ 6,  7,  8,  9, 10, 11],</span></div>
<div class="line"><span class="lineno"> 1516</span><span class="stringliteral">           [12, 13, 14, 15, 16, 17],</span></div>
<div class="line"><span class="lineno"> 1517</span><span class="stringliteral">           [18, 19, 20,  0, 22, 23],</span></div>
<div class="line"><span class="lineno"> 1518</span><span class="stringliteral">           [24, 25, 26, 27, 28, 29],</span></div>
<div class="line"><span class="lineno"> 1519</span><span class="stringliteral">           [30, 31, 32, 33, 34, 35]])</span></div>
<div class="line"><span class="lineno"> 1520</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_closing(a, size=(3,3))</span></div>
<div class="line"><span class="lineno"> 1521</span><span class="stringliteral">    array([[ 7,  7,  8,  9, 10, 11],</span></div>
<div class="line"><span class="lineno"> 1522</span><span class="stringliteral">           [ 7,  7,  8,  9, 10, 11],</span></div>
<div class="line"><span class="lineno"> 1523</span><span class="stringliteral">           [13, 13, 14, 15, 16, 17],</span></div>
<div class="line"><span class="lineno"> 1524</span><span class="stringliteral">           [19, 19, 20, 20, 22, 23],</span></div>
<div class="line"><span class="lineno"> 1525</span><span class="stringliteral">           [25, 25, 26, 27, 28, 29],</span></div>
<div class="line"><span class="lineno"> 1526</span><span class="stringliteral">           [31, 31, 32, 33, 34, 35]])</span></div>
<div class="line"><span class="lineno"> 1527</span><span class="stringliteral">    &gt;&gt;&gt; # Note that the local minimum a[3,3] has disappeared</span></div>
<div class="line"><span class="lineno"> 1528</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1529</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordflow">if</span> (size <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>) <span class="keywordflow">and</span> (footprint <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1531</span>        warnings.warn(<span class="stringliteral">&quot;ignoring size because footprint is set&quot;</span>, UserWarning, stacklevel=2)</div>
<div class="line"><span class="lineno"> 1532</span>    tmp = grey_dilation(input, size, footprint, structure, <span class="keywordtype">None</span>, mode,</div>
<div class="line"><span class="lineno"> 1533</span>                        cval, origin)</div>
<div class="line"><span class="lineno"> 1534</span>    <span class="keywordflow">return</span> grey_erosion(tmp, size, footprint, structure, output, mode,</div>
<div class="line"><span class="lineno"> 1535</span>                        cval, origin)</div>
<div class="line"><span class="lineno"> 1536</span> </div>
<div class="line"><span class="lineno"> 1537</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f19f05960e0438e963d6cb1bbf53765" name="a2f19f05960e0438e963d6cb1bbf53765"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f19f05960e0438e963d6cb1bbf53765">&#9670;&#160;</a></span>grey_dilation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.grey_dilation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>footprint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>&quot;reflect&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cval</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate a greyscale dilation, using either a structuring element,
or a footprint corresponding to a flat structuring element.

Grayscale dilation is a mathematical morphology operation. For the
simple case of a full and flat structuring element, it can be viewed
as a maximum filter over a sliding window.

Parameters
----------
input : array_like
    Array over which the grayscale dilation is to be computed.
size : tuple of ints
    Shape of a flat and full structuring element used for the grayscale
    dilation. Optional if `footprint` or `structure` is provided.
footprint : array of ints, optional
    Positions of non-infinite elements of a flat structuring element
    used for the grayscale dilation. Non-zero values give the set of
    neighbors of the center over which the maximum is chosen.
structure : array of ints, optional
    Structuring element used for the grayscale dilation. `structure`
    may be a non-flat structuring element.
output : array, optional
    An array used for storing the output of the dilation may be provided.
mode : {'reflect','constant','nearest','mirror', 'wrap'}, optional
    The `mode` parameter determines how the array borders are
    handled, where `cval` is the value when mode is equal to
    'constant'. Default is 'reflect'
cval : scalar, optional
    Value to fill past edges of input if `mode` is 'constant'. Default
    is 0.0.
origin : scalar, optional
    The `origin` parameter controls the placement of the filter.
    Default 0

Returns
-------
grey_dilation : ndarray
    Grayscale dilation of `input`.

See also
--------
binary_dilation, grey_erosion, grey_closing, grey_opening
generate_binary_structure, maximum_filter

Notes
-----
The grayscale dilation of an image input by a structuring element s defined
over a domain E is given by:

(input+s)(x) = max {input(y) + s(x-y), for y in E}

In particular, for structuring elements defined as
s(y) = 0 for y in E, the grayscale dilation computes the maximum of the
input image inside a sliding window defined by E.

Grayscale dilation [1]_ is a *mathematical morphology* operation [2]_.

References
----------
.. [1] https://en.wikipedia.org/wiki/Dilation_%28morphology%29
.. [2] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((7,7), dtype=int)
&gt;&gt;&gt; a[2:5, 2:5] = 1
&gt;&gt;&gt; a[4,4] = 2; a[2,3] = 3
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 3, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 2, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.grey_dilation(a, size=(3,3))
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 1, 3, 3, 3, 1, 0],
       [0, 1, 3, 3, 3, 1, 0],
       [0, 1, 3, 3, 3, 2, 0],
       [0, 1, 1, 2, 2, 2, 0],
       [0, 1, 1, 2, 2, 2, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.grey_dilation(a, footprint=np.ones((3,3)))
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 1, 3, 3, 3, 1, 0],
       [0, 1, 3, 3, 3, 1, 0],
       [0, 1, 3, 3, 3, 2, 0],
       [0, 1, 1, 2, 2, 2, 0],
       [0, 1, 1, 2, 2, 2, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; s = ndimage.generate_binary_structure(2,1)
&gt;&gt;&gt; s
array([[False,  True, False],
       [ True,  True,  True],
       [False,  True, False]], dtype=bool)
&gt;&gt;&gt; ndimage.grey_dilation(a, footprint=s)
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 3, 1, 0, 0],
       [0, 1, 3, 3, 3, 1, 0],
       [0, 1, 1, 3, 2, 1, 0],
       [0, 1, 1, 2, 2, 2, 0],
       [0, 0, 1, 1, 2, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.grey_dilation(a, size=(3,3), structure=np.ones((3,3)))
array([[1, 1, 1, 1, 1, 1, 1],
       [1, 2, 4, 4, 4, 2, 1],
       [1, 2, 4, 4, 4, 2, 1],
       [1, 2, 4, 4, 4, 3, 1],
       [1, 2, 2, 3, 3, 3, 1],
       [1, 2, 2, 3, 3, 3, 1],
       [1, 1, 1, 1, 1, 1, 1]])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1225</span>                  output=<span class="keywordtype">None</span>, mode=<span class="stringliteral">&quot;reflect&quot;</span>, cval=0.0, origin=0):</div>
<div class="line"><span class="lineno"> 1226</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1227</span><span class="stringliteral">    Calculate a greyscale dilation, using either a structuring element,</span></div>
<div class="line"><span class="lineno"> 1228</span><span class="stringliteral">    or a footprint corresponding to a flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1229</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1230</span><span class="stringliteral">    Grayscale dilation is a mathematical morphology operation. For the</span></div>
<div class="line"><span class="lineno"> 1231</span><span class="stringliteral">    simple case of a full and flat structuring element, it can be viewed</span></div>
<div class="line"><span class="lineno"> 1232</span><span class="stringliteral">    as a maximum filter over a sliding window.</span></div>
<div class="line"><span class="lineno"> 1233</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1234</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1235</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1236</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1237</span><span class="stringliteral">        Array over which the grayscale dilation is to be computed.</span></div>
<div class="line"><span class="lineno"> 1238</span><span class="stringliteral">    size : tuple of ints</span></div>
<div class="line"><span class="lineno"> 1239</span><span class="stringliteral">        Shape of a flat and full structuring element used for the grayscale</span></div>
<div class="line"><span class="lineno"> 1240</span><span class="stringliteral">        dilation. Optional if `footprint` or `structure` is provided.</span></div>
<div class="line"><span class="lineno"> 1241</span><span class="stringliteral">    footprint : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1242</span><span class="stringliteral">        Positions of non-infinite elements of a flat structuring element</span></div>
<div class="line"><span class="lineno"> 1243</span><span class="stringliteral">        used for the grayscale dilation. Non-zero values give the set of</span></div>
<div class="line"><span class="lineno"> 1244</span><span class="stringliteral">        neighbors of the center over which the maximum is chosen.</span></div>
<div class="line"><span class="lineno"> 1245</span><span class="stringliteral">    structure : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1246</span><span class="stringliteral">        Structuring element used for the grayscale dilation. `structure`</span></div>
<div class="line"><span class="lineno"> 1247</span><span class="stringliteral">        may be a non-flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1248</span><span class="stringliteral">    output : array, optional</span></div>
<div class="line"><span class="lineno"> 1249</span><span class="stringliteral">        An array used for storing the output of the dilation may be provided.</span></div>
<div class="line"><span class="lineno"> 1250</span><span class="stringliteral">    mode : {&#39;reflect&#39;,&#39;constant&#39;,&#39;nearest&#39;,&#39;mirror&#39;, &#39;wrap&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1251</span><span class="stringliteral">        The `mode` parameter determines how the array borders are</span></div>
<div class="line"><span class="lineno"> 1252</span><span class="stringliteral">        handled, where `cval` is the value when mode is equal to</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral">        &#39;constant&#39;. Default is &#39;reflect&#39;</span></div>
<div class="line"><span class="lineno"> 1254</span><span class="stringliteral">    cval : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1255</span><span class="stringliteral">        Value to fill past edges of input if `mode` is &#39;constant&#39;. Default</span></div>
<div class="line"><span class="lineno"> 1256</span><span class="stringliteral">        is 0.0.</span></div>
<div class="line"><span class="lineno"> 1257</span><span class="stringliteral">    origin : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1258</span><span class="stringliteral">        The `origin` parameter controls the placement of the filter.</span></div>
<div class="line"><span class="lineno"> 1259</span><span class="stringliteral">        Default 0</span></div>
<div class="line"><span class="lineno"> 1260</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1261</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1262</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1263</span><span class="stringliteral">    grey_dilation : ndarray</span></div>
<div class="line"><span class="lineno"> 1264</span><span class="stringliteral">        Grayscale dilation of `input`.</span></div>
<div class="line"><span class="lineno"> 1265</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1266</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1267</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="stringliteral">    binary_dilation, grey_erosion, grey_closing, grey_opening</span></div>
<div class="line"><span class="lineno"> 1269</span><span class="stringliteral">    generate_binary_structure, maximum_filter</span></div>
<div class="line"><span class="lineno"> 1270</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1271</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1272</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1273</span><span class="stringliteral">    The grayscale dilation of an image input by a structuring element s defined</span></div>
<div class="line"><span class="lineno"> 1274</span><span class="stringliteral">    over a domain E is given by:</span></div>
<div class="line"><span class="lineno"> 1275</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1276</span><span class="stringliteral">    (input+s)(x) = max {input(y) + s(x-y), for y in E}</span></div>
<div class="line"><span class="lineno"> 1277</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1278</span><span class="stringliteral">    In particular, for structuring elements defined as</span></div>
<div class="line"><span class="lineno"> 1279</span><span class="stringliteral">    s(y) = 0 for y in E, the grayscale dilation computes the maximum of the</span></div>
<div class="line"><span class="lineno"> 1280</span><span class="stringliteral">    input image inside a sliding window defined by E.</span></div>
<div class="line"><span class="lineno"> 1281</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1282</span><span class="stringliteral">    Grayscale dilation [1]_ is a *mathematical morphology* operation [2]_.</span></div>
<div class="line"><span class="lineno"> 1283</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1284</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1285</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1286</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Dilation_%28morphology%29</span></div>
<div class="line"><span class="lineno"> 1287</span><span class="stringliteral">    .. [2] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno"> 1288</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1289</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1290</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1291</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1292</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((7,7), dtype=int)</span></div>
<div class="line"><span class="lineno"> 1293</span><span class="stringliteral">    &gt;&gt;&gt; a[2:5, 2:5] = 1</span></div>
<div class="line"><span class="lineno"> 1294</span><span class="stringliteral">    &gt;&gt;&gt; a[4,4] = 2; a[2,3] = 3</span></div>
<div class="line"><span class="lineno"> 1295</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1297</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1298</span><span class="stringliteral">           [0, 0, 1, 3, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1299</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1300</span><span class="stringliteral">           [0, 0, 1, 1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1301</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1302</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1303</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_dilation(a, size=(3,3))</span></div>
<div class="line"><span class="lineno"> 1304</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1305</span><span class="stringliteral">           [0, 1, 3, 3, 3, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1306</span><span class="stringliteral">           [0, 1, 3, 3, 3, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1307</span><span class="stringliteral">           [0, 1, 3, 3, 3, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1308</span><span class="stringliteral">           [0, 1, 1, 2, 2, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1309</span><span class="stringliteral">           [0, 1, 1, 2, 2, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1310</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1311</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_dilation(a, footprint=np.ones((3,3)))</span></div>
<div class="line"><span class="lineno"> 1312</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1313</span><span class="stringliteral">           [0, 1, 3, 3, 3, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1314</span><span class="stringliteral">           [0, 1, 3, 3, 3, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1315</span><span class="stringliteral">           [0, 1, 3, 3, 3, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1316</span><span class="stringliteral">           [0, 1, 1, 2, 2, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1317</span><span class="stringliteral">           [0, 1, 1, 2, 2, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1318</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1319</span><span class="stringliteral">    &gt;&gt;&gt; s = ndimage.generate_binary_structure(2,1)</span></div>
<div class="line"><span class="lineno"> 1320</span><span class="stringliteral">    &gt;&gt;&gt; s</span></div>
<div class="line"><span class="lineno"> 1321</span><span class="stringliteral">    array([[False,  True, False],</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="stringliteral">           [ True,  True,  True],</span></div>
<div class="line"><span class="lineno"> 1323</span><span class="stringliteral">           [False,  True, False]], dtype=bool)</span></div>
<div class="line"><span class="lineno"> 1324</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_dilation(a, footprint=s)</span></div>
<div class="line"><span class="lineno"> 1325</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1326</span><span class="stringliteral">           [0, 0, 1, 3, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1327</span><span class="stringliteral">           [0, 1, 3, 3, 3, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1328</span><span class="stringliteral">           [0, 1, 1, 3, 2, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1329</span><span class="stringliteral">           [0, 1, 1, 2, 2, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1330</span><span class="stringliteral">           [0, 0, 1, 1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1331</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1332</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_dilation(a, size=(3,3), structure=np.ones((3,3)))</span></div>
<div class="line"><span class="lineno"> 1333</span><span class="stringliteral">    array([[1, 1, 1, 1, 1, 1, 1],</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="stringliteral">           [1, 2, 4, 4, 4, 2, 1],</span></div>
<div class="line"><span class="lineno"> 1335</span><span class="stringliteral">           [1, 2, 4, 4, 4, 2, 1],</span></div>
<div class="line"><span class="lineno"> 1336</span><span class="stringliteral">           [1, 2, 4, 4, 4, 3, 1],</span></div>
<div class="line"><span class="lineno"> 1337</span><span class="stringliteral">           [1, 2, 2, 3, 3, 3, 1],</span></div>
<div class="line"><span class="lineno"> 1338</span><span class="stringliteral">           [1, 2, 2, 3, 3, 3, 1],</span></div>
<div class="line"><span class="lineno"> 1339</span><span class="stringliteral">           [1, 1, 1, 1, 1, 1, 1]])</span></div>
<div class="line"><span class="lineno"> 1340</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1341</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1342</span>    <span class="keywordflow">if</span> size <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> footprint <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> structure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1343</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;size, footprint, or structure must be specified&quot;</span>)</div>
<div class="line"><span class="lineno"> 1344</span>    <span class="keywordflow">if</span> structure <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1345</span>        structure = numpy.asarray(structure)</div>
<div class="line"><span class="lineno"> 1346</span>        structure = structure[tuple([slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)] *</div>
<div class="line"><span class="lineno"> 1347</span>                                    structure.ndim)]</div>
<div class="line"><span class="lineno"> 1348</span>    <span class="keywordflow">if</span> footprint <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1349</span>        footprint = numpy.asarray(footprint)</div>
<div class="line"><span class="lineno"> 1350</span>        footprint = footprint[tuple([slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)] *</div>
<div class="line"><span class="lineno"> 1351</span>                                    footprint.ndim)]</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno"> 1354</span>    origin = _ni_support._normalize_sequence(origin, input.ndim)</div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(len(origin)):</div>
<div class="line"><span class="lineno"> 1356</span>        origin[ii] = -origin[ii]</div>
<div class="line"><span class="lineno"> 1357</span>        <span class="keywordflow">if</span> footprint <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1358</span>            sz = footprint.shape[ii]</div>
<div class="line"><span class="lineno"> 1359</span>        <span class="keywordflow">elif</span> structure <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1360</span>            sz = structure.shape[ii]</div>
<div class="line"><span class="lineno"> 1361</span>        <span class="keywordflow">elif</span> numpy.isscalar(size):</div>
<div class="line"><span class="lineno"> 1362</span>            sz = size</div>
<div class="line"><span class="lineno"> 1363</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1364</span>            sz = size[ii]</div>
<div class="line"><span class="lineno"> 1365</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> sz &amp; 1:</div>
<div class="line"><span class="lineno"> 1366</span>            origin[ii] -= 1</div>
<div class="line"><span class="lineno"> 1367</span> </div>
<div class="line"><span class="lineno"> 1368</span>    <span class="keywordflow">return</span> _filters._min_or_max_filter(input, size, footprint, structure,</div>
<div class="line"><span class="lineno"> 1369</span>                                       output, mode, cval, origin, 0)</div>
<div class="line"><span class="lineno"> 1370</span> </div>
<div class="line"><span class="lineno"> 1371</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adea52fca905158ab16412ce44ef86515" name="adea52fca905158ab16412ce44ef86515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea52fca905158ab16412ce44ef86515">&#9670;&#160;</a></span>grey_erosion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.grey_erosion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>footprint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>&quot;reflect&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cval</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate a greyscale erosion, using either a structuring element,
or a footprint corresponding to a flat structuring element.

Grayscale erosion is a mathematical morphology operation. For the
simple case of a full and flat structuring element, it can be viewed
as a minimum filter over a sliding window.

Parameters
----------
input : array_like
    Array over which the grayscale erosion is to be computed.
size : tuple of ints
    Shape of a flat and full structuring element used for the grayscale
    erosion. Optional if `footprint` or `structure` is provided.
footprint : array of ints, optional
    Positions of non-infinite elements of a flat structuring element
    used for the grayscale erosion. Non-zero values give the set of
    neighbors of the center over which the minimum is chosen.
structure : array of ints, optional
    Structuring element used for the grayscale erosion. `structure`
    may be a non-flat structuring element.
output : array, optional
    An array used for storing the output of the erosion may be provided.
mode : {'reflect','constant','nearest','mirror', 'wrap'}, optional
    The `mode` parameter determines how the array borders are
    handled, where `cval` is the value when mode is equal to
    'constant'. Default is 'reflect'
cval : scalar, optional
    Value to fill past edges of input if `mode` is 'constant'. Default
    is 0.0.
origin : scalar, optional
    The `origin` parameter controls the placement of the filter.
    Default 0

Returns
-------
output : ndarray
    Grayscale erosion of `input`.

See also
--------
binary_erosion, grey_dilation, grey_opening, grey_closing
generate_binary_structure, minimum_filter

Notes
-----
The grayscale erosion of an image input by a structuring element s defined
over a domain E is given by:

(input+s)(x) = min {input(y) - s(x-y), for y in E}

In particular, for structuring elements defined as
s(y) = 0 for y in E, the grayscale erosion computes the minimum of the
input image inside a sliding window defined by E.

Grayscale erosion [1]_ is a *mathematical morphology* operation [2]_.

References
----------
.. [1] https://en.wikipedia.org/wiki/Erosion_%28morphology%29
.. [2] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((7,7), dtype=int)
&gt;&gt;&gt; a[1:6, 1:6] = 3
&gt;&gt;&gt; a[4,4] = 2; a[2,3] = 1
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 3, 3, 3, 3, 3, 0],
       [0, 3, 3, 1, 3, 3, 0],
       [0, 3, 3, 3, 3, 3, 0],
       [0, 3, 3, 3, 2, 3, 0],
       [0, 3, 3, 3, 3, 3, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.grey_erosion(a, size=(3,3))
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 3, 2, 2, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; footprint = ndimage.generate_binary_structure(2, 1)
&gt;&gt;&gt; footprint
array([[False,  True, False],
       [ True,  True,  True],
       [False,  True, False]], dtype=bool)
&gt;&gt;&gt; # Diagonally-connected elements are not considered neighbors
&gt;&gt;&gt; ndimage.grey_erosion(a, size=(3,3), footprint=footprint)
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 3, 1, 2, 0, 0],
       [0, 0, 3, 2, 2, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1115</span>                 output=<span class="keywordtype">None</span>, mode=<span class="stringliteral">&quot;reflect&quot;</span>, cval=0.0, origin=0):</div>
<div class="line"><span class="lineno"> 1116</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1117</span><span class="stringliteral">    Calculate a greyscale erosion, using either a structuring element,</span></div>
<div class="line"><span class="lineno"> 1118</span><span class="stringliteral">    or a footprint corresponding to a flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1119</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1120</span><span class="stringliteral">    Grayscale erosion is a mathematical morphology operation. For the</span></div>
<div class="line"><span class="lineno"> 1121</span><span class="stringliteral">    simple case of a full and flat structuring element, it can be viewed</span></div>
<div class="line"><span class="lineno"> 1122</span><span class="stringliteral">    as a minimum filter over a sliding window.</span></div>
<div class="line"><span class="lineno"> 1123</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1124</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1125</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1126</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1127</span><span class="stringliteral">        Array over which the grayscale erosion is to be computed.</span></div>
<div class="line"><span class="lineno"> 1128</span><span class="stringliteral">    size : tuple of ints</span></div>
<div class="line"><span class="lineno"> 1129</span><span class="stringliteral">        Shape of a flat and full structuring element used for the grayscale</span></div>
<div class="line"><span class="lineno"> 1130</span><span class="stringliteral">        erosion. Optional if `footprint` or `structure` is provided.</span></div>
<div class="line"><span class="lineno"> 1131</span><span class="stringliteral">    footprint : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1132</span><span class="stringliteral">        Positions of non-infinite elements of a flat structuring element</span></div>
<div class="line"><span class="lineno"> 1133</span><span class="stringliteral">        used for the grayscale erosion. Non-zero values give the set of</span></div>
<div class="line"><span class="lineno"> 1134</span><span class="stringliteral">        neighbors of the center over which the minimum is chosen.</span></div>
<div class="line"><span class="lineno"> 1135</span><span class="stringliteral">    structure : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1136</span><span class="stringliteral">        Structuring element used for the grayscale erosion. `structure`</span></div>
<div class="line"><span class="lineno"> 1137</span><span class="stringliteral">        may be a non-flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1138</span><span class="stringliteral">    output : array, optional</span></div>
<div class="line"><span class="lineno"> 1139</span><span class="stringliteral">        An array used for storing the output of the erosion may be provided.</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="stringliteral">    mode : {&#39;reflect&#39;,&#39;constant&#39;,&#39;nearest&#39;,&#39;mirror&#39;, &#39;wrap&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1141</span><span class="stringliteral">        The `mode` parameter determines how the array borders are</span></div>
<div class="line"><span class="lineno"> 1142</span><span class="stringliteral">        handled, where `cval` is the value when mode is equal to</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="stringliteral">        &#39;constant&#39;. Default is &#39;reflect&#39;</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="stringliteral">    cval : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1145</span><span class="stringliteral">        Value to fill past edges of input if `mode` is &#39;constant&#39;. Default</span></div>
<div class="line"><span class="lineno"> 1146</span><span class="stringliteral">        is 0.0.</span></div>
<div class="line"><span class="lineno"> 1147</span><span class="stringliteral">    origin : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1148</span><span class="stringliteral">        The `origin` parameter controls the placement of the filter.</span></div>
<div class="line"><span class="lineno"> 1149</span><span class="stringliteral">        Default 0</span></div>
<div class="line"><span class="lineno"> 1150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1151</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1152</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1153</span><span class="stringliteral">    output : ndarray</span></div>
<div class="line"><span class="lineno"> 1154</span><span class="stringliteral">        Grayscale erosion of `input`.</span></div>
<div class="line"><span class="lineno"> 1155</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1156</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1157</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1158</span><span class="stringliteral">    binary_erosion, grey_dilation, grey_opening, grey_closing</span></div>
<div class="line"><span class="lineno"> 1159</span><span class="stringliteral">    generate_binary_structure, minimum_filter</span></div>
<div class="line"><span class="lineno"> 1160</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1161</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1162</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1163</span><span class="stringliteral">    The grayscale erosion of an image input by a structuring element s defined</span></div>
<div class="line"><span class="lineno"> 1164</span><span class="stringliteral">    over a domain E is given by:</span></div>
<div class="line"><span class="lineno"> 1165</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1166</span><span class="stringliteral">    (input+s)(x) = min {input(y) - s(x-y), for y in E}</span></div>
<div class="line"><span class="lineno"> 1167</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1168</span><span class="stringliteral">    In particular, for structuring elements defined as</span></div>
<div class="line"><span class="lineno"> 1169</span><span class="stringliteral">    s(y) = 0 for y in E, the grayscale erosion computes the minimum of the</span></div>
<div class="line"><span class="lineno"> 1170</span><span class="stringliteral">    input image inside a sliding window defined by E.</span></div>
<div class="line"><span class="lineno"> 1171</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1172</span><span class="stringliteral">    Grayscale erosion [1]_ is a *mathematical morphology* operation [2]_.</span></div>
<div class="line"><span class="lineno"> 1173</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1174</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1175</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1176</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Erosion_%28morphology%29</span></div>
<div class="line"><span class="lineno"> 1177</span><span class="stringliteral">    .. [2] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno"> 1178</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1179</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1180</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1181</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1182</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((7,7), dtype=int)</span></div>
<div class="line"><span class="lineno"> 1183</span><span class="stringliteral">    &gt;&gt;&gt; a[1:6, 1:6] = 3</span></div>
<div class="line"><span class="lineno"> 1184</span><span class="stringliteral">    &gt;&gt;&gt; a[4,4] = 2; a[2,3] = 1</span></div>
<div class="line"><span class="lineno"> 1185</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno"> 1186</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1187</span><span class="stringliteral">           [0, 3, 3, 3, 3, 3, 0],</span></div>
<div class="line"><span class="lineno"> 1188</span><span class="stringliteral">           [0, 3, 3, 1, 3, 3, 0],</span></div>
<div class="line"><span class="lineno"> 1189</span><span class="stringliteral">           [0, 3, 3, 3, 3, 3, 0],</span></div>
<div class="line"><span class="lineno"> 1190</span><span class="stringliteral">           [0, 3, 3, 3, 2, 3, 0],</span></div>
<div class="line"><span class="lineno"> 1191</span><span class="stringliteral">           [0, 3, 3, 3, 3, 3, 0],</span></div>
<div class="line"><span class="lineno"> 1192</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1193</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_erosion(a, size=(3,3))</span></div>
<div class="line"><span class="lineno"> 1194</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1195</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1196</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1197</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1198</span><span class="stringliteral">           [0, 0, 3, 2, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1199</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1200</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1201</span><span class="stringliteral">    &gt;&gt;&gt; footprint = ndimage.generate_binary_structure(2, 1)</span></div>
<div class="line"><span class="lineno"> 1202</span><span class="stringliteral">    &gt;&gt;&gt; footprint</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="stringliteral">    array([[False,  True, False],</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">           [ True,  True,  True],</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral">           [False,  True, False]], dtype=bool)</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">    &gt;&gt;&gt; # Diagonally-connected elements are not considered neighbors</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_erosion(a, size=(3,3), footprint=footprint)</span></div>
<div class="line"><span class="lineno"> 1208</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1209</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1210</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1211</span><span class="stringliteral">           [0, 0, 3, 1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="stringliteral">           [0, 0, 3, 2, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1214</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1215</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1216</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1217</span>    <span class="keywordflow">if</span> size <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> footprint <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> structure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1218</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;size, footprint, or structure must be specified&quot;</span>)</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>    <span class="keywordflow">return</span> _filters._min_or_max_filter(input, size, footprint, structure,</div>
<div class="line"><span class="lineno"> 1221</span>                                       output, mode, cval, origin, 1)</div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a22d6712a86de6eb485961fc8726fcc52" name="a22d6712a86de6eb485961fc8726fcc52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d6712a86de6eb485961fc8726fcc52">&#9670;&#160;</a></span>grey_opening()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.grey_opening </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>footprint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>&quot;reflect&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cval</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional grayscale opening.

A grayscale opening consists in the succession of a grayscale erosion,
and a grayscale dilation.

Parameters
----------
input : array_like
    Array over which the grayscale opening is to be computed.
size : tuple of ints
    Shape of a flat and full structuring element used for the grayscale
    opening. Optional if `footprint` or `structure` is provided.
footprint : array of ints, optional
    Positions of non-infinite elements of a flat structuring element
    used for the grayscale opening.
structure : array of ints, optional
    Structuring element used for the grayscale opening. `structure`
    may be a non-flat structuring element.
output : array, optional
    An array used for storing the output of the opening may be provided.
mode : {'reflect', 'constant', 'nearest', 'mirror', 'wrap'}, optional
    The `mode` parameter determines how the array borders are
    handled, where `cval` is the value when mode is equal to
    'constant'. Default is 'reflect'
cval : scalar, optional
    Value to fill past edges of input if `mode` is 'constant'. Default
    is 0.0.
origin : scalar, optional
    The `origin` parameter controls the placement of the filter.
    Default 0

Returns
-------
grey_opening : ndarray
    Result of the grayscale opening of `input` with `structure`.

See also
--------
binary_opening, grey_dilation, grey_erosion, grey_closing
generate_binary_structure

Notes
-----
The action of a grayscale opening with a flat structuring element amounts
to smoothen high local maxima, whereas binary opening erases small objects.

References
----------
.. [1] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.arange(36).reshape((6,6))
&gt;&gt;&gt; a[3, 3] = 50
&gt;&gt;&gt; a
array([[ 0,  1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10, 11],
       [12, 13, 14, 15, 16, 17],
       [18, 19, 20, 50, 22, 23],
       [24, 25, 26, 27, 28, 29],
       [30, 31, 32, 33, 34, 35]])
&gt;&gt;&gt; ndimage.grey_opening(a, size=(3,3))
array([[ 0,  1,  2,  3,  4,  4],
       [ 6,  7,  8,  9, 10, 10],
       [12, 13, 14, 15, 16, 16],
       [18, 19, 20, 22, 22, 22],
       [24, 25, 26, 27, 28, 28],
       [24, 25, 26, 27, 28, 28]])
&gt;&gt;&gt; # Note that the local maximum a[3,3] has disappeared</pre> <div class="fragment"><div class="line"><span class="lineno"> 1373</span>                 output=<span class="keywordtype">None</span>, mode=<span class="stringliteral">&quot;reflect&quot;</span>, cval=0.0, origin=0):</div>
<div class="line"><span class="lineno"> 1374</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1375</span><span class="stringliteral">    Multidimensional grayscale opening.</span></div>
<div class="line"><span class="lineno"> 1376</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1377</span><span class="stringliteral">    A grayscale opening consists in the succession of a grayscale erosion,</span></div>
<div class="line"><span class="lineno"> 1378</span><span class="stringliteral">    and a grayscale dilation.</span></div>
<div class="line"><span class="lineno"> 1379</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1380</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1381</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1382</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1383</span><span class="stringliteral">        Array over which the grayscale opening is to be computed.</span></div>
<div class="line"><span class="lineno"> 1384</span><span class="stringliteral">    size : tuple of ints</span></div>
<div class="line"><span class="lineno"> 1385</span><span class="stringliteral">        Shape of a flat and full structuring element used for the grayscale</span></div>
<div class="line"><span class="lineno"> 1386</span><span class="stringliteral">        opening. Optional if `footprint` or `structure` is provided.</span></div>
<div class="line"><span class="lineno"> 1387</span><span class="stringliteral">    footprint : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1388</span><span class="stringliteral">        Positions of non-infinite elements of a flat structuring element</span></div>
<div class="line"><span class="lineno"> 1389</span><span class="stringliteral">        used for the grayscale opening.</span></div>
<div class="line"><span class="lineno"> 1390</span><span class="stringliteral">    structure : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1391</span><span class="stringliteral">        Structuring element used for the grayscale opening. `structure`</span></div>
<div class="line"><span class="lineno"> 1392</span><span class="stringliteral">        may be a non-flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1393</span><span class="stringliteral">    output : array, optional</span></div>
<div class="line"><span class="lineno"> 1394</span><span class="stringliteral">        An array used for storing the output of the opening may be provided.</span></div>
<div class="line"><span class="lineno"> 1395</span><span class="stringliteral">    mode : {&#39;reflect&#39;, &#39;constant&#39;, &#39;nearest&#39;, &#39;mirror&#39;, &#39;wrap&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1396</span><span class="stringliteral">        The `mode` parameter determines how the array borders are</span></div>
<div class="line"><span class="lineno"> 1397</span><span class="stringliteral">        handled, where `cval` is the value when mode is equal to</span></div>
<div class="line"><span class="lineno"> 1398</span><span class="stringliteral">        &#39;constant&#39;. Default is &#39;reflect&#39;</span></div>
<div class="line"><span class="lineno"> 1399</span><span class="stringliteral">    cval : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1400</span><span class="stringliteral">        Value to fill past edges of input if `mode` is &#39;constant&#39;. Default</span></div>
<div class="line"><span class="lineno"> 1401</span><span class="stringliteral">        is 0.0.</span></div>
<div class="line"><span class="lineno"> 1402</span><span class="stringliteral">    origin : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1403</span><span class="stringliteral">        The `origin` parameter controls the placement of the filter.</span></div>
<div class="line"><span class="lineno"> 1404</span><span class="stringliteral">        Default 0</span></div>
<div class="line"><span class="lineno"> 1405</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1406</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1407</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1408</span><span class="stringliteral">    grey_opening : ndarray</span></div>
<div class="line"><span class="lineno"> 1409</span><span class="stringliteral">        Result of the grayscale opening of `input` with `structure`.</span></div>
<div class="line"><span class="lineno"> 1410</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1411</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1412</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1413</span><span class="stringliteral">    binary_opening, grey_dilation, grey_erosion, grey_closing</span></div>
<div class="line"><span class="lineno"> 1414</span><span class="stringliteral">    generate_binary_structure</span></div>
<div class="line"><span class="lineno"> 1415</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1416</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1417</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1418</span><span class="stringliteral">    The action of a grayscale opening with a flat structuring element amounts</span></div>
<div class="line"><span class="lineno"> 1419</span><span class="stringliteral">    to smoothen high local maxima, whereas binary opening erases small objects.</span></div>
<div class="line"><span class="lineno"> 1420</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1421</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1422</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1423</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno"> 1424</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1425</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1426</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1427</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1428</span><span class="stringliteral">    &gt;&gt;&gt; a = np.arange(36).reshape((6,6))</span></div>
<div class="line"><span class="lineno"> 1429</span><span class="stringliteral">    &gt;&gt;&gt; a[3, 3] = 50</span></div>
<div class="line"><span class="lineno"> 1430</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno"> 1431</span><span class="stringliteral">    array([[ 0,  1,  2,  3,  4,  5],</span></div>
<div class="line"><span class="lineno"> 1432</span><span class="stringliteral">           [ 6,  7,  8,  9, 10, 11],</span></div>
<div class="line"><span class="lineno"> 1433</span><span class="stringliteral">           [12, 13, 14, 15, 16, 17],</span></div>
<div class="line"><span class="lineno"> 1434</span><span class="stringliteral">           [18, 19, 20, 50, 22, 23],</span></div>
<div class="line"><span class="lineno"> 1435</span><span class="stringliteral">           [24, 25, 26, 27, 28, 29],</span></div>
<div class="line"><span class="lineno"> 1436</span><span class="stringliteral">           [30, 31, 32, 33, 34, 35]])</span></div>
<div class="line"><span class="lineno"> 1437</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_opening(a, size=(3,3))</span></div>
<div class="line"><span class="lineno"> 1438</span><span class="stringliteral">    array([[ 0,  1,  2,  3,  4,  4],</span></div>
<div class="line"><span class="lineno"> 1439</span><span class="stringliteral">           [ 6,  7,  8,  9, 10, 10],</span></div>
<div class="line"><span class="lineno"> 1440</span><span class="stringliteral">           [12, 13, 14, 15, 16, 16],</span></div>
<div class="line"><span class="lineno"> 1441</span><span class="stringliteral">           [18, 19, 20, 22, 22, 22],</span></div>
<div class="line"><span class="lineno"> 1442</span><span class="stringliteral">           [24, 25, 26, 27, 28, 28],</span></div>
<div class="line"><span class="lineno"> 1443</span><span class="stringliteral">           [24, 25, 26, 27, 28, 28]])</span></div>
<div class="line"><span class="lineno"> 1444</span><span class="stringliteral">    &gt;&gt;&gt; # Note that the local maximum a[3,3] has disappeared</span></div>
<div class="line"><span class="lineno"> 1445</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1446</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1447</span>    <span class="keywordflow">if</span> (size <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>) <span class="keywordflow">and</span> (footprint <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1448</span>        warnings.warn(<span class="stringliteral">&quot;ignoring size because footprint is set&quot;</span>, UserWarning, stacklevel=2)</div>
<div class="line"><span class="lineno"> 1449</span>    tmp = grey_erosion(input, size, footprint, structure, <span class="keywordtype">None</span>, mode,</div>
<div class="line"><span class="lineno"> 1450</span>                       cval, origin)</div>
<div class="line"><span class="lineno"> 1451</span>    <span class="keywordflow">return</span> grey_dilation(tmp, size, footprint, structure, output, mode,</div>
<div class="line"><span class="lineno"> 1452</span>                         cval, origin)</div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9dd391da5464b292a7b7880e7df2ec8c" name="a9dd391da5464b292a7b7880e7df2ec8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dd391da5464b292a7b7880e7df2ec8c">&#9670;&#160;</a></span>iterate_structure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.iterate_structure </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Iterate a structure by dilating it with itself.

Parameters
----------
structure : array_like
   Structuring element (an array of bools, for example), to be dilated with
   itself.
iterations : int
   number of dilations performed on the structure with itself
origin : optional
    If origin is None, only the iterated structure is returned. If
    not, a tuple of the iterated structure and the modified origin is
    returned.

Returns
-------
iterate_structure : ndarray of bools
    A new structuring element obtained by dilating `structure`
    (`iterations` - 1) times with itself.

See also
--------
generate_binary_structure

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; struct = ndimage.generate_binary_structure(2, 1)
&gt;&gt;&gt; struct.astype(int)
array([[0, 1, 0],
       [1, 1, 1],
       [0, 1, 0]])
&gt;&gt;&gt; ndimage.iterate_structure(struct, 2).astype(int)
array([[0, 0, 1, 0, 0],
       [0, 1, 1, 1, 0],
       [1, 1, 1, 1, 1],
       [0, 1, 1, 1, 0],
       [0, 0, 1, 0, 0]])
&gt;&gt;&gt; ndimage.iterate_structure(struct, 3).astype(int)
array([[0, 0, 0, 1, 0, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [1, 1, 1, 1, 1, 1, 1],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 0, 1, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno">   55</span><span class="keyword">def </span>iterate_structure(structure, iterations, origin=None):</div>
<div class="line"><span class="lineno">   56</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    Iterate a structure by dilating it with itself.</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">    structure : array_like</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">       Structuring element (an array of bools, for example), to be dilated with</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">       itself.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">    iterations : int</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">       number of dilations performed on the structure with itself</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    origin : optional</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">        If origin is None, only the iterated structure is returned. If</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        not, a tuple of the iterated structure and the modified origin is</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">    iterate_structure : ndarray of bools</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        A new structuring element obtained by dilating `structure`</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        (`iterations` - 1) times with itself.</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    generate_binary_structure</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    &gt;&gt;&gt; struct = ndimage.generate_binary_structure(2, 1)</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">    &gt;&gt;&gt; struct.astype(int)</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">    array([[0, 1, 0],</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">           [1, 1, 1],</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">           [0, 1, 0]])</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.iterate_structure(struct, 2).astype(int)</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    array([[0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">           [1, 1, 1, 1, 1],</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">           [0, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">           [0, 0, 1, 0, 0]])</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.iterate_structure(struct, 3).astype(int)</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    array([[0, 0, 0, 1, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">           [1, 1, 1, 1, 1, 1, 1],</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  105</span>    structure = numpy.asarray(structure)</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">if</span> iterations &lt; 2:</div>
<div class="line"><span class="lineno">  107</span>        <span class="keywordflow">return</span> structure.copy()</div>
<div class="line"><span class="lineno">  108</span>    ni = iterations - 1</div>
<div class="line"><span class="lineno">  109</span>    shape = [ii + ni * (ii - 1) <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> structure.shape]</div>
<div class="line"><span class="lineno">  110</span>    pos = [ni * (structure.shape[ii] // 2) <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(len(shape))]</div>
<div class="line"><span class="lineno">  111</span>    slc = tuple(slice(pos[ii], pos[ii] + structure.shape[ii], <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  112</span>                <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> range(len(shape)))</div>
<div class="line"><span class="lineno">  113</span>    out = numpy.zeros(shape, bool)</div>
<div class="line"><span class="lineno">  114</span>    out[slc] = structure != 0</div>
<div class="line"><span class="lineno">  115</span>    out = binary_dilation(out, structure, iterations=ni)</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">if</span> origin <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  117</span>        <span class="keywordflow">return</span> out</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  119</span>        origin = _ni_support._normalize_sequence(origin, structure.ndim)</div>
<div class="line"><span class="lineno">  120</span>        origin = [iterations * o <span class="keywordflow">for</span> o <span class="keywordflow">in</span> origin]</div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">return</span> out, origin</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2adc01fa7bd196f6b4e192bea82c7766" name="a2adc01fa7bd196f6b4e192bea82c7766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2adc01fa7bd196f6b4e192bea82c7766">&#9670;&#160;</a></span>morphological_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.morphological_gradient </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>footprint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>&quot;reflect&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cval</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional morphological gradient.

The morphological gradient is calculated as the difference between a
dilation and an erosion of the input with a given structuring element.

Parameters
----------
input : array_like
    Array over which to compute the morphlogical gradient.
size : tuple of ints
    Shape of a flat and full structuring element used for the mathematical
    morphology operations. Optional if `footprint` or `structure` is
    provided. A larger `size` yields a more blurred gradient.
footprint : array of ints, optional
    Positions of non-infinite elements of a flat structuring element
    used for the morphology operations. Larger footprints
    give a more blurred morphological gradient.
structure : array of ints, optional
    Structuring element used for the morphology operations.
    `structure` may be a non-flat structuring element.
output : array, optional
    An array used for storing the output of the morphological gradient
    may be provided.
mode : {'reflect', 'constant', 'nearest', 'mirror', 'wrap'}, optional
    The `mode` parameter determines how the array borders are
    handled, where `cval` is the value when mode is equal to
    'constant'. Default is 'reflect'
cval : scalar, optional
    Value to fill past edges of input if `mode` is 'constant'. Default
    is 0.0.
origin : scalar, optional
    The `origin` parameter controls the placement of the filter.
    Default 0

Returns
-------
morphological_gradient : ndarray
    Morphological gradient of `input`.

See also
--------
grey_dilation, grey_erosion, gaussian_gradient_magnitude

Notes
-----
For a flat structuring element, the morphological gradient
computed at a given point corresponds to the maximal difference
between elements of the input among the elements covered by the
structuring element centered on the point.

References
----------
.. [1] https://en.wikipedia.org/wiki/Mathematical_morphology

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((7,7), dtype=int)
&gt;&gt;&gt; a[2:5, 2:5] = 1
&gt;&gt;&gt; ndimage.morphological_gradient(a, size=(3,3))
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 1, 1, 0, 1, 1, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; # The morphological gradient is computed as the difference
&gt;&gt;&gt; # between a dilation and an erosion
&gt;&gt;&gt; ndimage.grey_dilation(a, size=(3,3)) -\\
...  ndimage.grey_erosion(a, size=(3,3))
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 1, 1, 0, 1, 1, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 1, 1, 1, 1, 1, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; a = np.zeros((7,7), dtype=int)
&gt;&gt;&gt; a[2:5, 2:5] = 1
&gt;&gt;&gt; a[4,4] = 2; a[2,3] = 3
&gt;&gt;&gt; a
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 1, 3, 1, 0, 0],
       [0, 0, 1, 1, 1, 0, 0],
       [0, 0, 1, 1, 2, 0, 0],
       [0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.morphological_gradient(a, size=(3,3))
array([[0, 0, 0, 0, 0, 0, 0],
       [0, 1, 3, 3, 3, 1, 0],
       [0, 1, 3, 3, 3, 1, 0],
       [0, 1, 3, 2, 3, 2, 0],
       [0, 1, 1, 2, 2, 2, 0],
       [0, 1, 1, 2, 2, 2, 0],
       [0, 0, 0, 0, 0, 0, 0]])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1539</span>                           output=<span class="keywordtype">None</span>, mode=<span class="stringliteral">&quot;reflect&quot;</span>, cval=0.0, origin=0):</div>
<div class="line"><span class="lineno"> 1540</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1541</span><span class="stringliteral">    Multidimensional morphological gradient.</span></div>
<div class="line"><span class="lineno"> 1542</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1543</span><span class="stringliteral">    The morphological gradient is calculated as the difference between a</span></div>
<div class="line"><span class="lineno"> 1544</span><span class="stringliteral">    dilation and an erosion of the input with a given structuring element.</span></div>
<div class="line"><span class="lineno"> 1545</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1546</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1547</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1548</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1549</span><span class="stringliteral">        Array over which to compute the morphlogical gradient.</span></div>
<div class="line"><span class="lineno"> 1550</span><span class="stringliteral">    size : tuple of ints</span></div>
<div class="line"><span class="lineno"> 1551</span><span class="stringliteral">        Shape of a flat and full structuring element used for the mathematical</span></div>
<div class="line"><span class="lineno"> 1552</span><span class="stringliteral">        morphology operations. Optional if `footprint` or `structure` is</span></div>
<div class="line"><span class="lineno"> 1553</span><span class="stringliteral">        provided. A larger `size` yields a more blurred gradient.</span></div>
<div class="line"><span class="lineno"> 1554</span><span class="stringliteral">    footprint : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1555</span><span class="stringliteral">        Positions of non-infinite elements of a flat structuring element</span></div>
<div class="line"><span class="lineno"> 1556</span><span class="stringliteral">        used for the morphology operations. Larger footprints</span></div>
<div class="line"><span class="lineno"> 1557</span><span class="stringliteral">        give a more blurred morphological gradient.</span></div>
<div class="line"><span class="lineno"> 1558</span><span class="stringliteral">    structure : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1559</span><span class="stringliteral">        Structuring element used for the morphology operations.</span></div>
<div class="line"><span class="lineno"> 1560</span><span class="stringliteral">        `structure` may be a non-flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1561</span><span class="stringliteral">    output : array, optional</span></div>
<div class="line"><span class="lineno"> 1562</span><span class="stringliteral">        An array used for storing the output of the morphological gradient</span></div>
<div class="line"><span class="lineno"> 1563</span><span class="stringliteral">        may be provided.</span></div>
<div class="line"><span class="lineno"> 1564</span><span class="stringliteral">    mode : {&#39;reflect&#39;, &#39;constant&#39;, &#39;nearest&#39;, &#39;mirror&#39;, &#39;wrap&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1565</span><span class="stringliteral">        The `mode` parameter determines how the array borders are</span></div>
<div class="line"><span class="lineno"> 1566</span><span class="stringliteral">        handled, where `cval` is the value when mode is equal to</span></div>
<div class="line"><span class="lineno"> 1567</span><span class="stringliteral">        &#39;constant&#39;. Default is &#39;reflect&#39;</span></div>
<div class="line"><span class="lineno"> 1568</span><span class="stringliteral">    cval : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1569</span><span class="stringliteral">        Value to fill past edges of input if `mode` is &#39;constant&#39;. Default</span></div>
<div class="line"><span class="lineno"> 1570</span><span class="stringliteral">        is 0.0.</span></div>
<div class="line"><span class="lineno"> 1571</span><span class="stringliteral">    origin : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1572</span><span class="stringliteral">        The `origin` parameter controls the placement of the filter.</span></div>
<div class="line"><span class="lineno"> 1573</span><span class="stringliteral">        Default 0</span></div>
<div class="line"><span class="lineno"> 1574</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1575</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1576</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1577</span><span class="stringliteral">    morphological_gradient : ndarray</span></div>
<div class="line"><span class="lineno"> 1578</span><span class="stringliteral">        Morphological gradient of `input`.</span></div>
<div class="line"><span class="lineno"> 1579</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1580</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1581</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1582</span><span class="stringliteral">    grey_dilation, grey_erosion, gaussian_gradient_magnitude</span></div>
<div class="line"><span class="lineno"> 1583</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1584</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1585</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1586</span><span class="stringliteral">    For a flat structuring element, the morphological gradient</span></div>
<div class="line"><span class="lineno"> 1587</span><span class="stringliteral">    computed at a given point corresponds to the maximal difference</span></div>
<div class="line"><span class="lineno"> 1588</span><span class="stringliteral">    between elements of the input among the elements covered by the</span></div>
<div class="line"><span class="lineno"> 1589</span><span class="stringliteral">    structuring element centered on the point.</span></div>
<div class="line"><span class="lineno"> 1590</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1591</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1592</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1593</span><span class="stringliteral">    .. [1] https://en.wikipedia.org/wiki/Mathematical_morphology</span></div>
<div class="line"><span class="lineno"> 1594</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1595</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1596</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1597</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1598</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((7,7), dtype=int)</span></div>
<div class="line"><span class="lineno"> 1599</span><span class="stringliteral">    &gt;&gt;&gt; a[2:5, 2:5] = 1</span></div>
<div class="line"><span class="lineno"> 1600</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.morphological_gradient(a, size=(3,3))</span></div>
<div class="line"><span class="lineno"> 1601</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1602</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1603</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1604</span><span class="stringliteral">           [0, 1, 1, 0, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1605</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1606</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1607</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1608</span><span class="stringliteral">    &gt;&gt;&gt; # The morphological gradient is computed as the difference</span></div>
<div class="line"><span class="lineno"> 1609</span><span class="stringliteral">    &gt;&gt;&gt; # between a dilation and an erosion</span></div>
<div class="line"><span class="lineno"> 1610</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.grey_dilation(a, size=(3,3)) -\\</span></div>
<div class="line"><span class="lineno"> 1611</span><span class="stringliteral">    ...  ndimage.grey_erosion(a, size=(3,3))</span></div>
<div class="line"><span class="lineno"> 1612</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1613</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1614</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1615</span><span class="stringliteral">           [0, 1, 1, 0, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1616</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1617</span><span class="stringliteral">           [0, 1, 1, 1, 1, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1618</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1619</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((7,7), dtype=int)</span></div>
<div class="line"><span class="lineno"> 1620</span><span class="stringliteral">    &gt;&gt;&gt; a[2:5, 2:5] = 1</span></div>
<div class="line"><span class="lineno"> 1621</span><span class="stringliteral">    &gt;&gt;&gt; a[4,4] = 2; a[2,3] = 3</span></div>
<div class="line"><span class="lineno"> 1622</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno"> 1623</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1624</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1625</span><span class="stringliteral">           [0, 0, 1, 3, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1626</span><span class="stringliteral">           [0, 0, 1, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1627</span><span class="stringliteral">           [0, 0, 1, 1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1628</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1629</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1630</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.morphological_gradient(a, size=(3,3))</span></div>
<div class="line"><span class="lineno"> 1631</span><span class="stringliteral">    array([[0, 0, 0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1632</span><span class="stringliteral">           [0, 1, 3, 3, 3, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1633</span><span class="stringliteral">           [0, 1, 3, 3, 3, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1634</span><span class="stringliteral">           [0, 1, 3, 2, 3, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1635</span><span class="stringliteral">           [0, 1, 1, 2, 2, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1636</span><span class="stringliteral">           [0, 1, 1, 2, 2, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1637</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1638</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1639</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1640</span>    tmp = grey_dilation(input, size, footprint, structure, <span class="keywordtype">None</span>, mode,</div>
<div class="line"><span class="lineno"> 1641</span>                        cval, origin)</div>
<div class="line"><span class="lineno"> 1642</span>    <span class="keywordflow">if</span> isinstance(output, numpy.ndarray):</div>
<div class="line"><span class="lineno"> 1643</span>        grey_erosion(input, size, footprint, structure, output, mode,</div>
<div class="line"><span class="lineno"> 1644</span>                     cval, origin)</div>
<div class="line"><span class="lineno"> 1645</span>        <span class="keywordflow">return</span> numpy.subtract(tmp, output, output)</div>
<div class="line"><span class="lineno"> 1646</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1647</span>        <span class="keywordflow">return</span> (tmp - grey_erosion(input, size, footprint, structure,</div>
<div class="line"><span class="lineno"> 1648</span>                                   <span class="keywordtype">None</span>, mode, cval, origin))</div>
<div class="line"><span class="lineno"> 1649</span> </div>
<div class="line"><span class="lineno"> 1650</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0fff8ab8112efaac5e8468232ef05fc5" name="a0fff8ab8112efaac5e8468232ef05fc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fff8ab8112efaac5e8468232ef05fc5">&#9670;&#160;</a></span>morphological_laplace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.morphological_laplace </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>footprint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>&quot;reflect&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cval</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional morphological laplace.

Parameters
----------
input : array_like
    Input.
size : int or sequence of ints, optional
    See `structure`.
footprint : bool or ndarray, optional
    See `structure`.
structure : structure, optional
    Either `size`, `footprint`, or the `structure` must be provided.
output : ndarray, optional
    An output array can optionally be provided.
mode : {'reflect','constant','nearest','mirror', 'wrap'}, optional
    The mode parameter determines how the array borders are handled.
    For 'constant' mode, values beyond borders are set to be `cval`.
    Default is 'reflect'.
cval : scalar, optional
    Value to fill past edges of input if mode is 'constant'.
    Default is 0.0
origin : origin, optional
    The origin parameter controls the placement of the filter.

Returns
-------
morphological_laplace : ndarray
    Output</pre> <div class="fragment"><div class="line"><span class="lineno"> 1653</span>                          mode=<span class="stringliteral">&quot;reflect&quot;</span>, cval=0.0, origin=0):</div>
<div class="line"><span class="lineno"> 1654</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1655</span><span class="stringliteral">    Multidimensional morphological laplace.</span></div>
<div class="line"><span class="lineno"> 1656</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1657</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1658</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1659</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1660</span><span class="stringliteral">        Input.</span></div>
<div class="line"><span class="lineno"> 1661</span><span class="stringliteral">    size : int or sequence of ints, optional</span></div>
<div class="line"><span class="lineno"> 1662</span><span class="stringliteral">        See `structure`.</span></div>
<div class="line"><span class="lineno"> 1663</span><span class="stringliteral">    footprint : bool or ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1664</span><span class="stringliteral">        See `structure`.</span></div>
<div class="line"><span class="lineno"> 1665</span><span class="stringliteral">    structure : structure, optional</span></div>
<div class="line"><span class="lineno"> 1666</span><span class="stringliteral">        Either `size`, `footprint`, or the `structure` must be provided.</span></div>
<div class="line"><span class="lineno"> 1667</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1668</span><span class="stringliteral">        An output array can optionally be provided.</span></div>
<div class="line"><span class="lineno"> 1669</span><span class="stringliteral">    mode : {&#39;reflect&#39;,&#39;constant&#39;,&#39;nearest&#39;,&#39;mirror&#39;, &#39;wrap&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1670</span><span class="stringliteral">        The mode parameter determines how the array borders are handled.</span></div>
<div class="line"><span class="lineno"> 1671</span><span class="stringliteral">        For &#39;constant&#39; mode, values beyond borders are set to be `cval`.</span></div>
<div class="line"><span class="lineno"> 1672</span><span class="stringliteral">        Default is &#39;reflect&#39;.</span></div>
<div class="line"><span class="lineno"> 1673</span><span class="stringliteral">    cval : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1674</span><span class="stringliteral">        Value to fill past edges of input if mode is &#39;constant&#39;.</span></div>
<div class="line"><span class="lineno"> 1675</span><span class="stringliteral">        Default is 0.0</span></div>
<div class="line"><span class="lineno"> 1676</span><span class="stringliteral">    origin : origin, optional</span></div>
<div class="line"><span class="lineno"> 1677</span><span class="stringliteral">        The origin parameter controls the placement of the filter.</span></div>
<div class="line"><span class="lineno"> 1678</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1679</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1680</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1681</span><span class="stringliteral">    morphological_laplace : ndarray</span></div>
<div class="line"><span class="lineno"> 1682</span><span class="stringliteral">        Output</span></div>
<div class="line"><span class="lineno"> 1683</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1684</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1685</span>    tmp1 = grey_dilation(input, size, footprint, structure, <span class="keywordtype">None</span>, mode,</div>
<div class="line"><span class="lineno"> 1686</span>                         cval, origin)</div>
<div class="line"><span class="lineno"> 1687</span>    <span class="keywordflow">if</span> isinstance(output, numpy.ndarray):</div>
<div class="line"><span class="lineno"> 1688</span>        grey_erosion(input, size, footprint, structure, output, mode,</div>
<div class="line"><span class="lineno"> 1689</span>                     cval, origin)</div>
<div class="line"><span class="lineno"> 1690</span>        numpy.add(tmp1, output, output)</div>
<div class="line"><span class="lineno"> 1691</span>        numpy.subtract(output, input, output)</div>
<div class="line"><span class="lineno"> 1692</span>        <span class="keywordflow">return</span> numpy.subtract(output, input, output)</div>
<div class="line"><span class="lineno"> 1693</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1694</span>        tmp2 = grey_erosion(input, size, footprint, structure, <span class="keywordtype">None</span>, mode,</div>
<div class="line"><span class="lineno"> 1695</span>                            cval, origin)</div>
<div class="line"><span class="lineno"> 1696</span>        numpy.add(tmp1, tmp2, tmp2)</div>
<div class="line"><span class="lineno"> 1697</span>        numpy.subtract(tmp2, input, tmp2)</div>
<div class="line"><span class="lineno"> 1698</span>        numpy.subtract(tmp2, input, tmp2)</div>
<div class="line"><span class="lineno"> 1699</span>        <span class="keywordflow">return</span> tmp2</div>
<div class="line"><span class="lineno"> 1700</span> </div>
<div class="line"><span class="lineno"> 1701</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afc672dbc002ca4d3046d93c4f97917df" name="afc672dbc002ca4d3046d93c4f97917df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc672dbc002ca4d3046d93c4f97917df">&#9670;&#160;</a></span>white_tophat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._morphology.white_tophat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>footprint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>&quot;reflect&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cval</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Multidimensional white tophat filter.

Parameters
----------
input : array_like
    Input.
size : tuple of ints
    Shape of a flat and full structuring element used for the filter.
    Optional if `footprint` or `structure` is provided.
footprint : array of ints, optional
    Positions of elements of a flat structuring element
    used for the white tophat filter.
structure : array of ints, optional
    Structuring element used for the filter. `structure`
    may be a non-flat structuring element.
output : array, optional
    An array used for storing the output of the filter may be provided.
mode : {'reflect', 'constant', 'nearest', 'mirror', 'wrap'}, optional
    The `mode` parameter determines how the array borders are
    handled, where `cval` is the value when mode is equal to
    'constant'. Default is 'reflect'
cval : scalar, optional
    Value to fill past edges of input if `mode` is 'constant'.
    Default is 0.0.
origin : scalar, optional
    The `origin` parameter controls the placement of the filter.
    Default is 0.

Returns
-------
output : ndarray
    Result of the filter of `input` with `structure`.

Examples
--------
Subtract gray background from a bright peak.

&gt;&gt;&gt; from scipy.ndimage import generate_binary_structure, white_tophat
&gt;&gt;&gt; square = generate_binary_structure(rank=2, connectivity=3)
&gt;&gt;&gt; bright_on_gray = np.array([[2, 3, 3, 3, 2],
...                            [3, 4, 5, 4, 3],
...                            [3, 5, 9, 5, 3],
...                            [3, 4, 5, 4, 3],
...                            [2, 3, 3, 3, 2]])
&gt;&gt;&gt; white_tophat(input=bright_on_gray, structure=square)
array([[0, 0, 0, 0, 0],
       [0, 0, 1, 0, 0],
       [0, 1, 5, 1, 0],
       [0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0]])

See also
--------
black_tophat</pre> <div class="fragment"><div class="line"><span class="lineno"> 1703</span>                 output=<span class="keywordtype">None</span>, mode=<span class="stringliteral">&quot;reflect&quot;</span>, cval=0.0, origin=0):</div>
<div class="line"><span class="lineno"> 1704</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1705</span><span class="stringliteral">    Multidimensional white tophat filter.</span></div>
<div class="line"><span class="lineno"> 1706</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1707</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1708</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1709</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1710</span><span class="stringliteral">        Input.</span></div>
<div class="line"><span class="lineno"> 1711</span><span class="stringliteral">    size : tuple of ints</span></div>
<div class="line"><span class="lineno"> 1712</span><span class="stringliteral">        Shape of a flat and full structuring element used for the filter.</span></div>
<div class="line"><span class="lineno"> 1713</span><span class="stringliteral">        Optional if `footprint` or `structure` is provided.</span></div>
<div class="line"><span class="lineno"> 1714</span><span class="stringliteral">    footprint : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1715</span><span class="stringliteral">        Positions of elements of a flat structuring element</span></div>
<div class="line"><span class="lineno"> 1716</span><span class="stringliteral">        used for the white tophat filter.</span></div>
<div class="line"><span class="lineno"> 1717</span><span class="stringliteral">    structure : array of ints, optional</span></div>
<div class="line"><span class="lineno"> 1718</span><span class="stringliteral">        Structuring element used for the filter. `structure`</span></div>
<div class="line"><span class="lineno"> 1719</span><span class="stringliteral">        may be a non-flat structuring element.</span></div>
<div class="line"><span class="lineno"> 1720</span><span class="stringliteral">    output : array, optional</span></div>
<div class="line"><span class="lineno"> 1721</span><span class="stringliteral">        An array used for storing the output of the filter may be provided.</span></div>
<div class="line"><span class="lineno"> 1722</span><span class="stringliteral">    mode : {&#39;reflect&#39;, &#39;constant&#39;, &#39;nearest&#39;, &#39;mirror&#39;, &#39;wrap&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1723</span><span class="stringliteral">        The `mode` parameter determines how the array borders are</span></div>
<div class="line"><span class="lineno"> 1724</span><span class="stringliteral">        handled, where `cval` is the value when mode is equal to</span></div>
<div class="line"><span class="lineno"> 1725</span><span class="stringliteral">        &#39;constant&#39;. Default is &#39;reflect&#39;</span></div>
<div class="line"><span class="lineno"> 1726</span><span class="stringliteral">    cval : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1727</span><span class="stringliteral">        Value to fill past edges of input if `mode` is &#39;constant&#39;.</span></div>
<div class="line"><span class="lineno"> 1728</span><span class="stringliteral">        Default is 0.0.</span></div>
<div class="line"><span class="lineno"> 1729</span><span class="stringliteral">    origin : scalar, optional</span></div>
<div class="line"><span class="lineno"> 1730</span><span class="stringliteral">        The `origin` parameter controls the placement of the filter.</span></div>
<div class="line"><span class="lineno"> 1731</span><span class="stringliteral">        Default is 0.</span></div>
<div class="line"><span class="lineno"> 1732</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1733</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1734</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1735</span><span class="stringliteral">    output : ndarray</span></div>
<div class="line"><span class="lineno"> 1736</span><span class="stringliteral">        Result of the filter of `input` with `structure`.</span></div>
<div class="line"><span class="lineno"> 1737</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1738</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1739</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1740</span><span class="stringliteral">    Subtract gray background from a bright peak.</span></div>
<div class="line"><span class="lineno"> 1741</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1742</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.ndimage import generate_binary_structure, white_tophat</span></div>
<div class="line"><span class="lineno"> 1743</span><span class="stringliteral">    &gt;&gt;&gt; square = generate_binary_structure(rank=2, connectivity=3)</span></div>
<div class="line"><span class="lineno"> 1744</span><span class="stringliteral">    &gt;&gt;&gt; bright_on_gray = np.array([[2, 3, 3, 3, 2],</span></div>
<div class="line"><span class="lineno"> 1745</span><span class="stringliteral">    ...                            [3, 4, 5, 4, 3],</span></div>
<div class="line"><span class="lineno"> 1746</span><span class="stringliteral">    ...                            [3, 5, 9, 5, 3],</span></div>
<div class="line"><span class="lineno"> 1747</span><span class="stringliteral">    ...                            [3, 4, 5, 4, 3],</span></div>
<div class="line"><span class="lineno"> 1748</span><span class="stringliteral">    ...                            [2, 3, 3, 3, 2]])</span></div>
<div class="line"><span class="lineno"> 1749</span><span class="stringliteral">    &gt;&gt;&gt; white_tophat(input=bright_on_gray, structure=square)</span></div>
<div class="line"><span class="lineno"> 1750</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1751</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1752</span><span class="stringliteral">           [0, 1, 5, 1, 0],</span></div>
<div class="line"><span class="lineno"> 1753</span><span class="stringliteral">           [0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1754</span><span class="stringliteral">           [0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1755</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1756</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1757</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1758</span><span class="stringliteral">    black_tophat</span></div>
<div class="line"><span class="lineno"> 1759</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1760</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1761</span>    <span class="keywordflow">if</span> (size <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>) <span class="keywordflow">and</span> (footprint <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1762</span>        warnings.warn(<span class="stringliteral">&quot;ignoring size because footprint is set&quot;</span>, UserWarning, stacklevel=2)</div>
<div class="line"><span class="lineno"> 1763</span>    tmp = grey_erosion(input, size, footprint, structure, <span class="keywordtype">None</span>, mode,</div>
<div class="line"><span class="lineno"> 1764</span>                       cval, origin)</div>
<div class="line"><span class="lineno"> 1765</span>    tmp = grey_dilation(tmp, size, footprint, structure, output, mode,</div>
<div class="line"><span class="lineno"> 1766</span>                        cval, origin)</div>
<div class="line"><span class="lineno"> 1767</span>    <span class="keywordflow">if</span> tmp <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1768</span>        tmp = output</div>
<div class="line"><span class="lineno"> 1769</span> </div>
<div class="line"><span class="lineno"> 1770</span>    <span class="keywordflow">if</span> input.dtype == numpy.bool_ <span class="keywordflow">and</span> tmp.dtype == numpy.bool_:</div>
<div class="line"><span class="lineno"> 1771</span>        numpy.bitwise_xor(input, tmp, out=tmp)</div>
<div class="line"><span class="lineno"> 1772</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1773</span>        numpy.subtract(input, tmp, out=tmp)</div>
<div class="line"><span class="lineno"> 1774</span>    <span class="keywordflow">return</span> tmp</div>
<div class="line"><span class="lineno"> 1775</span> </div>
<div class="line"><span class="lineno"> 1776</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
