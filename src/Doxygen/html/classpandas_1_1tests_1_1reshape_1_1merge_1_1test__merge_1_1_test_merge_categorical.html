<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.tests.reshape.merge.test_merge.TestMergeCategorical Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape.html">reshape</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge.html">merge</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html">test_merge</a></li><li class="navelem"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html">TestMergeCategorical</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">pandas.tests.reshape.merge.test_merge.TestMergeCategorical Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a50508fd4f1d694f19c7512621fd03af7" id="r_a50508fd4f1d694f19c7512621fd03af7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#a50508fd4f1d694f19c7512621fd03af7">test_identical</a> (self, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html#a7d5e47accc36575f2c7727a681ce30da">left</a>)</td></tr>
<tr class="separator:a50508fd4f1d694f19c7512621fd03af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc3ce45a48946da7806c2b437c516c0" id="r_acdc3ce45a48946da7806c2b437c516c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#acdc3ce45a48946da7806c2b437c516c0">test_basic</a> (self, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html#a7d5e47accc36575f2c7727a681ce30da">left</a>, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html#af85a1ef95e324849f37f1b54176ab702">right</a>)</td></tr>
<tr class="separator:acdc3ce45a48946da7806c2b437c516c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3b859034567e0dbb2b4c26e8382f74" id="r_a6b3b859034567e0dbb2b4c26e8382f74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#a6b3b859034567e0dbb2b4c26e8382f74">test_merge_categorical</a> (self)</td></tr>
<tr class="separator:a6b3b859034567e0dbb2b4c26e8382f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab21d9587db02b14874b88231b9e2bb9b" id="r_ab21d9587db02b14874b88231b9e2bb9b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#ab21d9587db02b14874b88231b9e2bb9b">tests_merge_categorical_unordered_equal</a> (self)</td></tr>
<tr class="separator:ab21d9587db02b14874b88231b9e2bb9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e53097ffd115fb789c1a037196e092f" id="r_a4e53097ffd115fb789c1a037196e092f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#a4e53097ffd115fb789c1a037196e092f">test_multiindex_merge_with_unordered_categoricalindex</a> (self, ordered)</td></tr>
<tr class="separator:a4e53097ffd115fb789c1a037196e092f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a646f76309dbd820041c543bdb90b218e" id="r_a646f76309dbd820041c543bdb90b218e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#a646f76309dbd820041c543bdb90b218e">test_other_columns</a> (self, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html#a7d5e47accc36575f2c7727a681ce30da">left</a>, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html#af85a1ef95e324849f37f1b54176ab702">right</a>)</td></tr>
<tr class="separator:a646f76309dbd820041c543bdb90b218e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a4fb7694b4b545299cc8a94c13ef07" id="r_a72a4fb7694b4b545299cc8a94c13ef07"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#a72a4fb7694b4b545299cc8a94c13ef07">test_dtype_on_merged_different</a> (self, change, join_type, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html#a7d5e47accc36575f2c7727a681ce30da">left</a>, <a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html#af85a1ef95e324849f37f1b54176ab702">right</a>)</td></tr>
<tr class="separator:a72a4fb7694b4b545299cc8a94c13ef07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d4653f706d7f72dacf00ec599599f3" id="r_a51d4653f706d7f72dacf00ec599599f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#a51d4653f706d7f72dacf00ec599599f3">test_self_join_multiple_categories</a> (self)</td></tr>
<tr class="separator:a51d4653f706d7f72dacf00ec599599f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc8e98e521c580b9113f5e0c36e85f5" id="r_acdc8e98e521c580b9113f5e0c36e85f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#acdc8e98e521c580b9113f5e0c36e85f5">test_dtype_on_categorical_dates</a> (self)</td></tr>
<tr class="separator:acdc8e98e521c580b9113f5e0c36e85f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6ed46d38aa0e564e92c457e6f3ef9de" id="r_ab6ed46d38aa0e564e92c457e6f3ef9de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#ab6ed46d38aa0e564e92c457e6f3ef9de">test_merging_with_bool_or_int_cateorical_column</a> (self, category_column, categories, expected_categories, ordered)</td></tr>
<tr class="separator:ab6ed46d38aa0e564e92c457e6f3ef9de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73ef61f1d7f5b1d2d6a2c9f756c24700" id="r_a73ef61f1d7f5b1d2d6a2c9f756c24700"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_categorical.html#a73ef61f1d7f5b1d2d6a2c9f756c24700">test_merge_on_int_array</a> (self)</td></tr>
<tr class="separator:a73ef61f1d7f5b1d2d6a2c9f756c24700"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="acdc3ce45a48946da7806c2b437c516c0" name="acdc3ce45a48946da7806c2b437c516c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdc3ce45a48946da7806c2b437c516c0">&#9670;&#160;</a></span>test_basic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_basic </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1795</span>    <span class="keyword">def </span>test_basic(self, left, right):</div>
<div class="line"><span class="lineno"> 1796</span>        <span class="comment"># we have matching Categorical dtypes in X</span></div>
<div class="line"><span class="lineno"> 1797</span>        <span class="comment"># so should preserve the merged column</span></div>
<div class="line"><span class="lineno"> 1798</span>        merged = merge(left, right, on=<span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><span class="lineno"> 1799</span>        result = merged.dtypes.sort_index()</div>
<div class="line"><span class="lineno"> 1800</span>        expected = Series(</div>
<div class="line"><span class="lineno"> 1801</span>            [</div>
<div class="line"><span class="lineno"> 1802</span>                CategoricalDtype(categories=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1803</span>                np.dtype(<span class="stringliteral">&quot;O&quot;</span>),</div>
<div class="line"><span class="lineno"> 1804</span>                np.dtype(<span class="stringliteral">&quot;int64&quot;</span>),</div>
<div class="line"><span class="lineno"> 1805</span>            ],</div>
<div class="line"><span class="lineno"> 1806</span>            index=[<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;Z&quot;</span>],</div>
<div class="line"><span class="lineno"> 1807</span>        )</div>
<div class="line"><span class="lineno"> 1808</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1809</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acdc8e98e521c580b9113f5e0c36e85f5" name="acdc8e98e521c580b9113f5e0c36e85f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdc8e98e521c580b9113f5e0c36e85f5">&#9670;&#160;</a></span>test_dtype_on_categorical_dates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_dtype_on_categorical_dates </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1992</span>    <span class="keyword">def </span>test_dtype_on_categorical_dates(self):</div>
<div class="line"><span class="lineno"> 1993</span>        <span class="comment"># GH 16900</span></div>
<div class="line"><span class="lineno"> 1994</span>        <span class="comment"># dates should not be coerced to ints</span></div>
<div class="line"><span class="lineno"> 1995</span> </div>
<div class="line"><span class="lineno"> 1996</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 1997</span>            [[date(2001, 1, 1), 1.1], [date(2001, 1, 2), 1.3]], columns=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;num2&quot;</span>]</div>
<div class="line"><span class="lineno"> 1998</span>        )</div>
<div class="line"><span class="lineno"> 1999</span>        df[<span class="stringliteral">&quot;date&quot;</span>] = df[<span class="stringliteral">&quot;date&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 2000</span> </div>
<div class="line"><span class="lineno"> 2001</span>        df2 = DataFrame(</div>
<div class="line"><span class="lineno"> 2002</span>            [[date(2001, 1, 1), 1.3], [date(2001, 1, 3), 1.4]], columns=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;num4&quot;</span>]</div>
<div class="line"><span class="lineno"> 2003</span>        )</div>
<div class="line"><span class="lineno"> 2004</span>        df2[<span class="stringliteral">&quot;date&quot;</span>] = df2[<span class="stringliteral">&quot;date&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 2005</span> </div>
<div class="line"><span class="lineno"> 2006</span>        expected_outer = DataFrame(</div>
<div class="line"><span class="lineno"> 2007</span>            [</div>
<div class="line"><span class="lineno"> 2008</span>                [pd.Timestamp(<span class="stringliteral">&quot;2001-01-01&quot;</span>).date(), 1.1, 1.3],</div>
<div class="line"><span class="lineno"> 2009</span>                [pd.Timestamp(<span class="stringliteral">&quot;2001-01-02&quot;</span>).date(), 1.3, np.nan],</div>
<div class="line"><span class="lineno"> 2010</span>                [pd.Timestamp(<span class="stringliteral">&quot;2001-01-03&quot;</span>).date(), np.nan, 1.4],</div>
<div class="line"><span class="lineno"> 2011</span>            ],</div>
<div class="line"><span class="lineno"> 2012</span>            columns=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;num2&quot;</span>, <span class="stringliteral">&quot;num4&quot;</span>],</div>
<div class="line"><span class="lineno"> 2013</span>        )</div>
<div class="line"><span class="lineno"> 2014</span>        result_outer = merge(df, df2, how=<span class="stringliteral">&quot;outer&quot;</span>, on=[<span class="stringliteral">&quot;date&quot;</span>])</div>
<div class="line"><span class="lineno"> 2015</span>        tm.assert_frame_equal(result_outer, expected_outer)</div>
<div class="line"><span class="lineno"> 2016</span> </div>
<div class="line"><span class="lineno"> 2017</span>        expected_inner = DataFrame(</div>
<div class="line"><span class="lineno"> 2018</span>            [[pd.Timestamp(<span class="stringliteral">&quot;2001-01-01&quot;</span>).date(), 1.1, 1.3]],</div>
<div class="line"><span class="lineno"> 2019</span>            columns=[<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;num2&quot;</span>, <span class="stringliteral">&quot;num4&quot;</span>],</div>
<div class="line"><span class="lineno"> 2020</span>        )</div>
<div class="line"><span class="lineno"> 2021</span>        result_inner = merge(df, df2, how=<span class="stringliteral">&quot;inner&quot;</span>, on=[<span class="stringliteral">&quot;date&quot;</span>])</div>
<div class="line"><span class="lineno"> 2022</span>        tm.assert_frame_equal(result_inner, expected_inner)</div>
<div class="line"><span class="lineno"> 2023</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a72a4fb7694b4b545299cc8a94c13ef07" name="a72a4fb7694b4b545299cc8a94c13ef07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72a4fb7694b4b545299cc8a94c13ef07">&#9670;&#160;</a></span>test_dtype_on_merged_different()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_dtype_on_merged_different </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>change</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>join_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1935</span>    <span class="keyword">def </span>test_dtype_on_merged_different(self, change, join_type, left, right):</div>
<div class="line"><span class="lineno"> 1936</span>        <span class="comment"># our merging columns, X now has 2 different dtypes</span></div>
<div class="line"><span class="lineno"> 1937</span>        <span class="comment"># so we must be object as a result</span></div>
<div class="line"><span class="lineno"> 1938</span> </div>
<div class="line"><span class="lineno"> 1939</span>        X = change(right.X.astype(<span class="stringliteral">&quot;object&quot;</span>))</div>
<div class="line"><span class="lineno"> 1940</span>        right = right.assign(X=X)</div>
<div class="line"><span class="lineno"> 1941</span>        <span class="keyword">assert</span> is_categorical_dtype(left.X.values.dtype)</div>
<div class="line"><span class="lineno"> 1942</span>        <span class="comment"># assert not left.X.values._categories_match_up_to_permutation(right.X.values)</span></div>
<div class="line"><span class="lineno"> 1943</span> </div>
<div class="line"><span class="lineno"> 1944</span>        merged = merge(left, right, on=<span class="stringliteral">&quot;X&quot;</span>, how=join_type)</div>
<div class="line"><span class="lineno"> 1945</span> </div>
<div class="line"><span class="lineno"> 1946</span>        result = merged.dtypes.sort_index()</div>
<div class="line"><span class="lineno"> 1947</span>        expected = Series(</div>
<div class="line"><span class="lineno"> 1948</span>            [np.dtype(<span class="stringliteral">&quot;O&quot;</span>), np.dtype(<span class="stringliteral">&quot;O&quot;</span>), np.dtype(<span class="stringliteral">&quot;int64&quot;</span>)], index=[<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;Z&quot;</span>]</div>
<div class="line"><span class="lineno"> 1949</span>        )</div>
<div class="line"><span class="lineno"> 1950</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1951</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a50508fd4f1d694f19c7512621fd03af7" name="a50508fd4f1d694f19c7512621fd03af7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50508fd4f1d694f19c7512621fd03af7">&#9670;&#160;</a></span>test_identical()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_identical </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1785</span>    <span class="keyword">def </span>test_identical(self, left):</div>
<div class="line"><span class="lineno"> 1786</span>        <span class="comment"># merging on the same, should preserve dtypes</span></div>
<div class="line"><span class="lineno"> 1787</span>        merged = merge(left, left, on=<span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><span class="lineno"> 1788</span>        result = merged.dtypes.sort_index()</div>
<div class="line"><span class="lineno"> 1789</span>        expected = Series(</div>
<div class="line"><span class="lineno"> 1790</span>            [CategoricalDtype(categories=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]), np.dtype(<span class="stringliteral">&quot;O&quot;</span>), np.dtype(<span class="stringliteral">&quot;O&quot;</span>)],</div>
<div class="line"><span class="lineno"> 1791</span>            index=[<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y_x&quot;</span>, <span class="stringliteral">&quot;Y_y&quot;</span>],</div>
<div class="line"><span class="lineno"> 1792</span>        )</div>
<div class="line"><span class="lineno"> 1793</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1794</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b3b859034567e0dbb2b4c26e8382f74" name="a6b3b859034567e0dbb2b4c26e8382f74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b3b859034567e0dbb2b4c26e8382f74">&#9670;&#160;</a></span>test_merge_categorical()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_merge_categorical </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1810</span>    <span class="keyword">def </span>test_merge_categorical(self):</div>
<div class="line"><span class="lineno"> 1811</span>        <span class="comment"># GH 9426</span></div>
<div class="line"><span class="lineno"> 1812</span> </div>
<div class="line"><span class="lineno"> 1813</span>        right = DataFrame(</div>
<div class="line"><span class="lineno"> 1814</span>            {</div>
<div class="line"><span class="lineno"> 1815</span>                <span class="stringliteral">&quot;c&quot;</span>: {0: <span class="stringliteral">&quot;a&quot;</span>, 1: <span class="stringliteral">&quot;b&quot;</span>, 2: <span class="stringliteral">&quot;c&quot;</span>, 3: <span class="stringliteral">&quot;d&quot;</span>, 4: <span class="stringliteral">&quot;e&quot;</span>},</div>
<div class="line"><span class="lineno"> 1816</span>                <span class="stringliteral">&quot;d&quot;</span>: {0: <span class="stringliteral">&quot;null&quot;</span>, 1: <span class="stringliteral">&quot;null&quot;</span>, 2: <span class="stringliteral">&quot;null&quot;</span>, 3: <span class="stringliteral">&quot;null&quot;</span>, 4: <span class="stringliteral">&quot;null&quot;</span>},</div>
<div class="line"><span class="lineno"> 1817</span>            }</div>
<div class="line"><span class="lineno"> 1818</span>        )</div>
<div class="line"><span class="lineno"> 1819</span>        left = DataFrame(</div>
<div class="line"><span class="lineno"> 1820</span>            {</div>
<div class="line"><span class="lineno"> 1821</span>                <span class="stringliteral">&quot;a&quot;</span>: {0: <span class="stringliteral">&quot;f&quot;</span>, 1: <span class="stringliteral">&quot;f&quot;</span>, 2: <span class="stringliteral">&quot;f&quot;</span>, 3: <span class="stringliteral">&quot;f&quot;</span>, 4: <span class="stringliteral">&quot;f&quot;</span>},</div>
<div class="line"><span class="lineno"> 1822</span>                <span class="stringliteral">&quot;b&quot;</span>: {0: <span class="stringliteral">&quot;g&quot;</span>, 1: <span class="stringliteral">&quot;g&quot;</span>, 2: <span class="stringliteral">&quot;g&quot;</span>, 3: <span class="stringliteral">&quot;g&quot;</span>, 4: <span class="stringliteral">&quot;g&quot;</span>},</div>
<div class="line"><span class="lineno"> 1823</span>            }</div>
<div class="line"><span class="lineno"> 1824</span>        )</div>
<div class="line"><span class="lineno"> 1825</span>        df = merge(left, right, how=<span class="stringliteral">&quot;left&quot;</span>, left_on=<span class="stringliteral">&quot;b&quot;</span>, right_on=<span class="stringliteral">&quot;c&quot;</span>)</div>
<div class="line"><span class="lineno"> 1826</span> </div>
<div class="line"><span class="lineno"> 1827</span>        <span class="comment"># object-object</span></div>
<div class="line"><span class="lineno"> 1828</span>        expected = df.copy()</div>
<div class="line"><span class="lineno"> 1829</span> </div>
<div class="line"><span class="lineno"> 1830</span>        <span class="comment"># object-cat</span></div>
<div class="line"><span class="lineno"> 1831</span>        <span class="comment"># note that we propagate the category</span></div>
<div class="line"><span class="lineno"> 1832</span>        <span class="comment"># because we don&#39;t have any matching rows</span></div>
<div class="line"><span class="lineno"> 1833</span>        cright = right.copy()</div>
<div class="line"><span class="lineno"> 1834</span>        cright[<span class="stringliteral">&quot;d&quot;</span>] = cright[<span class="stringliteral">&quot;d&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1835</span>        result = merge(left, cright, how=<span class="stringliteral">&quot;left&quot;</span>, left_on=<span class="stringliteral">&quot;b&quot;</span>, right_on=<span class="stringliteral">&quot;c&quot;</span>)</div>
<div class="line"><span class="lineno"> 1836</span>        expected[<span class="stringliteral">&quot;d&quot;</span>] = expected[<span class="stringliteral">&quot;d&quot;</span>].astype(CategoricalDtype([<span class="stringliteral">&quot;null&quot;</span>]))</div>
<div class="line"><span class="lineno"> 1837</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1838</span> </div>
<div class="line"><span class="lineno"> 1839</span>        <span class="comment"># cat-object</span></div>
<div class="line"><span class="lineno"> 1840</span>        cleft = left.copy()</div>
<div class="line"><span class="lineno"> 1841</span>        cleft[<span class="stringliteral">&quot;b&quot;</span>] = cleft[<span class="stringliteral">&quot;b&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1842</span>        result = merge(cleft, cright, how=<span class="stringliteral">&quot;left&quot;</span>, left_on=<span class="stringliteral">&quot;b&quot;</span>, right_on=<span class="stringliteral">&quot;c&quot;</span>)</div>
<div class="line"><span class="lineno"> 1843</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1844</span> </div>
<div class="line"><span class="lineno"> 1845</span>        <span class="comment"># cat-cat</span></div>
<div class="line"><span class="lineno"> 1846</span>        cright = right.copy()</div>
<div class="line"><span class="lineno"> 1847</span>        cright[<span class="stringliteral">&quot;d&quot;</span>] = cright[<span class="stringliteral">&quot;d&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1848</span>        cleft = left.copy()</div>
<div class="line"><span class="lineno"> 1849</span>        cleft[<span class="stringliteral">&quot;b&quot;</span>] = cleft[<span class="stringliteral">&quot;b&quot;</span>].astype(<span class="stringliteral">&quot;category&quot;</span>)</div>
<div class="line"><span class="lineno"> 1850</span>        result = merge(cleft, cright, how=<span class="stringliteral">&quot;left&quot;</span>, left_on=<span class="stringliteral">&quot;b&quot;</span>, right_on=<span class="stringliteral">&quot;c&quot;</span>)</div>
<div class="line"><span class="lineno"> 1851</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1852</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a73ef61f1d7f5b1d2d6a2c9f756c24700" name="a73ef61f1d7f5b1d2d6a2c9f756c24700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73ef61f1d7f5b1d2d6a2c9f756c24700">&#9670;&#160;</a></span>test_merge_on_int_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_merge_on_int_array </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2046</span>    <span class="keyword">def </span>test_merge_on_int_array(self):</div>
<div class="line"><span class="lineno"> 2047</span>        <span class="comment"># GH 23020</span></div>
<div class="line"><span class="lineno"> 2048</span>        df = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: Series([1, 2, np.nan], dtype=<span class="stringliteral">&quot;Int64&quot;</span>), <span class="stringliteral">&quot;B&quot;</span>: 1})</div>
<div class="line"><span class="lineno"> 2049</span>        result = merge(df, df, on=<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno"> 2050</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 2051</span>            {<span class="stringliteral">&quot;A&quot;</span>: Series([1, 2, np.nan], dtype=<span class="stringliteral">&quot;Int64&quot;</span>), <span class="stringliteral">&quot;B_x&quot;</span>: 1, <span class="stringliteral">&quot;B_y&quot;</span>: 1}</div>
<div class="line"><span class="lineno"> 2052</span>        )</div>
<div class="line"><span class="lineno"> 2053</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 2054</span> </div>
<div class="line"><span class="lineno"> 2055</span> </div>
<div class="line"><span class="lineno"> 2056</span><span class="preprocessor">@pytest.fixture</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6ed46d38aa0e564e92c457e6f3ef9de" name="ab6ed46d38aa0e564e92c457e6f3ef9de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6ed46d38aa0e564e92c457e6f3ef9de">&#9670;&#160;</a></span>test_merging_with_bool_or_int_cateorical_column()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_merging_with_bool_or_int_cateorical_column </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>category_column</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>categories</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_categories</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ordered</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2035</span>    ):</div>
<div class="line"><span class="lineno"> 2036</span>        <span class="comment"># GH 17187</span></div>
<div class="line"><span class="lineno"> 2037</span>        <span class="comment"># merging with a boolean/int categorical column</span></div>
<div class="line"><span class="lineno"> 2038</span>        df1 = DataFrame({<span class="stringliteral">&quot;id&quot;</span>: [1, 2, 3, 4], <span class="stringliteral">&quot;cat&quot;</span>: category_column})</div>
<div class="line"><span class="lineno"> 2039</span>        df1[<span class="stringliteral">&quot;cat&quot;</span>] = df1[<span class="stringliteral">&quot;cat&quot;</span>].astype(CDT(categories, ordered=ordered))</div>
<div class="line"><span class="lineno"> 2040</span>        df2 = DataFrame({<span class="stringliteral">&quot;id&quot;</span>: [2, 4], <span class="stringliteral">&quot;num&quot;</span>: [1, 9]})</div>
<div class="line"><span class="lineno"> 2041</span>        result = df1.merge(df2)</div>
<div class="line"><span class="lineno"> 2042</span>        expected = DataFrame({<span class="stringliteral">&quot;id&quot;</span>: [2, 4], <span class="stringliteral">&quot;cat&quot;</span>: expected_categories, <span class="stringliteral">&quot;num&quot;</span>: [1, 9]})</div>
<div class="line"><span class="lineno"> 2043</span>        expected[<span class="stringliteral">&quot;cat&quot;</span>] = expected[<span class="stringliteral">&quot;cat&quot;</span>].astype(CDT(categories, ordered=ordered))</div>
<div class="line"><span class="lineno"> 2044</span>        tm.assert_frame_equal(expected, result)</div>
<div class="line"><span class="lineno"> 2045</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e53097ffd115fb789c1a037196e092f" name="a4e53097ffd115fb789c1a037196e092f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e53097ffd115fb789c1a037196e092f">&#9670;&#160;</a></span>test_multiindex_merge_with_unordered_categoricalindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_multiindex_merge_with_unordered_categoricalindex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ordered</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1879</span>    <span class="keyword">def </span>test_multiindex_merge_with_unordered_categoricalindex(self, ordered):</div>
<div class="line"><span class="lineno"> 1880</span>        <span class="comment"># GH 36973</span></div>
<div class="line"><span class="lineno"> 1881</span>        pcat = CategoricalDtype(categories=[<span class="stringliteral">&quot;P2&quot;</span>, <span class="stringliteral">&quot;P1&quot;</span>], ordered=ordered)</div>
<div class="line"><span class="lineno"> 1882</span>        df1 = DataFrame(</div>
<div class="line"><span class="lineno"> 1883</span>            {</div>
<div class="line"><span class="lineno"> 1884</span>                <span class="stringliteral">&quot;id&quot;</span>: [<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>],</div>
<div class="line"><span class="lineno"> 1885</span>                <span class="stringliteral">&quot;p&quot;</span>: Categorical([<span class="stringliteral">&quot;P2&quot;</span>, <span class="stringliteral">&quot;P1&quot;</span>, <span class="stringliteral">&quot;P2&quot;</span>], dtype=pcat),</div>
<div class="line"><span class="lineno"> 1886</span>                <span class="stringliteral">&quot;a&quot;</span>: [0, 1, 2],</div>
<div class="line"><span class="lineno"> 1887</span>            }</div>
<div class="line"><span class="lineno"> 1888</span>        ).set_index([<span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;p&quot;</span>])</div>
<div class="line"><span class="lineno"> 1889</span>        df2 = DataFrame(</div>
<div class="line"><span class="lineno"> 1890</span>            {</div>
<div class="line"><span class="lineno"> 1891</span>                <span class="stringliteral">&quot;id&quot;</span>: [<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>],</div>
<div class="line"><span class="lineno"> 1892</span>                <span class="stringliteral">&quot;p&quot;</span>: Categorical([<span class="stringliteral">&quot;P2&quot;</span>, <span class="stringliteral">&quot;P2&quot;</span>, <span class="stringliteral">&quot;P1&quot;</span>], dtype=pcat),</div>
<div class="line"><span class="lineno"> 1893</span>                <span class="stringliteral">&quot;d1&quot;</span>: [10, 11, 12],</div>
<div class="line"><span class="lineno"> 1894</span>            }</div>
<div class="line"><span class="lineno"> 1895</span>        ).set_index([<span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;p&quot;</span>])</div>
<div class="line"><span class="lineno"> 1896</span>        result = merge(df1, df2, how=<span class="stringliteral">&quot;left&quot;</span>, left_index=<span class="keyword">True</span>, right_index=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1897</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1898</span>            {</div>
<div class="line"><span class="lineno"> 1899</span>                <span class="stringliteral">&quot;id&quot;</span>: [<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>],</div>
<div class="line"><span class="lineno"> 1900</span>                <span class="stringliteral">&quot;p&quot;</span>: Categorical([<span class="stringliteral">&quot;P2&quot;</span>, <span class="stringliteral">&quot;P1&quot;</span>, <span class="stringliteral">&quot;P2&quot;</span>], dtype=pcat),</div>
<div class="line"><span class="lineno"> 1901</span>                <span class="stringliteral">&quot;a&quot;</span>: [0, 1, 2],</div>
<div class="line"><span class="lineno"> 1902</span>                <span class="stringliteral">&quot;d1&quot;</span>: [11.0, 12.0, np.nan],</div>
<div class="line"><span class="lineno"> 1903</span>            }</div>
<div class="line"><span class="lineno"> 1904</span>        ).set_index([<span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;p&quot;</span>])</div>
<div class="line"><span class="lineno"> 1905</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1906</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a646f76309dbd820041c543bdb90b218e" name="a646f76309dbd820041c543bdb90b218e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a646f76309dbd820041c543bdb90b218e">&#9670;&#160;</a></span>test_other_columns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_other_columns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1907</span>    <span class="keyword">def </span>test_other_columns(self, left, right):</div>
<div class="line"><span class="lineno"> 1908</span>        <span class="comment"># non-merge columns should preserve if possible</span></div>
<div class="line"><span class="lineno"> 1909</span>        right = right.assign(Z=right.Z.astype(<span class="stringliteral">&quot;category&quot;</span>))</div>
<div class="line"><span class="lineno"> 1910</span> </div>
<div class="line"><span class="lineno"> 1911</span>        merged = merge(left, right, on=<span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><span class="lineno"> 1912</span>        result = merged.dtypes.sort_index()</div>
<div class="line"><span class="lineno"> 1913</span>        expected = Series(</div>
<div class="line"><span class="lineno"> 1914</span>            [</div>
<div class="line"><span class="lineno"> 1915</span>                CategoricalDtype(categories=[<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1916</span>                np.dtype(<span class="stringliteral">&quot;O&quot;</span>),</div>
<div class="line"><span class="lineno"> 1917</span>                CategoricalDtype(categories=[1, 2]),</div>
<div class="line"><span class="lineno"> 1918</span>            ],</div>
<div class="line"><span class="lineno"> 1919</span>            index=[<span class="stringliteral">&quot;X&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;Z&quot;</span>],</div>
<div class="line"><span class="lineno"> 1920</span>        )</div>
<div class="line"><span class="lineno"> 1921</span>        tm.assert_series_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1922</span> </div>
<div class="line"><span class="lineno"> 1923</span>        <span class="comment"># categories are preserved</span></div>
<div class="line"><span class="lineno"> 1924</span>        <span class="keyword">assert</span> left.X.values._categories_match_up_to_permutation(merged.X.values)</div>
<div class="line"><span class="lineno"> 1925</span>        <span class="keyword">assert</span> right.Z.values._categories_match_up_to_permutation(merged.Z.values)</div>
<div class="line"><span class="lineno"> 1926</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a51d4653f706d7f72dacf00ec599599f3" name="a51d4653f706d7f72dacf00ec599599f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d4653f706d7f72dacf00ec599599f3">&#9670;&#160;</a></span>test_self_join_multiple_categories()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.test_self_join_multiple_categories </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1952</span>    <span class="keyword">def </span>test_self_join_multiple_categories(self):</div>
<div class="line"><span class="lineno"> 1953</span>        <span class="comment"># GH 16767</span></div>
<div class="line"><span class="lineno"> 1954</span>        <span class="comment"># non-duplicates should work with multiple categories</span></div>
<div class="line"><span class="lineno"> 1955</span>        m = 5</div>
<div class="line"><span class="lineno"> 1956</span>        df = DataFrame(</div>
<div class="line"><span class="lineno"> 1957</span>            {</div>
<div class="line"><span class="lineno"> 1958</span>                <span class="stringliteral">&quot;a&quot;</span>: [<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;e&quot;</span>, <span class="stringliteral">&quot;f&quot;</span>, <span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;j&quot;</span>] * m,</div>
<div class="line"><span class="lineno"> 1959</span>                <span class="stringliteral">&quot;b&quot;</span>: [<span class="stringliteral">&quot;t&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;z&quot;</span>] * 2 * m,</div>
<div class="line"><span class="lineno"> 1960</span>                <span class="stringliteral">&quot;c&quot;</span>: [</div>
<div class="line"><span class="lineno"> 1961</span>                    letter</div>
<div class="line"><span class="lineno"> 1962</span>                    <span class="keywordflow">for</span> each <span class="keywordflow">in</span> [<span class="stringliteral">&quot;m&quot;</span>, <span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;u&quot;</span>, <span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;o&quot;</span>]</div>
<div class="line"><span class="lineno"> 1963</span>                    <span class="keywordflow">for</span> letter <span class="keywordflow">in</span> [each] * 2 * m</div>
<div class="line"><span class="lineno"> 1964</span>                ],</div>
<div class="line"><span class="lineno"> 1965</span>                <span class="stringliteral">&quot;d&quot;</span>: [</div>
<div class="line"><span class="lineno"> 1966</span>                    letter</div>
<div class="line"><span class="lineno"> 1967</span>                    <span class="keywordflow">for</span> each <span class="keywordflow">in</span> [</div>
<div class="line"><span class="lineno"> 1968</span>                        <span class="stringliteral">&quot;aa&quot;</span>,</div>
<div class="line"><span class="lineno"> 1969</span>                        <span class="stringliteral">&quot;bb&quot;</span>,</div>
<div class="line"><span class="lineno"> 1970</span>                        <span class="stringliteral">&quot;cc&quot;</span>,</div>
<div class="line"><span class="lineno"> 1971</span>                        <span class="stringliteral">&quot;dd&quot;</span>,</div>
<div class="line"><span class="lineno"> 1972</span>                        <span class="stringliteral">&quot;ee&quot;</span>,</div>
<div class="line"><span class="lineno"> 1973</span>                        <span class="stringliteral">&quot;ff&quot;</span>,</div>
<div class="line"><span class="lineno"> 1974</span>                        <span class="stringliteral">&quot;gg&quot;</span>,</div>
<div class="line"><span class="lineno"> 1975</span>                        <span class="stringliteral">&quot;hh&quot;</span>,</div>
<div class="line"><span class="lineno"> 1976</span>                        <span class="stringliteral">&quot;ii&quot;</span>,</div>
<div class="line"><span class="lineno"> 1977</span>                        <span class="stringliteral">&quot;jj&quot;</span>,</div>
<div class="line"><span class="lineno"> 1978</span>                    ]</div>
<div class="line"><span class="lineno"> 1979</span>                    <span class="keywordflow">for</span> letter <span class="keywordflow">in</span> [each] * m</div>
<div class="line"><span class="lineno"> 1980</span>                ],</div>
<div class="line"><span class="lineno"> 1981</span>            }</div>
<div class="line"><span class="lineno"> 1982</span>        )</div>
<div class="line"><span class="lineno"> 1983</span> </div>
<div class="line"><span class="lineno"> 1984</span>        <span class="comment"># change them all to categorical variables</span></div>
<div class="line"><span class="lineno"> 1985</span>        df = df.apply(<span class="keyword">lambda</span> x: x.astype(<span class="stringliteral">&quot;category&quot;</span>))</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>        <span class="comment"># self-join should equal ourselves</span></div>
<div class="line"><span class="lineno"> 1988</span>        result = merge(df, df, on=list(df.columns))</div>
<div class="line"><span class="lineno"> 1989</span> </div>
<div class="line"><span class="lineno"> 1990</span>        tm.assert_frame_equal(result, df)</div>
<div class="line"><span class="lineno"> 1991</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab21d9587db02b14874b88231b9e2bb9b" name="ab21d9587db02b14874b88231b9e2bb9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab21d9587db02b14874b88231b9e2bb9b">&#9670;&#160;</a></span>tests_merge_categorical_unordered_equal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeCategorical.tests_merge_categorical_unordered_equal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1853</span>    <span class="keyword">def </span>tests_merge_categorical_unordered_equal(self):</div>
<div class="line"><span class="lineno"> 1854</span>        <span class="comment"># GH-19551</span></div>
<div class="line"><span class="lineno"> 1855</span>        df1 = DataFrame(</div>
<div class="line"><span class="lineno"> 1856</span>            {</div>
<div class="line"><span class="lineno"> 1857</span>                <span class="stringliteral">&quot;Foo&quot;</span>: Categorical([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>], categories=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1858</span>                <span class="stringliteral">&quot;Left&quot;</span>: [<span class="stringliteral">&quot;A0&quot;</span>, <span class="stringliteral">&quot;B0&quot;</span>, <span class="stringliteral">&quot;C0&quot;</span>],</div>
<div class="line"><span class="lineno"> 1859</span>            }</div>
<div class="line"><span class="lineno"> 1860</span>        )</div>
<div class="line"><span class="lineno"> 1861</span> </div>
<div class="line"><span class="lineno"> 1862</span>        df2 = DataFrame(</div>
<div class="line"><span class="lineno"> 1863</span>            {</div>
<div class="line"><span class="lineno"> 1864</span>                <span class="stringliteral">&quot;Foo&quot;</span>: Categorical([<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>], categories=[<span class="stringliteral">&quot;C&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1865</span>                <span class="stringliteral">&quot;Right&quot;</span>: [<span class="stringliteral">&quot;C1&quot;</span>, <span class="stringliteral">&quot;B1&quot;</span>, <span class="stringliteral">&quot;A1&quot;</span>],</div>
<div class="line"><span class="lineno"> 1866</span>            }</div>
<div class="line"><span class="lineno"> 1867</span>        )</div>
<div class="line"><span class="lineno"> 1868</span>        result = merge(df1, df2, on=[<span class="stringliteral">&quot;Foo&quot;</span>])</div>
<div class="line"><span class="lineno"> 1869</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1870</span>            {</div>
<div class="line"><span class="lineno"> 1871</span>                <span class="stringliteral">&quot;Foo&quot;</span>: Categorical([<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>]),</div>
<div class="line"><span class="lineno"> 1872</span>                <span class="stringliteral">&quot;Left&quot;</span>: [<span class="stringliteral">&quot;A0&quot;</span>, <span class="stringliteral">&quot;B0&quot;</span>, <span class="stringliteral">&quot;C0&quot;</span>],</div>
<div class="line"><span class="lineno"> 1873</span>                <span class="stringliteral">&quot;Right&quot;</span>: [<span class="stringliteral">&quot;A1&quot;</span>, <span class="stringliteral">&quot;B1&quot;</span>, <span class="stringliteral">&quot;C1&quot;</span>],</div>
<div class="line"><span class="lineno"> 1874</span>            }</div>
<div class="line"><span class="lineno"> 1875</span>        )</div>
<div class="line"><span class="lineno"> 1876</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1877</span> </div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/pandas/tests/reshape/merge/<a class="el" href="test__merge_8py.html">test_merge.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
