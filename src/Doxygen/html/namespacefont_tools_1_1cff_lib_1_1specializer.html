<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: fontTools.cffLib.specializer Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacefont_tools.html">fontTools</a></li><li class="navelem"><a class="el" href="namespacefont_tools_1_1cff_lib.html">cffLib</a></li><li class="navelem"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html">specializer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">fontTools.cffLib.specializer Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfont_tools_1_1cff_lib_1_1specializer_1_1___generalizer_decombiner_commands_map.html">_GeneralizerDecombinerCommandsMap</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abcba3b335ec00348102ae1d8c6f4e3f4" id="r_abcba3b335ec00348102ae1d8c6f4e3f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#abcba3b335ec00348102ae1d8c6f4e3f4">stringToProgram</a> (string)</td></tr>
<tr class="separator:abcba3b335ec00348102ae1d8c6f4e3f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155ad83cc4b2830b80a6e8252b21b2f1" id="r_a155ad83cc4b2830b80a6e8252b21b2f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a155ad83cc4b2830b80a6e8252b21b2f1">programToString</a> (<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aefa6d0d36d587bd14e37492c20472460">program</a>)</td></tr>
<tr class="separator:a155ad83cc4b2830b80a6e8252b21b2f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96b10e67695ca9649119110ace82a8f" id="r_ae96b10e67695ca9649119110ace82a8f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#ae96b10e67695ca9649119110ace82a8f">programToCommands</a> (<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aefa6d0d36d587bd14e37492c20472460">program</a>, <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a9a89cc7c0675ab39f773445a0c3798fb">getNumRegions</a>=None)</td></tr>
<tr class="separator:ae96b10e67695ca9649119110ace82a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a202b2b5125af4a827857f9c215872a86" id="r_a202b2b5125af4a827857f9c215872a86"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a202b2b5125af4a827857f9c215872a86">_flattenBlendArgs</a> (args)</td></tr>
<tr class="separator:a202b2b5125af4a827857f9c215872a86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad36402550c84ab1ec66e48fcb9221045" id="r_ad36402550c84ab1ec66e48fcb9221045"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#ad36402550c84ab1ec66e48fcb9221045">commandsToProgram</a> (<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a3ed0c278e6ace1631557b1ca3b64023d">commands</a>)</td></tr>
<tr class="separator:ad36402550c84ab1ec66e48fcb9221045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19c4391af6822d3e7e84991e8d4be1fa" id="r_a19c4391af6822d3e7e84991e8d4be1fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a19c4391af6822d3e7e84991e8d4be1fa">_everyN</a> (el, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a19c4391af6822d3e7e84991e8d4be1fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b00a8c49702f057fbca107e7a6b9307" id="r_a9b00a8c49702f057fbca107e7a6b9307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a9b00a8c49702f057fbca107e7a6b9307">_convertBlendOpToArgs</a> (blendList)</td></tr>
<tr class="separator:a9b00a8c49702f057fbca107e7a6b9307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6961042ea591bb7626d0113ff19bc382" id="r_a6961042ea591bb7626d0113ff19bc382"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a6961042ea591bb7626d0113ff19bc382">generalizeCommands</a> (<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a3ed0c278e6ace1631557b1ca3b64023d">commands</a>, ignoreErrors=False)</td></tr>
<tr class="separator:a6961042ea591bb7626d0113ff19bc382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9b3f05111a67cce274b9d69b40518f2" id="r_af9b3f05111a67cce274b9d69b40518f2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#af9b3f05111a67cce274b9d69b40518f2">generalizeProgram</a> (<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aefa6d0d36d587bd14e37492c20472460">program</a>, <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a9a89cc7c0675ab39f773445a0c3798fb">getNumRegions</a>=None, **kwargs)</td></tr>
<tr class="separator:af9b3f05111a67cce274b9d69b40518f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe047d1692aa9964e0c71fd75facc013" id="r_abe047d1692aa9964e0c71fd75facc013"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#abe047d1692aa9964e0c71fd75facc013">_categorizeVector</a> (v)</td></tr>
<tr class="separator:abe047d1692aa9964e0c71fd75facc013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f3b77e284e4ed473b4bb90b692bb04f" id="r_a5f3b77e284e4ed473b4bb90b692bb04f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a5f3b77e284e4ed473b4bb90b692bb04f">_mergeCategories</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b)</td></tr>
<tr class="separator:a5f3b77e284e4ed473b4bb90b692bb04f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a2a1be3bb8b9d88d681baecf1c4476c" id="r_a7a2a1be3bb8b9d88d681baecf1c4476c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a7a2a1be3bb8b9d88d681baecf1c4476c">_negateCategory</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>)</td></tr>
<tr class="separator:a7a2a1be3bb8b9d88d681baecf1c4476c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40eafe7a16ca57d22aeea55b8e7b5700" id="r_a40eafe7a16ca57d22aeea55b8e7b5700"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a40eafe7a16ca57d22aeea55b8e7b5700">_convertToBlendCmds</a> (args)</td></tr>
<tr class="separator:a40eafe7a16ca57d22aeea55b8e7b5700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07e5d8c3f897ba6865e850249db77d82" id="r_a07e5d8c3f897ba6865e850249db77d82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a07e5d8c3f897ba6865e850249db77d82">_addArgs</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b)</td></tr>
<tr class="separator:a07e5d8c3f897ba6865e850249db77d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa31c6443748908b636cae3a8e053b310" id="r_aa31c6443748908b636cae3a8e053b310"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aa31c6443748908b636cae3a8e053b310">specializeCommands</a> (<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a3ed0c278e6ace1631557b1ca3b64023d">commands</a>, ignoreErrors=False, generalizeFirst=True, preserveTopology=False, maxstack=48)</td></tr>
<tr class="separator:aa31c6443748908b636cae3a8e053b310"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a296c9f18cd078c23bd6f352ca443c566" id="r_a296c9f18cd078c23bd6f352ca443c566"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a296c9f18cd078c23bd6f352ca443c566">specializeProgram</a> (<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aefa6d0d36d587bd14e37492c20472460">program</a>, <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a9a89cc7c0675ab39f773445a0c3798fb">getNumRegions</a>=None, **kwargs)</td></tr>
<tr class="separator:a296c9f18cd078c23bd6f352ca443c566"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a487430311d17ba046512f46a7e3eb760" id="r_a487430311d17ba046512f46a7e3eb760"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a487430311d17ba046512f46a7e3eb760">parser</a></td></tr>
<tr class="separator:a487430311d17ba046512f46a7e3eb760"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58327c3ec28dd12da069c29719dfb621" id="r_a58327c3ec28dd12da069c29719dfb621"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a58327c3ec28dd12da069c29719dfb621">metavar</a></td></tr>
<tr class="separator:a58327c3ec28dd12da069c29719dfb621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7442ac4810d7dca9a16a6fb1a1c61e" id="r_aae7442ac4810d7dca9a16a6fb1a1c61e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aae7442ac4810d7dca9a16a6fb1a1c61e">nargs</a></td></tr>
<tr class="separator:aae7442ac4810d7dca9a16a6fb1a1c61e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a824fe5e0a118b57e7b498ea30a495da8" id="r_a824fe5e0a118b57e7b498ea30a495da8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a824fe5e0a118b57e7b498ea30a495da8">help</a></td></tr>
<tr class="separator:a824fe5e0a118b57e7b498ea30a495da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7812e8fd2c9c9fa696e813c2efc7d4" id="r_a7c7812e8fd2c9c9fa696e813c2efc7d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a7c7812e8fd2c9c9fa696e813c2efc7d4">default</a></td></tr>
<tr class="separator:a7c7812e8fd2c9c9fa696e813c2efc7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a368b1527a310a8649cb95c2ab51dc3ec" id="r_a368b1527a310a8649cb95c2ab51dc3ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a368b1527a310a8649cb95c2ab51dc3ec">options</a> = parser.parse_args(sys.argv[1:])</td></tr>
<tr class="separator:a368b1527a310a8649cb95c2ab51dc3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a89cc7c0675ab39f773445a0c3798fb" id="r_a9a89cc7c0675ab39f773445a0c3798fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a9a89cc7c0675ab39f773445a0c3798fb">getNumRegions</a> = None if options.num_regions is None else <a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a> vsIndex(options.num_regions[0 if vsIndex is None else vsIndex])</td></tr>
<tr class="separator:a9a89cc7c0675ab39f773445a0c3798fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa6d0d36d587bd14e37492c20472460" id="r_aefa6d0d36d587bd14e37492c20472460"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aefa6d0d36d587bd14e37492c20472460">program</a> = <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#abcba3b335ec00348102ae1d8c6f4e3f4">stringToProgram</a>(options.program)</td></tr>
<tr class="separator:aefa6d0d36d587bd14e37492c20472460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ed0c278e6ace1631557b1ca3b64023d" id="r_a3ed0c278e6ace1631557b1ca3b64023d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a3ed0c278e6ace1631557b1ca3b64023d">commands</a> = <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#ae96b10e67695ca9649119110ace82a8f">programToCommands</a>(<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aefa6d0d36d587bd14e37492c20472460">program</a>, <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a9a89cc7c0675ab39f773445a0c3798fb">getNumRegions</a>)</td></tr>
<tr class="separator:a3ed0c278e6ace1631557b1ca3b64023d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee4a4360d741a8ca819d24258af4c36b" id="r_aee4a4360d741a8ca819d24258af4c36b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aee4a4360d741a8ca819d24258af4c36b">program2</a> = <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#ad36402550c84ab1ec66e48fcb9221045">commandsToProgram</a>(<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a3ed0c278e6ace1631557b1ca3b64023d">commands</a>)</td></tr>
<tr class="separator:aee4a4360d741a8ca819d24258af4c36b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">T2CharString operator specializer and generalizer.

PostScript glyph drawing operations can be expressed in multiple different
ways. For example, as well as the ``lineto`` operator, there is also a
``hlineto`` operator which draws a horizontal line, removing the need to
specify a ``dx`` coordinate, and a ``vlineto`` operator which draws a
vertical line, removing the need to specify a ``dy`` coordinate. As well
as decompiling :class:`fontTools.misc.psCharStrings.T2CharString` objects
into lists of operations, this module allows for conversion between general
and specific forms of the operation.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a07e5d8c3f897ba6865e850249db77d82" name="a07e5d8c3f897ba6865e850249db77d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07e5d8c3f897ba6865e850249db77d82">&#9670;&#160;</a></span>_addArgs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer._addArgs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  438</span><span class="keyword">def </span>_addArgs(a, b):</div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordflow">if</span> isinstance(b, list):</div>
<div class="line"><span class="lineno">  440</span>        <span class="keywordflow">if</span> isinstance(a, list):</div>
<div class="line"><span class="lineno">  441</span>            <span class="keywordflow">if</span> len(a) != len(b) <span class="keywordflow">or</span> a[-1] != b[-1]:</div>
<div class="line"><span class="lineno">  442</span>                <span class="keywordflow">raise</span> ValueError()</div>
<div class="line"><span class="lineno">  443</span>            <span class="keywordflow">return</span> [_addArgs(va, vb) <span class="keywordflow">for</span> va,vb <span class="keywordflow">in</span> zip(a[:-1], b[:-1])] + [a[-1]]</div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  445</span>            a, b = b, a</div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordflow">if</span> isinstance(a, list):</div>
<div class="line"><span class="lineno">  447</span>        <span class="keyword">assert</span> a[-1] == 1</div>
<div class="line"><span class="lineno">  448</span>        <span class="keywordflow">return</span> [_addArgs(a[0], b)] + a[1:]</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordflow">return</span> a + b</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abe047d1692aa9964e0c71fd75facc013" name="abe047d1692aa9964e0c71fd75facc013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe047d1692aa9964e0c71fd75facc013">&#9670;&#160;</a></span>_categorizeVector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer._categorizeVector </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">    Takes X,Y vector v and returns one of r, h, v, or 0 depending on which
    of X and/or Y are zero, plus tuple of nonzero ones.  If both are zero,
    it returns a single zero still.

    &gt;&gt;&gt; _categorizeVector((0,0))
    ('0', (0,))
    &gt;&gt;&gt; _categorizeVector((1,0))
    ('h', (1,))
    &gt;&gt;&gt; _categorizeVector((0,2))
    ('v', (2,))
    &gt;&gt;&gt; _categorizeVector((1,2))
    ('r', (1, 2))</pre> <div class="fragment"><div class="line"><span class="lineno">  348</span><span class="keyword">def </span>_categorizeVector(v):</div>
<div class="line"><span class="lineno">  349</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    Takes X,Y vector v and returns one of r, h, v, or 0 depending on which</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    of X and/or Y are zero, plus tuple of nonzero ones.  If both are zero,</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">    it returns a single zero still.</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">    &gt;&gt;&gt; _categorizeVector((0,0))</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    (&#39;0&#39;, (0,))</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">    &gt;&gt;&gt; _categorizeVector((1,0))</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">    (&#39;h&#39;, (1,))</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">    &gt;&gt;&gt; _categorizeVector((0,2))</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    (&#39;v&#39;, (2,))</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">    &gt;&gt;&gt; _categorizeVector((1,2))</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">    (&#39;r&#39;, (1, 2))</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> v[0]:</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> v[1]:</div>
<div class="line"><span class="lineno">  365</span>            <span class="keywordflow">return</span> <span class="stringliteral">&#39;0&#39;</span>, v[:1]</div>
<div class="line"><span class="lineno">  366</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">return</span> <span class="stringliteral">&#39;v&#39;</span>, v[1:]</div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> v[1]:</div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordflow">return</span> <span class="stringliteral">&#39;h&#39;</span>, v[:1]</div>
<div class="line"><span class="lineno">  371</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  372</span>            <span class="keywordflow">return</span> <span class="stringliteral">&#39;r&#39;</span>, v</div>
<div class="line"><span class="lineno">  373</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b00a8c49702f057fbca107e7a6b9307" name="a9b00a8c49702f057fbca107e7a6b9307"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b00a8c49702f057fbca107e7a6b9307">&#9670;&#160;</a></span>_convertBlendOpToArgs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer._convertBlendOpToArgs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>blendList</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  275</span><span class="keyword">def </span>_convertBlendOpToArgs(blendList):</div>
<div class="line"><span class="lineno">  276</span>    <span class="comment"># args is list of blend op args. Since we are supporting</span></div>
<div class="line"><span class="lineno">  277</span>    <span class="comment"># recursive blend op calls, some of these args may also</span></div>
<div class="line"><span class="lineno">  278</span>    <span class="comment"># be a list of blend op args, and need to be converted before</span></div>
<div class="line"><span class="lineno">  279</span>    <span class="comment"># we convert the current list.</span></div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">if</span> any([isinstance(arg, list) <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> blendList]):</div>
<div class="line"><span class="lineno">  281</span>        args =  [i <span class="keywordflow">for</span> e <span class="keywordflow">in</span> blendList <span class="keywordflow">for</span> i <span class="keywordflow">in</span> </div>
<div class="line"><span class="lineno">  282</span>                    (_convertBlendOpToArgs(e) <span class="keywordflow">if</span> isinstance(e,list) <span class="keywordflow">else</span> [e]) ]</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  284</span>        args = blendList</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    <span class="comment"># We now know that blendList contains a blend op argument list, even if</span></div>
<div class="line"><span class="lineno">  287</span>    <span class="comment"># some of the args are lists that each contain a blend op argument list.</span></div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">#   Convert from:</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="comment">#       [default font arg sequence x0,...,xn] + [delta tuple for x0] + ... + [delta tuple for xn]</span></div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">#   to:</span></div>
<div class="line"><span class="lineno">  291</span>    <span class="comment">#       [ [x0] + [delta tuple for x0],</span></div>
<div class="line"><span class="lineno">  292</span>    <span class="comment">#                 ...,</span></div>
<div class="line"><span class="lineno">  293</span>    <span class="comment">#          [xn] + [delta tuple for xn] ]</span></div>
<div class="line"><span class="lineno">  294</span>    numBlends = args[-1]</div>
<div class="line"><span class="lineno">  295</span>    <span class="comment"># Can&#39;t use args.pop() when the args are being used in a nested list</span></div>
<div class="line"><span class="lineno">  296</span>    <span class="comment"># comprehension. See calling context</span></div>
<div class="line"><span class="lineno">  297</span>    args = args[:-1]</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    numRegions = len(args)//numBlends - 1</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (numBlends*(numRegions + 1) == len(args)):</div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordflow">raise</span> ValueError(blendList)</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    defaultArgs = [[arg] <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> args[:numBlends]]</div>
<div class="line"><span class="lineno">  304</span>    deltaArgs = args[numBlends:]</div>
<div class="line"><span class="lineno">  305</span>    numDeltaValues = len(deltaArgs)</div>
<div class="line"><span class="lineno">  306</span>    deltaList = [ deltaArgs[i:i + numRegions] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, numDeltaValues, numRegions) ]</div>
<div class="line"><span class="lineno">  307</span>    blend_args = [ a + b + [1] <span class="keywordflow">for</span> a, b <span class="keywordflow">in</span> zip(defaultArgs,deltaList)]</div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">return</span> blend_args</div>
<div class="line"><span class="lineno">  309</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a40eafe7a16ca57d22aeea55b8e7b5700" name="a40eafe7a16ca57d22aeea55b8e7b5700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40eafe7a16ca57d22aeea55b8e7b5700">&#9670;&#160;</a></span>_convertToBlendCmds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer._convertToBlendCmds </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  386</span><span class="keyword">def </span>_convertToBlendCmds(args):</div>
<div class="line"><span class="lineno">  387</span>    <span class="comment"># return a list of blend commands, and</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="comment"># the remaining non-blended args, if any.</span></div>
<div class="line"><span class="lineno">  389</span>    num_args = len(args)</div>
<div class="line"><span class="lineno">  390</span>    stack_use = 0</div>
<div class="line"><span class="lineno">  391</span>    new_args = []</div>
<div class="line"><span class="lineno">  392</span>    i = 0</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">while</span> i &lt; num_args:</div>
<div class="line"><span class="lineno">  394</span>        arg = args[i]</div>
<div class="line"><span class="lineno">  395</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(arg, list):</div>
<div class="line"><span class="lineno">  396</span>            new_args.append(arg)</div>
<div class="line"><span class="lineno">  397</span>            i += 1</div>
<div class="line"><span class="lineno">  398</span>            stack_use += 1</div>
<div class="line"><span class="lineno">  399</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  400</span>            prev_stack_use = stack_use</div>
<div class="line"><span class="lineno">  401</span>            <span class="comment"># The arg is a tuple of blend values.</span></div>
<div class="line"><span class="lineno">  402</span>            <span class="comment"># These are each (master 0,delta 1..delta n, 1)</span></div>
<div class="line"><span class="lineno">  403</span>            <span class="comment"># Combine as many successive tuples as we can,</span></div>
<div class="line"><span class="lineno">  404</span>            <span class="comment"># up to the max stack limit.</span></div>
<div class="line"><span class="lineno">  405</span>            num_sources = len(arg) - 1</div>
<div class="line"><span class="lineno">  406</span>            blendlist = [arg]</div>
<div class="line"><span class="lineno">  407</span>            i += 1</div>
<div class="line"><span class="lineno">  408</span>            stack_use += 1 + num_sources  <span class="comment"># 1 for the num_blends arg</span></div>
<div class="line"><span class="lineno">  409</span>            <span class="keywordflow">while</span> (i &lt; num_args) <span class="keywordflow">and</span> isinstance(args[i], list):</div>
<div class="line"><span class="lineno">  410</span>                blendlist.append(args[i])</div>
<div class="line"><span class="lineno">  411</span>                i += 1</div>
<div class="line"><span class="lineno">  412</span>                stack_use += num_sources</div>
<div class="line"><span class="lineno">  413</span>                <span class="keywordflow">if</span> stack_use + num_sources &gt; maxStackLimit:</div>
<div class="line"><span class="lineno">  414</span>                    <span class="comment"># if we are here, max stack is the CFF2 max stack.</span></div>
<div class="line"><span class="lineno">  415</span>                    <span class="comment"># I use the CFF2 max stack limit here rather than</span></div>
<div class="line"><span class="lineno">  416</span>                    <span class="comment"># the &#39;maxstack&#39; chosen by the client, as the default</span></div>
<div class="line"><span class="lineno">  417</span>                    <span class="comment">#  maxstack may have been used unintentionally. For all</span></div>
<div class="line"><span class="lineno">  418</span>                    <span class="comment"># the other operators, this just produces a little less</span></div>
<div class="line"><span class="lineno">  419</span>                    <span class="comment"># optimization, but here it puts a hard (and low) limit</span></div>
<div class="line"><span class="lineno">  420</span>                    <span class="comment"># on the number of source fonts that can be used.</span></div>
<div class="line"><span class="lineno">  421</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  422</span>            <span class="comment"># blendList now contains as many single blend tuples as can be</span></div>
<div class="line"><span class="lineno">  423</span>            <span class="comment"># combined without exceeding the CFF2 stack limit.</span></div>
<div class="line"><span class="lineno">  424</span>            num_blends = len(blendlist)</div>
<div class="line"><span class="lineno">  425</span>            <span class="comment"># append the &#39;num_blends&#39; default font values</span></div>
<div class="line"><span class="lineno">  426</span>            blend_args = []</div>
<div class="line"><span class="lineno">  427</span>            <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> blendlist:</div>
<div class="line"><span class="lineno">  428</span>                blend_args.append(arg[0])</div>
<div class="line"><span class="lineno">  429</span>            <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> blendlist:</div>
<div class="line"><span class="lineno">  430</span>                <span class="keyword">assert</span> arg[-1] == 1</div>
<div class="line"><span class="lineno">  431</span>                blend_args.extend(arg[1:-1])</div>
<div class="line"><span class="lineno">  432</span>            blend_args.append(num_blends)</div>
<div class="line"><span class="lineno">  433</span>            new_args.append(blend_args)</div>
<div class="line"><span class="lineno">  434</span>            stack_use = prev_stack_use + num_blends</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    <span class="keywordflow">return</span> new_args</div>
<div class="line"><span class="lineno">  437</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a19c4391af6822d3e7e84991e8d4be1fa" name="a19c4391af6822d3e7e84991e8d4be1fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19c4391af6822d3e7e84991e8d4be1fa">&#9670;&#160;</a></span>_everyN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer._everyN </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>el</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Group the list el into groups of size n</pre> <div class="fragment"><div class="line"><span class="lineno">  147</span><span class="keyword">def </span>_everyN(el, n):</div>
<div class="line"><span class="lineno">  148</span>    <span class="stringliteral">&quot;&quot;&quot;Group the list el into groups of size n&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">if</span> len(el) % n != 0: <span class="keywordflow">raise</span> ValueError(el)</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, len(el), n):</div>
<div class="line"><span class="lineno">  151</span>        <span class="keywordflow">yield</span> el[i:i+n]</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a202b2b5125af4a827857f9c215872a86" name="a202b2b5125af4a827857f9c215872a86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a202b2b5125af4a827857f9c215872a86">&#9670;&#160;</a></span>_flattenBlendArgs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer._flattenBlendArgs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  124</span><span class="keyword">def </span>_flattenBlendArgs(args):</div>
<div class="line"><span class="lineno">  125</span>    token_list = []</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> args:</div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">if</span> isinstance(arg, list):</div>
<div class="line"><span class="lineno">  128</span>            token_list.extend(arg)</div>
<div class="line"><span class="lineno">  129</span>            token_list.append(<span class="stringliteral">&#39;blend&#39;</span>)</div>
<div class="line"><span class="lineno">  130</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  131</span>            token_list.append(arg)</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">return</span> token_list</div>
<div class="line"><span class="lineno">  133</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f3b77e284e4ed473b4bb90b692bb04f" name="a5f3b77e284e4ed473b4bb90b692bb04f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f3b77e284e4ed473b4bb90b692bb04f">&#9670;&#160;</a></span>_mergeCategories()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer._mergeCategories </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  374</span><span class="keyword">def </span>_mergeCategories(a, b):</div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">if</span> a == <span class="stringliteral">&#39;0&#39;</span>: <span class="keywordflow">return</span> b</div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">if</span> b == <span class="stringliteral">&#39;0&#39;</span>: <span class="keywordflow">return</span> a</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">if</span> a == b: <span class="keywordflow">return</span> a</div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  379</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a2a1be3bb8b9d88d681baecf1c4476c" name="a7a2a1be3bb8b9d88d681baecf1c4476c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a2a1be3bb8b9d88d681baecf1c4476c">&#9670;&#160;</a></span>_negateCategory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer._negateCategory </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  380</span><span class="keyword">def </span>_negateCategory(a):</div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordflow">if</span> a == <span class="stringliteral">&#39;h&#39;</span>: <span class="keywordflow">return</span> <span class="stringliteral">&#39;v&#39;</span></div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordflow">if</span> a == <span class="stringliteral">&#39;v&#39;</span>: <span class="keywordflow">return</span> <span class="stringliteral">&#39;h&#39;</span></div>
<div class="line"><span class="lineno">  383</span>    <span class="keyword">assert</span> a <span class="keywordflow">in</span> <span class="stringliteral">&#39;0r&#39;</span></div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordflow">return</span> a</div>
<div class="line"><span class="lineno">  385</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad36402550c84ab1ec66e48fcb9221045" name="ad36402550c84ab1ec66e48fcb9221045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad36402550c84ab1ec66e48fcb9221045">&#9670;&#160;</a></span>commandsToProgram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.commandsToProgram </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>commands</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes a commands list as returned by programToCommands() and converts
    it back to a T2CharString program list.</pre> <div class="fragment"><div class="line"><span class="lineno">  134</span><span class="keyword">def </span>commandsToProgram(commands):</div>
<div class="line"><span class="lineno">  135</span>    <span class="stringliteral">&quot;&quot;&quot;Takes a commands list as returned by programToCommands() and converts</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    it back to a T2CharString program list.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  137</span>    program = []</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">for</span> op,args <span class="keywordflow">in</span> commands:</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">if</span> any(isinstance(arg, list) <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> args):</div>
<div class="line"><span class="lineno">  140</span>            args = _flattenBlendArgs(args)</div>
<div class="line"><span class="lineno">  141</span>        program.extend(args)</div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">if</span> op:</div>
<div class="line"><span class="lineno">  143</span>            program.append(op)</div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">return</span> program</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6961042ea591bb7626d0113ff19bc382" name="a6961042ea591bb7626d0113ff19bc382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6961042ea591bb7626d0113ff19bc382">&#9670;&#160;</a></span>generalizeCommands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.generalizeCommands </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>commands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ignoreErrors</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  310</span><span class="keyword">def </span>generalizeCommands(commands, ignoreErrors=False):</div>
<div class="line"><span class="lineno">  311</span>    result = []</div>
<div class="line"><span class="lineno">  312</span>    mapping = _GeneralizerDecombinerCommandsMap</div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">for</span> op, args <span class="keywordflow">in</span> commands:</div>
<div class="line"><span class="lineno">  314</span>        <span class="comment"># First, generalize any blend args in the arg list.</span></div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">if</span> any([isinstance(arg, list) <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> args]):</div>
<div class="line"><span class="lineno">  316</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  317</span>                args = [n <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> args <span class="keywordflow">for</span> n <span class="keywordflow">in</span> (_convertBlendOpToArgs(arg) <span class="keywordflow">if</span> isinstance(arg, list) <span class="keywordflow">else</span> [arg])]</div>
<div class="line"><span class="lineno">  318</span>            <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  319</span>                <span class="keywordflow">if</span> ignoreErrors:</div>
<div class="line"><span class="lineno">  320</span>                    <span class="comment"># Store op as data, such that consumers of commands do not have to</span></div>
<div class="line"><span class="lineno">  321</span>                    <span class="comment"># deal with incorrect number of arguments.</span></div>
<div class="line"><span class="lineno">  322</span>                    result.append((<span class="stringliteral">&#39;&#39;</span>, args))</div>
<div class="line"><span class="lineno">  323</span>                    result.append((<span class="stringliteral">&#39;&#39;</span>, [op]))</div>
<div class="line"><span class="lineno">  324</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  325</span>                    <span class="keywordflow">raise</span></div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>        func = getattr(mapping, op, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  328</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> func:</div>
<div class="line"><span class="lineno">  329</span>            result.append((op,args))</div>
<div class="line"><span class="lineno">  330</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  331</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  332</span>            <span class="keywordflow">for</span> command <span class="keywordflow">in</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(args):</div>
<div class="line"><span class="lineno">  333</span>                result.append(command)</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  335</span>            <span class="keywordflow">if</span> ignoreErrors:</div>
<div class="line"><span class="lineno">  336</span>                <span class="comment"># Store op as data, such that consumers of commands do not have to</span></div>
<div class="line"><span class="lineno">  337</span>                <span class="comment"># deal with incorrect number of arguments.</span></div>
<div class="line"><span class="lineno">  338</span>                result.append((<span class="stringliteral">&#39;&#39;</span>, args))</div>
<div class="line"><span class="lineno">  339</span>                result.append((<span class="stringliteral">&#39;&#39;</span>, [op]))</div>
<div class="line"><span class="lineno">  340</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  341</span>                <span class="keywordflow">raise</span></div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9b3f05111a67cce274b9d69b40518f2" name="af9b3f05111a67cce274b9d69b40518f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9b3f05111a67cce274b9d69b40518f2">&#9670;&#160;</a></span>generalizeProgram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.generalizeProgram </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>program</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>getNumRegions</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  344</span><span class="keyword">def </span>generalizeProgram(program, getNumRegions=None, **kwargs):</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">return</span> commandsToProgram(generalizeCommands(programToCommands(program, getNumRegions), **kwargs))</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae96b10e67695ca9649119110ace82a8f" name="ae96b10e67695ca9649119110ace82a8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae96b10e67695ca9649119110ace82a8f">&#9670;&#160;</a></span>programToCommands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.programToCommands </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>program</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>getNumRegions</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes a T2CharString program list and returns list of commands.
    Each command is a two-tuple of commandname,arg-list.  The commandname might
    be empty string if no commandname shall be emitted (used for glyph width,
    hintmask/cntrmask argument, as well as stray arguments at the end of the
    program (\_()_/).
    'getNumRegions' may be None, or a callable object. It must return the
    number of regions. 'getNumRegions' takes a single argument, vsindex. If
    the vsindex argument is None, getNumRegions returns the default number
    of regions for the charstring, else it returns the numRegions for
    the vsindex.
    The Charstring may or may not start with a width value. If the first
    non-blend operator has an odd number of arguments, then the first argument is
    a width, and is popped off. This is complicated with blend operators, as
    there may be more than one before the first hint or moveto operator, and each
    one reduces several arguments to just one list argument. We have to sum the
    number of arguments that are not part of the blend arguments, and all the
    'numBlends' values. We could instead have said that by definition, if there
    is a blend operator, there is no width value, since CFF2 Charstrings don't
    have width values. I discussed this with Behdad, and we are allowing for an
    initial width value in this case because developers may assemble a CFF2
    charstring from CFF Charstrings, which could have width values.</pre> <div class="fragment"><div class="line"><span class="lineno">   39</span><span class="keyword">def </span>programToCommands(program, getNumRegions=None):</div>
<div class="line"><span class="lineno">   40</span>    <span class="stringliteral">&quot;&quot;&quot;Takes a T2CharString program list and returns list of commands.</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">    Each command is a two-tuple of commandname,arg-list.  The commandname might</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">    be empty string if no commandname shall be emitted (used for glyph width,</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">    hintmask/cntrmask argument, as well as stray arguments at the end of the</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    program (\_()_/).</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    &#39;getNumRegions&#39; may be None, or a callable object. It must return the</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    number of regions. &#39;getNumRegions&#39; takes a single argument, vsindex. If</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">    the vsindex argument is None, getNumRegions returns the default number</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    of regions for the charstring, else it returns the numRegions for</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    the vsindex.</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    The Charstring may or may not start with a width value. If the first</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">    non-blend operator has an odd number of arguments, then the first argument is</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    a width, and is popped off. This is complicated with blend operators, as</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">    there may be more than one before the first hint or moveto operator, and each</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">    one reduces several arguments to just one list argument. We have to sum the</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    number of arguments that are not part of the blend arguments, and all the</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    &#39;numBlends&#39; values. We could instead have said that by definition, if there</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    is a blend operator, there is no width value, since CFF2 Charstrings don&#39;t</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    have width values. I discussed this with Behdad, and we are allowing for an</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">    initial width value in this case because developers may assemble a CFF2</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">    charstring from CFF Charstrings, which could have width values.</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    seenWidthOp = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   64</span>    vsIndex = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   65</span>    lenBlendStack = 0</div>
<div class="line"><span class="lineno">   66</span>    lastBlendIndex = 0</div>
<div class="line"><span class="lineno">   67</span>    commands = []</div>
<div class="line"><span class="lineno">   68</span>    stack = []</div>
<div class="line"><span class="lineno">   69</span>    it = <a class="code hl_variable" href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a>(program)</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">for</span> token <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno">   72</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(token, str):</div>
<div class="line"><span class="lineno">   73</span>            stack.append(token)</div>
<div class="line"><span class="lineno">   74</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">if</span> token == <span class="stringliteral">&#39;blend&#39;</span>:</div>
<div class="line"><span class="lineno">   77</span>            <span class="keyword">assert</span> getNumRegions <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   78</span>            numSourceFonts = 1 + getNumRegions(vsIndex)</div>
<div class="line"><span class="lineno">   79</span>            <span class="comment"># replace the blend op args on the stack with a single list</span></div>
<div class="line"><span class="lineno">   80</span>            <span class="comment"># containing all the blend op args.</span></div>
<div class="line"><span class="lineno">   81</span>            numBlends = stack[-1]</div>
<div class="line"><span class="lineno">   82</span>            numBlendArgs = numBlends * numSourceFonts + 1</div>
<div class="line"><span class="lineno">   83</span>            <span class="comment"># replace first blend op by a list of the blend ops.</span></div>
<div class="line"><span class="lineno">   84</span>            stack[-numBlendArgs:] = [stack[-numBlendArgs:]]</div>
<div class="line"><span class="lineno">   85</span>            lenBlendStack += numBlends + len(stack) - 1</div>
<div class="line"><span class="lineno">   86</span>            lastBlendIndex = len(stack)</div>
<div class="line"><span class="lineno">   87</span>            <span class="comment"># if a blend op exists, this is or will be a CFF2 charstring.</span></div>
<div class="line"><span class="lineno">   88</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">elif</span> token == <span class="stringliteral">&#39;vsindex&#39;</span>:</div>
<div class="line"><span class="lineno">   91</span>            vsIndex = stack[-1]</div>
<div class="line"><span class="lineno">   92</span>            <span class="keyword">assert</span> type(vsIndex) <span class="keywordflow">is</span> int</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">elif</span> (<span class="keywordflow">not</span> seenWidthOp) <span class="keywordflow">and</span> token <span class="keywordflow">in</span> {<span class="stringliteral">&#39;hstem&#39;</span>, <span class="stringliteral">&#39;hstemhm&#39;</span>, <span class="stringliteral">&#39;vstem&#39;</span>, <span class="stringliteral">&#39;vstemhm&#39;</span>,</div>
<div class="line"><span class="lineno">   95</span>            <span class="stringliteral">&#39;cntrmask&#39;</span>, <span class="stringliteral">&#39;hintmask&#39;</span>,</div>
<div class="line"><span class="lineno">   96</span>            <span class="stringliteral">&#39;hmoveto&#39;</span>, <span class="stringliteral">&#39;vmoveto&#39;</span>, <span class="stringliteral">&#39;rmoveto&#39;</span>,</div>
<div class="line"><span class="lineno">   97</span>            <span class="stringliteral">&#39;endchar&#39;</span>}:</div>
<div class="line"><span class="lineno">   98</span>            seenWidthOp = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">   99</span>            parity = token <span class="keywordflow">in</span> {<span class="stringliteral">&#39;hmoveto&#39;</span>, <span class="stringliteral">&#39;vmoveto&#39;</span>}</div>
<div class="line"><span class="lineno">  100</span>            <span class="keywordflow">if</span> lenBlendStack:</div>
<div class="line"><span class="lineno">  101</span>                <span class="comment"># lenBlendStack has the number of args represented by the last blend</span></div>
<div class="line"><span class="lineno">  102</span>                <span class="comment"># arg and all the preceding args. We need to now add the number of</span></div>
<div class="line"><span class="lineno">  103</span>                <span class="comment"># args following the last blend arg.</span></div>
<div class="line"><span class="lineno">  104</span>                numArgs = lenBlendStack + len(stack[lastBlendIndex:])</div>
<div class="line"><span class="lineno">  105</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  106</span>                numArgs = len(stack)</div>
<div class="line"><span class="lineno">  107</span>            <span class="keywordflow">if</span> numArgs <span class="keywordflow">and</span> (numArgs % 2) ^ parity:</div>
<div class="line"><span class="lineno">  108</span>                width = stack.pop(0)</div>
<div class="line"><span class="lineno">  109</span>                commands.append((<span class="stringliteral">&#39;&#39;</span>, [width]))</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>        <span class="keywordflow">if</span> token <span class="keywordflow">in</span> {<span class="stringliteral">&#39;hintmask&#39;</span>, <span class="stringliteral">&#39;cntrmask&#39;</span>}:</div>
<div class="line"><span class="lineno">  112</span>            <span class="keywordflow">if</span> stack:</div>
<div class="line"><span class="lineno">  113</span>                commands.append((<span class="stringliteral">&#39;&#39;</span>, stack))</div>
<div class="line"><span class="lineno">  114</span>            commands.append((token, []))</div>
<div class="line"><span class="lineno">  115</span>            commands.append((<span class="stringliteral">&#39;&#39;</span>, [next(it)]))</div>
<div class="line"><span class="lineno">  116</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  117</span>            commands.append((token, stack))</div>
<div class="line"><span class="lineno">  118</span>        stack = []</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">if</span> stack:</div>
<div class="line"><span class="lineno">  120</span>        commands.append((<span class="stringliteral">&#39;&#39;</span>, stack))</div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">return</span> commands</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_a60590d91febfcb54d88443940cd5f23e"><div class="ttname"><a href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a></div><div class="ttdeci">void int double int double double double double int int * iter</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:623</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a155ad83cc4b2830b80a6e8252b21b2f1" name="a155ad83cc4b2830b80a6e8252b21b2f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a155ad83cc4b2830b80a6e8252b21b2f1">&#9670;&#160;</a></span>programToString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.programToString </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>program</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   35</span><span class="keyword">def </span>programToString(program):</div>
<div class="line"><span class="lineno">   36</span>    <span class="keywordflow">return</span> <span class="stringliteral">&#39; &#39;</span>.join(str(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> program)</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa31c6443748908b636cae3a8e053b310" name="aa31c6443748908b636cae3a8e053b310"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa31c6443748908b636cae3a8e053b310">&#9670;&#160;</a></span>specializeCommands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.specializeCommands </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>commands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ignoreErrors</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>generalizeFirst</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preserveTopology</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxstack</em> = <code>48</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  456</span>               maxstack=48):</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    <span class="comment"># We perform several rounds of optimizations.  They are carefully ordered and are:</span></div>
<div class="line"><span class="lineno">  459</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  460</span>    <span class="comment"># 0. Generalize commands.</span></div>
<div class="line"><span class="lineno">  461</span>    <span class="comment">#    This ensures that they are in our expected simple form, with each line/curve only</span></div>
<div class="line"><span class="lineno">  462</span>    <span class="comment">#    having arguments for one segment, and using the generic form (rlineto/rrcurveto).</span></div>
<div class="line"><span class="lineno">  463</span>    <span class="comment">#    If caller is sure the input is in this form, they can turn off generalization to</span></div>
<div class="line"><span class="lineno">  464</span>    <span class="comment">#    save time.</span></div>
<div class="line"><span class="lineno">  465</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  466</span>    <span class="comment"># 1. Combine successive rmoveto operations.</span></div>
<div class="line"><span class="lineno">  467</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  468</span>    <span class="comment"># 2. Specialize rmoveto/rlineto/rrcurveto operators into horizontal/vertical variants.</span></div>
<div class="line"><span class="lineno">  469</span>    <span class="comment">#    We specialize into some, made-up, variants as well, which simplifies following</span></div>
<div class="line"><span class="lineno">  470</span>    <span class="comment">#    passes.</span></div>
<div class="line"><span class="lineno">  471</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  472</span>    <span class="comment"># 3. Merge or delete redundant operations, to the extent requested.</span></div>
<div class="line"><span class="lineno">  473</span>    <span class="comment">#    OpenType spec declares point numbers in CFF undefined.  As such, we happily</span></div>
<div class="line"><span class="lineno">  474</span>    <span class="comment">#    change topology.  If client relies on point numbers (in GPOS anchors, or for</span></div>
<div class="line"><span class="lineno">  475</span>    <span class="comment">#    hinting purposes(what?)) they can turn this off.</span></div>
<div class="line"><span class="lineno">  476</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  477</span>    <span class="comment"># 4. Peephole optimization to revert back some of the h/v variants back into their</span></div>
<div class="line"><span class="lineno">  478</span>    <span class="comment">#    original &quot;relative&quot; operator (rline/rrcurveto) if that saves a byte.</span></div>
<div class="line"><span class="lineno">  479</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  480</span>    <span class="comment"># 5. Combine adjacent operators when possible, minding not to go over max stack size.</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  482</span>    <span class="comment"># 6. Resolve any remaining made-up operators into real operators.</span></div>
<div class="line"><span class="lineno">  483</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  484</span>    <span class="comment"># I have convinced myself that this produces optimal bytecode (except for, possibly</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="comment"># one byte each time maxstack size prohibits combining.)  YMMV, but you&#39;d be wrong. :-)</span></div>
<div class="line"><span class="lineno">  486</span>    <span class="comment"># A dynamic-programming approach can do the same but would be significantly slower.</span></div>
<div class="line"><span class="lineno">  487</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  488</span>    <span class="comment"># 7. For any args which are blend lists, convert them to a blend command.</span></div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    <span class="comment"># 0. Generalize commands.</span></div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">if</span> generalizeFirst:</div>
<div class="line"><span class="lineno">  493</span>        commands = generalizeCommands(commands, ignoreErrors=ignoreErrors)</div>
<div class="line"><span class="lineno">  494</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  495</span>        commands = list(commands) <span class="comment"># Make copy since we modify in-place later.</span></div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    <span class="comment"># 1. Combine successive rmoveto operations.</span></div>
<div class="line"><span class="lineno">  498</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(commands)-1, 0, -1):</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;rmoveto&#39;</span> == commands[i][0] == commands[i-1][0]:</div>
<div class="line"><span class="lineno">  500</span>            v1, v2 = commands[i-1][1], commands[i][1]</div>
<div class="line"><span class="lineno">  501</span>            commands[i-1] = (<span class="stringliteral">&#39;rmoveto&#39;</span>, [v1[0]+v2[0], v1[1]+v2[1]])</div>
<div class="line"><span class="lineno">  502</span>            del commands[i]</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="comment"># 2. Specialize rmoveto/rlineto/rrcurveto operators into horizontal/vertical variants.</span></div>
<div class="line"><span class="lineno">  505</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  506</span>    <span class="comment"># We, in fact, specialize into more, made-up, variants that special-case when both</span></div>
<div class="line"><span class="lineno">  507</span>    <span class="comment"># X and Y components are zero.  This simplifies the following optimization passes.</span></div>
<div class="line"><span class="lineno">  508</span>    <span class="comment"># This case is rare, but OCD does not let me skip it.</span></div>
<div class="line"><span class="lineno">  509</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  510</span>    <span class="comment"># After this round, we will have four variants that use the following mnemonics:</span></div>
<div class="line"><span class="lineno">  511</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  512</span>    <span class="comment">#  - &#39;r&#39; for relative,   ie. non-zero X and non-zero Y,</span></div>
<div class="line"><span class="lineno">  513</span>    <span class="comment">#  - &#39;h&#39; for horizontal, ie. zero X and non-zero Y,</span></div>
<div class="line"><span class="lineno">  514</span>    <span class="comment">#  - &#39;v&#39; for vertical,   ie. non-zero X and zero Y,</span></div>
<div class="line"><span class="lineno">  515</span>    <span class="comment">#  - &#39;0&#39; for zeros,      ie. zero X and zero Y.</span></div>
<div class="line"><span class="lineno">  516</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  517</span>    <span class="comment"># The &#39;0&#39; pseudo-operators are not part of the spec, but help simplify the following</span></div>
<div class="line"><span class="lineno">  518</span>    <span class="comment"># optimization rounds.  We resolve them at the end.  So, after this, we will have four</span></div>
<div class="line"><span class="lineno">  519</span>    <span class="comment"># moveto and four lineto variants:</span></div>
<div class="line"><span class="lineno">  520</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  521</span>    <span class="comment">#  - 0moveto, 0lineto</span></div>
<div class="line"><span class="lineno">  522</span>    <span class="comment">#  - hmoveto, hlineto</span></div>
<div class="line"><span class="lineno">  523</span>    <span class="comment">#  - vmoveto, vlineto</span></div>
<div class="line"><span class="lineno">  524</span>    <span class="comment">#  - rmoveto, rlineto</span></div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="comment"># and sixteen curveto variants.  For example, a &#39;0hcurveto&#39; operator means a curve</span></div>
<div class="line"><span class="lineno">  527</span>    <span class="comment"># dx0,dy0,dx1,dy1,dx2,dy2,dx3,dy3 where dx0, dx1, and dy3 are zero but not dx3.</span></div>
<div class="line"><span class="lineno">  528</span>    <span class="comment"># An &#39;rvcurveto&#39; means dx3 is zero but not dx0,dy0,dy3.</span></div>
<div class="line"><span class="lineno">  529</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  530</span>    <span class="comment"># There are nine different variants of curves without the &#39;0&#39;.  Those nine map exactly</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="comment"># to the existing curve variants in the spec: rrcurveto, and the four variants hhcurveto,</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="comment"># vvcurveto, hvcurveto, and vhcurveto each cover two cases, one with an odd number of</span></div>
<div class="line"><span class="lineno">  533</span>    <span class="comment"># arguments and one without.  Eg. an hhcurveto with an extra argument (odd number of</span></div>
<div class="line"><span class="lineno">  534</span>    <span class="comment"># arguments) is in fact an rhcurveto.  The operators in the spec are designed such that</span></div>
<div class="line"><span class="lineno">  535</span>    <span class="comment"># all four of rhcurveto, rvcurveto, hrcurveto, and vrcurveto are encodable for one curve.</span></div>
<div class="line"><span class="lineno">  536</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  537</span>    <span class="comment"># Of the curve types with &#39;0&#39;, the 00curveto is equivalent to a lineto variant.  The rest</span></div>
<div class="line"><span class="lineno">  538</span>    <span class="comment"># of the curve types with a 0 need to be encoded as a h or v variant.  Ie. a &#39;0&#39; can be</span></div>
<div class="line"><span class="lineno">  539</span>    <span class="comment"># thought of a &quot;don&#39;t care&quot; and can be used as either an &#39;h&#39; or a &#39;v&#39;.  As such, we always</span></div>
<div class="line"><span class="lineno">  540</span>    <span class="comment"># encode a number 0 as argument when we use a &#39;0&#39; variant.  Later on, we can just substitute</span></div>
<div class="line"><span class="lineno">  541</span>    <span class="comment"># the &#39;0&#39; with either &#39;h&#39; or &#39;v&#39; and it works.</span></div>
<div class="line"><span class="lineno">  542</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  543</span>    <span class="comment"># When we get to curve splines however, things become more complicated...  XXX finish this.</span></div>
<div class="line"><span class="lineno">  544</span>    <span class="comment"># There&#39;s one more complexity with splines.  If one side of the spline is not horizontal or</span></div>
<div class="line"><span class="lineno">  545</span>    <span class="comment"># vertical (or zero), ie. if it&#39;s &#39;r&#39;, then it limits which spline types we can encode.</span></div>
<div class="line"><span class="lineno">  546</span>    <span class="comment"># Only hhcurveto and vvcurveto operators can encode a spline starting with &#39;r&#39;, and</span></div>
<div class="line"><span class="lineno">  547</span>    <span class="comment"># only hvcurveto and vhcurveto operators can encode a spline ending with &#39;r&#39;.</span></div>
<div class="line"><span class="lineno">  548</span>    <span class="comment"># This limits our merge opportunities later.</span></div>
<div class="line"><span class="lineno">  549</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  550</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(commands)):</div>
<div class="line"><span class="lineno">  551</span>        op,args = commands[i]</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>        <span class="keywordflow">if</span> op <span class="keywordflow">in</span> {<span class="stringliteral">&#39;rmoveto&#39;</span>, <span class="stringliteral">&#39;rlineto&#39;</span>}:</div>
<div class="line"><span class="lineno">  554</span>            c, args = _categorizeVector(args)</div>
<div class="line"><span class="lineno">  555</span>            commands[i] = c+op[1:], args</div>
<div class="line"><span class="lineno">  556</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>        <span class="keywordflow">if</span> op == <span class="stringliteral">&#39;rrcurveto&#39;</span>:</div>
<div class="line"><span class="lineno">  559</span>            c1, args1 = _categorizeVector(args[:2])</div>
<div class="line"><span class="lineno">  560</span>            c2, args2 = _categorizeVector(args[-2:])</div>
<div class="line"><span class="lineno">  561</span>            commands[i] = c1+c2+<span class="stringliteral">&#39;curveto&#39;</span>, args1+args[2:4]+args2</div>
<div class="line"><span class="lineno">  562</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    <span class="comment"># 3. Merge or delete redundant operations, to the extent requested.</span></div>
<div class="line"><span class="lineno">  565</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  566</span>    <span class="comment"># TODO</span></div>
<div class="line"><span class="lineno">  567</span>    <span class="comment"># A 0moveto that comes before all other path operations can be removed.</span></div>
<div class="line"><span class="lineno">  568</span>    <span class="comment"># though I find conflicting evidence for this.</span></div>
<div class="line"><span class="lineno">  569</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  570</span>    <span class="comment"># TODO</span></div>
<div class="line"><span class="lineno">  571</span>    <span class="comment"># &quot;If hstem and vstem hints are both declared at the beginning of a</span></div>
<div class="line"><span class="lineno">  572</span>    <span class="comment"># CharString, and this sequence is followed directly by the hintmask or</span></div>
<div class="line"><span class="lineno">  573</span>    <span class="comment"># cntrmask operators, then the vstem hint operator (or, if applicable,</span></div>
<div class="line"><span class="lineno">  574</span>    <span class="comment"># the vstemhm operator) need not be included.&quot;</span></div>
<div class="line"><span class="lineno">  575</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  576</span>    <span class="comment"># &quot;The sequence and form of a CFF2 CharString program may be represented as:</span></div>
<div class="line"><span class="lineno">  577</span>    <span class="comment"># {hs* vs* cm* hm* mt subpath}? {mt subpath}*&quot;</span></div>
<div class="line"><span class="lineno">  578</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  579</span>    <span class="comment"># https://www.microsoft.com/typography/otspec/cff2charstr.htm#section3.1</span></div>
<div class="line"><span class="lineno">  580</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  581</span>    <span class="comment"># For Type2 CharStrings the sequence is:</span></div>
<div class="line"><span class="lineno">  582</span>    <span class="comment"># w? {hs* vs* cm* hm* mt subpath}? {mt subpath}* endchar&quot;</span></div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>    <span class="comment"># Some other redundancies change topology (point numbers).</span></div>
<div class="line"><span class="lineno">  586</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> preserveTopology:</div>
<div class="line"><span class="lineno">  587</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(commands)-1, -1, -1):</div>
<div class="line"><span class="lineno">  588</span>            op, args = commands[i]</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>            <span class="comment"># A 00curveto is demoted to a (specialized) lineto.</span></div>
<div class="line"><span class="lineno">  591</span>            <span class="keywordflow">if</span> op == <span class="stringliteral">&#39;00curveto&#39;</span>:</div>
<div class="line"><span class="lineno">  592</span>                <span class="keyword">assert</span> len(args) == 4</div>
<div class="line"><span class="lineno">  593</span>                c, args = _categorizeVector(args[1:3])</div>
<div class="line"><span class="lineno">  594</span>                op = c+<span class="stringliteral">&#39;lineto&#39;</span></div>
<div class="line"><span class="lineno">  595</span>                commands[i] = op, args</div>
<div class="line"><span class="lineno">  596</span>                <span class="comment"># and then...</span></div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>            <span class="comment"># A 0lineto can be deleted.</span></div>
<div class="line"><span class="lineno">  599</span>            <span class="keywordflow">if</span> op == <span class="stringliteral">&#39;0lineto&#39;</span>:</div>
<div class="line"><span class="lineno">  600</span>                del commands[i]</div>
<div class="line"><span class="lineno">  601</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>            <span class="comment"># Merge adjacent hlineto&#39;s and vlineto&#39;s.</span></div>
<div class="line"><span class="lineno">  604</span>            <span class="comment"># In CFF2 charstrings from variable fonts, each</span></div>
<div class="line"><span class="lineno">  605</span>            <span class="comment"># arg item may be a list of blendable values, one from</span></div>
<div class="line"><span class="lineno">  606</span>            <span class="comment"># each source font.</span></div>
<div class="line"><span class="lineno">  607</span>            <span class="keywordflow">if</span> (i <span class="keywordflow">and</span> op <span class="keywordflow">in</span> {<span class="stringliteral">&#39;hlineto&#39;</span>, <span class="stringliteral">&#39;vlineto&#39;</span>} <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  608</span>                            (op == commands[i-1][0])):</div>
<div class="line"><span class="lineno">  609</span>                _, other_args = commands[i-1]</div>
<div class="line"><span class="lineno">  610</span>                <span class="keyword">assert</span> len(args) == 1 <span class="keywordflow">and</span> len(other_args) == 1</div>
<div class="line"><span class="lineno">  611</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  612</span>                    new_args = [_addArgs(args[0], other_args[0])]</div>
<div class="line"><span class="lineno">  613</span>                <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  614</span>                    <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  615</span>                commands[i-1] = (op, new_args)</div>
<div class="line"><span class="lineno">  616</span>                del commands[i]</div>
<div class="line"><span class="lineno">  617</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    <span class="comment"># 4. Peephole optimization to revert back some of the h/v variants back into their</span></div>
<div class="line"><span class="lineno">  620</span>    <span class="comment">#    original &quot;relative&quot; operator (rline/rrcurveto) if that saves a byte.</span></div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(1, len(commands)-1):</div>
<div class="line"><span class="lineno">  622</span>        op,args = commands[i]</div>
<div class="line"><span class="lineno">  623</span>        prv,nxt = commands[i-1][0], commands[i+1][0]</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span>        <span class="keywordflow">if</span> op <span class="keywordflow">in</span> {<span class="stringliteral">&#39;0lineto&#39;</span>, <span class="stringliteral">&#39;hlineto&#39;</span>, <span class="stringliteral">&#39;vlineto&#39;</span>} <span class="keywordflow">and</span> prv == nxt == <span class="stringliteral">&#39;rlineto&#39;</span>:</div>
<div class="line"><span class="lineno">  626</span>            <span class="keyword">assert</span> len(args) == 1</div>
<div class="line"><span class="lineno">  627</span>            args = [0, args[0]] <span class="keywordflow">if</span> op[0] == <span class="stringliteral">&#39;v&#39;</span> <span class="keywordflow">else</span> [args[0], 0]</div>
<div class="line"><span class="lineno">  628</span>            commands[i] = (<span class="stringliteral">&#39;rlineto&#39;</span>, args)</div>
<div class="line"><span class="lineno">  629</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>        <span class="keywordflow">if</span> op[2:] == <span class="stringliteral">&#39;curveto&#39;</span> <span class="keywordflow">and</span> len(args) == 5 <span class="keywordflow">and</span> prv == nxt == <span class="stringliteral">&#39;rrcurveto&#39;</span>:</div>
<div class="line"><span class="lineno">  632</span>            <span class="keyword">assert</span> (op[0] == <span class="stringliteral">&#39;r&#39;</span>) ^ (op[1] == <span class="stringliteral">&#39;r&#39;</span>)</div>
<div class="line"><span class="lineno">  633</span>            <span class="keywordflow">if</span> op[0] == <span class="stringliteral">&#39;v&#39;</span>:</div>
<div class="line"><span class="lineno">  634</span>                pos = 0</div>
<div class="line"><span class="lineno">  635</span>            <span class="keywordflow">elif</span> op[0] != <span class="stringliteral">&#39;r&#39;</span>:</div>
<div class="line"><span class="lineno">  636</span>                pos = 1</div>
<div class="line"><span class="lineno">  637</span>            <span class="keywordflow">elif</span> op[1] == <span class="stringliteral">&#39;v&#39;</span>:</div>
<div class="line"><span class="lineno">  638</span>                pos = 4</div>
<div class="line"><span class="lineno">  639</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  640</span>                pos = 5</div>
<div class="line"><span class="lineno">  641</span>            <span class="comment"># Insert, while maintaining the type of args (can be tuple or list).</span></div>
<div class="line"><span class="lineno">  642</span>            args = args[:pos] + type(args)((0,)) + args[pos:]</div>
<div class="line"><span class="lineno">  643</span>            commands[i] = (<span class="stringliteral">&#39;rrcurveto&#39;</span>, args)</div>
<div class="line"><span class="lineno">  644</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    <span class="comment"># 5. Combine adjacent operators when possible, minding not to go over max stack size.</span></div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(commands)-1, 0, -1):</div>
<div class="line"><span class="lineno">  648</span>        op1,args1 = commands[i-1]</div>
<div class="line"><span class="lineno">  649</span>        op2,args2 = commands[i]</div>
<div class="line"><span class="lineno">  650</span>        new_op = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>        <span class="comment"># Merge logic...</span></div>
<div class="line"><span class="lineno">  653</span>        <span class="keywordflow">if</span> {op1, op2} &lt;= {<span class="stringliteral">&#39;rlineto&#39;</span>, <span class="stringliteral">&#39;rrcurveto&#39;</span>}:</div>
<div class="line"><span class="lineno">  654</span>            <span class="keywordflow">if</span> op1 == op2:</div>
<div class="line"><span class="lineno">  655</span>                new_op = op1</div>
<div class="line"><span class="lineno">  656</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  657</span>                <span class="keywordflow">if</span> op2 == <span class="stringliteral">&#39;rrcurveto&#39;</span> <span class="keywordflow">and</span> len(args2) == 6:</div>
<div class="line"><span class="lineno">  658</span>                    new_op = <span class="stringliteral">&#39;rlinecurve&#39;</span></div>
<div class="line"><span class="lineno">  659</span>                <span class="keywordflow">elif</span> len(args2) == 2:</div>
<div class="line"><span class="lineno">  660</span>                    new_op = <span class="stringliteral">&#39;rcurveline&#39;</span></div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>        <span class="keywordflow">elif</span> (op1, op2) <span class="keywordflow">in</span> {(<span class="stringliteral">&#39;rlineto&#39;</span>, <span class="stringliteral">&#39;rlinecurve&#39;</span>), (<span class="stringliteral">&#39;rrcurveto&#39;</span>, <span class="stringliteral">&#39;rcurveline&#39;</span>)}:</div>
<div class="line"><span class="lineno">  663</span>            new_op = op2</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>        <span class="keywordflow">elif</span> {op1, op2} == {<span class="stringliteral">&#39;vlineto&#39;</span>, <span class="stringliteral">&#39;hlineto&#39;</span>}:</div>
<div class="line"><span class="lineno">  666</span>            new_op = op1</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>        <span class="keywordflow">elif</span> <span class="stringliteral">&#39;curveto&#39;</span> == op1[2:] == op2[2:]:</div>
<div class="line"><span class="lineno">  669</span>            d0, d1 = op1[:2]</div>
<div class="line"><span class="lineno">  670</span>            d2, d3 = op2[:2]</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>            <span class="keywordflow">if</span> d1 == <span class="stringliteral">&#39;r&#39;</span> <span class="keywordflow">or</span> d2 == <span class="stringliteral">&#39;r&#39;</span> <span class="keywordflow">or</span> d0 == d3 == <span class="stringliteral">&#39;r&#39;</span>:</div>
<div class="line"><span class="lineno">  673</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>            d = _mergeCategories(d1, d2)</div>
<div class="line"><span class="lineno">  676</span>            <span class="keywordflow">if</span> d <span class="keywordflow">is</span> <span class="keywordtype">None</span>: <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  677</span>            <span class="keywordflow">if</span> d0 == <span class="stringliteral">&#39;r&#39;</span>:</div>
<div class="line"><span class="lineno">  678</span>                d = _mergeCategories(d, d3)</div>
<div class="line"><span class="lineno">  679</span>                <span class="keywordflow">if</span> d <span class="keywordflow">is</span> <span class="keywordtype">None</span>: <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  680</span>                new_op = <span class="stringliteral">&#39;r&#39;</span>+d+<span class="stringliteral">&#39;curveto&#39;</span></div>
<div class="line"><span class="lineno">  681</span>            <span class="keywordflow">elif</span> d3 == <span class="stringliteral">&#39;r&#39;</span>:</div>
<div class="line"><span class="lineno">  682</span>                d0 = _mergeCategories(d0, _negateCategory(d))</div>
<div class="line"><span class="lineno">  683</span>                <span class="keywordflow">if</span> d0 <span class="keywordflow">is</span> <span class="keywordtype">None</span>: <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  684</span>                new_op = d0+<span class="stringliteral">&#39;r&#39;</span>+<span class="stringliteral">&#39;curveto&#39;</span></div>
<div class="line"><span class="lineno">  685</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  686</span>                d0 = _mergeCategories(d0, d3)</div>
<div class="line"><span class="lineno">  687</span>                <span class="keywordflow">if</span> d0 <span class="keywordflow">is</span> <span class="keywordtype">None</span>: <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  688</span>                new_op = d0+d+<span class="stringliteral">&#39;curveto&#39;</span></div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>        <span class="comment"># Make sure the stack depth does not exceed (maxstack - 1), so</span></div>
<div class="line"><span class="lineno">  691</span>        <span class="comment"># that subroutinizer can insert subroutine calls at any point.</span></div>
<div class="line"><span class="lineno">  692</span>        <span class="keywordflow">if</span> new_op <span class="keywordflow">and</span> len(args1) + len(args2) &lt; maxstack:</div>
<div class="line"><span class="lineno">  693</span>            commands[i-1] = (new_op, args1+args2)</div>
<div class="line"><span class="lineno">  694</span>            del commands[i]</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>    <span class="comment"># 6. Resolve any remaining made-up operators into real operators.</span></div>
<div class="line"><span class="lineno">  697</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(commands)):</div>
<div class="line"><span class="lineno">  698</span>        op,args = commands[i]</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>        <span class="keywordflow">if</span> op <span class="keywordflow">in</span> {<span class="stringliteral">&#39;0moveto&#39;</span>, <span class="stringliteral">&#39;0lineto&#39;</span>}:</div>
<div class="line"><span class="lineno">  701</span>            commands[i] = <span class="stringliteral">&#39;h&#39;</span>+op[1:], args</div>
<div class="line"><span class="lineno">  702</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>        <span class="keywordflow">if</span> op[2:] == <span class="stringliteral">&#39;curveto&#39;</span> <span class="keywordflow">and</span> op[:2] <span class="keywordflow">not</span> <span class="keywordflow">in</span> {<span class="stringliteral">&#39;rr&#39;</span>, <span class="stringliteral">&#39;hh&#39;</span>, <span class="stringliteral">&#39;vv&#39;</span>, <span class="stringliteral">&#39;vh&#39;</span>, <span class="stringliteral">&#39;hv&#39;</span>}:</div>
<div class="line"><span class="lineno">  705</span>            op0, op1 = op[:2]</div>
<div class="line"><span class="lineno">  706</span>            <span class="keywordflow">if</span> (op0 == <span class="stringliteral">&#39;r&#39;</span>) ^ (op1 == <span class="stringliteral">&#39;r&#39;</span>):</div>
<div class="line"><span class="lineno">  707</span>                <span class="keyword">assert</span> len(args) % 2 == 1</div>
<div class="line"><span class="lineno">  708</span>            <span class="keywordflow">if</span> op0 == <span class="stringliteral">&#39;0&#39;</span>: op0 = <span class="stringliteral">&#39;h&#39;</span></div>
<div class="line"><span class="lineno">  709</span>            <span class="keywordflow">if</span> op1 == <span class="stringliteral">&#39;0&#39;</span>: op1 = <span class="stringliteral">&#39;h&#39;</span></div>
<div class="line"><span class="lineno">  710</span>            <span class="keywordflow">if</span> op0 == <span class="stringliteral">&#39;r&#39;</span>: op0 = op1</div>
<div class="line"><span class="lineno">  711</span>            <span class="keywordflow">if</span> op1 == <span class="stringliteral">&#39;r&#39;</span>: op1 = _negateCategory(op0)</div>
<div class="line"><span class="lineno">  712</span>            <span class="keyword">assert</span> {op0,op1} &lt;= {<span class="stringliteral">&#39;h&#39;</span>,<span class="stringliteral">&#39;v&#39;</span>}, (op0, op1)</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>            <span class="keywordflow">if</span> len(args) % 2:</div>
<div class="line"><span class="lineno">  715</span>                <span class="keywordflow">if</span> op0 != op1: <span class="comment"># vhcurveto / hvcurveto</span></div>
<div class="line"><span class="lineno">  716</span>                    <span class="keywordflow">if</span> (op0 == <span class="stringliteral">&#39;h&#39;</span>) ^ (len(args) % 8 == 1):</div>
<div class="line"><span class="lineno">  717</span>                        <span class="comment"># Swap last two args order</span></div>
<div class="line"><span class="lineno">  718</span>                        args = args[:-2]+args[-1:]+args[-2:-1]</div>
<div class="line"><span class="lineno">  719</span>                <span class="keywordflow">else</span>: <span class="comment"># hhcurveto / vvcurveto</span></div>
<div class="line"><span class="lineno">  720</span>                    <span class="keywordflow">if</span> op0 == <span class="stringliteral">&#39;h&#39;</span>: <span class="comment"># hhcurveto</span></div>
<div class="line"><span class="lineno">  721</span>                        <span class="comment"># Swap first two args order</span></div>
<div class="line"><span class="lineno">  722</span>                        args = args[1:2]+args[:1]+args[2:]</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>            commands[i] = op0+op1+<span class="stringliteral">&#39;curveto&#39;</span>, args</div>
<div class="line"><span class="lineno">  725</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>    <span class="comment"># 7. For any series of args which are blend lists, convert the series to a single blend arg.</span></div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(commands)):</div>
<div class="line"><span class="lineno">  729</span>        op, args = commands[i]</div>
<div class="line"><span class="lineno">  730</span>        <span class="keywordflow">if</span> any(isinstance(arg, list) <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> args):</div>
<div class="line"><span class="lineno">  731</span>            commands[i] = op, _convertToBlendCmds(args)</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>    <span class="keywordflow">return</span> commands</div>
<div class="line"><span class="lineno">  734</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a296c9f18cd078c23bd6f352ca443c566" name="a296c9f18cd078c23bd6f352ca443c566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a296c9f18cd078c23bd6f352ca443c566">&#9670;&#160;</a></span>specializeProgram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.specializeProgram </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>program</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>getNumRegions</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  735</span><span class="keyword">def </span>specializeProgram(program, getNumRegions=None, **kwargs):</div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordflow">return</span> commandsToProgram(specializeCommands(programToCommands(program, getNumRegions), **kwargs))</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abcba3b335ec00348102ae1d8c6f4e3f4" name="abcba3b335ec00348102ae1d8c6f4e3f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcba3b335ec00348102ae1d8c6f4e3f4">&#9670;&#160;</a></span>stringToProgram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.stringToProgram </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>string</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   19</span><span class="keyword">def </span>stringToProgram(string):</div>
<div class="line"><span class="lineno">   20</span>    <span class="keywordflow">if</span> isinstance(string, str):</div>
<div class="line"><span class="lineno">   21</span>        string = string.split()</div>
<div class="line"><span class="lineno">   22</span>    program = []</div>
<div class="line"><span class="lineno">   23</span>    <span class="keywordflow">for</span> token <span class="keywordflow">in</span> string:</div>
<div class="line"><span class="lineno">   24</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   25</span>            token = int(token)</div>
<div class="line"><span class="lineno">   26</span>        <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">   27</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   28</span>                token = float(token)</div>
<div class="line"><span class="lineno">   29</span>            <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">   30</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">   31</span>        program.append(token)</div>
<div class="line"><span class="lineno">   32</span>    <span class="keywordflow">return</span> program</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3ed0c278e6ace1631557b1ca3b64023d" name="a3ed0c278e6ace1631557b1ca3b64023d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ed0c278e6ace1631557b1ca3b64023d">&#9670;&#160;</a></span>commands</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.commands = <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#ae96b10e67695ca9649119110ace82a8f">programToCommands</a>(<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#aefa6d0d36d587bd14e37492c20472460">program</a>, <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a9a89cc7c0675ab39f773445a0c3798fb">getNumRegions</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c7812e8fd2c9c9fa696e813c2efc7d4" name="a7c7812e8fd2c9c9fa696e813c2efc7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7812e8fd2c9c9fa696e813c2efc7d4">&#9670;&#160;</a></span>default</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.default</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a89cc7c0675ab39f773445a0c3798fb" name="a9a89cc7c0675ab39f773445a0c3798fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a89cc7c0675ab39f773445a0c3798fb">&#9670;&#160;</a></span>getNumRegions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fontTools.cffLib.specializer.getNumRegions = None if options.num_regions is None else <a class="el" href="__lapack__subroutines_8h.html#a76093d20ca2e1c5d5216168f26f73e19">lambda</a> vsIndex(options.num_regions[0 if vsIndex is None else vsIndex])</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a824fe5e0a118b57e7b498ea30a495da8" name="a824fe5e0a118b57e7b498ea30a495da8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a824fe5e0a118b57e7b498ea30a495da8">&#9670;&#160;</a></span>help</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.help</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a58327c3ec28dd12da069c29719dfb621" name="a58327c3ec28dd12da069c29719dfb621"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58327c3ec28dd12da069c29719dfb621">&#9670;&#160;</a></span>metavar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.metavar</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aae7442ac4810d7dca9a16a6fb1a1c61e" name="aae7442ac4810d7dca9a16a6fb1a1c61e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7442ac4810d7dca9a16a6fb1a1c61e">&#9670;&#160;</a></span>nargs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.nargs</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a368b1527a310a8649cb95c2ab51dc3ec" name="a368b1527a310a8649cb95c2ab51dc3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a368b1527a310a8649cb95c2ab51dc3ec">&#9670;&#160;</a></span>options</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.options = parser.parse_args(sys.argv[1:])</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a487430311d17ba046512f46a7e3eb760" name="a487430311d17ba046512f46a7e3eb760"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a487430311d17ba046512f46a7e3eb760">&#9670;&#160;</a></span>parser</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.parser</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  argparse.ArgumentParser(</div>
<div class="line"><span class="lineno">    2</span>        <span class="stringliteral">&quot;fonttools cffLib.specialer&quot;</span>, description=<span class="stringliteral">&quot;CFF CharString generalizer/specializer&quot;</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aefa6d0d36d587bd14e37492c20472460" name="aefa6d0d36d587bd14e37492c20472460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa6d0d36d587bd14e37492c20472460">&#9670;&#160;</a></span>program</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.program = <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#abcba3b335ec00348102ae1d8c6f4e3f4">stringToProgram</a>(options.program)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aee4a4360d741a8ca819d24258af4c36b" name="aee4a4360d741a8ca819d24258af4c36b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee4a4360d741a8ca819d24258af4c36b">&#9670;&#160;</a></span>program2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fontTools.cffLib.specializer.program2 = <a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#ad36402550c84ab1ec66e48fcb9221045">commandsToProgram</a>(<a class="el" href="namespacefont_tools_1_1cff_lib_1_1specializer.html#a3ed0c278e6ace1631557b1ca3b64023d">commands</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
