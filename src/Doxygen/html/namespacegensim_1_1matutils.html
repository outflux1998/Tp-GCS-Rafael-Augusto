<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: gensim.matutils Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegensim.html">gensim</a></li><li class="navelem"><a class="el" href="namespacegensim_1_1matutils.html">matutils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">gensim.matutils Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1matutils_1_1_dense2_corpus.html">Dense2Corpus</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1matutils_1_1_mm_writer.html">MmWriter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1matutils_1_1_scipy2_corpus.html">Scipy2Corpus</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1matutils_1_1_sparse2_corpus.html">Sparse2Corpus</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abe0c34c59d19760696fb541155764405" id="r_abe0c34c59d19760696fb541155764405"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#abe0c34c59d19760696fb541155764405">blas</a> (name, ndarray)</td></tr>
<tr class="separator:abe0c34c59d19760696fb541155764405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86f380844deb3038727102ebfe7ec055" id="r_a86f380844deb3038727102ebfe7ec055"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a86f380844deb3038727102ebfe7ec055">argsort</a> (x, topn=None, reverse=False)</td></tr>
<tr class="separator:a86f380844deb3038727102ebfe7ec055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25eac9310d99ae3dd7e6e2bcdd557672" id="r_a25eac9310d99ae3dd7e6e2bcdd557672"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a25eac9310d99ae3dd7e6e2bcdd557672">corpus2csc</a> (corpus, num_terms=None, dtype=np.float64, num_docs=None, num_nnz=None, printprogress=0)</td></tr>
<tr class="separator:a25eac9310d99ae3dd7e6e2bcdd557672"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8b5b25340ec539ea44fcfeb7bc395c3" id="r_ad8b5b25340ec539ea44fcfeb7bc395c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#ad8b5b25340ec539ea44fcfeb7bc395c3">pad</a> (mat, padrow, padcol)</td></tr>
<tr class="separator:ad8b5b25340ec539ea44fcfeb7bc395c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0f4e63af65970c43d3dd2186786c773" id="r_af0f4e63af65970c43d3dd2186786c773"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#af0f4e63af65970c43d3dd2186786c773">zeros_aligned</a> (shape, dtype, <a class="el" href="__lapack__subroutines_8h.html#a9993259f1ab17738593f079acd0507d9">order</a>='C', align=128)</td></tr>
<tr class="separator:af0f4e63af65970c43d3dd2186786c773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4580d676c48a2532b4926892e368860e" id="r_a4580d676c48a2532b4926892e368860e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a4580d676c48a2532b4926892e368860e">ismatrix</a> (m)</td></tr>
<tr class="separator:a4580d676c48a2532b4926892e368860e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223db3e0c1923d447d40ef24ca539918" id="r_a223db3e0c1923d447d40ef24ca539918"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a223db3e0c1923d447d40ef24ca539918">any2sparse</a> (vec, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=1e-9)</td></tr>
<tr class="separator:a223db3e0c1923d447d40ef24ca539918"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad813947c2ce8af1d77f4e8434e7d3b" id="r_a3ad813947c2ce8af1d77f4e8434e7d3b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a3ad813947c2ce8af1d77f4e8434e7d3b">scipy2scipy_clipped</a> (matrix, topn, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=1e-9)</td></tr>
<tr class="separator:a3ad813947c2ce8af1d77f4e8434e7d3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab54f53e1ed7609694d3780fbd84bab7a" id="r_ab54f53e1ed7609694d3780fbd84bab7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#ab54f53e1ed7609694d3780fbd84bab7a">scipy2sparse</a> (vec, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=1e-9)</td></tr>
<tr class="separator:ab54f53e1ed7609694d3780fbd84bab7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebe041e75909ae8356aed869f09fa04c" id="r_aebe041e75909ae8356aed869f09fa04c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#aebe041e75909ae8356aed869f09fa04c">sparse2full</a> (doc, length)</td></tr>
<tr class="separator:aebe041e75909ae8356aed869f09fa04c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8972e8b9ba0f7f794b7c947bc49077d4" id="r_a8972e8b9ba0f7f794b7c947bc49077d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a8972e8b9ba0f7f794b7c947bc49077d4">full2sparse</a> (vec, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=1e-9)</td></tr>
<tr class="separator:a8972e8b9ba0f7f794b7c947bc49077d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9031e2faaabb920c0dbbaefa703f692b" id="r_a9031e2faaabb920c0dbbaefa703f692b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a9031e2faaabb920c0dbbaefa703f692b">full2sparse_clipped</a> (vec, topn, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=1e-9)</td></tr>
<tr class="separator:a9031e2faaabb920c0dbbaefa703f692b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7399d7c850ca5ab689ac94329867705" id="r_ad7399d7c850ca5ab689ac94329867705"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#ad7399d7c850ca5ab689ac94329867705">corpus2dense</a> (corpus, num_terms, num_docs=None, dtype=np.float32)</td></tr>
<tr class="separator:ad7399d7c850ca5ab689ac94329867705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad762724c82f5acef13649629eef642bb" id="r_ad762724c82f5acef13649629eef642bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#ad762724c82f5acef13649629eef642bb">veclen</a> (vec)</td></tr>
<tr class="separator:ad762724c82f5acef13649629eef642bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a447cb9e0ed5905d6e9493c3580bc79" id="r_a2a447cb9e0ed5905d6e9493c3580bc79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a2a447cb9e0ed5905d6e9493c3580bc79">ret_normalized_vec</a> (vec, length)</td></tr>
<tr class="separator:a2a447cb9e0ed5905d6e9493c3580bc79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63cf0e11bba0c7ba10f735f79dc5bde0" id="r_a63cf0e11bba0c7ba10f735f79dc5bde0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a63cf0e11bba0c7ba10f735f79dc5bde0">ret_log_normalize_vec</a> (vec, axis=1)</td></tr>
<tr class="separator:a63cf0e11bba0c7ba10f735f79dc5bde0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11c02b431f495ce6ba422f942251de8" id="r_af11c02b431f495ce6ba422f942251de8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#af11c02b431f495ce6ba422f942251de8">unitvec</a> (vec, norm='l2', return_norm=False)</td></tr>
<tr class="separator:af11c02b431f495ce6ba422f942251de8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12beb90533660b111f13516eb88b8fa5" id="r_a12beb90533660b111f13516eb88b8fa5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a12beb90533660b111f13516eb88b8fa5">cossim</a> (vec1, vec2)</td></tr>
<tr class="separator:a12beb90533660b111f13516eb88b8fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf2c014bf52d555eed2b5679bc26a4e4" id="r_abf2c014bf52d555eed2b5679bc26a4e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#abf2c014bf52d555eed2b5679bc26a4e4">softcossim</a> (vec1, vec2, similarity_matrix)</td></tr>
<tr class="separator:abf2c014bf52d555eed2b5679bc26a4e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa725a5c2b70f0a9fa85c1e65a07e23ca" id="r_aa725a5c2b70f0a9fa85c1e65a07e23ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#aa725a5c2b70f0a9fa85c1e65a07e23ca">isbow</a> (vec)</td></tr>
<tr class="separator:aa725a5c2b70f0a9fa85c1e65a07e23ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6591ac34606e0c0079e292f0e361a51a" id="r_a6591ac34606e0c0079e292f0e361a51a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a6591ac34606e0c0079e292f0e361a51a">_convert_vec</a> (vec1, vec2, num_features=None)</td></tr>
<tr class="separator:a6591ac34606e0c0079e292f0e361a51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3a2666ecd1109ff5214af4cea6405ec" id="r_ad3a2666ecd1109ff5214af4cea6405ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#ad3a2666ecd1109ff5214af4cea6405ec">kullback_leibler</a> (vec1, vec2, num_features=None)</td></tr>
<tr class="separator:ad3a2666ecd1109ff5214af4cea6405ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af58e282400356078829b9472b76e74bb" id="r_af58e282400356078829b9472b76e74bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#af58e282400356078829b9472b76e74bb">jensen_shannon</a> (vec1, vec2, num_features=None)</td></tr>
<tr class="separator:af58e282400356078829b9472b76e74bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af44d50fc227389ca61d7d1e0eaeadc2d" id="r_af44d50fc227389ca61d7d1e0eaeadc2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#af44d50fc227389ca61d7d1e0eaeadc2d">hellinger</a> (vec1, vec2)</td></tr>
<tr class="separator:af44d50fc227389ca61d7d1e0eaeadc2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbe02ad4e6f3d8fbdb006a7663095500" id="r_afbe02ad4e6f3d8fbdb006a7663095500"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#afbe02ad4e6f3d8fbdb006a7663095500">jaccard</a> (vec1, vec2)</td></tr>
<tr class="separator:afbe02ad4e6f3d8fbdb006a7663095500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a23645563bfd40342cfb0b1683ec37b" id="r_a8a23645563bfd40342cfb0b1683ec37b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a8a23645563bfd40342cfb0b1683ec37b">jaccard_distance</a> (set1, set2)</td></tr>
<tr class="separator:a8a23645563bfd40342cfb0b1683ec37b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98755356babde3f881125b3c68b916b2" id="r_a98755356babde3f881125b3c68b916b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a98755356babde3f881125b3c68b916b2">logsumexp</a> (x)</td></tr>
<tr class="separator:a98755356babde3f881125b3c68b916b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bf1be670f82c68189f048be52a9d60f" id="r_a4bf1be670f82c68189f048be52a9d60f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a4bf1be670f82c68189f048be52a9d60f">mean_absolute_difference</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b)</td></tr>
<tr class="separator:a4bf1be670f82c68189f048be52a9d60f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a382e6a53cefcaadad1b0c51718670204" id="r_a382e6a53cefcaadad1b0c51718670204"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a382e6a53cefcaadad1b0c51718670204">dirichlet_expectation</a> (<a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>)</td></tr>
<tr class="separator:a382e6a53cefcaadad1b0c51718670204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c03e5d9b6fe398c45c9a253b28d0d8" id="r_a21c03e5d9b6fe398c45c9a253b28d0d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a21c03e5d9b6fe398c45c9a253b28d0d8">qr_destroy</a> (la)</td></tr>
<tr class="separator:a21c03e5d9b6fe398c45c9a253b28d0d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0fe2607c8676f0d12c9dd22a70120eef" id="r_a0fe2607c8676f0d12c9dd22a70120eef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a0fe2607c8676f0d12c9dd22a70120eef">logger</a> = logging.getLogger(__name__)</td></tr>
<tr class="separator:a0fe2607c8676f0d12c9dd22a70120eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2900a35713b5b9b91b22c385ac6151d" id="r_ac2900a35713b5b9b91b22c385ac6151d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#ac2900a35713b5b9b91b22c385ac6151d">dense2vec</a> = <a class="el" href="namespacegensim_1_1matutils.html#a8972e8b9ba0f7f794b7c947bc49077d4">full2sparse</a></td></tr>
<tr class="separator:ac2900a35713b5b9b91b22c385ac6151d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ddae37c53575256bf4393c6c2898b09" id="r_a9ddae37c53575256bf4393c6c2898b09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#a9ddae37c53575256bf4393c6c2898b09">blas_nrm2</a> = <a class="el" href="namespacegensim_1_1matutils.html#abe0c34c59d19760696fb541155764405">blas</a>('nrm2', np.array([], dtype=float))</td></tr>
<tr class="separator:a9ddae37c53575256bf4393c6c2898b09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0c2e5e14b4bbc0f3951f3372439e163" id="r_ac0c2e5e14b4bbc0f3951f3372439e163"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegensim_1_1matutils.html#ac0c2e5e14b4bbc0f3951f3372439e163">blas_scal</a> = <a class="el" href="namespacegensim_1_1matutils.html#abe0c34c59d19760696fb541155764405">blas</a>('scal', np.array([], dtype=float))</td></tr>
<tr class="separator:ac0c2e5e14b4bbc0f3951f3372439e163"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Math helper functions.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a6591ac34606e0c0079e292f0e361a51a" name="a6591ac34606e0c0079e292f0e361a51a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6591ac34606e0c0079e292f0e361a51a">&#9670;&#160;</a></span>_convert_vec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils._convert_vec </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_features</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  923</span><span class="keyword">def </span>_convert_vec(vec1, vec2, num_features=None):</div>
<div class="line"><span class="lineno">  924</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec1):</div>
<div class="line"><span class="lineno">  925</span>        vec1 = vec1.toarray()</div>
<div class="line"><span class="lineno">  926</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec2):</div>
<div class="line"><span class="lineno">  927</span>        vec2 = vec2.toarray()  <span class="comment"># converted both the vectors to dense in case they were in sparse matrix</span></div>
<div class="line"><span class="lineno">  928</span>    <span class="keywordflow">if</span> isbow(vec1) <span class="keywordflow">and</span> isbow(vec2):  <span class="comment"># if they are in bag of words format we make it dense</span></div>
<div class="line"><span class="lineno">  929</span>        <span class="keywordflow">if</span> num_features <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:  <span class="comment"># if not None, make as large as the documents drawing from</span></div>
<div class="line"><span class="lineno">  930</span>            dense1 = sparse2full(vec1, num_features)</div>
<div class="line"><span class="lineno">  931</span>            dense2 = sparse2full(vec2, num_features)</div>
<div class="line"><span class="lineno">  932</span>            <span class="keywordflow">return</span> dense1, dense2</div>
<div class="line"><span class="lineno">  933</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  934</span>            max_len = max(len(vec1), len(vec2))</div>
<div class="line"><span class="lineno">  935</span>            dense1 = sparse2full(vec1, max_len)</div>
<div class="line"><span class="lineno">  936</span>            dense2 = sparse2full(vec2, max_len)</div>
<div class="line"><span class="lineno">  937</span>            <span class="keywordflow">return</span> dense1, dense2</div>
<div class="line"><span class="lineno">  938</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  939</span>        <span class="comment"># this conversion is made because if it is not in bow format, it might be a list within a list after conversion</span></div>
<div class="line"><span class="lineno">  940</span>        <span class="comment"># the scipy implementation of Kullback fails in such a case so we pick up only the nested list.</span></div>
<div class="line"><span class="lineno">  941</span>        <span class="keywordflow">if</span> len(vec1) == 1:</div>
<div class="line"><span class="lineno">  942</span>            vec1 = vec1[0]</div>
<div class="line"><span class="lineno">  943</span>        <span class="keywordflow">if</span> len(vec2) == 1:</div>
<div class="line"><span class="lineno">  944</span>            vec2 = vec2[0]</div>
<div class="line"><span class="lineno">  945</span>        <span class="keywordflow">return</span> vec1, vec2</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a223db3e0c1923d447d40ef24ca539918" name="a223db3e0c1923d447d40ef24ca539918"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a223db3e0c1923d447d40ef24ca539918">&#9670;&#160;</a></span>any2sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.any2sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-9</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert a numpy.ndarray or `scipy.sparse` vector into the Gensim bag-of-words format.

Parameters
----------
vec : {`numpy.ndarray`, `scipy.sparse`}
    Input vector
eps : float, optional
    Value used for threshold, all coordinates less than `eps` will not be presented in result.

Returns
-------
list of (int, float)
    Vector in BoW format.</pre> <div class="fragment"><div class="line"><span class="lineno">  245</span><span class="keyword">def </span>any2sparse(vec, eps=1e-9):</div>
<div class="line"><span class="lineno">  246</span>    <span class="stringliteral">&quot;&quot;&quot;Convert a numpy.ndarray or `scipy.sparse` vector into the Gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">    vec : {`numpy.ndarray`, `scipy.sparse`}</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">        Input vector</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    eps : float, optional</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">        Value used for threshold, all coordinates less than `eps` will not be presented in result.</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    list of (int, float)</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">        Vector in BoW format.</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordflow">if</span> isinstance(vec, np.ndarray):</div>
<div class="line"><span class="lineno">  262</span>        <span class="keywordflow">return</span> dense2vec(vec, eps)</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec):</div>
<div class="line"><span class="lineno">  264</span>        <span class="keywordflow">return</span> scipy2sparse(vec, eps)</div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">return</span> [(int(fid), float(fw)) <span class="keywordflow">for</span> fid, fw <span class="keywordflow">in</span> vec <span class="keywordflow">if</span> np.abs(fw) &gt; eps]</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a86f380844deb3038727102ebfe7ec055" name="a86f380844deb3038727102ebfe7ec055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86f380844deb3038727102ebfe7ec055">&#9670;&#160;</a></span>argsort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.argsort </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>topn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reverse</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Efficiently calculate indices of the `topn` smallest elements in array `x`.

Parameters
----------
x : array_like
    Array to get the smallest element indices from.
topn : int, optional
    Number of indices of the smallest (greatest) elements to be returned.
    If not given, indices of all elements will be returned in ascending (descending) order.
reverse : bool, optional
    Return the `topn` greatest elements in descending order,
    instead of smallest elements in ascending order?

Returns
-------
numpy.ndarray
    Array of `topn` indices that sort the array in the requested order.</pre> <div class="fragment"><div class="line"><span class="lineno">   53</span><span class="keyword">def </span>argsort(x, topn=None, reverse=False):</div>
<div class="line"><span class="lineno">   54</span>    <span class="stringliteral">&quot;&quot;&quot;Efficiently calculate indices of the `topn` smallest elements in array `x`.</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    x : array_like</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">        Array to get the smallest element indices from.</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">    topn : int, optional</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">        Number of indices of the smallest (greatest) elements to be returned.</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">        If not given, indices of all elements will be returned in ascending (descending) order.</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    reverse : bool, optional</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">        Return the `topn` greatest elements in descending order,</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        instead of smallest elements in ascending order?</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    numpy.ndarray</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        Array of `topn` indices that sort the array in the requested order.</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   73</span>    x = np.asarray(x)  <span class="comment"># unify code path for when `x` is not a np array (list, tuple...)</span></div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">if</span> topn <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   75</span>        topn = x.size</div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">if</span> topn &lt;= 0:</div>
<div class="line"><span class="lineno">   77</span>        <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">if</span> reverse:</div>
<div class="line"><span class="lineno">   79</span>        x = -x</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">if</span> topn &gt;= x.size <span class="keywordflow">or</span> <span class="keywordflow">not</span> hasattr(np, <span class="stringliteral">&#39;argpartition&#39;</span>):</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">return</span> np.argsort(x)[:topn]</div>
<div class="line"><span class="lineno">   82</span>    <span class="comment"># np &gt;= 1.8 has a fast partial argsort, use that!</span></div>
<div class="line"><span class="lineno">   83</span>    most_extreme = np.argpartition(x, topn)[:topn]</div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">return</span> most_extreme.take(np.argsort(x.take(most_extreme)))  <span class="comment"># resort topn into order</span></div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abe0c34c59d19760696fb541155764405" name="abe0c34c59d19760696fb541155764405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe0c34c59d19760696fb541155764405">&#9670;&#160;</a></span>blas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.blas </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ndarray</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Helper for getting the appropriate BLAS function, using :func:`scipy.linalg.get_blas_funcs`.

Parameters
----------
name : str
    Name(s) of BLAS functions, without the type prefix.
ndarray : numpy.ndarray
    Arrays can be given to determine optimal prefix of BLAS routines.

Returns
-------
object
    BLAS function for the needed operation on the given data type.</pre> <div class="fragment"><div class="line"><span class="lineno">   34</span><span class="keyword">def </span>blas(name, ndarray):</div>
<div class="line"><span class="lineno">   35</span>    <span class="stringliteral">&quot;&quot;&quot;Helper for getting the appropriate BLAS function, using :func:`scipy.linalg.get_blas_funcs`.</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">    name : str</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">        Name(s) of BLAS functions, without the type prefix.</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">    ndarray : numpy.ndarray</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">        Arrays can be given to determine optimal prefix of BLAS routines.</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    object</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">        BLAS function for the needed operation on the given data type.</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">return</span> scipy.linalg.get_blas_funcs((name,), (ndarray,))[0]</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a25eac9310d99ae3dd7e6e2bcdd557672" name="a25eac9310d99ae3dd7e6e2bcdd557672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25eac9310d99ae3dd7e6e2bcdd557672">&#9670;&#160;</a></span>corpus2csc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.corpus2csc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_terms</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em> = <code>np.float64</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_docs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_nnz</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>printprogress</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert a streamed corpus in bag-of-words format into a sparse matrix `scipy.sparse.csc_matrix`,
with documents as columns.

Notes
-----
If the number of terms, documents and non-zero elements is known, you can pass
them here as parameters and a (much) more memory efficient code path will be taken.

Parameters
----------
corpus : iterable of iterable of (int, number)
    Input corpus in BoW format
num_terms : int, optional
    Number of terms in `corpus`. If provided, the `corpus.num_terms` attribute (if any) will be ignored.
dtype : data-type, optional
    Data type of output CSC matrix.
num_docs : int, optional
    Number of documents in `corpus`. If provided, the `corpus.num_docs` attribute (in any) will be ignored.
num_nnz : int, optional
    Number of non-zero elements in `corpus`. If provided, the `corpus.num_nnz` attribute (if any) will be ignored.
printprogress : int, optional
    Log a progress message at INFO level once every `printprogress` documents. 0 to turn off progress logging.

Returns
-------
scipy.sparse.csc_matrix
    `corpus` converted into a sparse CSC matrix.

See Also
--------
:class:`~gensim.matutils.Sparse2Corpus`
    Convert sparse format to Gensim corpus format.</pre> <div class="fragment"><div class="line"><span class="lineno">   87</span><span class="keyword">def </span>corpus2csc(corpus, num_terms=None, dtype=np.float64, num_docs=None, num_nnz=None, printprogress=0):</div>
<div class="line"><span class="lineno">   88</span>    <span class="stringliteral">&quot;&quot;&quot;Convert a streamed corpus in bag-of-words format into a sparse matrix `scipy.sparse.csc_matrix`,</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    with documents as columns.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    If the number of terms, documents and non-zero elements is known, you can pass</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    them here as parameters and a (much) more memory efficient code path will be taken.</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    corpus : iterable of iterable of (int, number)</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">        Input corpus in BoW format</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">    num_terms : int, optional</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">        Number of terms in `corpus`. If provided, the `corpus.num_terms` attribute (if any) will be ignored.</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    dtype : data-type, optional</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">        Data type of output CSC matrix.</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    num_docs : int, optional</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">        Number of documents in `corpus`. If provided, the `corpus.num_docs` attribute (in any) will be ignored.</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    num_nnz : int, optional</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">        Number of non-zero elements in `corpus`. If provided, the `corpus.num_nnz` attribute (if any) will be ignored.</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">    printprogress : int, optional</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">        Log a progress message at INFO level once every `printprogress` documents. 0 to turn off progress logging.</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    scipy.sparse.csc_matrix</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">        `corpus` converted into a sparse CSC matrix.</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">    :class:`~gensim.matutils.Sparse2Corpus`</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">        Convert sparse format to Gensim corpus format.</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  123</span>        <span class="comment"># if the input corpus has the `num_nnz`, `num_docs` and `num_terms` attributes</span></div>
<div class="line"><span class="lineno">  124</span>        <span class="comment"># (as is the case with MmCorpus for example), we can use a more efficient code path</span></div>
<div class="line"><span class="lineno">  125</span>        <span class="keywordflow">if</span> num_terms <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  126</span>            num_terms = corpus.num_terms</div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">if</span> num_docs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  128</span>            num_docs = corpus.num_docs</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">if</span> num_nnz <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  130</span>            num_nnz = corpus.num_nnz</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">except</span> AttributeError:</div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordflow">pass</span>  <span class="comment"># not a MmCorpus...</span></div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">if</span> printprogress:</div>
<div class="line"><span class="lineno">  134</span>        logger.info(<span class="stringliteral">&quot;creating sparse matrix from corpus&quot;</span>)</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">if</span> num_terms <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> num_docs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> num_nnz <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  136</span>        <span class="comment"># faster and much more memory-friendly version of creating the sparse csc</span></div>
<div class="line"><span class="lineno">  137</span>        posnow, indptr = 0, [0]</div>
<div class="line"><span class="lineno">  138</span>        indices = np.empty((num_nnz,), dtype=np.int32)  <span class="comment"># HACK assume feature ids fit in 32bit integer</span></div>
<div class="line"><span class="lineno">  139</span>        data = np.empty((num_nnz,), dtype=dtype)</div>
<div class="line"><span class="lineno">  140</span>        <span class="keywordflow">for</span> docno, doc <span class="keywordflow">in</span> enumerate(corpus):</div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">if</span> printprogress <span class="keywordflow">and</span> docno % printprogress == 0:</div>
<div class="line"><span class="lineno">  142</span>                logger.info(<span class="stringliteral">&quot;PROGRESS: at document #%i/%i&quot;</span>, docno, num_docs)</div>
<div class="line"><span class="lineno">  143</span>            posnext = posnow + len(doc)</div>
<div class="line"><span class="lineno">  144</span>            <span class="comment"># zip(*doc) transforms doc to (token_indices, token_counts]</span></div>
<div class="line"><span class="lineno">  145</span>            indices[posnow: posnext], data[posnow: posnext] = zip(*doc) <span class="keywordflow">if</span> doc <span class="keywordflow">else</span> ([], [])</div>
<div class="line"><span class="lineno">  146</span>            indptr.append(posnext)</div>
<div class="line"><span class="lineno">  147</span>            posnow = posnext</div>
<div class="line"><span class="lineno">  148</span>        <span class="keyword">assert</span> posnow == num_nnz, <span class="stringliteral">&quot;mismatch between supplied and computed number of non-zeros&quot;</span></div>
<div class="line"><span class="lineno">  149</span>        result = <a class="code hl_class" href="classscipy_1_1sparse_1_1__csc_1_1csc__matrix.html">scipy.sparse.csc_matrix</a>((data, indices, indptr), shape=(num_terms, num_docs), dtype=dtype)</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  151</span>        <span class="comment"># slower version; determine the sparse matrix parameters during iteration</span></div>
<div class="line"><span class="lineno">  152</span>        num_nnz, data, indices, indptr = 0, [], [], [0]</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">for</span> docno, doc <span class="keywordflow">in</span> enumerate(corpus):</div>
<div class="line"><span class="lineno">  154</span>            <span class="keywordflow">if</span> printprogress <span class="keywordflow">and</span> docno % printprogress == 0:</div>
<div class="line"><span class="lineno">  155</span>                logger.info(<span class="stringliteral">&quot;PROGRESS: at document #%i&quot;</span>, docno)</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>            <span class="comment"># zip(*doc) transforms doc to (token_indices, token_counts]</span></div>
<div class="line"><span class="lineno">  158</span>            doc_indices, doc_data = zip(*doc) <span class="keywordflow">if</span> doc <span class="keywordflow">else</span> ([], [])</div>
<div class="line"><span class="lineno">  159</span>            indices.extend(doc_indices)</div>
<div class="line"><span class="lineno">  160</span>            data.extend(doc_data)</div>
<div class="line"><span class="lineno">  161</span>            num_nnz += len(doc)</div>
<div class="line"><span class="lineno">  162</span>            indptr.append(num_nnz)</div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">if</span> num_terms <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  164</span>            num_terms = max(indices) + 1 <span class="keywordflow">if</span> indices <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  165</span>        num_docs = len(indptr) - 1</div>
<div class="line"><span class="lineno">  166</span>        <span class="comment"># now num_docs, num_terms and num_nnz contain the correct values</span></div>
<div class="line"><span class="lineno">  167</span>        data = np.asarray(data, dtype=dtype)</div>
<div class="line"><span class="lineno">  168</span>        indices = np.asarray(indices)</div>
<div class="line"><span class="lineno">  169</span>        result = <a class="code hl_class" href="classscipy_1_1sparse_1_1__csc_1_1csc__matrix.html">scipy.sparse.csc_matrix</a>((data, indices, indptr), shape=(num_terms, num_docs), dtype=dtype)</div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="ttc" id="aclassscipy_1_1sparse_1_1__csc_1_1csc__matrix_html"><div class="ttname"><a href="classscipy_1_1sparse_1_1__csc_1_1csc__matrix.html">scipy.sparse._csc.csc_matrix</a></div><div class="ttdef"><b>Definition</b> _csc.py:16</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7399d7c850ca5ab689ac94329867705" name="ad7399d7c850ca5ab689ac94329867705"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7399d7c850ca5ab689ac94329867705">&#9670;&#160;</a></span>corpus2dense()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.corpus2dense </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_terms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_docs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em> = <code>np.float32</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert corpus into a dense numpy 2D array, with documents as columns.

Parameters
----------
corpus : iterable of iterable of (int, number)
    Input corpus in the Gensim bag-of-words format.
num_terms : int
    Number of terms in the dictionary. X-axis of the resulting matrix.
num_docs : int, optional
    Number of documents in the corpus. If provided, a slightly more memory-efficient code path is taken.
    Y-axis of the resulting matrix.
dtype : data-type, optional
    Data type of the output matrix.

Returns
-------
numpy.ndarray
    Dense 2D array that presents `corpus`.

See Also
--------
:class:`~gensim.matutils.Dense2Corpus`
    Convert dense matrix to Gensim corpus format.</pre> <div class="fragment"><div class="line"><span class="lineno">  473</span><span class="keyword">def </span>corpus2dense(corpus, num_terms, num_docs=None, dtype=np.float32):</div>
<div class="line"><span class="lineno">  474</span>    <span class="stringliteral">&quot;&quot;&quot;Convert corpus into a dense numpy 2D array, with documents as columns.</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    corpus : iterable of iterable of (int, number)</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">        Input corpus in the Gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">    num_terms : int</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">        Number of terms in the dictionary. X-axis of the resulting matrix.</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">    num_docs : int, optional</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">        Number of documents in the corpus. If provided, a slightly more memory-efficient code path is taken.</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">        Y-axis of the resulting matrix.</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">    dtype : data-type, optional</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">        Data type of the output matrix.</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">    numpy.ndarray</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">        Dense 2D array that presents `corpus`.</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">    :class:`~gensim.matutils.Dense2Corpus`</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">        Convert dense matrix to Gensim corpus format.</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  499</span>    <span class="keywordflow">if</span> num_docs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  500</span>        <span class="comment"># we know the number of documents =&gt; don&#39;t bother column_stacking</span></div>
<div class="line"><span class="lineno">  501</span>        docno, result = -1, np.empty((num_terms, num_docs), dtype=dtype)</div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">for</span> docno, doc <span class="keywordflow">in</span> enumerate(corpus):</div>
<div class="line"><span class="lineno">  503</span>            result[:, docno] = sparse2full(doc, num_terms)</div>
<div class="line"><span class="lineno">  504</span>        <span class="keyword">assert</span> docno + 1 == num_docs</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  506</span>        <span class="comment"># The below used to be a generator, but NumPy deprecated generator as of 1.16 with:</span></div>
<div class="line"><span class="lineno">  507</span>        <span class="comment"># &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  508</span>        <span class="comment"># FutureWarning: arrays to stack must be passed as a &quot;sequence&quot; type such as list or tuple.</span></div>
<div class="line"><span class="lineno">  509</span>        <span class="comment"># Support for non-sequence iterables such as generators is deprecated as of NumPy 1.16 and will raise an error</span></div>
<div class="line"><span class="lineno">  510</span>        <span class="comment"># in the future.</span></div>
<div class="line"><span class="lineno">  511</span>        <span class="comment"># &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  512</span>        result = np.column_stack([sparse2full(doc, num_terms) <span class="keywordflow">for</span> doc <span class="keywordflow">in</span> corpus])</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">return</span> result.astype(dtype)</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a12beb90533660b111f13516eb88b8fa5" name="a12beb90533660b111f13516eb88b8fa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12beb90533660b111f13516eb88b8fa5">&#9670;&#160;</a></span>cossim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.cossim </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get cosine similarity between two sparse vectors.

Cosine similarity is a number between `&lt;-1.0, 1.0&gt;`, higher means more similar.

Parameters
----------
vec1 : list of (int, float)
    Vector in BoW format.
vec2 : list of (int, float)
    Vector in BoW format.

Returns
-------
float
    Cosine similarity between `vec1` and `vec2`.</pre> <div class="fragment"><div class="line"><span class="lineno">  791</span><span class="keyword">def </span>cossim(vec1, vec2):</div>
<div class="line"><span class="lineno">  792</span>    <span class="stringliteral">&quot;&quot;&quot;Get cosine similarity between two sparse vectors.</span></div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral">    Cosine similarity is a number between `&lt;-1.0, 1.0&gt;`, higher means more similar.</span></div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral">    vec1 : list of (int, float)</span></div>
<div class="line"><span class="lineno">  799</span><span class="stringliteral">        Vector in BoW format.</span></div>
<div class="line"><span class="lineno">  800</span><span class="stringliteral">    vec2 : list of (int, float)</span></div>
<div class="line"><span class="lineno">  801</span><span class="stringliteral">        Vector in BoW format.</span></div>
<div class="line"><span class="lineno">  802</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  803</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  804</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  805</span><span class="stringliteral">    float</span></div>
<div class="line"><span class="lineno">  806</span><span class="stringliteral">        Cosine similarity between `vec1` and `vec2`.</span></div>
<div class="line"><span class="lineno">  807</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  808</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  809</span>    vec1, vec2 = dict(vec1), dict(vec2)</div>
<div class="line"><span class="lineno">  810</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> vec1 <span class="keywordflow">or</span> <span class="keywordflow">not</span> vec2:</div>
<div class="line"><span class="lineno">  811</span>        <span class="keywordflow">return</span> 0.0</div>
<div class="line"><span class="lineno">  812</span>    vec1len = 1.0 * math.sqrt(sum(val * val <span class="keywordflow">for</span> val <span class="keywordflow">in</span> itervalues(vec1)))</div>
<div class="line"><span class="lineno">  813</span>    vec2len = 1.0 * math.sqrt(sum(val * val <span class="keywordflow">for</span> val <span class="keywordflow">in</span> itervalues(vec2)))</div>
<div class="line"><span class="lineno">  814</span>    <span class="keyword">assert</span> vec1len &gt; 0.0 <span class="keywordflow">and</span> vec2len &gt; 0.0, <span class="stringliteral">&quot;sparse documents must not contain any explicit zero entries&quot;</span></div>
<div class="line"><span class="lineno">  815</span>    <span class="keywordflow">if</span> len(vec2) &lt; len(vec1):</div>
<div class="line"><span class="lineno">  816</span>        vec1, vec2 = vec2, vec1  <span class="comment"># swap references so that we iterate over the shorter vector</span></div>
<div class="line"><span class="lineno">  817</span>    result = sum(value * vec2.get(index, 0.0) <span class="keywordflow">for</span> index, value <span class="keywordflow">in</span> iteritems(vec1))</div>
<div class="line"><span class="lineno">  818</span>    result /= vec1len * vec2len  <span class="comment"># rescale by vector lengths</span></div>
<div class="line"><span class="lineno">  819</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span><span class="preprocessor">@deprecated</span>(</div>
<div class="line"><span class="lineno">  823</span>    <span class="stringliteral">&quot;Function will be removed in 4.0.0, use &quot;</span></div>
<div class="line"><span class="lineno">  824</span>    <span class="stringliteral">&quot;gensim.similarities.termsim.SparseTermSimilarityMatrix.inner_product instead&quot;</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a382e6a53cefcaadad1b0c51718670204" name="a382e6a53cefcaadad1b0c51718670204"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a382e6a53cefcaadad1b0c51718670204">&#9670;&#160;</a></span>dirichlet_expectation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.dirichlet_expectation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Expected value of log(theta) where theta is drawn from a Dirichlet distribution.

Parameters
----------
alpha : numpy.ndarray
    Dirichlet parameter 2d matrix or 1d vector, if 2d - each row is treated as a separate parameter vector.

Returns
-------
numpy.ndarray
    Log of expected values, dimension same as `alpha.ndim`.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1149</span>    <span class="keyword">def </span>dirichlet_expectation(alpha):</div>
<div class="line"><span class="lineno"> 1150</span>        <span class="stringliteral">&quot;&quot;&quot;Expected value of log(theta) where theta is drawn from a Dirichlet distribution.</span></div>
<div class="line"><span class="lineno"> 1151</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1152</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno"> 1153</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno"> 1154</span><span class="stringliteral">        alpha : numpy.ndarray</span></div>
<div class="line"><span class="lineno"> 1155</span><span class="stringliteral">            Dirichlet parameter 2d matrix or 1d vector, if 2d - each row is treated as a separate parameter vector.</span></div>
<div class="line"><span class="lineno"> 1156</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1157</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno"> 1158</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno"> 1159</span><span class="stringliteral">        numpy.ndarray</span></div>
<div class="line"><span class="lineno"> 1160</span><span class="stringliteral">            Log of expected values, dimension same as `alpha.ndim`.</span></div>
<div class="line"><span class="lineno"> 1161</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1162</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1163</span>        <span class="keywordflow">if</span> len(alpha.shape) == 1:</div>
<div class="line"><span class="lineno"> 1164</span>            result = psi(alpha) - psi(np.sum(alpha))</div>
<div class="line"><span class="lineno"> 1165</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1166</span>            result = psi(alpha) - psi(np.sum(alpha, 1))[:, np.newaxis]</div>
<div class="line"><span class="lineno"> 1167</span>        <span class="keywordflow">return</span> result.astype(alpha.dtype, copy=<span class="keyword">False</span>)  <span class="comment"># keep the same precision as input</span></div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8972e8b9ba0f7f794b7c947bc49077d4" name="a8972e8b9ba0f7f794b7c947bc49077d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8972e8b9ba0f7f794b7c947bc49077d4">&#9670;&#160;</a></span>full2sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.full2sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-9</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert a dense numpy array into the Gensim bag-of-words format.

Parameters
----------
vec : numpy.ndarray
    Dense input vector.
eps : float
    Feature weight threshold value. Features with `abs(weight) &lt; eps` are considered sparse and
    won't be included in the BOW result.

Returns
-------
list of (int, float)
    BoW format of `vec`, with near-zero values omitted (sparse vector).

See Also
--------
:func:`~gensim.matutils.sparse2full`
    Convert a document in Gensim bag-of-words format into a dense numpy array.</pre> <div class="fragment"><div class="line"><span class="lineno">  407</span><span class="keyword">def </span>full2sparse(vec, eps=1e-9):</div>
<div class="line"><span class="lineno">  408</span>    <span class="stringliteral">&quot;&quot;&quot;Convert a dense numpy array into the Gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral">    vec : numpy.ndarray</span></div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral">        Dense input vector.</span></div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral">    eps : float</span></div>
<div class="line"><span class="lineno">  415</span><span class="stringliteral">        Feature weight threshold value. Features with `abs(weight) &lt; eps` are considered sparse and</span></div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral">        won&#39;t be included in the BOW result.</span></div>
<div class="line"><span class="lineno">  417</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">    list of (int, float)</span></div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">        BoW format of `vec`, with near-zero values omitted (sparse vector).</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">    :func:`~gensim.matutils.sparse2full`</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">        Convert a document in Gensim bag-of-words format into a dense numpy array.</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  429</span>    vec = np.asarray(vec, dtype=float)</div>
<div class="line"><span class="lineno">  430</span>    nnz = np.nonzero(abs(vec) &gt; eps)[0]</div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">return</span> list(zip(nnz, vec.take(nnz)))</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9031e2faaabb920c0dbbaefa703f692b" name="a9031e2faaabb920c0dbbaefa703f692b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9031e2faaabb920c0dbbaefa703f692b">&#9670;&#160;</a></span>full2sparse_clipped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.full2sparse_clipped </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>topn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-9</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Like :func:`~gensim.matutils.full2sparse`, but only return the `topn` elements of the greatest magnitude (abs).

This is more efficient that sorting a vector and then taking the greatest values, especially
where `len(vec) &gt;&gt; topn`.

Parameters
----------
vec : numpy.ndarray
    Input dense vector
topn : int
    Number of greatest (abs) elements that will be presented in result.
eps : float
    Threshold value, if coordinate in `vec` &lt; eps, this will not be presented in result.

Returns
-------
list of (int, float)
    Clipped vector in BoW format.

See Also
--------
:func:`~gensim.matutils.full2sparse`
    Convert dense array to gensim bag-of-words format.</pre> <div class="fragment"><div class="line"><span class="lineno">  437</span><span class="keyword">def </span>full2sparse_clipped(vec, topn, eps=1e-9):</div>
<div class="line"><span class="lineno">  438</span>    <span class="stringliteral">&quot;&quot;&quot;Like :func:`~gensim.matutils.full2sparse`, but only return the `topn` elements of the greatest magnitude (abs).</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">    This is more efficient that sorting a vector and then taking the greatest values, especially</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">    where `len(vec) &gt;&gt; topn`.</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">    vec : numpy.ndarray</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral">        Input dense vector</span></div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">    topn : int</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral">        Number of greatest (abs) elements that will be presented in result.</span></div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral">    eps : float</span></div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">        Threshold value, if coordinate in `vec` &lt; eps, this will not be presented in result.</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral">    list of (int, float)</span></div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">        Clipped vector in BoW format.</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  458</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral">    :func:`~gensim.matutils.full2sparse`</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">        Convert dense array to gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  463</span>    <span class="comment"># use np.argpartition/argsort and only form tuples that are actually returned.</span></div>
<div class="line"><span class="lineno">  464</span>    <span class="comment"># this is about 40x faster than explicitly forming all 2-tuples to run sort() or heapq.nlargest() on.</span></div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">if</span> topn &lt;= 0:</div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordflow">return</span> []</div>
<div class="line"><span class="lineno">  467</span>    vec = np.asarray(vec, dtype=float)</div>
<div class="line"><span class="lineno">  468</span>    nnz = np.nonzero(abs(vec) &gt; eps)[0]</div>
<div class="line"><span class="lineno">  469</span>    biggest = nnz.take(argsort(abs(vec).take(nnz), topn, reverse=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">  470</span>    <span class="keywordflow">return</span> list(zip(biggest, vec.take(biggest)))</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af44d50fc227389ca61d7d1e0eaeadc2d" name="af44d50fc227389ca61d7d1e0eaeadc2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af44d50fc227389ca61d7d1e0eaeadc2d">&#9670;&#160;</a></span>hellinger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.hellinger </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate Hellinger distance between two probability distributions.

Parameters
----------
vec1 : {scipy.sparse, numpy.ndarray, list of (int, float)}
    Distribution vector.
vec2 : {scipy.sparse, numpy.ndarray, list of (int, float)}
    Distribution vector.

Returns
-------
float
    Hellinger distance between `vec1` and `vec2`.
    Value in range `[0, 1]`, where 0 is min distance (max similarity) and 1 is max distance (min similarity).</pre> <div class="fragment"><div class="line"><span class="lineno">  998</span><span class="keyword">def </span>hellinger(vec1, vec2):</div>
<div class="line"><span class="lineno">  999</span>    <span class="stringliteral">&quot;&quot;&quot;Calculate Hellinger distance between two probability distributions.</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1001</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1002</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1003</span><span class="stringliteral">    vec1 : {scipy.sparse, numpy.ndarray, list of (int, float)}</span></div>
<div class="line"><span class="lineno"> 1004</span><span class="stringliteral">        Distribution vector.</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="stringliteral">    vec2 : {scipy.sparse, numpy.ndarray, list of (int, float)}</span></div>
<div class="line"><span class="lineno"> 1006</span><span class="stringliteral">        Distribution vector.</span></div>
<div class="line"><span class="lineno"> 1007</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1008</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1009</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1010</span><span class="stringliteral">    float</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral">        Hellinger distance between `vec1` and `vec2`.</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral">        Value in range `[0, 1]`, where 0 is min distance (max similarity) and 1 is max distance (min similarity).</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec1):</div>
<div class="line"><span class="lineno"> 1016</span>        vec1 = vec1.toarray()</div>
<div class="line"><span class="lineno"> 1017</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec2):</div>
<div class="line"><span class="lineno"> 1018</span>        vec2 = vec2.toarray()</div>
<div class="line"><span class="lineno"> 1019</span>    <span class="keywordflow">if</span> isbow(vec1) <span class="keywordflow">and</span> isbow(vec2):</div>
<div class="line"><span class="lineno"> 1020</span>        <span class="comment"># if it is a BoW format, instead of converting to dense we use dictionaries to calculate appropriate distance</span></div>
<div class="line"><span class="lineno"> 1021</span>        vec1, vec2 = dict(vec1), dict(vec2)</div>
<div class="line"><span class="lineno"> 1022</span>        indices = set(list(vec1.keys()) + list(vec2.keys()))</div>
<div class="line"><span class="lineno"> 1023</span>        sim = np.sqrt(</div>
<div class="line"><span class="lineno"> 1024</span>            0.5 * sum((np.sqrt(vec1.get(index, 0.0)) - np.sqrt(vec2.get(index, 0.0)))**2 <span class="keywordflow">for</span> index <span class="keywordflow">in</span> indices)</div>
<div class="line"><span class="lineno"> 1025</span>        )</div>
<div class="line"><span class="lineno"> 1026</span>        <span class="keywordflow">return</span> sim</div>
<div class="line"><span class="lineno"> 1027</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1028</span>        sim = np.sqrt(0.5 * ((np.sqrt(vec1) - np.sqrt(vec2))**2).sum())</div>
<div class="line"><span class="lineno"> 1029</span>        <span class="keywordflow">return</span> sim</div>
<div class="line"><span class="lineno"> 1030</span> </div>
<div class="line"><span class="lineno"> 1031</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa725a5c2b70f0a9fa85c1e65a07e23ca" name="aa725a5c2b70f0a9fa85c1e65a07e23ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa725a5c2b70f0a9fa85c1e65a07e23ca">&#9670;&#160;</a></span>isbow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.isbow </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Checks if a vector is in the sparse Gensim bag-of-words format.

Parameters
----------
vec : object
    Object to check.

Returns
-------
bool
    Is `vec` in BoW format.</pre> <div class="fragment"><div class="line"><span class="lineno">  897</span><span class="keyword">def </span>isbow(vec):</div>
<div class="line"><span class="lineno">  898</span>    <span class="stringliteral">&quot;&quot;&quot;Checks if a vector is in the sparse Gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">    vec : object</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral">        Object to check.</span></div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">    bool</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">        Is `vec` in BoW format.</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  911</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec):</div>
<div class="line"><span class="lineno">  912</span>        vec = vec.todense().tolist()</div>
<div class="line"><span class="lineno">  913</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  914</span>        id_, val_ = vec[0]  <span class="comment"># checking first value to see if it is in bag of words format by unpacking</span></div>
<div class="line"><span class="lineno">  915</span>        int(id_), float(val_)</div>
<div class="line"><span class="lineno">  916</span>    <span class="keywordflow">except</span> IndexError:</div>
<div class="line"><span class="lineno">  917</span>        <span class="keywordflow">return</span> <span class="keyword">True</span>  <span class="comment"># this is to handle the empty input case</span></div>
<div class="line"><span class="lineno">  918</span>    <span class="keywordflow">except</span> (ValueError, TypeError):</div>
<div class="line"><span class="lineno">  919</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  920</span>    <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4580d676c48a2532b4926892e368860e" name="a4580d676c48a2532b4926892e368860e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4580d676c48a2532b4926892e368860e">&#9670;&#160;</a></span>ismatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.ismatrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check whether `m` is a 2D `numpy.ndarray` or `scipy.sparse` matrix.

Parameters
----------
m : object
    Object to check.

Returns
-------
bool
    Is `m` a 2D `numpy.ndarray` or `scipy.sparse` matrix.</pre> <div class="fragment"><div class="line"><span class="lineno">  228</span><span class="keyword">def </span>ismatrix(m):</div>
<div class="line"><span class="lineno">  229</span>    <span class="stringliteral">&quot;&quot;&quot;Check whether `m` is a 2D `numpy.ndarray` or `scipy.sparse` matrix.</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    m : object</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">        Object to check.</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">    bool</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">        Is `m` a 2D `numpy.ndarray` or `scipy.sparse` matrix.</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">return</span> isinstance(m, np.ndarray) <span class="keywordflow">and</span> m.ndim == 2 <span class="keywordflow">or</span> scipy.sparse.issparse(m)</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afbe02ad4e6f3d8fbdb006a7663095500" name="afbe02ad4e6f3d8fbdb006a7663095500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbe02ad4e6f3d8fbdb006a7663095500">&#9670;&#160;</a></span>jaccard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.jaccard </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate Jaccard distance between two vectors.

Parameters
----------
vec1 : {scipy.sparse, numpy.ndarray, list of (int, float)}
    Distribution vector.
vec2 : {scipy.sparse, numpy.ndarray, list of (int, float)}
    Distribution vector.

Returns
-------
float
    Jaccard distance between `vec1` and `vec2`.
    Value in range `[0, 1]`, where 0 is min distance (max similarity) and 1 is max distance (min similarity).</pre> <div class="fragment"><div class="line"><span class="lineno"> 1032</span><span class="keyword">def </span>jaccard(vec1, vec2):</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="stringliteral">&quot;&quot;&quot;Calculate Jaccard distance between two vectors.</span></div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral">    vec1 : {scipy.sparse, numpy.ndarray, list of (int, float)}</span></div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">        Distribution vector.</span></div>
<div class="line"><span class="lineno"> 1039</span><span class="stringliteral">    vec2 : {scipy.sparse, numpy.ndarray, list of (int, float)}</span></div>
<div class="line"><span class="lineno"> 1040</span><span class="stringliteral">        Distribution vector.</span></div>
<div class="line"><span class="lineno"> 1041</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1042</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1043</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1044</span><span class="stringliteral">    float</span></div>
<div class="line"><span class="lineno"> 1045</span><span class="stringliteral">        Jaccard distance between `vec1` and `vec2`.</span></div>
<div class="line"><span class="lineno"> 1046</span><span class="stringliteral">        Value in range `[0, 1]`, where 0 is min distance (max similarity) and 1 is max distance (min similarity).</span></div>
<div class="line"><span class="lineno"> 1047</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1048</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>    <span class="comment"># converting from sparse for easier manipulation</span></div>
<div class="line"><span class="lineno"> 1051</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec1):</div>
<div class="line"><span class="lineno"> 1052</span>        vec1 = vec1.toarray()</div>
<div class="line"><span class="lineno"> 1053</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec2):</div>
<div class="line"><span class="lineno"> 1054</span>        vec2 = vec2.toarray()</div>
<div class="line"><span class="lineno"> 1055</span>    <span class="keywordflow">if</span> isbow(vec1) <span class="keywordflow">and</span> isbow(vec2):</div>
<div class="line"><span class="lineno"> 1056</span>        <span class="comment"># if it&#39;s in bow format, we use the following definitions:</span></div>
<div class="line"><span class="lineno"> 1057</span>        <span class="comment"># union = sum of the &#39;weights&#39; of both the bags</span></div>
<div class="line"><span class="lineno"> 1058</span>        <span class="comment"># intersection = lowest weight for a particular id; basically the number of common words or items</span></div>
<div class="line"><span class="lineno"> 1059</span>        union = sum(weight <span class="keywordflow">for</span> id_, weight <span class="keywordflow">in</span> vec1) + sum(weight <span class="keywordflow">for</span> id_, weight <span class="keywordflow">in</span> vec2)</div>
<div class="line"><span class="lineno"> 1060</span>        vec1, vec2 = dict(vec1), dict(vec2)</div>
<div class="line"><span class="lineno"> 1061</span>        intersection = 0.0</div>
<div class="line"><span class="lineno"> 1062</span>        <span class="keywordflow">for</span> feature_id, feature_weight <span class="keywordflow">in</span> iteritems(vec1):</div>
<div class="line"><span class="lineno"> 1063</span>            intersection += min(feature_weight, vec2.get(feature_id, 0.0))</div>
<div class="line"><span class="lineno"> 1064</span>        <span class="keywordflow">return</span> 1 - float(intersection) / float(union)</div>
<div class="line"><span class="lineno"> 1065</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1066</span>        <span class="comment"># if it isn&#39;t in bag of words format, we can use sets to calculate intersection and union</span></div>
<div class="line"><span class="lineno"> 1067</span>        <span class="keywordflow">if</span> isinstance(vec1, np.ndarray):</div>
<div class="line"><span class="lineno"> 1068</span>            vec1 = vec1.tolist()</div>
<div class="line"><span class="lineno"> 1069</span>        <span class="keywordflow">if</span> isinstance(vec2, np.ndarray):</div>
<div class="line"><span class="lineno"> 1070</span>            vec2 = vec2.tolist()</div>
<div class="line"><span class="lineno"> 1071</span>        vec1 = set(vec1)</div>
<div class="line"><span class="lineno"> 1072</span>        vec2 = set(vec2)</div>
<div class="line"><span class="lineno"> 1073</span>        intersection = vec1 &amp; vec2</div>
<div class="line"><span class="lineno"> 1074</span>        union = vec1 | vec2</div>
<div class="line"><span class="lineno"> 1075</span>        <span class="keywordflow">return</span> 1 - float(len(intersection)) / float(len(union))</div>
<div class="line"><span class="lineno"> 1076</span> </div>
<div class="line"><span class="lineno"> 1077</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a23645563bfd40342cfb0b1683ec37b" name="a8a23645563bfd40342cfb0b1683ec37b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a23645563bfd40342cfb0b1683ec37b">&#9670;&#160;</a></span>jaccard_distance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.jaccard_distance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>set1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>set2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate Jaccard distance between two sets.

Parameters
----------
set1 : set
    Input set.
set2 : set
    Input set.

Returns
-------
float
    Jaccard distance between `set1` and `set2`.
    Value in range `[0, 1]`, where 0 is min distance (max similarity) and 1 is max distance (min similarity).
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1078</span><span class="keyword">def </span>jaccard_distance(set1, set2):</div>
<div class="line"><span class="lineno"> 1079</span>    <span class="stringliteral">&quot;&quot;&quot;Calculate Jaccard distance between two sets.</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral">    set1 : set</span></div>
<div class="line"><span class="lineno"> 1084</span><span class="stringliteral">        Input set.</span></div>
<div class="line"><span class="lineno"> 1085</span><span class="stringliteral">    set2 : set</span></div>
<div class="line"><span class="lineno"> 1086</span><span class="stringliteral">        Input set.</span></div>
<div class="line"><span class="lineno"> 1087</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1088</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1089</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1090</span><span class="stringliteral">    float</span></div>
<div class="line"><span class="lineno"> 1091</span><span class="stringliteral">        Jaccard distance between `set1` and `set2`.</span></div>
<div class="line"><span class="lineno"> 1092</span><span class="stringliteral">        Value in range `[0, 1]`, where 0 is min distance (max similarity) and 1 is max distance (min similarity).</span></div>
<div class="line"><span class="lineno"> 1093</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1094</span> </div>
<div class="line"><span class="lineno"> 1095</span>    union_cardinality = len(set1 | set2)</div>
<div class="line"><span class="lineno"> 1096</span>    <span class="keywordflow">if</span> union_cardinality == 0:  <span class="comment"># Both sets are empty</span></div>
<div class="line"><span class="lineno"> 1097</span>        <span class="keywordflow">return</span> 1.</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>    <span class="keywordflow">return</span> 1. - float(len(set1 &amp; set2)) / float(union_cardinality)</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af58e282400356078829b9472b76e74bb" name="af58e282400356078829b9472b76e74bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af58e282400356078829b9472b76e74bb">&#9670;&#160;</a></span>jensen_shannon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.jensen_shannon </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_features</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate Jensen-Shannon distance between two probability distributions using `scipy.stats.entropy`.

Parameters
----------
vec1 : {scipy.sparse, numpy.ndarray, list of (int, float)}
    Distribution vector.
vec2 : {scipy.sparse, numpy.ndarray, list of (int, float)}
    Distribution vector.
num_features : int, optional
    Number of features in the vectors.

Returns
-------
float
    Jensen-Shannon distance between `vec1` and `vec2`.

Notes
-----
This is a symmetric and finite "version" of :func:`gensim.matutils.kullback_leibler`.</pre> <div class="fragment"><div class="line"><span class="lineno">  971</span><span class="keyword">def </span>jensen_shannon(vec1, vec2, num_features=None):</div>
<div class="line"><span class="lineno">  972</span>    <span class="stringliteral">&quot;&quot;&quot;Calculate Jensen-Shannon distance between two probability distributions using `scipy.stats.entropy`.</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">    vec1 : {scipy.sparse, numpy.ndarray, list of (int, float)}</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">        Distribution vector.</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">    vec2 : {scipy.sparse, numpy.ndarray, list of (int, float)}</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">        Distribution vector.</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">    num_features : int, optional</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">        Number of features in the vectors.</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">    float</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral">        Jensen-Shannon distance between `vec1` and `vec2`.</span></div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">    This is a symmetric and finite &quot;version&quot; of :func:`gensim.matutils.kullback_leibler`.</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  993</span>    vec1, vec2 = _convert_vec(vec1, vec2, num_features=num_features)</div>
<div class="line"><span class="lineno">  994</span>    avg_vec = 0.5 * (vec1 + vec2)</div>
<div class="line"><span class="lineno">  995</span>    <span class="keywordflow">return</span> 0.5 * (entropy(vec1, avg_vec) + entropy(vec2, avg_vec))</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3a2666ecd1109ff5214af4cea6405ec" name="ad3a2666ecd1109ff5214af4cea6405ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3a2666ecd1109ff5214af4cea6405ec">&#9670;&#160;</a></span>kullback_leibler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.kullback_leibler </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_features</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate Kullback-Leibler distance between two probability distributions using `scipy.stats.entropy`.

Parameters
----------
vec1 : {scipy.sparse, numpy.ndarray, list of (int, float)}
    Distribution vector.
vec2 : {scipy.sparse, numpy.ndarray, list of (int, float)}
    Distribution vector.
num_features : int, optional
    Number of features in the vectors.

Returns
-------
float
    Kullback-Leibler distance between `vec1` and `vec2`.
    Value in range [0, +∞) where values closer to 0 mean less distance (higher similarity).</pre> <div class="fragment"><div class="line"><span class="lineno">  948</span><span class="keyword">def </span>kullback_leibler(vec1, vec2, num_features=None):</div>
<div class="line"><span class="lineno">  949</span>    <span class="stringliteral">&quot;&quot;&quot;Calculate Kullback-Leibler distance between two probability distributions using `scipy.stats.entropy`.</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral">    vec1 : {scipy.sparse, numpy.ndarray, list of (int, float)}</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">        Distribution vector.</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">    vec2 : {scipy.sparse, numpy.ndarray, list of (int, float)}</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">        Distribution vector.</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">    num_features : int, optional</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">        Number of features in the vectors.</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">    float</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">        Kullback-Leibler distance between `vec1` and `vec2`.</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral">        Value in range [0, +∞) where values closer to 0 mean less distance (higher similarity).</span></div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  967</span>    vec1, vec2 = _convert_vec(vec1, vec2, num_features=num_features)</div>
<div class="line"><span class="lineno">  968</span>    <span class="keywordflow">return</span> entropy(vec1, vec2)</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a98755356babde3f881125b3c68b916b2" name="a98755356babde3f881125b3c68b916b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98755356babde3f881125b3c68b916b2">&#9670;&#160;</a></span>logsumexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.logsumexp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Log of sum of exponentials.

Parameters
----------
x : numpy.ndarray
    Input 2d matrix.

Returns
-------
float
    log of sum of exponentials of elements in `x`.

Warnings
--------
For performance reasons, doesn't support NaNs or 1d, 3d, etc arrays like :func:`scipy.special.logsumexp`.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1107</span>    <span class="keyword">def </span>logsumexp(x):</div>
<div class="line"><span class="lineno"> 1108</span>        <span class="stringliteral">&quot;&quot;&quot;Log of sum of exponentials.</span></div>
<div class="line"><span class="lineno"> 1109</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1110</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno"> 1111</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno"> 1112</span><span class="stringliteral">        x : numpy.ndarray</span></div>
<div class="line"><span class="lineno"> 1113</span><span class="stringliteral">            Input 2d matrix.</span></div>
<div class="line"><span class="lineno"> 1114</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1115</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno"> 1116</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno"> 1117</span><span class="stringliteral">        float</span></div>
<div class="line"><span class="lineno"> 1118</span><span class="stringliteral">            log of sum of exponentials of elements in `x`.</span></div>
<div class="line"><span class="lineno"> 1119</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1120</span><span class="stringliteral">        Warnings</span></div>
<div class="line"><span class="lineno"> 1121</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno"> 1122</span><span class="stringliteral">        For performance reasons, doesn&#39;t support NaNs or 1d, 3d, etc arrays like :func:`scipy.special.logsumexp`.</span></div>
<div class="line"><span class="lineno"> 1123</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1124</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1125</span>        x_max = np.max(x)</div>
<div class="line"><span class="lineno"> 1126</span>        x = np.log(np.sum(np.exp(x - x_max)))</div>
<div class="line"><span class="lineno"> 1127</span>        x += x_max</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>        <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno"> 1130</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bf1be670f82c68189f048be52a9d60f" name="a4bf1be670f82c68189f048be52a9d60f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bf1be670f82c68189f048be52a9d60f">&#9670;&#160;</a></span>mean_absolute_difference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.mean_absolute_difference </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Mean absolute difference between two arrays.

Parameters
----------
a : numpy.ndarray
    Input 1d array.
b : numpy.ndarray
    Input 1d array.

Returns
-------
float
    mean(abs(a - b)).</pre> <div class="fragment"><div class="line"><span class="lineno"> 1131</span>    <span class="keyword">def </span>mean_absolute_difference(a, b):</div>
<div class="line"><span class="lineno"> 1132</span>        <span class="stringliteral">&quot;&quot;&quot;Mean absolute difference between two arrays.</span></div>
<div class="line"><span class="lineno"> 1133</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1134</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno"> 1135</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno"> 1136</span><span class="stringliteral">        a : numpy.ndarray</span></div>
<div class="line"><span class="lineno"> 1137</span><span class="stringliteral">            Input 1d array.</span></div>
<div class="line"><span class="lineno"> 1138</span><span class="stringliteral">        b : numpy.ndarray</span></div>
<div class="line"><span class="lineno"> 1139</span><span class="stringliteral">            Input 1d array.</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1141</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno"> 1142</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="stringliteral">        float</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="stringliteral">            mean(abs(a - b)).</span></div>
<div class="line"><span class="lineno"> 1145</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1146</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1147</span>        <span class="keywordflow">return</span> np.mean(np.abs(a - b))</div>
<div class="line"><span class="lineno"> 1148</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8b5b25340ec539ea44fcfeb7bc395c3" name="ad8b5b25340ec539ea44fcfeb7bc395c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8b5b25340ec539ea44fcfeb7bc395c3">&#9670;&#160;</a></span>pad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.pad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>padrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>padcol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Add additional rows/columns to `mat`. The new rows/columns will be initialized with zeros.

Parameters
----------
mat : numpy.ndarray
    Input 2D matrix
padrow : int
    Number of additional rows
padcol : int
    Number of additional columns

Returns
-------
numpy.matrixlib.defmatrix.matrix
    Matrix with needed padding.</pre> <div class="fragment"><div class="line"><span class="lineno">  173</span><span class="keyword">def </span>pad(mat, padrow, padcol):</div>
<div class="line"><span class="lineno">  174</span>    <span class="stringliteral">&quot;&quot;&quot;Add additional rows/columns to `mat`. The new rows/columns will be initialized with zeros.</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">    mat : numpy.ndarray</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">        Input 2D matrix</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    padrow : int</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">        Number of additional rows</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">    padcol : int</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">        Number of additional columns</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    numpy.matrixlib.defmatrix.matrix</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">        Matrix with needed padding.</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">if</span> padrow &lt; 0:</div>
<div class="line"><span class="lineno">  192</span>        padrow = 0</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">if</span> padcol &lt; 0:</div>
<div class="line"><span class="lineno">  194</span>        padcol = 0</div>
<div class="line"><span class="lineno">  195</span>    rows, cols = mat.shape</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">return</span> np.bmat([</div>
<div class="line"><span class="lineno">  197</span>        [mat, np.matrix(np.zeros((rows, padcol)))],</div>
<div class="line"><span class="lineno">  198</span>        [np.matrix(np.zeros((padrow, cols + padcol)))],</div>
<div class="line"><span class="lineno">  199</span>    ])</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a21c03e5d9b6fe398c45c9a253b28d0d8" name="a21c03e5d9b6fe398c45c9a253b28d0d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21c03e5d9b6fe398c45c9a253b28d0d8">&#9670;&#160;</a></span>qr_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.qr_destroy </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>la</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get QR decomposition of `la[0]`.

Parameters
----------
la : list of numpy.ndarray
    Run QR decomposition on the first elements of `la`. Must not be empty.

Returns
-------
(numpy.ndarray, numpy.ndarray)
    Matrices :math:`Q` and :math:`R`.

Notes
-----
Using this function is less memory intense than calling `scipy.linalg.qr(la[0])`,
because the memory used in `la[0]` is reclaimed earlier. This makes a difference when
decomposing very large arrays, where every memory copy counts.

Warnings
--------
Content of `la` as well as `la[0]` gets destroyed in the process. Again, for memory-effiency reasons.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1170</span><span class="keyword">def </span>qr_destroy(la):</div>
<div class="line"><span class="lineno"> 1171</span>    <span class="stringliteral">&quot;&quot;&quot;Get QR decomposition of `la[0]`.</span></div>
<div class="line"><span class="lineno"> 1172</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1173</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1174</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1175</span><span class="stringliteral">    la : list of numpy.ndarray</span></div>
<div class="line"><span class="lineno"> 1176</span><span class="stringliteral">        Run QR decomposition on the first elements of `la`. Must not be empty.</span></div>
<div class="line"><span class="lineno"> 1177</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1178</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1179</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1180</span><span class="stringliteral">    (numpy.ndarray, numpy.ndarray)</span></div>
<div class="line"><span class="lineno"> 1181</span><span class="stringliteral">        Matrices :math:`Q` and :math:`R`.</span></div>
<div class="line"><span class="lineno"> 1182</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1183</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1184</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1185</span><span class="stringliteral">    Using this function is less memory intense than calling `scipy.linalg.qr(la[0])`,</span></div>
<div class="line"><span class="lineno"> 1186</span><span class="stringliteral">    because the memory used in `la[0]` is reclaimed earlier. This makes a difference when</span></div>
<div class="line"><span class="lineno"> 1187</span><span class="stringliteral">    decomposing very large arrays, where every memory copy counts.</span></div>
<div class="line"><span class="lineno"> 1188</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1189</span><span class="stringliteral">    Warnings</span></div>
<div class="line"><span class="lineno"> 1190</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1191</span><span class="stringliteral">    Content of `la` as well as `la[0]` gets destroyed in the process. Again, for memory-effiency reasons.</span></div>
<div class="line"><span class="lineno"> 1192</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1193</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1194</span>    a = np.asfortranarray(la[0])</div>
<div class="line"><span class="lineno"> 1195</span>    del la[0], la  <span class="comment"># now `a` is the only reference to the input matrix</span></div>
<div class="line"><span class="lineno"> 1196</span>    m, n = a.shape</div>
<div class="line"><span class="lineno"> 1197</span>    <span class="comment"># perform q, r = QR(a); code hacked out of scipy.linalg.qr</span></div>
<div class="line"><span class="lineno"> 1198</span>    logger.debug(<span class="stringliteral">&quot;computing QR of %s dense matrix&quot;</span>, str(a.shape))</div>
<div class="line"><span class="lineno"> 1199</span>    geqrf, = get_lapack_funcs((<span class="stringliteral">&#39;geqrf&#39;</span>,), (a,))</div>
<div class="line"><span class="lineno"> 1200</span>    qr, tau, work, info = geqrf(a, lwork=-1, overwrite_a=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1201</span>    qr, tau, work, info = geqrf(a, lwork=work[0], overwrite_a=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1202</span>    del a  <span class="comment"># free up mem</span></div>
<div class="line"><span class="lineno"> 1203</span>    <span class="keyword">assert</span> info &gt;= 0</div>
<div class="line"><span class="lineno"> 1204</span>    r = triu(qr[:n, :n])</div>
<div class="line"><span class="lineno"> 1205</span>    <span class="keywordflow">if</span> m &lt; n:  <span class="comment"># rare case, #features &lt; #topics</span></div>
<div class="line"><span class="lineno"> 1206</span>        qr = qr[:, :m]  <span class="comment"># retains fortran order</span></div>
<div class="line"><span class="lineno"> 1207</span>    gorgqr, = get_lapack_funcs((<span class="stringliteral">&#39;orgqr&#39;</span>,), (qr,))</div>
<div class="line"><span class="lineno"> 1208</span>    q, work, info = gorgqr(qr, tau, lwork=-1, overwrite_a=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1209</span>    q, work, info = gorgqr(qr, tau, lwork=work[0], overwrite_a=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1210</span>    <span class="keyword">assert</span> info &gt;= 0, <span class="stringliteral">&quot;qr failed&quot;</span></div>
<div class="line"><span class="lineno"> 1211</span>    <span class="keyword">assert</span> q.flags.f_contiguous</div>
<div class="line"><span class="lineno"> 1212</span>    <span class="keywordflow">return</span> q, r</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a63cf0e11bba0c7ba10f735f79dc5bde0" name="a63cf0e11bba0c7ba10f735f79dc5bde0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63cf0e11bba0c7ba10f735f79dc5bde0">&#9670;&#160;</a></span>ret_log_normalize_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.ret_log_normalize_vec </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  667</span><span class="keyword">def </span>ret_log_normalize_vec(vec, axis=1):</div>
<div class="line"><span class="lineno">  668</span>    log_max = 100.0</div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">if</span> len(vec.shape) == 1:</div>
<div class="line"><span class="lineno">  670</span>        max_val = np.max(vec)</div>
<div class="line"><span class="lineno">  671</span>        log_shift = log_max - np.log(len(vec) + 1.0) - max_val</div>
<div class="line"><span class="lineno">  672</span>        tot = np.sum(np.exp(vec + log_shift))</div>
<div class="line"><span class="lineno">  673</span>        log_norm = np.log(tot) - log_shift</div>
<div class="line"><span class="lineno">  674</span>        vec -= log_norm</div>
<div class="line"><span class="lineno">  675</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  676</span>        <span class="keywordflow">if</span> axis == 1:  <span class="comment"># independently normalize each sample</span></div>
<div class="line"><span class="lineno">  677</span>            max_val = np.max(vec, 1)</div>
<div class="line"><span class="lineno">  678</span>            log_shift = log_max - np.log(vec.shape[1] + 1.0) - max_val</div>
<div class="line"><span class="lineno">  679</span>            tot = np.sum(np.exp(vec + log_shift[:, np.newaxis]), 1)</div>
<div class="line"><span class="lineno">  680</span>            log_norm = np.log(tot) - log_shift</div>
<div class="line"><span class="lineno">  681</span>            vec = vec - log_norm[:, np.newaxis]</div>
<div class="line"><span class="lineno">  682</span>        <span class="keywordflow">elif</span> axis == 0:  <span class="comment"># normalize each feature</span></div>
<div class="line"><span class="lineno">  683</span>            k = ret_log_normalize_vec(vec.T)</div>
<div class="line"><span class="lineno">  684</span>            <span class="keywordflow">return</span> k[0].T, k[1]</div>
<div class="line"><span class="lineno">  685</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  686</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;%s&#39; is not a supported axis&quot;</span> % axis)</div>
<div class="line"><span class="lineno">  687</span>    <span class="keywordflow">return</span> vec, log_norm</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a447cb9e0ed5905d6e9493c3580bc79" name="a2a447cb9e0ed5905d6e9493c3580bc79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a447cb9e0ed5905d6e9493c3580bc79">&#9670;&#160;</a></span>ret_normalized_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.ret_normalized_vec </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Normalize a vector in L2 (Euclidean unit norm).

Parameters
----------
vec : list of (int, number)
    Input vector in BoW format.
length : float
    Length of vector

Returns
-------
list of (int, number)
    L2-normalized vector in BoW format.</pre> <div class="fragment"><div class="line"><span class="lineno">  645</span><span class="keyword">def </span>ret_normalized_vec(vec, length):</div>
<div class="line"><span class="lineno">  646</span>    <span class="stringliteral">&quot;&quot;&quot;Normalize a vector in L2 (Euclidean unit norm).</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral">    vec : list of (int, number)</span></div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">        Input vector in BoW format.</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral">    length : float</span></div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">        Length of vector</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">    list of (int, number)</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral">        L2-normalized vector in BoW format.</span></div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordflow">if</span> length != 1.0:</div>
<div class="line"><span class="lineno">  662</span>        <span class="keywordflow">return</span> [(termid, val / length) <span class="keywordflow">for</span> termid, val <span class="keywordflow">in</span> vec]</div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  664</span>        <span class="keywordflow">return</span> list(vec)</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ad813947c2ce8af1d77f4e8434e7d3b" name="a3ad813947c2ce8af1d77f4e8434e7d3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ad813947c2ce8af1d77f4e8434e7d3b">&#9670;&#160;</a></span>scipy2scipy_clipped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.scipy2scipy_clipped </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>topn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-9</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get the 'topn' elements of the greatest magnitude (absolute value) from a `scipy.sparse` vector or matrix.

Parameters
----------
matrix : `scipy.sparse`
    Input vector or matrix (1D or 2D sparse array).
topn : int
    Number of greatest elements, in absolute value, to return.
eps : float
    Ignored.

Returns
-------
`scipy.sparse.csr.csr_matrix`
    Clipped matrix.</pre> <div class="fragment"><div class="line"><span class="lineno">  268</span><span class="keyword">def </span>scipy2scipy_clipped(matrix, topn, eps=1e-9):</div>
<div class="line"><span class="lineno">  269</span>    <span class="stringliteral">&quot;&quot;&quot;Get the &#39;topn&#39; elements of the greatest magnitude (absolute value) from a `scipy.sparse` vector or matrix.</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    matrix : `scipy.sparse`</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">        Input vector or matrix (1D or 2D sparse array).</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    topn : int</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">        Number of greatest elements, in absolute value, to return.</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    eps : float</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">        Ignored.</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    `scipy.sparse.csr.csr_matrix`</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">        Clipped matrix.</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> scipy.sparse.issparse(matrix):</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;%s&#39; is not a scipy sparse vector.&quot;</span> % matrix)</div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">if</span> topn &lt;= 0:</div>
<div class="line"><span class="lineno">  289</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classscipy_1_1sparse_1_1__csr_1_1csr__matrix.html">scipy.sparse.csr_matrix</a>([])</div>
<div class="line"><span class="lineno">  290</span>    <span class="comment"># Return clipped sparse vector if input is a sparse vector.</span></div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">if</span> matrix.shape[0] == 1:</div>
<div class="line"><span class="lineno">  292</span>        <span class="comment"># use np.argpartition/argsort and only form tuples that are actually returned.</span></div>
<div class="line"><span class="lineno">  293</span>        biggest = argsort(abs(matrix.data), topn, reverse=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  294</span>        indices, data = matrix.indices.take(biggest), matrix.data.take(biggest)</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classscipy_1_1sparse_1_1__csr_1_1csr__matrix.html">scipy.sparse.csr_matrix</a>((data, indices, [0, len(indices)]))</div>
<div class="line"><span class="lineno">  296</span>    <span class="comment"># Return clipped sparse matrix if input is a matrix, processing row by row.</span></div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  298</span>        matrix_indices = []</div>
<div class="line"><span class="lineno">  299</span>        matrix_data = []</div>
<div class="line"><span class="lineno">  300</span>        matrix_indptr = [0]</div>
<div class="line"><span class="lineno">  301</span>        <span class="comment"># calling abs() on entire matrix once is faster than calling abs() iteratively for each row</span></div>
<div class="line"><span class="lineno">  302</span>        matrix_abs = abs(matrix)</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(matrix.shape[0]):</div>
<div class="line"><span class="lineno">  304</span>            v = matrix.getrow(i)</div>
<div class="line"><span class="lineno">  305</span>            v_abs = matrix_abs.getrow(i)</div>
<div class="line"><span class="lineno">  306</span>            <span class="comment"># Sort and clip each row vector first.</span></div>
<div class="line"><span class="lineno">  307</span>            biggest = argsort(v_abs.data, topn, reverse=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  308</span>            indices, data = v.indices.take(biggest), v.data.take(biggest)</div>
<div class="line"><span class="lineno">  309</span>            <span class="comment"># Store the topn indices and values of each row vector.</span></div>
<div class="line"><span class="lineno">  310</span>            matrix_data.append(data)</div>
<div class="line"><span class="lineno">  311</span>            matrix_indices.append(indices)</div>
<div class="line"><span class="lineno">  312</span>            matrix_indptr.append(matrix_indptr[-1] + min(len(indices), topn))</div>
<div class="line"><span class="lineno">  313</span>        matrix_indices = np.concatenate(matrix_indices).ravel()</div>
<div class="line"><span class="lineno">  314</span>        matrix_data = np.concatenate(matrix_data).ravel()</div>
<div class="line"><span class="lineno">  315</span>        <span class="comment"># Instantiate and return a sparse csr_matrix which preserves the order of indices/data.</span></div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordflow">return</span> scipy.sparse.csr.csr_matrix(</div>
<div class="line"><span class="lineno">  317</span>            (matrix_data, matrix_indices, matrix_indptr),</div>
<div class="line"><span class="lineno">  318</span>            shape=(matrix.shape[0], np.max(matrix_indices) + 1)</div>
<div class="line"><span class="lineno">  319</span>        )</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="ttc" id="aclassscipy_1_1sparse_1_1__csr_1_1csr__matrix_html"><div class="ttname"><a href="classscipy_1_1sparse_1_1__csr_1_1csr__matrix.html">scipy.sparse._csr.csr_matrix</a></div><div class="ttdef"><b>Definition</b> _csr.py:17</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab54f53e1ed7609694d3780fbd84bab7a" name="ab54f53e1ed7609694d3780fbd84bab7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab54f53e1ed7609694d3780fbd84bab7a">&#9670;&#160;</a></span>scipy2sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.scipy2sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-9</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert a scipy.sparse vector into the Gensim bag-of-words format.

Parameters
----------
vec : `scipy.sparse`
    Sparse vector.

eps : float, optional
    Value used for threshold, all coordinates less than `eps` will not be presented in result.

Returns
-------
list of (int, float)
    Vector in Gensim bag-of-words format.</pre> <div class="fragment"><div class="line"><span class="lineno">  322</span><span class="keyword">def </span>scipy2sparse(vec, eps=1e-9):</div>
<div class="line"><span class="lineno">  323</span>    <span class="stringliteral">&quot;&quot;&quot;Convert a scipy.sparse vector into the Gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">    vec : `scipy.sparse`</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">        Sparse vector.</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    eps : float, optional</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">        Value used for threshold, all coordinates less than `eps` will not be presented in result.</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    list of (int, float)</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">        Vector in Gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  339</span>    vec = vec.tocsr()</div>
<div class="line"><span class="lineno">  340</span>    <span class="keyword">assert</span> vec.shape[0] == 1</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">return</span> [(int(pos), float(val)) <span class="keywordflow">for</span> pos, val <span class="keywordflow">in</span> zip(vec.indices, vec.data) <span class="keywordflow">if</span> np.abs(val) &gt; eps]</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abf2c014bf52d555eed2b5679bc26a4e4" name="abf2c014bf52d555eed2b5679bc26a4e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf2c014bf52d555eed2b5679bc26a4e4">&#9670;&#160;</a></span>softcossim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.softcossim </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>similarity_matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get Soft Cosine Measure between two vectors given a term similarity matrix.

Return Soft Cosine Measure between two sparse vectors given a sparse term similarity matrix
in the :class:`scipy.sparse.csc_matrix` format. The similarity is a number between `&lt;-1.0, 1.0&gt;`,
higher is more similar.

Notes
-----
Soft Cosine Measure was perhaps first defined by `Grigori Sidorov et al.,
"Soft Similarity and Soft Cosine Measure: Similarity of Features in Vector Space Model"
&lt;http://www.cys.cic.ipn.mx/ojs/index.php/CyS/article/view/2043/1921&gt;`_.

Parameters
----------
vec1 : list of (int, float)
    A query vector in the BoW format.
vec2 : list of (int, float)
    A document vector in the BoW format.
similarity_matrix : {:class:`scipy.sparse.csc_matrix`, :class:`scipy.sparse.csr_matrix`}
    A term similarity matrix. If the matrix is :class:`scipy.sparse.csr_matrix`, it is going
    to be transposed. If you rely on the fact that there is at most a constant number of
    non-zero elements in a single column, it is your responsibility to ensure that the matrix
    is symmetric.

Returns
-------
`similarity_matrix.dtype`
    The Soft Cosine Measure between `vec1` and `vec2`.

Raises
------
ValueError
    When the term similarity matrix is in an unknown format.

See Also
--------
:meth:`gensim.models.keyedvectors.WordEmbeddingsKeyedVectors.similarity_matrix`
    A term similarity matrix produced from term embeddings.
:class:`gensim.similarities.docsim.SoftCosineSimilarity`
    A class for performing corpus-based similarity queries with Soft Cosine Measure.</pre> <div class="fragment"><div class="line"><span class="lineno">  825</span><span class="keyword">def </span>softcossim(vec1, vec2, similarity_matrix):</div>
<div class="line"><span class="lineno">  826</span>    <span class="stringliteral">&quot;&quot;&quot;Get Soft Cosine Measure between two vectors given a term similarity matrix.</span></div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral">    Return Soft Cosine Measure between two sparse vectors given a sparse term similarity matrix</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">    in the :class:`scipy.sparse.csc_matrix` format. The similarity is a number between `&lt;-1.0, 1.0&gt;`,</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">    higher is more similar.</span></div>
<div class="line"><span class="lineno">  831</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  832</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  833</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  834</span><span class="stringliteral">    Soft Cosine Measure was perhaps first defined by `Grigori Sidorov et al.,</span></div>
<div class="line"><span class="lineno">  835</span><span class="stringliteral">    &quot;Soft Similarity and Soft Cosine Measure: Similarity of Features in Vector Space Model&quot;</span></div>
<div class="line"><span class="lineno">  836</span><span class="stringliteral">    &lt;http://www.cys.cic.ipn.mx/ojs/index.php/CyS/article/view/2043/1921&gt;`_.</span></div>
<div class="line"><span class="lineno">  837</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  838</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  839</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  840</span><span class="stringliteral">    vec1 : list of (int, float)</span></div>
<div class="line"><span class="lineno">  841</span><span class="stringliteral">        A query vector in the BoW format.</span></div>
<div class="line"><span class="lineno">  842</span><span class="stringliteral">    vec2 : list of (int, float)</span></div>
<div class="line"><span class="lineno">  843</span><span class="stringliteral">        A document vector in the BoW format.</span></div>
<div class="line"><span class="lineno">  844</span><span class="stringliteral">    similarity_matrix : {:class:`scipy.sparse.csc_matrix`, :class:`scipy.sparse.csr_matrix`}</span></div>
<div class="line"><span class="lineno">  845</span><span class="stringliteral">        A term similarity matrix. If the matrix is :class:`scipy.sparse.csr_matrix`, it is going</span></div>
<div class="line"><span class="lineno">  846</span><span class="stringliteral">        to be transposed. If you rely on the fact that there is at most a constant number of</span></div>
<div class="line"><span class="lineno">  847</span><span class="stringliteral">        non-zero elements in a single column, it is your responsibility to ensure that the matrix</span></div>
<div class="line"><span class="lineno">  848</span><span class="stringliteral">        is symmetric.</span></div>
<div class="line"><span class="lineno">  849</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  850</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  851</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  852</span><span class="stringliteral">    `similarity_matrix.dtype`</span></div>
<div class="line"><span class="lineno">  853</span><span class="stringliteral">        The Soft Cosine Measure between `vec1` and `vec2`.</span></div>
<div class="line"><span class="lineno">  854</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  855</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  856</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  857</span><span class="stringliteral">    ValueError</span></div>
<div class="line"><span class="lineno">  858</span><span class="stringliteral">        When the term similarity matrix is in an unknown format.</span></div>
<div class="line"><span class="lineno">  859</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  860</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  861</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  862</span><span class="stringliteral">    :meth:`gensim.models.keyedvectors.WordEmbeddingsKeyedVectors.similarity_matrix`</span></div>
<div class="line"><span class="lineno">  863</span><span class="stringliteral">        A term similarity matrix produced from term embeddings.</span></div>
<div class="line"><span class="lineno">  864</span><span class="stringliteral">    :class:`gensim.similarities.docsim.SoftCosineSimilarity`</span></div>
<div class="line"><span class="lineno">  865</span><span class="stringliteral">        A class for performing corpus-based similarity queries with Soft Cosine Measure.</span></div>
<div class="line"><span class="lineno">  866</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  868</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(similarity_matrix, <a class="code hl_class" href="classscipy_1_1sparse_1_1__csc_1_1csc__matrix.html">scipy.sparse.csc_matrix</a>):</div>
<div class="line"><span class="lineno">  869</span>        <span class="keywordflow">if</span> isinstance(similarity_matrix, <a class="code hl_class" href="classscipy_1_1sparse_1_1__csr_1_1csr__matrix.html">scipy.sparse.csr_matrix</a>):</div>
<div class="line"><span class="lineno">  870</span>            similarity_matrix = similarity_matrix.T</div>
<div class="line"><span class="lineno">  871</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  872</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;unknown similarity matrix format&#39;</span>)</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> vec1 <span class="keywordflow">or</span> <span class="keywordflow">not</span> vec2:</div>
<div class="line"><span class="lineno">  875</span>        <span class="keywordflow">return</span> 0.0</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>    vec1 = dict(vec1)</div>
<div class="line"><span class="lineno">  878</span>    vec2 = dict(vec2)</div>
<div class="line"><span class="lineno">  879</span>    word_indices = sorted(set(chain(vec1, vec2)))</div>
<div class="line"><span class="lineno">  880</span>    dtype = similarity_matrix.dtype</div>
<div class="line"><span class="lineno">  881</span>    vec1 = np.fromiter((vec1[i] <span class="keywordflow">if</span> i <span class="keywordflow">in</span> vec1 <span class="keywordflow">else</span> 0 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> word_indices), dtype=dtype, count=len(word_indices))</div>
<div class="line"><span class="lineno">  882</span>    vec2 = np.fromiter((vec2[i] <span class="keywordflow">if</span> i <span class="keywordflow">in</span> vec2 <span class="keywordflow">else</span> 0 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> word_indices), dtype=dtype, count=len(word_indices))</div>
<div class="line"><span class="lineno">  883</span>    dense_matrix = similarity_matrix[[[i] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> word_indices], word_indices].todense()</div>
<div class="line"><span class="lineno">  884</span>    vec1len = vec1.T.dot(dense_matrix).dot(vec1)[0, 0]</div>
<div class="line"><span class="lineno">  885</span>    vec2len = vec2.T.dot(dense_matrix).dot(vec2)[0, 0]</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span>    <span class="keyword">assert</span> \</div>
<div class="line"><span class="lineno">  888</span>        vec1len &gt; 0.0 <span class="keywordflow">and</span> vec2len &gt; 0.0, \</div>
<div class="line"><span class="lineno">  889</span>        <span class="stringliteral">u&quot;sparse documents must not contain any explicit zero entries and the similarity matrix S &quot;</span> \</div>
<div class="line"><span class="lineno">  890</span>        <span class="stringliteral">u&quot;must satisfy x^T * S * x &gt; 0 for any nonzero bag-of-words vector x.&quot;</span></div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>    result = vec1.T.dot(dense_matrix).dot(vec2)[0, 0]</div>
<div class="line"><span class="lineno">  893</span>    result /= math.sqrt(vec1len) * math.sqrt(vec2len)  <span class="comment"># rescale by vector lengths</span></div>
<div class="line"><span class="lineno">  894</span>    <span class="keywordflow">return</span> np.clip(result, -1.0, 1.0)</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aebe041e75909ae8356aed869f09fa04c" name="aebe041e75909ae8356aed869f09fa04c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebe041e75909ae8356aed869f09fa04c">&#9670;&#160;</a></span>sparse2full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.sparse2full </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>doc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert a document in Gensim bag-of-words format into a dense numpy array.

Parameters
----------
doc : list of (int, number)
    Document in BoW format.
length : int
    Vector dimensionality. This cannot be inferred from the BoW, and you must supply it explicitly.
    This is typically the vocabulary size or number of topics, depending on how you created `doc`.

Returns
-------
numpy.ndarray
    Dense numpy vector for `doc`.

See Also
--------
:func:`~gensim.matutils.full2sparse`
    Convert dense array to gensim bag-of-words format.</pre> <div class="fragment"><div class="line"><span class="lineno">  375</span><span class="keyword">def </span>sparse2full(doc, length):</div>
<div class="line"><span class="lineno">  376</span>    <span class="stringliteral">&quot;&quot;&quot;Convert a document in Gensim bag-of-words format into a dense numpy array.</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">    doc : list of (int, number)</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">        Document in BoW format.</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">    length : int</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">        Vector dimensionality. This cannot be inferred from the BoW, and you must supply it explicitly.</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">        This is typically the vocabulary size or number of topics, depending on how you created `doc`.</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">    numpy.ndarray</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">        Dense numpy vector for `doc`.</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    :func:`~gensim.matutils.full2sparse`</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">        Convert dense array to gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  397</span>    result = np.zeros(length, dtype=np.float32)  <span class="comment"># fill with zeroes (default value)</span></div>
<div class="line"><span class="lineno">  398</span>    <span class="comment"># convert indices to int as numpy 1.12 no longer indexes by floats</span></div>
<div class="line"><span class="lineno">  399</span>    doc = ((int(id_), float(val_)) <span class="keywordflow">for</span> (id_, val_) <span class="keywordflow">in</span> doc)</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    doc = dict(doc)</div>
<div class="line"><span class="lineno">  402</span>    <span class="comment"># overwrite some of the zeroes with explicit values</span></div>
<div class="line"><span class="lineno">  403</span>    result[list(doc)] = list(itervalues(doc))</div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af11c02b431f495ce6ba422f942251de8" name="af11c02b431f495ce6ba422f942251de8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af11c02b431f495ce6ba422f942251de8">&#9670;&#160;</a></span>unitvec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.unitvec </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>'l2'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_norm</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Scale a vector to unit length.

Parameters
----------
vec : {numpy.ndarray, scipy.sparse, list of (int, float)}
    Input vector in any format
norm : {'l1', 'l2', 'unique'}, optional
    Metric to normalize in.
return_norm : bool, optional
    Return the length of vector `vec`, in addition to the normalized vector itself?

Returns
-------
numpy.ndarray, scipy.sparse, list of (int, float)}
    Normalized vector in same format as `vec`.
float
    Length of `vec` before normalization, if `return_norm` is set.

Notes
-----
Zero-vector will be unchanged.</pre> <div class="fragment"><div class="line"><span class="lineno">  694</span><span class="keyword">def </span>unitvec(vec, norm=&#39;l2&#39;, return_norm=False):</div>
<div class="line"><span class="lineno">  695</span>    <span class="stringliteral">&quot;&quot;&quot;Scale a vector to unit length.</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">    vec : {numpy.ndarray, scipy.sparse, list of (int, float)}</span></div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral">        Input vector in any format</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">    norm : {&#39;l1&#39;, &#39;l2&#39;, &#39;unique&#39;}, optional</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral">        Metric to normalize in.</span></div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">    return_norm : bool, optional</span></div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral">        Return the length of vector `vec`, in addition to the normalized vector itself?</span></div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  708</span><span class="stringliteral">    numpy.ndarray, scipy.sparse, list of (int, float)}</span></div>
<div class="line"><span class="lineno">  709</span><span class="stringliteral">        Normalized vector in same format as `vec`.</span></div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral">    float</span></div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral">        Length of `vec` before normalization, if `return_norm` is set.</span></div>
<div class="line"><span class="lineno">  712</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  713</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral">    Zero-vector will be unchanged.</span></div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  718</span>    supported_norms = (<span class="stringliteral">&#39;l1&#39;</span>, <span class="stringliteral">&#39;l2&#39;</span>, <span class="stringliteral">&#39;unique&#39;</span>)</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> norm <span class="keywordflow">not</span> <span class="keywordflow">in</span> supported_norms:</div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;%s&#39; is not a supported norm. Currently supported norms are %s.&quot;</span> % (norm, supported_norms))</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>    <span class="keywordflow">if</span> scipy.sparse.issparse(vec):</div>
<div class="line"><span class="lineno">  723</span>        vec = vec.tocsr()</div>
<div class="line"><span class="lineno">  724</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;l1&#39;</span>:</div>
<div class="line"><span class="lineno">  725</span>            veclen = np.sum(np.abs(vec.data))</div>
<div class="line"><span class="lineno">  726</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;l2&#39;</span>:</div>
<div class="line"><span class="lineno">  727</span>            veclen = np.sqrt(np.sum(vec.data ** 2))</div>
<div class="line"><span class="lineno">  728</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;unique&#39;</span>:</div>
<div class="line"><span class="lineno">  729</span>            veclen = vec.nnz</div>
<div class="line"><span class="lineno">  730</span>        <span class="keywordflow">if</span> veclen &gt; 0.0:</div>
<div class="line"><span class="lineno">  731</span>            <span class="keywordflow">if</span> np.issubdtype(vec.dtype, np.integer):</div>
<div class="line"><span class="lineno">  732</span>                vec = vec.astype(np.float)</div>
<div class="line"><span class="lineno">  733</span>            vec /= veclen</div>
<div class="line"><span class="lineno">  734</span>            <span class="keywordflow">if</span> return_norm:</div>
<div class="line"><span class="lineno">  735</span>                <span class="keywordflow">return</span> vec, veclen</div>
<div class="line"><span class="lineno">  736</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  737</span>                <span class="keywordflow">return</span> vec</div>
<div class="line"><span class="lineno">  738</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  739</span>            <span class="keywordflow">if</span> return_norm:</div>
<div class="line"><span class="lineno">  740</span>                <span class="keywordflow">return</span> vec, 1.0</div>
<div class="line"><span class="lineno">  741</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  742</span>                <span class="keywordflow">return</span> vec</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>    <span class="keywordflow">if</span> isinstance(vec, np.ndarray):</div>
<div class="line"><span class="lineno">  745</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;l1&#39;</span>:</div>
<div class="line"><span class="lineno">  746</span>            veclen = np.sum(np.abs(vec))</div>
<div class="line"><span class="lineno">  747</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;l2&#39;</span>:</div>
<div class="line"><span class="lineno">  748</span>            <span class="keywordflow">if</span> vec.size == 0:</div>
<div class="line"><span class="lineno">  749</span>                veclen = 0.0</div>
<div class="line"><span class="lineno">  750</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  751</span>                veclen = blas_nrm2(vec)</div>
<div class="line"><span class="lineno">  752</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;unique&#39;</span>:</div>
<div class="line"><span class="lineno">  753</span>            veclen = np.count_nonzero(vec)</div>
<div class="line"><span class="lineno">  754</span>        <span class="keywordflow">if</span> veclen &gt; 0.0:</div>
<div class="line"><span class="lineno">  755</span>            <span class="keywordflow">if</span> np.issubdtype(vec.dtype, np.integer):</div>
<div class="line"><span class="lineno">  756</span>                vec = vec.astype(np.float)</div>
<div class="line"><span class="lineno">  757</span>            <span class="keywordflow">if</span> return_norm:</div>
<div class="line"><span class="lineno">  758</span>                <span class="keywordflow">return</span> blas_scal(1.0 / veclen, vec).astype(vec.dtype), veclen</div>
<div class="line"><span class="lineno">  759</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  760</span>                <span class="keywordflow">return</span> blas_scal(1.0 / veclen, vec).astype(vec.dtype)</div>
<div class="line"><span class="lineno">  761</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  762</span>            <span class="keywordflow">if</span> return_norm:</div>
<div class="line"><span class="lineno">  763</span>                <span class="keywordflow">return</span> vec, 1.0</div>
<div class="line"><span class="lineno">  764</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  765</span>                <span class="keywordflow">return</span> vec</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  768</span>        first = next(<a class="code hl_variable" href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a>(vec))  <span class="comment"># is there at least one element?</span></div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">except</span> StopIteration:</div>
<div class="line"><span class="lineno">  770</span>        <span class="keywordflow">if</span> return_norm:</div>
<div class="line"><span class="lineno">  771</span>            <span class="keywordflow">return</span> vec, 1.0</div>
<div class="line"><span class="lineno">  772</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  773</span>            <span class="keywordflow">return</span> vec</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">if</span> isinstance(first, (tuple, list)) <span class="keywordflow">and</span> len(first) == 2:  <span class="comment"># gensim sparse format</span></div>
<div class="line"><span class="lineno">  776</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;l1&#39;</span>:</div>
<div class="line"><span class="lineno">  777</span>            length = float(sum(abs(val) <span class="keywordflow">for</span> _, val <span class="keywordflow">in</span> vec))</div>
<div class="line"><span class="lineno">  778</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;l2&#39;</span>:</div>
<div class="line"><span class="lineno">  779</span>            length = 1.0 * math.sqrt(sum(val ** 2 <span class="keywordflow">for</span> _, val <span class="keywordflow">in</span> vec))</div>
<div class="line"><span class="lineno">  780</span>        <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;unique&#39;</span>:</div>
<div class="line"><span class="lineno">  781</span>            length = 1.0 * len(vec)</div>
<div class="line"><span class="lineno">  782</span>        <span class="keyword">assert</span> length &gt; 0.0, <span class="stringliteral">&quot;sparse documents must not contain any explicit zero entries&quot;</span></div>
<div class="line"><span class="lineno">  783</span>        <span class="keywordflow">if</span> return_norm:</div>
<div class="line"><span class="lineno">  784</span>            <span class="keywordflow">return</span> ret_normalized_vec(vec, length), length</div>
<div class="line"><span class="lineno">  785</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  786</span>            <span class="keywordflow">return</span> ret_normalized_vec(vec, length)</div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  788</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;unknown input type&quot;</span>)</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_a60590d91febfcb54d88443940cd5f23e"><div class="ttname"><a href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a></div><div class="ttdeci">void int double int double double double double int int * iter</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:623</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad762724c82f5acef13649629eef642bb" name="ad762724c82f5acef13649629eef642bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad762724c82f5acef13649629eef642bb">&#9670;&#160;</a></span>veclen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.veclen </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate L2 (euclidean) length of a vector.

Parameters
----------
vec : list of (int, number)
    Input vector in sparse bag-of-words format.

Returns
-------
float
    Length of `vec`.</pre> <div class="fragment"><div class="line"><span class="lineno">  624</span><span class="keyword">def </span>veclen(vec):</div>
<div class="line"><span class="lineno">  625</span>    <span class="stringliteral">&quot;&quot;&quot;Calculate L2 (euclidean) length of a vector.</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral">    vec : list of (int, number)</span></div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">        Input vector in sparse bag-of-words format.</span></div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  633</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  634</span><span class="stringliteral">    float</span></div>
<div class="line"><span class="lineno">  635</span><span class="stringliteral">        Length of `vec`.</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordflow">if</span> len(vec) == 0:</div>
<div class="line"><span class="lineno">  639</span>        <span class="keywordflow">return</span> 0.0</div>
<div class="line"><span class="lineno">  640</span>    length = 1.0 * math.sqrt(sum(val**2 <span class="keywordflow">for</span> _, val <span class="keywordflow">in</span> vec))</div>
<div class="line"><span class="lineno">  641</span>    <span class="keyword">assert</span> length &gt; 0.0, <span class="stringliteral">&quot;sparse documents must not contain any explicit zero entries&quot;</span></div>
<div class="line"><span class="lineno">  642</span>    <span class="keywordflow">return</span> length</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af0f4e63af65970c43d3dd2186786c773" name="af0f4e63af65970c43d3dd2186786c773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0f4e63af65970c43d3dd2186786c773">&#9670;&#160;</a></span>zeros_aligned()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.zeros_aligned </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>order</em> = <code>'C'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>align</em> = <code>128</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get array aligned at `align` byte boundary in memory.

Parameters
----------
shape : int or (int, int)
    Shape of array.
dtype : data-type
    Data type of array.
order : {'C', 'F'}, optional
    Whether to store multidimensional data in C- or Fortran-contiguous (row- or column-wise) order in memory.
align : int, optional
    Boundary for alignment in bytes.

Returns
-------
numpy.ndarray
    Aligned array.</pre> <div class="fragment"><div class="line"><span class="lineno">  202</span><span class="keyword">def </span>zeros_aligned(shape, dtype, order=&#39;C&#39;, align=128):</div>
<div class="line"><span class="lineno">  203</span>    <span class="stringliteral">&quot;&quot;&quot;Get array aligned at `align` byte boundary in memory.</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    shape : int or (int, int)</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">        Shape of array.</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    dtype : data-type</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">        Data type of array.</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    order : {&#39;C&#39;, &#39;F&#39;}, optional</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">        Whether to store multidimensional data in C- or Fortran-contiguous (row- or column-wise) order in memory.</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    align : int, optional</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">        Boundary for alignment in bytes.</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">    numpy.ndarray</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">        Aligned array.</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  222</span>    nbytes = np.prod(shape, dtype=np.int64) * np.dtype(dtype).itemsize</div>
<div class="line"><span class="lineno">  223</span>    buffer = np.zeros(nbytes + align, dtype=np.uint8)  <span class="comment"># problematic on win64 (&quot;maximum allowed dimension exceeded&quot;)</span></div>
<div class="line"><span class="lineno">  224</span>    start_index = -buffer.ctypes.data % align</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">return</span> buffer[start_index: start_index + nbytes].view(dtype).reshape(shape, order=order)</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9ddae37c53575256bf4393c6c2898b09" name="a9ddae37c53575256bf4393c6c2898b09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ddae37c53575256bf4393c6c2898b09">&#9670;&#160;</a></span>blas_nrm2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.blas_nrm2 = <a class="el" href="namespacegensim_1_1matutils.html#abe0c34c59d19760696fb541155764405">blas</a>('nrm2', np.array([], dtype=float))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac0c2e5e14b4bbc0f3951f3372439e163" name="ac0c2e5e14b4bbc0f3951f3372439e163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0c2e5e14b4bbc0f3951f3372439e163">&#9670;&#160;</a></span>blas_scal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.blas_scal = <a class="el" href="namespacegensim_1_1matutils.html#abe0c34c59d19760696fb541155764405">blas</a>('scal', np.array([], dtype=float))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2900a35713b5b9b91b22c385ac6151d" name="ac2900a35713b5b9b91b22c385ac6151d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2900a35713b5b9b91b22c385ac6151d">&#9670;&#160;</a></span>dense2vec</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.dense2vec = <a class="el" href="namespacegensim_1_1matutils.html#a8972e8b9ba0f7f794b7c947bc49077d4">full2sparse</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0fe2607c8676f0d12c9dd22a70120eef" name="a0fe2607c8676f0d12c9dd22a70120eef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe2607c8676f0d12c9dd22a70120eef">&#9670;&#160;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.matutils.logger = logging.getLogger(__name__)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
