<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.signal._filter_design Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1signal.html">signal</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html">_filter_design</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.signal._filter_design Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1signal_1_1__filter__design_1_1_bad_coefficients.html">BadCoefficients</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5e0ed4ba7b94312ec66b13bf06bf8f74" id="r_a5e0ed4ba7b94312ec66b13bf06bf8f74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a5e0ed4ba7b94312ec66b13bf06bf8f74">_is_int_type</a> (x)</td></tr>
<tr class="separator:a5e0ed4ba7b94312ec66b13bf06bf8f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a121c7e536c227088450930f0b93805ad" id="r_a121c7e536c227088450930f0b93805ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a121c7e536c227088450930f0b93805ad">findfreqs</a> (num, den, N, kind='ba')</td></tr>
<tr class="separator:a121c7e536c227088450930f0b93805ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9575c4eb7f36f5e534309051f96a8bb7" id="r_a9575c4eb7f36f5e534309051f96a8bb7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a9575c4eb7f36f5e534309051f96a8bb7">freqs</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, worN=200, plot=None)</td></tr>
<tr class="separator:a9575c4eb7f36f5e534309051f96a8bb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d1dbc48cfac5f3492922f226c4cd817" id="r_a8d1dbc48cfac5f3492922f226c4cd817"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a8d1dbc48cfac5f3492922f226c4cd817">freqs_zpk</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, worN=200)</td></tr>
<tr class="separator:a8d1dbc48cfac5f3492922f226c4cd817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57ecfa32b9c147c7075a33d24edd5c74" id="r_a57ecfa32b9c147c7075a33d24edd5c74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a57ecfa32b9c147c7075a33d24edd5c74">freqz</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>=1, worN=512, whole=False, plot=None, fs=2 *pi, include_nyquist=False)</td></tr>
<tr class="separator:a57ecfa32b9c147c7075a33d24edd5c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a054b88d412ab15682d43c45663270868" id="r_a054b88d412ab15682d43c45663270868"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a054b88d412ab15682d43c45663270868">freqz_zpk</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, worN=512, whole=False, fs=2 *pi)</td></tr>
<tr class="separator:a054b88d412ab15682d43c45663270868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a625d835512a209cd19d7dafe141ef33a" id="r_a625d835512a209cd19d7dafe141ef33a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a625d835512a209cd19d7dafe141ef33a">group_delay</a> (system, <a class="el" href="__lapack__subroutines_8h.html#a817b85d82af73ef273fafbec623bb90b">w</a>=512, whole=False, fs=2 *pi)</td></tr>
<tr class="separator:a625d835512a209cd19d7dafe141ef33a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2dec7b3a76879ba708edb9f7d00c00c" id="r_ad2dec7b3a76879ba708edb9f7d00c00c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ad2dec7b3a76879ba708edb9f7d00c00c">_validate_sos</a> (sos)</td></tr>
<tr class="separator:ad2dec7b3a76879ba708edb9f7d00c00c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea4c4ed52a5437a54057fd7a094d1936" id="r_aea4c4ed52a5437a54057fd7a094d1936"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#aea4c4ed52a5437a54057fd7a094d1936">sosfreqz</a> (sos, worN=512, whole=False, fs=2 *pi)</td></tr>
<tr class="separator:aea4c4ed52a5437a54057fd7a094d1936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39cb8fff9a90d19a81ee134d1ee37ed4" id="r_a39cb8fff9a90d19a81ee134d1ee37ed4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a39cb8fff9a90d19a81ee134d1ee37ed4">_cplxreal</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=None)</td></tr>
<tr class="separator:a39cb8fff9a90d19a81ee134d1ee37ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aed3d7c4622770e66245baa67139fbe" id="r_a2aed3d7c4622770e66245baa67139fbe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a2aed3d7c4622770e66245baa67139fbe">_cplxpair</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=None)</td></tr>
<tr class="separator:a2aed3d7c4622770e66245baa67139fbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd8e35038fae8873d10b7f7be6b8ca8f" id="r_afd8e35038fae8873d10b7f7be6b8ca8f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#afd8e35038fae8873d10b7f7be6b8ca8f">tf2zpk</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>)</td></tr>
<tr class="separator:afd8e35038fae8873d10b7f7be6b8ca8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf4baf8dc505f8b2ef88845ec55d645" id="r_a3bf4baf8dc505f8b2ef88845ec55d645"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a3bf4baf8dc505f8b2ef88845ec55d645">zpk2tf</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>)</td></tr>
<tr class="separator:a3bf4baf8dc505f8b2ef88845ec55d645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2277b1b035aa3d8ad1e20b68ba03390" id="r_aa2277b1b035aa3d8ad1e20b68ba03390"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#aa2277b1b035aa3d8ad1e20b68ba03390">tf2sos</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, pairing=None, *analog=False)</td></tr>
<tr class="separator:aa2277b1b035aa3d8ad1e20b68ba03390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4b170e32f7fa6684c6c75c54fd0520d" id="r_ab4b170e32f7fa6684c6c75c54fd0520d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ab4b170e32f7fa6684c6c75c54fd0520d">sos2tf</a> (sos)</td></tr>
<tr class="separator:ab4b170e32f7fa6684c6c75c54fd0520d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa268051778baf0e9f10a285f6cfd412f" id="r_aa268051778baf0e9f10a285f6cfd412f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#aa268051778baf0e9f10a285f6cfd412f">sos2zpk</a> (sos)</td></tr>
<tr class="separator:aa268051778baf0e9f10a285f6cfd412f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0dd1dd0be3996b739e2a4af5d8a2d0a" id="r_ac0dd1dd0be3996b739e2a4af5d8a2d0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ac0dd1dd0be3996b739e2a4af5d8a2d0a">_nearest_real_complex_idx</a> (fro, to, which)</td></tr>
<tr class="separator:ac0dd1dd0be3996b739e2a4af5d8a2d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2c25900a53f28740007fa4ed1445a7" id="r_a5c2c25900a53f28740007fa4ed1445a7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a5c2c25900a53f28740007fa4ed1445a7">_single_zpksos</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>)</td></tr>
<tr class="separator:a5c2c25900a53f28740007fa4ed1445a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf8ebb77eeb16e01aa05afc46c9cbfce" id="r_acf8ebb77eeb16e01aa05afc46c9cbfce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#acf8ebb77eeb16e01aa05afc46c9cbfce">zpk2sos</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, pairing=None, *analog=False)</td></tr>
<tr class="separator:acf8ebb77eeb16e01aa05afc46c9cbfce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f786c9911a15f0727e21552a6d027e1" id="r_a2f786c9911a15f0727e21552a6d027e1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a2f786c9911a15f0727e21552a6d027e1">_align_nums</a> (nums)</td></tr>
<tr class="separator:a2f786c9911a15f0727e21552a6d027e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a403f599e6854656425d2a6c393be2504" id="r_a403f599e6854656425d2a6c393be2504"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a403f599e6854656425d2a6c393be2504">normalize</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>)</td></tr>
<tr class="separator:a403f599e6854656425d2a6c393be2504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdb73944d070b0526aea89119ebcd64a" id="r_acdb73944d070b0526aea89119ebcd64a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#acdb73944d070b0526aea89119ebcd64a">lp2lp</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, wo=1.0)</td></tr>
<tr class="separator:acdb73944d070b0526aea89119ebcd64a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf80f2294b9a61970f9af0785977ac7d" id="r_acf80f2294b9a61970f9af0785977ac7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#acf80f2294b9a61970f9af0785977ac7d">lp2hp</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, wo=1.0)</td></tr>
<tr class="separator:acf80f2294b9a61970f9af0785977ac7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaef8478cb2d3a2d9df568f00047d2931" id="r_aaef8478cb2d3a2d9df568f00047d2931"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#aaef8478cb2d3a2d9df568f00047d2931">lp2bp</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, wo=1.0, bw=1.0)</td></tr>
<tr class="separator:aaef8478cb2d3a2d9df568f00047d2931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3bb750049c7af67e7751863c24c1652" id="r_ad3bb750049c7af67e7751863c24c1652"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ad3bb750049c7af67e7751863c24c1652">lp2bs</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, wo=1.0, bw=1.0)</td></tr>
<tr class="separator:ad3bb750049c7af67e7751863c24c1652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fe7b079ffdda28a189c255cbe9fb1d2" id="r_a6fe7b079ffdda28a189c255cbe9fb1d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a6fe7b079ffdda28a189c255cbe9fb1d2">bilinear</a> (b, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, fs=1.0)</td></tr>
<tr class="separator:a6fe7b079ffdda28a189c255cbe9fb1d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec666fcd802c4b7014526c80cbee6ed0" id="r_aec666fcd802c4b7014526c80cbee6ed0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#aec666fcd802c4b7014526c80cbee6ed0">_validate_gpass_gstop</a> (gpass, gstop)</td></tr>
<tr class="separator:aec666fcd802c4b7014526c80cbee6ed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d58f87f7cfea7d8b63e0809aba1c20" id="r_ae4d58f87f7cfea7d8b63e0809aba1c20"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ae4d58f87f7cfea7d8b63e0809aba1c20">iirdesign</a> (wp, ws, gpass, gstop, analog=False, ftype='<a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a61a842f3ea1494216b2d32708a8ae665">ellip</a>', output='ba', fs=None)</td></tr>
<tr class="separator:ae4d58f87f7cfea7d8b63e0809aba1c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a937343d2df9040beea4d31c3efe33481" id="r_a937343d2df9040beea4d31c3efe33481"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a937343d2df9040beea4d31c3efe33481">iirfilter</a> (N, Wn, rp=None, rs=None, btype='band', analog=False, ftype='<a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a4568219d096c6e4e5a091c63dbde4bb8">butter</a>', output='ba', fs=None)</td></tr>
<tr class="separator:a937343d2df9040beea4d31c3efe33481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a719d7c3c96122501b193e7e67a6cc19b" id="r_a719d7c3c96122501b193e7e67a6cc19b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a719d7c3c96122501b193e7e67a6cc19b">_relative_degree</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p)</td></tr>
<tr class="separator:a719d7c3c96122501b193e7e67a6cc19b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9da0a444f05972f5eca9cb9035d71261" id="r_a9da0a444f05972f5eca9cb9035d71261"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a9da0a444f05972f5eca9cb9035d71261">bilinear_zpk</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, fs)</td></tr>
<tr class="separator:a9da0a444f05972f5eca9cb9035d71261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc60fe8e91d4d924a667655144f7b3d" id="r_afbc60fe8e91d4d924a667655144f7b3d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#afbc60fe8e91d4d924a667655144f7b3d">lp2lp_zpk</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, wo=1.0)</td></tr>
<tr class="separator:afbc60fe8e91d4d924a667655144f7b3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d904ad8d1239d1f5408d1ed46d6b87c" id="r_a7d904ad8d1239d1f5408d1ed46d6b87c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a7d904ad8d1239d1f5408d1ed46d6b87c">lp2hp_zpk</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, wo=1.0)</td></tr>
<tr class="separator:a7d904ad8d1239d1f5408d1ed46d6b87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add44de70076884fad1e24280565faa71" id="r_add44de70076884fad1e24280565faa71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#add44de70076884fad1e24280565faa71">lp2bp_zpk</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, wo=1.0, bw=1.0)</td></tr>
<tr class="separator:add44de70076884fad1e24280565faa71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0030f63a715bfb905de22b463bb2005" id="r_ab0030f63a715bfb905de22b463bb2005"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ab0030f63a715bfb905de22b463bb2005">lp2bs_zpk</a> (<a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, wo=1.0, bw=1.0)</td></tr>
<tr class="separator:ab0030f63a715bfb905de22b463bb2005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4568219d096c6e4e5a091c63dbde4bb8" id="r_a4568219d096c6e4e5a091c63dbde4bb8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a4568219d096c6e4e5a091c63dbde4bb8">butter</a> (N, Wn, btype='low', analog=False, output='ba', fs=None)</td></tr>
<tr class="separator:a4568219d096c6e4e5a091c63dbde4bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e77ed88eb55f4b49a99f4d8844e61b7" id="r_a0e77ed88eb55f4b49a99f4d8844e61b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a0e77ed88eb55f4b49a99f4d8844e61b7">cheby1</a> (N, rp, Wn, btype='low', analog=False, output='ba', fs=None)</td></tr>
<tr class="separator:a0e77ed88eb55f4b49a99f4d8844e61b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ded91bfef2a44d329c94a19f884a2e9" id="r_a7ded91bfef2a44d329c94a19f884a2e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a7ded91bfef2a44d329c94a19f884a2e9">cheby2</a> (N, rs, Wn, btype='low', analog=False, output='ba', fs=None)</td></tr>
<tr class="separator:a7ded91bfef2a44d329c94a19f884a2e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61a842f3ea1494216b2d32708a8ae665" id="r_a61a842f3ea1494216b2d32708a8ae665"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a61a842f3ea1494216b2d32708a8ae665">ellip</a> (N, rp, rs, Wn, btype='low', analog=False, output='ba', fs=None)</td></tr>
<tr class="separator:a61a842f3ea1494216b2d32708a8ae665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad432d51b3c6588aad365b569f4fd73fc" id="r_ad432d51b3c6588aad365b569f4fd73fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ad432d51b3c6588aad365b569f4fd73fc">bessel</a> (N, Wn, btype='low', analog=False, output='ba', norm='phase', fs=None)</td></tr>
<tr class="separator:ad432d51b3c6588aad365b569f4fd73fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e93da165795ed541dd2fa129b781a35" id="r_a4e93da165795ed541dd2fa129b781a35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a4e93da165795ed541dd2fa129b781a35">maxflat</a> ()</td></tr>
<tr class="separator:a4e93da165795ed541dd2fa129b781a35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c5cc73d85694103d8943b59e3c3fe4" id="r_a63c5cc73d85694103d8943b59e3c3fe4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a63c5cc73d85694103d8943b59e3c3fe4">yulewalk</a> ()</td></tr>
<tr class="separator:a63c5cc73d85694103d8943b59e3c3fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a258bb5e560cf7595cda3c4906daa5f01" id="r_a258bb5e560cf7595cda3c4906daa5f01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a258bb5e560cf7595cda3c4906daa5f01">band_stop_obj</a> (wp, ind, passb, stopb, gpass, gstop, type)</td></tr>
<tr class="separator:a258bb5e560cf7595cda3c4906daa5f01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91da99d4aea5955bfa7a499a8e815bf4" id="r_a91da99d4aea5955bfa7a499a8e815bf4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a91da99d4aea5955bfa7a499a8e815bf4">buttord</a> (wp, ws, gpass, gstop, analog=False, fs=None)</td></tr>
<tr class="separator:a91da99d4aea5955bfa7a499a8e815bf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7faa130bd1b19c1b14542e764b6fe3c8" id="r_a7faa130bd1b19c1b14542e764b6fe3c8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a7faa130bd1b19c1b14542e764b6fe3c8">cheb1ord</a> (wp, ws, gpass, gstop, analog=False, fs=None)</td></tr>
<tr class="separator:a7faa130bd1b19c1b14542e764b6fe3c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa28a525115653cfbb7fa47769345631" id="r_afa28a525115653cfbb7fa47769345631"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#afa28a525115653cfbb7fa47769345631">cheb2ord</a> (wp, ws, gpass, gstop, analog=False, fs=None)</td></tr>
<tr class="separator:afa28a525115653cfbb7fa47769345631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29fbb90ffea114a412f2f43b81f4a00c" id="r_a29fbb90ffea114a412f2f43b81f4a00c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a29fbb90ffea114a412f2f43b81f4a00c">_pow10m1</a> (x)</td></tr>
<tr class="separator:a29fbb90ffea114a412f2f43b81f4a00c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef9f4f8f06e8223d397899d35ee6772" id="r_a6ef9f4f8f06e8223d397899d35ee6772"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a6ef9f4f8f06e8223d397899d35ee6772">ellipord</a> (wp, ws, gpass, gstop, analog=False, fs=None)</td></tr>
<tr class="separator:a6ef9f4f8f06e8223d397899d35ee6772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb3d2394285c25575e31ab79e78633c" id="r_accb3d2394285c25575e31ab79e78633c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#accb3d2394285c25575e31ab79e78633c">buttap</a> (N)</td></tr>
<tr class="separator:accb3d2394285c25575e31ab79e78633c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bff6c7f370bc3d69ca665c99c72b991" id="r_a8bff6c7f370bc3d69ca665c99c72b991"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a8bff6c7f370bc3d69ca665c99c72b991">cheb1ap</a> (N, rp)</td></tr>
<tr class="separator:a8bff6c7f370bc3d69ca665c99c72b991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85604d994461d93b66688f46e2274e01" id="r_a85604d994461d93b66688f46e2274e01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a85604d994461d93b66688f46e2274e01">cheb2ap</a> (N, rs)</td></tr>
<tr class="separator:a85604d994461d93b66688f46e2274e01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea1a91e31a980a583aea106301c3af7" id="r_adea1a91e31a980a583aea106301c3af7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#adea1a91e31a980a583aea106301c3af7">_ellipdeg</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, m1)</td></tr>
<tr class="separator:adea1a91e31a980a583aea106301c3af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79130ea20d907c20de2133fa36a8b2b4" id="r_a79130ea20d907c20de2133fa36a8b2b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a79130ea20d907c20de2133fa36a8b2b4">_arc_jac_sn</a> (<a class="el" href="__lapack__subroutines_8h.html#a817b85d82af73ef273fafbec623bb90b">w</a>, m)</td></tr>
<tr class="separator:a79130ea20d907c20de2133fa36a8b2b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc92d81e1dcd3827ea2a5a35dd9d9dbd" id="r_adc92d81e1dcd3827ea2a5a35dd9d9dbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#adc92d81e1dcd3827ea2a5a35dd9d9dbd">_arc_jac_sc1</a> (<a class="el" href="__lapack__subroutines_8h.html#a817b85d82af73ef273fafbec623bb90b">w</a>, m)</td></tr>
<tr class="separator:adc92d81e1dcd3827ea2a5a35dd9d9dbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23f21ad85d8274746e8029345a2d6dd2" id="r_a23f21ad85d8274746e8029345a2d6dd2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a23f21ad85d8274746e8029345a2d6dd2">ellipap</a> (N, rp, rs)</td></tr>
<tr class="separator:a23f21ad85d8274746e8029345a2d6dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a430d6e30bd79c1ac8415b1b3a86920ca" id="r_a430d6e30bd79c1ac8415b1b3a86920ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a430d6e30bd79c1ac8415b1b3a86920ca">_falling_factorial</a> (x, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a430d6e30bd79c1ac8415b1b3a86920ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac558291278a8e0c181a04544633535e9" id="r_ac558291278a8e0c181a04544633535e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ac558291278a8e0c181a04544633535e9">_bessel_poly</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, reverse=False)</td></tr>
<tr class="separator:ac558291278a8e0c181a04544633535e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f4c3649aa3f992a5fce219262b6b86b" id="r_a1f4c3649aa3f992a5fce219262b6b86b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a1f4c3649aa3f992a5fce219262b6b86b">_campos_zeros</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a1f4c3649aa3f992a5fce219262b6b86b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3e35a28f953cc535b8338a3d16e42b" id="r_a7b3e35a28f953cc535b8338a3d16e42b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a7b3e35a28f953cc535b8338a3d16e42b">_aberth</a> (<a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, fp, x0, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-15, maxiter=50)</td></tr>
<tr class="separator:a7b3e35a28f953cc535b8338a3d16e42b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437956b9572826ca331e4c0145f478b3" id="r_a437956b9572826ca331e4c0145f478b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a437956b9572826ca331e4c0145f478b3">_bessel_zeros</a> (N)</td></tr>
<tr class="separator:a437956b9572826ca331e4c0145f478b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af24f2b004da00e3d84426d2f1b70507c" id="r_af24f2b004da00e3d84426d2f1b70507c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#af24f2b004da00e3d84426d2f1b70507c">_norm_factor</a> (p, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>)</td></tr>
<tr class="separator:af24f2b004da00e3d84426d2f1b70507c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9494ea841106ba6e20f525f6782efb38" id="r_a9494ea841106ba6e20f525f6782efb38"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a9494ea841106ba6e20f525f6782efb38">besselap</a> (N, norm='phase')</td></tr>
<tr class="separator:a9494ea841106ba6e20f525f6782efb38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad597e2eb48ee608991d13e408bf5873e" id="r_ad597e2eb48ee608991d13e408bf5873e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ad597e2eb48ee608991d13e408bf5873e">iirnotch</a> (w0, Q, fs=2.0)</td></tr>
<tr class="separator:ad597e2eb48ee608991d13e408bf5873e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af928a310a30876eb852f6ef0ee25ac02" id="r_af928a310a30876eb852f6ef0ee25ac02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#af928a310a30876eb852f6ef0ee25ac02">iirpeak</a> (w0, Q, fs=2.0)</td></tr>
<tr class="separator:af928a310a30876eb852f6ef0ee25ac02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac21026656dadfc0ee99dc0ff88d716" id="r_a5ac21026656dadfc0ee99dc0ff88d716"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a5ac21026656dadfc0ee99dc0ff88d716">_design_notch_peak_filter</a> (w0, Q, ftype, fs=2.0)</td></tr>
<tr class="separator:a5ac21026656dadfc0ee99dc0ff88d716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc3e3e67171ad300aefe7d122abd9e96" id="r_abc3e3e67171ad300aefe7d122abd9e96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#abc3e3e67171ad300aefe7d122abd9e96">iircomb</a> (w0, Q, ftype='notch', fs=2.0, *pass_zero=False)</td></tr>
<tr class="separator:abc3e3e67171ad300aefe7d122abd9e96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adce4c3f0ff53976dd442626172326b1e" id="r_adce4c3f0ff53976dd442626172326b1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#adce4c3f0ff53976dd442626172326b1e">_hz_to_erb</a> (hz)</td></tr>
<tr class="separator:adce4c3f0ff53976dd442626172326b1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95698a45f8565d76ba5a43d77120ac9c" id="r_a95698a45f8565d76ba5a43d77120ac9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a95698a45f8565d76ba5a43d77120ac9c">gammatone</a> (freq, ftype, <a class="el" href="__lapack__subroutines_8h.html#a9993259f1ab17738593f079acd0507d9">order</a>=None, numtaps=None, fs=None)</td></tr>
<tr class="separator:a95698a45f8565d76ba5a43d77120ac9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae0755694c5f3c0fd7ffccc146d000962" id="r_ae0755694c5f3c0fd7ffccc146d000962"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#ae0755694c5f3c0fd7ffccc146d000962">abs</a> = absolute</td></tr>
<tr class="separator:ae0755694c5f3c0fd7ffccc146d000962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ecc62801ca1a598f57e1e89c3f862a" id="r_a76ecc62801ca1a598f57e1e89c3f862a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a76ecc62801ca1a598f57e1e89c3f862a">_POW10_LOG10</a> = np.log(10)</td></tr>
<tr class="separator:a76ecc62801ca1a598f57e1e89c3f862a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6345627611c9584ab49581b89d6133e3" id="r_a6345627611c9584ab49581b89d6133e3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a6345627611c9584ab49581b89d6133e3">EPSILON</a> = 2e-16</td></tr>
<tr class="separator:a6345627611c9584ab49581b89d6133e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2488f153d8ae94e3316797a1661dbb30" id="r_a2488f153d8ae94e3316797a1661dbb30"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a2488f153d8ae94e3316797a1661dbb30">_ELLIPDEG_MMAX</a> = 7</td></tr>
<tr class="separator:a2488f153d8ae94e3316797a1661dbb30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7652e5119bd8574ea5fb53c49d2cd3f9" id="r_a7652e5119bd8574ea5fb53c49d2cd3f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a7652e5119bd8574ea5fb53c49d2cd3f9">_ARC_JAC_SN_MAXITER</a> = 10</td></tr>
<tr class="separator:a7652e5119bd8574ea5fb53c49d2cd3f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1997d304fd4096c170a317286c5ddefc" id="r_a1997d304fd4096c170a317286c5ddefc"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a1997d304fd4096c170a317286c5ddefc">filter_dict</a></td></tr>
<tr class="separator:a1997d304fd4096c170a317286c5ddefc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f2e025a5a7ab98adda5a652673c1c95" id="r_a9f2e025a5a7ab98adda5a652673c1c95"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a9f2e025a5a7ab98adda5a652673c1c95">band_dict</a></td></tr>
<tr class="separator:a9f2e025a5a7ab98adda5a652673c1c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af27e4e2de443cd81d20e5da16eeae926" id="r_af27e4e2de443cd81d20e5da16eeae926"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#af27e4e2de443cd81d20e5da16eeae926">bessel_norms</a></td></tr>
<tr class="separator:af27e4e2de443cd81d20e5da16eeae926"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Filter design.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a7b3e35a28f953cc535b8338a3d16e42b" name="a7b3e35a28f953cc535b8338a3d16e42b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b3e35a28f953cc535b8338a3d16e42b">&#9670;&#160;</a></span>_aberth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._aberth </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-15</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>50</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given a function `f`, its first derivative `fp`, and a set of initial
guesses `x0`, simultaneously find the roots of the polynomial using the
Aberth-Ehrlich method.

``len(x0)`` should equal the number of roots of `f`.

(This is not a complete implementation of Bini's algorithm.)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 4664</span><span class="keyword">def </span>_aberth(f, fp, x0, tol=1e-15, maxiter=50):</div>
<div class="line"><span class="lineno"> 4665</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4666</span><span class="stringliteral">    Given a function `f`, its first derivative `fp`, and a set of initial</span></div>
<div class="line"><span class="lineno"> 4667</span><span class="stringliteral">    guesses `x0`, simultaneously find the roots of the polynomial using the</span></div>
<div class="line"><span class="lineno"> 4668</span><span class="stringliteral">    Aberth-Ehrlich method.</span></div>
<div class="line"><span class="lineno"> 4669</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4670</span><span class="stringliteral">    ``len(x0)`` should equal the number of roots of `f`.</span></div>
<div class="line"><span class="lineno"> 4671</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4672</span><span class="stringliteral">    (This is not a complete implementation of Bini&#39;s algorithm.)</span></div>
<div class="line"><span class="lineno"> 4673</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4674</span> </div>
<div class="line"><span class="lineno"> 4675</span>    N = len(x0)</div>
<div class="line"><span class="lineno"> 4676</span> </div>
<div class="line"><span class="lineno"> 4677</span>    x = array(x0, complex)</div>
<div class="line"><span class="lineno"> 4678</span>    beta = np.empty_like(x0)</div>
<div class="line"><span class="lineno"> 4679</span> </div>
<div class="line"><span class="lineno"> 4680</span>    <span class="keywordflow">for</span> iteration <span class="keywordflow">in</span> range(maxiter):</div>
<div class="line"><span class="lineno"> 4681</span>        alpha = -<a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x) / fp(x)  <span class="comment"># Newton&#39;s method</span></div>
<div class="line"><span class="lineno"> 4682</span> </div>
<div class="line"><span class="lineno"> 4683</span>        <span class="comment"># Model &quot;repulsion&quot; between zeros</span></div>
<div class="line"><span class="lineno"> 4684</span>        <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(N):</div>
<div class="line"><span class="lineno"> 4685</span>            beta[k] = np.sum(1/(x[k] - x[k+1:]))</div>
<div class="line"><span class="lineno"> 4686</span>            beta[k] += np.sum(1/(x[k] - x[:k]))</div>
<div class="line"><span class="lineno"> 4687</span> </div>
<div class="line"><span class="lineno"> 4688</span>        x += alpha / (1 + alpha * beta)</div>
<div class="line"><span class="lineno"> 4689</span> </div>
<div class="line"><span class="lineno"> 4690</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> all(np.isfinite(x)):</div>
<div class="line"><span class="lineno"> 4691</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;Root-finding calculation failed&#39;</span>)</div>
<div class="line"><span class="lineno"> 4692</span> </div>
<div class="line"><span class="lineno"> 4693</span>        <span class="comment"># Mekwi: The iterative process can be stopped when |hn| has become</span></div>
<div class="line"><span class="lineno"> 4694</span>        <span class="comment"># less than the largest error one is willing to permit in the root.</span></div>
<div class="line"><span class="lineno"> 4695</span>        <span class="keywordflow">if</span> all(abs(alpha) &lt;= tol):</div>
<div class="line"><span class="lineno"> 4696</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 4697</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4698</span>        <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&#39;Zeros failed to converge&#39;</span>)</div>
<div class="line"><span class="lineno"> 4699</span> </div>
<div class="line"><span class="lineno"> 4700</span>    <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno"> 4701</span> </div>
<div class="line"><span class="lineno"> 4702</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f786c9911a15f0727e21552a6d027e1" name="a2f786c9911a15f0727e21552a6d027e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f786c9911a15f0727e21552a6d027e1">&#9670;&#160;</a></span>_align_nums()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._align_nums </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nums</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Aligns the shapes of multiple numerators.

Given an array of numerator coefficient arrays [[a_1, a_2,...,
a_n],..., [b_1, b_2,..., b_m]], this function pads shorter numerator
arrays with zero's so that all numerators have the same length. Such
alignment is necessary for functions like 'tf2ss', which needs the
alignment when dealing with SIMO transfer functions.

Parameters
----------
nums: array_like
    Numerator or list of numerators. Not necessarily with same length.

Returns
-------
nums: array
    The numerator. If `nums` input was a list of numerators then a 2-D
    array with padded zeros for shorter numerators is returned. Otherwise
    returns ``np.asarray(nums)``.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1606</span><span class="keyword">def </span>_align_nums(nums):</div>
<div class="line"><span class="lineno"> 1607</span>    <span class="stringliteral">&quot;&quot;&quot;Aligns the shapes of multiple numerators.</span></div>
<div class="line"><span class="lineno"> 1608</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1609</span><span class="stringliteral">    Given an array of numerator coefficient arrays [[a_1, a_2,...,</span></div>
<div class="line"><span class="lineno"> 1610</span><span class="stringliteral">    a_n],..., [b_1, b_2,..., b_m]], this function pads shorter numerator</span></div>
<div class="line"><span class="lineno"> 1611</span><span class="stringliteral">    arrays with zero&#39;s so that all numerators have the same length. Such</span></div>
<div class="line"><span class="lineno"> 1612</span><span class="stringliteral">    alignment is necessary for functions like &#39;tf2ss&#39;, which needs the</span></div>
<div class="line"><span class="lineno"> 1613</span><span class="stringliteral">    alignment when dealing with SIMO transfer functions.</span></div>
<div class="line"><span class="lineno"> 1614</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1615</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1616</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1617</span><span class="stringliteral">    nums: array_like</span></div>
<div class="line"><span class="lineno"> 1618</span><span class="stringliteral">        Numerator or list of numerators. Not necessarily with same length.</span></div>
<div class="line"><span class="lineno"> 1619</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1620</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1621</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1622</span><span class="stringliteral">    nums: array</span></div>
<div class="line"><span class="lineno"> 1623</span><span class="stringliteral">        The numerator. If `nums` input was a list of numerators then a 2-D</span></div>
<div class="line"><span class="lineno"> 1624</span><span class="stringliteral">        array with padded zeros for shorter numerators is returned. Otherwise</span></div>
<div class="line"><span class="lineno"> 1625</span><span class="stringliteral">        returns ``np.asarray(nums)``.</span></div>
<div class="line"><span class="lineno"> 1626</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1627</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1628</span>        <span class="comment"># The statement can throw a ValueError if one</span></div>
<div class="line"><span class="lineno"> 1629</span>        <span class="comment"># of the numerators is a single digit and another</span></div>
<div class="line"><span class="lineno"> 1630</span>        <span class="comment"># is array-like e.g. if nums = [5, [1, 2, 3]]</span></div>
<div class="line"><span class="lineno"> 1631</span>        nums = asarray(nums)</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.issubdtype(nums.dtype, np.number):</div>
<div class="line"><span class="lineno"> 1634</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;dtype of numerator is non-numeric&quot;</span>)</div>
<div class="line"><span class="lineno"> 1635</span> </div>
<div class="line"><span class="lineno"> 1636</span>        <span class="keywordflow">return</span> nums</div>
<div class="line"><span class="lineno"> 1637</span> </div>
<div class="line"><span class="lineno"> 1638</span>    <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno"> 1639</span>        nums = [np.atleast_1d(num) <span class="keywordflow">for</span> num <span class="keywordflow">in</span> nums]</div>
<div class="line"><span class="lineno"> 1640</span>        max_width = max(num.size <span class="keywordflow">for</span> num <span class="keywordflow">in</span> nums)</div>
<div class="line"><span class="lineno"> 1641</span> </div>
<div class="line"><span class="lineno"> 1642</span>        <span class="comment"># pre-allocate</span></div>
<div class="line"><span class="lineno"> 1643</span>        aligned_nums = np.zeros((len(nums), max_width))</div>
<div class="line"><span class="lineno"> 1644</span> </div>
<div class="line"><span class="lineno"> 1645</span>        <span class="comment"># Create numerators with padded zeros</span></div>
<div class="line"><span class="lineno"> 1646</span>        <span class="keywordflow">for</span> index, num <span class="keywordflow">in</span> enumerate(nums):</div>
<div class="line"><span class="lineno"> 1647</span>            aligned_nums[index, -num.size:] = num</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>        <span class="keywordflow">return</span> aligned_nums</div>
<div class="line"><span class="lineno"> 1650</span> </div>
<div class="line"><span class="lineno"> 1651</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adc92d81e1dcd3827ea2a5a35dd9d9dbd" name="adc92d81e1dcd3827ea2a5a35dd9d9dbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc92d81e1dcd3827ea2a5a35dd9d9dbd">&#9670;&#160;</a></span>_arc_jac_sc1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._arc_jac_sc1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Real inverse Jacobian sc, with complementary modulus

Solve for z in w = sc(z, 1-m)

w - real scalar

m - modulus

From [1], sc(z, m) = -i * sn(i * z, 1 - m)

References
----------
# noqa: E501
.. [1] https://functions.wolfram.com/EllipticFunctions/JacobiSC/introductions/JacobiPQs/ShowAll.html,
   "Representations through other Jacobi functions"</pre> <div class="fragment"><div class="line"><span class="lineno"> 4465</span><span class="keyword">def </span>_arc_jac_sc1(w, m):</div>
<div class="line"><span class="lineno"> 4466</span>    <span class="stringliteral">&quot;&quot;&quot;Real inverse Jacobian sc, with complementary modulus</span></div>
<div class="line"><span class="lineno"> 4467</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4468</span><span class="stringliteral">    Solve for z in w = sc(z, 1-m)</span></div>
<div class="line"><span class="lineno"> 4469</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4470</span><span class="stringliteral">    w - real scalar</span></div>
<div class="line"><span class="lineno"> 4471</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4472</span><span class="stringliteral">    m - modulus</span></div>
<div class="line"><span class="lineno"> 4473</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4474</span><span class="stringliteral">    From [1], sc(z, m) = -i * sn(i * z, 1 - m)</span></div>
<div class="line"><span class="lineno"> 4475</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4476</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 4477</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4478</span><span class="stringliteral">    # noqa: E501</span></div>
<div class="line"><span class="lineno"> 4479</span><span class="stringliteral">    .. [1] https://functions.wolfram.com/EllipticFunctions/JacobiSC/introductions/JacobiPQs/ShowAll.html,</span></div>
<div class="line"><span class="lineno"> 4480</span><span class="stringliteral">       &quot;Representations through other Jacobi functions&quot;</span></div>
<div class="line"><span class="lineno"> 4481</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4482</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4483</span> </div>
<div class="line"><span class="lineno"> 4484</span>    zcomplex = _arc_jac_sn(1j * w, m)</div>
<div class="line"><span class="lineno"> 4485</span>    <span class="keywordflow">if</span> abs(zcomplex.real) &gt; 1e-14:</div>
<div class="line"><span class="lineno"> 4486</span>        <span class="keywordflow">raise</span> ValueError</div>
<div class="line"><span class="lineno"> 4487</span> </div>
<div class="line"><span class="lineno"> 4488</span>    <span class="keywordflow">return</span> zcomplex.imag</div>
<div class="line"><span class="lineno"> 4489</span> </div>
<div class="line"><span class="lineno"> 4490</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a79130ea20d907c20de2133fa36a8b2b4" name="a79130ea20d907c20de2133fa36a8b2b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79130ea20d907c20de2133fa36a8b2b4">&#9670;&#160;</a></span>_arc_jac_sn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._arc_jac_sn </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Inverse Jacobian elliptic sn

Solve for z in w = sn(z, m)

Parameters
----------
w : complex scalar
    argument

m : scalar
    modulus; in interval [0, 1]


See [1], Eq. (56)

References
----------
.. [1] Orfanidis, "Lecture Notes on Elliptic Filter Design",
       https://www.ece.rutgers.edu/~orfanidi/ece521/notes.pdf</pre> <div class="fragment"><div class="line"><span class="lineno"> 4404</span><span class="keyword">def </span>_arc_jac_sn(w, m):</div>
<div class="line"><span class="lineno"> 4405</span>    <span class="stringliteral">&quot;&quot;&quot;Inverse Jacobian elliptic sn</span></div>
<div class="line"><span class="lineno"> 4406</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4407</span><span class="stringliteral">    Solve for z in w = sn(z, m)</span></div>
<div class="line"><span class="lineno"> 4408</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4409</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 4410</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4411</span><span class="stringliteral">    w : complex scalar</span></div>
<div class="line"><span class="lineno"> 4412</span><span class="stringliteral">        argument</span></div>
<div class="line"><span class="lineno"> 4413</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4414</span><span class="stringliteral">    m : scalar</span></div>
<div class="line"><span class="lineno"> 4415</span><span class="stringliteral">        modulus; in interval [0, 1]</span></div>
<div class="line"><span class="lineno"> 4416</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4417</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4418</span><span class="stringliteral">    See [1], Eq. (56)</span></div>
<div class="line"><span class="lineno"> 4419</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4420</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 4421</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4422</span><span class="stringliteral">    .. [1] Orfanidis, &quot;Lecture Notes on Elliptic Filter Design&quot;,</span></div>
<div class="line"><span class="lineno"> 4423</span><span class="stringliteral">           https://www.ece.rutgers.edu/~orfanidi/ece521/notes.pdf</span></div>
<div class="line"><span class="lineno"> 4424</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4425</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4426</span> </div>
<div class="line"><span class="lineno"> 4427</span>    <span class="keyword">def </span>_complement(kx):</div>
<div class="line"><span class="lineno"> 4428</span>        <span class="comment"># (1-k**2) ** 0.5; the expression below</span></div>
<div class="line"><span class="lineno"> 4429</span>        <span class="comment"># works for small kx</span></div>
<div class="line"><span class="lineno"> 4430</span>        <span class="keywordflow">return</span> ((1 - kx) * (1 + kx)) ** 0.5</div>
<div class="line"><span class="lineno"> 4431</span> </div>
<div class="line"><span class="lineno"> 4432</span>    k = m ** 0.5</div>
<div class="line"><span class="lineno"> 4433</span> </div>
<div class="line"><span class="lineno"> 4434</span>    <span class="keywordflow">if</span> k &gt; 1:</div>
<div class="line"><span class="lineno"> 4435</span>        <span class="keywordflow">return</span> np.nan</div>
<div class="line"><span class="lineno"> 4436</span>    <span class="keywordflow">elif</span> k == 1:</div>
<div class="line"><span class="lineno"> 4437</span>        <span class="keywordflow">return</span> np.arctanh(w)</div>
<div class="line"><span class="lineno"> 4438</span> </div>
<div class="line"><span class="lineno"> 4439</span>    ks = [k]</div>
<div class="line"><span class="lineno"> 4440</span>    niter = 0</div>
<div class="line"><span class="lineno"> 4441</span>    <span class="keywordflow">while</span> ks[-1] != 0:</div>
<div class="line"><span class="lineno"> 4442</span>        k_ = ks[-1]</div>
<div class="line"><span class="lineno"> 4443</span>        k_p = _complement(k_)</div>
<div class="line"><span class="lineno"> 4444</span>        ks.append((1 - k_p) / (1 + k_p))</div>
<div class="line"><span class="lineno"> 4445</span>        niter += 1</div>
<div class="line"><span class="lineno"> 4446</span>        <span class="keywordflow">if</span> niter &gt; _ARC_JAC_SN_MAXITER:</div>
<div class="line"><span class="lineno"> 4447</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Landen transformation not converging&#39;</span>)</div>
<div class="line"><span class="lineno"> 4448</span> </div>
<div class="line"><span class="lineno"> 4449</span>    K = np.product(1 + np.array(ks[1:])) * np.pi/2</div>
<div class="line"><span class="lineno"> 4450</span> </div>
<div class="line"><span class="lineno"> 4451</span>    wns = [w]</div>
<div class="line"><span class="lineno"> 4452</span> </div>
<div class="line"><span class="lineno"> 4453</span>    <span class="keywordflow">for</span> kn, knext <span class="keywordflow">in</span> zip(ks[:-1], ks[1:]):</div>
<div class="line"><span class="lineno"> 4454</span>        wn = wns[-1]</div>
<div class="line"><span class="lineno"> 4455</span>        wnext = (2 * wn /</div>
<div class="line"><span class="lineno"> 4456</span>                 ((1 + knext) * (1 + _complement(kn * wn))))</div>
<div class="line"><span class="lineno"> 4457</span>        wns.append(wnext)</div>
<div class="line"><span class="lineno"> 4458</span> </div>
<div class="line"><span class="lineno"> 4459</span>    u = 2 / np.pi * np.arcsin(wns[-1])</div>
<div class="line"><span class="lineno"> 4460</span> </div>
<div class="line"><span class="lineno"> 4461</span>    z = K * u</div>
<div class="line"><span class="lineno"> 4462</span>    <span class="keywordflow">return</span> z</div>
<div class="line"><span class="lineno"> 4463</span> </div>
<div class="line"><span class="lineno"> 4464</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac558291278a8e0c181a04544633535e9" name="ac558291278a8e0c181a04544633535e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac558291278a8e0c181a04544633535e9">&#9670;&#160;</a></span>_bessel_poly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._bessel_poly </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reverse</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return the coefficients of Bessel polynomial of degree `n`

If `reverse` is true, a reverse Bessel polynomial is output.

Output is a list of coefficients:
[1]                   = 1
[1,  1]               = 1*s   +  1
[1,  3,  3]           = 1*s^2 +  3*s   +  3
[1,  6, 15, 15]       = 1*s^3 +  6*s^2 + 15*s   +  15
[1, 10, 45, 105, 105] = 1*s^4 + 10*s^3 + 45*s^2 + 105*s + 105
etc.

Output is a Python list of arbitrary precision long ints, so n is only
limited by your hardware's memory.

Sequence is http://oeis.org/A001498, and output can be confirmed to
match http://oeis.org/A001498/b001498.txt :

&gt;&gt;&gt; i = 0
&gt;&gt;&gt; for n in range(51):
...     for x in _bessel_poly(n, reverse=True):
...         print(i, x)
...         i += 1</pre> <div class="fragment"><div class="line"><span class="lineno"> 4595</span><span class="keyword">def </span>_bessel_poly(n, reverse=False):</div>
<div class="line"><span class="lineno"> 4596</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4597</span><span class="stringliteral">    Return the coefficients of Bessel polynomial of degree `n`</span></div>
<div class="line"><span class="lineno"> 4598</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4599</span><span class="stringliteral">    If `reverse` is true, a reverse Bessel polynomial is output.</span></div>
<div class="line"><span class="lineno"> 4600</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4601</span><span class="stringliteral">    Output is a list of coefficients:</span></div>
<div class="line"><span class="lineno"> 4602</span><span class="stringliteral">    [1]                   = 1</span></div>
<div class="line"><span class="lineno"> 4603</span><span class="stringliteral">    [1,  1]               = 1*s   +  1</span></div>
<div class="line"><span class="lineno"> 4604</span><span class="stringliteral">    [1,  3,  3]           = 1*s^2 +  3*s   +  3</span></div>
<div class="line"><span class="lineno"> 4605</span><span class="stringliteral">    [1,  6, 15, 15]       = 1*s^3 +  6*s^2 + 15*s   +  15</span></div>
<div class="line"><span class="lineno"> 4606</span><span class="stringliteral">    [1, 10, 45, 105, 105] = 1*s^4 + 10*s^3 + 45*s^2 + 105*s + 105</span></div>
<div class="line"><span class="lineno"> 4607</span><span class="stringliteral">    etc.</span></div>
<div class="line"><span class="lineno"> 4608</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4609</span><span class="stringliteral">    Output is a Python list of arbitrary precision long ints, so n is only</span></div>
<div class="line"><span class="lineno"> 4610</span><span class="stringliteral">    limited by your hardware&#39;s memory.</span></div>
<div class="line"><span class="lineno"> 4611</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4612</span><span class="stringliteral">    Sequence is http://oeis.org/A001498, and output can be confirmed to</span></div>
<div class="line"><span class="lineno"> 4613</span><span class="stringliteral">    match http://oeis.org/A001498/b001498.txt :</span></div>
<div class="line"><span class="lineno"> 4614</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4615</span><span class="stringliteral">    &gt;&gt;&gt; i = 0</span></div>
<div class="line"><span class="lineno"> 4616</span><span class="stringliteral">    &gt;&gt;&gt; for n in range(51):</span></div>
<div class="line"><span class="lineno"> 4617</span><span class="stringliteral">    ...     for x in _bessel_poly(n, reverse=True):</span></div>
<div class="line"><span class="lineno"> 4618</span><span class="stringliteral">    ...         print(i, x)</span></div>
<div class="line"><span class="lineno"> 4619</span><span class="stringliteral">    ...         i += 1</span></div>
<div class="line"><span class="lineno"> 4620</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4621</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4622</span>    <span class="keywordflow">if</span> abs(int(n)) != n:</div>
<div class="line"><span class="lineno"> 4623</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Polynomial order must be a nonnegative integer&quot;</span>)</div>
<div class="line"><span class="lineno"> 4624</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4625</span>        n = int(n)  <span class="comment"># np.int32 doesn&#39;t work, for instance</span></div>
<div class="line"><span class="lineno"> 4626</span> </div>
<div class="line"><span class="lineno"> 4627</span>    out = []</div>
<div class="line"><span class="lineno"> 4628</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(n + 1):</div>
<div class="line"><span class="lineno"> 4629</span>        num = _falling_factorial(2*n - k, n)</div>
<div class="line"><span class="lineno"> 4630</span>        den = 2**(n - k) * math.factorial(k)</div>
<div class="line"><span class="lineno"> 4631</span>        out.append(num // den)</div>
<div class="line"><span class="lineno"> 4632</span> </div>
<div class="line"><span class="lineno"> 4633</span>    <span class="keywordflow">if</span> reverse:</div>
<div class="line"><span class="lineno"> 4634</span>        <span class="keywordflow">return</span> out[::-1]</div>
<div class="line"><span class="lineno"> 4635</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4636</span>        <span class="keywordflow">return</span> out</div>
<div class="line"><span class="lineno"> 4637</span> </div>
<div class="line"><span class="lineno"> 4638</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a437956b9572826ca331e4c0145f478b3" name="a437956b9572826ca331e4c0145f478b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437956b9572826ca331e4c0145f478b3">&#9670;&#160;</a></span>_bessel_zeros()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._bessel_zeros </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Find zeros of ordinary Bessel polynomial of order `N`, by root-finding of
modified Bessel function of the second kind
</pre> <div class="fragment"><div class="line"><span class="lineno"> 4703</span><span class="keyword">def </span>_bessel_zeros(N):</div>
<div class="line"><span class="lineno"> 4704</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4705</span><span class="stringliteral">    Find zeros of ordinary Bessel polynomial of order `N`, by root-finding of</span></div>
<div class="line"><span class="lineno"> 4706</span><span class="stringliteral">    modified Bessel function of the second kind</span></div>
<div class="line"><span class="lineno"> 4707</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4708</span>    <span class="keywordflow">if</span> N == 0:</div>
<div class="line"><span class="lineno"> 4709</span>        <span class="keywordflow">return</span> asarray([])</div>
<div class="line"><span class="lineno"> 4710</span> </div>
<div class="line"><span class="lineno"> 4711</span>    <span class="comment"># Generate starting points</span></div>
<div class="line"><span class="lineno"> 4712</span>    x0 = _campos_zeros(N)</div>
<div class="line"><span class="lineno"> 4713</span> </div>
<div class="line"><span class="lineno"> 4714</span>    <span class="comment"># Zeros are the same for exp(1/x)*K_{N+0.5}(1/x) and Nth-order ordinary</span></div>
<div class="line"><span class="lineno"> 4715</span>    <span class="comment"># Bessel polynomial y_N(x)</span></div>
<div class="line"><span class="lineno"> 4716</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x):</div>
<div class="line"><span class="lineno"> 4717</span>        <span class="keywordflow">return</span> special.kve(N+0.5, 1/x)</div>
<div class="line"><span class="lineno"> 4718</span> </div>
<div class="line"><span class="lineno"> 4719</span>    <span class="comment"># First derivative of above</span></div>
<div class="line"><span class="lineno"> 4720</span>    <span class="keyword">def </span>fp(x):</div>
<div class="line"><span class="lineno"> 4721</span>        <span class="keywordflow">return</span> (special.kve(N-0.5, 1/x)/(2*x**2) -</div>
<div class="line"><span class="lineno"> 4722</span>                special.kve(N+0.5, 1/x)/(x**2) +</div>
<div class="line"><span class="lineno"> 4723</span>                special.kve(N+1.5, 1/x)/(2*x**2))</div>
<div class="line"><span class="lineno"> 4724</span> </div>
<div class="line"><span class="lineno"> 4725</span>    <span class="comment"># Starting points converge to true zeros</span></div>
<div class="line"><span class="lineno"> 4726</span>    x = _aberth(f, fp, x0)</div>
<div class="line"><span class="lineno"> 4727</span> </div>
<div class="line"><span class="lineno"> 4728</span>    <span class="comment"># Improve precision using Newton&#39;s method on each</span></div>
<div class="line"><span class="lineno"> 4729</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(x)):</div>
<div class="line"><span class="lineno"> 4730</span>        x[i] = optimize.newton(f, x[i], fp, tol=1e-15)</div>
<div class="line"><span class="lineno"> 4731</span> </div>
<div class="line"><span class="lineno"> 4732</span>    <span class="comment"># Average complex conjugates to make them exactly symmetrical</span></div>
<div class="line"><span class="lineno"> 4733</span>    x = np.mean((x, x[::-1].conj()), 0)</div>
<div class="line"><span class="lineno"> 4734</span> </div>
<div class="line"><span class="lineno"> 4735</span>    <span class="comment"># Zeros should sum to -1</span></div>
<div class="line"><span class="lineno"> 4736</span>    <span class="keywordflow">if</span> abs(np.sum(x) + 1) &gt; 1e-15:</div>
<div class="line"><span class="lineno"> 4737</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;Generated zeros are inaccurate&#39;</span>)</div>
<div class="line"><span class="lineno"> 4738</span> </div>
<div class="line"><span class="lineno"> 4739</span>    <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno"> 4740</span> </div>
<div class="line"><span class="lineno"> 4741</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f4c3649aa3f992a5fce219262b6b86b" name="a1f4c3649aa3f992a5fce219262b6b86b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f4c3649aa3f992a5fce219262b6b86b">&#9670;&#160;</a></span>_campos_zeros()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._campos_zeros </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return approximate zero locations of Bessel polynomials y_n(x) for order
`n` using polynomial fit (Campos-Calderon 2011)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 4639</span><span class="keyword">def </span>_campos_zeros(n):</div>
<div class="line"><span class="lineno"> 4640</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4641</span><span class="stringliteral">    Return approximate zero locations of Bessel polynomials y_n(x) for order</span></div>
<div class="line"><span class="lineno"> 4642</span><span class="stringliteral">    `n` using polynomial fit (Campos-Calderon 2011)</span></div>
<div class="line"><span class="lineno"> 4643</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4644</span>    <span class="keywordflow">if</span> n == 1:</div>
<div class="line"><span class="lineno"> 4645</span>        <span class="keywordflow">return</span> asarray([-1+0j])</div>
<div class="line"><span class="lineno"> 4646</span> </div>
<div class="line"><span class="lineno"> 4647</span>    s = npp_polyval(n, [0, 0, 2, 0, -3, 1])</div>
<div class="line"><span class="lineno"> 4648</span>    b3 = npp_polyval(n, [16, -8]) / s</div>
<div class="line"><span class="lineno"> 4649</span>    b2 = npp_polyval(n, [-24, -12, 12]) / s</div>
<div class="line"><span class="lineno"> 4650</span>    b1 = npp_polyval(n, [8, 24, -12, -2]) / s</div>
<div class="line"><span class="lineno"> 4651</span>    b0 = npp_polyval(n, [0, -6, 0, 5, -1]) / s</div>
<div class="line"><span class="lineno"> 4652</span> </div>
<div class="line"><span class="lineno"> 4653</span>    r = npp_polyval(n, [0, 0, 2, 1])</div>
<div class="line"><span class="lineno"> 4654</span>    a1 = npp_polyval(n, [-6, -6]) / r</div>
<div class="line"><span class="lineno"> 4655</span>    a2 = 6 / r</div>
<div class="line"><span class="lineno"> 4656</span> </div>
<div class="line"><span class="lineno"> 4657</span>    k = np.arange(1, n+1)</div>
<div class="line"><span class="lineno"> 4658</span>    x = npp_polyval(k, [0, a1, a2])</div>
<div class="line"><span class="lineno"> 4659</span>    y = npp_polyval(k, [b0, b1, b2, b3])</div>
<div class="line"><span class="lineno"> 4660</span> </div>
<div class="line"><span class="lineno"> 4661</span>    <span class="keywordflow">return</span> x + 1j*y</div>
<div class="line"><span class="lineno"> 4662</span> </div>
<div class="line"><span class="lineno"> 4663</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2aed3d7c4622770e66245baa67139fbe" name="a2aed3d7c4622770e66245baa67139fbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aed3d7c4622770e66245baa67139fbe">&#9670;&#160;</a></span>_cplxpair()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._cplxpair </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Sort into pairs of complex conjugates.

Complex conjugates in `z` are sorted by increasing real part. In each
pair, the number with negative imaginary part appears first.

If pairs have identical real parts, they are sorted by increasing
imaginary magnitude.

Two complex numbers are considered a conjugate pair if their real and
imaginary parts differ in magnitude by less than ``tol * abs(z)``.  The
pairs are forced to be exact complex conjugates by averaging the positive
and negative values.

Purely real numbers are also sorted, but placed after the complex
conjugate pairs. A number is considered real if its imaginary part is
smaller than `tol` times the magnitude of the number.

Parameters
----------
z : array_like
    1-D input array to be sorted.
tol : float, optional
    Relative tolerance for testing realness and conjugate equality.
    Default is ``100 * spacing(1)`` of `z`'s data type (i.e., 2e-14 for
    float64)

Returns
-------
y : ndarray
    Complex conjugate pairs followed by real numbers.

Raises
------
ValueError
    If there are any complex numbers in `z` for which a conjugate
    cannot be found.

See Also
--------
_cplxreal

Examples
--------
&gt;&gt;&gt; a = [4, 3, 1, 2-2j, 2+2j, 2-1j, 2+1j, 2-1j, 2+1j, 1+1j, 1-1j]
&gt;&gt;&gt; z = _cplxpair(a)
&gt;&gt;&gt; print(z)
[ 1.-1.j  1.+1.j  2.-1.j  2.+1.j  2.-1.j  2.+1.j  2.-2.j  2.+2.j  1.+0.j
  3.+0.j  4.+0.j]
</pre> <div class="fragment"><div class="line"><span class="lineno">  950</span><span class="keyword">def </span>_cplxpair(z, tol=None):</div>
<div class="line"><span class="lineno">  951</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">    Sort into pairs of complex conjugates.</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">    Complex conjugates in `z` are sorted by increasing real part. In each</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">    pair, the number with negative imaginary part appears first.</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">    If pairs have identical real parts, they are sorted by increasing</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">    imaginary magnitude.</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    Two complex numbers are considered a conjugate pair if their real and</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">    imaginary parts differ in magnitude by less than ``tol * abs(z)``.  The</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">    pairs are forced to be exact complex conjugates by averaging the positive</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">    and negative values.</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral">    Purely real numbers are also sorted, but placed after the complex</span></div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">    conjugate pairs. A number is considered real if its imaginary part is</span></div>
<div class="line"><span class="lineno">  967</span><span class="stringliteral">    smaller than `tol` times the magnitude of the number.</span></div>
<div class="line"><span class="lineno">  968</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  969</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral">        1-D input array to be sorted.</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">    tol : float, optional</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">        Relative tolerance for testing realness and conjugate equality.</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">        Default is ``100 * spacing(1)`` of `z`&#39;s data type (i.e., 2e-14 for</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">        float64)</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">    y : ndarray</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">        Complex conjugate pairs followed by real numbers.</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">    ValueError</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral">        If there are any complex numbers in `z` for which a conjugate</span></div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">        cannot be found.</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral">    _cplxreal</span></div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral">    &gt;&gt;&gt; a = [4, 3, 1, 2-2j, 2+2j, 2-1j, 2+1j, 2-1j, 2+1j, 1+1j, 1-1j]</span></div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">    &gt;&gt;&gt; z = _cplxpair(a)</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral">    &gt;&gt;&gt; print(z)</span></div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">    [ 1.-1.j  1.+1.j  2.-1.j  2.+1.j  2.-1.j  2.+1.j  2.-2.j  2.+2.j  1.+0.j</span></div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">      3.+0.j  4.+0.j]</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1001</span> </div>
<div class="line"><span class="lineno"> 1002</span>    z = atleast_1d(z)</div>
<div class="line"><span class="lineno"> 1003</span>    <span class="keywordflow">if</span> z.size == 0 <span class="keywordflow">or</span> np.isrealobj(z):</div>
<div class="line"><span class="lineno"> 1004</span>        <span class="keywordflow">return</span> np.sort(z)</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>    <span class="keywordflow">if</span> z.ndim != 1:</div>
<div class="line"><span class="lineno"> 1007</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;z must be 1-D&#39;</span>)</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span>    zc, zr = _cplxreal(z, tol)</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>    <span class="comment"># Interleave complex values and their conjugates, with negative imaginary</span></div>
<div class="line"><span class="lineno"> 1012</span>    <span class="comment"># parts first in each pair</span></div>
<div class="line"><span class="lineno"> 1013</span>    zc = np.dstack((zc.conj(), zc)).flatten()</div>
<div class="line"><span class="lineno"> 1014</span>    z = np.append(zc, zr)</div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordflow">return</span> z</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a39cb8fff9a90d19a81ee134d1ee37ed4" name="a39cb8fff9a90d19a81ee134d1ee37ed4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39cb8fff9a90d19a81ee134d1ee37ed4">&#9670;&#160;</a></span>_cplxreal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._cplxreal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Split into complex and real parts, combining conjugate pairs.

The 1-D input vector `z` is split up into its complex (`zc`) and real (`zr`)
elements. Every complex element must be part of a complex-conjugate pair,
which are combined into a single number (with positive imaginary part) in
the output. Two complex numbers are considered a conjugate pair if their
real and imaginary parts differ in magnitude by less than ``tol * abs(z)``.

Parameters
----------
z : array_like
    Vector of complex numbers to be sorted and split
tol : float, optional
    Relative tolerance for testing realness and conjugate equality.
    Default is ``100 * spacing(1)`` of `z`'s data type (i.e., 2e-14 for
    float64)

Returns
-------
zc : ndarray
    Complex elements of `z`, with each pair represented by a single value
    having positive imaginary part, sorted first by real part, and then
    by magnitude of imaginary part. The pairs are averaged when combined
    to reduce error.
zr : ndarray
    Real elements of `z` (those having imaginary part less than
    `tol` times their magnitude), sorted by value.

Raises
------
ValueError
    If there are any complex numbers in `z` for which a conjugate
    cannot be found.

See Also
--------
_cplxpair

Examples
--------
&gt;&gt;&gt; a = [4, 3, 1, 2-2j, 2+2j, 2-1j, 2+1j, 2-1j, 2+1j, 1+1j, 1-1j]
&gt;&gt;&gt; zc, zr = _cplxreal(a)
&gt;&gt;&gt; print(zc)
[ 1.+1.j  2.+1.j  2.+1.j  2.+2.j]
&gt;&gt;&gt; print(zr)
[ 1.  3.  4.]
</pre> <div class="fragment"><div class="line"><span class="lineno">  846</span><span class="keyword">def </span>_cplxreal(z, tol=None):</div>
<div class="line"><span class="lineno">  847</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  848</span><span class="stringliteral">    Split into complex and real parts, combining conjugate pairs.</span></div>
<div class="line"><span class="lineno">  849</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  850</span><span class="stringliteral">    The 1-D input vector `z` is split up into its complex (`zc`) and real (`zr`)</span></div>
<div class="line"><span class="lineno">  851</span><span class="stringliteral">    elements. Every complex element must be part of a complex-conjugate pair,</span></div>
<div class="line"><span class="lineno">  852</span><span class="stringliteral">    which are combined into a single number (with positive imaginary part) in</span></div>
<div class="line"><span class="lineno">  853</span><span class="stringliteral">    the output. Two complex numbers are considered a conjugate pair if their</span></div>
<div class="line"><span class="lineno">  854</span><span class="stringliteral">    real and imaginary parts differ in magnitude by less than ``tol * abs(z)``.</span></div>
<div class="line"><span class="lineno">  855</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  856</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  857</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  858</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno">  859</span><span class="stringliteral">        Vector of complex numbers to be sorted and split</span></div>
<div class="line"><span class="lineno">  860</span><span class="stringliteral">    tol : float, optional</span></div>
<div class="line"><span class="lineno">  861</span><span class="stringliteral">        Relative tolerance for testing realness and conjugate equality.</span></div>
<div class="line"><span class="lineno">  862</span><span class="stringliteral">        Default is ``100 * spacing(1)`` of `z`&#39;s data type (i.e., 2e-14 for</span></div>
<div class="line"><span class="lineno">  863</span><span class="stringliteral">        float64)</span></div>
<div class="line"><span class="lineno">  864</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  865</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  866</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">    zc : ndarray</span></div>
<div class="line"><span class="lineno">  868</span><span class="stringliteral">        Complex elements of `z`, with each pair represented by a single value</span></div>
<div class="line"><span class="lineno">  869</span><span class="stringliteral">        having positive imaginary part, sorted first by real part, and then</span></div>
<div class="line"><span class="lineno">  870</span><span class="stringliteral">        by magnitude of imaginary part. The pairs are averaged when combined</span></div>
<div class="line"><span class="lineno">  871</span><span class="stringliteral">        to reduce error.</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral">    zr : ndarray</span></div>
<div class="line"><span class="lineno">  873</span><span class="stringliteral">        Real elements of `z` (those having imaginary part less than</span></div>
<div class="line"><span class="lineno">  874</span><span class="stringliteral">        `tol` times their magnitude), sorted by value.</span></div>
<div class="line"><span class="lineno">  875</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  876</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">  877</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">  878</span><span class="stringliteral">    ValueError</span></div>
<div class="line"><span class="lineno">  879</span><span class="stringliteral">        If there are any complex numbers in `z` for which a conjugate</span></div>
<div class="line"><span class="lineno">  880</span><span class="stringliteral">        cannot be found.</span></div>
<div class="line"><span class="lineno">  881</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  882</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  883</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  884</span><span class="stringliteral">    _cplxpair</span></div>
<div class="line"><span class="lineno">  885</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  886</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  887</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  888</span><span class="stringliteral">    &gt;&gt;&gt; a = [4, 3, 1, 2-2j, 2+2j, 2-1j, 2+1j, 2-1j, 2+1j, 1+1j, 1-1j]</span></div>
<div class="line"><span class="lineno">  889</span><span class="stringliteral">    &gt;&gt;&gt; zc, zr = _cplxreal(a)</span></div>
<div class="line"><span class="lineno">  890</span><span class="stringliteral">    &gt;&gt;&gt; print(zc)</span></div>
<div class="line"><span class="lineno">  891</span><span class="stringliteral">    [ 1.+1.j  2.+1.j  2.+1.j  2.+2.j]</span></div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral">    &gt;&gt;&gt; print(zr)</span></div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">    [ 1.  3.  4.]</span></div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>    z = atleast_1d(z)</div>
<div class="line"><span class="lineno">  897</span>    <span class="keywordflow">if</span> z.size == 0:</div>
<div class="line"><span class="lineno">  898</span>        <span class="keywordflow">return</span> z, z</div>
<div class="line"><span class="lineno">  899</span>    <span class="keywordflow">elif</span> z.ndim != 1:</div>
<div class="line"><span class="lineno">  900</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;_cplxreal only accepts 1-D input&#39;</span>)</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>    <span class="keywordflow">if</span> tol <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  903</span>        <span class="comment"># Get tolerance from dtype of input</span></div>
<div class="line"><span class="lineno">  904</span>        tol = 100 * np.finfo((1.0 * z).dtype).eps</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>    <span class="comment"># Sort by real part, magnitude of imaginary part (speed up further sorting)</span></div>
<div class="line"><span class="lineno">  907</span>    z = z[np.lexsort((abs(z.imag), z.real))]</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>    <span class="comment"># Split reals from conjugate pairs</span></div>
<div class="line"><span class="lineno">  910</span>    real_indices = abs(z.imag) &lt;= tol * abs(z)</div>
<div class="line"><span class="lineno">  911</span>    zr = z[real_indices].real</div>
<div class="line"><span class="lineno">  912</span> </div>
<div class="line"><span class="lineno">  913</span>    <span class="keywordflow">if</span> len(zr) == len(z):</div>
<div class="line"><span class="lineno">  914</span>        <span class="comment"># Input is entirely real</span></div>
<div class="line"><span class="lineno">  915</span>        <span class="keywordflow">return</span> array([]), zr</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>    <span class="comment"># Split positive and negative halves of conjugates</span></div>
<div class="line"><span class="lineno">  918</span>    z = z[~real_indices]</div>
<div class="line"><span class="lineno">  919</span>    zp = z[z.imag &gt; 0]</div>
<div class="line"><span class="lineno">  920</span>    zn = z[z.imag &lt; 0]</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>    <span class="keywordflow">if</span> len(zp) != len(zn):</div>
<div class="line"><span class="lineno">  923</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Array contains complex value with no matching &#39;</span></div>
<div class="line"><span class="lineno">  924</span>                         <span class="stringliteral">&#39;conjugate.&#39;</span>)</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span>    <span class="comment"># Find runs of (approximately) the same real part</span></div>
<div class="line"><span class="lineno">  927</span>    same_real = np.diff(zp.real) &lt;= tol * abs(zp[:-1])</div>
<div class="line"><span class="lineno">  928</span>    diffs = numpy.diff(concatenate(([0], same_real, [0])))</div>
<div class="line"><span class="lineno">  929</span>    run_starts = numpy.nonzero(diffs &gt; 0)[0]</div>
<div class="line"><span class="lineno">  930</span>    run_stops = numpy.nonzero(diffs &lt; 0)[0]</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>    <span class="comment"># Sort each run by their imaginary parts</span></div>
<div class="line"><span class="lineno">  933</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(run_starts)):</div>
<div class="line"><span class="lineno">  934</span>        start = run_starts[i]</div>
<div class="line"><span class="lineno">  935</span>        stop = run_stops[i] + 1</div>
<div class="line"><span class="lineno">  936</span>        <span class="keywordflow">for</span> chunk <span class="keywordflow">in</span> (zp[start:stop], zn[start:stop]):</div>
<div class="line"><span class="lineno">  937</span>            chunk[...] = chunk[np.lexsort([abs(chunk.imag)])]</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>    <span class="comment"># Check that negatives match positives</span></div>
<div class="line"><span class="lineno">  940</span>    <span class="keywordflow">if</span> any(abs(zp - zn.conj()) &gt; tol * abs(zn)):</div>
<div class="line"><span class="lineno">  941</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Array contains complex value with no matching &#39;</span></div>
<div class="line"><span class="lineno">  942</span>                         <span class="stringliteral">&#39;conjugate.&#39;</span>)</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>    <span class="comment"># Average out numerical inaccuracy in real vs imag parts of pairs</span></div>
<div class="line"><span class="lineno">  945</span>    zc = (zp + zn.conj()) / 2</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>    <span class="keywordflow">return</span> zc, zr</div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ac21026656dadfc0ee99dc0ff88d716" name="a5ac21026656dadfc0ee99dc0ff88d716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac21026656dadfc0ee99dc0ff88d716">&#9670;&#160;</a></span>_design_notch_peak_filter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._design_notch_peak_filter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>2.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Design notch or peak digital filter.

Parameters
----------
w0 : float
    Normalized frequency to remove from a signal. If `fs` is specified,
    this is in the same units as `fs`. By default, it is a normalized
    scalar that must satisfy  ``0 &lt; w0 &lt; 1``, with ``w0 = 1``
    corresponding to half of the sampling frequency.
Q : float
    Quality factor. Dimensionless parameter that characterizes
    notch filter -3 dB bandwidth ``bw`` relative to its center
    frequency, ``Q = w0/bw``.
ftype : str
    The type of IIR filter to design:

        - notch filter : ``notch``
        - peak filter  : ``peak``
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0:

Returns
-------
b, a : ndarray, ndarray
    Numerator (``b``) and denominator (``a``) polynomials
    of the IIR filter.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 5035</span><span class="keyword">def </span>_design_notch_peak_filter(w0, Q, ftype, fs=2.0):</div>
<div class="line"><span class="lineno"> 5036</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5037</span><span class="stringliteral">    Design notch or peak digital filter.</span></div>
<div class="line"><span class="lineno"> 5038</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5039</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 5040</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 5041</span><span class="stringliteral">    w0 : float</span></div>
<div class="line"><span class="lineno"> 5042</span><span class="stringliteral">        Normalized frequency to remove from a signal. If `fs` is specified,</span></div>
<div class="line"><span class="lineno"> 5043</span><span class="stringliteral">        this is in the same units as `fs`. By default, it is a normalized</span></div>
<div class="line"><span class="lineno"> 5044</span><span class="stringliteral">        scalar that must satisfy  ``0 &lt; w0 &lt; 1``, with ``w0 = 1``</span></div>
<div class="line"><span class="lineno"> 5045</span><span class="stringliteral">        corresponding to half of the sampling frequency.</span></div>
<div class="line"><span class="lineno"> 5046</span><span class="stringliteral">    Q : float</span></div>
<div class="line"><span class="lineno"> 5047</span><span class="stringliteral">        Quality factor. Dimensionless parameter that characterizes</span></div>
<div class="line"><span class="lineno"> 5048</span><span class="stringliteral">        notch filter -3 dB bandwidth ``bw`` relative to its center</span></div>
<div class="line"><span class="lineno"> 5049</span><span class="stringliteral">        frequency, ``Q = w0/bw``.</span></div>
<div class="line"><span class="lineno"> 5050</span><span class="stringliteral">    ftype : str</span></div>
<div class="line"><span class="lineno"> 5051</span><span class="stringliteral">        The type of IIR filter to design:</span></div>
<div class="line"><span class="lineno"> 5052</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5053</span><span class="stringliteral">            - notch filter : ``notch``</span></div>
<div class="line"><span class="lineno"> 5054</span><span class="stringliteral">            - peak filter  : ``peak``</span></div>
<div class="line"><span class="lineno"> 5055</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 5056</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 5057</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5058</span><span class="stringliteral">        .. versionadded:: 1.2.0:</span></div>
<div class="line"><span class="lineno"> 5059</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5060</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 5061</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 5062</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 5063</span><span class="stringliteral">        Numerator (``b``) and denominator (``a``) polynomials</span></div>
<div class="line"><span class="lineno"> 5064</span><span class="stringliteral">        of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 5065</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5066</span> </div>
<div class="line"><span class="lineno"> 5067</span>    <span class="comment"># Guarantee that the inputs are floats</span></div>
<div class="line"><span class="lineno"> 5068</span>    w0 = float(w0)</div>
<div class="line"><span class="lineno"> 5069</span>    Q = float(Q)</div>
<div class="line"><span class="lineno"> 5070</span>    w0 = 2*w0/fs</div>
<div class="line"><span class="lineno"> 5071</span> </div>
<div class="line"><span class="lineno"> 5072</span>    <span class="comment"># Checks if w0 is within the range</span></div>
<div class="line"><span class="lineno"> 5073</span>    <span class="keywordflow">if</span> w0 &gt; 1.0 <span class="keywordflow">or</span> w0 &lt; 0.0:</div>
<div class="line"><span class="lineno"> 5074</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;w0 should be such that 0 &lt; w0 &lt; 1&quot;</span>)</div>
<div class="line"><span class="lineno"> 5075</span> </div>
<div class="line"><span class="lineno"> 5076</span>    <span class="comment"># Get bandwidth</span></div>
<div class="line"><span class="lineno"> 5077</span>    bw = w0/Q</div>
<div class="line"><span class="lineno"> 5078</span> </div>
<div class="line"><span class="lineno"> 5079</span>    <span class="comment"># Normalize inputs</span></div>
<div class="line"><span class="lineno"> 5080</span>    bw = bw*np.pi</div>
<div class="line"><span class="lineno"> 5081</span>    w0 = w0*np.pi</div>
<div class="line"><span class="lineno"> 5082</span> </div>
<div class="line"><span class="lineno"> 5083</span>    <span class="comment"># Compute -3dB attenuation</span></div>
<div class="line"><span class="lineno"> 5084</span>    gb = 1/np.sqrt(2)</div>
<div class="line"><span class="lineno"> 5085</span> </div>
<div class="line"><span class="lineno"> 5086</span>    <span class="keywordflow">if</span> ftype == <span class="stringliteral">&quot;notch&quot;</span>:</div>
<div class="line"><span class="lineno"> 5087</span>        <span class="comment"># Compute beta: formula 11.3.4 (p.575) from reference [1]</span></div>
<div class="line"><span class="lineno"> 5088</span>        beta = (np.sqrt(1.0-gb**2.0)/gb)*np.tan(bw/2.0)</div>
<div class="line"><span class="lineno"> 5089</span>    <span class="keywordflow">elif</span> ftype == <span class="stringliteral">&quot;peak&quot;</span>:</div>
<div class="line"><span class="lineno"> 5090</span>        <span class="comment"># Compute beta: formula 11.3.19 (p.579) from reference [1]</span></div>
<div class="line"><span class="lineno"> 5091</span>        beta = (gb/np.sqrt(1.0-gb**2.0))*np.tan(bw/2.0)</div>
<div class="line"><span class="lineno"> 5092</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 5093</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unknown ftype.&quot;</span>)</div>
<div class="line"><span class="lineno"> 5094</span> </div>
<div class="line"><span class="lineno"> 5095</span>    <span class="comment"># Compute gain: formula 11.3.6 (p.575) from reference [1]</span></div>
<div class="line"><span class="lineno"> 5096</span>    gain = 1.0/(1.0+beta)</div>
<div class="line"><span class="lineno"> 5097</span> </div>
<div class="line"><span class="lineno"> 5098</span>    <span class="comment"># Compute numerator b and denominator a</span></div>
<div class="line"><span class="lineno"> 5099</span>    <span class="comment"># formulas 11.3.7 (p.575) and 11.3.21 (p.579)</span></div>
<div class="line"><span class="lineno"> 5100</span>    <span class="comment"># from reference [1]</span></div>
<div class="line"><span class="lineno"> 5101</span>    <span class="keywordflow">if</span> ftype == <span class="stringliteral">&quot;notch&quot;</span>:</div>
<div class="line"><span class="lineno"> 5102</span>        b = gain*np.array([1.0, -2.0*np.cos(w0), 1.0])</div>
<div class="line"><span class="lineno"> 5103</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 5104</span>        b = (1.0-gain)*np.array([1.0, 0.0, -1.0])</div>
<div class="line"><span class="lineno"> 5105</span>    a = np.array([1.0, -2.0*gain*np.cos(w0), (2.0*gain-1.0)])</div>
<div class="line"><span class="lineno"> 5106</span> </div>
<div class="line"><span class="lineno"> 5107</span>    <span class="keywordflow">return</span> b, a</div>
<div class="line"><span class="lineno"> 5108</span> </div>
<div class="line"><span class="lineno"> 5109</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adea1a91e31a980a583aea106301c3af7" name="adea1a91e31a980a583aea106301c3af7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea1a91e31a980a583aea106301c3af7">&#9670;&#160;</a></span>_ellipdeg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._ellipdeg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Solve degree equation using nomes

Given n, m1, solve
   n * K(m) / K'(m) = K1(m1) / K1'(m1)
for m

See [1], Eq. (49)

References
----------
.. [1] Orfanidis, "Lecture Notes on Elliptic Filter Design",
       https://www.ece.rutgers.edu/~orfanidi/ece521/notes.pdf
</pre> <div class="fragment"><div class="line"><span class="lineno"> 4370</span><span class="keyword">def </span>_ellipdeg(n, m1):</div>
<div class="line"><span class="lineno"> 4371</span>    <span class="stringliteral">&quot;&quot;&quot;Solve degree equation using nomes</span></div>
<div class="line"><span class="lineno"> 4372</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4373</span><span class="stringliteral">    Given n, m1, solve</span></div>
<div class="line"><span class="lineno"> 4374</span><span class="stringliteral">       n * K(m) / K&#39;(m) = K1(m1) / K1&#39;(m1)</span></div>
<div class="line"><span class="lineno"> 4375</span><span class="stringliteral">    for m</span></div>
<div class="line"><span class="lineno"> 4376</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4377</span><span class="stringliteral">    See [1], Eq. (49)</span></div>
<div class="line"><span class="lineno"> 4378</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4379</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 4380</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4381</span><span class="stringliteral">    .. [1] Orfanidis, &quot;Lecture Notes on Elliptic Filter Design&quot;,</span></div>
<div class="line"><span class="lineno"> 4382</span><span class="stringliteral">           https://www.ece.rutgers.edu/~orfanidi/ece521/notes.pdf</span></div>
<div class="line"><span class="lineno"> 4383</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4384</span>    K1 = special.ellipk(m1)</div>
<div class="line"><span class="lineno"> 4385</span>    K1p = special.ellipkm1(m1)</div>
<div class="line"><span class="lineno"> 4386</span> </div>
<div class="line"><span class="lineno"> 4387</span>    q1 = np.exp(-np.pi * K1p / K1)</div>
<div class="line"><span class="lineno"> 4388</span>    q = q1 ** (1/n)</div>
<div class="line"><span class="lineno"> 4389</span> </div>
<div class="line"><span class="lineno"> 4390</span>    mnum = np.arange(_ELLIPDEG_MMAX + 1)</div>
<div class="line"><span class="lineno"> 4391</span>    mden = np.arange(1, _ELLIPDEG_MMAX + 2)</div>
<div class="line"><span class="lineno"> 4392</span> </div>
<div class="line"><span class="lineno"> 4393</span>    num = np.sum(q ** (mnum * (mnum+1)))</div>
<div class="line"><span class="lineno"> 4394</span>    den = 1 + 2 * np.sum(q ** (mden**2))</div>
<div class="line"><span class="lineno"> 4395</span> </div>
<div class="line"><span class="lineno"> 4396</span>    <span class="keywordflow">return</span> 16 * q * (num / den) ** 4</div>
<div class="line"><span class="lineno"> 4397</span> </div>
<div class="line"><span class="lineno"> 4398</span> </div>
<div class="line"><span class="lineno"> 4399</span><span class="comment"># Maximum number of iterations in Landen transformation recursion</span></div>
<div class="line"><span class="lineno"> 4400</span><span class="comment"># sequence.  10 is conservative; unit tests pass with 4, Orfanidis</span></div>
<div class="line"><span class="lineno"> 4401</span><span class="comment"># (see _arc_jac_cn [1]) suggests 5.</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a430d6e30bd79c1ac8415b1b3a86920ca" name="a430d6e30bd79c1ac8415b1b3a86920ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a430d6e30bd79c1ac8415b1b3a86920ca">&#9670;&#160;</a></span>_falling_factorial()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._falling_factorial </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return the factorial of `x` to the `n` falling.

This is defined as:

.. math::   x^\underline n = (x)_n = x (x-1) \cdots (x-n+1)

This can more efficiently calculate ratios of factorials, since:

n!/m! == falling_factorial(n, n-m)

where n &gt;= m

skipping the factors that cancel out

the usual factorial n! == ff(n, n)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 4571</span><span class="keyword">def </span>_falling_factorial(x, n):</div>
<div class="line"><span class="lineno"> 4572</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4573</span><span class="stringliteral">    Return the factorial of `x` to the `n` falling.</span></div>
<div class="line"><span class="lineno"> 4574</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4575</span><span class="stringliteral">    This is defined as:</span></div>
<div class="line"><span class="lineno"> 4576</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4577</span><span class="stringliteral">    .. math::   x^\underline n = (x)_n = x (x-1) \cdots (x-n+1)</span></div>
<div class="line"><span class="lineno"> 4578</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4579</span><span class="stringliteral">    This can more efficiently calculate ratios of factorials, since:</span></div>
<div class="line"><span class="lineno"> 4580</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4581</span><span class="stringliteral">    n!/m! == falling_factorial(n, n-m)</span></div>
<div class="line"><span class="lineno"> 4582</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4583</span><span class="stringliteral">    where n &gt;= m</span></div>
<div class="line"><span class="lineno"> 4584</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4585</span><span class="stringliteral">    skipping the factors that cancel out</span></div>
<div class="line"><span class="lineno"> 4586</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4587</span><span class="stringliteral">    the usual factorial n! == ff(n, n)</span></div>
<div class="line"><span class="lineno"> 4588</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4589</span>    val = 1</div>
<div class="line"><span class="lineno"> 4590</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(x - n + 1, x + 1):</div>
<div class="line"><span class="lineno"> 4591</span>        val *= k</div>
<div class="line"><span class="lineno"> 4592</span>    <span class="keywordflow">return</span> val</div>
<div class="line"><span class="lineno"> 4593</span> </div>
<div class="line"><span class="lineno"> 4594</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adce4c3f0ff53976dd442626172326b1e" name="adce4c3f0ff53976dd442626172326b1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adce4c3f0ff53976dd442626172326b1e">&#9670;&#160;</a></span>_hz_to_erb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._hz_to_erb </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Utility for converting from frequency (Hz) to the
Equivalent Rectangular Bandwidth (ERB) scale
ERB = frequency / EarQ + minBW
</pre> <div class="fragment"><div class="line"><span class="lineno"> 5317</span><span class="keyword">def </span>_hz_to_erb(hz):</div>
<div class="line"><span class="lineno"> 5318</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5319</span><span class="stringliteral">    Utility for converting from frequency (Hz) to the</span></div>
<div class="line"><span class="lineno"> 5320</span><span class="stringliteral">    Equivalent Rectangular Bandwidth (ERB) scale</span></div>
<div class="line"><span class="lineno"> 5321</span><span class="stringliteral">    ERB = frequency / EarQ + minBW</span></div>
<div class="line"><span class="lineno"> 5322</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5323</span>    EarQ = 9.26449</div>
<div class="line"><span class="lineno"> 5324</span>    minBW = 24.7</div>
<div class="line"><span class="lineno"> 5325</span>    <span class="keywordflow">return</span> hz / EarQ + minBW</div>
<div class="line"><span class="lineno"> 5326</span> </div>
<div class="line"><span class="lineno"> 5327</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e0ed4ba7b94312ec66b13bf06bf8f74" name="a5e0ed4ba7b94312ec66b13bf06bf8f74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e0ed4ba7b94312ec66b13bf06bf8f74">&#9670;&#160;</a></span>_is_int_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._is_int_type </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Check if input is of a scalar integer type (so ``5`` and ``array(5)`` will
pass, while ``5.0`` and ``array([5])`` will fail.
</pre> <div class="fragment"><div class="line"><span class="lineno">   41</span><span class="keyword">def </span>_is_int_type(x):</div>
<div class="line"><span class="lineno">   42</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">    Check if input is of a scalar integer type (so ``5`` and ``array(5)`` will</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    pass, while ``5.0`` and ``array([5])`` will fail.</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">if</span> np.ndim(x) != 0:</div>
<div class="line"><span class="lineno">   47</span>        <span class="comment"># Older versions of NumPy did not raise for np.array([1]).__index__()</span></div>
<div class="line"><span class="lineno">   48</span>        <span class="comment"># This is safe to remove when support for those versions is dropped</span></div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   51</span>        operator.index(x)</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">except</span> TypeError:</div>
<div class="line"><span class="lineno">   53</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   55</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0dd1dd0be3996b739e2a4af5d8a2d0a" name="ac0dd1dd0be3996b739e2a4af5d8a2d0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0dd1dd0be3996b739e2a4af5d8a2d0a">&#9670;&#160;</a></span>_nearest_real_complex_idx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._nearest_real_complex_idx </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>which</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Get the next closest real or complex element based on distance</pre> <div class="fragment"><div class="line"><span class="lineno"> 1267</span><span class="keyword">def </span>_nearest_real_complex_idx(fro, to, which):</div>
<div class="line"><span class="lineno"> 1268</span>    <span class="stringliteral">&quot;&quot;&quot;Get the next closest real or complex element based on distance&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1269</span>    <span class="keyword">assert</span> which <span class="keywordflow">in</span> (<span class="stringliteral">&#39;real&#39;</span>, <span class="stringliteral">&#39;complex&#39;</span>, <span class="stringliteral">&#39;any&#39;</span>)</div>
<div class="line"><span class="lineno"> 1270</span>    order = np.argsort(np.abs(fro - to))</div>
<div class="line"><span class="lineno"> 1271</span>    <span class="keywordflow">if</span> which == <span class="stringliteral">&#39;any&#39;</span>:</div>
<div class="line"><span class="lineno"> 1272</span>        <span class="keywordflow">return</span> order[0]</div>
<div class="line"><span class="lineno"> 1273</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1274</span>        mask = np.isreal(fro[order])</div>
<div class="line"><span class="lineno"> 1275</span>        <span class="keywordflow">if</span> which == <span class="stringliteral">&#39;complex&#39;</span>:</div>
<div class="line"><span class="lineno"> 1276</span>            mask = ~mask</div>
<div class="line"><span class="lineno"> 1277</span>        <span class="keywordflow">return</span> order[np.nonzero(mask)[0][0]]</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af24f2b004da00e3d84426d2f1b70507c" name="af24f2b004da00e3d84426d2f1b70507c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af24f2b004da00e3d84426d2f1b70507c">&#9670;&#160;</a></span>_norm_factor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._norm_factor </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Numerically find frequency shift to apply to delay-normalized filter such
that -3 dB point is at 1 rad/sec.

`p` is an array_like of polynomial poles
`k` is a float gain

First 10 values are listed in "Bessel Scale Factors" table,
"Bessel Filters Polynomials, Poles and Circuit Elements 2003, C. Bond."
</pre> <div class="fragment"><div class="line"><span class="lineno"> 4742</span><span class="keyword">def </span>_norm_factor(p, k):</div>
<div class="line"><span class="lineno"> 4743</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4744</span><span class="stringliteral">    Numerically find frequency shift to apply to delay-normalized filter such</span></div>
<div class="line"><span class="lineno"> 4745</span><span class="stringliteral">    that -3 dB point is at 1 rad/sec.</span></div>
<div class="line"><span class="lineno"> 4746</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4747</span><span class="stringliteral">    `p` is an array_like of polynomial poles</span></div>
<div class="line"><span class="lineno"> 4748</span><span class="stringliteral">    `k` is a float gain</span></div>
<div class="line"><span class="lineno"> 4749</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4750</span><span class="stringliteral">    First 10 values are listed in &quot;Bessel Scale Factors&quot; table,</span></div>
<div class="line"><span class="lineno"> 4751</span><span class="stringliteral">    &quot;Bessel Filters Polynomials, Poles and Circuit Elements 2003, C. Bond.&quot;</span></div>
<div class="line"><span class="lineno"> 4752</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4753</span>    p = asarray(p, dtype=complex)</div>
<div class="line"><span class="lineno"> 4754</span> </div>
<div class="line"><span class="lineno"> 4755</span>    <span class="keyword">def </span>G(w):</div>
<div class="line"><span class="lineno"> 4756</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4757</span><span class="stringliteral">        Gain of filter</span></div>
<div class="line"><span class="lineno"> 4758</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4759</span>        <span class="keywordflow">return</span> abs(k / prod(1j*w - p))</div>
<div class="line"><span class="lineno"> 4760</span> </div>
<div class="line"><span class="lineno"> 4761</span>    <span class="keyword">def </span>cutoff(w):</div>
<div class="line"><span class="lineno"> 4762</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4763</span><span class="stringliteral">        When gain = -3 dB, return 0</span></div>
<div class="line"><span class="lineno"> 4764</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4765</span>        <span class="keywordflow">return</span> G(w) - 1/np.sqrt(2)</div>
<div class="line"><span class="lineno"> 4766</span> </div>
<div class="line"><span class="lineno"> 4767</span>    <span class="keywordflow">return</span> optimize.newton(cutoff, 1.5)</div>
<div class="line"><span class="lineno"> 4768</span> </div>
<div class="line"><span class="lineno"> 4769</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a29fbb90ffea114a412f2f43b81f4a00c" name="a29fbb90ffea114a412f2f43b81f4a00c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29fbb90ffea114a412f2f43b81f4a00c">&#9670;&#160;</a></span>_pow10m1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._pow10m1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">10 ** x - 1 for x near 0</pre> <div class="fragment"><div class="line"><span class="lineno"> 4120</span><span class="keyword">def </span>_pow10m1(x):</div>
<div class="line"><span class="lineno"> 4121</span>    <span class="stringliteral">&quot;&quot;&quot;10 ** x - 1 for x near 0&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4122</span>    <span class="keywordflow">return</span> np.expm1(_POW10_LOG10 * x)</div>
<div class="line"><span class="lineno"> 4123</span> </div>
<div class="line"><span class="lineno"> 4124</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a719d7c3c96122501b193e7e67a6cc19b" name="a719d7c3c96122501b193e7e67a6cc19b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a719d7c3c96122501b193e7e67a6cc19b">&#9670;&#160;</a></span>_relative_degree()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._relative_degree </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return relative degree of transfer function from zeros and poles
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2562</span><span class="keyword">def </span>_relative_degree(z, p):</div>
<div class="line"><span class="lineno"> 2563</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2564</span><span class="stringliteral">    Return relative degree of transfer function from zeros and poles</span></div>
<div class="line"><span class="lineno"> 2565</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2566</span>    degree = len(p) - len(z)</div>
<div class="line"><span class="lineno"> 2567</span>    <span class="keywordflow">if</span> degree &lt; 0:</div>
<div class="line"><span class="lineno"> 2568</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Improper transfer function. &quot;</span></div>
<div class="line"><span class="lineno"> 2569</span>                         <span class="stringliteral">&quot;Must have at least as many poles as zeros.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2570</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2571</span>        <span class="keywordflow">return</span> degree</div>
<div class="line"><span class="lineno"> 2572</span> </div>
<div class="line"><span class="lineno"> 2573</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c2c25900a53f28740007fa4ed1445a7" name="a5c2c25900a53f28740007fa4ed1445a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c2c25900a53f28740007fa4ed1445a7">&#9670;&#160;</a></span>_single_zpksos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._single_zpksos </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Create one second-order section from up to two zeros and poles</pre> <div class="fragment"><div class="line"><span class="lineno"> 1280</span><span class="keyword">def </span>_single_zpksos(z, p, k):</div>
<div class="line"><span class="lineno"> 1281</span>    <span class="stringliteral">&quot;&quot;&quot;Create one second-order section from up to two zeros and poles&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1282</span>    sos = np.zeros(6)</div>
<div class="line"><span class="lineno"> 1283</span>    b, a = zpk2tf(z, p, k)</div>
<div class="line"><span class="lineno"> 1284</span>    sos[3-len(b):3] = b</div>
<div class="line"><span class="lineno"> 1285</span>    sos[6-len(a):6] = a</div>
<div class="line"><span class="lineno"> 1286</span>    <span class="keywordflow">return</span> sos</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aec666fcd802c4b7014526c80cbee6ed0" name="aec666fcd802c4b7014526c80cbee6ed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec666fcd802c4b7014526c80cbee6ed0">&#9670;&#160;</a></span>_validate_gpass_gstop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._validate_gpass_gstop </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gstop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2140</span><span class="keyword">def </span>_validate_gpass_gstop(gpass, gstop):</div>
<div class="line"><span class="lineno"> 2141</span> </div>
<div class="line"><span class="lineno"> 2142</span>    <span class="keywordflow">if</span> gpass &lt;= 0.0:</div>
<div class="line"><span class="lineno"> 2143</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;gpass should be larger than 0.0&quot;</span>)</div>
<div class="line"><span class="lineno"> 2144</span>    <span class="keywordflow">elif</span> gstop &lt;= 0.0:</div>
<div class="line"><span class="lineno"> 2145</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;gstop should be larger than 0.0&quot;</span>)</div>
<div class="line"><span class="lineno"> 2146</span>    <span class="keywordflow">elif</span> gpass &gt; gstop:</div>
<div class="line"><span class="lineno"> 2147</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;gpass should be smaller than gstop&quot;</span>)</div>
<div class="line"><span class="lineno"> 2148</span> </div>
<div class="line"><span class="lineno"> 2149</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2dec7b3a76879ba708edb9f7d00c00c" name="ad2dec7b3a76879ba708edb9f7d00c00c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2dec7b3a76879ba708edb9f7d00c00c">&#9670;&#160;</a></span>_validate_sos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._validate_sos </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Helper to validate a SOS input</pre> <div class="fragment"><div class="line"><span class="lineno">  711</span><span class="keyword">def </span>_validate_sos(sos):</div>
<div class="line"><span class="lineno">  712</span>    <span class="stringliteral">&quot;&quot;&quot;Helper to validate a SOS input&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  713</span>    sos = np.atleast_2d(sos)</div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">if</span> sos.ndim != 2:</div>
<div class="line"><span class="lineno">  715</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;sos array must be 2D&#39;</span>)</div>
<div class="line"><span class="lineno">  716</span>    n_sections, m = sos.shape</div>
<div class="line"><span class="lineno">  717</span>    <span class="keywordflow">if</span> m != 6:</div>
<div class="line"><span class="lineno">  718</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;sos array must be shape (n_sections, 6)&#39;</span>)</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (sos[:, 3] == 1).all():</div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;sos[:, 3] should be all ones&#39;</span>)</div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordflow">return</span> sos, n_sections</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a258bb5e560cf7595cda3c4906daa5f01" name="a258bb5e560cf7595cda3c4906daa5f01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a258bb5e560cf7595cda3c4906daa5f01">&#9670;&#160;</a></span>band_stop_obj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.band_stop_obj </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>passb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stopb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gstop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Band Stop Objective Function for order minimization.

Returns the non-integer order for an analog band stop filter.

Parameters
----------
wp : scalar
    Edge of passband `passb`.
ind : int, {0, 1}
    Index specifying which `passb` edge to vary (0 or 1).
passb : ndarray
    Two element sequence of fixed passband edges.
stopb : ndarray
    Two element sequence of fixed stopband edges.
gstop : float
    Amount of attenuation in stopband in dB.
gpass : float
    Amount of ripple in the passband in dB.
type : {'butter', 'cheby', 'ellip'}
    Type of filter.

Returns
-------
n : scalar
    Filter order (possibly non-integer).</pre> <div class="fragment"><div class="line"><span class="lineno"> 3579</span><span class="keyword">def </span>band_stop_obj(wp, ind, passb, stopb, gpass, gstop, type):</div>
<div class="line"><span class="lineno"> 3580</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3581</span><span class="stringliteral">    Band Stop Objective Function for order minimization.</span></div>
<div class="line"><span class="lineno"> 3582</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3583</span><span class="stringliteral">    Returns the non-integer order for an analog band stop filter.</span></div>
<div class="line"><span class="lineno"> 3584</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3585</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3586</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3587</span><span class="stringliteral">    wp : scalar</span></div>
<div class="line"><span class="lineno"> 3588</span><span class="stringliteral">        Edge of passband `passb`.</span></div>
<div class="line"><span class="lineno"> 3589</span><span class="stringliteral">    ind : int, {0, 1}</span></div>
<div class="line"><span class="lineno"> 3590</span><span class="stringliteral">        Index specifying which `passb` edge to vary (0 or 1).</span></div>
<div class="line"><span class="lineno"> 3591</span><span class="stringliteral">    passb : ndarray</span></div>
<div class="line"><span class="lineno"> 3592</span><span class="stringliteral">        Two element sequence of fixed passband edges.</span></div>
<div class="line"><span class="lineno"> 3593</span><span class="stringliteral">    stopb : ndarray</span></div>
<div class="line"><span class="lineno"> 3594</span><span class="stringliteral">        Two element sequence of fixed stopband edges.</span></div>
<div class="line"><span class="lineno"> 3595</span><span class="stringliteral">    gstop : float</span></div>
<div class="line"><span class="lineno"> 3596</span><span class="stringliteral">        Amount of attenuation in stopband in dB.</span></div>
<div class="line"><span class="lineno"> 3597</span><span class="stringliteral">    gpass : float</span></div>
<div class="line"><span class="lineno"> 3598</span><span class="stringliteral">        Amount of ripple in the passband in dB.</span></div>
<div class="line"><span class="lineno"> 3599</span><span class="stringliteral">    type : {&#39;butter&#39;, &#39;cheby&#39;, &#39;ellip&#39;}</span></div>
<div class="line"><span class="lineno"> 3600</span><span class="stringliteral">        Type of filter.</span></div>
<div class="line"><span class="lineno"> 3601</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3602</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3603</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3604</span><span class="stringliteral">    n : scalar</span></div>
<div class="line"><span class="lineno"> 3605</span><span class="stringliteral">        Filter order (possibly non-integer).</span></div>
<div class="line"><span class="lineno"> 3606</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3607</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3608</span> </div>
<div class="line"><span class="lineno"> 3609</span>    _validate_gpass_gstop(gpass, gstop)</div>
<div class="line"><span class="lineno"> 3610</span> </div>
<div class="line"><span class="lineno"> 3611</span>    passbC = passb.copy()</div>
<div class="line"><span class="lineno"> 3612</span>    passbC[ind] = wp</div>
<div class="line"><span class="lineno"> 3613</span>    nat = (stopb * (passbC[0] - passbC[1]) /</div>
<div class="line"><span class="lineno"> 3614</span>           (stopb ** 2 - passbC[0] * passbC[1]))</div>
<div class="line"><span class="lineno"> 3615</span>    nat = min(abs(nat))</div>
<div class="line"><span class="lineno"> 3616</span> </div>
<div class="line"><span class="lineno"> 3617</span>    <span class="keywordflow">if</span> type == <span class="stringliteral">&#39;butter&#39;</span>:</div>
<div class="line"><span class="lineno"> 3618</span>        GSTOP = 10 ** (0.1 * abs(gstop))</div>
<div class="line"><span class="lineno"> 3619</span>        GPASS = 10 ** (0.1 * abs(gpass))</div>
<div class="line"><span class="lineno"> 3620</span>        n = (log10((GSTOP - 1.0) / (GPASS - 1.0)) / (2 * log10(nat)))</div>
<div class="line"><span class="lineno"> 3621</span>    <span class="keywordflow">elif</span> type == <span class="stringliteral">&#39;cheby&#39;</span>:</div>
<div class="line"><span class="lineno"> 3622</span>        GSTOP = 10 ** (0.1 * abs(gstop))</div>
<div class="line"><span class="lineno"> 3623</span>        GPASS = 10 ** (0.1 * abs(gpass))</div>
<div class="line"><span class="lineno"> 3624</span>        n = arccosh(sqrt((GSTOP - 1.0) / (GPASS - 1.0))) / arccosh(nat)</div>
<div class="line"><span class="lineno"> 3625</span>    <span class="keywordflow">elif</span> type == <span class="stringliteral">&#39;ellip&#39;</span>:</div>
<div class="line"><span class="lineno"> 3626</span>        GSTOP = 10 ** (0.1 * gstop)</div>
<div class="line"><span class="lineno"> 3627</span>        GPASS = 10 ** (0.1 * gpass)</div>
<div class="line"><span class="lineno"> 3628</span>        arg1 = sqrt((GPASS - 1.0) / (GSTOP - 1.0))</div>
<div class="line"><span class="lineno"> 3629</span>        arg0 = 1.0 / nat</div>
<div class="line"><span class="lineno"> 3630</span>        d0 = special.ellipk([arg0 ** 2, 1 - arg0 ** 2])</div>
<div class="line"><span class="lineno"> 3631</span>        d1 = special.ellipk([arg1 ** 2, 1 - arg1 ** 2])</div>
<div class="line"><span class="lineno"> 3632</span>        n = (d0[0] * d1[1] / (d0[1] * d1[0]))</div>
<div class="line"><span class="lineno"> 3633</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3634</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Incorrect type: %s&quot;</span> % type)</div>
<div class="line"><span class="lineno"> 3635</span>    <span class="keywordflow">return</span> n</div>
<div class="line"><span class="lineno"> 3636</span> </div>
<div class="line"><span class="lineno"> 3637</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad432d51b3c6588aad365b569f4fd73fc" name="ad432d51b3c6588aad365b569f4fd73fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad432d51b3c6588aad365b569f4fd73fc">&#9670;&#160;</a></span>bessel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.bessel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Wn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>btype</em> = <code>'low'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>'ba'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>'phase'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Bessel/Thomson digital and analog filter design.

Design an Nth-order digital or analog Bessel filter and return the
filter coefficients.

Parameters
----------
N : int
    The order of the filter.
Wn : array_like
    A scalar or length-2 sequence giving the critical frequencies (defined
    by the `norm` parameter).
    For analog filters, `Wn` is an angular frequency (e.g., rad/s).

    For digital filters, `Wn` are in the same units as `fs`.  By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`Wn` is thus in
    half-cycles / sample.)
btype : {'lowpass', 'highpass', 'bandpass', 'bandstop'}, optional
    The type of filter.  Default is 'lowpass'.
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned. (See Notes.)
output : {'ba', 'zpk', 'sos'}, optional
    Type of output:  numerator/denominator ('ba'), pole-zero ('zpk'), or
    second-order sections ('sos'). Default is 'ba'.
norm : {'phase', 'delay', 'mag'}, optional
    Critical frequency normalization:

    ``phase``
        The filter is normalized such that the phase response reaches its
        midpoint at angular (e.g. rad/s) frequency `Wn`. This happens for
        both low-pass and high-pass filters, so this is the
        "phase-matched" case.

        The magnitude response asymptotes are the same as a Butterworth
        filter of the same order with a cutoff of `Wn`.

        This is the default, and matches MATLAB's implementation.

    ``delay``
        The filter is normalized such that the group delay in the passband
        is 1/`Wn` (e.g., seconds). This is the "natural" type obtained by
        solving Bessel polynomials.

    ``mag``
        The filter is normalized such that the gain magnitude is -3 dB at
        angular frequency `Wn`.

    .. versionadded:: 0.18.0
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.
    Only returned if ``output='ba'``.
z, p, k : ndarray, ndarray, float
    Zeros, poles, and system gain of the IIR filter transfer
    function.  Only returned if ``output='zpk'``.
sos : ndarray
    Second-order sections representation of the IIR filter.
    Only returned if ``output=='sos'``.

Notes
-----
Also known as a Thomson filter, the analog Bessel filter has maximally
flat group delay and maximally linear phase response, with very little
ringing in the step response. [1]_

The Bessel is inherently an analog filter. This function generates digital
Bessel filters using the bilinear transform, which does not preserve the
phase response of the analog filter. As such, it is only approximately
correct at frequencies below about fs/4. To get maximally-flat group
delay at higher frequencies, the analog Bessel filter must be transformed
using phase-preserving techniques.

See `besselap` for implementation details and references.

The ``'sos'`` output parameter was added in 0.16.0.

Examples
--------
Plot the phase-normalized frequency response, showing the relationship
to the Butterworth's cutoff frequency (green):

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; b, a = signal.butter(4, 100, 'low', analog=True)
&gt;&gt;&gt; w, h = signal.freqs(b, a)
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(np.abs(h)), color='silver', ls='dashed')
&gt;&gt;&gt; b, a = signal.bessel(4, 100, 'low', analog=True, norm='phase')
&gt;&gt;&gt; w, h = signal.freqs(b, a)
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(np.abs(h)))
&gt;&gt;&gt; plt.title('Bessel filter magnitude response (with Butterworth)')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.axvline(100, color='green')  # cutoff frequency
&gt;&gt;&gt; plt.show()

and the phase midpoint:

&gt;&gt;&gt; plt.figure()
&gt;&gt;&gt; plt.semilogx(w, np.unwrap(np.angle(h)))
&gt;&gt;&gt; plt.axvline(100, color='green')  # cutoff frequency
&gt;&gt;&gt; plt.axhline(-np.pi, color='red')  # phase midpoint
&gt;&gt;&gt; plt.title('Bessel filter phase response')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Phase [radians]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.show()

Plot the magnitude-normalized frequency response, showing the -3 dB cutoff:

&gt;&gt;&gt; b, a = signal.bessel(3, 10, 'low', analog=True, norm='mag')
&gt;&gt;&gt; w, h = signal.freqs(b, a)
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(np.abs(h)))
&gt;&gt;&gt; plt.axhline(-3, color='red')  # -3 dB magnitude
&gt;&gt;&gt; plt.axvline(10, color='green')  # cutoff frequency
&gt;&gt;&gt; plt.title('Magnitude-normalized Bessel filter frequency response')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.show()

Plot the delay-normalized filter, showing the maximally-flat group delay
at 0.1 seconds:

&gt;&gt;&gt; b, a = signal.bessel(5, 1/0.1, 'low', analog=True, norm='delay')
&gt;&gt;&gt; w, h = signal.freqs(b, a)
&gt;&gt;&gt; plt.figure()
&gt;&gt;&gt; plt.semilogx(w[1:], -np.diff(np.unwrap(np.angle(h)))/np.diff(w))
&gt;&gt;&gt; plt.axhline(0.1, color='red')  # 0.1 seconds group delay
&gt;&gt;&gt; plt.title('Bessel filter group delay')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Group delay [seconds]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.show()

References
----------
.. [1] Thomson, W.E., "Delay Networks having Maximally Flat Frequency
       Characteristics", Proceedings of the Institution of Electrical
       Engineers, Part III, November 1949, Vol. 96, No. 44, pp. 487-490.</pre> <div class="fragment"><div class="line"><span class="lineno"> 3410</span>           fs=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 3411</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3412</span><span class="stringliteral">    Bessel/Thomson digital and analog filter design.</span></div>
<div class="line"><span class="lineno"> 3413</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3414</span><span class="stringliteral">    Design an Nth-order digital or analog Bessel filter and return the</span></div>
<div class="line"><span class="lineno"> 3415</span><span class="stringliteral">    filter coefficients.</span></div>
<div class="line"><span class="lineno"> 3416</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3417</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3418</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3419</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno"> 3420</span><span class="stringliteral">        The order of the filter.</span></div>
<div class="line"><span class="lineno"> 3421</span><span class="stringliteral">    Wn : array_like</span></div>
<div class="line"><span class="lineno"> 3422</span><span class="stringliteral">        A scalar or length-2 sequence giving the critical frequencies (defined</span></div>
<div class="line"><span class="lineno"> 3423</span><span class="stringliteral">        by the `norm` parameter).</span></div>
<div class="line"><span class="lineno"> 3424</span><span class="stringliteral">        For analog filters, `Wn` is an angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 3425</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3426</span><span class="stringliteral">        For digital filters, `Wn` are in the same units as `fs`.  By default,</span></div>
<div class="line"><span class="lineno"> 3427</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 3428</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`Wn` is thus in</span></div>
<div class="line"><span class="lineno"> 3429</span><span class="stringliteral">        half-cycles / sample.)</span></div>
<div class="line"><span class="lineno"> 3430</span><span class="stringliteral">    btype : {&#39;lowpass&#39;, &#39;highpass&#39;, &#39;bandpass&#39;, &#39;bandstop&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3431</span><span class="stringliteral">        The type of filter.  Default is &#39;lowpass&#39;.</span></div>
<div class="line"><span class="lineno"> 3432</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 3433</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 3434</span><span class="stringliteral">        returned. (See Notes.)</span></div>
<div class="line"><span class="lineno"> 3435</span><span class="stringliteral">    output : {&#39;ba&#39;, &#39;zpk&#39;, &#39;sos&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3436</span><span class="stringliteral">        Type of output:  numerator/denominator (&#39;ba&#39;), pole-zero (&#39;zpk&#39;), or</span></div>
<div class="line"><span class="lineno"> 3437</span><span class="stringliteral">        second-order sections (&#39;sos&#39;). Default is &#39;ba&#39;.</span></div>
<div class="line"><span class="lineno"> 3438</span><span class="stringliteral">    norm : {&#39;phase&#39;, &#39;delay&#39;, &#39;mag&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3439</span><span class="stringliteral">        Critical frequency normalization:</span></div>
<div class="line"><span class="lineno"> 3440</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3441</span><span class="stringliteral">        ``phase``</span></div>
<div class="line"><span class="lineno"> 3442</span><span class="stringliteral">            The filter is normalized such that the phase response reaches its</span></div>
<div class="line"><span class="lineno"> 3443</span><span class="stringliteral">            midpoint at angular (e.g. rad/s) frequency `Wn`. This happens for</span></div>
<div class="line"><span class="lineno"> 3444</span><span class="stringliteral">            both low-pass and high-pass filters, so this is the</span></div>
<div class="line"><span class="lineno"> 3445</span><span class="stringliteral">            &quot;phase-matched&quot; case.</span></div>
<div class="line"><span class="lineno"> 3446</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3447</span><span class="stringliteral">            The magnitude response asymptotes are the same as a Butterworth</span></div>
<div class="line"><span class="lineno"> 3448</span><span class="stringliteral">            filter of the same order with a cutoff of `Wn`.</span></div>
<div class="line"><span class="lineno"> 3449</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3450</span><span class="stringliteral">            This is the default, and matches MATLAB&#39;s implementation.</span></div>
<div class="line"><span class="lineno"> 3451</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3452</span><span class="stringliteral">        ``delay``</span></div>
<div class="line"><span class="lineno"> 3453</span><span class="stringliteral">            The filter is normalized such that the group delay in the passband</span></div>
<div class="line"><span class="lineno"> 3454</span><span class="stringliteral">            is 1/`Wn` (e.g., seconds). This is the &quot;natural&quot; type obtained by</span></div>
<div class="line"><span class="lineno"> 3455</span><span class="stringliteral">            solving Bessel polynomials.</span></div>
<div class="line"><span class="lineno"> 3456</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3457</span><span class="stringliteral">        ``mag``</span></div>
<div class="line"><span class="lineno"> 3458</span><span class="stringliteral">            The filter is normalized such that the gain magnitude is -3 dB at</span></div>
<div class="line"><span class="lineno"> 3459</span><span class="stringliteral">            angular frequency `Wn`.</span></div>
<div class="line"><span class="lineno"> 3460</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3461</span><span class="stringliteral">        .. versionadded:: 0.18.0</span></div>
<div class="line"><span class="lineno"> 3462</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 3463</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 3464</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3465</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 3466</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3467</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3468</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3469</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 3470</span><span class="stringliteral">        Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 3471</span><span class="stringliteral">        Only returned if ``output=&#39;ba&#39;``.</span></div>
<div class="line"><span class="lineno"> 3472</span><span class="stringliteral">    z, p, k : ndarray, ndarray, float</span></div>
<div class="line"><span class="lineno"> 3473</span><span class="stringliteral">        Zeros, poles, and system gain of the IIR filter transfer</span></div>
<div class="line"><span class="lineno"> 3474</span><span class="stringliteral">        function.  Only returned if ``output=&#39;zpk&#39;``.</span></div>
<div class="line"><span class="lineno"> 3475</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 3476</span><span class="stringliteral">        Second-order sections representation of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 3477</span><span class="stringliteral">        Only returned if ``output==&#39;sos&#39;``.</span></div>
<div class="line"><span class="lineno"> 3478</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3479</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 3480</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 3481</span><span class="stringliteral">    Also known as a Thomson filter, the analog Bessel filter has maximally</span></div>
<div class="line"><span class="lineno"> 3482</span><span class="stringliteral">    flat group delay and maximally linear phase response, with very little</span></div>
<div class="line"><span class="lineno"> 3483</span><span class="stringliteral">    ringing in the step response. [1]_</span></div>
<div class="line"><span class="lineno"> 3484</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3485</span><span class="stringliteral">    The Bessel is inherently an analog filter. This function generates digital</span></div>
<div class="line"><span class="lineno"> 3486</span><span class="stringliteral">    Bessel filters using the bilinear transform, which does not preserve the</span></div>
<div class="line"><span class="lineno"> 3487</span><span class="stringliteral">    phase response of the analog filter. As such, it is only approximately</span></div>
<div class="line"><span class="lineno"> 3488</span><span class="stringliteral">    correct at frequencies below about fs/4. To get maximally-flat group</span></div>
<div class="line"><span class="lineno"> 3489</span><span class="stringliteral">    delay at higher frequencies, the analog Bessel filter must be transformed</span></div>
<div class="line"><span class="lineno"> 3490</span><span class="stringliteral">    using phase-preserving techniques.</span></div>
<div class="line"><span class="lineno"> 3491</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3492</span><span class="stringliteral">    See `besselap` for implementation details and references.</span></div>
<div class="line"><span class="lineno"> 3493</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3494</span><span class="stringliteral">    The ``&#39;sos&#39;`` output parameter was added in 0.16.0.</span></div>
<div class="line"><span class="lineno"> 3495</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3496</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3497</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3498</span><span class="stringliteral">    Plot the phase-normalized frequency response, showing the relationship</span></div>
<div class="line"><span class="lineno"> 3499</span><span class="stringliteral">    to the Butterworth&#39;s cutoff frequency (green):</span></div>
<div class="line"><span class="lineno"> 3500</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3501</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 3502</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 3503</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3504</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.butter(4, 100, &#39;low&#39;, analog=True)</span></div>
<div class="line"><span class="lineno"> 3505</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a)</span></div>
<div class="line"><span class="lineno"> 3506</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(np.abs(h)), color=&#39;silver&#39;, ls=&#39;dashed&#39;)</span></div>
<div class="line"><span class="lineno"> 3507</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.bessel(4, 100, &#39;low&#39;, analog=True, norm=&#39;phase&#39;)</span></div>
<div class="line"><span class="lineno"> 3508</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a)</span></div>
<div class="line"><span class="lineno"> 3509</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(np.abs(h)))</span></div>
<div class="line"><span class="lineno"> 3510</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Bessel filter magnitude response (with Butterworth)&#39;)</span></div>
<div class="line"><span class="lineno"> 3511</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3512</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 3513</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 3514</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3515</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(100, color=&#39;green&#39;)  # cutoff frequency</span></div>
<div class="line"><span class="lineno"> 3516</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3517</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3518</span><span class="stringliteral">    and the phase midpoint:</span></div>
<div class="line"><span class="lineno"> 3519</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3520</span><span class="stringliteral">    &gt;&gt;&gt; plt.figure()</span></div>
<div class="line"><span class="lineno"> 3521</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, np.unwrap(np.angle(h)))</span></div>
<div class="line"><span class="lineno"> 3522</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(100, color=&#39;green&#39;)  # cutoff frequency</span></div>
<div class="line"><span class="lineno"> 3523</span><span class="stringliteral">    &gt;&gt;&gt; plt.axhline(-np.pi, color=&#39;red&#39;)  # phase midpoint</span></div>
<div class="line"><span class="lineno"> 3524</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Bessel filter phase response&#39;)</span></div>
<div class="line"><span class="lineno"> 3525</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3526</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Phase [radians]&#39;)</span></div>
<div class="line"><span class="lineno"> 3527</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 3528</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3529</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3530</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3531</span><span class="stringliteral">    Plot the magnitude-normalized frequency response, showing the -3 dB cutoff:</span></div>
<div class="line"><span class="lineno"> 3532</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3533</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.bessel(3, 10, &#39;low&#39;, analog=True, norm=&#39;mag&#39;)</span></div>
<div class="line"><span class="lineno"> 3534</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a)</span></div>
<div class="line"><span class="lineno"> 3535</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(np.abs(h)))</span></div>
<div class="line"><span class="lineno"> 3536</span><span class="stringliteral">    &gt;&gt;&gt; plt.axhline(-3, color=&#39;red&#39;)  # -3 dB magnitude</span></div>
<div class="line"><span class="lineno"> 3537</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(10, color=&#39;green&#39;)  # cutoff frequency</span></div>
<div class="line"><span class="lineno"> 3538</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Magnitude-normalized Bessel filter frequency response&#39;)</span></div>
<div class="line"><span class="lineno"> 3539</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3540</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 3541</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 3542</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3543</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3544</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3545</span><span class="stringliteral">    Plot the delay-normalized filter, showing the maximally-flat group delay</span></div>
<div class="line"><span class="lineno"> 3546</span><span class="stringliteral">    at 0.1 seconds:</span></div>
<div class="line"><span class="lineno"> 3547</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3548</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.bessel(5, 1/0.1, &#39;low&#39;, analog=True, norm=&#39;delay&#39;)</span></div>
<div class="line"><span class="lineno"> 3549</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a)</span></div>
<div class="line"><span class="lineno"> 3550</span><span class="stringliteral">    &gt;&gt;&gt; plt.figure()</span></div>
<div class="line"><span class="lineno"> 3551</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w[1:], -np.diff(np.unwrap(np.angle(h)))/np.diff(w))</span></div>
<div class="line"><span class="lineno"> 3552</span><span class="stringliteral">    &gt;&gt;&gt; plt.axhline(0.1, color=&#39;red&#39;)  # 0.1 seconds group delay</span></div>
<div class="line"><span class="lineno"> 3553</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Bessel filter group delay&#39;)</span></div>
<div class="line"><span class="lineno"> 3554</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3555</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Group delay [seconds]&#39;)</span></div>
<div class="line"><span class="lineno"> 3556</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 3557</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3558</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3559</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3560</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 3561</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3562</span><span class="stringliteral">    .. [1] Thomson, W.E., &quot;Delay Networks having Maximally Flat Frequency</span></div>
<div class="line"><span class="lineno"> 3563</span><span class="stringliteral">           Characteristics&quot;, Proceedings of the Institution of Electrical</span></div>
<div class="line"><span class="lineno"> 3564</span><span class="stringliteral">           Engineers, Part III, November 1949, Vol. 96, No. 44, pp. 487-490.</span></div>
<div class="line"><span class="lineno"> 3565</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3566</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3567</span>    <span class="keywordflow">return</span> iirfilter(N, Wn, btype=btype, analog=analog,</div>
<div class="line"><span class="lineno"> 3568</span>                     output=output, ftype=<span class="stringliteral">&#39;bessel_&#39;</span>+norm, fs=fs)</div>
<div class="line"><span class="lineno"> 3569</span> </div>
<div class="line"><span class="lineno"> 3570</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9494ea841106ba6e20f525f6782efb38" name="a9494ea841106ba6e20f525f6782efb38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9494ea841106ba6e20f525f6782efb38">&#9670;&#160;</a></span>besselap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.besselap </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>'phase'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return (z,p,k) for analog prototype of an Nth-order Bessel filter.

Parameters
----------
N : int
    The order of the filter.
norm : {'phase', 'delay', 'mag'}, optional
    Frequency normalization:

    ``phase``
        The filter is normalized such that the phase response reaches its
        midpoint at an angular (e.g., rad/s) cutoff frequency of 1. This
        happens for both low-pass and high-pass filters, so this is the
        "phase-matched" case. [6]_

        The magnitude response asymptotes are the same as a Butterworth
        filter of the same order with a cutoff of `Wn`.

        This is the default, and matches MATLAB's implementation.

    ``delay``
        The filter is normalized such that the group delay in the passband
        is 1 (e.g., 1 second). This is the "natural" type obtained by
        solving Bessel polynomials

    ``mag``
        The filter is normalized such that the gain magnitude is -3 dB at
        angular frequency 1. This is called "frequency normalization" by
        Bond. [1]_

    .. versionadded:: 0.18.0

Returns
-------
z : ndarray
    Zeros of the transfer function. Is always an empty array.
p : ndarray
    Poles of the transfer function.
k : scalar
    Gain of the transfer function. For phase-normalized, this is always 1.

See Also
--------
bessel : Filter design function using this prototype

Notes
-----
To find the pole locations, approximate starting points are generated [2]_
for the zeros of the ordinary Bessel polynomial [3]_, then the
Aberth-Ehrlich method [4]_ [5]_ is used on the Kv(x) Bessel function to
calculate more accurate zeros, and these locations are then inverted about
the unit circle.

References
----------
.. [1] C.R. Bond, "Bessel Filter Constants",
       http://www.crbond.com/papers/bsf.pdf
.. [2] Campos and Calderon, "Approximate closed-form formulas for the
       zeros of the Bessel Polynomials", :arXiv:`1105.0957`.
.. [3] Thomson, W.E., "Delay Networks having Maximally Flat Frequency
       Characteristics", Proceedings of the Institution of Electrical
       Engineers, Part III, November 1949, Vol. 96, No. 44, pp. 487-490.
.. [4] Aberth, "Iteration Methods for Finding all Zeros of a Polynomial
       Simultaneously", Mathematics of Computation, Vol. 27, No. 122,
       April 1973
.. [5] Ehrlich, "A modified Newton method for polynomials", Communications
       of the ACM, Vol. 10, Issue 2, pp. 107-108, Feb. 1967,
       :DOI:`10.1145/363067.363115`
.. [6] Miller and Bohn, "A Bessel Filter Crossover, and Its Relation to
       Others", RaneNote 147, 1998, https://www.ranecommercial.com/legacy/note147.html</pre> <div class="fragment"><div class="line"><span class="lineno"> 4770</span><span class="keyword">def </span>besselap(N, norm=&#39;phase&#39;):</div>
<div class="line"><span class="lineno"> 4771</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4772</span><span class="stringliteral">    Return (z,p,k) for analog prototype of an Nth-order Bessel filter.</span></div>
<div class="line"><span class="lineno"> 4773</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4774</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 4775</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4776</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno"> 4777</span><span class="stringliteral">        The order of the filter.</span></div>
<div class="line"><span class="lineno"> 4778</span><span class="stringliteral">    norm : {&#39;phase&#39;, &#39;delay&#39;, &#39;mag&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 4779</span><span class="stringliteral">        Frequency normalization:</span></div>
<div class="line"><span class="lineno"> 4780</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4781</span><span class="stringliteral">        ``phase``</span></div>
<div class="line"><span class="lineno"> 4782</span><span class="stringliteral">            The filter is normalized such that the phase response reaches its</span></div>
<div class="line"><span class="lineno"> 4783</span><span class="stringliteral">            midpoint at an angular (e.g., rad/s) cutoff frequency of 1. This</span></div>
<div class="line"><span class="lineno"> 4784</span><span class="stringliteral">            happens for both low-pass and high-pass filters, so this is the</span></div>
<div class="line"><span class="lineno"> 4785</span><span class="stringliteral">            &quot;phase-matched&quot; case. [6]_</span></div>
<div class="line"><span class="lineno"> 4786</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4787</span><span class="stringliteral">            The magnitude response asymptotes are the same as a Butterworth</span></div>
<div class="line"><span class="lineno"> 4788</span><span class="stringliteral">            filter of the same order with a cutoff of `Wn`.</span></div>
<div class="line"><span class="lineno"> 4789</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4790</span><span class="stringliteral">            This is the default, and matches MATLAB&#39;s implementation.</span></div>
<div class="line"><span class="lineno"> 4791</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4792</span><span class="stringliteral">        ``delay``</span></div>
<div class="line"><span class="lineno"> 4793</span><span class="stringliteral">            The filter is normalized such that the group delay in the passband</span></div>
<div class="line"><span class="lineno"> 4794</span><span class="stringliteral">            is 1 (e.g., 1 second). This is the &quot;natural&quot; type obtained by</span></div>
<div class="line"><span class="lineno"> 4795</span><span class="stringliteral">            solving Bessel polynomials</span></div>
<div class="line"><span class="lineno"> 4796</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4797</span><span class="stringliteral">        ``mag``</span></div>
<div class="line"><span class="lineno"> 4798</span><span class="stringliteral">            The filter is normalized such that the gain magnitude is -3 dB at</span></div>
<div class="line"><span class="lineno"> 4799</span><span class="stringliteral">            angular frequency 1. This is called &quot;frequency normalization&quot; by</span></div>
<div class="line"><span class="lineno"> 4800</span><span class="stringliteral">            Bond. [1]_</span></div>
<div class="line"><span class="lineno"> 4801</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4802</span><span class="stringliteral">        .. versionadded:: 0.18.0</span></div>
<div class="line"><span class="lineno"> 4803</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4804</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 4805</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 4806</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 4807</span><span class="stringliteral">        Zeros of the transfer function. Is always an empty array.</span></div>
<div class="line"><span class="lineno"> 4808</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 4809</span><span class="stringliteral">        Poles of the transfer function.</span></div>
<div class="line"><span class="lineno"> 4810</span><span class="stringliteral">    k : scalar</span></div>
<div class="line"><span class="lineno"> 4811</span><span class="stringliteral">        Gain of the transfer function. For phase-normalized, this is always 1.</span></div>
<div class="line"><span class="lineno"> 4812</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4813</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 4814</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4815</span><span class="stringliteral">    bessel : Filter design function using this prototype</span></div>
<div class="line"><span class="lineno"> 4816</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4817</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 4818</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 4819</span><span class="stringliteral">    To find the pole locations, approximate starting points are generated [2]_</span></div>
<div class="line"><span class="lineno"> 4820</span><span class="stringliteral">    for the zeros of the ordinary Bessel polynomial [3]_, then the</span></div>
<div class="line"><span class="lineno"> 4821</span><span class="stringliteral">    Aberth-Ehrlich method [4]_ [5]_ is used on the Kv(x) Bessel function to</span></div>
<div class="line"><span class="lineno"> 4822</span><span class="stringliteral">    calculate more accurate zeros, and these locations are then inverted about</span></div>
<div class="line"><span class="lineno"> 4823</span><span class="stringliteral">    the unit circle.</span></div>
<div class="line"><span class="lineno"> 4824</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4825</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 4826</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4827</span><span class="stringliteral">    .. [1] C.R. Bond, &quot;Bessel Filter Constants&quot;,</span></div>
<div class="line"><span class="lineno"> 4828</span><span class="stringliteral">           http://www.crbond.com/papers/bsf.pdf</span></div>
<div class="line"><span class="lineno"> 4829</span><span class="stringliteral">    .. [2] Campos and Calderon, &quot;Approximate closed-form formulas for the</span></div>
<div class="line"><span class="lineno"> 4830</span><span class="stringliteral">           zeros of the Bessel Polynomials&quot;, :arXiv:`1105.0957`.</span></div>
<div class="line"><span class="lineno"> 4831</span><span class="stringliteral">    .. [3] Thomson, W.E., &quot;Delay Networks having Maximally Flat Frequency</span></div>
<div class="line"><span class="lineno"> 4832</span><span class="stringliteral">           Characteristics&quot;, Proceedings of the Institution of Electrical</span></div>
<div class="line"><span class="lineno"> 4833</span><span class="stringliteral">           Engineers, Part III, November 1949, Vol. 96, No. 44, pp. 487-490.</span></div>
<div class="line"><span class="lineno"> 4834</span><span class="stringliteral">    .. [4] Aberth, &quot;Iteration Methods for Finding all Zeros of a Polynomial</span></div>
<div class="line"><span class="lineno"> 4835</span><span class="stringliteral">           Simultaneously&quot;, Mathematics of Computation, Vol. 27, No. 122,</span></div>
<div class="line"><span class="lineno"> 4836</span><span class="stringliteral">           April 1973</span></div>
<div class="line"><span class="lineno"> 4837</span><span class="stringliteral">    .. [5] Ehrlich, &quot;A modified Newton method for polynomials&quot;, Communications</span></div>
<div class="line"><span class="lineno"> 4838</span><span class="stringliteral">           of the ACM, Vol. 10, Issue 2, pp. 107-108, Feb. 1967,</span></div>
<div class="line"><span class="lineno"> 4839</span><span class="stringliteral">           :DOI:`10.1145/363067.363115`</span></div>
<div class="line"><span class="lineno"> 4840</span><span class="stringliteral">    .. [6] Miller and Bohn, &quot;A Bessel Filter Crossover, and Its Relation to</span></div>
<div class="line"><span class="lineno"> 4841</span><span class="stringliteral">           Others&quot;, RaneNote 147, 1998, https://www.ranecommercial.com/legacy/note147.html</span></div>
<div class="line"><span class="lineno"> 4842</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4843</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4844</span>    <span class="keywordflow">if</span> abs(int(N)) != N:</div>
<div class="line"><span class="lineno"> 4845</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Filter order must be a nonnegative integer&quot;</span>)</div>
<div class="line"><span class="lineno"> 4846</span>    <span class="keywordflow">if</span> N == 0:</div>
<div class="line"><span class="lineno"> 4847</span>        p = []</div>
<div class="line"><span class="lineno"> 4848</span>        k = 1</div>
<div class="line"><span class="lineno"> 4849</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4850</span>        <span class="comment"># Find roots of reverse Bessel polynomial</span></div>
<div class="line"><span class="lineno"> 4851</span>        p = 1/_bessel_zeros(N)</div>
<div class="line"><span class="lineno"> 4852</span> </div>
<div class="line"><span class="lineno"> 4853</span>        a_last = _falling_factorial(2*N, N) // 2**N</div>
<div class="line"><span class="lineno"> 4854</span> </div>
<div class="line"><span class="lineno"> 4855</span>        <span class="comment"># Shift them to a different normalization if required</span></div>
<div class="line"><span class="lineno"> 4856</span>        <span class="keywordflow">if</span> norm <span class="keywordflow">in</span> (<span class="stringliteral">&#39;delay&#39;</span>, <span class="stringliteral">&#39;mag&#39;</span>):</div>
<div class="line"><span class="lineno"> 4857</span>            <span class="comment"># Normalized for group delay of 1</span></div>
<div class="line"><span class="lineno"> 4858</span>            k = a_last</div>
<div class="line"><span class="lineno"> 4859</span>            <span class="keywordflow">if</span> norm == <span class="stringliteral">&#39;mag&#39;</span>:</div>
<div class="line"><span class="lineno"> 4860</span>                <span class="comment"># -3 dB magnitude point is at 1 rad/sec</span></div>
<div class="line"><span class="lineno"> 4861</span>                norm_factor = _norm_factor(p, k)</div>
<div class="line"><span class="lineno"> 4862</span>                p /= norm_factor</div>
<div class="line"><span class="lineno"> 4863</span>                k = norm_factor**-N * a_last</div>
<div class="line"><span class="lineno"> 4864</span>        <span class="keywordflow">elif</span> norm == <span class="stringliteral">&#39;phase&#39;</span>:</div>
<div class="line"><span class="lineno"> 4865</span>            <span class="comment"># Phase-matched (1/2 max phase shift at 1 rad/sec)</span></div>
<div class="line"><span class="lineno"> 4866</span>            <span class="comment"># Asymptotes are same as Butterworth filter</span></div>
<div class="line"><span class="lineno"> 4867</span>            p *= 10**(-math.log10(a_last)/N)</div>
<div class="line"><span class="lineno"> 4868</span>            k = 1</div>
<div class="line"><span class="lineno"> 4869</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4870</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;normalization not understood&#39;</span>)</div>
<div class="line"><span class="lineno"> 4871</span> </div>
<div class="line"><span class="lineno"> 4872</span>    <span class="keywordflow">return</span> asarray([]), asarray(p, dtype=complex), float(k)</div>
<div class="line"><span class="lineno"> 4873</span> </div>
<div class="line"><span class="lineno"> 4874</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6fe7b079ffdda28a189c255cbe9fb1d2" name="a6fe7b079ffdda28a189c255cbe9fb1d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fe7b079ffdda28a189c255cbe9fb1d2">&#9670;&#160;</a></span>bilinear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.bilinear </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return a digital IIR filter from an analog one using a bilinear transform.

Transform a set of poles and zeros from the analog s-plane to the digital
z-plane using Tustin's method, which substitutes ``(z-1) / (z+1)`` for
``s``, maintaining the shape of the frequency response.

Parameters
----------
b : array_like
Numerator of the analog filter transfer function.
a : array_like
Denominator of the analog filter transfer function.
fs : float
Sample rate, as ordinary frequency (e.g., hertz). No prewarping is
done in this function.

Returns
-------
z : ndarray
Numerator of the transformed digital filter transfer function.
p : ndarray
Denominator of the transformed digital filter transfer function.

See Also
--------
lp2lp, lp2hp, lp2bp, lp2bs
bilinear_zpk

Examples
--------
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; fs = 100
&gt;&gt;&gt; bf = 2 * np.pi * np.array([7, 13])
&gt;&gt;&gt; filts = signal.lti(*signal.butter(4, bf, btype='bandpass',
...                                   analog=True))
&gt;&gt;&gt; filtz = signal.lti(*signal.bilinear(filts.num, filts.den, fs))
&gt;&gt;&gt; wz, hz = signal.freqz(filtz.num, filtz.den)
&gt;&gt;&gt; ws, hs = signal.freqs(filts.num, filts.den, worN=fs*wz)

&gt;&gt;&gt; plt.semilogx(wz*fs/(2*np.pi), 20*np.log10(np.abs(hz).clip(1e-15)),
...              label=r'$|H_z(e^{j \omega})|$')
&gt;&gt;&gt; plt.semilogx(wz*fs/(2*np.pi), 20*np.log10(np.abs(hs).clip(1e-15)),
...              label=r'$|H(j \omega)|$')
&gt;&gt;&gt; plt.legend()
&gt;&gt;&gt; plt.xlabel('Frequency [Hz]')
&gt;&gt;&gt; plt.ylabel('Magnitude [dB]')
&gt;&gt;&gt; plt.grid(True)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2056</span><span class="keyword">def </span>bilinear(b, a, fs=1.0):</div>
<div class="line"><span class="lineno"> 2057</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2058</span><span class="stringliteral">    Return a digital IIR filter from an analog one using a bilinear transform.</span></div>
<div class="line"><span class="lineno"> 2059</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2060</span><span class="stringliteral">    Transform a set of poles and zeros from the analog s-plane to the digital</span></div>
<div class="line"><span class="lineno"> 2061</span><span class="stringliteral">    z-plane using Tustin&#39;s method, which substitutes ``(z-1) / (z+1)`` for</span></div>
<div class="line"><span class="lineno"> 2062</span><span class="stringliteral">    ``s``, maintaining the shape of the frequency response.</span></div>
<div class="line"><span class="lineno"> 2063</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2064</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2065</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2066</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 2067</span><span class="stringliteral">        Numerator of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2068</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 2069</span><span class="stringliteral">        Denominator of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2070</span><span class="stringliteral">    fs : float</span></div>
<div class="line"><span class="lineno"> 2071</span><span class="stringliteral">        Sample rate, as ordinary frequency (e.g., hertz). No prewarping is</span></div>
<div class="line"><span class="lineno"> 2072</span><span class="stringliteral">        done in this function.</span></div>
<div class="line"><span class="lineno"> 2073</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2074</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2075</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2076</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 2077</span><span class="stringliteral">        Numerator of the transformed digital filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2078</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 2079</span><span class="stringliteral">        Denominator of the transformed digital filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2080</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2081</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2082</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2083</span><span class="stringliteral">    lp2lp, lp2hp, lp2bp, lp2bs</span></div>
<div class="line"><span class="lineno"> 2084</span><span class="stringliteral">    bilinear_zpk</span></div>
<div class="line"><span class="lineno"> 2085</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2086</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2087</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2088</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 2089</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 2090</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2091</span><span class="stringliteral">    &gt;&gt;&gt; fs = 100</span></div>
<div class="line"><span class="lineno"> 2092</span><span class="stringliteral">    &gt;&gt;&gt; bf = 2 * np.pi * np.array([7, 13])</span></div>
<div class="line"><span class="lineno"> 2093</span><span class="stringliteral">    &gt;&gt;&gt; filts = signal.lti(*signal.butter(4, bf, btype=&#39;bandpass&#39;,</span></div>
<div class="line"><span class="lineno"> 2094</span><span class="stringliteral">    ...                                   analog=True))</span></div>
<div class="line"><span class="lineno"> 2095</span><span class="stringliteral">    &gt;&gt;&gt; filtz = signal.lti(*signal.bilinear(filts.num, filts.den, fs))</span></div>
<div class="line"><span class="lineno"> 2096</span><span class="stringliteral">    &gt;&gt;&gt; wz, hz = signal.freqz(filtz.num, filtz.den)</span></div>
<div class="line"><span class="lineno"> 2097</span><span class="stringliteral">    &gt;&gt;&gt; ws, hs = signal.freqs(filts.num, filts.den, worN=fs*wz)</span></div>
<div class="line"><span class="lineno"> 2098</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2099</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(wz*fs/(2*np.pi), 20*np.log10(np.abs(hz).clip(1e-15)),</span></div>
<div class="line"><span class="lineno"> 2100</span><span class="stringliteral">    ...              label=r&#39;$|H_z(e^{j \omega})|$&#39;)</span></div>
<div class="line"><span class="lineno"> 2101</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(wz*fs/(2*np.pi), 20*np.log10(np.abs(hs).clip(1e-15)),</span></div>
<div class="line"><span class="lineno"> 2102</span><span class="stringliteral">    ...              label=r&#39;$|H(j \omega)|$&#39;)</span></div>
<div class="line"><span class="lineno"> 2103</span><span class="stringliteral">    &gt;&gt;&gt; plt.legend()</span></div>
<div class="line"><span class="lineno"> 2104</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [Hz]&#39;)</span></div>
<div class="line"><span class="lineno"> 2105</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Magnitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 2106</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno"> 2107</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2108</span>    fs = float(fs)</div>
<div class="line"><span class="lineno"> 2109</span>    a, b = map(atleast_1d, (a, b))</div>
<div class="line"><span class="lineno"> 2110</span>    D = len(a) - 1</div>
<div class="line"><span class="lineno"> 2111</span>    N = len(b) - 1</div>
<div class="line"><span class="lineno"> 2112</span>    artype = float</div>
<div class="line"><span class="lineno"> 2113</span>    M = max([N, D])</div>
<div class="line"><span class="lineno"> 2114</span>    Np = M</div>
<div class="line"><span class="lineno"> 2115</span>    Dp = M</div>
<div class="line"><span class="lineno"> 2116</span>    bprime = numpy.empty(Np + 1, artype)</div>
<div class="line"><span class="lineno"> 2117</span>    aprime = numpy.empty(Dp + 1, artype)</div>
<div class="line"><span class="lineno"> 2118</span>    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(Np + 1):</div>
<div class="line"><span class="lineno"> 2119</span>        val = 0.0</div>
<div class="line"><span class="lineno"> 2120</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(N + 1):</div>
<div class="line"><span class="lineno"> 2121</span>            <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(i + 1):</div>
<div class="line"><span class="lineno"> 2122</span>                <span class="keywordflow">for</span> l <span class="keywordflow">in</span> range(M - i + 1):</div>
<div class="line"><span class="lineno"> 2123</span>                    <span class="keywordflow">if</span> k + l == j:</div>
<div class="line"><span class="lineno"> 2124</span>                        val += (comb(i, k) * comb(M - i, l) * b[N - i] *</div>
<div class="line"><span class="lineno"> 2125</span>                                pow(2 * fs, i) * (-1) ** k)</div>
<div class="line"><span class="lineno"> 2126</span>        bprime[j] = real(val)</div>
<div class="line"><span class="lineno"> 2127</span>    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(Dp + 1):</div>
<div class="line"><span class="lineno"> 2128</span>        val = 0.0</div>
<div class="line"><span class="lineno"> 2129</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(D + 1):</div>
<div class="line"><span class="lineno"> 2130</span>            <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(i + 1):</div>
<div class="line"><span class="lineno"> 2131</span>                <span class="keywordflow">for</span> l <span class="keywordflow">in</span> range(M - i + 1):</div>
<div class="line"><span class="lineno"> 2132</span>                    <span class="keywordflow">if</span> k + l == j:</div>
<div class="line"><span class="lineno"> 2133</span>                        val += (comb(i, k) * comb(M - i, l) * a[D - i] *</div>
<div class="line"><span class="lineno"> 2134</span>                                pow(2 * fs, i) * (-1) ** k)</div>
<div class="line"><span class="lineno"> 2135</span>        aprime[j] = real(val)</div>
<div class="line"><span class="lineno"> 2136</span> </div>
<div class="line"><span class="lineno"> 2137</span>    <span class="keywordflow">return</span> normalize(bprime, aprime)</div>
<div class="line"><span class="lineno"> 2138</span> </div>
<div class="line"><span class="lineno"> 2139</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9da0a444f05972f5eca9cb9035d71261" name="a9da0a444f05972f5eca9cb9035d71261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9da0a444f05972f5eca9cb9035d71261">&#9670;&#160;</a></span>bilinear_zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.bilinear_zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return a digital IIR filter from an analog one using a bilinear transform.

Transform a set of poles and zeros from the analog s-plane to the digital
z-plane using Tustin's method, which substitutes ``(z-1) / (z+1)`` for
``s``, maintaining the shape of the frequency response.

Parameters
----------
z : array_like
Zeros of the analog filter transfer function.
p : array_like
Poles of the analog filter transfer function.
k : float
System gain of the analog filter transfer function.
fs : float
Sample rate, as ordinary frequency (e.g., hertz). No prewarping is
done in this function.

Returns
-------
z : ndarray
Zeros of the transformed digital filter transfer function.
p : ndarray
Poles of the transformed digital filter transfer function.
k : float
System gain of the transformed digital filter.

See Also
--------
lp2lp_zpk, lp2hp_zpk, lp2bp_zpk, lp2bs_zpk
bilinear

Notes
-----
.. versionadded:: 1.1.0

Examples
--------
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; fs = 100
&gt;&gt;&gt; bf = 2 * np.pi * np.array([7, 13])
&gt;&gt;&gt; filts = signal.lti(*signal.butter(4, bf, btype='bandpass', analog=True,
...                                   output='zpk'))
&gt;&gt;&gt; filtz = signal.lti(*signal.bilinear_zpk(filts.zeros, filts.poles,
...                                         filts.gain, fs))
&gt;&gt;&gt; wz, hz = signal.freqz_zpk(filtz.zeros, filtz.poles, filtz.gain)
&gt;&gt;&gt; ws, hs = signal.freqs_zpk(filts.zeros, filts.poles, filts.gain,
...                           worN=fs*wz)
&gt;&gt;&gt; plt.semilogx(wz*fs/(2*np.pi), 20*np.log10(np.abs(hz).clip(1e-15)),
...              label=r'$|H_z(e^{j \omega})|$')
&gt;&gt;&gt; plt.semilogx(wz*fs/(2*np.pi), 20*np.log10(np.abs(hs).clip(1e-15)),
...              label=r'$|H(j \omega)|$')
&gt;&gt;&gt; plt.legend()
&gt;&gt;&gt; plt.xlabel('Frequency [Hz]')
&gt;&gt;&gt; plt.ylabel('Magnitude [dB]')
&gt;&gt;&gt; plt.grid(True)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2574</span><span class="keyword">def </span>bilinear_zpk(z, p, k, fs):</div>
<div class="line"><span class="lineno"> 2575</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2576</span><span class="stringliteral">    Return a digital IIR filter from an analog one using a bilinear transform.</span></div>
<div class="line"><span class="lineno"> 2577</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2578</span><span class="stringliteral">    Transform a set of poles and zeros from the analog s-plane to the digital</span></div>
<div class="line"><span class="lineno"> 2579</span><span class="stringliteral">    z-plane using Tustin&#39;s method, which substitutes ``(z-1) / (z+1)`` for</span></div>
<div class="line"><span class="lineno"> 2580</span><span class="stringliteral">    ``s``, maintaining the shape of the frequency response.</span></div>
<div class="line"><span class="lineno"> 2581</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2582</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2583</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2584</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno"> 2585</span><span class="stringliteral">        Zeros of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2586</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno"> 2587</span><span class="stringliteral">        Poles of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2588</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2589</span><span class="stringliteral">        System gain of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2590</span><span class="stringliteral">    fs : float</span></div>
<div class="line"><span class="lineno"> 2591</span><span class="stringliteral">        Sample rate, as ordinary frequency (e.g., hertz). No prewarping is</span></div>
<div class="line"><span class="lineno"> 2592</span><span class="stringliteral">        done in this function.</span></div>
<div class="line"><span class="lineno"> 2593</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2594</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2595</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2596</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 2597</span><span class="stringliteral">        Zeros of the transformed digital filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2598</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 2599</span><span class="stringliteral">        Poles of the transformed digital filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2600</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2601</span><span class="stringliteral">        System gain of the transformed digital filter.</span></div>
<div class="line"><span class="lineno"> 2602</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2603</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2604</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2605</span><span class="stringliteral">    lp2lp_zpk, lp2hp_zpk, lp2bp_zpk, lp2bs_zpk</span></div>
<div class="line"><span class="lineno"> 2606</span><span class="stringliteral">    bilinear</span></div>
<div class="line"><span class="lineno"> 2607</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2608</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2609</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2610</span><span class="stringliteral">    .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno"> 2611</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2612</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2613</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2614</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 2615</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 2616</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2617</span><span class="stringliteral">    &gt;&gt;&gt; fs = 100</span></div>
<div class="line"><span class="lineno"> 2618</span><span class="stringliteral">    &gt;&gt;&gt; bf = 2 * np.pi * np.array([7, 13])</span></div>
<div class="line"><span class="lineno"> 2619</span><span class="stringliteral">    &gt;&gt;&gt; filts = signal.lti(*signal.butter(4, bf, btype=&#39;bandpass&#39;, analog=True,</span></div>
<div class="line"><span class="lineno"> 2620</span><span class="stringliteral">    ...                                   output=&#39;zpk&#39;))</span></div>
<div class="line"><span class="lineno"> 2621</span><span class="stringliteral">    &gt;&gt;&gt; filtz = signal.lti(*signal.bilinear_zpk(filts.zeros, filts.poles,</span></div>
<div class="line"><span class="lineno"> 2622</span><span class="stringliteral">    ...                                         filts.gain, fs))</span></div>
<div class="line"><span class="lineno"> 2623</span><span class="stringliteral">    &gt;&gt;&gt; wz, hz = signal.freqz_zpk(filtz.zeros, filtz.poles, filtz.gain)</span></div>
<div class="line"><span class="lineno"> 2624</span><span class="stringliteral">    &gt;&gt;&gt; ws, hs = signal.freqs_zpk(filts.zeros, filts.poles, filts.gain,</span></div>
<div class="line"><span class="lineno"> 2625</span><span class="stringliteral">    ...                           worN=fs*wz)</span></div>
<div class="line"><span class="lineno"> 2626</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(wz*fs/(2*np.pi), 20*np.log10(np.abs(hz).clip(1e-15)),</span></div>
<div class="line"><span class="lineno"> 2627</span><span class="stringliteral">    ...              label=r&#39;$|H_z(e^{j \omega})|$&#39;)</span></div>
<div class="line"><span class="lineno"> 2628</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(wz*fs/(2*np.pi), 20*np.log10(np.abs(hs).clip(1e-15)),</span></div>
<div class="line"><span class="lineno"> 2629</span><span class="stringliteral">    ...              label=r&#39;$|H(j \omega)|$&#39;)</span></div>
<div class="line"><span class="lineno"> 2630</span><span class="stringliteral">    &gt;&gt;&gt; plt.legend()</span></div>
<div class="line"><span class="lineno"> 2631</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [Hz]&#39;)</span></div>
<div class="line"><span class="lineno"> 2632</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Magnitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 2633</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno"> 2634</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2635</span>    z = atleast_1d(z)</div>
<div class="line"><span class="lineno"> 2636</span>    p = atleast_1d(p)</div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span>    degree = _relative_degree(z, p)</div>
<div class="line"><span class="lineno"> 2639</span> </div>
<div class="line"><span class="lineno"> 2640</span>    fs2 = 2.0*fs</div>
<div class="line"><span class="lineno"> 2641</span> </div>
<div class="line"><span class="lineno"> 2642</span>    <span class="comment"># Bilinear transform the poles and zeros</span></div>
<div class="line"><span class="lineno"> 2643</span>    z_z = (fs2 + z) / (fs2 - z)</div>
<div class="line"><span class="lineno"> 2644</span>    p_z = (fs2 + p) / (fs2 - p)</div>
<div class="line"><span class="lineno"> 2645</span> </div>
<div class="line"><span class="lineno"> 2646</span>    <span class="comment"># Any zeros that were at infinity get moved to the Nyquist frequency</span></div>
<div class="line"><span class="lineno"> 2647</span>    z_z = append(z_z, -ones(degree))</div>
<div class="line"><span class="lineno"> 2648</span> </div>
<div class="line"><span class="lineno"> 2649</span>    <span class="comment"># Compensate for gain change</span></div>
<div class="line"><span class="lineno"> 2650</span>    k_z = k * real(prod(fs2 - z) / prod(fs2 - p))</div>
<div class="line"><span class="lineno"> 2651</span> </div>
<div class="line"><span class="lineno"> 2652</span>    <span class="keywordflow">return</span> z_z, p_z, k_z</div>
<div class="line"><span class="lineno"> 2653</span> </div>
<div class="line"><span class="lineno"> 2654</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="accb3d2394285c25575e31ab79e78633c" name="accb3d2394285c25575e31ab79e78633c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accb3d2394285c25575e31ab79e78633c">&#9670;&#160;</a></span>buttap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.buttap </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return (z,p,k) for analog prototype of Nth-order Butterworth filter.

The filter will have an angular (e.g., rad/s) cutoff frequency of 1.

See Also
--------
butter : Filter design function using this prototype</pre> <div class="fragment"><div class="line"><span class="lineno"> 4265</span><span class="keyword">def </span>buttap(N):</div>
<div class="line"><span class="lineno"> 4266</span>    <span class="stringliteral">&quot;&quot;&quot;Return (z,p,k) for analog prototype of Nth-order Butterworth filter.</span></div>
<div class="line"><span class="lineno"> 4267</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4268</span><span class="stringliteral">    The filter will have an angular (e.g., rad/s) cutoff frequency of 1.</span></div>
<div class="line"><span class="lineno"> 4269</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4270</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 4271</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4272</span><span class="stringliteral">    butter : Filter design function using this prototype</span></div>
<div class="line"><span class="lineno"> 4273</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4274</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4275</span>    <span class="keywordflow">if</span> abs(int(N)) != N:</div>
<div class="line"><span class="lineno"> 4276</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Filter order must be a nonnegative integer&quot;</span>)</div>
<div class="line"><span class="lineno"> 4277</span>    z = numpy.array([])</div>
<div class="line"><span class="lineno"> 4278</span>    m = numpy.arange(-N+1, N, 2)</div>
<div class="line"><span class="lineno"> 4279</span>    <span class="comment"># Middle value is 0 to ensure an exactly real pole</span></div>
<div class="line"><span class="lineno"> 4280</span>    p = -numpy.exp(1j * pi * m / (2 * N))</div>
<div class="line"><span class="lineno"> 4281</span>    k = 1</div>
<div class="line"><span class="lineno"> 4282</span>    <span class="keywordflow">return</span> z, p, k</div>
<div class="line"><span class="lineno"> 4283</span> </div>
<div class="line"><span class="lineno"> 4284</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4568219d096c6e4e5a091c63dbde4bb8" name="a4568219d096c6e4e5a091c63dbde4bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4568219d096c6e4e5a091c63dbde4bb8">&#9670;&#160;</a></span>butter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.butter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Wn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>btype</em> = <code>'low'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>'ba'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Butterworth digital and analog filter design.

Design an Nth-order digital or analog Butterworth filter and return
the filter coefficients.

Parameters
----------
N : int
    The order of the filter. For 'bandpass' and 'bandstop' filters,
    the resulting order of the final second-order sections ('sos')
    matrix is ``2*N``, with `N` the number of biquad sections
    of the desired system.
Wn : array_like
    The critical frequency or frequencies. For lowpass and highpass
    filters, Wn is a scalar; for bandpass and bandstop filters,
    Wn is a length-2 sequence.

    For a Butterworth filter, this is the point at which the gain
    drops to 1/sqrt(2) that of the passband (the "-3 dB point").

    For digital filters, if `fs` is not specified, `Wn` units are
    normalized from 0 to 1, where 1 is the Nyquist frequency (`Wn` is
    thus in half cycles / sample and defined as 2*critical frequencies
    / `fs`). If `fs` is specified, `Wn` is in the same units as `fs`.

    For analog filters, `Wn` is an angular frequency (e.g. rad/s).
btype : {'lowpass', 'highpass', 'bandpass', 'bandstop'}, optional
    The type of filter.  Default is 'lowpass'.
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
output : {'ba', 'zpk', 'sos'}, optional
    Type of output:  numerator/denominator ('ba'), pole-zero ('zpk'), or
    second-order sections ('sos'). Default is 'ba' for backwards
    compatibility, but 'sos' should be used for general-purpose filtering.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.
    Only returned if ``output='ba'``.
z, p, k : ndarray, ndarray, float
    Zeros, poles, and system gain of the IIR filter transfer
    function.  Only returned if ``output='zpk'``.
sos : ndarray
    Second-order sections representation of the IIR filter.
    Only returned if ``output=='sos'``.

See Also
--------
buttord, buttap

Notes
-----
The Butterworth filter has maximally flat frequency response in the
passband.

The ``'sos'`` output parameter was added in 0.16.0.

If the transfer function form ``[b, a]`` is requested, numerical
problems can occur since the conversion between roots and
the polynomial coefficients is a numerically sensitive operation,
even for N &gt;= 4. It is recommended to work with the SOS
representation.

Examples
--------
Design an analog filter and plot its frequency response, showing the
critical points:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; b, a = signal.butter(4, 100, 'low', analog=True)
&gt;&gt;&gt; w, h = signal.freqs(b, a)
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.title('Butterworth filter frequency response')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.axvline(100, color='green') # cutoff frequency
&gt;&gt;&gt; plt.show()

Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz

&gt;&gt;&gt; t = np.linspace(0, 1, 1000, False)  # 1 second
&gt;&gt;&gt; sig = np.sin(2*np.pi*10*t) + np.sin(2*np.pi*20*t)
&gt;&gt;&gt; fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)
&gt;&gt;&gt; ax1.plot(t, sig)
&gt;&gt;&gt; ax1.set_title('10 Hz and 20 Hz sinusoids')
&gt;&gt;&gt; ax1.axis([0, 1, -2, 2])

Design a digital high-pass filter at 15 Hz to remove the 10 Hz tone, and
apply it to the signal. (It's recommended to use second-order sections
format when filtering, to avoid numerical error with transfer function
(``ba``) format):

&gt;&gt;&gt; sos = signal.butter(10, 15, 'hp', fs=1000, output='sos')
&gt;&gt;&gt; filtered = signal.sosfilt(sos, sig)
&gt;&gt;&gt; ax2.plot(t, filtered)
&gt;&gt;&gt; ax2.set_title('After 15 Hz high-pass filter')
&gt;&gt;&gt; ax2.axis([0, 1, -2, 2])
&gt;&gt;&gt; ax2.set_xlabel('Time [seconds]')
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 2940</span><span class="keyword">def </span>butter(N, Wn, btype=&#39;low&#39;, analog=False, output=&#39;ba&#39;, fs=None):</div>
<div class="line"><span class="lineno"> 2941</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2942</span><span class="stringliteral">    Butterworth digital and analog filter design.</span></div>
<div class="line"><span class="lineno"> 2943</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2944</span><span class="stringliteral">    Design an Nth-order digital or analog Butterworth filter and return</span></div>
<div class="line"><span class="lineno"> 2945</span><span class="stringliteral">    the filter coefficients.</span></div>
<div class="line"><span class="lineno"> 2946</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2947</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2948</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2949</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno"> 2950</span><span class="stringliteral">        The order of the filter. For &#39;bandpass&#39; and &#39;bandstop&#39; filters,</span></div>
<div class="line"><span class="lineno"> 2951</span><span class="stringliteral">        the resulting order of the final second-order sections (&#39;sos&#39;)</span></div>
<div class="line"><span class="lineno"> 2952</span><span class="stringliteral">        matrix is ``2*N``, with `N` the number of biquad sections</span></div>
<div class="line"><span class="lineno"> 2953</span><span class="stringliteral">        of the desired system.</span></div>
<div class="line"><span class="lineno"> 2954</span><span class="stringliteral">    Wn : array_like</span></div>
<div class="line"><span class="lineno"> 2955</span><span class="stringliteral">        The critical frequency or frequencies. For lowpass and highpass</span></div>
<div class="line"><span class="lineno"> 2956</span><span class="stringliteral">        filters, Wn is a scalar; for bandpass and bandstop filters,</span></div>
<div class="line"><span class="lineno"> 2957</span><span class="stringliteral">        Wn is a length-2 sequence.</span></div>
<div class="line"><span class="lineno"> 2958</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2959</span><span class="stringliteral">        For a Butterworth filter, this is the point at which the gain</span></div>
<div class="line"><span class="lineno"> 2960</span><span class="stringliteral">        drops to 1/sqrt(2) that of the passband (the &quot;-3 dB point&quot;).</span></div>
<div class="line"><span class="lineno"> 2961</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2962</span><span class="stringliteral">        For digital filters, if `fs` is not specified, `Wn` units are</span></div>
<div class="line"><span class="lineno"> 2963</span><span class="stringliteral">        normalized from 0 to 1, where 1 is the Nyquist frequency (`Wn` is</span></div>
<div class="line"><span class="lineno"> 2964</span><span class="stringliteral">        thus in half cycles / sample and defined as 2*critical frequencies</span></div>
<div class="line"><span class="lineno"> 2965</span><span class="stringliteral">        / `fs`). If `fs` is specified, `Wn` is in the same units as `fs`.</span></div>
<div class="line"><span class="lineno"> 2966</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2967</span><span class="stringliteral">        For analog filters, `Wn` is an angular frequency (e.g. rad/s).</span></div>
<div class="line"><span class="lineno"> 2968</span><span class="stringliteral">    btype : {&#39;lowpass&#39;, &#39;highpass&#39;, &#39;bandpass&#39;, &#39;bandstop&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 2969</span><span class="stringliteral">        The type of filter.  Default is &#39;lowpass&#39;.</span></div>
<div class="line"><span class="lineno"> 2970</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 2971</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 2972</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 2973</span><span class="stringliteral">    output : {&#39;ba&#39;, &#39;zpk&#39;, &#39;sos&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 2974</span><span class="stringliteral">        Type of output:  numerator/denominator (&#39;ba&#39;), pole-zero (&#39;zpk&#39;), or</span></div>
<div class="line"><span class="lineno"> 2975</span><span class="stringliteral">        second-order sections (&#39;sos&#39;). Default is &#39;ba&#39; for backwards</span></div>
<div class="line"><span class="lineno"> 2976</span><span class="stringliteral">        compatibility, but &#39;sos&#39; should be used for general-purpose filtering.</span></div>
<div class="line"><span class="lineno"> 2977</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 2978</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 2979</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2980</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 2981</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2982</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2983</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2984</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 2985</span><span class="stringliteral">        Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 2986</span><span class="stringliteral">        Only returned if ``output=&#39;ba&#39;``.</span></div>
<div class="line"><span class="lineno"> 2987</span><span class="stringliteral">    z, p, k : ndarray, ndarray, float</span></div>
<div class="line"><span class="lineno"> 2988</span><span class="stringliteral">        Zeros, poles, and system gain of the IIR filter transfer</span></div>
<div class="line"><span class="lineno"> 2989</span><span class="stringliteral">        function.  Only returned if ``output=&#39;zpk&#39;``.</span></div>
<div class="line"><span class="lineno"> 2990</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 2991</span><span class="stringliteral">        Second-order sections representation of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 2992</span><span class="stringliteral">        Only returned if ``output==&#39;sos&#39;``.</span></div>
<div class="line"><span class="lineno"> 2993</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2994</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2995</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2996</span><span class="stringliteral">    buttord, buttap</span></div>
<div class="line"><span class="lineno"> 2997</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2998</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2999</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 3000</span><span class="stringliteral">    The Butterworth filter has maximally flat frequency response in the</span></div>
<div class="line"><span class="lineno"> 3001</span><span class="stringliteral">    passband.</span></div>
<div class="line"><span class="lineno"> 3002</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3003</span><span class="stringliteral">    The ``&#39;sos&#39;`` output parameter was added in 0.16.0.</span></div>
<div class="line"><span class="lineno"> 3004</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3005</span><span class="stringliteral">    If the transfer function form ``[b, a]`` is requested, numerical</span></div>
<div class="line"><span class="lineno"> 3006</span><span class="stringliteral">    problems can occur since the conversion between roots and</span></div>
<div class="line"><span class="lineno"> 3007</span><span class="stringliteral">    the polynomial coefficients is a numerically sensitive operation,</span></div>
<div class="line"><span class="lineno"> 3008</span><span class="stringliteral">    even for N &gt;= 4. It is recommended to work with the SOS</span></div>
<div class="line"><span class="lineno"> 3009</span><span class="stringliteral">    representation.</span></div>
<div class="line"><span class="lineno"> 3010</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3011</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3012</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3013</span><span class="stringliteral">    Design an analog filter and plot its frequency response, showing the</span></div>
<div class="line"><span class="lineno"> 3014</span><span class="stringliteral">    critical points:</span></div>
<div class="line"><span class="lineno"> 3015</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3016</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 3017</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 3018</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3019</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.butter(4, 100, &#39;low&#39;, analog=True)</span></div>
<div class="line"><span class="lineno"> 3020</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a)</span></div>
<div class="line"><span class="lineno"> 3021</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 3022</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Butterworth filter frequency response&#39;)</span></div>
<div class="line"><span class="lineno"> 3023</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3024</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 3025</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 3026</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3027</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(100, color=&#39;green&#39;) # cutoff frequency</span></div>
<div class="line"><span class="lineno"> 3028</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3029</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3030</span><span class="stringliteral">    Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz</span></div>
<div class="line"><span class="lineno"> 3031</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3032</span><span class="stringliteral">    &gt;&gt;&gt; t = np.linspace(0, 1, 1000, False)  # 1 second</span></div>
<div class="line"><span class="lineno"> 3033</span><span class="stringliteral">    &gt;&gt;&gt; sig = np.sin(2*np.pi*10*t) + np.sin(2*np.pi*20*t)</span></div>
<div class="line"><span class="lineno"> 3034</span><span class="stringliteral">    &gt;&gt;&gt; fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)</span></div>
<div class="line"><span class="lineno"> 3035</span><span class="stringliteral">    &gt;&gt;&gt; ax1.plot(t, sig)</span></div>
<div class="line"><span class="lineno"> 3036</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_title(&#39;10 Hz and 20 Hz sinusoids&#39;)</span></div>
<div class="line"><span class="lineno"> 3037</span><span class="stringliteral">    &gt;&gt;&gt; ax1.axis([0, 1, -2, 2])</span></div>
<div class="line"><span class="lineno"> 3038</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3039</span><span class="stringliteral">    Design a digital high-pass filter at 15 Hz to remove the 10 Hz tone, and</span></div>
<div class="line"><span class="lineno"> 3040</span><span class="stringliteral">    apply it to the signal. (It&#39;s recommended to use second-order sections</span></div>
<div class="line"><span class="lineno"> 3041</span><span class="stringliteral">    format when filtering, to avoid numerical error with transfer function</span></div>
<div class="line"><span class="lineno"> 3042</span><span class="stringliteral">    (``ba``) format):</span></div>
<div class="line"><span class="lineno"> 3043</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3044</span><span class="stringliteral">    &gt;&gt;&gt; sos = signal.butter(10, 15, &#39;hp&#39;, fs=1000, output=&#39;sos&#39;)</span></div>
<div class="line"><span class="lineno"> 3045</span><span class="stringliteral">    &gt;&gt;&gt; filtered = signal.sosfilt(sos, sig)</span></div>
<div class="line"><span class="lineno"> 3046</span><span class="stringliteral">    &gt;&gt;&gt; ax2.plot(t, filtered)</span></div>
<div class="line"><span class="lineno"> 3047</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_title(&#39;After 15 Hz high-pass filter&#39;)</span></div>
<div class="line"><span class="lineno"> 3048</span><span class="stringliteral">    &gt;&gt;&gt; ax2.axis([0, 1, -2, 2])</span></div>
<div class="line"><span class="lineno"> 3049</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_xlabel(&#39;Time [seconds]&#39;)</span></div>
<div class="line"><span class="lineno"> 3050</span><span class="stringliteral">    &gt;&gt;&gt; plt.tight_layout()</span></div>
<div class="line"><span class="lineno"> 3051</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3052</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3053</span>    <span class="keywordflow">return</span> iirfilter(N, Wn, btype=btype, analog=analog,</div>
<div class="line"><span class="lineno"> 3054</span>                     output=output, ftype=<span class="stringliteral">&#39;butter&#39;</span>, fs=fs)</div>
<div class="line"><span class="lineno"> 3055</span> </div>
<div class="line"><span class="lineno"> 3056</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a91da99d4aea5955bfa7a499a8e815bf4" name="a91da99d4aea5955bfa7a499a8e815bf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91da99d4aea5955bfa7a499a8e815bf4">&#9670;&#160;</a></span>buttord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.buttord </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gstop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Butterworth filter order selection.

Return the order of the lowest order digital or analog Butterworth filter
that loses no more than `gpass` dB in the passband and has at least
`gstop` dB attenuation in the stopband.

Parameters
----------
wp, ws : float
    Passband and stopband edge frequencies.

    For digital filters, these are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`wp` and `ws` are thus in
    half-cycles / sample.) For example:

        - Lowpass:   wp = 0.2,          ws = 0.3
        - Highpass:  wp = 0.3,          ws = 0.2
        - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]
        - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]

    For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).
gpass : float
    The maximum loss in the passband (dB).
gstop : float
    The minimum attenuation in the stopband (dB).
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
ord : int
    The lowest order for a Butterworth filter which meets specs.
wn : ndarray or float
    The Butterworth natural frequency (i.e. the "3dB frequency"). Should
    be used with `butter` to give filter results. If `fs` is specified,
    this is in the same units, and `fs` must also be passed to `butter`.

See Also
--------
butter : Filter design using order and critical points
cheb1ord : Find order and critical points from passband and stopband spec
cheb2ord, ellipord
iirfilter : General filter design using order and critical frequencies
iirdesign : General filter design using passband and stopband spec

Examples
--------
Design an analog bandpass filter with passband within 3 dB from 20 to
50 rad/s, while rejecting at least -40 dB below 14 and above 60 rad/s.
Plot its frequency response, showing the passband and stopband
constraints in gray.

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; N, Wn = signal.buttord([20, 50], [14, 60], 3, 40, True)
&gt;&gt;&gt; b, a = signal.butter(N, Wn, 'band', True)
&gt;&gt;&gt; w, h = signal.freqs(b, a, np.logspace(1, 2, 500))
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.title('Butterworth bandpass filter fit to constraints')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.fill([1,  14,  14,   1], [-40, -40, 99, 99], '0.9', lw=0) # stop
&gt;&gt;&gt; plt.fill([20, 20,  50,  50], [-99, -3, -3, -99], '0.9', lw=0) # pass
&gt;&gt;&gt; plt.fill([60, 60, 1e9, 1e9], [99, -40, -40, 99], '0.9', lw=0) # stop
&gt;&gt;&gt; plt.axis([10, 100, -60, 3])
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno"> 3638</span><span class="keyword">def </span>buttord(wp, ws, gpass, gstop, analog=False, fs=None):</div>
<div class="line"><span class="lineno"> 3639</span>    <span class="stringliteral">&quot;&quot;&quot;Butterworth filter order selection.</span></div>
<div class="line"><span class="lineno"> 3640</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3641</span><span class="stringliteral">    Return the order of the lowest order digital or analog Butterworth filter</span></div>
<div class="line"><span class="lineno"> 3642</span><span class="stringliteral">    that loses no more than `gpass` dB in the passband and has at least</span></div>
<div class="line"><span class="lineno"> 3643</span><span class="stringliteral">    `gstop` dB attenuation in the stopband.</span></div>
<div class="line"><span class="lineno"> 3644</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3645</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3646</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3647</span><span class="stringliteral">    wp, ws : float</span></div>
<div class="line"><span class="lineno"> 3648</span><span class="stringliteral">        Passband and stopband edge frequencies.</span></div>
<div class="line"><span class="lineno"> 3649</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3650</span><span class="stringliteral">        For digital filters, these are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 3651</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 3652</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`wp` and `ws` are thus in</span></div>
<div class="line"><span class="lineno"> 3653</span><span class="stringliteral">        half-cycles / sample.) For example:</span></div>
<div class="line"><span class="lineno"> 3654</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3655</span><span class="stringliteral">            - Lowpass:   wp = 0.2,          ws = 0.3</span></div>
<div class="line"><span class="lineno"> 3656</span><span class="stringliteral">            - Highpass:  wp = 0.3,          ws = 0.2</span></div>
<div class="line"><span class="lineno"> 3657</span><span class="stringliteral">            - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]</span></div>
<div class="line"><span class="lineno"> 3658</span><span class="stringliteral">            - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]</span></div>
<div class="line"><span class="lineno"> 3659</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3660</span><span class="stringliteral">        For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 3661</span><span class="stringliteral">    gpass : float</span></div>
<div class="line"><span class="lineno"> 3662</span><span class="stringliteral">        The maximum loss in the passband (dB).</span></div>
<div class="line"><span class="lineno"> 3663</span><span class="stringliteral">    gstop : float</span></div>
<div class="line"><span class="lineno"> 3664</span><span class="stringliteral">        The minimum attenuation in the stopband (dB).</span></div>
<div class="line"><span class="lineno"> 3665</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 3666</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 3667</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 3668</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 3669</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 3670</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3671</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 3672</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3673</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3674</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3675</span><span class="stringliteral">    ord : int</span></div>
<div class="line"><span class="lineno"> 3676</span><span class="stringliteral">        The lowest order for a Butterworth filter which meets specs.</span></div>
<div class="line"><span class="lineno"> 3677</span><span class="stringliteral">    wn : ndarray or float</span></div>
<div class="line"><span class="lineno"> 3678</span><span class="stringliteral">        The Butterworth natural frequency (i.e. the &quot;3dB frequency&quot;). Should</span></div>
<div class="line"><span class="lineno"> 3679</span><span class="stringliteral">        be used with `butter` to give filter results. If `fs` is specified,</span></div>
<div class="line"><span class="lineno"> 3680</span><span class="stringliteral">        this is in the same units, and `fs` must also be passed to `butter`.</span></div>
<div class="line"><span class="lineno"> 3681</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3682</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 3683</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3684</span><span class="stringliteral">    butter : Filter design using order and critical points</span></div>
<div class="line"><span class="lineno"> 3685</span><span class="stringliteral">    cheb1ord : Find order and critical points from passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 3686</span><span class="stringliteral">    cheb2ord, ellipord</span></div>
<div class="line"><span class="lineno"> 3687</span><span class="stringliteral">    iirfilter : General filter design using order and critical frequencies</span></div>
<div class="line"><span class="lineno"> 3688</span><span class="stringliteral">    iirdesign : General filter design using passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 3689</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3690</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3691</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3692</span><span class="stringliteral">    Design an analog bandpass filter with passband within 3 dB from 20 to</span></div>
<div class="line"><span class="lineno"> 3693</span><span class="stringliteral">    50 rad/s, while rejecting at least -40 dB below 14 and above 60 rad/s.</span></div>
<div class="line"><span class="lineno"> 3694</span><span class="stringliteral">    Plot its frequency response, showing the passband and stopband</span></div>
<div class="line"><span class="lineno"> 3695</span><span class="stringliteral">    constraints in gray.</span></div>
<div class="line"><span class="lineno"> 3696</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3697</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 3698</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 3699</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3700</span><span class="stringliteral">    &gt;&gt;&gt; N, Wn = signal.buttord([20, 50], [14, 60], 3, 40, True)</span></div>
<div class="line"><span class="lineno"> 3701</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.butter(N, Wn, &#39;band&#39;, True)</span></div>
<div class="line"><span class="lineno"> 3702</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a, np.logspace(1, 2, 500))</span></div>
<div class="line"><span class="lineno"> 3703</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 3704</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Butterworth bandpass filter fit to constraints&#39;)</span></div>
<div class="line"><span class="lineno"> 3705</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3706</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 3707</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3708</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([1,  14,  14,   1], [-40, -40, 99, 99], &#39;0.9&#39;, lw=0) # stop</span></div>
<div class="line"><span class="lineno"> 3709</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([20, 20,  50,  50], [-99, -3, -3, -99], &#39;0.9&#39;, lw=0) # pass</span></div>
<div class="line"><span class="lineno"> 3710</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([60, 60, 1e9, 1e9], [99, -40, -40, 99], &#39;0.9&#39;, lw=0) # stop</span></div>
<div class="line"><span class="lineno"> 3711</span><span class="stringliteral">    &gt;&gt;&gt; plt.axis([10, 100, -60, 3])</span></div>
<div class="line"><span class="lineno"> 3712</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3713</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3714</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3715</span> </div>
<div class="line"><span class="lineno"> 3716</span>    _validate_gpass_gstop(gpass, gstop)</div>
<div class="line"><span class="lineno"> 3717</span> </div>
<div class="line"><span class="lineno"> 3718</span>    wp = atleast_1d(wp)</div>
<div class="line"><span class="lineno"> 3719</span>    ws = atleast_1d(ws)</div>
<div class="line"><span class="lineno"> 3720</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3721</span>        <span class="keywordflow">if</span> analog:</div>
<div class="line"><span class="lineno"> 3722</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;fs cannot be specified for an analog filter&quot;</span>)</div>
<div class="line"><span class="lineno"> 3723</span>        wp = 2*wp/fs</div>
<div class="line"><span class="lineno"> 3724</span>        ws = 2*ws/fs</div>
<div class="line"><span class="lineno"> 3725</span> </div>
<div class="line"><span class="lineno"> 3726</span>    filter_type = 2 * (len(wp) - 1)</div>
<div class="line"><span class="lineno"> 3727</span>    filter_type += 1</div>
<div class="line"><span class="lineno"> 3728</span>    <span class="keywordflow">if</span> wp[0] &gt;= ws[0]:</div>
<div class="line"><span class="lineno"> 3729</span>        filter_type += 1</div>
<div class="line"><span class="lineno"> 3730</span> </div>
<div class="line"><span class="lineno"> 3731</span>    <span class="comment"># Pre-warp frequencies for digital filter design</span></div>
<div class="line"><span class="lineno"> 3732</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 3733</span>        passb = tan(pi * wp / 2.0)</div>
<div class="line"><span class="lineno"> 3734</span>        stopb = tan(pi * ws / 2.0)</div>
<div class="line"><span class="lineno"> 3735</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3736</span>        passb = wp * 1.0</div>
<div class="line"><span class="lineno"> 3737</span>        stopb = ws * 1.0</div>
<div class="line"><span class="lineno"> 3738</span> </div>
<div class="line"><span class="lineno"> 3739</span>    <span class="keywordflow">if</span> filter_type == 1:            <span class="comment"># low</span></div>
<div class="line"><span class="lineno"> 3740</span>        nat = stopb / passb</div>
<div class="line"><span class="lineno"> 3741</span>    <span class="keywordflow">elif</span> filter_type == 2:          <span class="comment"># high</span></div>
<div class="line"><span class="lineno"> 3742</span>        nat = passb / stopb</div>
<div class="line"><span class="lineno"> 3743</span>    <span class="keywordflow">elif</span> filter_type == 3:          <span class="comment"># stop</span></div>
<div class="line"><span class="lineno"> 3744</span>        wp0 = optimize.fminbound(band_stop_obj, passb[0], stopb[0] - 1e-12,</div>
<div class="line"><span class="lineno"> 3745</span>                                 args=(0, passb, stopb, gpass, gstop,</div>
<div class="line"><span class="lineno"> 3746</span>                                       <span class="stringliteral">&#39;butter&#39;</span>),</div>
<div class="line"><span class="lineno"> 3747</span>                                 disp=0)</div>
<div class="line"><span class="lineno"> 3748</span>        passb[0] = wp0</div>
<div class="line"><span class="lineno"> 3749</span>        wp1 = optimize.fminbound(band_stop_obj, stopb[1] + 1e-12, passb[1],</div>
<div class="line"><span class="lineno"> 3750</span>                                 args=(1, passb, stopb, gpass, gstop,</div>
<div class="line"><span class="lineno"> 3751</span>                                       <span class="stringliteral">&#39;butter&#39;</span>),</div>
<div class="line"><span class="lineno"> 3752</span>                                 disp=0)</div>
<div class="line"><span class="lineno"> 3753</span>        passb[1] = wp1</div>
<div class="line"><span class="lineno"> 3754</span>        nat = ((stopb * (passb[0] - passb[1])) /</div>
<div class="line"><span class="lineno"> 3755</span>               (stopb ** 2 - passb[0] * passb[1]))</div>
<div class="line"><span class="lineno"> 3756</span>    <span class="keywordflow">elif</span> filter_type == 4:          <span class="comment"># pass</span></div>
<div class="line"><span class="lineno"> 3757</span>        nat = ((stopb ** 2 - passb[0] * passb[1]) /</div>
<div class="line"><span class="lineno"> 3758</span>               (stopb * (passb[0] - passb[1])))</div>
<div class="line"><span class="lineno"> 3759</span> </div>
<div class="line"><span class="lineno"> 3760</span>    nat = min(abs(nat))</div>
<div class="line"><span class="lineno"> 3761</span> </div>
<div class="line"><span class="lineno"> 3762</span>    GSTOP = 10 ** (0.1 * abs(gstop))</div>
<div class="line"><span class="lineno"> 3763</span>    GPASS = 10 ** (0.1 * abs(gpass))</div>
<div class="line"><span class="lineno"> 3764</span>    ord = int(ceil(log10((GSTOP - 1.0) / (GPASS - 1.0)) / (2 * log10(nat))))</div>
<div class="line"><span class="lineno"> 3765</span> </div>
<div class="line"><span class="lineno"> 3766</span>    <span class="comment"># Find the Butterworth natural frequency WN (or the &quot;3dB&quot; frequency&quot;)</span></div>
<div class="line"><span class="lineno"> 3767</span>    <span class="comment"># to give exactly gpass at passb.</span></div>
<div class="line"><span class="lineno"> 3768</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 3769</span>        W0 = (GPASS - 1.0) ** (-1.0 / (2.0 * ord))</div>
<div class="line"><span class="lineno"> 3770</span>    <span class="keywordflow">except</span> ZeroDivisionError:</div>
<div class="line"><span class="lineno"> 3771</span>        W0 = 1.0</div>
<div class="line"><span class="lineno"> 3772</span>        warnings.warn(<span class="stringliteral">&quot;Order is zero...check input parameters.&quot;</span>,</div>
<div class="line"><span class="lineno"> 3773</span>                      RuntimeWarning, 2)</div>
<div class="line"><span class="lineno"> 3774</span> </div>
<div class="line"><span class="lineno"> 3775</span>    <span class="comment"># now convert this frequency back from lowpass prototype</span></div>
<div class="line"><span class="lineno"> 3776</span>    <span class="comment"># to the original analog filter</span></div>
<div class="line"><span class="lineno"> 3777</span> </div>
<div class="line"><span class="lineno"> 3778</span>    <span class="keywordflow">if</span> filter_type == 1:  <span class="comment"># low</span></div>
<div class="line"><span class="lineno"> 3779</span>        WN = W0 * passb</div>
<div class="line"><span class="lineno"> 3780</span>    <span class="keywordflow">elif</span> filter_type == 2:  <span class="comment"># high</span></div>
<div class="line"><span class="lineno"> 3781</span>        WN = passb / W0</div>
<div class="line"><span class="lineno"> 3782</span>    <span class="keywordflow">elif</span> filter_type == 3:  <span class="comment"># stop</span></div>
<div class="line"><span class="lineno"> 3783</span>        WN = numpy.empty(2, float)</div>
<div class="line"><span class="lineno"> 3784</span>        discr = sqrt((passb[1] - passb[0]) ** 2 +</div>
<div class="line"><span class="lineno"> 3785</span>                     4 * W0 ** 2 * passb[0] * passb[1])</div>
<div class="line"><span class="lineno"> 3786</span>        WN[0] = ((passb[1] - passb[0]) + discr) / (2 * W0)</div>
<div class="line"><span class="lineno"> 3787</span>        WN[1] = ((passb[1] - passb[0]) - discr) / (2 * W0)</div>
<div class="line"><span class="lineno"> 3788</span>        WN = numpy.sort(abs(WN))</div>
<div class="line"><span class="lineno"> 3789</span>    <span class="keywordflow">elif</span> filter_type == 4:  <span class="comment"># pass</span></div>
<div class="line"><span class="lineno"> 3790</span>        W0 = numpy.array([-W0, W0], float)</div>
<div class="line"><span class="lineno"> 3791</span>        WN = (-W0 * (passb[1] - passb[0]) / 2.0 +</div>
<div class="line"><span class="lineno"> 3792</span>              sqrt(W0 ** 2 / 4.0 * (passb[1] - passb[0]) ** 2 +</div>
<div class="line"><span class="lineno"> 3793</span>                   passb[0] * passb[1]))</div>
<div class="line"><span class="lineno"> 3794</span>        WN = numpy.sort(abs(WN))</div>
<div class="line"><span class="lineno"> 3795</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3796</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Bad type: %s&quot;</span> % filter_type)</div>
<div class="line"><span class="lineno"> 3797</span> </div>
<div class="line"><span class="lineno"> 3798</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 3799</span>        wn = (2.0 / pi) * arctan(WN)</div>
<div class="line"><span class="lineno"> 3800</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3801</span>        wn = WN</div>
<div class="line"><span class="lineno"> 3802</span> </div>
<div class="line"><span class="lineno"> 3803</span>    <span class="keywordflow">if</span> len(wn) == 1:</div>
<div class="line"><span class="lineno"> 3804</span>        wn = wn[0]</div>
<div class="line"><span class="lineno"> 3805</span> </div>
<div class="line"><span class="lineno"> 3806</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3807</span>        wn = wn*fs/2</div>
<div class="line"><span class="lineno"> 3808</span> </div>
<div class="line"><span class="lineno"> 3809</span>    <span class="keywordflow">return</span> ord, wn</div>
<div class="line"><span class="lineno"> 3810</span> </div>
<div class="line"><span class="lineno"> 3811</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bff6c7f370bc3d69ca665c99c72b991" name="a8bff6c7f370bc3d69ca665c99c72b991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bff6c7f370bc3d69ca665c99c72b991">&#9670;&#160;</a></span>cheb1ap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.cheb1ap </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return (z,p,k) for Nth-order Chebyshev type I analog lowpass filter.

The returned filter prototype has `rp` decibels of ripple in the passband.

The filter's angular (e.g. rad/s) cutoff frequency is normalized to 1,
defined as the point at which the gain first drops below ``-rp``.

See Also
--------
cheby1 : Filter design function using this prototype</pre> <div class="fragment"><div class="line"><span class="lineno"> 4285</span><span class="keyword">def </span>cheb1ap(N, rp):</div>
<div class="line"><span class="lineno"> 4286</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4287</span><span class="stringliteral">    Return (z,p,k) for Nth-order Chebyshev type I analog lowpass filter.</span></div>
<div class="line"><span class="lineno"> 4288</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4289</span><span class="stringliteral">    The returned filter prototype has `rp` decibels of ripple in the passband.</span></div>
<div class="line"><span class="lineno"> 4290</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4291</span><span class="stringliteral">    The filter&#39;s angular (e.g. rad/s) cutoff frequency is normalized to 1,</span></div>
<div class="line"><span class="lineno"> 4292</span><span class="stringliteral">    defined as the point at which the gain first drops below ``-rp``.</span></div>
<div class="line"><span class="lineno"> 4293</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4294</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 4295</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4296</span><span class="stringliteral">    cheby1 : Filter design function using this prototype</span></div>
<div class="line"><span class="lineno"> 4297</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4298</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4299</span>    <span class="keywordflow">if</span> abs(int(N)) != N:</div>
<div class="line"><span class="lineno"> 4300</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Filter order must be a nonnegative integer&quot;</span>)</div>
<div class="line"><span class="lineno"> 4301</span>    <span class="keywordflow">elif</span> N == 0:</div>
<div class="line"><span class="lineno"> 4302</span>        <span class="comment"># Avoid divide-by-zero error</span></div>
<div class="line"><span class="lineno"> 4303</span>        <span class="comment"># Even order filters have DC gain of -rp dB</span></div>
<div class="line"><span class="lineno"> 4304</span>        <span class="keywordflow">return</span> numpy.array([]), numpy.array([]), 10**(-rp/20)</div>
<div class="line"><span class="lineno"> 4305</span>    z = numpy.array([])</div>
<div class="line"><span class="lineno"> 4306</span> </div>
<div class="line"><span class="lineno"> 4307</span>    <span class="comment"># Ripple factor (epsilon)</span></div>
<div class="line"><span class="lineno"> 4308</span>    eps = numpy.sqrt(10 ** (0.1 * rp) - 1.0)</div>
<div class="line"><span class="lineno"> 4309</span>    mu = 1.0 / N * arcsinh(1 / eps)</div>
<div class="line"><span class="lineno"> 4310</span> </div>
<div class="line"><span class="lineno"> 4311</span>    <span class="comment"># Arrange poles in an ellipse on the left half of the S-plane</span></div>
<div class="line"><span class="lineno"> 4312</span>    m = numpy.arange(-N+1, N, 2)</div>
<div class="line"><span class="lineno"> 4313</span>    theta = pi * m / (2*N)</div>
<div class="line"><span class="lineno"> 4314</span>    p = -sinh(mu + 1j*theta)</div>
<div class="line"><span class="lineno"> 4315</span> </div>
<div class="line"><span class="lineno"> 4316</span>    k = numpy.prod(-p, axis=0).real</div>
<div class="line"><span class="lineno"> 4317</span>    <span class="keywordflow">if</span> N % 2 == 0:</div>
<div class="line"><span class="lineno"> 4318</span>        k = k / sqrt((1 + eps * eps))</div>
<div class="line"><span class="lineno"> 4319</span> </div>
<div class="line"><span class="lineno"> 4320</span>    <span class="keywordflow">return</span> z, p, k</div>
<div class="line"><span class="lineno"> 4321</span> </div>
<div class="line"><span class="lineno"> 4322</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7faa130bd1b19c1b14542e764b6fe3c8" name="a7faa130bd1b19c1b14542e764b6fe3c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7faa130bd1b19c1b14542e764b6fe3c8">&#9670;&#160;</a></span>cheb1ord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.cheb1ord </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gstop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Chebyshev type I filter order selection.

Return the order of the lowest order digital or analog Chebyshev Type I
filter that loses no more than `gpass` dB in the passband and has at
least `gstop` dB attenuation in the stopband.

Parameters
----------
wp, ws : float
    Passband and stopband edge frequencies.

    For digital filters, these are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`wp` and `ws` are thus in
    half-cycles / sample.)  For example:

        - Lowpass:   wp = 0.2,          ws = 0.3
        - Highpass:  wp = 0.3,          ws = 0.2
        - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]
        - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]

    For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).
gpass : float
    The maximum loss in the passband (dB).
gstop : float
    The minimum attenuation in the stopband (dB).
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
ord : int
    The lowest order for a Chebyshev type I filter that meets specs.
wn : ndarray or float
    The Chebyshev natural frequency (the "3dB frequency") for use with
    `cheby1` to give filter results. If `fs` is specified,
    this is in the same units, and `fs` must also be passed to `cheby1`.

See Also
--------
cheby1 : Filter design using order and critical points
buttord : Find order and critical points from passband and stopband spec
cheb2ord, ellipord
iirfilter : General filter design using order and critical frequencies
iirdesign : General filter design using passband and stopband spec

Examples
--------
Design a digital lowpass filter such that the passband is within 3 dB up
to 0.2*(fs/2), while rejecting at least -40 dB above 0.3*(fs/2). Plot its
frequency response, showing the passband and stopband constraints in gray.

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; N, Wn = signal.cheb1ord(0.2, 0.3, 3, 40)
&gt;&gt;&gt; b, a = signal.cheby1(N, 3, Wn, 'low')
&gt;&gt;&gt; w, h = signal.freqz(b, a)
&gt;&gt;&gt; plt.semilogx(w / np.pi, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.title('Chebyshev I lowpass filter fit to constraints')
&gt;&gt;&gt; plt.xlabel('Normalized frequency')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.fill([.01, 0.2, 0.2, .01], [-3, -3, -99, -99], '0.9', lw=0) # stop
&gt;&gt;&gt; plt.fill([0.3, 0.3,   2,   2], [ 9, -40, -40,  9], '0.9', lw=0) # pass
&gt;&gt;&gt; plt.axis([0.08, 1, -60, 3])
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno"> 3812</span><span class="keyword">def </span>cheb1ord(wp, ws, gpass, gstop, analog=False, fs=None):</div>
<div class="line"><span class="lineno"> 3813</span>    <span class="stringliteral">&quot;&quot;&quot;Chebyshev type I filter order selection.</span></div>
<div class="line"><span class="lineno"> 3814</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3815</span><span class="stringliteral">    Return the order of the lowest order digital or analog Chebyshev Type I</span></div>
<div class="line"><span class="lineno"> 3816</span><span class="stringliteral">    filter that loses no more than `gpass` dB in the passband and has at</span></div>
<div class="line"><span class="lineno"> 3817</span><span class="stringliteral">    least `gstop` dB attenuation in the stopband.</span></div>
<div class="line"><span class="lineno"> 3818</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3819</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3820</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3821</span><span class="stringliteral">    wp, ws : float</span></div>
<div class="line"><span class="lineno"> 3822</span><span class="stringliteral">        Passband and stopband edge frequencies.</span></div>
<div class="line"><span class="lineno"> 3823</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3824</span><span class="stringliteral">        For digital filters, these are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 3825</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 3826</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`wp` and `ws` are thus in</span></div>
<div class="line"><span class="lineno"> 3827</span><span class="stringliteral">        half-cycles / sample.)  For example:</span></div>
<div class="line"><span class="lineno"> 3828</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3829</span><span class="stringliteral">            - Lowpass:   wp = 0.2,          ws = 0.3</span></div>
<div class="line"><span class="lineno"> 3830</span><span class="stringliteral">            - Highpass:  wp = 0.3,          ws = 0.2</span></div>
<div class="line"><span class="lineno"> 3831</span><span class="stringliteral">            - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]</span></div>
<div class="line"><span class="lineno"> 3832</span><span class="stringliteral">            - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]</span></div>
<div class="line"><span class="lineno"> 3833</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3834</span><span class="stringliteral">        For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 3835</span><span class="stringliteral">    gpass : float</span></div>
<div class="line"><span class="lineno"> 3836</span><span class="stringliteral">        The maximum loss in the passband (dB).</span></div>
<div class="line"><span class="lineno"> 3837</span><span class="stringliteral">    gstop : float</span></div>
<div class="line"><span class="lineno"> 3838</span><span class="stringliteral">        The minimum attenuation in the stopband (dB).</span></div>
<div class="line"><span class="lineno"> 3839</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 3840</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 3841</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 3842</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 3843</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 3844</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3845</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 3846</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3847</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3848</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3849</span><span class="stringliteral">    ord : int</span></div>
<div class="line"><span class="lineno"> 3850</span><span class="stringliteral">        The lowest order for a Chebyshev type I filter that meets specs.</span></div>
<div class="line"><span class="lineno"> 3851</span><span class="stringliteral">    wn : ndarray or float</span></div>
<div class="line"><span class="lineno"> 3852</span><span class="stringliteral">        The Chebyshev natural frequency (the &quot;3dB frequency&quot;) for use with</span></div>
<div class="line"><span class="lineno"> 3853</span><span class="stringliteral">        `cheby1` to give filter results. If `fs` is specified,</span></div>
<div class="line"><span class="lineno"> 3854</span><span class="stringliteral">        this is in the same units, and `fs` must also be passed to `cheby1`.</span></div>
<div class="line"><span class="lineno"> 3855</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3856</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 3857</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3858</span><span class="stringliteral">    cheby1 : Filter design using order and critical points</span></div>
<div class="line"><span class="lineno"> 3859</span><span class="stringliteral">    buttord : Find order and critical points from passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 3860</span><span class="stringliteral">    cheb2ord, ellipord</span></div>
<div class="line"><span class="lineno"> 3861</span><span class="stringliteral">    iirfilter : General filter design using order and critical frequencies</span></div>
<div class="line"><span class="lineno"> 3862</span><span class="stringliteral">    iirdesign : General filter design using passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 3863</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3864</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3865</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3866</span><span class="stringliteral">    Design a digital lowpass filter such that the passband is within 3 dB up</span></div>
<div class="line"><span class="lineno"> 3867</span><span class="stringliteral">    to 0.2*(fs/2), while rejecting at least -40 dB above 0.3*(fs/2). Plot its</span></div>
<div class="line"><span class="lineno"> 3868</span><span class="stringliteral">    frequency response, showing the passband and stopband constraints in gray.</span></div>
<div class="line"><span class="lineno"> 3869</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3870</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 3871</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 3872</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3873</span><span class="stringliteral">    &gt;&gt;&gt; N, Wn = signal.cheb1ord(0.2, 0.3, 3, 40)</span></div>
<div class="line"><span class="lineno"> 3874</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.cheby1(N, 3, Wn, &#39;low&#39;)</span></div>
<div class="line"><span class="lineno"> 3875</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz(b, a)</span></div>
<div class="line"><span class="lineno"> 3876</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w / np.pi, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 3877</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Chebyshev I lowpass filter fit to constraints&#39;)</span></div>
<div class="line"><span class="lineno"> 3878</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Normalized frequency&#39;)</span></div>
<div class="line"><span class="lineno"> 3879</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 3880</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3881</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([.01, 0.2, 0.2, .01], [-3, -3, -99, -99], &#39;0.9&#39;, lw=0) # stop</span></div>
<div class="line"><span class="lineno"> 3882</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([0.3, 0.3,   2,   2], [ 9, -40, -40,  9], &#39;0.9&#39;, lw=0) # pass</span></div>
<div class="line"><span class="lineno"> 3883</span><span class="stringliteral">    &gt;&gt;&gt; plt.axis([0.08, 1, -60, 3])</span></div>
<div class="line"><span class="lineno"> 3884</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3885</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3886</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3887</span> </div>
<div class="line"><span class="lineno"> 3888</span>    _validate_gpass_gstop(gpass, gstop)</div>
<div class="line"><span class="lineno"> 3889</span> </div>
<div class="line"><span class="lineno"> 3890</span>    wp = atleast_1d(wp)</div>
<div class="line"><span class="lineno"> 3891</span>    ws = atleast_1d(ws)</div>
<div class="line"><span class="lineno"> 3892</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3893</span>        <span class="keywordflow">if</span> analog:</div>
<div class="line"><span class="lineno"> 3894</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;fs cannot be specified for an analog filter&quot;</span>)</div>
<div class="line"><span class="lineno"> 3895</span>        wp = 2*wp/fs</div>
<div class="line"><span class="lineno"> 3896</span>        ws = 2*ws/fs</div>
<div class="line"><span class="lineno"> 3897</span> </div>
<div class="line"><span class="lineno"> 3898</span>    filter_type = 2 * (len(wp) - 1)</div>
<div class="line"><span class="lineno"> 3899</span>    <span class="keywordflow">if</span> wp[0] &lt; ws[0]:</div>
<div class="line"><span class="lineno"> 3900</span>        filter_type += 1</div>
<div class="line"><span class="lineno"> 3901</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3902</span>        filter_type += 2</div>
<div class="line"><span class="lineno"> 3903</span> </div>
<div class="line"><span class="lineno"> 3904</span>    <span class="comment"># Pre-warp frequencies for digital filter design</span></div>
<div class="line"><span class="lineno"> 3905</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 3906</span>        passb = tan(pi * wp / 2.0)</div>
<div class="line"><span class="lineno"> 3907</span>        stopb = tan(pi * ws / 2.0)</div>
<div class="line"><span class="lineno"> 3908</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3909</span>        passb = wp * 1.0</div>
<div class="line"><span class="lineno"> 3910</span>        stopb = ws * 1.0</div>
<div class="line"><span class="lineno"> 3911</span> </div>
<div class="line"><span class="lineno"> 3912</span>    <span class="keywordflow">if</span> filter_type == 1:           <span class="comment"># low</span></div>
<div class="line"><span class="lineno"> 3913</span>        nat = stopb / passb</div>
<div class="line"><span class="lineno"> 3914</span>    <span class="keywordflow">elif</span> filter_type == 2:          <span class="comment"># high</span></div>
<div class="line"><span class="lineno"> 3915</span>        nat = passb / stopb</div>
<div class="line"><span class="lineno"> 3916</span>    <span class="keywordflow">elif</span> filter_type == 3:     <span class="comment"># stop</span></div>
<div class="line"><span class="lineno"> 3917</span>        wp0 = optimize.fminbound(band_stop_obj, passb[0], stopb[0] - 1e-12,</div>
<div class="line"><span class="lineno"> 3918</span>                                 args=(0, passb, stopb, gpass, gstop, <span class="stringliteral">&#39;cheby&#39;</span>),</div>
<div class="line"><span class="lineno"> 3919</span>                                 disp=0)</div>
<div class="line"><span class="lineno"> 3920</span>        passb[0] = wp0</div>
<div class="line"><span class="lineno"> 3921</span>        wp1 = optimize.fminbound(band_stop_obj, stopb[1] + 1e-12, passb[1],</div>
<div class="line"><span class="lineno"> 3922</span>                                 args=(1, passb, stopb, gpass, gstop, <span class="stringliteral">&#39;cheby&#39;</span>),</div>
<div class="line"><span class="lineno"> 3923</span>                                 disp=0)</div>
<div class="line"><span class="lineno"> 3924</span>        passb[1] = wp1</div>
<div class="line"><span class="lineno"> 3925</span>        nat = ((stopb * (passb[0] - passb[1])) /</div>
<div class="line"><span class="lineno"> 3926</span>               (stopb ** 2 - passb[0] * passb[1]))</div>
<div class="line"><span class="lineno"> 3927</span>    <span class="keywordflow">elif</span> filter_type == 4:  <span class="comment"># pass</span></div>
<div class="line"><span class="lineno"> 3928</span>        nat = ((stopb ** 2 - passb[0] * passb[1]) /</div>
<div class="line"><span class="lineno"> 3929</span>               (stopb * (passb[0] - passb[1])))</div>
<div class="line"><span class="lineno"> 3930</span> </div>
<div class="line"><span class="lineno"> 3931</span>    nat = min(abs(nat))</div>
<div class="line"><span class="lineno"> 3932</span> </div>
<div class="line"><span class="lineno"> 3933</span>    GSTOP = 10 ** (0.1 * abs(gstop))</div>
<div class="line"><span class="lineno"> 3934</span>    GPASS = 10 ** (0.1 * abs(gpass))</div>
<div class="line"><span class="lineno"> 3935</span>    ord = int(ceil(arccosh(sqrt((GSTOP - 1.0) / (GPASS - 1.0))) /</div>
<div class="line"><span class="lineno"> 3936</span>                   arccosh(nat)))</div>
<div class="line"><span class="lineno"> 3937</span> </div>
<div class="line"><span class="lineno"> 3938</span>    <span class="comment"># Natural frequencies are just the passband edges</span></div>
<div class="line"><span class="lineno"> 3939</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 3940</span>        wn = (2.0 / pi) * arctan(passb)</div>
<div class="line"><span class="lineno"> 3941</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3942</span>        wn = passb</div>
<div class="line"><span class="lineno"> 3943</span> </div>
<div class="line"><span class="lineno"> 3944</span>    <span class="keywordflow">if</span> len(wn) == 1:</div>
<div class="line"><span class="lineno"> 3945</span>        wn = wn[0]</div>
<div class="line"><span class="lineno"> 3946</span> </div>
<div class="line"><span class="lineno"> 3947</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3948</span>        wn = wn*fs/2</div>
<div class="line"><span class="lineno"> 3949</span> </div>
<div class="line"><span class="lineno"> 3950</span>    <span class="keywordflow">return</span> ord, wn</div>
<div class="line"><span class="lineno"> 3951</span> </div>
<div class="line"><span class="lineno"> 3952</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a85604d994461d93b66688f46e2274e01" name="a85604d994461d93b66688f46e2274e01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85604d994461d93b66688f46e2274e01">&#9670;&#160;</a></span>cheb2ap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.cheb2ap </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return (z,p,k) for Nth-order Chebyshev type I analog lowpass filter.

The returned filter prototype has `rs` decibels of ripple in the stopband.

The filter's angular (e.g. rad/s) cutoff frequency is normalized to 1,
defined as the point at which the gain first reaches ``-rs``.

See Also
--------
cheby2 : Filter design function using this prototype</pre> <div class="fragment"><div class="line"><span class="lineno"> 4323</span><span class="keyword">def </span>cheb2ap(N, rs):</div>
<div class="line"><span class="lineno"> 4324</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4325</span><span class="stringliteral">    Return (z,p,k) for Nth-order Chebyshev type I analog lowpass filter.</span></div>
<div class="line"><span class="lineno"> 4326</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4327</span><span class="stringliteral">    The returned filter prototype has `rs` decibels of ripple in the stopband.</span></div>
<div class="line"><span class="lineno"> 4328</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4329</span><span class="stringliteral">    The filter&#39;s angular (e.g. rad/s) cutoff frequency is normalized to 1,</span></div>
<div class="line"><span class="lineno"> 4330</span><span class="stringliteral">    defined as the point at which the gain first reaches ``-rs``.</span></div>
<div class="line"><span class="lineno"> 4331</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4332</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 4333</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4334</span><span class="stringliteral">    cheby2 : Filter design function using this prototype</span></div>
<div class="line"><span class="lineno"> 4335</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4336</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4337</span>    <span class="keywordflow">if</span> abs(int(N)) != N:</div>
<div class="line"><span class="lineno"> 4338</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Filter order must be a nonnegative integer&quot;</span>)</div>
<div class="line"><span class="lineno"> 4339</span>    <span class="keywordflow">elif</span> N == 0:</div>
<div class="line"><span class="lineno"> 4340</span>        <span class="comment"># Avoid divide-by-zero warning</span></div>
<div class="line"><span class="lineno"> 4341</span>        <span class="keywordflow">return</span> numpy.array([]), numpy.array([]), 1</div>
<div class="line"><span class="lineno"> 4342</span> </div>
<div class="line"><span class="lineno"> 4343</span>    <span class="comment"># Ripple factor (epsilon)</span></div>
<div class="line"><span class="lineno"> 4344</span>    de = 1.0 / sqrt(10 ** (0.1 * rs) - 1)</div>
<div class="line"><span class="lineno"> 4345</span>    mu = arcsinh(1.0 / de) / N</div>
<div class="line"><span class="lineno"> 4346</span> </div>
<div class="line"><span class="lineno"> 4347</span>    <span class="keywordflow">if</span> N % 2:</div>
<div class="line"><span class="lineno"> 4348</span>        m = numpy.concatenate((numpy.arange(-N+1, 0, 2),</div>
<div class="line"><span class="lineno"> 4349</span>                               numpy.arange(2, N, 2)))</div>
<div class="line"><span class="lineno"> 4350</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4351</span>        m = numpy.arange(-N+1, N, 2)</div>
<div class="line"><span class="lineno"> 4352</span> </div>
<div class="line"><span class="lineno"> 4353</span>    z = -conjugate(1j / sin(m * pi / (2.0 * N)))</div>
<div class="line"><span class="lineno"> 4354</span> </div>
<div class="line"><span class="lineno"> 4355</span>    <span class="comment"># Poles around the unit circle like Butterworth</span></div>
<div class="line"><span class="lineno"> 4356</span>    p = -exp(1j * pi * numpy.arange(-N+1, N, 2) / (2 * N))</div>
<div class="line"><span class="lineno"> 4357</span>    <span class="comment"># Warp into Chebyshev II</span></div>
<div class="line"><span class="lineno"> 4358</span>    p = sinh(mu) * p.real + 1j * cosh(mu) * p.imag</div>
<div class="line"><span class="lineno"> 4359</span>    p = 1.0 / p</div>
<div class="line"><span class="lineno"> 4360</span> </div>
<div class="line"><span class="lineno"> 4361</span>    k = (numpy.prod(-p, axis=0) / numpy.prod(-z, axis=0)).real</div>
<div class="line"><span class="lineno"> 4362</span>    <span class="keywordflow">return</span> z, p, k</div>
<div class="line"><span class="lineno"> 4363</span> </div>
<div class="line"><span class="lineno"> 4364</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afa28a525115653cfbb7fa47769345631" name="afa28a525115653cfbb7fa47769345631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa28a525115653cfbb7fa47769345631">&#9670;&#160;</a></span>cheb2ord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.cheb2ord </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gstop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Chebyshev type II filter order selection.

Return the order of the lowest order digital or analog Chebyshev Type II
filter that loses no more than `gpass` dB in the passband and has at least
`gstop` dB attenuation in the stopband.

Parameters
----------
wp, ws : float
    Passband and stopband edge frequencies.

    For digital filters, these are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`wp` and `ws` are thus in
    half-cycles / sample.)  For example:

        - Lowpass:   wp = 0.2,          ws = 0.3
        - Highpass:  wp = 0.3,          ws = 0.2
        - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]
        - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]

    For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).
gpass : float
    The maximum loss in the passband (dB).
gstop : float
    The minimum attenuation in the stopband (dB).
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
ord : int
    The lowest order for a Chebyshev type II filter that meets specs.
wn : ndarray or float
    The Chebyshev natural frequency (the "3dB frequency") for use with
    `cheby2` to give filter results. If `fs` is specified,
    this is in the same units, and `fs` must also be passed to `cheby2`.

See Also
--------
cheby2 : Filter design using order and critical points
buttord : Find order and critical points from passband and stopband spec
cheb1ord, ellipord
iirfilter : General filter design using order and critical frequencies
iirdesign : General filter design using passband and stopband spec

Examples
--------
Design a digital bandstop filter which rejects -60 dB from 0.2*(fs/2) to
0.5*(fs/2), while staying within 3 dB below 0.1*(fs/2) or above
0.6*(fs/2). Plot its frequency response, showing the passband and
stopband constraints in gray.

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; N, Wn = signal.cheb2ord([0.1, 0.6], [0.2, 0.5], 3, 60)
&gt;&gt;&gt; b, a = signal.cheby2(N, 60, Wn, 'stop')
&gt;&gt;&gt; w, h = signal.freqz(b, a)
&gt;&gt;&gt; plt.semilogx(w / np.pi, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.title('Chebyshev II bandstop filter fit to constraints')
&gt;&gt;&gt; plt.xlabel('Normalized frequency')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.fill([.01, .1, .1, .01], [-3,  -3, -99, -99], '0.9', lw=0) # stop
&gt;&gt;&gt; plt.fill([.2,  .2, .5,  .5], [ 9, -60, -60,   9], '0.9', lw=0) # pass
&gt;&gt;&gt; plt.fill([.6,  .6,  2,   2], [-99, -3,  -3, -99], '0.9', lw=0) # stop
&gt;&gt;&gt; plt.axis([0.06, 1, -80, 3])
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno"> 3953</span><span class="keyword">def </span>cheb2ord(wp, ws, gpass, gstop, analog=False, fs=None):</div>
<div class="line"><span class="lineno"> 3954</span>    <span class="stringliteral">&quot;&quot;&quot;Chebyshev type II filter order selection.</span></div>
<div class="line"><span class="lineno"> 3955</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3956</span><span class="stringliteral">    Return the order of the lowest order digital or analog Chebyshev Type II</span></div>
<div class="line"><span class="lineno"> 3957</span><span class="stringliteral">    filter that loses no more than `gpass` dB in the passband and has at least</span></div>
<div class="line"><span class="lineno"> 3958</span><span class="stringliteral">    `gstop` dB attenuation in the stopband.</span></div>
<div class="line"><span class="lineno"> 3959</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3960</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3961</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3962</span><span class="stringliteral">    wp, ws : float</span></div>
<div class="line"><span class="lineno"> 3963</span><span class="stringliteral">        Passband and stopband edge frequencies.</span></div>
<div class="line"><span class="lineno"> 3964</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3965</span><span class="stringliteral">        For digital filters, these are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 3966</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 3967</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`wp` and `ws` are thus in</span></div>
<div class="line"><span class="lineno"> 3968</span><span class="stringliteral">        half-cycles / sample.)  For example:</span></div>
<div class="line"><span class="lineno"> 3969</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3970</span><span class="stringliteral">            - Lowpass:   wp = 0.2,          ws = 0.3</span></div>
<div class="line"><span class="lineno"> 3971</span><span class="stringliteral">            - Highpass:  wp = 0.3,          ws = 0.2</span></div>
<div class="line"><span class="lineno"> 3972</span><span class="stringliteral">            - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]</span></div>
<div class="line"><span class="lineno"> 3973</span><span class="stringliteral">            - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]</span></div>
<div class="line"><span class="lineno"> 3974</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3975</span><span class="stringliteral">        For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 3976</span><span class="stringliteral">    gpass : float</span></div>
<div class="line"><span class="lineno"> 3977</span><span class="stringliteral">        The maximum loss in the passband (dB).</span></div>
<div class="line"><span class="lineno"> 3978</span><span class="stringliteral">    gstop : float</span></div>
<div class="line"><span class="lineno"> 3979</span><span class="stringliteral">        The minimum attenuation in the stopband (dB).</span></div>
<div class="line"><span class="lineno"> 3980</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 3981</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 3982</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 3983</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 3984</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 3985</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3986</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 3987</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3988</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3989</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3990</span><span class="stringliteral">    ord : int</span></div>
<div class="line"><span class="lineno"> 3991</span><span class="stringliteral">        The lowest order for a Chebyshev type II filter that meets specs.</span></div>
<div class="line"><span class="lineno"> 3992</span><span class="stringliteral">    wn : ndarray or float</span></div>
<div class="line"><span class="lineno"> 3993</span><span class="stringliteral">        The Chebyshev natural frequency (the &quot;3dB frequency&quot;) for use with</span></div>
<div class="line"><span class="lineno"> 3994</span><span class="stringliteral">        `cheby2` to give filter results. If `fs` is specified,</span></div>
<div class="line"><span class="lineno"> 3995</span><span class="stringliteral">        this is in the same units, and `fs` must also be passed to `cheby2`.</span></div>
<div class="line"><span class="lineno"> 3996</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3997</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 3998</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3999</span><span class="stringliteral">    cheby2 : Filter design using order and critical points</span></div>
<div class="line"><span class="lineno"> 4000</span><span class="stringliteral">    buttord : Find order and critical points from passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 4001</span><span class="stringliteral">    cheb1ord, ellipord</span></div>
<div class="line"><span class="lineno"> 4002</span><span class="stringliteral">    iirfilter : General filter design using order and critical frequencies</span></div>
<div class="line"><span class="lineno"> 4003</span><span class="stringliteral">    iirdesign : General filter design using passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 4004</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4005</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 4006</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4007</span><span class="stringliteral">    Design a digital bandstop filter which rejects -60 dB from 0.2*(fs/2) to</span></div>
<div class="line"><span class="lineno"> 4008</span><span class="stringliteral">    0.5*(fs/2), while staying within 3 dB below 0.1*(fs/2) or above</span></div>
<div class="line"><span class="lineno"> 4009</span><span class="stringliteral">    0.6*(fs/2). Plot its frequency response, showing the passband and</span></div>
<div class="line"><span class="lineno"> 4010</span><span class="stringliteral">    stopband constraints in gray.</span></div>
<div class="line"><span class="lineno"> 4011</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4012</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 4013</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 4014</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4015</span><span class="stringliteral">    &gt;&gt;&gt; N, Wn = signal.cheb2ord([0.1, 0.6], [0.2, 0.5], 3, 60)</span></div>
<div class="line"><span class="lineno"> 4016</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.cheby2(N, 60, Wn, &#39;stop&#39;)</span></div>
<div class="line"><span class="lineno"> 4017</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz(b, a)</span></div>
<div class="line"><span class="lineno"> 4018</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w / np.pi, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 4019</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Chebyshev II bandstop filter fit to constraints&#39;)</span></div>
<div class="line"><span class="lineno"> 4020</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Normalized frequency&#39;)</span></div>
<div class="line"><span class="lineno"> 4021</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 4022</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 4023</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([.01, .1, .1, .01], [-3,  -3, -99, -99], &#39;0.9&#39;, lw=0) # stop</span></div>
<div class="line"><span class="lineno"> 4024</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([.2,  .2, .5,  .5], [ 9, -60, -60,   9], &#39;0.9&#39;, lw=0) # pass</span></div>
<div class="line"><span class="lineno"> 4025</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([.6,  .6,  2,   2], [-99, -3,  -3, -99], &#39;0.9&#39;, lw=0) # stop</span></div>
<div class="line"><span class="lineno"> 4026</span><span class="stringliteral">    &gt;&gt;&gt; plt.axis([0.06, 1, -80, 3])</span></div>
<div class="line"><span class="lineno"> 4027</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 4028</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4029</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4030</span> </div>
<div class="line"><span class="lineno"> 4031</span>    _validate_gpass_gstop(gpass, gstop)</div>
<div class="line"><span class="lineno"> 4032</span> </div>
<div class="line"><span class="lineno"> 4033</span>    wp = atleast_1d(wp)</div>
<div class="line"><span class="lineno"> 4034</span>    ws = atleast_1d(ws)</div>
<div class="line"><span class="lineno"> 4035</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 4036</span>        <span class="keywordflow">if</span> analog:</div>
<div class="line"><span class="lineno"> 4037</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;fs cannot be specified for an analog filter&quot;</span>)</div>
<div class="line"><span class="lineno"> 4038</span>        wp = 2*wp/fs</div>
<div class="line"><span class="lineno"> 4039</span>        ws = 2*ws/fs</div>
<div class="line"><span class="lineno"> 4040</span> </div>
<div class="line"><span class="lineno"> 4041</span>    filter_type = 2 * (len(wp) - 1)</div>
<div class="line"><span class="lineno"> 4042</span>    <span class="keywordflow">if</span> wp[0] &lt; ws[0]:</div>
<div class="line"><span class="lineno"> 4043</span>        filter_type += 1</div>
<div class="line"><span class="lineno"> 4044</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4045</span>        filter_type += 2</div>
<div class="line"><span class="lineno"> 4046</span> </div>
<div class="line"><span class="lineno"> 4047</span>    <span class="comment"># Pre-warp frequencies for digital filter design</span></div>
<div class="line"><span class="lineno"> 4048</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 4049</span>        passb = tan(pi * wp / 2.0)</div>
<div class="line"><span class="lineno"> 4050</span>        stopb = tan(pi * ws / 2.0)</div>
<div class="line"><span class="lineno"> 4051</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4052</span>        passb = wp * 1.0</div>
<div class="line"><span class="lineno"> 4053</span>        stopb = ws * 1.0</div>
<div class="line"><span class="lineno"> 4054</span> </div>
<div class="line"><span class="lineno"> 4055</span>    <span class="keywordflow">if</span> filter_type == 1:           <span class="comment"># low</span></div>
<div class="line"><span class="lineno"> 4056</span>        nat = stopb / passb</div>
<div class="line"><span class="lineno"> 4057</span>    <span class="keywordflow">elif</span> filter_type == 2:          <span class="comment"># high</span></div>
<div class="line"><span class="lineno"> 4058</span>        nat = passb / stopb</div>
<div class="line"><span class="lineno"> 4059</span>    <span class="keywordflow">elif</span> filter_type == 3:     <span class="comment"># stop</span></div>
<div class="line"><span class="lineno"> 4060</span>        wp0 = optimize.fminbound(band_stop_obj, passb[0], stopb[0] - 1e-12,</div>
<div class="line"><span class="lineno"> 4061</span>                                 args=(0, passb, stopb, gpass, gstop, <span class="stringliteral">&#39;cheby&#39;</span>),</div>
<div class="line"><span class="lineno"> 4062</span>                                 disp=0)</div>
<div class="line"><span class="lineno"> 4063</span>        passb[0] = wp0</div>
<div class="line"><span class="lineno"> 4064</span>        wp1 = optimize.fminbound(band_stop_obj, stopb[1] + 1e-12, passb[1],</div>
<div class="line"><span class="lineno"> 4065</span>                                 args=(1, passb, stopb, gpass, gstop, <span class="stringliteral">&#39;cheby&#39;</span>),</div>
<div class="line"><span class="lineno"> 4066</span>                                 disp=0)</div>
<div class="line"><span class="lineno"> 4067</span>        passb[1] = wp1</div>
<div class="line"><span class="lineno"> 4068</span>        nat = ((stopb * (passb[0] - passb[1])) /</div>
<div class="line"><span class="lineno"> 4069</span>               (stopb ** 2 - passb[0] * passb[1]))</div>
<div class="line"><span class="lineno"> 4070</span>    <span class="keywordflow">elif</span> filter_type == 4:  <span class="comment"># pass</span></div>
<div class="line"><span class="lineno"> 4071</span>        nat = ((stopb ** 2 - passb[0] * passb[1]) /</div>
<div class="line"><span class="lineno"> 4072</span>               (stopb * (passb[0] - passb[1])))</div>
<div class="line"><span class="lineno"> 4073</span> </div>
<div class="line"><span class="lineno"> 4074</span>    nat = min(abs(nat))</div>
<div class="line"><span class="lineno"> 4075</span> </div>
<div class="line"><span class="lineno"> 4076</span>    GSTOP = 10 ** (0.1 * abs(gstop))</div>
<div class="line"><span class="lineno"> 4077</span>    GPASS = 10 ** (0.1 * abs(gpass))</div>
<div class="line"><span class="lineno"> 4078</span>    ord = int(ceil(arccosh(sqrt((GSTOP - 1.0) / (GPASS - 1.0))) /</div>
<div class="line"><span class="lineno"> 4079</span>                   arccosh(nat)))</div>
<div class="line"><span class="lineno"> 4080</span> </div>
<div class="line"><span class="lineno"> 4081</span>    <span class="comment"># Find frequency where analog response is -gpass dB.</span></div>
<div class="line"><span class="lineno"> 4082</span>    <span class="comment"># Then convert back from low-pass prototype to the original filter.</span></div>
<div class="line"><span class="lineno"> 4083</span> </div>
<div class="line"><span class="lineno"> 4084</span>    new_freq = cosh(1.0 / ord * arccosh(sqrt((GSTOP - 1.0) / (GPASS - 1.0))))</div>
<div class="line"><span class="lineno"> 4085</span>    new_freq = 1.0 / new_freq</div>
<div class="line"><span class="lineno"> 4086</span> </div>
<div class="line"><span class="lineno"> 4087</span>    <span class="keywordflow">if</span> filter_type == 1:</div>
<div class="line"><span class="lineno"> 4088</span>        nat = passb / new_freq</div>
<div class="line"><span class="lineno"> 4089</span>    <span class="keywordflow">elif</span> filter_type == 2:</div>
<div class="line"><span class="lineno"> 4090</span>        nat = passb * new_freq</div>
<div class="line"><span class="lineno"> 4091</span>    <span class="keywordflow">elif</span> filter_type == 3:</div>
<div class="line"><span class="lineno"> 4092</span>        nat = numpy.empty(2, float)</div>
<div class="line"><span class="lineno"> 4093</span>        nat[0] = (new_freq / 2.0 * (passb[0] - passb[1]) +</div>
<div class="line"><span class="lineno"> 4094</span>                  sqrt(new_freq ** 2 * (passb[1] - passb[0]) ** 2 / 4.0 +</div>
<div class="line"><span class="lineno"> 4095</span>                       passb[1] * passb[0]))</div>
<div class="line"><span class="lineno"> 4096</span>        nat[1] = passb[1] * passb[0] / nat[0]</div>
<div class="line"><span class="lineno"> 4097</span>    <span class="keywordflow">elif</span> filter_type == 4:</div>
<div class="line"><span class="lineno"> 4098</span>        nat = numpy.empty(2, float)</div>
<div class="line"><span class="lineno"> 4099</span>        nat[0] = (1.0 / (2.0 * new_freq) * (passb[0] - passb[1]) +</div>
<div class="line"><span class="lineno"> 4100</span>                  sqrt((passb[1] - passb[0]) ** 2 / (4.0 * new_freq ** 2) +</div>
<div class="line"><span class="lineno"> 4101</span>                       passb[1] * passb[0]))</div>
<div class="line"><span class="lineno"> 4102</span>        nat[1] = passb[0] * passb[1] / nat[0]</div>
<div class="line"><span class="lineno"> 4103</span> </div>
<div class="line"><span class="lineno"> 4104</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 4105</span>        wn = (2.0 / pi) * arctan(nat)</div>
<div class="line"><span class="lineno"> 4106</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4107</span>        wn = nat</div>
<div class="line"><span class="lineno"> 4108</span> </div>
<div class="line"><span class="lineno"> 4109</span>    <span class="keywordflow">if</span> len(wn) == 1:</div>
<div class="line"><span class="lineno"> 4110</span>        wn = wn[0]</div>
<div class="line"><span class="lineno"> 4111</span> </div>
<div class="line"><span class="lineno"> 4112</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 4113</span>        wn = wn*fs/2</div>
<div class="line"><span class="lineno"> 4114</span> </div>
<div class="line"><span class="lineno"> 4115</span>    <span class="keywordflow">return</span> ord, wn</div>
<div class="line"><span class="lineno"> 4116</span> </div>
<div class="line"><span class="lineno"> 4117</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e77ed88eb55f4b49a99f4d8844e61b7" name="a0e77ed88eb55f4b49a99f4d8844e61b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e77ed88eb55f4b49a99f4d8844e61b7">&#9670;&#160;</a></span>cheby1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.cheby1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Wn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>btype</em> = <code>'low'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>'ba'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Chebyshev type I digital and analog filter design.

Design an Nth-order digital or analog Chebyshev type I filter and
return the filter coefficients.

Parameters
----------
N : int
    The order of the filter.
rp : float
    The maximum ripple allowed below unity gain in the passband.
    Specified in decibels, as a positive number.
Wn : array_like
    A scalar or length-2 sequence giving the critical frequencies.
    For Type I filters, this is the point in the transition band at which
    the gain first drops below -`rp`.

    For digital filters, `Wn` are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`Wn` is thus in
    half-cycles / sample.)

    For analog filters, `Wn` is an angular frequency (e.g., rad/s).
btype : {'lowpass', 'highpass', 'bandpass', 'bandstop'}, optional
    The type of filter.  Default is 'lowpass'.
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
output : {'ba', 'zpk', 'sos'}, optional
    Type of output:  numerator/denominator ('ba'), pole-zero ('zpk'), or
    second-order sections ('sos'). Default is 'ba' for backwards
    compatibility, but 'sos' should be used for general-purpose filtering.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.
    Only returned if ``output='ba'``.
z, p, k : ndarray, ndarray, float
    Zeros, poles, and system gain of the IIR filter transfer
    function.  Only returned if ``output='zpk'``.
sos : ndarray
    Second-order sections representation of the IIR filter.
    Only returned if ``output=='sos'``.

See Also
--------
cheb1ord, cheb1ap

Notes
-----
The Chebyshev type I filter maximizes the rate of cutoff between the
frequency response's passband and stopband, at the expense of ripple in
the passband and increased ringing in the step response.

Type I filters roll off faster than Type II (`cheby2`), but Type II
filters do not have any ripple in the passband.

The equiripple passband has N maxima or minima (for example, a
5th-order filter has 3 maxima and 2 minima). Consequently, the DC gain is
unity for odd-order filters, or -rp dB for even-order filters.

The ``'sos'`` output parameter was added in 0.16.0.

Examples
--------
Design an analog filter and plot its frequency response, showing the
critical points:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; b, a = signal.cheby1(4, 5, 100, 'low', analog=True)
&gt;&gt;&gt; w, h = signal.freqs(b, a)
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.title('Chebyshev Type I frequency response (rp=5)')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.axvline(100, color='green') # cutoff frequency
&gt;&gt;&gt; plt.axhline(-5, color='green') # rp
&gt;&gt;&gt; plt.show()

Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz

&gt;&gt;&gt; t = np.linspace(0, 1, 1000, False)  # 1 second
&gt;&gt;&gt; sig = np.sin(2*np.pi*10*t) + np.sin(2*np.pi*20*t)
&gt;&gt;&gt; fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)
&gt;&gt;&gt; ax1.plot(t, sig)
&gt;&gt;&gt; ax1.set_title('10 Hz and 20 Hz sinusoids')
&gt;&gt;&gt; ax1.axis([0, 1, -2, 2])

Design a digital high-pass filter at 15 Hz to remove the 10 Hz tone, and
apply it to the signal. (It's recommended to use second-order sections
format when filtering, to avoid numerical error with transfer function
(``ba``) format):

&gt;&gt;&gt; sos = signal.cheby1(10, 1, 15, 'hp', fs=1000, output='sos')
&gt;&gt;&gt; filtered = signal.sosfilt(sos, sig)
&gt;&gt;&gt; ax2.plot(t, filtered)
&gt;&gt;&gt; ax2.set_title('After 15 Hz high-pass filter')
&gt;&gt;&gt; ax2.axis([0, 1, -2, 2])
&gt;&gt;&gt; ax2.set_xlabel('Time [seconds]')
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 3057</span><span class="keyword">def </span>cheby1(N, rp, Wn, btype=&#39;low&#39;, analog=False, output=&#39;ba&#39;, fs=None):</div>
<div class="line"><span class="lineno"> 3058</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3059</span><span class="stringliteral">    Chebyshev type I digital and analog filter design.</span></div>
<div class="line"><span class="lineno"> 3060</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3061</span><span class="stringliteral">    Design an Nth-order digital or analog Chebyshev type I filter and</span></div>
<div class="line"><span class="lineno"> 3062</span><span class="stringliteral">    return the filter coefficients.</span></div>
<div class="line"><span class="lineno"> 3063</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3064</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3065</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3066</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno"> 3067</span><span class="stringliteral">        The order of the filter.</span></div>
<div class="line"><span class="lineno"> 3068</span><span class="stringliteral">    rp : float</span></div>
<div class="line"><span class="lineno"> 3069</span><span class="stringliteral">        The maximum ripple allowed below unity gain in the passband.</span></div>
<div class="line"><span class="lineno"> 3070</span><span class="stringliteral">        Specified in decibels, as a positive number.</span></div>
<div class="line"><span class="lineno"> 3071</span><span class="stringliteral">    Wn : array_like</span></div>
<div class="line"><span class="lineno"> 3072</span><span class="stringliteral">        A scalar or length-2 sequence giving the critical frequencies.</span></div>
<div class="line"><span class="lineno"> 3073</span><span class="stringliteral">        For Type I filters, this is the point in the transition band at which</span></div>
<div class="line"><span class="lineno"> 3074</span><span class="stringliteral">        the gain first drops below -`rp`.</span></div>
<div class="line"><span class="lineno"> 3075</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3076</span><span class="stringliteral">        For digital filters, `Wn` are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 3077</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 3078</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`Wn` is thus in</span></div>
<div class="line"><span class="lineno"> 3079</span><span class="stringliteral">        half-cycles / sample.)</span></div>
<div class="line"><span class="lineno"> 3080</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3081</span><span class="stringliteral">        For analog filters, `Wn` is an angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 3082</span><span class="stringliteral">    btype : {&#39;lowpass&#39;, &#39;highpass&#39;, &#39;bandpass&#39;, &#39;bandstop&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3083</span><span class="stringliteral">        The type of filter.  Default is &#39;lowpass&#39;.</span></div>
<div class="line"><span class="lineno"> 3084</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 3085</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 3086</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 3087</span><span class="stringliteral">    output : {&#39;ba&#39;, &#39;zpk&#39;, &#39;sos&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3088</span><span class="stringliteral">        Type of output:  numerator/denominator (&#39;ba&#39;), pole-zero (&#39;zpk&#39;), or</span></div>
<div class="line"><span class="lineno"> 3089</span><span class="stringliteral">        second-order sections (&#39;sos&#39;). Default is &#39;ba&#39; for backwards</span></div>
<div class="line"><span class="lineno"> 3090</span><span class="stringliteral">        compatibility, but &#39;sos&#39; should be used for general-purpose filtering.</span></div>
<div class="line"><span class="lineno"> 3091</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 3092</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 3093</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3094</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 3095</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3096</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3097</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3098</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 3099</span><span class="stringliteral">        Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 3100</span><span class="stringliteral">        Only returned if ``output=&#39;ba&#39;``.</span></div>
<div class="line"><span class="lineno"> 3101</span><span class="stringliteral">    z, p, k : ndarray, ndarray, float</span></div>
<div class="line"><span class="lineno"> 3102</span><span class="stringliteral">        Zeros, poles, and system gain of the IIR filter transfer</span></div>
<div class="line"><span class="lineno"> 3103</span><span class="stringliteral">        function.  Only returned if ``output=&#39;zpk&#39;``.</span></div>
<div class="line"><span class="lineno"> 3104</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 3105</span><span class="stringliteral">        Second-order sections representation of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 3106</span><span class="stringliteral">        Only returned if ``output==&#39;sos&#39;``.</span></div>
<div class="line"><span class="lineno"> 3107</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3108</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 3109</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3110</span><span class="stringliteral">    cheb1ord, cheb1ap</span></div>
<div class="line"><span class="lineno"> 3111</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3112</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 3113</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 3114</span><span class="stringliteral">    The Chebyshev type I filter maximizes the rate of cutoff between the</span></div>
<div class="line"><span class="lineno"> 3115</span><span class="stringliteral">    frequency response&#39;s passband and stopband, at the expense of ripple in</span></div>
<div class="line"><span class="lineno"> 3116</span><span class="stringliteral">    the passband and increased ringing in the step response.</span></div>
<div class="line"><span class="lineno"> 3117</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3118</span><span class="stringliteral">    Type I filters roll off faster than Type II (`cheby2`), but Type II</span></div>
<div class="line"><span class="lineno"> 3119</span><span class="stringliteral">    filters do not have any ripple in the passband.</span></div>
<div class="line"><span class="lineno"> 3120</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3121</span><span class="stringliteral">    The equiripple passband has N maxima or minima (for example, a</span></div>
<div class="line"><span class="lineno"> 3122</span><span class="stringliteral">    5th-order filter has 3 maxima and 2 minima). Consequently, the DC gain is</span></div>
<div class="line"><span class="lineno"> 3123</span><span class="stringliteral">    unity for odd-order filters, or -rp dB for even-order filters.</span></div>
<div class="line"><span class="lineno"> 3124</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3125</span><span class="stringliteral">    The ``&#39;sos&#39;`` output parameter was added in 0.16.0.</span></div>
<div class="line"><span class="lineno"> 3126</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3127</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3128</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3129</span><span class="stringliteral">    Design an analog filter and plot its frequency response, showing the</span></div>
<div class="line"><span class="lineno"> 3130</span><span class="stringliteral">    critical points:</span></div>
<div class="line"><span class="lineno"> 3131</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3132</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 3133</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 3134</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3135</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.cheby1(4, 5, 100, &#39;low&#39;, analog=True)</span></div>
<div class="line"><span class="lineno"> 3136</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a)</span></div>
<div class="line"><span class="lineno"> 3137</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 3138</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Chebyshev Type I frequency response (rp=5)&#39;)</span></div>
<div class="line"><span class="lineno"> 3139</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3140</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 3141</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 3142</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3143</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(100, color=&#39;green&#39;) # cutoff frequency</span></div>
<div class="line"><span class="lineno"> 3144</span><span class="stringliteral">    &gt;&gt;&gt; plt.axhline(-5, color=&#39;green&#39;) # rp</span></div>
<div class="line"><span class="lineno"> 3145</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3146</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3147</span><span class="stringliteral">    Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz</span></div>
<div class="line"><span class="lineno"> 3148</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3149</span><span class="stringliteral">    &gt;&gt;&gt; t = np.linspace(0, 1, 1000, False)  # 1 second</span></div>
<div class="line"><span class="lineno"> 3150</span><span class="stringliteral">    &gt;&gt;&gt; sig = np.sin(2*np.pi*10*t) + np.sin(2*np.pi*20*t)</span></div>
<div class="line"><span class="lineno"> 3151</span><span class="stringliteral">    &gt;&gt;&gt; fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)</span></div>
<div class="line"><span class="lineno"> 3152</span><span class="stringliteral">    &gt;&gt;&gt; ax1.plot(t, sig)</span></div>
<div class="line"><span class="lineno"> 3153</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_title(&#39;10 Hz and 20 Hz sinusoids&#39;)</span></div>
<div class="line"><span class="lineno"> 3154</span><span class="stringliteral">    &gt;&gt;&gt; ax1.axis([0, 1, -2, 2])</span></div>
<div class="line"><span class="lineno"> 3155</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3156</span><span class="stringliteral">    Design a digital high-pass filter at 15 Hz to remove the 10 Hz tone, and</span></div>
<div class="line"><span class="lineno"> 3157</span><span class="stringliteral">    apply it to the signal. (It&#39;s recommended to use second-order sections</span></div>
<div class="line"><span class="lineno"> 3158</span><span class="stringliteral">    format when filtering, to avoid numerical error with transfer function</span></div>
<div class="line"><span class="lineno"> 3159</span><span class="stringliteral">    (``ba``) format):</span></div>
<div class="line"><span class="lineno"> 3160</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3161</span><span class="stringliteral">    &gt;&gt;&gt; sos = signal.cheby1(10, 1, 15, &#39;hp&#39;, fs=1000, output=&#39;sos&#39;)</span></div>
<div class="line"><span class="lineno"> 3162</span><span class="stringliteral">    &gt;&gt;&gt; filtered = signal.sosfilt(sos, sig)</span></div>
<div class="line"><span class="lineno"> 3163</span><span class="stringliteral">    &gt;&gt;&gt; ax2.plot(t, filtered)</span></div>
<div class="line"><span class="lineno"> 3164</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_title(&#39;After 15 Hz high-pass filter&#39;)</span></div>
<div class="line"><span class="lineno"> 3165</span><span class="stringliteral">    &gt;&gt;&gt; ax2.axis([0, 1, -2, 2])</span></div>
<div class="line"><span class="lineno"> 3166</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_xlabel(&#39;Time [seconds]&#39;)</span></div>
<div class="line"><span class="lineno"> 3167</span><span class="stringliteral">    &gt;&gt;&gt; plt.tight_layout()</span></div>
<div class="line"><span class="lineno"> 3168</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3169</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3170</span>    <span class="keywordflow">return</span> iirfilter(N, Wn, rp=rp, btype=btype, analog=analog,</div>
<div class="line"><span class="lineno"> 3171</span>                     output=output, ftype=<span class="stringliteral">&#39;cheby1&#39;</span>, fs=fs)</div>
<div class="line"><span class="lineno"> 3172</span> </div>
<div class="line"><span class="lineno"> 3173</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ded91bfef2a44d329c94a19f884a2e9" name="a7ded91bfef2a44d329c94a19f884a2e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ded91bfef2a44d329c94a19f884a2e9">&#9670;&#160;</a></span>cheby2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.cheby2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Wn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>btype</em> = <code>'low'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>'ba'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Chebyshev type II digital and analog filter design.

Design an Nth-order digital or analog Chebyshev type II filter and
return the filter coefficients.

Parameters
----------
N : int
    The order of the filter.
rs : float
    The minimum attenuation required in the stop band.
    Specified in decibels, as a positive number.
Wn : array_like
    A scalar or length-2 sequence giving the critical frequencies.
    For Type II filters, this is the point in the transition band at which
    the gain first reaches -`rs`.

    For digital filters, `Wn` are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`Wn` is thus in
    half-cycles / sample.)

    For analog filters, `Wn` is an angular frequency (e.g., rad/s).
btype : {'lowpass', 'highpass', 'bandpass', 'bandstop'}, optional
    The type of filter.  Default is 'lowpass'.
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
output : {'ba', 'zpk', 'sos'}, optional
    Type of output:  numerator/denominator ('ba'), pole-zero ('zpk'), or
    second-order sections ('sos'). Default is 'ba' for backwards
    compatibility, but 'sos' should be used for general-purpose filtering.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.
    Only returned if ``output='ba'``.
z, p, k : ndarray, ndarray, float
    Zeros, poles, and system gain of the IIR filter transfer
    function.  Only returned if ``output='zpk'``.
sos : ndarray
    Second-order sections representation of the IIR filter.
    Only returned if ``output=='sos'``.

See Also
--------
cheb2ord, cheb2ap

Notes
-----
The Chebyshev type II filter maximizes the rate of cutoff between the
frequency response's passband and stopband, at the expense of ripple in
the stopband and increased ringing in the step response.

Type II filters do not roll off as fast as Type I (`cheby1`).

The ``'sos'`` output parameter was added in 0.16.0.

Examples
--------
Design an analog filter and plot its frequency response, showing the
critical points:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; b, a = signal.cheby2(4, 40, 100, 'low', analog=True)
&gt;&gt;&gt; w, h = signal.freqs(b, a)
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.title('Chebyshev Type II frequency response (rs=40)')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.axvline(100, color='green') # cutoff frequency
&gt;&gt;&gt; plt.axhline(-40, color='green') # rs
&gt;&gt;&gt; plt.show()

Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz

&gt;&gt;&gt; t = np.linspace(0, 1, 1000, False)  # 1 second
&gt;&gt;&gt; sig = np.sin(2*np.pi*10*t) + np.sin(2*np.pi*20*t)
&gt;&gt;&gt; fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)
&gt;&gt;&gt; ax1.plot(t, sig)
&gt;&gt;&gt; ax1.set_title('10 Hz and 20 Hz sinusoids')
&gt;&gt;&gt; ax1.axis([0, 1, -2, 2])

Design a digital high-pass filter at 17 Hz to remove the 10 Hz tone, and
apply it to the signal. (It's recommended to use second-order sections
format when filtering, to avoid numerical error with transfer function
(``ba``) format):

&gt;&gt;&gt; sos = signal.cheby2(12, 20, 17, 'hp', fs=1000, output='sos')
&gt;&gt;&gt; filtered = signal.sosfilt(sos, sig)
&gt;&gt;&gt; ax2.plot(t, filtered)
&gt;&gt;&gt; ax2.set_title('After 17 Hz high-pass filter')
&gt;&gt;&gt; ax2.axis([0, 1, -2, 2])
&gt;&gt;&gt; ax2.set_xlabel('Time [seconds]')
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 3174</span><span class="keyword">def </span>cheby2(N, rs, Wn, btype=&#39;low&#39;, analog=False, output=&#39;ba&#39;, fs=None):</div>
<div class="line"><span class="lineno"> 3175</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3176</span><span class="stringliteral">    Chebyshev type II digital and analog filter design.</span></div>
<div class="line"><span class="lineno"> 3177</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3178</span><span class="stringliteral">    Design an Nth-order digital or analog Chebyshev type II filter and</span></div>
<div class="line"><span class="lineno"> 3179</span><span class="stringliteral">    return the filter coefficients.</span></div>
<div class="line"><span class="lineno"> 3180</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3181</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3182</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3183</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno"> 3184</span><span class="stringliteral">        The order of the filter.</span></div>
<div class="line"><span class="lineno"> 3185</span><span class="stringliteral">    rs : float</span></div>
<div class="line"><span class="lineno"> 3186</span><span class="stringliteral">        The minimum attenuation required in the stop band.</span></div>
<div class="line"><span class="lineno"> 3187</span><span class="stringliteral">        Specified in decibels, as a positive number.</span></div>
<div class="line"><span class="lineno"> 3188</span><span class="stringliteral">    Wn : array_like</span></div>
<div class="line"><span class="lineno"> 3189</span><span class="stringliteral">        A scalar or length-2 sequence giving the critical frequencies.</span></div>
<div class="line"><span class="lineno"> 3190</span><span class="stringliteral">        For Type II filters, this is the point in the transition band at which</span></div>
<div class="line"><span class="lineno"> 3191</span><span class="stringliteral">        the gain first reaches -`rs`.</span></div>
<div class="line"><span class="lineno"> 3192</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3193</span><span class="stringliteral">        For digital filters, `Wn` are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 3194</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 3195</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`Wn` is thus in</span></div>
<div class="line"><span class="lineno"> 3196</span><span class="stringliteral">        half-cycles / sample.)</span></div>
<div class="line"><span class="lineno"> 3197</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3198</span><span class="stringliteral">        For analog filters, `Wn` is an angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 3199</span><span class="stringliteral">    btype : {&#39;lowpass&#39;, &#39;highpass&#39;, &#39;bandpass&#39;, &#39;bandstop&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3200</span><span class="stringliteral">        The type of filter.  Default is &#39;lowpass&#39;.</span></div>
<div class="line"><span class="lineno"> 3201</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 3202</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 3203</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 3204</span><span class="stringliteral">    output : {&#39;ba&#39;, &#39;zpk&#39;, &#39;sos&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3205</span><span class="stringliteral">        Type of output:  numerator/denominator (&#39;ba&#39;), pole-zero (&#39;zpk&#39;), or</span></div>
<div class="line"><span class="lineno"> 3206</span><span class="stringliteral">        second-order sections (&#39;sos&#39;). Default is &#39;ba&#39; for backwards</span></div>
<div class="line"><span class="lineno"> 3207</span><span class="stringliteral">        compatibility, but &#39;sos&#39; should be used for general-purpose filtering.</span></div>
<div class="line"><span class="lineno"> 3208</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 3209</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 3210</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3211</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 3212</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3213</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3214</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3215</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 3216</span><span class="stringliteral">        Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 3217</span><span class="stringliteral">        Only returned if ``output=&#39;ba&#39;``.</span></div>
<div class="line"><span class="lineno"> 3218</span><span class="stringliteral">    z, p, k : ndarray, ndarray, float</span></div>
<div class="line"><span class="lineno"> 3219</span><span class="stringliteral">        Zeros, poles, and system gain of the IIR filter transfer</span></div>
<div class="line"><span class="lineno"> 3220</span><span class="stringliteral">        function.  Only returned if ``output=&#39;zpk&#39;``.</span></div>
<div class="line"><span class="lineno"> 3221</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 3222</span><span class="stringliteral">        Second-order sections representation of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 3223</span><span class="stringliteral">        Only returned if ``output==&#39;sos&#39;``.</span></div>
<div class="line"><span class="lineno"> 3224</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3225</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 3226</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3227</span><span class="stringliteral">    cheb2ord, cheb2ap</span></div>
<div class="line"><span class="lineno"> 3228</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3229</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 3230</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 3231</span><span class="stringliteral">    The Chebyshev type II filter maximizes the rate of cutoff between the</span></div>
<div class="line"><span class="lineno"> 3232</span><span class="stringliteral">    frequency response&#39;s passband and stopband, at the expense of ripple in</span></div>
<div class="line"><span class="lineno"> 3233</span><span class="stringliteral">    the stopband and increased ringing in the step response.</span></div>
<div class="line"><span class="lineno"> 3234</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3235</span><span class="stringliteral">    Type II filters do not roll off as fast as Type I (`cheby1`).</span></div>
<div class="line"><span class="lineno"> 3236</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3237</span><span class="stringliteral">    The ``&#39;sos&#39;`` output parameter was added in 0.16.0.</span></div>
<div class="line"><span class="lineno"> 3238</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3239</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3240</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3241</span><span class="stringliteral">    Design an analog filter and plot its frequency response, showing the</span></div>
<div class="line"><span class="lineno"> 3242</span><span class="stringliteral">    critical points:</span></div>
<div class="line"><span class="lineno"> 3243</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3244</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 3245</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 3246</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3247</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.cheby2(4, 40, 100, &#39;low&#39;, analog=True)</span></div>
<div class="line"><span class="lineno"> 3248</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a)</span></div>
<div class="line"><span class="lineno"> 3249</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 3250</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Chebyshev Type II frequency response (rs=40)&#39;)</span></div>
<div class="line"><span class="lineno"> 3251</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3252</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 3253</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 3254</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3255</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(100, color=&#39;green&#39;) # cutoff frequency</span></div>
<div class="line"><span class="lineno"> 3256</span><span class="stringliteral">    &gt;&gt;&gt; plt.axhline(-40, color=&#39;green&#39;) # rs</span></div>
<div class="line"><span class="lineno"> 3257</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3258</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3259</span><span class="stringliteral">    Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz</span></div>
<div class="line"><span class="lineno"> 3260</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3261</span><span class="stringliteral">    &gt;&gt;&gt; t = np.linspace(0, 1, 1000, False)  # 1 second</span></div>
<div class="line"><span class="lineno"> 3262</span><span class="stringliteral">    &gt;&gt;&gt; sig = np.sin(2*np.pi*10*t) + np.sin(2*np.pi*20*t)</span></div>
<div class="line"><span class="lineno"> 3263</span><span class="stringliteral">    &gt;&gt;&gt; fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)</span></div>
<div class="line"><span class="lineno"> 3264</span><span class="stringliteral">    &gt;&gt;&gt; ax1.plot(t, sig)</span></div>
<div class="line"><span class="lineno"> 3265</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_title(&#39;10 Hz and 20 Hz sinusoids&#39;)</span></div>
<div class="line"><span class="lineno"> 3266</span><span class="stringliteral">    &gt;&gt;&gt; ax1.axis([0, 1, -2, 2])</span></div>
<div class="line"><span class="lineno"> 3267</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3268</span><span class="stringliteral">    Design a digital high-pass filter at 17 Hz to remove the 10 Hz tone, and</span></div>
<div class="line"><span class="lineno"> 3269</span><span class="stringliteral">    apply it to the signal. (It&#39;s recommended to use second-order sections</span></div>
<div class="line"><span class="lineno"> 3270</span><span class="stringliteral">    format when filtering, to avoid numerical error with transfer function</span></div>
<div class="line"><span class="lineno"> 3271</span><span class="stringliteral">    (``ba``) format):</span></div>
<div class="line"><span class="lineno"> 3272</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3273</span><span class="stringliteral">    &gt;&gt;&gt; sos = signal.cheby2(12, 20, 17, &#39;hp&#39;, fs=1000, output=&#39;sos&#39;)</span></div>
<div class="line"><span class="lineno"> 3274</span><span class="stringliteral">    &gt;&gt;&gt; filtered = signal.sosfilt(sos, sig)</span></div>
<div class="line"><span class="lineno"> 3275</span><span class="stringliteral">    &gt;&gt;&gt; ax2.plot(t, filtered)</span></div>
<div class="line"><span class="lineno"> 3276</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_title(&#39;After 17 Hz high-pass filter&#39;)</span></div>
<div class="line"><span class="lineno"> 3277</span><span class="stringliteral">    &gt;&gt;&gt; ax2.axis([0, 1, -2, 2])</span></div>
<div class="line"><span class="lineno"> 3278</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_xlabel(&#39;Time [seconds]&#39;)</span></div>
<div class="line"><span class="lineno"> 3279</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3280</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3281</span>    <span class="keywordflow">return</span> iirfilter(N, Wn, rs=rs, btype=btype, analog=analog,</div>
<div class="line"><span class="lineno"> 3282</span>                     output=output, ftype=<span class="stringliteral">&#39;cheby2&#39;</span>, fs=fs)</div>
<div class="line"><span class="lineno"> 3283</span> </div>
<div class="line"><span class="lineno"> 3284</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a61a842f3ea1494216b2d32708a8ae665" name="a61a842f3ea1494216b2d32708a8ae665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61a842f3ea1494216b2d32708a8ae665">&#9670;&#160;</a></span>ellip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.ellip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Wn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>btype</em> = <code>'low'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>'ba'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Elliptic (Cauer) digital and analog filter design.

Design an Nth-order digital or analog elliptic filter and return
the filter coefficients.

Parameters
----------
N : int
    The order of the filter.
rp : float
    The maximum ripple allowed below unity gain in the passband.
    Specified in decibels, as a positive number.
rs : float
    The minimum attenuation required in the stop band.
    Specified in decibels, as a positive number.
Wn : array_like
    A scalar or length-2 sequence giving the critical frequencies.
    For elliptic filters, this is the point in the transition band at
    which the gain first drops below -`rp`.

    For digital filters, `Wn` are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`Wn` is thus in
    half-cycles / sample.)

    For analog filters, `Wn` is an angular frequency (e.g., rad/s).
btype : {'lowpass', 'highpass', 'bandpass', 'bandstop'}, optional
    The type of filter. Default is 'lowpass'.
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
output : {'ba', 'zpk', 'sos'}, optional
    Type of output:  numerator/denominator ('ba'), pole-zero ('zpk'), or
    second-order sections ('sos'). Default is 'ba' for backwards
    compatibility, but 'sos' should be used for general-purpose filtering.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.
    Only returned if ``output='ba'``.
z, p, k : ndarray, ndarray, float
    Zeros, poles, and system gain of the IIR filter transfer
    function.  Only returned if ``output='zpk'``.
sos : ndarray
    Second-order sections representation of the IIR filter.
    Only returned if ``output=='sos'``.

See Also
--------
ellipord, ellipap

Notes
-----
Also known as Cauer or Zolotarev filters, the elliptical filter maximizes
the rate of transition between the frequency response's passband and
stopband, at the expense of ripple in both, and increased ringing in the
step response.

As `rp` approaches 0, the elliptical filter becomes a Chebyshev
type II filter (`cheby2`). As `rs` approaches 0, it becomes a Chebyshev
type I filter (`cheby1`). As both approach 0, it becomes a Butterworth
filter (`butter`).

The equiripple passband has N maxima or minima (for example, a
5th-order filter has 3 maxima and 2 minima). Consequently, the DC gain is
unity for odd-order filters, or -rp dB for even-order filters.

The ``'sos'`` output parameter was added in 0.16.0.

Examples
--------
Design an analog filter and plot its frequency response, showing the
critical points:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; b, a = signal.ellip(4, 5, 40, 100, 'low', analog=True)
&gt;&gt;&gt; w, h = signal.freqs(b, a)
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.title('Elliptic filter frequency response (rp=5, rs=40)')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.axvline(100, color='green') # cutoff frequency
&gt;&gt;&gt; plt.axhline(-40, color='green') # rs
&gt;&gt;&gt; plt.axhline(-5, color='green') # rp
&gt;&gt;&gt; plt.show()

Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz

&gt;&gt;&gt; t = np.linspace(0, 1, 1000, False)  # 1 second
&gt;&gt;&gt; sig = np.sin(2*np.pi*10*t) + np.sin(2*np.pi*20*t)
&gt;&gt;&gt; fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)
&gt;&gt;&gt; ax1.plot(t, sig)
&gt;&gt;&gt; ax1.set_title('10 Hz and 20 Hz sinusoids')
&gt;&gt;&gt; ax1.axis([0, 1, -2, 2])

Design a digital high-pass filter at 17 Hz to remove the 10 Hz tone, and
apply it to the signal. (It's recommended to use second-order sections
format when filtering, to avoid numerical error with transfer function
(``ba``) format):

&gt;&gt;&gt; sos = signal.ellip(8, 1, 100, 17, 'hp', fs=1000, output='sos')
&gt;&gt;&gt; filtered = signal.sosfilt(sos, sig)
&gt;&gt;&gt; ax2.plot(t, filtered)
&gt;&gt;&gt; ax2.set_title('After 17 Hz high-pass filter')
&gt;&gt;&gt; ax2.axis([0, 1, -2, 2])
&gt;&gt;&gt; ax2.set_xlabel('Time [seconds]')
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 3285</span><span class="keyword">def </span>ellip(N, rp, rs, Wn, btype=&#39;low&#39;, analog=False, output=&#39;ba&#39;, fs=None):</div>
<div class="line"><span class="lineno"> 3286</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3287</span><span class="stringliteral">    Elliptic (Cauer) digital and analog filter design.</span></div>
<div class="line"><span class="lineno"> 3288</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3289</span><span class="stringliteral">    Design an Nth-order digital or analog elliptic filter and return</span></div>
<div class="line"><span class="lineno"> 3290</span><span class="stringliteral">    the filter coefficients.</span></div>
<div class="line"><span class="lineno"> 3291</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3292</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 3293</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 3294</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno"> 3295</span><span class="stringliteral">        The order of the filter.</span></div>
<div class="line"><span class="lineno"> 3296</span><span class="stringliteral">    rp : float</span></div>
<div class="line"><span class="lineno"> 3297</span><span class="stringliteral">        The maximum ripple allowed below unity gain in the passband.</span></div>
<div class="line"><span class="lineno"> 3298</span><span class="stringliteral">        Specified in decibels, as a positive number.</span></div>
<div class="line"><span class="lineno"> 3299</span><span class="stringliteral">    rs : float</span></div>
<div class="line"><span class="lineno"> 3300</span><span class="stringliteral">        The minimum attenuation required in the stop band.</span></div>
<div class="line"><span class="lineno"> 3301</span><span class="stringliteral">        Specified in decibels, as a positive number.</span></div>
<div class="line"><span class="lineno"> 3302</span><span class="stringliteral">    Wn : array_like</span></div>
<div class="line"><span class="lineno"> 3303</span><span class="stringliteral">        A scalar or length-2 sequence giving the critical frequencies.</span></div>
<div class="line"><span class="lineno"> 3304</span><span class="stringliteral">        For elliptic filters, this is the point in the transition band at</span></div>
<div class="line"><span class="lineno"> 3305</span><span class="stringliteral">        which the gain first drops below -`rp`.</span></div>
<div class="line"><span class="lineno"> 3306</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3307</span><span class="stringliteral">        For digital filters, `Wn` are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 3308</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 3309</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`Wn` is thus in</span></div>
<div class="line"><span class="lineno"> 3310</span><span class="stringliteral">        half-cycles / sample.)</span></div>
<div class="line"><span class="lineno"> 3311</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3312</span><span class="stringliteral">        For analog filters, `Wn` is an angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 3313</span><span class="stringliteral">    btype : {&#39;lowpass&#39;, &#39;highpass&#39;, &#39;bandpass&#39;, &#39;bandstop&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3314</span><span class="stringliteral">        The type of filter. Default is &#39;lowpass&#39;.</span></div>
<div class="line"><span class="lineno"> 3315</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 3316</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 3317</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 3318</span><span class="stringliteral">    output : {&#39;ba&#39;, &#39;zpk&#39;, &#39;sos&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 3319</span><span class="stringliteral">        Type of output:  numerator/denominator (&#39;ba&#39;), pole-zero (&#39;zpk&#39;), or</span></div>
<div class="line"><span class="lineno"> 3320</span><span class="stringliteral">        second-order sections (&#39;sos&#39;). Default is &#39;ba&#39; for backwards</span></div>
<div class="line"><span class="lineno"> 3321</span><span class="stringliteral">        compatibility, but &#39;sos&#39; should be used for general-purpose filtering.</span></div>
<div class="line"><span class="lineno"> 3322</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 3323</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 3324</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3325</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 3326</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3327</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 3328</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 3329</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 3330</span><span class="stringliteral">        Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 3331</span><span class="stringliteral">        Only returned if ``output=&#39;ba&#39;``.</span></div>
<div class="line"><span class="lineno"> 3332</span><span class="stringliteral">    z, p, k : ndarray, ndarray, float</span></div>
<div class="line"><span class="lineno"> 3333</span><span class="stringliteral">        Zeros, poles, and system gain of the IIR filter transfer</span></div>
<div class="line"><span class="lineno"> 3334</span><span class="stringliteral">        function.  Only returned if ``output=&#39;zpk&#39;``.</span></div>
<div class="line"><span class="lineno"> 3335</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 3336</span><span class="stringliteral">        Second-order sections representation of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 3337</span><span class="stringliteral">        Only returned if ``output==&#39;sos&#39;``.</span></div>
<div class="line"><span class="lineno"> 3338</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3339</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 3340</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3341</span><span class="stringliteral">    ellipord, ellipap</span></div>
<div class="line"><span class="lineno"> 3342</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3343</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 3344</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 3345</span><span class="stringliteral">    Also known as Cauer or Zolotarev filters, the elliptical filter maximizes</span></div>
<div class="line"><span class="lineno"> 3346</span><span class="stringliteral">    the rate of transition between the frequency response&#39;s passband and</span></div>
<div class="line"><span class="lineno"> 3347</span><span class="stringliteral">    stopband, at the expense of ripple in both, and increased ringing in the</span></div>
<div class="line"><span class="lineno"> 3348</span><span class="stringliteral">    step response.</span></div>
<div class="line"><span class="lineno"> 3349</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3350</span><span class="stringliteral">    As `rp` approaches 0, the elliptical filter becomes a Chebyshev</span></div>
<div class="line"><span class="lineno"> 3351</span><span class="stringliteral">    type II filter (`cheby2`). As `rs` approaches 0, it becomes a Chebyshev</span></div>
<div class="line"><span class="lineno"> 3352</span><span class="stringliteral">    type I filter (`cheby1`). As both approach 0, it becomes a Butterworth</span></div>
<div class="line"><span class="lineno"> 3353</span><span class="stringliteral">    filter (`butter`).</span></div>
<div class="line"><span class="lineno"> 3354</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3355</span><span class="stringliteral">    The equiripple passband has N maxima or minima (for example, a</span></div>
<div class="line"><span class="lineno"> 3356</span><span class="stringliteral">    5th-order filter has 3 maxima and 2 minima). Consequently, the DC gain is</span></div>
<div class="line"><span class="lineno"> 3357</span><span class="stringliteral">    unity for odd-order filters, or -rp dB for even-order filters.</span></div>
<div class="line"><span class="lineno"> 3358</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3359</span><span class="stringliteral">    The ``&#39;sos&#39;`` output parameter was added in 0.16.0.</span></div>
<div class="line"><span class="lineno"> 3360</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3361</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 3362</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 3363</span><span class="stringliteral">    Design an analog filter and plot its frequency response, showing the</span></div>
<div class="line"><span class="lineno"> 3364</span><span class="stringliteral">    critical points:</span></div>
<div class="line"><span class="lineno"> 3365</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3366</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 3367</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 3368</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3369</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.ellip(4, 5, 40, 100, &#39;low&#39;, analog=True)</span></div>
<div class="line"><span class="lineno"> 3370</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a)</span></div>
<div class="line"><span class="lineno"> 3371</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 3372</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Elliptic filter frequency response (rp=5, rs=40)&#39;)</span></div>
<div class="line"><span class="lineno"> 3373</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 3374</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 3375</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 3376</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 3377</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(100, color=&#39;green&#39;) # cutoff frequency</span></div>
<div class="line"><span class="lineno"> 3378</span><span class="stringliteral">    &gt;&gt;&gt; plt.axhline(-40, color=&#39;green&#39;) # rs</span></div>
<div class="line"><span class="lineno"> 3379</span><span class="stringliteral">    &gt;&gt;&gt; plt.axhline(-5, color=&#39;green&#39;) # rp</span></div>
<div class="line"><span class="lineno"> 3380</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3381</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3382</span><span class="stringliteral">    Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz</span></div>
<div class="line"><span class="lineno"> 3383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3384</span><span class="stringliteral">    &gt;&gt;&gt; t = np.linspace(0, 1, 1000, False)  # 1 second</span></div>
<div class="line"><span class="lineno"> 3385</span><span class="stringliteral">    &gt;&gt;&gt; sig = np.sin(2*np.pi*10*t) + np.sin(2*np.pi*20*t)</span></div>
<div class="line"><span class="lineno"> 3386</span><span class="stringliteral">    &gt;&gt;&gt; fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)</span></div>
<div class="line"><span class="lineno"> 3387</span><span class="stringliteral">    &gt;&gt;&gt; ax1.plot(t, sig)</span></div>
<div class="line"><span class="lineno"> 3388</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_title(&#39;10 Hz and 20 Hz sinusoids&#39;)</span></div>
<div class="line"><span class="lineno"> 3389</span><span class="stringliteral">    &gt;&gt;&gt; ax1.axis([0, 1, -2, 2])</span></div>
<div class="line"><span class="lineno"> 3390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3391</span><span class="stringliteral">    Design a digital high-pass filter at 17 Hz to remove the 10 Hz tone, and</span></div>
<div class="line"><span class="lineno"> 3392</span><span class="stringliteral">    apply it to the signal. (It&#39;s recommended to use second-order sections</span></div>
<div class="line"><span class="lineno"> 3393</span><span class="stringliteral">    format when filtering, to avoid numerical error with transfer function</span></div>
<div class="line"><span class="lineno"> 3394</span><span class="stringliteral">    (``ba``) format):</span></div>
<div class="line"><span class="lineno"> 3395</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3396</span><span class="stringliteral">    &gt;&gt;&gt; sos = signal.ellip(8, 1, 100, 17, &#39;hp&#39;, fs=1000, output=&#39;sos&#39;)</span></div>
<div class="line"><span class="lineno"> 3397</span><span class="stringliteral">    &gt;&gt;&gt; filtered = signal.sosfilt(sos, sig)</span></div>
<div class="line"><span class="lineno"> 3398</span><span class="stringliteral">    &gt;&gt;&gt; ax2.plot(t, filtered)</span></div>
<div class="line"><span class="lineno"> 3399</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_title(&#39;After 17 Hz high-pass filter&#39;)</span></div>
<div class="line"><span class="lineno"> 3400</span><span class="stringliteral">    &gt;&gt;&gt; ax2.axis([0, 1, -2, 2])</span></div>
<div class="line"><span class="lineno"> 3401</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_xlabel(&#39;Time [seconds]&#39;)</span></div>
<div class="line"><span class="lineno"> 3402</span><span class="stringliteral">    &gt;&gt;&gt; plt.tight_layout()</span></div>
<div class="line"><span class="lineno"> 3403</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 3404</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3405</span>    <span class="keywordflow">return</span> iirfilter(N, Wn, rs=rs, rp=rp, btype=btype, analog=analog,</div>
<div class="line"><span class="lineno"> 3406</span>                     output=output, ftype=<span class="stringliteral">&#39;elliptic&#39;</span>, fs=fs)</div>
<div class="line"><span class="lineno"> 3407</span> </div>
<div class="line"><span class="lineno"> 3408</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a23f21ad85d8274746e8029345a2d6dd2" name="a23f21ad85d8274746e8029345a2d6dd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23f21ad85d8274746e8029345a2d6dd2">&#9670;&#160;</a></span>ellipap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.ellipap </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return (z,p,k) of Nth-order elliptic analog lowpass filter.

The filter is a normalized prototype that has `rp` decibels of ripple
in the passband and a stopband `rs` decibels down.

The filter's angular (e.g., rad/s) cutoff frequency is normalized to 1,
defined as the point at which the gain first drops below ``-rp``.

See Also
--------
ellip : Filter design function using this prototype

References
----------
.. [1] Lutova, Tosic, and Evans, "Filter Design for Signal Processing",
       Chapters 5 and 12.

.. [2] Orfanidis, "Lecture Notes on Elliptic Filter Design",
       https://www.ece.rutgers.edu/~orfanidi/ece521/notes.pdf</pre> <div class="fragment"><div class="line"><span class="lineno"> 4491</span><span class="keyword">def </span>ellipap(N, rp, rs):</div>
<div class="line"><span class="lineno"> 4492</span>    <span class="stringliteral">&quot;&quot;&quot;Return (z,p,k) of Nth-order elliptic analog lowpass filter.</span></div>
<div class="line"><span class="lineno"> 4493</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4494</span><span class="stringliteral">    The filter is a normalized prototype that has `rp` decibels of ripple</span></div>
<div class="line"><span class="lineno"> 4495</span><span class="stringliteral">    in the passband and a stopband `rs` decibels down.</span></div>
<div class="line"><span class="lineno"> 4496</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4497</span><span class="stringliteral">    The filter&#39;s angular (e.g., rad/s) cutoff frequency is normalized to 1,</span></div>
<div class="line"><span class="lineno"> 4498</span><span class="stringliteral">    defined as the point at which the gain first drops below ``-rp``.</span></div>
<div class="line"><span class="lineno"> 4499</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4500</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 4501</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4502</span><span class="stringliteral">    ellip : Filter design function using this prototype</span></div>
<div class="line"><span class="lineno"> 4503</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4504</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 4505</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4506</span><span class="stringliteral">    .. [1] Lutova, Tosic, and Evans, &quot;Filter Design for Signal Processing&quot;,</span></div>
<div class="line"><span class="lineno"> 4507</span><span class="stringliteral">           Chapters 5 and 12.</span></div>
<div class="line"><span class="lineno"> 4508</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4509</span><span class="stringliteral">    .. [2] Orfanidis, &quot;Lecture Notes on Elliptic Filter Design&quot;,</span></div>
<div class="line"><span class="lineno"> 4510</span><span class="stringliteral">           https://www.ece.rutgers.edu/~orfanidi/ece521/notes.pdf</span></div>
<div class="line"><span class="lineno"> 4511</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4512</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4513</span>    <span class="keywordflow">if</span> abs(int(N)) != N:</div>
<div class="line"><span class="lineno"> 4514</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Filter order must be a nonnegative integer&quot;</span>)</div>
<div class="line"><span class="lineno"> 4515</span>    <span class="keywordflow">elif</span> N == 0:</div>
<div class="line"><span class="lineno"> 4516</span>        <span class="comment"># Avoid divide-by-zero warning</span></div>
<div class="line"><span class="lineno"> 4517</span>        <span class="comment"># Even order filters have DC gain of -rp dB</span></div>
<div class="line"><span class="lineno"> 4518</span>        <span class="keywordflow">return</span> numpy.array([]), numpy.array([]), 10**(-rp/20)</div>
<div class="line"><span class="lineno"> 4519</span>    <span class="keywordflow">elif</span> N == 1:</div>
<div class="line"><span class="lineno"> 4520</span>        p = -sqrt(1.0 / _pow10m1(0.1 * rp))</div>
<div class="line"><span class="lineno"> 4521</span>        k = -p</div>
<div class="line"><span class="lineno"> 4522</span>        z = []</div>
<div class="line"><span class="lineno"> 4523</span>        <span class="keywordflow">return</span> asarray(z), asarray(p), k</div>
<div class="line"><span class="lineno"> 4524</span> </div>
<div class="line"><span class="lineno"> 4525</span>    eps_sq = _pow10m1(0.1 * rp)</div>
<div class="line"><span class="lineno"> 4526</span> </div>
<div class="line"><span class="lineno"> 4527</span>    eps = np.sqrt(eps_sq)</div>
<div class="line"><span class="lineno"> 4528</span>    ck1_sq = eps_sq / _pow10m1(0.1 * rs)</div>
<div class="line"><span class="lineno"> 4529</span>    <span class="keywordflow">if</span> ck1_sq == 0:</div>
<div class="line"><span class="lineno"> 4530</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Cannot design a filter with given rp and rs&quot;</span></div>
<div class="line"><span class="lineno"> 4531</span>                         <span class="stringliteral">&quot; specifications.&quot;</span>)</div>
<div class="line"><span class="lineno"> 4532</span> </div>
<div class="line"><span class="lineno"> 4533</span>    val = special.ellipk(ck1_sq), special.ellipkm1(ck1_sq)</div>
<div class="line"><span class="lineno"> 4534</span> </div>
<div class="line"><span class="lineno"> 4535</span>    m = _ellipdeg(N, ck1_sq)</div>
<div class="line"><span class="lineno"> 4536</span> </div>
<div class="line"><span class="lineno"> 4537</span>    capk = special.ellipk(m)</div>
<div class="line"><span class="lineno"> 4538</span> </div>
<div class="line"><span class="lineno"> 4539</span>    j = numpy.arange(1 - N % 2, N, 2)</div>
<div class="line"><span class="lineno"> 4540</span>    jj = len(j)</div>
<div class="line"><span class="lineno"> 4541</span> </div>
<div class="line"><span class="lineno"> 4542</span>    [s, c, d, phi] = special.ellipj(j * capk / N, m * numpy.ones(jj))</div>
<div class="line"><span class="lineno"> 4543</span>    snew = numpy.compress(abs(s) &gt; EPSILON, s, axis=-1)</div>
<div class="line"><span class="lineno"> 4544</span>    z = 1.0 / (sqrt(m) * snew)</div>
<div class="line"><span class="lineno"> 4545</span>    z = 1j * z</div>
<div class="line"><span class="lineno"> 4546</span>    z = numpy.concatenate((z, conjugate(z)))</div>
<div class="line"><span class="lineno"> 4547</span> </div>
<div class="line"><span class="lineno"> 4548</span>    r = _arc_jac_sc1(1. / eps, ck1_sq)</div>
<div class="line"><span class="lineno"> 4549</span>    v0 = capk * r / (N * val[0])</div>
<div class="line"><span class="lineno"> 4550</span> </div>
<div class="line"><span class="lineno"> 4551</span>    [sv, cv, dv, phi] = special.ellipj(v0, 1 - m)</div>
<div class="line"><span class="lineno"> 4552</span>    p = -(c * d * sv * cv + 1j * s * dv) / (1 - (d * sv) ** 2.0)</div>
<div class="line"><span class="lineno"> 4553</span> </div>
<div class="line"><span class="lineno"> 4554</span>    <span class="keywordflow">if</span> N % 2:</div>
<div class="line"><span class="lineno"> 4555</span>        newp = numpy.compress(abs(p.imag) &gt; EPSILON *</div>
<div class="line"><span class="lineno"> 4556</span>                              numpy.sqrt(numpy.sum(p * numpy.conjugate(p),</div>
<div class="line"><span class="lineno"> 4557</span>                                                   axis=0).real),</div>
<div class="line"><span class="lineno"> 4558</span>                              p, axis=-1)</div>
<div class="line"><span class="lineno"> 4559</span>        p = numpy.concatenate((p, conjugate(newp)))</div>
<div class="line"><span class="lineno"> 4560</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4561</span>        p = numpy.concatenate((p, conjugate(p)))</div>
<div class="line"><span class="lineno"> 4562</span> </div>
<div class="line"><span class="lineno"> 4563</span>    k = (numpy.prod(-p, axis=0) / numpy.prod(-z, axis=0)).real</div>
<div class="line"><span class="lineno"> 4564</span>    <span class="keywordflow">if</span> N % 2 == 0:</div>
<div class="line"><span class="lineno"> 4565</span>        k = k / numpy.sqrt((1 + eps_sq))</div>
<div class="line"><span class="lineno"> 4566</span> </div>
<div class="line"><span class="lineno"> 4567</span>    <span class="keywordflow">return</span> z, p, k</div>
<div class="line"><span class="lineno"> 4568</span> </div>
<div class="line"><span class="lineno"> 4569</span> </div>
<div class="line"><span class="lineno"> 4570</span><span class="comment"># TODO: Make this a real public function scipy.misc.ff</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ef9f4f8f06e8223d397899d35ee6772" name="a6ef9f4f8f06e8223d397899d35ee6772"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ef9f4f8f06e8223d397899d35ee6772">&#9670;&#160;</a></span>ellipord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.ellipord </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gstop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Elliptic (Cauer) filter order selection.

Return the order of the lowest order digital or analog elliptic filter
that loses no more than `gpass` dB in the passband and has at least
`gstop` dB attenuation in the stopband.

Parameters
----------
wp, ws : float
    Passband and stopband edge frequencies.

    For digital filters, these are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`wp` and `ws` are thus in
    half-cycles / sample.) For example:

        - Lowpass:   wp = 0.2,          ws = 0.3
        - Highpass:  wp = 0.3,          ws = 0.2
        - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]
        - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]

    For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).
gpass : float
    The maximum loss in the passband (dB).
gstop : float
    The minimum attenuation in the stopband (dB).
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
ord : int
    The lowest order for an Elliptic (Cauer) filter that meets specs.
wn : ndarray or float
    The Chebyshev natural frequency (the "3dB frequency") for use with
    `ellip` to give filter results. If `fs` is specified,
    this is in the same units, and `fs` must also be passed to `ellip`.

See Also
--------
ellip : Filter design using order and critical points
buttord : Find order and critical points from passband and stopband spec
cheb1ord, cheb2ord
iirfilter : General filter design using order and critical frequencies
iirdesign : General filter design using passband and stopband spec

Examples
--------
Design an analog highpass filter such that the passband is within 3 dB
above 30 rad/s, while rejecting -60 dB at 10 rad/s. Plot its
frequency response, showing the passband and stopband constraints in gray.

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; N, Wn = signal.ellipord(30, 10, 3, 60, True)
&gt;&gt;&gt; b, a = signal.ellip(N, 3, 60, Wn, 'high', True)
&gt;&gt;&gt; w, h = signal.freqs(b, a, np.logspace(0, 3, 500))
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.title('Elliptical highpass filter fit to constraints')
&gt;&gt;&gt; plt.xlabel('Frequency [radians / second]')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.fill([.1, 10,  10,  .1], [1e4, 1e4, -60, -60], '0.9', lw=0) # stop
&gt;&gt;&gt; plt.fill([30, 30, 1e9, 1e9], [-99,  -3,  -3, -99], '0.9', lw=0) # pass
&gt;&gt;&gt; plt.axis([1, 300, -80, 3])
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno"> 4125</span><span class="keyword">def </span>ellipord(wp, ws, gpass, gstop, analog=False, fs=None):</div>
<div class="line"><span class="lineno"> 4126</span>    <span class="stringliteral">&quot;&quot;&quot;Elliptic (Cauer) filter order selection.</span></div>
<div class="line"><span class="lineno"> 4127</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4128</span><span class="stringliteral">    Return the order of the lowest order digital or analog elliptic filter</span></div>
<div class="line"><span class="lineno"> 4129</span><span class="stringliteral">    that loses no more than `gpass` dB in the passband and has at least</span></div>
<div class="line"><span class="lineno"> 4130</span><span class="stringliteral">    `gstop` dB attenuation in the stopband.</span></div>
<div class="line"><span class="lineno"> 4131</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4132</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 4133</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4134</span><span class="stringliteral">    wp, ws : float</span></div>
<div class="line"><span class="lineno"> 4135</span><span class="stringliteral">        Passband and stopband edge frequencies.</span></div>
<div class="line"><span class="lineno"> 4136</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4137</span><span class="stringliteral">        For digital filters, these are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 4138</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 4139</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`wp` and `ws` are thus in</span></div>
<div class="line"><span class="lineno"> 4140</span><span class="stringliteral">        half-cycles / sample.) For example:</span></div>
<div class="line"><span class="lineno"> 4141</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4142</span><span class="stringliteral">            - Lowpass:   wp = 0.2,          ws = 0.3</span></div>
<div class="line"><span class="lineno"> 4143</span><span class="stringliteral">            - Highpass:  wp = 0.3,          ws = 0.2</span></div>
<div class="line"><span class="lineno"> 4144</span><span class="stringliteral">            - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]</span></div>
<div class="line"><span class="lineno"> 4145</span><span class="stringliteral">            - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]</span></div>
<div class="line"><span class="lineno"> 4146</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4147</span><span class="stringliteral">        For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 4148</span><span class="stringliteral">    gpass : float</span></div>
<div class="line"><span class="lineno"> 4149</span><span class="stringliteral">        The maximum loss in the passband (dB).</span></div>
<div class="line"><span class="lineno"> 4150</span><span class="stringliteral">    gstop : float</span></div>
<div class="line"><span class="lineno"> 4151</span><span class="stringliteral">        The minimum attenuation in the stopband (dB).</span></div>
<div class="line"><span class="lineno"> 4152</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 4153</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 4154</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 4155</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 4156</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 4157</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4158</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 4159</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4160</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 4161</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 4162</span><span class="stringliteral">    ord : int</span></div>
<div class="line"><span class="lineno"> 4163</span><span class="stringliteral">        The lowest order for an Elliptic (Cauer) filter that meets specs.</span></div>
<div class="line"><span class="lineno"> 4164</span><span class="stringliteral">    wn : ndarray or float</span></div>
<div class="line"><span class="lineno"> 4165</span><span class="stringliteral">        The Chebyshev natural frequency (the &quot;3dB frequency&quot;) for use with</span></div>
<div class="line"><span class="lineno"> 4166</span><span class="stringliteral">        `ellip` to give filter results. If `fs` is specified,</span></div>
<div class="line"><span class="lineno"> 4167</span><span class="stringliteral">        this is in the same units, and `fs` must also be passed to `ellip`.</span></div>
<div class="line"><span class="lineno"> 4168</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4169</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 4170</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4171</span><span class="stringliteral">    ellip : Filter design using order and critical points</span></div>
<div class="line"><span class="lineno"> 4172</span><span class="stringliteral">    buttord : Find order and critical points from passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 4173</span><span class="stringliteral">    cheb1ord, cheb2ord</span></div>
<div class="line"><span class="lineno"> 4174</span><span class="stringliteral">    iirfilter : General filter design using order and critical frequencies</span></div>
<div class="line"><span class="lineno"> 4175</span><span class="stringliteral">    iirdesign : General filter design using passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 4176</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4177</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 4178</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4179</span><span class="stringliteral">    Design an analog highpass filter such that the passband is within 3 dB</span></div>
<div class="line"><span class="lineno"> 4180</span><span class="stringliteral">    above 30 rad/s, while rejecting -60 dB at 10 rad/s. Plot its</span></div>
<div class="line"><span class="lineno"> 4181</span><span class="stringliteral">    frequency response, showing the passband and stopband constraints in gray.</span></div>
<div class="line"><span class="lineno"> 4182</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4183</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 4184</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 4185</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4186</span><span class="stringliteral">    &gt;&gt;&gt; N, Wn = signal.ellipord(30, 10, 3, 60, True)</span></div>
<div class="line"><span class="lineno"> 4187</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.ellip(N, 3, 60, Wn, &#39;high&#39;, True)</span></div>
<div class="line"><span class="lineno"> 4188</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a, np.logspace(0, 3, 500))</span></div>
<div class="line"><span class="lineno"> 4189</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 4190</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Elliptical highpass filter fit to constraints&#39;)</span></div>
<div class="line"><span class="lineno"> 4191</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [radians / second]&#39;)</span></div>
<div class="line"><span class="lineno"> 4192</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 4193</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 4194</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([.1, 10,  10,  .1], [1e4, 1e4, -60, -60], &#39;0.9&#39;, lw=0) # stop</span></div>
<div class="line"><span class="lineno"> 4195</span><span class="stringliteral">    &gt;&gt;&gt; plt.fill([30, 30, 1e9, 1e9], [-99,  -3,  -3, -99], &#39;0.9&#39;, lw=0) # pass</span></div>
<div class="line"><span class="lineno"> 4196</span><span class="stringliteral">    &gt;&gt;&gt; plt.axis([1, 300, -80, 3])</span></div>
<div class="line"><span class="lineno"> 4197</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 4198</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4199</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4200</span> </div>
<div class="line"><span class="lineno"> 4201</span>    _validate_gpass_gstop(gpass, gstop)</div>
<div class="line"><span class="lineno"> 4202</span> </div>
<div class="line"><span class="lineno"> 4203</span>    wp = atleast_1d(wp)</div>
<div class="line"><span class="lineno"> 4204</span>    ws = atleast_1d(ws)</div>
<div class="line"><span class="lineno"> 4205</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 4206</span>        <span class="keywordflow">if</span> analog:</div>
<div class="line"><span class="lineno"> 4207</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;fs cannot be specified for an analog filter&quot;</span>)</div>
<div class="line"><span class="lineno"> 4208</span>        wp = 2*wp/fs</div>
<div class="line"><span class="lineno"> 4209</span>        ws = 2*ws/fs</div>
<div class="line"><span class="lineno"> 4210</span> </div>
<div class="line"><span class="lineno"> 4211</span>    filter_type = 2 * (len(wp) - 1)</div>
<div class="line"><span class="lineno"> 4212</span>    filter_type += 1</div>
<div class="line"><span class="lineno"> 4213</span>    <span class="keywordflow">if</span> wp[0] &gt;= ws[0]:</div>
<div class="line"><span class="lineno"> 4214</span>        filter_type += 1</div>
<div class="line"><span class="lineno"> 4215</span> </div>
<div class="line"><span class="lineno"> 4216</span>    <span class="comment"># Pre-warp frequencies for digital filter design</span></div>
<div class="line"><span class="lineno"> 4217</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 4218</span>        passb = tan(pi * wp / 2.0)</div>
<div class="line"><span class="lineno"> 4219</span>        stopb = tan(pi * ws / 2.0)</div>
<div class="line"><span class="lineno"> 4220</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4221</span>        passb = wp * 1.0</div>
<div class="line"><span class="lineno"> 4222</span>        stopb = ws * 1.0</div>
<div class="line"><span class="lineno"> 4223</span> </div>
<div class="line"><span class="lineno"> 4224</span>    <span class="keywordflow">if</span> filter_type == 1:           <span class="comment"># low</span></div>
<div class="line"><span class="lineno"> 4225</span>        nat = stopb / passb</div>
<div class="line"><span class="lineno"> 4226</span>    <span class="keywordflow">elif</span> filter_type == 2:          <span class="comment"># high</span></div>
<div class="line"><span class="lineno"> 4227</span>        nat = passb / stopb</div>
<div class="line"><span class="lineno"> 4228</span>    <span class="keywordflow">elif</span> filter_type == 3:     <span class="comment"># stop</span></div>
<div class="line"><span class="lineno"> 4229</span>        wp0 = optimize.fminbound(band_stop_obj, passb[0], stopb[0] - 1e-12,</div>
<div class="line"><span class="lineno"> 4230</span>                                 args=(0, passb, stopb, gpass, gstop, <span class="stringliteral">&#39;ellip&#39;</span>),</div>
<div class="line"><span class="lineno"> 4231</span>                                 disp=0)</div>
<div class="line"><span class="lineno"> 4232</span>        passb[0] = wp0</div>
<div class="line"><span class="lineno"> 4233</span>        wp1 = optimize.fminbound(band_stop_obj, stopb[1] + 1e-12, passb[1],</div>
<div class="line"><span class="lineno"> 4234</span>                                 args=(1, passb, stopb, gpass, gstop, <span class="stringliteral">&#39;ellip&#39;</span>),</div>
<div class="line"><span class="lineno"> 4235</span>                                 disp=0)</div>
<div class="line"><span class="lineno"> 4236</span>        passb[1] = wp1</div>
<div class="line"><span class="lineno"> 4237</span>        nat = ((stopb * (passb[0] - passb[1])) /</div>
<div class="line"><span class="lineno"> 4238</span>               (stopb ** 2 - passb[0] * passb[1]))</div>
<div class="line"><span class="lineno"> 4239</span>    <span class="keywordflow">elif</span> filter_type == 4:  <span class="comment"># pass</span></div>
<div class="line"><span class="lineno"> 4240</span>        nat = ((stopb ** 2 - passb[0] * passb[1]) /</div>
<div class="line"><span class="lineno"> 4241</span>               (stopb * (passb[0] - passb[1])))</div>
<div class="line"><span class="lineno"> 4242</span> </div>
<div class="line"><span class="lineno"> 4243</span>    nat = min(abs(nat))</div>
<div class="line"><span class="lineno"> 4244</span> </div>
<div class="line"><span class="lineno"> 4245</span>    arg1_sq = _pow10m1(0.1 * gpass) / _pow10m1(0.1 * gstop)</div>
<div class="line"><span class="lineno"> 4246</span>    arg0 = 1.0 / nat</div>
<div class="line"><span class="lineno"> 4247</span>    d0 = special.ellipk(arg0 ** 2), special.ellipkm1(arg0 ** 2)</div>
<div class="line"><span class="lineno"> 4248</span>    d1 = special.ellipk(arg1_sq), special.ellipkm1(arg1_sq)</div>
<div class="line"><span class="lineno"> 4249</span>    ord = int(ceil(d0[0] * d1[1] / (d0[1] * d1[0])))</div>
<div class="line"><span class="lineno"> 4250</span> </div>
<div class="line"><span class="lineno"> 4251</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 4252</span>        wn = arctan(passb) * 2.0 / pi</div>
<div class="line"><span class="lineno"> 4253</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 4254</span>        wn = passb</div>
<div class="line"><span class="lineno"> 4255</span> </div>
<div class="line"><span class="lineno"> 4256</span>    <span class="keywordflow">if</span> len(wn) == 1:</div>
<div class="line"><span class="lineno"> 4257</span>        wn = wn[0]</div>
<div class="line"><span class="lineno"> 4258</span> </div>
<div class="line"><span class="lineno"> 4259</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 4260</span>        wn = wn*fs/2</div>
<div class="line"><span class="lineno"> 4261</span> </div>
<div class="line"><span class="lineno"> 4262</span>    <span class="keywordflow">return</span> ord, wn</div>
<div class="line"><span class="lineno"> 4263</span> </div>
<div class="line"><span class="lineno"> 4264</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a121c7e536c227088450930f0b93805ad" name="a121c7e536c227088450930f0b93805ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a121c7e536c227088450930f0b93805ad">&#9670;&#160;</a></span>findfreqs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.findfreqs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>den</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kind</em> = <code>'ba'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find array of frequencies for computing the response of an analog filter.

Parameters
----------
num, den : array_like, 1-D
    The polynomial coefficients of the numerator and denominator of the
    transfer function of the filter or LTI system, where the coefficients
    are ordered from highest to lowest degree. Or, the roots  of the
    transfer function numerator and denominator (i.e., zeroes and poles).
N : int
    The length of the array to be computed.
kind : str {'ba', 'zp'}, optional
    Specifies whether the numerator and denominator are specified by their
    polynomial coefficients ('ba'), or their roots ('zp').

Returns
-------
w : (N,) ndarray
    A 1-D array of frequencies, logarithmically spaced.

Examples
--------
Find a set of nine frequencies that span the "interesting part" of the
frequency response for the filter with the transfer function

    H(s) = s / (s^2 + 8s + 25)

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; signal.findfreqs([1, 0], [1, 8, 25], N=9)
array([  1.00000000e-02,   3.16227766e-02,   1.00000000e-01,
         3.16227766e-01,   1.00000000e+00,   3.16227766e+00,
         1.00000000e+01,   3.16227766e+01,   1.00000000e+02])
</pre> <div class="fragment"><div class="line"><span class="lineno">   58</span><span class="keyword">def </span>findfreqs(num, den, N, kind=&#39;ba&#39;):</div>
<div class="line"><span class="lineno">   59</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">    Find array of frequencies for computing the response of an analog filter.</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">    num, den : array_like, 1-D</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        The polynomial coefficients of the numerator and denominator of the</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">        transfer function of the filter or LTI system, where the coefficients</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">        are ordered from highest to lowest degree. Or, the roots  of the</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        transfer function numerator and denominator (i.e., zeroes and poles).</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        The length of the array to be computed.</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    kind : str {&#39;ba&#39;, &#39;zp&#39;}, optional</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">        Specifies whether the numerator and denominator are specified by their</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        polynomial coefficients (&#39;ba&#39;), or their roots (&#39;zp&#39;).</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    w : (N,) ndarray</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        A 1-D array of frequencies, logarithmically spaced.</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    Find a set of nine frequencies that span the &quot;interesting part&quot; of the</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    frequency response for the filter with the transfer function</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        H(s) = s / (s^2 + 8s + 25)</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    &gt;&gt;&gt; signal.findfreqs([1, 0], [1, 8, 25], N=9)</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    array([  1.00000000e-02,   3.16227766e-02,   1.00000000e-01,</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">             3.16227766e-01,   1.00000000e+00,   3.16227766e+00,</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">             1.00000000e+01,   3.16227766e+01,   1.00000000e+02])</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">if</span> kind == <span class="stringliteral">&#39;ba&#39;</span>:</div>
<div class="line"><span class="lineno">   94</span>        ep = atleast_1d(roots(den)) + 0j</div>
<div class="line"><span class="lineno">   95</span>        tz = atleast_1d(roots(num)) + 0j</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">elif</span> kind == <span class="stringliteral">&#39;zp&#39;</span>:</div>
<div class="line"><span class="lineno">   97</span>        ep = atleast_1d(den) + 0j</div>
<div class="line"><span class="lineno">   98</span>        tz = atleast_1d(num) + 0j</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;input must be one of {&#39;ba&#39;, &#39;zp&#39;}&quot;</span>)</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">if</span> len(ep) == 0:</div>
<div class="line"><span class="lineno">  103</span>        ep = atleast_1d(-1000) + 0j</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    ez = r_[<span class="stringliteral">&#39;-1&#39;</span>,</div>
<div class="line"><span class="lineno">  106</span>            numpy.compress(ep.imag &gt;= 0, ep, axis=-1),</div>
<div class="line"><span class="lineno">  107</span>            numpy.compress((abs(tz) &lt; 1e5) &amp; (tz.imag &gt;= 0), tz, axis=-1)]</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    integ = abs(ez) &lt; 1e-10</div>
<div class="line"><span class="lineno">  110</span>    hfreq = numpy.around(numpy.log10(numpy.max(3 * abs(ez.real + integ) +</div>
<div class="line"><span class="lineno">  111</span>                                               1.5 * ez.imag)) + 0.5)</div>
<div class="line"><span class="lineno">  112</span>    lfreq = numpy.around(numpy.log10(0.1 * numpy.min(abs(real(ez + integ)) +</div>
<div class="line"><span class="lineno">  113</span>                                                     2 * ez.imag)) - 0.5)</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    w = logspace(lfreq, hfreq, N)</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">return</span> w</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9575c4eb7f36f5e534309051f96a8bb7" name="a9575c4eb7f36f5e534309051f96a8bb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9575c4eb7f36f5e534309051f96a8bb7">&#9670;&#160;</a></span>freqs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.freqs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>worN</em> = <code>200</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute frequency response of analog filter.

Given the M-order numerator `b` and N-order denominator `a` of an analog
filter, compute its frequency response::

         b[0]*(jw)**M + b[1]*(jw)**(M-1) + ... + b[M]
 H(w) = ----------------------------------------------
         a[0]*(jw)**N + a[1]*(jw)**(N-1) + ... + a[N]

Parameters
----------
b : array_like
    Numerator of a linear filter.
a : array_like
    Denominator of a linear filter.
worN : {None, int, array_like}, optional
    If None, then compute at 200 frequencies around the interesting parts
    of the response curve (determined by pole-zero locations). If a single
    integer, then compute at that many frequencies. Otherwise, compute the
    response at the angular frequencies (e.g., rad/s) given in `worN`.
plot : callable, optional
    A callable that takes two arguments. If given, the return parameters
    `w` and `h` are passed to plot. Useful for plotting the frequency
    response inside `freqs`.

Returns
-------
w : ndarray
    The angular frequencies at which `h` was computed.
h : ndarray
    The frequency response.

See Also
--------
freqz : Compute the frequency response of a digital filter.

Notes
-----
Using Matplotlib's "plot" function as the callable for `plot` produces
unexpected results, this plots the real part of the complex transfer
function, not the magnitude. Try ``lambda w, h: plot(w, abs(h))``.

Examples
--------
&gt;&gt;&gt; from scipy.signal import freqs, iirfilter

&gt;&gt;&gt; b, a = iirfilter(4, [1, 10], 1, 60, analog=True, ftype='cheby1')

&gt;&gt;&gt; w, h = freqs(b, a, worN=np.logspace(-1, 2, 1000))

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.xlabel('Frequency')
&gt;&gt;&gt; plt.ylabel('Amplitude response [dB]')
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  119</span><span class="keyword">def </span>freqs(b, a, worN=200, plot=None):</div>
<div class="line"><span class="lineno">  120</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    Compute frequency response of analog filter.</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    Given the M-order numerator `b` and N-order denominator `a` of an analog</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    filter, compute its frequency response::</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">             b[0]*(jw)**M + b[1]*(jw)**(M-1) + ... + b[M]</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">     H(w) = ----------------------------------------------</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">             a[0]*(jw)**N + a[1]*(jw)**(N-1) + ... + a[N]</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">        Numerator of a linear filter.</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">        Denominator of a linear filter.</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    worN : {None, int, array_like}, optional</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">        If None, then compute at 200 frequencies around the interesting parts</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        of the response curve (determined by pole-zero locations). If a single</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">        integer, then compute at that many frequencies. Otherwise, compute the</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">        response at the angular frequencies (e.g., rad/s) given in `worN`.</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    plot : callable, optional</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">        A callable that takes two arguments. If given, the return parameters</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">        `w` and `h` are passed to plot. Useful for plotting the frequency</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        response inside `freqs`.</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    w : ndarray</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">        The angular frequencies at which `h` was computed.</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">    h : ndarray</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">        The frequency response.</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">    freqz : Compute the frequency response of a digital filter.</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    Using Matplotlib&#39;s &quot;plot&quot; function as the callable for `plot` produces</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">    unexpected results, this plots the real part of the complex transfer</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    function, not the magnitude. Try ``lambda w, h: plot(w, abs(h))``.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.signal import freqs, iirfilter</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">    &gt;&gt;&gt; b, a = iirfilter(4, [1, 10], 1, 60, analog=True, ftype=&#39;cheby1&#39;)</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">    &gt;&gt;&gt; w, h = freqs(b, a, worN=np.logspace(-1, 2, 1000))</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency&#39;)</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude response [dB]&#39;)</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">if</span> worN <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  180</span>        <span class="comment"># For backwards compatibility</span></div>
<div class="line"><span class="lineno">  181</span>        w = findfreqs(b, a, 200)</div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">elif</span> _is_int_type(worN):</div>
<div class="line"><span class="lineno">  183</span>        w = findfreqs(b, a, worN)</div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  185</span>        w = atleast_1d(worN)</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    s = 1j * w</div>
<div class="line"><span class="lineno">  188</span>    h = polyval(b, s) / polyval(a, s)</div>
<div class="line"><span class="lineno">  189</span>    <span class="keywordflow">if</span> plot <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  190</span>        plot(w, h)</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">return</span> w, h</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d1dbc48cfac5f3492922f226c4cd817" name="a8d1dbc48cfac5f3492922f226c4cd817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d1dbc48cfac5f3492922f226c4cd817">&#9670;&#160;</a></span>freqs_zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.freqs_zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>worN</em> = <code>200</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute frequency response of analog filter.

Given the zeros `z`, poles `p`, and gain `k` of a filter, compute its
frequency response::

            (jw-z[0]) * (jw-z[1]) * ... * (jw-z[-1])
 H(w) = k * ----------------------------------------
            (jw-p[0]) * (jw-p[1]) * ... * (jw-p[-1])

Parameters
----------
z : array_like
    Zeroes of a linear filter
p : array_like
    Poles of a linear filter
k : scalar
    Gain of a linear filter
worN : {None, int, array_like}, optional
    If None, then compute at 200 frequencies around the interesting parts
    of the response curve (determined by pole-zero locations). If a single
    integer, then compute at that many frequencies. Otherwise, compute the
    response at the angular frequencies (e.g., rad/s) given in `worN`.

Returns
-------
w : ndarray
    The angular frequencies at which `h` was computed.
h : ndarray
    The frequency response.

See Also
--------
freqs : Compute the frequency response of an analog filter in TF form
freqz : Compute the frequency response of a digital filter in TF form
freqz_zpk : Compute the frequency response of a digital filter in ZPK form

Notes
-----
.. versionadded:: 0.19.0

Examples
--------
&gt;&gt;&gt; from scipy.signal import freqs_zpk, iirfilter

&gt;&gt;&gt; z, p, k = iirfilter(4, [1, 10], 1, 60, analog=True, ftype='cheby1',
...                     output='zpk')

&gt;&gt;&gt; w, h = freqs_zpk(z, p, k, worN=np.logspace(-1, 2, 1000))

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.xlabel('Frequency')
&gt;&gt;&gt; plt.ylabel('Amplitude response [dB]')
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  195</span><span class="keyword">def </span>freqs_zpk(z, p, k, worN=200):</div>
<div class="line"><span class="lineno">  196</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    Compute frequency response of analog filter.</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    Given the zeros `z`, poles `p`, and gain `k` of a filter, compute its</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    frequency response::</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">                (jw-z[0]) * (jw-z[1]) * ... * (jw-z[-1])</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">     H(w) = k * ----------------------------------------</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">                (jw-p[0]) * (jw-p[1]) * ... * (jw-p[-1])</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">        Zeroes of a linear filter</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">        Poles of a linear filter</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    k : scalar</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">        Gain of a linear filter</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">    worN : {None, int, array_like}, optional</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">        If None, then compute at 200 frequencies around the interesting parts</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">        of the response curve (determined by pole-zero locations). If a single</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">        integer, then compute at that many frequencies. Otherwise, compute the</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">        response at the angular frequencies (e.g., rad/s) given in `worN`.</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    w : ndarray</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">        The angular frequencies at which `h` was computed.</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">    h : ndarray</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">        The frequency response.</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">    freqs : Compute the frequency response of an analog filter in TF form</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    freqz : Compute the frequency response of a digital filter in TF form</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">    freqz_zpk : Compute the frequency response of a digital filter in ZPK form</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">    .. versionadded:: 0.19.0</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.signal import freqs_zpk, iirfilter</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    &gt;&gt;&gt; z, p, k = iirfilter(4, [1, 10], 1, 60, analog=True, ftype=&#39;cheby1&#39;,</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">    ...                     output=&#39;zpk&#39;)</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    &gt;&gt;&gt; w, h = freqs_zpk(z, p, k, worN=np.logspace(-1, 2, 1000))</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx(w, 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency&#39;)</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude response [dB]&#39;)</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  254</span>    k = np.asarray(k)</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">if</span> k.size &gt; 1:</div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;k must be a single scalar gain&#39;</span>)</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">if</span> worN <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  259</span>        <span class="comment"># For backwards compatibility</span></div>
<div class="line"><span class="lineno">  260</span>        w = findfreqs(z, p, 200, kind=<span class="stringliteral">&#39;zp&#39;</span>)</div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordflow">elif</span> _is_int_type(worN):</div>
<div class="line"><span class="lineno">  262</span>        w = findfreqs(z, p, worN, kind=<span class="stringliteral">&#39;zp&#39;</span>)</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  264</span>        w = worN</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    w = atleast_1d(w)</div>
<div class="line"><span class="lineno">  267</span>    s = 1j * w</div>
<div class="line"><span class="lineno">  268</span>    num = polyvalfromroots(s, z)</div>
<div class="line"><span class="lineno">  269</span>    den = polyvalfromroots(s, p)</div>
<div class="line"><span class="lineno">  270</span>    h = k * num/den</div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">return</span> w, h</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a57ecfa32b9c147c7075a33d24edd5c74" name="a57ecfa32b9c147c7075a33d24edd5c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57ecfa32b9c147c7075a33d24edd5c74">&#9670;&#160;</a></span>freqz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.freqz </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>worN</em> = <code>512</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>whole</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>2*pi</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>include_nyquist</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the frequency response of a digital filter.

Given the M-order numerator `b` and N-order denominator `a` of a digital
filter, compute its frequency response::

             jw                 -jw              -jwM
    jw    B(e  )    b[0] + b[1]e    + ... + b[M]e
 H(e  ) = ------ = -----------------------------------
             jw                 -jw              -jwN
          A(e  )    a[0] + a[1]e    + ... + a[N]e

Parameters
----------
b : array_like
    Numerator of a linear filter. If `b` has dimension greater than 1,
    it is assumed that the coefficients are stored in the first dimension,
    and ``b.shape[1:]``, ``a.shape[1:]``, and the shape of the frequencies
    array must be compatible for broadcasting.
a : array_like
    Denominator of a linear filter. If `b` has dimension greater than 1,
    it is assumed that the coefficients are stored in the first dimension,
    and ``b.shape[1:]``, ``a.shape[1:]``, and the shape of the frequencies
    array must be compatible for broadcasting.
worN : {None, int, array_like}, optional
    If a single integer, then compute at that many frequencies (default is
    N=512). This is a convenient alternative to::

        np.linspace(0, fs if whole else fs/2, N, endpoint=include_nyquist)

    Using a number that is fast for FFT computations can result in
    faster computations (see Notes).

    If an array_like, compute the response at the frequencies given.
    These are in the same units as `fs`.
whole : bool, optional
    Normally, frequencies are computed from 0 to the Nyquist frequency,
    fs/2 (upper-half of unit-circle). If `whole` is True, compute
    frequencies from 0 to fs. Ignored if worN is array_like.
plot : callable
    A callable that takes two arguments. If given, the return parameters
    `w` and `h` are passed to plot. Useful for plotting the frequency
    response inside `freqz`.
fs : float, optional
    The sampling frequency of the digital system. Defaults to 2*pi
    radians/sample (so w is from 0 to pi).

    .. versionadded:: 1.2.0
include_nyquist : bool, optional
    If `whole` is False and `worN` is an integer, setting `include_nyquist` to True
    will include the last frequency (Nyquist frequency) and is otherwise ignored.

    .. versionadded:: 1.5.0

Returns
-------
w : ndarray
    The frequencies at which `h` was computed, in the same units as `fs`.
    By default, `w` is normalized to the range [0, pi) (radians/sample).
h : ndarray
    The frequency response, as complex numbers.

See Also
--------
freqz_zpk
sosfreqz

Notes
-----
Using Matplotlib's :func:`matplotlib.pyplot.plot` function as the callable
for `plot` produces unexpected results, as this plots the real part of the
complex transfer function, not the magnitude.
Try ``lambda w, h: plot(w, np.abs(h))``.

A direct computation via (R)FFT is used to compute the frequency response
when the following conditions are met:

1. An integer value is given for `worN`.
2. `worN` is fast to compute via FFT (i.e.,
   `next_fast_len(worN) &lt;scipy.fft.next_fast_len&gt;` equals `worN`).
3. The denominator coefficients are a single value (``a.shape[0] == 1``).
4. `worN` is at least as long as the numerator coefficients
   (``worN &gt;= b.shape[0]``).
5. If ``b.ndim &gt; 1``, then ``b.shape[-1] == 1``.

For long FIR filters, the FFT approach can have lower error and be much
faster than the equivalent direct polynomial calculation.

Examples
--------
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; b = signal.firwin(80, 0.5, window=('kaiser', 8))
&gt;&gt;&gt; w, h = signal.freqz(b)

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig, ax1 = plt.subplots()
&gt;&gt;&gt; ax1.set_title('Digital filter frequency response')

&gt;&gt;&gt; ax1.plot(w, 20 * np.log10(abs(h)), 'b')
&gt;&gt;&gt; ax1.set_ylabel('Amplitude [dB]', color='b')
&gt;&gt;&gt; ax1.set_xlabel('Frequency [rad/sample]')

&gt;&gt;&gt; ax2 = ax1.twinx()
&gt;&gt;&gt; angles = np.unwrap(np.angle(h))
&gt;&gt;&gt; ax2.plot(w, angles, 'g')
&gt;&gt;&gt; ax2.set_ylabel('Angle (radians)', color='g')
&gt;&gt;&gt; ax2.grid(True)
&gt;&gt;&gt; ax2.axis('tight')
&gt;&gt;&gt; plt.show()

Broadcasting Examples

Suppose we have two FIR filters whose coefficients are stored in the
rows of an array with shape (2, 25). For this demonstration, we'll
use random data:

&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; b = rng.random((2, 25))

To compute the frequency response for these two filters with one call
to `freqz`, we must pass in ``b.T``, because `freqz` expects the first
axis to hold the coefficients. We must then extend the shape with a
trivial dimension of length 1 to allow broadcasting with the array
of frequencies.  That is, we pass in ``b.T[..., np.newaxis]``, which has
shape (25, 2, 1):

&gt;&gt;&gt; w, h = signal.freqz(b.T[..., np.newaxis], worN=1024)
&gt;&gt;&gt; w.shape
(1024,)
&gt;&gt;&gt; h.shape
(2, 1024)

Now, suppose we have two transfer functions, with the same numerator
coefficients ``b = [0.5, 0.5]``. The coefficients for the two denominators
are stored in the first dimension of the 2-D array  `a`::

    a = [   1      1  ]
        [ -0.25, -0.5 ]

&gt;&gt;&gt; b = np.array([0.5, 0.5])
&gt;&gt;&gt; a = np.array([[1, 1], [-0.25, -0.5]])

Only `a` is more than 1-D. To make it compatible for
broadcasting with the frequencies, we extend it with a trivial dimension
in the call to `freqz`:

&gt;&gt;&gt; w, h = signal.freqz(b, a[..., np.newaxis], worN=1024)
&gt;&gt;&gt; w.shape
(1024,)
&gt;&gt;&gt; h.shape
(2, 1024)</pre> <div class="fragment"><div class="line"><span class="lineno">  274</span><span class="keyword">def </span>freqz(b, a=1, worN=512, whole=False, plot=None, fs=2*pi, include_nyquist=False):</div>
<div class="line"><span class="lineno">  275</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    Compute the frequency response of a digital filter.</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    Given the M-order numerator `b` and N-order denominator `a` of a digital</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">    filter, compute its frequency response::</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">                 jw                 -jw              -jwM</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">        jw    B(e  )    b[0] + b[1]e    + ... + b[M]e</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">     H(e  ) = ------ = -----------------------------------</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">                 jw                 -jw              -jwN</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">              A(e  )    a[0] + a[1]e    + ... + a[N]e</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">        Numerator of a linear filter. If `b` has dimension greater than 1,</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">        it is assumed that the coefficients are stored in the first dimension,</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">        and ``b.shape[1:]``, ``a.shape[1:]``, and the shape of the frequencies</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">        array must be compatible for broadcasting.</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">        Denominator of a linear filter. If `b` has dimension greater than 1,</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">        it is assumed that the coefficients are stored in the first dimension,</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">        and ``b.shape[1:]``, ``a.shape[1:]``, and the shape of the frequencies</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">        array must be compatible for broadcasting.</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">    worN : {None, int, array_like}, optional</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">        If a single integer, then compute at that many frequencies (default is</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">        N=512). This is a convenient alternative to::</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">            np.linspace(0, fs if whole else fs/2, N, endpoint=include_nyquist)</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">        Using a number that is fast for FFT computations can result in</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">        faster computations (see Notes).</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">        If an array_like, compute the response at the frequencies given.</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">        These are in the same units as `fs`.</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    whole : bool, optional</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">        Normally, frequencies are computed from 0 to the Nyquist frequency,</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">        fs/2 (upper-half of unit-circle). If `whole` is True, compute</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">        frequencies from 0 to fs. Ignored if worN is array_like.</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">    plot : callable</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">        A callable that takes two arguments. If given, the return parameters</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">        `w` and `h` are passed to plot. Useful for plotting the frequency</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">        response inside `freqz`.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">        The sampling frequency of the digital system. Defaults to 2*pi</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        radians/sample (so w is from 0 to pi).</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    include_nyquist : bool, optional</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        If `whole` is False and `worN` is an integer, setting `include_nyquist` to True</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">        will include the last frequency (Nyquist frequency) and is otherwise ignored.</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        .. versionadded:: 1.5.0</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    w : ndarray</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">        The frequencies at which `h` was computed, in the same units as `fs`.</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">        By default, `w` is normalized to the range [0, pi) (radians/sample).</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    h : ndarray</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">        The frequency response, as complex numbers.</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">    freqz_zpk</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    sosfreqz</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    Using Matplotlib&#39;s :func:`matplotlib.pyplot.plot` function as the callable</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    for `plot` produces unexpected results, as this plots the real part of the</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    complex transfer function, not the magnitude.</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">    Try ``lambda w, h: plot(w, np.abs(h))``.</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    A direct computation via (R)FFT is used to compute the frequency response</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    when the following conditions are met:</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">    1. An integer value is given for `worN`.</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    2. `worN` is fast to compute via FFT (i.e.,</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">       `next_fast_len(worN) &lt;scipy.fft.next_fast_len&gt;` equals `worN`).</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    3. The denominator coefficients are a single value (``a.shape[0] == 1``).</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">    4. `worN` is at least as long as the numerator coefficients</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">       (``worN &gt;= b.shape[0]``).</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">    5. If ``b.ndim &gt; 1``, then ``b.shape[-1] == 1``.</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">    For long FIR filters, the FFT approach can have lower error and be much</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">    faster than the equivalent direct polynomial calculation.</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">    &gt;&gt;&gt; b = signal.firwin(80, 0.5, window=(&#39;kaiser&#39;, 8))</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz(b)</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">    &gt;&gt;&gt; fig, ax1 = plt.subplots()</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_title(&#39;Digital filter frequency response&#39;)</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">    &gt;&gt;&gt; ax1.plot(w, 20 * np.log10(abs(h)), &#39;b&#39;)</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_ylabel(&#39;Amplitude [dB]&#39;, color=&#39;b&#39;)</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_xlabel(&#39;Frequency [rad/sample]&#39;)</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">    &gt;&gt;&gt; ax2 = ax1.twinx()</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">    &gt;&gt;&gt; angles = np.unwrap(np.angle(h))</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">    &gt;&gt;&gt; ax2.plot(w, angles, &#39;g&#39;)</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_ylabel(&#39;Angle (radians)&#39;, color=&#39;g&#39;)</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">    &gt;&gt;&gt; ax2.grid(True)</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">    &gt;&gt;&gt; ax2.axis(&#39;tight&#39;)</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">    Broadcasting Examples</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">    Suppose we have two FIR filters whose coefficients are stored in the</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">    rows of an array with shape (2, 25). For this demonstration, we&#39;ll</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">    use random data:</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    &gt;&gt;&gt; rng = np.random.default_rng()</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    &gt;&gt;&gt; b = rng.random((2, 25))</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">    To compute the frequency response for these two filters with one call</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    to `freqz`, we must pass in ``b.T``, because `freqz` expects the first</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    axis to hold the coefficients. We must then extend the shape with a</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    trivial dimension of length 1 to allow broadcasting with the array</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">    of frequencies.  That is, we pass in ``b.T[..., np.newaxis]``, which has</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    shape (25, 2, 1):</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz(b.T[..., np.newaxis], worN=1024)</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">    &gt;&gt;&gt; w.shape</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">    (1024,)</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">    &gt;&gt;&gt; h.shape</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">    (2, 1024)</span></div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  407</span><span class="stringliteral">    Now, suppose we have two transfer functions, with the same numerator</span></div>
<div class="line"><span class="lineno">  408</span><span class="stringliteral">    coefficients ``b = [0.5, 0.5]``. The coefficients for the two denominators</span></div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral">    are stored in the first dimension of the 2-D array  `a`::</span></div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">        a = [   1      1  ]</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral">            [ -0.25, -0.5 ]</span></div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral">    &gt;&gt;&gt; b = np.array([0.5, 0.5])</span></div>
<div class="line"><span class="lineno">  415</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 1], [-0.25, -0.5]])</span></div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  417</span><span class="stringliteral">    Only `a` is more than 1-D. To make it compatible for</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">    broadcasting with the frequencies, we extend it with a trivial dimension</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral">    in the call to `freqz`:</span></div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz(b, a[..., np.newaxis], worN=1024)</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">    &gt;&gt;&gt; w.shape</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">    (1024,)</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">    &gt;&gt;&gt; h.shape</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">    (2, 1024)</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  428</span>    b = atleast_1d(b)</div>
<div class="line"><span class="lineno">  429</span>    a = atleast_1d(a)</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">if</span> worN <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  432</span>        <span class="comment"># For backwards compatibility</span></div>
<div class="line"><span class="lineno">  433</span>        worN = 512</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    h = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordflow">if</span> _is_int_type(worN):</div>
<div class="line"><span class="lineno">  438</span>        N = operator.index(worN)</div>
<div class="line"><span class="lineno">  439</span>        del worN</div>
<div class="line"><span class="lineno">  440</span>        <span class="keywordflow">if</span> N &lt; 0:</div>
<div class="line"><span class="lineno">  441</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;worN must be nonnegative, got %s&#39;</span> % (N,))</div>
<div class="line"><span class="lineno">  442</span>        lastpoint = 2 * pi <span class="keywordflow">if</span> whole <span class="keywordflow">else</span> pi</div>
<div class="line"><span class="lineno">  443</span>        <span class="comment"># if include_nyquist is true and whole is false, w should include end point</span></div>
<div class="line"><span class="lineno">  444</span>        w = np.linspace(0, lastpoint, N, endpoint=include_nyquist <span class="keywordflow">and</span> <span class="keywordflow">not</span> whole)</div>
<div class="line"><span class="lineno">  445</span>        <span class="keywordflow">if</span> (a.size == 1 <span class="keywordflow">and</span> N &gt;= b.shape[0] <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  446</span>                sp_fft.next_fast_len(N) == N <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  447</span>                (b.ndim == 1 <span class="keywordflow">or</span> (b.shape[-1] == 1))):</div>
<div class="line"><span class="lineno">  448</span>            <span class="comment"># if N is fast, 2 * N will be fast, too, so no need to check</span></div>
<div class="line"><span class="lineno">  449</span>            n_fft = N <span class="keywordflow">if</span> whole <span class="keywordflow">else</span> N * 2</div>
<div class="line"><span class="lineno">  450</span>            <span class="keywordflow">if</span> np.isrealobj(b) <span class="keywordflow">and</span> np.isrealobj(a):</div>
<div class="line"><span class="lineno">  451</span>                fft_func = sp_fft.rfft</div>
<div class="line"><span class="lineno">  452</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  453</span>                fft_func = sp_fft.fft</div>
<div class="line"><span class="lineno">  454</span>            h = fft_func(b, n=n_fft, axis=0)[:N]</div>
<div class="line"><span class="lineno">  455</span>            h /= a</div>
<div class="line"><span class="lineno">  456</span>            <span class="keywordflow">if</span> fft_func <span class="keywordflow">is</span> sp_fft.rfft <span class="keywordflow">and</span> whole:</div>
<div class="line"><span class="lineno">  457</span>                <span class="comment"># exclude DC and maybe Nyquist (no need to use axis_reverse</span></div>
<div class="line"><span class="lineno">  458</span>                <span class="comment"># here because we can build reversal with the truncation)</span></div>
<div class="line"><span class="lineno">  459</span>                stop = -1 <span class="keywordflow">if</span> n_fft % 2 == 1 <span class="keywordflow">else</span> -2</div>
<div class="line"><span class="lineno">  460</span>                h_flip = slice(stop, 0, -1)</div>
<div class="line"><span class="lineno">  461</span>                h = np.concatenate((h, h[h_flip].conj()))</div>
<div class="line"><span class="lineno">  462</span>            <span class="keywordflow">if</span> b.ndim &gt; 1:</div>
<div class="line"><span class="lineno">  463</span>                <span class="comment"># Last axis of h has length 1, so drop it.</span></div>
<div class="line"><span class="lineno">  464</span>                h = h[..., 0]</div>
<div class="line"><span class="lineno">  465</span>                <span class="comment"># Move the first axis of h to the end.</span></div>
<div class="line"><span class="lineno">  466</span>                h = np.moveaxis(h, 0, -1)</div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  468</span>        w = atleast_1d(worN)</div>
<div class="line"><span class="lineno">  469</span>        del worN</div>
<div class="line"><span class="lineno">  470</span>        w = 2*pi*w/fs</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>    <span class="keywordflow">if</span> h <span class="keywordflow">is</span> <span class="keywordtype">None</span>:  <span class="comment"># still need to compute using freqs w</span></div>
<div class="line"><span class="lineno">  473</span>        zm1 = exp(-1j * w)</div>
<div class="line"><span class="lineno">  474</span>        h = (npp_polyval(zm1, b, tensor=<span class="keyword">False</span>) /</div>
<div class="line"><span class="lineno">  475</span>             npp_polyval(zm1, a, tensor=<span class="keyword">False</span>))</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    w = w*fs/(2*pi)</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>    <span class="keywordflow">if</span> plot <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  480</span>        plot(w, h)</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    <span class="keywordflow">return</span> w, h</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a054b88d412ab15682d43c45663270868" name="a054b88d412ab15682d43c45663270868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a054b88d412ab15682d43c45663270868">&#9670;&#160;</a></span>freqz_zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.freqz_zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>worN</em> = <code>512</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>whole</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>2*pi</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the frequency response of a digital filter in ZPK form.

Given the Zeros, Poles and Gain of a digital filter, compute its frequency
response:

:math:`H(z)=k \prod_i (z - Z[i]) / \prod_j (z - P[j])`

where :math:`k` is the `gain`, :math:`Z` are the `zeros` and :math:`P` are
the `poles`.

Parameters
----------
z : array_like
Zeroes of a linear filter
p : array_like
Poles of a linear filter
k : scalar
Gain of a linear filter
worN : {None, int, array_like}, optional
If a single integer, then compute at that many frequencies (default is
N=512).

If an array_like, compute the response at the frequencies given.
These are in the same units as `fs`.
whole : bool, optional
Normally, frequencies are computed from 0 to the Nyquist frequency,
fs/2 (upper-half of unit-circle). If `whole` is True, compute
frequencies from 0 to fs. Ignored if w is array_like.
fs : float, optional
The sampling frequency of the digital system. Defaults to 2*pi
radians/sample (so w is from 0 to pi).

.. versionadded:: 1.2.0

Returns
-------
w : ndarray
The frequencies at which `h` was computed, in the same units as `fs`.
By default, `w` is normalized to the range [0, pi) (radians/sample).
h : ndarray
The frequency response, as complex numbers.

See Also
--------
freqs : Compute the frequency response of an analog filter in TF form
freqs_zpk : Compute the frequency response of an analog filter in ZPK form
freqz : Compute the frequency response of a digital filter in TF form

Notes
-----
.. versionadded:: 0.19.0

Examples
--------
Design a 4th-order digital Butterworth filter with cut-off of 100 Hz in a
system with sample rate of 1000 Hz, and plot the frequency response:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; z, p, k = signal.butter(4, 100, output='zpk', fs=1000)
&gt;&gt;&gt; w, h = signal.freqz_zpk(z, p, k, fs=1000)

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig = plt.figure()
&gt;&gt;&gt; ax1 = fig.add_subplot(1, 1, 1)
&gt;&gt;&gt; ax1.set_title('Digital filter frequency response')

&gt;&gt;&gt; ax1.plot(w, 20 * np.log10(abs(h)), 'b')
&gt;&gt;&gt; ax1.set_ylabel('Amplitude [dB]', color='b')
&gt;&gt;&gt; ax1.set_xlabel('Frequency [Hz]')
&gt;&gt;&gt; ax1.grid(True)

&gt;&gt;&gt; ax2 = ax1.twinx()
&gt;&gt;&gt; angles = np.unwrap(np.angle(h))
&gt;&gt;&gt; ax2.plot(w, angles, 'g')
&gt;&gt;&gt; ax2.set_ylabel('Angle [radians]', color='g')

&gt;&gt;&gt; plt.axis('tight')
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  485</span><span class="keyword">def </span>freqz_zpk(z, p, k, worN=512, whole=False, fs=2*pi):</div>
<div class="line"><span class="lineno">  486</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">    Compute the frequency response of a digital filter in ZPK form.</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">    Given the Zeros, Poles and Gain of a digital filter, compute its frequency</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">    response:</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">    :math:`H(z)=k \prod_i (z - Z[i]) / \prod_j (z - P[j])`</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">    where :math:`k` is the `gain`, :math:`Z` are the `zeros` and :math:`P` are</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">    the `poles`.</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">        Zeroes of a linear filter</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">        Poles of a linear filter</span></div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">    k : scalar</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">        Gain of a linear filter</span></div>
<div class="line"><span class="lineno">  505</span><span class="stringliteral">    worN : {None, int, array_like}, optional</span></div>
<div class="line"><span class="lineno">  506</span><span class="stringliteral">        If a single integer, then compute at that many frequencies (default is</span></div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral">        N=512).</span></div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  509</span><span class="stringliteral">        If an array_like, compute the response at the frequencies given.</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">        These are in the same units as `fs`.</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">    whole : bool, optional</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">        Normally, frequencies are computed from 0 to the Nyquist frequency,</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">        fs/2 (upper-half of unit-circle). If `whole` is True, compute</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">        frequencies from 0 to fs. Ignored if w is array_like.</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">        The sampling frequency of the digital system. Defaults to 2*pi</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">        radians/sample (so w is from 0 to pi).</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">    w : ndarray</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">        The frequencies at which `h` was computed, in the same units as `fs`.</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">        By default, `w` is normalized to the range [0, pi) (radians/sample).</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">    h : ndarray</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">        The frequency response, as complex numbers.</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">    freqs : Compute the frequency response of an analog filter in TF form</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">    freqs_zpk : Compute the frequency response of an analog filter in ZPK form</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">    freqz : Compute the frequency response of a digital filter in TF form</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral">    .. versionadded:: 0.19.0</span></div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  540</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  541</span><span class="stringliteral">    Design a 4th-order digital Butterworth filter with cut-off of 100 Hz in a</span></div>
<div class="line"><span class="lineno">  542</span><span class="stringliteral">    system with sample rate of 1000 Hz, and plot the frequency response:</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">    &gt;&gt;&gt; z, p, k = signal.butter(4, 100, output=&#39;zpk&#39;, fs=1000)</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz_zpk(z, p, k, fs=1000)</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">    &gt;&gt;&gt; fig = plt.figure()</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">    &gt;&gt;&gt; ax1 = fig.add_subplot(1, 1, 1)</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_title(&#39;Digital filter frequency response&#39;)</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral">    &gt;&gt;&gt; ax1.plot(w, 20 * np.log10(abs(h)), &#39;b&#39;)</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_ylabel(&#39;Amplitude [dB]&#39;, color=&#39;b&#39;)</span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_xlabel(&#39;Frequency [Hz]&#39;)</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">    &gt;&gt;&gt; ax1.grid(True)</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">    &gt;&gt;&gt; ax2 = ax1.twinx()</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">    &gt;&gt;&gt; angles = np.unwrap(np.angle(h))</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">    &gt;&gt;&gt; ax2.plot(w, angles, &#39;g&#39;)</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_ylabel(&#39;Angle [radians]&#39;, color=&#39;g&#39;)</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">    &gt;&gt;&gt; plt.axis(&#39;tight&#39;)</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  567</span>    z, p = map(atleast_1d, (z, p))</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>    <span class="keywordflow">if</span> whole:</div>
<div class="line"><span class="lineno">  570</span>        lastpoint = 2 * pi</div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  572</span>        lastpoint = pi</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">if</span> worN <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  575</span>        <span class="comment"># For backwards compatibility</span></div>
<div class="line"><span class="lineno">  576</span>        w = numpy.linspace(0, lastpoint, 512, endpoint=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">elif</span> _is_int_type(worN):</div>
<div class="line"><span class="lineno">  578</span>        w = numpy.linspace(0, lastpoint, worN, endpoint=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  579</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  580</span>        w = atleast_1d(worN)</div>
<div class="line"><span class="lineno">  581</span>        w = 2*pi*w/fs</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    zm1 = exp(1j * w)</div>
<div class="line"><span class="lineno">  584</span>    h = k * polyvalfromroots(zm1, z) / polyvalfromroots(zm1, p)</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    w = w*fs/(2*pi)</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    <span class="keywordflow">return</span> w, h</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a95698a45f8565d76ba5a43d77120ac9c" name="a95698a45f8565d76ba5a43d77120ac9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95698a45f8565d76ba5a43d77120ac9c">&#9670;&#160;</a></span>gammatone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.gammatone </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>order</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>numtaps</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Gammatone filter design.

This function computes the coefficients of an FIR or IIR gammatone
digital filter [1]_.

Parameters
----------
freq : float
    Center frequency of the filter (expressed in the same units
    as `fs`).
ftype : {'fir', 'iir'}
    The type of filter the function generates. If 'fir', the function
    will generate an Nth order FIR gammatone filter. If 'iir', the
    function will generate an 8th order digital IIR filter, modeled as
    as 4th order gammatone filter.
order : int, optional
    The order of the filter. Only used when ``ftype='fir'``.
    Default is 4 to model the human auditory system. Must be between
    0 and 24.
numtaps : int, optional
    Length of the filter. Only used when ``ftype='fir'``.
    Default is ``fs*0.015`` if `fs` is greater than 1000,
    15 if `fs` is less than or equal to 1000.
fs : float, optional
    The sampling frequency of the signal. `freq` must be between
    0 and ``fs/2``. Default is 2.

Returns
-------
b, a : ndarray, ndarray
    Numerator (``b``) and denominator (``a``) polynomials of the filter.

Raises
------
ValueError
    If `freq` is less than or equal to 0 or greater than or equal to
    ``fs/2``, if `ftype` is not 'fir' or 'iir', if `order` is less than
    or equal to 0 or greater than 24 when ``ftype='fir'``

See Also
--------
firwin
iirfilter

References
----------
.. [1] Slaney, Malcolm, "An Efficient Implementation of the
    Patterson-Holdsworth Auditory Filter Bank", Apple Computer
    Technical Report 35, 1993, pp.3-8, 34-39.

Examples
--------
16-sample 4th order FIR Gammatone filter centered at 440 Hz

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; signal.gammatone(440, 'fir', numtaps=16, fs=16000)
(array([ 0.00000000e+00,  2.22196719e-07,  1.64942101e-06,  4.99298227e-06,
    1.01993969e-05,  1.63125770e-05,  2.14648940e-05,  2.29947263e-05,
    1.76776931e-05,  2.04980537e-06, -2.72062858e-05, -7.28455299e-05,
   -1.36651076e-04, -2.19066855e-04, -3.18905076e-04, -4.33156712e-04]),
   [1.0])

IIR Gammatone filter centered at 440 Hz

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; b, a = signal.gammatone(440, 'iir', fs=16000)
&gt;&gt;&gt; w, h = signal.freqz(b, a)
&gt;&gt;&gt; plt.plot(w / ((2 * np.pi) / 16000), 20 * np.log10(abs(h)))
&gt;&gt;&gt; plt.xscale('log')
&gt;&gt;&gt; plt.title('Gammatone filter frequency response')
&gt;&gt;&gt; plt.xlabel('Frequency')
&gt;&gt;&gt; plt.ylabel('Amplitude [dB]')
&gt;&gt;&gt; plt.margins(0, 0.1)
&gt;&gt;&gt; plt.grid(which='both', axis='both')
&gt;&gt;&gt; plt.axvline(440, color='green') # cutoff frequency
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 5328</span><span class="keyword">def </span>gammatone(freq, ftype, order=None, numtaps=None, fs=None):</div>
<div class="line"><span class="lineno"> 5329</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5330</span><span class="stringliteral">    Gammatone filter design.</span></div>
<div class="line"><span class="lineno"> 5331</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5332</span><span class="stringliteral">    This function computes the coefficients of an FIR or IIR gammatone</span></div>
<div class="line"><span class="lineno"> 5333</span><span class="stringliteral">    digital filter [1]_.</span></div>
<div class="line"><span class="lineno"> 5334</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5335</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 5336</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 5337</span><span class="stringliteral">    freq : float</span></div>
<div class="line"><span class="lineno"> 5338</span><span class="stringliteral">        Center frequency of the filter (expressed in the same units</span></div>
<div class="line"><span class="lineno"> 5339</span><span class="stringliteral">        as `fs`).</span></div>
<div class="line"><span class="lineno"> 5340</span><span class="stringliteral">    ftype : {&#39;fir&#39;, &#39;iir&#39;}</span></div>
<div class="line"><span class="lineno"> 5341</span><span class="stringliteral">        The type of filter the function generates. If &#39;fir&#39;, the function</span></div>
<div class="line"><span class="lineno"> 5342</span><span class="stringliteral">        will generate an Nth order FIR gammatone filter. If &#39;iir&#39;, the</span></div>
<div class="line"><span class="lineno"> 5343</span><span class="stringliteral">        function will generate an 8th order digital IIR filter, modeled as</span></div>
<div class="line"><span class="lineno"> 5344</span><span class="stringliteral">        as 4th order gammatone filter.</span></div>
<div class="line"><span class="lineno"> 5345</span><span class="stringliteral">    order : int, optional</span></div>
<div class="line"><span class="lineno"> 5346</span><span class="stringliteral">        The order of the filter. Only used when ``ftype=&#39;fir&#39;``.</span></div>
<div class="line"><span class="lineno"> 5347</span><span class="stringliteral">        Default is 4 to model the human auditory system. Must be between</span></div>
<div class="line"><span class="lineno"> 5348</span><span class="stringliteral">        0 and 24.</span></div>
<div class="line"><span class="lineno"> 5349</span><span class="stringliteral">    numtaps : int, optional</span></div>
<div class="line"><span class="lineno"> 5350</span><span class="stringliteral">        Length of the filter. Only used when ``ftype=&#39;fir&#39;``.</span></div>
<div class="line"><span class="lineno"> 5351</span><span class="stringliteral">        Default is ``fs*0.015`` if `fs` is greater than 1000,</span></div>
<div class="line"><span class="lineno"> 5352</span><span class="stringliteral">        15 if `fs` is less than or equal to 1000.</span></div>
<div class="line"><span class="lineno"> 5353</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 5354</span><span class="stringliteral">        The sampling frequency of the signal. `freq` must be between</span></div>
<div class="line"><span class="lineno"> 5355</span><span class="stringliteral">        0 and ``fs/2``. Default is 2.</span></div>
<div class="line"><span class="lineno"> 5356</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5357</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 5358</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 5359</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 5360</span><span class="stringliteral">        Numerator (``b``) and denominator (``a``) polynomials of the filter.</span></div>
<div class="line"><span class="lineno"> 5361</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5362</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno"> 5363</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno"> 5364</span><span class="stringliteral">    ValueError</span></div>
<div class="line"><span class="lineno"> 5365</span><span class="stringliteral">        If `freq` is less than or equal to 0 or greater than or equal to</span></div>
<div class="line"><span class="lineno"> 5366</span><span class="stringliteral">        ``fs/2``, if `ftype` is not &#39;fir&#39; or &#39;iir&#39;, if `order` is less than</span></div>
<div class="line"><span class="lineno"> 5367</span><span class="stringliteral">        or equal to 0 or greater than 24 when ``ftype=&#39;fir&#39;``</span></div>
<div class="line"><span class="lineno"> 5368</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5369</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 5370</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 5371</span><span class="stringliteral">    firwin</span></div>
<div class="line"><span class="lineno"> 5372</span><span class="stringliteral">    iirfilter</span></div>
<div class="line"><span class="lineno"> 5373</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5374</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 5375</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 5376</span><span class="stringliteral">    .. [1] Slaney, Malcolm, &quot;An Efficient Implementation of the</span></div>
<div class="line"><span class="lineno"> 5377</span><span class="stringliteral">        Patterson-Holdsworth Auditory Filter Bank&quot;, Apple Computer</span></div>
<div class="line"><span class="lineno"> 5378</span><span class="stringliteral">        Technical Report 35, 1993, pp.3-8, 34-39.</span></div>
<div class="line"><span class="lineno"> 5379</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5380</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 5381</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 5382</span><span class="stringliteral">    16-sample 4th order FIR Gammatone filter centered at 440 Hz</span></div>
<div class="line"><span class="lineno"> 5383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5384</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 5385</span><span class="stringliteral">    &gt;&gt;&gt; signal.gammatone(440, &#39;fir&#39;, numtaps=16, fs=16000)</span></div>
<div class="line"><span class="lineno"> 5386</span><span class="stringliteral">    (array([ 0.00000000e+00,  2.22196719e-07,  1.64942101e-06,  4.99298227e-06,</span></div>
<div class="line"><span class="lineno"> 5387</span><span class="stringliteral">        1.01993969e-05,  1.63125770e-05,  2.14648940e-05,  2.29947263e-05,</span></div>
<div class="line"><span class="lineno"> 5388</span><span class="stringliteral">        1.76776931e-05,  2.04980537e-06, -2.72062858e-05, -7.28455299e-05,</span></div>
<div class="line"><span class="lineno"> 5389</span><span class="stringliteral">       -1.36651076e-04, -2.19066855e-04, -3.18905076e-04, -4.33156712e-04]),</span></div>
<div class="line"><span class="lineno"> 5390</span><span class="stringliteral">       [1.0])</span></div>
<div class="line"><span class="lineno"> 5391</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5392</span><span class="stringliteral">    IIR Gammatone filter centered at 440 Hz</span></div>
<div class="line"><span class="lineno"> 5393</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5394</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 5395</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 5396</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5397</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.gammatone(440, &#39;iir&#39;, fs=16000)</span></div>
<div class="line"><span class="lineno"> 5398</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz(b, a)</span></div>
<div class="line"><span class="lineno"> 5399</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w / ((2 * np.pi) / 16000), 20 * np.log10(abs(h)))</span></div>
<div class="line"><span class="lineno"> 5400</span><span class="stringliteral">    &gt;&gt;&gt; plt.xscale(&#39;log&#39;)</span></div>
<div class="line"><span class="lineno"> 5401</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Gammatone filter frequency response&#39;)</span></div>
<div class="line"><span class="lineno"> 5402</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency&#39;)</span></div>
<div class="line"><span class="lineno"> 5403</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 5404</span><span class="stringliteral">    &gt;&gt;&gt; plt.margins(0, 0.1)</span></div>
<div class="line"><span class="lineno"> 5405</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 5406</span><span class="stringliteral">    &gt;&gt;&gt; plt.axvline(440, color=&#39;green&#39;) # cutoff frequency</span></div>
<div class="line"><span class="lineno"> 5407</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 5408</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5409</span>    <span class="comment"># Converts freq to float</span></div>
<div class="line"><span class="lineno"> 5410</span>    freq = float(freq)</div>
<div class="line"><span class="lineno"> 5411</span> </div>
<div class="line"><span class="lineno"> 5412</span>    <span class="comment"># Set sampling rate if not passed</span></div>
<div class="line"><span class="lineno"> 5413</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 5414</span>        fs = 2</div>
<div class="line"><span class="lineno"> 5415</span>    fs = float(fs)</div>
<div class="line"><span class="lineno"> 5416</span> </div>
<div class="line"><span class="lineno"> 5417</span>    <span class="comment"># Check for invalid cutoff frequency or filter type</span></div>
<div class="line"><span class="lineno"> 5418</span>    ftype = ftype.lower()</div>
<div class="line"><span class="lineno"> 5419</span>    filter_types = [<span class="stringliteral">&#39;fir&#39;</span>, <span class="stringliteral">&#39;iir&#39;</span>]</div>
<div class="line"><span class="lineno"> 5420</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> 0 &lt; freq &lt; fs / 2:</div>
<div class="line"><span class="lineno"> 5421</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The frequency must be between 0 and {}&quot;</span></div>
<div class="line"><span class="lineno"> 5422</span>                         <span class="stringliteral">&quot; (nyquist), but given {}.&quot;</span>.format(fs / 2, freq))</div>
<div class="line"><span class="lineno"> 5423</span>    <span class="keywordflow">if</span> ftype <span class="keywordflow">not</span> <span class="keywordflow">in</span> filter_types:</div>
<div class="line"><span class="lineno"> 5424</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;ftype must be either fir or iir.&#39;</span>)</div>
<div class="line"><span class="lineno"> 5425</span> </div>
<div class="line"><span class="lineno"> 5426</span>    <span class="comment"># Calculate FIR gammatone filter</span></div>
<div class="line"><span class="lineno"> 5427</span>    <span class="keywordflow">if</span> ftype == <span class="stringliteral">&#39;fir&#39;</span>:</div>
<div class="line"><span class="lineno"> 5428</span>        <span class="comment"># Set order and numtaps if not passed</span></div>
<div class="line"><span class="lineno"> 5429</span>        <span class="keywordflow">if</span> order <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 5430</span>            order = 4</div>
<div class="line"><span class="lineno"> 5431</span>        order = operator.index(order)</div>
<div class="line"><span class="lineno"> 5432</span> </div>
<div class="line"><span class="lineno"> 5433</span>        <span class="keywordflow">if</span> numtaps <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 5434</span>            numtaps = max(int(fs * 0.015), 15)</div>
<div class="line"><span class="lineno"> 5435</span>        numtaps = operator.index(numtaps)</div>
<div class="line"><span class="lineno"> 5436</span> </div>
<div class="line"><span class="lineno"> 5437</span>        <span class="comment"># Check for invalid order</span></div>
<div class="line"><span class="lineno"> 5438</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> 0 &lt; order &lt;= 24:</div>
<div class="line"><span class="lineno"> 5439</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Invalid order: order must be &gt; 0 and &lt;= 24.&quot;</span>)</div>
<div class="line"><span class="lineno"> 5440</span> </div>
<div class="line"><span class="lineno"> 5441</span>        <span class="comment"># Gammatone impulse response settings</span></div>
<div class="line"><span class="lineno"> 5442</span>        t = np.arange(numtaps) / fs</div>
<div class="line"><span class="lineno"> 5443</span>        bw = 1.019 * _hz_to_erb(freq)</div>
<div class="line"><span class="lineno"> 5444</span> </div>
<div class="line"><span class="lineno"> 5445</span>        <span class="comment"># Calculate the FIR gammatone filter</span></div>
<div class="line"><span class="lineno"> 5446</span>        b = (t ** (order - 1)) * np.exp(-2 * np.pi * bw * t)</div>
<div class="line"><span class="lineno"> 5447</span>        b *= np.cos(2 * np.pi * freq * t)</div>
<div class="line"><span class="lineno"> 5448</span> </div>
<div class="line"><span class="lineno"> 5449</span>        <span class="comment"># Scale the FIR filter so the frequency response is 1 at cutoff</span></div>
<div class="line"><span class="lineno"> 5450</span>        scale_factor = 2 * (2 * np.pi * bw) ** (order)</div>
<div class="line"><span class="lineno"> 5451</span>        scale_factor /= float_factorial(order - 1)</div>
<div class="line"><span class="lineno"> 5452</span>        scale_factor /= fs</div>
<div class="line"><span class="lineno"> 5453</span>        b *= scale_factor</div>
<div class="line"><span class="lineno"> 5454</span>        a = [1.0]</div>
<div class="line"><span class="lineno"> 5455</span> </div>
<div class="line"><span class="lineno"> 5456</span>    <span class="comment"># Calculate IIR gammatone filter</span></div>
<div class="line"><span class="lineno"> 5457</span>    <span class="keywordflow">elif</span> ftype == <span class="stringliteral">&#39;iir&#39;</span>:</div>
<div class="line"><span class="lineno"> 5458</span>        <span class="comment"># Raise warning if order and/or numtaps is passed</span></div>
<div class="line"><span class="lineno"> 5459</span>        <span class="keywordflow">if</span> order <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 5460</span>            warnings.warn(<span class="stringliteral">&#39;order is not used for IIR gammatone filter.&#39;</span>)</div>
<div class="line"><span class="lineno"> 5461</span>        <span class="keywordflow">if</span> numtaps <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 5462</span>            warnings.warn(<span class="stringliteral">&#39;numtaps is not used for IIR gammatone filter.&#39;</span>)</div>
<div class="line"><span class="lineno"> 5463</span> </div>
<div class="line"><span class="lineno"> 5464</span>        <span class="comment"># Gammatone impulse response settings</span></div>
<div class="line"><span class="lineno"> 5465</span>        T = 1./fs</div>
<div class="line"><span class="lineno"> 5466</span>        bw = 2 * np.pi * 1.019 * _hz_to_erb(freq)</div>
<div class="line"><span class="lineno"> 5467</span>        fr = 2 * freq * np.pi * T</div>
<div class="line"><span class="lineno"> 5468</span>        bwT = bw * T</div>
<div class="line"><span class="lineno"> 5469</span> </div>
<div class="line"><span class="lineno"> 5470</span>        <span class="comment"># Calculate the gain to normalize the volume at the center frequency</span></div>
<div class="line"><span class="lineno"> 5471</span>        g1 = -2 * np.exp(2j * fr) * T</div>
<div class="line"><span class="lineno"> 5472</span>        g2 = 2 * np.exp(-(bwT) + 1j * fr) * T</div>
<div class="line"><span class="lineno"> 5473</span>        g3 = np.sqrt(3 + 2 ** (3 / 2)) * np.sin(fr)</div>
<div class="line"><span class="lineno"> 5474</span>        g4 = np.sqrt(3 - 2 ** (3 / 2)) * np.sin(fr)</div>
<div class="line"><span class="lineno"> 5475</span>        g5 = np.exp(2j * fr)</div>
<div class="line"><span class="lineno"> 5476</span> </div>
<div class="line"><span class="lineno"> 5477</span>        g = g1 + g2 * (np.cos(fr) - g4)</div>
<div class="line"><span class="lineno"> 5478</span>        g *= (g1 + g2 * (np.cos(fr) + g4))</div>
<div class="line"><span class="lineno"> 5479</span>        g *= (g1 + g2 * (np.cos(fr) - g3))</div>
<div class="line"><span class="lineno"> 5480</span>        g *= (g1 + g2 * (np.cos(fr) + g3))</div>
<div class="line"><span class="lineno"> 5481</span>        g /= ((-2 / np.exp(2 * bwT) - 2 * g5 + 2 * (1 + g5) / np.exp(bwT)) ** 4)</div>
<div class="line"><span class="lineno"> 5482</span>        g = np.abs(g)</div>
<div class="line"><span class="lineno"> 5483</span> </div>
<div class="line"><span class="lineno"> 5484</span>        <span class="comment"># Create empty filter coefficient lists</span></div>
<div class="line"><span class="lineno"> 5485</span>        b = np.empty(5)</div>
<div class="line"><span class="lineno"> 5486</span>        a = np.empty(9)</div>
<div class="line"><span class="lineno"> 5487</span> </div>
<div class="line"><span class="lineno"> 5488</span>        <span class="comment"># Calculate the numerator coefficients</span></div>
<div class="line"><span class="lineno"> 5489</span>        b[0] = (T ** 4) / g</div>
<div class="line"><span class="lineno"> 5490</span>        b[1] = -4 * T ** 4 * np.cos(fr) / np.exp(bw * T) / g</div>
<div class="line"><span class="lineno"> 5491</span>        b[2] = 6 * T ** 4 * np.cos(2 * fr) / np.exp(2 * bw * T) / g</div>
<div class="line"><span class="lineno"> 5492</span>        b[3] = -4 * T ** 4 * np.cos(3 * fr) / np.exp(3 * bw * T) / g</div>
<div class="line"><span class="lineno"> 5493</span>        b[4] = T ** 4 * np.cos(4 * fr) / np.exp(4 * bw * T) / g</div>
<div class="line"><span class="lineno"> 5494</span> </div>
<div class="line"><span class="lineno"> 5495</span>        <span class="comment"># Calculate the denominator coefficients</span></div>
<div class="line"><span class="lineno"> 5496</span>        a[0] = 1</div>
<div class="line"><span class="lineno"> 5497</span>        a[1] = -8 * np.cos(fr) / np.exp(bw * T)</div>
<div class="line"><span class="lineno"> 5498</span>        a[2] = 4 * (4 + 3 * np.cos(2 * fr)) / np.exp(2 * bw * T)</div>
<div class="line"><span class="lineno"> 5499</span>        a[3] = -8 * (6 * np.cos(fr) + np.cos(3 * fr))</div>
<div class="line"><span class="lineno"> 5500</span>        a[3] /= np.exp(3 * bw * T)</div>
<div class="line"><span class="lineno"> 5501</span>        a[4] = 2 * (18 + 16 * np.cos(2 * fr) + np.cos(4 * fr))</div>
<div class="line"><span class="lineno"> 5502</span>        a[4] /= np.exp(4 * bw * T)</div>
<div class="line"><span class="lineno"> 5503</span>        a[5] = -8 * (6 * np.cos(fr) + np.cos(3 * fr))</div>
<div class="line"><span class="lineno"> 5504</span>        a[5] /= np.exp(5 * bw * T)</div>
<div class="line"><span class="lineno"> 5505</span>        a[6] = 4 * (4 + 3 * np.cos(2 * fr)) / np.exp(6 * bw * T)</div>
<div class="line"><span class="lineno"> 5506</span>        a[7] = -8 * np.cos(fr) / np.exp(7 * bw * T)</div>
<div class="line"><span class="lineno"> 5507</span>        a[8] = np.exp(-8 * bw * T)</div>
<div class="line"><span class="lineno"> 5508</span> </div>
<div class="line"><span class="lineno"> 5509</span>    <span class="keywordflow">return</span> b, a</div>
<div class="line"><span class="lineno"> 5510</span> </div>
<div class="line"><span class="lineno"> 5511</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a625d835512a209cd19d7dafe141ef33a" name="a625d835512a209cd19d7dafe141ef33a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a625d835512a209cd19d7dafe141ef33a">&#9670;&#160;</a></span>group_delay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.group_delay </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w</em> = <code>512</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>whole</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>2*pi</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the group delay of a digital filter.

The group delay measures by how many samples amplitude envelopes of
various spectral components of a signal are delayed by a filter.
It is formally defined as the derivative of continuous (unwrapped) phase::

       d        jw
D(w) = - -- arg H(e)
      dw

Parameters
----------
system : tuple of array_like (b, a)
Numerator and denominator coefficients of a filter transfer function.
w : {None, int, array_like}, optional
If a single integer, then compute at that many frequencies (default is
N=512).

If an array_like, compute the delay at the frequencies given. These
are in the same units as `fs`.
whole : bool, optional
Normally, frequencies are computed from 0 to the Nyquist frequency,
fs/2 (upper-half of unit-circle). If `whole` is True, compute
frequencies from 0 to fs. Ignored if w is array_like.
fs : float, optional
The sampling frequency of the digital system. Defaults to 2*pi
radians/sample (so w is from 0 to pi).

.. versionadded:: 1.2.0

Returns
-------
w : ndarray
The frequencies at which group delay was computed, in the same units
as `fs`.  By default, `w` is normalized to the range [0, pi)
(radians/sample).
gd : ndarray
The group delay.

Notes
-----
The similar function in MATLAB is called `grpdelay`.

If the transfer function :math:`H(z)` has zeros or poles on the unit
circle, the group delay at corresponding frequencies is undefined.
When such a case arises the warning is raised and the group delay
is set to 0 at those frequencies.

For the details of numerical computation of the group delay refer to [1]_.

.. versionadded:: 0.16.0

See Also
--------
freqz : Frequency response of a digital filter

References
----------
.. [1] Richard G. Lyons, "Understanding Digital Signal Processing,
   3rd edition", p. 830.

Examples
--------
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; b, a = signal.iirdesign(0.1, 0.3, 5, 50, ftype='cheby1')
&gt;&gt;&gt; w, gd = signal.group_delay((b, a))

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; plt.title('Digital filter group delay')
&gt;&gt;&gt; plt.plot(w, gd)
&gt;&gt;&gt; plt.ylabel('Group delay [samples]')
&gt;&gt;&gt; plt.xlabel('Frequency [rad/sample]')
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  591</span><span class="keyword">def </span>group_delay(system, w=512, whole=False, fs=2*pi):</div>
<div class="line"><span class="lineno">  592</span>    <span class="stringliteral">r&quot;&quot;&quot;Compute the group delay of a digital filter.</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">    The group delay measures by how many samples amplitude envelopes of</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">    various spectral components of a signal are delayed by a filter.</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral">    It is formally defined as the derivative of continuous (unwrapped) phase::</span></div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">               d        jw</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">     D(w) = - -- arg H(e)</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral">              dw</span></div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">    system : tuple of array_like (b, a)</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">        Numerator and denominator coefficients of a filter transfer function.</span></div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral">    w : {None, int, array_like}, optional</span></div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">        If a single integer, then compute at that many frequencies (default is</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">        N=512).</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral">        If an array_like, compute the delay at the frequencies given. These</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">        are in the same units as `fs`.</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral">    whole : bool, optional</span></div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">        Normally, frequencies are computed from 0 to the Nyquist frequency,</span></div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral">        fs/2 (upper-half of unit-circle). If `whole` is True, compute</span></div>
<div class="line"><span class="lineno">  615</span><span class="stringliteral">        frequencies from 0 to fs. Ignored if w is array_like.</span></div>
<div class="line"><span class="lineno">  616</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno">  617</span><span class="stringliteral">        The sampling frequency of the digital system. Defaults to 2*pi</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">        radians/sample (so w is from 0 to pi).</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral">    w : ndarray</span></div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">        The frequencies at which group delay was computed, in the same units</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">        as `fs`.  By default, `w` is normalized to the range [0, pi)</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">        (radians/sample).</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">    gd : ndarray</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral">        The group delay.</span></div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  633</span><span class="stringliteral">    The similar function in MATLAB is called `grpdelay`.</span></div>
<div class="line"><span class="lineno">  634</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  635</span><span class="stringliteral">    If the transfer function :math:`H(z)` has zeros or poles on the unit</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral">    circle, the group delay at corresponding frequencies is undefined.</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">    When such a case arises the warning is raised and the group delay</span></div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral">    is set to 0 at those frequencies.</span></div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">    For the details of numerical computation of the group delay refer to [1]_.</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">    .. versionadded:: 0.16.0</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">    freqz : Frequency response of a digital filter</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral">    .. [1] Richard G. Lyons, &quot;Understanding Digital Signal Processing,</span></div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">           3rd edition&quot;, p. 830.</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.iirdesign(0.1, 0.3, 5, 50, ftype=&#39;cheby1&#39;)</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">    &gt;&gt;&gt; w, gd = signal.group_delay((b, a))</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Digital filter group delay&#39;)</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, gd)</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Group delay [samples]&#39;)</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [rad/sample]&#39;)</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">if</span> w <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  668</span>        <span class="comment"># For backwards compatibility</span></div>
<div class="line"><span class="lineno">  669</span>        w = 512</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">if</span> _is_int_type(w):</div>
<div class="line"><span class="lineno">  672</span>        <span class="keywordflow">if</span> whole:</div>
<div class="line"><span class="lineno">  673</span>            w = np.linspace(0, 2 * pi, w, endpoint=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  674</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  675</span>            w = np.linspace(0, pi, w, endpoint=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  676</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  677</span>        w = np.atleast_1d(w)</div>
<div class="line"><span class="lineno">  678</span>        w = 2*pi*w/fs</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>    b, a = map(np.atleast_1d, system)</div>
<div class="line"><span class="lineno">  681</span>    c = np.convolve(b, a[::-1])</div>
<div class="line"><span class="lineno">  682</span>    cr = c * np.arange(c.size)</div>
<div class="line"><span class="lineno">  683</span>    z = np.exp(-1j * w)</div>
<div class="line"><span class="lineno">  684</span>    num = np.polyval(cr[::-1], z)</div>
<div class="line"><span class="lineno">  685</span>    den = np.polyval(c[::-1], z)</div>
<div class="line"><span class="lineno">  686</span>    gd = np.real(num / den) - a.size + 1</div>
<div class="line"><span class="lineno">  687</span>    singular = ~np.isfinite(gd)</div>
<div class="line"><span class="lineno">  688</span>    near_singular = np.absolute(den) &lt; 10 * EPSILON</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>    <span class="keywordflow">if</span> np.any(singular):</div>
<div class="line"><span class="lineno">  691</span>        gd[singular] = 0</div>
<div class="line"><span class="lineno">  692</span>        warnings.warn(</div>
<div class="line"><span class="lineno">  693</span>            <span class="stringliteral">&quot;The group delay is singular at frequencies [{0}], setting to 0&quot;</span>.</div>
<div class="line"><span class="lineno">  694</span>            format(<span class="stringliteral">&quot;, &quot;</span>.join(<span class="stringliteral">&quot;{0:.3f}&quot;</span>.format(ws) <span class="keywordflow">for</span> ws <span class="keywordflow">in</span> w[singular])),</div>
<div class="line"><span class="lineno">  695</span>            stacklevel=2</div>
<div class="line"><span class="lineno">  696</span>        )</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>    <span class="keywordflow">elif</span> np.any(near_singular):</div>
<div class="line"><span class="lineno">  699</span>        warnings.warn(</div>
<div class="line"><span class="lineno">  700</span>            <span class="stringliteral">&quot;The filter&#39;s denominator is extremely small at frequencies [{0}], \</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">            around which a singularity may be present&quot;</span>.</div>
<div class="line"><span class="lineno">  702</span>            format(<span class="stringliteral">&quot;, &quot;</span>.join(<span class="stringliteral">&quot;{0:.3f}&quot;</span>.format(ws) <span class="keywordflow">for</span> ws <span class="keywordflow">in</span> w[near_singular])),</div>
<div class="line"><span class="lineno">  703</span>            stacklevel=2</div>
<div class="line"><span class="lineno">  704</span>        )</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>    w = w*fs/(2*pi)</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>    <span class="keywordflow">return</span> w, gd</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abc3e3e67171ad300aefe7d122abd9e96" name="abc3e3e67171ad300aefe7d122abd9e96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc3e3e67171ad300aefe7d122abd9e96">&#9670;&#160;</a></span>iircomb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.iircomb </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftype</em> = <code>'notch'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>2.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>pass_zero</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Design IIR notching or peaking digital comb filter.

A notching comb filter consists of regularly-spaced band-stop filters with
a narrow bandwidth (high quality factor). Each rejects a narrow frequency
band and leaves the rest of the spectrum little changed.

A peaking comb filter consists of regularly-spaced band-pass filters with
a narrow bandwidth (high quality factor). Each rejects components outside
a narrow frequency band.

Parameters
----------
w0 : float
    The fundamental frequency of the comb filter (the spacing between its
    peaks). This must evenly divide the sampling frequency. If `fs` is
    specified, this is in the same units as `fs`. By default, it is
    a normalized scalar that must satisfy  ``0 &lt; w0 &lt; 1``, with
    ``w0 = 1`` corresponding to half of the sampling frequency.
Q : float
    Quality factor. Dimensionless parameter that characterizes
    notch filter -3 dB bandwidth ``bw`` relative to its center
    frequency, ``Q = w0/bw``.
ftype : {'notch', 'peak'}
    The type of comb filter generated by the function. If 'notch', then
    the Q factor applies to the notches. If 'peak', then the Q factor
    applies to the peaks.  Default is 'notch'.
fs : float, optional
    The sampling frequency of the signal. Default is 2.0.
pass_zero : bool, optional
    If False (default), the notches (nulls) of the filter are centered on
    frequencies [0, w0, 2*w0, ...], and the peaks are centered on the
    midpoints [w0/2, 3*w0/2, 5*w0/2, ...].  If True, the peaks are centered
    on [0, w0, 2*w0, ...] (passing zero frequency) and vice versa.

    .. versionadded:: 1.9.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (``b``) and denominator (``a``) polynomials
    of the IIR filter.

Raises
------
ValueError
    If `w0` is less than or equal to 0 or greater than or equal to
    ``fs/2``, if `fs` is not divisible by `w0`, if `ftype`
    is not 'notch' or 'peak'

See Also
--------
iirnotch
iirpeak

Notes
-----
For implementation details, see [1]_. The TF implementation of the
comb filter is numerically stable even at higher orders due to the
use of a single repeated pole, which won't suffer from precision loss.

References
----------
.. [1] Sophocles J. Orfanidis, "Introduction To Signal Processing",
       Prentice-Hall, 1996, ch. 11, "Digital Filter Design"

Examples
--------
Design and plot notching comb filter at 20 Hz for a
signal sampled at 200 Hz, using quality factor Q = 30

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; fs = 200.0  # Sample frequency (Hz)
&gt;&gt;&gt; f0 = 20.0  # Frequency to be removed from signal (Hz)
&gt;&gt;&gt; Q = 30.0  # Quality factor
&gt;&gt;&gt; # Design notching comb filter
&gt;&gt;&gt; b, a = signal.iircomb(f0, Q, ftype='notch', fs=fs)

&gt;&gt;&gt; # Frequency response
&gt;&gt;&gt; freq, h = signal.freqz(b, a, fs=fs)
&gt;&gt;&gt; response = abs(h)
&gt;&gt;&gt; # To avoid divide by zero when graphing
&gt;&gt;&gt; response[response == 0] = 1e-20
&gt;&gt;&gt; # Plot
&gt;&gt;&gt; fig, ax = plt.subplots(2, 1, figsize=(8, 6), sharex=True)
&gt;&gt;&gt; ax[0].plot(freq, 20*np.log10(abs(response)), color='blue')
&gt;&gt;&gt; ax[0].set_title("Frequency Response")
&gt;&gt;&gt; ax[0].set_ylabel("Amplitude (dB)", color='blue')
&gt;&gt;&gt; ax[0].set_xlim([0, 100])
&gt;&gt;&gt; ax[0].set_ylim([-30, 10])
&gt;&gt;&gt; ax[0].grid(True)
&gt;&gt;&gt; ax[1].plot(freq, (np.angle(h)*180/np.pi+180)%360 - 180, color='green')
&gt;&gt;&gt; ax[1].set_ylabel("Angle (degrees)", color='green')
&gt;&gt;&gt; ax[1].set_xlabel("Frequency (Hz)")
&gt;&gt;&gt; ax[1].set_xlim([0, 100])
&gt;&gt;&gt; ax[1].set_yticks([-90, -60, -30, 0, 30, 60, 90])
&gt;&gt;&gt; ax[1].set_ylim([-90, 90])
&gt;&gt;&gt; ax[1].grid(True)
&gt;&gt;&gt; plt.show()

Design and plot peaking comb filter at 250 Hz for a
signal sampled at 1000 Hz, using quality factor Q = 30

&gt;&gt;&gt; fs = 1000.0  # Sample frequency (Hz)
&gt;&gt;&gt; f0 = 250.0  # Frequency to be retained (Hz)
&gt;&gt;&gt; Q = 30.0  # Quality factor
&gt;&gt;&gt; # Design peaking filter
&gt;&gt;&gt; b, a = signal.iircomb(f0, Q, ftype='peak', fs=fs, pass_zero=True)

&gt;&gt;&gt; # Frequency response
&gt;&gt;&gt; freq, h = signal.freqz(b, a, fs=fs)
&gt;&gt;&gt; response = abs(h)
&gt;&gt;&gt; # To avoid divide by zero when graphing
&gt;&gt;&gt; response[response == 0] = 1e-20
&gt;&gt;&gt; # Plot
&gt;&gt;&gt; fig, ax = plt.subplots(2, 1, figsize=(8, 6), sharex=True)
&gt;&gt;&gt; ax[0].plot(freq, 20*np.log10(np.maximum(abs(h), 1e-5)), color='blue')
&gt;&gt;&gt; ax[0].set_title("Frequency Response")
&gt;&gt;&gt; ax[0].set_ylabel("Amplitude (dB)", color='blue')
&gt;&gt;&gt; ax[0].set_xlim([0, 500])
&gt;&gt;&gt; ax[0].set_ylim([-80, 10])
&gt;&gt;&gt; ax[0].grid(True)
&gt;&gt;&gt; ax[1].plot(freq, (np.angle(h)*180/np.pi+180)%360 - 180, color='green')
&gt;&gt;&gt; ax[1].set_ylabel("Angle (degrees)", color='green')
&gt;&gt;&gt; ax[1].set_xlabel("Frequency (Hz)")
&gt;&gt;&gt; ax[1].set_xlim([0, 500])
&gt;&gt;&gt; ax[1].set_yticks([-90, -60, -30, 0, 30, 60, 90])
&gt;&gt;&gt; ax[1].set_ylim([-90, 90])
&gt;&gt;&gt; ax[1].grid(True)
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 5110</span><span class="keyword">def </span>iircomb(w0, Q, ftype=&#39;notch&#39;, fs=2.0, *, pass_zero=False):</div>
<div class="line"><span class="lineno"> 5111</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5112</span><span class="stringliteral">    Design IIR notching or peaking digital comb filter.</span></div>
<div class="line"><span class="lineno"> 5113</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5114</span><span class="stringliteral">    A notching comb filter consists of regularly-spaced band-stop filters with</span></div>
<div class="line"><span class="lineno"> 5115</span><span class="stringliteral">    a narrow bandwidth (high quality factor). Each rejects a narrow frequency</span></div>
<div class="line"><span class="lineno"> 5116</span><span class="stringliteral">    band and leaves the rest of the spectrum little changed.</span></div>
<div class="line"><span class="lineno"> 5117</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5118</span><span class="stringliteral">    A peaking comb filter consists of regularly-spaced band-pass filters with</span></div>
<div class="line"><span class="lineno"> 5119</span><span class="stringliteral">    a narrow bandwidth (high quality factor). Each rejects components outside</span></div>
<div class="line"><span class="lineno"> 5120</span><span class="stringliteral">    a narrow frequency band.</span></div>
<div class="line"><span class="lineno"> 5121</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5122</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 5123</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 5124</span><span class="stringliteral">    w0 : float</span></div>
<div class="line"><span class="lineno"> 5125</span><span class="stringliteral">        The fundamental frequency of the comb filter (the spacing between its</span></div>
<div class="line"><span class="lineno"> 5126</span><span class="stringliteral">        peaks). This must evenly divide the sampling frequency. If `fs` is</span></div>
<div class="line"><span class="lineno"> 5127</span><span class="stringliteral">        specified, this is in the same units as `fs`. By default, it is</span></div>
<div class="line"><span class="lineno"> 5128</span><span class="stringliteral">        a normalized scalar that must satisfy  ``0 &lt; w0 &lt; 1``, with</span></div>
<div class="line"><span class="lineno"> 5129</span><span class="stringliteral">        ``w0 = 1`` corresponding to half of the sampling frequency.</span></div>
<div class="line"><span class="lineno"> 5130</span><span class="stringliteral">    Q : float</span></div>
<div class="line"><span class="lineno"> 5131</span><span class="stringliteral">        Quality factor. Dimensionless parameter that characterizes</span></div>
<div class="line"><span class="lineno"> 5132</span><span class="stringliteral">        notch filter -3 dB bandwidth ``bw`` relative to its center</span></div>
<div class="line"><span class="lineno"> 5133</span><span class="stringliteral">        frequency, ``Q = w0/bw``.</span></div>
<div class="line"><span class="lineno"> 5134</span><span class="stringliteral">    ftype : {&#39;notch&#39;, &#39;peak&#39;}</span></div>
<div class="line"><span class="lineno"> 5135</span><span class="stringliteral">        The type of comb filter generated by the function. If &#39;notch&#39;, then</span></div>
<div class="line"><span class="lineno"> 5136</span><span class="stringliteral">        the Q factor applies to the notches. If &#39;peak&#39;, then the Q factor</span></div>
<div class="line"><span class="lineno"> 5137</span><span class="stringliteral">        applies to the peaks.  Default is &#39;notch&#39;.</span></div>
<div class="line"><span class="lineno"> 5138</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 5139</span><span class="stringliteral">        The sampling frequency of the signal. Default is 2.0.</span></div>
<div class="line"><span class="lineno"> 5140</span><span class="stringliteral">    pass_zero : bool, optional</span></div>
<div class="line"><span class="lineno"> 5141</span><span class="stringliteral">        If False (default), the notches (nulls) of the filter are centered on</span></div>
<div class="line"><span class="lineno"> 5142</span><span class="stringliteral">        frequencies [0, w0, 2*w0, ...], and the peaks are centered on the</span></div>
<div class="line"><span class="lineno"> 5143</span><span class="stringliteral">        midpoints [w0/2, 3*w0/2, 5*w0/2, ...].  If True, the peaks are centered</span></div>
<div class="line"><span class="lineno"> 5144</span><span class="stringliteral">        on [0, w0, 2*w0, ...] (passing zero frequency) and vice versa.</span></div>
<div class="line"><span class="lineno"> 5145</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5146</span><span class="stringliteral">        .. versionadded:: 1.9.0</span></div>
<div class="line"><span class="lineno"> 5147</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5148</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 5149</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 5150</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 5151</span><span class="stringliteral">        Numerator (``b``) and denominator (``a``) polynomials</span></div>
<div class="line"><span class="lineno"> 5152</span><span class="stringliteral">        of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 5153</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5154</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno"> 5155</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno"> 5156</span><span class="stringliteral">    ValueError</span></div>
<div class="line"><span class="lineno"> 5157</span><span class="stringliteral">        If `w0` is less than or equal to 0 or greater than or equal to</span></div>
<div class="line"><span class="lineno"> 5158</span><span class="stringliteral">        ``fs/2``, if `fs` is not divisible by `w0`, if `ftype`</span></div>
<div class="line"><span class="lineno"> 5159</span><span class="stringliteral">        is not &#39;notch&#39; or &#39;peak&#39;</span></div>
<div class="line"><span class="lineno"> 5160</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5161</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 5162</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 5163</span><span class="stringliteral">    iirnotch</span></div>
<div class="line"><span class="lineno"> 5164</span><span class="stringliteral">    iirpeak</span></div>
<div class="line"><span class="lineno"> 5165</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5166</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 5167</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 5168</span><span class="stringliteral">    For implementation details, see [1]_. The TF implementation of the</span></div>
<div class="line"><span class="lineno"> 5169</span><span class="stringliteral">    comb filter is numerically stable even at higher orders due to the</span></div>
<div class="line"><span class="lineno"> 5170</span><span class="stringliteral">    use of a single repeated pole, which won&#39;t suffer from precision loss.</span></div>
<div class="line"><span class="lineno"> 5171</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5172</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 5173</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 5174</span><span class="stringliteral">    .. [1] Sophocles J. Orfanidis, &quot;Introduction To Signal Processing&quot;,</span></div>
<div class="line"><span class="lineno"> 5175</span><span class="stringliteral">           Prentice-Hall, 1996, ch. 11, &quot;Digital Filter Design&quot;</span></div>
<div class="line"><span class="lineno"> 5176</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5177</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 5178</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 5179</span><span class="stringliteral">    Design and plot notching comb filter at 20 Hz for a</span></div>
<div class="line"><span class="lineno"> 5180</span><span class="stringliteral">    signal sampled at 200 Hz, using quality factor Q = 30</span></div>
<div class="line"><span class="lineno"> 5181</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5182</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 5183</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 5184</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5185</span><span class="stringliteral">    &gt;&gt;&gt; fs = 200.0  # Sample frequency (Hz)</span></div>
<div class="line"><span class="lineno"> 5186</span><span class="stringliteral">    &gt;&gt;&gt; f0 = 20.0  # Frequency to be removed from signal (Hz)</span></div>
<div class="line"><span class="lineno"> 5187</span><span class="stringliteral">    &gt;&gt;&gt; Q = 30.0  # Quality factor</span></div>
<div class="line"><span class="lineno"> 5188</span><span class="stringliteral">    &gt;&gt;&gt; # Design notching comb filter</span></div>
<div class="line"><span class="lineno"> 5189</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.iircomb(f0, Q, ftype=&#39;notch&#39;, fs=fs)</span></div>
<div class="line"><span class="lineno"> 5190</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5191</span><span class="stringliteral">    &gt;&gt;&gt; # Frequency response</span></div>
<div class="line"><span class="lineno"> 5192</span><span class="stringliteral">    &gt;&gt;&gt; freq, h = signal.freqz(b, a, fs=fs)</span></div>
<div class="line"><span class="lineno"> 5193</span><span class="stringliteral">    &gt;&gt;&gt; response = abs(h)</span></div>
<div class="line"><span class="lineno"> 5194</span><span class="stringliteral">    &gt;&gt;&gt; # To avoid divide by zero when graphing</span></div>
<div class="line"><span class="lineno"> 5195</span><span class="stringliteral">    &gt;&gt;&gt; response[response == 0] = 1e-20</span></div>
<div class="line"><span class="lineno"> 5196</span><span class="stringliteral">    &gt;&gt;&gt; # Plot</span></div>
<div class="line"><span class="lineno"> 5197</span><span class="stringliteral">    &gt;&gt;&gt; fig, ax = plt.subplots(2, 1, figsize=(8, 6), sharex=True)</span></div>
<div class="line"><span class="lineno"> 5198</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].plot(freq, 20*np.log10(abs(response)), color=&#39;blue&#39;)</span></div>
<div class="line"><span class="lineno"> 5199</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_title(&quot;Frequency Response&quot;)</span></div>
<div class="line"><span class="lineno"> 5200</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_ylabel(&quot;Amplitude (dB)&quot;, color=&#39;blue&#39;)</span></div>
<div class="line"><span class="lineno"> 5201</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_xlim([0, 100])</span></div>
<div class="line"><span class="lineno"> 5202</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_ylim([-30, 10])</span></div>
<div class="line"><span class="lineno"> 5203</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].grid(True)</span></div>
<div class="line"><span class="lineno"> 5204</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].plot(freq, (np.angle(h)*180/np.pi+180)%360 - 180, color=&#39;green&#39;)</span></div>
<div class="line"><span class="lineno"> 5205</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_ylabel(&quot;Angle (degrees)&quot;, color=&#39;green&#39;)</span></div>
<div class="line"><span class="lineno"> 5206</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_xlabel(&quot;Frequency (Hz)&quot;)</span></div>
<div class="line"><span class="lineno"> 5207</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_xlim([0, 100])</span></div>
<div class="line"><span class="lineno"> 5208</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_yticks([-90, -60, -30, 0, 30, 60, 90])</span></div>
<div class="line"><span class="lineno"> 5209</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_ylim([-90, 90])</span></div>
<div class="line"><span class="lineno"> 5210</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].grid(True)</span></div>
<div class="line"><span class="lineno"> 5211</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 5212</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5213</span><span class="stringliteral">    Design and plot peaking comb filter at 250 Hz for a</span></div>
<div class="line"><span class="lineno"> 5214</span><span class="stringliteral">    signal sampled at 1000 Hz, using quality factor Q = 30</span></div>
<div class="line"><span class="lineno"> 5215</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5216</span><span class="stringliteral">    &gt;&gt;&gt; fs = 1000.0  # Sample frequency (Hz)</span></div>
<div class="line"><span class="lineno"> 5217</span><span class="stringliteral">    &gt;&gt;&gt; f0 = 250.0  # Frequency to be retained (Hz)</span></div>
<div class="line"><span class="lineno"> 5218</span><span class="stringliteral">    &gt;&gt;&gt; Q = 30.0  # Quality factor</span></div>
<div class="line"><span class="lineno"> 5219</span><span class="stringliteral">    &gt;&gt;&gt; # Design peaking filter</span></div>
<div class="line"><span class="lineno"> 5220</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.iircomb(f0, Q, ftype=&#39;peak&#39;, fs=fs, pass_zero=True)</span></div>
<div class="line"><span class="lineno"> 5221</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5222</span><span class="stringliteral">    &gt;&gt;&gt; # Frequency response</span></div>
<div class="line"><span class="lineno"> 5223</span><span class="stringliteral">    &gt;&gt;&gt; freq, h = signal.freqz(b, a, fs=fs)</span></div>
<div class="line"><span class="lineno"> 5224</span><span class="stringliteral">    &gt;&gt;&gt; response = abs(h)</span></div>
<div class="line"><span class="lineno"> 5225</span><span class="stringliteral">    &gt;&gt;&gt; # To avoid divide by zero when graphing</span></div>
<div class="line"><span class="lineno"> 5226</span><span class="stringliteral">    &gt;&gt;&gt; response[response == 0] = 1e-20</span></div>
<div class="line"><span class="lineno"> 5227</span><span class="stringliteral">    &gt;&gt;&gt; # Plot</span></div>
<div class="line"><span class="lineno"> 5228</span><span class="stringliteral">    &gt;&gt;&gt; fig, ax = plt.subplots(2, 1, figsize=(8, 6), sharex=True)</span></div>
<div class="line"><span class="lineno"> 5229</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].plot(freq, 20*np.log10(np.maximum(abs(h), 1e-5)), color=&#39;blue&#39;)</span></div>
<div class="line"><span class="lineno"> 5230</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_title(&quot;Frequency Response&quot;)</span></div>
<div class="line"><span class="lineno"> 5231</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_ylabel(&quot;Amplitude (dB)&quot;, color=&#39;blue&#39;)</span></div>
<div class="line"><span class="lineno"> 5232</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_xlim([0, 500])</span></div>
<div class="line"><span class="lineno"> 5233</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_ylim([-80, 10])</span></div>
<div class="line"><span class="lineno"> 5234</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].grid(True)</span></div>
<div class="line"><span class="lineno"> 5235</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].plot(freq, (np.angle(h)*180/np.pi+180)%360 - 180, color=&#39;green&#39;)</span></div>
<div class="line"><span class="lineno"> 5236</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_ylabel(&quot;Angle (degrees)&quot;, color=&#39;green&#39;)</span></div>
<div class="line"><span class="lineno"> 5237</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_xlabel(&quot;Frequency (Hz)&quot;)</span></div>
<div class="line"><span class="lineno"> 5238</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_xlim([0, 500])</span></div>
<div class="line"><span class="lineno"> 5239</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_yticks([-90, -60, -30, 0, 30, 60, 90])</span></div>
<div class="line"><span class="lineno"> 5240</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_ylim([-90, 90])</span></div>
<div class="line"><span class="lineno"> 5241</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].grid(True)</span></div>
<div class="line"><span class="lineno"> 5242</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 5243</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5244</span> </div>
<div class="line"><span class="lineno"> 5245</span>    <span class="comment"># Convert w0, Q, and fs to float</span></div>
<div class="line"><span class="lineno"> 5246</span>    w0 = float(w0)</div>
<div class="line"><span class="lineno"> 5247</span>    Q = float(Q)</div>
<div class="line"><span class="lineno"> 5248</span>    fs = float(fs)</div>
<div class="line"><span class="lineno"> 5249</span> </div>
<div class="line"><span class="lineno"> 5250</span>    <span class="comment"># Check for invalid cutoff frequency or filter type</span></div>
<div class="line"><span class="lineno"> 5251</span>    ftype = ftype.lower()</div>
<div class="line"><span class="lineno"> 5252</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> 0 &lt; w0 &lt; fs / 2:</div>
<div class="line"><span class="lineno"> 5253</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;w0 must be between 0 and {}&quot;</span></div>
<div class="line"><span class="lineno"> 5254</span>                         <span class="stringliteral">&quot; (nyquist), but given {}.&quot;</span>.format(fs / 2, w0))</div>
<div class="line"><span class="lineno"> 5255</span>    <span class="keywordflow">if</span> ftype <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&#39;notch&#39;</span>, <span class="stringliteral">&#39;peak&#39;</span>):</div>
<div class="line"><span class="lineno"> 5256</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;ftype must be either notch or peak.&#39;</span>)</div>
<div class="line"><span class="lineno"> 5257</span> </div>
<div class="line"><span class="lineno"> 5258</span>    <span class="comment"># Compute the order of the filter</span></div>
<div class="line"><span class="lineno"> 5259</span>    N = round(fs / w0)</div>
<div class="line"><span class="lineno"> 5260</span> </div>
<div class="line"><span class="lineno"> 5261</span>    <span class="comment"># Check for cutoff frequency divisibility</span></div>
<div class="line"><span class="lineno"> 5262</span>    <span class="keywordflow">if</span> abs(w0 - fs/N)/fs &gt; 1e-14:</div>
<div class="line"><span class="lineno"> 5263</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;fs must be divisible by w0.&#39;</span>)</div>
<div class="line"><span class="lineno"> 5264</span> </div>
<div class="line"><span class="lineno"> 5265</span>    <span class="comment"># Compute frequency in radians and filter bandwidth</span></div>
<div class="line"><span class="lineno"> 5266</span>    <span class="comment"># Eq. 11.3.1 (p. 574) from reference [1]</span></div>
<div class="line"><span class="lineno"> 5267</span>    w0 = (2 * np.pi * w0) / fs</div>
<div class="line"><span class="lineno"> 5268</span>    w_delta = w0 / Q</div>
<div class="line"><span class="lineno"> 5269</span> </div>
<div class="line"><span class="lineno"> 5270</span>    <span class="comment"># Define base gain values depending on notch or peak filter</span></div>
<div class="line"><span class="lineno"> 5271</span>    <span class="comment"># Compute -3dB attenuation</span></div>
<div class="line"><span class="lineno"> 5272</span>    <span class="comment"># Eqs. 11.4.1 and 11.4.2 (p. 582) from reference [1]</span></div>
<div class="line"><span class="lineno"> 5273</span>    <span class="keywordflow">if</span> ftype == <span class="stringliteral">&#39;notch&#39;</span>:</div>
<div class="line"><span class="lineno"> 5274</span>        G0, G = 1, 0</div>
<div class="line"><span class="lineno"> 5275</span>    <span class="keywordflow">elif</span> ftype == <span class="stringliteral">&#39;peak&#39;</span>:</div>
<div class="line"><span class="lineno"> 5276</span>        G0, G = 0, 1</div>
<div class="line"><span class="lineno"> 5277</span>    GB = 1 / np.sqrt(2)</div>
<div class="line"><span class="lineno"> 5278</span> </div>
<div class="line"><span class="lineno"> 5279</span>    <span class="comment"># Compute beta</span></div>
<div class="line"><span class="lineno"> 5280</span>    <span class="comment"># Eq. 11.5.3 (p. 591) from reference [1]</span></div>
<div class="line"><span class="lineno"> 5281</span>    beta = np.sqrt((GB**2 - G0**2) / (G**2 - GB**2)) * np.tan(N * w_delta / 4)</div>
<div class="line"><span class="lineno"> 5282</span> </div>
<div class="line"><span class="lineno"> 5283</span>    <span class="comment"># Compute filter coefficients</span></div>
<div class="line"><span class="lineno"> 5284</span>    <span class="comment"># Eq 11.5.1 (p. 590) variables a, b, c from reference [1]</span></div>
<div class="line"><span class="lineno"> 5285</span>    ax = (1 - beta) / (1 + beta)</div>
<div class="line"><span class="lineno"> 5286</span>    bx = (G0 + G * beta) / (1 + beta)</div>
<div class="line"><span class="lineno"> 5287</span>    cx = (G0 - G * beta) / (1 + beta)</div>
<div class="line"><span class="lineno"> 5288</span> </div>
<div class="line"><span class="lineno"> 5289</span>    <span class="comment"># Last coefficients are negative to get peaking comb that passes zero or</span></div>
<div class="line"><span class="lineno"> 5290</span>    <span class="comment"># notching comb that doesn&#39;t.</span></div>
<div class="line"><span class="lineno"> 5291</span>    negative_coef = ((ftype == <span class="stringliteral">&#39;peak&#39;</span> <span class="keywordflow">and</span> pass_zero) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno"> 5292</span>                     (ftype == <span class="stringliteral">&#39;notch&#39;</span> <span class="keywordflow">and</span> <span class="keywordflow">not</span> pass_zero))</div>
<div class="line"><span class="lineno"> 5293</span> </div>
<div class="line"><span class="lineno"> 5294</span>    <span class="comment"># Compute numerator coefficients</span></div>
<div class="line"><span class="lineno"> 5295</span>    <span class="comment"># Eq 11.5.1 (p. 590) or Eq 11.5.4 (p. 591) from reference [1]</span></div>
<div class="line"><span class="lineno"> 5296</span>    <span class="comment"># b - cz^-N or b + cz^-N</span></div>
<div class="line"><span class="lineno"> 5297</span>    b = np.zeros(N + 1)</div>
<div class="line"><span class="lineno"> 5298</span>    b[0] = bx</div>
<div class="line"><span class="lineno"> 5299</span>    <span class="keywordflow">if</span> negative_coef:</div>
<div class="line"><span class="lineno"> 5300</span>        b[-1] = -cx</div>
<div class="line"><span class="lineno"> 5301</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 5302</span>        b[-1] = +cx</div>
<div class="line"><span class="lineno"> 5303</span> </div>
<div class="line"><span class="lineno"> 5304</span>    <span class="comment"># Compute denominator coefficients</span></div>
<div class="line"><span class="lineno"> 5305</span>    <span class="comment"># Eq 11.5.1 (p. 590) or Eq 11.5.4 (p. 591) from reference [1]</span></div>
<div class="line"><span class="lineno"> 5306</span>    <span class="comment"># 1 - az^-N or 1 + az^-N</span></div>
<div class="line"><span class="lineno"> 5307</span>    a = np.zeros(N + 1)</div>
<div class="line"><span class="lineno"> 5308</span>    a[0] = 1</div>
<div class="line"><span class="lineno"> 5309</span>    <span class="keywordflow">if</span> negative_coef:</div>
<div class="line"><span class="lineno"> 5310</span>        a[-1] = -ax</div>
<div class="line"><span class="lineno"> 5311</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 5312</span>        a[-1] = +ax</div>
<div class="line"><span class="lineno"> 5313</span> </div>
<div class="line"><span class="lineno"> 5314</span>    <span class="keywordflow">return</span> b, a</div>
<div class="line"><span class="lineno"> 5315</span> </div>
<div class="line"><span class="lineno"> 5316</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4d58f87f7cfea7d8b63e0809aba1c20" name="ae4d58f87f7cfea7d8b63e0809aba1c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d58f87f7cfea7d8b63e0809aba1c20">&#9670;&#160;</a></span>iirdesign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.iirdesign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gstop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftype</em> = <code>'<a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a61a842f3ea1494216b2d32708a8ae665">ellip</a>'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>'ba'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Complete IIR digital and analog filter design.

Given passband and stopband frequencies and gains, construct an analog or
digital IIR filter of minimum order for a given basic type. Return the
output in numerator, denominator ('ba'), pole-zero ('zpk') or second order
sections ('sos') form.

Parameters
----------
wp, ws : float or array like, shape (2,)
    Passband and stopband edge frequencies. Possible values are scalars
    (for lowpass and highpass filters) or ranges (for bandpass and bandstop
    filters).
    For digital filters, these are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. For example:

        - Lowpass:   wp = 0.2,          ws = 0.3
        - Highpass:  wp = 0.3,          ws = 0.2
        - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]
        - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]

    For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).
    Note, that for bandpass and bandstop filters passband must lie strictly
    inside stopband or vice versa.
gpass : float
    The maximum loss in the passband (dB).
gstop : float
    The minimum attenuation in the stopband (dB).
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
ftype : str, optional
    The type of IIR filter to design:

        - Butterworth   : 'butter'
        - Chebyshev I   : 'cheby1'
        - Chebyshev II  : 'cheby2'
        - Cauer/elliptic: 'ellip'
        - Bessel/Thomson: 'bessel'

output : {'ba', 'zpk', 'sos'}, optional
    Filter form of the output:

        - second-order sections (recommended): 'sos'
        - numerator/denominator (default)    : 'ba'
        - pole-zero                          : 'zpk'

    In general the second-order sections ('sos') form  is
    recommended because inferring the coefficients for the
    numerator/denominator form ('ba') suffers from numerical
    instabilities. For reasons of backward compatibility the default
    form is the numerator/denominator form ('ba'), where the 'b'
    and the 'a' in 'ba' refer to the commonly used names of the
    coefficients used.

    Note: Using the second-order sections form ('sos') is sometimes
    associated with additional computational costs: for
    data-intense use cases it is therefore recommended to also
    investigate the numerator/denominator form ('ba').

fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.
    Only returned if ``output='ba'``.
z, p, k : ndarray, ndarray, float
    Zeros, poles, and system gain of the IIR filter transfer
    function.  Only returned if ``output='zpk'``.
sos : ndarray
    Second-order sections representation of the IIR filter.
    Only returned if ``output=='sos'``.

See Also
--------
butter : Filter design using order and critical points
cheby1, cheby2, ellip, bessel
buttord : Find order and critical points from passband and stopband spec
cheb1ord, cheb2ord, ellipord
iirfilter : General filter design using order and critical frequencies

Notes
-----
The ``'sos'`` output parameter was added in 0.16.0.

Examples
--------

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; import matplotlib.ticker

&gt;&gt;&gt; wp = 0.2
&gt;&gt;&gt; ws = 0.3
&gt;&gt;&gt; gpass = 1
&gt;&gt;&gt; gstop = 40

&gt;&gt;&gt; system = signal.iirdesign(wp, ws, gpass, gstop)
&gt;&gt;&gt; w, h = signal.freqz(*system)

&gt;&gt;&gt; fig, ax1 = plt.subplots()
&gt;&gt;&gt; ax1.set_title('Digital filter frequency response')
&gt;&gt;&gt; ax1.plot(w, 20 * np.log10(abs(h)), 'b')
&gt;&gt;&gt; ax1.set_ylabel('Amplitude [dB]', color='b')
&gt;&gt;&gt; ax1.set_xlabel('Frequency [rad/sample]')
&gt;&gt;&gt; ax1.grid(True)
&gt;&gt;&gt; ax1.set_ylim([-120, 20])
&gt;&gt;&gt; ax2 = ax1.twinx()
&gt;&gt;&gt; angles = np.unwrap(np.angle(h))
&gt;&gt;&gt; ax2.plot(w, angles, 'g')
&gt;&gt;&gt; ax2.set_ylabel('Angle (radians)', color='g')
&gt;&gt;&gt; ax2.grid(True)
&gt;&gt;&gt; ax2.axis('tight')
&gt;&gt;&gt; ax2.set_ylim([-6, 1])
&gt;&gt;&gt; nticks = 8
&gt;&gt;&gt; ax1.yaxis.set_major_locator(matplotlib.ticker.LinearLocator(nticks))
&gt;&gt;&gt; ax2.yaxis.set_major_locator(matplotlib.ticker.LinearLocator(nticks))</pre> <div class="fragment"><div class="line"><span class="lineno"> 2151</span>              fs=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2152</span>    <span class="stringliteral">&quot;&quot;&quot;Complete IIR digital and analog filter design.</span></div>
<div class="line"><span class="lineno"> 2153</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2154</span><span class="stringliteral">    Given passband and stopband frequencies and gains, construct an analog or</span></div>
<div class="line"><span class="lineno"> 2155</span><span class="stringliteral">    digital IIR filter of minimum order for a given basic type. Return the</span></div>
<div class="line"><span class="lineno"> 2156</span><span class="stringliteral">    output in numerator, denominator (&#39;ba&#39;), pole-zero (&#39;zpk&#39;) or second order</span></div>
<div class="line"><span class="lineno"> 2157</span><span class="stringliteral">    sections (&#39;sos&#39;) form.</span></div>
<div class="line"><span class="lineno"> 2158</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2159</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2160</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2161</span><span class="stringliteral">    wp, ws : float or array like, shape (2,)</span></div>
<div class="line"><span class="lineno"> 2162</span><span class="stringliteral">        Passband and stopband edge frequencies. Possible values are scalars</span></div>
<div class="line"><span class="lineno"> 2163</span><span class="stringliteral">        (for lowpass and highpass filters) or ranges (for bandpass and bandstop</span></div>
<div class="line"><span class="lineno"> 2164</span><span class="stringliteral">        filters).</span></div>
<div class="line"><span class="lineno"> 2165</span><span class="stringliteral">        For digital filters, these are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 2166</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 2167</span><span class="stringliteral">        where 1 is the Nyquist frequency. For example:</span></div>
<div class="line"><span class="lineno"> 2168</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2169</span><span class="stringliteral">            - Lowpass:   wp = 0.2,          ws = 0.3</span></div>
<div class="line"><span class="lineno"> 2170</span><span class="stringliteral">            - Highpass:  wp = 0.3,          ws = 0.2</span></div>
<div class="line"><span class="lineno"> 2171</span><span class="stringliteral">            - Bandpass:  wp = [0.2, 0.5],   ws = [0.1, 0.6]</span></div>
<div class="line"><span class="lineno"> 2172</span><span class="stringliteral">            - Bandstop:  wp = [0.1, 0.6],   ws = [0.2, 0.5]</span></div>
<div class="line"><span class="lineno"> 2173</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2174</span><span class="stringliteral">        For analog filters, `wp` and `ws` are angular frequencies (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 2175</span><span class="stringliteral">        Note, that for bandpass and bandstop filters passband must lie strictly</span></div>
<div class="line"><span class="lineno"> 2176</span><span class="stringliteral">        inside stopband or vice versa.</span></div>
<div class="line"><span class="lineno"> 2177</span><span class="stringliteral">    gpass : float</span></div>
<div class="line"><span class="lineno"> 2178</span><span class="stringliteral">        The maximum loss in the passband (dB).</span></div>
<div class="line"><span class="lineno"> 2179</span><span class="stringliteral">    gstop : float</span></div>
<div class="line"><span class="lineno"> 2180</span><span class="stringliteral">        The minimum attenuation in the stopband (dB).</span></div>
<div class="line"><span class="lineno"> 2181</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 2182</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 2183</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 2184</span><span class="stringliteral">    ftype : str, optional</span></div>
<div class="line"><span class="lineno"> 2185</span><span class="stringliteral">        The type of IIR filter to design:</span></div>
<div class="line"><span class="lineno"> 2186</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2187</span><span class="stringliteral">            - Butterworth   : &#39;butter&#39;</span></div>
<div class="line"><span class="lineno"> 2188</span><span class="stringliteral">            - Chebyshev I   : &#39;cheby1&#39;</span></div>
<div class="line"><span class="lineno"> 2189</span><span class="stringliteral">            - Chebyshev II  : &#39;cheby2&#39;</span></div>
<div class="line"><span class="lineno"> 2190</span><span class="stringliteral">            - Cauer/elliptic: &#39;ellip&#39;</span></div>
<div class="line"><span class="lineno"> 2191</span><span class="stringliteral">            - Bessel/Thomson: &#39;bessel&#39;</span></div>
<div class="line"><span class="lineno"> 2192</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2193</span><span class="stringliteral">    output : {&#39;ba&#39;, &#39;zpk&#39;, &#39;sos&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 2194</span><span class="stringliteral">        Filter form of the output:</span></div>
<div class="line"><span class="lineno"> 2195</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2196</span><span class="stringliteral">            - second-order sections (recommended): &#39;sos&#39;</span></div>
<div class="line"><span class="lineno"> 2197</span><span class="stringliteral">            - numerator/denominator (default)    : &#39;ba&#39;</span></div>
<div class="line"><span class="lineno"> 2198</span><span class="stringliteral">            - pole-zero                          : &#39;zpk&#39;</span></div>
<div class="line"><span class="lineno"> 2199</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2200</span><span class="stringliteral">        In general the second-order sections (&#39;sos&#39;) form  is</span></div>
<div class="line"><span class="lineno"> 2201</span><span class="stringliteral">        recommended because inferring the coefficients for the</span></div>
<div class="line"><span class="lineno"> 2202</span><span class="stringliteral">        numerator/denominator form (&#39;ba&#39;) suffers from numerical</span></div>
<div class="line"><span class="lineno"> 2203</span><span class="stringliteral">        instabilities. For reasons of backward compatibility the default</span></div>
<div class="line"><span class="lineno"> 2204</span><span class="stringliteral">        form is the numerator/denominator form (&#39;ba&#39;), where the &#39;b&#39;</span></div>
<div class="line"><span class="lineno"> 2205</span><span class="stringliteral">        and the &#39;a&#39; in &#39;ba&#39; refer to the commonly used names of the</span></div>
<div class="line"><span class="lineno"> 2206</span><span class="stringliteral">        coefficients used.</span></div>
<div class="line"><span class="lineno"> 2207</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2208</span><span class="stringliteral">        Note: Using the second-order sections form (&#39;sos&#39;) is sometimes</span></div>
<div class="line"><span class="lineno"> 2209</span><span class="stringliteral">        associated with additional computational costs: for</span></div>
<div class="line"><span class="lineno"> 2210</span><span class="stringliteral">        data-intense use cases it is therefore recommended to also</span></div>
<div class="line"><span class="lineno"> 2211</span><span class="stringliteral">        investigate the numerator/denominator form (&#39;ba&#39;).</span></div>
<div class="line"><span class="lineno"> 2212</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2213</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 2214</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 2215</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2216</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 2217</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2218</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2219</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2220</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 2221</span><span class="stringliteral">        Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 2222</span><span class="stringliteral">        Only returned if ``output=&#39;ba&#39;``.</span></div>
<div class="line"><span class="lineno"> 2223</span><span class="stringliteral">    z, p, k : ndarray, ndarray, float</span></div>
<div class="line"><span class="lineno"> 2224</span><span class="stringliteral">        Zeros, poles, and system gain of the IIR filter transfer</span></div>
<div class="line"><span class="lineno"> 2225</span><span class="stringliteral">        function.  Only returned if ``output=&#39;zpk&#39;``.</span></div>
<div class="line"><span class="lineno"> 2226</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 2227</span><span class="stringliteral">        Second-order sections representation of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 2228</span><span class="stringliteral">        Only returned if ``output==&#39;sos&#39;``.</span></div>
<div class="line"><span class="lineno"> 2229</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2230</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2231</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2232</span><span class="stringliteral">    butter : Filter design using order and critical points</span></div>
<div class="line"><span class="lineno"> 2233</span><span class="stringliteral">    cheby1, cheby2, ellip, bessel</span></div>
<div class="line"><span class="lineno"> 2234</span><span class="stringliteral">    buttord : Find order and critical points from passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 2235</span><span class="stringliteral">    cheb1ord, cheb2ord, ellipord</span></div>
<div class="line"><span class="lineno"> 2236</span><span class="stringliteral">    iirfilter : General filter design using order and critical frequencies</span></div>
<div class="line"><span class="lineno"> 2237</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2238</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2239</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2240</span><span class="stringliteral">    The ``&#39;sos&#39;`` output parameter was added in 0.16.0.</span></div>
<div class="line"><span class="lineno"> 2241</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2242</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2243</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2244</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2245</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 2246</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 2247</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.ticker</span></div>
<div class="line"><span class="lineno"> 2248</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2249</span><span class="stringliteral">    &gt;&gt;&gt; wp = 0.2</span></div>
<div class="line"><span class="lineno"> 2250</span><span class="stringliteral">    &gt;&gt;&gt; ws = 0.3</span></div>
<div class="line"><span class="lineno"> 2251</span><span class="stringliteral">    &gt;&gt;&gt; gpass = 1</span></div>
<div class="line"><span class="lineno"> 2252</span><span class="stringliteral">    &gt;&gt;&gt; gstop = 40</span></div>
<div class="line"><span class="lineno"> 2253</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2254</span><span class="stringliteral">    &gt;&gt;&gt; system = signal.iirdesign(wp, ws, gpass, gstop)</span></div>
<div class="line"><span class="lineno"> 2255</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz(*system)</span></div>
<div class="line"><span class="lineno"> 2256</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2257</span><span class="stringliteral">    &gt;&gt;&gt; fig, ax1 = plt.subplots()</span></div>
<div class="line"><span class="lineno"> 2258</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_title(&#39;Digital filter frequency response&#39;)</span></div>
<div class="line"><span class="lineno"> 2259</span><span class="stringliteral">    &gt;&gt;&gt; ax1.plot(w, 20 * np.log10(abs(h)), &#39;b&#39;)</span></div>
<div class="line"><span class="lineno"> 2260</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_ylabel(&#39;Amplitude [dB]&#39;, color=&#39;b&#39;)</span></div>
<div class="line"><span class="lineno"> 2261</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_xlabel(&#39;Frequency [rad/sample]&#39;)</span></div>
<div class="line"><span class="lineno"> 2262</span><span class="stringliteral">    &gt;&gt;&gt; ax1.grid(True)</span></div>
<div class="line"><span class="lineno"> 2263</span><span class="stringliteral">    &gt;&gt;&gt; ax1.set_ylim([-120, 20])</span></div>
<div class="line"><span class="lineno"> 2264</span><span class="stringliteral">    &gt;&gt;&gt; ax2 = ax1.twinx()</span></div>
<div class="line"><span class="lineno"> 2265</span><span class="stringliteral">    &gt;&gt;&gt; angles = np.unwrap(np.angle(h))</span></div>
<div class="line"><span class="lineno"> 2266</span><span class="stringliteral">    &gt;&gt;&gt; ax2.plot(w, angles, &#39;g&#39;)</span></div>
<div class="line"><span class="lineno"> 2267</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_ylabel(&#39;Angle (radians)&#39;, color=&#39;g&#39;)</span></div>
<div class="line"><span class="lineno"> 2268</span><span class="stringliteral">    &gt;&gt;&gt; ax2.grid(True)</span></div>
<div class="line"><span class="lineno"> 2269</span><span class="stringliteral">    &gt;&gt;&gt; ax2.axis(&#39;tight&#39;)</span></div>
<div class="line"><span class="lineno"> 2270</span><span class="stringliteral">    &gt;&gt;&gt; ax2.set_ylim([-6, 1])</span></div>
<div class="line"><span class="lineno"> 2271</span><span class="stringliteral">    &gt;&gt;&gt; nticks = 8</span></div>
<div class="line"><span class="lineno"> 2272</span><span class="stringliteral">    &gt;&gt;&gt; ax1.yaxis.set_major_locator(matplotlib.ticker.LinearLocator(nticks))</span></div>
<div class="line"><span class="lineno"> 2273</span><span class="stringliteral">    &gt;&gt;&gt; ax2.yaxis.set_major_locator(matplotlib.ticker.LinearLocator(nticks))</span></div>
<div class="line"><span class="lineno"> 2274</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2275</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2276</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2277</span>        ordfunc = filter_dict[ftype][1]</div>
<div class="line"><span class="lineno"> 2278</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2279</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Invalid IIR filter type: %s&quot;</span> % ftype) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno"> 2280</span>    <span class="keywordflow">except</span> IndexError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2281</span>        <span class="keywordflow">raise</span> ValueError((<span class="stringliteral">&quot;%s does not have order selection. Use &quot;</span></div>
<div class="line"><span class="lineno"> 2282</span>                          <span class="stringliteral">&quot;iirfilter function.&quot;</span>) % ftype) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno"> 2283</span> </div>
<div class="line"><span class="lineno"> 2284</span>    _validate_gpass_gstop(gpass, gstop)</div>
<div class="line"><span class="lineno"> 2285</span> </div>
<div class="line"><span class="lineno"> 2286</span>    wp = atleast_1d(wp)</div>
<div class="line"><span class="lineno"> 2287</span>    ws = atleast_1d(ws)</div>
<div class="line"><span class="lineno"> 2288</span> </div>
<div class="line"><span class="lineno"> 2289</span>    <span class="keywordflow">if</span> wp.shape[0] != ws.shape[0] <span class="keywordflow">or</span> wp.shape <span class="keywordflow">not</span> <span class="keywordflow">in</span> [(1,), (2,)]:</div>
<div class="line"><span class="lineno"> 2290</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;wp and ws must have one or two elements each, and&quot;</span></div>
<div class="line"><span class="lineno"> 2291</span>                         <span class="stringliteral">&quot;the same shape, got %s and %s&quot;</span></div>
<div class="line"><span class="lineno"> 2292</span>                         % (wp.shape, ws.shape))</div>
<div class="line"><span class="lineno"> 2293</span> </div>
<div class="line"><span class="lineno"> 2294</span>    <span class="keywordflow">if</span> any(wp &lt;= 0) <span class="keywordflow">or</span> any(ws &lt;= 0):</div>
<div class="line"><span class="lineno"> 2295</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Values for wp, ws must be greater than 0&quot;</span>)</div>
<div class="line"><span class="lineno"> 2296</span> </div>
<div class="line"><span class="lineno"> 2297</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 2298</span>        <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2299</span>            <span class="keywordflow">if</span> any(wp &gt;= 1) <span class="keywordflow">or</span> any(ws &gt;= 1):</div>
<div class="line"><span class="lineno"> 2300</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Values for wp, ws must be less than 1&quot;</span>)</div>
<div class="line"><span class="lineno"> 2301</span>        <span class="keywordflow">elif</span> any(wp &gt;= fs/2) <span class="keywordflow">or</span> any(ws &gt;= fs/2):</div>
<div class="line"><span class="lineno"> 2302</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Values for wp, ws must be less than fs/2&quot;</span></div>
<div class="line"><span class="lineno"> 2303</span>                             <span class="stringliteral">&quot; (fs={} -&gt; fs/2={})&quot;</span>.format(fs, fs/2))</div>
<div class="line"><span class="lineno"> 2304</span> </div>
<div class="line"><span class="lineno"> 2305</span>    <span class="keywordflow">if</span> wp.shape[0] == 2:</div>
<div class="line"><span class="lineno"> 2306</span>        <span class="keywordflow">if</span> not((ws[0] &lt; wp[0] <span class="keywordflow">and</span> wp[1] &lt; ws[1]) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno"> 2307</span>               (wp[0] &lt; ws[0] <span class="keywordflow">and</span> ws[1] &lt; wp[1])):</div>
<div class="line"><span class="lineno"> 2308</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Passband must lie strictly inside stopband&quot;</span></div>
<div class="line"><span class="lineno"> 2309</span>                         <span class="stringliteral">&quot; or vice versa&quot;</span>)</div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span>    band_type = 2 * (len(wp) - 1)</div>
<div class="line"><span class="lineno"> 2312</span>    band_type += 1</div>
<div class="line"><span class="lineno"> 2313</span>    <span class="keywordflow">if</span> wp[0] &gt;= ws[0]:</div>
<div class="line"><span class="lineno"> 2314</span>        band_type += 1</div>
<div class="line"><span class="lineno"> 2315</span> </div>
<div class="line"><span class="lineno"> 2316</span>    btype = {1: <span class="stringliteral">&#39;lowpass&#39;</span>, 2: <span class="stringliteral">&#39;highpass&#39;</span>,</div>
<div class="line"><span class="lineno"> 2317</span>             3: <span class="stringliteral">&#39;bandstop&#39;</span>, 4: <span class="stringliteral">&#39;bandpass&#39;</span>}[band_type]</div>
<div class="line"><span class="lineno"> 2318</span> </div>
<div class="line"><span class="lineno"> 2319</span>    N, Wn = ordfunc(wp, ws, gpass, gstop, analog=analog, fs=fs)</div>
<div class="line"><span class="lineno"> 2320</span>    <span class="keywordflow">return</span> iirfilter(N, Wn, rp=gpass, rs=gstop, analog=analog, btype=btype,</div>
<div class="line"><span class="lineno"> 2321</span>                     ftype=ftype, output=output, fs=fs)</div>
<div class="line"><span class="lineno"> 2322</span> </div>
<div class="line"><span class="lineno"> 2323</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a937343d2df9040beea4d31c3efe33481" name="a937343d2df9040beea4d31c3efe33481"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a937343d2df9040beea4d31c3efe33481">&#9670;&#160;</a></span>iirfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.iirfilter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Wn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rp</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>btype</em> = <code>'band'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftype</em> = <code>'<a class="el" href="namespacescipy_1_1signal_1_1__filter__design.html#a4568219d096c6e4e5a091c63dbde4bb8">butter</a>'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>'ba'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">IIR digital and analog filter design given order and critical points.

Design an Nth-order digital or analog filter and return the filter
coefficients.

Parameters
----------
N : int
    The order of the filter.
Wn : array_like
    A scalar or length-2 sequence giving the critical frequencies.

    For digital filters, `Wn` are in the same units as `fs`. By default,
    `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,
    where 1 is the Nyquist frequency. (`Wn` is thus in
    half-cycles / sample.)

    For analog filters, `Wn` is an angular frequency (e.g., rad/s).

    When Wn is a length-2 sequence, ``Wn[0]`` must be less than ``Wn[1]``.
rp : float, optional
    For Chebyshev and elliptic filters, provides the maximum ripple
    in the passband. (dB)
rs : float, optional
    For Chebyshev and elliptic filters, provides the minimum attenuation
    in the stop band. (dB)
btype : {'bandpass', 'lowpass', 'highpass', 'bandstop'}, optional
    The type of filter.  Default is 'bandpass'.
analog : bool, optional
    When True, return an analog filter, otherwise a digital filter is
    returned.
ftype : str, optional
    The type of IIR filter to design:

        - Butterworth   : 'butter'
        - Chebyshev I   : 'cheby1'
        - Chebyshev II  : 'cheby2'
        - Cauer/elliptic: 'ellip'
        - Bessel/Thomson: 'bessel'

output : {'ba', 'zpk', 'sos'}, optional
    Filter form of the output:

        - second-order sections (recommended): 'sos'
        - numerator/denominator (default)    : 'ba'
        - pole-zero                          : 'zpk'

    In general the second-order sections ('sos') form  is
    recommended because inferring the coefficients for the
    numerator/denominator form ('ba') suffers from numerical
    instabilities. For reasons of backward compatibility the default
    form is the numerator/denominator form ('ba'), where the 'b'
    and the 'a' in 'ba' refer to the commonly used names of the
    coefficients used.

    Note: Using the second-order sections form ('sos') is sometimes
    associated with additional computational costs: for
    data-intense use cases it is therefore recommended to also
    investigate the numerator/denominator form ('ba').

fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.
    Only returned if ``output='ba'``.
z, p, k : ndarray, ndarray, float
    Zeros, poles, and system gain of the IIR filter transfer
    function.  Only returned if ``output='zpk'``.
sos : ndarray
    Second-order sections representation of the IIR filter.
    Only returned if ``output=='sos'``.

See Also
--------
butter : Filter design using order and critical points
cheby1, cheby2, ellip, bessel
buttord : Find order and critical points from passband and stopband spec
cheb1ord, cheb2ord, ellipord
iirdesign : General filter design using passband and stopband spec

Notes
-----
The ``'sos'`` output parameter was added in 0.16.0.

Examples
--------
Generate a 17th-order Chebyshev II analog bandpass filter from 50 Hz to
200 Hz and plot the frequency response:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; b, a = signal.iirfilter(17, [2*np.pi*50, 2*np.pi*200], rs=60,
...                         btype='band', analog=True, ftype='cheby2')
&gt;&gt;&gt; w, h = signal.freqs(b, a, 1000)
&gt;&gt;&gt; fig = plt.figure()
&gt;&gt;&gt; ax = fig.add_subplot(1, 1, 1)
&gt;&gt;&gt; ax.semilogx(w / (2*np.pi), 20 * np.log10(np.maximum(abs(h), 1e-5)))
&gt;&gt;&gt; ax.set_title('Chebyshev Type II bandpass frequency response')
&gt;&gt;&gt; ax.set_xlabel('Frequency [Hz]')
&gt;&gt;&gt; ax.set_ylabel('Amplitude [dB]')
&gt;&gt;&gt; ax.axis((10, 1000, -100, 10))
&gt;&gt;&gt; ax.grid(which='both', axis='both')
&gt;&gt;&gt; plt.show()

Create a digital filter with the same properties, in a system with
sampling rate of 2000 Hz, and plot the frequency response. (Second-order
sections implementation is required to ensure stability of a filter of
this order):

&gt;&gt;&gt; sos = signal.iirfilter(17, [50, 200], rs=60, btype='band',
...                        analog=False, ftype='cheby2', fs=2000,
...                        output='sos')
&gt;&gt;&gt; w, h = signal.sosfreqz(sos, 2000, fs=2000)
&gt;&gt;&gt; fig = plt.figure()
&gt;&gt;&gt; ax = fig.add_subplot(1, 1, 1)
&gt;&gt;&gt; ax.semilogx(w, 20 * np.log10(np.maximum(abs(h), 1e-5)))
&gt;&gt;&gt; ax.set_title('Chebyshev Type II bandpass frequency response')
&gt;&gt;&gt; ax.set_xlabel('Frequency [Hz]')
&gt;&gt;&gt; ax.set_ylabel('Amplitude [dB]')
&gt;&gt;&gt; ax.axis((10, 1000, -100, 10))
&gt;&gt;&gt; ax.grid(which='both', axis='both')
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno"> 2325</span>              ftype=<span class="stringliteral">&#39;butter&#39;</span>, output=<span class="stringliteral">&#39;ba&#39;</span>, fs=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2326</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2327</span><span class="stringliteral">    IIR digital and analog filter design given order and critical points.</span></div>
<div class="line"><span class="lineno"> 2328</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2329</span><span class="stringliteral">    Design an Nth-order digital or analog filter and return the filter</span></div>
<div class="line"><span class="lineno"> 2330</span><span class="stringliteral">    coefficients.</span></div>
<div class="line"><span class="lineno"> 2331</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2332</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2333</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2334</span><span class="stringliteral">    N : int</span></div>
<div class="line"><span class="lineno"> 2335</span><span class="stringliteral">        The order of the filter.</span></div>
<div class="line"><span class="lineno"> 2336</span><span class="stringliteral">    Wn : array_like</span></div>
<div class="line"><span class="lineno"> 2337</span><span class="stringliteral">        A scalar or length-2 sequence giving the critical frequencies.</span></div>
<div class="line"><span class="lineno"> 2338</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2339</span><span class="stringliteral">        For digital filters, `Wn` are in the same units as `fs`. By default,</span></div>
<div class="line"><span class="lineno"> 2340</span><span class="stringliteral">        `fs` is 2 half-cycles/sample, so these are normalized from 0 to 1,</span></div>
<div class="line"><span class="lineno"> 2341</span><span class="stringliteral">        where 1 is the Nyquist frequency. (`Wn` is thus in</span></div>
<div class="line"><span class="lineno"> 2342</span><span class="stringliteral">        half-cycles / sample.)</span></div>
<div class="line"><span class="lineno"> 2343</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2344</span><span class="stringliteral">        For analog filters, `Wn` is an angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 2345</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2346</span><span class="stringliteral">        When Wn is a length-2 sequence, ``Wn[0]`` must be less than ``Wn[1]``.</span></div>
<div class="line"><span class="lineno"> 2347</span><span class="stringliteral">    rp : float, optional</span></div>
<div class="line"><span class="lineno"> 2348</span><span class="stringliteral">        For Chebyshev and elliptic filters, provides the maximum ripple</span></div>
<div class="line"><span class="lineno"> 2349</span><span class="stringliteral">        in the passband. (dB)</span></div>
<div class="line"><span class="lineno"> 2350</span><span class="stringliteral">    rs : float, optional</span></div>
<div class="line"><span class="lineno"> 2351</span><span class="stringliteral">        For Chebyshev and elliptic filters, provides the minimum attenuation</span></div>
<div class="line"><span class="lineno"> 2352</span><span class="stringliteral">        in the stop band. (dB)</span></div>
<div class="line"><span class="lineno"> 2353</span><span class="stringliteral">    btype : {&#39;bandpass&#39;, &#39;lowpass&#39;, &#39;highpass&#39;, &#39;bandstop&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 2354</span><span class="stringliteral">        The type of filter.  Default is &#39;bandpass&#39;.</span></div>
<div class="line"><span class="lineno"> 2355</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 2356</span><span class="stringliteral">        When True, return an analog filter, otherwise a digital filter is</span></div>
<div class="line"><span class="lineno"> 2357</span><span class="stringliteral">        returned.</span></div>
<div class="line"><span class="lineno"> 2358</span><span class="stringliteral">    ftype : str, optional</span></div>
<div class="line"><span class="lineno"> 2359</span><span class="stringliteral">        The type of IIR filter to design:</span></div>
<div class="line"><span class="lineno"> 2360</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2361</span><span class="stringliteral">            - Butterworth   : &#39;butter&#39;</span></div>
<div class="line"><span class="lineno"> 2362</span><span class="stringliteral">            - Chebyshev I   : &#39;cheby1&#39;</span></div>
<div class="line"><span class="lineno"> 2363</span><span class="stringliteral">            - Chebyshev II  : &#39;cheby2&#39;</span></div>
<div class="line"><span class="lineno"> 2364</span><span class="stringliteral">            - Cauer/elliptic: &#39;ellip&#39;</span></div>
<div class="line"><span class="lineno"> 2365</span><span class="stringliteral">            - Bessel/Thomson: &#39;bessel&#39;</span></div>
<div class="line"><span class="lineno"> 2366</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2367</span><span class="stringliteral">    output : {&#39;ba&#39;, &#39;zpk&#39;, &#39;sos&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 2368</span><span class="stringliteral">        Filter form of the output:</span></div>
<div class="line"><span class="lineno"> 2369</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2370</span><span class="stringliteral">            - second-order sections (recommended): &#39;sos&#39;</span></div>
<div class="line"><span class="lineno"> 2371</span><span class="stringliteral">            - numerator/denominator (default)    : &#39;ba&#39;</span></div>
<div class="line"><span class="lineno"> 2372</span><span class="stringliteral">            - pole-zero                          : &#39;zpk&#39;</span></div>
<div class="line"><span class="lineno"> 2373</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2374</span><span class="stringliteral">        In general the second-order sections (&#39;sos&#39;) form  is</span></div>
<div class="line"><span class="lineno"> 2375</span><span class="stringliteral">        recommended because inferring the coefficients for the</span></div>
<div class="line"><span class="lineno"> 2376</span><span class="stringliteral">        numerator/denominator form (&#39;ba&#39;) suffers from numerical</span></div>
<div class="line"><span class="lineno"> 2377</span><span class="stringliteral">        instabilities. For reasons of backward compatibility the default</span></div>
<div class="line"><span class="lineno"> 2378</span><span class="stringliteral">        form is the numerator/denominator form (&#39;ba&#39;), where the &#39;b&#39;</span></div>
<div class="line"><span class="lineno"> 2379</span><span class="stringliteral">        and the &#39;a&#39; in &#39;ba&#39; refer to the commonly used names of the</span></div>
<div class="line"><span class="lineno"> 2380</span><span class="stringliteral">        coefficients used.</span></div>
<div class="line"><span class="lineno"> 2381</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2382</span><span class="stringliteral">        Note: Using the second-order sections form (&#39;sos&#39;) is sometimes</span></div>
<div class="line"><span class="lineno"> 2383</span><span class="stringliteral">        associated with additional computational costs: for</span></div>
<div class="line"><span class="lineno"> 2384</span><span class="stringliteral">        data-intense use cases it is therefore recommended to also</span></div>
<div class="line"><span class="lineno"> 2385</span><span class="stringliteral">        investigate the numerator/denominator form (&#39;ba&#39;).</span></div>
<div class="line"><span class="lineno"> 2386</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2387</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 2388</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 2389</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2390</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 2391</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2392</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2393</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2394</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 2395</span><span class="stringliteral">        Numerator (`b`) and denominator (`a`) polynomials of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 2396</span><span class="stringliteral">        Only returned if ``output=&#39;ba&#39;``.</span></div>
<div class="line"><span class="lineno"> 2397</span><span class="stringliteral">    z, p, k : ndarray, ndarray, float</span></div>
<div class="line"><span class="lineno"> 2398</span><span class="stringliteral">        Zeros, poles, and system gain of the IIR filter transfer</span></div>
<div class="line"><span class="lineno"> 2399</span><span class="stringliteral">        function.  Only returned if ``output=&#39;zpk&#39;``.</span></div>
<div class="line"><span class="lineno"> 2400</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 2401</span><span class="stringliteral">        Second-order sections representation of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 2402</span><span class="stringliteral">        Only returned if ``output==&#39;sos&#39;``.</span></div>
<div class="line"><span class="lineno"> 2403</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2404</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2405</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2406</span><span class="stringliteral">    butter : Filter design using order and critical points</span></div>
<div class="line"><span class="lineno"> 2407</span><span class="stringliteral">    cheby1, cheby2, ellip, bessel</span></div>
<div class="line"><span class="lineno"> 2408</span><span class="stringliteral">    buttord : Find order and critical points from passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 2409</span><span class="stringliteral">    cheb1ord, cheb2ord, ellipord</span></div>
<div class="line"><span class="lineno"> 2410</span><span class="stringliteral">    iirdesign : General filter design using passband and stopband spec</span></div>
<div class="line"><span class="lineno"> 2411</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2412</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2413</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2414</span><span class="stringliteral">    The ``&#39;sos&#39;`` output parameter was added in 0.16.0.</span></div>
<div class="line"><span class="lineno"> 2415</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2416</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2417</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2418</span><span class="stringliteral">    Generate a 17th-order Chebyshev II analog bandpass filter from 50 Hz to</span></div>
<div class="line"><span class="lineno"> 2419</span><span class="stringliteral">    200 Hz and plot the frequency response:</span></div>
<div class="line"><span class="lineno"> 2420</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2421</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 2422</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 2423</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2424</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.iirfilter(17, [2*np.pi*50, 2*np.pi*200], rs=60,</span></div>
<div class="line"><span class="lineno"> 2425</span><span class="stringliteral">    ...                         btype=&#39;band&#39;, analog=True, ftype=&#39;cheby2&#39;)</span></div>
<div class="line"><span class="lineno"> 2426</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqs(b, a, 1000)</span></div>
<div class="line"><span class="lineno"> 2427</span><span class="stringliteral">    &gt;&gt;&gt; fig = plt.figure()</span></div>
<div class="line"><span class="lineno"> 2428</span><span class="stringliteral">    &gt;&gt;&gt; ax = fig.add_subplot(1, 1, 1)</span></div>
<div class="line"><span class="lineno"> 2429</span><span class="stringliteral">    &gt;&gt;&gt; ax.semilogx(w / (2*np.pi), 20 * np.log10(np.maximum(abs(h), 1e-5)))</span></div>
<div class="line"><span class="lineno"> 2430</span><span class="stringliteral">    &gt;&gt;&gt; ax.set_title(&#39;Chebyshev Type II bandpass frequency response&#39;)</span></div>
<div class="line"><span class="lineno"> 2431</span><span class="stringliteral">    &gt;&gt;&gt; ax.set_xlabel(&#39;Frequency [Hz]&#39;)</span></div>
<div class="line"><span class="lineno"> 2432</span><span class="stringliteral">    &gt;&gt;&gt; ax.set_ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 2433</span><span class="stringliteral">    &gt;&gt;&gt; ax.axis((10, 1000, -100, 10))</span></div>
<div class="line"><span class="lineno"> 2434</span><span class="stringliteral">    &gt;&gt;&gt; ax.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 2435</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 2436</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2437</span><span class="stringliteral">    Create a digital filter with the same properties, in a system with</span></div>
<div class="line"><span class="lineno"> 2438</span><span class="stringliteral">    sampling rate of 2000 Hz, and plot the frequency response. (Second-order</span></div>
<div class="line"><span class="lineno"> 2439</span><span class="stringliteral">    sections implementation is required to ensure stability of a filter of</span></div>
<div class="line"><span class="lineno"> 2440</span><span class="stringliteral">    this order):</span></div>
<div class="line"><span class="lineno"> 2441</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2442</span><span class="stringliteral">    &gt;&gt;&gt; sos = signal.iirfilter(17, [50, 200], rs=60, btype=&#39;band&#39;,</span></div>
<div class="line"><span class="lineno"> 2443</span><span class="stringliteral">    ...                        analog=False, ftype=&#39;cheby2&#39;, fs=2000,</span></div>
<div class="line"><span class="lineno"> 2444</span><span class="stringliteral">    ...                        output=&#39;sos&#39;)</span></div>
<div class="line"><span class="lineno"> 2445</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.sosfreqz(sos, 2000, fs=2000)</span></div>
<div class="line"><span class="lineno"> 2446</span><span class="stringliteral">    &gt;&gt;&gt; fig = plt.figure()</span></div>
<div class="line"><span class="lineno"> 2447</span><span class="stringliteral">    &gt;&gt;&gt; ax = fig.add_subplot(1, 1, 1)</span></div>
<div class="line"><span class="lineno"> 2448</span><span class="stringliteral">    &gt;&gt;&gt; ax.semilogx(w, 20 * np.log10(np.maximum(abs(h), 1e-5)))</span></div>
<div class="line"><span class="lineno"> 2449</span><span class="stringliteral">    &gt;&gt;&gt; ax.set_title(&#39;Chebyshev Type II bandpass frequency response&#39;)</span></div>
<div class="line"><span class="lineno"> 2450</span><span class="stringliteral">    &gt;&gt;&gt; ax.set_xlabel(&#39;Frequency [Hz]&#39;)</span></div>
<div class="line"><span class="lineno"> 2451</span><span class="stringliteral">    &gt;&gt;&gt; ax.set_ylabel(&#39;Amplitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 2452</span><span class="stringliteral">    &gt;&gt;&gt; ax.axis((10, 1000, -100, 10))</span></div>
<div class="line"><span class="lineno"> 2453</span><span class="stringliteral">    &gt;&gt;&gt; ax.grid(which=&#39;both&#39;, axis=&#39;both&#39;)</span></div>
<div class="line"><span class="lineno"> 2454</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 2455</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2456</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2457</span>    ftype, btype, output = [x.lower() <span class="keywordflow">for</span> x <span class="keywordflow">in</span> (ftype, btype, output)]</div>
<div class="line"><span class="lineno"> 2458</span>    Wn = asarray(Wn)</div>
<div class="line"><span class="lineno"> 2459</span>    <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2460</span>        <span class="keywordflow">if</span> analog:</div>
<div class="line"><span class="lineno"> 2461</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;fs cannot be specified for an analog filter&quot;</span>)</div>
<div class="line"><span class="lineno"> 2462</span>        Wn = 2*Wn/fs</div>
<div class="line"><span class="lineno"> 2463</span> </div>
<div class="line"><span class="lineno"> 2464</span>    <span class="keywordflow">if</span> numpy.any(Wn &lt;= 0):</div>
<div class="line"><span class="lineno"> 2465</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;filter critical frequencies must be greater than 0&quot;</span>)</div>
<div class="line"><span class="lineno"> 2466</span> </div>
<div class="line"><span class="lineno"> 2467</span>    <span class="keywordflow">if</span> Wn.size &gt; 1 <span class="keywordflow">and</span> <span class="keywordflow">not</span> Wn[0] &lt; Wn[1]:</div>
<div class="line"><span class="lineno"> 2468</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Wn[0] must be less than Wn[1]&quot;</span>)</div>
<div class="line"><span class="lineno"> 2469</span> </div>
<div class="line"><span class="lineno"> 2470</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2471</span>        btype = band_dict[btype]</div>
<div class="line"><span class="lineno"> 2472</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2473</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;%s&#39; is an invalid bandtype for filter.&quot;</span> % btype) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno"> 2474</span> </div>
<div class="line"><span class="lineno"> 2475</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2476</span>        typefunc = filter_dict[ftype][0]</div>
<div class="line"><span class="lineno"> 2477</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2478</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;%s&#39; is not a valid basic IIR filter.&quot;</span> % ftype) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno"> 2479</span> </div>
<div class="line"><span class="lineno"> 2480</span>    <span class="keywordflow">if</span> output <span class="keywordflow">not</span> <span class="keywordflow">in</span> [<span class="stringliteral">&#39;ba&#39;</span>, <span class="stringliteral">&#39;zpk&#39;</span>, <span class="stringliteral">&#39;sos&#39;</span>]:</div>
<div class="line"><span class="lineno"> 2481</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;%s&#39; is not a valid output form.&quot;</span> % output)</div>
<div class="line"><span class="lineno"> 2482</span> </div>
<div class="line"><span class="lineno"> 2483</span>    <span class="keywordflow">if</span> rp <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> rp &lt; 0:</div>
<div class="line"><span class="lineno"> 2484</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;passband ripple (rp) must be positive&quot;</span>)</div>
<div class="line"><span class="lineno"> 2485</span> </div>
<div class="line"><span class="lineno"> 2486</span>    <span class="keywordflow">if</span> rs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> rs &lt; 0:</div>
<div class="line"><span class="lineno"> 2487</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;stopband attenuation (rs) must be positive&quot;</span>)</div>
<div class="line"><span class="lineno"> 2488</span> </div>
<div class="line"><span class="lineno"> 2489</span>    <span class="comment"># Get analog lowpass prototype</span></div>
<div class="line"><span class="lineno"> 2490</span>    <span class="keywordflow">if</span> typefunc == buttap:</div>
<div class="line"><span class="lineno"> 2491</span>        z, p, k = typefunc(N)</div>
<div class="line"><span class="lineno"> 2492</span>    <span class="keywordflow">elif</span> typefunc == besselap:</div>
<div class="line"><span class="lineno"> 2493</span>        z, p, k = typefunc(N, norm=bessel_norms[ftype])</div>
<div class="line"><span class="lineno"> 2494</span>    <span class="keywordflow">elif</span> typefunc == cheb1ap:</div>
<div class="line"><span class="lineno"> 2495</span>        <span class="keywordflow">if</span> rp <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2496</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;passband ripple (rp) must be provided to &quot;</span></div>
<div class="line"><span class="lineno"> 2497</span>                             <span class="stringliteral">&quot;design a Chebyshev I filter.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2498</span>        z, p, k = typefunc(N, rp)</div>
<div class="line"><span class="lineno"> 2499</span>    <span class="keywordflow">elif</span> typefunc == cheb2ap:</div>
<div class="line"><span class="lineno"> 2500</span>        <span class="keywordflow">if</span> rs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2501</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;stopband attenuation (rs) must be provided to &quot;</span></div>
<div class="line"><span class="lineno"> 2502</span>                             <span class="stringliteral">&quot;design an Chebyshev II filter.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2503</span>        z, p, k = typefunc(N, rs)</div>
<div class="line"><span class="lineno"> 2504</span>    <span class="keywordflow">elif</span> typefunc == ellipap:</div>
<div class="line"><span class="lineno"> 2505</span>        <span class="keywordflow">if</span> rs <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">or</span> rp <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2506</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Both rp and rs must be provided to design an &quot;</span></div>
<div class="line"><span class="lineno"> 2507</span>                             <span class="stringliteral">&quot;elliptic filter.&quot;</span>)</div>
<div class="line"><span class="lineno"> 2508</span>        z, p, k = typefunc(N, rp, rs)</div>
<div class="line"><span class="lineno"> 2509</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2510</span>        <span class="keywordflow">raise</span> NotImplementedError(<span class="stringliteral">&quot;&#39;%s&#39; not implemented in iirfilter.&quot;</span> % ftype)</div>
<div class="line"><span class="lineno"> 2511</span> </div>
<div class="line"><span class="lineno"> 2512</span>    <span class="comment"># Pre-warp frequencies for digital filter design</span></div>
<div class="line"><span class="lineno"> 2513</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 2514</span>        <span class="keywordflow">if</span> numpy.any(Wn &lt;= 0) <span class="keywordflow">or</span> numpy.any(Wn &gt;= 1):</div>
<div class="line"><span class="lineno"> 2515</span>            <span class="keywordflow">if</span> fs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2516</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Digital filter critical frequencies &quot;</span></div>
<div class="line"><span class="lineno"> 2517</span>                                 <span class="stringliteral">&quot;must be 0 &lt; Wn &lt; fs/2 (fs={} -&gt; fs/2={})&quot;</span>.format(fs, fs/2))</div>
<div class="line"><span class="lineno"> 2518</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Digital filter critical frequencies &quot;</span></div>
<div class="line"><span class="lineno"> 2519</span>                             <span class="stringliteral">&quot;must be 0 &lt; Wn &lt; 1&quot;</span>)</div>
<div class="line"><span class="lineno"> 2520</span>        fs = 2.0</div>
<div class="line"><span class="lineno"> 2521</span>        warped = 2 * fs * tan(pi * Wn / fs)</div>
<div class="line"><span class="lineno"> 2522</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2523</span>        warped = Wn</div>
<div class="line"><span class="lineno"> 2524</span> </div>
<div class="line"><span class="lineno"> 2525</span>    <span class="comment"># transform to lowpass, bandpass, highpass, or bandstop</span></div>
<div class="line"><span class="lineno"> 2526</span>    <span class="keywordflow">if</span> btype <span class="keywordflow">in</span> (<span class="stringliteral">&#39;lowpass&#39;</span>, <span class="stringliteral">&#39;highpass&#39;</span>):</div>
<div class="line"><span class="lineno"> 2527</span>        <span class="keywordflow">if</span> numpy.size(Wn) != 1:</div>
<div class="line"><span class="lineno"> 2528</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Must specify a single critical frequency Wn for lowpass or highpass filter&#39;</span>)</div>
<div class="line"><span class="lineno"> 2529</span> </div>
<div class="line"><span class="lineno"> 2530</span>        <span class="keywordflow">if</span> btype == <span class="stringliteral">&#39;lowpass&#39;</span>:</div>
<div class="line"><span class="lineno"> 2531</span>            z, p, k = lp2lp_zpk(z, p, k, wo=warped)</div>
<div class="line"><span class="lineno"> 2532</span>        <span class="keywordflow">elif</span> btype == <span class="stringliteral">&#39;highpass&#39;</span>:</div>
<div class="line"><span class="lineno"> 2533</span>            z, p, k = lp2hp_zpk(z, p, k, wo=warped)</div>
<div class="line"><span class="lineno"> 2534</span>    <span class="keywordflow">elif</span> btype <span class="keywordflow">in</span> (<span class="stringliteral">&#39;bandpass&#39;</span>, <span class="stringliteral">&#39;bandstop&#39;</span>):</div>
<div class="line"><span class="lineno"> 2535</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2536</span>            bw = warped[1] - warped[0]</div>
<div class="line"><span class="lineno"> 2537</span>            wo = sqrt(warped[0] * warped[1])</div>
<div class="line"><span class="lineno"> 2538</span>        <span class="keywordflow">except</span> IndexError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno"> 2539</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Wn must specify start and stop frequencies for bandpass or bandstop &#39;</span></div>
<div class="line"><span class="lineno"> 2540</span>                             <span class="stringliteral">&#39;filter&#39;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno"> 2541</span> </div>
<div class="line"><span class="lineno"> 2542</span>        <span class="keywordflow">if</span> btype == <span class="stringliteral">&#39;bandpass&#39;</span>:</div>
<div class="line"><span class="lineno"> 2543</span>            z, p, k = lp2bp_zpk(z, p, k, wo=wo, bw=bw)</div>
<div class="line"><span class="lineno"> 2544</span>        <span class="keywordflow">elif</span> btype == <span class="stringliteral">&#39;bandstop&#39;</span>:</div>
<div class="line"><span class="lineno"> 2545</span>            z, p, k = lp2bs_zpk(z, p, k, wo=wo, bw=bw)</div>
<div class="line"><span class="lineno"> 2546</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2547</span>        <span class="keywordflow">raise</span> NotImplementedError(<span class="stringliteral">&quot;&#39;%s&#39; not implemented in iirfilter.&quot;</span> % btype)</div>
<div class="line"><span class="lineno"> 2548</span> </div>
<div class="line"><span class="lineno"> 2549</span>    <span class="comment"># Find discrete equivalent if necessary</span></div>
<div class="line"><span class="lineno"> 2550</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 2551</span>        z, p, k = bilinear_zpk(z, p, k, fs=fs)</div>
<div class="line"><span class="lineno"> 2552</span> </div>
<div class="line"><span class="lineno"> 2553</span>    <span class="comment"># Transform to proper out type (pole-zero, state-space, numer-denom)</span></div>
<div class="line"><span class="lineno"> 2554</span>    <span class="keywordflow">if</span> output == <span class="stringliteral">&#39;zpk&#39;</span>:</div>
<div class="line"><span class="lineno"> 2555</span>        <span class="keywordflow">return</span> z, p, k</div>
<div class="line"><span class="lineno"> 2556</span>    <span class="keywordflow">elif</span> output == <span class="stringliteral">&#39;ba&#39;</span>:</div>
<div class="line"><span class="lineno"> 2557</span>        <span class="keywordflow">return</span> zpk2tf(z, p, k)</div>
<div class="line"><span class="lineno"> 2558</span>    <span class="keywordflow">elif</span> output == <span class="stringliteral">&#39;sos&#39;</span>:</div>
<div class="line"><span class="lineno"> 2559</span>        <span class="keywordflow">return</span> zpk2sos(z, p, k, analog=analog)</div>
<div class="line"><span class="lineno"> 2560</span> </div>
<div class="line"><span class="lineno"> 2561</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad597e2eb48ee608991d13e408bf5873e" name="ad597e2eb48ee608991d13e408bf5873e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad597e2eb48ee608991d13e408bf5873e">&#9670;&#160;</a></span>iirnotch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.iirnotch </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>2.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Design second-order IIR notch digital filter.

A notch filter is a band-stop filter with a narrow bandwidth
(high quality factor). It rejects a narrow frequency band and
leaves the rest of the spectrum little changed.

Parameters
----------
w0 : float
    Frequency to remove from a signal. If `fs` is specified, this is in
    the same units as `fs`. By default, it is a normalized scalar that must
    satisfy  ``0 &lt; w0 &lt; 1``, with ``w0 = 1`` corresponding to half of the
    sampling frequency.
Q : float
    Quality factor. Dimensionless parameter that characterizes
    notch filter -3 dB bandwidth ``bw`` relative to its center
    frequency, ``Q = w0/bw``.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (``b``) and denominator (``a``) polynomials
    of the IIR filter.

See Also
--------
iirpeak

Notes
-----
.. versionadded:: 0.19.0

References
----------
.. [1] Sophocles J. Orfanidis, "Introduction To Signal Processing",
       Prentice-Hall, 1996

Examples
--------
Design and plot filter to remove the 60 Hz component from a
signal sampled at 200 Hz, using a quality factor Q = 30

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; fs = 200.0  # Sample frequency (Hz)
&gt;&gt;&gt; f0 = 60.0  # Frequency to be removed from signal (Hz)
&gt;&gt;&gt; Q = 30.0  # Quality factor
&gt;&gt;&gt; # Design notch filter
&gt;&gt;&gt; b, a = signal.iirnotch(f0, Q, fs)

&gt;&gt;&gt; # Frequency response
&gt;&gt;&gt; freq, h = signal.freqz(b, a, fs=fs)
&gt;&gt;&gt; # Plot
&gt;&gt;&gt; fig, ax = plt.subplots(2, 1, figsize=(8, 6))
&gt;&gt;&gt; ax[0].plot(freq, 20*np.log10(abs(h)), color='blue')
&gt;&gt;&gt; ax[0].set_title("Frequency Response")
&gt;&gt;&gt; ax[0].set_ylabel("Amplitude (dB)", color='blue')
&gt;&gt;&gt; ax[0].set_xlim([0, 100])
&gt;&gt;&gt; ax[0].set_ylim([-25, 10])
&gt;&gt;&gt; ax[0].grid(True)
&gt;&gt;&gt; ax[1].plot(freq, np.unwrap(np.angle(h))*180/np.pi, color='green')
&gt;&gt;&gt; ax[1].set_ylabel("Angle (degrees)", color='green')
&gt;&gt;&gt; ax[1].set_xlabel("Frequency (Hz)")
&gt;&gt;&gt; ax[1].set_xlim([0, 100])
&gt;&gt;&gt; ax[1].set_yticks([-90, -60, -30, 0, 30, 60, 90])
&gt;&gt;&gt; ax[1].set_ylim([-90, 90])
&gt;&gt;&gt; ax[1].grid(True)
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 4875</span><span class="keyword">def </span>iirnotch(w0, Q, fs=2.0):</div>
<div class="line"><span class="lineno"> 4876</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4877</span><span class="stringliteral">    Design second-order IIR notch digital filter.</span></div>
<div class="line"><span class="lineno"> 4878</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4879</span><span class="stringliteral">    A notch filter is a band-stop filter with a narrow bandwidth</span></div>
<div class="line"><span class="lineno"> 4880</span><span class="stringliteral">    (high quality factor). It rejects a narrow frequency band and</span></div>
<div class="line"><span class="lineno"> 4881</span><span class="stringliteral">    leaves the rest of the spectrum little changed.</span></div>
<div class="line"><span class="lineno"> 4882</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4883</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 4884</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4885</span><span class="stringliteral">    w0 : float</span></div>
<div class="line"><span class="lineno"> 4886</span><span class="stringliteral">        Frequency to remove from a signal. If `fs` is specified, this is in</span></div>
<div class="line"><span class="lineno"> 4887</span><span class="stringliteral">        the same units as `fs`. By default, it is a normalized scalar that must</span></div>
<div class="line"><span class="lineno"> 4888</span><span class="stringliteral">        satisfy  ``0 &lt; w0 &lt; 1``, with ``w0 = 1`` corresponding to half of the</span></div>
<div class="line"><span class="lineno"> 4889</span><span class="stringliteral">        sampling frequency.</span></div>
<div class="line"><span class="lineno"> 4890</span><span class="stringliteral">    Q : float</span></div>
<div class="line"><span class="lineno"> 4891</span><span class="stringliteral">        Quality factor. Dimensionless parameter that characterizes</span></div>
<div class="line"><span class="lineno"> 4892</span><span class="stringliteral">        notch filter -3 dB bandwidth ``bw`` relative to its center</span></div>
<div class="line"><span class="lineno"> 4893</span><span class="stringliteral">        frequency, ``Q = w0/bw``.</span></div>
<div class="line"><span class="lineno"> 4894</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 4895</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 4896</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4897</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 4898</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4899</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 4900</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 4901</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 4902</span><span class="stringliteral">        Numerator (``b``) and denominator (``a``) polynomials</span></div>
<div class="line"><span class="lineno"> 4903</span><span class="stringliteral">        of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 4904</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4905</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 4906</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4907</span><span class="stringliteral">    iirpeak</span></div>
<div class="line"><span class="lineno"> 4908</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4909</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 4910</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 4911</span><span class="stringliteral">    .. versionadded:: 0.19.0</span></div>
<div class="line"><span class="lineno"> 4912</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4913</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 4914</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4915</span><span class="stringliteral">    .. [1] Sophocles J. Orfanidis, &quot;Introduction To Signal Processing&quot;,</span></div>
<div class="line"><span class="lineno"> 4916</span><span class="stringliteral">           Prentice-Hall, 1996</span></div>
<div class="line"><span class="lineno"> 4917</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4918</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 4919</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4920</span><span class="stringliteral">    Design and plot filter to remove the 60 Hz component from a</span></div>
<div class="line"><span class="lineno"> 4921</span><span class="stringliteral">    signal sampled at 200 Hz, using a quality factor Q = 30</span></div>
<div class="line"><span class="lineno"> 4922</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4923</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 4924</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 4925</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4926</span><span class="stringliteral">    &gt;&gt;&gt; fs = 200.0  # Sample frequency (Hz)</span></div>
<div class="line"><span class="lineno"> 4927</span><span class="stringliteral">    &gt;&gt;&gt; f0 = 60.0  # Frequency to be removed from signal (Hz)</span></div>
<div class="line"><span class="lineno"> 4928</span><span class="stringliteral">    &gt;&gt;&gt; Q = 30.0  # Quality factor</span></div>
<div class="line"><span class="lineno"> 4929</span><span class="stringliteral">    &gt;&gt;&gt; # Design notch filter</span></div>
<div class="line"><span class="lineno"> 4930</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.iirnotch(f0, Q, fs)</span></div>
<div class="line"><span class="lineno"> 4931</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4932</span><span class="stringliteral">    &gt;&gt;&gt; # Frequency response</span></div>
<div class="line"><span class="lineno"> 4933</span><span class="stringliteral">    &gt;&gt;&gt; freq, h = signal.freqz(b, a, fs=fs)</span></div>
<div class="line"><span class="lineno"> 4934</span><span class="stringliteral">    &gt;&gt;&gt; # Plot</span></div>
<div class="line"><span class="lineno"> 4935</span><span class="stringliteral">    &gt;&gt;&gt; fig, ax = plt.subplots(2, 1, figsize=(8, 6))</span></div>
<div class="line"><span class="lineno"> 4936</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].plot(freq, 20*np.log10(abs(h)), color=&#39;blue&#39;)</span></div>
<div class="line"><span class="lineno"> 4937</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_title(&quot;Frequency Response&quot;)</span></div>
<div class="line"><span class="lineno"> 4938</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_ylabel(&quot;Amplitude (dB)&quot;, color=&#39;blue&#39;)</span></div>
<div class="line"><span class="lineno"> 4939</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_xlim([0, 100])</span></div>
<div class="line"><span class="lineno"> 4940</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_ylim([-25, 10])</span></div>
<div class="line"><span class="lineno"> 4941</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].grid(True)</span></div>
<div class="line"><span class="lineno"> 4942</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].plot(freq, np.unwrap(np.angle(h))*180/np.pi, color=&#39;green&#39;)</span></div>
<div class="line"><span class="lineno"> 4943</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_ylabel(&quot;Angle (degrees)&quot;, color=&#39;green&#39;)</span></div>
<div class="line"><span class="lineno"> 4944</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_xlabel(&quot;Frequency (Hz)&quot;)</span></div>
<div class="line"><span class="lineno"> 4945</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_xlim([0, 100])</span></div>
<div class="line"><span class="lineno"> 4946</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_yticks([-90, -60, -30, 0, 30, 60, 90])</span></div>
<div class="line"><span class="lineno"> 4947</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_ylim([-90, 90])</span></div>
<div class="line"><span class="lineno"> 4948</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].grid(True)</span></div>
<div class="line"><span class="lineno"> 4949</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 4950</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4951</span> </div>
<div class="line"><span class="lineno"> 4952</span>    <span class="keywordflow">return</span> _design_notch_peak_filter(w0, Q, <span class="stringliteral">&quot;notch&quot;</span>, fs)</div>
<div class="line"><span class="lineno"> 4953</span> </div>
<div class="line"><span class="lineno"> 4954</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af928a310a30876eb852f6ef0ee25ac02" name="af928a310a30876eb852f6ef0ee25ac02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af928a310a30876eb852f6ef0ee25ac02">&#9670;&#160;</a></span>iirpeak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.iirpeak </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>2.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Design second-order IIR peak (resonant) digital filter.

A peak filter is a band-pass filter with a narrow bandwidth
(high quality factor). It rejects components outside a narrow
frequency band.

Parameters
----------
w0 : float
    Frequency to be retained in a signal. If `fs` is specified, this is in
    the same units as `fs`. By default, it is a normalized scalar that must
    satisfy  ``0 &lt; w0 &lt; 1``, with ``w0 = 1`` corresponding to half of the
    sampling frequency.
Q : float
    Quality factor. Dimensionless parameter that characterizes
    peak filter -3 dB bandwidth ``bw`` relative to its center
    frequency, ``Q = w0/bw``.
fs : float, optional
    The sampling frequency of the digital system.

    .. versionadded:: 1.2.0

Returns
-------
b, a : ndarray, ndarray
    Numerator (``b``) and denominator (``a``) polynomials
    of the IIR filter.

See Also
--------
iirnotch

Notes
-----
.. versionadded:: 0.19.0

References
----------
.. [1] Sophocles J. Orfanidis, "Introduction To Signal Processing",
       Prentice-Hall, 1996

Examples
--------
Design and plot filter to remove the frequencies other than the 300 Hz
component from a signal sampled at 1000 Hz, using a quality factor Q = 30

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; fs = 1000.0  # Sample frequency (Hz)
&gt;&gt;&gt; f0 = 300.0  # Frequency to be retained (Hz)
&gt;&gt;&gt; Q = 30.0  # Quality factor
&gt;&gt;&gt; # Design peak filter
&gt;&gt;&gt; b, a = signal.iirpeak(f0, Q, fs)

&gt;&gt;&gt; # Frequency response
&gt;&gt;&gt; freq, h = signal.freqz(b, a, fs=fs)
&gt;&gt;&gt; # Plot
&gt;&gt;&gt; fig, ax = plt.subplots(2, 1, figsize=(8, 6))
&gt;&gt;&gt; ax[0].plot(freq, 20*np.log10(np.maximum(abs(h), 1e-5)), color='blue')
&gt;&gt;&gt; ax[0].set_title("Frequency Response")
&gt;&gt;&gt; ax[0].set_ylabel("Amplitude (dB)", color='blue')
&gt;&gt;&gt; ax[0].set_xlim([0, 500])
&gt;&gt;&gt; ax[0].set_ylim([-50, 10])
&gt;&gt;&gt; ax[0].grid(True)
&gt;&gt;&gt; ax[1].plot(freq, np.unwrap(np.angle(h))*180/np.pi, color='green')
&gt;&gt;&gt; ax[1].set_ylabel("Angle (degrees)", color='green')
&gt;&gt;&gt; ax[1].set_xlabel("Frequency (Hz)")
&gt;&gt;&gt; ax[1].set_xlim([0, 500])
&gt;&gt;&gt; ax[1].set_yticks([-90, -60, -30, 0, 30, 60, 90])
&gt;&gt;&gt; ax[1].set_ylim([-90, 90])
&gt;&gt;&gt; ax[1].grid(True)
&gt;&gt;&gt; plt.show()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 4955</span><span class="keyword">def </span>iirpeak(w0, Q, fs=2.0):</div>
<div class="line"><span class="lineno"> 4956</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 4957</span><span class="stringliteral">    Design second-order IIR peak (resonant) digital filter.</span></div>
<div class="line"><span class="lineno"> 4958</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4959</span><span class="stringliteral">    A peak filter is a band-pass filter with a narrow bandwidth</span></div>
<div class="line"><span class="lineno"> 4960</span><span class="stringliteral">    (high quality factor). It rejects components outside a narrow</span></div>
<div class="line"><span class="lineno"> 4961</span><span class="stringliteral">    frequency band.</span></div>
<div class="line"><span class="lineno"> 4962</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4963</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 4964</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4965</span><span class="stringliteral">    w0 : float</span></div>
<div class="line"><span class="lineno"> 4966</span><span class="stringliteral">        Frequency to be retained in a signal. If `fs` is specified, this is in</span></div>
<div class="line"><span class="lineno"> 4967</span><span class="stringliteral">        the same units as `fs`. By default, it is a normalized scalar that must</span></div>
<div class="line"><span class="lineno"> 4968</span><span class="stringliteral">        satisfy  ``0 &lt; w0 &lt; 1``, with ``w0 = 1`` corresponding to half of the</span></div>
<div class="line"><span class="lineno"> 4969</span><span class="stringliteral">        sampling frequency.</span></div>
<div class="line"><span class="lineno"> 4970</span><span class="stringliteral">    Q : float</span></div>
<div class="line"><span class="lineno"> 4971</span><span class="stringliteral">        Quality factor. Dimensionless parameter that characterizes</span></div>
<div class="line"><span class="lineno"> 4972</span><span class="stringliteral">        peak filter -3 dB bandwidth ``bw`` relative to its center</span></div>
<div class="line"><span class="lineno"> 4973</span><span class="stringliteral">        frequency, ``Q = w0/bw``.</span></div>
<div class="line"><span class="lineno"> 4974</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno"> 4975</span><span class="stringliteral">        The sampling frequency of the digital system.</span></div>
<div class="line"><span class="lineno"> 4976</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4977</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno"> 4978</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4979</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 4980</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 4981</span><span class="stringliteral">    b, a : ndarray, ndarray</span></div>
<div class="line"><span class="lineno"> 4982</span><span class="stringliteral">        Numerator (``b``) and denominator (``a``) polynomials</span></div>
<div class="line"><span class="lineno"> 4983</span><span class="stringliteral">        of the IIR filter.</span></div>
<div class="line"><span class="lineno"> 4984</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4985</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 4986</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 4987</span><span class="stringliteral">    iirnotch</span></div>
<div class="line"><span class="lineno"> 4988</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4989</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 4990</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 4991</span><span class="stringliteral">    .. versionadded:: 0.19.0</span></div>
<div class="line"><span class="lineno"> 4992</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4993</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 4994</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 4995</span><span class="stringliteral">    .. [1] Sophocles J. Orfanidis, &quot;Introduction To Signal Processing&quot;,</span></div>
<div class="line"><span class="lineno"> 4996</span><span class="stringliteral">           Prentice-Hall, 1996</span></div>
<div class="line"><span class="lineno"> 4997</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 4998</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 4999</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 5000</span><span class="stringliteral">    Design and plot filter to remove the frequencies other than the 300 Hz</span></div>
<div class="line"><span class="lineno"> 5001</span><span class="stringliteral">    component from a signal sampled at 1000 Hz, using a quality factor Q = 30</span></div>
<div class="line"><span class="lineno"> 5002</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5003</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 5004</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 5005</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5006</span><span class="stringliteral">    &gt;&gt;&gt; fs = 1000.0  # Sample frequency (Hz)</span></div>
<div class="line"><span class="lineno"> 5007</span><span class="stringliteral">    &gt;&gt;&gt; f0 = 300.0  # Frequency to be retained (Hz)</span></div>
<div class="line"><span class="lineno"> 5008</span><span class="stringliteral">    &gt;&gt;&gt; Q = 30.0  # Quality factor</span></div>
<div class="line"><span class="lineno"> 5009</span><span class="stringliteral">    &gt;&gt;&gt; # Design peak filter</span></div>
<div class="line"><span class="lineno"> 5010</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.iirpeak(f0, Q, fs)</span></div>
<div class="line"><span class="lineno"> 5011</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 5012</span><span class="stringliteral">    &gt;&gt;&gt; # Frequency response</span></div>
<div class="line"><span class="lineno"> 5013</span><span class="stringliteral">    &gt;&gt;&gt; freq, h = signal.freqz(b, a, fs=fs)</span></div>
<div class="line"><span class="lineno"> 5014</span><span class="stringliteral">    &gt;&gt;&gt; # Plot</span></div>
<div class="line"><span class="lineno"> 5015</span><span class="stringliteral">    &gt;&gt;&gt; fig, ax = plt.subplots(2, 1, figsize=(8, 6))</span></div>
<div class="line"><span class="lineno"> 5016</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].plot(freq, 20*np.log10(np.maximum(abs(h), 1e-5)), color=&#39;blue&#39;)</span></div>
<div class="line"><span class="lineno"> 5017</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_title(&quot;Frequency Response&quot;)</span></div>
<div class="line"><span class="lineno"> 5018</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_ylabel(&quot;Amplitude (dB)&quot;, color=&#39;blue&#39;)</span></div>
<div class="line"><span class="lineno"> 5019</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_xlim([0, 500])</span></div>
<div class="line"><span class="lineno"> 5020</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].set_ylim([-50, 10])</span></div>
<div class="line"><span class="lineno"> 5021</span><span class="stringliteral">    &gt;&gt;&gt; ax[0].grid(True)</span></div>
<div class="line"><span class="lineno"> 5022</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].plot(freq, np.unwrap(np.angle(h))*180/np.pi, color=&#39;green&#39;)</span></div>
<div class="line"><span class="lineno"> 5023</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_ylabel(&quot;Angle (degrees)&quot;, color=&#39;green&#39;)</span></div>
<div class="line"><span class="lineno"> 5024</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_xlabel(&quot;Frequency (Hz)&quot;)</span></div>
<div class="line"><span class="lineno"> 5025</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_xlim([0, 500])</span></div>
<div class="line"><span class="lineno"> 5026</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_yticks([-90, -60, -30, 0, 30, 60, 90])</span></div>
<div class="line"><span class="lineno"> 5027</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].set_ylim([-90, 90])</span></div>
<div class="line"><span class="lineno"> 5028</span><span class="stringliteral">    &gt;&gt;&gt; ax[1].grid(True)</span></div>
<div class="line"><span class="lineno"> 5029</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno"> 5030</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 5031</span> </div>
<div class="line"><span class="lineno"> 5032</span>    <span class="keywordflow">return</span> _design_notch_peak_filter(w0, Q, <span class="stringliteral">&quot;peak&quot;</span>, fs)</div>
<div class="line"><span class="lineno"> 5033</span> </div>
<div class="line"><span class="lineno"> 5034</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aaef8478cb2d3a2d9df568f00047d2931" name="aaef8478cb2d3a2d9df568f00047d2931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaef8478cb2d3a2d9df568f00047d2931">&#9670;&#160;</a></span>lp2bp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.lp2bp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wo</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bw</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a lowpass filter prototype to a bandpass filter.

Return an analog band-pass filter with center frequency `wo` and
bandwidth `bw` from an analog low-pass filter prototype with unity
cutoff frequency, in transfer function ('ba') representation.

Parameters
----------
b : array_like
    Numerator polynomial coefficients.
a : array_like
    Denominator polynomial coefficients.
wo : float
    Desired passband center, as angular frequency (e.g., rad/s).
    Defaults to no change.
bw : float
    Desired passband width, as angular frequency (e.g., rad/s).
    Defaults to 1.

Returns
-------
b : array_like
    Numerator polynomial coefficients of the transformed band-pass filter.
a : array_like
    Denominator polynomial coefficients of the transformed band-pass filter.

See Also
--------
lp2lp, lp2hp, lp2bs, bilinear
lp2bp_zpk

Notes
-----
This is derived from the s-plane substitution

.. math:: s \rightarrow \frac{s^2 + {\omega_0}^2}{s \cdot \mathrm{BW}}

This is the "wideband" transformation, producing a passband with
geometric (log frequency) symmetry about `wo`.

Examples
--------
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; lp = signal.lti([1.0], [1.0, 1.0])
&gt;&gt;&gt; bp = signal.lti(*signal.lp2bp(lp.num, lp.den))
&gt;&gt;&gt; w, mag_lp, p_lp = lp.bode()
&gt;&gt;&gt; w, mag_bp, p_bp = bp.bode(w)

&gt;&gt;&gt; plt.plot(w, mag_lp, label='Lowpass')
&gt;&gt;&gt; plt.plot(w, mag_bp, label='Bandpass')
&gt;&gt;&gt; plt.semilogx()
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.xlabel('Frequency [rad/s]')
&gt;&gt;&gt; plt.ylabel('Magnitude [dB]')
&gt;&gt;&gt; plt.legend()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1878</span><span class="keyword">def </span>lp2bp(b, a, wo=1.0, bw=1.0):</div>
<div class="line"><span class="lineno"> 1879</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1880</span><span class="stringliteral">    Transform a lowpass filter prototype to a bandpass filter.</span></div>
<div class="line"><span class="lineno"> 1881</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1882</span><span class="stringliteral">    Return an analog band-pass filter with center frequency `wo` and</span></div>
<div class="line"><span class="lineno"> 1883</span><span class="stringliteral">    bandwidth `bw` from an analog low-pass filter prototype with unity</span></div>
<div class="line"><span class="lineno"> 1884</span><span class="stringliteral">    cutoff frequency, in transfer function (&#39;ba&#39;) representation.</span></div>
<div class="line"><span class="lineno"> 1885</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1886</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1887</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1888</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1889</span><span class="stringliteral">        Numerator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1890</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1891</span><span class="stringliteral">        Denominator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1892</span><span class="stringliteral">    wo : float</span></div>
<div class="line"><span class="lineno"> 1893</span><span class="stringliteral">        Desired passband center, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 1894</span><span class="stringliteral">        Defaults to no change.</span></div>
<div class="line"><span class="lineno"> 1895</span><span class="stringliteral">    bw : float</span></div>
<div class="line"><span class="lineno"> 1896</span><span class="stringliteral">        Desired passband width, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 1897</span><span class="stringliteral">        Defaults to 1.</span></div>
<div class="line"><span class="lineno"> 1898</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1899</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1900</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1901</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1902</span><span class="stringliteral">        Numerator polynomial coefficients of the transformed band-pass filter.</span></div>
<div class="line"><span class="lineno"> 1903</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1904</span><span class="stringliteral">        Denominator polynomial coefficients of the transformed band-pass filter.</span></div>
<div class="line"><span class="lineno"> 1905</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1906</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1907</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1908</span><span class="stringliteral">    lp2lp, lp2hp, lp2bs, bilinear</span></div>
<div class="line"><span class="lineno"> 1909</span><span class="stringliteral">    lp2bp_zpk</span></div>
<div class="line"><span class="lineno"> 1910</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1911</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1912</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1913</span><span class="stringliteral">    This is derived from the s-plane substitution</span></div>
<div class="line"><span class="lineno"> 1914</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1915</span><span class="stringliteral">    .. math:: s \rightarrow \frac{s^2 + {\omega_0}^2}{s \cdot \mathrm{BW}}</span></div>
<div class="line"><span class="lineno"> 1916</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1917</span><span class="stringliteral">    This is the &quot;wideband&quot; transformation, producing a passband with</span></div>
<div class="line"><span class="lineno"> 1918</span><span class="stringliteral">    geometric (log frequency) symmetry about `wo`.</span></div>
<div class="line"><span class="lineno"> 1919</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1920</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1921</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1922</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 1923</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 1924</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1925</span><span class="stringliteral">    &gt;&gt;&gt; lp = signal.lti([1.0], [1.0, 1.0])</span></div>
<div class="line"><span class="lineno"> 1926</span><span class="stringliteral">    &gt;&gt;&gt; bp = signal.lti(*signal.lp2bp(lp.num, lp.den))</span></div>
<div class="line"><span class="lineno"> 1927</span><span class="stringliteral">    &gt;&gt;&gt; w, mag_lp, p_lp = lp.bode()</span></div>
<div class="line"><span class="lineno"> 1928</span><span class="stringliteral">    &gt;&gt;&gt; w, mag_bp, p_bp = bp.bode(w)</span></div>
<div class="line"><span class="lineno"> 1929</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1930</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, mag_lp, label=&#39;Lowpass&#39;)</span></div>
<div class="line"><span class="lineno"> 1931</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, mag_bp, label=&#39;Bandpass&#39;)</span></div>
<div class="line"><span class="lineno"> 1932</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx()</span></div>
<div class="line"><span class="lineno"> 1933</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno"> 1934</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [rad/s]&#39;)</span></div>
<div class="line"><span class="lineno"> 1935</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Magnitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 1936</span><span class="stringliteral">    &gt;&gt;&gt; plt.legend()</span></div>
<div class="line"><span class="lineno"> 1937</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1938</span> </div>
<div class="line"><span class="lineno"> 1939</span>    a, b = map(atleast_1d, (a, b))</div>
<div class="line"><span class="lineno"> 1940</span>    D = len(a) - 1</div>
<div class="line"><span class="lineno"> 1941</span>    N = len(b) - 1</div>
<div class="line"><span class="lineno"> 1942</span>    artype = mintypecode((a, b))</div>
<div class="line"><span class="lineno"> 1943</span>    ma = max([N, D])</div>
<div class="line"><span class="lineno"> 1944</span>    Np = N + ma</div>
<div class="line"><span class="lineno"> 1945</span>    Dp = D + ma</div>
<div class="line"><span class="lineno"> 1946</span>    bprime = numpy.empty(Np + 1, artype)</div>
<div class="line"><span class="lineno"> 1947</span>    aprime = numpy.empty(Dp + 1, artype)</div>
<div class="line"><span class="lineno"> 1948</span>    wosq = wo * wo</div>
<div class="line"><span class="lineno"> 1949</span>    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(Np + 1):</div>
<div class="line"><span class="lineno"> 1950</span>        val = 0.0</div>
<div class="line"><span class="lineno"> 1951</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, N + 1):</div>
<div class="line"><span class="lineno"> 1952</span>            <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(0, i + 1):</div>
<div class="line"><span class="lineno"> 1953</span>                <span class="keywordflow">if</span> ma - i + 2 * k == j:</div>
<div class="line"><span class="lineno"> 1954</span>                    val += comb(i, k) * b[N - i] * (wosq) ** (i - k) / bw ** i</div>
<div class="line"><span class="lineno"> 1955</span>        bprime[Np - j] = val</div>
<div class="line"><span class="lineno"> 1956</span>    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(Dp + 1):</div>
<div class="line"><span class="lineno"> 1957</span>        val = 0.0</div>
<div class="line"><span class="lineno"> 1958</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, D + 1):</div>
<div class="line"><span class="lineno"> 1959</span>            <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(0, i + 1):</div>
<div class="line"><span class="lineno"> 1960</span>                <span class="keywordflow">if</span> ma - i + 2 * k == j:</div>
<div class="line"><span class="lineno"> 1961</span>                    val += comb(i, k) * a[D - i] * (wosq) ** (i - k) / bw ** i</div>
<div class="line"><span class="lineno"> 1962</span>        aprime[Dp - j] = val</div>
<div class="line"><span class="lineno"> 1963</span> </div>
<div class="line"><span class="lineno"> 1964</span>    <span class="keywordflow">return</span> normalize(bprime, aprime)</div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="add44de70076884fad1e24280565faa71" name="add44de70076884fad1e24280565faa71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add44de70076884fad1e24280565faa71">&#9670;&#160;</a></span>lp2bp_zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.lp2bp_zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wo</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bw</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a lowpass filter prototype to a bandpass filter.

Return an analog band-pass filter with center frequency `wo` and
bandwidth `bw` from an analog low-pass filter prototype with unity
cutoff frequency, using zeros, poles, and gain ('zpk') representation.

Parameters
----------
z : array_like
    Zeros of the analog filter transfer function.
p : array_like
    Poles of the analog filter transfer function.
k : float
    System gain of the analog filter transfer function.
wo : float
    Desired passband center, as angular frequency (e.g., rad/s).
    Defaults to no change.
bw : float
    Desired passband width, as angular frequency (e.g., rad/s).
    Defaults to 1.

Returns
-------
z : ndarray
    Zeros of the transformed band-pass filter transfer function.
p : ndarray
    Poles of the transformed band-pass filter transfer function.
k : float
    System gain of the transformed band-pass filter.

See Also
--------
lp2lp_zpk, lp2hp_zpk, lp2bs_zpk, bilinear
lp2bp

Notes
-----
This is derived from the s-plane substitution

.. math:: s \rightarrow \frac{s^2 + {\omega_0}^2}{s \cdot \mathrm{BW}}

This is the "wideband" transformation, producing a passband with
geometric (log frequency) symmetry about `wo`.

.. versionadded:: 1.1.0</pre> <div class="fragment"><div class="line"><span class="lineno"> 2781</span><span class="keyword">def </span>lp2bp_zpk(z, p, k, wo=1.0, bw=1.0):</div>
<div class="line"><span class="lineno"> 2782</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2783</span><span class="stringliteral">    Transform a lowpass filter prototype to a bandpass filter.</span></div>
<div class="line"><span class="lineno"> 2784</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2785</span><span class="stringliteral">    Return an analog band-pass filter with center frequency `wo` and</span></div>
<div class="line"><span class="lineno"> 2786</span><span class="stringliteral">    bandwidth `bw` from an analog low-pass filter prototype with unity</span></div>
<div class="line"><span class="lineno"> 2787</span><span class="stringliteral">    cutoff frequency, using zeros, poles, and gain (&#39;zpk&#39;) representation.</span></div>
<div class="line"><span class="lineno"> 2788</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2789</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2790</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2791</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno"> 2792</span><span class="stringliteral">        Zeros of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2793</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno"> 2794</span><span class="stringliteral">        Poles of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2795</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2796</span><span class="stringliteral">        System gain of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2797</span><span class="stringliteral">    wo : float</span></div>
<div class="line"><span class="lineno"> 2798</span><span class="stringliteral">        Desired passband center, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 2799</span><span class="stringliteral">        Defaults to no change.</span></div>
<div class="line"><span class="lineno"> 2800</span><span class="stringliteral">    bw : float</span></div>
<div class="line"><span class="lineno"> 2801</span><span class="stringliteral">        Desired passband width, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 2802</span><span class="stringliteral">        Defaults to 1.</span></div>
<div class="line"><span class="lineno"> 2803</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2804</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2805</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2806</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 2807</span><span class="stringliteral">        Zeros of the transformed band-pass filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2808</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 2809</span><span class="stringliteral">        Poles of the transformed band-pass filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2810</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2811</span><span class="stringliteral">        System gain of the transformed band-pass filter.</span></div>
<div class="line"><span class="lineno"> 2812</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2813</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2814</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2815</span><span class="stringliteral">    lp2lp_zpk, lp2hp_zpk, lp2bs_zpk, bilinear</span></div>
<div class="line"><span class="lineno"> 2816</span><span class="stringliteral">    lp2bp</span></div>
<div class="line"><span class="lineno"> 2817</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2818</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2819</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2820</span><span class="stringliteral">    This is derived from the s-plane substitution</span></div>
<div class="line"><span class="lineno"> 2821</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2822</span><span class="stringliteral">    .. math:: s \rightarrow \frac{s^2 + {\omega_0}^2}{s \cdot \mathrm{BW}}</span></div>
<div class="line"><span class="lineno"> 2823</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2824</span><span class="stringliteral">    This is the &quot;wideband&quot; transformation, producing a passband with</span></div>
<div class="line"><span class="lineno"> 2825</span><span class="stringliteral">    geometric (log frequency) symmetry about `wo`.</span></div>
<div class="line"><span class="lineno"> 2826</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2827</span><span class="stringliteral">    .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno"> 2828</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2829</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2830</span>    z = atleast_1d(z)</div>
<div class="line"><span class="lineno"> 2831</span>    p = atleast_1d(p)</div>
<div class="line"><span class="lineno"> 2832</span>    wo = float(wo)</div>
<div class="line"><span class="lineno"> 2833</span>    bw = float(bw)</div>
<div class="line"><span class="lineno"> 2834</span> </div>
<div class="line"><span class="lineno"> 2835</span>    degree = _relative_degree(z, p)</div>
<div class="line"><span class="lineno"> 2836</span> </div>
<div class="line"><span class="lineno"> 2837</span>    <span class="comment"># Scale poles and zeros to desired bandwidth</span></div>
<div class="line"><span class="lineno"> 2838</span>    z_lp = z * bw/2</div>
<div class="line"><span class="lineno"> 2839</span>    p_lp = p * bw/2</div>
<div class="line"><span class="lineno"> 2840</span> </div>
<div class="line"><span class="lineno"> 2841</span>    <span class="comment"># Square root needs to produce complex result, not NaN</span></div>
<div class="line"><span class="lineno"> 2842</span>    z_lp = z_lp.astype(complex)</div>
<div class="line"><span class="lineno"> 2843</span>    p_lp = p_lp.astype(complex)</div>
<div class="line"><span class="lineno"> 2844</span> </div>
<div class="line"><span class="lineno"> 2845</span>    <span class="comment"># Duplicate poles and zeros and shift from baseband to +wo and -wo</span></div>
<div class="line"><span class="lineno"> 2846</span>    z_bp = concatenate((z_lp + sqrt(z_lp**2 - wo**2),</div>
<div class="line"><span class="lineno"> 2847</span>                        z_lp - sqrt(z_lp**2 - wo**2)))</div>
<div class="line"><span class="lineno"> 2848</span>    p_bp = concatenate((p_lp + sqrt(p_lp**2 - wo**2),</div>
<div class="line"><span class="lineno"> 2849</span>                        p_lp - sqrt(p_lp**2 - wo**2)))</div>
<div class="line"><span class="lineno"> 2850</span> </div>
<div class="line"><span class="lineno"> 2851</span>    <span class="comment"># Move degree zeros to origin, leaving degree zeros at infinity for BPF</span></div>
<div class="line"><span class="lineno"> 2852</span>    z_bp = append(z_bp, zeros(degree))</div>
<div class="line"><span class="lineno"> 2853</span> </div>
<div class="line"><span class="lineno"> 2854</span>    <span class="comment"># Cancel out gain change from frequency scaling</span></div>
<div class="line"><span class="lineno"> 2855</span>    k_bp = k * bw**degree</div>
<div class="line"><span class="lineno"> 2856</span> </div>
<div class="line"><span class="lineno"> 2857</span>    <span class="keywordflow">return</span> z_bp, p_bp, k_bp</div>
<div class="line"><span class="lineno"> 2858</span> </div>
<div class="line"><span class="lineno"> 2859</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3bb750049c7af67e7751863c24c1652" name="ad3bb750049c7af67e7751863c24c1652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3bb750049c7af67e7751863c24c1652">&#9670;&#160;</a></span>lp2bs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.lp2bs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wo</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bw</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a lowpass filter prototype to a bandstop filter.

Return an analog band-stop filter with center frequency `wo` and
bandwidth `bw` from an analog low-pass filter prototype with unity
cutoff frequency, in transfer function ('ba') representation.

Parameters
----------
b : array_like
    Numerator polynomial coefficients.
a : array_like
    Denominator polynomial coefficients.
wo : float
    Desired stopband center, as angular frequency (e.g., rad/s).
    Defaults to no change.
bw : float
    Desired stopband width, as angular frequency (e.g., rad/s).
    Defaults to 1.

Returns
-------
b : array_like
    Numerator polynomial coefficients of the transformed band-stop filter.
a : array_like
    Denominator polynomial coefficients of the transformed band-stop filter.

See Also
--------
lp2lp, lp2hp, lp2bp, bilinear
lp2bs_zpk

Notes
-----
This is derived from the s-plane substitution

.. math:: s \rightarrow \frac{s \cdot \mathrm{BW}}{s^2 + {\omega_0}^2}

This is the "wideband" transformation, producing a stopband with
geometric (log frequency) symmetry about `wo`.

Examples
--------
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; lp = signal.lti([1.0], [1.0, 1.5])
&gt;&gt;&gt; bs = signal.lti(*signal.lp2bs(lp.num, lp.den))
&gt;&gt;&gt; w, mag_lp, p_lp = lp.bode()
&gt;&gt;&gt; w, mag_bs, p_bs = bs.bode(w)
&gt;&gt;&gt; plt.plot(w, mag_lp, label='Lowpass')
&gt;&gt;&gt; plt.plot(w, mag_bs, label='Bandstop')
&gt;&gt;&gt; plt.semilogx()
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.xlabel('Frequency [rad/s]')
&gt;&gt;&gt; plt.ylabel('Magnitude [dB]')
&gt;&gt;&gt; plt.legend()
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1967</span><span class="keyword">def </span>lp2bs(b, a, wo=1.0, bw=1.0):</div>
<div class="line"><span class="lineno"> 1968</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1969</span><span class="stringliteral">    Transform a lowpass filter prototype to a bandstop filter.</span></div>
<div class="line"><span class="lineno"> 1970</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1971</span><span class="stringliteral">    Return an analog band-stop filter with center frequency `wo` and</span></div>
<div class="line"><span class="lineno"> 1972</span><span class="stringliteral">    bandwidth `bw` from an analog low-pass filter prototype with unity</span></div>
<div class="line"><span class="lineno"> 1973</span><span class="stringliteral">    cutoff frequency, in transfer function (&#39;ba&#39;) representation.</span></div>
<div class="line"><span class="lineno"> 1974</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1975</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1976</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1977</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1978</span><span class="stringliteral">        Numerator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1979</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1980</span><span class="stringliteral">        Denominator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1981</span><span class="stringliteral">    wo : float</span></div>
<div class="line"><span class="lineno"> 1982</span><span class="stringliteral">        Desired stopband center, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 1983</span><span class="stringliteral">        Defaults to no change.</span></div>
<div class="line"><span class="lineno"> 1984</span><span class="stringliteral">    bw : float</span></div>
<div class="line"><span class="lineno"> 1985</span><span class="stringliteral">        Desired stopband width, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 1986</span><span class="stringliteral">        Defaults to 1.</span></div>
<div class="line"><span class="lineno"> 1987</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1988</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1989</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1990</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1991</span><span class="stringliteral">        Numerator polynomial coefficients of the transformed band-stop filter.</span></div>
<div class="line"><span class="lineno"> 1992</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1993</span><span class="stringliteral">        Denominator polynomial coefficients of the transformed band-stop filter.</span></div>
<div class="line"><span class="lineno"> 1994</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1995</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1996</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1997</span><span class="stringliteral">    lp2lp, lp2hp, lp2bp, bilinear</span></div>
<div class="line"><span class="lineno"> 1998</span><span class="stringliteral">    lp2bs_zpk</span></div>
<div class="line"><span class="lineno"> 1999</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2000</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2001</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2002</span><span class="stringliteral">    This is derived from the s-plane substitution</span></div>
<div class="line"><span class="lineno"> 2003</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2004</span><span class="stringliteral">    .. math:: s \rightarrow \frac{s \cdot \mathrm{BW}}{s^2 + {\omega_0}^2}</span></div>
<div class="line"><span class="lineno"> 2005</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2006</span><span class="stringliteral">    This is the &quot;wideband&quot; transformation, producing a stopband with</span></div>
<div class="line"><span class="lineno"> 2007</span><span class="stringliteral">    geometric (log frequency) symmetry about `wo`.</span></div>
<div class="line"><span class="lineno"> 2008</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2009</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2010</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2011</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 2012</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 2013</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2014</span><span class="stringliteral">    &gt;&gt;&gt; lp = signal.lti([1.0], [1.0, 1.5])</span></div>
<div class="line"><span class="lineno"> 2015</span><span class="stringliteral">    &gt;&gt;&gt; bs = signal.lti(*signal.lp2bs(lp.num, lp.den))</span></div>
<div class="line"><span class="lineno"> 2016</span><span class="stringliteral">    &gt;&gt;&gt; w, mag_lp, p_lp = lp.bode()</span></div>
<div class="line"><span class="lineno"> 2017</span><span class="stringliteral">    &gt;&gt;&gt; w, mag_bs, p_bs = bs.bode(w)</span></div>
<div class="line"><span class="lineno"> 2018</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, mag_lp, label=&#39;Lowpass&#39;)</span></div>
<div class="line"><span class="lineno"> 2019</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, mag_bs, label=&#39;Bandstop&#39;)</span></div>
<div class="line"><span class="lineno"> 2020</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx()</span></div>
<div class="line"><span class="lineno"> 2021</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno"> 2022</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [rad/s]&#39;)</span></div>
<div class="line"><span class="lineno"> 2023</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Magnitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 2024</span><span class="stringliteral">    &gt;&gt;&gt; plt.legend()</span></div>
<div class="line"><span class="lineno"> 2025</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2026</span>    a, b = map(atleast_1d, (a, b))</div>
<div class="line"><span class="lineno"> 2027</span>    D = len(a) - 1</div>
<div class="line"><span class="lineno"> 2028</span>    N = len(b) - 1</div>
<div class="line"><span class="lineno"> 2029</span>    artype = mintypecode((a, b))</div>
<div class="line"><span class="lineno"> 2030</span>    M = max([N, D])</div>
<div class="line"><span class="lineno"> 2031</span>    Np = M + M</div>
<div class="line"><span class="lineno"> 2032</span>    Dp = M + M</div>
<div class="line"><span class="lineno"> 2033</span>    bprime = numpy.empty(Np + 1, artype)</div>
<div class="line"><span class="lineno"> 2034</span>    aprime = numpy.empty(Dp + 1, artype)</div>
<div class="line"><span class="lineno"> 2035</span>    wosq = wo * wo</div>
<div class="line"><span class="lineno"> 2036</span>    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(Np + 1):</div>
<div class="line"><span class="lineno"> 2037</span>        val = 0.0</div>
<div class="line"><span class="lineno"> 2038</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, N + 1):</div>
<div class="line"><span class="lineno"> 2039</span>            <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(0, M - i + 1):</div>
<div class="line"><span class="lineno"> 2040</span>                <span class="keywordflow">if</span> i + 2 * k == j:</div>
<div class="line"><span class="lineno"> 2041</span>                    val += (comb(M - i, k) * b[N - i] *</div>
<div class="line"><span class="lineno"> 2042</span>                            (wosq) ** (M - i - k) * bw ** i)</div>
<div class="line"><span class="lineno"> 2043</span>        bprime[Np - j] = val</div>
<div class="line"><span class="lineno"> 2044</span>    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(Dp + 1):</div>
<div class="line"><span class="lineno"> 2045</span>        val = 0.0</div>
<div class="line"><span class="lineno"> 2046</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, D + 1):</div>
<div class="line"><span class="lineno"> 2047</span>            <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(0, M - i + 1):</div>
<div class="line"><span class="lineno"> 2048</span>                <span class="keywordflow">if</span> i + 2 * k == j:</div>
<div class="line"><span class="lineno"> 2049</span>                    val += (comb(M - i, k) * a[D - i] *</div>
<div class="line"><span class="lineno"> 2050</span>                            (wosq) ** (M - i - k) * bw ** i)</div>
<div class="line"><span class="lineno"> 2051</span>        aprime[Dp - j] = val</div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span>    <span class="keywordflow">return</span> normalize(bprime, aprime)</div>
<div class="line"><span class="lineno"> 2054</span> </div>
<div class="line"><span class="lineno"> 2055</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0030f63a715bfb905de22b463bb2005" name="ab0030f63a715bfb905de22b463bb2005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0030f63a715bfb905de22b463bb2005">&#9670;&#160;</a></span>lp2bs_zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.lp2bs_zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wo</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bw</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a lowpass filter prototype to a bandstop filter.

Return an analog band-stop filter with center frequency `wo` and
stopband width `bw` from an analog low-pass filter prototype with unity
cutoff frequency, using zeros, poles, and gain ('zpk') representation.

Parameters
----------
z : array_like
    Zeros of the analog filter transfer function.
p : array_like
    Poles of the analog filter transfer function.
k : float
    System gain of the analog filter transfer function.
wo : float
    Desired stopband center, as angular frequency (e.g., rad/s).
    Defaults to no change.
bw : float
    Desired stopband width, as angular frequency (e.g., rad/s).
    Defaults to 1.

Returns
-------
z : ndarray
    Zeros of the transformed band-stop filter transfer function.
p : ndarray
    Poles of the transformed band-stop filter transfer function.
k : float
    System gain of the transformed band-stop filter.

See Also
--------
lp2lp_zpk, lp2hp_zpk, lp2bp_zpk, bilinear
lp2bs

Notes
-----
This is derived from the s-plane substitution

.. math:: s \rightarrow \frac{s \cdot \mathrm{BW}}{s^2 + {\omega_0}^2}

This is the "wideband" transformation, producing a stopband with
geometric (log frequency) symmetry about `wo`.

.. versionadded:: 1.1.0</pre> <div class="fragment"><div class="line"><span class="lineno"> 2860</span><span class="keyword">def </span>lp2bs_zpk(z, p, k, wo=1.0, bw=1.0):</div>
<div class="line"><span class="lineno"> 2861</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2862</span><span class="stringliteral">    Transform a lowpass filter prototype to a bandstop filter.</span></div>
<div class="line"><span class="lineno"> 2863</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2864</span><span class="stringliteral">    Return an analog band-stop filter with center frequency `wo` and</span></div>
<div class="line"><span class="lineno"> 2865</span><span class="stringliteral">    stopband width `bw` from an analog low-pass filter prototype with unity</span></div>
<div class="line"><span class="lineno"> 2866</span><span class="stringliteral">    cutoff frequency, using zeros, poles, and gain (&#39;zpk&#39;) representation.</span></div>
<div class="line"><span class="lineno"> 2867</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2868</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2869</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2870</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno"> 2871</span><span class="stringliteral">        Zeros of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2872</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno"> 2873</span><span class="stringliteral">        Poles of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2874</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2875</span><span class="stringliteral">        System gain of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2876</span><span class="stringliteral">    wo : float</span></div>
<div class="line"><span class="lineno"> 2877</span><span class="stringliteral">        Desired stopband center, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 2878</span><span class="stringliteral">        Defaults to no change.</span></div>
<div class="line"><span class="lineno"> 2879</span><span class="stringliteral">    bw : float</span></div>
<div class="line"><span class="lineno"> 2880</span><span class="stringliteral">        Desired stopband width, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 2881</span><span class="stringliteral">        Defaults to 1.</span></div>
<div class="line"><span class="lineno"> 2882</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2883</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2884</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2885</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 2886</span><span class="stringliteral">        Zeros of the transformed band-stop filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2887</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 2888</span><span class="stringliteral">        Poles of the transformed band-stop filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2889</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2890</span><span class="stringliteral">        System gain of the transformed band-stop filter.</span></div>
<div class="line"><span class="lineno"> 2891</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2892</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2893</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2894</span><span class="stringliteral">    lp2lp_zpk, lp2hp_zpk, lp2bp_zpk, bilinear</span></div>
<div class="line"><span class="lineno"> 2895</span><span class="stringliteral">    lp2bs</span></div>
<div class="line"><span class="lineno"> 2896</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2897</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2898</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2899</span><span class="stringliteral">    This is derived from the s-plane substitution</span></div>
<div class="line"><span class="lineno"> 2900</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2901</span><span class="stringliteral">    .. math:: s \rightarrow \frac{s \cdot \mathrm{BW}}{s^2 + {\omega_0}^2}</span></div>
<div class="line"><span class="lineno"> 2902</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2903</span><span class="stringliteral">    This is the &quot;wideband&quot; transformation, producing a stopband with</span></div>
<div class="line"><span class="lineno"> 2904</span><span class="stringliteral">    geometric (log frequency) symmetry about `wo`.</span></div>
<div class="line"><span class="lineno"> 2905</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2906</span><span class="stringliteral">    .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno"> 2907</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2908</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2909</span>    z = atleast_1d(z)</div>
<div class="line"><span class="lineno"> 2910</span>    p = atleast_1d(p)</div>
<div class="line"><span class="lineno"> 2911</span>    wo = float(wo)</div>
<div class="line"><span class="lineno"> 2912</span>    bw = float(bw)</div>
<div class="line"><span class="lineno"> 2913</span> </div>
<div class="line"><span class="lineno"> 2914</span>    degree = _relative_degree(z, p)</div>
<div class="line"><span class="lineno"> 2915</span> </div>
<div class="line"><span class="lineno"> 2916</span>    <span class="comment"># Invert to a highpass filter with desired bandwidth</span></div>
<div class="line"><span class="lineno"> 2917</span>    z_hp = (bw/2) / z</div>
<div class="line"><span class="lineno"> 2918</span>    p_hp = (bw/2) / p</div>
<div class="line"><span class="lineno"> 2919</span> </div>
<div class="line"><span class="lineno"> 2920</span>    <span class="comment"># Square root needs to produce complex result, not NaN</span></div>
<div class="line"><span class="lineno"> 2921</span>    z_hp = z_hp.astype(complex)</div>
<div class="line"><span class="lineno"> 2922</span>    p_hp = p_hp.astype(complex)</div>
<div class="line"><span class="lineno"> 2923</span> </div>
<div class="line"><span class="lineno"> 2924</span>    <span class="comment"># Duplicate poles and zeros and shift from baseband to +wo and -wo</span></div>
<div class="line"><span class="lineno"> 2925</span>    z_bs = concatenate((z_hp + sqrt(z_hp**2 - wo**2),</div>
<div class="line"><span class="lineno"> 2926</span>                        z_hp - sqrt(z_hp**2 - wo**2)))</div>
<div class="line"><span class="lineno"> 2927</span>    p_bs = concatenate((p_hp + sqrt(p_hp**2 - wo**2),</div>
<div class="line"><span class="lineno"> 2928</span>                        p_hp - sqrt(p_hp**2 - wo**2)))</div>
<div class="line"><span class="lineno"> 2929</span> </div>
<div class="line"><span class="lineno"> 2930</span>    <span class="comment"># Move any zeros that were at infinity to the center of the stopband</span></div>
<div class="line"><span class="lineno"> 2931</span>    z_bs = append(z_bs, full(degree, +1j*wo))</div>
<div class="line"><span class="lineno"> 2932</span>    z_bs = append(z_bs, full(degree, -1j*wo))</div>
<div class="line"><span class="lineno"> 2933</span> </div>
<div class="line"><span class="lineno"> 2934</span>    <span class="comment"># Cancel out gain change caused by inversion</span></div>
<div class="line"><span class="lineno"> 2935</span>    k_bs = k * real(prod(-z) / prod(-p))</div>
<div class="line"><span class="lineno"> 2936</span> </div>
<div class="line"><span class="lineno"> 2937</span>    <span class="keywordflow">return</span> z_bs, p_bs, k_bs</div>
<div class="line"><span class="lineno"> 2938</span> </div>
<div class="line"><span class="lineno"> 2939</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acf80f2294b9a61970f9af0785977ac7d" name="acf80f2294b9a61970f9af0785977ac7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf80f2294b9a61970f9af0785977ac7d">&#9670;&#160;</a></span>lp2hp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.lp2hp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wo</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a lowpass filter prototype to a highpass filter.

Return an analog high-pass filter with cutoff frequency `wo`
from an analog low-pass filter prototype with unity cutoff frequency, in
transfer function ('ba') representation.

Parameters
----------
b : array_like
    Numerator polynomial coefficients.
a : array_like
    Denominator polynomial coefficients.
wo : float
    Desired cutoff, as angular frequency (e.g., rad/s).
    Defaults to no change.

Returns
-------
b : array_like
    Numerator polynomial coefficients of the transformed high-pass filter.
a : array_like
    Denominator polynomial coefficients of the transformed high-pass filter.

See Also
--------
lp2lp, lp2bp, lp2bs, bilinear
lp2hp_zpk

Notes
-----
This is derived from the s-plane substitution

.. math:: s \rightarrow \frac{\omega_0}{s}

This maintains symmetry of the lowpass and highpass responses on a
logarithmic scale.

Examples
--------
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; lp = signal.lti([1.0], [1.0, 1.0])
&gt;&gt;&gt; hp = signal.lti(*signal.lp2hp(lp.num, lp.den))
&gt;&gt;&gt; w, mag_lp, p_lp = lp.bode()
&gt;&gt;&gt; w, mag_hp, p_hp = hp.bode(w)

&gt;&gt;&gt; plt.plot(w, mag_lp, label='Lowpass')
&gt;&gt;&gt; plt.plot(w, mag_hp, label='Highpass')
&gt;&gt;&gt; plt.semilogx()
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.xlabel('Frequency [rad/s]')
&gt;&gt;&gt; plt.ylabel('Magnitude [dB]')
&gt;&gt;&gt; plt.legend()</pre> <div class="fragment"><div class="line"><span class="lineno"> 1795</span><span class="keyword">def </span>lp2hp(b, a, wo=1.0):</div>
<div class="line"><span class="lineno"> 1796</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1797</span><span class="stringliteral">    Transform a lowpass filter prototype to a highpass filter.</span></div>
<div class="line"><span class="lineno"> 1798</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1799</span><span class="stringliteral">    Return an analog high-pass filter with cutoff frequency `wo`</span></div>
<div class="line"><span class="lineno"> 1800</span><span class="stringliteral">    from an analog low-pass filter prototype with unity cutoff frequency, in</span></div>
<div class="line"><span class="lineno"> 1801</span><span class="stringliteral">    transfer function (&#39;ba&#39;) representation.</span></div>
<div class="line"><span class="lineno"> 1802</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1803</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1804</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1805</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1806</span><span class="stringliteral">        Numerator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1807</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1808</span><span class="stringliteral">        Denominator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1809</span><span class="stringliteral">    wo : float</span></div>
<div class="line"><span class="lineno"> 1810</span><span class="stringliteral">        Desired cutoff, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 1811</span><span class="stringliteral">        Defaults to no change.</span></div>
<div class="line"><span class="lineno"> 1812</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1813</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1814</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1815</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1816</span><span class="stringliteral">        Numerator polynomial coefficients of the transformed high-pass filter.</span></div>
<div class="line"><span class="lineno"> 1817</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1818</span><span class="stringliteral">        Denominator polynomial coefficients of the transformed high-pass filter.</span></div>
<div class="line"><span class="lineno"> 1819</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1820</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1821</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1822</span><span class="stringliteral">    lp2lp, lp2bp, lp2bs, bilinear</span></div>
<div class="line"><span class="lineno"> 1823</span><span class="stringliteral">    lp2hp_zpk</span></div>
<div class="line"><span class="lineno"> 1824</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1825</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1826</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1827</span><span class="stringliteral">    This is derived from the s-plane substitution</span></div>
<div class="line"><span class="lineno"> 1828</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1829</span><span class="stringliteral">    .. math:: s \rightarrow \frac{\omega_0}{s}</span></div>
<div class="line"><span class="lineno"> 1830</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1831</span><span class="stringliteral">    This maintains symmetry of the lowpass and highpass responses on a</span></div>
<div class="line"><span class="lineno"> 1832</span><span class="stringliteral">    logarithmic scale.</span></div>
<div class="line"><span class="lineno"> 1833</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1834</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1835</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1836</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 1837</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 1838</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1839</span><span class="stringliteral">    &gt;&gt;&gt; lp = signal.lti([1.0], [1.0, 1.0])</span></div>
<div class="line"><span class="lineno"> 1840</span><span class="stringliteral">    &gt;&gt;&gt; hp = signal.lti(*signal.lp2hp(lp.num, lp.den))</span></div>
<div class="line"><span class="lineno"> 1841</span><span class="stringliteral">    &gt;&gt;&gt; w, mag_lp, p_lp = lp.bode()</span></div>
<div class="line"><span class="lineno"> 1842</span><span class="stringliteral">    &gt;&gt;&gt; w, mag_hp, p_hp = hp.bode(w)</span></div>
<div class="line"><span class="lineno"> 1843</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1844</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, mag_lp, label=&#39;Lowpass&#39;)</span></div>
<div class="line"><span class="lineno"> 1845</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, mag_hp, label=&#39;Highpass&#39;)</span></div>
<div class="line"><span class="lineno"> 1846</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx()</span></div>
<div class="line"><span class="lineno"> 1847</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno"> 1848</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [rad/s]&#39;)</span></div>
<div class="line"><span class="lineno"> 1849</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Magnitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 1850</span><span class="stringliteral">    &gt;&gt;&gt; plt.legend()</span></div>
<div class="line"><span class="lineno"> 1851</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1852</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1853</span>    a, b = map(atleast_1d, (a, b))</div>
<div class="line"><span class="lineno"> 1854</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1855</span>        wo = float(wo)</div>
<div class="line"><span class="lineno"> 1856</span>    <span class="keywordflow">except</span> TypeError:</div>
<div class="line"><span class="lineno"> 1857</span>        wo = float(wo[0])</div>
<div class="line"><span class="lineno"> 1858</span>    d = len(a)</div>
<div class="line"><span class="lineno"> 1859</span>    n = len(b)</div>
<div class="line"><span class="lineno"> 1860</span>    <span class="keywordflow">if</span> wo != 1:</div>
<div class="line"><span class="lineno"> 1861</span>        pwo = pow(wo, numpy.arange(max((d, n))))</div>
<div class="line"><span class="lineno"> 1862</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1863</span>        pwo = numpy.ones(max((d, n)), b.dtype.char)</div>
<div class="line"><span class="lineno"> 1864</span>    <span class="keywordflow">if</span> d &gt;= n:</div>
<div class="line"><span class="lineno"> 1865</span>        outa = a[::-1] * pwo</div>
<div class="line"><span class="lineno"> 1866</span>        outb = resize(b, (d,))</div>
<div class="line"><span class="lineno"> 1867</span>        outb[n:] = 0.0</div>
<div class="line"><span class="lineno"> 1868</span>        outb[:n] = b[::-1] * pwo[:n]</div>
<div class="line"><span class="lineno"> 1869</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1870</span>        outb = b[::-1] * pwo</div>
<div class="line"><span class="lineno"> 1871</span>        outa = resize(a, (n,))</div>
<div class="line"><span class="lineno"> 1872</span>        outa[d:] = 0.0</div>
<div class="line"><span class="lineno"> 1873</span>        outa[:d] = a[::-1] * pwo[:d]</div>
<div class="line"><span class="lineno"> 1874</span> </div>
<div class="line"><span class="lineno"> 1875</span>    <span class="keywordflow">return</span> normalize(outb, outa)</div>
<div class="line"><span class="lineno"> 1876</span> </div>
<div class="line"><span class="lineno"> 1877</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d904ad8d1239d1f5408d1ed46d6b87c" name="a7d904ad8d1239d1f5408d1ed46d6b87c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d904ad8d1239d1f5408d1ed46d6b87c">&#9670;&#160;</a></span>lp2hp_zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.lp2hp_zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wo</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a lowpass filter prototype to a highpass filter.

Return an analog high-pass filter with cutoff frequency `wo`
from an analog low-pass filter prototype with unity cutoff frequency,
using zeros, poles, and gain ('zpk') representation.

Parameters
----------
z : array_like
    Zeros of the analog filter transfer function.
p : array_like
    Poles of the analog filter transfer function.
k : float
    System gain of the analog filter transfer function.
wo : float
    Desired cutoff, as angular frequency (e.g., rad/s).
    Defaults to no change.

Returns
-------
z : ndarray
    Zeros of the transformed high-pass filter transfer function.
p : ndarray
    Poles of the transformed high-pass filter transfer function.
k : float
    System gain of the transformed high-pass filter.

See Also
--------
lp2lp_zpk, lp2bp_zpk, lp2bs_zpk, bilinear
lp2hp

Notes
-----
This is derived from the s-plane substitution

.. math:: s \rightarrow \frac{\omega_0}{s}

This maintains symmetry of the lowpass and highpass responses on a
logarithmic scale.

.. versionadded:: 1.1.0</pre> <div class="fragment"><div class="line"><span class="lineno"> 2715</span><span class="keyword">def </span>lp2hp_zpk(z, p, k, wo=1.0):</div>
<div class="line"><span class="lineno"> 2716</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2717</span><span class="stringliteral">    Transform a lowpass filter prototype to a highpass filter.</span></div>
<div class="line"><span class="lineno"> 2718</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2719</span><span class="stringliteral">    Return an analog high-pass filter with cutoff frequency `wo`</span></div>
<div class="line"><span class="lineno"> 2720</span><span class="stringliteral">    from an analog low-pass filter prototype with unity cutoff frequency,</span></div>
<div class="line"><span class="lineno"> 2721</span><span class="stringliteral">    using zeros, poles, and gain (&#39;zpk&#39;) representation.</span></div>
<div class="line"><span class="lineno"> 2722</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2723</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2724</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2725</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno"> 2726</span><span class="stringliteral">        Zeros of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2727</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno"> 2728</span><span class="stringliteral">        Poles of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2729</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2730</span><span class="stringliteral">        System gain of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2731</span><span class="stringliteral">    wo : float</span></div>
<div class="line"><span class="lineno"> 2732</span><span class="stringliteral">        Desired cutoff, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 2733</span><span class="stringliteral">        Defaults to no change.</span></div>
<div class="line"><span class="lineno"> 2734</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2735</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2736</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2737</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 2738</span><span class="stringliteral">        Zeros of the transformed high-pass filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2739</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 2740</span><span class="stringliteral">        Poles of the transformed high-pass filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2741</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2742</span><span class="stringliteral">        System gain of the transformed high-pass filter.</span></div>
<div class="line"><span class="lineno"> 2743</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2744</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2745</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2746</span><span class="stringliteral">    lp2lp_zpk, lp2bp_zpk, lp2bs_zpk, bilinear</span></div>
<div class="line"><span class="lineno"> 2747</span><span class="stringliteral">    lp2hp</span></div>
<div class="line"><span class="lineno"> 2748</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2749</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2750</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2751</span><span class="stringliteral">    This is derived from the s-plane substitution</span></div>
<div class="line"><span class="lineno"> 2752</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2753</span><span class="stringliteral">    .. math:: s \rightarrow \frac{\omega_0}{s}</span></div>
<div class="line"><span class="lineno"> 2754</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2755</span><span class="stringliteral">    This maintains symmetry of the lowpass and highpass responses on a</span></div>
<div class="line"><span class="lineno"> 2756</span><span class="stringliteral">    logarithmic scale.</span></div>
<div class="line"><span class="lineno"> 2757</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2758</span><span class="stringliteral">    .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno"> 2759</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2760</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2761</span>    z = atleast_1d(z)</div>
<div class="line"><span class="lineno"> 2762</span>    p = atleast_1d(p)</div>
<div class="line"><span class="lineno"> 2763</span>    wo = float(wo)</div>
<div class="line"><span class="lineno"> 2764</span> </div>
<div class="line"><span class="lineno"> 2765</span>    degree = _relative_degree(z, p)</div>
<div class="line"><span class="lineno"> 2766</span> </div>
<div class="line"><span class="lineno"> 2767</span>    <span class="comment"># Invert positions radially about unit circle to convert LPF to HPF</span></div>
<div class="line"><span class="lineno"> 2768</span>    <span class="comment"># Scale all points radially from origin to shift cutoff frequency</span></div>
<div class="line"><span class="lineno"> 2769</span>    z_hp = wo / z</div>
<div class="line"><span class="lineno"> 2770</span>    p_hp = wo / p</div>
<div class="line"><span class="lineno"> 2771</span> </div>
<div class="line"><span class="lineno"> 2772</span>    <span class="comment"># If lowpass had zeros at infinity, inverting moves them to origin.</span></div>
<div class="line"><span class="lineno"> 2773</span>    z_hp = append(z_hp, zeros(degree))</div>
<div class="line"><span class="lineno"> 2774</span> </div>
<div class="line"><span class="lineno"> 2775</span>    <span class="comment"># Cancel out gain change caused by inversion</span></div>
<div class="line"><span class="lineno"> 2776</span>    k_hp = k * real(prod(-z) / prod(-p))</div>
<div class="line"><span class="lineno"> 2777</span> </div>
<div class="line"><span class="lineno"> 2778</span>    <span class="keywordflow">return</span> z_hp, p_hp, k_hp</div>
<div class="line"><span class="lineno"> 2779</span> </div>
<div class="line"><span class="lineno"> 2780</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acdb73944d070b0526aea89119ebcd64a" name="acdb73944d070b0526aea89119ebcd64a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdb73944d070b0526aea89119ebcd64a">&#9670;&#160;</a></span>lp2lp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.lp2lp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wo</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a lowpass filter prototype to a different frequency.

Return an analog low-pass filter with cutoff frequency `wo`
from an analog low-pass filter prototype with unity cutoff frequency, in
transfer function ('ba') representation.

Parameters
----------
b : array_like
    Numerator polynomial coefficients.
a : array_like
    Denominator polynomial coefficients.
wo : float
    Desired cutoff, as angular frequency (e.g. rad/s).
    Defaults to no change.

Returns
-------
b : array_like
    Numerator polynomial coefficients of the transformed low-pass filter.
a : array_like
    Denominator polynomial coefficients of the transformed low-pass filter.

See Also
--------
lp2hp, lp2bp, lp2bs, bilinear
lp2lp_zpk

Notes
-----
This is derived from the s-plane substitution

.. math:: s \rightarrow \frac{s}{\omega_0}

Examples
--------

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; lp = signal.lti([1.0], [1.0, 1.0])
&gt;&gt;&gt; lp2 = signal.lti(*signal.lp2lp(lp.num, lp.den, 2))
&gt;&gt;&gt; w, mag_lp, p_lp = lp.bode()
&gt;&gt;&gt; w, mag_lp2, p_lp2 = lp2.bode(w)

&gt;&gt;&gt; plt.plot(w, mag_lp, label='Lowpass')
&gt;&gt;&gt; plt.plot(w, mag_lp2, label='Transformed Lowpass')
&gt;&gt;&gt; plt.semilogx()
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.xlabel('Frequency [rad/s]')
&gt;&gt;&gt; plt.ylabel('Magnitude [dB]')
&gt;&gt;&gt; plt.legend()</pre> <div class="fragment"><div class="line"><span class="lineno"> 1723</span><span class="keyword">def </span>lp2lp(b, a, wo=1.0):</div>
<div class="line"><span class="lineno"> 1724</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1725</span><span class="stringliteral">    Transform a lowpass filter prototype to a different frequency.</span></div>
<div class="line"><span class="lineno"> 1726</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1727</span><span class="stringliteral">    Return an analog low-pass filter with cutoff frequency `wo`</span></div>
<div class="line"><span class="lineno"> 1728</span><span class="stringliteral">    from an analog low-pass filter prototype with unity cutoff frequency, in</span></div>
<div class="line"><span class="lineno"> 1729</span><span class="stringliteral">    transfer function (&#39;ba&#39;) representation.</span></div>
<div class="line"><span class="lineno"> 1730</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1731</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1732</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1733</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1734</span><span class="stringliteral">        Numerator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1735</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1736</span><span class="stringliteral">        Denominator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1737</span><span class="stringliteral">    wo : float</span></div>
<div class="line"><span class="lineno"> 1738</span><span class="stringliteral">        Desired cutoff, as angular frequency (e.g. rad/s).</span></div>
<div class="line"><span class="lineno"> 1739</span><span class="stringliteral">        Defaults to no change.</span></div>
<div class="line"><span class="lineno"> 1740</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1741</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1742</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1743</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1744</span><span class="stringliteral">        Numerator polynomial coefficients of the transformed low-pass filter.</span></div>
<div class="line"><span class="lineno"> 1745</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1746</span><span class="stringliteral">        Denominator polynomial coefficients of the transformed low-pass filter.</span></div>
<div class="line"><span class="lineno"> 1747</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1748</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1749</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1750</span><span class="stringliteral">    lp2hp, lp2bp, lp2bs, bilinear</span></div>
<div class="line"><span class="lineno"> 1751</span><span class="stringliteral">    lp2lp_zpk</span></div>
<div class="line"><span class="lineno"> 1752</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1753</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1754</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1755</span><span class="stringliteral">    This is derived from the s-plane substitution</span></div>
<div class="line"><span class="lineno"> 1756</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1757</span><span class="stringliteral">    .. math:: s \rightarrow \frac{s}{\omega_0}</span></div>
<div class="line"><span class="lineno"> 1758</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1759</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1760</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1761</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1762</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 1763</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno"> 1764</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1765</span><span class="stringliteral">    &gt;&gt;&gt; lp = signal.lti([1.0], [1.0, 1.0])</span></div>
<div class="line"><span class="lineno"> 1766</span><span class="stringliteral">    &gt;&gt;&gt; lp2 = signal.lti(*signal.lp2lp(lp.num, lp.den, 2))</span></div>
<div class="line"><span class="lineno"> 1767</span><span class="stringliteral">    &gt;&gt;&gt; w, mag_lp, p_lp = lp.bode()</span></div>
<div class="line"><span class="lineno"> 1768</span><span class="stringliteral">    &gt;&gt;&gt; w, mag_lp2, p_lp2 = lp2.bode(w)</span></div>
<div class="line"><span class="lineno"> 1769</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1770</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, mag_lp, label=&#39;Lowpass&#39;)</span></div>
<div class="line"><span class="lineno"> 1771</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w, mag_lp2, label=&#39;Transformed Lowpass&#39;)</span></div>
<div class="line"><span class="lineno"> 1772</span><span class="stringliteral">    &gt;&gt;&gt; plt.semilogx()</span></div>
<div class="line"><span class="lineno"> 1773</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno"> 1774</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Frequency [rad/s]&#39;)</span></div>
<div class="line"><span class="lineno"> 1775</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Magnitude [dB]&#39;)</span></div>
<div class="line"><span class="lineno"> 1776</span><span class="stringliteral">    &gt;&gt;&gt; plt.legend()</span></div>
<div class="line"><span class="lineno"> 1777</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1778</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1779</span>    a, b = map(atleast_1d, (a, b))</div>
<div class="line"><span class="lineno"> 1780</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1781</span>        wo = float(wo)</div>
<div class="line"><span class="lineno"> 1782</span>    <span class="keywordflow">except</span> TypeError:</div>
<div class="line"><span class="lineno"> 1783</span>        wo = float(wo[0])</div>
<div class="line"><span class="lineno"> 1784</span>    d = len(a)</div>
<div class="line"><span class="lineno"> 1785</span>    n = len(b)</div>
<div class="line"><span class="lineno"> 1786</span>    M = max((d, n))</div>
<div class="line"><span class="lineno"> 1787</span>    pwo = pow(wo, numpy.arange(M - 1, -1, -1))</div>
<div class="line"><span class="lineno"> 1788</span>    start1 = max((n - d, 0))</div>
<div class="line"><span class="lineno"> 1789</span>    start2 = max((d - n, 0))</div>
<div class="line"><span class="lineno"> 1790</span>    b = b * pwo[start1] / pwo[start2:]</div>
<div class="line"><span class="lineno"> 1791</span>    a = a * pwo[start1] / pwo[start1:]</div>
<div class="line"><span class="lineno"> 1792</span>    <span class="keywordflow">return</span> normalize(b, a)</div>
<div class="line"><span class="lineno"> 1793</span> </div>
<div class="line"><span class="lineno"> 1794</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afbc60fe8e91d4d924a667655144f7b3d" name="afbc60fe8e91d4d924a667655144f7b3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbc60fe8e91d4d924a667655144f7b3d">&#9670;&#160;</a></span>lp2lp_zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.lp2lp_zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wo</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a lowpass filter prototype to a different frequency.

Return an analog low-pass filter with cutoff frequency `wo`
from an analog low-pass filter prototype with unity cutoff frequency,
using zeros, poles, and gain ('zpk') representation.

Parameters
----------
z : array_like
    Zeros of the analog filter transfer function.
p : array_like
    Poles of the analog filter transfer function.
k : float
    System gain of the analog filter transfer function.
wo : float
    Desired cutoff, as angular frequency (e.g., rad/s).
    Defaults to no change.

Returns
-------
z : ndarray
    Zeros of the transformed low-pass filter transfer function.
p : ndarray
    Poles of the transformed low-pass filter transfer function.
k : float
    System gain of the transformed low-pass filter.

See Also
--------
lp2hp_zpk, lp2bp_zpk, lp2bs_zpk, bilinear
lp2lp

Notes
-----
This is derived from the s-plane substitution

.. math:: s \rightarrow \frac{s}{\omega_0}

.. versionadded:: 1.1.0</pre> <div class="fragment"><div class="line"><span class="lineno"> 2655</span><span class="keyword">def </span>lp2lp_zpk(z, p, k, wo=1.0):</div>
<div class="line"><span class="lineno"> 2656</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2657</span><span class="stringliteral">    Transform a lowpass filter prototype to a different frequency.</span></div>
<div class="line"><span class="lineno"> 2658</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2659</span><span class="stringliteral">    Return an analog low-pass filter with cutoff frequency `wo`</span></div>
<div class="line"><span class="lineno"> 2660</span><span class="stringliteral">    from an analog low-pass filter prototype with unity cutoff frequency,</span></div>
<div class="line"><span class="lineno"> 2661</span><span class="stringliteral">    using zeros, poles, and gain (&#39;zpk&#39;) representation.</span></div>
<div class="line"><span class="lineno"> 2662</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2663</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2664</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2665</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno"> 2666</span><span class="stringliteral">        Zeros of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2667</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno"> 2668</span><span class="stringliteral">        Poles of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2669</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2670</span><span class="stringliteral">        System gain of the analog filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2671</span><span class="stringliteral">    wo : float</span></div>
<div class="line"><span class="lineno"> 2672</span><span class="stringliteral">        Desired cutoff, as angular frequency (e.g., rad/s).</span></div>
<div class="line"><span class="lineno"> 2673</span><span class="stringliteral">        Defaults to no change.</span></div>
<div class="line"><span class="lineno"> 2674</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2675</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2676</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2677</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 2678</span><span class="stringliteral">        Zeros of the transformed low-pass filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2679</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 2680</span><span class="stringliteral">        Poles of the transformed low-pass filter transfer function.</span></div>
<div class="line"><span class="lineno"> 2681</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 2682</span><span class="stringliteral">        System gain of the transformed low-pass filter.</span></div>
<div class="line"><span class="lineno"> 2683</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2684</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 2685</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2686</span><span class="stringliteral">    lp2hp_zpk, lp2bp_zpk, lp2bs_zpk, bilinear</span></div>
<div class="line"><span class="lineno"> 2687</span><span class="stringliteral">    lp2lp</span></div>
<div class="line"><span class="lineno"> 2688</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2689</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2690</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2691</span><span class="stringliteral">    This is derived from the s-plane substitution</span></div>
<div class="line"><span class="lineno"> 2692</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2693</span><span class="stringliteral">    .. math:: s \rightarrow \frac{s}{\omega_0}</span></div>
<div class="line"><span class="lineno"> 2694</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2695</span><span class="stringliteral">    .. versionadded:: 1.1.0</span></div>
<div class="line"><span class="lineno"> 2696</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2697</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2698</span>    z = atleast_1d(z)</div>
<div class="line"><span class="lineno"> 2699</span>    p = atleast_1d(p)</div>
<div class="line"><span class="lineno"> 2700</span>    wo = float(wo)  <span class="comment"># Avoid int wraparound</span></div>
<div class="line"><span class="lineno"> 2701</span> </div>
<div class="line"><span class="lineno"> 2702</span>    degree = _relative_degree(z, p)</div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>    <span class="comment"># Scale all points radially from origin to shift cutoff frequency</span></div>
<div class="line"><span class="lineno"> 2705</span>    z_lp = wo * z</div>
<div class="line"><span class="lineno"> 2706</span>    p_lp = wo * p</div>
<div class="line"><span class="lineno"> 2707</span> </div>
<div class="line"><span class="lineno"> 2708</span>    <span class="comment"># Each shifted pole decreases gain by wo, each shifted zero increases it.</span></div>
<div class="line"><span class="lineno"> 2709</span>    <span class="comment"># Cancel out the net change to keep overall gain the same</span></div>
<div class="line"><span class="lineno"> 2710</span>    k_lp = k * wo**degree</div>
<div class="line"><span class="lineno"> 2711</span> </div>
<div class="line"><span class="lineno"> 2712</span>    <span class="keywordflow">return</span> z_lp, p_lp, k_lp</div>
<div class="line"><span class="lineno"> 2713</span> </div>
<div class="line"><span class="lineno"> 2714</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e93da165795ed541dd2fa129b781a35" name="a4e93da165795ed541dd2fa129b781a35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e93da165795ed541dd2fa129b781a35">&#9670;&#160;</a></span>maxflat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.maxflat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3571</span><span class="keyword">def </span>maxflat():</div>
<div class="line"><span class="lineno"> 3572</span>    <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 3573</span> </div>
<div class="line"><span class="lineno"> 3574</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a403f599e6854656425d2a6c393be2504" name="a403f599e6854656425d2a6c393be2504"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a403f599e6854656425d2a6c393be2504">&#9670;&#160;</a></span>normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.normalize </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Normalize numerator/denominator of a continuous-time transfer function.

If values of `b` are too close to 0, they are removed. In that case, a
BadCoefficients warning is emitted.

Parameters
----------
b: array_like
    Numerator of the transfer function. Can be a 2-D array to normalize
    multiple transfer functions.
a: array_like
    Denominator of the transfer function. At most 1-D.

Returns
-------
num: array
    The numerator of the normalized transfer function. At least a 1-D
    array. A 2-D array if the input `num` is a 2-D array.
den: 1-D array
    The denominator of the normalized transfer function.

Notes
-----
Coefficients for both the numerator and denominator should be specified in
descending exponent order (e.g., ``s^2 + 3s + 5`` would be represented as
``[1, 3, 5]``).
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1652</span><span class="keyword">def </span>normalize(b, a):</div>
<div class="line"><span class="lineno"> 1653</span>    <span class="stringliteral">&quot;&quot;&quot;Normalize numerator/denominator of a continuous-time transfer function.</span></div>
<div class="line"><span class="lineno"> 1654</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1655</span><span class="stringliteral">    If values of `b` are too close to 0, they are removed. In that case, a</span></div>
<div class="line"><span class="lineno"> 1656</span><span class="stringliteral">    BadCoefficients warning is emitted.</span></div>
<div class="line"><span class="lineno"> 1657</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1658</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1659</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1660</span><span class="stringliteral">    b: array_like</span></div>
<div class="line"><span class="lineno"> 1661</span><span class="stringliteral">        Numerator of the transfer function. Can be a 2-D array to normalize</span></div>
<div class="line"><span class="lineno"> 1662</span><span class="stringliteral">        multiple transfer functions.</span></div>
<div class="line"><span class="lineno"> 1663</span><span class="stringliteral">    a: array_like</span></div>
<div class="line"><span class="lineno"> 1664</span><span class="stringliteral">        Denominator of the transfer function. At most 1-D.</span></div>
<div class="line"><span class="lineno"> 1665</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1666</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1667</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1668</span><span class="stringliteral">    num: array</span></div>
<div class="line"><span class="lineno"> 1669</span><span class="stringliteral">        The numerator of the normalized transfer function. At least a 1-D</span></div>
<div class="line"><span class="lineno"> 1670</span><span class="stringliteral">        array. A 2-D array if the input `num` is a 2-D array.</span></div>
<div class="line"><span class="lineno"> 1671</span><span class="stringliteral">    den: 1-D array</span></div>
<div class="line"><span class="lineno"> 1672</span><span class="stringliteral">        The denominator of the normalized transfer function.</span></div>
<div class="line"><span class="lineno"> 1673</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1674</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1675</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1676</span><span class="stringliteral">    Coefficients for both the numerator and denominator should be specified in</span></div>
<div class="line"><span class="lineno"> 1677</span><span class="stringliteral">    descending exponent order (e.g., ``s^2 + 3s + 5`` would be represented as</span></div>
<div class="line"><span class="lineno"> 1678</span><span class="stringliteral">    ``[1, 3, 5]``).</span></div>
<div class="line"><span class="lineno"> 1679</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1680</span>    num, den = b, a</div>
<div class="line"><span class="lineno"> 1681</span> </div>
<div class="line"><span class="lineno"> 1682</span>    den = np.atleast_1d(den)</div>
<div class="line"><span class="lineno"> 1683</span>    num = np.atleast_2d(_align_nums(num))</div>
<div class="line"><span class="lineno"> 1684</span> </div>
<div class="line"><span class="lineno"> 1685</span>    <span class="keywordflow">if</span> den.ndim != 1:</div>
<div class="line"><span class="lineno"> 1686</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Denominator polynomial must be rank-1 array.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1687</span>    <span class="keywordflow">if</span> num.ndim &gt; 2:</div>
<div class="line"><span class="lineno"> 1688</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Numerator polynomial must be rank-1 or&quot;</span></div>
<div class="line"><span class="lineno"> 1689</span>                         <span class="stringliteral">&quot; rank-2 array.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1690</span>    <span class="keywordflow">if</span> np.all(den == 0):</div>
<div class="line"><span class="lineno"> 1691</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Denominator must have at least on nonzero element.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>    <span class="comment"># Trim leading zeros in denominator, leave at least one.</span></div>
<div class="line"><span class="lineno"> 1694</span>    den = np.trim_zeros(den, <span class="stringliteral">&#39;f&#39;</span>)</div>
<div class="line"><span class="lineno"> 1695</span> </div>
<div class="line"><span class="lineno"> 1696</span>    <span class="comment"># Normalize transfer function</span></div>
<div class="line"><span class="lineno"> 1697</span>    num, den = num / den[0], den / den[0]</div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span>    <span class="comment"># Count numerator columns that are all zero</span></div>
<div class="line"><span class="lineno"> 1700</span>    leading_zeros = 0</div>
<div class="line"><span class="lineno"> 1701</span>    <span class="keywordflow">for</span> col <span class="keywordflow">in</span> num.T:</div>
<div class="line"><span class="lineno"> 1702</span>        <span class="keywordflow">if</span> np.allclose(col, 0, atol=1e-14):</div>
<div class="line"><span class="lineno"> 1703</span>            leading_zeros += 1</div>
<div class="line"><span class="lineno"> 1704</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1705</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1706</span> </div>
<div class="line"><span class="lineno"> 1707</span>    <span class="comment"># Trim leading zeros of numerator</span></div>
<div class="line"><span class="lineno"> 1708</span>    <span class="keywordflow">if</span> leading_zeros &gt; 0:</div>
<div class="line"><span class="lineno"> 1709</span>        warnings.warn(<span class="stringliteral">&quot;Badly conditioned filter coefficients (numerator): the &quot;</span></div>
<div class="line"><span class="lineno"> 1710</span>                      <span class="stringliteral">&quot;results may be meaningless&quot;</span>, BadCoefficients)</div>
<div class="line"><span class="lineno"> 1711</span>        <span class="comment"># Make sure at least one column remains</span></div>
<div class="line"><span class="lineno"> 1712</span>        <span class="keywordflow">if</span> leading_zeros == num.shape[1]:</div>
<div class="line"><span class="lineno"> 1713</span>            leading_zeros -= 1</div>
<div class="line"><span class="lineno"> 1714</span>        num = num[:, leading_zeros:]</div>
<div class="line"><span class="lineno"> 1715</span> </div>
<div class="line"><span class="lineno"> 1716</span>    <span class="comment"># Squeeze first dimension if singular</span></div>
<div class="line"><span class="lineno"> 1717</span>    <span class="keywordflow">if</span> num.shape[0] == 1:</div>
<div class="line"><span class="lineno"> 1718</span>        num = num[0, :]</div>
<div class="line"><span class="lineno"> 1719</span> </div>
<div class="line"><span class="lineno"> 1720</span>    <span class="keywordflow">return</span> num, den</div>
<div class="line"><span class="lineno"> 1721</span> </div>
<div class="line"><span class="lineno"> 1722</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4b170e32f7fa6684c6c75c54fd0520d" name="ab4b170e32f7fa6684c6c75c54fd0520d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b170e32f7fa6684c6c75c54fd0520d">&#9670;&#160;</a></span>sos2tf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.sos2tf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return a single transfer function from a series of second-order sections

Parameters
----------
sos : array_like
    Array of second-order filter coefficients, must have shape
    ``(n_sections, 6)``. See `sosfilt` for the SOS filter format
    specification.

Returns
-------
b : ndarray
    Numerator polynomial coefficients.
a : ndarray
    Denominator polynomial coefficients.

Notes
-----
.. versionadded:: 0.16.0
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1191</span><span class="keyword">def </span>sos2tf(sos):</div>
<div class="line"><span class="lineno"> 1192</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1193</span><span class="stringliteral">    Return a single transfer function from a series of second-order sections</span></div>
<div class="line"><span class="lineno"> 1194</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1195</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1196</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1197</span><span class="stringliteral">    sos : array_like</span></div>
<div class="line"><span class="lineno"> 1198</span><span class="stringliteral">        Array of second-order filter coefficients, must have shape</span></div>
<div class="line"><span class="lineno"> 1199</span><span class="stringliteral">        ``(n_sections, 6)``. See `sosfilt` for the SOS filter format</span></div>
<div class="line"><span class="lineno"> 1200</span><span class="stringliteral">        specification.</span></div>
<div class="line"><span class="lineno"> 1201</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1202</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">    b : ndarray</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral">        Numerator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">    a : ndarray</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="stringliteral">        Denominator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1209</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1210</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1211</span><span class="stringliteral">    .. versionadded:: 0.16.0</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1213</span>    sos = np.asarray(sos)</div>
<div class="line"><span class="lineno"> 1214</span>    result_type = sos.dtype</div>
<div class="line"><span class="lineno"> 1215</span>    <span class="keywordflow">if</span> result_type.kind <span class="keywordflow">in</span> <span class="stringliteral">&#39;bui&#39;</span>:</div>
<div class="line"><span class="lineno"> 1216</span>        result_type = np.float64</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>    b = np.array([1], dtype=result_type)</div>
<div class="line"><span class="lineno"> 1219</span>    a = np.array([1], dtype=result_type)</div>
<div class="line"><span class="lineno"> 1220</span>    n_sections = sos.shape[0]</div>
<div class="line"><span class="lineno"> 1221</span>    <span class="keywordflow">for</span> section <span class="keywordflow">in</span> range(n_sections):</div>
<div class="line"><span class="lineno"> 1222</span>        b = np.polymul(b, sos[section, :3])</div>
<div class="line"><span class="lineno"> 1223</span>        a = np.polymul(a, sos[section, 3:])</div>
<div class="line"><span class="lineno"> 1224</span>    <span class="keywordflow">return</span> b, a</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa268051778baf0e9f10a285f6cfd412f" name="aa268051778baf0e9f10a285f6cfd412f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa268051778baf0e9f10a285f6cfd412f">&#9670;&#160;</a></span>sos2zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.sos2zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return zeros, poles, and gain of a series of second-order sections

Parameters
----------
sos : array_like
    Array of second-order filter coefficients, must have shape
    ``(n_sections, 6)``. See `sosfilt` for the SOS filter format
    specification.

Returns
-------
z : ndarray
    Zeros of the transfer function.
p : ndarray
    Poles of the transfer function.
k : float
    System gain.

Notes
-----
The number of zeros and poles returned will be ``n_sections * 2``
even if some of these are (effectively) zero.

.. versionadded:: 0.16.0
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1227</span><span class="keyword">def </span>sos2zpk(sos):</div>
<div class="line"><span class="lineno"> 1228</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1229</span><span class="stringliteral">    Return zeros, poles, and gain of a series of second-order sections</span></div>
<div class="line"><span class="lineno"> 1230</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1231</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1232</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1233</span><span class="stringliteral">    sos : array_like</span></div>
<div class="line"><span class="lineno"> 1234</span><span class="stringliteral">        Array of second-order filter coefficients, must have shape</span></div>
<div class="line"><span class="lineno"> 1235</span><span class="stringliteral">        ``(n_sections, 6)``. See `sosfilt` for the SOS filter format</span></div>
<div class="line"><span class="lineno"> 1236</span><span class="stringliteral">        specification.</span></div>
<div class="line"><span class="lineno"> 1237</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1238</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1239</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1240</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 1241</span><span class="stringliteral">        Zeros of the transfer function.</span></div>
<div class="line"><span class="lineno"> 1242</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 1243</span><span class="stringliteral">        Poles of the transfer function.</span></div>
<div class="line"><span class="lineno"> 1244</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 1245</span><span class="stringliteral">        System gain.</span></div>
<div class="line"><span class="lineno"> 1246</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1247</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1248</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1249</span><span class="stringliteral">    The number of zeros and poles returned will be ``n_sections * 2``</span></div>
<div class="line"><span class="lineno"> 1250</span><span class="stringliteral">    even if some of these are (effectively) zero.</span></div>
<div class="line"><span class="lineno"> 1251</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1252</span><span class="stringliteral">    .. versionadded:: 0.16.0</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1254</span>    sos = np.asarray(sos)</div>
<div class="line"><span class="lineno"> 1255</span>    n_sections = sos.shape[0]</div>
<div class="line"><span class="lineno"> 1256</span>    z = np.zeros(n_sections*2, np.complex128)</div>
<div class="line"><span class="lineno"> 1257</span>    p = np.zeros(n_sections*2, np.complex128)</div>
<div class="line"><span class="lineno"> 1258</span>    k = 1.</div>
<div class="line"><span class="lineno"> 1259</span>    <span class="keywordflow">for</span> section <span class="keywordflow">in</span> range(n_sections):</div>
<div class="line"><span class="lineno"> 1260</span>        zpk = tf2zpk(sos[section, :3], sos[section, 3:])</div>
<div class="line"><span class="lineno"> 1261</span>        z[2*section:2*section+len(zpk[0])] = zpk[0]</div>
<div class="line"><span class="lineno"> 1262</span>        p[2*section:2*section+len(zpk[1])] = zpk[1]</div>
<div class="line"><span class="lineno"> 1263</span>        k *= zpk[2]</div>
<div class="line"><span class="lineno"> 1264</span>    <span class="keywordflow">return</span> z, p, k</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aea4c4ed52a5437a54057fd7a094d1936" name="aea4c4ed52a5437a54057fd7a094d1936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea4c4ed52a5437a54057fd7a094d1936">&#9670;&#160;</a></span>sosfreqz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.sosfreqz </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>worN</em> = <code>512</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>whole</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fs</em> = <code>2*pi</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the frequency response of a digital filter in SOS format.

Given `sos`, an array with shape (n, 6) of second order sections of
a digital filter, compute the frequency response of the system function::

           B0(z)   B1(z)         B{n-1}(z)
    H(z) = ----- * ----- * ... * ---------
           A0(z)   A1(z)         A{n-1}(z)

for z = exp(omega*1j), where B{k}(z) and A{k}(z) are numerator and
denominator of the transfer function of the k-th second order section.

Parameters
----------
sos : array_like
    Array of second-order filter coefficients, must have shape
    ``(n_sections, 6)``. Each row corresponds to a second-order
    section, with the first three columns providing the numerator
    coefficients and the last three providing the denominator
    coefficients.
worN : {None, int, array_like}, optional
    If a single integer, then compute at that many frequencies (default is
    N=512).  Using a number that is fast for FFT computations can result
    in faster computations (see Notes of `freqz`).

    If an array_like, compute the response at the frequencies given (must
    be 1-D). These are in the same units as `fs`.
whole : bool, optional
    Normally, frequencies are computed from 0 to the Nyquist frequency,
    fs/2 (upper-half of unit-circle). If `whole` is True, compute
    frequencies from 0 to fs.
fs : float, optional
    The sampling frequency of the digital system. Defaults to 2*pi
    radians/sample (so w is from 0 to pi).

    .. versionadded:: 1.2.0

Returns
-------
w : ndarray
    The frequencies at which `h` was computed, in the same units as `fs`.
    By default, `w` is normalized to the range [0, pi) (radians/sample).
h : ndarray
    The frequency response, as complex numbers.

See Also
--------
freqz, sosfilt

Notes
-----
.. versionadded:: 0.19.0

Examples
--------
Design a 15th-order bandpass filter in SOS format.

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; sos = signal.ellip(15, 0.5, 60, (0.2, 0.4), btype='bandpass',
...                    output='sos')

Compute the frequency response at 1500 points from DC to Nyquist.

&gt;&gt;&gt; w, h = signal.sosfreqz(sos, worN=1500)

Plot the response.

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; plt.subplot(2, 1, 1)
&gt;&gt;&gt; db = 20*np.log10(np.maximum(np.abs(h), 1e-5))
&gt;&gt;&gt; plt.plot(w/np.pi, db)
&gt;&gt;&gt; plt.ylim(-75, 5)
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.yticks([0, -20, -40, -60])
&gt;&gt;&gt; plt.ylabel('Gain [dB]')
&gt;&gt;&gt; plt.title('Frequency Response')
&gt;&gt;&gt; plt.subplot(2, 1, 2)
&gt;&gt;&gt; plt.plot(w/np.pi, np.angle(h))
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.yticks([-np.pi, -0.5*np.pi, 0, 0.5*np.pi, np.pi],
...            [r'$-\pi$', r'$-\pi/2$', '0', r'$\pi/2$', r'$\pi$'])
&gt;&gt;&gt; plt.ylabel('Phase [rad]')
&gt;&gt;&gt; plt.xlabel('Normalized frequency (1.0 = Nyquist)')
&gt;&gt;&gt; plt.show()

If the same filter is implemented as a single transfer function,
numerical error corrupts the frequency response:

&gt;&gt;&gt; b, a = signal.ellip(15, 0.5, 60, (0.2, 0.4), btype='bandpass',
...                    output='ba')
&gt;&gt;&gt; w, h = signal.freqz(b, a, worN=1500)
&gt;&gt;&gt; plt.subplot(2, 1, 1)
&gt;&gt;&gt; db = 20*np.log10(np.maximum(np.abs(h), 1e-5))
&gt;&gt;&gt; plt.plot(w/np.pi, db)
&gt;&gt;&gt; plt.ylim(-75, 5)
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.yticks([0, -20, -40, -60])
&gt;&gt;&gt; plt.ylabel('Gain [dB]')
&gt;&gt;&gt; plt.title('Frequency Response')
&gt;&gt;&gt; plt.subplot(2, 1, 2)
&gt;&gt;&gt; plt.plot(w/np.pi, np.angle(h))
&gt;&gt;&gt; plt.grid(True)
&gt;&gt;&gt; plt.yticks([-np.pi, -0.5*np.pi, 0, 0.5*np.pi, np.pi],
...            [r'$-\pi$', r'$-\pi/2$', '0', r'$\pi/2$', r'$\pi$'])
&gt;&gt;&gt; plt.ylabel('Phase [rad]')
&gt;&gt;&gt; plt.xlabel('Normalized frequency (1.0 = Nyquist)')
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  724</span><span class="keyword">def </span>sosfreqz(sos, worN=512, whole=False, fs=2*pi):</div>
<div class="line"><span class="lineno">  725</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">    Compute the frequency response of a digital filter in SOS format.</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral">    Given `sos`, an array with shape (n, 6) of second order sections of</span></div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">    a digital filter, compute the frequency response of the system function::</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">               B0(z)   B1(z)         B{n-1}(z)</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">        H(z) = ----- * ----- * ... * ---------</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">               A0(z)   A1(z)         A{n-1}(z)</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">    for z = exp(omega*1j), where B{k}(z) and A{k}(z) are numerator and</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral">    denominator of the transfer function of the k-th second order section.</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">    sos : array_like</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">        Array of second-order filter coefficients, must have shape</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">        ``(n_sections, 6)``. Each row corresponds to a second-order</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">        section, with the first three columns providing the numerator</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">        coefficients and the last three providing the denominator</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral">        coefficients.</span></div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">    worN : {None, int, array_like}, optional</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral">        If a single integer, then compute at that many frequencies (default is</span></div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">        N=512).  Using a number that is fast for FFT computations can result</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral">        in faster computations (see Notes of `freqz`).</span></div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral">        If an array_like, compute the response at the frequencies given (must</span></div>
<div class="line"><span class="lineno">  752</span><span class="stringliteral">        be 1-D). These are in the same units as `fs`.</span></div>
<div class="line"><span class="lineno">  753</span><span class="stringliteral">    whole : bool, optional</span></div>
<div class="line"><span class="lineno">  754</span><span class="stringliteral">        Normally, frequencies are computed from 0 to the Nyquist frequency,</span></div>
<div class="line"><span class="lineno">  755</span><span class="stringliteral">        fs/2 (upper-half of unit-circle). If `whole` is True, compute</span></div>
<div class="line"><span class="lineno">  756</span><span class="stringliteral">        frequencies from 0 to fs.</span></div>
<div class="line"><span class="lineno">  757</span><span class="stringliteral">    fs : float, optional</span></div>
<div class="line"><span class="lineno">  758</span><span class="stringliteral">        The sampling frequency of the digital system. Defaults to 2*pi</span></div>
<div class="line"><span class="lineno">  759</span><span class="stringliteral">        radians/sample (so w is from 0 to pi).</span></div>
<div class="line"><span class="lineno">  760</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  761</span><span class="stringliteral">        .. versionadded:: 1.2.0</span></div>
<div class="line"><span class="lineno">  762</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  763</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  764</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  765</span><span class="stringliteral">    w : ndarray</span></div>
<div class="line"><span class="lineno">  766</span><span class="stringliteral">        The frequencies at which `h` was computed, in the same units as `fs`.</span></div>
<div class="line"><span class="lineno">  767</span><span class="stringliteral">        By default, `w` is normalized to the range [0, pi) (radians/sample).</span></div>
<div class="line"><span class="lineno">  768</span><span class="stringliteral">    h : ndarray</span></div>
<div class="line"><span class="lineno">  769</span><span class="stringliteral">        The frequency response, as complex numbers.</span></div>
<div class="line"><span class="lineno">  770</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  771</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  772</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  773</span><span class="stringliteral">    freqz, sosfilt</span></div>
<div class="line"><span class="lineno">  774</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  775</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  776</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  777</span><span class="stringliteral">    .. versionadded:: 0.19.0</span></div>
<div class="line"><span class="lineno">  778</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  779</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  780</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  781</span><span class="stringliteral">    Design a 15th-order bandpass filter in SOS format.</span></div>
<div class="line"><span class="lineno">  782</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  783</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno">  784</span><span class="stringliteral">    &gt;&gt;&gt; sos = signal.ellip(15, 0.5, 60, (0.2, 0.4), btype=&#39;bandpass&#39;,</span></div>
<div class="line"><span class="lineno">  785</span><span class="stringliteral">    ...                    output=&#39;sos&#39;)</span></div>
<div class="line"><span class="lineno">  786</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  787</span><span class="stringliteral">    Compute the frequency response at 1500 points from DC to Nyquist.</span></div>
<div class="line"><span class="lineno">  788</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  789</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.sosfreqz(sos, worN=1500)</span></div>
<div class="line"><span class="lineno">  790</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  791</span><span class="stringliteral">    Plot the response.</span></div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral">    &gt;&gt;&gt; plt.subplot(2, 1, 1)</span></div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral">    &gt;&gt;&gt; db = 20*np.log10(np.maximum(np.abs(h), 1e-5))</span></div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w/np.pi, db)</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylim(-75, 5)</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno">  799</span><span class="stringliteral">    &gt;&gt;&gt; plt.yticks([0, -20, -40, -60])</span></div>
<div class="line"><span class="lineno">  800</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Gain [dB]&#39;)</span></div>
<div class="line"><span class="lineno">  801</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Frequency Response&#39;)</span></div>
<div class="line"><span class="lineno">  802</span><span class="stringliteral">    &gt;&gt;&gt; plt.subplot(2, 1, 2)</span></div>
<div class="line"><span class="lineno">  803</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w/np.pi, np.angle(h))</span></div>
<div class="line"><span class="lineno">  804</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno">  805</span><span class="stringliteral">    &gt;&gt;&gt; plt.yticks([-np.pi, -0.5*np.pi, 0, 0.5*np.pi, np.pi],</span></div>
<div class="line"><span class="lineno">  806</span><span class="stringliteral">    ...            [r&#39;$-\pi$&#39;, r&#39;$-\pi/2$&#39;, &#39;0&#39;, r&#39;$\pi/2$&#39;, r&#39;$\pi$&#39;])</span></div>
<div class="line"><span class="lineno">  807</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Phase [rad]&#39;)</span></div>
<div class="line"><span class="lineno">  808</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Normalized frequency (1.0 = Nyquist)&#39;)</span></div>
<div class="line"><span class="lineno">  809</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  810</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  811</span><span class="stringliteral">    If the same filter is implemented as a single transfer function,</span></div>
<div class="line"><span class="lineno">  812</span><span class="stringliteral">    numerical error corrupts the frequency response:</span></div>
<div class="line"><span class="lineno">  813</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  814</span><span class="stringliteral">    &gt;&gt;&gt; b, a = signal.ellip(15, 0.5, 60, (0.2, 0.4), btype=&#39;bandpass&#39;,</span></div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral">    ...                    output=&#39;ba&#39;)</span></div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">    &gt;&gt;&gt; w, h = signal.freqz(b, a, worN=1500)</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral">    &gt;&gt;&gt; plt.subplot(2, 1, 1)</span></div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">    &gt;&gt;&gt; db = 20*np.log10(np.maximum(np.abs(h), 1e-5))</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w/np.pi, db)</span></div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylim(-75, 5)</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">    &gt;&gt;&gt; plt.yticks([0, -20, -40, -60])</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Gain [dB]&#39;)</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">    &gt;&gt;&gt; plt.title(&#39;Frequency Response&#39;)</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">    &gt;&gt;&gt; plt.subplot(2, 1, 2)</span></div>
<div class="line"><span class="lineno">  826</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(w/np.pi, np.angle(h))</span></div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral">    &gt;&gt;&gt; plt.grid(True)</span></div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral">    &gt;&gt;&gt; plt.yticks([-np.pi, -0.5*np.pi, 0, 0.5*np.pi, np.pi],</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">    ...            [r&#39;$-\pi$&#39;, r&#39;$-\pi/2$&#39;, &#39;0&#39;, r&#39;$\pi/2$&#39;, r&#39;$\pi$&#39;])</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(&#39;Phase [rad]&#39;)</span></div>
<div class="line"><span class="lineno">  831</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(&#39;Normalized frequency (1.0 = Nyquist)&#39;)</span></div>
<div class="line"><span class="lineno">  832</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  833</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  834</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>    sos, n_sections = _validate_sos(sos)</div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">if</span> n_sections == 0:</div>
<div class="line"><span class="lineno">  838</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Cannot compute frequencies with no sections&#39;</span>)</div>
<div class="line"><span class="lineno">  839</span>    h = 1.</div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">for</span> row <span class="keywordflow">in</span> sos:</div>
<div class="line"><span class="lineno">  841</span>        w, rowh = freqz(row[:3], row[3:], worN=worN, whole=whole, fs=fs)</div>
<div class="line"><span class="lineno">  842</span>        h *= rowh</div>
<div class="line"><span class="lineno">  843</span>    <span class="keywordflow">return</span> w, h</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2277b1b035aa3d8ad1e20b68ba03390" name="aa2277b1b035aa3d8ad1e20b68ba03390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2277b1b035aa3d8ad1e20b68ba03390">&#9670;&#160;</a></span>tf2sos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.tf2sos </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pairing</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return second-order sections from transfer function representation

Parameters
----------
b : array_like
    Numerator polynomial coefficients.
a : array_like
    Denominator polynomial coefficients.
pairing : {None, 'nearest', 'keep_odd', 'minimal'}, optional
    The method to use to combine pairs of poles and zeros into sections.
    See `zpk2sos` for information and restrictions on `pairing` and
    `analog` arguments.
analog : bool, optional
    If True, system is analog, otherwise discrete.

    .. versionadded:: 1.8.0

Returns
-------
sos : ndarray
    Array of second-order filter coefficients, with shape
    ``(n_sections, 6)``. See `sosfilt` for the SOS filter format
    specification.

See Also
--------
zpk2sos, sosfilt

Notes
-----
It is generally discouraged to convert from TF to SOS format, since doing
so usually will not improve numerical precision errors. Instead, consider
designing filters in ZPK format and converting directly to SOS. TF is
converted to SOS by first converting to ZPK format, then converting
ZPK to SOS.

.. versionadded:: 0.16.0
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1148</span><span class="keyword">def </span>tf2sos(b, a, pairing=None, *, analog=False):</div>
<div class="line"><span class="lineno"> 1149</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1150</span><span class="stringliteral">    Return second-order sections from transfer function representation</span></div>
<div class="line"><span class="lineno"> 1151</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1152</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1153</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1154</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1155</span><span class="stringliteral">        Numerator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1156</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1157</span><span class="stringliteral">        Denominator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1158</span><span class="stringliteral">    pairing : {None, &#39;nearest&#39;, &#39;keep_odd&#39;, &#39;minimal&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1159</span><span class="stringliteral">        The method to use to combine pairs of poles and zeros into sections.</span></div>
<div class="line"><span class="lineno"> 1160</span><span class="stringliteral">        See `zpk2sos` for information and restrictions on `pairing` and</span></div>
<div class="line"><span class="lineno"> 1161</span><span class="stringliteral">        `analog` arguments.</span></div>
<div class="line"><span class="lineno"> 1162</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 1163</span><span class="stringliteral">        If True, system is analog, otherwise discrete.</span></div>
<div class="line"><span class="lineno"> 1164</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1165</span><span class="stringliteral">        .. versionadded:: 1.8.0</span></div>
<div class="line"><span class="lineno"> 1166</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1167</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1168</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1169</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 1170</span><span class="stringliteral">        Array of second-order filter coefficients, with shape</span></div>
<div class="line"><span class="lineno"> 1171</span><span class="stringliteral">        ``(n_sections, 6)``. See `sosfilt` for the SOS filter format</span></div>
<div class="line"><span class="lineno"> 1172</span><span class="stringliteral">        specification.</span></div>
<div class="line"><span class="lineno"> 1173</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1174</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1175</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1176</span><span class="stringliteral">    zpk2sos, sosfilt</span></div>
<div class="line"><span class="lineno"> 1177</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1178</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1179</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1180</span><span class="stringliteral">    It is generally discouraged to convert from TF to SOS format, since doing</span></div>
<div class="line"><span class="lineno"> 1181</span><span class="stringliteral">    so usually will not improve numerical precision errors. Instead, consider</span></div>
<div class="line"><span class="lineno"> 1182</span><span class="stringliteral">    designing filters in ZPK format and converting directly to SOS. TF is</span></div>
<div class="line"><span class="lineno"> 1183</span><span class="stringliteral">    converted to SOS by first converting to ZPK format, then converting</span></div>
<div class="line"><span class="lineno"> 1184</span><span class="stringliteral">    ZPK to SOS.</span></div>
<div class="line"><span class="lineno"> 1185</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1186</span><span class="stringliteral">    .. versionadded:: 0.16.0</span></div>
<div class="line"><span class="lineno"> 1187</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1188</span>    <span class="keywordflow">return</span> zpk2sos(*tf2zpk(b, a), pairing=pairing, analog=analog)</div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afd8e35038fae8873d10b7f7be6b8ca8f" name="afd8e35038fae8873d10b7f7be6b8ca8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd8e35038fae8873d10b7f7be6b8ca8f">&#9670;&#160;</a></span>tf2zpk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.tf2zpk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return zero, pole, gain (z, p, k) representation from a numerator,
denominator representation of a linear filter.

Parameters
----------
b : array_like
    Numerator polynomial coefficients.
a : array_like
    Denominator polynomial coefficients.

Returns
-------
z : ndarray
    Zeros of the transfer function.
p : ndarray
    Poles of the transfer function.
k : float
    System gain.

Notes
-----
If some values of `b` are too close to 0, they are removed. In that case,
a BadCoefficients warning is emitted.

The `b` and `a` arrays are interpreted as coefficients for positive,
descending powers of the transfer function variable. So the inputs
:math:`b = [b_0, b_1, ..., b_M]` and :math:`a =[a_0, a_1, ..., a_N]`
can represent an analog filter of the form:

.. math::

    H(s) = \frac
    {b_0 s^M + b_1 s^{(M-1)} + \cdots + b_M}
    {a_0 s^N + a_1 s^{(N-1)} + \cdots + a_N}

or a discrete-time filter of the form:

.. math::

    H(z) = \frac
    {b_0 z^M + b_1 z^{(M-1)} + \cdots + b_M}
    {a_0 z^N + a_1 z^{(N-1)} + \cdots + a_N}

This "positive powers" form is found more commonly in controls
engineering. If `M` and `N` are equal (which is true for all filters
generated by the bilinear transform), then this happens to be equivalent
to the "negative powers" discrete-time form preferred in DSP:

.. math::

    H(z) = \frac
    {b_0 + b_1 z^{-1} + \cdots + b_M z^{-M}}
    {a_0 + a_1 z^{-1} + \cdots + a_N z^{-N}}

Although this is true for common filters, remember that this is not true
in the general case. If `M` and `N` are not equal, the discrete-time
transfer function coefficients must first be converted to the "positive
powers" form before finding the poles and zeros.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1018</span><span class="keyword">def </span>tf2zpk(b, a):</div>
<div class="line"><span class="lineno"> 1019</span>    <span class="stringliteral">r&quot;&quot;&quot;Return zero, pole, gain (z, p, k) representation from a numerator,</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral">    denominator representation of a linear filter.</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral">    b : array_like</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral">        Numerator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="stringliteral">    a : array_like</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="stringliteral">        Denominator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1028</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1029</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1030</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1031</span><span class="stringliteral">    z : ndarray</span></div>
<div class="line"><span class="lineno"> 1032</span><span class="stringliteral">        Zeros of the transfer function.</span></div>
<div class="line"><span class="lineno"> 1033</span><span class="stringliteral">    p : ndarray</span></div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral">        Poles of the transfer function.</span></div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral">        System gain.</span></div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1039</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1040</span><span class="stringliteral">    If some values of `b` are too close to 0, they are removed. In that case,</span></div>
<div class="line"><span class="lineno"> 1041</span><span class="stringliteral">    a BadCoefficients warning is emitted.</span></div>
<div class="line"><span class="lineno"> 1042</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1043</span><span class="stringliteral">    The `b` and `a` arrays are interpreted as coefficients for positive,</span></div>
<div class="line"><span class="lineno"> 1044</span><span class="stringliteral">    descending powers of the transfer function variable. So the inputs</span></div>
<div class="line"><span class="lineno"> 1045</span><span class="stringliteral">    :math:`b = [b_0, b_1, ..., b_M]` and :math:`a =[a_0, a_1, ..., a_N]`</span></div>
<div class="line"><span class="lineno"> 1046</span><span class="stringliteral">    can represent an analog filter of the form:</span></div>
<div class="line"><span class="lineno"> 1047</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1048</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral">        H(s) = \frac</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">        {b_0 s^M + b_1 s^{(M-1)} + \cdots + b_M}</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">        {a_0 s^N + a_1 s^{(N-1)} + \cdots + a_N}</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">    or a discrete-time filter of the form:</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">        H(z) = \frac</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral">        {b_0 z^M + b_1 z^{(M-1)} + \cdots + b_M}</span></div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral">        {a_0 z^N + a_1 z^{(N-1)} + \cdots + a_N}</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">    This &quot;positive powers&quot; form is found more commonly in controls</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral">    engineering. If `M` and `N` are equal (which is true for all filters</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral">    generated by the bilinear transform), then this happens to be equivalent</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral">    to the &quot;negative powers&quot; discrete-time form preferred in DSP:</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1067</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1069</span><span class="stringliteral">        H(z) = \frac</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="stringliteral">        {b_0 + b_1 z^{-1} + \cdots + b_M z^{-M}}</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="stringliteral">        {a_0 + a_1 z^{-1} + \cdots + a_N z^{-N}}</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1073</span><span class="stringliteral">    Although this is true for common filters, remember that this is not true</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral">    in the general case. If `M` and `N` are not equal, the discrete-time</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">    transfer function coefficients must first be converted to the &quot;positive</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">    powers&quot; form before finding the poles and zeros.</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1079</span>    b, a = normalize(b, a)</div>
<div class="line"><span class="lineno"> 1080</span>    b = (b + 0.0) / a[0]</div>
<div class="line"><span class="lineno"> 1081</span>    a = (a + 0.0) / a[0]</div>
<div class="line"><span class="lineno"> 1082</span>    k = b[0]</div>
<div class="line"><span class="lineno"> 1083</span>    b /= b[0]</div>
<div class="line"><span class="lineno"> 1084</span>    z = roots(b)</div>
<div class="line"><span class="lineno"> 1085</span>    p = roots(a)</div>
<div class="line"><span class="lineno"> 1086</span>    <span class="keywordflow">return</span> z, p, k</div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a63c5cc73d85694103d8943b59e3c3fe4" name="a63c5cc73d85694103d8943b59e3c3fe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63c5cc73d85694103d8943b59e3c3fe4">&#9670;&#160;</a></span>yulewalk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.yulewalk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3575</span><span class="keyword">def </span>yulewalk():</div>
<div class="line"><span class="lineno"> 3576</span>    <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 3577</span> </div>
<div class="line"><span class="lineno"> 3578</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acf8ebb77eeb16e01aa05afc46c9cbfce" name="acf8ebb77eeb16e01aa05afc46c9cbfce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf8ebb77eeb16e01aa05afc46c9cbfce">&#9670;&#160;</a></span>zpk2sos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.zpk2sos </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pairing</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>analog</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return second-order sections from zeros, poles, and gain of a system

Parameters
----------
z : array_like
    Zeros of the transfer function.
p : array_like
    Poles of the transfer function.
k : float
    System gain.
pairing : {None, 'nearest', 'keep_odd', 'minimal'}, optional
    The method to use to combine pairs of poles and zeros into sections.
    If analog is False and pairing is None, pairing is set to 'nearest';
    if analog is True, pairing must be 'minimal', and is set to that if
    it is None.
analog : bool, optional
    If True, system is analog, otherwise discrete.

    .. versionadded:: 1.8.0

Returns
-------
sos : ndarray
    Array of second-order filter coefficients, with shape
    ``(n_sections, 6)``. See `sosfilt` for the SOS filter format
    specification.

See Also
--------
sosfilt

Notes
-----
The algorithm used to convert ZPK to SOS format is designed to
minimize errors due to numerical precision issues. The pairing
algorithm attempts to minimize the peak gain of each biquadratic
section. This is done by pairing poles with the nearest zeros, starting
with the poles closest to the unit circle for discrete-time systems, and
poles closest to the imaginary axis for continuous-time systems.

``pairing='minimal'`` outputs may not be suitable for `sosfilt`,
and ``analog=True`` outputs will never be suitable for `sosfilt`.

*Algorithms*

The steps in the ``pairing='nearest'``, ``pairing='keep_odd'``,
and ``pairing='minimal'`` algorithms are mostly shared. The
``'nearest'`` algorithm attempts to minimize the peak gain, while
``'keep_odd'`` minimizes peak gain under the constraint that
odd-order systems should retain one section as first order.
``'minimal'`` is similar to ``'keep_odd'``, but no additional
poles or zeros are introduced

The algorithm steps are as follows:

As a pre-processing step for ``pairing='nearest'``,
``pairing='keep_odd'``, add poles or zeros to the origin as
necessary to obtain the same number of poles and zeros for
pairing.  If ``pairing == 'nearest'`` and there are an odd number
of poles, add an additional pole and a zero at the origin.

The following steps are then iterated over until no more poles or
zeros remain:

1. Take the (next remaining) pole (complex or real) closest to the
   unit circle (or imaginary axis, for ``analog=True``) to
   begin a new filter section.

2. If the pole is real and there are no other remaining real poles [#]_,
   add the closest real zero to the section and leave it as a first
   order section. Note that after this step we are guaranteed to be
   left with an even number of real poles, complex poles, real zeros,
   and complex zeros for subsequent pairing iterations.

3. Else:

    1. If the pole is complex and the zero is the only remaining real
       zero*, then pair the pole with the *next* closest zero
       (guaranteed to be complex). This is necessary to ensure that
       there will be a real zero remaining to eventually create a
       first-order section (thus keeping the odd order).

    2. Else pair the pole with the closest remaining zero (complex or
       real).

    3. Proceed to complete the second-order section by adding another
       pole and zero to the current pole and zero in the section:

        1. If the current pole and zero are both complex, add their
           conjugates.

        2. Else if the pole is complex and the zero is real, add the
           conjugate pole and the next closest real zero.

        3. Else if the pole is real and the zero is complex, add the
           conjugate zero and the real pole closest to those zeros.

        4. Else (we must have a real pole and real zero) add the next
           real pole closest to the unit circle, and then add the real
           zero closest to that pole.

.. [#] This conditional can only be met for specific odd-order inputs
       with the ``pairing = 'keep_odd'`` or ``'minimal'`` methods.

.. versionadded:: 0.16.0

Examples
--------

Design a 6th order low-pass elliptic digital filter for a system with a
sampling rate of 8000 Hz that has a pass-band corner frequency of
1000 Hz. The ripple in the pass-band should not exceed 0.087 dB, and
the attenuation in the stop-band should be at least 90 dB.

In the following call to `ellip`, we could use ``output='sos'``,
but for this example, we'll use ``output='zpk'``, and then convert
to SOS format with `zpk2sos`:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; z, p, k = signal.ellip(6, 0.087, 90, 1000/(0.5*8000), output='zpk')

Now convert to SOS format.

&gt;&gt;&gt; sos = signal.zpk2sos(z, p, k)

The coefficients of the numerators of the sections:

&gt;&gt;&gt; sos[:, :3]
array([[ 0.0014154 ,  0.00248707,  0.0014154 ],
       [ 1.        ,  0.72965193,  1.        ],
       [ 1.        ,  0.17594966,  1.        ]])

The symmetry in the coefficients occurs because all the zeros are on the
unit circle.

The coefficients of the denominators of the sections:

&gt;&gt;&gt; sos[:, 3:]
array([[ 1.        , -1.32543251,  0.46989499],
       [ 1.        , -1.26117915,  0.6262586 ],
       [ 1.        , -1.25707217,  0.86199667]])

The next example shows the effect of the `pairing` option.  We have a
system with three poles and three zeros, so the SOS array will have
shape (2, 6). The means there is, in effect, an extra pole and an extra
zero at the origin in the SOS representation.

&gt;&gt;&gt; z1 = np.array([-1, -0.5-0.5j, -0.5+0.5j])
&gt;&gt;&gt; p1 = np.array([0.75, 0.8+0.1j, 0.8-0.1j])

With ``pairing='nearest'`` (the default), we obtain

&gt;&gt;&gt; signal.zpk2sos(z1, p1, 1)
array([[ 1.  ,  1.  ,  0.5 ,  1.  , -0.75,  0.  ],
       [ 1.  ,  1.  ,  0.  ,  1.  , -1.6 ,  0.65]])

The first section has the zeros {-0.5-0.05j, -0.5+0.5j} and the poles
{0, 0.75}, and the second section has the zeros {-1, 0} and poles
{0.8+0.1j, 0.8-0.1j}. Note that the extra pole and zero at the origin
have been assigned to different sections.

With ``pairing='keep_odd'``, we obtain:

&gt;&gt;&gt; signal.zpk2sos(z1, p1, 1, pairing='keep_odd')
array([[ 1.  ,  1.  ,  0.  ,  1.  , -0.75,  0.  ],
       [ 1.  ,  1.  ,  0.5 ,  1.  , -1.6 ,  0.65]])

The extra pole and zero at the origin are in the same section.
The first section is, in effect, a first-order section.

With ``pairing='minimal'``, the first-order section doesn't have
the extra pole and zero at the origin:

&gt;&gt;&gt; signal.zpk2sos(z1, p1, 1, pairing='minimal')
array([[ 0.  ,  1.  ,  1.  ,  0.  ,  1.  , -0.75],
       [ 1.  ,  1.  ,  0.5 ,  1.  , -1.6 ,  0.65]])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1289</span><span class="keyword">def </span>zpk2sos(z, p, k, pairing=None, *, analog=False):</div>
<div class="line"><span class="lineno"> 1290</span>    <span class="stringliteral">&quot;&quot;&quot;Return second-order sections from zeros, poles, and gain of a system</span></div>
<div class="line"><span class="lineno"> 1291</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1292</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1293</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1294</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno"> 1295</span><span class="stringliteral">        Zeros of the transfer function.</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno"> 1297</span><span class="stringliteral">        Poles of the transfer function.</span></div>
<div class="line"><span class="lineno"> 1298</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 1299</span><span class="stringliteral">        System gain.</span></div>
<div class="line"><span class="lineno"> 1300</span><span class="stringliteral">    pairing : {None, &#39;nearest&#39;, &#39;keep_odd&#39;, &#39;minimal&#39;}, optional</span></div>
<div class="line"><span class="lineno"> 1301</span><span class="stringliteral">        The method to use to combine pairs of poles and zeros into sections.</span></div>
<div class="line"><span class="lineno"> 1302</span><span class="stringliteral">        If analog is False and pairing is None, pairing is set to &#39;nearest&#39;;</span></div>
<div class="line"><span class="lineno"> 1303</span><span class="stringliteral">        if analog is True, pairing must be &#39;minimal&#39;, and is set to that if</span></div>
<div class="line"><span class="lineno"> 1304</span><span class="stringliteral">        it is None.</span></div>
<div class="line"><span class="lineno"> 1305</span><span class="stringliteral">    analog : bool, optional</span></div>
<div class="line"><span class="lineno"> 1306</span><span class="stringliteral">        If True, system is analog, otherwise discrete.</span></div>
<div class="line"><span class="lineno"> 1307</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1308</span><span class="stringliteral">        .. versionadded:: 1.8.0</span></div>
<div class="line"><span class="lineno"> 1309</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1310</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1311</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1312</span><span class="stringliteral">    sos : ndarray</span></div>
<div class="line"><span class="lineno"> 1313</span><span class="stringliteral">        Array of second-order filter coefficients, with shape</span></div>
<div class="line"><span class="lineno"> 1314</span><span class="stringliteral">        ``(n_sections, 6)``. See `sosfilt` for the SOS filter format</span></div>
<div class="line"><span class="lineno"> 1315</span><span class="stringliteral">        specification.</span></div>
<div class="line"><span class="lineno"> 1316</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1317</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1318</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1319</span><span class="stringliteral">    sosfilt</span></div>
<div class="line"><span class="lineno"> 1320</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1321</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1323</span><span class="stringliteral">    The algorithm used to convert ZPK to SOS format is designed to</span></div>
<div class="line"><span class="lineno"> 1324</span><span class="stringliteral">    minimize errors due to numerical precision issues. The pairing</span></div>
<div class="line"><span class="lineno"> 1325</span><span class="stringliteral">    algorithm attempts to minimize the peak gain of each biquadratic</span></div>
<div class="line"><span class="lineno"> 1326</span><span class="stringliteral">    section. This is done by pairing poles with the nearest zeros, starting</span></div>
<div class="line"><span class="lineno"> 1327</span><span class="stringliteral">    with the poles closest to the unit circle for discrete-time systems, and</span></div>
<div class="line"><span class="lineno"> 1328</span><span class="stringliteral">    poles closest to the imaginary axis for continuous-time systems.</span></div>
<div class="line"><span class="lineno"> 1329</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1330</span><span class="stringliteral">    ``pairing=&#39;minimal&#39;`` outputs may not be suitable for `sosfilt`,</span></div>
<div class="line"><span class="lineno"> 1331</span><span class="stringliteral">    and ``analog=True`` outputs will never be suitable for `sosfilt`.</span></div>
<div class="line"><span class="lineno"> 1332</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1333</span><span class="stringliteral">    *Algorithms*</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1335</span><span class="stringliteral">    The steps in the ``pairing=&#39;nearest&#39;``, ``pairing=&#39;keep_odd&#39;``,</span></div>
<div class="line"><span class="lineno"> 1336</span><span class="stringliteral">    and ``pairing=&#39;minimal&#39;`` algorithms are mostly shared. The</span></div>
<div class="line"><span class="lineno"> 1337</span><span class="stringliteral">    ``&#39;nearest&#39;`` algorithm attempts to minimize the peak gain, while</span></div>
<div class="line"><span class="lineno"> 1338</span><span class="stringliteral">    ``&#39;keep_odd&#39;`` minimizes peak gain under the constraint that</span></div>
<div class="line"><span class="lineno"> 1339</span><span class="stringliteral">    odd-order systems should retain one section as first order.</span></div>
<div class="line"><span class="lineno"> 1340</span><span class="stringliteral">    ``&#39;minimal&#39;`` is similar to ``&#39;keep_odd&#39;``, but no additional</span></div>
<div class="line"><span class="lineno"> 1341</span><span class="stringliteral">    poles or zeros are introduced</span></div>
<div class="line"><span class="lineno"> 1342</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1343</span><span class="stringliteral">    The algorithm steps are as follows:</span></div>
<div class="line"><span class="lineno"> 1344</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1345</span><span class="stringliteral">    As a pre-processing step for ``pairing=&#39;nearest&#39;``,</span></div>
<div class="line"><span class="lineno"> 1346</span><span class="stringliteral">    ``pairing=&#39;keep_odd&#39;``, add poles or zeros to the origin as</span></div>
<div class="line"><span class="lineno"> 1347</span><span class="stringliteral">    necessary to obtain the same number of poles and zeros for</span></div>
<div class="line"><span class="lineno"> 1348</span><span class="stringliteral">    pairing.  If ``pairing == &#39;nearest&#39;`` and there are an odd number</span></div>
<div class="line"><span class="lineno"> 1349</span><span class="stringliteral">    of poles, add an additional pole and a zero at the origin.</span></div>
<div class="line"><span class="lineno"> 1350</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1351</span><span class="stringliteral">    The following steps are then iterated over until no more poles or</span></div>
<div class="line"><span class="lineno"> 1352</span><span class="stringliteral">    zeros remain:</span></div>
<div class="line"><span class="lineno"> 1353</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1354</span><span class="stringliteral">    1. Take the (next remaining) pole (complex or real) closest to the</span></div>
<div class="line"><span class="lineno"> 1355</span><span class="stringliteral">       unit circle (or imaginary axis, for ``analog=True``) to</span></div>
<div class="line"><span class="lineno"> 1356</span><span class="stringliteral">       begin a new filter section.</span></div>
<div class="line"><span class="lineno"> 1357</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1358</span><span class="stringliteral">    2. If the pole is real and there are no other remaining real poles [#]_,</span></div>
<div class="line"><span class="lineno"> 1359</span><span class="stringliteral">       add the closest real zero to the section and leave it as a first</span></div>
<div class="line"><span class="lineno"> 1360</span><span class="stringliteral">       order section. Note that after this step we are guaranteed to be</span></div>
<div class="line"><span class="lineno"> 1361</span><span class="stringliteral">       left with an even number of real poles, complex poles, real zeros,</span></div>
<div class="line"><span class="lineno"> 1362</span><span class="stringliteral">       and complex zeros for subsequent pairing iterations.</span></div>
<div class="line"><span class="lineno"> 1363</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1364</span><span class="stringliteral">    3. Else:</span></div>
<div class="line"><span class="lineno"> 1365</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1366</span><span class="stringliteral">        1. If the pole is complex and the zero is the only remaining real</span></div>
<div class="line"><span class="lineno"> 1367</span><span class="stringliteral">           zero*, then pair the pole with the *next* closest zero</span></div>
<div class="line"><span class="lineno"> 1368</span><span class="stringliteral">           (guaranteed to be complex). This is necessary to ensure that</span></div>
<div class="line"><span class="lineno"> 1369</span><span class="stringliteral">           there will be a real zero remaining to eventually create a</span></div>
<div class="line"><span class="lineno"> 1370</span><span class="stringliteral">           first-order section (thus keeping the odd order).</span></div>
<div class="line"><span class="lineno"> 1371</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1372</span><span class="stringliteral">        2. Else pair the pole with the closest remaining zero (complex or</span></div>
<div class="line"><span class="lineno"> 1373</span><span class="stringliteral">           real).</span></div>
<div class="line"><span class="lineno"> 1374</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1375</span><span class="stringliteral">        3. Proceed to complete the second-order section by adding another</span></div>
<div class="line"><span class="lineno"> 1376</span><span class="stringliteral">           pole and zero to the current pole and zero in the section:</span></div>
<div class="line"><span class="lineno"> 1377</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1378</span><span class="stringliteral">            1. If the current pole and zero are both complex, add their</span></div>
<div class="line"><span class="lineno"> 1379</span><span class="stringliteral">               conjugates.</span></div>
<div class="line"><span class="lineno"> 1380</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1381</span><span class="stringliteral">            2. Else if the pole is complex and the zero is real, add the</span></div>
<div class="line"><span class="lineno"> 1382</span><span class="stringliteral">               conjugate pole and the next closest real zero.</span></div>
<div class="line"><span class="lineno"> 1383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1384</span><span class="stringliteral">            3. Else if the pole is real and the zero is complex, add the</span></div>
<div class="line"><span class="lineno"> 1385</span><span class="stringliteral">               conjugate zero and the real pole closest to those zeros.</span></div>
<div class="line"><span class="lineno"> 1386</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1387</span><span class="stringliteral">            4. Else (we must have a real pole and real zero) add the next</span></div>
<div class="line"><span class="lineno"> 1388</span><span class="stringliteral">               real pole closest to the unit circle, and then add the real</span></div>
<div class="line"><span class="lineno"> 1389</span><span class="stringliteral">               zero closest to that pole.</span></div>
<div class="line"><span class="lineno"> 1390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1391</span><span class="stringliteral">    .. [#] This conditional can only be met for specific odd-order inputs</span></div>
<div class="line"><span class="lineno"> 1392</span><span class="stringliteral">           with the ``pairing = &#39;keep_odd&#39;`` or ``&#39;minimal&#39;`` methods.</span></div>
<div class="line"><span class="lineno"> 1393</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1394</span><span class="stringliteral">    .. versionadded:: 0.16.0</span></div>
<div class="line"><span class="lineno"> 1395</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1396</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1397</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1398</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1399</span><span class="stringliteral">    Design a 6th order low-pass elliptic digital filter for a system with a</span></div>
<div class="line"><span class="lineno"> 1400</span><span class="stringliteral">    sampling rate of 8000 Hz that has a pass-band corner frequency of</span></div>
<div class="line"><span class="lineno"> 1401</span><span class="stringliteral">    1000 Hz. The ripple in the pass-band should not exceed 0.087 dB, and</span></div>
<div class="line"><span class="lineno"> 1402</span><span class="stringliteral">    the attenuation in the stop-band should be at least 90 dB.</span></div>
<div class="line"><span class="lineno"> 1403</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1404</span><span class="stringliteral">    In the following call to `ellip`, we could use ``output=&#39;sos&#39;``,</span></div>
<div class="line"><span class="lineno"> 1405</span><span class="stringliteral">    but for this example, we&#39;ll use ``output=&#39;zpk&#39;``, and then convert</span></div>
<div class="line"><span class="lineno"> 1406</span><span class="stringliteral">    to SOS format with `zpk2sos`:</span></div>
<div class="line"><span class="lineno"> 1407</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1408</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import signal</span></div>
<div class="line"><span class="lineno"> 1409</span><span class="stringliteral">    &gt;&gt;&gt; z, p, k = signal.ellip(6, 0.087, 90, 1000/(0.5*8000), output=&#39;zpk&#39;)</span></div>
<div class="line"><span class="lineno"> 1410</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1411</span><span class="stringliteral">    Now convert to SOS format.</span></div>
<div class="line"><span class="lineno"> 1412</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1413</span><span class="stringliteral">    &gt;&gt;&gt; sos = signal.zpk2sos(z, p, k)</span></div>
<div class="line"><span class="lineno"> 1414</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1415</span><span class="stringliteral">    The coefficients of the numerators of the sections:</span></div>
<div class="line"><span class="lineno"> 1416</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1417</span><span class="stringliteral">    &gt;&gt;&gt; sos[:, :3]</span></div>
<div class="line"><span class="lineno"> 1418</span><span class="stringliteral">    array([[ 0.0014154 ,  0.00248707,  0.0014154 ],</span></div>
<div class="line"><span class="lineno"> 1419</span><span class="stringliteral">           [ 1.        ,  0.72965193,  1.        ],</span></div>
<div class="line"><span class="lineno"> 1420</span><span class="stringliteral">           [ 1.        ,  0.17594966,  1.        ]])</span></div>
<div class="line"><span class="lineno"> 1421</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1422</span><span class="stringliteral">    The symmetry in the coefficients occurs because all the zeros are on the</span></div>
<div class="line"><span class="lineno"> 1423</span><span class="stringliteral">    unit circle.</span></div>
<div class="line"><span class="lineno"> 1424</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1425</span><span class="stringliteral">    The coefficients of the denominators of the sections:</span></div>
<div class="line"><span class="lineno"> 1426</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1427</span><span class="stringliteral">    &gt;&gt;&gt; sos[:, 3:]</span></div>
<div class="line"><span class="lineno"> 1428</span><span class="stringliteral">    array([[ 1.        , -1.32543251,  0.46989499],</span></div>
<div class="line"><span class="lineno"> 1429</span><span class="stringliteral">           [ 1.        , -1.26117915,  0.6262586 ],</span></div>
<div class="line"><span class="lineno"> 1430</span><span class="stringliteral">           [ 1.        , -1.25707217,  0.86199667]])</span></div>
<div class="line"><span class="lineno"> 1431</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1432</span><span class="stringliteral">    The next example shows the effect of the `pairing` option.  We have a</span></div>
<div class="line"><span class="lineno"> 1433</span><span class="stringliteral">    system with three poles and three zeros, so the SOS array will have</span></div>
<div class="line"><span class="lineno"> 1434</span><span class="stringliteral">    shape (2, 6). The means there is, in effect, an extra pole and an extra</span></div>
<div class="line"><span class="lineno"> 1435</span><span class="stringliteral">    zero at the origin in the SOS representation.</span></div>
<div class="line"><span class="lineno"> 1436</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1437</span><span class="stringliteral">    &gt;&gt;&gt; z1 = np.array([-1, -0.5-0.5j, -0.5+0.5j])</span></div>
<div class="line"><span class="lineno"> 1438</span><span class="stringliteral">    &gt;&gt;&gt; p1 = np.array([0.75, 0.8+0.1j, 0.8-0.1j])</span></div>
<div class="line"><span class="lineno"> 1439</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1440</span><span class="stringliteral">    With ``pairing=&#39;nearest&#39;`` (the default), we obtain</span></div>
<div class="line"><span class="lineno"> 1441</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1442</span><span class="stringliteral">    &gt;&gt;&gt; signal.zpk2sos(z1, p1, 1)</span></div>
<div class="line"><span class="lineno"> 1443</span><span class="stringliteral">    array([[ 1.  ,  1.  ,  0.5 ,  1.  , -0.75,  0.  ],</span></div>
<div class="line"><span class="lineno"> 1444</span><span class="stringliteral">           [ 1.  ,  1.  ,  0.  ,  1.  , -1.6 ,  0.65]])</span></div>
<div class="line"><span class="lineno"> 1445</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1446</span><span class="stringliteral">    The first section has the zeros {-0.5-0.05j, -0.5+0.5j} and the poles</span></div>
<div class="line"><span class="lineno"> 1447</span><span class="stringliteral">    {0, 0.75}, and the second section has the zeros {-1, 0} and poles</span></div>
<div class="line"><span class="lineno"> 1448</span><span class="stringliteral">    {0.8+0.1j, 0.8-0.1j}. Note that the extra pole and zero at the origin</span></div>
<div class="line"><span class="lineno"> 1449</span><span class="stringliteral">    have been assigned to different sections.</span></div>
<div class="line"><span class="lineno"> 1450</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1451</span><span class="stringliteral">    With ``pairing=&#39;keep_odd&#39;``, we obtain:</span></div>
<div class="line"><span class="lineno"> 1452</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1453</span><span class="stringliteral">    &gt;&gt;&gt; signal.zpk2sos(z1, p1, 1, pairing=&#39;keep_odd&#39;)</span></div>
<div class="line"><span class="lineno"> 1454</span><span class="stringliteral">    array([[ 1.  ,  1.  ,  0.  ,  1.  , -0.75,  0.  ],</span></div>
<div class="line"><span class="lineno"> 1455</span><span class="stringliteral">           [ 1.  ,  1.  ,  0.5 ,  1.  , -1.6 ,  0.65]])</span></div>
<div class="line"><span class="lineno"> 1456</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1457</span><span class="stringliteral">    The extra pole and zero at the origin are in the same section.</span></div>
<div class="line"><span class="lineno"> 1458</span><span class="stringliteral">    The first section is, in effect, a first-order section.</span></div>
<div class="line"><span class="lineno"> 1459</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1460</span><span class="stringliteral">    With ``pairing=&#39;minimal&#39;``, the first-order section doesn&#39;t have</span></div>
<div class="line"><span class="lineno"> 1461</span><span class="stringliteral">    the extra pole and zero at the origin:</span></div>
<div class="line"><span class="lineno"> 1462</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1463</span><span class="stringliteral">    &gt;&gt;&gt; signal.zpk2sos(z1, p1, 1, pairing=&#39;minimal&#39;)</span></div>
<div class="line"><span class="lineno"> 1464</span><span class="stringliteral">    array([[ 0.  ,  1.  ,  1.  ,  0.  ,  1.  , -0.75],</span></div>
<div class="line"><span class="lineno"> 1465</span><span class="stringliteral">           [ 1.  ,  1.  ,  0.5 ,  1.  , -1.6 ,  0.65]])</span></div>
<div class="line"><span class="lineno"> 1466</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1467</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1468</span>    <span class="comment"># TODO in the near future:</span></div>
<div class="line"><span class="lineno"> 1469</span>    <span class="comment"># 1. Add SOS capability to `filtfilt`, `freqz`, etc. somehow (#3259).</span></div>
<div class="line"><span class="lineno"> 1470</span>    <span class="comment"># 2. Make `decimate` use `sosfilt` instead of `lfilter`.</span></div>
<div class="line"><span class="lineno"> 1471</span>    <span class="comment"># 3. Make sosfilt automatically simplify sections to first order</span></div>
<div class="line"><span class="lineno"> 1472</span>    <span class="comment">#    when possible. Note this might make `sosfiltfilt` a bit harder (ICs).</span></div>
<div class="line"><span class="lineno"> 1473</span>    <span class="comment"># 4. Further optimizations of the section ordering / pole-zero pairing.</span></div>
<div class="line"><span class="lineno"> 1474</span>    <span class="comment"># See the wiki for other potential issues.</span></div>
<div class="line"><span class="lineno"> 1475</span> </div>
<div class="line"><span class="lineno"> 1476</span>    <span class="keywordflow">if</span> pairing <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1477</span>        pairing = <span class="stringliteral">&#39;minimal&#39;</span> <span class="keywordflow">if</span> analog <span class="keywordflow">else</span> <span class="stringliteral">&#39;nearest&#39;</span></div>
<div class="line"><span class="lineno"> 1478</span> </div>
<div class="line"><span class="lineno"> 1479</span>    valid_pairings = [<span class="stringliteral">&#39;nearest&#39;</span>, <span class="stringliteral">&#39;keep_odd&#39;</span>, <span class="stringliteral">&#39;minimal&#39;</span>]</div>
<div class="line"><span class="lineno"> 1480</span>    <span class="keywordflow">if</span> pairing <span class="keywordflow">not</span> <span class="keywordflow">in</span> valid_pairings:</div>
<div class="line"><span class="lineno"> 1481</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;pairing must be one of %s, not %s&#39;</span></div>
<div class="line"><span class="lineno"> 1482</span>                         % (valid_pairings, pairing))</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>    <span class="keywordflow">if</span> analog <span class="keywordflow">and</span> pairing != <span class="stringliteral">&#39;minimal&#39;</span>:</div>
<div class="line"><span class="lineno"> 1485</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;for analog zpk2sos conversion, &#39;</span></div>
<div class="line"><span class="lineno"> 1486</span>                         <span class="stringliteral">&#39;pairing must be &quot;minimal&quot;&#39;</span>)</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>    <span class="keywordflow">if</span> len(z) == len(p) == 0:</div>
<div class="line"><span class="lineno"> 1489</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 1490</span>            <span class="keywordflow">return</span> np.array([[k, 0., 0., 1., 0., 0.]])</div>
<div class="line"><span class="lineno"> 1491</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1492</span>            <span class="keywordflow">return</span> np.array([[0., 0., k, 0., 0., 1.]])</div>
<div class="line"><span class="lineno"> 1493</span> </div>
<div class="line"><span class="lineno"> 1494</span>    <span class="keywordflow">if</span> pairing != <span class="stringliteral">&#39;minimal&#39;</span>:</div>
<div class="line"><span class="lineno"> 1495</span>        <span class="comment"># ensure we have the same number of poles and zeros, and make copies</span></div>
<div class="line"><span class="lineno"> 1496</span>        p = np.concatenate((p, np.zeros(max(len(z) - len(p), 0))))</div>
<div class="line"><span class="lineno"> 1497</span>        z = np.concatenate((z, np.zeros(max(len(p) - len(z), 0))))</div>
<div class="line"><span class="lineno"> 1498</span>        n_sections = (max(len(p), len(z)) + 1) // 2</div>
<div class="line"><span class="lineno"> 1499</span> </div>
<div class="line"><span class="lineno"> 1500</span>        <span class="keywordflow">if</span> len(p) % 2 == 1 <span class="keywordflow">and</span> pairing == <span class="stringliteral">&#39;nearest&#39;</span>:</div>
<div class="line"><span class="lineno"> 1501</span>            p = np.concatenate((p, [0.]))</div>
<div class="line"><span class="lineno"> 1502</span>            z = np.concatenate((z, [0.]))</div>
<div class="line"><span class="lineno"> 1503</span>        <span class="keyword">assert</span> len(p) == len(z)</div>
<div class="line"><span class="lineno"> 1504</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1505</span>        <span class="keywordflow">if</span> len(p) &lt; len(z):</div>
<div class="line"><span class="lineno"> 1506</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;for analog zpk2sos conversion, &#39;</span></div>
<div class="line"><span class="lineno"> 1507</span>                             <span class="stringliteral">&#39;must have len(p)&gt;=len(z)&#39;</span>)</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span>        n_sections = (len(p) + 1) // 2</div>
<div class="line"><span class="lineno"> 1510</span> </div>
<div class="line"><span class="lineno"> 1511</span>    <span class="comment"># Ensure we have complex conjugate pairs</span></div>
<div class="line"><span class="lineno"> 1512</span>    <span class="comment"># (note that _cplxreal only gives us one element of each complex pair):</span></div>
<div class="line"><span class="lineno"> 1513</span>    z = np.concatenate(_cplxreal(z))</div>
<div class="line"><span class="lineno"> 1514</span>    p = np.concatenate(_cplxreal(p))</div>
<div class="line"><span class="lineno"> 1515</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isreal(k):</div>
<div class="line"><span class="lineno"> 1516</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;k must be real&#39;</span>)</div>
<div class="line"><span class="lineno"> 1517</span>    k = k.real</div>
<div class="line"><span class="lineno"> 1518</span> </div>
<div class="line"><span class="lineno"> 1519</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> analog:</div>
<div class="line"><span class="lineno"> 1520</span>        <span class="comment"># digital: &quot;worst&quot; is the closest to the unit circle</span></div>
<div class="line"><span class="lineno"> 1521</span>        <span class="keyword">def </span>idx_worst(p):</div>
<div class="line"><span class="lineno"> 1522</span>            <span class="keywordflow">return</span> np.argmin(np.abs(1 - np.abs(p)))</div>
<div class="line"><span class="lineno"> 1523</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1524</span>        <span class="comment"># analog: &quot;worst&quot; is the closest to the imaginary axis</span></div>
<div class="line"><span class="lineno"> 1525</span>        <span class="keyword">def </span>idx_worst(p):</div>
<div class="line"><span class="lineno"> 1526</span>            <span class="keywordflow">return</span> np.argmin(np.abs(np.real(p)))</div>
<div class="line"><span class="lineno"> 1527</span> </div>
<div class="line"><span class="lineno"> 1528</span>    sos = np.zeros((n_sections, 6))</div>
<div class="line"><span class="lineno"> 1529</span> </div>
<div class="line"><span class="lineno"> 1530</span>    <span class="comment"># Construct the system, reversing order so the &quot;worst&quot; are last</span></div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordflow">for</span> si <span class="keywordflow">in</span> range(n_sections-1, -1, -1):</div>
<div class="line"><span class="lineno"> 1532</span>        <span class="comment"># Select the next &quot;worst&quot; pole</span></div>
<div class="line"><span class="lineno"> 1533</span>        p1_idx = idx_worst(p)</div>
<div class="line"><span class="lineno"> 1534</span>        p1 = p[p1_idx]</div>
<div class="line"><span class="lineno"> 1535</span>        p = np.delete(p, p1_idx)</div>
<div class="line"><span class="lineno"> 1536</span> </div>
<div class="line"><span class="lineno"> 1537</span>        <span class="comment"># Pair that pole with a zero</span></div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>        <span class="keywordflow">if</span> np.isreal(p1) <span class="keywordflow">and</span> np.isreal(p).sum() == 0:</div>
<div class="line"><span class="lineno"> 1540</span>            <span class="comment"># Special case (1): last remaining real pole</span></div>
<div class="line"><span class="lineno"> 1541</span>            <span class="keywordflow">if</span> pairing != <span class="stringliteral">&#39;minimal&#39;</span>:</div>
<div class="line"><span class="lineno"> 1542</span>                z1_idx = _nearest_real_complex_idx(z, p1, <span class="stringliteral">&#39;real&#39;</span>)</div>
<div class="line"><span class="lineno"> 1543</span>                z1 = z[z1_idx]</div>
<div class="line"><span class="lineno"> 1544</span>                z = np.delete(z, z1_idx)</div>
<div class="line"><span class="lineno"> 1545</span>                sos[si] = _single_zpksos([z1, 0], [p1, 0], 1)</div>
<div class="line"><span class="lineno"> 1546</span>            <span class="keywordflow">elif</span> len(z) &gt; 0:</div>
<div class="line"><span class="lineno"> 1547</span>                z1_idx = _nearest_real_complex_idx(z, p1, <span class="stringliteral">&#39;real&#39;</span>)</div>
<div class="line"><span class="lineno"> 1548</span>                z1 = z[z1_idx]</div>
<div class="line"><span class="lineno"> 1549</span>                z = np.delete(z, z1_idx)</div>
<div class="line"><span class="lineno"> 1550</span>                sos[si] = _single_zpksos([z1], [p1], 1)</div>
<div class="line"><span class="lineno"> 1551</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1552</span>                sos[si] = _single_zpksos([], [p1], 1)</div>
<div class="line"><span class="lineno"> 1553</span> </div>
<div class="line"><span class="lineno"> 1554</span>        <span class="keywordflow">elif</span> (len(p) + 1 == len(z)</div>
<div class="line"><span class="lineno"> 1555</span>              <span class="keywordflow">and</span> <span class="keywordflow">not</span> np.isreal(p1)</div>
<div class="line"><span class="lineno"> 1556</span>              <span class="keywordflow">and</span> np.isreal(p).sum() == 1</div>
<div class="line"><span class="lineno"> 1557</span>              <span class="keywordflow">and</span> np.isreal(z).sum() == 1):</div>
<div class="line"><span class="lineno"> 1558</span> </div>
<div class="line"><span class="lineno"> 1559</span>            <span class="comment"># Special case (2): there&#39;s one real pole and one real zero</span></div>
<div class="line"><span class="lineno"> 1560</span>            <span class="comment"># left, and an equal number of poles and zeros to pair up.</span></div>
<div class="line"><span class="lineno"> 1561</span>            <span class="comment"># We *must* pair with a complex zero</span></div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>            z1_idx = _nearest_real_complex_idx(z, p1, <span class="stringliteral">&#39;complex&#39;</span>)</div>
<div class="line"><span class="lineno"> 1564</span>            z1 = z[z1_idx]</div>
<div class="line"><span class="lineno"> 1565</span>            z = np.delete(z, z1_idx)</div>
<div class="line"><span class="lineno"> 1566</span>            sos[si] = _single_zpksos([z1, z1.conj()], [p1, p1.conj()], 1)</div>
<div class="line"><span class="lineno"> 1567</span> </div>
<div class="line"><span class="lineno"> 1568</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1569</span>            <span class="keywordflow">if</span> np.isreal(p1):</div>
<div class="line"><span class="lineno"> 1570</span>                prealidx = np.flatnonzero(np.isreal(p))</div>
<div class="line"><span class="lineno"> 1571</span>                p2_idx = prealidx[idx_worst(p[prealidx])]</div>
<div class="line"><span class="lineno"> 1572</span>                p2 = p[p2_idx]</div>
<div class="line"><span class="lineno"> 1573</span>                p = np.delete(p, p2_idx)</div>
<div class="line"><span class="lineno"> 1574</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1575</span>                p2 = p1.conj()</div>
<div class="line"><span class="lineno"> 1576</span> </div>
<div class="line"><span class="lineno"> 1577</span>            <span class="comment"># find closest zero</span></div>
<div class="line"><span class="lineno"> 1578</span>            <span class="keywordflow">if</span> len(z) &gt; 0:</div>
<div class="line"><span class="lineno"> 1579</span>                z1_idx = _nearest_real_complex_idx(z, p1, <span class="stringliteral">&#39;any&#39;</span>)</div>
<div class="line"><span class="lineno"> 1580</span>                z1 = z[z1_idx]</div>
<div class="line"><span class="lineno"> 1581</span>                z = np.delete(z, z1_idx)</div>
<div class="line"><span class="lineno"> 1582</span> </div>
<div class="line"><span class="lineno"> 1583</span>                <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isreal(z1):</div>
<div class="line"><span class="lineno"> 1584</span>                    sos[si] = _single_zpksos([z1, z1.conj()], [p1, p2], 1)</div>
<div class="line"><span class="lineno"> 1585</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1586</span>                    <span class="keywordflow">if</span> len(z) &gt; 0:</div>
<div class="line"><span class="lineno"> 1587</span>                        z2_idx = _nearest_real_complex_idx(z, p1, <span class="stringliteral">&#39;real&#39;</span>)</div>
<div class="line"><span class="lineno"> 1588</span>                        z2 = z[z2_idx]</div>
<div class="line"><span class="lineno"> 1589</span>                        <span class="keyword">assert</span> np.isreal(z2)</div>
<div class="line"><span class="lineno"> 1590</span>                        z = np.delete(z, z2_idx)</div>
<div class="line"><span class="lineno"> 1591</span>                        sos[si] = _single_zpksos([z1, z2], [p1, p2], 1)</div>
<div class="line"><span class="lineno"> 1592</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1593</span>                        sos[si] = _single_zpksos([z1], [p1, p2], 1)</div>
<div class="line"><span class="lineno"> 1594</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1595</span>                <span class="comment"># no more zeros</span></div>
<div class="line"><span class="lineno"> 1596</span>                sos[si] = _single_zpksos([], [p1, p2], 1)</div>
<div class="line"><span class="lineno"> 1597</span> </div>
<div class="line"><span class="lineno"> 1598</span>    <span class="keyword">assert</span> len(p) == len(z) == 0  <span class="comment"># we&#39;ve consumed all poles and zeros</span></div>
<div class="line"><span class="lineno"> 1599</span>    del p, z</div>
<div class="line"><span class="lineno"> 1600</span> </div>
<div class="line"><span class="lineno"> 1601</span>    <span class="comment"># put gain in first sos</span></div>
<div class="line"><span class="lineno"> 1602</span>    sos[0][:3] *= k</div>
<div class="line"><span class="lineno"> 1603</span>    <span class="keywordflow">return</span> sos</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bf4baf8dc505f8b2ef88845ec55d645" name="a3bf4baf8dc505f8b2ef88845ec55d645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bf4baf8dc505f8b2ef88845ec55d645">&#9670;&#160;</a></span>zpk2tf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.zpk2tf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return polynomial transfer function representation from zeros and poles

Parameters
----------
z : array_like
    Zeros of the transfer function.
p : array_like
    Poles of the transfer function.
k : float
    System gain.

Returns
-------
b : ndarray
    Numerator polynomial coefficients.
a : ndarray
    Denominator polynomial coefficients.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1089</span><span class="keyword">def </span>zpk2tf(z, p, k):</div>
<div class="line"><span class="lineno"> 1090</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1091</span><span class="stringliteral">    Return polynomial transfer function representation from zeros and poles</span></div>
<div class="line"><span class="lineno"> 1092</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1093</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1094</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1095</span><span class="stringliteral">    z : array_like</span></div>
<div class="line"><span class="lineno"> 1096</span><span class="stringliteral">        Zeros of the transfer function.</span></div>
<div class="line"><span class="lineno"> 1097</span><span class="stringliteral">    p : array_like</span></div>
<div class="line"><span class="lineno"> 1098</span><span class="stringliteral">        Poles of the transfer function.</span></div>
<div class="line"><span class="lineno"> 1099</span><span class="stringliteral">    k : float</span></div>
<div class="line"><span class="lineno"> 1100</span><span class="stringliteral">        System gain.</span></div>
<div class="line"><span class="lineno"> 1101</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1102</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1103</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1104</span><span class="stringliteral">    b : ndarray</span></div>
<div class="line"><span class="lineno"> 1105</span><span class="stringliteral">        Numerator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1106</span><span class="stringliteral">    a : ndarray</span></div>
<div class="line"><span class="lineno"> 1107</span><span class="stringliteral">        Denominator polynomial coefficients.</span></div>
<div class="line"><span class="lineno"> 1108</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1109</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1110</span>    z = atleast_1d(z)</div>
<div class="line"><span class="lineno"> 1111</span>    k = atleast_1d(k)</div>
<div class="line"><span class="lineno"> 1112</span>    <span class="keywordflow">if</span> len(z.shape) &gt; 1:</div>
<div class="line"><span class="lineno"> 1113</span>        temp = poly(z[0])</div>
<div class="line"><span class="lineno"> 1114</span>        b = np.empty((z.shape[0], z.shape[1] + 1), temp.dtype.char)</div>
<div class="line"><span class="lineno"> 1115</span>        <span class="keywordflow">if</span> len(k) == 1:</div>
<div class="line"><span class="lineno"> 1116</span>            k = [k[0]] * z.shape[0]</div>
<div class="line"><span class="lineno"> 1117</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(z.shape[0]):</div>
<div class="line"><span class="lineno"> 1118</span>            b[i] = k[i] * poly(z[i])</div>
<div class="line"><span class="lineno"> 1119</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1120</span>        b = k * poly(z)</div>
<div class="line"><span class="lineno"> 1121</span>    a = atleast_1d(poly(p))</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>    <span class="comment"># Use real output if possible. Copied from numpy.poly, since</span></div>
<div class="line"><span class="lineno"> 1124</span>    <span class="comment"># we can&#39;t depend on a specific version of numpy.</span></div>
<div class="line"><span class="lineno"> 1125</span>    <span class="keywordflow">if</span> issubclass(b.dtype.type, numpy.complexfloating):</div>
<div class="line"><span class="lineno"> 1126</span>        <span class="comment"># if complex roots are all complex conjugates, the roots are real.</span></div>
<div class="line"><span class="lineno"> 1127</span>        roots = numpy.asarray(z, complex)</div>
<div class="line"><span class="lineno"> 1128</span>        pos_roots = numpy.compress(roots.imag &gt; 0, roots)</div>
<div class="line"><span class="lineno"> 1129</span>        neg_roots = numpy.conjugate(numpy.compress(roots.imag &lt; 0, roots))</div>
<div class="line"><span class="lineno"> 1130</span>        <span class="keywordflow">if</span> len(pos_roots) == len(neg_roots):</div>
<div class="line"><span class="lineno"> 1131</span>            <span class="keywordflow">if</span> numpy.all(numpy.sort_complex(neg_roots) ==</div>
<div class="line"><span class="lineno"> 1132</span>                         numpy.sort_complex(pos_roots)):</div>
<div class="line"><span class="lineno"> 1133</span>                b = b.real.copy()</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>    <span class="keywordflow">if</span> issubclass(a.dtype.type, numpy.complexfloating):</div>
<div class="line"><span class="lineno"> 1136</span>        <span class="comment"># if complex roots are all complex conjugates, the roots are real.</span></div>
<div class="line"><span class="lineno"> 1137</span>        roots = numpy.asarray(p, complex)</div>
<div class="line"><span class="lineno"> 1138</span>        pos_roots = numpy.compress(roots.imag &gt; 0, roots)</div>
<div class="line"><span class="lineno"> 1139</span>        neg_roots = numpy.conjugate(numpy.compress(roots.imag &lt; 0, roots))</div>
<div class="line"><span class="lineno"> 1140</span>        <span class="keywordflow">if</span> len(pos_roots) == len(neg_roots):</div>
<div class="line"><span class="lineno"> 1141</span>            <span class="keywordflow">if</span> numpy.all(numpy.sort_complex(neg_roots) ==</div>
<div class="line"><span class="lineno"> 1142</span>                         numpy.sort_complex(pos_roots)):</div>
<div class="line"><span class="lineno"> 1143</span>                a = a.real.copy()</div>
<div class="line"><span class="lineno"> 1144</span> </div>
<div class="line"><span class="lineno"> 1145</span>    <span class="keywordflow">return</span> b, a</div>
<div class="line"><span class="lineno"> 1146</span> </div>
<div class="line"><span class="lineno"> 1147</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7652e5119bd8574ea5fb53c49d2cd3f9" name="a7652e5119bd8574ea5fb53c49d2cd3f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7652e5119bd8574ea5fb53c49d2cd3f9">&#9670;&#160;</a></span>_ARC_JAC_SN_MAXITER</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int scipy.signal._filter_design._ARC_JAC_SN_MAXITER = 10</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2488f153d8ae94e3316797a1661dbb30" name="a2488f153d8ae94e3316797a1661dbb30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2488f153d8ae94e3316797a1661dbb30">&#9670;&#160;</a></span>_ELLIPDEG_MMAX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int scipy.signal._filter_design._ELLIPDEG_MMAX = 7</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a76ecc62801ca1a598f57e1e89c3f862a" name="a76ecc62801ca1a598f57e1e89c3f862a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ecc62801ca1a598f57e1e89c3f862a">&#9670;&#160;</a></span>_POW10_LOG10</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design._POW10_LOG10 = np.log(10)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae0755694c5f3c0fd7ffccc146d000962" name="ae0755694c5f3c0fd7ffccc146d000962"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0755694c5f3c0fd7ffccc146d000962">&#9670;&#160;</a></span>abs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._filter_design.abs = absolute</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9f2e025a5a7ab98adda5a652673c1c95" name="a9f2e025a5a7ab98adda5a652673c1c95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f2e025a5a7ab98adda5a652673c1c95">&#9670;&#160;</a></span>band_dict</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.signal._filter_design.band_dict</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {<span class="stringliteral">&#39;band&#39;</span>: <span class="stringliteral">&#39;bandpass&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>             <span class="stringliteral">&#39;bandpass&#39;</span>: <span class="stringliteral">&#39;bandpass&#39;</span>,</div>
<div class="line"><span class="lineno">    3</span>             <span class="stringliteral">&#39;pass&#39;</span>: <span class="stringliteral">&#39;bandpass&#39;</span>,</div>
<div class="line"><span class="lineno">    4</span>             <span class="stringliteral">&#39;bp&#39;</span>: <span class="stringliteral">&#39;bandpass&#39;</span>,</div>
<div class="line"><span class="lineno">    5</span> </div>
<div class="line"><span class="lineno">    6</span>             <span class="stringliteral">&#39;bs&#39;</span>: <span class="stringliteral">&#39;bandstop&#39;</span>,</div>
<div class="line"><span class="lineno">    7</span>             <span class="stringliteral">&#39;bandstop&#39;</span>: <span class="stringliteral">&#39;bandstop&#39;</span>,</div>
<div class="line"><span class="lineno">    8</span>             <span class="stringliteral">&#39;bands&#39;</span>: <span class="stringliteral">&#39;bandstop&#39;</span>,</div>
<div class="line"><span class="lineno">    9</span>             <span class="stringliteral">&#39;stop&#39;</span>: <span class="stringliteral">&#39;bandstop&#39;</span>,</div>
<div class="line"><span class="lineno">   10</span> </div>
<div class="line"><span class="lineno">   11</span>             <span class="stringliteral">&#39;l&#39;</span>: <span class="stringliteral">&#39;lowpass&#39;</span>,</div>
<div class="line"><span class="lineno">   12</span>             <span class="stringliteral">&#39;low&#39;</span>: <span class="stringliteral">&#39;lowpass&#39;</span>,</div>
<div class="line"><span class="lineno">   13</span>             <span class="stringliteral">&#39;lowpass&#39;</span>: <span class="stringliteral">&#39;lowpass&#39;</span>,</div>
<div class="line"><span class="lineno">   14</span>             <span class="stringliteral">&#39;lp&#39;</span>: <span class="stringliteral">&#39;lowpass&#39;</span>,</div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>             <span class="stringliteral">&#39;high&#39;</span>: <span class="stringliteral">&#39;highpass&#39;</span>,</div>
<div class="line"><span class="lineno">   17</span>             <span class="stringliteral">&#39;highpass&#39;</span>: <span class="stringliteral">&#39;highpass&#39;</span>,</div>
<div class="line"><span class="lineno">   18</span>             <span class="stringliteral">&#39;h&#39;</span>: <span class="stringliteral">&#39;highpass&#39;</span>,</div>
<div class="line"><span class="lineno">   19</span>             <span class="stringliteral">&#39;hp&#39;</span>: <span class="stringliteral">&#39;highpass&#39;</span>,</div>
<div class="line"><span class="lineno">   20</span>             }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af27e4e2de443cd81d20e5da16eeae926" name="af27e4e2de443cd81d20e5da16eeae926"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af27e4e2de443cd81d20e5da16eeae926">&#9670;&#160;</a></span>bessel_norms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.signal._filter_design.bessel_norms</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {<span class="stringliteral">&#39;bessel&#39;</span>: <span class="stringliteral">&#39;phase&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>                <span class="stringliteral">&#39;bessel_phase&#39;</span>: <span class="stringliteral">&#39;phase&#39;</span>,</div>
<div class="line"><span class="lineno">    3</span>                <span class="stringliteral">&#39;bessel_delay&#39;</span>: <span class="stringliteral">&#39;delay&#39;</span>,</div>
<div class="line"><span class="lineno">    4</span>                <span class="stringliteral">&#39;bessel_mag&#39;</span>: <span class="stringliteral">&#39;mag&#39;</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6345627611c9584ab49581b89d6133e3" name="a6345627611c9584ab49581b89d6133e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6345627611c9584ab49581b89d6133e3">&#9670;&#160;</a></span>EPSILON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scipy.signal._filter_design.EPSILON = 2e-16</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1997d304fd4096c170a317286c5ddefc" name="a1997d304fd4096c170a317286c5ddefc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1997d304fd4096c170a317286c5ddefc">&#9670;&#160;</a></span>filter_dict</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict scipy.signal._filter_design.filter_dict</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {<span class="stringliteral">&#39;butter&#39;</span>: [buttap, buttord],</div>
<div class="line"><span class="lineno">    2</span>               <span class="stringliteral">&#39;butterworth&#39;</span>: [buttap, buttord],</div>
<div class="line"><span class="lineno">    3</span> </div>
<div class="line"><span class="lineno">    4</span>               <span class="stringliteral">&#39;cauer&#39;</span>: [ellipap, ellipord],</div>
<div class="line"><span class="lineno">    5</span>               <span class="stringliteral">&#39;elliptic&#39;</span>: [ellipap, ellipord],</div>
<div class="line"><span class="lineno">    6</span>               <span class="stringliteral">&#39;ellip&#39;</span>: [ellipap, ellipord],</div>
<div class="line"><span class="lineno">    7</span> </div>
<div class="line"><span class="lineno">    8</span>               <span class="stringliteral">&#39;bessel&#39;</span>: [besselap],</div>
<div class="line"><span class="lineno">    9</span>               <span class="stringliteral">&#39;bessel_phase&#39;</span>: [besselap],</div>
<div class="line"><span class="lineno">   10</span>               <span class="stringliteral">&#39;bessel_delay&#39;</span>: [besselap],</div>
<div class="line"><span class="lineno">   11</span>               <span class="stringliteral">&#39;bessel_mag&#39;</span>: [besselap],</div>
<div class="line"><span class="lineno">   12</span> </div>
<div class="line"><span class="lineno">   13</span>               <span class="stringliteral">&#39;cheby1&#39;</span>: [cheb1ap, cheb1ord],</div>
<div class="line"><span class="lineno">   14</span>               <span class="stringliteral">&#39;chebyshev1&#39;</span>: [cheb1ap, cheb1ord],</div>
<div class="line"><span class="lineno">   15</span>               <span class="stringliteral">&#39;chebyshevi&#39;</span>: [cheb1ap, cheb1ord],</div>
<div class="line"><span class="lineno">   16</span> </div>
<div class="line"><span class="lineno">   17</span>               <span class="stringliteral">&#39;cheby2&#39;</span>: [cheb2ap, cheb2ord],</div>
<div class="line"><span class="lineno">   18</span>               <span class="stringliteral">&#39;chebyshev2&#39;</span>: [cheb2ap, cheb2ord],</div>
<div class="line"><span class="lineno">   19</span>               <span class="stringliteral">&#39;chebyshevii&#39;</span>: [cheb2ap, cheb2ord],</div>
<div class="line"><span class="lineno">   20</span>               }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
