<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.ndimage._measurements Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1ndimage.html">ndimage</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html">_measurements</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.ndimage._measurements Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acd18adae08ab2f0a9bb59491bdca20da" id="r_acd18adae08ab2f0a9bb59491bdca20da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#acd18adae08ab2f0a9bb59491bdca20da">label</a> (input, structure=None, output=None)</td></tr>
<tr class="separator:acd18adae08ab2f0a9bb59491bdca20da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9750b1fb6714b8995efbd3774678f0e" id="r_af9750b1fb6714b8995efbd3774678f0e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#af9750b1fb6714b8995efbd3774678f0e">find_objects</a> (input, max_label=0)</td></tr>
<tr class="separator:af9750b1fb6714b8995efbd3774678f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a260a352f74fc4d35b80f768fe18df021" id="r_a260a352f74fc4d35b80f768fe18df021"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a260a352f74fc4d35b80f768fe18df021">labeled_comprehension</a> (input, labels, index, <a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, out_dtype, default, pass_positions=False)</td></tr>
<tr class="separator:a260a352f74fc4d35b80f768fe18df021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5611f2732b53efd58b28bef10229d807" id="r_a5611f2732b53efd58b28bef10229d807"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a5611f2732b53efd58b28bef10229d807">_safely_castable_to_int</a> (dt)</td></tr>
<tr class="separator:a5611f2732b53efd58b28bef10229d807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7dc65b20856dd147841f596bd22c44d" id="r_ab7dc65b20856dd147841f596bd22c44d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#ab7dc65b20856dd147841f596bd22c44d">_stats</a> (input, labels=None, index=None, centered=False)</td></tr>
<tr class="separator:ab7dc65b20856dd147841f596bd22c44d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af33d5bd105bc783aaad2fd63ff192e54" id="r_af33d5bd105bc783aaad2fd63ff192e54"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#af33d5bd105bc783aaad2fd63ff192e54">sum</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:af33d5bd105bc783aaad2fd63ff192e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b66f3a839b4d796c81486803a302b44" id="r_a9b66f3a839b4d796c81486803a302b44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a9b66f3a839b4d796c81486803a302b44">sum_labels</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a9b66f3a839b4d796c81486803a302b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d73c1376cb88d223685e7a9302979e8" id="r_a6d73c1376cb88d223685e7a9302979e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a6d73c1376cb88d223685e7a9302979e8">mean</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a6d73c1376cb88d223685e7a9302979e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab57b2e6d048f4c85575fe47af356dca8" id="r_ab57b2e6d048f4c85575fe47af356dca8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#ab57b2e6d048f4c85575fe47af356dca8">variance</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:ab57b2e6d048f4c85575fe47af356dca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fcfcde86ce25ec5c83d41a3dcd8c5e8" id="r_a5fcfcde86ce25ec5c83d41a3dcd8c5e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a5fcfcde86ce25ec5c83d41a3dcd8c5e8">standard_deviation</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a5fcfcde86ce25ec5c83d41a3dcd8c5e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb0c65033e2fa96cb9a880ae95e60135" id="r_adb0c65033e2fa96cb9a880ae95e60135"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#adb0c65033e2fa96cb9a880ae95e60135">_select</a> (input, labels=None, index=None, find_min=False, find_max=False, find_min_positions=False, find_max_positions=False, find_median=False)</td></tr>
<tr class="separator:adb0c65033e2fa96cb9a880ae95e60135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8237970ae2bcc52d16c50ffa94d2f1ef" id="r_a8237970ae2bcc52d16c50ffa94d2f1ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a8237970ae2bcc52d16c50ffa94d2f1ef">minimum</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a8237970ae2bcc52d16c50ffa94d2f1ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a602599bfa35067292b5d41c02e248b28" id="r_a602599bfa35067292b5d41c02e248b28"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a602599bfa35067292b5d41c02e248b28">maximum</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a602599bfa35067292b5d41c02e248b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a659619a5c12296c7ee1b5cb2149d9b5b" id="r_a659619a5c12296c7ee1b5cb2149d9b5b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a659619a5c12296c7ee1b5cb2149d9b5b">median</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a659619a5c12296c7ee1b5cb2149d9b5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd5270f7a6873182ffc034149fd0db6" id="r_a0bd5270f7a6873182ffc034149fd0db6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a0bd5270f7a6873182ffc034149fd0db6">minimum_position</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a0bd5270f7a6873182ffc034149fd0db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64100b0a1521dad4c71215e840ede6f9" id="r_a64100b0a1521dad4c71215e840ede6f9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a64100b0a1521dad4c71215e840ede6f9">maximum_position</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a64100b0a1521dad4c71215e840ede6f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e463f41e565223c239ff2ded8ff23b4" id="r_a9e463f41e565223c239ff2ded8ff23b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a9e463f41e565223c239ff2ded8ff23b4">extrema</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a9e463f41e565223c239ff2ded8ff23b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32bf542cf41cbc2dc3ff1a297c3d64b1" id="r_a32bf542cf41cbc2dc3ff1a297c3d64b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a32bf542cf41cbc2dc3ff1a297c3d64b1">center_of_mass</a> (input, labels=None, index=None)</td></tr>
<tr class="separator:a32bf542cf41cbc2dc3ff1a297c3d64b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30172eb6216dce8140b3a2f761b1aeed" id="r_a30172eb6216dce8140b3a2f761b1aeed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a30172eb6216dce8140b3a2f761b1aeed">histogram</a> (input, min, max, bins, labels=None, index=None)</td></tr>
<tr class="separator:a30172eb6216dce8140b3a2f761b1aeed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a290134c166e65518735205b48afa5a13" id="r_a290134c166e65518735205b48afa5a13"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1ndimage_1_1__measurements.html#a290134c166e65518735205b48afa5a13">watershed_ift</a> (input, markers, structure=None, output=None)</td></tr>
<tr class="separator:a290134c166e65518735205b48afa5a13"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a5611f2732b53efd58b28bef10229d807" name="a5611f2732b53efd58b28bef10229d807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5611f2732b53efd58b28bef10229d807">&#9670;&#160;</a></span>_safely_castable_to_int()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements._safely_castable_to_int </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Test whether the NumPy data type `dt` can be safely cast to an int.</pre> <div class="fragment"><div class="line"><span class="lineno">  461</span><span class="keyword">def </span>_safely_castable_to_int(dt):</div>
<div class="line"><span class="lineno">  462</span>    <span class="stringliteral">&quot;&quot;&quot;Test whether the NumPy data type `dt` can be safely cast to an int.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  463</span>    int_size = np.dtype(int).itemsize</div>
<div class="line"><span class="lineno">  464</span>    safe = ((np.issubdtype(dt, np.signedinteger) <span class="keywordflow">and</span> dt.itemsize &lt;= int_size) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  465</span>            (np.issubdtype(dt, np.unsignedinteger) <span class="keywordflow">and</span> dt.itemsize &lt; int_size))</div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordflow">return</span> safe</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adb0c65033e2fa96cb9a880ae95e60135" name="adb0c65033e2fa96cb9a880ae95e60135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb0c65033e2fa96cb9a880ae95e60135">&#9670;&#160;</a></span>_select()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements._select </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>find_min</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>find_max</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>find_min_positions</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>find_max_positions</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>find_median</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns min, max, or both, plus their positions (if requested), and
median.</pre> <div class="fragment"><div class="line"><span class="lineno">  792</span>            find_median=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  793</span>    <span class="stringliteral">&quot;&quot;&quot;Returns min, max, or both, plus their positions (if requested), and</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral">    median.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>    input = numpy.asanyarray(input)</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>    find_positions = find_min_positions <span class="keywordflow">or</span> find_max_positions</div>
<div class="line"><span class="lineno">  799</span>    positions = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  800</span>    <span class="keywordflow">if</span> find_positions:</div>
<div class="line"><span class="lineno">  801</span>        positions = numpy.arange(input.size).reshape(input.shape)</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>    <span class="keyword">def </span>single_group(vals, positions):</div>
<div class="line"><span class="lineno">  804</span>        result = []</div>
<div class="line"><span class="lineno">  805</span>        <span class="keywordflow">if</span> find_min:</div>
<div class="line"><span class="lineno">  806</span>            result += [vals.min()]</div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordflow">if</span> find_min_positions:</div>
<div class="line"><span class="lineno">  808</span>            result += [positions[vals == vals.min()][0]]</div>
<div class="line"><span class="lineno">  809</span>        <span class="keywordflow">if</span> find_max:</div>
<div class="line"><span class="lineno">  810</span>            result += [vals.max()]</div>
<div class="line"><span class="lineno">  811</span>        <span class="keywordflow">if</span> find_max_positions:</div>
<div class="line"><span class="lineno">  812</span>            result += [positions[vals == vals.max()][0]]</div>
<div class="line"><span class="lineno">  813</span>        <span class="keywordflow">if</span> find_median:</div>
<div class="line"><span class="lineno">  814</span>            result += [numpy.median(vals)]</div>
<div class="line"><span class="lineno">  815</span>        <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    <span class="keywordflow">if</span> labels <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  818</span>        <span class="keywordflow">return</span> single_group(input, positions)</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>    <span class="comment"># ensure input and labels match sizes</span></div>
<div class="line"><span class="lineno">  821</span>    input, labels = numpy.broadcast_arrays(input, labels)</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>    <span class="keywordflow">if</span> index <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  824</span>        mask = (labels &gt; 0)</div>
<div class="line"><span class="lineno">  825</span>        masked_positions = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  826</span>        <span class="keywordflow">if</span> find_positions:</div>
<div class="line"><span class="lineno">  827</span>            masked_positions = positions[mask]</div>
<div class="line"><span class="lineno">  828</span>        <span class="keywordflow">return</span> single_group(input[mask], masked_positions)</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>    <span class="keywordflow">if</span> numpy.isscalar(index):</div>
<div class="line"><span class="lineno">  831</span>        mask = (labels == index)</div>
<div class="line"><span class="lineno">  832</span>        masked_positions = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  833</span>        <span class="keywordflow">if</span> find_positions:</div>
<div class="line"><span class="lineno">  834</span>            masked_positions = positions[mask]</div>
<div class="line"><span class="lineno">  835</span>        <span class="keywordflow">return</span> single_group(input[mask], masked_positions)</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>    <span class="comment"># remap labels to unique integers if necessary, or if the largest</span></div>
<div class="line"><span class="lineno">  838</span>    <span class="comment"># label is larger than the number of values.</span></div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">if</span> (<span class="keywordflow">not</span> _safely_castable_to_int(labels.dtype) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  840</span>            labels.min() &lt; 0 <span class="keywordflow">or</span> labels.max() &gt; labels.size):</div>
<div class="line"><span class="lineno">  841</span>        <span class="comment"># remap labels, and indexes</span></div>
<div class="line"><span class="lineno">  842</span>        unique_labels, labels = numpy.unique(labels, return_inverse=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  843</span>        idxs = numpy.searchsorted(unique_labels, index)</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>        <span class="comment"># make all of idxs valid</span></div>
<div class="line"><span class="lineno">  846</span>        idxs[idxs &gt;= unique_labels.size] = 0</div>
<div class="line"><span class="lineno">  847</span>        found = (unique_labels[idxs] == index)</div>
<div class="line"><span class="lineno">  848</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  849</span>        <span class="comment"># labels are an integer type, and there aren&#39;t too many</span></div>
<div class="line"><span class="lineno">  850</span>        idxs = numpy.asanyarray(index, numpy.int_).copy()</div>
<div class="line"><span class="lineno">  851</span>        found = (idxs &gt;= 0) &amp; (idxs &lt;= labels.max())</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>    idxs[~ found] = labels.max() + 1</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    <span class="keywordflow">if</span> find_median:</div>
<div class="line"><span class="lineno">  856</span>        order = numpy.lexsort((input.ravel(), labels.ravel()))</div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  858</span>        order = input.ravel().argsort()</div>
<div class="line"><span class="lineno">  859</span>    input = input.ravel()[order]</div>
<div class="line"><span class="lineno">  860</span>    labels = labels.ravel()[order]</div>
<div class="line"><span class="lineno">  861</span>    <span class="keywordflow">if</span> find_positions:</div>
<div class="line"><span class="lineno">  862</span>        positions = positions.ravel()[order]</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>    result = []</div>
<div class="line"><span class="lineno">  865</span>    <span class="keywordflow">if</span> find_min:</div>
<div class="line"><span class="lineno">  866</span>        mins = numpy.zeros(labels.max() + 2, input.dtype)</div>
<div class="line"><span class="lineno">  867</span>        mins[labels[::-1]] = input[::-1]</div>
<div class="line"><span class="lineno">  868</span>        result += [mins[idxs]]</div>
<div class="line"><span class="lineno">  869</span>    <span class="keywordflow">if</span> find_min_positions:</div>
<div class="line"><span class="lineno">  870</span>        minpos = numpy.zeros(labels.max() + 2, int)</div>
<div class="line"><span class="lineno">  871</span>        minpos[labels[::-1]] = positions[::-1]</div>
<div class="line"><span class="lineno">  872</span>        result += [minpos[idxs]]</div>
<div class="line"><span class="lineno">  873</span>    <span class="keywordflow">if</span> find_max:</div>
<div class="line"><span class="lineno">  874</span>        maxs = numpy.zeros(labels.max() + 2, input.dtype)</div>
<div class="line"><span class="lineno">  875</span>        maxs[labels] = input</div>
<div class="line"><span class="lineno">  876</span>        result += [maxs[idxs]]</div>
<div class="line"><span class="lineno">  877</span>    <span class="keywordflow">if</span> find_max_positions:</div>
<div class="line"><span class="lineno">  878</span>        maxpos = numpy.zeros(labels.max() + 2, int)</div>
<div class="line"><span class="lineno">  879</span>        maxpos[labels] = positions</div>
<div class="line"><span class="lineno">  880</span>        result += [maxpos[idxs]]</div>
<div class="line"><span class="lineno">  881</span>    <span class="keywordflow">if</span> find_median:</div>
<div class="line"><span class="lineno">  882</span>        locs = numpy.arange(len(labels))</div>
<div class="line"><span class="lineno">  883</span>        lo = numpy.zeros(labels.max() + 2, numpy.int_)</div>
<div class="line"><span class="lineno">  884</span>        lo[labels[::-1]] = locs[::-1]</div>
<div class="line"><span class="lineno">  885</span>        hi = numpy.zeros(labels.max() + 2, numpy.int_)</div>
<div class="line"><span class="lineno">  886</span>        hi[labels] = locs</div>
<div class="line"><span class="lineno">  887</span>        lo = lo[idxs]</div>
<div class="line"><span class="lineno">  888</span>        hi = hi[idxs]</div>
<div class="line"><span class="lineno">  889</span>        <span class="comment"># lo is an index to the lowest value in input for each label,</span></div>
<div class="line"><span class="lineno">  890</span>        <span class="comment"># hi is an index to the largest value.</span></div>
<div class="line"><span class="lineno">  891</span>        <span class="comment"># move them to be either the same ((hi - lo) % 2 == 0) or next</span></div>
<div class="line"><span class="lineno">  892</span>        <span class="comment"># to each other ((hi - lo) % 2 == 1), then average.</span></div>
<div class="line"><span class="lineno">  893</span>        step = (hi - lo) // 2</div>
<div class="line"><span class="lineno">  894</span>        lo += step</div>
<div class="line"><span class="lineno">  895</span>        hi -= step</div>
<div class="line"><span class="lineno">  896</span>        <span class="keywordflow">if</span> (np.issubdtype(input.dtype, np.integer)</div>
<div class="line"><span class="lineno">  897</span>                <span class="keywordflow">or</span> np.issubdtype(input.dtype, np.bool_)):</div>
<div class="line"><span class="lineno">  898</span>            <span class="comment"># avoid integer overflow or boolean addition (gh-12836)</span></div>
<div class="line"><span class="lineno">  899</span>            result += [(input[lo].astype(<span class="stringliteral">&#39;d&#39;</span>) + input[hi].astype(<span class="stringliteral">&#39;d&#39;</span>)) / 2.0]</div>
<div class="line"><span class="lineno">  900</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  901</span>            result += [(input[lo] + input[hi]) / 2.0]</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7dc65b20856dd147841f596bd22c44d" name="ab7dc65b20856dd147841f596bd22c44d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7dc65b20856dd147841f596bd22c44d">&#9670;&#160;</a></span>_stats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements._stats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>centered</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Count, sum, and optionally compute (sum - centre)^2 of input by label

Parameters
----------
input : array_like, N-D
    The input data to be analyzed.
labels : array_like (N-D), optional
    The labels of the data in `input`. This array must be broadcast
    compatible with `input`; typically, it is the same shape as `input`.
    If `labels` is None, all nonzero values in `input` are treated as
    the single labeled group.
index : label or sequence of labels, optional
    These are the labels of the groups for which the stats are computed.
    If `index` is None, the stats are computed for the single group where
    `labels` is greater than 0.
centered : bool, optional
    If True, the centered sum of squares for each labeled group is
    also returned. Default is False.

Returns
-------
counts : int or ndarray of ints
    The number of elements in each labeled group.
sums : scalar or ndarray of scalars
    The sums of the values in each labeled group.
sums_c : scalar or ndarray of scalars, optional
    The sums of mean-centered squares of the values in each labeled group.
    This is only returned if `centered` is True.</pre> <div class="fragment"><div class="line"><span class="lineno">  469</span><span class="keyword">def </span>_stats(input, labels=None, index=None, centered=False):</div>
<div class="line"><span class="lineno">  470</span>    <span class="stringliteral">&quot;&quot;&quot;Count, sum, and optionally compute (sum - centre)^2 of input by label</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">    input : array_like, N-D</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">        The input data to be analyzed.</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">    labels : array_like (N-D), optional</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">        The labels of the data in `input`. This array must be broadcast</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">        compatible with `input`; typically, it is the same shape as `input`.</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">        If `labels` is None, all nonzero values in `input` are treated as</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">        the single labeled group.</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">    index : label or sequence of labels, optional</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">        These are the labels of the groups for which the stats are computed.</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">        If `index` is None, the stats are computed for the single group where</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">        `labels` is greater than 0.</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">    centered : bool, optional</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">        If True, the centered sum of squares for each labeled group is</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">        also returned. Default is False.</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">    counts : int or ndarray of ints</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">        The number of elements in each labeled group.</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">    sums : scalar or ndarray of scalars</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">        The sums of the values in each labeled group.</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">    sums_c : scalar or ndarray of scalars, optional</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">        The sums of mean-centered squares of the values in each labeled group.</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral">        This is only returned if `centered` is True.</span></div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  500</span>    <span class="keyword">def </span>single_group(vals):</div>
<div class="line"><span class="lineno">  501</span>        <span class="keywordflow">if</span> centered:</div>
<div class="line"><span class="lineno">  502</span>            vals_c = vals - vals.mean()</div>
<div class="line"><span class="lineno">  503</span>            <span class="keywordflow">return</span> vals.size, vals.sum(), (vals_c * vals_c.conjugate()).sum()</div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  505</span>            <span class="keywordflow">return</span> vals.size, vals.sum()</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>    <span class="keywordflow">if</span> labels <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordflow">return</span> single_group(input)</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="comment"># ensure input and labels match sizes</span></div>
<div class="line"><span class="lineno">  511</span>    input, labels = numpy.broadcast_arrays(input, labels)</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">if</span> index <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  514</span>        <span class="keywordflow">return</span> single_group(input[labels &gt; 0])</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">if</span> numpy.isscalar(index):</div>
<div class="line"><span class="lineno">  517</span>        <span class="keywordflow">return</span> single_group(input[labels == index])</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    <span class="keyword">def </span>_sum_centered(labels):</div>
<div class="line"><span class="lineno">  520</span>        <span class="comment"># `labels` is expected to be an ndarray with the same shape as `input`.</span></div>
<div class="line"><span class="lineno">  521</span>        <span class="comment"># It must contain the label indices (which are not necessarily the labels</span></div>
<div class="line"><span class="lineno">  522</span>        <span class="comment"># themselves).</span></div>
<div class="line"><span class="lineno">  523</span>        means = sums / counts</div>
<div class="line"><span class="lineno">  524</span>        centered_input = input - means[labels]</div>
<div class="line"><span class="lineno">  525</span>        <span class="comment"># bincount expects 1-D inputs, so we ravel the arguments.</span></div>
<div class="line"><span class="lineno">  526</span>        bc = numpy.bincount(labels.ravel(),</div>
<div class="line"><span class="lineno">  527</span>                              weights=(centered_input *</div>
<div class="line"><span class="lineno">  528</span>                                       centered_input.conjugate()).ravel())</div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">return</span> bc</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    <span class="comment"># Remap labels to unique integers if necessary, or if the largest</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="comment"># label is larger than the number of values.</span></div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>    <span class="keywordflow">if</span> (<span class="keywordflow">not</span> _safely_castable_to_int(labels.dtype) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  535</span>            labels.min() &lt; 0 <span class="keywordflow">or</span> labels.max() &gt; labels.size):</div>
<div class="line"><span class="lineno">  536</span>        <span class="comment"># Use numpy.unique to generate the label indices.  `new_labels` will</span></div>
<div class="line"><span class="lineno">  537</span>        <span class="comment"># be 1-D, but it should be interpreted as the flattened N-D array of</span></div>
<div class="line"><span class="lineno">  538</span>        <span class="comment"># label indices.</span></div>
<div class="line"><span class="lineno">  539</span>        unique_labels, new_labels = numpy.unique(labels, return_inverse=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  540</span>        counts = numpy.bincount(new_labels)</div>
<div class="line"><span class="lineno">  541</span>        sums = numpy.bincount(new_labels, weights=input.ravel())</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">if</span> centered:</div>
<div class="line"><span class="lineno">  543</span>            <span class="comment"># Compute the sum of the mean-centered squares.</span></div>
<div class="line"><span class="lineno">  544</span>            <span class="comment"># We must reshape new_labels to the N-D shape of `input` before</span></div>
<div class="line"><span class="lineno">  545</span>            <span class="comment"># passing it _sum_centered.</span></div>
<div class="line"><span class="lineno">  546</span>            sums_c = _sum_centered(new_labels.reshape(labels.shape))</div>
<div class="line"><span class="lineno">  547</span>        idxs = numpy.searchsorted(unique_labels, index)</div>
<div class="line"><span class="lineno">  548</span>        <span class="comment"># make all of idxs valid</span></div>
<div class="line"><span class="lineno">  549</span>        idxs[idxs &gt;= unique_labels.size] = 0</div>
<div class="line"><span class="lineno">  550</span>        found = (unique_labels[idxs] == index)</div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  552</span>        <span class="comment"># labels are an integer type allowed by bincount, and there aren&#39;t too</span></div>
<div class="line"><span class="lineno">  553</span>        <span class="comment"># many, so call bincount directly.</span></div>
<div class="line"><span class="lineno">  554</span>        counts = numpy.bincount(labels.ravel())</div>
<div class="line"><span class="lineno">  555</span>        sums = numpy.bincount(labels.ravel(), weights=input.ravel())</div>
<div class="line"><span class="lineno">  556</span>        <span class="keywordflow">if</span> centered:</div>
<div class="line"><span class="lineno">  557</span>            sums_c = _sum_centered(labels)</div>
<div class="line"><span class="lineno">  558</span>        <span class="comment"># make sure all index values are valid</span></div>
<div class="line"><span class="lineno">  559</span>        idxs = numpy.asanyarray(index, numpy.int_).copy()</div>
<div class="line"><span class="lineno">  560</span>        found = (idxs &gt;= 0) &amp; (idxs &lt; counts.size)</div>
<div class="line"><span class="lineno">  561</span>        idxs[~found] = 0</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>    counts = counts[idxs]</div>
<div class="line"><span class="lineno">  564</span>    counts[~found] = 0</div>
<div class="line"><span class="lineno">  565</span>    sums = sums[idxs]</div>
<div class="line"><span class="lineno">  566</span>    sums[~found] = 0</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> centered:</div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">return</span> (counts, sums)</div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  571</span>        sums_c = sums_c[idxs]</div>
<div class="line"><span class="lineno">  572</span>        sums_c[~found] = 0</div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordflow">return</span> (counts, sums, sums_c)</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a32bf542cf41cbc2dc3ff1a297c3d64b1" name="a32bf542cf41cbc2dc3ff1a297c3d64b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32bf542cf41cbc2dc3ff1a297c3d64b1">&#9670;&#160;</a></span>center_of_mass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.center_of_mass </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the center of mass of the values of an array at labels.

Parameters
----------
input : ndarray
    Data from which to calculate center-of-mass. The masses can either
    be positive or negative.
labels : ndarray, optional
    Labels for objects in `input`, as generated by `ndimage.label`.
    Only used with `index`. Dimensions must be the same as `input`.
index : int or sequence of ints, optional
    Labels for which to calculate centers-of-mass. If not specified,
    the combined center of mass of all labels greater than zero
    will be calculated. Only used with `labels`.

Returns
-------
center_of_mass : tuple, or list of tuples
    Coordinates of centers-of-mass.

Examples
--------
&gt;&gt;&gt; a = np.array(([0,0,0,0],
...               [0,1,1,0],
...               [0,1,1,0],
...               [0,1,1,0]))
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; ndimage.center_of_mass(a)
(2.0, 1.5)

Calculation of multiple objects in an image

&gt;&gt;&gt; b = np.array(([0,1,1,0],
...               [0,1,0,0],
...               [0,0,0,0],
...               [0,0,1,1],
...               [0,0,1,1]))
&gt;&gt;&gt; lbl = ndimage.label(b)[0]
&gt;&gt;&gt; ndimage.center_of_mass(b, lbl, [1,2])
[(0.33333333333333331, 1.3333333333333333), (3.5, 2.5)]

Negative masses are also accepted, which can occur for example when
bias is removed from measured data due to random noise.

&gt;&gt;&gt; c = np.array(([-1,0,0,0],
...               [0,-1,-1,0],
...               [0,1,-1,0],
...               [0,1,1,0]))
&gt;&gt;&gt; ndimage.center_of_mass(c)
(-4.0, 1.0)

If there are division by zero issues, the function does not raise an
error but rather issues a RuntimeWarning before returning inf and/or NaN.

&gt;&gt;&gt; d = np.array([-1, 1])
&gt;&gt;&gt; ndimage.center_of_mass(d)
(inf,)
</pre> <div class="fragment"><div class="line"><span class="lineno"> 1344</span><span class="keyword">def </span>center_of_mass(input, labels=None, index=None):</div>
<div class="line"><span class="lineno"> 1345</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1346</span><span class="stringliteral">    Calculate the center of mass of the values of an array at labels.</span></div>
<div class="line"><span class="lineno"> 1347</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1348</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1349</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1350</span><span class="stringliteral">    input : ndarray</span></div>
<div class="line"><span class="lineno"> 1351</span><span class="stringliteral">        Data from which to calculate center-of-mass. The masses can either</span></div>
<div class="line"><span class="lineno"> 1352</span><span class="stringliteral">        be positive or negative.</span></div>
<div class="line"><span class="lineno"> 1353</span><span class="stringliteral">    labels : ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1354</span><span class="stringliteral">        Labels for objects in `input`, as generated by `ndimage.label`.</span></div>
<div class="line"><span class="lineno"> 1355</span><span class="stringliteral">        Only used with `index`. Dimensions must be the same as `input`.</span></div>
<div class="line"><span class="lineno"> 1356</span><span class="stringliteral">    index : int or sequence of ints, optional</span></div>
<div class="line"><span class="lineno"> 1357</span><span class="stringliteral">        Labels for which to calculate centers-of-mass. If not specified,</span></div>
<div class="line"><span class="lineno"> 1358</span><span class="stringliteral">        the combined center of mass of all labels greater than zero</span></div>
<div class="line"><span class="lineno"> 1359</span><span class="stringliteral">        will be calculated. Only used with `labels`.</span></div>
<div class="line"><span class="lineno"> 1360</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1361</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1362</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1363</span><span class="stringliteral">    center_of_mass : tuple, or list of tuples</span></div>
<div class="line"><span class="lineno"> 1364</span><span class="stringliteral">        Coordinates of centers-of-mass.</span></div>
<div class="line"><span class="lineno"> 1365</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1366</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1367</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1368</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array(([0,0,0,0],</span></div>
<div class="line"><span class="lineno"> 1369</span><span class="stringliteral">    ...               [0,1,1,0],</span></div>
<div class="line"><span class="lineno"> 1370</span><span class="stringliteral">    ...               [0,1,1,0],</span></div>
<div class="line"><span class="lineno"> 1371</span><span class="stringliteral">    ...               [0,1,1,0]))</span></div>
<div class="line"><span class="lineno"> 1372</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1373</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.center_of_mass(a)</span></div>
<div class="line"><span class="lineno"> 1374</span><span class="stringliteral">    (2.0, 1.5)</span></div>
<div class="line"><span class="lineno"> 1375</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1376</span><span class="stringliteral">    Calculation of multiple objects in an image</span></div>
<div class="line"><span class="lineno"> 1377</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1378</span><span class="stringliteral">    &gt;&gt;&gt; b = np.array(([0,1,1,0],</span></div>
<div class="line"><span class="lineno"> 1379</span><span class="stringliteral">    ...               [0,1,0,0],</span></div>
<div class="line"><span class="lineno"> 1380</span><span class="stringliteral">    ...               [0,0,0,0],</span></div>
<div class="line"><span class="lineno"> 1381</span><span class="stringliteral">    ...               [0,0,1,1],</span></div>
<div class="line"><span class="lineno"> 1382</span><span class="stringliteral">    ...               [0,0,1,1]))</span></div>
<div class="line"><span class="lineno"> 1383</span><span class="stringliteral">    &gt;&gt;&gt; lbl = ndimage.label(b)[0]</span></div>
<div class="line"><span class="lineno"> 1384</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.center_of_mass(b, lbl, [1,2])</span></div>
<div class="line"><span class="lineno"> 1385</span><span class="stringliteral">    [(0.33333333333333331, 1.3333333333333333), (3.5, 2.5)]</span></div>
<div class="line"><span class="lineno"> 1386</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1387</span><span class="stringliteral">    Negative masses are also accepted, which can occur for example when</span></div>
<div class="line"><span class="lineno"> 1388</span><span class="stringliteral">    bias is removed from measured data due to random noise.</span></div>
<div class="line"><span class="lineno"> 1389</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1390</span><span class="stringliteral">    &gt;&gt;&gt; c = np.array(([-1,0,0,0],</span></div>
<div class="line"><span class="lineno"> 1391</span><span class="stringliteral">    ...               [0,-1,-1,0],</span></div>
<div class="line"><span class="lineno"> 1392</span><span class="stringliteral">    ...               [0,1,-1,0],</span></div>
<div class="line"><span class="lineno"> 1393</span><span class="stringliteral">    ...               [0,1,1,0]))</span></div>
<div class="line"><span class="lineno"> 1394</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.center_of_mass(c)</span></div>
<div class="line"><span class="lineno"> 1395</span><span class="stringliteral">    (-4.0, 1.0)</span></div>
<div class="line"><span class="lineno"> 1396</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1397</span><span class="stringliteral">    If there are division by zero issues, the function does not raise an</span></div>
<div class="line"><span class="lineno"> 1398</span><span class="stringliteral">    error but rather issues a RuntimeWarning before returning inf and/or NaN.</span></div>
<div class="line"><span class="lineno"> 1399</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1400</span><span class="stringliteral">    &gt;&gt;&gt; d = np.array([-1, 1])</span></div>
<div class="line"><span class="lineno"> 1401</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.center_of_mass(d)</span></div>
<div class="line"><span class="lineno"> 1402</span><span class="stringliteral">    (inf,)</span></div>
<div class="line"><span class="lineno"> 1403</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1404</span>    normalizer = sum(input, labels, index)</div>
<div class="line"><span class="lineno"> 1405</span>    grids = numpy.ogrid[[slice(0, i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> input.shape]]</div>
<div class="line"><span class="lineno"> 1406</span> </div>
<div class="line"><span class="lineno"> 1407</span>    results = [sum(input * grids[dir].astype(float), labels, index) / normalizer</div>
<div class="line"><span class="lineno"> 1408</span>               <span class="keywordflow">for</span> dir <span class="keywordflow">in</span> range(input.ndim)]</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>    <span class="keywordflow">if</span> numpy.isscalar(results[0]):</div>
<div class="line"><span class="lineno"> 1411</span>        <span class="keywordflow">return</span> tuple(results)</div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span>    <span class="keywordflow">return</span> [tuple(v) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> numpy.array(results).T]</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e463f41e565223c239ff2ded8ff23b4" name="a9e463f41e565223c239ff2ded8ff23b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e463f41e565223c239ff2ded8ff23b4">&#9670;&#160;</a></span>extrema()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.extrema </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the minimums and maximums of the values of an array
at labels, along with their positions.

Parameters
----------
input : ndarray
    N-D image data to process.
labels : ndarray, optional
    Labels of features in input.
    If not None, must be same shape as `input`.
index : int or sequence of ints, optional
    Labels to include in output.  If None (default), all values where
    non-zero `labels` are used.

Returns
-------
minimums, maximums : int or ndarray
    Values of minimums and maximums in each feature.
min_positions, max_positions : tuple or list of tuples
    Each tuple gives the N-D coordinates of the corresponding minimum
    or maximum.

See Also
--------
maximum, minimum, maximum_position, minimum_position, center_of_mass

Examples
--------
&gt;&gt;&gt; a = np.array([[1, 2, 0, 0],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; ndimage.extrema(a)
(0, 9, (0, 2), (3, 0))

Features to process can be specified using `labels` and `index`:

&gt;&gt;&gt; lbl, nlbl = ndimage.label(a)
&gt;&gt;&gt; ndimage.extrema(a, lbl, index=np.arange(1, nlbl+1))
(array([1, 4, 3]),
 array([5, 7, 9]),
 [(0, 0), (1, 3), (3, 1)],
 [(1, 0), (2, 3), (3, 0)])

If no index is given, non-zero `labels` are processed:

&gt;&gt;&gt; ndimage.extrema(a, lbl)
(1, 9, (0, 0), (3, 0))</pre> <div class="fragment"><div class="line"><span class="lineno"> 1270</span><span class="keyword">def </span>extrema(input, labels=None, index=None):</div>
<div class="line"><span class="lineno"> 1271</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1272</span><span class="stringliteral">    Calculate the minimums and maximums of the values of an array</span></div>
<div class="line"><span class="lineno"> 1273</span><span class="stringliteral">    at labels, along with their positions.</span></div>
<div class="line"><span class="lineno"> 1274</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1275</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1276</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1277</span><span class="stringliteral">    input : ndarray</span></div>
<div class="line"><span class="lineno"> 1278</span><span class="stringliteral">        N-D image data to process.</span></div>
<div class="line"><span class="lineno"> 1279</span><span class="stringliteral">    labels : ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1280</span><span class="stringliteral">        Labels of features in input.</span></div>
<div class="line"><span class="lineno"> 1281</span><span class="stringliteral">        If not None, must be same shape as `input`.</span></div>
<div class="line"><span class="lineno"> 1282</span><span class="stringliteral">    index : int or sequence of ints, optional</span></div>
<div class="line"><span class="lineno"> 1283</span><span class="stringliteral">        Labels to include in output.  If None (default), all values where</span></div>
<div class="line"><span class="lineno"> 1284</span><span class="stringliteral">        non-zero `labels` are used.</span></div>
<div class="line"><span class="lineno"> 1285</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1286</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1287</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1288</span><span class="stringliteral">    minimums, maximums : int or ndarray</span></div>
<div class="line"><span class="lineno"> 1289</span><span class="stringliteral">        Values of minimums and maximums in each feature.</span></div>
<div class="line"><span class="lineno"> 1290</span><span class="stringliteral">    min_positions, max_positions : tuple or list of tuples</span></div>
<div class="line"><span class="lineno"> 1291</span><span class="stringliteral">        Each tuple gives the N-D coordinates of the corresponding minimum</span></div>
<div class="line"><span class="lineno"> 1292</span><span class="stringliteral">        or maximum.</span></div>
<div class="line"><span class="lineno"> 1293</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1294</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1295</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="stringliteral">    maximum, minimum, maximum_position, minimum_position, center_of_mass</span></div>
<div class="line"><span class="lineno"> 1297</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1298</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1299</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1300</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1301</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno"> 1302</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno"> 1303</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1304</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1305</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.extrema(a)</span></div>
<div class="line"><span class="lineno"> 1306</span><span class="stringliteral">    (0, 9, (0, 2), (3, 0))</span></div>
<div class="line"><span class="lineno"> 1307</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1308</span><span class="stringliteral">    Features to process can be specified using `labels` and `index`:</span></div>
<div class="line"><span class="lineno"> 1309</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1310</span><span class="stringliteral">    &gt;&gt;&gt; lbl, nlbl = ndimage.label(a)</span></div>
<div class="line"><span class="lineno"> 1311</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.extrema(a, lbl, index=np.arange(1, nlbl+1))</span></div>
<div class="line"><span class="lineno"> 1312</span><span class="stringliteral">    (array([1, 4, 3]),</span></div>
<div class="line"><span class="lineno"> 1313</span><span class="stringliteral">     array([5, 7, 9]),</span></div>
<div class="line"><span class="lineno"> 1314</span><span class="stringliteral">     [(0, 0), (1, 3), (3, 1)],</span></div>
<div class="line"><span class="lineno"> 1315</span><span class="stringliteral">     [(1, 0), (2, 3), (3, 0)])</span></div>
<div class="line"><span class="lineno"> 1316</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1317</span><span class="stringliteral">    If no index is given, non-zero `labels` are processed:</span></div>
<div class="line"><span class="lineno"> 1318</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1319</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.extrema(a, lbl)</span></div>
<div class="line"><span class="lineno"> 1320</span><span class="stringliteral">    (1, 9, (0, 0), (3, 0))</span></div>
<div class="line"><span class="lineno"> 1321</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1322</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1323</span>    dims = numpy.array(numpy.asarray(input).shape)</div>
<div class="line"><span class="lineno"> 1324</span>    <span class="comment"># see numpy.unravel_index to understand this line.</span></div>
<div class="line"><span class="lineno"> 1325</span>    dim_prod = numpy.cumprod([1] + list(dims[:0:-1]))[::-1]</div>
<div class="line"><span class="lineno"> 1326</span> </div>
<div class="line"><span class="lineno"> 1327</span>    minimums, min_positions, maximums, max_positions = _select(input, labels,</div>
<div class="line"><span class="lineno"> 1328</span>                                                               index,</div>
<div class="line"><span class="lineno"> 1329</span>                                                               find_min=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1330</span>                                                               find_max=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1331</span>                                                               find_min_positions=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno"> 1332</span>                                                               find_max_positions=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>    <span class="keywordflow">if</span> numpy.isscalar(minimums):</div>
<div class="line"><span class="lineno"> 1335</span>        <span class="keywordflow">return</span> (minimums, maximums, tuple((min_positions // dim_prod) % dims),</div>
<div class="line"><span class="lineno"> 1336</span>                tuple((max_positions // dim_prod) % dims))</div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span>    min_positions = [tuple(v) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> (min_positions.reshape(-1, 1) // dim_prod) % dims]</div>
<div class="line"><span class="lineno"> 1339</span>    max_positions = [tuple(v) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> (max_positions.reshape(-1, 1) // dim_prod) % dims]</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>    <span class="keywordflow">return</span> minimums, maximums, min_positions, max_positions</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af9750b1fb6714b8995efbd3774678f0e" name="af9750b1fb6714b8995efbd3774678f0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9750b1fb6714b8995efbd3774678f0e">&#9670;&#160;</a></span>find_objects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.find_objects </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_label</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find objects in a labeled array.

Parameters
----------
input : ndarray of ints
    Array containing objects defined by different labels. Labels with
    value 0 are ignored.
max_label : int, optional
    Maximum label to be searched for in `input`. If max_label is not
    given, the positions of all objects are returned.

Returns
-------
object_slices : list of tuples
    A list of tuples, with each tuple containing N slices (with N the
    dimension of the input array). Slices correspond to the minimal
    parallelepiped that contains the object. If a number is missing,
    None is returned instead of a slice.

See Also
--------
label, center_of_mass

Notes
-----
This function is very useful for isolating a volume of interest inside
a 3-D array, that cannot be "seen through".

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.zeros((6,6), dtype=int)
&gt;&gt;&gt; a[2:4, 2:4] = 1
&gt;&gt;&gt; a[4, 4] = 1
&gt;&gt;&gt; a[:2, :3] = 2
&gt;&gt;&gt; a[0, 5] = 3
&gt;&gt;&gt; a
array([[2, 2, 2, 0, 0, 3],
       [2, 2, 2, 0, 0, 0],
       [0, 0, 1, 1, 0, 0],
       [0, 0, 1, 1, 0, 0],
       [0, 0, 0, 0, 1, 0],
       [0, 0, 0, 0, 0, 0]])
&gt;&gt;&gt; ndimage.find_objects(a)
[(slice(2, 5, None), slice(2, 5, None)), (slice(0, 2, None), slice(0, 3, None)), (slice(0, 1, None), slice(5, 6, None))]
&gt;&gt;&gt; ndimage.find_objects(a, max_label=2)
[(slice(2, 5, None), slice(2, 5, None)), (slice(0, 2, None), slice(0, 3, None))]
&gt;&gt;&gt; ndimage.find_objects(a == 1, max_label=2)
[(slice(2, 5, None), slice(2, 5, None)), None]

&gt;&gt;&gt; loc = ndimage.find_objects(a)[0]
&gt;&gt;&gt; a[loc]
array([[1, 1, 0],
       [1, 1, 0],
       [0, 0, 1]])</pre> <div class="fragment"><div class="line"><span class="lineno">  239</span><span class="keyword">def </span>find_objects(input, max_label=0):</div>
<div class="line"><span class="lineno">  240</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    Find objects in a labeled array.</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    input : ndarray of ints</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">        Array containing objects defined by different labels. Labels with</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">        value 0 are ignored.</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    max_label : int, optional</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">        Maximum label to be searched for in `input`. If max_label is not</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">        given, the positions of all objects are returned.</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">    object_slices : list of tuples</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">        A list of tuples, with each tuple containing N slices (with N the</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">        dimension of the input array). Slices correspond to the minimal</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">        parallelepiped that contains the object. If a number is missing,</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">        None is returned instead of a slice.</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">    label, center_of_mass</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    This function is very useful for isolating a volume of interest inside</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    a 3-D array, that cannot be &quot;seen through&quot;.</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    &gt;&gt;&gt; a = np.zeros((6,6), dtype=int)</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    &gt;&gt;&gt; a[2:4, 2:4] = 1</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    &gt;&gt;&gt; a[4, 4] = 1</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    &gt;&gt;&gt; a[:2, :3] = 2</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    &gt;&gt;&gt; a[0, 5] = 3</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    array([[2, 2, 2, 0, 0, 3],</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">           [2, 2, 2, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">           [0, 0, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">           [0, 0, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">           [0, 0, 0, 0, 1, 0],</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">           [0, 0, 0, 0, 0, 0]])</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.find_objects(a)</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    [(slice(2, 5, None), slice(2, 5, None)), (slice(0, 2, None), slice(0, 3, None)), (slice(0, 1, None), slice(5, 6, None))]</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.find_objects(a, max_label=2)</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">    [(slice(2, 5, None), slice(2, 5, None)), (slice(0, 2, None), slice(0, 3, None))]</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.find_objects(a == 1, max_label=2)</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">    [(slice(2, 5, None), slice(2, 5, None)), None]</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    &gt;&gt;&gt; loc = ndimage.find_objects(a)[0]</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    &gt;&gt;&gt; a[loc]</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">    array([[1, 1, 0],</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">           [1, 1, 0],</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">           [0, 0, 1]])</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  298</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">if</span> numpy.iscomplexobj(input):</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;Complex type not supported&#39;</span>)</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">if</span> max_label &lt; 1:</div>
<div class="line"><span class="lineno">  303</span>        max_label = input.max()</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>    <span class="keywordflow">return</span> _nd_image.find_objects(input, max_label)</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a30172eb6216dce8140b3a2f761b1aeed" name="a30172eb6216dce8140b3a2f761b1aeed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30172eb6216dce8140b3a2f761b1aeed">&#9670;&#160;</a></span>histogram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.histogram </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the histogram of the values of an array, optionally at labels.

Histogram calculates the frequency of values in an array within bins
determined by `min`, `max`, and `bins`. The `labels` and `index`
keywords can limit the scope of the histogram to specified sub-regions
within the array.

Parameters
----------
input : array_like
    Data for which to calculate histogram.
min, max : int
    Minimum and maximum values of range of histogram bins.
bins : int
    Number of bins.
labels : array_like, optional
    Labels for objects in `input`.
    If not None, must be same shape as `input`.
index : int or sequence of ints, optional
    Label or labels for which to calculate histogram. If None, all values
    where label is greater than zero are used

Returns
-------
hist : ndarray
    Histogram counts.

Examples
--------
&gt;&gt;&gt; a = np.array([[ 0.    ,  0.2146,  0.5962,  0.    ],
...               [ 0.    ,  0.7778,  0.    ,  0.    ],
...               [ 0.    ,  0.    ,  0.    ,  0.    ],
...               [ 0.    ,  0.    ,  0.7181,  0.2787],
...               [ 0.    ,  0.    ,  0.6573,  0.3094]])
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; ndimage.histogram(a, 0, 1, 10)
array([13,  0,  2,  1,  0,  1,  1,  2,  0,  0])

With labels and no indices, non-zero elements are counted:

&gt;&gt;&gt; lbl, nlbl = ndimage.label(a)
&gt;&gt;&gt; ndimage.histogram(a, 0, 1, 10, lbl)
array([0, 0, 2, 1, 0, 1, 1, 2, 0, 0])

Indices can be used to count only certain objects:

&gt;&gt;&gt; ndimage.histogram(a, 0, 1, 10, lbl, 2)
array([0, 0, 1, 1, 0, 0, 1, 1, 0, 0])</pre> <div class="fragment"><div class="line"><span class="lineno"> 1416</span><span class="keyword">def </span>histogram(input, min, max, bins, labels=None, index=None):</div>
<div class="line"><span class="lineno"> 1417</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1418</span><span class="stringliteral">    Calculate the histogram of the values of an array, optionally at labels.</span></div>
<div class="line"><span class="lineno"> 1419</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1420</span><span class="stringliteral">    Histogram calculates the frequency of values in an array within bins</span></div>
<div class="line"><span class="lineno"> 1421</span><span class="stringliteral">    determined by `min`, `max`, and `bins`. The `labels` and `index`</span></div>
<div class="line"><span class="lineno"> 1422</span><span class="stringliteral">    keywords can limit the scope of the histogram to specified sub-regions</span></div>
<div class="line"><span class="lineno"> 1423</span><span class="stringliteral">    within the array.</span></div>
<div class="line"><span class="lineno"> 1424</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1425</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1426</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1427</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1428</span><span class="stringliteral">        Data for which to calculate histogram.</span></div>
<div class="line"><span class="lineno"> 1429</span><span class="stringliteral">    min, max : int</span></div>
<div class="line"><span class="lineno"> 1430</span><span class="stringliteral">        Minimum and maximum values of range of histogram bins.</span></div>
<div class="line"><span class="lineno"> 1431</span><span class="stringliteral">    bins : int</span></div>
<div class="line"><span class="lineno"> 1432</span><span class="stringliteral">        Number of bins.</span></div>
<div class="line"><span class="lineno"> 1433</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno"> 1434</span><span class="stringliteral">        Labels for objects in `input`.</span></div>
<div class="line"><span class="lineno"> 1435</span><span class="stringliteral">        If not None, must be same shape as `input`.</span></div>
<div class="line"><span class="lineno"> 1436</span><span class="stringliteral">    index : int or sequence of ints, optional</span></div>
<div class="line"><span class="lineno"> 1437</span><span class="stringliteral">        Label or labels for which to calculate histogram. If None, all values</span></div>
<div class="line"><span class="lineno"> 1438</span><span class="stringliteral">        where label is greater than zero are used</span></div>
<div class="line"><span class="lineno"> 1439</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1440</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1441</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1442</span><span class="stringliteral">    hist : ndarray</span></div>
<div class="line"><span class="lineno"> 1443</span><span class="stringliteral">        Histogram counts.</span></div>
<div class="line"><span class="lineno"> 1444</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1445</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1446</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1447</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[ 0.    ,  0.2146,  0.5962,  0.    ],</span></div>
<div class="line"><span class="lineno"> 1448</span><span class="stringliteral">    ...               [ 0.    ,  0.7778,  0.    ,  0.    ],</span></div>
<div class="line"><span class="lineno"> 1449</span><span class="stringliteral">    ...               [ 0.    ,  0.    ,  0.    ,  0.    ],</span></div>
<div class="line"><span class="lineno"> 1450</span><span class="stringliteral">    ...               [ 0.    ,  0.    ,  0.7181,  0.2787],</span></div>
<div class="line"><span class="lineno"> 1451</span><span class="stringliteral">    ...               [ 0.    ,  0.    ,  0.6573,  0.3094]])</span></div>
<div class="line"><span class="lineno"> 1452</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1453</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.histogram(a, 0, 1, 10)</span></div>
<div class="line"><span class="lineno"> 1454</span><span class="stringliteral">    array([13,  0,  2,  1,  0,  1,  1,  2,  0,  0])</span></div>
<div class="line"><span class="lineno"> 1455</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1456</span><span class="stringliteral">    With labels and no indices, non-zero elements are counted:</span></div>
<div class="line"><span class="lineno"> 1457</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1458</span><span class="stringliteral">    &gt;&gt;&gt; lbl, nlbl = ndimage.label(a)</span></div>
<div class="line"><span class="lineno"> 1459</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.histogram(a, 0, 1, 10, lbl)</span></div>
<div class="line"><span class="lineno"> 1460</span><span class="stringliteral">    array([0, 0, 2, 1, 0, 1, 1, 2, 0, 0])</span></div>
<div class="line"><span class="lineno"> 1461</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1462</span><span class="stringliteral">    Indices can be used to count only certain objects:</span></div>
<div class="line"><span class="lineno"> 1463</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1464</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.histogram(a, 0, 1, 10, lbl, 2)</span></div>
<div class="line"><span class="lineno"> 1465</span><span class="stringliteral">    array([0, 0, 1, 1, 0, 0, 1, 1, 0, 0])</span></div>
<div class="line"><span class="lineno"> 1466</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1467</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1468</span>    _bins = numpy.linspace(min, max, bins + 1)</div>
<div class="line"><span class="lineno"> 1469</span> </div>
<div class="line"><span class="lineno"> 1470</span>    <span class="keyword">def </span>_hist(vals):</div>
<div class="line"><span class="lineno"> 1471</span>        <span class="keywordflow">return</span> numpy.histogram(vals, _bins)[0]</div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>    <span class="keywordflow">return</span> labeled_comprehension(input, labels, index, _hist, object, <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno"> 1474</span>                                 pass_positions=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1475</span> </div>
<div class="line"><span class="lineno"> 1476</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acd18adae08ab2f0a9bb59491bdca20da" name="acd18adae08ab2f0a9bb59491bdca20da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd18adae08ab2f0a9bb59491bdca20da">&#9670;&#160;</a></span>label()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.label </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Label features in an array.

Parameters
----------
input : array_like
    An array-like object to be labeled. Any non-zero values in `input` are
    counted as features and zero values are considered the background.
structure : array_like, optional
    A structuring element that defines feature connections.
    `structure` must be centrosymmetric
    (see Notes).
    If no structuring element is provided,
    one is automatically generated with a squared connectivity equal to
    one.  That is, for a 2-D `input` array, the default structuring element
    is::

        [[0,1,0],
         [1,1,1],
         [0,1,0]]

output : (None, data-type, array_like), optional
    If `output` is a data type, it specifies the type of the resulting
    labeled feature array.
    If `output` is an array-like object, then `output` will be updated
    with the labeled features from this function.  This function can
    operate in-place, by passing output=input.
    Note that the output must be able to store the largest label, or this
    function will raise an Exception.

Returns
-------
label : ndarray or int
    An integer ndarray where each unique feature in `input` has a unique
    label in the returned array.
num_features : int
    How many objects were found.

    If `output` is None, this function returns a tuple of
    (`labeled_array`, `num_features`).

    If `output` is a ndarray, then it will be updated with values in
    `labeled_array` and only `num_features` will be returned by this
    function.

See Also
--------
find_objects : generate a list of slices for the labeled features (or
               objects); useful for finding features' position or
               dimensions

Notes
-----
A centrosymmetric matrix is a matrix that is symmetric about the center.
See [1]_ for more information.

The `structure` matrix must be centrosymmetric to ensure
two-way connections.
For instance, if the `structure` matrix is not centrosymmetric
and is defined as::

    [[0,1,0],
     [1,1,0],
     [0,0,0]]

and the `input` is::

    [[1,2],
     [0,3]]

then the structure matrix would indicate the
entry 2 in the input is connected to 1,
but 1 is not connected to 2.

Examples
--------
Create an image with some features, then label it using the default
(cross-shaped) structuring element:

&gt;&gt;&gt; from scipy.ndimage import label, generate_binary_structure
&gt;&gt;&gt; a = np.array([[0,0,1,1,0,0],
...               [0,0,0,1,0,0],
...               [1,1,0,0,1,0],
...               [0,0,0,1,0,0]])
&gt;&gt;&gt; labeled_array, num_features = label(a)

Each of the 4 features are labeled with a different integer:

&gt;&gt;&gt; num_features
4
&gt;&gt;&gt; labeled_array
array([[0, 0, 1, 1, 0, 0],
       [0, 0, 0, 1, 0, 0],
       [2, 2, 0, 0, 3, 0],
       [0, 0, 0, 4, 0, 0]])

Generate a structuring element that will consider features connected even
if they touch diagonally:

&gt;&gt;&gt; s = generate_binary_structure(2,2)

or,

&gt;&gt;&gt; s = [[1,1,1],
...      [1,1,1],
...      [1,1,1]]

Label the image using the new structuring element:

&gt;&gt;&gt; labeled_array, num_features = label(a, structure=s)

Show the 2 labeled features (note that features 1, 3, and 4 from above are
now considered a single feature):

&gt;&gt;&gt; num_features
2
&gt;&gt;&gt; labeled_array
array([[0, 0, 1, 1, 0, 0],
       [0, 0, 0, 1, 0, 0],
       [2, 2, 0, 0, 1, 0],
       [0, 0, 0, 1, 0, 0]])

References
----------

.. [1] James R. Weaver, "Centrosymmetric (cross-symmetric)
   matrices, their basic properties, eigenvalues, and
   eigenvectors." The American Mathematical Monthly 92.10
   (1985): 711-717.</pre> <div class="fragment"><div class="line"><span class="lineno">   44</span><span class="keyword">def </span>label(input, structure=None, output=None):</div>
<div class="line"><span class="lineno">   45</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    Label features in an array.</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">        An array-like object to be labeled. Any non-zero values in `input` are</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">        counted as features and zero values are considered the background.</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">    structure : array_like, optional</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">        A structuring element that defines feature connections.</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">        `structure` must be centrosymmetric</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">        (see Notes).</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">        If no structuring element is provided,</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">        one is automatically generated with a squared connectivity equal to</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">        one.  That is, for a 2-D `input` array, the default structuring element</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">        is::</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">            [[0,1,0],</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">             [1,1,1],</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">             [0,1,0]]</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    output : (None, data-type, array_like), optional</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">        If `output` is a data type, it specifies the type of the resulting</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        labeled feature array.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">        If `output` is an array-like object, then `output` will be updated</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        with the labeled features from this function.  This function can</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">        operate in-place, by passing output=input.</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">        Note that the output must be able to store the largest label, or this</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        function will raise an Exception.</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    label : ndarray or int</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        An integer ndarray where each unique feature in `input` has a unique</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">        label in the returned array.</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    num_features : int</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">        How many objects were found.</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">        If `output` is None, this function returns a tuple of</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">        (`labeled_array`, `num_features`).</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        If `output` is a ndarray, then it will be updated with values in</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        `labeled_array` and only `num_features` will be returned by this</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">        function.</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    find_objects : generate a list of slices for the labeled features (or</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">                   objects); useful for finding features&#39; position or</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">                   dimensions</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    A centrosymmetric matrix is a matrix that is symmetric about the center.</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    See [1]_ for more information.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    The `structure` matrix must be centrosymmetric to ensure</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    two-way connections.</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    For instance, if the `structure` matrix is not centrosymmetric</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    and is defined as::</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">        [[0,1,0],</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">         [1,1,0],</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">         [0,0,0]]</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">    and the `input` is::</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">        [[1,2],</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">         [0,3]]</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">    then the structure matrix would indicate the</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">    entry 2 in the input is connected to 1,</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">    but 1 is not connected to 2.</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    Create an image with some features, then label it using the default</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    (cross-shaped) structuring element:</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.ndimage import label, generate_binary_structure</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[0,0,1,1,0,0],</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">    ...               [0,0,0,1,0,0],</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    ...               [1,1,0,0,1,0],</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    ...               [0,0,0,1,0,0]])</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    &gt;&gt;&gt; labeled_array, num_features = label(a)</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    Each of the 4 features are labeled with a different integer:</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    &gt;&gt;&gt; num_features</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    4</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    &gt;&gt;&gt; labeled_array</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    array([[0, 0, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">           [2, 2, 0, 0, 3, 0],</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">           [0, 0, 0, 4, 0, 0]])</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    Generate a structuring element that will consider features connected even</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">    if they touch diagonally:</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    &gt;&gt;&gt; s = generate_binary_structure(2,2)</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    or,</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    &gt;&gt;&gt; s = [[1,1,1],</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    ...      [1,1,1],</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">    ...      [1,1,1]]</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    Label the image using the new structuring element:</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    &gt;&gt;&gt; labeled_array, num_features = label(a, structure=s)</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    Show the 2 labeled features (note that features 1, 3, and 4 from above are</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    now considered a single feature):</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    &gt;&gt;&gt; num_features</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">    2</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    &gt;&gt;&gt; labeled_array</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">    array([[0, 0, 1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">           [2, 2, 0, 0, 1, 0],</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">           [0, 0, 0, 1, 0, 0]])</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    .. [1] James R. Weaver, &quot;Centrosymmetric (cross-symmetric)</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">       matrices, their basic properties, eigenvalues, and</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">       eigenvectors.&quot; The American Mathematical Monthly 92.10</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">       (1985): 711-717.</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  176</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">if</span> numpy.iscomplexobj(input):</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;Complex type not supported&#39;</span>)</div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">if</span> structure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  180</span>        structure = _morphology.generate_binary_structure(input.ndim, 1)</div>
<div class="line"><span class="lineno">  181</span>    structure = numpy.asarray(structure, dtype=bool)</div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">if</span> structure.ndim != input.ndim:</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;structure and input must have equal rank&#39;</span>)</div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> structure.shape:</div>
<div class="line"><span class="lineno">  185</span>        <span class="keywordflow">if</span> ii != 3:</div>
<div class="line"><span class="lineno">  186</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;structure dimensions must be equal to 3&#39;</span>)</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="comment"># Use 32 bits if it&#39;s large enough for this image.</span></div>
<div class="line"><span class="lineno">  189</span>    <span class="comment"># _ni_label.label() needs two entries for background and</span></div>
<div class="line"><span class="lineno">  190</span>    <span class="comment"># foreground tracking</span></div>
<div class="line"><span class="lineno">  191</span>    need_64bits = input.size &gt;= (2**31 - 2)</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">if</span> isinstance(output, numpy.ndarray):</div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">if</span> output.shape != input.shape:</div>
<div class="line"><span class="lineno">  195</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;output shape not correct&quot;</span>)</div>
<div class="line"><span class="lineno">  196</span>        caller_provided_output = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  198</span>        caller_provided_output = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  199</span>        <span class="keywordflow">if</span> output <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  200</span>            output = np.empty(input.shape, np.intp <span class="keywordflow">if</span> need_64bits <span class="keywordflow">else</span> np.int32)</div>
<div class="line"><span class="lineno">  201</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  202</span>            output = np.empty(input.shape, output)</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="comment"># handle scalars, 0-D arrays</span></div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">if</span> input.ndim == 0 <span class="keywordflow">or</span> input.size == 0:</div>
<div class="line"><span class="lineno">  206</span>        <span class="keywordflow">if</span> input.ndim == 0:</div>
<div class="line"><span class="lineno">  207</span>            <span class="comment"># scalar</span></div>
<div class="line"><span class="lineno">  208</span>            maxlabel = 1 <span class="keywordflow">if</span> (input != 0) <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  209</span>            output[...] = maxlabel</div>
<div class="line"><span class="lineno">  210</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  211</span>            <span class="comment"># 0-D</span></div>
<div class="line"><span class="lineno">  212</span>            maxlabel = 0</div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">if</span> caller_provided_output:</div>
<div class="line"><span class="lineno">  214</span>            <span class="keywordflow">return</span> maxlabel</div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  216</span>            <span class="keywordflow">return</span> output, maxlabel</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  219</span>        max_label = _ni_label._label(input, structure, output)</div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">except</span> _ni_label.NeedMoreBits <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  221</span>        <span class="comment"># Make another attempt with enough bits, then try to cast to the</span></div>
<div class="line"><span class="lineno">  222</span>        <span class="comment"># new type.</span></div>
<div class="line"><span class="lineno">  223</span>        tmp_output = np.empty(input.shape, np.intp <span class="keywordflow">if</span> need_64bits <span class="keywordflow">else</span> np.int32)</div>
<div class="line"><span class="lineno">  224</span>        max_label = _ni_label._label(input, structure, tmp_output)</div>
<div class="line"><span class="lineno">  225</span>        output[...] = tmp_output[...]</div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.all(output == tmp_output):</div>
<div class="line"><span class="lineno">  227</span>            <span class="comment"># refuse to return bad results</span></div>
<div class="line"><span class="lineno">  228</span>            <span class="keywordflow">raise</span> RuntimeError(</div>
<div class="line"><span class="lineno">  229</span>                <span class="stringliteral">&quot;insufficient bit-depth in requested output type&quot;</span></div>
<div class="line"><span class="lineno">  230</span>            ) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> caller_provided_output:</div>
<div class="line"><span class="lineno">  233</span>        <span class="comment"># result was written in-place</span></div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">return</span> max_label</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">return</span> output, max_label</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a260a352f74fc4d35b80f768fe18df021" name="a260a352f74fc4d35b80f768fe18df021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a260a352f74fc4d35b80f768fe18df021">&#9670;&#160;</a></span>labeled_comprehension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.labeled_comprehension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>default</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pass_positions</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Roughly equivalent to [func(input[labels == i]) for i in index].

Sequentially applies an arbitrary function (that works on array_like input)
to subsets of an N-D image array specified by `labels` and `index`.
The option exists to provide the function with positional parameters as the
second argument.

Parameters
----------
input : array_like
    Data from which to select `labels` to process.
labels : array_like or None
    Labels to objects in `input`.
    If not None, array must be same shape as `input`.
    If None, `func` is applied to raveled `input`.
index : int, sequence of ints or None
    Subset of `labels` to which to apply `func`.
    If a scalar, a single value is returned.
    If None, `func` is applied to all non-zero values of `labels`.
func : callable
    Python function to apply to `labels` from `input`.
out_dtype : dtype
    Dtype to use for `result`.
default : int, float or None
    Default return value when a element of `index` does not exist
    in `labels`.
pass_positions : bool, optional
    If True, pass linear indices to `func` as a second argument.
    Default is False.

Returns
-------
result : ndarray
    Result of applying `func` to each of `labels` to `input` in `index`.

Examples
--------
&gt;&gt;&gt; a = np.array([[1, 2, 0, 0],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; lbl, nlbl = ndimage.label(a)
&gt;&gt;&gt; lbls = np.arange(1, nlbl+1)
&gt;&gt;&gt; ndimage.labeled_comprehension(a, lbl, lbls, np.mean, float, 0)
array([ 2.75,  5.5 ,  6.  ])

Falling back to `default`:

&gt;&gt;&gt; lbls = np.arange(1, nlbl+2)
&gt;&gt;&gt; ndimage.labeled_comprehension(a, lbl, lbls, np.mean, float, -1)
array([ 2.75,  5.5 ,  6.  , -1.  ])

Passing positions:

&gt;&gt;&gt; def fn(val, pos):
...     print("fn says: %s : %s" % (val, pos))
...     return (val.sum()) if (pos.sum() % 2 == 0) else (-val.sum())
...
&gt;&gt;&gt; ndimage.labeled_comprehension(a, lbl, lbls, fn, float, 0, True)
fn says: [1 2 5 3] : [0 1 4 5]
fn says: [4 7] : [ 7 11]
fn says: [9 3] : [12 13]
array([ 11.,  11., -12.,   0.])</pre> <div class="fragment"><div class="line"><span class="lineno">  308</span><span class="keyword">def </span>labeled_comprehension(input, labels, index, func, out_dtype, default, pass_positions=False):</div>
<div class="line"><span class="lineno">  309</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    Roughly equivalent to [func(input[labels == i]) for i in index].</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">    Sequentially applies an arbitrary function (that works on array_like input)</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">    to subsets of an N-D image array specified by `labels` and `index`.</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">    The option exists to provide the function with positional parameters as the</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">    second argument.</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        Data from which to select `labels` to process.</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    labels : array_like or None</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">        Labels to objects in `input`.</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">        If not None, array must be same shape as `input`.</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        If None, `func` is applied to raveled `input`.</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    index : int, sequence of ints or None</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">        Subset of `labels` to which to apply `func`.</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        If a scalar, a single value is returned.</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">        If None, `func` is applied to all non-zero values of `labels`.</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">    func : callable</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">        Python function to apply to `labels` from `input`.</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    out_dtype : dtype</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">        Dtype to use for `result`.</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">    default : int, float or None</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">        Default return value when a element of `index` does not exist</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">        in `labels`.</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    pass_positions : bool, optional</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">        If True, pass linear indices to `func` as a second argument.</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">        Default is False.</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    result : ndarray</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">        Result of applying `func` to each of `labels` to `input` in `index`.</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">    &gt;&gt;&gt; lbl, nlbl = ndimage.label(a)</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    &gt;&gt;&gt; lbls = np.arange(1, nlbl+1)</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.labeled_comprehension(a, lbl, lbls, np.mean, float, 0)</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    array([ 2.75,  5.5 ,  6.  ])</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">    Falling back to `default`:</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    &gt;&gt;&gt; lbls = np.arange(1, nlbl+2)</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.labeled_comprehension(a, lbl, lbls, np.mean, float, -1)</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">    array([ 2.75,  5.5 ,  6.  , -1.  ])</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">    Passing positions:</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">    &gt;&gt;&gt; def fn(val, pos):</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">    ...     print(&quot;fn says: %s : %s&quot; % (val, pos))</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    ...     return (val.sum()) if (pos.sum() % 2 == 0) else (-val.sum())</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">    ...</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.labeled_comprehension(a, lbl, lbls, fn, float, 0, True)</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">    fn says: [1 2 5 3] : [0 1 4 5]</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">    fn says: [4 7] : [ 7 11]</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">    fn says: [9 3] : [12 13]</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">    array([ 11.,  11., -12.,   0.])</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>    as_scalar = numpy.isscalar(index)</div>
<div class="line"><span class="lineno">  378</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">if</span> pass_positions:</div>
<div class="line"><span class="lineno">  381</span>        positions = numpy.arange(input.size).reshape(input.shape)</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">if</span> labels <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">if</span> index <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  385</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;index without defined labels&quot;</span>)</div>
<div class="line"><span class="lineno">  386</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> pass_positions:</div>
<div class="line"><span class="lineno">  387</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(input.ravel())</div>
<div class="line"><span class="lineno">  388</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  389</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(input.ravel(), positions.ravel())</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  392</span>        input, labels = numpy.broadcast_arrays(input, labels)</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;input and labels must have the same shape &quot;</span></div>
<div class="line"><span class="lineno">  395</span>                            <span class="stringliteral">&quot;(excepting dimensions with width 1)&quot;</span>) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">if</span> index <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  398</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> pass_positions:</div>
<div class="line"><span class="lineno">  399</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(input[labels &gt; 0])</div>
<div class="line"><span class="lineno">  400</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  401</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(input[labels &gt; 0], positions[labels &gt; 0])</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>    index = numpy.atleast_1d(index)</div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">if</span> np.any(index.astype(labels.dtype).astype(index.dtype) != index):</div>
<div class="line"><span class="lineno">  405</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Cannot convert index values from &lt;%s&gt; to &lt;%s&gt; &quot;</span></div>
<div class="line"><span class="lineno">  406</span>                            <span class="stringliteral">&quot;(labels&#39; type) without loss of precision&quot;</span> %</div>
<div class="line"><span class="lineno">  407</span>                            (index.dtype, labels.dtype))</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    index = index.astype(labels.dtype)</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    <span class="comment"># optimization: find min/max in index, and select those parts of labels, input, and positions</span></div>
<div class="line"><span class="lineno">  412</span>    lo = index.min()</div>
<div class="line"><span class="lineno">  413</span>    hi = index.max()</div>
<div class="line"><span class="lineno">  414</span>    mask = (labels &gt;= lo) &amp; (labels &lt;= hi)</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    <span class="comment"># this also ravels the arrays</span></div>
<div class="line"><span class="lineno">  417</span>    labels = labels[mask]</div>
<div class="line"><span class="lineno">  418</span>    input = input[mask]</div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordflow">if</span> pass_positions:</div>
<div class="line"><span class="lineno">  420</span>        positions = positions[mask]</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>    <span class="comment"># sort everything by labels</span></div>
<div class="line"><span class="lineno">  423</span>    label_order = labels.argsort()</div>
<div class="line"><span class="lineno">  424</span>    labels = labels[label_order]</div>
<div class="line"><span class="lineno">  425</span>    input = input[label_order]</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">if</span> pass_positions:</div>
<div class="line"><span class="lineno">  427</span>        positions = positions[label_order]</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    index_order = index.argsort()</div>
<div class="line"><span class="lineno">  430</span>    sorted_index = index[index_order]</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="keyword">def </span>do_map(inputs, output):</div>
<div class="line"><span class="lineno">  433</span>        <span class="stringliteral">&quot;&quot;&quot;labels must be sorted&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  434</span>        nidx = sorted_index.size</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>        <span class="comment"># Find boundaries for each stretch of constant labels</span></div>
<div class="line"><span class="lineno">  437</span>        <span class="comment"># This could be faster, but we already paid N log N to sort labels.</span></div>
<div class="line"><span class="lineno">  438</span>        lo = numpy.searchsorted(labels, sorted_index, side=<span class="stringliteral">&#39;left&#39;</span>)</div>
<div class="line"><span class="lineno">  439</span>        hi = numpy.searchsorted(labels, sorted_index, side=<span class="stringliteral">&#39;right&#39;</span>)</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>        <span class="keywordflow">for</span> i, l, h <span class="keywordflow">in</span> zip(range(nidx), lo, hi):</div>
<div class="line"><span class="lineno">  442</span>            <span class="keywordflow">if</span> l == h:</div>
<div class="line"><span class="lineno">  443</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  444</span>            output[i] = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*[inp[l:h] <span class="keywordflow">for</span> inp <span class="keywordflow">in</span> inputs])</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>    temp = numpy.empty(index.shape, out_dtype)</div>
<div class="line"><span class="lineno">  447</span>    temp[:] = default</div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> pass_positions:</div>
<div class="line"><span class="lineno">  449</span>        do_map([input], temp)</div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  451</span>        do_map([input, positions], temp)</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>    output = numpy.zeros(index.shape, out_dtype)</div>
<div class="line"><span class="lineno">  454</span>    output[index_order] = temp</div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">if</span> as_scalar:</div>
<div class="line"><span class="lineno">  456</span>        output = output[0]</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    <span class="keywordflow">return</span> output</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a602599bfa35067292b5d41c02e248b28" name="a602599bfa35067292b5d41c02e248b28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a602599bfa35067292b5d41c02e248b28">&#9670;&#160;</a></span>maximum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.maximum </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the maximum of the values of an array over labeled regions.

Parameters
----------
input : array_like
    Array_like of values. For each region specified by `labels`, the
    maximal values of `input` over the region is computed.
labels : array_like, optional
    An array of integers marking different regions over which the
    maximum value of `input` is to be computed. `labels` must have the
    same shape as `input`. If `labels` is not specified, the maximum
    over the whole array is returned.
index : array_like, optional
    A list of region labels that are taken into account for computing the
    maxima. If index is None, the maximum over all elements where `labels`
    is non-zero is returned.

Returns
-------
output : float or list of floats
    List of maxima of `input` over the regions determined by `labels` and
    whose index is in `index`. If `index` or `labels` are not specified, a
    float is returned: the maximal value of `input` if `labels` is None,
    and the maximal value of elements where `labels` is greater than zero
    if `index` is None.

See Also
--------
label, minimum, median, maximum_position, extrema, sum, mean, variance,
standard_deviation

Notes
-----
The function returns a Python list and not a NumPy array, use
`np.array` to convert the list to an array.

Examples
--------
&gt;&gt;&gt; a = np.arange(16).reshape((4,4))
&gt;&gt;&gt; a
array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [12, 13, 14, 15]])
&gt;&gt;&gt; labels = np.zeros_like(a)
&gt;&gt;&gt; labels[:2,:2] = 1
&gt;&gt;&gt; labels[2:, 1:3] = 2
&gt;&gt;&gt; labels
array([[1, 1, 0, 0],
       [1, 1, 0, 0],
       [0, 2, 2, 0],
       [0, 2, 2, 0]])
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; ndimage.maximum(a)
15.0
&gt;&gt;&gt; ndimage.maximum(a, labels=labels, index=[1,2])
[5.0, 14.0]
&gt;&gt;&gt; ndimage.maximum(a, labels=labels)
14.0

&gt;&gt;&gt; b = np.array([[1, 2, 0, 0],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])
&gt;&gt;&gt; labels, labels_nb = ndimage.label(b)
&gt;&gt;&gt; labels
array([[1, 1, 0, 0],
       [1, 1, 0, 2],
       [0, 0, 0, 2],
       [3, 3, 0, 0]])
&gt;&gt;&gt; ndimage.maximum(b, labels=labels, index=np.arange(1, labels_nb + 1))
[5.0, 7.0, 9.0]</pre> <div class="fragment"><div class="line"><span class="lineno">  968</span><span class="keyword">def </span>maximum(input, labels=None, index=None):</div>
<div class="line"><span class="lineno">  969</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral">    Calculate the maximum of the values of an array over labeled regions.</span></div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">        Array_like of values. For each region specified by `labels`, the</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">        maximal values of `input` over the region is computed.</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">        An array of integers marking different regions over which the</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">        maximum value of `input` is to be computed. `labels` must have the</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">        same shape as `input`. If `labels` is not specified, the maximum</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">        over the whole array is returned.</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">    index : array_like, optional</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">        A list of region labels that are taken into account for computing the</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">        maxima. If index is None, the maximum over all elements where `labels`</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">        is non-zero is returned.</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">    output : float or list of floats</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">        List of maxima of `input` over the regions determined by `labels` and</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral">        whose index is in `index`. If `index` or `labels` are not specified, a</span></div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">        float is returned: the maximal value of `input` if `labels` is None,</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">        and the maximal value of elements where `labels` is greater than zero</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">        if `index` is None.</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">    label, minimum, median, maximum_position, extrema, sum, mean, variance,</span></div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">    standard_deviation</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1001</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1002</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1003</span><span class="stringliteral">    The function returns a Python list and not a NumPy array, use</span></div>
<div class="line"><span class="lineno"> 1004</span><span class="stringliteral">    `np.array` to convert the list to an array.</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1006</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1007</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1008</span><span class="stringliteral">    &gt;&gt;&gt; a = np.arange(16).reshape((4,4))</span></div>
<div class="line"><span class="lineno"> 1009</span><span class="stringliteral">    &gt;&gt;&gt; a</span></div>
<div class="line"><span class="lineno"> 1010</span><span class="stringliteral">    array([[ 0,  1,  2,  3],</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral">           [ 4,  5,  6,  7],</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral">           [ 8,  9, 10, 11],</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral">           [12, 13, 14, 15]])</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">    &gt;&gt;&gt; labels = np.zeros_like(a)</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="stringliteral">    &gt;&gt;&gt; labels[:2,:2] = 1</span></div>
<div class="line"><span class="lineno"> 1016</span><span class="stringliteral">    &gt;&gt;&gt; labels[2:, 1:3] = 2</span></div>
<div class="line"><span class="lineno"> 1017</span><span class="stringliteral">    &gt;&gt;&gt; labels</span></div>
<div class="line"><span class="lineno"> 1018</span><span class="stringliteral">    array([[1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1019</span><span class="stringliteral">           [1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral">           [0, 2, 2, 0],</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral">           [0, 2, 2, 0]])</span></div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.maximum(a)</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral">    15.0</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.maximum(a, labels=labels, index=[1,2])</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="stringliteral">    [5.0, 14.0]</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.maximum(a, labels=labels)</span></div>
<div class="line"><span class="lineno"> 1028</span><span class="stringliteral">    14.0</span></div>
<div class="line"><span class="lineno"> 1029</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1030</span><span class="stringliteral">    &gt;&gt;&gt; b = np.array([[1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1031</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno"> 1032</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno"> 1033</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral">    &gt;&gt;&gt; labels, labels_nb = ndimage.label(b)</span></div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral">    &gt;&gt;&gt; labels</span></div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral">    array([[1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral">           [1, 1, 0, 2],</span></div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">           [0, 0, 0, 2],</span></div>
<div class="line"><span class="lineno"> 1039</span><span class="stringliteral">           [3, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1040</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.maximum(b, labels=labels, index=np.arange(1, labels_nb + 1))</span></div>
<div class="line"><span class="lineno"> 1041</span><span class="stringliteral">    [5.0, 7.0, 9.0]</span></div>
<div class="line"><span class="lineno"> 1042</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1043</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1044</span>    <span class="keywordflow">return</span> _select(input, labels, index, find_max=<span class="keyword">True</span>)[0]</div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a64100b0a1521dad4c71215e840ede6f9" name="a64100b0a1521dad4c71215e840ede6f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64100b0a1521dad4c71215e840ede6f9">&#9670;&#160;</a></span>maximum_position()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.maximum_position </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find the positions of the maximums of the values of an array at labels.

For each region specified by `labels`, the position of the maximum
value of `input` within the region is returned.

Parameters
----------
input : array_like
    Array_like of values.
labels : array_like, optional
    An array of integers marking different regions over which the
    position of the maximum value of `input` is to be computed.
    `labels` must have the same shape as `input`. If `labels` is not
    specified, the location of the first maximum over the whole
    array is returned.

    The `labels` argument only works when `index` is specified.
index : array_like, optional
    A list of region labels that are taken into account for finding the
    location of the maxima. If `index` is None, the first maximum
    over all elements where `labels` is non-zero is returned.

    The `index` argument only works when `labels` is specified.

Returns
-------
output : list of tuples of ints
    List of tuples of ints that specify the location of maxima of
    `input` over the regions determined by `labels` and whose index
    is in `index`.

    If `index` or `labels` are not specified, a tuple of ints is
    returned specifying the location of the ``first`` maximal value
    of `input`.

See also
--------
label, minimum, median, maximum_position, extrema, sum, mean, variance,
standard_deviation

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.array([[1, 2, 0, 0],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])
&gt;&gt;&gt; ndimage.maximum_position(a)
(3, 0)

Features to process can be specified using `labels` and `index`:

&gt;&gt;&gt; lbl = np.array([[0, 1, 2, 3],
...                 [0, 1, 2, 3],
...                 [0, 1, 2, 3],
...                 [0, 1, 2, 3]])
&gt;&gt;&gt; ndimage.maximum_position(a, lbl, 1)
(1, 1)

If no index is given, non-zero `labels` are processed:

&gt;&gt;&gt; ndimage.maximum_position(a, lbl)
(2, 3)

If there are no maxima, the position of the first element is returned:

&gt;&gt;&gt; ndimage.maximum_position(a, lbl, 2)
(0, 2)</pre> <div class="fragment"><div class="line"><span class="lineno"> 1186</span><span class="keyword">def </span>maximum_position(input, labels=None, index=None):</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1188</span><span class="stringliteral">    Find the positions of the maximums of the values of an array at labels.</span></div>
<div class="line"><span class="lineno"> 1189</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1190</span><span class="stringliteral">    For each region specified by `labels`, the position of the maximum</span></div>
<div class="line"><span class="lineno"> 1191</span><span class="stringliteral">    value of `input` within the region is returned.</span></div>
<div class="line"><span class="lineno"> 1192</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1193</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1194</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1195</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1196</span><span class="stringliteral">        Array_like of values.</span></div>
<div class="line"><span class="lineno"> 1197</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno"> 1198</span><span class="stringliteral">        An array of integers marking different regions over which the</span></div>
<div class="line"><span class="lineno"> 1199</span><span class="stringliteral">        position of the maximum value of `input` is to be computed.</span></div>
<div class="line"><span class="lineno"> 1200</span><span class="stringliteral">        `labels` must have the same shape as `input`. If `labels` is not</span></div>
<div class="line"><span class="lineno"> 1201</span><span class="stringliteral">        specified, the location of the first maximum over the whole</span></div>
<div class="line"><span class="lineno"> 1202</span><span class="stringliteral">        array is returned.</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">        The `labels` argument only works when `index` is specified.</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral">    index : array_like, optional</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">        A list of region labels that are taken into account for finding the</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="stringliteral">        location of the maxima. If `index` is None, the first maximum</span></div>
<div class="line"><span class="lineno"> 1208</span><span class="stringliteral">        over all elements where `labels` is non-zero is returned.</span></div>
<div class="line"><span class="lineno"> 1209</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1210</span><span class="stringliteral">        The `index` argument only works when `labels` is specified.</span></div>
<div class="line"><span class="lineno"> 1211</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1212</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1214</span><span class="stringliteral">    output : list of tuples of ints</span></div>
<div class="line"><span class="lineno"> 1215</span><span class="stringliteral">        List of tuples of ints that specify the location of maxima of</span></div>
<div class="line"><span class="lineno"> 1216</span><span class="stringliteral">        `input` over the regions determined by `labels` and whose index</span></div>
<div class="line"><span class="lineno"> 1217</span><span class="stringliteral">        is in `index`.</span></div>
<div class="line"><span class="lineno"> 1218</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1219</span><span class="stringliteral">        If `index` or `labels` are not specified, a tuple of ints is</span></div>
<div class="line"><span class="lineno"> 1220</span><span class="stringliteral">        returned specifying the location of the ``first`` maximal value</span></div>
<div class="line"><span class="lineno"> 1221</span><span class="stringliteral">        of `input`.</span></div>
<div class="line"><span class="lineno"> 1222</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1223</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno"> 1224</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1225</span><span class="stringliteral">    label, minimum, median, maximum_position, extrema, sum, mean, variance,</span></div>
<div class="line"><span class="lineno"> 1226</span><span class="stringliteral">    standard_deviation</span></div>
<div class="line"><span class="lineno"> 1227</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1228</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1229</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1230</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1231</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno"> 1232</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno"> 1233</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno"> 1234</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1235</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.maximum_position(a)</span></div>
<div class="line"><span class="lineno"> 1236</span><span class="stringliteral">    (3, 0)</span></div>
<div class="line"><span class="lineno"> 1237</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1238</span><span class="stringliteral">    Features to process can be specified using `labels` and `index`:</span></div>
<div class="line"><span class="lineno"> 1239</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1240</span><span class="stringliteral">    &gt;&gt;&gt; lbl = np.array([[0, 1, 2, 3],</span></div>
<div class="line"><span class="lineno"> 1241</span><span class="stringliteral">    ...                 [0, 1, 2, 3],</span></div>
<div class="line"><span class="lineno"> 1242</span><span class="stringliteral">    ...                 [0, 1, 2, 3],</span></div>
<div class="line"><span class="lineno"> 1243</span><span class="stringliteral">    ...                 [0, 1, 2, 3]])</span></div>
<div class="line"><span class="lineno"> 1244</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.maximum_position(a, lbl, 1)</span></div>
<div class="line"><span class="lineno"> 1245</span><span class="stringliteral">    (1, 1)</span></div>
<div class="line"><span class="lineno"> 1246</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1247</span><span class="stringliteral">    If no index is given, non-zero `labels` are processed:</span></div>
<div class="line"><span class="lineno"> 1248</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1249</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.maximum_position(a, lbl)</span></div>
<div class="line"><span class="lineno"> 1250</span><span class="stringliteral">    (2, 3)</span></div>
<div class="line"><span class="lineno"> 1251</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1252</span><span class="stringliteral">    If there are no maxima, the position of the first element is returned:</span></div>
<div class="line"><span class="lineno"> 1253</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1254</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.maximum_position(a, lbl, 2)</span></div>
<div class="line"><span class="lineno"> 1255</span><span class="stringliteral">    (0, 2)</span></div>
<div class="line"><span class="lineno"> 1256</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1257</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1258</span>    dims = numpy.array(numpy.asarray(input).shape)</div>
<div class="line"><span class="lineno"> 1259</span>    <span class="comment"># see numpy.unravel_index to understand this line.</span></div>
<div class="line"><span class="lineno"> 1260</span>    dim_prod = numpy.cumprod([1] + list(dims[:0:-1]))[::-1]</div>
<div class="line"><span class="lineno"> 1261</span> </div>
<div class="line"><span class="lineno"> 1262</span>    result = _select(input, labels, index, find_max_positions=<span class="keyword">True</span>)[0]</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>    <span class="keywordflow">if</span> numpy.isscalar(result):</div>
<div class="line"><span class="lineno"> 1265</span>        <span class="keywordflow">return</span> tuple((result // dim_prod) % dims)</div>
<div class="line"><span class="lineno"> 1266</span> </div>
<div class="line"><span class="lineno"> 1267</span>    <span class="keywordflow">return</span> [tuple(v) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> (result.reshape(-1, 1) // dim_prod) % dims]</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d73c1376cb88d223685e7a9302979e8" name="a6d73c1376cb88d223685e7a9302979e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d73c1376cb88d223685e7a9302979e8">&#9670;&#160;</a></span>mean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.mean </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the mean of the values of an array at labels.

Parameters
----------
input : array_like
    Array on which to compute the mean of elements over distinct
    regions.
labels : array_like, optional
    Array of labels of same shape, or broadcastable to the same shape as
    `input`. All elements sharing the same label form one region over
    which the mean of the elements is computed.
index : int or sequence of ints, optional
    Labels of the objects over which the mean is to be computed.
    Default is None, in which case the mean for all values where label is
    greater than 0 is calculated.

Returns
-------
out : list
    Sequence of same length as `index`, with the mean of the different
    regions labeled by the labels in `index`.

See Also
--------
variance, standard_deviation, minimum, maximum, sum, label

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.arange(25).reshape((5,5))
&gt;&gt;&gt; labels = np.zeros_like(a)
&gt;&gt;&gt; labels[3:5,3:5] = 1
&gt;&gt;&gt; index = np.unique(labels)
&gt;&gt;&gt; labels
array([[0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 1, 1],
       [0, 0, 0, 1, 1]])
&gt;&gt;&gt; index
array([0, 1])
&gt;&gt;&gt; ndimage.mean(a, labels=labels, index=index)
[10.285714285714286, 21.0]</pre> <div class="fragment"><div class="line"><span class="lineno">  635</span><span class="keyword">def </span>mean(input, labels=None, index=None):</div>
<div class="line"><span class="lineno">  636</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">    Calculate the mean of the values of an array at labels.</span></div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">        Array on which to compute the mean of elements over distinct</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral">        regions.</span></div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">        Array of labels of same shape, or broadcastable to the same shape as</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">        `input`. All elements sharing the same label form one region over</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral">        which the mean of the elements is computed.</span></div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral">    index : int or sequence of ints, optional</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">        Labels of the objects over which the mean is to be computed.</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral">        Default is None, in which case the mean for all values where label is</span></div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">        greater than 0 is calculated.</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">    out : list</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">        Sequence of same length as `index`, with the mean of the different</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">        regions labeled by the labels in `index`.</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">    variance, standard_deviation, minimum, maximum, sum, label</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">    &gt;&gt;&gt; a = np.arange(25).reshape((5,5))</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">    &gt;&gt;&gt; labels = np.zeros_like(a)</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">    &gt;&gt;&gt; labels[3:5,3:5] = 1</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral">    &gt;&gt;&gt; index = np.unique(labels)</span></div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral">    &gt;&gt;&gt; labels</span></div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">    array([[0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">           [0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">           [0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">           [0, 0, 0, 1, 1],</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral">           [0, 0, 0, 1, 1]])</span></div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral">    &gt;&gt;&gt; index</span></div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral">    array([0, 1])</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.mean(a, labels=labels, index=index)</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">    [10.285714285714286, 21.0]</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>    count, sum = _stats(input, labels, index)</div>
<div class="line"><span class="lineno">  684</span>    <span class="keywordflow">return</span> sum / numpy.asanyarray(count).astype(numpy.float64)</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a659619a5c12296c7ee1b5cb2149d9b5b" name="a659619a5c12296c7ee1b5cb2149d9b5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a659619a5c12296c7ee1b5cb2149d9b5b">&#9670;&#160;</a></span>median()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.median </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the median of the values of an array over labeled regions.

Parameters
----------
input : array_like
    Array_like of values. For each region specified by `labels`, the
    median value of `input` over the region is computed.
labels : array_like, optional
    An array_like of integers marking different regions over which the
    median value of `input` is to be computed. `labels` must have the
    same shape as `input`. If `labels` is not specified, the median
    over the whole array is returned.
index : array_like, optional
    A list of region labels that are taken into account for computing the
    medians. If index is None, the median over all elements where `labels`
    is non-zero is returned.

Returns
-------
median : float or list of floats
    List of medians of `input` over the regions determined by `labels` and
    whose index is in `index`. If `index` or `labels` are not specified, a
    float is returned: the median value of `input` if `labels` is None,
    and the median value of elements where `labels` is greater than zero
    if `index` is None.

See Also
--------
label, minimum, maximum, extrema, sum, mean, variance, standard_deviation

Notes
-----
The function returns a Python list and not a NumPy array, use
`np.array` to convert the list to an array.

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.array([[1, 2, 0, 1],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])
&gt;&gt;&gt; labels, labels_nb = ndimage.label(a)
&gt;&gt;&gt; labels
array([[1, 1, 0, 2],
       [1, 1, 0, 2],
       [0, 0, 0, 2],
       [3, 3, 0, 0]])
&gt;&gt;&gt; ndimage.median(a, labels=labels, index=np.arange(1, labels_nb + 1))
[2.5, 4.0, 6.0]
&gt;&gt;&gt; ndimage.median(a)
1.0
&gt;&gt;&gt; ndimage.median(a, labels=labels)
3.0</pre> <div class="fragment"><div class="line"><span class="lineno"> 1047</span><span class="keyword">def </span>median(input, labels=None, index=None):</div>
<div class="line"><span class="lineno"> 1048</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral">    Calculate the median of the values of an array over labeled regions.</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">        Array_like of values. For each region specified by `labels`, the</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral">        median value of `input` over the region is computed.</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral">        An array_like of integers marking different regions over which the</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">        median value of `input` is to be computed. `labels` must have the</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral">        same shape as `input`. If `labels` is not specified, the median</span></div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral">        over the whole array is returned.</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral">    index : array_like, optional</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">        A list of region labels that are taken into account for computing the</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral">        medians. If index is None, the median over all elements where `labels`</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral">        is non-zero is returned.</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1066</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="stringliteral">    median : float or list of floats</span></div>
<div class="line"><span class="lineno"> 1069</span><span class="stringliteral">        List of medians of `input` over the regions determined by `labels` and</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="stringliteral">        whose index is in `index`. If `index` or `labels` are not specified, a</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="stringliteral">        float is returned: the median value of `input` if `labels` is None,</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="stringliteral">        and the median value of elements where `labels` is greater than zero</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="stringliteral">        if `index` is None.</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral">    label, minimum, maximum, extrema, sum, mean, variance, standard_deviation</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">    The function returns a Python list and not a NumPy array, use</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">    `np.array` to convert the list to an array.</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1084</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1085</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1086</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1087</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 2, 0, 1],</span></div>
<div class="line"><span class="lineno"> 1088</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno"> 1089</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno"> 1090</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1091</span><span class="stringliteral">    &gt;&gt;&gt; labels, labels_nb = ndimage.label(a)</span></div>
<div class="line"><span class="lineno"> 1092</span><span class="stringliteral">    &gt;&gt;&gt; labels</span></div>
<div class="line"><span class="lineno"> 1093</span><span class="stringliteral">    array([[1, 1, 0, 2],</span></div>
<div class="line"><span class="lineno"> 1094</span><span class="stringliteral">           [1, 1, 0, 2],</span></div>
<div class="line"><span class="lineno"> 1095</span><span class="stringliteral">           [0, 0, 0, 2],</span></div>
<div class="line"><span class="lineno"> 1096</span><span class="stringliteral">           [3, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1097</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.median(a, labels=labels, index=np.arange(1, labels_nb + 1))</span></div>
<div class="line"><span class="lineno"> 1098</span><span class="stringliteral">    [2.5, 4.0, 6.0]</span></div>
<div class="line"><span class="lineno"> 1099</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.median(a)</span></div>
<div class="line"><span class="lineno"> 1100</span><span class="stringliteral">    1.0</span></div>
<div class="line"><span class="lineno"> 1101</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.median(a, labels=labels)</span></div>
<div class="line"><span class="lineno"> 1102</span><span class="stringliteral">    3.0</span></div>
<div class="line"><span class="lineno"> 1103</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1104</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1105</span>    <span class="keywordflow">return</span> _select(input, labels, index, find_median=<span class="keyword">True</span>)[0]</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8237970ae2bcc52d16c50ffa94d2f1ef" name="a8237970ae2bcc52d16c50ffa94d2f1ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8237970ae2bcc52d16c50ffa94d2f1ef">&#9670;&#160;</a></span>minimum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.minimum </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the minimum of the values of an array over labeled regions.

Parameters
----------
input : array_like
    Array_like of values. For each region specified by `labels`, the
    minimal values of `input` over the region is computed.
labels : array_like, optional
    An array_like of integers marking different regions over which the
    minimum value of `input` is to be computed. `labels` must have the
    same shape as `input`. If `labels` is not specified, the minimum
    over the whole array is returned.
index : array_like, optional
    A list of region labels that are taken into account for computing the
    minima. If index is None, the minimum over all elements where `labels`
    is non-zero is returned.

Returns
-------
minimum : float or list of floats
    List of minima of `input` over the regions determined by `labels` and
    whose index is in `index`. If `index` or `labels` are not specified, a
    float is returned: the minimal value of `input` if `labels` is None,
    and the minimal value of elements where `labels` is greater than zero
    if `index` is None.

See Also
--------
label, maximum, median, minimum_position, extrema, sum, mean, variance,
standard_deviation

Notes
-----
The function returns a Python list and not a NumPy array, use
`np.array` to convert the list to an array.

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; a = np.array([[1, 2, 0, 0],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])
&gt;&gt;&gt; labels, labels_nb = ndimage.label(a)
&gt;&gt;&gt; labels
array([[1, 1, 0, 0],
       [1, 1, 0, 2],
       [0, 0, 0, 2],
       [3, 3, 0, 0]])
&gt;&gt;&gt; ndimage.minimum(a, labels=labels, index=np.arange(1, labels_nb + 1))
[1.0, 4.0, 3.0]
&gt;&gt;&gt; ndimage.minimum(a)
0.0
&gt;&gt;&gt; ndimage.minimum(a, labels=labels)
1.0</pre> <div class="fragment"><div class="line"><span class="lineno">  906</span><span class="keyword">def </span>minimum(input, labels=None, index=None):</div>
<div class="line"><span class="lineno">  907</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">    Calculate the minimum of the values of an array over labeled regions.</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral">        Array_like of values. For each region specified by `labels`, the</span></div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">        minimal values of `input` over the region is computed.</span></div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral">        An array_like of integers marking different regions over which the</span></div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">        minimum value of `input` is to be computed. `labels` must have the</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">        same shape as `input`. If `labels` is not specified, the minimum</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">        over the whole array is returned.</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral">    index : array_like, optional</span></div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral">        A list of region labels that are taken into account for computing the</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">        minima. If index is None, the minimum over all elements where `labels`</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral">        is non-zero is returned.</span></div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">    minimum : float or list of floats</span></div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral">        List of minima of `input` over the regions determined by `labels` and</span></div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral">        whose index is in `index`. If `index` or `labels` are not specified, a</span></div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral">        float is returned: the minimal value of `input` if `labels` is None,</span></div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral">        and the minimal value of elements where `labels` is greater than zero</span></div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral">        if `index` is None.</span></div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">    label, maximum, median, minimum_position, extrema, sum, mean, variance,</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">    standard_deviation</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  940</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  941</span><span class="stringliteral">    The function returns a Python list and not a NumPy array, use</span></div>
<div class="line"><span class="lineno">  942</span><span class="stringliteral">    `np.array` to convert the list to an array.</span></div>
<div class="line"><span class="lineno">  943</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  944</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  945</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  946</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    &gt;&gt;&gt; labels, labels_nb = ndimage.label(a)</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">    &gt;&gt;&gt; labels</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral">    array([[1, 1, 0, 0],</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">           [1, 1, 0, 2],</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">           [0, 0, 0, 2],</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">           [3, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.minimum(a, labels=labels, index=np.arange(1, labels_nb + 1))</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">    [1.0, 4.0, 3.0]</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.minimum(a)</span></div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    0.0</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.minimum(a, labels=labels)</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">    1.0</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  965</span>    <span class="keywordflow">return</span> _select(input, labels, index, find_min=<span class="keyword">True</span>)[0]</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bd5270f7a6873182ffc034149fd0db6" name="a0bd5270f7a6873182ffc034149fd0db6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bd5270f7a6873182ffc034149fd0db6">&#9670;&#160;</a></span>minimum_position()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.minimum_position </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find the positions of the minimums of the values of an array at labels.

Parameters
----------
input : array_like
    Array_like of values.
labels : array_like, optional
    An array of integers marking different regions over which the
    position of the minimum value of `input` is to be computed.
    `labels` must have the same shape as `input`. If `labels` is not
    specified, the location of the first minimum over the whole
    array is returned.

    The `labels` argument only works when `index` is specified.
index : array_like, optional
    A list of region labels that are taken into account for finding the
    location of the minima. If `index` is None, the ``first`` minimum
    over all elements where `labels` is non-zero is returned.

    The `index` argument only works when `labels` is specified.

Returns
-------
output : list of tuples of ints
    Tuple of ints or list of tuples of ints that specify the location
    of minima of `input` over the regions determined by `labels` and
    whose index is in `index`.

    If `index` or `labels` are not specified, a tuple of ints is
    returned specifying the location of the first minimal value of `input`.

See Also
--------
label, minimum, median, maximum_position, extrema, sum, mean, variance,
standard_deviation

Examples
--------
&gt;&gt;&gt; a = np.array([[10, 20, 30],
...               [40, 80, 100],
...               [1, 100, 200]])
&gt;&gt;&gt; b = np.array([[1, 2, 0, 1],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])

&gt;&gt;&gt; from scipy import ndimage

&gt;&gt;&gt; ndimage.minimum_position(a)
(2, 0)
&gt;&gt;&gt; ndimage.minimum_position(b)
(0, 2)

Features to process can be specified using `labels` and `index`:

&gt;&gt;&gt; label, pos = ndimage.label(a)
&gt;&gt;&gt; ndimage.minimum_position(a, label, index=np.arange(1, pos+1))
[(2, 0)]

&gt;&gt;&gt; label, pos = ndimage.label(b)
&gt;&gt;&gt; ndimage.minimum_position(b, label, index=np.arange(1, pos+1))
[(0, 0), (0, 3), (3, 1)]</pre> <div class="fragment"><div class="line"><span class="lineno"> 1108</span><span class="keyword">def </span>minimum_position(input, labels=None, index=None):</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1110</span><span class="stringliteral">    Find the positions of the minimums of the values of an array at labels.</span></div>
<div class="line"><span class="lineno"> 1111</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1112</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1113</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1114</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1115</span><span class="stringliteral">        Array_like of values.</span></div>
<div class="line"><span class="lineno"> 1116</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno"> 1117</span><span class="stringliteral">        An array of integers marking different regions over which the</span></div>
<div class="line"><span class="lineno"> 1118</span><span class="stringliteral">        position of the minimum value of `input` is to be computed.</span></div>
<div class="line"><span class="lineno"> 1119</span><span class="stringliteral">        `labels` must have the same shape as `input`. If `labels` is not</span></div>
<div class="line"><span class="lineno"> 1120</span><span class="stringliteral">        specified, the location of the first minimum over the whole</span></div>
<div class="line"><span class="lineno"> 1121</span><span class="stringliteral">        array is returned.</span></div>
<div class="line"><span class="lineno"> 1122</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1123</span><span class="stringliteral">        The `labels` argument only works when `index` is specified.</span></div>
<div class="line"><span class="lineno"> 1124</span><span class="stringliteral">    index : array_like, optional</span></div>
<div class="line"><span class="lineno"> 1125</span><span class="stringliteral">        A list of region labels that are taken into account for finding the</span></div>
<div class="line"><span class="lineno"> 1126</span><span class="stringliteral">        location of the minima. If `index` is None, the ``first`` minimum</span></div>
<div class="line"><span class="lineno"> 1127</span><span class="stringliteral">        over all elements where `labels` is non-zero is returned.</span></div>
<div class="line"><span class="lineno"> 1128</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1129</span><span class="stringliteral">        The `index` argument only works when `labels` is specified.</span></div>
<div class="line"><span class="lineno"> 1130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1131</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1132</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1133</span><span class="stringliteral">    output : list of tuples of ints</span></div>
<div class="line"><span class="lineno"> 1134</span><span class="stringliteral">        Tuple of ints or list of tuples of ints that specify the location</span></div>
<div class="line"><span class="lineno"> 1135</span><span class="stringliteral">        of minima of `input` over the regions determined by `labels` and</span></div>
<div class="line"><span class="lineno"> 1136</span><span class="stringliteral">        whose index is in `index`.</span></div>
<div class="line"><span class="lineno"> 1137</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1138</span><span class="stringliteral">        If `index` or `labels` are not specified, a tuple of ints is</span></div>
<div class="line"><span class="lineno"> 1139</span><span class="stringliteral">        returned specifying the location of the first minimal value of `input`.</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1141</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno"> 1142</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="stringliteral">    label, minimum, median, maximum_position, extrema, sum, mean, variance,</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="stringliteral">    standard_deviation</span></div>
<div class="line"><span class="lineno"> 1145</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1146</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1147</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1148</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[10, 20, 30],</span></div>
<div class="line"><span class="lineno"> 1149</span><span class="stringliteral">    ...               [40, 80, 100],</span></div>
<div class="line"><span class="lineno"> 1150</span><span class="stringliteral">    ...               [1, 100, 200]])</span></div>
<div class="line"><span class="lineno"> 1151</span><span class="stringliteral">    &gt;&gt;&gt; b = np.array([[1, 2, 0, 1],</span></div>
<div class="line"><span class="lineno"> 1152</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno"> 1153</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno"> 1154</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno"> 1155</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1156</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno"> 1157</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1158</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.minimum_position(a)</span></div>
<div class="line"><span class="lineno"> 1159</span><span class="stringliteral">    (2, 0)</span></div>
<div class="line"><span class="lineno"> 1160</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.minimum_position(b)</span></div>
<div class="line"><span class="lineno"> 1161</span><span class="stringliteral">    (0, 2)</span></div>
<div class="line"><span class="lineno"> 1162</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1163</span><span class="stringliteral">    Features to process can be specified using `labels` and `index`:</span></div>
<div class="line"><span class="lineno"> 1164</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1165</span><span class="stringliteral">    &gt;&gt;&gt; label, pos = ndimage.label(a)</span></div>
<div class="line"><span class="lineno"> 1166</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.minimum_position(a, label, index=np.arange(1, pos+1))</span></div>
<div class="line"><span class="lineno"> 1167</span><span class="stringliteral">    [(2, 0)]</span></div>
<div class="line"><span class="lineno"> 1168</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1169</span><span class="stringliteral">    &gt;&gt;&gt; label, pos = ndimage.label(b)</span></div>
<div class="line"><span class="lineno"> 1170</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.minimum_position(b, label, index=np.arange(1, pos+1))</span></div>
<div class="line"><span class="lineno"> 1171</span><span class="stringliteral">    [(0, 0), (0, 3), (3, 1)]</span></div>
<div class="line"><span class="lineno"> 1172</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1173</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1174</span>    dims = numpy.array(numpy.asarray(input).shape)</div>
<div class="line"><span class="lineno"> 1175</span>    <span class="comment"># see numpy.unravel_index to understand this line.</span></div>
<div class="line"><span class="lineno"> 1176</span>    dim_prod = numpy.cumprod([1] + list(dims[:0:-1]))[::-1]</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>    result = _select(input, labels, index, find_min_positions=<span class="keyword">True</span>)[0]</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>    <span class="keywordflow">if</span> numpy.isscalar(result):</div>
<div class="line"><span class="lineno"> 1181</span>        <span class="keywordflow">return</span> tuple((result // dim_prod) % dims)</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>    <span class="keywordflow">return</span> [tuple(v) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> (result.reshape(-1, 1) // dim_prod) % dims]</div>
<div class="line"><span class="lineno"> 1184</span> </div>
<div class="line"><span class="lineno"> 1185</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fcfcde86ce25ec5c83d41a3dcd8c5e8" name="a5fcfcde86ce25ec5c83d41a3dcd8c5e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fcfcde86ce25ec5c83d41a3dcd8c5e8">&#9670;&#160;</a></span>standard_deviation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.standard_deviation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the standard deviation of the values of an N-D image array,
optionally at specified sub-regions.

Parameters
----------
input : array_like
    N-D image data to process.
labels : array_like, optional
    Labels to identify sub-regions in `input`.
    If not None, must be same shape as `input`.
index : int or sequence of ints, optional
    `labels` to include in output. If None (default), all values where
    `labels` is non-zero are used.

Returns
-------
standard_deviation : float or ndarray
    Values of standard deviation, for each sub-region if `labels` and
    `index` are specified.

See Also
--------
label, variance, maximum, minimum, extrema

Examples
--------
&gt;&gt;&gt; a = np.array([[1, 2, 0, 0],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; ndimage.standard_deviation(a)
2.7585095613392387

Features to process can be specified using `labels` and `index`:

&gt;&gt;&gt; lbl, nlbl = ndimage.label(a)
&gt;&gt;&gt; ndimage.standard_deviation(a, lbl, index=np.arange(1, nlbl+1))
array([ 1.479,  1.5  ,  3.   ])

If no index is given, non-zero `labels` are processed:

&gt;&gt;&gt; ndimage.standard_deviation(a, lbl)
2.4874685927665499</pre> <div class="fragment"><div class="line"><span class="lineno">  739</span><span class="keyword">def </span>standard_deviation(input, labels=None, index=None):</div>
<div class="line"><span class="lineno">  740</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">    Calculate the standard deviation of the values of an N-D image array,</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">    optionally at specified sub-regions.</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral">        N-D image data to process.</span></div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral">        Labels to identify sub-regions in `input`.</span></div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral">        If not None, must be same shape as `input`.</span></div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral">    index : int or sequence of ints, optional</span></div>
<div class="line"><span class="lineno">  752</span><span class="stringliteral">        `labels` to include in output. If None (default), all values where</span></div>
<div class="line"><span class="lineno">  753</span><span class="stringliteral">        `labels` is non-zero are used.</span></div>
<div class="line"><span class="lineno">  754</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  755</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  756</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  757</span><span class="stringliteral">    standard_deviation : float or ndarray</span></div>
<div class="line"><span class="lineno">  758</span><span class="stringliteral">        Values of standard deviation, for each sub-region if `labels` and</span></div>
<div class="line"><span class="lineno">  759</span><span class="stringliteral">        `index` are specified.</span></div>
<div class="line"><span class="lineno">  760</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  761</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  762</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  763</span><span class="stringliteral">    label, variance, maximum, minimum, extrema</span></div>
<div class="line"><span class="lineno">  764</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  765</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  766</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  767</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno">  768</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno">  769</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno">  770</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno">  771</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  772</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.standard_deviation(a)</span></div>
<div class="line"><span class="lineno">  773</span><span class="stringliteral">    2.7585095613392387</span></div>
<div class="line"><span class="lineno">  774</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  775</span><span class="stringliteral">    Features to process can be specified using `labels` and `index`:</span></div>
<div class="line"><span class="lineno">  776</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  777</span><span class="stringliteral">    &gt;&gt;&gt; lbl, nlbl = ndimage.label(a)</span></div>
<div class="line"><span class="lineno">  778</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.standard_deviation(a, lbl, index=np.arange(1, nlbl+1))</span></div>
<div class="line"><span class="lineno">  779</span><span class="stringliteral">    array([ 1.479,  1.5  ,  3.   ])</span></div>
<div class="line"><span class="lineno">  780</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  781</span><span class="stringliteral">    If no index is given, non-zero `labels` are processed:</span></div>
<div class="line"><span class="lineno">  782</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  783</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.standard_deviation(a, lbl)</span></div>
<div class="line"><span class="lineno">  784</span><span class="stringliteral">    2.4874685927665499</span></div>
<div class="line"><span class="lineno">  785</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  786</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">return</span> numpy.sqrt(variance(input, labels, index))</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af33d5bd105bc783aaad2fd63ff192e54" name="af33d5bd105bc783aaad2fd63ff192e54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af33d5bd105bc783aaad2fd63ff192e54">&#9670;&#160;</a></span>sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.sum </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the sum of the values of the array.

Notes
-----
This is an alias for `ndimage.sum_labels` kept for backwards compatibility
reasons, for new code please prefer `sum_labels`.  See the `sum_labels`
docstring for more details.</pre> <div class="fragment"><div class="line"><span class="lineno">  576</span><span class="keyword">def </span>sum(input, labels=None, index=None):</div>
<div class="line"><span class="lineno">  577</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">    Calculate the sum of the values of the array.</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">    This is an alias for `ndimage.sum_labels` kept for backwards compatibility</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral">    reasons, for new code please prefer `sum_labels`.  See the `sum_labels`</span></div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">    docstring for more details.</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  587</span>    <span class="keywordflow">return</span> sum_labels(input, labels, index)</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b66f3a839b4d796c81486803a302b44" name="a9b66f3a839b4d796c81486803a302b44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b66f3a839b4d796c81486803a302b44">&#9670;&#160;</a></span>sum_labels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.sum_labels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the sum of the values of the array.

Parameters
----------
input : array_like
    Values of `input` inside the regions defined by `labels`
    are summed together.
labels : array_like of ints, optional
    Assign labels to the values of the array. Has to have the same shape as
    `input`.
index : array_like, optional
    A single label number or a sequence of label numbers of
    the objects to be measured.

Returns
-------
sum : ndarray or scalar
    An array of the sums of values of `input` inside the regions defined
    by `labels` with the same shape as `index`. If 'index' is None or scalar,
    a scalar is returned.

See Also
--------
mean, median

Examples
--------
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; input =  [0,1,2,3]
&gt;&gt;&gt; labels = [1,1,2,2]
&gt;&gt;&gt; ndimage.sum_labels(input, labels, index=[1,2])
[1.0, 5.0]
&gt;&gt;&gt; ndimage.sum_labels(input, labels, index=1)
1
&gt;&gt;&gt; ndimage.sum_labels(input, labels)
6</pre> <div class="fragment"><div class="line"><span class="lineno">  590</span><span class="keyword">def </span>sum_labels(input, labels=None, index=None):</div>
<div class="line"><span class="lineno">  591</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">    Calculate the sum of the values of the array.</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral">        Values of `input` inside the regions defined by `labels`</span></div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">        are summed together.</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">    labels : array_like of ints, optional</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral">        Assign labels to the values of the array. Has to have the same shape as</span></div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral">        `input`.</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">    index : array_like, optional</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">        A single label number or a sequence of label numbers of</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">        the objects to be measured.</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">    sum : ndarray or scalar</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral">        An array of the sums of values of `input` inside the regions defined</span></div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral">        by `labels` with the same shape as `index`. If &#39;index&#39; is None or scalar,</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">        a scalar is returned.</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  615</span><span class="stringliteral">    mean, median</span></div>
<div class="line"><span class="lineno">  616</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  617</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral">    &gt;&gt;&gt; input =  [0,1,2,3]</span></div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral">    &gt;&gt;&gt; labels = [1,1,2,2]</span></div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.sum_labels(input, labels, index=[1,2])</span></div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral">    [1.0, 5.0]</span></div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.sum_labels(input, labels, index=1)</span></div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">    1</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.sum_labels(input, labels)</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">    6</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  631</span>    count, sum = _stats(input, labels, index)</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">return</span> sum</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab57b2e6d048f4c85575fe47af356dca8" name="ab57b2e6d048f4c85575fe47af356dca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab57b2e6d048f4c85575fe47af356dca8">&#9670;&#160;</a></span>variance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.variance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the variance of the values of an N-D image array, optionally at
specified sub-regions.

Parameters
----------
input : array_like
    Nd-image data to process.
labels : array_like, optional
    Labels defining sub-regions in `input`.
    If not None, must be same shape as `input`.
index : int or sequence of ints, optional
    `labels` to include in output.  If None (default), all values where
    `labels` is non-zero are used.

Returns
-------
variance : float or ndarray
    Values of variance, for each sub-region if `labels` and `index` are
    specified.

See Also
--------
label, standard_deviation, maximum, minimum, extrema

Examples
--------
&gt;&gt;&gt; a = np.array([[1, 2, 0, 0],
...               [5, 3, 0, 4],
...               [0, 0, 0, 7],
...               [9, 3, 0, 0]])
&gt;&gt;&gt; from scipy import ndimage
&gt;&gt;&gt; ndimage.variance(a)
7.609375

Features to process can be specified using `labels` and `index`:

&gt;&gt;&gt; lbl, nlbl = ndimage.label(a)
&gt;&gt;&gt; ndimage.variance(a, lbl, index=np.arange(1, nlbl+1))
array([ 2.1875,  2.25  ,  9.    ])

If no index is given, all non-zero `labels` are processed:

&gt;&gt;&gt; ndimage.variance(a, lbl)
6.1875</pre> <div class="fragment"><div class="line"><span class="lineno">  687</span><span class="keyword">def </span>variance(input, labels=None, index=None):</div>
<div class="line"><span class="lineno">  688</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral">    Calculate the variance of the values of an N-D image array, optionally at</span></div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral">    specified sub-regions.</span></div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral">        Nd-image data to process.</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral">    labels : array_like, optional</span></div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">        Labels defining sub-regions in `input`.</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">        If not None, must be same shape as `input`.</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">    index : int or sequence of ints, optional</span></div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral">        `labels` to include in output.  If None (default), all values where</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">        `labels` is non-zero are used.</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral">    variance : float or ndarray</span></div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral">        Values of variance, for each sub-region if `labels` and `index` are</span></div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral">        specified.</span></div>
<div class="line"><span class="lineno">  708</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  709</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral">    label, standard_deviation, maximum, minimum, extrema</span></div>
<div class="line"><span class="lineno">  712</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  713</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 2, 0, 0],</span></div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">    ...               [5, 3, 0, 4],</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">    ...               [0, 0, 0, 7],</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">    ...               [9, 3, 0, 0]])</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import ndimage</span></div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.variance(a)</span></div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral">    7.609375</span></div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">    Features to process can be specified using `labels` and `index`:</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">    &gt;&gt;&gt; lbl, nlbl = ndimage.label(a)</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.variance(a, lbl, index=np.arange(1, nlbl+1))</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral">    array([ 2.1875,  2.25  ,  9.    ])</span></div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">    If no index is given, all non-zero `labels` are processed:</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">    &gt;&gt;&gt; ndimage.variance(a, lbl)</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">    6.1875</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  735</span>    count, sum, sum_c_sq = _stats(input, labels, index, centered=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordflow">return</span> sum_c_sq / np.asanyarray(count).astype(float)</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a290134c166e65518735205b48afa5a13" name="a290134c166e65518735205b48afa5a13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a290134c166e65518735205b48afa5a13">&#9670;&#160;</a></span>watershed_ift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.ndimage._measurements.watershed_ift </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>markers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Apply watershed from markers using image foresting transform algorithm.

Parameters
----------
input : array_like
    Input.
markers : array_like
    Markers are points within each watershed that form the beginning
    of the process. Negative markers are considered background markers
    which are processed after the other markers.
structure : structure element, optional
    A structuring element defining the connectivity of the object can be
    provided. If None, an element is generated with a squared
    connectivity equal to one.
output : ndarray, optional
    An output array can optionally be provided. The same shape as input.

Returns
-------
watershed_ift : ndarray
    Output.  Same shape as `input`.

References
----------
.. [1] A.X. Falcao, J. Stolfi and R. de Alencar Lotufo, "The image
       foresting transform: theory, algorithms, and applications",
       Pattern Analysis and Machine Intelligence, vol. 26, pp. 19-29, 2004.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1477</span><span class="keyword">def </span>watershed_ift(input, markers, structure=None, output=None):</div>
<div class="line"><span class="lineno"> 1478</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1479</span><span class="stringliteral">    Apply watershed from markers using image foresting transform algorithm.</span></div>
<div class="line"><span class="lineno"> 1480</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1481</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 1482</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1483</span><span class="stringliteral">    input : array_like</span></div>
<div class="line"><span class="lineno"> 1484</span><span class="stringliteral">        Input.</span></div>
<div class="line"><span class="lineno"> 1485</span><span class="stringliteral">    markers : array_like</span></div>
<div class="line"><span class="lineno"> 1486</span><span class="stringliteral">        Markers are points within each watershed that form the beginning</span></div>
<div class="line"><span class="lineno"> 1487</span><span class="stringliteral">        of the process. Negative markers are considered background markers</span></div>
<div class="line"><span class="lineno"> 1488</span><span class="stringliteral">        which are processed after the other markers.</span></div>
<div class="line"><span class="lineno"> 1489</span><span class="stringliteral">    structure : structure element, optional</span></div>
<div class="line"><span class="lineno"> 1490</span><span class="stringliteral">        A structuring element defining the connectivity of the object can be</span></div>
<div class="line"><span class="lineno"> 1491</span><span class="stringliteral">        provided. If None, an element is generated with a squared</span></div>
<div class="line"><span class="lineno"> 1492</span><span class="stringliteral">        connectivity equal to one.</span></div>
<div class="line"><span class="lineno"> 1493</span><span class="stringliteral">    output : ndarray, optional</span></div>
<div class="line"><span class="lineno"> 1494</span><span class="stringliteral">        An output array can optionally be provided. The same shape as input.</span></div>
<div class="line"><span class="lineno"> 1495</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1496</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 1497</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 1498</span><span class="stringliteral">    watershed_ift : ndarray</span></div>
<div class="line"><span class="lineno"> 1499</span><span class="stringliteral">        Output.  Same shape as `input`.</span></div>
<div class="line"><span class="lineno"> 1500</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1501</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1502</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1503</span><span class="stringliteral">    .. [1] A.X. Falcao, J. Stolfi and R. de Alencar Lotufo, &quot;The image</span></div>
<div class="line"><span class="lineno"> 1504</span><span class="stringliteral">           foresting transform: theory, algorithms, and applications&quot;,</span></div>
<div class="line"><span class="lineno"> 1505</span><span class="stringliteral">           Pattern Analysis and Machine Intelligence, vol. 26, pp. 19-29, 2004.</span></div>
<div class="line"><span class="lineno"> 1506</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1507</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1508</span>    input = numpy.asarray(input)</div>
<div class="line"><span class="lineno"> 1509</span>    <span class="keywordflow">if</span> input.dtype.type <span class="keywordflow">not</span> <span class="keywordflow">in</span> [numpy.uint8, numpy.uint16]:</div>
<div class="line"><span class="lineno"> 1510</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;only 8 and 16 unsigned inputs are supported&#39;</span>)</div>
<div class="line"><span class="lineno"> 1511</span> </div>
<div class="line"><span class="lineno"> 1512</span>    <span class="keywordflow">if</span> structure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1513</span>        structure = _morphology.generate_binary_structure(input.ndim, 1)</div>
<div class="line"><span class="lineno"> 1514</span>    structure = numpy.asarray(structure, dtype=bool)</div>
<div class="line"><span class="lineno"> 1515</span>    <span class="keywordflow">if</span> structure.ndim != input.ndim:</div>
<div class="line"><span class="lineno"> 1516</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;structure and input must have equal rank&#39;</span>)</div>
<div class="line"><span class="lineno"> 1517</span>    <span class="keywordflow">for</span> ii <span class="keywordflow">in</span> structure.shape:</div>
<div class="line"><span class="lineno"> 1518</span>        <span class="keywordflow">if</span> ii != 3:</div>
<div class="line"><span class="lineno"> 1519</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;structure dimensions must be equal to 3&#39;</span>)</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> structure.flags.contiguous:</div>
<div class="line"><span class="lineno"> 1522</span>        structure = structure.copy()</div>
<div class="line"><span class="lineno"> 1523</span>    markers = numpy.asarray(markers)</div>
<div class="line"><span class="lineno"> 1524</span>    <span class="keywordflow">if</span> input.shape != markers.shape:</div>
<div class="line"><span class="lineno"> 1525</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;input and markers must have equal shape&#39;</span>)</div>
<div class="line"><span class="lineno"> 1526</span> </div>
<div class="line"><span class="lineno"> 1527</span>    integral_types = [numpy.int0,</div>
<div class="line"><span class="lineno"> 1528</span>                      numpy.int8,</div>
<div class="line"><span class="lineno"> 1529</span>                      numpy.int16,</div>
<div class="line"><span class="lineno"> 1530</span>                      numpy.int32,</div>
<div class="line"><span class="lineno"> 1531</span>                      numpy.int_,</div>
<div class="line"><span class="lineno"> 1532</span>                      numpy.int64,</div>
<div class="line"><span class="lineno"> 1533</span>                      numpy.intc,</div>
<div class="line"><span class="lineno"> 1534</span>                      numpy.intp]</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>    <span class="keywordflow">if</span> markers.dtype.type <span class="keywordflow">not</span> <span class="keywordflow">in</span> integral_types:</div>
<div class="line"><span class="lineno"> 1537</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;marker should be of integer type&#39;</span>)</div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>    <span class="keywordflow">if</span> isinstance(output, numpy.ndarray):</div>
<div class="line"><span class="lineno"> 1540</span>        <span class="keywordflow">if</span> output.dtype.type <span class="keywordflow">not</span> <span class="keywordflow">in</span> integral_types:</div>
<div class="line"><span class="lineno"> 1541</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;output should be of integer type&#39;</span>)</div>
<div class="line"><span class="lineno"> 1542</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1543</span>        output = markers.dtype</div>
<div class="line"><span class="lineno"> 1544</span> </div>
<div class="line"><span class="lineno"> 1545</span>    output = _ni_support._get_output(output, input)</div>
<div class="line"><span class="lineno"> 1546</span>    _nd_image.watershed_ift(input, markers, structure, output)</div>
<div class="line"><span class="lineno"> 1547</span>    <span class="keywordflow">return</span> output</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
