<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._linprog_ip Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html">_linprog_ip</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._linprog_ip Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af79fe8c81184bcea6e515bb6a77d2828" id="r_af79fe8c81184bcea6e515bb6a77d2828"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#af79fe8c81184bcea6e515bb6a77d2828">_get_solver</a> (M, sparse=False, lstsq=False, sym_pos=True, cholesky=True, permc_spec='MMD_AT_PLUS_A')</td></tr>
<tr class="separator:af79fe8c81184bcea6e515bb6a77d2828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58efb64f7a6fd37af380f7034a7caf99" id="r_a58efb64f7a6fd37af380f7034a7caf99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a58efb64f7a6fd37af380f7034a7caf99">_get_delta</a> (A, b, c, <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, y, <a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, <a class="el" href="__lapack__subroutines_8h.html#af0c5a889e1121fdd1acf62bec776a634">tau</a>, kappa, gamma, eta, sparse=False, lstsq=False, sym_pos=True, cholesky=True, pc=True, ip=False, permc_spec='MMD_AT_PLUS_A')</td></tr>
<tr class="separator:a58efb64f7a6fd37af380f7034a7caf99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1248a49c1aea2448578f657e76bec188" id="r_a1248a49c1aea2448578f657e76bec188"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a1248a49c1aea2448578f657e76bec188">_sym_solve</a> (Dinv, A, r1, r2, solve)</td></tr>
<tr class="separator:a1248a49c1aea2448578f657e76bec188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6737fa094c528ba99df49e08787dca4c" id="r_a6737fa094c528ba99df49e08787dca4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a6737fa094c528ba99df49e08787dca4c">_get_step</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, d_x, <a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, d_z, <a class="el" href="__lapack__subroutines_8h.html#af0c5a889e1121fdd1acf62bec776a634">tau</a>, d_tau, kappa, d_kappa, alpha0)</td></tr>
<tr class="separator:a6737fa094c528ba99df49e08787dca4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54ec1ab35d00d322c65f232b8ef7ff79" id="r_a54ec1ab35d00d322c65f232b8ef7ff79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a54ec1ab35d00d322c65f232b8ef7ff79">_get_message</a> (status)</td></tr>
<tr class="separator:a54ec1ab35d00d322c65f232b8ef7ff79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15baf8b51bf0ec22309e1e2bea5f56ed" id="r_a15baf8b51bf0ec22309e1e2bea5f56ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a15baf8b51bf0ec22309e1e2bea5f56ed">_do_step</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, y, <a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, <a class="el" href="__lapack__subroutines_8h.html#af0c5a889e1121fdd1acf62bec776a634">tau</a>, kappa, d_x, d_y, d_z, d_tau, d_kappa, <a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>)</td></tr>
<tr class="separator:a15baf8b51bf0ec22309e1e2bea5f56ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac626b8ed27b4d7cec8106d411d30a0cb" id="r_ac626b8ed27b4d7cec8106d411d30a0cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#ac626b8ed27b4d7cec8106d411d30a0cb">_get_blind_start</a> (shape)</td></tr>
<tr class="separator:ac626b8ed27b4d7cec8106d411d30a0cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b869c3648f9ebfeacc2b523f8ad0140" id="r_a9b869c3648f9ebfeacc2b523f8ad0140"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a9b869c3648f9ebfeacc2b523f8ad0140">_indicators</a> (A, b, c, c0, <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, y, <a class="el" href="__blas__subroutines_8h.html#a97fad269e85497afbd382321b3079d38">z</a>, <a class="el" href="__lapack__subroutines_8h.html#af0c5a889e1121fdd1acf62bec776a634">tau</a>, kappa)</td></tr>
<tr class="separator:a9b869c3648f9ebfeacc2b523f8ad0140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac48461770088454d0d509ca1a41e26fd" id="r_ac48461770088454d0d509ca1a41e26fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#ac48461770088454d0d509ca1a41e26fd">_display_iter</a> (rho_p, rho_d, rho_g, <a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>, rho_mu, obj, header=False)</td></tr>
<tr class="separator:ac48461770088454d0d509ca1a41e26fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa766610b7755f45804088f10cce8d0b4" id="r_aa766610b7755f45804088f10cce8d0b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#aa766610b7755f45804088f10cce8d0b4">_ip_hsd</a> (A, b, c, c0, alpha0, beta, maxiter, disp, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>, sparse, lstsq, sym_pos, cholesky, pc, ip, permc_spec, callback, postsolve_args)</td></tr>
<tr class="separator:aa766610b7755f45804088f10cce8d0b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42cb4bc5cf1de3997308da90a69616a1" id="r_a42cb4bc5cf1de3997308da90a69616a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a42cb4bc5cf1de3997308da90a69616a1">_linprog_ip</a> (c, c0, A, b, callback, postsolve_args, maxiter=1000, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-8, disp=False, alpha0=.99995, beta=0.1, sparse=False, lstsq=False, sym_pos=True, cholesky=None, pc=True, ip=False, permc_spec='MMD_AT_PLUS_A', **unknown_options)</td></tr>
<tr class="separator:a42cb4bc5cf1de3997308da90a69616a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a35542dc98dc5eb7e24ce99ad20609fd9" id="r_a35542dc98dc5eb7e24ce99ad20609fd9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a35542dc98dc5eb7e24ce99ad20609fd9">has_umfpack</a> = True</td></tr>
<tr class="separator:a35542dc98dc5eb7e24ce99ad20609fd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23cc8954769aa8804b0aae1303bab0d9" id="r_a23cc8954769aa8804b0aae1303bab0d9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__ip.html#a23cc8954769aa8804b0aae1303bab0d9">has_cholmod</a> = True</td></tr>
<tr class="separator:a23cc8954769aa8804b0aae1303bab0d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Interior-point method for linear programming

The *interior-point* method uses the primal-dual path following algorithm
outlined in [1]_. This algorithm supports sparse constraint matrices and
is typically faster than the simplex methods, especially for large, sparse
problems. Note, however, that the solution returned may be slightly less
accurate than those of the simplex methods and will not, in general,
correspond with a vertex of the polytope defined by the constraints.

    .. versionadded:: 1.0.0

References
----------
.. [1] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ac48461770088454d0d509ca1a41e26fd" name="ac48461770088454d0d509ca1a41e26fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac48461770088454d0d509ca1a41e26fd">&#9670;&#160;</a></span>_display_iter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._display_iter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rho_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rho_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rho_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rho_mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>header</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Print indicators of optimization status to the console.

Parameters
----------
rho_p : float
    The (normalized) primal feasibility, see [4] 4.5
rho_d : float
    The (normalized) dual feasibility, see [4] 4.5
rho_g : float
    The (normalized) duality gap, see [4] 4.5
alpha : float
    The step size, see [4] 4.3
rho_mu : float
    The (normalized) path parameter, see [4] 4.5
obj : float
    The objective function value of the current iterate
header : bool
    True if a header is to be printed

References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.</pre> <div class="fragment"><div class="line"><span class="lineno">  506</span><span class="keyword">def </span>_display_iter(rho_p, rho_d, rho_g, alpha, rho_mu, obj, header=False):</div>
<div class="line"><span class="lineno">  507</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral">    Print indicators of optimization status to the console.</span></div>
<div class="line"><span class="lineno">  509</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">    rho_p : float</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">        The (normalized) primal feasibility, see [4] 4.5</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">    rho_d : float</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">        The (normalized) dual feasibility, see [4] 4.5</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">    rho_g : float</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">        The (normalized) duality gap, see [4] 4.5</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">    alpha : float</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">        The step size, see [4] 4.3</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">    rho_mu : float</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">        The (normalized) path parameter, see [4] 4.5</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">    obj : float</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">        The objective function value of the current iterate</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">    header : bool</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">        True if a header is to be printed</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  535</span>    <span class="keywordflow">if</span> header:</div>
<div class="line"><span class="lineno">  536</span>        print(<span class="stringliteral">&quot;Primal Feasibility &quot;</span>,</div>
<div class="line"><span class="lineno">  537</span>              <span class="stringliteral">&quot;Dual Feasibility   &quot;</span>,</div>
<div class="line"><span class="lineno">  538</span>              <span class="stringliteral">&quot;Duality Gap        &quot;</span>,</div>
<div class="line"><span class="lineno">  539</span>              <span class="stringliteral">&quot;Step            &quot;</span>,</div>
<div class="line"><span class="lineno">  540</span>              <span class="stringliteral">&quot;Path Parameter     &quot;</span>,</div>
<div class="line"><span class="lineno">  541</span>              <span class="stringliteral">&quot;Objective          &quot;</span>)</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="comment"># no clue why this works</span></div>
<div class="line"><span class="lineno">  544</span>    fmt = <span class="stringliteral">&#39;{0:&lt;20.13}{1:&lt;20.13}{2:&lt;20.13}{3:&lt;17.13}{4:&lt;20.13}{5:&lt;20.13}&#39;</span></div>
<div class="line"><span class="lineno">  545</span>    print(fmt.format(</div>
<div class="line"><span class="lineno">  546</span>        float(rho_p),</div>
<div class="line"><span class="lineno">  547</span>        float(rho_d),</div>
<div class="line"><span class="lineno">  548</span>        float(rho_g),</div>
<div class="line"><span class="lineno">  549</span>        alpha <span class="keywordflow">if</span> isinstance(alpha, str) <span class="keywordflow">else</span> float(alpha),</div>
<div class="line"><span class="lineno">  550</span>        float(rho_mu),</div>
<div class="line"><span class="lineno">  551</span>        float(obj)))</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a15baf8b51bf0ec22309e1e2bea5f56ed" name="a15baf8b51bf0ec22309e1e2bea5f56ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15baf8b51bf0ec22309e1e2bea5f56ed">&#9670;&#160;</a></span>_do_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._do_step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">An implementation of [4] Equation 8.9

References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.</pre> <div class="fragment"><div class="line"><span class="lineno">  416</span><span class="keyword">def </span>_do_step(x, y, z, tau, kappa, d_x, d_y, d_z, d_tau, d_kappa, alpha):</div>
<div class="line"><span class="lineno">  417</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">    An implementation of [4] Equation 8.9</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  428</span>    x = x + alpha * d_x</div>
<div class="line"><span class="lineno">  429</span>    tau = tau + alpha * d_tau</div>
<div class="line"><span class="lineno">  430</span>    z = z + alpha * d_z</div>
<div class="line"><span class="lineno">  431</span>    kappa = kappa + alpha * d_kappa</div>
<div class="line"><span class="lineno">  432</span>    y = y + alpha * d_y</div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordflow">return</span> x, y, z, tau, kappa</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac626b8ed27b4d7cec8106d411d30a0cb" name="ac626b8ed27b4d7cec8106d411d30a0cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac626b8ed27b4d7cec8106d411d30a0cb">&#9670;&#160;</a></span>_get_blind_start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._get_blind_start </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shape</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return the starting point from [4] 4.4

References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.</pre> <div class="fragment"><div class="line"><span class="lineno">  436</span><span class="keyword">def </span>_get_blind_start(shape):</div>
<div class="line"><span class="lineno">  437</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">    Return the starting point from [4] 4.4</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  448</span>    m, n = shape</div>
<div class="line"><span class="lineno">  449</span>    x0 = np.ones(n)</div>
<div class="line"><span class="lineno">  450</span>    y0 = np.zeros(m)</div>
<div class="line"><span class="lineno">  451</span>    z0 = np.ones(n)</div>
<div class="line"><span class="lineno">  452</span>    tau0 = 1</div>
<div class="line"><span class="lineno">  453</span>    kappa0 = 1</div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">return</span> x0, y0, z0, tau0, kappa0</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a58efb64f7a6fd37af380f7034a7caf99" name="a58efb64f7a6fd37af380f7034a7caf99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58efb64f7a6fd37af380f7034a7caf99">&#9670;&#160;</a></span>_get_delta()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._get_delta </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparse</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lstsq</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sym_pos</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cholesky</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pc</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>permc_spec</em> = <code>'MMD_AT_PLUS_A'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given standard form problem defined by ``A``, ``b``, and ``c``;
current variable estimates ``x``, ``y``, ``z``, ``tau``, and ``kappa``;
algorithmic parameters ``gamma and ``eta;
and options ``sparse``, ``lstsq``, ``sym_pos``, ``cholesky``, ``pc``
(predictor-corrector), and ``ip`` (initial point improvement),
get the search direction for increments to the variable estimates.

Parameters
----------
As defined in [4], except:
sparse : bool
    True if the system to be solved is sparse. This is typically set
    True when the original ``A_ub`` and ``A_eq`` arrays are sparse.
lstsq : bool
    True if the system is ill-conditioned and/or (nearly) singular and
    thus a more robust least-squares solver is desired. This is sometimes
    needed as the solution is approached.
sym_pos : bool
    True if the system matrix is symmetric positive definite
    Sometimes this needs to be set false as the solution is approached,
    even when the system should be symmetric positive definite, due to
    numerical difficulties.
cholesky : bool
    True if the system is to be solved by Cholesky, rather than LU,
    decomposition. This is typically faster unless the problem is very
    small or prone to numerical difficulties.
pc : bool
    True if the predictor-corrector method of Mehrota is to be used. This
    is almost always (if not always) beneficial. Even though it requires
    the solution of an additional linear system, the factorization
    is typically (implicitly) reused so solution is efficient, and the
    number of algorithm iterations is typically reduced.
ip : bool
    True if the improved initial point suggestion due to [4] section 4.3
    is desired. It's unclear whether this is beneficial.
permc_spec : str (default = 'MMD_AT_PLUS_A')
    (Has effect only with ``sparse = True``, ``lstsq = False``, ``sym_pos =
    True``.) A matrix is factorized in each iteration of the algorithm.
    This option specifies how to permute the columns of the matrix for
    sparsity preservation. Acceptable values are:

    - ``NATURAL``: natural ordering.
    - ``MMD_ATA``: minimum degree ordering on the structure of A^T A.
    - ``MMD_AT_PLUS_A``: minimum degree ordering on the structure of A^T+A.
    - ``COLAMD``: approximate minimum degree column ordering.

    This option can impact the convergence of the
    interior point algorithm; test different values to determine which
    performs best for your problem. For more information, refer to
    ``scipy.sparse.linalg.splu``.

Returns
-------
Search directions as defined in [4]

References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.</pre> <div class="fragment"><div class="line"><span class="lineno">  134</span>               permc_spec=<span class="stringliteral">&#39;MMD_AT_PLUS_A&#39;</span>):</div>
<div class="line"><span class="lineno">  135</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    Given standard form problem defined by ``A``, ``b``, and ``c``;</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    current variable estimates ``x``, ``y``, ``z``, ``tau``, and ``kappa``;</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    algorithmic parameters ``gamma and ``eta;</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    and options ``sparse``, ``lstsq``, ``sym_pos``, ``cholesky``, ``pc``</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    (predictor-corrector), and ``ip`` (initial point improvement),</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    get the search direction for increments to the variable estimates.</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    As defined in [4], except:</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    sparse : bool</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">        True if the system to be solved is sparse. This is typically set</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">        True when the original ``A_ub`` and ``A_eq`` arrays are sparse.</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    lstsq : bool</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        True if the system is ill-conditioned and/or (nearly) singular and</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">        thus a more robust least-squares solver is desired. This is sometimes</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">        needed as the solution is approached.</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    sym_pos : bool</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">        True if the system matrix is symmetric positive definite</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">        Sometimes this needs to be set false as the solution is approached,</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">        even when the system should be symmetric positive definite, due to</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">        numerical difficulties.</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    cholesky : bool</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">        True if the system is to be solved by Cholesky, rather than LU,</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">        decomposition. This is typically faster unless the problem is very</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">        small or prone to numerical difficulties.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">    pc : bool</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">        True if the predictor-corrector method of Mehrota is to be used. This</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">        is almost always (if not always) beneficial. Even though it requires</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">        the solution of an additional linear system, the factorization</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">        is typically (implicitly) reused so solution is efficient, and the</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">        number of algorithm iterations is typically reduced.</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">    ip : bool</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">        True if the improved initial point suggestion due to [4] section 4.3</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">        is desired. It&#39;s unclear whether this is beneficial.</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">    permc_spec : str (default = &#39;MMD_AT_PLUS_A&#39;)</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">        (Has effect only with ``sparse = True``, ``lstsq = False``, ``sym_pos =</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">        True``.) A matrix is factorized in each iteration of the algorithm.</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">        This option specifies how to permute the columns of the matrix for</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">        sparsity preservation. Acceptable values are:</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">        - ``NATURAL``: natural ordering.</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">        - ``MMD_ATA``: minimum degree ordering on the structure of A^T A.</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">        - ``MMD_AT_PLUS_A``: minimum degree ordering on the structure of A^T+A.</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">        - ``COLAMD``: approximate minimum degree column ordering.</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">        This option can impact the convergence of the</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">        interior point algorithm; test different values to determine which</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">        performs best for your problem. For more information, refer to</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">        ``scipy.sparse.linalg.splu``.</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    Search directions as defined in [4]</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> A.shape[0] == 0:</div>
<div class="line"><span class="lineno">  200</span>        <span class="comment"># If there are no constraints, some solvers fail (understandably)</span></div>
<div class="line"><span class="lineno">  201</span>        <span class="comment"># rather than returning empty solution. This gets the job done.</span></div>
<div class="line"><span class="lineno">  202</span>        sparse, lstsq, sym_pos, cholesky = <span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  203</span>    n_x = len(x)</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    <span class="comment"># [4] Equation 8.8</span></div>
<div class="line"><span class="lineno">  206</span>    r_P = b * tau - A.dot(x)</div>
<div class="line"><span class="lineno">  207</span>    r_D = c * tau - A.T.dot(y) - z</div>
<div class="line"><span class="lineno">  208</span>    r_G = c.dot(x) - b.transpose().dot(y) + kappa</div>
<div class="line"><span class="lineno">  209</span>    mu = (x.dot(z) + tau * kappa) / (n_x + 1)</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">#  Assemble M from [4] Equation 8.31</span></div>
<div class="line"><span class="lineno">  212</span>    Dinv = x / z</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span> sparse:</div>
<div class="line"><span class="lineno">  215</span>        M = A.dot(sps.diags(Dinv, 0, format=<span class="stringliteral">&quot;csc&quot;</span>).dot(A.T))</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  217</span>        M = A.dot(Dinv.reshape(-1, 1) * A.T)</div>
<div class="line"><span class="lineno">  218</span>    solve = _get_solver(M, sparse, lstsq, sym_pos, cholesky, permc_spec)</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="comment"># pc: &quot;predictor-corrector&quot; [4] Section 4.1</span></div>
<div class="line"><span class="lineno">  221</span>    <span class="comment"># In development this option could be turned off</span></div>
<div class="line"><span class="lineno">  222</span>    <span class="comment"># but it always seems to improve performance substantially</span></div>
<div class="line"><span class="lineno">  223</span>    n_corrections = 1 <span class="keywordflow">if</span> pc <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    i = 0</div>
<div class="line"><span class="lineno">  226</span>    alpha, d_x, d_z, d_tau, d_kappa = 0, 0, 0, 0, 0</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">while</span> i &lt;= n_corrections:</div>
<div class="line"><span class="lineno">  228</span>        <span class="comment"># Reference [4] Eq. 8.6</span></div>
<div class="line"><span class="lineno">  229</span>        rhatp = eta(gamma) * r_P</div>
<div class="line"><span class="lineno">  230</span>        rhatd = eta(gamma) * r_D</div>
<div class="line"><span class="lineno">  231</span>        rhatg = eta(gamma) * r_G</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>        <span class="comment"># Reference [4] Eq. 8.7</span></div>
<div class="line"><span class="lineno">  234</span>        rhatxs = gamma * mu - x * z</div>
<div class="line"><span class="lineno">  235</span>        rhattk = gamma * mu - tau * kappa</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">if</span> i == 1:</div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordflow">if</span> ip:  <span class="comment"># if the correction is to get &quot;initial point&quot;</span></div>
<div class="line"><span class="lineno">  239</span>                <span class="comment"># Reference [4] Eq. 8.23</span></div>
<div class="line"><span class="lineno">  240</span>                rhatxs = ((1 - alpha) * gamma * mu -</div>
<div class="line"><span class="lineno">  241</span>                          x * z - alpha**2 * d_x * d_z)</div>
<div class="line"><span class="lineno">  242</span>                rhattk = ((1 - alpha) * gamma * mu -</div>
<div class="line"><span class="lineno">  243</span>                    tau * kappa -</div>
<div class="line"><span class="lineno">  244</span>                    alpha**2 * d_tau * d_kappa)</div>
<div class="line"><span class="lineno">  245</span>            <span class="keywordflow">else</span>:  <span class="comment"># if the correction is for &quot;predictor-corrector&quot;</span></div>
<div class="line"><span class="lineno">  246</span>                <span class="comment"># Reference [4] Eq. 8.13</span></div>
<div class="line"><span class="lineno">  247</span>                rhatxs -= d_x * d_z</div>
<div class="line"><span class="lineno">  248</span>                rhattk -= d_tau * d_kappa</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>        <span class="comment"># sometimes numerical difficulties arise as the solution is approached</span></div>
<div class="line"><span class="lineno">  251</span>        <span class="comment"># this loop tries to solve the equations using a sequence of functions</span></div>
<div class="line"><span class="lineno">  252</span>        <span class="comment"># for solve. For dense systems, the order is:</span></div>
<div class="line"><span class="lineno">  253</span>        <span class="comment"># 1. scipy.linalg.cho_factor/scipy.linalg.cho_solve,</span></div>
<div class="line"><span class="lineno">  254</span>        <span class="comment"># 2. scipy.linalg.solve w/ sym_pos = True,</span></div>
<div class="line"><span class="lineno">  255</span>        <span class="comment"># 3. scipy.linalg.solve w/ sym_pos = False, and if all else fails</span></div>
<div class="line"><span class="lineno">  256</span>        <span class="comment"># 4. scipy.linalg.lstsq</span></div>
<div class="line"><span class="lineno">  257</span>        <span class="comment"># For sparse systems, the order is:</span></div>
<div class="line"><span class="lineno">  258</span>        <span class="comment"># 1. sksparse.cholmod.cholesky (if available)</span></div>
<div class="line"><span class="lineno">  259</span>        <span class="comment"># 2. scipy.sparse.linalg.factorized (if umfpack available)</span></div>
<div class="line"><span class="lineno">  260</span>        <span class="comment"># 3. scipy.sparse.linalg.splu</span></div>
<div class="line"><span class="lineno">  261</span>        <span class="comment"># 4. scipy.sparse.linalg.lsqr</span></div>
<div class="line"><span class="lineno">  262</span>        solved = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  263</span>        while(<span class="keywordflow">not</span> solved):</div>
<div class="line"><span class="lineno">  264</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  265</span>                <span class="comment"># [4] Equation 8.28</span></div>
<div class="line"><span class="lineno">  266</span>                p, q = _sym_solve(Dinv, A, c, b, solve)</div>
<div class="line"><span class="lineno">  267</span>                <span class="comment"># [4] Equation 8.29</span></div>
<div class="line"><span class="lineno">  268</span>                u, v = _sym_solve(Dinv, A, rhatd -</div>
<div class="line"><span class="lineno">  269</span>                                  (1 / x) * rhatxs, rhatp, solve)</div>
<div class="line"><span class="lineno">  270</span>                <span class="keywordflow">if</span> np.any(np.isnan(p)) <span class="keywordflow">or</span> np.any(np.isnan(q)):</div>
<div class="line"><span class="lineno">  271</span>                    <span class="keywordflow">raise</span> LinAlgError</div>
<div class="line"><span class="lineno">  272</span>                solved = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  273</span>            <span class="keywordflow">except</span> (LinAlgError, ValueError, TypeError) <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  274</span>                <span class="comment"># Usually this doesn&#39;t happen. If it does, it happens when</span></div>
<div class="line"><span class="lineno">  275</span>                <span class="comment"># there are redundant constraints or when approaching the</span></div>
<div class="line"><span class="lineno">  276</span>                <span class="comment"># solution. If so, change solver.</span></div>
<div class="line"><span class="lineno">  277</span>                <span class="keywordflow">if</span> cholesky:</div>
<div class="line"><span class="lineno">  278</span>                    cholesky = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  279</span>                    warn(</div>
<div class="line"><span class="lineno">  280</span>                        <span class="stringliteral">&quot;Solving system with option &#39;cholesky&#39;:True &quot;</span></div>
<div class="line"><span class="lineno">  281</span>                        <span class="stringliteral">&quot;failed. It is normal for this to happen &quot;</span></div>
<div class="line"><span class="lineno">  282</span>                        <span class="stringliteral">&quot;occasionally, especially as the solution is &quot;</span></div>
<div class="line"><span class="lineno">  283</span>                        <span class="stringliteral">&quot;approached. However, if you see this frequently, &quot;</span></div>
<div class="line"><span class="lineno">  284</span>                        <span class="stringliteral">&quot;consider setting option &#39;cholesky&#39; to False.&quot;</span>,</div>
<div class="line"><span class="lineno">  285</span>                        OptimizeWarning, stacklevel=5)</div>
<div class="line"><span class="lineno">  286</span>                <span class="keywordflow">elif</span> sym_pos:</div>
<div class="line"><span class="lineno">  287</span>                    sym_pos = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  288</span>                    warn(</div>
<div class="line"><span class="lineno">  289</span>                        <span class="stringliteral">&quot;Solving system with option &#39;sym_pos&#39;:True &quot;</span></div>
<div class="line"><span class="lineno">  290</span>                        <span class="stringliteral">&quot;failed. It is normal for this to happen &quot;</span></div>
<div class="line"><span class="lineno">  291</span>                        <span class="stringliteral">&quot;occasionally, especially as the solution is &quot;</span></div>
<div class="line"><span class="lineno">  292</span>                        <span class="stringliteral">&quot;approached. However, if you see this frequently, &quot;</span></div>
<div class="line"><span class="lineno">  293</span>                        <span class="stringliteral">&quot;consider setting option &#39;sym_pos&#39; to False.&quot;</span>,</div>
<div class="line"><span class="lineno">  294</span>                        OptimizeWarning, stacklevel=5)</div>
<div class="line"><span class="lineno">  295</span>                <span class="keywordflow">elif</span> <span class="keywordflow">not</span> lstsq:</div>
<div class="line"><span class="lineno">  296</span>                    lstsq = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  297</span>                    warn(</div>
<div class="line"><span class="lineno">  298</span>                        <span class="stringliteral">&quot;Solving system with option &#39;sym_pos&#39;:False &quot;</span></div>
<div class="line"><span class="lineno">  299</span>                        <span class="stringliteral">&quot;failed. This may happen occasionally, &quot;</span></div>
<div class="line"><span class="lineno">  300</span>                        <span class="stringliteral">&quot;especially as the solution is &quot;</span></div>
<div class="line"><span class="lineno">  301</span>                        <span class="stringliteral">&quot;approached. However, if you see this frequently, &quot;</span></div>
<div class="line"><span class="lineno">  302</span>                        <span class="stringliteral">&quot;your problem may be numerically challenging. &quot;</span></div>
<div class="line"><span class="lineno">  303</span>                        <span class="stringliteral">&quot;If you cannot improve the formulation, consider &quot;</span></div>
<div class="line"><span class="lineno">  304</span>                        <span class="stringliteral">&quot;setting &#39;lstsq&#39; to True. Consider also setting &quot;</span></div>
<div class="line"><span class="lineno">  305</span>                        <span class="stringliteral">&quot;`presolve` to True, if it is not already.&quot;</span>,</div>
<div class="line"><span class="lineno">  306</span>                        OptimizeWarning, stacklevel=5)</div>
<div class="line"><span class="lineno">  307</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  308</span>                    <span class="keywordflow">raise</span> e</div>
<div class="line"><span class="lineno">  309</span>                solve = _get_solver(M, sparse, lstsq, sym_pos,</div>
<div class="line"><span class="lineno">  310</span>                                    cholesky, permc_spec)</div>
<div class="line"><span class="lineno">  311</span>        <span class="comment"># [4] Results after 8.29</span></div>
<div class="line"><span class="lineno">  312</span>        d_tau = ((rhatg + 1 / tau * rhattk - (-c.dot(u) + b.dot(v))) /</div>
<div class="line"><span class="lineno">  313</span>                 (1 / tau * kappa + (-c.dot(p) + b.dot(q))))</div>
<div class="line"><span class="lineno">  314</span>        d_x = u + p * d_tau</div>
<div class="line"><span class="lineno">  315</span>        d_y = v + q * d_tau</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>        <span class="comment"># [4] Relations between  after 8.25 and 8.26</span></div>
<div class="line"><span class="lineno">  318</span>        d_z = (1 / x) * (rhatxs - z * d_x)</div>
<div class="line"><span class="lineno">  319</span>        d_kappa = 1 / tau * (rhattk - kappa * d_tau)</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>        <span class="comment"># [4] 8.12 and &quot;Let alpha be the maximal possible step...&quot; before 8.23</span></div>
<div class="line"><span class="lineno">  322</span>        alpha = _get_step(x, d_x, z, d_z, tau, d_tau, kappa, d_kappa, 1)</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">if</span> ip:  <span class="comment"># initial point - see [4] 4.4</span></div>
<div class="line"><span class="lineno">  324</span>            gamma = 10</div>
<div class="line"><span class="lineno">  325</span>        <span class="keywordflow">else</span>:  <span class="comment"># predictor-corrector, [4] definition after 8.12</span></div>
<div class="line"><span class="lineno">  326</span>            beta1 = 0.1  <span class="comment"># [4] pg. 220 (Table 8.1)</span></div>
<div class="line"><span class="lineno">  327</span>            gamma = (1 - alpha)**2 * min(beta1, (1 - alpha))</div>
<div class="line"><span class="lineno">  328</span>        i += 1</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">return</span> d_x, d_y, d_z, d_tau, d_kappa</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a54ec1ab35d00d322c65f232b8ef7ff79" name="a54ec1ab35d00d322c65f232b8ef7ff79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54ec1ab35d00d322c65f232b8ef7ff79">&#9670;&#160;</a></span>_get_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._get_message </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given problem status code, return a more detailed message.

Parameters
----------
status : int
    An integer representing the exit status of the optimization::

     0 : Optimization terminated successfully
     1 : Iteration limit reached
     2 : Problem appears to be infeasible
     3 : Problem appears to be unbounded
     4 : Serious numerical difficulties encountered

Returns
-------
message : str
    A string descriptor of the exit status of the optimization.</pre> <div class="fragment"><div class="line"><span class="lineno">  379</span><span class="keyword">def </span>_get_message(status):</div>
<div class="line"><span class="lineno">  380</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">    Given problem status code, return a more detailed message.</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">         0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">         1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">         2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">         3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">         4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">        A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  400</span>    messages = (</div>
<div class="line"><span class="lineno">  401</span>        [<span class="stringliteral">&quot;Optimization terminated successfully.&quot;</span>,</div>
<div class="line"><span class="lineno">  402</span>         <span class="stringliteral">&quot;The iteration limit was reached before the algorithm converged.&quot;</span>,</div>
<div class="line"><span class="lineno">  403</span>         <span class="stringliteral">&quot;The algorithm terminated successfully and determined that the &quot;</span></div>
<div class="line"><span class="lineno">  404</span>         <span class="stringliteral">&quot;problem is infeasible.&quot;</span>,</div>
<div class="line"><span class="lineno">  405</span>         <span class="stringliteral">&quot;The algorithm terminated successfully and determined that the &quot;</span></div>
<div class="line"><span class="lineno">  406</span>         <span class="stringliteral">&quot;problem is unbounded.&quot;</span>,</div>
<div class="line"><span class="lineno">  407</span>         <span class="stringliteral">&quot;Numerical difficulties were encountered before the problem &quot;</span></div>
<div class="line"><span class="lineno">  408</span>         <span class="stringliteral">&quot;converged. Please check your problem formulation for errors, &quot;</span></div>
<div class="line"><span class="lineno">  409</span>         <span class="stringliteral">&quot;independence of linear equality constraints, and reasonable &quot;</span></div>
<div class="line"><span class="lineno">  410</span>         <span class="stringliteral">&quot;scaling and matrix condition numbers. If you continue to &quot;</span></div>
<div class="line"><span class="lineno">  411</span>         <span class="stringliteral">&quot;encounter this error, please submit a bug report.&quot;</span></div>
<div class="line"><span class="lineno">  412</span>         ])</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">return</span> messages[status]</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af79fe8c81184bcea6e515bb6a77d2828" name="af79fe8c81184bcea6e515bb6a77d2828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af79fe8c81184bcea6e515bb6a77d2828">&#9670;&#160;</a></span>_get_solver()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._get_solver </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparse</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lstsq</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sym_pos</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cholesky</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>permc_spec</em> = <code>'MMD_AT_PLUS_A'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Given solver options, return a handle to the appropriate linear system
solver.

Parameters
----------
M : 2-D array
    As defined in [4] Equation 8.31
sparse : bool (default = False)
    True if the system to be solved is sparse. This is typically set
    True when the original ``A_ub`` and ``A_eq`` arrays are sparse.
lstsq : bool (default = False)
    True if the system is ill-conditioned and/or (nearly) singular and
    thus a more robust least-squares solver is desired. This is sometimes
    needed as the solution is approached.
sym_pos : bool (default = True)
    True if the system matrix is symmetric positive definite
    Sometimes this needs to be set false as the solution is approached,
    even when the system should be symmetric positive definite, due to
    numerical difficulties.
cholesky : bool (default = True)
    True if the system is to be solved by Cholesky, rather than LU,
    decomposition. This is typically faster unless the problem is very
    small or prone to numerical difficulties.
permc_spec : str (default = 'MMD_AT_PLUS_A')
    Sparsity preservation strategy used by SuperLU. Acceptable values are:

    - ``NATURAL``: natural ordering.
    - ``MMD_ATA``: minimum degree ordering on the structure of A^T A.
    - ``MMD_AT_PLUS_A``: minimum degree ordering on the structure of A^T+A.
    - ``COLAMD``: approximate minimum degree column ordering.

    See SuperLU documentation.

Returns
-------
solve : function
    Handle to the appropriate solver function</pre> <div class="fragment"><div class="line"><span class="lineno">   43</span>                cholesky=<span class="keyword">True</span>, permc_spec=<span class="stringliteral">&#39;MMD_AT_PLUS_A&#39;</span>):</div>
<div class="line"><span class="lineno">   44</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    Given solver options, return a handle to the appropriate linear system</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    solver.</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    M : 2-D array</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">        As defined in [4] Equation 8.31</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    sparse : bool (default = False)</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">        True if the system to be solved is sparse. This is typically set</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">        True when the original ``A_ub`` and ``A_eq`` arrays are sparse.</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    lstsq : bool (default = False)</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">        True if the system is ill-conditioned and/or (nearly) singular and</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">        thus a more robust least-squares solver is desired. This is sometimes</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">        needed as the solution is approached.</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">    sym_pos : bool (default = True)</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">        True if the system matrix is symmetric positive definite</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">        Sometimes this needs to be set false as the solution is approached,</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">        even when the system should be symmetric positive definite, due to</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">        numerical difficulties.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">    cholesky : bool (default = True)</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        True if the system is to be solved by Cholesky, rather than LU,</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">        decomposition. This is typically faster unless the problem is very</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">        small or prone to numerical difficulties.</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">    permc_spec : str (default = &#39;MMD_AT_PLUS_A&#39;)</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">        Sparsity preservation strategy used by SuperLU. Acceptable values are:</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">        - ``NATURAL``: natural ordering.</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">        - ``MMD_ATA``: minimum degree ordering on the structure of A^T A.</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        - ``MMD_AT_PLUS_A``: minimum degree ordering on the structure of A^T+A.</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        - ``COLAMD``: approximate minimum degree column ordering.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        See SuperLU documentation.</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    solve : function</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">        Handle to the appropriate solver function</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">if</span> sparse:</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">if</span> lstsq:</div>
<div class="line"><span class="lineno">   87</span>                <span class="keyword">def </span>solve(r, sym_pos=False):</div>
<div class="line"><span class="lineno">   88</span>                    <span class="keywordflow">return</span> sps.linalg.lsqr(M, r)[0]</div>
<div class="line"><span class="lineno">   89</span>            <span class="keywordflow">elif</span> cholesky:</div>
<div class="line"><span class="lineno">   90</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   91</span>                    <span class="comment"># Will raise an exception in the first call,</span></div>
<div class="line"><span class="lineno">   92</span>                    <span class="comment"># or when the matrix changes due to a new problem</span></div>
<div class="line"><span class="lineno">   93</span>                    _get_solver.cholmod_factor.cholesky_inplace(M)</div>
<div class="line"><span class="lineno">   94</span>                <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno">   95</span>                    _get_solver.cholmod_factor = cholmod_analyze(M)</div>
<div class="line"><span class="lineno">   96</span>                    _get_solver.cholmod_factor.cholesky_inplace(M)</div>
<div class="line"><span class="lineno">   97</span>                solve = _get_solver.cholmod_factor</div>
<div class="line"><span class="lineno">   98</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   99</span>                <span class="keywordflow">if</span> has_umfpack <span class="keywordflow">and</span> sym_pos:</div>
<div class="line"><span class="lineno">  100</span>                    solve = sps.linalg.factorized(M)</div>
<div class="line"><span class="lineno">  101</span>                <span class="keywordflow">else</span>:  <span class="comment"># factorized doesn&#39;t pass permc_spec</span></div>
<div class="line"><span class="lineno">  102</span>                    solve = sps.linalg.splu(M, permc_spec=permc_spec).solve</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  105</span>            <span class="keywordflow">if</span> lstsq:  <span class="comment"># sometimes necessary as solution is approached</span></div>
<div class="line"><span class="lineno">  106</span>                <span class="keyword">def </span>solve(r):</div>
<div class="line"><span class="lineno">  107</span>                    <span class="keywordflow">return</span> sp.linalg.lstsq(M, r)[0]</div>
<div class="line"><span class="lineno">  108</span>            <span class="keywordflow">elif</span> cholesky:</div>
<div class="line"><span class="lineno">  109</span>                L = sp.linalg.cho_factor(M)</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>                <span class="keyword">def </span>solve(r):</div>
<div class="line"><span class="lineno">  112</span>                    <span class="keywordflow">return</span> sp.linalg.cho_solve(L, r)</div>
<div class="line"><span class="lineno">  113</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  114</span>                <span class="comment"># this seems to cache the matrix factorization, so solving</span></div>
<div class="line"><span class="lineno">  115</span>                <span class="comment"># with multiple right hand sides is much faster</span></div>
<div class="line"><span class="lineno">  116</span>                <span class="keyword">def </span>solve(r, sym_pos=sym_pos):</div>
<div class="line"><span class="lineno">  117</span>                    <span class="keywordflow">if</span> sym_pos:</div>
<div class="line"><span class="lineno">  118</span>                        <span class="keywordflow">return</span> sp.linalg.solve(M, r, assume_a=<span class="stringliteral">&quot;pos&quot;</span>)</div>
<div class="line"><span class="lineno">  119</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  120</span>                        <span class="keywordflow">return</span> sp.linalg.solve(M, r)</div>
<div class="line"><span class="lineno">  121</span>    <span class="comment"># There are many things that can go wrong here, and it&#39;s hard to say</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="comment"># what all of them are. It doesn&#39;t really matter: if the matrix can&#39;t be</span></div>
<div class="line"><span class="lineno">  123</span>    <span class="comment"># factorized, return None. get_solver will be called again with different</span></div>
<div class="line"><span class="lineno">  124</span>    <span class="comment"># inputs, and a new routine will try to factorize the matrix.</span></div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">except</span> KeyboardInterrupt:</div>
<div class="line"><span class="lineno">  126</span>        <span class="keywordflow">raise</span></div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">return</span> solve</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6737fa094c528ba99df49e08787dca4c" name="a6737fa094c528ba99df49e08787dca4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6737fa094c528ba99df49e08787dca4c">&#9670;&#160;</a></span>_get_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._get_step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">An implementation of [4] equation 8.21

References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.</pre> <div class="fragment"><div class="line"><span class="lineno">  353</span><span class="keyword">def </span>_get_step(x, d_x, z, d_z, tau, d_tau, kappa, d_kappa, alpha0):</div>
<div class="line"><span class="lineno">  354</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    An implementation of [4] equation 8.21</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  365</span>    <span class="comment"># [4] 4.3 Equation 8.21, ignoring 8.20 requirement</span></div>
<div class="line"><span class="lineno">  366</span>    <span class="comment"># same step is taken in primal and dual spaces</span></div>
<div class="line"><span class="lineno">  367</span>    <span class="comment"># alpha0 is basically beta3 from [4] Table 8.1, but instead of beta3</span></div>
<div class="line"><span class="lineno">  368</span>    <span class="comment"># the value 1 is used in Mehrota corrector and initial point correction</span></div>
<div class="line"><span class="lineno">  369</span>    i_x = d_x &lt; 0</div>
<div class="line"><span class="lineno">  370</span>    i_z = d_z &lt; 0</div>
<div class="line"><span class="lineno">  371</span>    alpha_x = alpha0 * np.min(x[i_x] / -d_x[i_x]) <span class="keywordflow">if</span> np.any(i_x) <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  372</span>    alpha_tau = alpha0 * tau / -d_tau <span class="keywordflow">if</span> d_tau &lt; 0 <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  373</span>    alpha_z = alpha0 * np.min(z[i_z] / -d_z[i_z]) <span class="keywordflow">if</span> np.any(i_z) <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  374</span>    alpha_kappa = alpha0 * kappa / -d_kappa <span class="keywordflow">if</span> d_kappa &lt; 0 <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  375</span>    alpha = np.min([1, alpha_x, alpha_tau, alpha_z, alpha_kappa])</div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">return</span> alpha</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b869c3648f9ebfeacc2b523f8ad0140" name="a9b869c3648f9ebfeacc2b523f8ad0140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b869c3648f9ebfeacc2b523f8ad0140">&#9670;&#160;</a></span>_indicators()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._indicators </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kappa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Implementation of several equations from [4] used as indicators of
the status of optimization.

References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.</pre> <div class="fragment"><div class="line"><span class="lineno">  457</span><span class="keyword">def </span>_indicators(A, b, c, c0, x, y, z, tau, kappa):</div>
<div class="line"><span class="lineno">  458</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral">    Implementation of several equations from [4] used as indicators of</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">    the status of optimization.</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  464</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno">  467</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    <span class="comment"># residuals for termination are relative to initial values</span></div>
<div class="line"><span class="lineno">  472</span>    x0, y0, z0, tau0, kappa0 = _get_blind_start(A.shape)</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>    <span class="comment"># See [4], Section 4 - The Homogeneous Algorithm, Equation 8.8</span></div>
<div class="line"><span class="lineno">  475</span>    <span class="keyword">def </span>r_p(x, tau):</div>
<div class="line"><span class="lineno">  476</span>        <span class="keywordflow">return</span> b * tau - A.dot(x)</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    <span class="keyword">def </span>r_d(y, z, tau):</div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">return</span> c * tau - A.T.dot(y) - z</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>    <span class="keyword">def </span>r_g(x, y, kappa):</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">return</span> kappa + c.dot(x) - b.dot(y)</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>    <span class="comment"># np.dot unpacks if they are arrays of size one</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="keyword">def </span>mu(x, tau, z, kappa):</div>
<div class="line"><span class="lineno">  486</span>        <span class="keywordflow">return</span> (x.dot(z) + np.dot(tau, kappa)) / (len(x) + 1)</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    obj = c.dot(x / tau) + c0</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>    <span class="keyword">def </span>norm(a):</div>
<div class="line"><span class="lineno">  491</span>        <span class="keywordflow">return</span> np.linalg.norm(a)</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>    <span class="comment"># See [4], Section 4.5 - The Stopping Criteria</span></div>
<div class="line"><span class="lineno">  494</span>    r_p0 = r_p(x0, tau0)</div>
<div class="line"><span class="lineno">  495</span>    r_d0 = r_d(y0, z0, tau0)</div>
<div class="line"><span class="lineno">  496</span>    r_g0 = r_g(x0, y0, kappa0)</div>
<div class="line"><span class="lineno">  497</span>    mu_0 = mu(x0, tau0, z0, kappa0)</div>
<div class="line"><span class="lineno">  498</span>    rho_A = norm(c.T.dot(x) - b.T.dot(y)) / (tau + norm(b.T.dot(y)))</div>
<div class="line"><span class="lineno">  499</span>    rho_p = norm(r_p(x, tau)) / max(1, norm(r_p0))</div>
<div class="line"><span class="lineno">  500</span>    rho_d = norm(r_d(y, z, tau)) / max(1, norm(r_d0))</div>
<div class="line"><span class="lineno">  501</span>    rho_g = norm(r_g(x, y, kappa)) / max(1, norm(r_g0))</div>
<div class="line"><span class="lineno">  502</span>    rho_mu = mu(x, tau, z, kappa) / mu_0</div>
<div class="line"><span class="lineno">  503</span>    <span class="keywordflow">return</span> rho_p, rho_d, rho_A, rho_g, rho_mu, obj</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa766610b7755f45804088f10cce8d0b4" name="aa766610b7755f45804088f10cce8d0b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa766610b7755f45804088f10cce8d0b4">&#9670;&#160;</a></span>_ip_hsd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._ip_hsd </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lstsq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sym_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cholesky</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>permc_spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Solve a linear programming problem in standard form:

Minimize::

    c @ x

Subject to::

    A @ x == b
        x &gt;= 0

using the interior point method of [4].

Parameters
----------
A : 2-D array
    2-D array such that ``A @ x``, gives the values of the equality
    constraints at ``x``.
b : 1-D array
    1-D array of values representing the RHS of each equality constraint
    (row) in ``A`` (for standard form problem).
c : 1-D array
    Coefficients of the linear objective function to be minimized (for
    standard form problem).
c0 : float
    Constant term in objective function due to fixed (and eliminated)
    variables. (Purely for display.)
alpha0 : float
    The maximal step size for Mehrota's predictor-corrector search
    direction; see :math:`\beta_3`of [4] Table 8.1
beta : float
    The desired reduction of the path parameter :math:`\mu` (see  [6]_)
maxiter : int
    The maximum number of iterations of the algorithm.
disp : bool
    Set to ``True`` if indicators of optimization status are to be printed
    to the console each iteration.
tol : float
    Termination tolerance; see [4]_ Section 4.5.
sparse : bool
    Set to ``True`` if the problem is to be treated as sparse. However,
    the inputs ``A_eq`` and ``A_ub`` should nonetheless be provided as
    (dense) arrays rather than sparse matrices.
lstsq : bool
    Set to ``True`` if the problem is expected to be very poorly
    conditioned. This should always be left as ``False`` unless severe
    numerical difficulties are frequently encountered, and a better option
    would be to improve the formulation of the problem.
sym_pos : bool
    Leave ``True`` if the problem is expected to yield a well conditioned
    symmetric positive definite normal equation matrix (almost always).
cholesky : bool
    Set to ``True`` if the normal equations are to be solved by explicit
    Cholesky decomposition followed by explicit forward/backward
    substitution. This is typically faster for moderate, dense problems
    that are numerically well-behaved.
pc : bool
    Leave ``True`` if the predictor-corrector method of Mehrota is to be
    used. This is almost always (if not always) beneficial.
ip : bool
    Set to ``True`` if the improved initial point suggestion due to [4]_
    Section 4.3 is desired. It's unclear whether this is beneficial.
permc_spec : str (default = 'MMD_AT_PLUS_A')
    (Has effect only with ``sparse = True``, ``lstsq = False``, ``sym_pos =
    True``.) A matrix is factorized in each iteration of the algorithm.
    This option specifies how to permute the columns of the matrix for
    sparsity preservation. Acceptable values are:

    - ``NATURAL``: natural ordering.
    - ``MMD_ATA``: minimum degree ordering on the structure of A^T A.
    - ``MMD_AT_PLUS_A``: minimum degree ordering on the structure of A^T+A.
    - ``COLAMD``: approximate minimum degree column ordering.

    This option can impact the convergence of the
    interior point algorithm; test different values to determine which
    performs best for your problem. For more information, refer to
    ``scipy.sparse.linalg.splu``.
callback : callable, optional
    If a callback function is provided, it will be called within each
    iteration of the algorithm. The callback function must accept a single
    `scipy.optimize.OptimizeResult` consisting of the following fields:

        x : 1-D array
            Current solution vector
        fun : float
            Current value of the objective function
        success : bool
            True only when an algorithm has completed successfully,
            so this is always False as the callback function is called
            only while the algorithm is still iterating.
        slack : 1-D array
            The values of the slack variables. Each slack variable
            corresponds to an inequality constraint. If the slack is zero,
            the corresponding constraint is active.
        con : 1-D array
            The (nominally zero) residuals of the equality constraints,
            that is, ``b - A_eq @ x``
        phase : int
            The phase of the algorithm being executed. This is always
            1 for the interior-point method because it has only one phase.
        status : int
            For revised simplex, this is always 0 because if a different
            status is detected, the algorithm terminates.
        nit : int
            The number of iterations performed.
        message : str
            A string descriptor of the exit status of the optimization.
postsolve_args : tuple
    Data needed by _postsolve to convert the solution to the standard-form
    problem into the solution to the original problem.

Returns
-------
x_hat : float
    Solution vector (for standard form problem).
status : int
    An integer representing the exit status of the optimization::

     0 : Optimization terminated successfully
     1 : Iteration limit reached
     2 : Problem appears to be infeasible
     3 : Problem appears to be unbounded
     4 : Serious numerical difficulties encountered

message : str
    A string descriptor of the exit status of the optimization.
iteration : int
    The number of iterations taken to solve the problem

References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.
.. [6] Freund, Robert M. "Primal-Dual Interior-Point Methods for Linear
       Programming based on Newton's Method." Unpublished Course Notes,
       March 2004. Available 2/25/2017 at:
       https://ocw.mit.edu/courses/sloan-school-of-management/15-084j-nonlinear-programming-spring-2004/lecture-notes/lec14_int_pt_mthd.pdf</pre> <div class="fragment"><div class="line"><span class="lineno">  555</span>            sym_pos, cholesky, pc, ip, permc_spec, callback, postsolve_args):</div>
<div class="line"><span class="lineno">  556</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">    Solve a linear programming problem in standard form:</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">        A @ x == b</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">            x &gt;= 0</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">    using the interior point method of [4].</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral">    A : 2-D array</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">        2-D array such that ``A @ x``, gives the values of the equality</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">        constraints at ``x``.</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">    b : 1-D array</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">        1-D array of values representing the RHS of each equality constraint</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral">        (row) in ``A`` (for standard form problem).</span></div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">    c : 1-D array</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">        Coefficients of the linear objective function to be minimized (for</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">        standard form problem).</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">    c0 : float</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">        Constant term in objective function due to fixed (and eliminated)</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral">        variables. (Purely for display.)</span></div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">    alpha0 : float</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">        The maximal step size for Mehrota&#39;s predictor-corrector search</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">        direction; see :math:`\beta_3`of [4] Table 8.1</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">    beta : float</span></div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">        The desired reduction of the path parameter :math:`\mu` (see  [6]_)</span></div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">        The maximum number of iterations of the algorithm.</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral">    disp : bool</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">        Set to ``True`` if indicators of optimization status are to be printed</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral">        to the console each iteration.</span></div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">        Termination tolerance; see [4]_ Section 4.5.</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral">    sparse : bool</span></div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral">        Set to ``True`` if the problem is to be treated as sparse. However,</span></div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">        the inputs ``A_eq`` and ``A_ub`` should nonetheless be provided as</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">        (dense) arrays rather than sparse matrices.</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral">    lstsq : bool</span></div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral">        Set to ``True`` if the problem is expected to be very poorly</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">        conditioned. This should always be left as ``False`` unless severe</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">        numerical difficulties are frequently encountered, and a better option</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">        would be to improve the formulation of the problem.</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">    sym_pos : bool</span></div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral">        Leave ``True`` if the problem is expected to yield a well conditioned</span></div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">        symmetric positive definite normal equation matrix (almost always).</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">    cholesky : bool</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral">        Set to ``True`` if the normal equations are to be solved by explicit</span></div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral">        Cholesky decomposition followed by explicit forward/backward</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">        substitution. This is typically faster for moderate, dense problems</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral">        that are numerically well-behaved.</span></div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">    pc : bool</span></div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral">        Leave ``True`` if the predictor-corrector method of Mehrota is to be</span></div>
<div class="line"><span class="lineno">  615</span><span class="stringliteral">        used. This is almost always (if not always) beneficial.</span></div>
<div class="line"><span class="lineno">  616</span><span class="stringliteral">    ip : bool</span></div>
<div class="line"><span class="lineno">  617</span><span class="stringliteral">        Set to ``True`` if the improved initial point suggestion due to [4]_</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">        Section 4.3 is desired. It&#39;s unclear whether this is beneficial.</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral">    permc_spec : str (default = &#39;MMD_AT_PLUS_A&#39;)</span></div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral">        (Has effect only with ``sparse = True``, ``lstsq = False``, ``sym_pos =</span></div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral">        True``.) A matrix is factorized in each iteration of the algorithm.</span></div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral">        This option specifies how to permute the columns of the matrix for</span></div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral">        sparsity preservation. Acceptable values are:</span></div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">        - ``NATURAL``: natural ordering.</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">        - ``MMD_ATA``: minimum degree ordering on the structure of A^T A.</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">        - ``MMD_AT_PLUS_A``: minimum degree ordering on the structure of A^T+A.</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">        - ``COLAMD``: approximate minimum degree column ordering.</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">        This option can impact the convergence of the</span></div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral">        interior point algorithm; test different values to determine which</span></div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">        performs best for your problem. For more information, refer to</span></div>
<div class="line"><span class="lineno">  633</span><span class="stringliteral">        ``scipy.sparse.linalg.splu``.</span></div>
<div class="line"><span class="lineno">  634</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno">  635</span><span class="stringliteral">        If a callback function is provided, it will be called within each</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral">        iteration of the algorithm. The callback function must accept a single</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">        `scipy.optimize.OptimizeResult` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral">            x : 1-D array</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">                Current solution vector</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">            fun : float</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">                Current value of the objective function</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral">            success : bool</span></div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral">                True only when an algorithm has completed successfully,</span></div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">                so this is always False as the callback function is called</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">                only while the algorithm is still iterating.</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral">            slack : 1-D array</span></div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral">                The values of the slack variables. Each slack variable</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral">                corresponds to an inequality constraint. If the slack is zero,</span></div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral">                the corresponding constraint is active.</span></div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">            con : 1-D array</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral">                The (nominally zero) residuals of the equality constraints,</span></div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">                that is, ``b - A_eq @ x``</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">            phase : int</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">                The phase of the algorithm being executed. This is always</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">                1 for the interior-point method because it has only one phase.</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">            status : int</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral">                For revised simplex, this is always 0 because if a different</span></div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">                status is detected, the algorithm terminates.</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">            nit : int</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">                The number of iterations performed.</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">            message : str</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">                A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">    postsolve_args : tuple</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">        Data needed by _postsolve to convert the solution to the standard-form</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">        problem into the solution to the original problem.</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral">    x_hat : float</span></div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">        Solution vector (for standard form problem).</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral">         0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral">         1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral">         2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">         3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">         4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">        A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">    iteration : int</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">        The number of iterations taken to solve the problem</span></div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral">    .. [6] Freund, Robert M. &quot;Primal-Dual Interior-Point Methods for Linear</span></div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral">           Programming based on Newton&#39;s Method.&quot; Unpublished Course Notes,</span></div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">           March 2004. Available 2/25/2017 at:</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral">           https://ocw.mit.edu/courses/sloan-school-of-management/15-084j-nonlinear-programming-spring-2004/lecture-notes/lec14_int_pt_mthd.pdf</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    iteration = 0</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>    <span class="comment"># default initial point</span></div>
<div class="line"><span class="lineno">  702</span>    x, y, z, tau, kappa = _get_blind_start(A.shape)</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    <span class="comment"># first iteration is special improvement of initial point</span></div>
<div class="line"><span class="lineno">  705</span>    ip = ip <span class="keywordflow">if</span> pc <span class="keywordflow">else</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="comment"># [4] 4.5</span></div>
<div class="line"><span class="lineno">  708</span>    rho_p, rho_d, rho_A, rho_g, rho_mu, obj = _indicators(</div>
<div class="line"><span class="lineno">  709</span>        A, b, c, c0, x, y, z, tau, kappa)</div>
<div class="line"><span class="lineno">  710</span>    go = rho_p &gt; tol <span class="keywordflow">or</span> rho_d &gt; tol <span class="keywordflow">or</span> rho_A &gt; tol  <span class="comment"># we might get lucky : )</span></div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno">  713</span>        _display_iter(rho_p, rho_d, rho_g, <span class="stringliteral">&quot;-&quot;</span>, rho_mu, obj, header=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  715</span>        x_o, fun, slack, con = _postsolve(x/tau, postsolve_args)</div>
<div class="line"><span class="lineno">  716</span>        res = OptimizeResult({<span class="stringliteral">&#39;x&#39;</span>: x_o, <span class="stringliteral">&#39;fun&#39;</span>: fun, <span class="stringliteral">&#39;slack&#39;</span>: slack,</div>
<div class="line"><span class="lineno">  717</span>                              <span class="stringliteral">&#39;con&#39;</span>: con, <span class="stringliteral">&#39;nit&#39;</span>: iteration, <span class="stringliteral">&#39;phase&#39;</span>: 1,</div>
<div class="line"><span class="lineno">  718</span>                              <span class="stringliteral">&#39;complete&#39;</span>: <span class="keyword">False</span>, <span class="stringliteral">&#39;status&#39;</span>: 0,</div>
<div class="line"><span class="lineno">  719</span>                              <span class="stringliteral">&#39;message&#39;</span>: <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&#39;success&#39;</span>: <span class="keyword">False</span>})</div>
<div class="line"><span class="lineno">  720</span>        callback(res)</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>    status = 0</div>
<div class="line"><span class="lineno">  723</span>    message = <span class="stringliteral">&quot;Optimization terminated successfully.&quot;</span></div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>    <span class="keywordflow">if</span> sparse:</div>
<div class="line"><span class="lineno">  726</span>        A = sps.csc_matrix(A)</div>
<div class="line"><span class="lineno">  727</span>        A.T = A.transpose()  <span class="comment"># A.T is defined for sparse matrices but is slow</span></div>
<div class="line"><span class="lineno">  728</span>        <span class="comment"># Redefine it to avoid calculating again</span></div>
<div class="line"><span class="lineno">  729</span>        <span class="comment"># This is fine as long as A doesn&#39;t change</span></div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">while</span> go:</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>        iteration += 1</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>        <span class="keywordflow">if</span> ip:  <span class="comment"># initial point</span></div>
<div class="line"><span class="lineno">  736</span>            <span class="comment"># [4] Section 4.4</span></div>
<div class="line"><span class="lineno">  737</span>            gamma = 1</div>
<div class="line"><span class="lineno">  738</span> </div>
<div class="line"><span class="lineno">  739</span>            <span class="keyword">def </span>eta(g):</div>
<div class="line"><span class="lineno">  740</span>                <span class="keywordflow">return</span> 1</div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  742</span>            <span class="comment"># gamma = 0 in predictor step according to [4] 4.1</span></div>
<div class="line"><span class="lineno">  743</span>            <span class="comment"># if predictor/corrector is off, use mean of complementarity [6]</span></div>
<div class="line"><span class="lineno">  744</span>            <span class="comment"># 5.1 / [4] Below Figure 10-4</span></div>
<div class="line"><span class="lineno">  745</span>            gamma = 0 <span class="keywordflow">if</span> pc <span class="keywordflow">else</span> beta * np.mean(z * x)</div>
<div class="line"><span class="lineno">  746</span>            <span class="comment"># [4] Section 4.1</span></div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>            <span class="keyword">def </span>eta(g=gamma):</div>
<div class="line"><span class="lineno">  749</span>                <span class="keywordflow">return</span> 1 - g</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  752</span>            <span class="comment"># Solve [4] 8.6 and 8.7/8.13/8.23</span></div>
<div class="line"><span class="lineno">  753</span>            d_x, d_y, d_z, d_tau, d_kappa = _get_delta(</div>
<div class="line"><span class="lineno">  754</span>                A, b, c, x, y, z, tau, kappa, gamma, eta,</div>
<div class="line"><span class="lineno">  755</span>                sparse, lstsq, sym_pos, cholesky, pc, ip, permc_spec)</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>            <span class="keywordflow">if</span> ip:  <span class="comment"># initial point</span></div>
<div class="line"><span class="lineno">  758</span>                <span class="comment"># [4] 4.4</span></div>
<div class="line"><span class="lineno">  759</span>                <span class="comment"># Formula after 8.23 takes a full step regardless if this will</span></div>
<div class="line"><span class="lineno">  760</span>                <span class="comment"># take it negative</span></div>
<div class="line"><span class="lineno">  761</span>                alpha = 1.0</div>
<div class="line"><span class="lineno">  762</span>                x, y, z, tau, kappa = _do_step(</div>
<div class="line"><span class="lineno">  763</span>                    x, y, z, tau, kappa, d_x, d_y,</div>
<div class="line"><span class="lineno">  764</span>                    d_z, d_tau, d_kappa, alpha)</div>
<div class="line"><span class="lineno">  765</span>                x[x &lt; 1] = 1</div>
<div class="line"><span class="lineno">  766</span>                z[z &lt; 1] = 1</div>
<div class="line"><span class="lineno">  767</span>                tau = max(1, tau)</div>
<div class="line"><span class="lineno">  768</span>                kappa = max(1, kappa)</div>
<div class="line"><span class="lineno">  769</span>                ip = <span class="keyword">False</span>  <span class="comment"># done with initial point</span></div>
<div class="line"><span class="lineno">  770</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  771</span>                <span class="comment"># [4] Section 4.3</span></div>
<div class="line"><span class="lineno">  772</span>                alpha = _get_step(x, d_x, z, d_z, tau,</div>
<div class="line"><span class="lineno">  773</span>                                  d_tau, kappa, d_kappa, alpha0)</div>
<div class="line"><span class="lineno">  774</span>                <span class="comment"># [4] Equation 8.9</span></div>
<div class="line"><span class="lineno">  775</span>                x, y, z, tau, kappa = _do_step(</div>
<div class="line"><span class="lineno">  776</span>                    x, y, z, tau, kappa, d_x, d_y, d_z, d_tau, d_kappa, alpha)</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>        <span class="keywordflow">except</span> (LinAlgError, FloatingPointError,</div>
<div class="line"><span class="lineno">  779</span>                ValueError, ZeroDivisionError):</div>
<div class="line"><span class="lineno">  780</span>            <span class="comment"># this can happen when sparse solver is used and presolve</span></div>
<div class="line"><span class="lineno">  781</span>            <span class="comment"># is turned off. Also observed ValueError in AppVeyor Python 3.6</span></div>
<div class="line"><span class="lineno">  782</span>            <span class="comment"># Win32 build (PR #8676). I&#39;ve never seen it otherwise.</span></div>
<div class="line"><span class="lineno">  783</span>            status = 4</div>
<div class="line"><span class="lineno">  784</span>            message = _get_message(status)</div>
<div class="line"><span class="lineno">  785</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>        <span class="comment"># [4] 4.5</span></div>
<div class="line"><span class="lineno">  788</span>        rho_p, rho_d, rho_A, rho_g, rho_mu, obj = _indicators(</div>
<div class="line"><span class="lineno">  789</span>            A, b, c, c0, x, y, z, tau, kappa)</div>
<div class="line"><span class="lineno">  790</span>        go = rho_p &gt; tol <span class="keywordflow">or</span> rho_d &gt; tol <span class="keywordflow">or</span> rho_A &gt; tol</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>        <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno">  793</span>            _display_iter(rho_p, rho_d, rho_g, alpha, rho_mu, obj)</div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  795</span>            x_o, fun, slack, con = _postsolve(x/tau, postsolve_args)</div>
<div class="line"><span class="lineno">  796</span>            res = OptimizeResult({<span class="stringliteral">&#39;x&#39;</span>: x_o, <span class="stringliteral">&#39;fun&#39;</span>: fun, <span class="stringliteral">&#39;slack&#39;</span>: slack,</div>
<div class="line"><span class="lineno">  797</span>                                  <span class="stringliteral">&#39;con&#39;</span>: con, <span class="stringliteral">&#39;nit&#39;</span>: iteration, <span class="stringliteral">&#39;phase&#39;</span>: 1,</div>
<div class="line"><span class="lineno">  798</span>                                  <span class="stringliteral">&#39;complete&#39;</span>: <span class="keyword">False</span>, <span class="stringliteral">&#39;status&#39;</span>: 0,</div>
<div class="line"><span class="lineno">  799</span>                                  <span class="stringliteral">&#39;message&#39;</span>: <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&#39;success&#39;</span>: <span class="keyword">False</span>})</div>
<div class="line"><span class="lineno">  800</span>            callback(res)</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>        <span class="comment"># [4] 4.5</span></div>
<div class="line"><span class="lineno">  803</span>        inf1 = (rho_p &lt; tol <span class="keywordflow">and</span> rho_d &lt; tol <span class="keywordflow">and</span> rho_g &lt; tol <span class="keywordflow">and</span> tau &lt; tol *</div>
<div class="line"><span class="lineno">  804</span>                max(1, kappa))</div>
<div class="line"><span class="lineno">  805</span>        inf2 = rho_mu &lt; tol <span class="keywordflow">and</span> tau &lt; tol * min(1, kappa)</div>
<div class="line"><span class="lineno">  806</span>        <span class="keywordflow">if</span> inf1 <span class="keywordflow">or</span> inf2:</div>
<div class="line"><span class="lineno">  807</span>            <span class="comment"># [4] Lemma 8.4 / Theorem 8.3</span></div>
<div class="line"><span class="lineno">  808</span>            <span class="keywordflow">if</span> b.transpose().dot(y) &gt; tol:</div>
<div class="line"><span class="lineno">  809</span>                status = 2</div>
<div class="line"><span class="lineno">  810</span>            <span class="keywordflow">else</span>:  <span class="comment"># elif c.T.dot(x) &lt; tol: ? Probably not necessary.</span></div>
<div class="line"><span class="lineno">  811</span>                status = 3</div>
<div class="line"><span class="lineno">  812</span>            message = _get_message(status)</div>
<div class="line"><span class="lineno">  813</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  814</span>        <span class="keywordflow">elif</span> iteration &gt;= maxiter:</div>
<div class="line"><span class="lineno">  815</span>            status = 1</div>
<div class="line"><span class="lineno">  816</span>            message = _get_message(status)</div>
<div class="line"><span class="lineno">  817</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    x_hat = x / tau</div>
<div class="line"><span class="lineno">  820</span>    <span class="comment"># [4] Statement after Theorem 8.2</span></div>
<div class="line"><span class="lineno">  821</span>    <span class="keywordflow">return</span> x_hat, status, message, iteration</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a42cb4bc5cf1de3997308da90a69616a1" name="a42cb4bc5cf1de3997308da90a69616a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42cb4bc5cf1de3997308da90a69616a1">&#9670;&#160;</a></span>_linprog_ip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._linprog_ip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha0</em> = <code>.99995</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>beta</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparse</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lstsq</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sym_pos</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cholesky</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pc</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>permc_spec</em> = <code>'MMD_AT_PLUS_A'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimize a linear objective function subject to linear
equality and non-negativity constraints using the interior point method
of [4]_. Linear programming is intended to solve problems
of the following form:

Minimize::

    c @ x

Subject to::

    A @ x == b
        x &gt;= 0

User-facing documentation is in _linprog_doc.py.

Parameters
----------
c : 1-D array
    Coefficients of the linear objective function to be minimized.
c0 : float
    Constant term in objective function due to fixed (and eliminated)
    variables. (Purely for display.)
A : 2-D array
    2-D array such that ``A @ x``, gives the values of the equality
    constraints at ``x``.
b : 1-D array
    1-D array of values representing the right hand side of each equality
    constraint (row) in ``A``.
callback : callable, optional
    Callback function to be executed once per iteration.
postsolve_args : tuple
    Data needed by _postsolve to convert the solution to the standard-form
    problem into the solution to the original problem.

Options
-------
maxiter : int (default = 1000)
    The maximum number of iterations of the algorithm.
tol : float (default = 1e-8)
    Termination tolerance to be used for all termination criteria;
    see [4]_ Section 4.5.
disp : bool (default = False)
    Set to ``True`` if indicators of optimization status are to be printed
    to the console each iteration.
alpha0 : float (default = 0.99995)
    The maximal step size for Mehrota's predictor-corrector search
    direction; see :math:`\beta_{3}` of [4]_ Table 8.1.
beta : float (default = 0.1)
    The desired reduction of the path parameter :math:`\mu` (see [6]_)
    when Mehrota's predictor-corrector is not in use (uncommon).
sparse : bool (default = False)
    Set to ``True`` if the problem is to be treated as sparse after
    presolve. If either ``A_eq`` or ``A_ub`` is a sparse matrix,
    this option will automatically be set ``True``, and the problem
    will be treated as sparse even during presolve. If your constraint
    matrices contain mostly zeros and the problem is not very small (less
    than about 100 constraints or variables), consider setting ``True``
    or providing ``A_eq`` and ``A_ub`` as sparse matrices.
lstsq : bool (default = False)
    Set to ``True`` if the problem is expected to be very poorly
    conditioned. This should always be left ``False`` unless severe
    numerical difficulties are encountered. Leave this at the default
    unless you receive a warning message suggesting otherwise.
sym_pos : bool (default = True)
    Leave ``True`` if the problem is expected to yield a well conditioned
    symmetric positive definite normal equation matrix
    (almost always). Leave this at the default unless you receive
    a warning message suggesting otherwise.
cholesky : bool (default = True)
    Set to ``True`` if the normal equations are to be solved by explicit
    Cholesky decomposition followed by explicit forward/backward
    substitution. This is typically faster for problems
    that are numerically well-behaved.
pc : bool (default = True)
    Leave ``True`` if the predictor-corrector method of Mehrota is to be
    used. This is almost always (if not always) beneficial.
ip : bool (default = False)
    Set to ``True`` if the improved initial point suggestion due to [4]_
    Section 4.3 is desired. Whether this is beneficial or not
    depends on the problem.
permc_spec : str (default = 'MMD_AT_PLUS_A')
    (Has effect only with ``sparse = True``, ``lstsq = False``, ``sym_pos =
    True``, and no SuiteSparse.)
    A matrix is factorized in each iteration of the algorithm.
    This option specifies how to permute the columns of the matrix for
    sparsity preservation. Acceptable values are:

    - ``NATURAL``: natural ordering.
    - ``MMD_ATA``: minimum degree ordering on the structure of A^T A.
    - ``MMD_AT_PLUS_A``: minimum degree ordering on the structure of A^T+A.
    - ``COLAMD``: approximate minimum degree column ordering.

    This option can impact the convergence of the
    interior point algorithm; test different values to determine which
    performs best for your problem. For more information, refer to
    ``scipy.sparse.linalg.splu``.
unknown_options : dict
    Optional arguments not used by this particular solver. If
    `unknown_options` is non-empty a warning is issued listing all
    unused options.

Returns
-------
x : 1-D array
    Solution vector.
status : int
    An integer representing the exit status of the optimization::

     0 : Optimization terminated successfully
     1 : Iteration limit reached
     2 : Problem appears to be infeasible
     3 : Problem appears to be unbounded
     4 : Serious numerical difficulties encountered

message : str
    A string descriptor of the exit status of the optimization.
iteration : int
    The number of iterations taken to solve the problem.

Notes
-----
This method implements the algorithm outlined in [4]_ with ideas from [8]_
and a structure inspired by the simpler methods of [6]_.

The primal-dual path following method begins with initial 'guesses' of
the primal and dual variables of the standard form problem and iteratively
attempts to solve the (nonlinear) Karush-Kuhn-Tucker conditions for the
problem with a gradually reduced logarithmic barrier term added to the
objective. This particular implementation uses a homogeneous self-dual
formulation, which provides certificates of infeasibility or unboundedness
where applicable.

The default initial point for the primal and dual variables is that
defined in [4]_ Section 4.4 Equation 8.22. Optionally (by setting initial
point option ``ip=True``), an alternate (potentially improved) starting
point can be calculated according to the additional recommendations of
[4]_ Section 4.4.

A search direction is calculated using the predictor-corrector method
(single correction) proposed by Mehrota and detailed in [4]_ Section 4.1.
(A potential improvement would be to implement the method of multiple
corrections described in [4]_ Section 4.2.) In practice, this is
accomplished by solving the normal equations, [4]_ Section 5.1 Equations
8.31 and 8.32, derived from the Newton equations [4]_ Section 5 Equations
8.25 (compare to [4]_ Section 4 Equations 8.6-8.8). The advantage of
solving the normal equations rather than 8.25 directly is that the
matrices involved are symmetric positive definite, so Cholesky
decomposition can be used rather than the more expensive LU factorization.

With default options, the solver used to perform the factorization depends
on third-party software availability and the conditioning of the problem.

For dense problems, solvers are tried in the following order:

1. ``scipy.linalg.cho_factor``

2. ``scipy.linalg.solve`` with option ``sym_pos=True``

3. ``scipy.linalg.solve`` with option ``sym_pos=False``

4. ``scipy.linalg.lstsq``

For sparse problems:

1. ``sksparse.cholmod.cholesky`` (if scikit-sparse and SuiteSparse are installed)

2. ``scipy.sparse.linalg.factorized`` (if scikit-umfpack and SuiteSparse are installed)

3. ``scipy.sparse.linalg.splu`` (which uses SuperLU distributed with SciPy)

4. ``scipy.sparse.linalg.lsqr``

If the solver fails for any reason, successively more robust (but slower)
solvers are attempted in the order indicated. Attempting, failing, and
re-starting factorization can be time consuming, so if the problem is
numerically challenging, options can be set to  bypass solvers that are
failing. Setting ``cholesky=False`` skips to solver 2,
``sym_pos=False`` skips to solver 3, and ``lstsq=True`` skips
to solver 4 for both sparse and dense problems.

Potential improvements for combatting issues associated with dense
columns in otherwise sparse problems are outlined in [4]_ Section 5.3 and
[10]_ Section 4.1-4.2; the latter also discusses the alleviation of
accuracy issues associated with the substitution approach to free
variables.

After calculating the search direction, the maximum possible step size
that does not activate the non-negativity constraints is calculated, and
the smaller of this step size and unity is applied (as in [4]_ Section
4.1.) [4]_ Section 4.3 suggests improvements for choosing the step size.

The new point is tested according to the termination conditions of [4]_
Section 4.5. The same tolerance, which can be set using the ``tol`` option,
is used for all checks. (A potential improvement would be to expose
the different tolerances to be set independently.) If optimality,
unboundedness, or infeasibility is detected, the solve procedure
terminates; otherwise it repeats.

The expected problem formulation differs between the top level ``linprog``
module and the method specific solvers. The method specific solvers expect a
problem in standard form:

Minimize::

    c @ x

Subject to::

    A @ x == b
        x &gt;= 0

Whereas the top level ``linprog`` module expects a problem of form:

Minimize::

    c @ x

Subject to::

    A_ub @ x &lt;= b_ub
    A_eq @ x == b_eq
     lb &lt;= x &lt;= ub

where ``lb = 0`` and ``ub = None`` unless set in ``bounds``.

The original problem contains equality, upper-bound and variable constraints
whereas the method specific solver requires equality constraints and
variable non-negativity.

``linprog`` module converts the original problem to standard form by
converting the simple bounds to upper bound constraints, introducing
non-negative slack variables for inequality constraints, and expressing
unbounded variables as the difference between two non-negative variables.


References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.
.. [6] Freund, Robert M. "Primal-Dual Interior-Point Methods for Linear
       Programming based on Newton's Method." Unpublished Course Notes,
       March 2004. Available 2/25/2017 at
       https://ocw.mit.edu/courses/sloan-school-of-management/15-084j-nonlinear-programming-spring-2004/lecture-notes/lec14_int_pt_mthd.pdf
.. [8] Andersen, Erling D., and Knud D. Andersen. "Presolving in linear
       programming." Mathematical Programming 71.2 (1995): 221-245.
.. [9] Bertsimas, Dimitris, and J. Tsitsiklis. "Introduction to linear
       programming." Athena Scientific 1 (1997): 997.
.. [10] Andersen, Erling D., et al. Implementation of interior point methods
        for large scale linear programming. HEC/Universite de Geneve, 1996.</pre> <div class="fragment"><div class="line"><span class="lineno">  827</span>                permc_spec=<span class="stringliteral">&#39;MMD_AT_PLUS_A&#39;</span>, **unknown_options):</div>
<div class="line"><span class="lineno">  828</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">    Minimize a linear objective function subject to linear</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">    equality and non-negativity constraints using the interior point method</span></div>
<div class="line"><span class="lineno">  831</span><span class="stringliteral">    of [4]_. Linear programming is intended to solve problems</span></div>
<div class="line"><span class="lineno">  832</span><span class="stringliteral">    of the following form:</span></div>
<div class="line"><span class="lineno">  833</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  834</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno">  835</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  836</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno">  837</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  838</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno">  839</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  840</span><span class="stringliteral">        A @ x == b</span></div>
<div class="line"><span class="lineno">  841</span><span class="stringliteral">            x &gt;= 0</span></div>
<div class="line"><span class="lineno">  842</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  843</span><span class="stringliteral">    User-facing documentation is in _linprog_doc.py.</span></div>
<div class="line"><span class="lineno">  844</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  845</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  846</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  847</span><span class="stringliteral">    c : 1-D array</span></div>
<div class="line"><span class="lineno">  848</span><span class="stringliteral">        Coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  849</span><span class="stringliteral">    c0 : float</span></div>
<div class="line"><span class="lineno">  850</span><span class="stringliteral">        Constant term in objective function due to fixed (and eliminated)</span></div>
<div class="line"><span class="lineno">  851</span><span class="stringliteral">        variables. (Purely for display.)</span></div>
<div class="line"><span class="lineno">  852</span><span class="stringliteral">    A : 2-D array</span></div>
<div class="line"><span class="lineno">  853</span><span class="stringliteral">        2-D array such that ``A @ x``, gives the values of the equality</span></div>
<div class="line"><span class="lineno">  854</span><span class="stringliteral">        constraints at ``x``.</span></div>
<div class="line"><span class="lineno">  855</span><span class="stringliteral">    b : 1-D array</span></div>
<div class="line"><span class="lineno">  856</span><span class="stringliteral">        1-D array of values representing the right hand side of each equality</span></div>
<div class="line"><span class="lineno">  857</span><span class="stringliteral">        constraint (row) in ``A``.</span></div>
<div class="line"><span class="lineno">  858</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno">  859</span><span class="stringliteral">        Callback function to be executed once per iteration.</span></div>
<div class="line"><span class="lineno">  860</span><span class="stringliteral">    postsolve_args : tuple</span></div>
<div class="line"><span class="lineno">  861</span><span class="stringliteral">        Data needed by _postsolve to convert the solution to the standard-form</span></div>
<div class="line"><span class="lineno">  862</span><span class="stringliteral">        problem into the solution to the original problem.</span></div>
<div class="line"><span class="lineno">  863</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  864</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno">  865</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  866</span><span class="stringliteral">    maxiter : int (default = 1000)</span></div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">        The maximum number of iterations of the algorithm.</span></div>
<div class="line"><span class="lineno">  868</span><span class="stringliteral">    tol : float (default = 1e-8)</span></div>
<div class="line"><span class="lineno">  869</span><span class="stringliteral">        Termination tolerance to be used for all termination criteria;</span></div>
<div class="line"><span class="lineno">  870</span><span class="stringliteral">        see [4]_ Section 4.5.</span></div>
<div class="line"><span class="lineno">  871</span><span class="stringliteral">    disp : bool (default = False)</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral">        Set to ``True`` if indicators of optimization status are to be printed</span></div>
<div class="line"><span class="lineno">  873</span><span class="stringliteral">        to the console each iteration.</span></div>
<div class="line"><span class="lineno">  874</span><span class="stringliteral">    alpha0 : float (default = 0.99995)</span></div>
<div class="line"><span class="lineno">  875</span><span class="stringliteral">        The maximal step size for Mehrota&#39;s predictor-corrector search</span></div>
<div class="line"><span class="lineno">  876</span><span class="stringliteral">        direction; see :math:`\beta_{3}` of [4]_ Table 8.1.</span></div>
<div class="line"><span class="lineno">  877</span><span class="stringliteral">    beta : float (default = 0.1)</span></div>
<div class="line"><span class="lineno">  878</span><span class="stringliteral">        The desired reduction of the path parameter :math:`\mu` (see [6]_)</span></div>
<div class="line"><span class="lineno">  879</span><span class="stringliteral">        when Mehrota&#39;s predictor-corrector is not in use (uncommon).</span></div>
<div class="line"><span class="lineno">  880</span><span class="stringliteral">    sparse : bool (default = False)</span></div>
<div class="line"><span class="lineno">  881</span><span class="stringliteral">        Set to ``True`` if the problem is to be treated as sparse after</span></div>
<div class="line"><span class="lineno">  882</span><span class="stringliteral">        presolve. If either ``A_eq`` or ``A_ub`` is a sparse matrix,</span></div>
<div class="line"><span class="lineno">  883</span><span class="stringliteral">        this option will automatically be set ``True``, and the problem</span></div>
<div class="line"><span class="lineno">  884</span><span class="stringliteral">        will be treated as sparse even during presolve. If your constraint</span></div>
<div class="line"><span class="lineno">  885</span><span class="stringliteral">        matrices contain mostly zeros and the problem is not very small (less</span></div>
<div class="line"><span class="lineno">  886</span><span class="stringliteral">        than about 100 constraints or variables), consider setting ``True``</span></div>
<div class="line"><span class="lineno">  887</span><span class="stringliteral">        or providing ``A_eq`` and ``A_ub`` as sparse matrices.</span></div>
<div class="line"><span class="lineno">  888</span><span class="stringliteral">    lstsq : bool (default = False)</span></div>
<div class="line"><span class="lineno">  889</span><span class="stringliteral">        Set to ``True`` if the problem is expected to be very poorly</span></div>
<div class="line"><span class="lineno">  890</span><span class="stringliteral">        conditioned. This should always be left ``False`` unless severe</span></div>
<div class="line"><span class="lineno">  891</span><span class="stringliteral">        numerical difficulties are encountered. Leave this at the default</span></div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral">        unless you receive a warning message suggesting otherwise.</span></div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">    sym_pos : bool (default = True)</span></div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral">        Leave ``True`` if the problem is expected to yield a well conditioned</span></div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">        symmetric positive definite normal equation matrix</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral">        (almost always). Leave this at the default unless you receive</span></div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">        a warning message suggesting otherwise.</span></div>
<div class="line"><span class="lineno">  898</span><span class="stringliteral">    cholesky : bool (default = True)</span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral">        Set to ``True`` if the normal equations are to be solved by explicit</span></div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral">        Cholesky decomposition followed by explicit forward/backward</span></div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">        substitution. This is typically faster for problems</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">        that are numerically well-behaved.</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral">    pc : bool (default = True)</span></div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">        Leave ``True`` if the predictor-corrector method of Mehrota is to be</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral">        used. This is almost always (if not always) beneficial.</span></div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">    ip : bool (default = False)</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral">        Set to ``True`` if the improved initial point suggestion due to [4]_</span></div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">        Section 4.3 is desired. Whether this is beneficial or not</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral">        depends on the problem.</span></div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">    permc_spec : str (default = &#39;MMD_AT_PLUS_A&#39;)</span></div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral">        (Has effect only with ``sparse = True``, ``lstsq = False``, ``sym_pos =</span></div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">        True``, and no SuiteSparse.)</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral">        A matrix is factorized in each iteration of the algorithm.</span></div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">        This option specifies how to permute the columns of the matrix for</span></div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral">        sparsity preservation. Acceptable values are:</span></div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">        - ``NATURAL``: natural ordering.</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">        - ``MMD_ATA``: minimum degree ordering on the structure of A^T A.</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">        - ``MMD_AT_PLUS_A``: minimum degree ordering on the structure of A^T+A.</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral">        - ``COLAMD``: approximate minimum degree column ordering.</span></div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">        This option can impact the convergence of the</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral">        interior point algorithm; test different values to determine which</span></div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral">        performs best for your problem. For more information, refer to</span></div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral">        ``scipy.sparse.linalg.splu``.</span></div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">    unknown_options : dict</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">        Optional arguments not used by this particular solver. If</span></div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral">        `unknown_options` is non-empty a warning is issued listing all</span></div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral">        unused options.</span></div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral">    x : 1-D array</span></div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral">        Solution vector.</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral">         0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">         1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  940</span><span class="stringliteral">         2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  941</span><span class="stringliteral">         3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  942</span><span class="stringliteral">         4 : Serious numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  943</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  944</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno">  945</span><span class="stringliteral">        A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  946</span><span class="stringliteral">    iteration : int</span></div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral">        The number of iterations taken to solve the problem.</span></div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    This method implements the algorithm outlined in [4]_ with ideas from [8]_</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">    and a structure inspired by the simpler methods of [6]_.</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">    The primal-dual path following method begins with initial &#39;guesses&#39; of</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">    the primal and dual variables of the standard form problem and iteratively</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">    attempts to solve the (nonlinear) Karush-Kuhn-Tucker conditions for the</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">    problem with a gradually reduced logarithmic barrier term added to the</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">    objective. This particular implementation uses a homogeneous self-dual</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral">    formulation, which provides certificates of infeasibility or unboundedness</span></div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    where applicable.</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">    The default initial point for the primal and dual variables is that</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">    defined in [4]_ Section 4.4 Equation 8.22. Optionally (by setting initial</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral">    point option ``ip=True``), an alternate (potentially improved) starting</span></div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral">    point can be calculated according to the additional recommendations of</span></div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">    [4]_ Section 4.4.</span></div>
<div class="line"><span class="lineno">  967</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  968</span><span class="stringliteral">    A search direction is calculated using the predictor-corrector method</span></div>
<div class="line"><span class="lineno">  969</span><span class="stringliteral">    (single correction) proposed by Mehrota and detailed in [4]_ Section 4.1.</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral">    (A potential improvement would be to implement the method of multiple</span></div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral">    corrections described in [4]_ Section 4.2.) In practice, this is</span></div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral">    accomplished by solving the normal equations, [4]_ Section 5.1 Equations</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">    8.31 and 8.32, derived from the Newton equations [4]_ Section 5 Equations</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">    8.25 (compare to [4]_ Section 4 Equations 8.6-8.8). The advantage of</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">    solving the normal equations rather than 8.25 directly is that the</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">    matrices involved are symmetric positive definite, so Cholesky</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">    decomposition can be used rather than the more expensive LU factorization.</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral">    With default options, the solver used to perform the factorization depends</span></div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">    on third-party software availability and the conditioning of the problem.</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">    For dense problems, solvers are tried in the following order:</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">    1. ``scipy.linalg.cho_factor``</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral">    2. ``scipy.linalg.solve`` with option ``sym_pos=True``</span></div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">    3. ``scipy.linalg.solve`` with option ``sym_pos=False``</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">    4. ``scipy.linalg.lstsq``</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">    For sparse problems:</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">    1. ``sksparse.cholmod.cholesky`` (if scikit-sparse and SuiteSparse are installed)</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">    2. ``scipy.sparse.linalg.factorized`` (if scikit-umfpack and SuiteSparse are installed)</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">    3. ``scipy.sparse.linalg.splu`` (which uses SuperLU distributed with SciPy)</span></div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">    4. ``scipy.sparse.linalg.lsqr``</span></div>
<div class="line"><span class="lineno"> 1001</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1002</span><span class="stringliteral">    If the solver fails for any reason, successively more robust (but slower)</span></div>
<div class="line"><span class="lineno"> 1003</span><span class="stringliteral">    solvers are attempted in the order indicated. Attempting, failing, and</span></div>
<div class="line"><span class="lineno"> 1004</span><span class="stringliteral">    re-starting factorization can be time consuming, so if the problem is</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="stringliteral">    numerically challenging, options can be set to  bypass solvers that are</span></div>
<div class="line"><span class="lineno"> 1006</span><span class="stringliteral">    failing. Setting ``cholesky=False`` skips to solver 2,</span></div>
<div class="line"><span class="lineno"> 1007</span><span class="stringliteral">    ``sym_pos=False`` skips to solver 3, and ``lstsq=True`` skips</span></div>
<div class="line"><span class="lineno"> 1008</span><span class="stringliteral">    to solver 4 for both sparse and dense problems.</span></div>
<div class="line"><span class="lineno"> 1009</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1010</span><span class="stringliteral">    Potential improvements for combatting issues associated with dense</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral">    columns in otherwise sparse problems are outlined in [4]_ Section 5.3 and</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral">    [10]_ Section 4.1-4.2; the latter also discusses the alleviation of</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral">    accuracy issues associated with the substitution approach to free</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">    variables.</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1016</span><span class="stringliteral">    After calculating the search direction, the maximum possible step size</span></div>
<div class="line"><span class="lineno"> 1017</span><span class="stringliteral">    that does not activate the non-negativity constraints is calculated, and</span></div>
<div class="line"><span class="lineno"> 1018</span><span class="stringliteral">    the smaller of this step size and unity is applied (as in [4]_ Section</span></div>
<div class="line"><span class="lineno"> 1019</span><span class="stringliteral">    4.1.) [4]_ Section 4.3 suggests improvements for choosing the step size.</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral">    The new point is tested according to the termination conditions of [4]_</span></div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral">    Section 4.5. The same tolerance, which can be set using the ``tol`` option,</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral">    is used for all checks. (A potential improvement would be to expose</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral">    the different tolerances to be set independently.) If optimality,</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral">    unboundedness, or infeasibility is detected, the solve procedure</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="stringliteral">    terminates; otherwise it repeats.</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1028</span><span class="stringliteral">    The expected problem formulation differs between the top level ``linprog``</span></div>
<div class="line"><span class="lineno"> 1029</span><span class="stringliteral">    module and the method specific solvers. The method specific solvers expect a</span></div>
<div class="line"><span class="lineno"> 1030</span><span class="stringliteral">    problem in standard form:</span></div>
<div class="line"><span class="lineno"> 1031</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1032</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno"> 1033</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">        A @ x == b</span></div>
<div class="line"><span class="lineno"> 1039</span><span class="stringliteral">            x &gt;= 0</span></div>
<div class="line"><span class="lineno"> 1040</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1041</span><span class="stringliteral">    Whereas the top level ``linprog`` module expects a problem of form:</span></div>
<div class="line"><span class="lineno"> 1042</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1043</span><span class="stringliteral">    Minimize::</span></div>
<div class="line"><span class="lineno"> 1044</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1045</span><span class="stringliteral">        c @ x</span></div>
<div class="line"><span class="lineno"> 1046</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1047</span><span class="stringliteral">    Subject to::</span></div>
<div class="line"><span class="lineno"> 1048</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral">        A_ub @ x &lt;= b_ub</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral">        A_eq @ x == b_eq</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">         lb &lt;= x &lt;= ub</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">    where ``lb = 0`` and ``ub = None`` unless set in ``bounds``.</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral">    The original problem contains equality, upper-bound and variable constraints</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">    whereas the method specific solver requires equality constraints and</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral">    variable non-negativity.</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral">    ``linprog`` module converts the original problem to standard form by</span></div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral">    converting the simple bounds to upper bound constraints, introducing</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral">    non-negative slack variables for inequality constraints, and expressing</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">    unbounded variables as the difference between two non-negative variables.</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno"> 1069</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="stringliteral">    .. [6] Freund, Robert M. &quot;Primal-Dual Interior-Point Methods for Linear</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="stringliteral">           Programming based on Newton&#39;s Method.&quot; Unpublished Course Notes,</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="stringliteral">           March 2004. Available 2/25/2017 at</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral">           https://ocw.mit.edu/courses/sloan-school-of-management/15-084j-nonlinear-programming-spring-2004/lecture-notes/lec14_int_pt_mthd.pdf</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">    .. [8] Andersen, Erling D., and Knud D. Andersen. &quot;Presolving in linear</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">           programming.&quot; Mathematical Programming 71.2 (1995): 221-245.</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral">    .. [9] Bertsimas, Dimitris, and J. Tsitsiklis. &quot;Introduction to linear</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">           programming.&quot; Athena Scientific 1 (1997): 997.</span></div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral">    .. [10] Andersen, Erling D., et al. Implementation of interior point methods</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">            for large scale linear programming. HEC/Universite de Geneve, 1996.</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1083</span> </div>
<div class="line"><span class="lineno"> 1084</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>    <span class="comment"># These should be warnings, not errors</span></div>
<div class="line"><span class="lineno"> 1087</span>    <span class="keywordflow">if</span> (cholesky <span class="keywordflow">or</span> cholesky <span class="keywordflow">is</span> <span class="keywordtype">None</span>) <span class="keywordflow">and</span> sparse <span class="keywordflow">and</span> <span class="keywordflow">not</span> has_cholmod:</div>
<div class="line"><span class="lineno"> 1088</span>        <span class="keywordflow">if</span> cholesky:</div>
<div class="line"><span class="lineno"> 1089</span>            warn(<span class="stringliteral">&quot;Sparse cholesky is only available with scikit-sparse. &quot;</span></div>
<div class="line"><span class="lineno"> 1090</span>                 <span class="stringliteral">&quot;Setting `cholesky = False`&quot;</span>,</div>
<div class="line"><span class="lineno"> 1091</span>                 OptimizeWarning, stacklevel=3)</div>
<div class="line"><span class="lineno"> 1092</span>        cholesky = <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keywordflow">if</span> sparse <span class="keywordflow">and</span> lstsq:</div>
<div class="line"><span class="lineno"> 1095</span>        warn(<span class="stringliteral">&quot;Option combination &#39;sparse&#39;:True and &#39;lstsq&#39;:True &quot;</span></div>
<div class="line"><span class="lineno"> 1096</span>             <span class="stringliteral">&quot;is not recommended.&quot;</span>,</div>
<div class="line"><span class="lineno"> 1097</span>             OptimizeWarning, stacklevel=3)</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>    <span class="keywordflow">if</span> lstsq <span class="keywordflow">and</span> cholesky:</div>
<div class="line"><span class="lineno"> 1100</span>        warn(<span class="stringliteral">&quot;Invalid option combination &#39;lstsq&#39;:True &quot;</span></div>
<div class="line"><span class="lineno"> 1101</span>             <span class="stringliteral">&quot;and &#39;cholesky&#39;:True; option &#39;cholesky&#39; has no effect when &quot;</span></div>
<div class="line"><span class="lineno"> 1102</span>             <span class="stringliteral">&quot;&#39;lstsq&#39; is set True.&quot;</span>,</div>
<div class="line"><span class="lineno"> 1103</span>             OptimizeWarning, stacklevel=3)</div>
<div class="line"><span class="lineno"> 1104</span> </div>
<div class="line"><span class="lineno"> 1105</span>    valid_permc_spec = (<span class="stringliteral">&#39;NATURAL&#39;</span>, <span class="stringliteral">&#39;MMD_ATA&#39;</span>, <span class="stringliteral">&#39;MMD_AT_PLUS_A&#39;</span>, <span class="stringliteral">&#39;COLAMD&#39;</span>)</div>
<div class="line"><span class="lineno"> 1106</span>    <span class="keywordflow">if</span> permc_spec.upper() <span class="keywordflow">not</span> <span class="keywordflow">in</span> valid_permc_spec:</div>
<div class="line"><span class="lineno"> 1107</span>        warn(<span class="stringliteral">&quot;Invalid permc_spec option: &#39;&quot;</span> + str(permc_spec) + <span class="stringliteral">&quot;&#39;. &quot;</span></div>
<div class="line"><span class="lineno"> 1108</span>             <span class="stringliteral">&quot;Acceptable values are &#39;NATURAL&#39;, &#39;MMD_ATA&#39;, &#39;MMD_AT_PLUS_A&#39;, &quot;</span></div>
<div class="line"><span class="lineno"> 1109</span>             <span class="stringliteral">&quot;and &#39;COLAMD&#39;. Reverting to default.&quot;</span>,</div>
<div class="line"><span class="lineno"> 1110</span>             OptimizeWarning, stacklevel=3)</div>
<div class="line"><span class="lineno"> 1111</span>        permc_spec = <span class="stringliteral">&#39;MMD_AT_PLUS_A&#39;</span></div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>    <span class="comment"># This can be an error</span></div>
<div class="line"><span class="lineno"> 1114</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> sym_pos <span class="keywordflow">and</span> cholesky:</div>
<div class="line"><span class="lineno"> 1115</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno"> 1116</span>            <span class="stringliteral">&quot;Invalid option combination &#39;sym_pos&#39;:False &quot;</span></div>
<div class="line"><span class="lineno"> 1117</span>            <span class="stringliteral">&quot;and &#39;cholesky&#39;:True: Cholesky decomposition is only possible &quot;</span></div>
<div class="line"><span class="lineno"> 1118</span>            <span class="stringliteral">&quot;for symmetric positive definite matrices.&quot;</span>)</div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>    cholesky = cholesky <span class="keywordflow">or</span> (cholesky <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> sym_pos <span class="keywordflow">and</span> <span class="keywordflow">not</span> lstsq)</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>    x, status, message, iteration = _ip_hsd(A, b, c, c0, alpha0, beta,</div>
<div class="line"><span class="lineno"> 1123</span>                                            maxiter, disp, tol, sparse,</div>
<div class="line"><span class="lineno"> 1124</span>                                            lstsq, sym_pos, cholesky,</div>
<div class="line"><span class="lineno"> 1125</span>                                            pc, ip, permc_spec, callback,</div>
<div class="line"><span class="lineno"> 1126</span>                                            postsolve_args)</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>    <span class="keywordflow">return</span> x, status, message, iteration</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1248a49c1aea2448578f657e76bec188" name="a1248a49c1aea2448578f657e76bec188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1248a49c1aea2448578f657e76bec188">&#9670;&#160;</a></span>_sym_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_ip._sym_solve </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Dinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>solve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">An implementation of [4] equation 8.31 and 8.32

References
----------
.. [4] Andersen, Erling D., and Knud D. Andersen. "The MOSEK interior point
       optimizer for linear programming: an implementation of the
       homogeneous algorithm." High performance optimization. Springer US,
       2000. 197-232.</pre> <div class="fragment"><div class="line"><span class="lineno">  333</span><span class="keyword">def </span>_sym_solve(Dinv, A, r1, r2, solve):</div>
<div class="line"><span class="lineno">  334</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    An implementation of [4] equation 8.31 and 8.32</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">    .. [4] Andersen, Erling D., and Knud D. Andersen. &quot;The MOSEK interior point</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">           optimizer for linear programming: an implementation of the</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">           homogeneous algorithm.&quot; High performance optimization. Springer US,</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">           2000. 197-232.</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  345</span>    <span class="comment"># [4] 8.31</span></div>
<div class="line"><span class="lineno">  346</span>    r = r2 + A.dot(Dinv * r1)</div>
<div class="line"><span class="lineno">  347</span>    v = solve(r)</div>
<div class="line"><span class="lineno">  348</span>    <span class="comment"># [4] 8.32</span></div>
<div class="line"><span class="lineno">  349</span>    u = Dinv * (A.T.dot(v) - r1)</div>
<div class="line"><span class="lineno">  350</span>    <span class="keywordflow">return</span> u, v</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a23cc8954769aa8804b0aae1303bab0d9" name="a23cc8954769aa8804b0aae1303bab0d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23cc8954769aa8804b0aae1303bab0d9">&#9670;&#160;</a></span>has_cholmod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scipy.optimize._linprog_ip.has_cholmod = True</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a35542dc98dc5eb7e24ce99ad20609fd9" name="a35542dc98dc5eb7e24ce99ad20609fd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35542dc98dc5eb7e24ce99ad20609fd9">&#9670;&#160;</a></span>has_umfpack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scipy.optimize._linprog_ip.has_umfpack = True</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
