<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.decomposition.tests.test_kernel_pca Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1decomposition.html">decomposition</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html">test_kernel_pca</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.decomposition.tests.test_kernel_pca Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7a0532f4becd302b9dfaea5ff52018fc" id="r_a7a0532f4becd302b9dfaea5ff52018fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a7a0532f4becd302b9dfaea5ff52018fc">test_kernel_pca</a> ()</td></tr>
<tr class="separator:a7a0532f4becd302b9dfaea5ff52018fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae26000837a43eeb2a33ca48214ace902" id="r_ae26000837a43eeb2a33ca48214ace902"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#ae26000837a43eeb2a33ca48214ace902">test_kernel_pca_invalid_parameters</a> ()</td></tr>
<tr class="separator:ae26000837a43eeb2a33ca48214ace902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70575569754fd5eba7c1247abae19292" id="r_a70575569754fd5eba7c1247abae19292"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a70575569754fd5eba7c1247abae19292">test_kernel_pca_consistent_transform</a> ()</td></tr>
<tr class="separator:a70575569754fd5eba7c1247abae19292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad66ce9a77befaf1ab0e072aa1024d70" id="r_aad66ce9a77befaf1ab0e072aa1024d70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#aad66ce9a77befaf1ab0e072aa1024d70">test_kernel_pca_deterministic_output</a> ()</td></tr>
<tr class="separator:aad66ce9a77befaf1ab0e072aa1024d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4f8053a71b013fddf28a2523fc2d568" id="r_ac4f8053a71b013fddf28a2523fc2d568"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#ac4f8053a71b013fddf28a2523fc2d568">test_kernel_pca_sparse</a> ()</td></tr>
<tr class="separator:ac4f8053a71b013fddf28a2523fc2d568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd05332bbb11178090cea30753660f2e" id="r_acd05332bbb11178090cea30753660f2e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#acd05332bbb11178090cea30753660f2e">test_kernel_pca_linear_kernel</a> (solver, n_features)</td></tr>
<tr class="separator:acd05332bbb11178090cea30753660f2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef694ad3ea1e56cef808894b724cc4a1" id="r_aef694ad3ea1e56cef808894b724cc4a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#aef694ad3ea1e56cef808894b724cc4a1">test_kernel_pca_n_components</a> ()</td></tr>
<tr class="separator:aef694ad3ea1e56cef808894b724cc4a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14795984239fe7aa042c1fa998037ca" id="r_ac14795984239fe7aa042c1fa998037ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#ac14795984239fe7aa042c1fa998037ca">test_remove_zero_eig</a> ()</td></tr>
<tr class="separator:ac14795984239fe7aa042c1fa998037ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59c4671e21d8ab727cc127097587c923" id="r_a59c4671e21d8ab727cc127097587c923"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a59c4671e21d8ab727cc127097587c923">test_leave_zero_eig</a> ()</td></tr>
<tr class="separator:a59c4671e21d8ab727cc127097587c923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd04458f08807e871a9c538ad705be01" id="r_acd04458f08807e871a9c538ad705be01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#acd04458f08807e871a9c538ad705be01">test_kernel_pca_precomputed</a> ()</td></tr>
<tr class="separator:acd04458f08807e871a9c538ad705be01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6f7af0a86aadc4bd8b9e597568e5710" id="r_af6f7af0a86aadc4bd8b9e597568e5710"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#af6f7af0a86aadc4bd8b9e597568e5710">test_kernel_pca_precomputed_non_symmetric</a> (solver)</td></tr>
<tr class="separator:af6f7af0a86aadc4bd8b9e597568e5710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae656a51e9ef78d821d3ff5f10e6d3dd3" id="r_ae656a51e9ef78d821d3ff5f10e6d3dd3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#ae656a51e9ef78d821d3ff5f10e6d3dd3">test_gridsearch_pipeline</a> ()</td></tr>
<tr class="separator:ae656a51e9ef78d821d3ff5f10e6d3dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed449a400d8a222e3819ec6b1ae0e3a" id="r_a1ed449a400d8a222e3819ec6b1ae0e3a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a1ed449a400d8a222e3819ec6b1ae0e3a">test_gridsearch_pipeline_precomputed</a> ()</td></tr>
<tr class="separator:a1ed449a400d8a222e3819ec6b1ae0e3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87acadd5858af2492e400bc7003a82bd" id="r_a87acadd5858af2492e400bc7003a82bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a87acadd5858af2492e400bc7003a82bd">test_nested_circles</a> ()</td></tr>
<tr class="separator:a87acadd5858af2492e400bc7003a82bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c91197f96a58f755d0140f86ead3339" id="r_a2c91197f96a58f755d0140f86ead3339"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a2c91197f96a58f755d0140f86ead3339">test_kernel_conditioning</a> ()</td></tr>
<tr class="separator:a2c91197f96a58f755d0140f86ead3339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bf430b9a953ba8ce3d16cff0d2fde09" id="r_a9bf430b9a953ba8ce3d16cff0d2fde09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a9bf430b9a953ba8ce3d16cff0d2fde09">test_precomputed_kernel_not_psd</a> (solver)</td></tr>
<tr class="separator:a9bf430b9a953ba8ce3d16cff0d2fde09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4170797d0cb93eec99925b25e97059d1" id="r_a4170797d0cb93eec99925b25e97059d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a4170797d0cb93eec99925b25e97059d1">test_kernel_pca_solvers_equivalence</a> (n_components)</td></tr>
<tr class="separator:a4170797d0cb93eec99925b25e97059d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f2572b7e94433c13a6a3912054de544" id="r_a6f2572b7e94433c13a6a3912054de544"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a6f2572b7e94433c13a6a3912054de544">test_kernel_pca_inverse_transform_reconstruction</a> ()</td></tr>
<tr class="separator:a6f2572b7e94433c13a6a3912054de544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad86e74e071191a488cffead8e7264690" id="r_ad86e74e071191a488cffead8e7264690"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#ad86e74e071191a488cffead8e7264690">test_kernel_pca_raise_not_fitted_error</a> ()</td></tr>
<tr class="separator:ad86e74e071191a488cffead8e7264690"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a0d63847a2f77c4b2792328d6c6d31d" id="r_a3a0d63847a2f77c4b2792328d6c6d31d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a3a0d63847a2f77c4b2792328d6c6d31d">test_32_64_decomposition_shape</a> ()</td></tr>
<tr class="separator:a3a0d63847a2f77c4b2792328d6c6d31d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79d891fd3914611621ae6067f662f4ea" id="r_a79d891fd3914611621ae6067f662f4ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca.html#a79d891fd3914611621ae6067f662f4ea">test_kernel_pca_feature_names_out</a> ()</td></tr>
<tr class="separator:a79d891fd3914611621ae6067f662f4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3a0d63847a2f77c4b2792328d6c6d31d" name="a3a0d63847a2f77c4b2792328d6c6d31d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a0d63847a2f77c4b2792328d6c6d31d">&#9670;&#160;</a></span>test_32_64_decomposition_shape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_32_64_decomposition_shape </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that the decomposition is similar for 32 and 64 bits data

Non regression test for
https://github.com/scikit-learn/scikit-learn/issues/18146
</pre> <div class="fragment"><div class="line"><span class="lineno">  502</span><span class="keyword">def </span>test_32_64_decomposition_shape():</div>
<div class="line"><span class="lineno">  503</span>    <span class="stringliteral">&quot;&quot;&quot;Test that the decomposition is similar for 32 and 64 bits data</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  505</span><span class="stringliteral">    Non regression test for</span></div>
<div class="line"><span class="lineno">  506</span><span class="stringliteral">    https://github.com/scikit-learn/scikit-learn/issues/18146</span></div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  508</span>    X, y = make_blobs(</div>
<div class="line"><span class="lineno">  509</span>        n_samples=30, centers=[[0, 0, 0], [1, 1, 1]], random_state=0, cluster_std=0.1</div>
<div class="line"><span class="lineno">  510</span>    )</div>
<div class="line"><span class="lineno">  511</span>    X = StandardScaler().fit_transform(X)</div>
<div class="line"><span class="lineno">  512</span>    X -= X.min()</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <span class="comment"># Compare the shapes (corresponds to the number of non-zero eigenvalues)</span></div>
<div class="line"><span class="lineno">  515</span>    kpca = KernelPCA()</div>
<div class="line"><span class="lineno">  516</span>    <span class="keyword">assert</span> kpca.fit_transform(X).shape == kpca.fit_transform(X.astype(np.float32)).shape</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae656a51e9ef78d821d3ff5f10e6d3dd3" name="ae656a51e9ef78d821d3ff5f10e6d3dd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae656a51e9ef78d821d3ff5f10e6d3dd3">&#9670;&#160;</a></span>test_gridsearch_pipeline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_gridsearch_pipeline </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that kPCA works as expected in a grid search pipeline

Test if we can do a grid-search to find parameters to separate
circles with a perceptron model.
</pre> <div class="fragment"><div class="line"><span class="lineno">  313</span><span class="keyword">def </span>test_gridsearch_pipeline():</div>
<div class="line"><span class="lineno">  314</span>    <span class="stringliteral">&quot;&quot;&quot;Check that kPCA works as expected in a grid search pipeline</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    Test if we can do a grid-search to find parameters to separate</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">    circles with a perceptron model.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  319</span>    X, y = make_circles(n_samples=400, factor=0.3, noise=0.05, random_state=0)</div>
<div class="line"><span class="lineno">  320</span>    kpca = KernelPCA(kernel=<span class="stringliteral">&quot;rbf&quot;</span>, n_components=2)</div>
<div class="line"><span class="lineno">  321</span>    pipeline = Pipeline([(<span class="stringliteral">&quot;kernel_pca&quot;</span>, kpca), (<span class="stringliteral">&quot;Perceptron&quot;</span>, Perceptron(max_iter=5))])</div>
<div class="line"><span class="lineno">  322</span>    param_grid = dict(kernel_pca__gamma=2.0 ** np.arange(-2, 2))</div>
<div class="line"><span class="lineno">  323</span>    grid_search = GridSearchCV(pipeline, cv=3, param_grid=param_grid)</div>
<div class="line"><span class="lineno">  324</span>    grid_search.fit(X, y)</div>
<div class="line"><span class="lineno">  325</span>    <span class="keyword">assert</span> grid_search.best_score_ == 1</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ed449a400d8a222e3819ec6b1ae0e3a" name="a1ed449a400d8a222e3819ec6b1ae0e3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed449a400d8a222e3819ec6b1ae0e3a">&#9670;&#160;</a></span>test_gridsearch_pipeline_precomputed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_gridsearch_pipeline_precomputed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that kPCA works as expected in a grid search pipeline (2)

Test if we can do a grid-search to find parameters to separate
circles with a perceptron model. This test uses a precomputed kernel.
</pre> <div class="fragment"><div class="line"><span class="lineno">  328</span><span class="keyword">def </span>test_gridsearch_pipeline_precomputed():</div>
<div class="line"><span class="lineno">  329</span>    <span class="stringliteral">&quot;&quot;&quot;Check that kPCA works as expected in a grid search pipeline (2)</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    Test if we can do a grid-search to find parameters to separate</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    circles with a perceptron model. This test uses a precomputed kernel.</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  334</span>    X, y = make_circles(n_samples=400, factor=0.3, noise=0.05, random_state=0)</div>
<div class="line"><span class="lineno">  335</span>    kpca = KernelPCA(kernel=<span class="stringliteral">&quot;precomputed&quot;</span>, n_components=2)</div>
<div class="line"><span class="lineno">  336</span>    pipeline = Pipeline([(<span class="stringliteral">&quot;kernel_pca&quot;</span>, kpca), (<span class="stringliteral">&quot;Perceptron&quot;</span>, Perceptron(max_iter=5))])</div>
<div class="line"><span class="lineno">  337</span>    param_grid = dict(Perceptron__max_iter=np.arange(1, 5))</div>
<div class="line"><span class="lineno">  338</span>    grid_search = GridSearchCV(pipeline, cv=3, param_grid=param_grid)</div>
<div class="line"><span class="lineno">  339</span>    X_kernel = rbf_kernel(X, gamma=2.0)</div>
<div class="line"><span class="lineno">  340</span>    grid_search.fit(X_kernel, y)</div>
<div class="line"><span class="lineno">  341</span>    <span class="keyword">assert</span> grid_search.best_score_ == 1</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c91197f96a58f755d0140f86ead3339" name="a2c91197f96a58f755d0140f86ead3339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c91197f96a58f755d0140f86ead3339">&#9670;&#160;</a></span>test_kernel_conditioning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_conditioning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that ``_check_psd_eigenvalues`` is correctly called in kPCA

Non-regression test for issue #12140 (PR #12145).
</pre> <div class="fragment"><div class="line"><span class="lineno">  372</span><span class="keyword">def </span>test_kernel_conditioning():</div>
<div class="line"><span class="lineno">  373</span>    <span class="stringliteral">&quot;&quot;&quot;Check that ``_check_psd_eigenvalues`` is correctly called in kPCA</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">    Non-regression test for issue #12140 (PR #12145).</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>    <span class="comment"># create a pathological X leading to small non-zero eigenvalue</span></div>
<div class="line"><span class="lineno">  379</span>    X = [[5, 1], [5 + 1e-8, 1e-8], [5 + 1e-8, 0]]</div>
<div class="line"><span class="lineno">  380</span>    kpca = KernelPCA(kernel=<span class="stringliteral">&quot;linear&quot;</span>, n_components=2, fit_inverse_transform=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  381</span>    kpca.fit(X)</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="comment"># check that the small non-zero eigenvalue was correctly set to zero</span></div>
<div class="line"><span class="lineno">  384</span>    <span class="keyword">assert</span> kpca.eigenvalues_.min() == 0</div>
<div class="line"><span class="lineno">  385</span>    <span class="keyword">assert</span> np.all(kpca.eigenvalues_ == _check_psd_eigenvalues(kpca.eigenvalues_))</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span><span class="preprocessor">@pytest.mark.parametrize(&quot;solver&quot;, [&quot;auto&quot;, &quot;dense&quot;, &quot;arpack&quot;, &quot;randomized&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a0532f4becd302b9dfaea5ff52018fc" name="a7a0532f4becd302b9dfaea5ff52018fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a0532f4becd302b9dfaea5ff52018fc">&#9670;&#160;</a></span>test_kernel_pca()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Nominal test for all solvers and all known kernels + a custom one

It tests
 - that fit_transform is equivalent to fit+transform
 - that the shapes of transforms and inverse transforms are correct
</pre> <div class="fragment"><div class="line"><span class="lineno">   24</span><span class="keyword">def </span>test_kernel_pca():</div>
<div class="line"><span class="lineno">   25</span>    <span class="stringliteral">&quot;&quot;&quot;Nominal test for all solvers and all known kernels + a custom one</span></div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">    It tests</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">     - that fit_transform is equivalent to fit+transform</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">     - that the shapes of transforms and inverse transforms are correct</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   31</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">   32</span>    X_fit = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno">   33</span>    X_pred = rng.random_sample((2, 4))</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>    <span class="keyword">def </span>histogram(x, y, **kwargs):</div>
<div class="line"><span class="lineno">   36</span>        <span class="comment"># Histogram kernel implemented as a callable.</span></div>
<div class="line"><span class="lineno">   37</span>        <span class="keyword">assert</span> kwargs == {}  <span class="comment"># no kernel_params that we didn&#39;t ask for</span></div>
<div class="line"><span class="lineno">   38</span>        <span class="keywordflow">return</span> np.minimum(x, y).sum()</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">for</span> eigen_solver <span class="keywordflow">in</span> (<span class="stringliteral">&quot;auto&quot;</span>, <span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;arpack&quot;</span>, <span class="stringliteral">&quot;randomized&quot;</span>):</div>
<div class="line"><span class="lineno">   41</span>        <span class="keywordflow">for</span> kernel <span class="keywordflow">in</span> (<span class="stringliteral">&quot;linear&quot;</span>, <span class="stringliteral">&quot;rbf&quot;</span>, <span class="stringliteral">&quot;poly&quot;</span>, histogram):</div>
<div class="line"><span class="lineno">   42</span>            <span class="comment"># histogram kernel produces singular matrix inside linalg.solve</span></div>
<div class="line"><span class="lineno">   43</span>            <span class="comment"># XXX use a least-squares approximation?</span></div>
<div class="line"><span class="lineno">   44</span>            inv = <span class="keywordflow">not</span> callable(kernel)</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>            <span class="comment"># transform fit data</span></div>
<div class="line"><span class="lineno">   47</span>            kpca = KernelPCA(</div>
<div class="line"><span class="lineno">   48</span>                4, kernel=kernel, eigen_solver=eigen_solver, fit_inverse_transform=inv</div>
<div class="line"><span class="lineno">   49</span>            )</div>
<div class="line"><span class="lineno">   50</span>            X_fit_transformed = kpca.fit_transform(X_fit)</div>
<div class="line"><span class="lineno">   51</span>            X_fit_transformed2 = kpca.fit(X_fit).transform(X_fit)</div>
<div class="line"><span class="lineno">   52</span>            assert_array_almost_equal(</div>
<div class="line"><span class="lineno">   53</span>                np.abs(X_fit_transformed), np.abs(X_fit_transformed2)</div>
<div class="line"><span class="lineno">   54</span>            )</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>            <span class="comment"># non-regression test: previously, gamma would be 0 by default,</span></div>
<div class="line"><span class="lineno">   57</span>            <span class="comment"># forcing all eigenvalues to 0 under the poly kernel</span></div>
<div class="line"><span class="lineno">   58</span>            <span class="keyword">assert</span> X_fit_transformed.size != 0</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>            <span class="comment"># transform new data</span></div>
<div class="line"><span class="lineno">   61</span>            X_pred_transformed = kpca.transform(X_pred)</div>
<div class="line"><span class="lineno">   62</span>            <span class="keyword">assert</span> X_pred_transformed.shape[1] == X_fit_transformed.shape[1]</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>            <span class="comment"># inverse transform</span></div>
<div class="line"><span class="lineno">   65</span>            <span class="keywordflow">if</span> inv:</div>
<div class="line"><span class="lineno">   66</span>                X_pred2 = kpca.inverse_transform(X_pred_transformed)</div>
<div class="line"><span class="lineno">   67</span>                <span class="keyword">assert</span> X_pred2.shape == X_pred.shape</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a70575569754fd5eba7c1247abae19292" name="a70575569754fd5eba7c1247abae19292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70575569754fd5eba7c1247abae19292">&#9670;&#160;</a></span>test_kernel_pca_consistent_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_consistent_transform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check robustness to mutations in the original training array

Test that after fitting a kPCA model, it stays independent of any
mutation of the values of the original data object by relying on an
internal copy.
</pre> <div class="fragment"><div class="line"><span class="lineno">   84</span><span class="keyword">def </span>test_kernel_pca_consistent_transform():</div>
<div class="line"><span class="lineno">   85</span>    <span class="stringliteral">&quot;&quot;&quot;Check robustness to mutations in the original training array</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">    Test that after fitting a kPCA model, it stays independent of any</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    mutation of the values of the original data object by relying on an</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    internal copy.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   91</span>    <span class="comment"># X_fit_ needs to retain the old, unmodified copy of X</span></div>
<div class="line"><span class="lineno">   92</span>    state = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">   93</span>    X = state.rand(10, 10)</div>
<div class="line"><span class="lineno">   94</span>    kpca = KernelPCA(random_state=state).fit(X)</div>
<div class="line"><span class="lineno">   95</span>    transformed1 = kpca.transform(X)</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    X_copy = X.copy()</div>
<div class="line"><span class="lineno">   98</span>    X[:, 0] = 666</div>
<div class="line"><span class="lineno">   99</span>    transformed2 = kpca.transform(X_copy)</div>
<div class="line"><span class="lineno">  100</span>    assert_array_almost_equal(transformed1, transformed2)</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aad66ce9a77befaf1ab0e072aa1024d70" name="aad66ce9a77befaf1ab0e072aa1024d70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad66ce9a77befaf1ab0e072aa1024d70">&#9670;&#160;</a></span>test_kernel_pca_deterministic_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_deterministic_output </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that Kernel PCA produces deterministic output

Tests that the same inputs and random state produce the same output.
</pre> <div class="fragment"><div class="line"><span class="lineno">  103</span><span class="keyword">def </span>test_kernel_pca_deterministic_output():</div>
<div class="line"><span class="lineno">  104</span>    <span class="stringliteral">&quot;&quot;&quot;Test that Kernel PCA produces deterministic output</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    Tests that the same inputs and random state produce the same output.</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  108</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  109</span>    X = rng.rand(10, 10)</div>
<div class="line"><span class="lineno">  110</span>    eigen_solver = (<span class="stringliteral">&quot;arpack&quot;</span>, <span class="stringliteral">&quot;dense&quot;</span>)</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">for</span> solver <span class="keywordflow">in</span> eigen_solver:</div>
<div class="line"><span class="lineno">  113</span>        transformed_X = np.zeros((20, 2))</div>
<div class="line"><span class="lineno">  114</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(20):</div>
<div class="line"><span class="lineno">  115</span>            kpca = KernelPCA(n_components=2, eigen_solver=solver, random_state=rng)</div>
<div class="line"><span class="lineno">  116</span>            transformed_X[i, :] = kpca.fit_transform(X)[0]</div>
<div class="line"><span class="lineno">  117</span>        assert_allclose(transformed_X, np.tile(transformed_X[0, :], 20).reshape(20, 2))</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a79d891fd3914611621ae6067f662f4ea" name="a79d891fd3914611621ae6067f662f4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79d891fd3914611621ae6067f662f4ea">&#9670;&#160;</a></span>test_kernel_pca_feature_names_out()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_feature_names_out </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check feature names out for KernelPCA.</pre> <div class="fragment"><div class="line"><span class="lineno">  519</span><span class="keyword">def </span>test_kernel_pca_feature_names_out():</div>
<div class="line"><span class="lineno">  520</span>    <span class="stringliteral">&quot;&quot;&quot;Check feature names out for KernelPCA.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  521</span>    X, *_ = make_blobs(n_samples=100, n_features=4, random_state=0)</div>
<div class="line"><span class="lineno">  522</span>    kpca = KernelPCA(n_components=2).fit(X)</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>    names = kpca.get_feature_names_out()</div>
<div class="line"><span class="lineno">  525</span>    assert_array_equal([f<span class="stringliteral">&quot;kernelpca{i}&quot;</span> <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(2)], names)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae26000837a43eeb2a33ca48214ace902" name="ae26000837a43eeb2a33ca48214ace902"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae26000837a43eeb2a33ca48214ace902">&#9670;&#160;</a></span>test_kernel_pca_invalid_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_invalid_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that kPCA raises an error if the parameters are invalid

Tests fitting inverse transform with a precomputed kernel raises a
ValueError.
</pre> <div class="fragment"><div class="line"><span class="lineno">   70</span><span class="keyword">def </span>test_kernel_pca_invalid_parameters():</div>
<div class="line"><span class="lineno">   71</span>    <span class="stringliteral">&quot;&quot;&quot;Check that kPCA raises an error if the parameters are invalid</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">    Tests fitting inverse transform with a precomputed kernel raises a</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">    ValueError.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   76</span>    estimator = KernelPCA(</div>
<div class="line"><span class="lineno">   77</span>        n_components=10, fit_inverse_transform=<span class="keyword">True</span>, kernel=<span class="stringliteral">&quot;precomputed&quot;</span></div>
<div class="line"><span class="lineno">   78</span>    )</div>
<div class="line"><span class="lineno">   79</span>    err_ms = <span class="stringliteral">&quot;Cannot fit_inverse_transform with a precomputed kernel&quot;</span></div>
<div class="line"><span class="lineno">   80</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=err_ms):</div>
<div class="line"><span class="lineno">   81</span>        estimator.fit(np.random.randn(10, 10))</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f2572b7e94433c13a6a3912054de544" name="a6f2572b7e94433c13a6a3912054de544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f2572b7e94433c13a6a3912054de544">&#9670;&#160;</a></span>test_kernel_pca_inverse_transform_reconstruction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_inverse_transform_reconstruction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test if the reconstruction is a good approximation.

Note that in general it is not possible to get an arbitrarily good
reconstruction because of kernel centering that does not
preserve all the information of the original data.
</pre> <div class="fragment"><div class="line"><span class="lineno">  477</span><span class="keyword">def </span>test_kernel_pca_inverse_transform_reconstruction():</div>
<div class="line"><span class="lineno">  478</span>    <span class="stringliteral">&quot;&quot;&quot;Test if the reconstruction is a good approximation.</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">    Note that in general it is not possible to get an arbitrarily good</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">    reconstruction because of kernel centering that does not</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">    preserve all the information of the original data.</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  484</span>    X, *_ = make_blobs(n_samples=100, n_features=4, random_state=0)</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    kpca = KernelPCA(</div>
<div class="line"><span class="lineno">  487</span>        n_components=20, kernel=<span class="stringliteral">&quot;rbf&quot;</span>, fit_inverse_transform=<span class="keyword">True</span>, alpha=1e-3</div>
<div class="line"><span class="lineno">  488</span>    )</div>
<div class="line"><span class="lineno">  489</span>    X_trans = kpca.fit_transform(X)</div>
<div class="line"><span class="lineno">  490</span>    X_reconst = kpca.inverse_transform(X_trans)</div>
<div class="line"><span class="lineno">  491</span>    <span class="keyword">assert</span> np.linalg.norm(X - X_reconst) / np.linalg.norm(X) &lt; 1e-1</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acd05332bbb11178090cea30753660f2e" name="acd05332bbb11178090cea30753660f2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd05332bbb11178090cea30753660f2e">&#9670;&#160;</a></span>test_kernel_pca_linear_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_linear_kernel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>solver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_features</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that kPCA with linear kernel is equivalent to PCA for all solvers.

KernelPCA with linear kernel should produce the same output as PCA.
</pre> <div class="fragment"><div class="line"><span class="lineno">  159</span><span class="keyword">def </span>test_kernel_pca_linear_kernel(solver, n_features):</div>
<div class="line"><span class="lineno">  160</span>    <span class="stringliteral">&quot;&quot;&quot;Test that kPCA with linear kernel is equivalent to PCA for all solvers.</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">    KernelPCA with linear kernel should produce the same output as PCA.</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  164</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  165</span>    X_fit = rng.random_sample((5, n_features))</div>
<div class="line"><span class="lineno">  166</span>    X_pred = rng.random_sample((2, n_features))</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="comment"># for a linear kernel, kernel PCA should find the same projection as PCA</span></div>
<div class="line"><span class="lineno">  169</span>    <span class="comment"># modulo the sign (direction)</span></div>
<div class="line"><span class="lineno">  170</span>    <span class="comment"># fit only the first four components: fifth is near zero eigenvalue, so</span></div>
<div class="line"><span class="lineno">  171</span>    <span class="comment"># can be trimmed due to roundoff error</span></div>
<div class="line"><span class="lineno">  172</span>    n_comps = 3 <span class="keywordflow">if</span> solver == <span class="stringliteral">&quot;arpack&quot;</span> <span class="keywordflow">else</span> 4</div>
<div class="line"><span class="lineno">  173</span>    assert_array_almost_equal(</div>
<div class="line"><span class="lineno">  174</span>        np.abs(KernelPCA(n_comps, eigen_solver=solver).fit(X_fit).transform(X_pred)),</div>
<div class="line"><span class="lineno">  175</span>        np.abs(</div>
<div class="line"><span class="lineno">  176</span>            PCA(n_comps, svd_solver=solver <span class="keywordflow">if</span> solver != <span class="stringliteral">&quot;dense&quot;</span> <span class="keywordflow">else</span> <span class="stringliteral">&quot;full&quot;</span>)</div>
<div class="line"><span class="lineno">  177</span>            .fit(X_fit)</div>
<div class="line"><span class="lineno">  178</span>            .transform(X_pred)</div>
<div class="line"><span class="lineno">  179</span>        ),</div>
<div class="line"><span class="lineno">  180</span>    )</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aef694ad3ea1e56cef808894b724cc4a1" name="aef694ad3ea1e56cef808894b724cc4a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef694ad3ea1e56cef808894b724cc4a1">&#9670;&#160;</a></span>test_kernel_pca_n_components()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_n_components </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that `n_components` is correctly taken into account for projections

For all solvers this tests that the output has the correct shape depending
on the selected number of components.
</pre> <div class="fragment"><div class="line"><span class="lineno">  183</span><span class="keyword">def </span>test_kernel_pca_n_components():</div>
<div class="line"><span class="lineno">  184</span>    <span class="stringliteral">&quot;&quot;&quot;Test that `n_components` is correctly taken into account for projections</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    For all solvers this tests that the output has the correct shape depending</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    on the selected number of components.</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  189</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  190</span>    X_fit = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno">  191</span>    X_pred = rng.random_sample((2, 4))</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">for</span> eigen_solver <span class="keywordflow">in</span> (<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;arpack&quot;</span>, <span class="stringliteral">&quot;randomized&quot;</span>):</div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">for</span> c <span class="keywordflow">in</span> [1, 2, 4]:</div>
<div class="line"><span class="lineno">  195</span>            kpca = KernelPCA(n_components=c, eigen_solver=eigen_solver)</div>
<div class="line"><span class="lineno">  196</span>            shape = kpca.fit(X_fit).transform(X_pred).shape</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>            <span class="keyword">assert</span> shape == (2, c)</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acd04458f08807e871a9c538ad705be01" name="acd04458f08807e871a9c538ad705be01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd04458f08807e871a9c538ad705be01">&#9670;&#160;</a></span>test_kernel_pca_precomputed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_precomputed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that kPCA works with a precomputed kernel, for all solvers</pre> <div class="fragment"><div class="line"><span class="lineno">  248</span><span class="keyword">def </span>test_kernel_pca_precomputed():</div>
<div class="line"><span class="lineno">  249</span>    <span class="stringliteral">&quot;&quot;&quot;Test that kPCA works with a precomputed kernel, for all solvers&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  250</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  251</span>    X_fit = rng.random_sample((5, 4))</div>
<div class="line"><span class="lineno">  252</span>    X_pred = rng.random_sample((2, 4))</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">for</span> eigen_solver <span class="keywordflow">in</span> (<span class="stringliteral">&quot;dense&quot;</span>, <span class="stringliteral">&quot;arpack&quot;</span>, <span class="stringliteral">&quot;randomized&quot;</span>):</div>
<div class="line"><span class="lineno">  255</span>        X_kpca = (</div>
<div class="line"><span class="lineno">  256</span>            KernelPCA(4, eigen_solver=eigen_solver, random_state=0)</div>
<div class="line"><span class="lineno">  257</span>            .fit(X_fit)</div>
<div class="line"><span class="lineno">  258</span>            .transform(X_pred)</div>
<div class="line"><span class="lineno">  259</span>        )</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>        X_kpca2 = (</div>
<div class="line"><span class="lineno">  262</span>            KernelPCA(</div>
<div class="line"><span class="lineno">  263</span>                4, eigen_solver=eigen_solver, kernel=<span class="stringliteral">&quot;precomputed&quot;</span>, random_state=0</div>
<div class="line"><span class="lineno">  264</span>            )</div>
<div class="line"><span class="lineno">  265</span>            .fit(np.dot(X_fit, X_fit.T))</div>
<div class="line"><span class="lineno">  266</span>            .transform(np.dot(X_pred, X_fit.T))</div>
<div class="line"><span class="lineno">  267</span>        )</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>        X_kpca_train = KernelPCA(</div>
<div class="line"><span class="lineno">  270</span>            4, eigen_solver=eigen_solver, kernel=<span class="stringliteral">&quot;precomputed&quot;</span>, random_state=0</div>
<div class="line"><span class="lineno">  271</span>        ).fit_transform(np.dot(X_fit, X_fit.T))</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>        X_kpca_train2 = (</div>
<div class="line"><span class="lineno">  274</span>            KernelPCA(</div>
<div class="line"><span class="lineno">  275</span>                4, eigen_solver=eigen_solver, kernel=<span class="stringliteral">&quot;precomputed&quot;</span>, random_state=0</div>
<div class="line"><span class="lineno">  276</span>            )</div>
<div class="line"><span class="lineno">  277</span>            .fit(np.dot(X_fit, X_fit.T))</div>
<div class="line"><span class="lineno">  278</span>            .transform(np.dot(X_fit, X_fit.T))</div>
<div class="line"><span class="lineno">  279</span>        )</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>        assert_array_almost_equal(np.abs(X_kpca), np.abs(X_kpca2))</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>        assert_array_almost_equal(np.abs(X_kpca_train), np.abs(X_kpca_train2))</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span><span class="preprocessor">@pytest.mark.parametrize(&quot;solver&quot;, [&quot;auto&quot;, &quot;dense&quot;, &quot;arpack&quot;, &quot;randomized&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6f7af0a86aadc4bd8b9e597568e5710" name="af6f7af0a86aadc4bd8b9e597568e5710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6f7af0a86aadc4bd8b9e597568e5710">&#9670;&#160;</a></span>test_kernel_pca_precomputed_non_symmetric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_precomputed_non_symmetric </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>solver</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that the kernel centerer works.

Tests that a non symmetric precomputed kernel is actually accepted
because the kernel centerer does its job correctly.
</pre> <div class="fragment"><div class="line"><span class="lineno">  287</span><span class="keyword">def </span>test_kernel_pca_precomputed_non_symmetric(solver):</div>
<div class="line"><span class="lineno">  288</span>    <span class="stringliteral">&quot;&quot;&quot;Check that the kernel centerer works.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">    Tests that a non symmetric precomputed kernel is actually accepted</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    because the kernel centerer does its job correctly.</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="comment"># a non symmetric gram matrix</span></div>
<div class="line"><span class="lineno">  295</span>    K = [[1, 2], [3, 40]]</div>
<div class="line"><span class="lineno">  296</span>    kpca = KernelPCA(</div>
<div class="line"><span class="lineno">  297</span>        kernel=<span class="stringliteral">&quot;precomputed&quot;</span>, eigen_solver=solver, n_components=1, random_state=0</div>
<div class="line"><span class="lineno">  298</span>    )</div>
<div class="line"><span class="lineno">  299</span>    kpca.fit(K)  <span class="comment"># no error</span></div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>    <span class="comment"># same test with centered kernel</span></div>
<div class="line"><span class="lineno">  302</span>    Kc = [[9, -9], [-9, 9]]</div>
<div class="line"><span class="lineno">  303</span>    kpca_c = KernelPCA(</div>
<div class="line"><span class="lineno">  304</span>        kernel=<span class="stringliteral">&quot;precomputed&quot;</span>, eigen_solver=solver, n_components=1, random_state=0</div>
<div class="line"><span class="lineno">  305</span>    )</div>
<div class="line"><span class="lineno">  306</span>    kpca_c.fit(Kc)</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="comment"># comparison between the non-centered and centered versions</span></div>
<div class="line"><span class="lineno">  309</span>    assert_array_equal(kpca.eigenvectors_, kpca_c.eigenvectors_)</div>
<div class="line"><span class="lineno">  310</span>    assert_array_equal(kpca.eigenvalues_, kpca_c.eigenvalues_)</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad86e74e071191a488cffead8e7264690" name="ad86e74e071191a488cffead8e7264690"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad86e74e071191a488cffead8e7264690">&#9670;&#160;</a></span>test_kernel_pca_raise_not_fitted_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_raise_not_fitted_error </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  494</span><span class="keyword">def </span>test_kernel_pca_raise_not_fitted_error():</div>
<div class="line"><span class="lineno">  495</span>    X = np.random.randn(15).reshape(5, 3)</div>
<div class="line"><span class="lineno">  496</span>    kpca = KernelPCA()</div>
<div class="line"><span class="lineno">  497</span>    kpca.fit(X)</div>
<div class="line"><span class="lineno">  498</span>    <span class="keyword">with</span> pytest.raises(NotFittedError):</div>
<div class="line"><span class="lineno">  499</span>        kpca.inverse_transform(X)</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4170797d0cb93eec99925b25e97059d1" name="a4170797d0cb93eec99925b25e97059d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4170797d0cb93eec99925b25e97059d1">&#9670;&#160;</a></span>test_kernel_pca_solvers_equivalence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_solvers_equivalence </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_components</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that 'dense' 'arpack' &amp; 'randomized' solvers give similar results</pre> <div class="fragment"><div class="line"><span class="lineno">  441</span><span class="keyword">def </span>test_kernel_pca_solvers_equivalence(n_components):</div>
<div class="line"><span class="lineno">  442</span>    <span class="stringliteral">&quot;&quot;&quot;Check that &#39;dense&#39; &#39;arpack&#39; &amp; &#39;randomized&#39; solvers give similar results&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>    <span class="comment"># Generate random data</span></div>
<div class="line"><span class="lineno">  445</span>    n_train, n_test = 1_000, 100</div>
<div class="line"><span class="lineno">  446</span>    X, _ = make_circles(</div>
<div class="line"><span class="lineno">  447</span>        n_samples=(n_train + n_test), factor=0.3, noise=0.05, random_state=0</div>
<div class="line"><span class="lineno">  448</span>    )</div>
<div class="line"><span class="lineno">  449</span>    X_fit, X_pred = X[:n_train, :], X[n_train:, :]</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <span class="comment"># reference (full)</span></div>
<div class="line"><span class="lineno">  452</span>    ref_pred = (</div>
<div class="line"><span class="lineno">  453</span>        KernelPCA(n_components, eigen_solver=<span class="stringliteral">&quot;dense&quot;</span>, random_state=0)</div>
<div class="line"><span class="lineno">  454</span>        .fit(X_fit)</div>
<div class="line"><span class="lineno">  455</span>        .transform(X_pred)</div>
<div class="line"><span class="lineno">  456</span>    )</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    <span class="comment"># arpack</span></div>
<div class="line"><span class="lineno">  459</span>    a_pred = (</div>
<div class="line"><span class="lineno">  460</span>        KernelPCA(n_components, eigen_solver=<span class="stringliteral">&quot;arpack&quot;</span>, random_state=0)</div>
<div class="line"><span class="lineno">  461</span>        .fit(X_fit)</div>
<div class="line"><span class="lineno">  462</span>        .transform(X_pred)</div>
<div class="line"><span class="lineno">  463</span>    )</div>
<div class="line"><span class="lineno">  464</span>    <span class="comment"># check that the result is still correct despite the approx</span></div>
<div class="line"><span class="lineno">  465</span>    assert_array_almost_equal(np.abs(a_pred), np.abs(ref_pred))</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    <span class="comment"># randomized</span></div>
<div class="line"><span class="lineno">  468</span>    r_pred = (</div>
<div class="line"><span class="lineno">  469</span>        KernelPCA(n_components, eigen_solver=<span class="stringliteral">&quot;randomized&quot;</span>, random_state=0)</div>
<div class="line"><span class="lineno">  470</span>        .fit(X_fit)</div>
<div class="line"><span class="lineno">  471</span>        .transform(X_pred)</div>
<div class="line"><span class="lineno">  472</span>    )</div>
<div class="line"><span class="lineno">  473</span>    <span class="comment"># check that the result is still correct despite the approximation</span></div>
<div class="line"><span class="lineno">  474</span>    assert_array_almost_equal(np.abs(r_pred), np.abs(ref_pred))</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4f8053a71b013fddf28a2523fc2d568" name="ac4f8053a71b013fddf28a2523fc2d568"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4f8053a71b013fddf28a2523fc2d568">&#9670;&#160;</a></span>test_kernel_pca_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_kernel_pca_sparse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that kPCA works on a sparse data input.

Same test as ``test_kernel_pca except inverse_transform`` since it's not
implemented for sparse matrices.
</pre> <div class="fragment"><div class="line"><span class="lineno">  120</span><span class="keyword">def </span>test_kernel_pca_sparse():</div>
<div class="line"><span class="lineno">  121</span>    <span class="stringliteral">&quot;&quot;&quot;Test that kPCA works on a sparse data input.</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    Same test as ``test_kernel_pca except inverse_transform`` since it&#39;s not</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    implemented for sparse matrices.</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  126</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  127</span>    X_fit = sp.csr_matrix(rng.random_sample((5, 4)))</div>
<div class="line"><span class="lineno">  128</span>    X_pred = sp.csr_matrix(rng.random_sample((2, 4)))</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">for</span> eigen_solver <span class="keywordflow">in</span> (<span class="stringliteral">&quot;auto&quot;</span>, <span class="stringliteral">&quot;arpack&quot;</span>, <span class="stringliteral">&quot;randomized&quot;</span>):</div>
<div class="line"><span class="lineno">  131</span>        <span class="keywordflow">for</span> kernel <span class="keywordflow">in</span> (<span class="stringliteral">&quot;linear&quot;</span>, <span class="stringliteral">&quot;rbf&quot;</span>, <span class="stringliteral">&quot;poly&quot;</span>):</div>
<div class="line"><span class="lineno">  132</span>            <span class="comment"># transform fit data</span></div>
<div class="line"><span class="lineno">  133</span>            kpca = KernelPCA(</div>
<div class="line"><span class="lineno">  134</span>                4,</div>
<div class="line"><span class="lineno">  135</span>                kernel=kernel,</div>
<div class="line"><span class="lineno">  136</span>                eigen_solver=eigen_solver,</div>
<div class="line"><span class="lineno">  137</span>                fit_inverse_transform=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  138</span>                random_state=0,</div>
<div class="line"><span class="lineno">  139</span>            )</div>
<div class="line"><span class="lineno">  140</span>            X_fit_transformed = kpca.fit_transform(X_fit)</div>
<div class="line"><span class="lineno">  141</span>            X_fit_transformed2 = kpca.fit(X_fit).transform(X_fit)</div>
<div class="line"><span class="lineno">  142</span>            assert_array_almost_equal(</div>
<div class="line"><span class="lineno">  143</span>                np.abs(X_fit_transformed), np.abs(X_fit_transformed2)</div>
<div class="line"><span class="lineno">  144</span>            )</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>            <span class="comment"># transform new data</span></div>
<div class="line"><span class="lineno">  147</span>            X_pred_transformed = kpca.transform(X_pred)</div>
<div class="line"><span class="lineno">  148</span>            <span class="keyword">assert</span> X_pred_transformed.shape[1] == X_fit_transformed.shape[1]</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>            <span class="comment"># inverse transform: not available for sparse matrices</span></div>
<div class="line"><span class="lineno">  151</span>            <span class="comment"># XXX: should we raise another exception type here? For instance:</span></div>
<div class="line"><span class="lineno">  152</span>            <span class="comment"># NotImplementedError.</span></div>
<div class="line"><span class="lineno">  153</span>            <span class="keyword">with</span> pytest.raises(NotFittedError):</div>
<div class="line"><span class="lineno">  154</span>                kpca.inverse_transform(X_pred_transformed)</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span><span class="preprocessor">@pytest.mark.parametrize(&quot;solver&quot;, [&quot;auto&quot;, &quot;dense&quot;, &quot;arpack&quot;, &quot;randomized&quot;])</span></div>
<div class="line"><span class="lineno">  158</span><span class="preprocessor">@pytest.mark.parametrize(&quot;n_features&quot;, [4, 10])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59c4671e21d8ab727cc127097587c923" name="a59c4671e21d8ab727cc127097587c923"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59c4671e21d8ab727cc127097587c923">&#9670;&#160;</a></span>test_leave_zero_eig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_leave_zero_eig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Non-regression test for issue #12141 (PR #12143)

This test checks that fit().transform() returns the same result as
fit_transform() in case of non-removed zero eigenvalue.
</pre> <div class="fragment"><div class="line"><span class="lineno">  223</span><span class="keyword">def </span>test_leave_zero_eig():</div>
<div class="line"><span class="lineno">  224</span>    <span class="stringliteral">&quot;&quot;&quot;Non-regression test for issue #12141 (PR #12143)</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">    This test checks that fit().transform() returns the same result as</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    fit_transform() in case of non-removed zero eigenvalue.</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  229</span>    X_fit = np.array([[1, 1], [0, 0]])</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># Assert that even with all np warnings on, there is no div by zero warning</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  233</span>        <span class="comment"># There might be warnings about the kernel being badly conditioned,</span></div>
<div class="line"><span class="lineno">  234</span>        <span class="comment"># but there should not be warnings about division by zero.</span></div>
<div class="line"><span class="lineno">  235</span>        <span class="comment"># (Numpy division by zero warning can have many message variants, but</span></div>
<div class="line"><span class="lineno">  236</span>        <span class="comment"># at least we know that it is a RuntimeWarning so lets check only this)</span></div>
<div class="line"><span class="lineno">  237</span>        warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, RuntimeWarning)</div>
<div class="line"><span class="lineno">  238</span>        <span class="keyword">with</span> np.errstate(all=<span class="stringliteral">&quot;warn&quot;</span>):</div>
<div class="line"><span class="lineno">  239</span>            k = KernelPCA(n_components=2, remove_zero_eig=<span class="keyword">False</span>, eigen_solver=<span class="stringliteral">&quot;dense&quot;</span>)</div>
<div class="line"><span class="lineno">  240</span>            <span class="comment"># Fit, then transform</span></div>
<div class="line"><span class="lineno">  241</span>            A = k.fit(X_fit).transform(X_fit)</div>
<div class="line"><span class="lineno">  242</span>            <span class="comment"># Do both at once</span></div>
<div class="line"><span class="lineno">  243</span>            B = k.fit_transform(X_fit)</div>
<div class="line"><span class="lineno">  244</span>            <span class="comment"># Compare</span></div>
<div class="line"><span class="lineno">  245</span>            assert_array_almost_equal(np.abs(A), np.abs(B))</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a87acadd5858af2492e400bc7003a82bd" name="a87acadd5858af2492e400bc7003a82bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87acadd5858af2492e400bc7003a82bd">&#9670;&#160;</a></span>test_nested_circles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_nested_circles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that kPCA projects in a space where nested circles are separable

Tests that 2D nested circles become separable with a perceptron when
projected in the first 2 kPCA using an RBF kernel, while raw samples
are not directly separable in the original space.
</pre> <div class="fragment"><div class="line"><span class="lineno">  344</span><span class="keyword">def </span>test_nested_circles():</div>
<div class="line"><span class="lineno">  345</span>    <span class="stringliteral">&quot;&quot;&quot;Check that kPCA projects in a space where nested circles are separable</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">    Tests that 2D nested circles become separable with a perceptron when</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">    projected in the first 2 kPCA using an RBF kernel, while raw samples</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    are not directly separable in the original space.</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  351</span>    X, y = make_circles(n_samples=400, factor=0.3, noise=0.05, random_state=0)</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    <span class="comment"># 2D nested circles are not linearly separable</span></div>
<div class="line"><span class="lineno">  354</span>    train_score = Perceptron(max_iter=5).fit(X, y).score(X, y)</div>
<div class="line"><span class="lineno">  355</span>    <span class="keyword">assert</span> train_score &lt; 0.8</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    <span class="comment"># Project the circles data into the first 2 components of a RBF Kernel</span></div>
<div class="line"><span class="lineno">  358</span>    <span class="comment"># PCA model.</span></div>
<div class="line"><span class="lineno">  359</span>    <span class="comment"># Note that the gamma value is data dependent. If this test breaks</span></div>
<div class="line"><span class="lineno">  360</span>    <span class="comment"># and the gamma value has to be updated, the Kernel PCA example will</span></div>
<div class="line"><span class="lineno">  361</span>    <span class="comment"># have to be updated too.</span></div>
<div class="line"><span class="lineno">  362</span>    kpca = KernelPCA(</div>
<div class="line"><span class="lineno">  363</span>        kernel=<span class="stringliteral">&quot;rbf&quot;</span>, n_components=2, fit_inverse_transform=<span class="keyword">True</span>, gamma=2.0</div>
<div class="line"><span class="lineno">  364</span>    )</div>
<div class="line"><span class="lineno">  365</span>    X_kpca = kpca.fit_transform(X)</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    <span class="comment"># The data is perfectly linearly separable in that space</span></div>
<div class="line"><span class="lineno">  368</span>    train_score = Perceptron(max_iter=5).fit(X_kpca, y).score(X_kpca, y)</div>
<div class="line"><span class="lineno">  369</span>    <span class="keyword">assert</span> train_score == 1.0</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bf430b9a953ba8ce3d16cff0d2fde09" name="a9bf430b9a953ba8ce3d16cff0d2fde09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bf430b9a953ba8ce3d16cff0d2fde09">&#9670;&#160;</a></span>test_precomputed_kernel_not_psd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_precomputed_kernel_not_psd </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>solver</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check how KernelPCA works with non-PSD kernels depending on n_components

Tests for all methods what happens with a non PSD gram matrix (this
can happen in an isomap scenario, or with custom kernel functions, or
maybe with ill-posed datasets).

When ``n_component`` is large enough to capture a negative eigenvalue, an
error should be raised. Otherwise, KernelPCA should run without error
since the negative eigenvalues are not selected.
</pre> <div class="fragment"><div class="line"><span class="lineno">  389</span><span class="keyword">def </span>test_precomputed_kernel_not_psd(solver):</div>
<div class="line"><span class="lineno">  390</span>    <span class="stringliteral">&quot;&quot;&quot;Check how KernelPCA works with non-PSD kernels depending on n_components</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    Tests for all methods what happens with a non PSD gram matrix (this</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    can happen in an isomap scenario, or with custom kernel functions, or</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">    maybe with ill-posed datasets).</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    When ``n_component`` is large enough to capture a negative eigenvalue, an</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    error should be raised. Otherwise, KernelPCA should run without error</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">    since the negative eigenvalues are not selected.</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    <span class="comment"># a non PSD kernel with large eigenvalues, already centered</span></div>
<div class="line"><span class="lineno">  402</span>    <span class="comment"># it was captured from an isomap call and multiplied by 100 for compacity</span></div>
<div class="line"><span class="lineno">  403</span>    K = [</div>
<div class="line"><span class="lineno">  404</span>        [4.48, -1.0, 8.07, 2.33, 2.33, 2.33, -5.76, -12.78],</div>
<div class="line"><span class="lineno">  405</span>        [-1.0, -6.48, 4.5, -1.24, -1.24, -1.24, -0.81, 7.49],</div>
<div class="line"><span class="lineno">  406</span>        [8.07, 4.5, 15.48, 2.09, 2.09, 2.09, -11.1, -23.23],</div>
<div class="line"><span class="lineno">  407</span>        [2.33, -1.24, 2.09, 4.0, -3.65, -3.65, 1.02, -0.9],</div>
<div class="line"><span class="lineno">  408</span>        [2.33, -1.24, 2.09, -3.65, 4.0, -3.65, 1.02, -0.9],</div>
<div class="line"><span class="lineno">  409</span>        [2.33, -1.24, 2.09, -3.65, -3.65, 4.0, 1.02, -0.9],</div>
<div class="line"><span class="lineno">  410</span>        [-5.76, -0.81, -11.1, 1.02, 1.02, 1.02, 4.86, 9.75],</div>
<div class="line"><span class="lineno">  411</span>        [-12.78, 7.49, -23.23, -0.9, -0.9, -0.9, 9.75, 21.46],</div>
<div class="line"><span class="lineno">  412</span>    ]</div>
<div class="line"><span class="lineno">  413</span>    <span class="comment"># this gram matrix has 5 positive eigenvalues and 3 negative ones</span></div>
<div class="line"><span class="lineno">  414</span>    <span class="comment"># [ 52.72,   7.65,   7.65,   5.02,   0.  ,  -0.  ,  -6.13, -15.11]</span></div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    <span class="comment"># 1. ask for enough components to get a significant negative one</span></div>
<div class="line"><span class="lineno">  417</span>    kpca = KernelPCA(kernel=<span class="stringliteral">&quot;precomputed&quot;</span>, eigen_solver=solver, n_components=7)</div>
<div class="line"><span class="lineno">  418</span>    <span class="comment"># make sure that the appropriate error is raised</span></div>
<div class="line"><span class="lineno">  419</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">&quot;There are significant negative eigenvalues&quot;</span>):</div>
<div class="line"><span class="lineno">  420</span>        kpca.fit(K)</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>    <span class="comment"># 2. ask for a small enough n_components to get only positive ones</span></div>
<div class="line"><span class="lineno">  423</span>    kpca = KernelPCA(kernel=<span class="stringliteral">&quot;precomputed&quot;</span>, eigen_solver=solver, n_components=2)</div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">if</span> solver == <span class="stringliteral">&quot;randomized&quot;</span>:</div>
<div class="line"><span class="lineno">  425</span>        <span class="comment"># the randomized method is still inconsistent with the others on this</span></div>
<div class="line"><span class="lineno">  426</span>        <span class="comment"># since it selects the eigenvalues based on the largest 2 modules, not</span></div>
<div class="line"><span class="lineno">  427</span>        <span class="comment"># on the largest 2 values.</span></div>
<div class="line"><span class="lineno">  428</span>        <span class="comment">#</span></div>
<div class="line"><span class="lineno">  429</span>        <span class="comment"># At least we can ensure that we return an error instead of returning</span></div>
<div class="line"><span class="lineno">  430</span>        <span class="comment"># the wrong eigenvalues</span></div>
<div class="line"><span class="lineno">  431</span>        <span class="keyword">with</span> pytest.raises(</div>
<div class="line"><span class="lineno">  432</span>            ValueError, match=<span class="stringliteral">&quot;There are significant negative eigenvalues&quot;</span></div>
<div class="line"><span class="lineno">  433</span>        ):</div>
<div class="line"><span class="lineno">  434</span>            kpca.fit(K)</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  436</span>        <span class="comment"># general case: make sure that it works</span></div>
<div class="line"><span class="lineno">  437</span>        kpca.fit(K)</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span><span class="preprocessor">@pytest.mark.parametrize(&quot;n_components&quot;, [4, 10, 20])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac14795984239fe7aa042c1fa998037ca" name="ac14795984239fe7aa042c1fa998037ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14795984239fe7aa042c1fa998037ca">&#9670;&#160;</a></span>test_remove_zero_eig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_kernel_pca.test_remove_zero_eig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that the ``remove_zero_eig`` parameter works correctly.

Tests that the null-space (Zero) eigenvalues are removed when
remove_zero_eig=True, whereas they are not by default.
</pre> <div class="fragment"><div class="line"><span class="lineno">  201</span><span class="keyword">def </span>test_remove_zero_eig():</div>
<div class="line"><span class="lineno">  202</span>    <span class="stringliteral">&quot;&quot;&quot;Check that the ``remove_zero_eig`` parameter works correctly.</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    Tests that the null-space (Zero) eigenvalues are removed when</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    remove_zero_eig=True, whereas they are not by default.</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  207</span>    X = np.array([[1 - 1e-30, 1], [1, 1], [1, 1 - 1e-20]])</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    <span class="comment"># n_components=None (default) =&gt; remove_zero_eig is True</span></div>
<div class="line"><span class="lineno">  210</span>    kpca = KernelPCA()</div>
<div class="line"><span class="lineno">  211</span>    Xt = kpca.fit_transform(X)</div>
<div class="line"><span class="lineno">  212</span>    <span class="keyword">assert</span> Xt.shape == (3, 0)</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    kpca = KernelPCA(n_components=2)</div>
<div class="line"><span class="lineno">  215</span>    Xt = kpca.fit_transform(X)</div>
<div class="line"><span class="lineno">  216</span>    <span class="keyword">assert</span> Xt.shape == (3, 2)</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>    kpca = KernelPCA(n_components=2, remove_zero_eig=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  219</span>    Xt = kpca.fit_transform(X)</div>
<div class="line"><span class="lineno">  220</span>    <span class="keyword">assert</span> Xt.shape == (3, 0)</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
