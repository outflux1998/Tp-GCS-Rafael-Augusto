<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.interpolate._bsplines.BSpline Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1interpolate.html">interpolate</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1interpolate_1_1__bsplines.html">_bsplines</a></li><li class="navelem"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html">BSpline</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scipy.interpolate._bsplines.BSpline Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1b9428a890cbd6bb7d82cd25c298537c" id="r_a1b9428a890cbd6bb7d82cd25c298537c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a1b9428a890cbd6bb7d82cd25c298537c">__init__</a> (self, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a65cf9b018488e71c09d3226fc19711ac">t</a>, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a30ced40af99c785dd17b954c0686c342">c</a>, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#ab4747354ee39af9d2a47a83549d7251d">k</a>, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#aaed4249c982a07066700e9118ef2adde">extrapolate</a>=True, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a76ea4ea8f3b10f81836e1d096c2ffaac">axis</a>=0)</td></tr>
<tr class="separator:a1b9428a890cbd6bb7d82cd25c298537c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c87eb89f684e67ef87492f79fadf8a" id="r_a73c87eb89f684e67ef87492f79fadf8a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a73c87eb89f684e67ef87492f79fadf8a">construct_fast</a> (cls, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a65cf9b018488e71c09d3226fc19711ac">t</a>, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a30ced40af99c785dd17b954c0686c342">c</a>, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#ab4747354ee39af9d2a47a83549d7251d">k</a>, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#aaed4249c982a07066700e9118ef2adde">extrapolate</a>=True, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a76ea4ea8f3b10f81836e1d096c2ffaac">axis</a>=0)</td></tr>
<tr class="separator:a73c87eb89f684e67ef87492f79fadf8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a355a0ec57ba58676356f5a4bc0f424a6" id="r_a355a0ec57ba58676356f5a4bc0f424a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a355a0ec57ba58676356f5a4bc0f424a6">tck</a> (self)</td></tr>
<tr class="separator:a355a0ec57ba58676356f5a4bc0f424a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e2e0cd783f4f33618ea9b2b462caf5e" id="r_a1e2e0cd783f4f33618ea9b2b462caf5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a1e2e0cd783f4f33618ea9b2b462caf5e">basis_element</a> (cls, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a65cf9b018488e71c09d3226fc19711ac">t</a>, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#aaed4249c982a07066700e9118ef2adde">extrapolate</a>=True)</td></tr>
<tr class="separator:a1e2e0cd783f4f33618ea9b2b462caf5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6829cbd59d70ea16b17000df8e30c3" id="r_aca6829cbd59d70ea16b17000df8e30c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#aca6829cbd59d70ea16b17000df8e30c3">design_matrix</a> (cls, x, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a65cf9b018488e71c09d3226fc19711ac">t</a>, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#ab4747354ee39af9d2a47a83549d7251d">k</a>)</td></tr>
<tr class="separator:aca6829cbd59d70ea16b17000df8e30c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4447f2d14925dd6021697d1cc6f0d6fb" id="r_a4447f2d14925dd6021697d1cc6f0d6fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a4447f2d14925dd6021697d1cc6f0d6fb">__call__</a> (self, x, nu=0, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#aaed4249c982a07066700e9118ef2adde">extrapolate</a>=None)</td></tr>
<tr class="separator:a4447f2d14925dd6021697d1cc6f0d6fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf7f21ca79befe5d8f287901f83647a" id="r_a6cf7f21ca79befe5d8f287901f83647a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a6cf7f21ca79befe5d8f287901f83647a">derivative</a> (self, nu=1)</td></tr>
<tr class="separator:a6cf7f21ca79befe5d8f287901f83647a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae251a05037a86f3a8323a3d51d52d9bb" id="r_ae251a05037a86f3a8323a3d51d52d9bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#ae251a05037a86f3a8323a3d51d52d9bb">antiderivative</a> (self, nu=1)</td></tr>
<tr class="separator:ae251a05037a86f3a8323a3d51d52d9bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31990fcf057166e5f1cc4d2092eb613b" id="r_a31990fcf057166e5f1cc4d2092eb613b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a31990fcf057166e5f1cc4d2092eb613b">integrate</a> (self, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#aaed4249c982a07066700e9118ef2adde">extrapolate</a>=None)</td></tr>
<tr class="separator:a31990fcf057166e5f1cc4d2092eb613b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c45523f20d6d4535205074096b00a45" id="r_a5c45523f20d6d4535205074096b00a45"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a5c45523f20d6d4535205074096b00a45">from_power_basis</a> (cls, <a class="el" href="__lapack__subroutines_8h.html#a9a1d89ecfd021bcb01121a1414d4a738">pp</a>, bc_type='not-<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>-knot')</td></tr>
<tr class="separator:a5c45523f20d6d4535205074096b00a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ab4747354ee39af9d2a47a83549d7251d" id="r_ab4747354ee39af9d2a47a83549d7251d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#ab4747354ee39af9d2a47a83549d7251d">k</a></td></tr>
<tr class="separator:ab4747354ee39af9d2a47a83549d7251d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30ced40af99c785dd17b954c0686c342" id="r_a30ced40af99c785dd17b954c0686c342"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a30ced40af99c785dd17b954c0686c342">c</a></td></tr>
<tr class="separator:a30ced40af99c785dd17b954c0686c342"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65cf9b018488e71c09d3226fc19711ac" id="r_a65cf9b018488e71c09d3226fc19711ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a65cf9b018488e71c09d3226fc19711ac">t</a></td></tr>
<tr class="separator:a65cf9b018488e71c09d3226fc19711ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed4249c982a07066700e9118ef2adde" id="r_aaed4249c982a07066700e9118ef2adde"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#aaed4249c982a07066700e9118ef2adde">extrapolate</a></td></tr>
<tr class="separator:aaed4249c982a07066700e9118ef2adde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ea4ea8f3b10f81836e1d096c2ffaac" id="r_a76ea4ea8f3b10f81836e1d096c2ffaac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a76ea4ea8f3b10f81836e1d096c2ffaac">axis</a></td></tr>
<tr class="separator:a76ea4ea8f3b10f81836e1d096c2ffaac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a82b61cae93070fdf78fa7f56fb3b6bf9" id="r_a82b61cae93070fdf78fa7f56fb3b6bf9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#a82b61cae93070fdf78fa7f56fb3b6bf9">_evaluate</a> (self, xp, nu, <a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#aaed4249c982a07066700e9118ef2adde">extrapolate</a>, out)</td></tr>
<tr class="separator:a82b61cae93070fdf78fa7f56fb3b6bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae108ccc7b08e1683b96acbf338fcd54a" id="r_ae108ccc7b08e1683b96acbf338fcd54a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1interpolate_1_1__bsplines_1_1_b_spline.html#ae108ccc7b08e1683b96acbf338fcd54a">_ensure_c_contiguous</a> (self)</td></tr>
<tr class="separator:ae108ccc7b08e1683b96acbf338fcd54a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Univariate spline in the B-spline basis.

.. math::

    S(x) = \sum_{j=0}^{n-1} c_j  B_{j, k; t}(x)

where :math:`B_{j, k; t}` are B-spline basis functions of degree `k`
and knots `t`.

Parameters
----------
t : ndarray, shape (n+k+1,)
    knots
c : ndarray, shape (&gt;=n, ...)
    spline coefficients
k : int
    B-spline degree
extrapolate : bool or 'periodic', optional
    whether to extrapolate beyond the base interval, ``t[k] .. t[n]``,
    or to return nans.
    If True, extrapolates the first and last polynomial pieces of b-spline
    functions active on the base interval.
    If 'periodic', periodic extrapolation is used.
    Default is True.
axis : int, optional
    Interpolation axis. Default is zero.

Attributes
----------
t : ndarray
    knot vector
c : ndarray
    spline coefficients
k : int
    spline degree
extrapolate : bool
    If True, extrapolates the first and last polynomial pieces of b-spline
    functions active on the base interval.
axis : int
    Interpolation axis.
tck : tuple
    A read-only equivalent of ``(self.t, self.c, self.k)``

Methods
-------
__call__
basis_element
derivative
antiderivative
integrate
construct_fast
design_matrix
from_power_basis

Notes
-----
B-spline basis elements are defined via

.. math::

    B_{i, 0}(x) = 1, \textrm{if $t_i \le x &lt; t_{i+1}$, otherwise $0$,}

    B_{i, k}(x) = \frac{x - t_i}{t_{i+k} - t_i} B_{i, k-1}(x)
             + \frac{t_{i+k+1} - x}{t_{i+k+1} - t_{i+1}} B_{i+1, k-1}(x)

**Implementation details**

- At least ``k+1`` coefficients are required for a spline of degree `k`,
  so that ``n &gt;= k+1``. Additional coefficients, ``c[j]`` with
  ``j &gt; n``, are ignored.

- B-spline basis elements of degree `k` form a partition of unity on the
  *base interval*, ``t[k] &lt;= x &lt;= t[n]``.


Examples
--------

Translating the recursive definition of B-splines into Python code, we have:

&gt;&gt;&gt; def B(x, k, i, t):
...    if k == 0:
...       return 1.0 if t[i] &lt;= x &lt; t[i+1] else 0.0
...    if t[i+k] == t[i]:
...       c1 = 0.0
...    else:
...       c1 = (x - t[i])/(t[i+k] - t[i]) * B(x, k-1, i, t)
...    if t[i+k+1] == t[i+1]:
...       c2 = 0.0
...    else:
...       c2 = (t[i+k+1] - x)/(t[i+k+1] - t[i+1]) * B(x, k-1, i+1, t)
...    return c1 + c2

&gt;&gt;&gt; def bspline(x, t, c, k):
...    n = len(t) - k - 1
...    assert (n &gt;= k+1) and (len(c) &gt;= n)
...    return sum(c[i] * B(x, k, i, t) for i in range(n))

Note that this is an inefficient (if straightforward) way to
evaluate B-splines --- this spline class does it in an equivalent,
but much more efficient way.

Here we construct a quadratic spline function on the base interval
``2 &lt;= x &lt;= 4`` and compare with the naive way of evaluating the spline:

&gt;&gt;&gt; from scipy.interpolate import BSpline
&gt;&gt;&gt; k = 2
&gt;&gt;&gt; t = [0, 1, 2, 3, 4, 5, 6]
&gt;&gt;&gt; c = [-1, 2, 0, -1]
&gt;&gt;&gt; spl = BSpline(t, c, k)
&gt;&gt;&gt; spl(2.5)
array(1.375)
&gt;&gt;&gt; bspline(2.5, t, c, k)
1.375

Note that outside of the base interval results differ. This is because
`BSpline` extrapolates the first and last polynomial pieces of B-spline
functions active on the base interval.

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig, ax = plt.subplots()
&gt;&gt;&gt; xx = np.linspace(1.5, 4.5, 50)
&gt;&gt;&gt; ax.plot(xx, [bspline(x, t, c ,k) for x in xx], 'r-', lw=3, label='naive')
&gt;&gt;&gt; ax.plot(xx, spl(xx), 'b-', lw=4, alpha=0.7, label='BSpline')
&gt;&gt;&gt; ax.grid(True)
&gt;&gt;&gt; ax.legend(loc='best')
&gt;&gt;&gt; plt.show()


References
----------
.. [1] Tom Lyche and Knut Morken, Spline methods,
    http://www.uio.no/studier/emner/matnat/ifi/INF-MAT5340/v05/undervisningsmateriale/
.. [2] Carl de Boor, A practical guide to splines, Springer, 2001.</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1b9428a890cbd6bb7d82cd25c298537c" name="a1b9428a890cbd6bb7d82cd25c298537c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b9428a890cbd6bb7d82cd25c298537c">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extrapolate</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  204</span>    <span class="keyword">def </span>__init__(self, t, c, k, extrapolate=True, axis=0):</div>
<div class="line"><span class="lineno">  205</span>        super().__init__()</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>        self.k = operator.index(k)</div>
<div class="line"><span class="lineno">  208</span>        self.c = np.asarray(c)</div>
<div class="line"><span class="lineno">  209</span>        self.t = np.ascontiguousarray(t, dtype=np.float64)</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">if</span> extrapolate == <span class="stringliteral">&#39;periodic&#39;</span>:</div>
<div class="line"><span class="lineno">  212</span>            self.extrapolate = extrapolate</div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  214</span>            self.extrapolate = bool(extrapolate)</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>        n = self.t.shape[0] - self.k - 1</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>        axis = normalize_axis_index(axis, self.c.ndim)</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>        <span class="comment"># Note that the normalized axis is stored in the object.</span></div>
<div class="line"><span class="lineno">  221</span>        self.axis = axis</div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">if</span> axis != 0:</div>
<div class="line"><span class="lineno">  223</span>            <span class="comment"># roll the interpolation axis to be the first one in self.c</span></div>
<div class="line"><span class="lineno">  224</span>            <span class="comment"># More specifically, the target shape for self.c is (n, ...),</span></div>
<div class="line"><span class="lineno">  225</span>            <span class="comment"># and axis !=0 means that we have c.shape (..., n, ...)</span></div>
<div class="line"><span class="lineno">  226</span>            <span class="comment">#                                               ^</span></div>
<div class="line"><span class="lineno">  227</span>            <span class="comment">#                                              axis</span></div>
<div class="line"><span class="lineno">  228</span>            self.c = np.moveaxis(self.c, axis, 0)</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>        <span class="keywordflow">if</span> k &lt; 0:</div>
<div class="line"><span class="lineno">  231</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Spline order cannot be negative.&quot;</span>)</div>
<div class="line"><span class="lineno">  232</span>        <span class="keywordflow">if</span> self.t.ndim != 1:</div>
<div class="line"><span class="lineno">  233</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Knot vector must be one-dimensional.&quot;</span>)</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">if</span> n &lt; self.k + 1:</div>
<div class="line"><span class="lineno">  235</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Need at least %d knots for degree %d&quot;</span> %</div>
<div class="line"><span class="lineno">  236</span>                    (2*k + 2, k))</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">if</span> (np.diff(self.t) &lt; 0).any():</div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Knots must be in a non-decreasing order.&quot;</span>)</div>
<div class="line"><span class="lineno">  239</span>        <span class="keywordflow">if</span> len(np.unique(self.t[k:n+1])) &lt; 2:</div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Need at least two internal knots.&quot;</span>)</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isfinite(self.t).all():</div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Knots should not have nans or infs.&quot;</span>)</div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordflow">if</span> self.c.ndim &lt; 1:</div>
<div class="line"><span class="lineno">  244</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Coefficients must be at least 1-dimensional.&quot;</span>)</div>
<div class="line"><span class="lineno">  245</span>        <span class="keywordflow">if</span> self.c.shape[0] &lt; n:</div>
<div class="line"><span class="lineno">  246</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Knots, coefficients and degree are inconsistent.&quot;</span>)</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>        dt = _get_dtype(self.c.dtype)</div>
<div class="line"><span class="lineno">  249</span>        self.c = np.ascontiguousarray(self.c, dtype=dt)</div>
<div class="line"><span class="lineno">  250</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4447f2d14925dd6021697d1cc6f0d6fb" name="a4447f2d14925dd6021697d1cc6f0d6fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4447f2d14925dd6021697d1cc6f0d6fb">&#9670;&#160;</a></span>__call__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.__call__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nu</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extrapolate</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Evaluate a spline function.

Parameters
----------
x : array_like
    points to evaluate the spline at.
nu : int, optional
    derivative to evaluate (default is 0).
extrapolate : bool or 'periodic', optional
    whether to extrapolate based on the first and last intervals
    or return nans. If 'periodic', periodic extrapolation is used.
    Default is `self.extrapolate`.

Returns
-------
y : array_like
    Shape is determined by replacing the interpolation axis
    in the coefficient array with the shape of `x`.</pre> <div class="fragment"><div class="line"><span class="lineno">  422</span>    <span class="keyword">def </span>__call__(self, x, nu=0, extrapolate=None):</div>
<div class="line"><span class="lineno">  423</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">        Evaluate a spline function.</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">        x : array_like</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral">            points to evaluate the spline at.</span></div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">        nu : int, optional</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">            derivative to evaluate (default is 0).</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">        extrapolate : bool or &#39;periodic&#39;, optional</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">            whether to extrapolate based on the first and last intervals</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">            or return nans. If &#39;periodic&#39;, periodic extrapolation is used.</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">            Default is `self.extrapolate`.</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">        y : array_like</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">            Shape is determined by replacing the interpolation axis</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">            in the coefficient array with the shape of `x`.</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">if</span> extrapolate <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  445</span>            extrapolate = self.extrapolate</div>
<div class="line"><span class="lineno">  446</span>        x = np.asarray(x)</div>
<div class="line"><span class="lineno">  447</span>        x_shape, x_ndim = x.shape, x.ndim</div>
<div class="line"><span class="lineno">  448</span>        x = np.ascontiguousarray(x.ravel(), dtype=np.float_)</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>        <span class="comment"># With periodic extrapolation we map x to the segment</span></div>
<div class="line"><span class="lineno">  451</span>        <span class="comment"># [self.t[k], self.t[n]].</span></div>
<div class="line"><span class="lineno">  452</span>        <span class="keywordflow">if</span> extrapolate == <span class="stringliteral">&#39;periodic&#39;</span>:</div>
<div class="line"><span class="lineno">  453</span>            n = self.t.size - self.k - 1</div>
<div class="line"><span class="lineno">  454</span>            x = self.t[self.k] + (x - self.t[self.k]) % (self.t[n] -</div>
<div class="line"><span class="lineno">  455</span>                                                         self.t[self.k])</div>
<div class="line"><span class="lineno">  456</span>            extrapolate = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>        out = np.empty((len(x), prod(self.c.shape[1:])), dtype=self.c.dtype)</div>
<div class="line"><span class="lineno">  459</span>        self._ensure_c_contiguous()</div>
<div class="line"><span class="lineno">  460</span>        self._evaluate(x, nu, extrapolate, out)</div>
<div class="line"><span class="lineno">  461</span>        out = out.reshape(x_shape + self.c.shape[1:])</div>
<div class="line"><span class="lineno">  462</span>        <span class="keywordflow">if</span> self.axis != 0:</div>
<div class="line"><span class="lineno">  463</span>            <span class="comment"># transpose to move the calculated values to the interpolation axis</span></div>
<div class="line"><span class="lineno">  464</span>            l = list(range(out.ndim))</div>
<div class="line"><span class="lineno">  465</span>            l = l[x_ndim:x_ndim+self.axis] + l[:x_ndim] + l[x_ndim+self.axis:]</div>
<div class="line"><span class="lineno">  466</span>            out = out.transpose(l)</div>
<div class="line"><span class="lineno">  467</span>        <span class="keywordflow">return</span> out</div>
<div class="line"><span class="lineno">  468</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae108ccc7b08e1683b96acbf338fcd54a" name="ae108ccc7b08e1683b96acbf338fcd54a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae108ccc7b08e1683b96acbf338fcd54a">&#9670;&#160;</a></span>_ensure_c_contiguous()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline._ensure_c_contiguous </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">c and t may be modified by the user. The Cython code expects
that they are C contiguous.</pre> <div class="fragment"><div class="line"><span class="lineno">  473</span>    <span class="keyword">def </span>_ensure_c_contiguous(self):</div>
<div class="line"><span class="lineno">  474</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">        c and t may be modified by the user. The Cython code expects</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">        that they are C contiguous.</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.t.flags.c_contiguous:</div>
<div class="line"><span class="lineno">  480</span>            self.t = self.t.copy()</div>
<div class="line"><span class="lineno">  481</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.c.flags.c_contiguous:</div>
<div class="line"><span class="lineno">  482</span>            self.c = self.c.copy()</div>
<div class="line"><span class="lineno">  483</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a82b61cae93070fdf78fa7f56fb3b6bf9" name="a82b61cae93070fdf78fa7f56fb3b6bf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82b61cae93070fdf78fa7f56fb3b6bf9">&#9670;&#160;</a></span>_evaluate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline._evaluate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extrapolate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  469</span>    <span class="keyword">def </span>_evaluate(self, xp, nu, extrapolate, out):</div>
<div class="line"><span class="lineno">  470</span>        _bspl.evaluate_spline(self.t, self.c.reshape(self.c.shape[0], -1),</div>
<div class="line"><span class="lineno">  471</span>                self.k, xp, nu, extrapolate, out)</div>
<div class="line"><span class="lineno">  472</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae251a05037a86f3a8323a3d51d52d9bb" name="ae251a05037a86f3a8323a3d51d52d9bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae251a05037a86f3a8323a3d51d52d9bb">&#9670;&#160;</a></span>antiderivative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.antiderivative </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nu</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return a B-spline representing the antiderivative.

Parameters
----------
nu : int, optional
    Antiderivative order. Default is 1.

Returns
-------
b : BSpline object
    A new instance representing the antiderivative.

Notes
-----
If antiderivative is computed and ``self.extrapolate='periodic'``,
it will be set to False for the returned instance. This is done because
the antiderivative is no longer periodic and its correct evaluation
outside of the initially given x interval is difficult.

See Also
--------
splder, splantider</pre> <div class="fragment"><div class="line"><span class="lineno">  512</span>    <span class="keyword">def </span>antiderivative(self, nu=1):</div>
<div class="line"><span class="lineno">  513</span>        <span class="stringliteral">&quot;&quot;&quot;Return a B-spline representing the antiderivative.</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">        nu : int, optional</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">            Antiderivative order. Default is 1.</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">        b : BSpline object</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">            A new instance representing the antiderivative.</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">        If antiderivative is computed and ``self.extrapolate=&#39;periodic&#39;``,</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">        it will be set to False for the returned instance. This is done because</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">        the antiderivative is no longer periodic and its correct evaluation</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">        outside of the initially given x interval is difficult.</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">        See Also</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">        splder, splantider</span></div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  537</span>        c = self.c</div>
<div class="line"><span class="lineno">  538</span>        <span class="comment"># pad the c array if needed</span></div>
<div class="line"><span class="lineno">  539</span>        ct = len(self.t) - len(c)</div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">if</span> ct &gt; 0:</div>
<div class="line"><span class="lineno">  541</span>            c = np.r_[c, np.zeros((ct,) + c.shape[1:])]</div>
<div class="line"><span class="lineno">  542</span>        tck = _fitpack_impl.splantider((self.t, c, self.k), nu)</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordflow">if</span> self.extrapolate == <span class="stringliteral">&#39;periodic&#39;</span>:</div>
<div class="line"><span class="lineno">  545</span>            extrapolate = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  546</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  547</span>            extrapolate = self.extrapolate</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">return</span> self.construct_fast(*tck, extrapolate=extrapolate,</div>
<div class="line"><span class="lineno">  550</span>                                   axis=self.axis)</div>
<div class="line"><span class="lineno">  551</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e2e0cd783f4f33618ea9b2b462caf5e" name="a1e2e0cd783f4f33618ea9b2b462caf5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e2e0cd783f4f33618ea9b2b462caf5e">&#9670;&#160;</a></span>basis_element()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.basis_element </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extrapolate</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return a B-spline basis element ``B(x | t[0], ..., t[k+1])``.

Parameters
----------
t : ndarray, shape (k+2,)
    internal knots
extrapolate : bool or 'periodic', optional
    whether to extrapolate beyond the base interval, ``t[0] .. t[k+1]``,
    or to return nans.
    If 'periodic', periodic extrapolation is used.
    Default is True.

Returns
-------
basis_element : callable
    A callable representing a B-spline basis element for the knot
    vector `t`.

Notes
-----
The degree of the B-spline, `k`, is inferred from the length of `t` as
``len(t)-2``. The knot vector is constructed by appending and prepending
``k+1`` elements to internal knots `t`.

Examples
--------

Construct a cubic B-spline:

&gt;&gt;&gt; from scipy.interpolate import BSpline
&gt;&gt;&gt; b = BSpline.basis_element([0, 1, 2, 3, 4])
&gt;&gt;&gt; k = b.k
&gt;&gt;&gt; b.t[k:-k]
array([ 0.,  1.,  2.,  3.,  4.])
&gt;&gt;&gt; k
3

Construct a quadratic B-spline on ``[0, 1, 1, 2]``, and compare
to its explicit form:

&gt;&gt;&gt; t = [-1, 0, 1, 1, 2]
&gt;&gt;&gt; b = BSpline.basis_element(t[1:])
&gt;&gt;&gt; def f(x):
...     return np.where(x &lt; 1, x*x, (2. - x)**2)

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig, ax = plt.subplots()
&gt;&gt;&gt; x = np.linspace(0, 2, 51)
&gt;&gt;&gt; ax.plot(x, b(x), 'g', lw=3)
&gt;&gt;&gt; ax.plot(x, f(x), 'r', lw=8, alpha=0.4)
&gt;&gt;&gt; ax.grid(True)
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  271</span>    <span class="keyword">def </span>basis_element(cls, t, extrapolate=True):</div>
<div class="line"><span class="lineno">  272</span>        <span class="stringliteral">&quot;&quot;&quot;Return a B-spline basis element ``B(x | t[0], ..., t[k+1])``.</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">        t : ndarray, shape (k+2,)</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">            internal knots</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">        extrapolate : bool or &#39;periodic&#39;, optional</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">            whether to extrapolate beyond the base interval, ``t[0] .. t[k+1]``,</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">            or to return nans.</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">            If &#39;periodic&#39;, periodic extrapolation is used.</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">            Default is True.</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">        basis_element : callable</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">            A callable representing a B-spline basis element for the knot</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">            vector `t`.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">        The degree of the B-spline, `k`, is inferred from the length of `t` as</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">        ``len(t)-2``. The knot vector is constructed by appending and prepending</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">        ``k+1`` elements to internal knots `t`.</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">        Examples</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">        Construct a cubic B-spline:</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">        &gt;&gt;&gt; from scipy.interpolate import BSpline</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">        &gt;&gt;&gt; b = BSpline.basis_element([0, 1, 2, 3, 4])</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">        &gt;&gt;&gt; k = b.k</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        &gt;&gt;&gt; b.t[k:-k]</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">        array([ 0.,  1.,  2.,  3.,  4.])</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">        &gt;&gt;&gt; k</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">        3</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">        Construct a quadratic B-spline on ``[0, 1, 1, 2]``, and compare</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">        to its explicit form:</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">        &gt;&gt;&gt; t = [-1, 0, 1, 1, 2]</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">        &gt;&gt;&gt; b = BSpline.basis_element(t[1:])</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">        &gt;&gt;&gt; def f(x):</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">        ...     return np.where(x &lt; 1, x*x, (2. - x)**2)</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">        &gt;&gt;&gt; fig, ax = plt.subplots()</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">        &gt;&gt;&gt; x = np.linspace(0, 2, 51)</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        &gt;&gt;&gt; ax.plot(x, b(x), &#39;g&#39;, lw=3)</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">        &gt;&gt;&gt; ax.plot(x, f(x), &#39;r&#39;, lw=8, alpha=0.4)</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">        &gt;&gt;&gt; ax.grid(True)</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">        &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  326</span>        k = len(t) - 2</div>
<div class="line"><span class="lineno">  327</span>        t = _as_float_array(t)</div>
<div class="line"><span class="lineno">  328</span>        t = np.r_[(t[0]-1,) * k, t, (t[-1]+1,) * k]</div>
<div class="line"><span class="lineno">  329</span>        c = np.zeros_like(t)</div>
<div class="line"><span class="lineno">  330</span>        c[k] = 1.</div>
<div class="line"><span class="lineno">  331</span>        <span class="keywordflow">return</span> cls.construct_fast(t, c, k, extrapolate)</div>
<div class="line"><span class="lineno">  332</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a73c87eb89f684e67ef87492f79fadf8a" name="a73c87eb89f684e67ef87492f79fadf8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c87eb89f684e67ef87492f79fadf8a">&#9670;&#160;</a></span>construct_fast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.construct_fast </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extrapolate</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct a spline without making checks.

Accepts same parameters as the regular constructor. Input arrays
`t` and `c` must of correct shape and dtype.
</pre> <div class="fragment"><div class="line"><span class="lineno">  252</span>    <span class="keyword">def </span>construct_fast(cls, t, c, k, extrapolate=True, axis=0):</div>
<div class="line"><span class="lineno">  253</span>        <span class="stringliteral">&quot;&quot;&quot;Construct a spline without making checks.</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">        Accepts same parameters as the regular constructor. Input arrays</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">        `t` and `c` must of correct shape and dtype.</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  258</span>        self = object.__new__(cls)</div>
<div class="line"><span class="lineno">  259</span>        self.t, self.c, self.k = t, c, k</div>
<div class="line"><span class="lineno">  260</span>        self.extrapolate = extrapolate</div>
<div class="line"><span class="lineno">  261</span>        self.axis = axis</div>
<div class="line"><span class="lineno">  262</span>        <span class="keywordflow">return</span> self</div>
<div class="line"><span class="lineno">  263</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cf7f21ca79befe5d8f287901f83647a" name="a6cf7f21ca79befe5d8f287901f83647a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf7f21ca79befe5d8f287901f83647a">&#9670;&#160;</a></span>derivative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.derivative </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nu</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return a B-spline representing the derivative.

Parameters
----------
nu : int, optional
    Derivative order.
    Default is 1.

Returns
-------
b : BSpline object
    A new instance representing the derivative.

See Also
--------
splder, splantider</pre> <div class="fragment"><div class="line"><span class="lineno">  484</span>    <span class="keyword">def </span>derivative(self, nu=1):</div>
<div class="line"><span class="lineno">  485</span>        <span class="stringliteral">&quot;&quot;&quot;Return a B-spline representing the derivative.</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">        nu : int, optional</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">            Derivative order.</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">            Default is 1.</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">        b : BSpline object</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">            A new instance representing the derivative.</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">        See Also</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">        splder, splantider</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  503</span>        c = self.c</div>
<div class="line"><span class="lineno">  504</span>        <span class="comment"># pad the c array if needed</span></div>
<div class="line"><span class="lineno">  505</span>        ct = len(self.t) - len(c)</div>
<div class="line"><span class="lineno">  506</span>        <span class="keywordflow">if</span> ct &gt; 0:</div>
<div class="line"><span class="lineno">  507</span>            c = np.r_[c, np.zeros((ct,) + c.shape[1:])]</div>
<div class="line"><span class="lineno">  508</span>        tck = _fitpack_impl.splder((self.t, c, self.k), nu)</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">return</span> self.construct_fast(*tck, extrapolate=self.extrapolate,</div>
<div class="line"><span class="lineno">  510</span>                                    axis=self.axis)</div>
<div class="line"><span class="lineno">  511</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aca6829cbd59d70ea16b17000df8e30c3" name="aca6829cbd59d70ea16b17000df8e30c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca6829cbd59d70ea16b17000df8e30c3">&#9670;&#160;</a></span>design_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.design_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns a design matrix as a CSR format sparse array.

Parameters
----------
x : array_like, shape (n,)
    Points to evaluate the spline at.
t : array_like, shape (nt,)
    Sorted 1D array of knots.
k : int
    B-spline degree.

Returns
-------
design_matrix : `csr_array` object
    Sparse matrix in CSR format where in each row all the basis
    elements are evaluated at the certain point (first row - x[0],
    ..., last row - x[-1]).

Examples
--------
Construct a design matrix for a B-spline

&gt;&gt;&gt; from scipy.interpolate import make_interp_spline, BSpline
&gt;&gt;&gt; x = np.linspace(0, np.pi * 2, 4)
&gt;&gt;&gt; y = np.sin(x)
&gt;&gt;&gt; k = 3
&gt;&gt;&gt; bspl = make_interp_spline(x, y, k=k)
&gt;&gt;&gt; design_matrix = bspl.design_matrix(x, bspl.t, k)
&gt;&gt;&gt; design_matrix.toarray()
[[1.        , 0.        , 0.        , 0.        ],
[0.2962963 , 0.44444444, 0.22222222, 0.03703704],
[0.03703704, 0.22222222, 0.44444444, 0.2962963 ],
[0.        , 0.        , 0.        , 1.        ]]

Construct a design matrix for some vector of knots

&gt;&gt;&gt; k = 2
&gt;&gt;&gt; t = [-1, 0, 1, 2, 3, 4, 5, 6]
&gt;&gt;&gt; x = [1, 2, 3, 4]
&gt;&gt;&gt; design_matrix = BSpline.design_matrix(x, t, k).toarray()
&gt;&gt;&gt; design_matrix
[[0.5, 0.5, 0. , 0. , 0. ],
[0. , 0.5, 0.5, 0. , 0. ],
[0. , 0. , 0.5, 0.5, 0. ],
[0. , 0. , 0. , 0.5, 0.5]]

This result is equivalent to the one created in the sparse format

&gt;&gt;&gt; c = np.eye(len(t) - k - 1)
&gt;&gt;&gt; design_matrix_gh = BSpline(t, c, k)(x)
&gt;&gt;&gt; np.allclose(design_matrix, design_matrix_gh, atol=1e-14)
True

Notes
-----
.. versionadded:: 1.8.0

In each row of the design matrix all the basis elements are evaluated
at the certain point (first row - x[0], ..., last row - x[-1]).

`nt` is a length of the vector of knots: as far as there are
`nt - k - 1` basis elements, `nt` should be not less than `2 * k + 2`
to have at least `k + 1` basis element.

Out of bounds `x` raises a ValueError.
</pre> <div class="fragment"><div class="line"><span class="lineno">  334</span>    <span class="keyword">def </span>design_matrix(cls, x, t, k):</div>
<div class="line"><span class="lineno">  335</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">        Returns a design matrix as a CSR format sparse array.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">        x : array_like, shape (n,)</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">            Points to evaluate the spline at.</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">        t : array_like, shape (nt,)</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">            Sorted 1D array of knots.</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">        k : int</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">            B-spline degree.</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">        design_matrix : `csr_array` object</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">            Sparse matrix in CSR format where in each row all the basis</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">            elements are evaluated at the certain point (first row - x[0],</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">            ..., last row - x[-1]).</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">        Examples</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">        Construct a design matrix for a B-spline</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral">        &gt;&gt;&gt; from scipy.interpolate import make_interp_spline, BSpline</span></div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">        &gt;&gt;&gt; x = np.linspace(0, np.pi * 2, 4)</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">        &gt;&gt;&gt; y = np.sin(x)</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">        &gt;&gt;&gt; k = 3</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">        &gt;&gt;&gt; bspl = make_interp_spline(x, y, k=k)</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">        &gt;&gt;&gt; design_matrix = bspl.design_matrix(x, bspl.t, k)</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">        &gt;&gt;&gt; design_matrix.toarray()</span></div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">        [[1.        , 0.        , 0.        , 0.        ],</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">        [0.2962963 , 0.44444444, 0.22222222, 0.03703704],</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">        [0.03703704, 0.22222222, 0.44444444, 0.2962963 ],</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">        [0.        , 0.        , 0.        , 1.        ]]</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">        Construct a design matrix for some vector of knots</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">        &gt;&gt;&gt; k = 2</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">        &gt;&gt;&gt; t = [-1, 0, 1, 2, 3, 4, 5, 6]</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">        &gt;&gt;&gt; x = [1, 2, 3, 4]</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">        &gt;&gt;&gt; design_matrix = BSpline.design_matrix(x, t, k).toarray()</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">        &gt;&gt;&gt; design_matrix</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">        [[0.5, 0.5, 0. , 0. , 0. ],</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">        [0. , 0.5, 0.5, 0. , 0. ],</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">        [0. , 0. , 0.5, 0.5, 0. ],</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">        [0. , 0. , 0. , 0.5, 0.5]]</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">        This result is equivalent to the one created in the sparse format</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">        &gt;&gt;&gt; c = np.eye(len(t) - k - 1)</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">        &gt;&gt;&gt; design_matrix_gh = BSpline(t, c, k)(x)</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">        &gt;&gt;&gt; np.allclose(design_matrix, design_matrix_gh, atol=1e-14)</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">        True</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">        .. versionadded:: 1.8.0</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">        In each row of the design matrix all the basis elements are evaluated</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">        at the certain point (first row - x[0], ..., last row - x[-1]).</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">        `nt` is a length of the vector of knots: as far as there are</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">        `nt - k - 1` basis elements, `nt` should be not less than `2 * k + 2`</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">        to have at least `k + 1` basis element.</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">        Out of bounds `x` raises a ValueError.</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  402</span>        x = _as_float_array(x, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  403</span>        t = _as_float_array(t, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>        <span class="keywordflow">if</span> t.ndim != 1 <span class="keywordflow">or</span> np.any(t[1:] &lt; t[:-1]):</div>
<div class="line"><span class="lineno">  406</span>            <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Expect t to be a 1-D sorted array_like, but &quot;</span></div>
<div class="line"><span class="lineno">  407</span>                             f<span class="stringliteral">&quot;got t={t}.&quot;</span>)</div>
<div class="line"><span class="lineno">  408</span>        <span class="comment"># There are `nt - k - 1` basis elements in a BSpline built on the</span></div>
<div class="line"><span class="lineno">  409</span>        <span class="comment"># vector of knots with length `nt`, so to have at least `k + 1` basis</span></div>
<div class="line"><span class="lineno">  410</span>        <span class="comment"># element we need to have at least `2 * k + 2` elements in the vector</span></div>
<div class="line"><span class="lineno">  411</span>        <span class="comment"># of knots.</span></div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">if</span> len(t) &lt; 2 * k + 2:</div>
<div class="line"><span class="lineno">  413</span>            <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Length t is not enough for k={k}.&quot;</span>)</div>
<div class="line"><span class="lineno">  414</span>        <span class="comment"># Checks from `find_interval` function</span></div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">if</span> (min(x) &lt; t[k]) <span class="keywordflow">or</span> (max(x) &gt; t[t.shape[0] - k - 1]):</div>
<div class="line"><span class="lineno">  416</span>            <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&#39;Out of bounds w/ x = {x}.&#39;</span>)</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>        n, nt = x.shape[0], t.shape[0]</div>
<div class="line"><span class="lineno">  419</span>        data, idx = _bspl._make_design_matrix(x, t, k)</div>
<div class="line"><span class="lineno">  420</span>        <span class="keywordflow">return</span> csr_array((data, idx), (n, nt - k - 1))</div>
<div class="line"><span class="lineno">  421</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c45523f20d6d4535205074096b00a45" name="a5c45523f20d6d4535205074096b00a45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c45523f20d6d4535205074096b00a45">&#9670;&#160;</a></span>from_power_basis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.from_power_basis </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bc_type</em> = <code>'not-<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>-knot'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Construct a polynomial in the B-spline basis
    from a piecewise polynomial in the power basis.

    For now, accepts ``CubicSpline`` instances only.

    Parameters
    ----------
    pp : CubicSpline
        A piecewise polynomial in the power basis, as created
        by ``CubicSpline``
    bc_type : string, optional
        Boundary condition type as in ``CubicSpline``: one of the
        ``not-a-knot``, ``natural``, ``clamped``, or ``periodic``.
        Necessary for construction an instance of ``BSpline`` class.
        Default is ``not-a-knot``.

    Returns
    -------
    b : BSpline object
        A new instance representing the initial polynomial
        in the B-spline basis.

    Notes
    -----
    .. versionadded:: 1.8.0

    Accepts only ``CubicSpline`` instances for now.

    The algorithm follows from differentiation
    the Marsden's identity [1]: each of coefficients of spline
    interpolation function in the B-spline basis is computed as follows:

    .. math::

        c_j = \sum_{m=0}^{k} \frac{(k-m)!}{k!}
                   c_{m,i} (-1)^{k-m} D^m p_{j,k}(x_i)

    :math:`c_{m, i}` - a coefficient of CubicSpline,
    :math:`D^m p_{j, k}(x_i)` - an m-th defivative of a dual polynomial
    in :math:`x_i`.

    ``k`` always equals 3 for now.

    First ``n - 2`` coefficients are computed in :math:`x_i = x_j`, e.g.

    .. math::

        c_1 = \sum_{m=0}^{k} \frac{(k-1)!}{k!} c_{m,1} D^m p_{j,3}(x_1)

    Last ``nod + 2`` coefficients are computed in ``x[-2]``,
    ``nod`` - number of derivatives at the ends.

    For example, consider :math:`x = [0, 1, 2, 3, 4]`,
    :math:`y = [1, 1, 1, 1, 1]` and bc_type = ``natural``

    The coefficients of CubicSpline in the power basis:

    :math:`[[0, 0, 0, 0, 0], [0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0], [1, 1, 1, 1, 1]]`

    The knot vector: :math:`t = [0, 0, 0, 0, 1, 2, 3, 4, 4, 4, 4]`

    In this case

    .. math::

        c_j = \frac{0!}{k!} c_{3, i} k! = c_{3, i} = 1,~j = 0, ..., 6

    References
    ----------
    .. [1] Tom Lyche and Knut Morken, Spline Methods, 2005, Section 3.1.2</pre> <div class="fragment"><div class="line"><span class="lineno">  686</span>    <span class="keyword">def </span>from_power_basis(cls, pp, bc_type=&#39;not-a-knot&#39;):</div>
<div class="line"><span class="lineno">  687</span>        <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral">        Construct a polynomial in the B-spline basis</span></div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral">        from a piecewise polynomial in the power basis.</span></div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral">        For now, accepts ``CubicSpline`` instances only.</span></div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral">        pp : CubicSpline</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral">            A piecewise polynomial in the power basis, as created</span></div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">            by ``CubicSpline``</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">        bc_type : string, optional</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">            Boundary condition type as in ``CubicSpline``: one of the</span></div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral">            ``not-a-knot``, ``natural``, ``clamped``, or ``periodic``.</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">            Necessary for construction an instance of ``BSpline`` class.</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral">            Default is ``not-a-knot``.</span></div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  704</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno">  705</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno">  706</span><span class="stringliteral">        b : BSpline object</span></div>
<div class="line"><span class="lineno">  707</span><span class="stringliteral">            A new instance representing the initial polynomial</span></div>
<div class="line"><span class="lineno">  708</span><span class="stringliteral">            in the B-spline basis.</span></div>
<div class="line"><span class="lineno">  709</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  712</span><span class="stringliteral">        .. versionadded:: 1.8.0</span></div>
<div class="line"><span class="lineno">  713</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">        Accepts only ``CubicSpline`` instances for now.</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">        The algorithm follows from differentiation</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">        the Marsden&#39;s identity [1]: each of coefficients of spline</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">        interpolation function in the B-spline basis is computed as follows:</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral">        .. math::</span></div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">            c_j = \sum_{m=0}^{k} \frac{(k-m)!}{k!}</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">                       c_{m,i} (-1)^{k-m} D^m p_{j,k}(x_i)</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">        :math:`c_{m, i}` - a coefficient of CubicSpline,</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">        :math:`D^m p_{j, k}(x_i)` - an m-th defivative of a dual polynomial</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral">        in :math:`x_i`.</span></div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">        ``k`` always equals 3 for now.</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">        First ``n - 2`` coefficients are computed in :math:`x_i = x_j`, e.g.</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">        .. math::</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">            c_1 = \sum_{m=0}^{k} \frac{(k-1)!}{k!} c_{m,1} D^m p_{j,3}(x_1)</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">        Last ``nod + 2`` coefficients are computed in ``x[-2]``,</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">        ``nod`` - number of derivatives at the ends.</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">        For example, consider :math:`x = [0, 1, 2, 3, 4]`,</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">        :math:`y = [1, 1, 1, 1, 1]` and bc_type = ``natural``</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">        The coefficients of CubicSpline in the power basis:</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral">        :math:`[[0, 0, 0, 0, 0], [0, 0, 0, 0, 0],</span></div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">        [0, 0, 0, 0, 0], [1, 1, 1, 1, 1]]`</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">        The knot vector: :math:`t = [0, 0, 0, 0, 1, 2, 3, 4, 4, 4, 4]`</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral">        In this case</span></div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  752</span><span class="stringliteral">        .. math::</span></div>
<div class="line"><span class="lineno">  753</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  754</span><span class="stringliteral">            c_j = \frac{0!}{k!} c_{3, i} k! = c_{3, i} = 1,~j = 0, ..., 6</span></div>
<div class="line"><span class="lineno">  755</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  756</span><span class="stringliteral">        References</span></div>
<div class="line"><span class="lineno">  757</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  758</span><span class="stringliteral">        .. [1] Tom Lyche and Knut Morken, Spline Methods, 2005, Section 3.1.2</span></div>
<div class="line"><span class="lineno">  759</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  760</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  761</span>        <span class="keyword">from</span> ._cubic <span class="keyword">import</span> CubicSpline</div>
<div class="line"><span class="lineno">  762</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(pp, CubicSpline):</div>
<div class="line"><span class="lineno">  763</span>            <span class="keywordflow">raise</span> NotImplementedError(<span class="stringliteral">&quot;Only CubicSpline objects are accepted&quot;</span></div>
<div class="line"><span class="lineno">  764</span>                                      <span class="stringliteral">&quot;for now. Got %s instead.&quot;</span> % type(pp))</div>
<div class="line"><span class="lineno">  765</span>        x = pp.x</div>
<div class="line"><span class="lineno">  766</span>        coef = pp.c</div>
<div class="line"><span class="lineno">  767</span>        k = pp.c.shape[0] - 1</div>
<div class="line"><span class="lineno">  768</span>        n = x.shape[0]</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>        <span class="keywordflow">if</span> bc_type == <span class="stringliteral">&#39;not-a-knot&#39;</span>:</div>
<div class="line"><span class="lineno">  771</span>            t = _not_a_knot(x, k)</div>
<div class="line"><span class="lineno">  772</span>        <span class="keywordflow">elif</span> bc_type == <span class="stringliteral">&#39;natural&#39;</span> <span class="keywordflow">or</span> bc_type == <span class="stringliteral">&#39;clamped&#39;</span>:</div>
<div class="line"><span class="lineno">  773</span>            t = _augknt(x, k)</div>
<div class="line"><span class="lineno">  774</span>        <span class="keywordflow">elif</span> bc_type == <span class="stringliteral">&#39;periodic&#39;</span>:</div>
<div class="line"><span class="lineno">  775</span>            t = _periodic_knots(x, k)</div>
<div class="line"><span class="lineno">  776</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  777</span>            <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;Unknown boundary condition: %s&#39;</span> % bc_type)</div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>        nod = t.shape[0] - (n + k + 1)  <span class="comment"># number of derivatives at the ends</span></div>
<div class="line"><span class="lineno">  780</span>        c = np.zeros(n + nod, dtype=pp.c.dtype)</div>
<div class="line"><span class="lineno">  781</span>        <span class="keywordflow">for</span> m <span class="keywordflow">in</span> range(k + 1):</div>
<div class="line"><span class="lineno">  782</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n - 2):</div>
<div class="line"><span class="lineno">  783</span>                c[i] += poch(k + 1, -m) * coef[m, i]\</div>
<div class="line"><span class="lineno">  784</span>                        * np.power(-1, k - m)\</div>
<div class="line"><span class="lineno">  785</span>                        * _diff_dual_poly(i, k, x[i], m, t)</div>
<div class="line"><span class="lineno">  786</span>            <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(n - 2, n + nod):</div>
<div class="line"><span class="lineno">  787</span>                c[j] += poch(k + 1, -m) * coef[m, n - 2]\</div>
<div class="line"><span class="lineno">  788</span>                        * np.power(-1, k - m)\</div>
<div class="line"><span class="lineno">  789</span>                        * _diff_dual_poly(j, k, x[n - 2], m, t)</div>
<div class="line"><span class="lineno">  790</span>        <span class="keywordflow">return</span> cls.construct_fast(t, c, k, pp.extrapolate, pp.axis)</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a31990fcf057166e5f1cc4d2092eb613b" name="a31990fcf057166e5f1cc4d2092eb613b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31990fcf057166e5f1cc4d2092eb613b">&#9670;&#160;</a></span>integrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.integrate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extrapolate</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute a definite integral of the spline.

Parameters
----------
a : float
    Lower limit of integration.
b : float
    Upper limit of integration.
extrapolate : bool or 'periodic', optional
    whether to extrapolate beyond the base interval,
    ``t[k] .. t[-k-1]``, or take the spline to be zero outside of the
    base interval. If 'periodic', periodic extrapolation is used.
    If None (default), use `self.extrapolate`.

Returns
-------
I : array_like
    Definite integral of the spline over the interval ``[a, b]``.

Examples
--------
Construct the linear spline ``x if x &lt; 1 else 2 - x`` on the base
interval :math:`[0, 2]`, and integrate it

&gt;&gt;&gt; from scipy.interpolate import BSpline
&gt;&gt;&gt; b = BSpline.basis_element([0, 1, 2])
&gt;&gt;&gt; b.integrate(0, 1)
array(0.5)

If the integration limits are outside of the base interval, the result
is controlled by the `extrapolate` parameter

&gt;&gt;&gt; b.integrate(-1, 1)
array(0.0)
&gt;&gt;&gt; b.integrate(-1, 1, extrapolate=False)
array(0.5)

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig, ax = plt.subplots()
&gt;&gt;&gt; ax.grid(True)
&gt;&gt;&gt; ax.axvline(0, c='r', lw=5, alpha=0.5)  # base interval
&gt;&gt;&gt; ax.axvline(2, c='r', lw=5, alpha=0.5)
&gt;&gt;&gt; xx = [-1, 1, 2]
&gt;&gt;&gt; ax.plot(xx, b(xx))
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  552</span>    <span class="keyword">def </span>integrate(self, a, b, extrapolate=None):</div>
<div class="line"><span class="lineno">  553</span>        <span class="stringliteral">&quot;&quot;&quot;Compute a definite integral of the spline.</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">        a : float</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">            Lower limit of integration.</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">        b : float</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">            Upper limit of integration.</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        extrapolate : bool or &#39;periodic&#39;, optional</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">            whether to extrapolate beyond the base interval,</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">            ``t[k] .. t[-k-1]``, or take the spline to be zero outside of the</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">            base interval. If &#39;periodic&#39;, periodic extrapolation is used.</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">            If None (default), use `self.extrapolate`.</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">        I : array_like</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">            Definite integral of the spline over the interval ``[a, b]``.</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral">        Examples</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">        Construct the linear spline ``x if x &lt; 1 else 2 - x`` on the base</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">        interval :math:`[0, 2]`, and integrate it</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral">        &gt;&gt;&gt; from scipy.interpolate import BSpline</span></div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">        &gt;&gt;&gt; b = BSpline.basis_element([0, 1, 2])</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">        &gt;&gt;&gt; b.integrate(0, 1)</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral">        array(0.5)</span></div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">        If the integration limits are outside of the base interval, the result</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral">        is controlled by the `extrapolate` parameter</span></div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">        &gt;&gt;&gt; b.integrate(-1, 1)</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">        array(0.0)</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">        &gt;&gt;&gt; b.integrate(-1, 1, extrapolate=False)</span></div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">        array(0.5)</span></div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral">        &gt;&gt;&gt; fig, ax = plt.subplots()</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">        &gt;&gt;&gt; ax.grid(True)</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral">        &gt;&gt;&gt; ax.axvline(0, c=&#39;r&#39;, lw=5, alpha=0.5)  # base interval</span></div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">        &gt;&gt;&gt; ax.axvline(2, c=&#39;r&#39;, lw=5, alpha=0.5)</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">        &gt;&gt;&gt; xx = [-1, 1, 2]</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral">        &gt;&gt;&gt; ax.plot(xx, b(xx))</span></div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral">        &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  600</span>        <span class="keywordflow">if</span> extrapolate <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  601</span>            extrapolate = self.extrapolate</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>        <span class="comment"># Prepare self.t and self.c.</span></div>
<div class="line"><span class="lineno">  604</span>        self._ensure_c_contiguous()</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>        <span class="comment"># Swap integration bounds if needed.</span></div>
<div class="line"><span class="lineno">  607</span>        sign = 1</div>
<div class="line"><span class="lineno">  608</span>        <span class="keywordflow">if</span> b &lt; a:</div>
<div class="line"><span class="lineno">  609</span>            a, b = b, a</div>
<div class="line"><span class="lineno">  610</span>            sign = -1</div>
<div class="line"><span class="lineno">  611</span>        n = self.t.size - self.k - 1</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">if</span> extrapolate != <span class="stringliteral">&quot;periodic&quot;</span> <span class="keywordflow">and</span> <span class="keywordflow">not</span> extrapolate:</div>
<div class="line"><span class="lineno">  614</span>            <span class="comment"># Shrink the integration interval, if needed.</span></div>
<div class="line"><span class="lineno">  615</span>            a = max(a, self.t[self.k])</div>
<div class="line"><span class="lineno">  616</span>            b = min(b, self.t[n])</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>            <span class="keywordflow">if</span> self.c.ndim == 1:</div>
<div class="line"><span class="lineno">  619</span>                <span class="comment"># Fast path: use FITPACK&#39;s routine</span></div>
<div class="line"><span class="lineno">  620</span>                <span class="comment"># (cf _fitpack_impl.splint).</span></div>
<div class="line"><span class="lineno">  621</span>                t, c, k = self.tck</div>
<div class="line"><span class="lineno">  622</span>                integral, wrk = _dierckx._splint(t, c, k, a, b)</div>
<div class="line"><span class="lineno">  623</span>                <span class="keywordflow">return</span> integral * sign</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span>        out = np.empty((2, prod(self.c.shape[1:])), dtype=self.c.dtype)</div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>        <span class="comment"># Compute the antiderivative.</span></div>
<div class="line"><span class="lineno">  628</span>        c = self.c</div>
<div class="line"><span class="lineno">  629</span>        ct = len(self.t) - len(c)</div>
<div class="line"><span class="lineno">  630</span>        <span class="keywordflow">if</span> ct &gt; 0:</div>
<div class="line"><span class="lineno">  631</span>            c = np.r_[c, np.zeros((ct,) + c.shape[1:])]</div>
<div class="line"><span class="lineno">  632</span>        ta, ca, ka = _fitpack_impl.splantider((self.t, c, self.k), 1)</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>        <span class="keywordflow">if</span> extrapolate == <span class="stringliteral">&#39;periodic&#39;</span>:</div>
<div class="line"><span class="lineno">  635</span>            <span class="comment"># Split the integral into the part over period (can be several</span></div>
<div class="line"><span class="lineno">  636</span>            <span class="comment"># of them) and the remaining part.</span></div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>            ts, te = self.t[self.k], self.t[n]</div>
<div class="line"><span class="lineno">  639</span>            period = te - ts</div>
<div class="line"><span class="lineno">  640</span>            interval = b - a</div>
<div class="line"><span class="lineno">  641</span>            n_periods, left = divmod(interval, period)</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>            <span class="keywordflow">if</span> n_periods &gt; 0:</div>
<div class="line"><span class="lineno">  644</span>                <span class="comment"># Evaluate the difference of antiderivatives.</span></div>
<div class="line"><span class="lineno">  645</span>                x = np.asarray([ts, te], dtype=np.float_)</div>
<div class="line"><span class="lineno">  646</span>                _bspl.evaluate_spline(ta, ca.reshape(ca.shape[0], -1),</div>
<div class="line"><span class="lineno">  647</span>                                      ka, x, 0, <span class="keyword">False</span>, out)</div>
<div class="line"><span class="lineno">  648</span>                integral = out[1] - out[0]</div>
<div class="line"><span class="lineno">  649</span>                integral *= n_periods</div>
<div class="line"><span class="lineno">  650</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  651</span>                integral = np.zeros((1, prod(self.c.shape[1:])),</div>
<div class="line"><span class="lineno">  652</span>                                    dtype=self.c.dtype)</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>            <span class="comment"># Map a to [ts, te], b is always a + left.</span></div>
<div class="line"><span class="lineno">  655</span>            a = ts + (a - ts) % period</div>
<div class="line"><span class="lineno">  656</span>            b = a + left</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>            <span class="comment"># If b &lt;= te then we need to integrate over [a, b], otherwise</span></div>
<div class="line"><span class="lineno">  659</span>            <span class="comment"># over [a, te] and from xs to what is remained.</span></div>
<div class="line"><span class="lineno">  660</span>            <span class="keywordflow">if</span> b &lt;= te:</div>
<div class="line"><span class="lineno">  661</span>                x = np.asarray([a, b], dtype=np.float_)</div>
<div class="line"><span class="lineno">  662</span>                _bspl.evaluate_spline(ta, ca.reshape(ca.shape[0], -1),</div>
<div class="line"><span class="lineno">  663</span>                                      ka, x, 0, <span class="keyword">False</span>, out)</div>
<div class="line"><span class="lineno">  664</span>                integral += out[1] - out[0]</div>
<div class="line"><span class="lineno">  665</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  666</span>                x = np.asarray([a, te], dtype=np.float_)</div>
<div class="line"><span class="lineno">  667</span>                _bspl.evaluate_spline(ta, ca.reshape(ca.shape[0], -1),</div>
<div class="line"><span class="lineno">  668</span>                                      ka, x, 0, <span class="keyword">False</span>, out)</div>
<div class="line"><span class="lineno">  669</span>                integral += out[1] - out[0]</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>                x = np.asarray([ts, ts + b - te], dtype=np.float_)</div>
<div class="line"><span class="lineno">  672</span>                _bspl.evaluate_spline(ta, ca.reshape(ca.shape[0], -1),</div>
<div class="line"><span class="lineno">  673</span>                                      ka, x, 0, <span class="keyword">False</span>, out)</div>
<div class="line"><span class="lineno">  674</span>                integral += out[1] - out[0]</div>
<div class="line"><span class="lineno">  675</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  676</span>            <span class="comment"># Evaluate the difference of antiderivatives.</span></div>
<div class="line"><span class="lineno">  677</span>            x = np.asarray([a, b], dtype=np.float_)</div>
<div class="line"><span class="lineno">  678</span>            _bspl.evaluate_spline(ta, ca.reshape(ca.shape[0], -1),</div>
<div class="line"><span class="lineno">  679</span>                                  ka, x, 0, extrapolate, out)</div>
<div class="line"><span class="lineno">  680</span>            integral = out[1] - out[0]</div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>        integral *= sign</div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordflow">return</span> integral.reshape(ca.shape[1:])</div>
<div class="line"><span class="lineno">  684</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a355a0ec57ba58676356f5a4bc0f424a6" name="a355a0ec57ba58676356f5a4bc0f424a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a355a0ec57ba58676356f5a4bc0f424a6">&#9670;&#160;</a></span>tck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.tck </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Equivalent to ``(self.t, self.c, self.k)`` (read-only).
</pre> <div class="fragment"><div class="line"><span class="lineno">  265</span>    <span class="keyword">def </span>tck(self):</div>
<div class="line"><span class="lineno">  266</span>        <span class="stringliteral">&quot;&quot;&quot;Equivalent to ``(self.t, self.c, self.k)`` (read-only).</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  268</span>        <span class="keywordflow">return</span> self.t, self.c, self.k</div>
<div class="line"><span class="lineno">  269</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a76ea4ea8f3b10f81836e1d096c2ffaac" name="a76ea4ea8f3b10f81836e1d096c2ffaac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ea4ea8f3b10f81836e1d096c2ffaac">&#9670;&#160;</a></span>axis</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.axis</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a30ced40af99c785dd17b954c0686c342" name="a30ced40af99c785dd17b954c0686c342"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30ced40af99c785dd17b954c0686c342">&#9670;&#160;</a></span>c</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.c</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaed4249c982a07066700e9118ef2adde" name="aaed4249c982a07066700e9118ef2adde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaed4249c982a07066700e9118ef2adde">&#9670;&#160;</a></span>extrapolate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.extrapolate</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4747354ee39af9d2a47a83549d7251d" name="ab4747354ee39af9d2a47a83549d7251d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4747354ee39af9d2a47a83549d7251d">&#9670;&#160;</a></span>k</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.k</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a65cf9b018488e71c09d3226fc19711ac" name="a65cf9b018488e71c09d3226fc19711ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65cf9b018488e71c09d3226fc19711ac">&#9670;&#160;</a></span>t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.interpolate._bsplines.BSpline.t</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/scipy/interpolate/<a class="el" href="interpolate_2__bsplines_8py.html">_bsplines.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
