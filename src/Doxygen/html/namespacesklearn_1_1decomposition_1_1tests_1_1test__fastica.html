<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.decomposition.tests.test_fastica Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1decomposition.html">decomposition</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html">test_fastica</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.decomposition.tests.test_fastica Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0c0640d9046886a418f1ab90dc350842" id="r_a0c0640d9046886a418f1ab90dc350842"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a0c0640d9046886a418f1ab90dc350842">center_and_norm</a> (x, axis=-1)</td></tr>
<tr class="separator:a0c0640d9046886a418f1ab90dc350842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6e9fbca2336299c1b15ddd6511bf1d" id="r_a3a6e9fbca2336299c1b15ddd6511bf1d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a3a6e9fbca2336299c1b15ddd6511bf1d">test_gs</a> ()</td></tr>
<tr class="separator:a3a6e9fbca2336299c1b15ddd6511bf1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6cf7afd0990992499c97b1d466657a2" id="r_af6cf7afd0990992499c97b1d466657a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#af6cf7afd0990992499c97b1d466657a2">test_fastica_attributes_dtypes</a> (global_dtype)</td></tr>
<tr class="separator:af6cf7afd0990992499c97b1d466657a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4deec83dae939d0b1f3731dd1336c233" id="r_a4deec83dae939d0b1f3731dd1336c233"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a4deec83dae939d0b1f3731dd1336c233">test_fastica_return_dtypes</a> (global_dtype)</td></tr>
<tr class="separator:a4deec83dae939d0b1f3731dd1336c233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a30e61d50282fad4485ff7aa468a170" id="r_a2a30e61d50282fad4485ff7aa468a170"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a2a30e61d50282fad4485ff7aa468a170">test_fastica_simple</a> (add_noise, global_random_seed, global_dtype)</td></tr>
<tr class="separator:a2a30e61d50282fad4485ff7aa468a170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26c780fd56380a337c60b08bf3410413" id="r_a26c780fd56380a337c60b08bf3410413"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a26c780fd56380a337c60b08bf3410413">test_fastica_nowhiten</a> ()</td></tr>
<tr class="separator:a26c780fd56380a337c60b08bf3410413"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4980bf24db7f32812514f17a06ae5ab" id="r_ae4980bf24db7f32812514f17a06ae5ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#ae4980bf24db7f32812514f17a06ae5ab">test_fastica_convergence_fail</a> ()</td></tr>
<tr class="separator:ae4980bf24db7f32812514f17a06ae5ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ea76706cf8262e612439be6aa012511" id="r_a2ea76706cf8262e612439be6aa012511"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a2ea76706cf8262e612439be6aa012511">test_non_square_fastica</a> (add_noise)</td></tr>
<tr class="separator:a2ea76706cf8262e612439be6aa012511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae4b6627cc06ad6c4353b61f3698e171" id="r_aae4b6627cc06ad6c4353b61f3698e171"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#aae4b6627cc06ad6c4353b61f3698e171">test_fit_transform</a> (global_random_seed, global_dtype)</td></tr>
<tr class="separator:aae4b6627cc06ad6c4353b61f3698e171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3dd8cb41d36f3c1d00f06872d357f58" id="r_ab3dd8cb41d36f3c1d00f06872d357f58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#ab3dd8cb41d36f3c1d00f06872d357f58">test_inverse_transform</a> (whiten, n_components, expected_mixing_shape, global_random_seed, global_dtype)</td></tr>
<tr class="separator:ab3dd8cb41d36f3c1d00f06872d357f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae42fc32fbb7471fae132138b13db1dfc" id="r_ae42fc32fbb7471fae132138b13db1dfc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#ae42fc32fbb7471fae132138b13db1dfc">test_fastica_errors</a> ()</td></tr>
<tr class="separator:ae42fc32fbb7471fae132138b13db1dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ab7b9343acc0f1fb3bff72eb702563" id="r_ae7ab7b9343acc0f1fb3bff72eb702563"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#ae7ab7b9343acc0f1fb3bff72eb702563">test_fastica_whiten_unit_variance</a> ()</td></tr>
<tr class="separator:ae7ab7b9343acc0f1fb3bff72eb702563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a72c2ed63f17d7f54656497b3d55d2c" id="r_a2a72c2ed63f17d7f54656497b3d55d2c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a2a72c2ed63f17d7f54656497b3d55d2c">test_fastica_whiten_default_value_deprecation</a> (ica)</td></tr>
<tr class="separator:a2a72c2ed63f17d7f54656497b3d55d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd700e5bc327a7dc90b33f39f91158c" id="r_a7cd700e5bc327a7dc90b33f39f91158c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a7cd700e5bc327a7dc90b33f39f91158c">test_fastica_whiten_backwards_compatibility</a> ()</td></tr>
<tr class="separator:a7cd700e5bc327a7dc90b33f39f91158c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3be4bc38880e4c54dc1882265e19164" id="r_af3be4bc38880e4c54dc1882265e19164"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#af3be4bc38880e4c54dc1882265e19164">test_fastica_output_shape</a> (whiten, return_X_mean, return_n_iter)</td></tr>
<tr class="separator:af3be4bc38880e4c54dc1882265e19164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14eaa39780dad7a508d6db83baf9f357" id="r_a14eaa39780dad7a508d6db83baf9f357"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a14eaa39780dad7a508d6db83baf9f357">test_fastica_simple_different_solvers</a> (add_noise, global_random_seed)</td></tr>
<tr class="separator:a14eaa39780dad7a508d6db83baf9f357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cfe1d51141446819cd8a86cd32816d8" id="r_a7cfe1d51141446819cd8a86cd32816d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1decomposition_1_1tests_1_1test__fastica.html#a7cfe1d51141446819cd8a86cd32816d8">test_fastica_eigh_low_rank_warning</a> (global_random_seed)</td></tr>
<tr class="separator:a7cfe1d51141446819cd8a86cd32816d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Test the fastica algorithm.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a0c0640d9046886a418f1ab90dc350842" name="a0c0640d9046886a418f1ab90dc350842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c0640d9046886a418f1ab90dc350842">&#9670;&#160;</a></span>center_and_norm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.center_and_norm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Centers and norms x **in place**

Parameters
-----------
x: ndarray
    Array with an axis of observations (statistical units) measured on
    random variables.
axis: int, optional
    Axis along which the mean and variance are calculated.
</pre> <div class="fragment"><div class="line"><span class="lineno">   20</span><span class="keyword">def </span>center_and_norm(x, axis=-1):</div>
<div class="line"><span class="lineno">   21</span>    <span class="stringliteral">&quot;&quot;&quot;Centers and norms x **in place**</span></div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   24</span><span class="stringliteral">    -----------</span></div>
<div class="line"><span class="lineno">   25</span><span class="stringliteral">    x: ndarray</span></div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral">        Array with an axis of observations (statistical units) measured on</span></div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">        random variables.</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">    axis: int, optional</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">        Axis along which the mean and variance are calculated.</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   31</span>    x = np.rollaxis(x, axis)</div>
<div class="line"><span class="lineno">   32</span>    x -= x.mean(axis=0)</div>
<div class="line"><span class="lineno">   33</span>    x /= x.std(axis=0)</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af6cf7afd0990992499c97b1d466657a2" name="af6cf7afd0990992499c97b1d466657a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6cf7afd0990992499c97b1d466657a2">&#9670;&#160;</a></span>test_fastica_attributes_dtypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_attributes_dtypes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   50</span><span class="keyword">def </span>test_fastica_attributes_dtypes(global_dtype):</div>
<div class="line"><span class="lineno">   51</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">   52</span>    X = rng.random_sample((100, 10)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">   53</span>    fica = FastICA(</div>
<div class="line"><span class="lineno">   54</span>        n_components=5, max_iter=1000, whiten=<span class="stringliteral">&quot;unit-variance&quot;</span>, random_state=0</div>
<div class="line"><span class="lineno">   55</span>    ).fit(X)</div>
<div class="line"><span class="lineno">   56</span>    <span class="keyword">assert</span> fica.components_.dtype == global_dtype</div>
<div class="line"><span class="lineno">   57</span>    <span class="keyword">assert</span> fica.mixing_.dtype == global_dtype</div>
<div class="line"><span class="lineno">   58</span>    <span class="keyword">assert</span> fica.mean_.dtype == global_dtype</div>
<div class="line"><span class="lineno">   59</span>    <span class="keyword">assert</span> fica.whitening_.dtype == global_dtype</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4980bf24db7f32812514f17a06ae5ab" name="ae4980bf24db7f32812514f17a06ae5ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4980bf24db7f32812514f17a06ae5ab">&#9670;&#160;</a></span>test_fastica_convergence_fail()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_convergence_fail </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  195</span><span class="keyword">def </span>test_fastica_convergence_fail():</div>
<div class="line"><span class="lineno">  196</span>    <span class="comment"># Test the FastICA algorithm on very simple data</span></div>
<div class="line"><span class="lineno">  197</span>    <span class="comment"># (see test_non_square_fastica).</span></div>
<div class="line"><span class="lineno">  198</span>    <span class="comment"># Ensure a ConvergenceWarning raised if the tolerance is sufficiently low.</span></div>
<div class="line"><span class="lineno">  199</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    n_samples = 1000</div>
<div class="line"><span class="lineno">  202</span>    <span class="comment"># Generate two sources:</span></div>
<div class="line"><span class="lineno">  203</span>    t = np.linspace(0, 100, n_samples)</div>
<div class="line"><span class="lineno">  204</span>    s1 = np.sin(t)</div>
<div class="line"><span class="lineno">  205</span>    s2 = np.ceil(np.sin(np.pi * t))</div>
<div class="line"><span class="lineno">  206</span>    s = np.c_[s1, s2].T</div>
<div class="line"><span class="lineno">  207</span>    center_and_norm(s)</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    <span class="comment"># Mixing matrix</span></div>
<div class="line"><span class="lineno">  210</span>    mixing = rng.randn(6, 2)</div>
<div class="line"><span class="lineno">  211</span>    m = np.dot(mixing, s)</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="comment"># Do fastICA with tolerance 0. to ensure failing convergence</span></div>
<div class="line"><span class="lineno">  214</span>    warn_msg = (</div>
<div class="line"><span class="lineno">  215</span>        <span class="stringliteral">&quot;FastICA did not converge. Consider increasing tolerance &quot;</span></div>
<div class="line"><span class="lineno">  216</span>        <span class="stringliteral">&quot;or the maximum number of iterations.&quot;</span></div>
<div class="line"><span class="lineno">  217</span>    )</div>
<div class="line"><span class="lineno">  218</span>    <span class="keyword">with</span> pytest.warns(ConvergenceWarning, match=warn_msg):</div>
<div class="line"><span class="lineno">  219</span>        ica = FastICA(</div>
<div class="line"><span class="lineno">  220</span>            algorithm=<span class="stringliteral">&quot;parallel&quot;</span>, n_components=2, random_state=rng, max_iter=2, tol=0.0</div>
<div class="line"><span class="lineno">  221</span>        )</div>
<div class="line"><span class="lineno">  222</span>        ica.fit(m.T)</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span><span class="preprocessor">@pytest.mark.parametrize(&quot;add_noise&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cfe1d51141446819cd8a86cd32816d8" name="a7cfe1d51141446819cd8a86cd32816d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cfe1d51141446819cd8a86cd32816d8">&#9670;&#160;</a></span>test_fastica_eigh_low_rank_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_eigh_low_rank_warning </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test FastICA eigh solver raises warning for low-rank data.</pre> <div class="fragment"><div class="line"><span class="lineno">  504</span><span class="keyword">def </span>test_fastica_eigh_low_rank_warning(global_random_seed):</div>
<div class="line"><span class="lineno">  505</span>    <span class="stringliteral">&quot;&quot;&quot;Test FastICA eigh solver raises warning for low-rank data.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  506</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">  507</span>    A = rng.randn(10, 2)</div>
<div class="line"><span class="lineno">  508</span>    X = A @ A.T</div>
<div class="line"><span class="lineno">  509</span>    ica = FastICA(random_state=0, whiten=<span class="stringliteral">&quot;unit-variance&quot;</span>, whiten_solver=<span class="stringliteral">&quot;eigh&quot;</span>)</div>
<div class="line"><span class="lineno">  510</span>    msg = <span class="stringliteral">&quot;There are some small singular values&quot;</span></div>
<div class="line"><span class="lineno">  511</span>    <span class="keyword">with</span> pytest.warns(UserWarning, match=msg):</div>
<div class="line"><span class="lineno">  512</span>        ica.fit(X)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae42fc32fbb7471fae132138b13db1dfc" name="ae42fc32fbb7471fae132138b13db1dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae42fc32fbb7471fae132138b13db1dfc">&#9670;&#160;</a></span>test_fastica_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  369</span><span class="keyword">def </span>test_fastica_errors():</div>
<div class="line"><span class="lineno">  370</span>    n_features = 3</div>
<div class="line"><span class="lineno">  371</span>    n_samples = 10</div>
<div class="line"><span class="lineno">  372</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  373</span>    X = rng.random_sample((n_samples, n_features))</div>
<div class="line"><span class="lineno">  374</span>    w_init = rng.randn(n_features + 1, n_features + 1)</div>
<div class="line"><span class="lineno">  375</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=<span class="stringliteral">r&quot;alpha must be in \[1,2\]&quot;</span>):</div>
<div class="line"><span class="lineno">  376</span>        fastica(X, fun_args={<span class="stringliteral">&quot;alpha&quot;</span>: 0})</div>
<div class="line"><span class="lineno">  377</span>    <span class="keyword">with</span> pytest.raises(</div>
<div class="line"><span class="lineno">  378</span>        ValueError, match=<span class="stringliteral">&quot;w_init has invalid shape.+&quot;</span> <span class="stringliteral">r&quot;should be \&zwj;(3L?, 3L?\&zwj;)&quot;</span></div>
<div class="line"><span class="lineno">  379</span>    ):</div>
<div class="line"><span class="lineno">  380</span>        fastica(X, w_init=w_init)</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a26c780fd56380a337c60b08bf3410413" name="a26c780fd56380a337c60b08bf3410413"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26c780fd56380a337c60b08bf3410413">&#9670;&#160;</a></span>test_fastica_nowhiten()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_nowhiten </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  184</span><span class="keyword">def </span>test_fastica_nowhiten():</div>
<div class="line"><span class="lineno">  185</span>    m = [[0, 1], [1, 0]]</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    <span class="comment"># test for issue #697</span></div>
<div class="line"><span class="lineno">  188</span>    ica = FastICA(n_components=1, whiten=<span class="keyword">False</span>, random_state=0)</div>
<div class="line"><span class="lineno">  189</span>    warn_msg = <span class="stringliteral">&quot;Ignoring n_components with whiten=False.&quot;</span></div>
<div class="line"><span class="lineno">  190</span>    <span class="keyword">with</span> pytest.warns(UserWarning, match=warn_msg):</div>
<div class="line"><span class="lineno">  191</span>        ica.fit(m)</div>
<div class="line"><span class="lineno">  192</span>    <span class="keyword">assert</span> hasattr(ica, <span class="stringliteral">&quot;mixing_&quot;</span>)</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af3be4bc38880e4c54dc1882265e19164" name="af3be4bc38880e4c54dc1882265e19164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3be4bc38880e4c54dc1882265e19164">&#9670;&#160;</a></span>test_fastica_output_shape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_output_shape </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>whiten</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_X_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_n_iter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  452</span><span class="keyword">def </span>test_fastica_output_shape(whiten, return_X_mean, return_n_iter):</div>
<div class="line"><span class="lineno">  453</span>    n_features = 3</div>
<div class="line"><span class="lineno">  454</span>    n_samples = 10</div>
<div class="line"><span class="lineno">  455</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  456</span>    X = rng.random_sample((n_samples, n_features))</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    expected_len = 3 + return_X_mean + return_n_iter</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    out = fastica(</div>
<div class="line"><span class="lineno">  461</span>        X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean</div>
<div class="line"><span class="lineno">  462</span>    )</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>    <span class="keyword">assert</span> len(out) == expected_len</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> whiten:</div>
<div class="line"><span class="lineno">  466</span>        <span class="keyword">assert</span> out[0] <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span><span class="preprocessor">@pytest.mark.parametrize(&quot;add_noise&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4deec83dae939d0b1f3731dd1336c233" name="a4deec83dae939d0b1f3731dd1336c233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4deec83dae939d0b1f3731dd1336c233">&#9670;&#160;</a></span>test_fastica_return_dtypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_return_dtypes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   62</span><span class="keyword">def </span>test_fastica_return_dtypes(global_dtype):</div>
<div class="line"><span class="lineno">   63</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">   64</span>    X = rng.random_sample((100, 10)).astype(global_dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">   65</span>    k_, mixing_, s_ = fastica(</div>
<div class="line"><span class="lineno">   66</span>        X, max_iter=1000, whiten=<span class="stringliteral">&quot;unit-variance&quot;</span>, random_state=rng</div>
<div class="line"><span class="lineno">   67</span>    )</div>
<div class="line"><span class="lineno">   68</span>    <span class="keyword">assert</span> k_.dtype == global_dtype</div>
<div class="line"><span class="lineno">   69</span>    <span class="keyword">assert</span> mixing_.dtype == global_dtype</div>
<div class="line"><span class="lineno">   70</span>    <span class="keyword">assert</span> s_.dtype == global_dtype</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span><span class="comment"># FIXME remove filter in 1.3</span></div>
<div class="line"><span class="lineno">   74</span><span class="preprocessor">@pytest.mark.filterwarnings</span>(</div>
<div class="line"><span class="lineno">   75</span>    <span class="stringliteral">&quot;ignore:Starting in v1.3, whiten=&#39;unit-variance&#39; will be used by default.&quot;</span></div>
<div class="line"><span class="lineno">   76</span>)</div>
<div class="line"><span class="lineno">   77</span><span class="preprocessor">@pytest.mark.parametrize(&quot;add_noise&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a30e61d50282fad4485ff7aa468a170" name="a2a30e61d50282fad4485ff7aa468a170"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a30e61d50282fad4485ff7aa468a170">&#9670;&#160;</a></span>test_fastica_simple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_simple </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>add_noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   78</span><span class="keyword">def </span>test_fastica_simple(add_noise, global_random_seed, global_dtype):</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno">   80</span>        global_random_seed == 20</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">and</span> global_dtype == np.float32</div>
<div class="line"><span class="lineno">   82</span>        <span class="keywordflow">and</span> <span class="keywordflow">not</span> add_noise</div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordflow">and</span> os.getenv(<span class="stringliteral">&quot;DISTRIB&quot;</span>) == <span class="stringliteral">&quot;ubuntu&quot;</span></div>
<div class="line"><span class="lineno">   84</span>    ):</div>
<div class="line"><span class="lineno">   85</span>        pytest.xfail(</div>
<div class="line"><span class="lineno">   86</span>            <span class="stringliteral">&quot;FastICA instability with Ubuntu Atlas build with float32 &quot;</span></div>
<div class="line"><span class="lineno">   87</span>            <span class="stringliteral">&quot;global_dtype. For more details, see &quot;</span></div>
<div class="line"><span class="lineno">   88</span>            <span class="stringliteral">&quot;https://github.com/scikit-learn/scikit-learn/issues/24131#issuecomment-1208091119&quot;</span>  <span class="comment"># noqa</span></div>
<div class="line"><span class="lineno">   89</span>        )</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    <span class="comment"># Test the FastICA algorithm on very simple data.</span></div>
<div class="line"><span class="lineno">   92</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">   93</span>    n_samples = 1000</div>
<div class="line"><span class="lineno">   94</span>    <span class="comment"># Generate two sources:</span></div>
<div class="line"><span class="lineno">   95</span>    s1 = (2 * np.sin(np.linspace(0, 100, n_samples)) &gt; 0) - 1</div>
<div class="line"><span class="lineno">   96</span>    s2 = stats.t.rvs(1, size=n_samples, random_state=global_random_seed)</div>
<div class="line"><span class="lineno">   97</span>    s = np.c_[s1, s2].T</div>
<div class="line"><span class="lineno">   98</span>    center_and_norm(s)</div>
<div class="line"><span class="lineno">   99</span>    s = s.astype(global_dtype)</div>
<div class="line"><span class="lineno">  100</span>    s1, s2 = s</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <span class="comment"># Mixing angle</span></div>
<div class="line"><span class="lineno">  103</span>    phi = 0.6</div>
<div class="line"><span class="lineno">  104</span>    mixing = np.array([[np.cos(phi), np.sin(phi)], [np.sin(phi), -np.cos(phi)]])</div>
<div class="line"><span class="lineno">  105</span>    mixing = mixing.astype(global_dtype)</div>
<div class="line"><span class="lineno">  106</span>    m = np.dot(mixing, s)</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> add_noise:</div>
<div class="line"><span class="lineno">  109</span>        m += 0.1 * rng.randn(2, 1000)</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    center_and_norm(m)</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    <span class="comment"># function as fun arg</span></div>
<div class="line"><span class="lineno">  114</span>    <span class="keyword">def </span>g_test(x):</div>
<div class="line"><span class="lineno">  115</span>        <span class="keywordflow">return</span> x**3, (3 * x**2).mean(axis=-1)</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>    algos = [<span class="stringliteral">&quot;parallel&quot;</span>, <span class="stringliteral">&quot;deflation&quot;</span>]</div>
<div class="line"><span class="lineno">  118</span>    nls = [<span class="stringliteral">&quot;logcosh&quot;</span>, <span class="stringliteral">&quot;exp&quot;</span>, <span class="stringliteral">&quot;cube&quot;</span>, g_test]</div>
<div class="line"><span class="lineno">  119</span>    whitening = [<span class="stringliteral">&quot;arbitrary-variance&quot;</span>, <span class="stringliteral">&quot;unit-variance&quot;</span>, <span class="keyword">False</span>]</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">for</span> algo, nl, whiten <span class="keywordflow">in</span> itertools.product(algos, nls, whitening):</div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">if</span> whiten:</div>
<div class="line"><span class="lineno">  122</span>            k_, mixing_, s_ = fastica(</div>
<div class="line"><span class="lineno">  123</span>                m.T, fun=nl, whiten=whiten, algorithm=algo, random_state=rng</div>
<div class="line"><span class="lineno">  124</span>            )</div>
<div class="line"><span class="lineno">  125</span>            <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  126</span>                fastica(m.T, fun=np.tanh, whiten=whiten, algorithm=algo)</div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  128</span>            pca = PCA(n_components=2, whiten=<span class="keyword">True</span>, random_state=rng)</div>
<div class="line"><span class="lineno">  129</span>            X = pca.fit_transform(m.T)</div>
<div class="line"><span class="lineno">  130</span>            k_, mixing_, s_ = fastica(</div>
<div class="line"><span class="lineno">  131</span>                X, fun=nl, algorithm=algo, whiten=<span class="keyword">False</span>, random_state=rng</div>
<div class="line"><span class="lineno">  132</span>            )</div>
<div class="line"><span class="lineno">  133</span>            <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  134</span>                fastica(X, fun=np.tanh, algorithm=algo)</div>
<div class="line"><span class="lineno">  135</span>        s_ = s_.T</div>
<div class="line"><span class="lineno">  136</span>        <span class="comment"># Check that the mixing model described in the docstring holds:</span></div>
<div class="line"><span class="lineno">  137</span>        <span class="keywordflow">if</span> whiten:</div>
<div class="line"><span class="lineno">  138</span>            <span class="comment"># XXX: exact reconstruction to standard relative tolerance is not</span></div>
<div class="line"><span class="lineno">  139</span>            <span class="comment"># possible. This is probably expected when add_noise is True but we</span></div>
<div class="line"><span class="lineno">  140</span>            <span class="comment"># also need a non-trivial atol in float32 when add_noise is False.</span></div>
<div class="line"><span class="lineno">  141</span>            <span class="comment">#</span></div>
<div class="line"><span class="lineno">  142</span>            <span class="comment"># Note that the 2 sources are non-Gaussian in this test.</span></div>
<div class="line"><span class="lineno">  143</span>            atol = 1e-5 <span class="keywordflow">if</span> global_dtype == np.float32 <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  144</span>            assert_allclose(np.dot(np.dot(mixing_, k_), m), s_, atol=atol)</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>        center_and_norm(s_)</div>
<div class="line"><span class="lineno">  147</span>        s1_, s2_ = s_</div>
<div class="line"><span class="lineno">  148</span>        <span class="comment"># Check to see if the sources have been estimated</span></div>
<div class="line"><span class="lineno">  149</span>        <span class="comment"># in the wrong order</span></div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">if</span> abs(np.dot(s1_, s2)) &gt; abs(np.dot(s1_, s1)):</div>
<div class="line"><span class="lineno">  151</span>            s2_, s1_ = s_</div>
<div class="line"><span class="lineno">  152</span>        s1_ *= np.sign(np.dot(s1_, s1))</div>
<div class="line"><span class="lineno">  153</span>        s2_ *= np.sign(np.dot(s2_, s2))</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>        <span class="comment"># Check that we have estimated the original sources</span></div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> add_noise:</div>
<div class="line"><span class="lineno">  157</span>            assert_allclose(np.dot(s1_, s1) / n_samples, 1, atol=1e-2)</div>
<div class="line"><span class="lineno">  158</span>            assert_allclose(np.dot(s2_, s2) / n_samples, 1, atol=1e-2)</div>
<div class="line"><span class="lineno">  159</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  160</span>            assert_allclose(np.dot(s1_, s1) / n_samples, 1, atol=1e-1)</div>
<div class="line"><span class="lineno">  161</span>            assert_allclose(np.dot(s2_, s2) / n_samples, 1, atol=1e-1)</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="comment"># Test FastICA class</span></div>
<div class="line"><span class="lineno">  164</span>    _, _, sources_fun = fastica(</div>
<div class="line"><span class="lineno">  165</span>        m.T, fun=nl, algorithm=algo, random_state=global_random_seed</div>
<div class="line"><span class="lineno">  166</span>    )</div>
<div class="line"><span class="lineno">  167</span>    ica = FastICA(fun=nl, algorithm=algo, random_state=global_random_seed)</div>
<div class="line"><span class="lineno">  168</span>    sources = ica.fit_transform(m.T)</div>
<div class="line"><span class="lineno">  169</span>    <span class="keyword">assert</span> ica.components_.shape == (2, 2)</div>
<div class="line"><span class="lineno">  170</span>    <span class="keyword">assert</span> sources.shape == (1000, 2)</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    assert_allclose(sources_fun, sources)</div>
<div class="line"><span class="lineno">  173</span>    <span class="comment"># the debian 32 bit build with global dtype float32 needs an atol to pass</span></div>
<div class="line"><span class="lineno">  174</span>    atol = 1e-7 <span class="keywordflow">if</span> global_dtype == np.float32 <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  175</span>    assert_allclose(sources, ica.transform(m.T), atol=atol)</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keyword">assert</span> ica.mixing_.shape == (2, 2)</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    ica = FastICA(fun=np.tanh, algorithm=algo)</div>
<div class="line"><span class="lineno">  180</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  181</span>        ica.fit(m.T)</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a14eaa39780dad7a508d6db83baf9f357" name="a14eaa39780dad7a508d6db83baf9f357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14eaa39780dad7a508d6db83baf9f357">&#9670;&#160;</a></span>test_fastica_simple_different_solvers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_simple_different_solvers </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>add_noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test FastICA is consistent between whiten_solvers.</pre> <div class="fragment"><div class="line"><span class="lineno">  470</span><span class="keyword">def </span>test_fastica_simple_different_solvers(add_noise, global_random_seed):</div>
<div class="line"><span class="lineno">  471</span>    <span class="stringliteral">&quot;&quot;&quot;Test FastICA is consistent between whiten_solvers.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  472</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">  473</span>    n_samples = 1000</div>
<div class="line"><span class="lineno">  474</span>    <span class="comment"># Generate two sources:</span></div>
<div class="line"><span class="lineno">  475</span>    s1 = (2 * np.sin(np.linspace(0, 100, n_samples)) &gt; 0) - 1</div>
<div class="line"><span class="lineno">  476</span>    s2 = stats.t.rvs(1, size=n_samples, random_state=rng)</div>
<div class="line"><span class="lineno">  477</span>    s = np.c_[s1, s2].T</div>
<div class="line"><span class="lineno">  478</span>    center_and_norm(s)</div>
<div class="line"><span class="lineno">  479</span>    s1, s2 = s</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>    <span class="comment"># Mixing angle</span></div>
<div class="line"><span class="lineno">  482</span>    phi = rng.rand() * 2 * np.pi</div>
<div class="line"><span class="lineno">  483</span>    mixing = np.array([[np.cos(phi), np.sin(phi)], [np.sin(phi), -np.cos(phi)]])</div>
<div class="line"><span class="lineno">  484</span>    m = np.dot(mixing, s)</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">if</span> add_noise:</div>
<div class="line"><span class="lineno">  487</span>        m += 0.1 * rng.randn(2, 1000)</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    center_and_norm(m)</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    outs = {}</div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">for</span> solver <span class="keywordflow">in</span> (<span class="stringliteral">&quot;svd&quot;</span>, <span class="stringliteral">&quot;eigh&quot;</span>):</div>
<div class="line"><span class="lineno">  493</span>        ica = FastICA(random_state=0, whiten=<span class="stringliteral">&quot;unit-variance&quot;</span>, whiten_solver=solver)</div>
<div class="line"><span class="lineno">  494</span>        sources = ica.fit_transform(m.T)</div>
<div class="line"><span class="lineno">  495</span>        outs[solver] = sources</div>
<div class="line"><span class="lineno">  496</span>        <span class="keyword">assert</span> ica.components_.shape == (2, 2)</div>
<div class="line"><span class="lineno">  497</span>        <span class="keyword">assert</span> sources.shape == (1000, 2)</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>    <span class="comment"># compared numbers are not all on the same magnitude. Using a small atol to</span></div>
<div class="line"><span class="lineno">  500</span>    <span class="comment"># make the test less brittle</span></div>
<div class="line"><span class="lineno">  501</span>    assert_allclose(outs[<span class="stringliteral">&quot;eigh&quot;</span>], outs[<span class="stringliteral">&quot;svd&quot;</span>], atol=1e-12)</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cd700e5bc327a7dc90b33f39f91158c" name="a7cd700e5bc327a7dc90b33f39f91158c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cd700e5bc327a7dc90b33f39f91158c">&#9670;&#160;</a></span>test_fastica_whiten_backwards_compatibility()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_whiten_backwards_compatibility </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test previous behavior for FastICA whitening (whiten=True)

Regression test for #19490
</pre> <div class="fragment"><div class="line"><span class="lineno">  410</span><span class="keyword">def </span>test_fastica_whiten_backwards_compatibility():</div>
<div class="line"><span class="lineno">  411</span>    <span class="stringliteral">&quot;&quot;&quot;Test previous behavior for FastICA whitening (whiten=True)</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral">    Regression test for #19490</span></div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  415</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  416</span>    X = rng.random_sample((100, 10))</div>
<div class="line"><span class="lineno">  417</span>    n_components = X.shape[1]</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    default_ica = FastICA(n_components=n_components, random_state=0)</div>
<div class="line"><span class="lineno">  420</span>    <span class="keyword">with</span> pytest.warns(FutureWarning):</div>
<div class="line"><span class="lineno">  421</span>        Xt_on_default = default_ica.fit_transform(X)</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    ica = FastICA(n_components=n_components, whiten=<span class="keyword">True</span>, random_state=0)</div>
<div class="line"><span class="lineno">  424</span>    <span class="keyword">with</span> pytest.warns(FutureWarning):</div>
<div class="line"><span class="lineno">  425</span>        Xt = ica.fit_transform(X)</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>    <span class="comment"># No warning must be raised in this case.</span></div>
<div class="line"><span class="lineno">  428</span>    av_ica = FastICA(</div>
<div class="line"><span class="lineno">  429</span>        n_components=n_components,</div>
<div class="line"><span class="lineno">  430</span>        whiten=<span class="stringliteral">&quot;arbitrary-variance&quot;</span>,</div>
<div class="line"><span class="lineno">  431</span>        random_state=0,</div>
<div class="line"><span class="lineno">  432</span>        whiten_solver=<span class="stringliteral">&quot;svd&quot;</span>,</div>
<div class="line"><span class="lineno">  433</span>    )</div>
<div class="line"><span class="lineno">  434</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  435</span>        warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, FutureWarning)</div>
<div class="line"><span class="lineno">  436</span>        Xt_av = av_ica.fit_transform(X)</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    <span class="comment"># The whitening strategy must be &quot;arbitrary-variance&quot; in all the cases.</span></div>
<div class="line"><span class="lineno">  439</span>    <span class="keyword">assert</span> default_ica._whiten == <span class="stringliteral">&quot;arbitrary-variance&quot;</span></div>
<div class="line"><span class="lineno">  440</span>    <span class="keyword">assert</span> ica._whiten == <span class="stringliteral">&quot;arbitrary-variance&quot;</span></div>
<div class="line"><span class="lineno">  441</span>    <span class="keyword">assert</span> av_ica._whiten == <span class="stringliteral">&quot;arbitrary-variance&quot;</span></div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    assert_array_equal(Xt, Xt_on_default)</div>
<div class="line"><span class="lineno">  444</span>    assert_array_equal(Xt, Xt_av)</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>    <span class="keyword">assert</span> np.var(Xt) == pytest.approx(1.0 / 100)</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span><span class="preprocessor">@pytest.mark.parametrize(&quot;whiten&quot;, [&quot;arbitrary-variance&quot;, &quot;unit-variance&quot;, False])</span></div>
<div class="line"><span class="lineno">  450</span><span class="preprocessor">@pytest.mark.parametrize(&quot;return_X_mean&quot;, [True, False])</span></div>
<div class="line"><span class="lineno">  451</span><span class="preprocessor">@pytest.mark.parametrize(&quot;return_n_iter&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a72c2ed63f17d7f54656497b3d55d2c" name="a2a72c2ed63f17d7f54656497b3d55d2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a72c2ed63f17d7f54656497b3d55d2c">&#9670;&#160;</a></span>test_fastica_whiten_default_value_deprecation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_whiten_default_value_deprecation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ica</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test FastICA whiten default value deprecation.

Regression test for #19490
</pre> <div class="fragment"><div class="line"><span class="lineno">  398</span><span class="keyword">def </span>test_fastica_whiten_default_value_deprecation(ica):</div>
<div class="line"><span class="lineno">  399</span>    <span class="stringliteral">&quot;&quot;&quot;Test FastICA whiten default value deprecation.</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    Regression test for #19490</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  403</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  404</span>    X = rng.random_sample((100, 10))</div>
<div class="line"><span class="lineno">  405</span>    <span class="keyword">with</span> pytest.warns(FutureWarning, match=<span class="stringliteral">r&quot;Starting in v1.3, whiten=&quot;</span>):</div>
<div class="line"><span class="lineno">  406</span>        ica.fit(X)</div>
<div class="line"><span class="lineno">  407</span>        <span class="keyword">assert</span> ica._whiten == <span class="stringliteral">&quot;arbitrary-variance&quot;</span></div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7ab7b9343acc0f1fb3bff72eb702563" name="ae7ab7b9343acc0f1fb3bff72eb702563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ab7b9343acc0f1fb3bff72eb702563">&#9670;&#160;</a></span>test_fastica_whiten_unit_variance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fastica_whiten_unit_variance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test unit variance of transformed data using FastICA algorithm.

Bug #13056
</pre> <div class="fragment"><div class="line"><span class="lineno">  383</span><span class="keyword">def </span>test_fastica_whiten_unit_variance():</div>
<div class="line"><span class="lineno">  384</span>    <span class="stringliteral">&quot;&quot;&quot;Test unit variance of transformed data using FastICA algorithm.</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">    Bug #13056</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  388</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  389</span>    X = rng.random_sample((100, 10))</div>
<div class="line"><span class="lineno">  390</span>    n_components = X.shape[1]</div>
<div class="line"><span class="lineno">  391</span>    ica = FastICA(n_components=n_components, whiten=<span class="stringliteral">&quot;unit-variance&quot;</span>, random_state=0)</div>
<div class="line"><span class="lineno">  392</span>    Xt = ica.fit_transform(X)</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>    <span class="keyword">assert</span> np.var(Xt) == pytest.approx(1.0)</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span><span class="preprocessor">@pytest.mark.parametrize(&quot;ica&quot;, [FastICA()</span>, FastICA(whiten=<span class="keyword">True</span>)])</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae4b6627cc06ad6c4353b61f3698e171" name="aae4b6627cc06ad6c4353b61f3698e171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae4b6627cc06ad6c4353b61f3698e171">&#9670;&#160;</a></span>test_fit_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_fit_transform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test unit variance of transformed data using FastICA algorithm.

Check that `fit_transform` gives the same result as applying
`fit` and then `transform`.

Bug #13056
</pre> <div class="fragment"><div class="line"><span class="lineno">  271</span><span class="keyword">def </span>test_fit_transform(global_random_seed, global_dtype):</div>
<div class="line"><span class="lineno">  272</span>    <span class="stringliteral">&quot;&quot;&quot;Test unit variance of transformed data using FastICA algorithm.</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    Check that `fit_transform` gives the same result as applying</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    `fit` and then `transform`.</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    Bug #13056</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  279</span>    <span class="comment"># multivariate uniform data in [0, 1]</span></div>
<div class="line"><span class="lineno">  280</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">  281</span>    X = rng.random_sample((100, 10)).astype(global_dtype)</div>
<div class="line"><span class="lineno">  282</span>    max_iter = 300</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">for</span> whiten, n_components <span class="keywordflow">in</span> [[<span class="stringliteral">&quot;unit-variance&quot;</span>, 5], [<span class="keyword">False</span>, <span class="keywordtype">None</span>]]:</div>
<div class="line"><span class="lineno">  284</span>        n_components_ = n_components <span class="keywordflow">if</span> n_components <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> X.shape[1]</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>        ica = FastICA(</div>
<div class="line"><span class="lineno">  287</span>            n_components=n_components, max_iter=max_iter, whiten=whiten, random_state=0</div>
<div class="line"><span class="lineno">  288</span>        )</div>
<div class="line"><span class="lineno">  289</span>        <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  290</span>            <span class="comment"># make sure that numerical errors do not cause sqrt of negative</span></div>
<div class="line"><span class="lineno">  291</span>            <span class="comment"># values</span></div>
<div class="line"><span class="lineno">  292</span>            warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, RuntimeWarning)</div>
<div class="line"><span class="lineno">  293</span>            <span class="comment"># XXX: for some seeds, the model does not converge.</span></div>
<div class="line"><span class="lineno">  294</span>            <span class="comment"># However this is not what we test here.</span></div>
<div class="line"><span class="lineno">  295</span>            warnings.simplefilter(<span class="stringliteral">&quot;ignore&quot;</span>, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  296</span>            Xt = ica.fit_transform(X)</div>
<div class="line"><span class="lineno">  297</span>        <span class="keyword">assert</span> ica.components_.shape == (n_components_, 10)</div>
<div class="line"><span class="lineno">  298</span>        <span class="keyword">assert</span> Xt.shape == (X.shape[0], n_components_)</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>        ica2 = FastICA(</div>
<div class="line"><span class="lineno">  301</span>            n_components=n_components, max_iter=max_iter, whiten=whiten, random_state=0</div>
<div class="line"><span class="lineno">  302</span>        )</div>
<div class="line"><span class="lineno">  303</span>        <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  304</span>            <span class="comment"># make sure that numerical errors do not cause sqrt of negative</span></div>
<div class="line"><span class="lineno">  305</span>            <span class="comment"># values</span></div>
<div class="line"><span class="lineno">  306</span>            warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, RuntimeWarning)</div>
<div class="line"><span class="lineno">  307</span>            warnings.simplefilter(<span class="stringliteral">&quot;ignore&quot;</span>, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  308</span>            ica2.fit(X)</div>
<div class="line"><span class="lineno">  309</span>        <span class="keyword">assert</span> ica2.components_.shape == (n_components_, 10)</div>
<div class="line"><span class="lineno">  310</span>        Xt2 = ica2.transform(X)</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>        <span class="comment"># XXX: we have to set atol for this test to pass for all seeds when</span></div>
<div class="line"><span class="lineno">  313</span>        <span class="comment"># fitting with float32 data. Is this revealing a bug?</span></div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordflow">if</span> global_dtype:</div>
<div class="line"><span class="lineno">  315</span>            atol = np.abs(Xt2).mean() / 1e6</div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  317</span>            atol = 0.0  <span class="comment"># the default rtol is enough for float64 data</span></div>
<div class="line"><span class="lineno">  318</span>        assert_allclose(Xt, Xt2, atol=atol)</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:Ignoring n_components with whiten=False.&quot;)</span></div>
<div class="line"><span class="lineno">  322</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  323</span>    <span class="stringliteral">&quot;whiten, n_components, expected_mixing_shape&quot;</span>,</div>
<div class="line"><span class="lineno">  324</span>    [</div>
<div class="line"><span class="lineno">  325</span>        (<span class="stringliteral">&quot;arbitrary-variance&quot;</span>, 5, (10, 5)),</div>
<div class="line"><span class="lineno">  326</span>        (<span class="stringliteral">&quot;arbitrary-variance&quot;</span>, 10, (10, 10)),</div>
<div class="line"><span class="lineno">  327</span>        (<span class="stringliteral">&quot;unit-variance&quot;</span>, 5, (10, 5)),</div>
<div class="line"><span class="lineno">  328</span>        (<span class="stringliteral">&quot;unit-variance&quot;</span>, 10, (10, 10)),</div>
<div class="line"><span class="lineno">  329</span>        (<span class="keyword">False</span>, 5, (10, 10)),</div>
<div class="line"><span class="lineno">  330</span>        (<span class="keyword">False</span>, 10, (10, 10)),</div>
<div class="line"><span class="lineno">  331</span>    ],</div>
<div class="line"><span class="lineno">  332</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a6e9fbca2336299c1b15ddd6511bf1d" name="a3a6e9fbca2336299c1b15ddd6511bf1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a6e9fbca2336299c1b15ddd6511bf1d">&#9670;&#160;</a></span>test_gs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_gs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   36</span><span class="keyword">def </span>test_gs():</div>
<div class="line"><span class="lineno">   37</span>    <span class="comment"># Test gram schmidt orthonormalization</span></div>
<div class="line"><span class="lineno">   38</span>    <span class="comment"># generate a random orthogonal  matrix</span></div>
<div class="line"><span class="lineno">   39</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">   40</span>    W, _, _ = np.linalg.svd(rng.randn(10, 10))</div>
<div class="line"><span class="lineno">   41</span>    w = rng.randn(10)</div>
<div class="line"><span class="lineno">   42</span>    _gs_decorrelation(w, W, 10)</div>
<div class="line"><span class="lineno">   43</span>    <span class="keyword">assert</span> (w**2).sum() &lt; 1.0e-10</div>
<div class="line"><span class="lineno">   44</span>    w = rng.randn(10)</div>
<div class="line"><span class="lineno">   45</span>    u = _gs_decorrelation(w, W, 5)</div>
<div class="line"><span class="lineno">   46</span>    tmp = np.dot(u, W.T)</div>
<div class="line"><span class="lineno">   47</span>    <span class="keyword">assert</span> (tmp[:5] ** 2).sum() &lt; 1.0e-10</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3dd8cb41d36f3c1d00f06872d357f58" name="ab3dd8cb41d36f3c1d00f06872d357f58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3dd8cb41d36f3c1d00f06872d357f58">&#9670;&#160;</a></span>test_inverse_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_inverse_transform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>whiten</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_components</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_mixing_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_random_seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>global_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  335</span>):</div>
<div class="line"><span class="lineno">  336</span>    <span class="comment"># Test FastICA.inverse_transform</span></div>
<div class="line"><span class="lineno">  337</span>    n_samples = 100</div>
<div class="line"><span class="lineno">  338</span>    rng = np.random.RandomState(global_random_seed)</div>
<div class="line"><span class="lineno">  339</span>    X = rng.random_sample((n_samples, 10)).astype(global_dtype)</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    ica = FastICA(n_components=n_components, random_state=rng, whiten=whiten)</div>
<div class="line"><span class="lineno">  342</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  343</span>        <span class="comment"># For some dataset (depending on the value of global_dtype) the model</span></div>
<div class="line"><span class="lineno">  344</span>        <span class="comment"># can fail to converge but this should not impact the definition of</span></div>
<div class="line"><span class="lineno">  345</span>        <span class="comment"># a valid inverse transform.</span></div>
<div class="line"><span class="lineno">  346</span>        warnings.simplefilter(<span class="stringliteral">&quot;ignore&quot;</span>, ConvergenceWarning)</div>
<div class="line"><span class="lineno">  347</span>        Xt = ica.fit_transform(X)</div>
<div class="line"><span class="lineno">  348</span>    <span class="keyword">assert</span> ica.mixing_.shape == expected_mixing_shape</div>
<div class="line"><span class="lineno">  349</span>    X2 = ica.inverse_transform(Xt)</div>
<div class="line"><span class="lineno">  350</span>    <span class="keyword">assert</span> X.shape == X2.shape</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>    <span class="comment"># reversibility test in non-reduction case</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordflow">if</span> n_components == X.shape[1]:</div>
<div class="line"><span class="lineno">  354</span>        <span class="comment"># XXX: we have to set atol for this test to pass for all seeds when</span></div>
<div class="line"><span class="lineno">  355</span>        <span class="comment"># fitting with float32 data. Is this revealing a bug?</span></div>
<div class="line"><span class="lineno">  356</span>        <span class="keywordflow">if</span> global_dtype:</div>
<div class="line"><span class="lineno">  357</span>            <span class="comment"># XXX: dividing by a smaller number makes</span></div>
<div class="line"><span class="lineno">  358</span>            <span class="comment"># tests fail for some seeds.</span></div>
<div class="line"><span class="lineno">  359</span>            atol = np.abs(X2).mean() / 1e5</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  361</span>            atol = 0.0  <span class="comment"># the default rtol is enough for float64 data</span></div>
<div class="line"><span class="lineno">  362</span>        assert_allclose(X, X2, atol=atol)</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span><span class="comment"># FIXME remove filter in 1.3</span></div>
<div class="line"><span class="lineno">  366</span><span class="preprocessor">@pytest.mark.filterwarnings</span>(</div>
<div class="line"><span class="lineno">  367</span>    <span class="stringliteral">&quot;ignore:Starting in v1.3, whiten=&#39;unit-variance&#39; will be used by default.&quot;</span></div>
<div class="line"><span class="lineno">  368</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ea76706cf8262e612439be6aa012511" name="a2ea76706cf8262e612439be6aa012511"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ea76706cf8262e612439be6aa012511">&#9670;&#160;</a></span>test_non_square_fastica()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.decomposition.tests.test_fastica.test_non_square_fastica </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>add_noise</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  226</span><span class="keyword">def </span>test_non_square_fastica(add_noise):</div>
<div class="line"><span class="lineno">  227</span>    <span class="comment"># Test the FastICA algorithm on very simple data.</span></div>
<div class="line"><span class="lineno">  228</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    n_samples = 1000</div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># Generate two sources:</span></div>
<div class="line"><span class="lineno">  232</span>    t = np.linspace(0, 100, n_samples)</div>
<div class="line"><span class="lineno">  233</span>    s1 = np.sin(t)</div>
<div class="line"><span class="lineno">  234</span>    s2 = np.ceil(np.sin(np.pi * t))</div>
<div class="line"><span class="lineno">  235</span>    s = np.c_[s1, s2].T</div>
<div class="line"><span class="lineno">  236</span>    center_and_norm(s)</div>
<div class="line"><span class="lineno">  237</span>    s1, s2 = s</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <span class="comment"># Mixing matrix</span></div>
<div class="line"><span class="lineno">  240</span>    mixing = rng.randn(6, 2)</div>
<div class="line"><span class="lineno">  241</span>    m = np.dot(mixing, s)</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordflow">if</span> add_noise:</div>
<div class="line"><span class="lineno">  244</span>        m += 0.1 * rng.randn(6, n_samples)</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    center_and_norm(m)</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    k_, mixing_, s_ = fastica(</div>
<div class="line"><span class="lineno">  249</span>        m.T, n_components=2, whiten=<span class="stringliteral">&quot;unit-variance&quot;</span>, random_state=rng</div>
<div class="line"><span class="lineno">  250</span>    )</div>
<div class="line"><span class="lineno">  251</span>    s_ = s_.T</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>    <span class="comment"># Check that the mixing model described in the docstring holds:</span></div>
<div class="line"><span class="lineno">  254</span>    assert_allclose(s_, np.dot(np.dot(mixing_, k_), m))</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    center_and_norm(s_)</div>
<div class="line"><span class="lineno">  257</span>    s1_, s2_ = s_</div>
<div class="line"><span class="lineno">  258</span>    <span class="comment"># Check to see if the sources have been estimated</span></div>
<div class="line"><span class="lineno">  259</span>    <span class="comment"># in the wrong order</span></div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">if</span> abs(np.dot(s1_, s2)) &gt; abs(np.dot(s1_, s1)):</div>
<div class="line"><span class="lineno">  261</span>        s2_, s1_ = s_</div>
<div class="line"><span class="lineno">  262</span>    s1_ *= np.sign(np.dot(s1_, s1))</div>
<div class="line"><span class="lineno">  263</span>    s2_ *= np.sign(np.dot(s2_, s2))</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="comment"># Check that we have estimated the original sources</span></div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> add_noise:</div>
<div class="line"><span class="lineno">  267</span>        assert_allclose(np.dot(s1_, s1) / n_samples, 1, atol=1e-3)</div>
<div class="line"><span class="lineno">  268</span>        assert_allclose(np.dot(s2_, s2) / n_samples, 1, atol=1e-3)</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
