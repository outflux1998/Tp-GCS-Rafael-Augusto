<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.integrate._quadpack_py Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1integrate.html">integrate</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1integrate_1_1__quadpack__py.html">_quadpack_py</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.integrate._quadpack_py Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__quadpack__py_1_1___n_quad.html">_NQuad</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__quadpack__py_1_1___opt_func.html">_OptFunc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__quadpack__py_1_1___range_func.html">_RangeFunc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__quadpack__py_1_1_integration_warning.html">IntegrationWarning</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae2de4d68c789f180f5ab7d02bca07af0" id="r_ae2de4d68c789f180f5ab7d02bca07af0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quadpack__py.html#ae2de4d68c789f180f5ab7d02bca07af0">quad</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, args=(), full_output=0, epsabs=1.49e-8, epsrel=1.49e-8, limit=50, points=None, weight=None, wvar=None, wopts=None, maxp1=50, limlst=50)</td></tr>
<tr class="separator:ae2de4d68c789f180f5ab7d02bca07af0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0171c91e8e0a3757666e9bc2bb5370" id="r_a7b0171c91e8e0a3757666e9bc2bb5370"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quadpack__py.html#a7b0171c91e8e0a3757666e9bc2bb5370">_quad</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, args, full_output, epsabs, epsrel, limit, points)</td></tr>
<tr class="separator:a7b0171c91e8e0a3757666e9bc2bb5370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65aa3ac6dffcb27e737856a9b16ae872" id="r_a65aa3ac6dffcb27e737856a9b16ae872"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quadpack__py.html#a65aa3ac6dffcb27e737856a9b16ae872">_quad_weight</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, args, full_output, epsabs, epsrel, limlst, limit, maxp1, weight, wvar, wopts)</td></tr>
<tr class="separator:a65aa3ac6dffcb27e737856a9b16ae872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f7a9287a9e3c5c28bfa17bc17971b25" id="r_a3f7a9287a9e3c5c28bfa17bc17971b25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quadpack__py.html#a3f7a9287a9e3c5c28bfa17bc17971b25">dblquad</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, gfun, hfun, args=(), epsabs=1.49e-8, epsrel=1.49e-8)</td></tr>
<tr class="separator:a3f7a9287a9e3c5c28bfa17bc17971b25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e51375a16d6df8cdc6770ca0c67d44" id="r_a14e51375a16d6df8cdc6770ca0c67d44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quadpack__py.html#a14e51375a16d6df8cdc6770ca0c67d44">tplquad</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, gfun, hfun, qfun, rfun, args=(), epsabs=1.49e-8, epsrel=1.49e-8)</td></tr>
<tr class="separator:a14e51375a16d6df8cdc6770ca0c67d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd9cae351d9ebe0189e4136618bc784" id="r_a0dd9cae351d9ebe0189e4136618bc784"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quadpack__py.html#a0dd9cae351d9ebe0189e4136618bc784">nquad</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, ranges, args=None, opts=None, full_output=False)</td></tr>
<tr class="separator:a0dd9cae351d9ebe0189e4136618bc784"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae03734ba6a052fe5e9da90315f29680f" id="r_ae03734ba6a052fe5e9da90315f29680f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quadpack__py.html#ae03734ba6a052fe5e9da90315f29680f">error</a> = _quadpack.error</td></tr>
<tr class="separator:ae03734ba6a052fe5e9da90315f29680f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7b0171c91e8e0a3757666e9bc2bb5370" name="a7b0171c91e8e0a3757666e9bc2bb5370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b0171c91e8e0a3757666e9bc2bb5370">&#9670;&#160;</a></span>_quad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quadpack_py._quad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsabs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsrel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  505</span><span class="keyword">def </span>_quad(func,a,b,args,full_output,epsabs,epsrel,limit,points):</div>
<div class="line"><span class="lineno">  506</span>    infbounds = 0</div>
<div class="line"><span class="lineno">  507</span>    <span class="keywordflow">if</span> (b != Inf <span class="keywordflow">and</span> a != -Inf):</div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordflow">pass</span>   <span class="comment"># standard integration</span></div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">elif</span> (b == Inf <span class="keywordflow">and</span> a != -Inf):</div>
<div class="line"><span class="lineno">  510</span>        infbounds = 1</div>
<div class="line"><span class="lineno">  511</span>        bound = a</div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">elif</span> (b == Inf <span class="keywordflow">and</span> a == -Inf):</div>
<div class="line"><span class="lineno">  513</span>        infbounds = 2</div>
<div class="line"><span class="lineno">  514</span>        bound = 0     <span class="comment"># ignored</span></div>
<div class="line"><span class="lineno">  515</span>    <span class="keywordflow">elif</span> (b != Inf <span class="keywordflow">and</span> a == -Inf):</div>
<div class="line"><span class="lineno">  516</span>        infbounds = -1</div>
<div class="line"><span class="lineno">  517</span>        bound = b</div>
<div class="line"><span class="lineno">  518</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  519</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;Infinity comparisons don&#39;t work for you.&quot;</span>)</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>    <span class="keywordflow">if</span> points <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  522</span>        <span class="keywordflow">if</span> infbounds == 0:</div>
<div class="line"><span class="lineno">  523</span>            <span class="keywordflow">return</span> _quadpack._qagse(func,a,b,args,full_output,epsabs,epsrel,limit)</div>
<div class="line"><span class="lineno">  524</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  525</span>            <span class="keywordflow">return</span> _quadpack._qagie(func,bound,infbounds,args,full_output,epsabs,epsrel,limit)</div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  527</span>        <span class="keywordflow">if</span> infbounds != 0:</div>
<div class="line"><span class="lineno">  528</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Infinity inputs cannot be used with break points.&quot;</span>)</div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  530</span>            <span class="comment">#Duplicates force function evaluation at singular points</span></div>
<div class="line"><span class="lineno">  531</span>            the_points = numpy.unique(points)</div>
<div class="line"><span class="lineno">  532</span>            the_points = the_points[a &lt; the_points]</div>
<div class="line"><span class="lineno">  533</span>            the_points = the_points[the_points &lt; b]</div>
<div class="line"><span class="lineno">  534</span>            the_points = numpy.concatenate((the_points, (0., 0.)))</div>
<div class="line"><span class="lineno">  535</span>            <span class="keywordflow">return</span> _quadpack._qagpe(func,a,b,the_points,args,full_output,epsabs,epsrel,limit)</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a65aa3ac6dffcb27e737856a9b16ae872" name="a65aa3ac6dffcb27e737856a9b16ae872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65aa3ac6dffcb27e737856a9b16ae872">&#9670;&#160;</a></span>_quad_weight()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quadpack_py._quad_weight </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsabs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsrel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>limlst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wopts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  538</span><span class="keyword">def </span>_quad_weight(func,a,b,args,full_output,epsabs,epsrel,limlst,limit,maxp1,weight,wvar,wopts):</div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordflow">if</span> weight <span class="keywordflow">not</span> <span class="keywordflow">in</span> [<span class="stringliteral">&#39;cos&#39;</span>,<span class="stringliteral">&#39;sin&#39;</span>,<span class="stringliteral">&#39;alg&#39;</span>,<span class="stringliteral">&#39;alg-loga&#39;</span>,<span class="stringliteral">&#39;alg-logb&#39;</span>,<span class="stringliteral">&#39;alg-log&#39;</span>,<span class="stringliteral">&#39;cauchy&#39;</span>]:</div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;%s not a recognized weighting function.&quot;</span> % weight)</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>    strdict = {<span class="stringliteral">&#39;cos&#39;</span>:1,<span class="stringliteral">&#39;sin&#39;</span>:2,<span class="stringliteral">&#39;alg&#39;</span>:1,<span class="stringliteral">&#39;alg-loga&#39;</span>:2,<span class="stringliteral">&#39;alg-logb&#39;</span>:3,<span class="stringliteral">&#39;alg-log&#39;</span>:4}</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordflow">if</span> weight <span class="keywordflow">in</span> [<span class="stringliteral">&#39;cos&#39;</span>,<span class="stringliteral">&#39;sin&#39;</span>]:</div>
<div class="line"><span class="lineno">  545</span>        integr = strdict[weight]</div>
<div class="line"><span class="lineno">  546</span>        <span class="keywordflow">if</span> (b != Inf <span class="keywordflow">and</span> a != -Inf):  <span class="comment"># finite limits</span></div>
<div class="line"><span class="lineno">  547</span>            <span class="keywordflow">if</span> wopts <span class="keywordflow">is</span> <span class="keywordtype">None</span>:         <span class="comment"># no precomputed Chebyshev moments</span></div>
<div class="line"><span class="lineno">  548</span>                <span class="keywordflow">return</span> _quadpack._qawoe(func, a, b, wvar, integr, args, full_output,</div>
<div class="line"><span class="lineno">  549</span>                                        epsabs, epsrel, limit, maxp1,1)</div>
<div class="line"><span class="lineno">  550</span>            <span class="keywordflow">else</span>:                     <span class="comment"># precomputed Chebyshev moments</span></div>
<div class="line"><span class="lineno">  551</span>                momcom = wopts[0]</div>
<div class="line"><span class="lineno">  552</span>                chebcom = wopts[1]</div>
<div class="line"><span class="lineno">  553</span>                <span class="keywordflow">return</span> _quadpack._qawoe(func, a, b, wvar, integr, args, full_output,</div>
<div class="line"><span class="lineno">  554</span>                                        epsabs, epsrel, limit, maxp1, 2, momcom, chebcom)</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>        <span class="keywordflow">elif</span> (b == Inf <span class="keywordflow">and</span> a != -Inf):</div>
<div class="line"><span class="lineno">  557</span>            <span class="keywordflow">return</span> _quadpack._qawfe(func, a, wvar, integr, args, full_output,</div>
<div class="line"><span class="lineno">  558</span>                                    epsabs,limlst,limit,maxp1)</div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">elif</span> (b != Inf <span class="keywordflow">and</span> a == -Inf):  <span class="comment"># remap function and interval</span></div>
<div class="line"><span class="lineno">  560</span>            <span class="keywordflow">if</span> weight == <span class="stringliteral">&#39;cos&#39;</span>:</div>
<div class="line"><span class="lineno">  561</span>                <span class="keyword">def </span>thefunc(x,*myargs):</div>
<div class="line"><span class="lineno">  562</span>                    y = -x</div>
<div class="line"><span class="lineno">  563</span>                    func = myargs[0]</div>
<div class="line"><span class="lineno">  564</span>                    myargs = (y,) + myargs[1:]</div>
<div class="line"><span class="lineno">  565</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*myargs)</div>
<div class="line"><span class="lineno">  566</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  567</span>                <span class="keyword">def </span>thefunc(x,*myargs):</div>
<div class="line"><span class="lineno">  568</span>                    y = -x</div>
<div class="line"><span class="lineno">  569</span>                    func = myargs[0]</div>
<div class="line"><span class="lineno">  570</span>                    myargs = (y,) + myargs[1:]</div>
<div class="line"><span class="lineno">  571</span>                    <span class="keywordflow">return</span> -<a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(*myargs)</div>
<div class="line"><span class="lineno">  572</span>            args = (func,) + args</div>
<div class="line"><span class="lineno">  573</span>            <span class="keywordflow">return</span> _quadpack._qawfe(thefunc, -b, wvar, integr, args,</div>
<div class="line"><span class="lineno">  574</span>                                    full_output, epsabs, limlst, limit, maxp1)</div>
<div class="line"><span class="lineno">  575</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  576</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Cannot integrate with this weight from -Inf to +Inf.&quot;</span>)</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  578</span>        <span class="keywordflow">if</span> a <span class="keywordflow">in</span> [-Inf,Inf] <span class="keywordflow">or</span> b <span class="keywordflow">in</span> [-Inf,Inf]:</div>
<div class="line"><span class="lineno">  579</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Cannot integrate with this weight over an infinite interval.&quot;</span>)</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>        <span class="keywordflow">if</span> weight.startswith(<span class="stringliteral">&#39;alg&#39;</span>):</div>
<div class="line"><span class="lineno">  582</span>            integr = strdict[weight]</div>
<div class="line"><span class="lineno">  583</span>            <span class="keywordflow">return</span> _quadpack._qawse(func, a, b, wvar, integr, args,</div>
<div class="line"><span class="lineno">  584</span>                                    full_output, epsabs, epsrel, limit)</div>
<div class="line"><span class="lineno">  585</span>        <span class="keywordflow">else</span>:  <span class="comment"># weight == &#39;cauchy&#39;</span></div>
<div class="line"><span class="lineno">  586</span>            <span class="keywordflow">return</span> _quadpack._qawce(func, a, b, wvar, args, full_output,</div>
<div class="line"><span class="lineno">  587</span>                                    epsabs, epsrel, limit)</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f7a9287a9e3c5c28bfa17bc17971b25" name="a3f7a9287a9e3c5c28bfa17bc17971b25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f7a9287a9e3c5c28bfa17bc17971b25">&#9670;&#160;</a></span>dblquad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quadpack_py.dblquad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsabs</em> = <code>1.49e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsrel</em> = <code>1.49e-8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute a double integral.

Return the double (definite) integral of ``func(y, x)`` from ``x = a..b``
and ``y = gfun(x)..hfun(x)``.

Parameters
----------
func : callable
    A Python function or method of at least two variables: y must be the
    first argument and x the second argument.
a, b : float
    The limits of integration in x: `a` &lt; `b`
gfun : callable or float
    The lower boundary curve in y which is a function taking a single
    floating point argument (x) and returning a floating point result
    or a float indicating a constant boundary curve.
hfun : callable or float
    The upper boundary curve in y (same requirements as `gfun`).
args : sequence, optional
    Extra arguments to pass to `func`.
epsabs : float, optional
    Absolute tolerance passed directly to the inner 1-D quadrature
    integration. Default is 1.49e-8. ``dblquad`` tries to obtain
    an accuracy of ``abs(i-result) &lt;= max(epsabs, epsrel*abs(i))``
    where ``i`` = inner integral of ``func(y, x)`` from ``gfun(x)``
    to ``hfun(x)``, and ``result`` is the numerical approximation.
    See `epsrel` below.
epsrel : float, optional
    Relative tolerance of the inner 1-D integrals. Default is 1.49e-8.
    If ``epsabs &lt;= 0``, `epsrel` must be greater than both 5e-29
    and ``50 * (machine epsilon)``. See `epsabs` above.

Returns
-------
y : float
    The resultant integral.
abserr : float
    An estimate of the error.

See Also
--------
quad : single integral
tplquad : triple integral
nquad : N-dimensional integrals
fixed_quad : fixed-order Gaussian quadrature
quadrature : adaptive Gaussian quadrature
odeint : ODE integrator
ode : ODE integrator
simpson : integrator for sampled data
romb : integrator for sampled data
scipy.special : for coefficients and roots of orthogonal polynomials


Notes
-----

**Details of QUADPACK level routines**

`quad` calls routines from the FORTRAN library QUADPACK. This section
provides details on the conditions for each routine to be called and a
short description of each routine. For each level of integration, ``qagse``
is used for finite limits or ``qagie`` is used if either limit (or both!)
are infinite. The following provides a short description from [1]_ for each
routine.

qagse
    is an integrator based on globally adaptive interval
    subdivision in connection with extrapolation, which will
    eliminate the effects of integrand singularities of
    several types.
qagie
    handles integration over infinite intervals. The infinite range is
    mapped onto a finite interval and subsequently the same strategy as
    in ``QAGS`` is applied.

References
----------

.. [1] Piessens, Robert; de Doncker-Kapenga, Elise;
       Überhuber, Christoph W.; Kahaner, David (1983).
       QUADPACK: A subroutine package for automatic integration.
       Springer-Verlag.
       ISBN 978-3-540-12553-2.

Examples
--------
Compute the double integral of ``x * y**2`` over the box
``x`` ranging from 0 to 2 and ``y`` ranging from 0 to 1.
That is, :math:`\\int^{x=2}_{x=0} \\int^{y=1}_{y=0} x y^2 \\,dy \\,dx`.

&gt;&gt;&gt; from scipy import integrate
&gt;&gt;&gt; f = lambda y, x: x*y**2
&gt;&gt;&gt; integrate.dblquad(f, 0, 2, 0, 1)
    (0.6666666666666667, 7.401486830834377e-15)

Calculate :math:`\\int^{x=\\pi/4}_{x=0} \\int^{y=\\cos(x)}_{y=\\sin(x)} 1
\\,dy \\,dx`.

&gt;&gt;&gt; f = lambda y, x: 1
&gt;&gt;&gt; integrate.dblquad(f, 0, np.pi/4, np.sin, np.cos)
    (0.41421356237309503, 1.1083280054755938e-14)

Calculate :math:`\\int^{x=1}_{x=0} \\int^{y=x}_{y=2-x} a x y \\,dy \\,dx`
for :math:`a=1, 3`.

&gt;&gt;&gt; f = lambda y, x, a: a*x*y
&gt;&gt;&gt; integrate.dblquad(f, 0, 1, lambda x: x, lambda x: 2-x, args=(1,))
    (0.33333333333333337, 5.551115123125783e-15)
&gt;&gt;&gt; integrate.dblquad(f, 0, 1, lambda x: x, lambda x: 2-x, args=(3,))
    (0.9999999999999999, 1.6653345369377348e-14)</pre> <div class="fragment"><div class="line"><span class="lineno">  590</span><span class="keyword">def </span>dblquad(func, a, b, gfun, hfun, args=(), epsabs=1.49e-8, epsrel=1.49e-8):</div>
<div class="line"><span class="lineno">  591</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">    Compute a double integral.</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">    Return the double (definite) integral of ``func(y, x)`` from ``x = a..b``</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">    and ``y = gfun(x)..hfun(x)``.</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">    func : callable</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral">        A Python function or method of at least two variables: y must be the</span></div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral">        first argument and x the second argument.</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">    a, b : float</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">        The limits of integration in x: `a` &lt; `b`</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">    gfun : callable or float</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">        The lower boundary curve in y which is a function taking a single</span></div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral">        floating point argument (x) and returning a floating point result</span></div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">        or a float indicating a constant boundary curve.</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">    hfun : callable or float</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral">        The upper boundary curve in y (same requirements as `gfun`).</span></div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral">    args : sequence, optional</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">        Extra arguments to pass to `func`.</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral">    epsabs : float, optional</span></div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">        Absolute tolerance passed directly to the inner 1-D quadrature</span></div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral">        integration. Default is 1.49e-8. ``dblquad`` tries to obtain</span></div>
<div class="line"><span class="lineno">  615</span><span class="stringliteral">        an accuracy of ``abs(i-result) &lt;= max(epsabs, epsrel*abs(i))``</span></div>
<div class="line"><span class="lineno">  616</span><span class="stringliteral">        where ``i`` = inner integral of ``func(y, x)`` from ``gfun(x)``</span></div>
<div class="line"><span class="lineno">  617</span><span class="stringliteral">        to ``hfun(x)``, and ``result`` is the numerical approximation.</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">        See `epsrel` below.</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral">    epsrel : float, optional</span></div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral">        Relative tolerance of the inner 1-D integrals. Default is 1.49e-8.</span></div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral">        If ``epsabs &lt;= 0``, `epsrel` must be greater than both 5e-29</span></div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral">        and ``50 * (machine epsilon)``. See `epsabs` above.</span></div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">    y : float</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">        The resultant integral.</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">    abserr : float</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral">        An estimate of the error.</span></div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  633</span><span class="stringliteral">    quad : single integral</span></div>
<div class="line"><span class="lineno">  634</span><span class="stringliteral">    tplquad : triple integral</span></div>
<div class="line"><span class="lineno">  635</span><span class="stringliteral">    nquad : N-dimensional integrals</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral">    fixed_quad : fixed-order Gaussian quadrature</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">    quadrature : adaptive Gaussian quadrature</span></div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral">    odeint : ODE integrator</span></div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral">    ode : ODE integrator</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">    simpson : integrator for sampled data</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">    romb : integrator for sampled data</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">    scipy.special : for coefficients and roots of orthogonal polynomials</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  648</span><span class="stringliteral">    **Details of QUADPACK level routines**</span></div>
<div class="line"><span class="lineno">  649</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  650</span><span class="stringliteral">    `quad` calls routines from the FORTRAN library QUADPACK. This section</span></div>
<div class="line"><span class="lineno">  651</span><span class="stringliteral">    provides details on the conditions for each routine to be called and a</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral">    short description of each routine. For each level of integration, ``qagse``</span></div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral">    is used for finite limits or ``qagie`` is used if either limit (or both!)</span></div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">    are infinite. The following provides a short description from [1]_ for each</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">    routine.</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">    qagse</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral">        is an integrator based on globally adaptive interval</span></div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">        subdivision in connection with extrapolation, which will</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">        eliminate the effects of integrand singularities of</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">        several types.</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">    qagie</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">        handles integration over infinite intervals. The infinite range is</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">        mapped onto a finite interval and subsequently the same strategy as</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">        in ``QAGS`` is applied.</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral">    .. [1] Piessens, Robert; de Doncker-Kapenga, Elise;</span></div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">           Überhuber, Christoph W.; Kahaner, David (1983).</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">           QUADPACK: A subroutine package for automatic integration.</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">           Springer-Verlag.</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">           ISBN 978-3-540-12553-2.</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">    Compute the double integral of ``x * y**2`` over the box</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">    ``x`` ranging from 0 to 2 and ``y`` ranging from 0 to 1.</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral">    That is, :math:`\\int^{x=2}_{x=0} \\int^{y=1}_{y=0} x y^2 \\,dy \\,dx`.</span></div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import integrate</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">    &gt;&gt;&gt; f = lambda y, x: x*y**2</span></div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">    &gt;&gt;&gt; integrate.dblquad(f, 0, 2, 0, 1)</span></div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral">        (0.6666666666666667, 7.401486830834377e-15)</span></div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral">    Calculate :math:`\\int^{x=\\pi/4}_{x=0} \\int^{y=\\cos(x)}_{y=\\sin(x)} 1</span></div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral">    \\,dy \\,dx`.</span></div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral">    &gt;&gt;&gt; f = lambda y, x: 1</span></div>
<div class="line"><span class="lineno">  691</span><span class="stringliteral">    &gt;&gt;&gt; integrate.dblquad(f, 0, np.pi/4, np.sin, np.cos)</span></div>
<div class="line"><span class="lineno">  692</span><span class="stringliteral">        (0.41421356237309503, 1.1083280054755938e-14)</span></div>
<div class="line"><span class="lineno">  693</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  694</span><span class="stringliteral">    Calculate :math:`\\int^{x=1}_{x=0} \\int^{y=x}_{y=2-x} a x y \\,dy \\,dx`</span></div>
<div class="line"><span class="lineno">  695</span><span class="stringliteral">    for :math:`a=1, 3`.</span></div>
<div class="line"><span class="lineno">  696</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  697</span><span class="stringliteral">    &gt;&gt;&gt; f = lambda y, x, a: a*x*y</span></div>
<div class="line"><span class="lineno">  698</span><span class="stringliteral">    &gt;&gt;&gt; integrate.dblquad(f, 0, 1, lambda x: x, lambda x: 2-x, args=(1,))</span></div>
<div class="line"><span class="lineno">  699</span><span class="stringliteral">        (0.33333333333333337, 5.551115123125783e-15)</span></div>
<div class="line"><span class="lineno">  700</span><span class="stringliteral">    &gt;&gt;&gt; integrate.dblquad(f, 0, 1, lambda x: x, lambda x: 2-x, args=(3,))</span></div>
<div class="line"><span class="lineno">  701</span><span class="stringliteral">        (0.9999999999999999, 1.6653345369377348e-14)</span></div>
<div class="line"><span class="lineno">  702</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  703</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>    <span class="keyword">def </span>temp_ranges(*args):</div>
<div class="line"><span class="lineno">  706</span>        <span class="keywordflow">return</span> [gfun(args[0]) <span class="keywordflow">if</span> callable(gfun) <span class="keywordflow">else</span> gfun,</div>
<div class="line"><span class="lineno">  707</span>                hfun(args[0]) <span class="keywordflow">if</span> callable(hfun) <span class="keywordflow">else</span> hfun]</div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">return</span> nquad(func, [temp_ranges, [a, b]], args=args,</div>
<div class="line"><span class="lineno">  710</span>            opts={<span class="stringliteral">&quot;epsabs&quot;</span>: epsabs, <span class="stringliteral">&quot;epsrel&quot;</span>: epsrel})</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0dd9cae351d9ebe0189e4136618bc784" name="a0dd9cae351d9ebe0189e4136618bc784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd9cae351d9ebe0189e4136618bc784">&#9670;&#160;</a></span>nquad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quadpack_py.nquad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>opts</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Integration over multiple variables.

Wraps `quad` to enable integration over multiple variables.
Various options allow improved integration of discontinuous functions, as
well as the use of weighted integration, and generally finer control of the
integration process.

Parameters
----------
func : {callable, scipy.LowLevelCallable}
    The function to be integrated. Has arguments of ``x0, ... xn``,
    ``t0, ... tm``, where integration is carried out over ``x0, ... xn``,
    which must be floats.  Where ``t0, ... tm`` are extra arguments
    passed in args.
    Function signature should be ``func(x0, x1, ..., xn, t0, t1, ..., tm)``.
    Integration is carried out in order.  That is, integration over ``x0``
    is the innermost integral, and ``xn`` is the outermost.

    If the user desires improved integration performance, then `f` may
    be a `scipy.LowLevelCallable` with one of the signatures::

        double func(int n, double *xx)
        double func(int n, double *xx, void *user_data)

    where ``n`` is the number of variables and args.  The ``xx`` array
    contains the coordinates and extra arguments. ``user_data`` is the data
    contained in the `scipy.LowLevelCallable`.
ranges : iterable object
    Each element of ranges may be either a sequence  of 2 numbers, or else
    a callable that returns such a sequence. ``ranges[0]`` corresponds to
    integration over x0, and so on. If an element of ranges is a callable,
    then it will be called with all of the integration arguments available,
    as well as any parametric arguments. e.g., if
    ``func = f(x0, x1, x2, t0, t1)``, then ``ranges[0]`` may be defined as
    either ``(a, b)`` or else as ``(a, b) = range0(x1, x2, t0, t1)``.
args : iterable object, optional
    Additional arguments ``t0, ... tn``, required by ``func``, ``ranges``,
    and ``opts``.
opts : iterable object or dict, optional
    Options to be passed to `quad`. May be empty, a dict, or
    a sequence of dicts or functions that return a dict. If empty, the
    default options from scipy.integrate.quad are used. If a dict, the same
    options are used for all levels of integraion. If a sequence, then each
    element of the sequence corresponds to a particular integration. e.g.,
    ``opts[0]`` corresponds to integration over ``x0``, and so on. If a
    callable, the signature must be the same as for ``ranges``. The
    available options together with their default values are:

      - epsabs = 1.49e-08
      - epsrel = 1.49e-08
      - limit  = 50
      - points = None
      - weight = None
      - wvar   = None
      - wopts  = None

    For more information on these options, see `quad`.

full_output : bool, optional
    Partial implementation of ``full_output`` from scipy.integrate.quad.
    The number of integrand function evaluations ``neval`` can be obtained
    by setting ``full_output=True`` when calling nquad.

Returns
-------
result : float
    The result of the integration.
abserr : float
    The maximum of the estimates of the absolute error in the various
    integration results.
out_dict : dict, optional
    A dict containing additional information on the integration.

See Also
--------
quad : 1-D numerical integration
dblquad, tplquad : double and triple integrals
fixed_quad : fixed-order Gaussian quadrature
quadrature : adaptive Gaussian quadrature

Notes
-----

**Details of QUADPACK level routines**

`nquad` calls routines from the FORTRAN library QUADPACK. This section
provides details on the conditions for each routine to be called and a
short description of each routine. The routine called depends on
`weight`, `points` and the integration limits `a` and `b`.

================  ==============  ==========  =====================
QUADPACK routine  `weight`        `points`    infinite bounds
================  ==============  ==========  =====================
qagse             None            No          No
qagie             None            No          Yes
qagpe             None            Yes         No
qawoe             'sin', 'cos'    No          No
qawfe             'sin', 'cos'    No          either `a` or `b`
qawse             'alg*'          No          No
qawce             'cauchy'        No          No
================  ==============  ==========  =====================

The following provides a short desciption from [1]_ for each
routine.

qagse
    is an integrator based on globally adaptive interval
    subdivision in connection with extrapolation, which will
    eliminate the effects of integrand singularities of
    several types.
qagie
    handles integration over infinite intervals. The infinite range is
    mapped onto a finite interval and subsequently the same strategy as
    in ``QAGS`` is applied.
qagpe
    serves the same purposes as QAGS, but also allows the
    user to provide explicit information about the location
    and type of trouble-spots i.e. the abscissae of internal
    singularities, discontinuities and other difficulties of
    the integrand function.
qawoe
    is an integrator for the evaluation of
    :math:`\int^b_a \cos(\omega x)f(x)dx` or
    :math:`\int^b_a \sin(\omega x)f(x)dx`
    over a finite interval [a,b], where :math:`\omega` and :math:`f`
    are specified by the user. The rule evaluation component is based
    on the modified Clenshaw-Curtis technique

    An adaptive subdivision scheme is used in connection
    with an extrapolation procedure, which is a modification
    of that in ``QAGS`` and allows the algorithm to deal with
    singularities in :math:`f(x)`.
qawfe
    calculates the Fourier transform
    :math:`\int^\infty_a \cos(\omega x)f(x)dx` or
    :math:`\int^\infty_a \sin(\omega x)f(x)dx`
    for user-provided :math:`\omega` and :math:`f`. The procedure of
    ``QAWO`` is applied on successive finite intervals, and convergence
    acceleration by means of the :math:`\varepsilon`-algorithm is applied
    to the series of integral approximations.
qawse
    approximate :math:`\int^b_a w(x)f(x)dx`, with :math:`a &lt; b` where
    :math:`w(x) = (x-a)^{\alpha}(b-x)^{\beta}v(x)` with
    :math:`\alpha,\beta &gt; -1`, where :math:`v(x)` may be one of the
    following functions: :math:`1`, :math:`\log(x-a)`, :math:`\log(b-x)`,
    :math:`\log(x-a)\log(b-x)`.

    The user specifies :math:`\alpha`, :math:`\beta` and the type of the
    function :math:`v`. A globally adaptive subdivision strategy is
    applied, with modified Clenshaw-Curtis integration on those
    subintervals which contain `a` or `b`.
qawce
    compute :math:`\int^b_a f(x) / (x-c)dx` where the integral must be
    interpreted as a Cauchy principal value integral, for user specified
    :math:`c` and :math:`f`. The strategy is globally adaptive. Modified
    Clenshaw-Curtis integration is used on those intervals containing the
    point :math:`x = c`.

References
----------

.. [1] Piessens, Robert; de Doncker-Kapenga, Elise;
       Überhuber, Christoph W.; Kahaner, David (1983).
       QUADPACK: A subroutine package for automatic integration.
       Springer-Verlag.
       ISBN 978-3-540-12553-2.

Examples
--------
Calculate

.. math::

    \int^{1}_{-0.15} \int^{0.8}_{0.13} \int^{1}_{-1} \int^{1}_{0}
    f(x_0, x_1, x_2, x_3) \,dx_0 \,dx_1 \,dx_2 \,dx_3 ,

where

.. math::

    f(x_0, x_1, x_2, x_3) = \begin{cases}
      x_0^2+x_1 x_2-x_3^3+ \sin{x_0}+1 &amp; (x_0-0.2 x_3-0.5-0.25 x_1 &gt; 0) \\
      x_0^2+x_1 x_2-x_3^3+ \sin{x_0}+0 &amp; (x_0-0.2 x_3-0.5-0.25 x_1 \leq 0)
    \end{cases} .

&gt;&gt;&gt; from scipy import integrate
&gt;&gt;&gt; func = lambda x0,x1,x2,x3 : x0**2 + x1*x2 - x3**3 + np.sin(x0) + (
...                                 1 if (x0-.2*x3-.5-.25*x1&gt;0) else 0)
&gt;&gt;&gt; def opts0(*args, **kwargs):
...     return {'points':[0.2*args[2] + 0.5 + 0.25*args[0]]}
&gt;&gt;&gt; integrate.nquad(func, [[0,1], [-1,1], [.13,.8], [-.15,1]],
...                 opts=[opts0,{},{},{}], full_output=True)
(1.5267454070738633, 2.9437360001402324e-14, {'neval': 388962})

Calculate

.. math::

    \int^{t_0+t_1+1}_{t_0+t_1-1}
    \int^{x_2+t_0^2 t_1^3+1}_{x_2+t_0^2 t_1^3-1}
    \int^{t_0 x_1+t_1 x_2+1}_{t_0 x_1+t_1 x_2-1}
    f(x_0,x_1, x_2,t_0,t_1)
    \,dx_0 \,dx_1 \,dx_2,

where

.. math::

    f(x_0, x_1, x_2, t_0, t_1) = \begin{cases}
      x_0 x_2^2 + \sin{x_1}+2 &amp; (x_0+t_1 x_1-t_0 &gt; 0) \\
      x_0 x_2^2 +\sin{x_1}+1 &amp; (x_0+t_1 x_1-t_0 \leq 0)
    \end{cases}

and :math:`(t_0, t_1) = (0, 1)` .

&gt;&gt;&gt; def func2(x0, x1, x2, t0, t1):
...     return x0*x2**2 + np.sin(x1) + 1 + (1 if x0+t1*x1-t0&gt;0 else 0)
&gt;&gt;&gt; def lim0(x1, x2, t0, t1):
...     return [t0*x1 + t1*x2 - 1, t0*x1 + t1*x2 + 1]
&gt;&gt;&gt; def lim1(x2, t0, t1):
...     return [x2 + t0**2*t1**3 - 1, x2 + t0**2*t1**3 + 1]
&gt;&gt;&gt; def lim2(t0, t1):
...     return [t0 + t1 - 1, t0 + t1 + 1]
&gt;&gt;&gt; def opts0(x1, x2, t0, t1):
...     return {'points' : [t0 - t1*x1]}
&gt;&gt;&gt; def opts1(x2, t0, t1):
...     return {}
&gt;&gt;&gt; def opts2(t0, t1):
...     return {}
&gt;&gt;&gt; integrate.nquad(func2, [lim0, lim1, lim2], args=(0,1),
...                 opts=[opts0, opts1, opts2])
(36.099919226771625, 1.8546948553373528e-07)</pre> <div class="fragment"><div class="line"><span class="lineno">  850</span><span class="keyword">def </span>nquad(func, ranges, args=None, opts=None, full_output=False):</div>
<div class="line"><span class="lineno">  851</span>    <span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  852</span><span class="stringliteral">    Integration over multiple variables.</span></div>
<div class="line"><span class="lineno">  853</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  854</span><span class="stringliteral">    Wraps `quad` to enable integration over multiple variables.</span></div>
<div class="line"><span class="lineno">  855</span><span class="stringliteral">    Various options allow improved integration of discontinuous functions, as</span></div>
<div class="line"><span class="lineno">  856</span><span class="stringliteral">    well as the use of weighted integration, and generally finer control of the</span></div>
<div class="line"><span class="lineno">  857</span><span class="stringliteral">    integration process.</span></div>
<div class="line"><span class="lineno">  858</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  859</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  860</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  861</span><span class="stringliteral">    func : {callable, scipy.LowLevelCallable}</span></div>
<div class="line"><span class="lineno">  862</span><span class="stringliteral">        The function to be integrated. Has arguments of ``x0, ... xn``,</span></div>
<div class="line"><span class="lineno">  863</span><span class="stringliteral">        ``t0, ... tm``, where integration is carried out over ``x0, ... xn``,</span></div>
<div class="line"><span class="lineno">  864</span><span class="stringliteral">        which must be floats.  Where ``t0, ... tm`` are extra arguments</span></div>
<div class="line"><span class="lineno">  865</span><span class="stringliteral">        passed in args.</span></div>
<div class="line"><span class="lineno">  866</span><span class="stringliteral">        Function signature should be ``func(x0, x1, ..., xn, t0, t1, ..., tm)``.</span></div>
<div class="line"><span class="lineno">  867</span><span class="stringliteral">        Integration is carried out in order.  That is, integration over ``x0``</span></div>
<div class="line"><span class="lineno">  868</span><span class="stringliteral">        is the innermost integral, and ``xn`` is the outermost.</span></div>
<div class="line"><span class="lineno">  869</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  870</span><span class="stringliteral">        If the user desires improved integration performance, then `f` may</span></div>
<div class="line"><span class="lineno">  871</span><span class="stringliteral">        be a `scipy.LowLevelCallable` with one of the signatures::</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  873</span><span class="stringliteral">            double func(int n, double *xx)</span></div>
<div class="line"><span class="lineno">  874</span><span class="stringliteral">            double func(int n, double *xx, void *user_data)</span></div>
<div class="line"><span class="lineno">  875</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  876</span><span class="stringliteral">        where ``n`` is the number of variables and args.  The ``xx`` array</span></div>
<div class="line"><span class="lineno">  877</span><span class="stringliteral">        contains the coordinates and extra arguments. ``user_data`` is the data</span></div>
<div class="line"><span class="lineno">  878</span><span class="stringliteral">        contained in the `scipy.LowLevelCallable`.</span></div>
<div class="line"><span class="lineno">  879</span><span class="stringliteral">    ranges : iterable object</span></div>
<div class="line"><span class="lineno">  880</span><span class="stringliteral">        Each element of ranges may be either a sequence  of 2 numbers, or else</span></div>
<div class="line"><span class="lineno">  881</span><span class="stringliteral">        a callable that returns such a sequence. ``ranges[0]`` corresponds to</span></div>
<div class="line"><span class="lineno">  882</span><span class="stringliteral">        integration over x0, and so on. If an element of ranges is a callable,</span></div>
<div class="line"><span class="lineno">  883</span><span class="stringliteral">        then it will be called with all of the integration arguments available,</span></div>
<div class="line"><span class="lineno">  884</span><span class="stringliteral">        as well as any parametric arguments. e.g., if</span></div>
<div class="line"><span class="lineno">  885</span><span class="stringliteral">        ``func = f(x0, x1, x2, t0, t1)``, then ``ranges[0]`` may be defined as</span></div>
<div class="line"><span class="lineno">  886</span><span class="stringliteral">        either ``(a, b)`` or else as ``(a, b) = range0(x1, x2, t0, t1)``.</span></div>
<div class="line"><span class="lineno">  887</span><span class="stringliteral">    args : iterable object, optional</span></div>
<div class="line"><span class="lineno">  888</span><span class="stringliteral">        Additional arguments ``t0, ... tn``, required by ``func``, ``ranges``,</span></div>
<div class="line"><span class="lineno">  889</span><span class="stringliteral">        and ``opts``.</span></div>
<div class="line"><span class="lineno">  890</span><span class="stringliteral">    opts : iterable object or dict, optional</span></div>
<div class="line"><span class="lineno">  891</span><span class="stringliteral">        Options to be passed to `quad`. May be empty, a dict, or</span></div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral">        a sequence of dicts or functions that return a dict. If empty, the</span></div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">        default options from scipy.integrate.quad are used. If a dict, the same</span></div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral">        options are used for all levels of integraion. If a sequence, then each</span></div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">        element of the sequence corresponds to a particular integration. e.g.,</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral">        ``opts[0]`` corresponds to integration over ``x0``, and so on. If a</span></div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">        callable, the signature must be the same as for ``ranges``. The</span></div>
<div class="line"><span class="lineno">  898</span><span class="stringliteral">        available options together with their default values are:</span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral">          - epsabs = 1.49e-08</span></div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">          - epsrel = 1.49e-08</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">          - limit  = 50</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral">          - points = None</span></div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">          - weight = None</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral">          - wvar   = None</span></div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">          - wopts  = None</span></div>
<div class="line"><span class="lineno">  907</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  908</span><span class="stringliteral">        For more information on these options, see `quad`.</span></div>
<div class="line"><span class="lineno">  909</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  910</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno">  911</span><span class="stringliteral">        Partial implementation of ``full_output`` from scipy.integrate.quad.</span></div>
<div class="line"><span class="lineno">  912</span><span class="stringliteral">        The number of integrand function evaluations ``neval`` can be obtained</span></div>
<div class="line"><span class="lineno">  913</span><span class="stringliteral">        by setting ``full_output=True`` when calling nquad.</span></div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  915</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  916</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  917</span><span class="stringliteral">    result : float</span></div>
<div class="line"><span class="lineno">  918</span><span class="stringliteral">        The result of the integration.</span></div>
<div class="line"><span class="lineno">  919</span><span class="stringliteral">    abserr : float</span></div>
<div class="line"><span class="lineno">  920</span><span class="stringliteral">        The maximum of the estimates of the absolute error in the various</span></div>
<div class="line"><span class="lineno">  921</span><span class="stringliteral">        integration results.</span></div>
<div class="line"><span class="lineno">  922</span><span class="stringliteral">    out_dict : dict, optional</span></div>
<div class="line"><span class="lineno">  923</span><span class="stringliteral">        A dict containing additional information on the integration.</span></div>
<div class="line"><span class="lineno">  924</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">    quad : 1-D numerical integration</span></div>
<div class="line"><span class="lineno">  928</span><span class="stringliteral">    dblquad, tplquad : double and triple integrals</span></div>
<div class="line"><span class="lineno">  929</span><span class="stringliteral">    fixed_quad : fixed-order Gaussian quadrature</span></div>
<div class="line"><span class="lineno">  930</span><span class="stringliteral">    quadrature : adaptive Gaussian quadrature</span></div>
<div class="line"><span class="lineno">  931</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  932</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  933</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  934</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral">    **Details of QUADPACK level routines**</span></div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">    `nquad` calls routines from the FORTRAN library QUADPACK. This section</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral">    provides details on the conditions for each routine to be called and a</span></div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">    short description of each routine. The routine called depends on</span></div>
<div class="line"><span class="lineno">  940</span><span class="stringliteral">    `weight`, `points` and the integration limits `a` and `b`.</span></div>
<div class="line"><span class="lineno">  941</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  942</span><span class="stringliteral">    ================  ==============  ==========  =====================</span></div>
<div class="line"><span class="lineno">  943</span><span class="stringliteral">    QUADPACK routine  `weight`        `points`    infinite bounds</span></div>
<div class="line"><span class="lineno">  944</span><span class="stringliteral">    ================  ==============  ==========  =====================</span></div>
<div class="line"><span class="lineno">  945</span><span class="stringliteral">    qagse             None            No          No</span></div>
<div class="line"><span class="lineno">  946</span><span class="stringliteral">    qagie             None            No          Yes</span></div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral">    qagpe             None            Yes         No</span></div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral">    qawoe             &#39;sin&#39;, &#39;cos&#39;    No          No</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">    qawfe             &#39;sin&#39;, &#39;cos&#39;    No          either `a` or `b`</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">    qawse             &#39;alg*&#39;          No          No</span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    qawce             &#39;cauchy&#39;        No          No</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">    ================  ==============  ==========  =====================</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">    The following provides a short desciption from [1]_ for each</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">    routine.</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">    qagse</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">        is an integrator based on globally adaptive interval</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral">        subdivision in connection with extrapolation, which will</span></div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">        eliminate the effects of integrand singularities of</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">        several types.</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">    qagie</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">        handles integration over infinite intervals. The infinite range is</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral">        mapped onto a finite interval and subsequently the same strategy as</span></div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral">        in ``QAGS`` is applied.</span></div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">    qagpe</span></div>
<div class="line"><span class="lineno">  967</span><span class="stringliteral">        serves the same purposes as QAGS, but also allows the</span></div>
<div class="line"><span class="lineno">  968</span><span class="stringliteral">        user to provide explicit information about the location</span></div>
<div class="line"><span class="lineno">  969</span><span class="stringliteral">        and type of trouble-spots i.e. the abscissae of internal</span></div>
<div class="line"><span class="lineno">  970</span><span class="stringliteral">        singularities, discontinuities and other difficulties of</span></div>
<div class="line"><span class="lineno">  971</span><span class="stringliteral">        the integrand function.</span></div>
<div class="line"><span class="lineno">  972</span><span class="stringliteral">    qawoe</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">        is an integrator for the evaluation of</span></div>
<div class="line"><span class="lineno">  974</span><span class="stringliteral">        :math:`\int^b_a \cos(\omega x)f(x)dx` or</span></div>
<div class="line"><span class="lineno">  975</span><span class="stringliteral">        :math:`\int^b_a \sin(\omega x)f(x)dx`</span></div>
<div class="line"><span class="lineno">  976</span><span class="stringliteral">        over a finite interval [a,b], where :math:`\omega` and :math:`f`</span></div>
<div class="line"><span class="lineno">  977</span><span class="stringliteral">        are specified by the user. The rule evaluation component is based</span></div>
<div class="line"><span class="lineno">  978</span><span class="stringliteral">        on the modified Clenshaw-Curtis technique</span></div>
<div class="line"><span class="lineno">  979</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  980</span><span class="stringliteral">        An adaptive subdivision scheme is used in connection</span></div>
<div class="line"><span class="lineno">  981</span><span class="stringliteral">        with an extrapolation procedure, which is a modification</span></div>
<div class="line"><span class="lineno">  982</span><span class="stringliteral">        of that in ``QAGS`` and allows the algorithm to deal with</span></div>
<div class="line"><span class="lineno">  983</span><span class="stringliteral">        singularities in :math:`f(x)`.</span></div>
<div class="line"><span class="lineno">  984</span><span class="stringliteral">    qawfe</span></div>
<div class="line"><span class="lineno">  985</span><span class="stringliteral">        calculates the Fourier transform</span></div>
<div class="line"><span class="lineno">  986</span><span class="stringliteral">        :math:`\int^\infty_a \cos(\omega x)f(x)dx` or</span></div>
<div class="line"><span class="lineno">  987</span><span class="stringliteral">        :math:`\int^\infty_a \sin(\omega x)f(x)dx`</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">        for user-provided :math:`\omega` and :math:`f`. The procedure of</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral">        ``QAWO`` is applied on successive finite intervals, and convergence</span></div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">        acceleration by means of the :math:`\varepsilon`-algorithm is applied</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral">        to the series of integral approximations.</span></div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">    qawse</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">        approximate :math:`\int^b_a w(x)f(x)dx`, with :math:`a &lt; b` where</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral">        :math:`w(x) = (x-a)^{\alpha}(b-x)^{\beta}v(x)` with</span></div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral">        :math:`\alpha,\beta &gt; -1`, where :math:`v(x)` may be one of the</span></div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">        following functions: :math:`1`, :math:`\log(x-a)`, :math:`\log(b-x)`,</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral">        :math:`\log(x-a)\log(b-x)`.</span></div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">        The user specifies :math:`\alpha`, :math:`\beta` and the type of the</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">        function :math:`v`. A globally adaptive subdivision strategy is</span></div>
<div class="line"><span class="lineno"> 1001</span><span class="stringliteral">        applied, with modified Clenshaw-Curtis integration on those</span></div>
<div class="line"><span class="lineno"> 1002</span><span class="stringliteral">        subintervals which contain `a` or `b`.</span></div>
<div class="line"><span class="lineno"> 1003</span><span class="stringliteral">    qawce</span></div>
<div class="line"><span class="lineno"> 1004</span><span class="stringliteral">        compute :math:`\int^b_a f(x) / (x-c)dx` where the integral must be</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="stringliteral">        interpreted as a Cauchy principal value integral, for user specified</span></div>
<div class="line"><span class="lineno"> 1006</span><span class="stringliteral">        :math:`c` and :math:`f`. The strategy is globally adaptive. Modified</span></div>
<div class="line"><span class="lineno"> 1007</span><span class="stringliteral">        Clenshaw-Curtis integration is used on those intervals containing the</span></div>
<div class="line"><span class="lineno"> 1008</span><span class="stringliteral">        point :math:`x = c`.</span></div>
<div class="line"><span class="lineno"> 1009</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1010</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1013</span><span class="stringliteral">    .. [1] Piessens, Robert; de Doncker-Kapenga, Elise;</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">           Überhuber, Christoph W.; Kahaner, David (1983).</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="stringliteral">           QUADPACK: A subroutine package for automatic integration.</span></div>
<div class="line"><span class="lineno"> 1016</span><span class="stringliteral">           Springer-Verlag.</span></div>
<div class="line"><span class="lineno"> 1017</span><span class="stringliteral">           ISBN 978-3-540-12553-2.</span></div>
<div class="line"><span class="lineno"> 1018</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1019</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="stringliteral">    Calculate</span></div>
<div class="line"><span class="lineno"> 1022</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1023</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1025</span><span class="stringliteral">        \int^{1}_{-0.15} \int^{0.8}_{0.13} \int^{1}_{-1} \int^{1}_{0}</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="stringliteral">        f(x_0, x_1, x_2, x_3) \,dx_0 \,dx_1 \,dx_2 \,dx_3 ,</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1028</span><span class="stringliteral">    where</span></div>
<div class="line"><span class="lineno"> 1029</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1030</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno"> 1031</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1032</span><span class="stringliteral">        f(x_0, x_1, x_2, x_3) = \begin{cases}</span></div>
<div class="line"><span class="lineno"> 1033</span><span class="stringliteral">          x_0^2+x_1 x_2-x_3^3+ \sin{x_0}+1 &amp; (x_0-0.2 x_3-0.5-0.25 x_1 &gt; 0) \\</span></div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral">          x_0^2+x_1 x_2-x_3^3+ \sin{x_0}+0 &amp; (x_0-0.2 x_3-0.5-0.25 x_1 \leq 0)</span></div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral">        \end{cases} .</span></div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import integrate</span></div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">    &gt;&gt;&gt; func = lambda x0,x1,x2,x3 : x0**2 + x1*x2 - x3**3 + np.sin(x0) + (</span></div>
<div class="line"><span class="lineno"> 1039</span><span class="stringliteral">    ...                                 1 if (x0-.2*x3-.5-.25*x1&gt;0) else 0)</span></div>
<div class="line"><span class="lineno"> 1040</span><span class="stringliteral">    &gt;&gt;&gt; def opts0(*args, **kwargs):</span></div>
<div class="line"><span class="lineno"> 1041</span><span class="stringliteral">    ...     return {&#39;points&#39;:[0.2*args[2] + 0.5 + 0.25*args[0]]}</span></div>
<div class="line"><span class="lineno"> 1042</span><span class="stringliteral">    &gt;&gt;&gt; integrate.nquad(func, [[0,1], [-1,1], [.13,.8], [-.15,1]],</span></div>
<div class="line"><span class="lineno"> 1043</span><span class="stringliteral">    ...                 opts=[opts0,{},{},{}], full_output=True)</span></div>
<div class="line"><span class="lineno"> 1044</span><span class="stringliteral">    (1.5267454070738633, 2.9437360001402324e-14, {&#39;neval&#39;: 388962})</span></div>
<div class="line"><span class="lineno"> 1045</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1046</span><span class="stringliteral">    Calculate</span></div>
<div class="line"><span class="lineno"> 1047</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1048</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1050</span><span class="stringliteral">        \int^{t_0+t_1+1}_{t_0+t_1-1}</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="stringliteral">        \int^{x_2+t_0^2 t_1^3+1}_{x_2+t_0^2 t_1^3-1}</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="stringliteral">        \int^{t_0 x_1+t_1 x_2+1}_{t_0 x_1+t_1 x_2-1}</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="stringliteral">        f(x_0,x_1, x_2,t_0,t_1)</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="stringliteral">        \,dx_0 \,dx_1 \,dx_2,</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">    where</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1058</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1060</span><span class="stringliteral">        f(x_0, x_1, x_2, t_0, t_1) = \begin{cases}</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="stringliteral">          x_0 x_2^2 + \sin{x_1}+2 &amp; (x_0+t_1 x_1-t_0 &gt; 0) \\</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="stringliteral">          x_0 x_2^2 +\sin{x_1}+1 &amp; (x_0+t_1 x_1-t_0 \leq 0)</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="stringliteral">        \end{cases}</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1065</span><span class="stringliteral">    and :math:`(t_0, t_1) = (0, 1)` .</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1067</span><span class="stringliteral">    &gt;&gt;&gt; def func2(x0, x1, x2, t0, t1):</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="stringliteral">    ...     return x0*x2**2 + np.sin(x1) + 1 + (1 if x0+t1*x1-t0&gt;0 else 0)</span></div>
<div class="line"><span class="lineno"> 1069</span><span class="stringliteral">    &gt;&gt;&gt; def lim0(x1, x2, t0, t1):</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="stringliteral">    ...     return [t0*x1 + t1*x2 - 1, t0*x1 + t1*x2 + 1]</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="stringliteral">    &gt;&gt;&gt; def lim1(x2, t0, t1):</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="stringliteral">    ...     return [x2 + t0**2*t1**3 - 1, x2 + t0**2*t1**3 + 1]</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="stringliteral">    &gt;&gt;&gt; def lim2(t0, t1):</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="stringliteral">    ...     return [t0 + t1 - 1, t0 + t1 + 1]</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="stringliteral">    &gt;&gt;&gt; def opts0(x1, x2, t0, t1):</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="stringliteral">    ...     return {&#39;points&#39; : [t0 - t1*x1]}</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral">    &gt;&gt;&gt; def opts1(x2, t0, t1):</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">    ...     return {}</span></div>
<div class="line"><span class="lineno"> 1079</span><span class="stringliteral">    &gt;&gt;&gt; def opts2(t0, t1):</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="stringliteral">    ...     return {}</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="stringliteral">    &gt;&gt;&gt; integrate.nquad(func2, [lim0, lim1, lim2], args=(0,1),</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="stringliteral">    ...                 opts=[opts0, opts1, opts2])</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="stringliteral">    (36.099919226771625, 1.8546948553373528e-07)</span></div>
<div class="line"><span class="lineno"> 1084</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1085</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1086</span>    depth = len(ranges)</div>
<div class="line"><span class="lineno"> 1087</span>    ranges = [rng <span class="keywordflow">if</span> callable(rng) <span class="keywordflow">else</span> _RangeFunc(rng) <span class="keywordflow">for</span> rng <span class="keywordflow">in</span> ranges]</div>
<div class="line"><span class="lineno"> 1088</span>    <span class="keywordflow">if</span> args <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1089</span>        args = ()</div>
<div class="line"><span class="lineno"> 1090</span>    <span class="keywordflow">if</span> opts <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1091</span>        opts = [dict([])] * depth</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    <span class="keywordflow">if</span> isinstance(opts, dict):</div>
<div class="line"><span class="lineno"> 1094</span>        opts = [_OptFunc(opts)] * depth</div>
<div class="line"><span class="lineno"> 1095</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1096</span>        opts = [opt <span class="keywordflow">if</span> callable(opt) <span class="keywordflow">else</span> _OptFunc(opt) <span class="keywordflow">for</span> opt <span class="keywordflow">in</span> opts]</div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keywordflow">return</span> _NQuad(func, ranges, opts, full_output).integrate(*args)</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2de4d68c789f180f5ab7d02bca07af0" name="ae2de4d68c789f180f5ab7d02bca07af0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2de4d68c789f180f5ab7d02bca07af0">&#9670;&#160;</a></span>quad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quadpack_py.quad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsabs</em> = <code>1.49e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsrel</em> = <code>1.49e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>limit</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>weight</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wvar</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wopts</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxp1</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>limlst</em> = <code>50</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute a definite integral.

Integrate func from `a` to `b` (possibly infinite interval) using a
technique from the Fortran library QUADPACK.

Parameters
----------
func : {function, scipy.LowLevelCallable}
    A Python function or method to integrate. If `func` takes many
    arguments, it is integrated along the axis corresponding to the
    first argument.

    If the user desires improved integration performance, then `f` may
    be a `scipy.LowLevelCallable` with one of the signatures::

        double func(double x)
        double func(double x, void *user_data)
        double func(int n, double *xx)
        double func(int n, double *xx, void *user_data)

    The ``user_data`` is the data contained in the `scipy.LowLevelCallable`.
    In the call forms with ``xx``,  ``n`` is the length of the ``xx``
    array which contains ``xx[0] == x`` and the rest of the items are
    numbers contained in the ``args`` argument of quad.

    In addition, certain ctypes call signatures are supported for
    backward compatibility, but those should not be used in new code.
a : float
    Lower limit of integration (use -numpy.inf for -infinity).
b : float
    Upper limit of integration (use numpy.inf for +infinity).
args : tuple, optional
    Extra arguments to pass to `func`.
full_output : int, optional
    Non-zero to return a dictionary of integration information.
    If non-zero, warning messages are also suppressed and the
    message is appended to the output tuple.

Returns
-------
y : float
    The integral of func from `a` to `b`.
abserr : float
    An estimate of the absolute error in the result.
infodict : dict
    A dictionary containing additional information.
message
    A convergence message.
explain
    Appended only with 'cos' or 'sin' weighting and infinite
    integration limits, it contains an explanation of the codes in
    infodict['ierlst']

Other Parameters
----------------
epsabs : float or int, optional
    Absolute error tolerance. Default is 1.49e-8. `quad` tries to obtain
    an accuracy of ``abs(i-result) &lt;= max(epsabs, epsrel*abs(i))``
    where ``i`` = integral of `func` from `a` to `b`, and ``result`` is the
    numerical approximation. See `epsrel` below.
epsrel : float or int, optional
    Relative error tolerance. Default is 1.49e-8.
    If ``epsabs &lt;= 0``, `epsrel` must be greater than both 5e-29
    and ``50 * (machine epsilon)``. See `epsabs` above.
limit : float or int, optional
    An upper bound on the number of subintervals used in the adaptive
    algorithm.
points : (sequence of floats,ints), optional
    A sequence of break points in the bounded integration interval
    where local difficulties of the integrand may occur (e.g.,
    singularities, discontinuities). The sequence does not have
    to be sorted. Note that this option cannot be used in conjunction
    with ``weight``.
weight : float or int, optional
    String indicating weighting function. Full explanation for this
    and the remaining arguments can be found below.
wvar : optional
    Variables for use with weighting functions.
wopts : optional
    Optional input for reusing Chebyshev moments.
maxp1 : float or int, optional
    An upper bound on the number of Chebyshev moments.
limlst : int, optional
    Upper bound on the number of cycles (&gt;=3) for use with a sinusoidal
    weighting and an infinite end-point.

See Also
--------
dblquad : double integral
tplquad : triple integral
nquad : n-dimensional integrals (uses `quad` recursively)
fixed_quad : fixed-order Gaussian quadrature
quadrature : adaptive Gaussian quadrature
odeint : ODE integrator
ode : ODE integrator
simpson : integrator for sampled data
romb : integrator for sampled data
scipy.special : for coefficients and roots of orthogonal polynomials

Notes
-----

**Extra information for quad() inputs and outputs**

If full_output is non-zero, then the third output argument
(infodict) is a dictionary with entries as tabulated below. For
infinite limits, the range is transformed to (0,1) and the
optional outputs are given with respect to this transformed range.
Let M be the input argument limit and let K be infodict['last'].
The entries are:

'neval'
    The number of function evaluations.
'last'
    The number, K, of subintervals produced in the subdivision process.
'alist'
    A rank-1 array of length M, the first K elements of which are the
    left end points of the subintervals in the partition of the
    integration range.
'blist'
    A rank-1 array of length M, the first K elements of which are the
    right end points of the subintervals.
'rlist'
    A rank-1 array of length M, the first K elements of which are the
    integral approximations on the subintervals.
'elist'
    A rank-1 array of length M, the first K elements of which are the
    moduli of the absolute error estimates on the subintervals.
'iord'
    A rank-1 integer array of length M, the first L elements of
    which are pointers to the error estimates over the subintervals
    with ``L=K`` if ``K&lt;=M/2+2`` or ``L=M+1-K`` otherwise. Let I be the
    sequence ``infodict['iord']`` and let E be the sequence
    ``infodict['elist']``.  Then ``E[I[1]], ..., E[I[L]]`` forms a
    decreasing sequence.

If the input argument points is provided (i.e., it is not None),
the following additional outputs are placed in the output
dictionary. Assume the points sequence is of length P.

'pts'
    A rank-1 array of length P+2 containing the integration limits
    and the break points of the intervals in ascending order.
    This is an array giving the subintervals over which integration
    will occur.
'level'
    A rank-1 integer array of length M (=limit), containing the
    subdivision levels of the subintervals, i.e., if (aa,bb) is a
    subinterval of ``(pts[1], pts[2])`` where ``pts[0]`` and ``pts[2]``
    are adjacent elements of ``infodict['pts']``, then (aa,bb) has level l
    if ``|bb-aa| = |pts[2]-pts[1]| * 2**(-l)``.
'ndin'
    A rank-1 integer array of length P+2. After the first integration
    over the intervals (pts[1], pts[2]), the error estimates over some
    of the intervals may have been increased artificially in order to
    put their subdivision forward. This array has ones in slots
    corresponding to the subintervals for which this happens.

**Weighting the integrand**

The input variables, *weight* and *wvar*, are used to weight the
integrand by a select list of functions. Different integration
methods are used to compute the integral with these weighting
functions, and these do not support specifying break points. The
possible values of weight and the corresponding weighting functions are.

==========  ===================================   =====================
``weight``  Weight function used                  ``wvar``
==========  ===================================   =====================
'cos'       cos(w*x)                              wvar = w
'sin'       sin(w*x)                              wvar = w
'alg'       g(x) = ((x-a)**alpha)*((b-x)**beta)   wvar = (alpha, beta)
'alg-loga'  g(x)*log(x-a)                         wvar = (alpha, beta)
'alg-logb'  g(x)*log(b-x)                         wvar = (alpha, beta)
'alg-log'   g(x)*log(x-a)*log(b-x)                wvar = (alpha, beta)
'cauchy'    1/(x-c)                               wvar = c
==========  ===================================   =====================

wvar holds the parameter w, (alpha, beta), or c depending on the weight
selected. In these expressions, a and b are the integration limits.

For the 'cos' and 'sin' weighting, additional inputs and outputs are
available.

For finite integration limits, the integration is performed using a
Clenshaw-Curtis method which uses Chebyshev moments. For repeated
calculations, these moments are saved in the output dictionary:

'momcom'
    The maximum level of Chebyshev moments that have been computed,
    i.e., if ``M_c`` is ``infodict['momcom']`` then the moments have been
    computed for intervals of length ``|b-a| * 2**(-l)``,
    ``l=0,1,...,M_c``.
'nnlog'
    A rank-1 integer array of length M(=limit), containing the
    subdivision levels of the subintervals, i.e., an element of this
    array is equal to l if the corresponding subinterval is
    ``|b-a|* 2**(-l)``.
'chebmo'
    A rank-2 array of shape (25, maxp1) containing the computed
    Chebyshev moments. These can be passed on to an integration
    over the same interval by passing this array as the second
    element of the sequence wopts and passing infodict['momcom'] as
    the first element.

If one of the integration limits is infinite, then a Fourier integral is
computed (assuming w neq 0). If full_output is 1 and a numerical error
is encountered, besides the error message attached to the output tuple,
a dictionary is also appended to the output tuple which translates the
error codes in the array ``info['ierlst']`` to English messages. The
output information dictionary contains the following entries instead of
'last', 'alist', 'blist', 'rlist', and 'elist':

'lst'
    The number of subintervals needed for the integration (call it ``K_f``).
'rslst'
    A rank-1 array of length M_f=limlst, whose first ``K_f`` elements
    contain the integral contribution over the interval
    ``(a+(k-1)c, a+kc)`` where ``c = (2*floor(|w|) + 1) * pi / |w|``
    and ``k=1,2,...,K_f``.
'erlst'
    A rank-1 array of length ``M_f`` containing the error estimate
    corresponding to the interval in the same position in
    ``infodict['rslist']``.
'ierlst'
    A rank-1 integer array of length ``M_f`` containing an error flag
    corresponding to the interval in the same position in
    ``infodict['rslist']``.  See the explanation dictionary (last entry
    in the output tuple) for the meaning of the codes.


**Details of QUADPACK level routines**

`quad` calls routines from the FORTRAN library QUADPACK. This section
provides details on the conditions for each routine to be called and a
short description of each routine. The routine called depends on
`weight`, `points` and the integration limits `a` and `b`.

================  ==============  ==========  =====================
QUADPACK routine  `weight`        `points`    infinite bounds
================  ==============  ==========  =====================
qagse             None            No          No
qagie             None            No          Yes
qagpe             None            Yes         No
qawoe             'sin', 'cos'    No          No
qawfe             'sin', 'cos'    No          either `a` or `b`
qawse             'alg*'          No          No
qawce             'cauchy'        No          No
================  ==============  ==========  =====================

The following provides a short desciption from [1]_ for each
routine.

qagse
    is an integrator based on globally adaptive interval
    subdivision in connection with extrapolation, which will
    eliminate the effects of integrand singularities of
    several types.
qagie
    handles integration over infinite intervals. The infinite range is
    mapped onto a finite interval and subsequently the same strategy as
    in ``QAGS`` is applied.
qagpe
    serves the same purposes as QAGS, but also allows the
    user to provide explicit information about the location
    and type of trouble-spots i.e. the abscissae of internal
    singularities, discontinuities and other difficulties of
    the integrand function.
qawoe
    is an integrator for the evaluation of
    :math:`\\int^b_a \\cos(\\omega x)f(x)dx` or
    :math:`\\int^b_a \\sin(\\omega x)f(x)dx`
    over a finite interval [a,b], where :math:`\\omega` and :math:`f`
    are specified by the user. The rule evaluation component is based
    on the modified Clenshaw-Curtis technique

    An adaptive subdivision scheme is used in connection
    with an extrapolation procedure, which is a modification
    of that in ``QAGS`` and allows the algorithm to deal with
    singularities in :math:`f(x)`.
qawfe
    calculates the Fourier transform
    :math:`\\int^\\infty_a \\cos(\\omega x)f(x)dx` or
    :math:`\\int^\\infty_a \\sin(\\omega x)f(x)dx`
    for user-provided :math:`\\omega` and :math:`f`. The procedure of
    ``QAWO`` is applied on successive finite intervals, and convergence
    acceleration by means of the :math:`\\varepsilon`-algorithm is applied
    to the series of integral approximations.
qawse
    approximate :math:`\\int^b_a w(x)f(x)dx`, with :math:`a &lt; b` where
    :math:`w(x) = (x-a)^{\\alpha}(b-x)^{\\beta}v(x)` with
    :math:`\\alpha,\\beta &gt; -1`, where :math:`v(x)` may be one of the
    following functions: :math:`1`, :math:`\\log(x-a)`, :math:`\\log(b-x)`,
    :math:`\\log(x-a)\\log(b-x)`.

    The user specifies :math:`\\alpha`, :math:`\\beta` and the type of the
    function :math:`v`. A globally adaptive subdivision strategy is
    applied, with modified Clenshaw-Curtis integration on those
    subintervals which contain `a` or `b`.
qawce
    compute :math:`\\int^b_a f(x) / (x-c)dx` where the integral must be
    interpreted as a Cauchy principal value integral, for user specified
    :math:`c` and :math:`f`. The strategy is globally adaptive. Modified
    Clenshaw-Curtis integration is used on those intervals containing the
    point :math:`x = c`.

References
----------

.. [1] Piessens, Robert; de Doncker-Kapenga, Elise;
       Überhuber, Christoph W.; Kahaner, David (1983).
       QUADPACK: A subroutine package for automatic integration.
       Springer-Verlag.
       ISBN 978-3-540-12553-2.

Examples
--------
Calculate :math:`\\int^4_0 x^2 dx` and compare with an analytic result

&gt;&gt;&gt; from scipy import integrate
&gt;&gt;&gt; x2 = lambda x: x**2
&gt;&gt;&gt; integrate.quad(x2, 0, 4)
(21.333333333333332, 2.3684757858670003e-13)
&gt;&gt;&gt; print(4**3 / 3.)  # analytical result
21.3333333333

Calculate :math:`\\int^\\infty_0 e^{-x} dx`

&gt;&gt;&gt; invexp = lambda x: np.exp(-x)
&gt;&gt;&gt; integrate.quad(invexp, 0, np.inf)
(1.0, 5.842605999138044e-11)

Calculate :math:`\\int^1_0 a x \\,dx` for :math:`a = 1, 3`

&gt;&gt;&gt; f = lambda x, a: a*x
&gt;&gt;&gt; y, err = integrate.quad(f, 0, 1, args=(1,))
&gt;&gt;&gt; y
0.5
&gt;&gt;&gt; y, err = integrate.quad(f, 0, 1, args=(3,))
&gt;&gt;&gt; y
1.5

Calculate :math:`\\int^1_0 x^2 + y^2 dx` with ctypes, holding
y parameter as 1::

    testlib.c =&gt;
        double func(int n, double args[n]){
            return args[0]*args[0] + args[1]*args[1];}
    compile to library testlib.*

::

   from scipy import integrate
   import ctypes
   lib = ctypes.CDLL('/home/.../testlib.*') #use absolute path
   lib.func.restype = ctypes.c_double
   lib.func.argtypes = (ctypes.c_int,ctypes.c_double)
   integrate.quad(lib.func,0,1,(1))
   #(1.3333333333333333, 1.4802973661668752e-14)
   print((1.0**3/3.0 + 1.0) - (0.0**3/3.0 + 0.0)) #Analytic result
   # 1.3333333333333333

Be aware that pulse shapes and other sharp features as compared to the
size of the integration interval may not be integrated correctly using
this method. A simplified example of this limitation is integrating a
y-axis reflected step function with many zero values within the integrals
bounds.

&gt;&gt;&gt; y = lambda x: 1 if x&lt;=0 else 0
&gt;&gt;&gt; integrate.quad(y, -1, 1)
(1.0, 1.1102230246251565e-14)
&gt;&gt;&gt; integrate.quad(y, -1, 100)
(1.0000000002199108, 1.0189464580163188e-08)
&gt;&gt;&gt; integrate.quad(y, -1, 10000)
(0.0, 0.0)</pre> <div class="fragment"><div class="line"><span class="lineno">   25</span>         limlst=50):</div>
<div class="line"><span class="lineno">   26</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">    Compute a definite integral.</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">    Integrate func from `a` to `b` (possibly infinite interval) using a</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    technique from the Fortran library QUADPACK.</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">    func : {function, scipy.LowLevelCallable}</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">        A Python function or method to integrate. If `func` takes many</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">        arguments, it is integrated along the axis corresponding to the</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">        first argument.</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">        If the user desires improved integration performance, then `f` may</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">        be a `scipy.LowLevelCallable` with one of the signatures::</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">            double func(double x)</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">            double func(double x, void *user_data)</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">            double func(int n, double *xx)</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">            double func(int n, double *xx, void *user_data)</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">        The ``user_data`` is the data contained in the `scipy.LowLevelCallable`.</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">        In the call forms with ``xx``,  ``n`` is the length of the ``xx``</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">        array which contains ``xx[0] == x`` and the rest of the items are</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">        numbers contained in the ``args`` argument of quad.</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">        In addition, certain ctypes call signatures are supported for</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">        backward compatibility, but those should not be used in new code.</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">    a : float</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">        Lower limit of integration (use -numpy.inf for -infinity).</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    b : float</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">        Upper limit of integration (use numpy.inf for +infinity).</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">        Extra arguments to pass to `func`.</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">    full_output : int, optional</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">        Non-zero to return a dictionary of integration information.</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">        If non-zero, warning messages are also suppressed and the</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">        message is appended to the output tuple.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    y : float</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        The integral of func from `a` to `b`.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    abserr : float</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        An estimate of the absolute error in the result.</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    infodict : dict</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">        A dictionary containing additional information.</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">    message</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        A convergence message.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    explain</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        Appended only with &#39;cos&#39; or &#39;sin&#39; weighting and infinite</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">        integration limits, it contains an explanation of the codes in</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        infodict[&#39;ierlst&#39;]</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    Other Parameters</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    ----------------</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    epsabs : float or int, optional</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">        Absolute error tolerance. Default is 1.49e-8. `quad` tries to obtain</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">        an accuracy of ``abs(i-result) &lt;= max(epsabs, epsrel*abs(i))``</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        where ``i`` = integral of `func` from `a` to `b`, and ``result`` is the</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        numerical approximation. See `epsrel` below.</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">    epsrel : float or int, optional</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">        Relative error tolerance. Default is 1.49e-8.</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">        If ``epsabs &lt;= 0``, `epsrel` must be greater than both 5e-29</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">        and ``50 * (machine epsilon)``. See `epsabs` above.</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    limit : float or int, optional</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">        An upper bound on the number of subintervals used in the adaptive</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">        algorithm.</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    points : (sequence of floats,ints), optional</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">        A sequence of break points in the bounded integration interval</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">        where local difficulties of the integrand may occur (e.g.,</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">        singularities, discontinuities). The sequence does not have</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">        to be sorted. Note that this option cannot be used in conjunction</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">        with ``weight``.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">    weight : float or int, optional</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">        String indicating weighting function. Full explanation for this</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">        and the remaining arguments can be found below.</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    wvar : optional</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">        Variables for use with weighting functions.</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">    wopts : optional</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">        Optional input for reusing Chebyshev moments.</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    maxp1 : float or int, optional</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">        An upper bound on the number of Chebyshev moments.</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">    limlst : int, optional</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">        Upper bound on the number of cycles (&gt;=3) for use with a sinusoidal</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">        weighting and an infinite end-point.</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">    dblquad : double integral</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">    tplquad : triple integral</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">    nquad : n-dimensional integrals (uses `quad` recursively)</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">    fixed_quad : fixed-order Gaussian quadrature</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    quadrature : adaptive Gaussian quadrature</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    odeint : ODE integrator</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    ode : ODE integrator</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    simpson : integrator for sampled data</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    romb : integrator for sampled data</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    scipy.special : for coefficients and roots of orthogonal polynomials</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    **Extra information for quad() inputs and outputs**</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    If full_output is non-zero, then the third output argument</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">    (infodict) is a dictionary with entries as tabulated below. For</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    infinite limits, the range is transformed to (0,1) and the</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    optional outputs are given with respect to this transformed range.</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    Let M be the input argument limit and let K be infodict[&#39;last&#39;].</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    The entries are:</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    &#39;neval&#39;</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">        The number of function evaluations.</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    &#39;last&#39;</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">        The number, K, of subintervals produced in the subdivision process.</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">    &#39;alist&#39;</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">        A rank-1 array of length M, the first K elements of which are the</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        left end points of the subintervals in the partition of the</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">        integration range.</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    &#39;blist&#39;</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">        A rank-1 array of length M, the first K elements of which are the</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">        right end points of the subintervals.</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    &#39;rlist&#39;</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        A rank-1 array of length M, the first K elements of which are the</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">        integral approximations on the subintervals.</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    &#39;elist&#39;</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">        A rank-1 array of length M, the first K elements of which are the</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">        moduli of the absolute error estimates on the subintervals.</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">    &#39;iord&#39;</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">        A rank-1 integer array of length M, the first L elements of</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">        which are pointers to the error estimates over the subintervals</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">        with ``L=K`` if ``K&lt;=M/2+2`` or ``L=M+1-K`` otherwise. Let I be the</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">        sequence ``infodict[&#39;iord&#39;]`` and let E be the sequence</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">        ``infodict[&#39;elist&#39;]``.  Then ``E[I[1]], ..., E[I[L]]`` forms a</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">        decreasing sequence.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    If the input argument points is provided (i.e., it is not None),</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    the following additional outputs are placed in the output</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">    dictionary. Assume the points sequence is of length P.</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">    &#39;pts&#39;</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">        A rank-1 array of length P+2 containing the integration limits</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">        and the break points of the intervals in ascending order.</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">        This is an array giving the subintervals over which integration</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">        will occur.</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">    &#39;level&#39;</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">        A rank-1 integer array of length M (=limit), containing the</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">        subdivision levels of the subintervals, i.e., if (aa,bb) is a</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">        subinterval of ``(pts[1], pts[2])`` where ``pts[0]`` and ``pts[2]``</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">        are adjacent elements of ``infodict[&#39;pts&#39;]``, then (aa,bb) has level l</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">        if ``|bb-aa| = |pts[2]-pts[1]| * 2**(-l)``.</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">    &#39;ndin&#39;</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">        A rank-1 integer array of length P+2. After the first integration</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">        over the intervals (pts[1], pts[2]), the error estimates over some</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">        of the intervals may have been increased artificially in order to</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">        put their subdivision forward. This array has ones in slots</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">        corresponding to the subintervals for which this happens.</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">    **Weighting the integrand**</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    The input variables, *weight* and *wvar*, are used to weight the</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    integrand by a select list of functions. Different integration</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    methods are used to compute the integral with these weighting</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    functions, and these do not support specifying break points. The</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    possible values of weight and the corresponding weighting functions are.</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    ==========  ===================================   =====================</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    ``weight``  Weight function used                  ``wvar``</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    ==========  ===================================   =====================</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">    &#39;cos&#39;       cos(w*x)                              wvar = w</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    &#39;sin&#39;       sin(w*x)                              wvar = w</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    &#39;alg&#39;       g(x) = ((x-a)**alpha)*((b-x)**beta)   wvar = (alpha, beta)</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    &#39;alg-loga&#39;  g(x)*log(x-a)                         wvar = (alpha, beta)</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    &#39;alg-logb&#39;  g(x)*log(b-x)                         wvar = (alpha, beta)</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">    &#39;alg-log&#39;   g(x)*log(x-a)*log(b-x)                wvar = (alpha, beta)</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">    &#39;cauchy&#39;    1/(x-c)                               wvar = c</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">    ==========  ===================================   =====================</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    wvar holds the parameter w, (alpha, beta), or c depending on the weight</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    selected. In these expressions, a and b are the integration limits.</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">    For the &#39;cos&#39; and &#39;sin&#39; weighting, additional inputs and outputs are</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    available.</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    For finite integration limits, the integration is performed using a</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    Clenshaw-Curtis method which uses Chebyshev moments. For repeated</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    calculations, these moments are saved in the output dictionary:</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    &#39;momcom&#39;</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">        The maximum level of Chebyshev moments that have been computed,</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">        i.e., if ``M_c`` is ``infodict[&#39;momcom&#39;]`` then the moments have been</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">        computed for intervals of length ``|b-a| * 2**(-l)``,</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">        ``l=0,1,...,M_c``.</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    &#39;nnlog&#39;</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">        A rank-1 integer array of length M(=limit), containing the</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">        subdivision levels of the subintervals, i.e., an element of this</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">        array is equal to l if the corresponding subinterval is</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">        ``|b-a|* 2**(-l)``.</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">    &#39;chebmo&#39;</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">        A rank-2 array of shape (25, maxp1) containing the computed</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">        Chebyshev moments. These can be passed on to an integration</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">        over the same interval by passing this array as the second</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">        element of the sequence wopts and passing infodict[&#39;momcom&#39;] as</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">        the first element.</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    If one of the integration limits is infinite, then a Fourier integral is</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    computed (assuming w neq 0). If full_output is 1 and a numerical error</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">    is encountered, besides the error message attached to the output tuple,</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">    a dictionary is also appended to the output tuple which translates the</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">    error codes in the array ``info[&#39;ierlst&#39;]`` to English messages. The</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">    output information dictionary contains the following entries instead of</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">    &#39;last&#39;, &#39;alist&#39;, &#39;blist&#39;, &#39;rlist&#39;, and &#39;elist&#39;:</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral">    &#39;lst&#39;</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">        The number of subintervals needed for the integration (call it ``K_f``).</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">    &#39;rslst&#39;</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">        A rank-1 array of length M_f=limlst, whose first ``K_f`` elements</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">        contain the integral contribution over the interval</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">        ``(a+(k-1)c, a+kc)`` where ``c = (2*floor(|w|) + 1) * pi / |w|``</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">        and ``k=1,2,...,K_f``.</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    &#39;erlst&#39;</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">        A rank-1 array of length ``M_f`` containing the error estimate</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">        corresponding to the interval in the same position in</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">        ``infodict[&#39;rslist&#39;]``.</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    &#39;ierlst&#39;</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">        A rank-1 integer array of length ``M_f`` containing an error flag</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">        corresponding to the interval in the same position in</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">        ``infodict[&#39;rslist&#39;]``.  See the explanation dictionary (last entry</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">        in the output tuple) for the meaning of the codes.</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">    **Details of QUADPACK level routines**</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    `quad` calls routines from the FORTRAN library QUADPACK. This section</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    provides details on the conditions for each routine to be called and a</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">    short description of each routine. The routine called depends on</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">    `weight`, `points` and the integration limits `a` and `b`.</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    ================  ==============  ==========  =====================</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    QUADPACK routine  `weight`        `points`    infinite bounds</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    ================  ==============  ==========  =====================</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    qagse             None            No          No</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    qagie             None            No          Yes</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    qagpe             None            Yes         No</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">    qawoe             &#39;sin&#39;, &#39;cos&#39;    No          No</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    qawfe             &#39;sin&#39;, &#39;cos&#39;    No          either `a` or `b`</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    qawse             &#39;alg*&#39;          No          No</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    qawce             &#39;cauchy&#39;        No          No</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    ================  ==============  ==========  =====================</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">    The following provides a short desciption from [1]_ for each</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    routine.</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">    qagse</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">        is an integrator based on globally adaptive interval</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">        subdivision in connection with extrapolation, which will</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">        eliminate the effects of integrand singularities of</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">        several types.</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    qagie</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">        handles integration over infinite intervals. The infinite range is</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">        mapped onto a finite interval and subsequently the same strategy as</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">        in ``QAGS`` is applied.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">    qagpe</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">        serves the same purposes as QAGS, but also allows the</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">        user to provide explicit information about the location</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">        and type of trouble-spots i.e. the abscissae of internal</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">        singularities, discontinuities and other difficulties of</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">        the integrand function.</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">    qawoe</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">        is an integrator for the evaluation of</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">        :math:`\\int^b_a \\cos(\\omega x)f(x)dx` or</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">        :math:`\\int^b_a \\sin(\\omega x)f(x)dx`</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">        over a finite interval [a,b], where :math:`\\omega` and :math:`f`</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">        are specified by the user. The rule evaluation component is based</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">        on the modified Clenshaw-Curtis technique</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">        An adaptive subdivision scheme is used in connection</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        with an extrapolation procedure, which is a modification</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">        of that in ``QAGS`` and allows the algorithm to deal with</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">        singularities in :math:`f(x)`.</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">    qawfe</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">        calculates the Fourier transform</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">        :math:`\\int^\\infty_a \\cos(\\omega x)f(x)dx` or</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">        :math:`\\int^\\infty_a \\sin(\\omega x)f(x)dx`</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">        for user-provided :math:`\\omega` and :math:`f`. The procedure of</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">        ``QAWO`` is applied on successive finite intervals, and convergence</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">        acceleration by means of the :math:`\\varepsilon`-algorithm is applied</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">        to the series of integral approximations.</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">    qawse</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">        approximate :math:`\\int^b_a w(x)f(x)dx`, with :math:`a &lt; b` where</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">        :math:`w(x) = (x-a)^{\\alpha}(b-x)^{\\beta}v(x)` with</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">        :math:`\\alpha,\\beta &gt; -1`, where :math:`v(x)` may be one of the</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">        following functions: :math:`1`, :math:`\\log(x-a)`, :math:`\\log(b-x)`,</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">        :math:`\\log(x-a)\\log(b-x)`.</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">        The user specifies :math:`\\alpha`, :math:`\\beta` and the type of the</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">        function :math:`v`. A globally adaptive subdivision strategy is</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        applied, with modified Clenshaw-Curtis integration on those</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">        subintervals which contain `a` or `b`.</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">    qawce</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        compute :math:`\\int^b_a f(x) / (x-c)dx` where the integral must be</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">        interpreted as a Cauchy principal value integral, for user specified</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">        :math:`c` and :math:`f`. The strategy is globally adaptive. Modified</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">        Clenshaw-Curtis integration is used on those intervals containing the</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">        point :math:`x = c`.</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    .. [1] Piessens, Robert; de Doncker-Kapenga, Elise;</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">           Überhuber, Christoph W.; Kahaner, David (1983).</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">           QUADPACK: A subroutine package for automatic integration.</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">           Springer-Verlag.</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">           ISBN 978-3-540-12553-2.</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    Calculate :math:`\\int^4_0 x^2 dx` and compare with an analytic result</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import integrate</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">    &gt;&gt;&gt; x2 = lambda x: x**2</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">    &gt;&gt;&gt; integrate.quad(x2, 0, 4)</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    (21.333333333333332, 2.3684757858670003e-13)</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">    &gt;&gt;&gt; print(4**3 / 3.)  # analytical result</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    21.3333333333</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    Calculate :math:`\\int^\\infty_0 e^{-x} dx`</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    &gt;&gt;&gt; invexp = lambda x: np.exp(-x)</span></div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">    &gt;&gt;&gt; integrate.quad(invexp, 0, np.inf)</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">    (1.0, 5.842605999138044e-11)</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    Calculate :math:`\\int^1_0 a x \\,dx` for :math:`a = 1, 3`</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">    &gt;&gt;&gt; f = lambda x, a: a*x</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">    &gt;&gt;&gt; y, err = integrate.quad(f, 0, 1, args=(1,))</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">    &gt;&gt;&gt; y</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">    0.5</span></div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">    &gt;&gt;&gt; y, err = integrate.quad(f, 0, 1, args=(3,))</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">    &gt;&gt;&gt; y</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    1.5</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">    Calculate :math:`\\int^1_0 x^2 + y^2 dx` with ctypes, holding</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">    y parameter as 1::</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">        testlib.c =&gt;</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">            double func(int n, double args[n]){</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">                return args[0]*args[0] + args[1]*args[1];}</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">        compile to library testlib.*</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">    ::</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">       from scipy import integrate</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">       import ctypes</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">       lib = ctypes.CDLL(&#39;/home/.../testlib.*&#39;) #use absolute path</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">       lib.func.restype = ctypes.c_double</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">       lib.func.argtypes = (ctypes.c_int,ctypes.c_double)</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">       integrate.quad(lib.func,0,1,(1))</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">       #(1.3333333333333333, 1.4802973661668752e-14)</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">       print((1.0**3/3.0 + 1.0) - (0.0**3/3.0 + 0.0)) #Analytic result</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">       # 1.3333333333333333</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">    Be aware that pulse shapes and other sharp features as compared to the</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">    size of the integration interval may not be integrated correctly using</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    this method. A simplified example of this limitation is integrating a</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    y-axis reflected step function with many zero values within the integrals</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    bounds.</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    &gt;&gt;&gt; y = lambda x: 1 if x&lt;=0 else 0</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    &gt;&gt;&gt; integrate.quad(y, -1, 1)</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    (1.0, 1.1102230246251565e-14)</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">    &gt;&gt;&gt; integrate.quad(y, -1, 100)</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    (1.0000000002199108, 1.0189464580163188e-08)</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    &gt;&gt;&gt; integrate.quad(y, -1, 10000)</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    (0.0, 0.0)</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(args, tuple):</div>
<div class="line"><span class="lineno">  405</span>        args = (args,)</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    <span class="comment"># check the limits of integration: \int_a^b, expect a &lt; b</span></div>
<div class="line"><span class="lineno">  408</span>    flip, a, b = b &lt; a, min(a, b), max(a, b)</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">if</span> weight <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  411</span>        retval = _quad(func, a, b, args, full_output, epsabs, epsrel, limit,</div>
<div class="line"><span class="lineno">  412</span>                       points)</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">if</span> points <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  415</span>            msg = (<span class="stringliteral">&quot;Break points cannot be specified when using weighted integrand.\n&quot;</span></div>
<div class="line"><span class="lineno">  416</span>                   <span class="stringliteral">&quot;Continuing, ignoring specified points.&quot;</span>)</div>
<div class="line"><span class="lineno">  417</span>            warnings.warn(msg, IntegrationWarning, stacklevel=2)</div>
<div class="line"><span class="lineno">  418</span>        retval = _quad_weight(func, a, b, args, full_output, epsabs, epsrel,</div>
<div class="line"><span class="lineno">  419</span>                              limlst, limit, maxp1, weight, wvar, wopts)</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">if</span> flip:</div>
<div class="line"><span class="lineno">  422</span>        retval = (-retval[0],) + retval[1:]</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    ier = retval[-1]</div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">if</span> ier == 0:</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">return</span> retval[:-1]</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    msgs = {80: <span class="stringliteral">&quot;A Python error occurred possibly while calling the function.&quot;</span>,</div>
<div class="line"><span class="lineno">  429</span>             1: <span class="stringliteral">&quot;The maximum number of subdivisions (%d) has been achieved.\n  If increasing the limit yields no improvement it is advised to analyze \n  the integrand in order to determine the difficulties.  If the position of a \n  local difficulty can be determined (singularity, discontinuity) one will \n  probably gain from splitting up the interval and calling the integrator \n  on the subranges.  Perhaps a special-purpose integrator should be used.&quot;</span> % limit,</div>
<div class="line"><span class="lineno">  430</span>             2: <span class="stringliteral">&quot;The occurrence of roundoff error is detected, which prevents \n  the requested tolerance from being achieved.  The error may be \n  underestimated.&quot;</span>,</div>
<div class="line"><span class="lineno">  431</span>             3: <span class="stringliteral">&quot;Extremely bad integrand behavior occurs at some points of the\n  integration interval.&quot;</span>,</div>
<div class="line"><span class="lineno">  432</span>             4: <span class="stringliteral">&quot;The algorithm does not converge.  Roundoff error is detected\n  in the extrapolation table.  It is assumed that the requested tolerance\n  cannot be achieved, and that the returned result (if full_output = 1) is \n  the best which can be obtained.&quot;</span>,</div>
<div class="line"><span class="lineno">  433</span>             5: <span class="stringliteral">&quot;The integral is probably divergent, or slowly convergent.&quot;</span>,</div>
<div class="line"><span class="lineno">  434</span>             6: <span class="stringliteral">&quot;The input is invalid.&quot;</span>,</div>
<div class="line"><span class="lineno">  435</span>             7: <span class="stringliteral">&quot;Abnormal termination of the routine.  The estimates for result\n  and error are less reliable.  It is assumed that the requested accuracy\n  has not been achieved.&quot;</span>,</div>
<div class="line"><span class="lineno">  436</span>            <span class="stringliteral">&#39;unknown&#39;</span>: <span class="stringliteral">&quot;Unknown error.&quot;</span>}</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    <span class="keywordflow">if</span> weight <span class="keywordflow">in</span> [<span class="stringliteral">&#39;cos&#39;</span>,<span class="stringliteral">&#39;sin&#39;</span>] <span class="keywordflow">and</span> (b == Inf <span class="keywordflow">or</span> a == -Inf):</div>
<div class="line"><span class="lineno">  439</span>        msgs[1] = <span class="stringliteral">&quot;The maximum number of cycles allowed has been achieved., e.e.\n  of subintervals (a+(k-1)c, a+kc) where c = (2*int(abs(omega)+1))\n  *pi/abs(omega), for k = 1, 2, ..., lst.  One can allow more cycles by increasing the value of limlst.  Look at info[&#39;ierlst&#39;] with full_output=1.&quot;</span></div>
<div class="line"><span class="lineno">  440</span>        msgs[4] = <span class="stringliteral">&quot;The extrapolation table constructed for convergence acceleration\n  of the series formed by the integral contributions over the cycles, \n  does not converge to within the requested accuracy.  Look at \n  info[&#39;ierlst&#39;] with full_output=1.&quot;</span></div>
<div class="line"><span class="lineno">  441</span>        msgs[7] = <span class="stringliteral">&quot;Bad integrand behavior occurs within one or more of the cycles.\n  Location and type of the difficulty involved can be determined from \n  the vector info[&#39;ierlist&#39;] obtained with full_output=1.&quot;</span></div>
<div class="line"><span class="lineno">  442</span>        explain = {1: <span class="stringliteral">&quot;The maximum number of subdivisions (= limit) has been \n  achieved on this cycle.&quot;</span>,</div>
<div class="line"><span class="lineno">  443</span>                   2: <span class="stringliteral">&quot;The occurrence of roundoff error is detected and prevents\n  the tolerance imposed on this cycle from being achieved.&quot;</span>,</div>
<div class="line"><span class="lineno">  444</span>                   3: <span class="stringliteral">&quot;Extremely bad integrand behavior occurs at some points of\n  this cycle.&quot;</span>,</div>
<div class="line"><span class="lineno">  445</span>                   4: <span class="stringliteral">&quot;The integral over this cycle does not converge (to within the required accuracy) due to roundoff in the extrapolation procedure invoked on this cycle.  It is assumed that the result on this interval is the best which can be obtained.&quot;</span>,</div>
<div class="line"><span class="lineno">  446</span>                   5: <span class="stringliteral">&quot;The integral over this cycle is probably divergent or slowly convergent.&quot;</span>}</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  449</span>        msg = msgs[ier]</div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">except</span> KeyError:</div>
<div class="line"><span class="lineno">  451</span>        msg = msgs[<span class="stringliteral">&#39;unknown&#39;</span>]</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">if</span> ier <span class="keywordflow">in</span> [1,2,3,4,5,7]:</div>
<div class="line"><span class="lineno">  454</span>        <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno">  455</span>            <span class="keywordflow">if</span> weight <span class="keywordflow">in</span> [<span class="stringliteral">&#39;cos&#39;</span>, <span class="stringliteral">&#39;sin&#39;</span>] <span class="keywordflow">and</span> (b == Inf <span class="keywordflow">or</span> a == -Inf):</div>
<div class="line"><span class="lineno">  456</span>                <span class="keywordflow">return</span> retval[:-1] + (msg, explain)</div>
<div class="line"><span class="lineno">  457</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  458</span>                <span class="keywordflow">return</span> retval[:-1] + (msg,)</div>
<div class="line"><span class="lineno">  459</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  460</span>            warnings.warn(msg, IntegrationWarning, stacklevel=2)</div>
<div class="line"><span class="lineno">  461</span>            <span class="keywordflow">return</span> retval[:-1]</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">elif</span> ier == 6:  <span class="comment"># Forensic decision tree when QUADPACK throws ier=6</span></div>
<div class="line"><span class="lineno">  464</span>        <span class="keywordflow">if</span> epsabs &lt;= 0:  <span class="comment"># Small error tolerance - applies to all methods</span></div>
<div class="line"><span class="lineno">  465</span>            <span class="keywordflow">if</span> epsrel &lt; max(50 * sys.float_info.epsilon, 5e-29):</div>
<div class="line"><span class="lineno">  466</span>                msg = (<span class="stringliteral">&quot;If &#39;epsabs&#39;&lt;=0, &#39;epsrel&#39; must be greater than both&quot;</span></div>
<div class="line"><span class="lineno">  467</span>                       <span class="stringliteral">&quot; 5e-29 and 50*(machine epsilon).&quot;</span>)</div>
<div class="line"><span class="lineno">  468</span>            <span class="keywordflow">elif</span> weight <span class="keywordflow">in</span> [<span class="stringliteral">&#39;sin&#39;</span>, <span class="stringliteral">&#39;cos&#39;</span>] <span class="keywordflow">and</span> (abs(a) + abs(b) == Inf):</div>
<div class="line"><span class="lineno">  469</span>                msg = (<span class="stringliteral">&quot;Sine or cosine weighted intergals with infinite domain&quot;</span></div>
<div class="line"><span class="lineno">  470</span>                       <span class="stringliteral">&quot; must have &#39;epsabs&#39;&gt;0.&quot;</span>)</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>        <span class="keywordflow">elif</span> weight <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  473</span>            <span class="keywordflow">if</span> points <span class="keywordflow">is</span> <span class="keywordtype">None</span>:  <span class="comment"># QAGSE/QAGIE</span></div>
<div class="line"><span class="lineno">  474</span>                msg = (<span class="stringliteral">&quot;Invalid &#39;limit&#39; argument. There must be&quot;</span></div>
<div class="line"><span class="lineno">  475</span>                       <span class="stringliteral">&quot; at least one subinterval&quot;</span>)</div>
<div class="line"><span class="lineno">  476</span>            <span class="keywordflow">else</span>:  <span class="comment"># QAGPE</span></div>
<div class="line"><span class="lineno">  477</span>                <span class="keywordflow">if</span> <span class="keywordflow">not</span> (min(a, b) &lt;= min(points) &lt;= max(points) &lt;= max(a, b)):</div>
<div class="line"><span class="lineno">  478</span>                    msg = (<span class="stringliteral">&quot;All break points in &#39;points&#39; must lie within the&quot;</span></div>
<div class="line"><span class="lineno">  479</span>                           <span class="stringliteral">&quot; integration limits.&quot;</span>)</div>
<div class="line"><span class="lineno">  480</span>                <span class="keywordflow">elif</span> len(points) &gt;= limit:</div>
<div class="line"><span class="lineno">  481</span>                    msg = (<span class="stringliteral">&quot;Number of break points ({:d})&quot;</span></div>
<div class="line"><span class="lineno">  482</span>                           <span class="stringliteral">&quot; must be less than subinterval&quot;</span></div>
<div class="line"><span class="lineno">  483</span>                           <span class="stringliteral">&quot; limit ({:d})&quot;</span>).format(len(points), limit)</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  486</span>            <span class="keywordflow">if</span> maxp1 &lt; 1:</div>
<div class="line"><span class="lineno">  487</span>                msg = <span class="stringliteral">&quot;Chebyshev moment limit maxp1 must be &gt;=1.&quot;</span></div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>            <span class="keywordflow">elif</span> weight <span class="keywordflow">in</span> (<span class="stringliteral">&#39;cos&#39;</span>, <span class="stringliteral">&#39;sin&#39;</span>) <span class="keywordflow">and</span> abs(a+b) == Inf:  <span class="comment"># QAWFE</span></div>
<div class="line"><span class="lineno">  490</span>                msg = <span class="stringliteral">&quot;Cycle limit limlst must be &gt;=3.&quot;</span></div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>            <span class="keywordflow">elif</span> weight.startswith(<span class="stringliteral">&#39;alg&#39;</span>):  <span class="comment"># QAWSE</span></div>
<div class="line"><span class="lineno">  493</span>                <span class="keywordflow">if</span> min(wvar) &lt; -1:</div>
<div class="line"><span class="lineno">  494</span>                    msg = <span class="stringliteral">&quot;wvar parameters (alpha, beta) must both be &gt;= -1.&quot;</span></div>
<div class="line"><span class="lineno">  495</span>                <span class="keywordflow">if</span> b &lt; a:</div>
<div class="line"><span class="lineno">  496</span>                    msg = <span class="stringliteral">&quot;Integration limits a, b must satistfy a&lt;b.&quot;</span></div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>            <span class="keywordflow">elif</span> weight == <span class="stringliteral">&#39;cauchy&#39;</span> <span class="keywordflow">and</span> wvar <span class="keywordflow">in</span> (a, b):</div>
<div class="line"><span class="lineno">  499</span>                msg = (<span class="stringliteral">&quot;Parameter &#39;wvar&#39; must not equal&quot;</span></div>
<div class="line"><span class="lineno">  500</span>                       <span class="stringliteral">&quot; integration limits &#39;a&#39; or &#39;b&#39;.&quot;</span>)</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>    <span class="keywordflow">raise</span> ValueError(msg)</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a14e51375a16d6df8cdc6770ca0c67d44" name="a14e51375a16d6df8cdc6770ca0c67d44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14e51375a16d6df8cdc6770ca0c67d44">&#9670;&#160;</a></span>tplquad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quadpack_py.tplquad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>qfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsabs</em> = <code>1.49e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsrel</em> = <code>1.49e-8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute a triple (definite) integral.

Return the triple integral of ``func(z, y, x)`` from ``x = a..b``,
``y = gfun(x)..hfun(x)``, and ``z = qfun(x,y)..rfun(x,y)``.

Parameters
----------
func : function
    A Python function or method of at least three variables in the
    order (z, y, x).
a, b : float
    The limits of integration in x: `a` &lt; `b`
gfun : function or float
    The lower boundary curve in y which is a function taking a single
    floating point argument (x) and returning a floating point result
    or a float indicating a constant boundary curve.
hfun : function or float
    The upper boundary curve in y (same requirements as `gfun`).
qfun : function or float
    The lower boundary surface in z.  It must be a function that takes
    two floats in the order (x, y) and returns a float or a float
    indicating a constant boundary surface.
rfun : function or float
    The upper boundary surface in z. (Same requirements as `qfun`.)
args : tuple, optional
    Extra arguments to pass to `func`.
epsabs : float, optional
    Absolute tolerance passed directly to the innermost 1-D quadrature
    integration. Default is 1.49e-8.
epsrel : float, optional
    Relative tolerance of the innermost 1-D integrals. Default is 1.49e-8.

Returns
-------
y : float
    The resultant integral.
abserr : float
    An estimate of the error.

See Also
--------
quad : Adaptive quadrature using QUADPACK
quadrature : Adaptive Gaussian quadrature
fixed_quad : Fixed-order Gaussian quadrature
dblquad : Double integrals
nquad : N-dimensional integrals
romb : Integrators for sampled data
simpson : Integrators for sampled data
ode : ODE integrators
odeint : ODE integrators
scipy.special : For coefficients and roots of orthogonal polynomials

Notes
-----

**Details of QUADPACK level routines**

`quad` calls routines from the FORTRAN library QUADPACK. This section
provides details on the conditions for each routine to be called and a
short description of each routine. For each level of integration, ``qagse``
is used for finite limits or ``qagie`` is used, if either limit (or both!)
are infinite. The following provides a short description from [1]_ for each
routine.

qagse
    is an integrator based on globally adaptive interval
    subdivision in connection with extrapolation, which will
    eliminate the effects of integrand singularities of
    several types.
qagie
    handles integration over infinite intervals. The infinite range is
    mapped onto a finite interval and subsequently the same strategy as
    in ``QAGS`` is applied.

References
----------

.. [1] Piessens, Robert; de Doncker-Kapenga, Elise;
       Überhuber, Christoph W.; Kahaner, David (1983).
       QUADPACK: A subroutine package for automatic integration.
       Springer-Verlag.
       ISBN 978-3-540-12553-2.

Examples
--------
Compute the triple integral of ``x * y * z``, over ``x`` ranging
from 1 to 2, ``y`` ranging from 2 to 3, ``z`` ranging from 0 to 1.
That is, :math:`\\int^{x=2}_{x=1} \\int^{y=3}_{y=2} \\int^{z=1}_{z=0} x y z
\\,dz \\,dy \\,dx`.

&gt;&gt;&gt; from scipy import integrate
&gt;&gt;&gt; f = lambda z, y, x: x*y*z
&gt;&gt;&gt; integrate.tplquad(f, 1, 2, 2, 3, 0, 1)
(1.8749999999999998, 3.3246447942574074e-14)

Calculate :math:`\\int^{x=1}_{x=0} \\int^{y=1-2x}_{y=0}
\\int^{z=1-x-2y}_{z=0} x y z \\,dz \\,dy \\,dx`.
Note: `qfun`/`rfun` takes arguments in the order (x, y), even though ``f``
takes arguments in the order (z, y, x).

&gt;&gt;&gt; f = lambda z, y, x: x*y*z
&gt;&gt;&gt; integrate.tplquad(f, 0, 1, 0, lambda x: 1-2*x, 0, lambda x, y: 1-x-2*y)
(0.05416666666666668, 2.1774196738157757e-14)

Calculate :math:`\\int^{x=1}_{x=0} \\int^{y=1}_{y=0} \\int^{z=1}_{z=0}
a x y z \\,dz \\,dy \\,dx` for :math:`a=1, 3`.

&gt;&gt;&gt; f = lambda z, y, x, a: a*x*y*z
&gt;&gt;&gt; integrate.tplquad(f, 0, 1, 0, 1, 0, 1, args=(1,))
    (0.125, 5.527033708952211e-15)
&gt;&gt;&gt; integrate.tplquad(f, 0, 1, 0, 1, 0, 1, args=(3,))
    (0.375, 1.6581101126856635e-14)</pre> <div class="fragment"><div class="line"><span class="lineno">  714</span>            epsrel=1.49e-8):</div>
<div class="line"><span class="lineno">  715</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">    Compute a triple (definite) integral.</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">    Return the triple integral of ``func(z, y, x)`` from ``x = a..b``,</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral">    ``y = gfun(x)..hfun(x)``, and ``z = qfun(x,y)..rfun(x,y)``.</span></div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">    func : function</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral">        A Python function or method of at least three variables in the</span></div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">        order (z, y, x).</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">    a, b : float</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral">        The limits of integration in x: `a` &lt; `b`</span></div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral">    gfun : function or float</span></div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">        The lower boundary curve in y which is a function taking a single</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral">        floating point argument (x) and returning a floating point result</span></div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">        or a float indicating a constant boundary curve.</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">    hfun : function or float</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral">        The upper boundary curve in y (same requirements as `gfun`).</span></div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">    qfun : function or float</span></div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">        The lower boundary surface in z.  It must be a function that takes</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral">        two floats in the order (x, y) and returns a float or a float</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">        indicating a constant boundary surface.</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">    rfun : function or float</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">        The upper boundary surface in z. (Same requirements as `qfun`.)</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">        Extra arguments to pass to `func`.</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">    epsabs : float, optional</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">        Absolute tolerance passed directly to the innermost 1-D quadrature</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">        integration. Default is 1.49e-8.</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral">    epsrel : float, optional</span></div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">        Relative tolerance of the innermost 1-D integrals. Default is 1.49e-8.</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral">    y : float</span></div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral">        The resultant integral.</span></div>
<div class="line"><span class="lineno">  752</span><span class="stringliteral">    abserr : float</span></div>
<div class="line"><span class="lineno">  753</span><span class="stringliteral">        An estimate of the error.</span></div>
<div class="line"><span class="lineno">  754</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  755</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  756</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  757</span><span class="stringliteral">    quad : Adaptive quadrature using QUADPACK</span></div>
<div class="line"><span class="lineno">  758</span><span class="stringliteral">    quadrature : Adaptive Gaussian quadrature</span></div>
<div class="line"><span class="lineno">  759</span><span class="stringliteral">    fixed_quad : Fixed-order Gaussian quadrature</span></div>
<div class="line"><span class="lineno">  760</span><span class="stringliteral">    dblquad : Double integrals</span></div>
<div class="line"><span class="lineno">  761</span><span class="stringliteral">    nquad : N-dimensional integrals</span></div>
<div class="line"><span class="lineno">  762</span><span class="stringliteral">    romb : Integrators for sampled data</span></div>
<div class="line"><span class="lineno">  763</span><span class="stringliteral">    simpson : Integrators for sampled data</span></div>
<div class="line"><span class="lineno">  764</span><span class="stringliteral">    ode : ODE integrators</span></div>
<div class="line"><span class="lineno">  765</span><span class="stringliteral">    odeint : ODE integrators</span></div>
<div class="line"><span class="lineno">  766</span><span class="stringliteral">    scipy.special : For coefficients and roots of orthogonal polynomials</span></div>
<div class="line"><span class="lineno">  767</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  768</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  769</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  770</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  771</span><span class="stringliteral">    **Details of QUADPACK level routines**</span></div>
<div class="line"><span class="lineno">  772</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  773</span><span class="stringliteral">    `quad` calls routines from the FORTRAN library QUADPACK. This section</span></div>
<div class="line"><span class="lineno">  774</span><span class="stringliteral">    provides details on the conditions for each routine to be called and a</span></div>
<div class="line"><span class="lineno">  775</span><span class="stringliteral">    short description of each routine. For each level of integration, ``qagse``</span></div>
<div class="line"><span class="lineno">  776</span><span class="stringliteral">    is used for finite limits or ``qagie`` is used, if either limit (or both!)</span></div>
<div class="line"><span class="lineno">  777</span><span class="stringliteral">    are infinite. The following provides a short description from [1]_ for each</span></div>
<div class="line"><span class="lineno">  778</span><span class="stringliteral">    routine.</span></div>
<div class="line"><span class="lineno">  779</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  780</span><span class="stringliteral">    qagse</span></div>
<div class="line"><span class="lineno">  781</span><span class="stringliteral">        is an integrator based on globally adaptive interval</span></div>
<div class="line"><span class="lineno">  782</span><span class="stringliteral">        subdivision in connection with extrapolation, which will</span></div>
<div class="line"><span class="lineno">  783</span><span class="stringliteral">        eliminate the effects of integrand singularities of</span></div>
<div class="line"><span class="lineno">  784</span><span class="stringliteral">        several types.</span></div>
<div class="line"><span class="lineno">  785</span><span class="stringliteral">    qagie</span></div>
<div class="line"><span class="lineno">  786</span><span class="stringliteral">        handles integration over infinite intervals. The infinite range is</span></div>
<div class="line"><span class="lineno">  787</span><span class="stringliteral">        mapped onto a finite interval and subsequently the same strategy as</span></div>
<div class="line"><span class="lineno">  788</span><span class="stringliteral">        in ``QAGS`` is applied.</span></div>
<div class="line"><span class="lineno">  789</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  790</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  791</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">    .. [1] Piessens, Robert; de Doncker-Kapenga, Elise;</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral">           Überhuber, Christoph W.; Kahaner, David (1983).</span></div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral">           QUADPACK: A subroutine package for automatic integration.</span></div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">           Springer-Verlag.</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">           ISBN 978-3-540-12553-2.</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  799</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  800</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  801</span><span class="stringliteral">    Compute the triple integral of ``x * y * z``, over ``x`` ranging</span></div>
<div class="line"><span class="lineno">  802</span><span class="stringliteral">    from 1 to 2, ``y`` ranging from 2 to 3, ``z`` ranging from 0 to 1.</span></div>
<div class="line"><span class="lineno">  803</span><span class="stringliteral">    That is, :math:`\\int^{x=2}_{x=1} \\int^{y=3}_{y=2} \\int^{z=1}_{z=0} x y z</span></div>
<div class="line"><span class="lineno">  804</span><span class="stringliteral">    \\,dz \\,dy \\,dx`.</span></div>
<div class="line"><span class="lineno">  805</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  806</span><span class="stringliteral">    &gt;&gt;&gt; from scipy import integrate</span></div>
<div class="line"><span class="lineno">  807</span><span class="stringliteral">    &gt;&gt;&gt; f = lambda z, y, x: x*y*z</span></div>
<div class="line"><span class="lineno">  808</span><span class="stringliteral">    &gt;&gt;&gt; integrate.tplquad(f, 1, 2, 2, 3, 0, 1)</span></div>
<div class="line"><span class="lineno">  809</span><span class="stringliteral">    (1.8749999999999998, 3.3246447942574074e-14)</span></div>
<div class="line"><span class="lineno">  810</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  811</span><span class="stringliteral">    Calculate :math:`\\int^{x=1}_{x=0} \\int^{y=1-2x}_{y=0}</span></div>
<div class="line"><span class="lineno">  812</span><span class="stringliteral">    \\int^{z=1-x-2y}_{z=0} x y z \\,dz \\,dy \\,dx`.</span></div>
<div class="line"><span class="lineno">  813</span><span class="stringliteral">    Note: `qfun`/`rfun` takes arguments in the order (x, y), even though ``f``</span></div>
<div class="line"><span class="lineno">  814</span><span class="stringliteral">    takes arguments in the order (z, y, x).</span></div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">    &gt;&gt;&gt; f = lambda z, y, x: x*y*z</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral">    &gt;&gt;&gt; integrate.tplquad(f, 0, 1, 0, lambda x: 1-2*x, 0, lambda x, y: 1-x-2*y)</span></div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">    (0.05416666666666668, 2.1774196738157757e-14)</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral">    Calculate :math:`\\int^{x=1}_{x=0} \\int^{y=1}_{y=0} \\int^{z=1}_{z=0}</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">    a x y z \\,dz \\,dy \\,dx` for :math:`a=1, 3`.</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">    &gt;&gt;&gt; f = lambda z, y, x, a: a*x*y*z</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">    &gt;&gt;&gt; integrate.tplquad(f, 0, 1, 0, 1, 0, 1, args=(1,))</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">        (0.125, 5.527033708952211e-15)</span></div>
<div class="line"><span class="lineno">  826</span><span class="stringliteral">    &gt;&gt;&gt; integrate.tplquad(f, 0, 1, 0, 1, 0, 1, args=(3,))</span></div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral">        (0.375, 1.6581101126856635e-14)</span></div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  830</span>    <span class="comment"># f(z, y, x)</span></div>
<div class="line"><span class="lineno">  831</span>    <span class="comment"># qfun/rfun(x, y)</span></div>
<div class="line"><span class="lineno">  832</span>    <span class="comment"># gfun/hfun(x)</span></div>
<div class="line"><span class="lineno">  833</span>    <span class="comment"># nquad will hand (y, x, t0, ...) to ranges0</span></div>
<div class="line"><span class="lineno">  834</span>    <span class="comment"># nquad will hand (x, t0, ...) to ranges1</span></div>
<div class="line"><span class="lineno">  835</span>    <span class="comment"># Only qfun / rfun is different API...</span></div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>    <span class="keyword">def </span>ranges0(*args):</div>
<div class="line"><span class="lineno">  838</span>        <span class="keywordflow">return</span> [qfun(args[1], args[0]) <span class="keywordflow">if</span> callable(qfun) <span class="keywordflow">else</span> qfun,</div>
<div class="line"><span class="lineno">  839</span>                rfun(args[1], args[0]) <span class="keywordflow">if</span> callable(rfun) <span class="keywordflow">else</span> rfun]</div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>    <span class="keyword">def </span>ranges1(*args):</div>
<div class="line"><span class="lineno">  842</span>        <span class="keywordflow">return</span> [gfun(args[0]) <span class="keywordflow">if</span> callable(gfun) <span class="keywordflow">else</span> gfun,</div>
<div class="line"><span class="lineno">  843</span>                hfun(args[0]) <span class="keywordflow">if</span> callable(hfun) <span class="keywordflow">else</span> hfun]</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>    ranges = [ranges0, ranges1, [a, b]]</div>
<div class="line"><span class="lineno">  846</span>    <span class="keywordflow">return</span> nquad(func, ranges, args=args,</div>
<div class="line"><span class="lineno">  847</span>            opts={<span class="stringliteral">&quot;epsabs&quot;</span>: epsabs, <span class="stringliteral">&quot;epsrel&quot;</span>: epsrel})</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae03734ba6a052fe5e9da90315f29680f" name="ae03734ba6a052fe5e9da90315f29680f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae03734ba6a052fe5e9da90315f29680f">&#9670;&#160;</a></span>error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quadpack_py.error = _quadpack.error</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
