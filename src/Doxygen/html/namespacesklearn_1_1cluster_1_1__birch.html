<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.cluster._birch Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1cluster.html">cluster</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1cluster_1_1__birch.html">_birch</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.cluster._birch Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1cluster_1_1__birch_1_1___c_f_node.html">_CFNode</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1cluster_1_1__birch_1_1___c_f_subcluster.html">_CFSubcluster</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1cluster_1_1__birch_1_1_birch.html">Birch</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a23c4790c95cd51c557a42478218c1090" id="r_a23c4790c95cd51c557a42478218c1090"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1__birch.html#a23c4790c95cd51c557a42478218c1090">_iterate_sparse_X</a> (X)</td></tr>
<tr class="separator:a23c4790c95cd51c557a42478218c1090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a199e399ad2374166d923b25e26d2303e" id="r_a199e399ad2374166d923b25e26d2303e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1__birch.html#a199e399ad2374166d923b25e26d2303e">_split_node</a> (node, threshold, branching_factor)</td></tr>
<tr class="separator:a199e399ad2374166d923b25e26d2303e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a23c4790c95cd51c557a42478218c1090" name="a23c4790c95cd51c557a42478218c1090"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23c4790c95cd51c557a42478218c1090">&#9670;&#160;</a></span>_iterate_sparse_X()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster._birch._iterate_sparse_X </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">This little hack returns a densified row when iterating over a sparse
matrix, instead of constructing a sparse matrix for every row that is
expensive.
</pre> <div class="fragment"><div class="line"><span class="lineno">   28</span><span class="keyword">def </span>_iterate_sparse_X(X):</div>
<div class="line"><span class="lineno">   29</span>    <span class="stringliteral">&quot;&quot;&quot;This little hack returns a densified row when iterating over a sparse</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    matrix, instead of constructing a sparse matrix for every row that is</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">    expensive.</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   33</span>    n_samples = X.shape[0]</div>
<div class="line"><span class="lineno">   34</span>    X_indices = X.indices</div>
<div class="line"><span class="lineno">   35</span>    X_data = X.data</div>
<div class="line"><span class="lineno">   36</span>    X_indptr = X.indptr</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n_samples):</div>
<div class="line"><span class="lineno">   39</span>        row = np.zeros(X.shape[1])</div>
<div class="line"><span class="lineno">   40</span>        startptr, endptr = X_indptr[i], X_indptr[i + 1]</div>
<div class="line"><span class="lineno">   41</span>        nonzero_indices = X_indices[startptr:endptr]</div>
<div class="line"><span class="lineno">   42</span>        row[nonzero_indices] = X_data[startptr:endptr]</div>
<div class="line"><span class="lineno">   43</span>        <span class="keywordflow">yield</span> row</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a199e399ad2374166d923b25e26d2303e" name="a199e399ad2374166d923b25e26d2303e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a199e399ad2374166d923b25e26d2303e">&#9670;&#160;</a></span>_split_node()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster._birch._split_node </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>branching_factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">The node has to be split if there is no place for a new subcluster
in the node.
1. Two empty nodes and two empty subclusters are initialized.
2. The pair of distant subclusters are found.
3. The properties of the empty subclusters and nodes are updated
   according to the nearest distance between the subclusters to the
   pair of distant subclusters.
4. The two nodes are set as children to the two subclusters.
</pre> <div class="fragment"><div class="line"><span class="lineno">   46</span><span class="keyword">def </span>_split_node(node, threshold, branching_factor):</div>
<div class="line"><span class="lineno">   47</span>    <span class="stringliteral">&quot;&quot;&quot;The node has to be split if there is no place for a new subcluster</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    in the node.</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    1. Two empty nodes and two empty subclusters are initialized.</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    2. The pair of distant subclusters are found.</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">    3. The properties of the empty subclusters and nodes are updated</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">       according to the nearest distance between the subclusters to the</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">       pair of distant subclusters.</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">    4. The two nodes are set as children to the two subclusters.</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   56</span>    new_subcluster1 = _CFSubcluster()</div>
<div class="line"><span class="lineno">   57</span>    new_subcluster2 = _CFSubcluster()</div>
<div class="line"><span class="lineno">   58</span>    new_node1 = _CFNode(</div>
<div class="line"><span class="lineno">   59</span>        threshold=threshold,</div>
<div class="line"><span class="lineno">   60</span>        branching_factor=branching_factor,</div>
<div class="line"><span class="lineno">   61</span>        is_leaf=node.is_leaf,</div>
<div class="line"><span class="lineno">   62</span>        n_features=node.n_features,</div>
<div class="line"><span class="lineno">   63</span>        dtype=node.init_centroids_.dtype,</div>
<div class="line"><span class="lineno">   64</span>    )</div>
<div class="line"><span class="lineno">   65</span>    new_node2 = _CFNode(</div>
<div class="line"><span class="lineno">   66</span>        threshold=threshold,</div>
<div class="line"><span class="lineno">   67</span>        branching_factor=branching_factor,</div>
<div class="line"><span class="lineno">   68</span>        is_leaf=node.is_leaf,</div>
<div class="line"><span class="lineno">   69</span>        n_features=node.n_features,</div>
<div class="line"><span class="lineno">   70</span>        dtype=node.init_centroids_.dtype,</div>
<div class="line"><span class="lineno">   71</span>    )</div>
<div class="line"><span class="lineno">   72</span>    new_subcluster1.child_ = new_node1</div>
<div class="line"><span class="lineno">   73</span>    new_subcluster2.child_ = new_node2</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">if</span> node.is_leaf:</div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">if</span> node.prev_leaf_ <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   77</span>            node.prev_leaf_.next_leaf_ = new_node1</div>
<div class="line"><span class="lineno">   78</span>        new_node1.prev_leaf_ = node.prev_leaf_</div>
<div class="line"><span class="lineno">   79</span>        new_node1.next_leaf_ = new_node2</div>
<div class="line"><span class="lineno">   80</span>        new_node2.prev_leaf_ = new_node1</div>
<div class="line"><span class="lineno">   81</span>        new_node2.next_leaf_ = node.next_leaf_</div>
<div class="line"><span class="lineno">   82</span>        <span class="keywordflow">if</span> node.next_leaf_ <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   83</span>            node.next_leaf_.prev_leaf_ = new_node2</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    dist = euclidean_distances(</div>
<div class="line"><span class="lineno">   86</span>        node.centroids_, Y_norm_squared=node.squared_norm_, squared=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">   87</span>    )</div>
<div class="line"><span class="lineno">   88</span>    n_clusters = dist.shape[0]</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>    farthest_idx = np.unravel_index(dist.argmax(), (n_clusters, n_clusters))</div>
<div class="line"><span class="lineno">   91</span>    node1_dist, node2_dist = dist[(farthest_idx,)]</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    node1_closer = node1_dist &lt; node2_dist</div>
<div class="line"><span class="lineno">   94</span>    <span class="comment"># make sure node1 is closest to itself even if all distances are equal.</span></div>
<div class="line"><span class="lineno">   95</span>    <span class="comment"># This can only happen when all node.centroids_ are duplicates leading to all</span></div>
<div class="line"><span class="lineno">   96</span>    <span class="comment"># distances between centroids being zero.</span></div>
<div class="line"><span class="lineno">   97</span>    node1_closer[farthest_idx[0]] = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">for</span> idx, subcluster <span class="keywordflow">in</span> enumerate(node.subclusters_):</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">if</span> node1_closer[idx]:</div>
<div class="line"><span class="lineno">  101</span>            new_node1.append_subcluster(subcluster)</div>
<div class="line"><span class="lineno">  102</span>            new_subcluster1.update(subcluster)</div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  104</span>            new_node2.append_subcluster(subcluster)</div>
<div class="line"><span class="lineno">  105</span>            new_subcluster2.update(subcluster)</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">return</span> new_subcluster1, new_subcluster2</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
