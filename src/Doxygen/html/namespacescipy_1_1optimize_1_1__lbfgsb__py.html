<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._lbfgsb_py Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__lbfgsb__py.html">_lbfgsb_py</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._lbfgsb_py Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__lbfgsb__py_1_1_lbfgs_inv_hess_product.html">LbfgsInvHessProduct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a577fc761e80b4a6d16727f96afc4fa05" id="r_a577fc761e80b4a6d16727f96afc4fa05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__lbfgsb__py.html#a577fc761e80b4a6d16727f96afc4fa05">fmin_l_bfgs_b</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, x0, fprime=None, args=(), approx_grad=0, bounds=None, m=10, factr=1e7, pgtol=1e-5, epsilon=1e-8, iprint=-1, maxfun=15000, maxiter=15000, disp=None, callback=None, maxls=20)</td></tr>
<tr class="separator:a577fc761e80b4a6d16727f96afc4fa05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b51e06e060fcdd7ce8a447d35e836e" id="r_af8b51e06e060fcdd7ce8a447d35e836e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__lbfgsb__py.html#af8b51e06e060fcdd7ce8a447d35e836e">_minimize_lbfgsb</a> (fun, x0, args=(), jac=None, bounds=None, disp=None, maxcor=10, ftol=2.2204460492503131e-09, gtol=1e-5, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=1e-8, maxfun=15000, maxiter=15000, iprint=-1, callback=None, maxls=20, finite_diff_rel_step=None, **unknown_options)</td></tr>
<tr class="separator:af8b51e06e060fcdd7ce8a447d35e836e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Functions
---------
.. autosummary::
   :toctree: generated/

    fmin_l_bfgs_b</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="af8b51e06e060fcdd7ce8a447d35e836e" name="af8b51e06e060fcdd7ce8a447d35e836e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8b51e06e060fcdd7ce8a447d35e836e">&#9670;&#160;</a></span>_minimize_lbfgsb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._lbfgsb_py._minimize_lbfgsb </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxcor</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ftol</em> = <code>2.2204460492503131e-09</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gtol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfun</em> = <code>15000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>15000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iprint</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxls</em> = <code>20</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>finite_diff_rel_step</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Minimize a scalar function of one or more variables using the L-BFGS-B
algorithm.

Options
-------
disp : None or int
    If `disp is None` (the default), then the supplied version of `iprint`
    is used. If `disp is not None`, then it overrides the supplied version
    of `iprint` with the behaviour you outlined.
maxcor : int
    The maximum number of variable metric corrections used to
    define the limited memory matrix. (The limited memory BFGS
    method does not store the full hessian but uses this many terms
    in an approximation to it.)
ftol : float
    The iteration stops when ``(f^k -
    f^{k+1})/max{|f^k|,|f^{k+1}|,1} &lt;= ftol``.
gtol : float
    The iteration will stop when ``max{|proj g_i | i = 1, ..., n}
    &lt;= gtol`` where ``pg_i`` is the i-th component of the
    projected gradient.
eps : float or ndarray
    If `jac is None` the absolute step size used for numerical
    approximation of the jacobian via forward differences.
maxfun : int
    Maximum number of function evaluations.
maxiter : int
    Maximum number of iterations.
iprint : int, optional
    Controls the frequency of output. ``iprint &lt; 0`` means no output;
    ``iprint = 0``    print only one line at the last iteration;
    ``0 &lt; iprint &lt; 99`` print also f and ``|proj g|`` every iprint iterations;
    ``iprint = 99``   print details of every iteration except n-vectors;
    ``iprint = 100``  print also the changes of active set and final x;
    ``iprint &gt; 100``  print details of every iteration including x and g.
callback : callable, optional
    Called after each iteration, as ``callback(xk)``, where ``xk`` is the
    current parameter vector.
maxls : int, optional
    Maximum number of line search steps (per iteration). Default is 20.
finite_diff_rel_step : None or array_like, optional
    If `jac in ['2-point', '3-point', 'cs']` the relative step size to
    use for numerical approximation of the jacobian. The absolute step
    size is computed as ``h = rel_step * sign(x) * max(1, abs(x))``,
    possibly adjusted to fit into the bounds. For ``method='3-point'``
    the sign of `h` is ignored. If None (default) then step is selected
    automatically.

Notes
-----
The option `ftol` is exposed via the `scipy.optimize.minimize` interface,
but calling `scipy.optimize.fmin_l_bfgs_b` directly exposes `factr`. The
relationship between the two is ``ftol = factr * numpy.finfo(float).eps``.
I.e., `factr` multiplies the default machine floating-point precision to
arrive at `ftol`.</pre> <div class="fragment"><div class="line"><span class="lineno">  214</span>                     finite_diff_rel_step=<span class="keywordtype">None</span>, **unknown_options):</div>
<div class="line"><span class="lineno">  215</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">    Minimize a scalar function of one or more variables using the L-BFGS-B</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">    algorithm.</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">    disp : None or int</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">        If `disp is None` (the default), then the supplied version of `iprint`</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">        is used. If `disp is not None`, then it overrides the supplied version</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">        of `iprint` with the behaviour you outlined.</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">    maxcor : int</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">        The maximum number of variable metric corrections used to</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">        define the limited memory matrix. (The limited memory BFGS</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">        method does not store the full hessian but uses this many terms</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">        in an approximation to it.)</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    ftol : float</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">        The iteration stops when ``(f^k -</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">        f^{k+1})/max{|f^k|,|f^{k+1}|,1} &lt;= ftol``.</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    gtol : float</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">        The iteration will stop when ``max{|proj g_i | i = 1, ..., n}</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">        &lt;= gtol`` where ``pg_i`` is the i-th component of the</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">        projected gradient.</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">    eps : float or ndarray</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">        If `jac is None` the absolute step size used for numerical</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">        approximation of the jacobian via forward differences.</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral">    maxfun : int</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">        Maximum number of function evaluations.</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">        Maximum number of iterations.</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    iprint : int, optional</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">        Controls the frequency of output. ``iprint &lt; 0`` means no output;</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">        ``iprint = 0``    print only one line at the last iteration;</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">        ``0 &lt; iprint &lt; 99`` print also f and ``|proj g|`` every iprint iterations;</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">        ``iprint = 99``   print details of every iteration except n-vectors;</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">        ``iprint = 100``  print also the changes of active set and final x;</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">        ``iprint &gt; 100``  print details of every iteration including x and g.</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">        Called after each iteration, as ``callback(xk)``, where ``xk`` is the</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">        current parameter vector.</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">    maxls : int, optional</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">        Maximum number of line search steps (per iteration). Default is 20.</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    finite_diff_rel_step : None or array_like, optional</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">        If `jac in [&#39;2-point&#39;, &#39;3-point&#39;, &#39;cs&#39;]` the relative step size to</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">        use for numerical approximation of the jacobian. The absolute step</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">        size is computed as ``h = rel_step * sign(x) * max(1, abs(x))``,</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">        possibly adjusted to fit into the bounds. For ``method=&#39;3-point&#39;``</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">        the sign of `h` is ignored. If None (default) then step is selected</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">        automatically.</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    The option `ftol` is exposed via the `scipy.optimize.minimize` interface,</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    but calling `scipy.optimize.fmin_l_bfgs_b` directly exposes `factr`. The</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    relationship between the two is ``ftol = factr * numpy.finfo(float).eps``.</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    I.e., `factr` multiplies the default machine floating-point precision to</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    arrive at `ftol`.</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  273</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno">  274</span>    m = maxcor</div>
<div class="line"><span class="lineno">  275</span>    pgtol = gtol</div>
<div class="line"><span class="lineno">  276</span>    factr = ftol / np.finfo(float).eps</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>    x0 = asarray(x0).ravel()</div>
<div class="line"><span class="lineno">  279</span>    n, = x0.shape</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">if</span> bounds <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  282</span>        bounds = [(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>)] * n</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">if</span> len(bounds) != n:</div>
<div class="line"><span class="lineno">  284</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;length of x0 != length of bounds&#39;</span>)</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    <span class="comment"># unbounded variables must use None, not +-inf, for optimizer to work properly</span></div>
<div class="line"><span class="lineno">  287</span>    bounds = [(<span class="keywordtype">None</span> <span class="keywordflow">if</span> l == -np.inf <span class="keywordflow">else</span> l, <span class="keywordtype">None</span> <span class="keywordflow">if</span> u == np.inf <span class="keywordflow">else</span> u) <span class="keywordflow">for</span> l, u <span class="keywordflow">in</span> bounds]</div>
<div class="line"><span class="lineno">  288</span>    <span class="comment"># LBFGSB is sent &#39;old-style&#39; bounds, &#39;new-style&#39; bounds are required by</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="comment"># approx_derivative and ScalarFunction</span></div>
<div class="line"><span class="lineno">  290</span>    new_bounds = old_bound_to_new(bounds)</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>    <span class="comment"># check bounds</span></div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">if</span> (new_bounds[0] &gt; new_bounds[1]).any():</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;LBFGSB - one of the lower bounds is greater than an upper bound.&quot;</span>)</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    <span class="comment"># initial vector must lie within the bounds. Otherwise ScalarFunction and</span></div>
<div class="line"><span class="lineno">  297</span>    <span class="comment"># approx_derivative will cause problems</span></div>
<div class="line"><span class="lineno">  298</span>    x0 = np.clip(x0, new_bounds[0], new_bounds[1])</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">if</span> disp <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordflow">if</span> disp == 0:</div>
<div class="line"><span class="lineno">  302</span>            iprint = -1</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  304</span>            iprint = disp</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    sf = _prepare_scalar_function(fun, x0, jac=jac, args=args, epsilon=eps,</div>
<div class="line"><span class="lineno">  307</span>                                  bounds=new_bounds,</div>
<div class="line"><span class="lineno">  308</span>                                  finite_diff_rel_step=finite_diff_rel_step)</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    func_and_grad = sf.fun_and_grad</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>    fortran_int = _lbfgsb.types.intvar.dtype</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    nbd = zeros(n, fortran_int)</div>
<div class="line"><span class="lineno">  315</span>    low_bnd = zeros(n, float64)</div>
<div class="line"><span class="lineno">  316</span>    upper_bnd = zeros(n, float64)</div>
<div class="line"><span class="lineno">  317</span>    bounds_map = {(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>): 0,</div>
<div class="line"><span class="lineno">  318</span>                  (1, <span class="keywordtype">None</span>): 1,</div>
<div class="line"><span class="lineno">  319</span>                  (1, 1): 2,</div>
<div class="line"><span class="lineno">  320</span>                  (<span class="keywordtype">None</span>, 1): 3}</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, n):</div>
<div class="line"><span class="lineno">  322</span>        l, u = bounds[i]</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">if</span> l <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  324</span>            low_bnd[i] = l</div>
<div class="line"><span class="lineno">  325</span>            l = 1</div>
<div class="line"><span class="lineno">  326</span>        <span class="keywordflow">if</span> u <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  327</span>            upper_bnd[i] = u</div>
<div class="line"><span class="lineno">  328</span>            u = 1</div>
<div class="line"><span class="lineno">  329</span>        nbd[i] = bounds_map[l, u]</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> maxls &gt; 0:</div>
<div class="line"><span class="lineno">  332</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;maxls must be positive.&#39;</span>)</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    x = array(x0, float64)</div>
<div class="line"><span class="lineno">  335</span>    f = array(0.0, float64)</div>
<div class="line"><span class="lineno">  336</span>    g = zeros((n,), float64)</div>
<div class="line"><span class="lineno">  337</span>    wa = zeros(2*m*n + 5*n + 11*m*m + 8*m, float64)</div>
<div class="line"><span class="lineno">  338</span>    iwa = zeros(3*n, fortran_int)</div>
<div class="line"><span class="lineno">  339</span>    task = zeros(1, <span class="stringliteral">&#39;S60&#39;</span>)</div>
<div class="line"><span class="lineno">  340</span>    csave = zeros(1, <span class="stringliteral">&#39;S60&#39;</span>)</div>
<div class="line"><span class="lineno">  341</span>    lsave = zeros(4, fortran_int)</div>
<div class="line"><span class="lineno">  342</span>    isave = zeros(44, fortran_int)</div>
<div class="line"><span class="lineno">  343</span>    dsave = zeros(29, float64)</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    task[:] = <span class="stringliteral">&#39;START&#39;</span></div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>    n_iterations = 0</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">while</span> 1:</div>
<div class="line"><span class="lineno">  350</span>        <span class="comment"># x, f, g, wa, iwa, task, csave, lsave, isave, dsave = \</span></div>
<div class="line"><span class="lineno">  351</span>        _lbfgsb.setulb(m, x, low_bnd, upper_bnd, nbd, f, g, factr,</div>
<div class="line"><span class="lineno">  352</span>                       pgtol, wa, iwa, task, iprint, csave, lsave,</div>
<div class="line"><span class="lineno">  353</span>                       isave, dsave, maxls)</div>
<div class="line"><span class="lineno">  354</span>        task_str = task.tobytes()</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">if</span> task_str.startswith(b<span class="stringliteral">&#39;FG&#39;</span>):</div>
<div class="line"><span class="lineno">  356</span>            <span class="comment"># The minimization routine wants f and g at the current x.</span></div>
<div class="line"><span class="lineno">  357</span>            <span class="comment"># Note that interruptions due to maxfun are postponed</span></div>
<div class="line"><span class="lineno">  358</span>            <span class="comment"># until the completion of the current minimization iteration.</span></div>
<div class="line"><span class="lineno">  359</span>            <span class="comment"># Overwrite f and g:</span></div>
<div class="line"><span class="lineno">  360</span>            f, g = func_and_grad(x)</div>
<div class="line"><span class="lineno">  361</span>        <span class="keywordflow">elif</span> task_str.startswith(b<span class="stringliteral">&#39;NEW_X&#39;</span>):</div>
<div class="line"><span class="lineno">  362</span>            <span class="comment"># new iteration</span></div>
<div class="line"><span class="lineno">  363</span>            n_iterations += 1</div>
<div class="line"><span class="lineno">  364</span>            <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  365</span>                callback(np.copy(x))</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">if</span> n_iterations &gt;= maxiter:</div>
<div class="line"><span class="lineno">  368</span>                task[:] = <span class="stringliteral">&#39;STOP: TOTAL NO. of ITERATIONS REACHED LIMIT&#39;</span></div>
<div class="line"><span class="lineno">  369</span>            <span class="keywordflow">elif</span> sf.nfev &gt; maxfun:</div>
<div class="line"><span class="lineno">  370</span>                task[:] = (<span class="stringliteral">&#39;STOP: TOTAL NO. of f AND g EVALUATIONS &#39;</span></div>
<div class="line"><span class="lineno">  371</span>                           <span class="stringliteral">&#39;EXCEEDS LIMIT&#39;</span>)</div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  373</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>    task_str = task.tobytes().strip(b<span class="stringliteral">&#39;\x00&#39;</span>).strip()</div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">if</span> task_str.startswith(b<span class="stringliteral">&#39;CONV&#39;</span>):</div>
<div class="line"><span class="lineno">  377</span>        warnflag = 0</div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">elif</span> sf.nfev &gt; maxfun <span class="keywordflow">or</span> n_iterations &gt;= maxiter:</div>
<div class="line"><span class="lineno">  379</span>        warnflag = 1</div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  381</span>        warnflag = 2</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="comment"># These two portions of the workspace are described in the mainlb</span></div>
<div class="line"><span class="lineno">  384</span>    <span class="comment"># subroutine in lbfgsb.f. See line 363.</span></div>
<div class="line"><span class="lineno">  385</span>    s = wa[0: m*n].reshape(m, n)</div>
<div class="line"><span class="lineno">  386</span>    y = wa[m*n: 2*m*n].reshape(m, n)</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    <span class="comment"># See lbfgsb.f line 160 for this portion of the workspace.</span></div>
<div class="line"><span class="lineno">  389</span>    <span class="comment"># isave(31) = the total number of BFGS updates prior the current iteration;</span></div>
<div class="line"><span class="lineno">  390</span>    n_bfgs_updates = isave[30]</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    n_corrs = min(n_bfgs_updates, maxcor)</div>
<div class="line"><span class="lineno">  393</span>    hess_inv = LbfgsInvHessProduct(s[:n_corrs], y[:n_corrs])</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    task_str = task_str.decode()</div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordflow">return</span> OptimizeResult(fun=f, jac=g, nfev=sf.nfev,</div>
<div class="line"><span class="lineno">  397</span>                          njev=sf.ngev,</div>
<div class="line"><span class="lineno">  398</span>                          nit=n_iterations, status=warnflag, message=task_str,</div>
<div class="line"><span class="lineno">  399</span>                          x=x, success=(warnflag == 0), hess_inv=hess_inv)</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a577fc761e80b4a6d16727f96afc4fa05" name="a577fc761e80b4a6d16727f96afc4fa05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a577fc761e80b4a6d16727f96afc4fa05">&#9670;&#160;</a></span>fmin_l_bfgs_b()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._lbfgsb_py.fmin_l_bfgs_b </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fprime</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>approx_grad</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bounds</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>factr</em> = <code>1e7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pgtol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iprint</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxfun</em> = <code>15000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>15000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxls</em> = <code>20</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Minimize a function func using the L-BFGS-B algorithm.

Parameters
----------
func : callable f(x,*args)
    Function to minimize.
x0 : ndarray
    Initial guess.
fprime : callable fprime(x,*args), optional
    The gradient of `func`. If None, then `func` returns the function
    value and the gradient (``f, g = func(x, *args)``), unless
    `approx_grad` is True in which case `func` returns only ``f``.
args : sequence, optional
    Arguments to pass to `func` and `fprime`.
approx_grad : bool, optional
    Whether to approximate the gradient numerically (in which case
    `func` returns only the function value).
bounds : list, optional
    ``(min, max)`` pairs for each element in ``x``, defining
    the bounds on that parameter. Use None or +-inf for one of ``min`` or
    ``max`` when there is no bound in that direction.
m : int, optional
    The maximum number of variable metric corrections
    used to define the limited memory matrix. (The limited memory BFGS
    method does not store the full hessian but uses this many terms in an
    approximation to it.)
factr : float, optional
    The iteration stops when
    ``(f^k - f^{k+1})/max{|f^k|,|f^{k+1}|,1} &lt;= factr * eps``,
    where ``eps`` is the machine precision, which is automatically
    generated by the code. Typical values for `factr` are: 1e12 for
    low accuracy; 1e7 for moderate accuracy; 10.0 for extremely
    high accuracy. See Notes for relationship to `ftol`, which is exposed
    (instead of `factr`) by the `scipy.optimize.minimize` interface to
    L-BFGS-B.
pgtol : float, optional
    The iteration will stop when
    ``max{|proj g_i | i = 1, ..., n} &lt;= pgtol``
    where ``pg_i`` is the i-th component of the projected gradient.
epsilon : float, optional
    Step size used when `approx_grad` is True, for numerically
    calculating the gradient
iprint : int, optional
    Controls the frequency of output. ``iprint &lt; 0`` means no output;
    ``iprint = 0``    print only one line at the last iteration;
    ``0 &lt; iprint &lt; 99`` print also f and ``|proj g|`` every iprint iterations;
    ``iprint = 99``   print details of every iteration except n-vectors;
    ``iprint = 100``  print also the changes of active set and final x;
    ``iprint &gt; 100``  print details of every iteration including x and g.
disp : int, optional
    If zero, then no output. If a positive number, then this over-rides
    `iprint` (i.e., `iprint` gets the value of `disp`).
maxfun : int, optional
    Maximum number of function evaluations. Note that this function
    may violate the limit because of evaluating gradients by numerical
    differentiation.
maxiter : int, optional
    Maximum number of iterations.
callback : callable, optional
    Called after each iteration, as ``callback(xk)``, where ``xk`` is the
    current parameter vector.
maxls : int, optional
    Maximum number of line search steps (per iteration). Default is 20.

Returns
-------
x : array_like
    Estimated position of the minimum.
f : float
    Value of `func` at the minimum.
d : dict
    Information dictionary.

    * d['warnflag'] is

      - 0 if converged,
      - 1 if too many function evaluations or too many iterations,
      - 2 if stopped for another reason, given in d['task']

    * d['grad'] is the gradient at the minimum (should be 0 ish)
    * d['funcalls'] is the number of function calls made.
    * d['nit'] is the number of iterations.

See also
--------
minimize: Interface to minimization algorithms for multivariate
    functions. See the 'L-BFGS-B' `method` in particular. Note that the
    `ftol` option is made available via that interface, while `factr` is
    provided via this interface, where `factr` is the factor multiplying
    the default machine floating-point precision to arrive at `ftol`:
    ``ftol = factr * numpy.finfo(float).eps``.

Notes
-----
License of L-BFGS-B (FORTRAN code):

The version included here (in fortran code) is 3.0
(released April 25, 2011). It was written by Ciyou Zhu, Richard Byrd,
and Jorge Nocedal &lt;nocedal@ece.nwu.edu&gt;. It carries the following
condition for use:

This software is freely available, but we expect that all publications
describing work using this software, or all commercial products using it,
quote at least one of the references given below. This software is released
under the BSD License.

References
----------
* R. H. Byrd, P. Lu and J. Nocedal. A Limited Memory Algorithm for Bound
  Constrained Optimization, (1995), SIAM Journal on Scientific and
  Statistical Computing, 16, 5, pp. 1190-1208.
* C. Zhu, R. H. Byrd and J. Nocedal. L-BFGS-B: Algorithm 778: L-BFGS-B,
  FORTRAN routines for large scale bound constrained optimization (1997),
  ACM Transactions on Mathematical Software, 23, 4, pp. 550 - 560.
* J.L. Morales and J. Nocedal. L-BFGS-B: Remark on Algorithm 778: L-BFGS-B,
  FORTRAN routines for large scale bound constrained optimization (2011),
  ACM Transactions on Mathematical Software, 38, 1.</pre> <div class="fragment"><div class="line"><span class="lineno">   53</span>                  callback=<span class="keywordtype">None</span>, maxls=20):</div>
<div class="line"><span class="lineno">   54</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    Minimize a function func using the L-BFGS-B algorithm.</span></div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">    func : callable f(x,*args)</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">        Function to minimize.</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">    x0 : ndarray</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">        Initial guess.</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    fprime : callable fprime(x,*args), optional</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">        The gradient of `func`. If None, then `func` returns the function</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        value and the gradient (``f, g = func(x, *args)``), unless</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">        `approx_grad` is True in which case `func` returns only ``f``.</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    args : sequence, optional</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        Arguments to pass to `func` and `fprime`.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    approx_grad : bool, optional</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        Whether to approximate the gradient numerically (in which case</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">        `func` returns only the function value).</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    bounds : list, optional</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        ``(min, max)`` pairs for each element in ``x``, defining</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        the bounds on that parameter. Use None or +-inf for one of ``min`` or</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        ``max`` when there is no bound in that direction.</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">    m : int, optional</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">        The maximum number of variable metric corrections</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        used to define the limited memory matrix. (The limited memory BFGS</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">        method does not store the full hessian but uses this many terms in an</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">        approximation to it.)</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    factr : float, optional</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">        The iteration stops when</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">        ``(f^k - f^{k+1})/max{|f^k|,|f^{k+1}|,1} &lt;= factr * eps``,</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">        where ``eps`` is the machine precision, which is automatically</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        generated by the code. Typical values for `factr` are: 1e12 for</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        low accuracy; 1e7 for moderate accuracy; 10.0 for extremely</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        high accuracy. See Notes for relationship to `ftol`, which is exposed</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">        (instead of `factr`) by the `scipy.optimize.minimize` interface to</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">        L-BFGS-B.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    pgtol : float, optional</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">        The iteration will stop when</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">        ``max{|proj g_i | i = 1, ..., n} &lt;= pgtol``</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">        where ``pg_i`` is the i-th component of the projected gradient.</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    epsilon : float, optional</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">        Step size used when `approx_grad` is True, for numerically</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">        calculating the gradient</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    iprint : int, optional</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">        Controls the frequency of output. ``iprint &lt; 0`` means no output;</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">        ``iprint = 0``    print only one line at the last iteration;</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">        ``0 &lt; iprint &lt; 99`` print also f and ``|proj g|`` every iprint iterations;</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">        ``iprint = 99``   print details of every iteration except n-vectors;</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">        ``iprint = 100``  print also the changes of active set and final x;</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">        ``iprint &gt; 100``  print details of every iteration including x and g.</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    disp : int, optional</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">        If zero, then no output. If a positive number, then this over-rides</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">        `iprint` (i.e., `iprint` gets the value of `disp`).</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral">    maxfun : int, optional</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">        Maximum number of function evaluations. Note that this function</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">        may violate the limit because of evaluating gradients by numerical</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">        differentiation.</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">        Maximum number of iterations.</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">        Called after each iteration, as ``callback(xk)``, where ``xk`` is the</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">        current parameter vector.</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">    maxls : int, optional</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">        Maximum number of line search steps (per iteration). Default is 20.</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    x : array_like</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">        Estimated position of the minimum.</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    f : float</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">        Value of `func` at the minimum.</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    d : dict</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">        Information dictionary.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">        * d[&#39;warnflag&#39;] is</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">          - 0 if converged,</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">          - 1 if too many function evaluations or too many iterations,</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">          - 2 if stopped for another reason, given in d[&#39;task&#39;]</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">        * d[&#39;grad&#39;] is the gradient at the minimum (should be 0 ish)</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">        * d[&#39;funcalls&#39;] is the number of function calls made.</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">        * d[&#39;nit&#39;] is the number of iterations.</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    See also</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    minimize: Interface to minimization algorithms for multivariate</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">        functions. See the &#39;L-BFGS-B&#39; `method` in particular. Note that the</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">        `ftol` option is made available via that interface, while `factr` is</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">        provided via this interface, where `factr` is the factor multiplying</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        the default machine floating-point precision to arrive at `ftol`:</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">        ``ftol = factr * numpy.finfo(float).eps``.</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    License of L-BFGS-B (FORTRAN code):</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    The version included here (in fortran code) is 3.0</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    (released April 25, 2011). It was written by Ciyou Zhu, Richard Byrd,</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    and Jorge Nocedal &lt;nocedal@ece.nwu.edu&gt;. It carries the following</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    condition for use:</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    This software is freely available, but we expect that all publications</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    describing work using this software, or all commercial products using it,</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    quote at least one of the references given below. This software is released</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    under the BSD License.</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    * R. H. Byrd, P. Lu and J. Nocedal. A Limited Memory Algorithm for Bound</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">      Constrained Optimization, (1995), SIAM Journal on Scientific and</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">      Statistical Computing, 16, 5, pp. 1190-1208.</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">    * C. Zhu, R. H. Byrd and J. Nocedal. L-BFGS-B: Algorithm 778: L-BFGS-B,</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">      FORTRAN routines for large scale bound constrained optimization (1997),</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">      ACM Transactions on Mathematical Software, 23, 4, pp. 550 - 560.</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">    * J.L. Morales and J. Nocedal. L-BFGS-B: Remark on Algorithm 778: L-BFGS-B,</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">      FORTRAN routines for large scale bound constrained optimization (2011),</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">      ACM Transactions on Mathematical Software, 38, 1.</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  174</span>    <span class="comment"># handle fprime/approx_grad</span></div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">if</span> approx_grad:</div>
<div class="line"><span class="lineno">  176</span>        fun = func</div>
<div class="line"><span class="lineno">  177</span>        jac = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordflow">elif</span> fprime <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  179</span>        fun = MemoizeJac(func)</div>
<div class="line"><span class="lineno">  180</span>        jac = fun.derivative</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  182</span>        fun = func</div>
<div class="line"><span class="lineno">  183</span>        jac = fprime</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    <span class="comment"># build options</span></div>
<div class="line"><span class="lineno">  186</span>    opts = {<span class="stringliteral">&#39;disp&#39;</span>: disp,</div>
<div class="line"><span class="lineno">  187</span>            <span class="stringliteral">&#39;iprint&#39;</span>: iprint,</div>
<div class="line"><span class="lineno">  188</span>            <span class="stringliteral">&#39;maxcor&#39;</span>: m,</div>
<div class="line"><span class="lineno">  189</span>            <span class="stringliteral">&#39;ftol&#39;</span>: factr * np.finfo(float).eps,</div>
<div class="line"><span class="lineno">  190</span>            <span class="stringliteral">&#39;gtol&#39;</span>: pgtol,</div>
<div class="line"><span class="lineno">  191</span>            <span class="stringliteral">&#39;eps&#39;</span>: epsilon,</div>
<div class="line"><span class="lineno">  192</span>            <span class="stringliteral">&#39;maxfun&#39;</span>: maxfun,</div>
<div class="line"><span class="lineno">  193</span>            <span class="stringliteral">&#39;maxiter&#39;</span>: maxiter,</div>
<div class="line"><span class="lineno">  194</span>            <span class="stringliteral">&#39;callback&#39;</span>: callback,</div>
<div class="line"><span class="lineno">  195</span>            <span class="stringliteral">&#39;maxls&#39;</span>: maxls}</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>    res = _minimize_lbfgsb(fun, x0, args=args, jac=jac, bounds=bounds,</div>
<div class="line"><span class="lineno">  198</span>                           **opts)</div>
<div class="line"><span class="lineno">  199</span>    d = {<span class="stringliteral">&#39;grad&#39;</span>: res[<span class="stringliteral">&#39;jac&#39;</span>],</div>
<div class="line"><span class="lineno">  200</span>         <span class="stringliteral">&#39;task&#39;</span>: res[<span class="stringliteral">&#39;message&#39;</span>],</div>
<div class="line"><span class="lineno">  201</span>         <span class="stringliteral">&#39;funcalls&#39;</span>: res[<span class="stringliteral">&#39;nfev&#39;</span>],</div>
<div class="line"><span class="lineno">  202</span>         <span class="stringliteral">&#39;nit&#39;</span>: res[<span class="stringliteral">&#39;nit&#39;</span>],</div>
<div class="line"><span class="lineno">  203</span>         <span class="stringliteral">&#39;warnflag&#39;</span>: res[<span class="stringliteral">&#39;status&#39;</span>]}</div>
<div class="line"><span class="lineno">  204</span>    f = res[<span class="stringliteral">&#39;fun&#39;</span>]</div>
<div class="line"><span class="lineno">  205</span>    x = res[<span class="stringliteral">&#39;x&#39;</span>]</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">return</span> x, f, d</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
