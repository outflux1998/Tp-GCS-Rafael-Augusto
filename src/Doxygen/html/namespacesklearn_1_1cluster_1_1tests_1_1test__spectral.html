<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.cluster.tests.test_spectral Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1cluster.html">cluster</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1cluster_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html">test_spectral</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sklearn.cluster.tests.test_spectral Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a35fe218d47fc8809ce6234e4155e14ca" id="r_a35fe218d47fc8809ce6234e4155e14ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a35fe218d47fc8809ce6234e4155e14ca">test_spectral_clustering</a> (eigen_solver, assign_labels)</td></tr>
<tr class="separator:a35fe218d47fc8809ce6234e4155e14ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb427062dba4bcb1a52bac9972debeba" id="r_aeb427062dba4bcb1a52bac9972debeba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#aeb427062dba4bcb1a52bac9972debeba">test_spectral_clustering_sparse</a> (assign_labels)</td></tr>
<tr class="separator:aeb427062dba4bcb1a52bac9972debeba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2998eb509299b492fa42730949adedd" id="r_af2998eb509299b492fa42730949adedd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#af2998eb509299b492fa42730949adedd">test_precomputed_nearest_neighbors_filtering</a> ()</td></tr>
<tr class="separator:af2998eb509299b492fa42730949adedd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5206c05d6faa2ab09a486bca2b25a8d0" id="r_a5206c05d6faa2ab09a486bca2b25a8d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a5206c05d6faa2ab09a486bca2b25a8d0">test_affinities</a> ()</td></tr>
<tr class="separator:a5206c05d6faa2ab09a486bca2b25a8d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a463e90ce8e34e5cf9dae5725b2fa6a" id="r_a7a463e90ce8e34e5cf9dae5725b2fa6a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a7a463e90ce8e34e5cf9dae5725b2fa6a">test_cluster_qr</a> ()</td></tr>
<tr class="separator:a7a463e90ce8e34e5cf9dae5725b2fa6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd8d9b803c17e4e6b2c4b84d4861a0a" id="r_acdd8d9b803c17e4e6b2c4b84d4861a0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#acdd8d9b803c17e4e6b2c4b84d4861a0a">test_cluster_qr_permutation_invariance</a> ()</td></tr>
<tr class="separator:acdd8d9b803c17e4e6b2c4b84d4861a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a8b43a788fc330504c1f88fffc26685" id="r_a5a8b43a788fc330504c1f88fffc26685"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a5a8b43a788fc330504c1f88fffc26685">test_discretize</a> (<a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#af14fe07d510072695adc185e05bbcc08">n_samples</a>)</td></tr>
<tr class="separator:a5a8b43a788fc330504c1f88fffc26685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cbb324c31f118f17b1745dc93f46566" id="r_a4cbb324c31f118f17b1745dc93f46566"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a4cbb324c31f118f17b1745dc93f46566">test_spectral_clustering_with_arpack_amg_solvers</a> ()</td></tr>
<tr class="separator:a4cbb324c31f118f17b1745dc93f46566"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a019d7fb2ae4497aeefab2d47c4af5f" id="r_a8a019d7fb2ae4497aeefab2d47c4af5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a8a019d7fb2ae4497aeefab2d47c4af5f">test_n_components</a> ()</td></tr>
<tr class="separator:a8a019d7fb2ae4497aeefab2d47c4af5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8074e3efa6ac9866dbf4ce7312915ece" id="r_a8074e3efa6ac9866dbf4ce7312915ece"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a8074e3efa6ac9866dbf4ce7312915ece">test_verbose</a> (assign_labels, capsys)</td></tr>
<tr class="separator:a8074e3efa6ac9866dbf4ce7312915ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d121caab2c39def7e021101abe2238d" id="r_a4d121caab2c39def7e021101abe2238d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a4d121caab2c39def7e021101abe2238d">test_spectral_clustering_np_matrix_raises</a> ()</td></tr>
<tr class="separator:a4d121caab2c39def7e021101abe2238d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0fe8c060f10e0189d6bb9df236a4d8" id="r_a7c0fe8c060f10e0189d6bb9df236a4d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a7c0fe8c060f10e0189d6bb9df236a4d8">test_spectral_clustering_not_infinite_loop</a> (capsys, monkeypatch)</td></tr>
<tr class="separator:a7c0fe8c060f10e0189d6bb9df236a4d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a73084bd70acefcf290705f42cb70dd0c" id="r_a73084bd70acefcf290705f42cb70dd0c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a73084bd70acefcf290705f42cb70dd0c">amg_loaded</a> = True</td></tr>
<tr class="separator:a73084bd70acefcf290705f42cb70dd0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a772522c961782ee582656b736624e339" id="r_a772522c961782ee582656b736624e339"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a772522c961782ee582656b736624e339">centers</a> = np.array([[1, 1], [-1, -1], [1, -1]]) + 10</td></tr>
<tr class="separator:a772522c961782ee582656b736624e339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51be97ddbf8782b51f2e3e719781fc44" id="r_a51be97ddbf8782b51f2e3e719781fc44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a51be97ddbf8782b51f2e3e719781fc44">X</a></td></tr>
<tr class="separator:a51be97ddbf8782b51f2e3e719781fc44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e8f9b7ad66417dbaefee8e8f45197c" id="r_a28e8f9b7ad66417dbaefee8e8f45197c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a28e8f9b7ad66417dbaefee8e8f45197c">_</a></td></tr>
<tr class="separator:a28e8f9b7ad66417dbaefee8e8f45197c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14fe07d510072695adc185e05bbcc08" id="r_af14fe07d510072695adc185e05bbcc08"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#af14fe07d510072695adc185e05bbcc08">n_samples</a></td></tr>
<tr class="separator:af14fe07d510072695adc185e05bbcc08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4f7c4e573e4ff096f9fcaee0b57ec47" id="r_ab4f7c4e573e4ff096f9fcaee0b57ec47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#ab4f7c4e573e4ff096f9fcaee0b57ec47">n_features</a></td></tr>
<tr class="separator:ab4f7c4e573e4ff096f9fcaee0b57ec47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a700875787dcbf961128b80fbcdcf1344" id="r_a700875787dcbf961128b80fbcdcf1344"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#a700875787dcbf961128b80fbcdcf1344">cluster_std</a></td></tr>
<tr class="separator:a700875787dcbf961128b80fbcdcf1344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f04c2c5318790ab3331c22a23591dc" id="r_aa8f04c2c5318790ab3331c22a23591dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#aa8f04c2c5318790ab3331c22a23591dc">shuffle</a></td></tr>
<tr class="separator:aa8f04c2c5318790ab3331c22a23591dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa3295f48616946c602d213324663ccf" id="r_afa3295f48616946c602d213324663ccf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1cluster_1_1tests_1_1test__spectral.html#afa3295f48616946c602d213324663ccf">random_state</a></td></tr>
<tr class="separator:afa3295f48616946c602d213324663ccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Testing for Spectral Clustering methods</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a5206c05d6faa2ab09a486bca2b25a8d0" name="a5206c05d6faa2ab09a486bca2b25a8d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5206c05d6faa2ab09a486bca2b25a8d0">&#9670;&#160;</a></span>test_affinities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_affinities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  125</span><span class="keyword">def </span>test_affinities():</div>
<div class="line"><span class="lineno">  126</span>    <span class="comment"># Note: in the following, random_state has been selected to have</span></div>
<div class="line"><span class="lineno">  127</span>    <span class="comment"># a dataset that yields a stable eigen decomposition both when built</span></div>
<div class="line"><span class="lineno">  128</span>    <span class="comment"># on OSX and Linux</span></div>
<div class="line"><span class="lineno">  129</span>    X, y = make_blobs(</div>
<div class="line"><span class="lineno">  130</span>        n_samples=20, random_state=0, centers=[[1, 1], [-1, -1]], cluster_std=0.01</div>
<div class="line"><span class="lineno">  131</span>    )</div>
<div class="line"><span class="lineno">  132</span>    <span class="comment"># nearest neighbors affinity</span></div>
<div class="line"><span class="lineno">  133</span>    sp = SpectralClustering(n_clusters=2, affinity=<span class="stringliteral">&quot;nearest_neighbors&quot;</span>, random_state=0)</div>
<div class="line"><span class="lineno">  134</span>    <span class="keyword">with</span> pytest.warns(UserWarning, match=<span class="stringliteral">&quot;not fully connected&quot;</span>):</div>
<div class="line"><span class="lineno">  135</span>        sp.fit(X)</div>
<div class="line"><span class="lineno">  136</span>    <span class="keyword">assert</span> adjusted_rand_score(y, sp.labels_) == 1</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    sp = SpectralClustering(n_clusters=2, gamma=2, random_state=0)</div>
<div class="line"><span class="lineno">  139</span>    labels = sp.fit(X).labels_</div>
<div class="line"><span class="lineno">  140</span>    <span class="keyword">assert</span> adjusted_rand_score(y, labels) == 1</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    X = check_random_state(10).rand(10, 5) * 10</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    kernels_available = kernel_metrics()</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">for</span> kern <span class="keywordflow">in</span> kernels_available:</div>
<div class="line"><span class="lineno">  146</span>        <span class="comment"># Additive chi^2 gives a negative similarity matrix which</span></div>
<div class="line"><span class="lineno">  147</span>        <span class="comment"># doesn&#39;t make sense for spectral clustering</span></div>
<div class="line"><span class="lineno">  148</span>        <span class="keywordflow">if</span> kern != <span class="stringliteral">&quot;additive_chi2&quot;</span>:</div>
<div class="line"><span class="lineno">  149</span>            sp = SpectralClustering(n_clusters=2, affinity=kern, random_state=0)</div>
<div class="line"><span class="lineno">  150</span>            labels = sp.fit(X).labels_</div>
<div class="line"><span class="lineno">  151</span>            <span class="keyword">assert</span> (X.shape[0],) == labels.shape</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    sp = SpectralClustering(n_clusters=2, affinity=<span class="keyword">lambda</span> x, y: 1, random_state=0)</div>
<div class="line"><span class="lineno">  154</span>    labels = sp.fit(X).labels_</div>
<div class="line"><span class="lineno">  155</span>    <span class="keyword">assert</span> (X.shape[0],) == labels.shape</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="keyword">def </span>histogram(x, y, **kwargs):</div>
<div class="line"><span class="lineno">  158</span>        <span class="comment"># Histogram kernel implemented as a callable.</span></div>
<div class="line"><span class="lineno">  159</span>        <span class="keyword">assert</span> kwargs == {}  <span class="comment"># no kernel_params that we didn&#39;t ask for</span></div>
<div class="line"><span class="lineno">  160</span>        <span class="keywordflow">return</span> np.minimum(x, y).sum()</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    sp = SpectralClustering(n_clusters=2, affinity=histogram, random_state=0)</div>
<div class="line"><span class="lineno">  163</span>    labels = sp.fit(X).labels_</div>
<div class="line"><span class="lineno">  164</span>    <span class="keyword">assert</span> (X.shape[0],) == labels.shape</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a463e90ce8e34e5cf9dae5725b2fa6a" name="a7a463e90ce8e34e5cf9dae5725b2fa6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a463e90ce8e34e5cf9dae5725b2fa6a">&#9670;&#160;</a></span>test_cluster_qr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_cluster_qr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  167</span><span class="keyword">def </span>test_cluster_qr():</div>
<div class="line"><span class="lineno">  168</span>    <span class="comment"># cluster_qr by itself should not be used for clustering generic data</span></div>
<div class="line"><span class="lineno">  169</span>    <span class="comment"># other than the rows of the eigenvectors within spectral clustering,</span></div>
<div class="line"><span class="lineno">  170</span>    <span class="comment"># but cluster_qr must still preserve the labels for different dtypes</span></div>
<div class="line"><span class="lineno">  171</span>    <span class="comment"># of the generic fixed input even if the labels may be meaningless.</span></div>
<div class="line"><span class="lineno">  172</span>    random_state = np.random.RandomState(seed=8)</div>
<div class="line"><span class="lineno">  173</span>    n_samples, n_components = 10, 5</div>
<div class="line"><span class="lineno">  174</span>    data = random_state.randn(n_samples, n_components)</div>
<div class="line"><span class="lineno">  175</span>    labels_float64 = cluster_qr(data.astype(np.float64))</div>
<div class="line"><span class="lineno">  176</span>    <span class="comment"># Each sample is assigned a cluster identifier</span></div>
<div class="line"><span class="lineno">  177</span>    <span class="keyword">assert</span> labels_float64.shape == (n_samples,)</div>
<div class="line"><span class="lineno">  178</span>    <span class="comment"># All components should be covered by the assignment</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="keyword">assert</span> np.array_equal(np.unique(labels_float64), np.arange(n_components))</div>
<div class="line"><span class="lineno">  180</span>    <span class="comment"># Single precision data should yield the same cluster assignments</span></div>
<div class="line"><span class="lineno">  181</span>    labels_float32 = cluster_qr(data.astype(np.float32))</div>
<div class="line"><span class="lineno">  182</span>    <span class="keyword">assert</span> np.array_equal(labels_float64, labels_float32)</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acdd8d9b803c17e4e6b2c4b84d4861a0a" name="acdd8d9b803c17e4e6b2c4b84d4861a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdd8d9b803c17e4e6b2c4b84d4861a0a">&#9670;&#160;</a></span>test_cluster_qr_permutation_invariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_cluster_qr_permutation_invariance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  185</span><span class="keyword">def </span>test_cluster_qr_permutation_invariance():</div>
<div class="line"><span class="lineno">  186</span>    <span class="comment"># cluster_qr must be invariant to sample permutation.</span></div>
<div class="line"><span class="lineno">  187</span>    random_state = np.random.RandomState(seed=8)</div>
<div class="line"><span class="lineno">  188</span>    n_samples, n_components = 100, 5</div>
<div class="line"><span class="lineno">  189</span>    data = random_state.randn(n_samples, n_components)</div>
<div class="line"><span class="lineno">  190</span>    perm = random_state.permutation(n_samples)</div>
<div class="line"><span class="lineno">  191</span>    <span class="keyword">assert</span> np.array_equal(</div>
<div class="line"><span class="lineno">  192</span>        cluster_qr(data)[perm],</div>
<div class="line"><span class="lineno">  193</span>        cluster_qr(data[perm]),</div>
<div class="line"><span class="lineno">  194</span>    )</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span><span class="preprocessor">@pytest.mark.parametrize(&quot;n_samples&quot;, [50, 100, 150, 500])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a8b43a788fc330504c1f88fffc26685" name="a5a8b43a788fc330504c1f88fffc26685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a8b43a788fc330504c1f88fffc26685">&#9670;&#160;</a></span>test_discretize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_discretize </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_samples</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  198</span><span class="keyword">def </span>test_discretize(n_samples):</div>
<div class="line"><span class="lineno">  199</span>    <span class="comment"># Test the discretize using a noise assignment matrix</span></div>
<div class="line"><span class="lineno">  200</span>    random_state = np.random.RandomState(seed=8)</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">for</span> n_class <span class="keywordflow">in</span> range(2, 10):</div>
<div class="line"><span class="lineno">  202</span>        <span class="comment"># random class labels</span></div>
<div class="line"><span class="lineno">  203</span>        y_true = random_state.randint(0, n_class + 1, n_samples)</div>
<div class="line"><span class="lineno">  204</span>        y_true = np.array(y_true, float)</div>
<div class="line"><span class="lineno">  205</span>        <span class="comment"># noise class assignment matrix</span></div>
<div class="line"><span class="lineno">  206</span>        y_indicator = sparse.coo_matrix(</div>
<div class="line"><span class="lineno">  207</span>            (np.ones(n_samples), (np.arange(n_samples), y_true)),</div>
<div class="line"><span class="lineno">  208</span>            shape=(n_samples, n_class + 1),</div>
<div class="line"><span class="lineno">  209</span>        )</div>
<div class="line"><span class="lineno">  210</span>        y_true_noisy = y_indicator.toarray() + 0.1 * random_state.randn(</div>
<div class="line"><span class="lineno">  211</span>            n_samples, n_class + 1</div>
<div class="line"><span class="lineno">  212</span>        )</div>
<div class="line"><span class="lineno">  213</span>        y_pred = discretize(y_true_noisy, random_state=random_state)</div>
<div class="line"><span class="lineno">  214</span>        <span class="keyword">assert</span> adjusted_rand_score(y_true, y_pred) &gt; 0.8</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span><span class="comment"># TODO: Remove when pyamg does replaces sp.rand call with np.random.rand</span></div>
<div class="line"><span class="lineno">  218</span><span class="comment"># https://github.com/scikit-learn/scikit-learn/issues/15913</span></div>
<div class="line"><span class="lineno">  219</span><span class="preprocessor">@pytest.mark.filterwarnings</span>(</div>
<div class="line"><span class="lineno">  220</span>    <span class="stringliteral">&quot;ignore:scipy.rand is deprecated:DeprecationWarning:pyamg.*&quot;</span></div>
<div class="line"><span class="lineno">  221</span>)</div>
<div class="line"><span class="lineno">  222</span><span class="comment"># TODO: Remove when pyamg removes the use of np.float</span></div>
<div class="line"><span class="lineno">  223</span><span class="preprocessor">@pytest.mark.filterwarnings</span>(</div>
<div class="line"><span class="lineno">  224</span>    <span class="stringliteral">&quot;ignore:`np.float` is a deprecated alias:DeprecationWarning:pyamg.*&quot;</span></div>
<div class="line"><span class="lineno">  225</span>)</div>
<div class="line"><span class="lineno">  226</span><span class="comment"># TODO: Remove when pyamg removes the use of pinv2</span></div>
<div class="line"><span class="lineno">  227</span><span class="preprocessor">@pytest.mark.filterwarnings</span>(</div>
<div class="line"><span class="lineno">  228</span>    <span class="stringliteral">&quot;ignore:scipy.linalg.pinv2 is deprecated:DeprecationWarning:pyamg.*&quot;</span></div>
<div class="line"><span class="lineno">  229</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a019d7fb2ae4497aeefab2d47c4af5f" name="a8a019d7fb2ae4497aeefab2d47c4af5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a019d7fb2ae4497aeefab2d47c4af5f">&#9670;&#160;</a></span>test_n_components()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_n_components </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  266</span><span class="keyword">def </span>test_n_components():</div>
<div class="line"><span class="lineno">  267</span>    <span class="comment"># Test that after adding n_components, result is different and</span></div>
<div class="line"><span class="lineno">  268</span>    <span class="comment"># n_components = n_clusters by default</span></div>
<div class="line"><span class="lineno">  269</span>    X, y = make_blobs(</div>
<div class="line"><span class="lineno">  270</span>        n_samples=20, random_state=0, centers=[[1, 1], [-1, -1]], cluster_std=0.01</div>
<div class="line"><span class="lineno">  271</span>    )</div>
<div class="line"><span class="lineno">  272</span>    sp = SpectralClustering(n_clusters=2, random_state=0)</div>
<div class="line"><span class="lineno">  273</span>    labels = sp.fit(X).labels_</div>
<div class="line"><span class="lineno">  274</span>    <span class="comment"># set n_components = n_cluster and test if result is the same</span></div>
<div class="line"><span class="lineno">  275</span>    labels_same_ncomp = (</div>
<div class="line"><span class="lineno">  276</span>        SpectralClustering(n_clusters=2, n_components=2, random_state=0).fit(X).labels_</div>
<div class="line"><span class="lineno">  277</span>    )</div>
<div class="line"><span class="lineno">  278</span>    <span class="comment"># test that n_components=n_clusters by default</span></div>
<div class="line"><span class="lineno">  279</span>    assert_array_equal(labels, labels_same_ncomp)</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="comment"># test that n_components affect result</span></div>
<div class="line"><span class="lineno">  282</span>    <span class="comment"># n_clusters=8 by default, and set n_components=2</span></div>
<div class="line"><span class="lineno">  283</span>    labels_diff_ncomp = (</div>
<div class="line"><span class="lineno">  284</span>        SpectralClustering(n_components=2, random_state=0).fit(X).labels_</div>
<div class="line"><span class="lineno">  285</span>    )</div>
<div class="line"><span class="lineno">  286</span>    <span class="keyword">assert</span> <span class="keywordflow">not</span> np.array_equal(labels, labels_diff_ncomp)</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span><span class="preprocessor">@pytest.mark.parametrize(&quot;assign_labels&quot;, (&quot;kmeans&quot;, &quot;discretize&quot;, &quot;cluster_qr&quot;)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2998eb509299b492fa42730949adedd" name="af2998eb509299b492fa42730949adedd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2998eb509299b492fa42730949adedd">&#9670;&#160;</a></span>test_precomputed_nearest_neighbors_filtering()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_precomputed_nearest_neighbors_filtering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   99</span><span class="keyword">def </span>test_precomputed_nearest_neighbors_filtering():</div>
<div class="line"><span class="lineno">  100</span>    <span class="comment"># Test precomputed graph filtering when containing too many neighbors</span></div>
<div class="line"><span class="lineno">  101</span>    X, y = make_blobs(</div>
<div class="line"><span class="lineno">  102</span>        n_samples=200, random_state=0, centers=[[1, 1], [-1, -1]], cluster_std=0.01</div>
<div class="line"><span class="lineno">  103</span>    )</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    n_neighbors = 2</div>
<div class="line"><span class="lineno">  106</span>    results = []</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">for</span> additional_neighbors <span class="keywordflow">in</span> [0, 10]:</div>
<div class="line"><span class="lineno">  108</span>        nn = NearestNeighbors(n_neighbors=n_neighbors + additional_neighbors).fit(X)</div>
<div class="line"><span class="lineno">  109</span>        graph = nn.kneighbors_graph(X, mode=<span class="stringliteral">&quot;connectivity&quot;</span>)</div>
<div class="line"><span class="lineno">  110</span>        labels = (</div>
<div class="line"><span class="lineno">  111</span>            SpectralClustering(</div>
<div class="line"><span class="lineno">  112</span>                random_state=0,</div>
<div class="line"><span class="lineno">  113</span>                n_clusters=2,</div>
<div class="line"><span class="lineno">  114</span>                affinity=<span class="stringliteral">&quot;precomputed_nearest_neighbors&quot;</span>,</div>
<div class="line"><span class="lineno">  115</span>                n_neighbors=n_neighbors,</div>
<div class="line"><span class="lineno">  116</span>            )</div>
<div class="line"><span class="lineno">  117</span>            .fit(graph)</div>
<div class="line"><span class="lineno">  118</span>            .labels_</div>
<div class="line"><span class="lineno">  119</span>        )</div>
<div class="line"><span class="lineno">  120</span>        results.append(labels)</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    assert_array_equal(results[0], results[1])</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a35fe218d47fc8809ce6234e4155e14ca" name="a35fe218d47fc8809ce6234e4155e14ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35fe218d47fc8809ce6234e4155e14ca">&#9670;&#160;</a></span>test_spectral_clustering()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_spectral_clustering </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eigen_solver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>assign_labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   43</span><span class="keyword">def </span>test_spectral_clustering(eigen_solver, assign_labels):</div>
<div class="line"><span class="lineno">   44</span>    S = np.array(</div>
<div class="line"><span class="lineno">   45</span>        [</div>
<div class="line"><span class="lineno">   46</span>            [1.0, 1.0, 1.0, 0.2, 0.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">   47</span>            [1.0, 1.0, 1.0, 0.2, 0.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">   48</span>            [1.0, 1.0, 1.0, 0.2, 0.0, 0.0, 0.0],</div>
<div class="line"><span class="lineno">   49</span>            [0.2, 0.2, 0.2, 1.0, 1.0, 1.0, 1.0],</div>
<div class="line"><span class="lineno">   50</span>            [0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0],</div>
<div class="line"><span class="lineno">   51</span>            [0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0],</div>
<div class="line"><span class="lineno">   52</span>            [0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0],</div>
<div class="line"><span class="lineno">   53</span>        ]</div>
<div class="line"><span class="lineno">   54</span>    )</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">for</span> mat <span class="keywordflow">in</span> (S, sparse.csr_matrix(S)):</div>
<div class="line"><span class="lineno">   57</span>        model = SpectralClustering(</div>
<div class="line"><span class="lineno">   58</span>            random_state=0,</div>
<div class="line"><span class="lineno">   59</span>            n_clusters=2,</div>
<div class="line"><span class="lineno">   60</span>            affinity=<span class="stringliteral">&quot;precomputed&quot;</span>,</div>
<div class="line"><span class="lineno">   61</span>            eigen_solver=eigen_solver,</div>
<div class="line"><span class="lineno">   62</span>            assign_labels=assign_labels,</div>
<div class="line"><span class="lineno">   63</span>        ).fit(mat)</div>
<div class="line"><span class="lineno">   64</span>        labels = model.labels_</div>
<div class="line"><span class="lineno">   65</span>        <span class="keywordflow">if</span> labels[0] == 0:</div>
<div class="line"><span class="lineno">   66</span>            labels = 1 - labels</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>        <span class="keyword">assert</span> adjusted_rand_score(labels, [1, 1, 1, 0, 0, 0, 0]) == 1</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>        model_copy = pickle.loads(pickle.dumps(model))</div>
<div class="line"><span class="lineno">   71</span>        <span class="keyword">assert</span> model_copy.n_clusters == model.n_clusters</div>
<div class="line"><span class="lineno">   72</span>        <span class="keyword">assert</span> model_copy.eigen_solver == model.eigen_solver</div>
<div class="line"><span class="lineno">   73</span>        assert_array_equal(model_copy.labels_, model.labels_)</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span><span class="preprocessor">@pytest.mark.parametrize(&quot;assign_labels&quot;, (&quot;kmeans&quot;, &quot;discretize&quot;, &quot;cluster_qr&quot;)</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c0fe8c060f10e0189d6bb9df236a4d8" name="a7c0fe8c060f10e0189d6bb9df236a4d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c0fe8c060f10e0189d6bb9df236a4d8">&#9670;&#160;</a></span>test_spectral_clustering_not_infinite_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_spectral_clustering_not_infinite_loop </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>capsys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>monkeypatch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that discretize raises LinAlgError when svd never converges.

Non-regression test for #21380
</pre> <div class="fragment"><div class="line"><span class="lineno">  317</span><span class="keyword">def </span>test_spectral_clustering_not_infinite_loop(capsys, monkeypatch):</div>
<div class="line"><span class="lineno">  318</span>    <span class="stringliteral">&quot;&quot;&quot;Check that discretize raises LinAlgError when svd never converges.</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">    Non-regression test for #21380</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="keyword">def </span>new_svd(*args, **kwargs):</div>
<div class="line"><span class="lineno">  324</span>        <span class="keywordflow">raise</span> LinAlgError()</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    monkeypatch.setattr(<a class="code hl_namespace" href="namespacenp_1_1linalg.html">np.linalg</a>, <span class="stringliteral">&quot;svd&quot;</span>, new_svd)</div>
<div class="line"><span class="lineno">  327</span>    vectors = np.ones((10, 4))</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>    <span class="keyword">with</span> pytest.raises(LinAlgError, match=<span class="stringliteral">&quot;SVD did not converge&quot;</span>):</div>
<div class="line"><span class="lineno">  330</span>        discretize(vectors)</div>
<div class="ttc" id="anamespacenp_1_1linalg_html"><div class="ttname"><a href="namespacenp_1_1linalg.html">np.linalg</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d121caab2c39def7e021101abe2238d" name="a4d121caab2c39def7e021101abe2238d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d121caab2c39def7e021101abe2238d">&#9670;&#160;</a></span>test_spectral_clustering_np_matrix_raises()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_spectral_clustering_np_matrix_raises </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that spectral_clustering raises an informative error when passed
a np.matrix. See #10993</pre> <div class="fragment"><div class="line"><span class="lineno">  307</span><span class="keyword">def </span>test_spectral_clustering_np_matrix_raises():</div>
<div class="line"><span class="lineno">  308</span>    <span class="stringliteral">&quot;&quot;&quot;Check that spectral_clustering raises an informative error when passed</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">    a np.matrix. See #10993&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  310</span>    X = np.matrix([[0.0, 2.0], [2.0, 0.0]])</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>    msg = <span class="stringliteral">r&quot;spectral_clustering does not support passing in affinity as an np\.matrix&quot;</span></div>
<div class="line"><span class="lineno">  313</span>    <span class="keyword">with</span> pytest.raises(TypeError, match=msg):</div>
<div class="line"><span class="lineno">  314</span>        spectral_clustering(X)</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb427062dba4bcb1a52bac9972debeba" name="aeb427062dba4bcb1a52bac9972debeba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb427062dba4bcb1a52bac9972debeba">&#9670;&#160;</a></span>test_spectral_clustering_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_spectral_clustering_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>assign_labels</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   77</span><span class="keyword">def </span>test_spectral_clustering_sparse(assign_labels):</div>
<div class="line"><span class="lineno">   78</span>    X, y = make_blobs(</div>
<div class="line"><span class="lineno">   79</span>        n_samples=20, random_state=0, centers=[[1, 1], [-1, -1]], cluster_std=0.01</div>
<div class="line"><span class="lineno">   80</span>    )</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    S = rbf_kernel(X, gamma=1)</div>
<div class="line"><span class="lineno">   83</span>    S = np.maximum(S - 1e-4, 0)</div>
<div class="line"><span class="lineno">   84</span>    S = sparse.coo_matrix(S)</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>    labels = (</div>
<div class="line"><span class="lineno">   87</span>        SpectralClustering(</div>
<div class="line"><span class="lineno">   88</span>            random_state=0,</div>
<div class="line"><span class="lineno">   89</span>            n_clusters=2,</div>
<div class="line"><span class="lineno">   90</span>            affinity=<span class="stringliteral">&quot;precomputed&quot;</span>,</div>
<div class="line"><span class="lineno">   91</span>            assign_labels=assign_labels,</div>
<div class="line"><span class="lineno">   92</span>        )</div>
<div class="line"><span class="lineno">   93</span>        .fit(S)</div>
<div class="line"><span class="lineno">   94</span>        .labels_</div>
<div class="line"><span class="lineno">   95</span>    )</div>
<div class="line"><span class="lineno">   96</span>    <span class="keyword">assert</span> adjusted_rand_score(y, labels) == 1</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4cbb324c31f118f17b1745dc93f46566" name="a4cbb324c31f118f17b1745dc93f46566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cbb324c31f118f17b1745dc93f46566">&#9670;&#160;</a></span>test_spectral_clustering_with_arpack_amg_solvers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_spectral_clustering_with_arpack_amg_solvers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  230</span><span class="keyword">def </span>test_spectral_clustering_with_arpack_amg_solvers():</div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># Test that spectral_clustering is the same for arpack and amg solver</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="comment"># Based on toy example from plot_segmentation_toy.py</span></div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    <span class="comment"># a small two coin image</span></div>
<div class="line"><span class="lineno">  235</span>    x, y = np.indices((40, 40))</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    center1, center2 = (14, 12), (20, 25)</div>
<div class="line"><span class="lineno">  238</span>    radius1, radius2 = 8, 7</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>    circle1 = (x - center1[0]) ** 2 + (y - center1[1]) ** 2 &lt; radius1**2</div>
<div class="line"><span class="lineno">  241</span>    circle2 = (x - center2[0]) ** 2 + (y - center2[1]) ** 2 &lt; radius2**2</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>    circles = circle1 | circle2</div>
<div class="line"><span class="lineno">  244</span>    mask = circles.copy()</div>
<div class="line"><span class="lineno">  245</span>    img = circles.astype(float)</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    graph = img_to_graph(img, mask=mask)</div>
<div class="line"><span class="lineno">  248</span>    graph.data = np.exp(-graph.data / graph.data.std())</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    labels_arpack = spectral_clustering(</div>
<div class="line"><span class="lineno">  251</span>        graph, n_clusters=2, eigen_solver=<span class="stringliteral">&quot;arpack&quot;</span>, random_state=0</div>
<div class="line"><span class="lineno">  252</span>    )</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    <span class="keyword">assert</span> len(np.unique(labels_arpack)) == 2</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">if</span> amg_loaded:</div>
<div class="line"><span class="lineno">  257</span>        labels_amg = spectral_clustering(</div>
<div class="line"><span class="lineno">  258</span>            graph, n_clusters=2, eigen_solver=<span class="stringliteral">&quot;amg&quot;</span>, random_state=0</div>
<div class="line"><span class="lineno">  259</span>        )</div>
<div class="line"><span class="lineno">  260</span>        <span class="keyword">assert</span> adjusted_rand_score(labels_arpack, labels_amg) == 1</div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  262</span>        <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  263</span>            spectral_clustering(graph, n_clusters=2, eigen_solver=<span class="stringliteral">&quot;amg&quot;</span>, random_state=0)</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8074e3efa6ac9866dbf4ce7312915ece" name="a8074e3efa6ac9866dbf4ce7312915ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8074e3efa6ac9866dbf4ce7312915ece">&#9670;&#160;</a></span>test_verbose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.test_verbose </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>assign_labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>capsys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  290</span><span class="keyword">def </span>test_verbose(assign_labels, capsys):</div>
<div class="line"><span class="lineno">  291</span>    <span class="comment"># Check verbose mode of KMeans for better coverage.</span></div>
<div class="line"><span class="lineno">  292</span>    X, y = make_blobs(</div>
<div class="line"><span class="lineno">  293</span>        n_samples=20, random_state=0, centers=[[1, 1], [-1, -1]], cluster_std=0.01</div>
<div class="line"><span class="lineno">  294</span>    )</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    SpectralClustering(n_clusters=2, random_state=42, verbose=1).fit(X)</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    captured = capsys.readouterr()</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="keyword">assert</span> re.search(<span class="stringliteral">r&quot;Computing label assignment using&quot;</span>, captured.out)</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">if</span> assign_labels == <span class="stringliteral">&quot;kmeans&quot;</span>:</div>
<div class="line"><span class="lineno">  303</span>        <span class="keyword">assert</span> re.search(<span class="stringliteral">r&quot;Initialization complete&quot;</span>, captured.out)</div>
<div class="line"><span class="lineno">  304</span>        <span class="keyword">assert</span> re.search(<span class="stringliteral">r&quot;Iteration [0-9]+, inertia&quot;</span>, captured.out)</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a28e8f9b7ad66417dbaefee8e8f45197c" name="a28e8f9b7ad66417dbaefee8e8f45197c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28e8f9b7ad66417dbaefee8e8f45197c">&#9670;&#160;</a></span>_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral._</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a73084bd70acefcf290705f42cb70dd0c" name="a73084bd70acefcf290705f42cb70dd0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73084bd70acefcf290705f42cb70dd0c">&#9670;&#160;</a></span>amg_loaded</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sklearn.cluster.tests.test_spectral.amg_loaded = True</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a772522c961782ee582656b736624e339" name="a772522c961782ee582656b736624e339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a772522c961782ee582656b736624e339">&#9670;&#160;</a></span>centers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.centers = np.array([[1, 1], [-1, -1], [1, -1]]) + 10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a700875787dcbf961128b80fbcdcf1344" name="a700875787dcbf961128b80fbcdcf1344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a700875787dcbf961128b80fbcdcf1344">&#9670;&#160;</a></span>cluster_std</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.cluster_std</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4f7c4e573e4ff096f9fcaee0b57ec47" name="ab4f7c4e573e4ff096f9fcaee0b57ec47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4f7c4e573e4ff096f9fcaee0b57ec47">&#9670;&#160;</a></span>n_features</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.n_features</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af14fe07d510072695adc185e05bbcc08" name="af14fe07d510072695adc185e05bbcc08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af14fe07d510072695adc185e05bbcc08">&#9670;&#160;</a></span>n_samples</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.n_samples</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afa3295f48616946c602d213324663ccf" name="afa3295f48616946c602d213324663ccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa3295f48616946c602d213324663ccf">&#9670;&#160;</a></span>random_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.random_state</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa8f04c2c5318790ab3331c22a23591dc" name="aa8f04c2c5318790ab3331c22a23591dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8f04c2c5318790ab3331c22a23591dc">&#9670;&#160;</a></span>shuffle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.shuffle</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a51be97ddbf8782b51f2e3e719781fc44" name="a51be97ddbf8782b51f2e3e719781fc44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51be97ddbf8782b51f2e3e719781fc44">&#9670;&#160;</a></span>X</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.cluster.tests.test_spectral.X</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
