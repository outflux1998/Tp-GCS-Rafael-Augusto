<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.special._precompute.gammainc_data Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1special.html">special</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1special_1_1__precompute.html">_precompute</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1special_1_1__precompute_1_1gammainc__data.html">gammainc_data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.special._precompute.gammainc_data Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a32f51a8139c189c958a449580498f9c0" id="r_a32f51a8139c189c958a449580498f9c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1special_1_1__precompute_1_1gammainc__data.html#a32f51a8139c189c958a449580498f9c0">gammainc</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, x, dps=50, maxterms=10 **8)</td></tr>
<tr class="separator:a32f51a8139c189c958a449580498f9c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3a6ee460fd00c66172766b6e00e3626" id="r_ac3a6ee460fd00c66172766b6e00e3626"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1special_1_1__precompute_1_1gammainc__data.html#ac3a6ee460fd00c66172766b6e00e3626">gammaincc</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, x, dps=50, maxterms=10 **8)</td></tr>
<tr class="separator:ac3a6ee460fd00c66172766b6e00e3626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a6efbb268986569c2b8717128a0c74" id="r_ac9a6efbb268986569c2b8717128a0c74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1special_1_1__precompute_1_1gammainc__data.html#ac9a6efbb268986569c2b8717128a0c74">main</a> ()</td></tr>
<tr class="separator:ac9a6efbb268986569c2b8717128a0c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Compute gammainc and gammaincc for large arguments and parameters
and save the values to data files for use in tests. We can't just
compare to mpmath's gammainc in test_mpmath.TestSystematic because it
would take too long.

Note that mpmath's gammainc is computed using hypercomb, but since it
doesn't allow the user to increase the maximum number of terms used in
the series it doesn't converge for many arguments. To get around this
we copy the mpmath implementation but use more terms.

This takes about 17 minutes to run on a 2.3 GHz Macbook Pro with 4GB
ram.

Sources:
[1] Fredrik Johansson and others. mpmath: a Python library for
    arbitrary-precision floating-point arithmetic (version 0.19),
    December 2013. http://mpmath.org/.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a32f51a8139c189c958a449580498f9c0" name="a32f51a8139c189c958a449580498f9c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32f51a8139c189c958a449580498f9c0">&#9670;&#160;</a></span>gammainc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.special._precompute.gammainc_data.gammainc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dps</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxterms</em> = <code>10**8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute gammainc exactly like mpmath does but allow for more
summands in hypercomb. See

mpmath/functions/expintegrals.py#L134

in the mpmath github repository.</pre> <div class="fragment"><div class="line"><span class="lineno">   33</span><span class="keyword">def </span>gammainc(a, x, dps=50, maxterms=10**8):</div>
<div class="line"><span class="lineno">   34</span>    <span class="stringliteral">&quot;&quot;&quot;Compute gammainc exactly like mpmath does but allow for more</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">    summands in hypercomb. See</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    mpmath/functions/expintegrals.py#L134</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">    in the mpmath github repository.</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="keyword">with</span> mp.workdps(dps):</div>
<div class="line"><span class="lineno">   43</span>        z, a, b = mp.mpf(a), mp.mpf(x), mp.mpf(x)</div>
<div class="line"><span class="lineno">   44</span>        G = [z]</div>
<div class="line"><span class="lineno">   45</span>        negb = mp.fneg(b, exact=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>        <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#a866dc72abfeae882204974bec3220f3a">h</a>(z):</div>
<div class="line"><span class="lineno">   48</span>            T1 = [mp.exp(negb), b, z], [1, z, -1], [], G, [1], [1+z], b</div>
<div class="line"><span class="lineno">   49</span>            <span class="keywordflow">return</span> (T1,)</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>        res = mp.hypercomb(h, [z], maxterms=maxterms)</div>
<div class="line"><span class="lineno">   52</span>        <span class="keywordflow">return</span> mpf2float(res)</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_a866dc72abfeae882204974bec3220f3a"><div class="ttname"><a href="__lapack__subroutines_8h.html#a866dc72abfeae882204974bec3220f3a">h</a></div><div class="ttdeci">void char char int int int npy_complex64 * h</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:211</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3a6ee460fd00c66172766b6e00e3626" name="ac3a6ee460fd00c66172766b6e00e3626"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3a6ee460fd00c66172766b6e00e3626">&#9670;&#160;</a></span>gammaincc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.special._precompute.gammainc_data.gammaincc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dps</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxterms</em> = <code>10**8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute gammaincc exactly like mpmath does but allow for more
terms in hypercomb. See

mpmath/functions/expintegrals.py#L187

in the mpmath github repository.</pre> <div class="fragment"><div class="line"><span class="lineno">   55</span><span class="keyword">def </span>gammaincc(a, x, dps=50, maxterms=10**8):</div>
<div class="line"><span class="lineno">   56</span>    <span class="stringliteral">&quot;&quot;&quot;Compute gammaincc exactly like mpmath does but allow for more</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    terms in hypercomb. See</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">    mpmath/functions/expintegrals.py#L187</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">    in the mpmath github repository.</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="keyword">with</span> mp.workdps(dps):</div>
<div class="line"><span class="lineno">   65</span>        z, a = a, x</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">if</span> mp.isint(z):</div>
<div class="line"><span class="lineno">   68</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   69</span>                <span class="comment"># mpmath has a fast integer path</span></div>
<div class="line"><span class="lineno">   70</span>                <span class="keywordflow">return</span> mpf2float(mp.gammainc(z, a=a, regularized=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">   71</span>            <span class="keywordflow">except</span> mp.libmp.NoConvergence:</div>
<div class="line"><span class="lineno">   72</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">   73</span>        nega = mp.fneg(a, exact=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   74</span>        G = [z]</div>
<div class="line"><span class="lineno">   75</span>        <span class="comment"># Use 2F0 series when possible; fall back to lower gamma representation</span></div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   77</span>            <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#a866dc72abfeae882204974bec3220f3a">h</a>(z):</div>
<div class="line"><span class="lineno">   78</span>                r = z-1</div>
<div class="line"><span class="lineno">   79</span>                <span class="keywordflow">return</span> [([mp.exp(nega), a], [1, r], [], G, [1, -r], [], 1/nega)]</div>
<div class="line"><span class="lineno">   80</span>            <span class="keywordflow">return</span> mpf2float(mp.hypercomb(h, [z], force_series=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">except</span> mp.libmp.NoConvergence:</div>
<div class="line"><span class="lineno">   82</span>            <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#a866dc72abfeae882204974bec3220f3a">h</a>(z):</div>
<div class="line"><span class="lineno">   83</span>                T1 = [], [1, z-1], [z], G, [], [], 0</div>
<div class="line"><span class="lineno">   84</span>                T2 = [-mp.exp(nega), a, z], [1, z, -1], [], G, [1], [1+z], a</div>
<div class="line"><span class="lineno">   85</span>                <span class="keywordflow">return</span> T1, T2</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">return</span> mpf2float(mp.hypercomb(h, [z], maxterms=maxterms))</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9a6efbb268986569c2b8717128a0c74" name="ac9a6efbb268986569c2b8717128a0c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a6efbb268986569c2b8717128a0c74">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.special._precompute.gammainc_data.main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   89</span><span class="keyword">def </span>main():</div>
<div class="line"><span class="lineno">   90</span>    t0 = time()</div>
<div class="line"><span class="lineno">   91</span>    <span class="comment"># It would be nice to have data for larger values, but either this</span></div>
<div class="line"><span class="lineno">   92</span>    <span class="comment"># requires prohibitively large precision (dps &gt; 800) or mpmath has</span></div>
<div class="line"><span class="lineno">   93</span>    <span class="comment"># a bug. For example, gammainc(1e20, 1e20, dps=800) returns a</span></div>
<div class="line"><span class="lineno">   94</span>    <span class="comment"># value around 0.03, while the true value should be close to 0.5</span></div>
<div class="line"><span class="lineno">   95</span>    <span class="comment"># (DLMF 8.12.15).</span></div>
<div class="line"><span class="lineno">   96</span>    print(__doc__)</div>
<div class="line"><span class="lineno">   97</span>    pwd = os.path.dirname(__file__)</div>
<div class="line"><span class="lineno">   98</span>    r = np.logspace(4, 14, 30)</div>
<div class="line"><span class="lineno">   99</span>    ltheta = np.logspace(np.log10(pi/4), np.log10(np.arctan(0.6)), 30)</div>
<div class="line"><span class="lineno">  100</span>    utheta = np.logspace(np.log10(pi/4), np.log10(np.arctan(1.4)), 30)</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    regimes = [(gammainc, ltheta), (gammaincc, utheta)]</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">for</span> func, theta <span class="keywordflow">in</span> regimes:</div>
<div class="line"><span class="lineno">  104</span>        rg, thetag = np.meshgrid(r, theta)</div>
<div class="line"><span class="lineno">  105</span>        a, x = rg*np.cos(thetag), rg*np.sin(thetag)</div>
<div class="line"><span class="lineno">  106</span>        a, x = a.flatten(), x.flatten()</div>
<div class="line"><span class="lineno">  107</span>        dataset = []</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">for</span> i, (a0, x0) <span class="keywordflow">in</span> enumerate(zip(a, x)):</div>
<div class="line"><span class="lineno">  109</span>            <span class="keywordflow">if</span> func == gammaincc:</div>
<div class="line"><span class="lineno">  110</span>                <span class="comment"># Exploit the fast integer path in gammaincc whenever</span></div>
<div class="line"><span class="lineno">  111</span>                <span class="comment"># possible so that the computation doesn&#39;t take too</span></div>
<div class="line"><span class="lineno">  112</span>                <span class="comment"># long</span></div>
<div class="line"><span class="lineno">  113</span>                a0, x0 = np.floor(a0), np.floor(x0)</div>
<div class="line"><span class="lineno">  114</span>            dataset.append((a0, x0, <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(a0, x0)))</div>
<div class="line"><span class="lineno">  115</span>        dataset = np.array(dataset)</div>
<div class="line"><span class="lineno">  116</span>        filename = os.path.join(pwd, <span class="stringliteral">&#39;..&#39;</span>, <span class="stringliteral">&#39;tests&#39;</span>, <span class="stringliteral">&#39;data&#39;</span>, <span class="stringliteral">&#39;local&#39;</span>,</div>
<div class="line"><span class="lineno">  117</span>                                <span class="stringliteral">&#39;{}.txt&#39;</span>.format(func.__name__))</div>
<div class="line"><span class="lineno">  118</span>        np.savetxt(filename, dataset)</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>    print(<span class="stringliteral">&quot;{} minutes elapsed&quot;</span>.format((time() - t0)/60))</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
