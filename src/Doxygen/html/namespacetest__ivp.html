<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: test_ivp Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">test_ivp Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6a4c0c600921c15b0658ff05dfef4a0e" id="r_a6a4c0c600921c15b0658ff05dfef4a0e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a6a4c0c600921c15b0658ff05dfef4a0e">fun_zero</a> (t, y)</td></tr>
<tr class="separator:a6a4c0c600921c15b0658ff05dfef4a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a435821c9a3cbcce4714f7c948ea9da0b" id="r_a435821c9a3cbcce4714f7c948ea9da0b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a435821c9a3cbcce4714f7c948ea9da0b">fun_linear</a> (t, y)</td></tr>
<tr class="separator:a435821c9a3cbcce4714f7c948ea9da0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d791034d5c03c46603ea1894b651ae0" id="r_a0d791034d5c03c46603ea1894b651ae0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a0d791034d5c03c46603ea1894b651ae0">jac_linear</a> ()</td></tr>
<tr class="separator:a0d791034d5c03c46603ea1894b651ae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d00e14d9bc080bacdea9bf1141f8a5" id="r_a47d00e14d9bc080bacdea9bf1141f8a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a47d00e14d9bc080bacdea9bf1141f8a5">sol_linear</a> (t)</td></tr>
<tr class="separator:a47d00e14d9bc080bacdea9bf1141f8a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08a2ed2f84d8c43cc1c8c9f9e9e38b0c" id="r_a08a2ed2f84d8c43cc1c8c9f9e9e38b0c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a08a2ed2f84d8c43cc1c8c9f9e9e38b0c">fun_rational</a> (t, y)</td></tr>
<tr class="separator:a08a2ed2f84d8c43cc1c8c9f9e9e38b0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5922044670449614a8b1c718fc7ff2c1" id="r_a5922044670449614a8b1c718fc7ff2c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a5922044670449614a8b1c718fc7ff2c1">fun_rational_vectorized</a> (t, y)</td></tr>
<tr class="separator:a5922044670449614a8b1c718fc7ff2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39bc7107eec839103cd0505929592272" id="r_a39bc7107eec839103cd0505929592272"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a39bc7107eec839103cd0505929592272">jac_rational</a> (t, y)</td></tr>
<tr class="separator:a39bc7107eec839103cd0505929592272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c8baf0e992e55c66b4304ab3cadad8" id="r_a29c8baf0e992e55c66b4304ab3cadad8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a29c8baf0e992e55c66b4304ab3cadad8">jac_rational_sparse</a> (t, y)</td></tr>
<tr class="separator:a29c8baf0e992e55c66b4304ab3cadad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef2b21628175722a200e6a5f0bec1806" id="r_aef2b21628175722a200e6a5f0bec1806"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#aef2b21628175722a200e6a5f0bec1806">sol_rational</a> (t)</td></tr>
<tr class="separator:aef2b21628175722a200e6a5f0bec1806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad78fb05b3c319af2460eb244610f77ab" id="r_ad78fb05b3c319af2460eb244610f77ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ad78fb05b3c319af2460eb244610f77ab">fun_medazko</a> (t, y)</td></tr>
<tr class="separator:ad78fb05b3c319af2460eb244610f77ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6da4cbfe80a9686cc1c8a89faa0b973" id="r_ad6da4cbfe80a9686cc1c8a89faa0b973"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ad6da4cbfe80a9686cc1c8a89faa0b973">medazko_sparsity</a> (<a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:ad6da4cbfe80a9686cc1c8a89faa0b973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5074bbecc2ee15010642366f0c4292b" id="r_ac5074bbecc2ee15010642366f0c4292b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ac5074bbecc2ee15010642366f0c4292b">fun_complex</a> (t, y)</td></tr>
<tr class="separator:ac5074bbecc2ee15010642366f0c4292b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b9b0928ad27bee5d005e0b38076f97" id="r_a86b9b0928ad27bee5d005e0b38076f97"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a86b9b0928ad27bee5d005e0b38076f97">jac_complex</a> (t, y)</td></tr>
<tr class="separator:a86b9b0928ad27bee5d005e0b38076f97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcfee59d80603c12aa956b0176c238e9" id="r_afcfee59d80603c12aa956b0176c238e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#afcfee59d80603c12aa956b0176c238e9">jac_complex_sparse</a> (t, y)</td></tr>
<tr class="separator:afcfee59d80603c12aa956b0176c238e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49d0d0b16638190e2d7d24424a524d1f" id="r_a49d0d0b16638190e2d7d24424a524d1f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a49d0d0b16638190e2d7d24424a524d1f">sol_complex</a> (t)</td></tr>
<tr class="separator:a49d0d0b16638190e2d7d24424a524d1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c69bcdd96f635cf2724c489c7797b4d" id="r_a7c69bcdd96f635cf2724c489c7797b4d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a7c69bcdd96f635cf2724c489c7797b4d">compute_error</a> (y, y_true, <a class="el" href="__lapack__subroutines_8h.html#aa4a017e91ee751f9803a1bdb6caf1c06">rtol</a>, atol)</td></tr>
<tr class="separator:a7c69bcdd96f635cf2724c489c7797b4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95c50287f936099a73cb21c2b57fd947" id="r_a95c50287f936099a73cb21c2b57fd947"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a95c50287f936099a73cb21c2b57fd947">test_integration</a> ()</td></tr>
<tr class="separator:a95c50287f936099a73cb21c2b57fd947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fcb81b81965a65bebf2764b1077e10b" id="r_a5fcb81b81965a65bebf2764b1077e10b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a5fcb81b81965a65bebf2764b1077e10b">test_integration_complex</a> ()</td></tr>
<tr class="separator:a5fcb81b81965a65bebf2764b1077e10b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7256d01ece43a5f75d9e0ac9c558a77" id="r_ae7256d01ece43a5f75d9e0ac9c558a77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ae7256d01ece43a5f75d9e0ac9c558a77">test_integration_sparse_difference</a> ()</td></tr>
<tr class="separator:ae7256d01ece43a5f75d9e0ac9c558a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af26e8fe90a4395dd27b08fffa4e131a1" id="r_af26e8fe90a4395dd27b08fffa4e131a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#af26e8fe90a4395dd27b08fffa4e131a1">test_integration_const_jac</a> ()</td></tr>
<tr class="separator:af26e8fe90a4395dd27b08fffa4e131a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72f35d3fbfa47e38404b8e5ffc96d845" id="r_a72f35d3fbfa47e38404b8e5ffc96d845"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a72f35d3fbfa47e38404b8e5ffc96d845">test_integration_stiff</a> (method)</td></tr>
<tr class="separator:a72f35d3fbfa47e38404b8e5ffc96d845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb83743ea1ef8cf07a5ff3dbb4115a5d" id="r_acb83743ea1ef8cf07a5ff3dbb4115a5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#acb83743ea1ef8cf07a5ff3dbb4115a5d">test_events</a> ()</td></tr>
<tr class="separator:acb83743ea1ef8cf07a5ff3dbb4115a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff6b2c7a3a0e2581f51bbce1b8540b9" id="r_a6ff6b2c7a3a0e2581f51bbce1b8540b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a6ff6b2c7a3a0e2581f51bbce1b8540b9">test_max_step</a> ()</td></tr>
<tr class="separator:a6ff6b2c7a3a0e2581f51bbce1b8540b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada56b08a0a8146fcfd4407c999c47576" id="r_ada56b08a0a8146fcfd4407c999c47576"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ada56b08a0a8146fcfd4407c999c47576">test_first_step</a> ()</td></tr>
<tr class="separator:ada56b08a0a8146fcfd4407c999c47576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a41daaccaed0d3c8e0f49dc088f446f" id="r_a6a41daaccaed0d3c8e0f49dc088f446f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a6a41daaccaed0d3c8e0f49dc088f446f">test_t_eval</a> ()</td></tr>
<tr class="separator:a6a41daaccaed0d3c8e0f49dc088f446f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae545504c253537c14ce74f7affbb9ade" id="r_ae545504c253537c14ce74f7affbb9ade"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ae545504c253537c14ce74f7affbb9ade">test_t_eval_dense_output</a> ()</td></tr>
<tr class="separator:ae545504c253537c14ce74f7affbb9ade"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374c33d3edceda765894d0f407d5c722" id="r_a374c33d3edceda765894d0f407d5c722"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a374c33d3edceda765894d0f407d5c722">test_t_eval_early_event</a> ()</td></tr>
<tr class="separator:a374c33d3edceda765894d0f407d5c722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac209b4163ab35aef2a1dc92daed44822" id="r_ac209b4163ab35aef2a1dc92daed44822"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ac209b4163ab35aef2a1dc92daed44822">test_no_integration</a> ()</td></tr>
<tr class="separator:ac209b4163ab35aef2a1dc92daed44822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b5766ea0266d3782d25e38c0b0006b" id="r_ac0b5766ea0266d3782d25e38c0b0006b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ac0b5766ea0266d3782d25e38c0b0006b">test_no_integration_class</a> ()</td></tr>
<tr class="separator:ac0b5766ea0266d3782d25e38c0b0006b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbc432f12d06a6247138b8de77c204ab" id="r_abbc432f12d06a6247138b8de77c204ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#abbc432f12d06a6247138b8de77c204ab">test_empty</a> ()</td></tr>
<tr class="separator:abbc432f12d06a6247138b8de77c204ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9879a90966b4198c79b1ae585ec4f55" id="r_ad9879a90966b4198c79b1ae585ec4f55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ad9879a90966b4198c79b1ae585ec4f55">test_ConstantDenseOutput</a> ()</td></tr>
<tr class="separator:ad9879a90966b4198c79b1ae585ec4f55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cb74cd62a8be040c99eb402b4029c4b" id="r_a9cb74cd62a8be040c99eb402b4029c4b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a9cb74cd62a8be040c99eb402b4029c4b">test_classes</a> ()</td></tr>
<tr class="separator:a9cb74cd62a8be040c99eb402b4029c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7184ccb2b245ba7630788cea2705c2ca" id="r_a7184ccb2b245ba7630788cea2705c2ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a7184ccb2b245ba7630788cea2705c2ca">test_OdeSolution</a> ()</td></tr>
<tr class="separator:a7184ccb2b245ba7630788cea2705c2ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a119de8491bb749c3c733cd9827785699" id="r_a119de8491bb749c3c733cd9827785699"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a119de8491bb749c3c733cd9827785699">test_num_jac</a> ()</td></tr>
<tr class="separator:a119de8491bb749c3c733cd9827785699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6d693508f3462270cf0d8c5d75af942" id="r_ac6d693508f3462270cf0d8c5d75af942"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ac6d693508f3462270cf0d8c5d75af942">test_num_jac_sparse</a> ()</td></tr>
<tr class="separator:ac6d693508f3462270cf0d8c5d75af942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4a806b41098556cabcea78c0ad42202" id="r_ad4a806b41098556cabcea78c0ad42202"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#ad4a806b41098556cabcea78c0ad42202">test_args</a> ()</td></tr>
<tr class="separator:ad4a806b41098556cabcea78c0ad42202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09ae61f6d7dddf2fe6bf64f69f9cef44" id="r_a09ae61f6d7dddf2fe6bf64f69f9cef44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#a09ae61f6d7dddf2fe6bf64f69f9cef44">test_array_rtol</a> ()</td></tr>
<tr class="separator:a09ae61f6d7dddf2fe6bf64f69f9cef44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba7fab352d673df1aff810a5c5568ee2" id="r_aba7fab352d673df1aff810a5c5568ee2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#aba7fab352d673df1aff810a5c5568ee2">test_integration_zero_rhs</a> (method)</td></tr>
<tr class="separator:aba7fab352d673df1aff810a5c5568ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf3e5944787e37062f2977a480160685" id="r_aaf3e5944787e37062f2977a480160685"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest__ivp.html#aaf3e5944787e37062f2977a480160685">test_args_single_value</a> ()</td></tr>
<tr class="separator:aaf3e5944787e37062f2977a480160685"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7c69bcdd96f635cf2724c489c7797b4d" name="a7c69bcdd96f635cf2724c489c7797b4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c69bcdd96f635cf2724c489c7797b4d">&#9670;&#160;</a></span>compute_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.compute_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_true</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>atol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  138</span><span class="keyword">def </span>compute_error(y, y_true, rtol, atol):</div>
<div class="line"><span class="lineno">  139</span>    e = (y - y_true) / (atol + rtol * np.abs(y_true))</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">return</span> np.linalg.norm(e, axis=0) / np.sqrt(e.shape[0])</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5074bbecc2ee15010642366f0c4292b" name="ac5074bbecc2ee15010642366f0c4292b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5074bbecc2ee15010642366f0c4292b">&#9670;&#160;</a></span>fun_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.fun_complex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  121</span><span class="keyword">def </span>fun_complex(t, y):</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">return</span> -y</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a435821c9a3cbcce4714f7c948ea9da0b" name="a435821c9a3cbcce4714f7c948ea9da0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a435821c9a3cbcce4714f7c948ea9da0b">&#9670;&#160;</a></span>fun_linear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.fun_linear </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   19</span><span class="keyword">def </span>fun_linear(t, y):</div>
<div class="line"><span class="lineno">   20</span>    <span class="keywordflow">return</span> np.array([-y[0] - 5 * y[1], y[0] + y[1]])</div>
<div class="line"><span class="lineno">   21</span> </div>
<div class="line"><span class="lineno">   22</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad78fb05b3c319af2460eb244610f77ab" name="ad78fb05b3c319af2460eb244610f77ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad78fb05b3c319af2460eb244610f77ab">&#9670;&#160;</a></span>fun_medazko()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.fun_medazko </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   62</span><span class="keyword">def </span>fun_medazko(t, y):</div>
<div class="line"><span class="lineno">   63</span>    n = y.shape[0] // 2</div>
<div class="line"><span class="lineno">   64</span>    k = 100</div>
<div class="line"><span class="lineno">   65</span>    c = 4</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    phi = 2 <span class="keywordflow">if</span> t &lt;= 5 <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">   68</span>    y = np.hstack((phi, 0, y, y[-2]))</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    d = 1 / n</div>
<div class="line"><span class="lineno">   71</span>    j = np.arange(n) + 1</div>
<div class="line"><span class="lineno">   72</span>    alpha = 2 * (j * d - 1) ** 3 / c ** 2</div>
<div class="line"><span class="lineno">   73</span>    beta = (j * d - 1) ** 4 / c ** 2</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    j_2_p1 = 2 * j + 2</div>
<div class="line"><span class="lineno">   76</span>    j_2_m3 = 2 * j - 2</div>
<div class="line"><span class="lineno">   77</span>    j_2_m1 = 2 * j</div>
<div class="line"><span class="lineno">   78</span>    j_2 = 2 * j + 1</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    f = np.empty(2 * n)</div>
<div class="line"><span class="lineno">   81</span>    f[::2] = (alpha * (y[j_2_p1] - y[j_2_m3]) / (2 * d) +</div>
<div class="line"><span class="lineno">   82</span>              beta * (y[j_2_m3] - 2 * y[j_2_m1] + y[j_2_p1]) / d ** 2 -</div>
<div class="line"><span class="lineno">   83</span>              k * y[j_2_m1] * y[j_2])</div>
<div class="line"><span class="lineno">   84</span>    f[1::2] = -k * y[j_2] * y[j_2_m1]</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">return</span> f</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a08a2ed2f84d8c43cc1c8c9f9e9e38b0c" name="a08a2ed2f84d8c43cc1c8c9f9e9e38b0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08a2ed2f84d8c43cc1c8c9f9e9e38b0c">&#9670;&#160;</a></span>fun_rational()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.fun_rational </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   32</span><span class="keyword">def </span>fun_rational(t, y):</div>
<div class="line"><span class="lineno">   33</span>    <span class="keywordflow">return</span> np.array([y[1] / t,</div>
<div class="line"><span class="lineno">   34</span>                     y[1] * (y[0] + 2 * y[1] - 1) / (t * (y[0] - 1))])</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5922044670449614a8b1c718fc7ff2c1" name="a5922044670449614a8b1c718fc7ff2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5922044670449614a8b1c718fc7ff2c1">&#9670;&#160;</a></span>fun_rational_vectorized()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.fun_rational_vectorized </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   37</span><span class="keyword">def </span>fun_rational_vectorized(t, y):</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">return</span> np.vstack((y[1] / t,</div>
<div class="line"><span class="lineno">   39</span>                      y[1] * (y[0] + 2 * y[1] - 1) / (t * (y[0] - 1))))</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a4c0c600921c15b0658ff05dfef4a0e" name="a6a4c0c600921c15b0658ff05dfef4a0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a4c0c600921c15b0658ff05dfef4a0e">&#9670;&#160;</a></span>fun_zero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.fun_zero </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   15</span><span class="keyword">def </span>fun_zero(t, y):</div>
<div class="line"><span class="lineno">   16</span>    <span class="keywordflow">return</span> np.zeros_like(y)</div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a86b9b0928ad27bee5d005e0b38076f97" name="a86b9b0928ad27bee5d005e0b38076f97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86b9b0928ad27bee5d005e0b38076f97">&#9670;&#160;</a></span>jac_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.jac_complex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  125</span><span class="keyword">def </span>jac_complex(t, y):</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">return</span> -np.eye(y.shape[0])</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afcfee59d80603c12aa956b0176c238e9" name="afcfee59d80603c12aa956b0176c238e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcfee59d80603c12aa956b0176c238e9">&#9670;&#160;</a></span>jac_complex_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.jac_complex_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  129</span><span class="keyword">def </span>jac_complex_sparse(t, y):</div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">return</span> csc_matrix(jac_complex(t, y))</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d791034d5c03c46603ea1894b651ae0" name="a0d791034d5c03c46603ea1894b651ae0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d791034d5c03c46603ea1894b651ae0">&#9670;&#160;</a></span>jac_linear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.jac_linear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   23</span><span class="keyword">def </span>jac_linear():</div>
<div class="line"><span class="lineno">   24</span>    <span class="keywordflow">return</span> np.array([[-1, -5], [1, 1]])</div>
<div class="line"><span class="lineno">   25</span> </div>
<div class="line"><span class="lineno">   26</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a39bc7107eec839103cd0505929592272" name="a39bc7107eec839103cd0505929592272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39bc7107eec839103cd0505929592272">&#9670;&#160;</a></span>jac_rational()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.jac_rational </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   42</span><span class="keyword">def </span>jac_rational(t, y):</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">return</span> np.array([</div>
<div class="line"><span class="lineno">   44</span>        [0, 1 / t],</div>
<div class="line"><span class="lineno">   45</span>        [-2 * y[1] ** 2 / (t * (y[0] - 1) ** 2),</div>
<div class="line"><span class="lineno">   46</span>         (y[0] + 4 * y[1] - 1) / (t * (y[0] - 1))]</div>
<div class="line"><span class="lineno">   47</span>    ])</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a29c8baf0e992e55c66b4304ab3cadad8" name="a29c8baf0e992e55c66b4304ab3cadad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29c8baf0e992e55c66b4304ab3cadad8">&#9670;&#160;</a></span>jac_rational_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.jac_rational_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   50</span><span class="keyword">def </span>jac_rational_sparse(t, y):</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">return</span> csc_matrix([</div>
<div class="line"><span class="lineno">   52</span>        [0, 1 / t],</div>
<div class="line"><span class="lineno">   53</span>        [-2 * y[1] ** 2 / (t * (y[0] - 1) ** 2),</div>
<div class="line"><span class="lineno">   54</span>         (y[0] + 4 * y[1] - 1) / (t * (y[0] - 1))]</div>
<div class="line"><span class="lineno">   55</span>    ])</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6da4cbfe80a9686cc1c8a89faa0b973" name="ad6da4cbfe80a9686cc1c8a89faa0b973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6da4cbfe80a9686cc1c8a89faa0b973">&#9670;&#160;</a></span>medazko_sparsity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.medazko_sparsity </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   89</span><span class="keyword">def </span>medazko_sparsity(n):</div>
<div class="line"><span class="lineno">   90</span>    cols = []</div>
<div class="line"><span class="lineno">   91</span>    rows = []</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    i = np.arange(n) * 2</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>    cols.append(i[1:])</div>
<div class="line"><span class="lineno">   96</span>    rows.append(i[1:] - 2)</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    cols.append(i)</div>
<div class="line"><span class="lineno">   99</span>    rows.append(i)</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    cols.append(i)</div>
<div class="line"><span class="lineno">  102</span>    rows.append(i + 1)</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    cols.append(i[:-1])</div>
<div class="line"><span class="lineno">  105</span>    rows.append(i[:-1] + 2)</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    i = np.arange(n) * 2 + 1</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    cols.append(i)</div>
<div class="line"><span class="lineno">  110</span>    rows.append(i)</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    cols.append(i)</div>
<div class="line"><span class="lineno">  113</span>    rows.append(i - 1)</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    cols = np.hstack(cols)</div>
<div class="line"><span class="lineno">  116</span>    rows = np.hstack(rows)</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">return</span> coo_matrix((np.ones_like(cols), (cols, rows)))</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a49d0d0b16638190e2d7d24424a524d1f" name="a49d0d0b16638190e2d7d24424a524d1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49d0d0b16638190e2d7d24424a524d1f">&#9670;&#160;</a></span>sol_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.sol_complex </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  133</span><span class="keyword">def </span>sol_complex(t):</div>
<div class="line"><span class="lineno">  134</span>    y = (0.5 + 1j) * np.exp(-t)</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">return</span> y.reshape((1, -1))</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a47d00e14d9bc080bacdea9bf1141f8a5" name="a47d00e14d9bc080bacdea9bf1141f8a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47d00e14d9bc080bacdea9bf1141f8a5">&#9670;&#160;</a></span>sol_linear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.sol_linear </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   27</span><span class="keyword">def </span>sol_linear(t):</div>
<div class="line"><span class="lineno">   28</span>    <span class="keywordflow">return</span> np.vstack((-5 * np.sin(2 * t),</div>
<div class="line"><span class="lineno">   29</span>                      2 * np.cos(2 * t) + np.sin(2 * t)))</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aef2b21628175722a200e6a5f0bec1806" name="aef2b21628175722a200e6a5f0bec1806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef2b21628175722a200e6a5f0bec1806">&#9670;&#160;</a></span>sol_rational()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.sol_rational </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   58</span><span class="keyword">def </span>sol_rational(t):</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">return</span> np.asarray((t / (t + 10), 10 * t / (t + 10) ** 2))</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4a806b41098556cabcea78c0ad42202" name="ad4a806b41098556cabcea78c0ad42202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4a806b41098556cabcea78c0ad42202">&#9670;&#160;</a></span>test_args()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_args </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  922</span><span class="keyword">def </span>test_args():</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>    <span class="comment"># sys3 is actually two decoupled systems. (x, y) form a</span></div>
<div class="line"><span class="lineno">  925</span>    <span class="comment"># linear oscillator, while z is a nonlinear first order</span></div>
<div class="line"><span class="lineno">  926</span>    <span class="comment"># system with equilibria at z=0 and z=1. If k &gt; 0, z=1</span></div>
<div class="line"><span class="lineno">  927</span>    <span class="comment"># is stable and z=0 is unstable.</span></div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>    <span class="keyword">def </span>sys3(t, w, omega, k, zfinal):</div>
<div class="line"><span class="lineno">  930</span>        x, y, z = w</div>
<div class="line"><span class="lineno">  931</span>        <span class="keywordflow">return</span> [-omega*y, omega*x, k*z*(1 - z)]</div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span>    <span class="keyword">def </span>sys3_jac(t, w, omega, k, zfinal):</div>
<div class="line"><span class="lineno">  934</span>        x, y, z = w</div>
<div class="line"><span class="lineno">  935</span>        J = np.array([[0, -omega, 0],</div>
<div class="line"><span class="lineno">  936</span>                      [omega, 0, 0],</div>
<div class="line"><span class="lineno">  937</span>                      [0, 0, k*(1 - 2*z)]])</div>
<div class="line"><span class="lineno">  938</span>        <span class="keywordflow">return</span> J</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>    <span class="keyword">def </span>sys3_x0decreasing(t, w, omega, k, zfinal):</div>
<div class="line"><span class="lineno">  941</span>        x, y, z = w</div>
<div class="line"><span class="lineno">  942</span>        <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>    <span class="keyword">def </span>sys3_y0increasing(t, w, omega, k, zfinal):</div>
<div class="line"><span class="lineno">  945</span>        x, y, z = w</div>
<div class="line"><span class="lineno">  946</span>        <span class="keywordflow">return</span> y</div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>    <span class="keyword">def </span>sys3_zfinal(t, w, omega, k, zfinal):</div>
<div class="line"><span class="lineno">  949</span>        x, y, z = w</div>
<div class="line"><span class="lineno">  950</span>        <span class="keywordflow">return</span> z - zfinal</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>    <span class="comment"># Set the event flags for the event functions.</span></div>
<div class="line"><span class="lineno">  953</span>    sys3_x0decreasing.direction = -1</div>
<div class="line"><span class="lineno">  954</span>    sys3_y0increasing.direction = 1</div>
<div class="line"><span class="lineno">  955</span>    sys3_zfinal.terminal = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  956</span> </div>
<div class="line"><span class="lineno">  957</span>    omega = 2</div>
<div class="line"><span class="lineno">  958</span>    k = 4</div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>    tfinal = 5</div>
<div class="line"><span class="lineno">  961</span>    zfinal = 0.99</div>
<div class="line"><span class="lineno">  962</span>    <span class="comment"># Find z0 such that when z(0) = z0, z(tfinal) = zfinal.</span></div>
<div class="line"><span class="lineno">  963</span>    <span class="comment"># The condition z(tfinal) = zfinal is the terminal event.</span></div>
<div class="line"><span class="lineno">  964</span>    z0 = np.exp(-k*tfinal)/((1 - zfinal)/zfinal + np.exp(-k*tfinal))</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>    w0 = [0, -1, z0]</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>    <span class="comment"># Provide the jac argument and use the Radau method to ensure that the use</span></div>
<div class="line"><span class="lineno">  969</span>    <span class="comment"># of the Jacobian function is exercised.</span></div>
<div class="line"><span class="lineno">  970</span>    <span class="comment"># If event handling is working, the solution will stop at tfinal, not tend.</span></div>
<div class="line"><span class="lineno">  971</span>    tend = 2*tfinal</div>
<div class="line"><span class="lineno">  972</span>    sol = solve_ivp(sys3, [0, tend], w0,</div>
<div class="line"><span class="lineno">  973</span>                    events=[sys3_x0decreasing, sys3_y0increasing, sys3_zfinal],</div>
<div class="line"><span class="lineno">  974</span>                    dense_output=<span class="keyword">True</span>, args=(omega, k, zfinal),</div>
<div class="line"><span class="lineno">  975</span>                    method=<span class="stringliteral">&#39;Radau&#39;</span>, jac=sys3_jac,</div>
<div class="line"><span class="lineno">  976</span>                    rtol=1e-10, atol=1e-13)</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>    <span class="comment"># Check that we got the expected events at the expected times.</span></div>
<div class="line"><span class="lineno">  979</span>    x0events_t = sol.t_events[0]</div>
<div class="line"><span class="lineno">  980</span>    y0events_t = sol.t_events[1]</div>
<div class="line"><span class="lineno">  981</span>    zfinalevents_t = sol.t_events[2]</div>
<div class="line"><span class="lineno">  982</span>    assert_allclose(x0events_t, [0.5*np.pi, 1.5*np.pi])</div>
<div class="line"><span class="lineno">  983</span>    assert_allclose(y0events_t, [0.25*np.pi, 1.25*np.pi])</div>
<div class="line"><span class="lineno">  984</span>    assert_allclose(zfinalevents_t, [tfinal])</div>
<div class="line"><span class="lineno">  985</span> </div>
<div class="line"><span class="lineno">  986</span>    <span class="comment"># Check that the solution agrees with the known exact solution.</span></div>
<div class="line"><span class="lineno">  987</span>    t = np.linspace(0, zfinalevents_t[0], 250)</div>
<div class="line"><span class="lineno">  988</span>    w = sol.sol(t)</div>
<div class="line"><span class="lineno">  989</span>    assert_allclose(w[0], np.sin(omega*t), rtol=1e-9, atol=1e-12)</div>
<div class="line"><span class="lineno">  990</span>    assert_allclose(w[1], -np.cos(omega*t), rtol=1e-9, atol=1e-12)</div>
<div class="line"><span class="lineno">  991</span>    assert_allclose(w[2], 1/(((1 - z0)/z0)*np.exp(-k*t) + 1),</div>
<div class="line"><span class="lineno">  992</span>                    rtol=1e-9, atol=1e-12)</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>    <span class="comment"># Check that the state variables have the expected values at the events.</span></div>
<div class="line"><span class="lineno">  995</span>    x0events = sol.sol(x0events_t)</div>
<div class="line"><span class="lineno">  996</span>    y0events = sol.sol(y0events_t)</div>
<div class="line"><span class="lineno">  997</span>    zfinalevents = sol.sol(zfinalevents_t)</div>
<div class="line"><span class="lineno">  998</span>    assert_allclose(x0events[0], np.zeros_like(x0events[0]), atol=5e-14)</div>
<div class="line"><span class="lineno">  999</span>    assert_allclose(x0events[1], np.ones_like(x0events[1]))</div>
<div class="line"><span class="lineno"> 1000</span>    assert_allclose(y0events[0], np.ones_like(y0events[0]))</div>
<div class="line"><span class="lineno"> 1001</span>    assert_allclose(y0events[1], np.zeros_like(y0events[1]), atol=5e-14)</div>
<div class="line"><span class="lineno"> 1002</span>    assert_allclose(zfinalevents[2], [zfinal])</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf3e5944787e37062f2977a480160685" name="aaf3e5944787e37062f2977a480160685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf3e5944787e37062f2977a480160685">&#9670;&#160;</a></span>test_args_single_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_args_single_value </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1031</span><span class="keyword">def </span>test_args_single_value():</div>
<div class="line"><span class="lineno"> 1032</span>    <span class="keyword">def </span>fun_with_arg(t, y, a):</div>
<div class="line"><span class="lineno"> 1033</span>        <span class="keywordflow">return</span> a*y</div>
<div class="line"><span class="lineno"> 1034</span> </div>
<div class="line"><span class="lineno"> 1035</span>    message = <span class="stringliteral">&quot;Supplied &#39;args&#39; cannot be unpacked.&quot;</span></div>
<div class="line"><span class="lineno"> 1036</span>    <span class="keyword">with</span> pytest.raises(TypeError, match=message):</div>
<div class="line"><span class="lineno"> 1037</span>        solve_ivp(fun_with_arg, (0, 0.1), [1], args=-1)</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>    sol = solve_ivp(fun_with_arg, (0, 0.1), [1], args=(-1,))</div>
<div class="line"><span class="lineno"> 1040</span>    assert_allclose(sol.y[0, -1], np.exp(-0.1))</div>
</div><!-- fragment -->
</div>
</div>
<a id="a09ae61f6d7dddf2fe6bf64f69f9cef44" name="a09ae61f6d7dddf2fe6bf64f69f9cef44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09ae61f6d7dddf2fe6bf64f69f9cef44">&#9670;&#160;</a></span>test_array_rtol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_array_rtol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1005</span><span class="keyword">def </span>test_array_rtol():</div>
<div class="line"><span class="lineno"> 1006</span>    <span class="comment"># solve_ivp had a bug with array_like `rtol`; see gh-15482</span></div>
<div class="line"><span class="lineno"> 1007</span>    <span class="comment"># check that it&#39;s fixed</span></div>
<div class="line"><span class="lineno"> 1008</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(t, y):</div>
<div class="line"><span class="lineno"> 1009</span>        <span class="keywordflow">return</span> y[0], y[1]</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>    <span class="comment"># no warning (or error) when `rtol` is array_like</span></div>
<div class="line"><span class="lineno"> 1012</span>    sol = solve_ivp(f, (0, 1), [1., 1.], rtol=[1e-1, 1e-1])</div>
<div class="line"><span class="lineno"> 1013</span>    err1 = np.abs(np.linalg.norm(sol.y[:, -1] - np.exp(1)))</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>    <span class="comment"># warning when an element of `rtol` is too small</span></div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keyword">with</span> pytest.warns(UserWarning, match=<span class="stringliteral">&quot;At least one element...&quot;</span>):</div>
<div class="line"><span class="lineno"> 1017</span>        sol = solve_ivp(f, (0, 1), [1., 1.], rtol=[1e-1, 1e-16])</div>
<div class="line"><span class="lineno"> 1018</span>        err2 = np.abs(np.linalg.norm(sol.y[:, -1] - np.exp(1)))</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>    <span class="comment"># tighter rtol improves the error</span></div>
<div class="line"><span class="lineno"> 1021</span>    <span class="keyword">assert</span> err2 &lt; err1</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span><span class="preprocessor">@pytest.mark.parametrize(&#39;method&#39;, [&#39;RK23&#39;, &#39;RK45&#39;, &#39;DOP853&#39;, &#39;Radau&#39;, &#39;BDF&#39;, &#39;LSODA&#39;])</span></div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9cb74cd62a8be040c99eb402b4029c4b" name="a9cb74cd62a8be040c99eb402b4029c4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cb74cd62a8be040c99eb402b4029c4b">&#9670;&#160;</a></span>test_classes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_classes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  768</span><span class="keyword">def </span>test_classes():</div>
<div class="line"><span class="lineno">  769</span>    y0 = [1 / 3, 2 / 9]</div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordflow">for</span> cls <span class="keywordflow">in</span> [RK23, RK45, DOP853, Radau, BDF, LSODA]:</div>
<div class="line"><span class="lineno">  771</span>        solver = cls(fun_rational, 5, y0, np.inf)</div>
<div class="line"><span class="lineno">  772</span>        assert_equal(solver.n, 2)</div>
<div class="line"><span class="lineno">  773</span>        assert_equal(solver.status, <span class="stringliteral">&#39;running&#39;</span>)</div>
<div class="line"><span class="lineno">  774</span>        assert_equal(solver.t_bound, np.inf)</div>
<div class="line"><span class="lineno">  775</span>        assert_equal(solver.direction, 1)</div>
<div class="line"><span class="lineno">  776</span>        assert_equal(solver.t, 5)</div>
<div class="line"><span class="lineno">  777</span>        assert_equal(solver.y, y0)</div>
<div class="line"><span class="lineno">  778</span>        assert_(solver.step_size <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  779</span>        <span class="keywordflow">if</span> cls <span class="keywordflow">is</span> <span class="keywordflow">not</span> LSODA:</div>
<div class="line"><span class="lineno">  780</span>            assert_(solver.nfev &gt; 0)</div>
<div class="line"><span class="lineno">  781</span>            assert_(solver.njev &gt;= 0)</div>
<div class="line"><span class="lineno">  782</span>            assert_equal(solver.nlu, 0)</div>
<div class="line"><span class="lineno">  783</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  784</span>            assert_equal(solver.nfev, 0)</div>
<div class="line"><span class="lineno">  785</span>            assert_equal(solver.njev, 0)</div>
<div class="line"><span class="lineno">  786</span>            assert_equal(solver.nlu, 0)</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>        assert_raises(RuntimeError, solver.dense_output)</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>        message = solver.step()</div>
<div class="line"><span class="lineno">  791</span>        assert_equal(solver.status, <span class="stringliteral">&#39;running&#39;</span>)</div>
<div class="line"><span class="lineno">  792</span>        assert_equal(message, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  793</span>        assert_equal(solver.n, 2)</div>
<div class="line"><span class="lineno">  794</span>        assert_equal(solver.t_bound, np.inf)</div>
<div class="line"><span class="lineno">  795</span>        assert_equal(solver.direction, 1)</div>
<div class="line"><span class="lineno">  796</span>        assert_(solver.t &gt; 5)</div>
<div class="line"><span class="lineno">  797</span>        assert_(<span class="keywordflow">not</span> np.all(np.equal(solver.y, y0)))</div>
<div class="line"><span class="lineno">  798</span>        assert_(solver.step_size &gt; 0)</div>
<div class="line"><span class="lineno">  799</span>        assert_(solver.nfev &gt; 0)</div>
<div class="line"><span class="lineno">  800</span>        assert_(solver.njev &gt;= 0)</div>
<div class="line"><span class="lineno">  801</span>        assert_(solver.nlu &gt;= 0)</div>
<div class="line"><span class="lineno">  802</span>        sol = solver.dense_output()</div>
<div class="line"><span class="lineno">  803</span>        assert_allclose(sol(5), y0, rtol=1e-15, atol=0)</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9879a90966b4198c79b1ae585ec4f55" name="ad9879a90966b4198c79b1ae585ec4f55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9879a90966b4198c79b1ae585ec4f55">&#9670;&#160;</a></span>test_ConstantDenseOutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_ConstantDenseOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  758</span><span class="keyword">def </span>test_ConstantDenseOutput():</div>
<div class="line"><span class="lineno">  759</span>    sol = ConstantDenseOutput(0, 1, np.array([1, 2]))</div>
<div class="line"><span class="lineno">  760</span>    assert_allclose(sol(1.5), [1, 2])</div>
<div class="line"><span class="lineno">  761</span>    assert_allclose(sol([1, 1.5, 2]), [[1, 1, 1], [2, 2, 2]])</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>    sol = ConstantDenseOutput(0, 1, np.array([]))</div>
<div class="line"><span class="lineno">  764</span>    assert_allclose(sol(1.5), np.empty(0))</div>
<div class="line"><span class="lineno">  765</span>    assert_allclose(sol([1, 1.5, 2]), np.empty((0, 3)))</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abbc432f12d06a6247138b8de77c204ab" name="abbc432f12d06a6247138b8de77c204ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbc432f12d06a6247138b8de77c204ab">&#9670;&#160;</a></span>test_empty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_empty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  739</span><span class="keyword">def </span>test_empty():</div>
<div class="line"><span class="lineno">  740</span>    <span class="keyword">def </span>fun(t, y):</div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">return</span> np.zeros((0,))</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>    y0 = np.zeros((0,))</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;Radau&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>, <span class="stringliteral">&#39;LSODA&#39;</span>]:</div>
<div class="line"><span class="lineno">  746</span>        sol = assert_no_warnings(solve_ivp, fun, [0, 10], y0,</div>
<div class="line"><span class="lineno">  747</span>                                 method=method, dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  748</span>        assert_equal(sol.sol(10), np.zeros((0,)))</div>
<div class="line"><span class="lineno">  749</span>        assert_equal(sol.sol([1, 2, 3]), np.zeros((0, 3)))</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;Radau&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>, <span class="stringliteral">&#39;LSODA&#39;</span>]:</div>
<div class="line"><span class="lineno">  752</span>        sol = assert_no_warnings(solve_ivp, fun, [0, np.inf], y0,</div>
<div class="line"><span class="lineno">  753</span>                                 method=method, dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  754</span>        assert_equal(sol.sol(10), np.zeros((0,)))</div>
<div class="line"><span class="lineno">  755</span>        assert_equal(sol.sol([1, 2, 3]), np.zeros((0, 3)))</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acb83743ea1ef8cf07a5ff3dbb4115a5d" name="acb83743ea1ef8cf07a5ff3dbb4115a5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb83743ea1ef8cf07a5ff3dbb4115a5d">&#9670;&#160;</a></span>test_events()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_events </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  341</span><span class="keyword">def </span>test_events():</div>
<div class="line"><span class="lineno">  342</span>    <span class="keyword">def </span>event_rational_1(t, y):</div>
<div class="line"><span class="lineno">  343</span>        <span class="keywordflow">return</span> y[0] - y[1] ** 0.7</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="keyword">def </span>event_rational_2(t, y):</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">return</span> y[1] ** 0.6 - y[0]</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="keyword">def </span>event_rational_3(t, y):</div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordflow">return</span> t - 7.4</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    event_rational_3.terminal = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;Radau&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>, <span class="stringliteral">&#39;LSODA&#39;</span>]:</div>
<div class="line"><span class="lineno">  354</span>        res = solve_ivp(fun_rational, [5, 8], [1/3, 2/9], method=method,</div>
<div class="line"><span class="lineno">  355</span>                        events=(event_rational_1, event_rational_2))</div>
<div class="line"><span class="lineno">  356</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  357</span>        assert_equal(res.t_events[0].size, 1)</div>
<div class="line"><span class="lineno">  358</span>        assert_equal(res.t_events[1].size, 1)</div>
<div class="line"><span class="lineno">  359</span>        assert_(5.3 &lt; res.t_events[0][0] &lt; 5.7)</div>
<div class="line"><span class="lineno">  360</span>        assert_(7.3 &lt; res.t_events[1][0] &lt; 7.7)</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>        assert_equal(res.y_events[0].shape, (1, 2))</div>
<div class="line"><span class="lineno">  363</span>        assert_equal(res.y_events[1].shape, (1, 2))</div>
<div class="line"><span class="lineno">  364</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  365</span>            event_rational_1(res.t_events[0][0], res.y_events[0][0]), 0)</div>
<div class="line"><span class="lineno">  366</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  367</span>            event_rational_2(res.t_events[1][0], res.y_events[1][0]), 0)</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>        event_rational_1.direction = 1</div>
<div class="line"><span class="lineno">  370</span>        event_rational_2.direction = 1</div>
<div class="line"><span class="lineno">  371</span>        res = solve_ivp(fun_rational, [5, 8], [1 / 3, 2 / 9], method=method,</div>
<div class="line"><span class="lineno">  372</span>                        events=(event_rational_1, event_rational_2))</div>
<div class="line"><span class="lineno">  373</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  374</span>        assert_equal(res.t_events[0].size, 1)</div>
<div class="line"><span class="lineno">  375</span>        assert_equal(res.t_events[1].size, 0)</div>
<div class="line"><span class="lineno">  376</span>        assert_(5.3 &lt; res.t_events[0][0] &lt; 5.7)</div>
<div class="line"><span class="lineno">  377</span>        assert_equal(res.y_events[0].shape, (1, 2))</div>
<div class="line"><span class="lineno">  378</span>        assert_equal(res.y_events[1].shape, (0,))</div>
<div class="line"><span class="lineno">  379</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  380</span>            event_rational_1(res.t_events[0][0], res.y_events[0][0]), 0)</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>        event_rational_1.direction = -1</div>
<div class="line"><span class="lineno">  383</span>        event_rational_2.direction = -1</div>
<div class="line"><span class="lineno">  384</span>        res = solve_ivp(fun_rational, [5, 8], [1 / 3, 2 / 9], method=method,</div>
<div class="line"><span class="lineno">  385</span>                        events=(event_rational_1, event_rational_2))</div>
<div class="line"><span class="lineno">  386</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  387</span>        assert_equal(res.t_events[0].size, 0)</div>
<div class="line"><span class="lineno">  388</span>        assert_equal(res.t_events[1].size, 1)</div>
<div class="line"><span class="lineno">  389</span>        assert_(7.3 &lt; res.t_events[1][0] &lt; 7.7)</div>
<div class="line"><span class="lineno">  390</span>        assert_equal(res.y_events[0].shape, (0,))</div>
<div class="line"><span class="lineno">  391</span>        assert_equal(res.y_events[1].shape, (1, 2))</div>
<div class="line"><span class="lineno">  392</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  393</span>            event_rational_2(res.t_events[1][0], res.y_events[1][0]), 0)</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>        event_rational_1.direction = 0</div>
<div class="line"><span class="lineno">  396</span>        event_rational_2.direction = 0</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>        res = solve_ivp(fun_rational, [5, 8], [1 / 3, 2 / 9], method=method,</div>
<div class="line"><span class="lineno">  399</span>                        events=(event_rational_1, event_rational_2,</div>
<div class="line"><span class="lineno">  400</span>                                event_rational_3), dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  401</span>        assert_equal(res.status, 1)</div>
<div class="line"><span class="lineno">  402</span>        assert_equal(res.t_events[0].size, 1)</div>
<div class="line"><span class="lineno">  403</span>        assert_equal(res.t_events[1].size, 0)</div>
<div class="line"><span class="lineno">  404</span>        assert_equal(res.t_events[2].size, 1)</div>
<div class="line"><span class="lineno">  405</span>        assert_(5.3 &lt; res.t_events[0][0] &lt; 5.7)</div>
<div class="line"><span class="lineno">  406</span>        assert_(7.3 &lt; res.t_events[2][0] &lt; 7.5)</div>
<div class="line"><span class="lineno">  407</span>        assert_equal(res.y_events[0].shape, (1, 2))</div>
<div class="line"><span class="lineno">  408</span>        assert_equal(res.y_events[1].shape, (0,))</div>
<div class="line"><span class="lineno">  409</span>        assert_equal(res.y_events[2].shape, (1, 2))</div>
<div class="line"><span class="lineno">  410</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  411</span>            event_rational_1(res.t_events[0][0], res.y_events[0][0]), 0)</div>
<div class="line"><span class="lineno">  412</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  413</span>            event_rational_3(res.t_events[2][0], res.y_events[2][0]), 0)</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>        res = solve_ivp(fun_rational, [5, 8], [1 / 3, 2 / 9], method=method,</div>
<div class="line"><span class="lineno">  416</span>                        events=event_rational_1, dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  417</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  418</span>        assert_equal(res.t_events[0].size, 1)</div>
<div class="line"><span class="lineno">  419</span>        assert_(5.3 &lt; res.t_events[0][0] &lt; 5.7)</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>        assert_equal(res.y_events[0].shape, (1, 2))</div>
<div class="line"><span class="lineno">  422</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  423</span>            event_rational_1(res.t_events[0][0], res.y_events[0][0]), 0)</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>        <span class="comment"># Also test that termination by event doesn&#39;t break interpolants.</span></div>
<div class="line"><span class="lineno">  426</span>        tc = np.linspace(res.t[0], res.t[-1])</div>
<div class="line"><span class="lineno">  427</span>        yc_true = sol_rational(tc)</div>
<div class="line"><span class="lineno">  428</span>        yc = res.sol(tc)</div>
<div class="line"><span class="lineno">  429</span>        e = compute_error(yc, yc_true, 1e-3, 1e-6)</div>
<div class="line"><span class="lineno">  430</span>        assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>        <span class="comment"># Test that the y_event matches solution</span></div>
<div class="line"><span class="lineno">  433</span>        <span class="keyword">assert</span> np.allclose(sol_rational(res.t_events[0][0]), res.y_events[0][0], rtol=1e-3, atol=1e-6)</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    <span class="comment"># Test in backward direction.</span></div>
<div class="line"><span class="lineno">  436</span>    event_rational_1.direction = 0</div>
<div class="line"><span class="lineno">  437</span>    event_rational_2.direction = 0</div>
<div class="line"><span class="lineno">  438</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;Radau&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>, <span class="stringliteral">&#39;LSODA&#39;</span>]:</div>
<div class="line"><span class="lineno">  439</span>        res = solve_ivp(fun_rational, [8, 5], [4/9, 20/81], method=method,</div>
<div class="line"><span class="lineno">  440</span>                        events=(event_rational_1, event_rational_2))</div>
<div class="line"><span class="lineno">  441</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  442</span>        assert_equal(res.t_events[0].size, 1)</div>
<div class="line"><span class="lineno">  443</span>        assert_equal(res.t_events[1].size, 1)</div>
<div class="line"><span class="lineno">  444</span>        assert_(5.3 &lt; res.t_events[0][0] &lt; 5.7)</div>
<div class="line"><span class="lineno">  445</span>        assert_(7.3 &lt; res.t_events[1][0] &lt; 7.7)</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>        assert_equal(res.y_events[0].shape, (1, 2))</div>
<div class="line"><span class="lineno">  448</span>        assert_equal(res.y_events[1].shape, (1, 2))</div>
<div class="line"><span class="lineno">  449</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  450</span>            event_rational_1(res.t_events[0][0], res.y_events[0][0]), 0)</div>
<div class="line"><span class="lineno">  451</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  452</span>            event_rational_2(res.t_events[1][0], res.y_events[1][0]), 0)</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>        event_rational_1.direction = -1</div>
<div class="line"><span class="lineno">  455</span>        event_rational_2.direction = -1</div>
<div class="line"><span class="lineno">  456</span>        res = solve_ivp(fun_rational, [8, 5], [4/9, 20/81], method=method,</div>
<div class="line"><span class="lineno">  457</span>                        events=(event_rational_1, event_rational_2))</div>
<div class="line"><span class="lineno">  458</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  459</span>        assert_equal(res.t_events[0].size, 1)</div>
<div class="line"><span class="lineno">  460</span>        assert_equal(res.t_events[1].size, 0)</div>
<div class="line"><span class="lineno">  461</span>        assert_(5.3 &lt; res.t_events[0][0] &lt; 5.7)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>        assert_equal(res.y_events[0].shape, (1, 2))</div>
<div class="line"><span class="lineno">  464</span>        assert_equal(res.y_events[1].shape, (0,))</div>
<div class="line"><span class="lineno">  465</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  466</span>            event_rational_1(res.t_events[0][0], res.y_events[0][0]), 0)</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>        event_rational_1.direction = 1</div>
<div class="line"><span class="lineno">  469</span>        event_rational_2.direction = 1</div>
<div class="line"><span class="lineno">  470</span>        res = solve_ivp(fun_rational, [8, 5], [4/9, 20/81], method=method,</div>
<div class="line"><span class="lineno">  471</span>                        events=(event_rational_1, event_rational_2))</div>
<div class="line"><span class="lineno">  472</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  473</span>        assert_equal(res.t_events[0].size, 0)</div>
<div class="line"><span class="lineno">  474</span>        assert_equal(res.t_events[1].size, 1)</div>
<div class="line"><span class="lineno">  475</span>        assert_(7.3 &lt; res.t_events[1][0] &lt; 7.7)</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>        assert_equal(res.y_events[0].shape, (0,))</div>
<div class="line"><span class="lineno">  478</span>        assert_equal(res.y_events[1].shape, (1, 2))</div>
<div class="line"><span class="lineno">  479</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  480</span>            event_rational_2(res.t_events[1][0], res.y_events[1][0]), 0)</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>        event_rational_1.direction = 0</div>
<div class="line"><span class="lineno">  483</span>        event_rational_2.direction = 0</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>        res = solve_ivp(fun_rational, [8, 5], [4/9, 20/81], method=method,</div>
<div class="line"><span class="lineno">  486</span>                        events=(event_rational_1, event_rational_2,</div>
<div class="line"><span class="lineno">  487</span>                                event_rational_3), dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  488</span>        assert_equal(res.status, 1)</div>
<div class="line"><span class="lineno">  489</span>        assert_equal(res.t_events[0].size, 0)</div>
<div class="line"><span class="lineno">  490</span>        assert_equal(res.t_events[1].size, 1)</div>
<div class="line"><span class="lineno">  491</span>        assert_equal(res.t_events[2].size, 1)</div>
<div class="line"><span class="lineno">  492</span>        assert_(7.3 &lt; res.t_events[1][0] &lt; 7.7)</div>
<div class="line"><span class="lineno">  493</span>        assert_(7.3 &lt; res.t_events[2][0] &lt; 7.5)</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>        assert_equal(res.y_events[0].shape, (0,))</div>
<div class="line"><span class="lineno">  496</span>        assert_equal(res.y_events[1].shape, (1, 2))</div>
<div class="line"><span class="lineno">  497</span>        assert_equal(res.y_events[2].shape, (1, 2))</div>
<div class="line"><span class="lineno">  498</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  499</span>            event_rational_2(res.t_events[1][0], res.y_events[1][0]), 0)</div>
<div class="line"><span class="lineno">  500</span>        <span class="keyword">assert</span> np.isclose(</div>
<div class="line"><span class="lineno">  501</span>            event_rational_3(res.t_events[2][0], res.y_events[2][0]), 0)</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>        <span class="comment"># Also test that termination by event doesn&#39;t break interpolants.</span></div>
<div class="line"><span class="lineno">  504</span>        tc = np.linspace(res.t[-1], res.t[0])</div>
<div class="line"><span class="lineno">  505</span>        yc_true = sol_rational(tc)</div>
<div class="line"><span class="lineno">  506</span>        yc = res.sol(tc)</div>
<div class="line"><span class="lineno">  507</span>        e = compute_error(yc, yc_true, 1e-3, 1e-6)</div>
<div class="line"><span class="lineno">  508</span>        assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>        <span class="keyword">assert</span> np.allclose(sol_rational(res.t_events[1][0]), res.y_events[1][0], rtol=1e-3, atol=1e-6)</div>
<div class="line"><span class="lineno">  511</span>        <span class="keyword">assert</span> np.allclose(sol_rational(res.t_events[2][0]), res.y_events[2][0], rtol=1e-3, atol=1e-6)</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ada56b08a0a8146fcfd4407c999c47576" name="ada56b08a0a8146fcfd4407c999c47576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada56b08a0a8146fcfd4407c999c47576">&#9670;&#160;</a></span>test_first_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_first_step </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  558</span><span class="keyword">def </span>test_first_step():</div>
<div class="line"><span class="lineno">  559</span>    rtol = 1e-3</div>
<div class="line"><span class="lineno">  560</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  561</span>    y0 = [1/3, 2/9]</div>
<div class="line"><span class="lineno">  562</span>    first_step = 0.1</div>
<div class="line"><span class="lineno">  563</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [RK23, RK45, DOP853, Radau, BDF, LSODA]:</div>
<div class="line"><span class="lineno">  564</span>        <span class="keywordflow">for</span> t_span <span class="keywordflow">in</span> ([5, 9], [5, 1]):</div>
<div class="line"><span class="lineno">  565</span>            res = solve_ivp(fun_rational, t_span, y0, rtol=rtol,</div>
<div class="line"><span class="lineno">  566</span>                            max_step=0.5, atol=atol, method=method,</div>
<div class="line"><span class="lineno">  567</span>                            dense_output=<span class="keyword">True</span>, first_step=first_step)</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>            assert_equal(res.t[0], t_span[0])</div>
<div class="line"><span class="lineno">  570</span>            assert_equal(res.t[-1], t_span[-1])</div>
<div class="line"><span class="lineno">  571</span>            assert_allclose(first_step, np.abs(res.t[1] - 5))</div>
<div class="line"><span class="lineno">  572</span>            assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  573</span>            assert_(res.success)</div>
<div class="line"><span class="lineno">  574</span>            assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>            y_true = sol_rational(res.t)</div>
<div class="line"><span class="lineno">  577</span>            e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  578</span>            assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>            tc = np.linspace(*t_span)</div>
<div class="line"><span class="lineno">  581</span>            yc_true = sol_rational(tc)</div>
<div class="line"><span class="lineno">  582</span>            yc = res.sol(tc)</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>            e = compute_error(yc, yc_true, rtol, atol)</div>
<div class="line"><span class="lineno">  585</span>            assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>            <span class="comment"># See comment in test_integration.</span></div>
<div class="line"><span class="lineno">  588</span>            <span class="keywordflow">if</span> method <span class="keywordflow">is</span> <span class="keywordflow">not</span> LSODA:</div>
<div class="line"><span class="lineno">  589</span>                assert_allclose(res.sol(res.t), res.y, rtol=1e-15, atol=1e-15)</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>            assert_raises(ValueError, method, fun_rational, t_span[0], y0,</div>
<div class="line"><span class="lineno">  592</span>                          t_span[1], first_step=-1)</div>
<div class="line"><span class="lineno">  593</span>            assert_raises(ValueError, method, fun_rational, t_span[0], y0,</div>
<div class="line"><span class="lineno">  594</span>                          t_span[1], first_step=5)</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a95c50287f936099a73cb21c2b57fd947" name="a95c50287f936099a73cb21c2b57fd947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95c50287f936099a73cb21c2b57fd947">&#9670;&#160;</a></span>test_integration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_integration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  143</span><span class="keyword">def </span>test_integration():</div>
<div class="line"><span class="lineno">  144</span>    rtol = 1e-3</div>
<div class="line"><span class="lineno">  145</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  146</span>    y0 = [1/3, 2/9]</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">for</span> vectorized, method, t_span, jac <span class="keywordflow">in</span> product(</div>
<div class="line"><span class="lineno">  149</span>            [<span class="keyword">False</span>, <span class="keyword">True</span>],</div>
<div class="line"><span class="lineno">  150</span>            [<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;Radau&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>, <span class="stringliteral">&#39;LSODA&#39;</span>],</div>
<div class="line"><span class="lineno">  151</span>            [[5, 9], [5, 1]],</div>
<div class="line"><span class="lineno">  152</span>            [<span class="keywordtype">None</span>, jac_rational, jac_rational_sparse]):</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">if</span> vectorized:</div>
<div class="line"><span class="lineno">  155</span>            fun = fun_rational_vectorized</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  157</span>            fun = fun_rational</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>        <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno">  160</span>            sup.filter(UserWarning,</div>
<div class="line"><span class="lineno">  161</span>                       <span class="stringliteral">&quot;The following arguments have no effect for a chosen &quot;</span></div>
<div class="line"><span class="lineno">  162</span>                       <span class="stringliteral">&quot;solver: `jac`&quot;</span>)</div>
<div class="line"><span class="lineno">  163</span>            res = solve_ivp(fun, t_span, y0, rtol=rtol,</div>
<div class="line"><span class="lineno">  164</span>                            atol=atol, method=method, dense_output=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  165</span>                            jac=jac, vectorized=vectorized)</div>
<div class="line"><span class="lineno">  166</span>        assert_equal(res.t[0], t_span[0])</div>
<div class="line"><span class="lineno">  167</span>        assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  168</span>        assert_(res.y_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  169</span>        assert_(res.success)</div>
<div class="line"><span class="lineno">  170</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>        <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;DOP853&#39;</span>:</div>
<div class="line"><span class="lineno">  173</span>            <span class="comment"># DOP853 spends more functions evaluation because it doesn&#39;t</span></div>
<div class="line"><span class="lineno">  174</span>            <span class="comment"># have enough time to develop big enough step size.</span></div>
<div class="line"><span class="lineno">  175</span>            assert_(res.nfev &lt; 50)</div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  177</span>            assert_(res.nfev &lt; 40)</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">if</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;LSODA&#39;</span>]:</div>
<div class="line"><span class="lineno">  180</span>            assert_equal(res.njev, 0)</div>
<div class="line"><span class="lineno">  181</span>            assert_equal(res.nlu, 0)</div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  183</span>            assert_(0 &lt; res.njev &lt; 3)</div>
<div class="line"><span class="lineno">  184</span>            assert_(0 &lt; res.nlu &lt; 10)</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>        y_true = sol_rational(res.t)</div>
<div class="line"><span class="lineno">  187</span>        e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  188</span>        assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>        tc = np.linspace(*t_span)</div>
<div class="line"><span class="lineno">  191</span>        yc_true = sol_rational(tc)</div>
<div class="line"><span class="lineno">  192</span>        yc = res.sol(tc)</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>        e = compute_error(yc, yc_true, rtol, atol)</div>
<div class="line"><span class="lineno">  195</span>        assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>        tc = (t_span[0] + t_span[-1]) / 2</div>
<div class="line"><span class="lineno">  198</span>        yc_true = sol_rational(tc)</div>
<div class="line"><span class="lineno">  199</span>        yc = res.sol(tc)</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>        e = compute_error(yc, yc_true, rtol, atol)</div>
<div class="line"><span class="lineno">  202</span>        assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>        <span class="comment"># LSODA for some reasons doesn&#39;t pass the polynomial through the</span></div>
<div class="line"><span class="lineno">  205</span>        <span class="comment"># previous points exactly after the order change. It might be some</span></div>
<div class="line"><span class="lineno">  206</span>        <span class="comment"># bug in LSOSA implementation or maybe we missing something.</span></div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">if</span> method != <span class="stringliteral">&#39;LSODA&#39;</span>:</div>
<div class="line"><span class="lineno">  208</span>            assert_allclose(res.sol(res.t), res.y, rtol=1e-15, atol=1e-15)</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fcb81b81965a65bebf2764b1077e10b" name="a5fcb81b81965a65bebf2764b1077e10b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fcb81b81965a65bebf2764b1077e10b">&#9670;&#160;</a></span>test_integration_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_integration_complex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  211</span><span class="keyword">def </span>test_integration_complex():</div>
<div class="line"><span class="lineno">  212</span>    rtol = 1e-3</div>
<div class="line"><span class="lineno">  213</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  214</span>    y0 = [0.5 + 1j]</div>
<div class="line"><span class="lineno">  215</span>    t_span = [0, 1]</div>
<div class="line"><span class="lineno">  216</span>    tc = np.linspace(t_span[0], t_span[1])</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">for</span> method, jac <span class="keywordflow">in</span> product([<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>],</div>
<div class="line"><span class="lineno">  218</span>                               [<span class="keywordtype">None</span>, jac_complex, jac_complex_sparse]):</div>
<div class="line"><span class="lineno">  219</span>        <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno">  220</span>            sup.filter(UserWarning,</div>
<div class="line"><span class="lineno">  221</span>                       <span class="stringliteral">&quot;The following arguments have no effect for a chosen &quot;</span></div>
<div class="line"><span class="lineno">  222</span>                       <span class="stringliteral">&quot;solver: `jac`&quot;</span>)</div>
<div class="line"><span class="lineno">  223</span>            res = solve_ivp(fun_complex, t_span, y0, method=method,</div>
<div class="line"><span class="lineno">  224</span>                            dense_output=<span class="keyword">True</span>, rtol=rtol, atol=atol, jac=jac)</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>        assert_equal(res.t[0], t_span[0])</div>
<div class="line"><span class="lineno">  227</span>        assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  228</span>        assert_(res.y_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  229</span>        assert_(res.success)</div>
<div class="line"><span class="lineno">  230</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>        <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;DOP853&#39;</span>:</div>
<div class="line"><span class="lineno">  233</span>            <span class="keyword">assert</span> res.nfev &lt; 35</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  235</span>            <span class="keyword">assert</span> res.nfev &lt; 25</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;BDF&#39;</span>:</div>
<div class="line"><span class="lineno">  238</span>            assert_equal(res.njev, 1)</div>
<div class="line"><span class="lineno">  239</span>            <span class="keyword">assert</span> res.nlu &lt; 6</div>
<div class="line"><span class="lineno">  240</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  241</span>            <span class="keyword">assert</span> res.njev == 0</div>
<div class="line"><span class="lineno">  242</span>            <span class="keyword">assert</span> res.nlu == 0</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>        y_true = sol_complex(res.t)</div>
<div class="line"><span class="lineno">  245</span>        e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  246</span>        <span class="keyword">assert</span> np.all(e &lt; 5)</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>        yc_true = sol_complex(tc)</div>
<div class="line"><span class="lineno">  249</span>        yc = res.sol(tc)</div>
<div class="line"><span class="lineno">  250</span>        e = compute_error(yc, yc_true, rtol, atol)</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>        <span class="keyword">assert</span> np.all(e &lt; 5)</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af26e8fe90a4395dd27b08fffa4e131a1" name="af26e8fe90a4395dd27b08fffa4e131a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af26e8fe90a4395dd27b08fffa4e131a1">&#9670;&#160;</a></span>test_integration_const_jac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_integration_const_jac </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  282</span><span class="keyword">def </span>test_integration_const_jac():</div>
<div class="line"><span class="lineno">  283</span>    rtol = 1e-3</div>
<div class="line"><span class="lineno">  284</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  285</span>    y0 = [0, 2]</div>
<div class="line"><span class="lineno">  286</span>    t_span = [0, 2]</div>
<div class="line"><span class="lineno">  287</span>    J = jac_linear()</div>
<div class="line"><span class="lineno">  288</span>    J_sparse = csc_matrix(J)</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">for</span> method, jac <span class="keywordflow">in</span> product([<span class="stringliteral">&#39;Radau&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>], [J, J_sparse]):</div>
<div class="line"><span class="lineno">  291</span>        res = solve_ivp(fun_linear, t_span, y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  292</span>                        method=method, dense_output=<span class="keyword">True</span>, jac=jac)</div>
<div class="line"><span class="lineno">  293</span>        assert_equal(res.t[0], t_span[0])</div>
<div class="line"><span class="lineno">  294</span>        assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  295</span>        assert_(res.y_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  296</span>        assert_(res.success)</div>
<div class="line"><span class="lineno">  297</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>        assert_(res.nfev &lt; 100)</div>
<div class="line"><span class="lineno">  300</span>        assert_equal(res.njev, 0)</div>
<div class="line"><span class="lineno">  301</span>        assert_(0 &lt; res.nlu &lt; 15)</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>        y_true = sol_linear(res.t)</div>
<div class="line"><span class="lineno">  304</span>        e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  305</span>        assert_(np.all(e &lt; 10))</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>        tc = np.linspace(*t_span)</div>
<div class="line"><span class="lineno">  308</span>        yc_true = sol_linear(tc)</div>
<div class="line"><span class="lineno">  309</span>        yc = res.sol(tc)</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>        e = compute_error(yc, yc_true, rtol, atol)</div>
<div class="line"><span class="lineno">  312</span>        assert_(np.all(e &lt; 15))</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>        assert_allclose(res.sol(res.t), res.y, rtol=1e-14, atol=1e-14)</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span><span class="preprocessor">@pytest.mark.slow</span></div>
<div class="line"><span class="lineno">  318</span><span class="preprocessor">@pytest.mark.parametrize(&#39;method&#39;, [&#39;Radau&#39;, &#39;BDF&#39;, &#39;LSODA&#39;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7256d01ece43a5f75d9e0ac9c558a77" name="ae7256d01ece43a5f75d9e0ac9c558a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7256d01ece43a5f75d9e0ac9c558a77">&#9670;&#160;</a></span>test_integration_sparse_difference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_integration_sparse_difference </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  255</span><span class="keyword">def </span>test_integration_sparse_difference():</div>
<div class="line"><span class="lineno">  256</span>    n = 200</div>
<div class="line"><span class="lineno">  257</span>    t_span = [0, 20]</div>
<div class="line"><span class="lineno">  258</span>    y0 = np.zeros(2 * n)</div>
<div class="line"><span class="lineno">  259</span>    y0[1::2] = 1</div>
<div class="line"><span class="lineno">  260</span>    sparsity = medazko_sparsity(n)</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;BDF&#39;</span>, <span class="stringliteral">&#39;Radau&#39;</span>]:</div>
<div class="line"><span class="lineno">  263</span>        res = solve_ivp(fun_medazko, t_span, y0, method=method,</div>
<div class="line"><span class="lineno">  264</span>                        jac_sparsity=sparsity)</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>        assert_equal(res.t[0], t_span[0])</div>
<div class="line"><span class="lineno">  267</span>        assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  268</span>        assert_(res.y_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  269</span>        assert_(res.success)</div>
<div class="line"><span class="lineno">  270</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>        assert_allclose(res.y[78, -1], 0.233994e-3, rtol=1e-2)</div>
<div class="line"><span class="lineno">  273</span>        assert_allclose(res.y[79, -1], 0, atol=1e-3)</div>
<div class="line"><span class="lineno">  274</span>        assert_allclose(res.y[148, -1], 0.359561e-3, rtol=1e-2)</div>
<div class="line"><span class="lineno">  275</span>        assert_allclose(res.y[149, -1], 0, atol=1e-3)</div>
<div class="line"><span class="lineno">  276</span>        assert_allclose(res.y[198, -1], 0.117374129e-3, rtol=1e-2)</div>
<div class="line"><span class="lineno">  277</span>        assert_allclose(res.y[199, -1], 0.6190807e-5, atol=1e-3)</div>
<div class="line"><span class="lineno">  278</span>        assert_allclose(res.y[238, -1], 0, atol=1e-3)</div>
<div class="line"><span class="lineno">  279</span>        assert_allclose(res.y[239, -1], 0.9999997, rtol=1e-2)</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a72f35d3fbfa47e38404b8e5ffc96d845" name="a72f35d3fbfa47e38404b8e5ffc96d845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72f35d3fbfa47e38404b8e5ffc96d845">&#9670;&#160;</a></span>test_integration_stiff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_integration_stiff </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  319</span><span class="keyword">def </span>test_integration_stiff(method):</div>
<div class="line"><span class="lineno">  320</span>    rtol = 1e-6</div>
<div class="line"><span class="lineno">  321</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  322</span>    y0 = [1e4, 0, 0]</div>
<div class="line"><span class="lineno">  323</span>    tspan = [0, 1e8]</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>    <span class="keyword">def </span>fun_robertson(t, state):</div>
<div class="line"><span class="lineno">  326</span>        x, y, z = state</div>
<div class="line"><span class="lineno">  327</span>        <span class="keywordflow">return</span> [</div>
<div class="line"><span class="lineno">  328</span>            -0.04 * x + 1e4 * y * z,</div>
<div class="line"><span class="lineno">  329</span>            0.04 * x - 1e4 * y * z - 3e7 * y * y,</div>
<div class="line"><span class="lineno">  330</span>            3e7 * y * y,</div>
<div class="line"><span class="lineno">  331</span>        ]</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    res = solve_ivp(fun_robertson, tspan, y0, rtol=rtol,</div>
<div class="line"><span class="lineno">  334</span>                    atol=atol, method=method)</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    <span class="comment"># If the stiff mode is not activated correctly, these numbers will be much bigger</span></div>
<div class="line"><span class="lineno">  337</span>    <span class="keyword">assert</span> res.nfev &lt; 5000</div>
<div class="line"><span class="lineno">  338</span>    <span class="keyword">assert</span> res.njev &lt; 200</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aba7fab352d673df1aff810a5c5568ee2" name="aba7fab352d673df1aff810a5c5568ee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba7fab352d673df1aff810a5c5568ee2">&#9670;&#160;</a></span>test_integration_zero_rhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_integration_zero_rhs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1024</span><span class="keyword">def </span>test_integration_zero_rhs(method):</div>
<div class="line"><span class="lineno"> 1025</span>    result = solve_ivp(fun_zero, [0, 10], np.ones(3), method=method)</div>
<div class="line"><span class="lineno"> 1026</span>    assert_(result.success)</div>
<div class="line"><span class="lineno"> 1027</span>    assert_equal(result.status, 0)</div>
<div class="line"><span class="lineno"> 1028</span>    assert_allclose(result.y, 1.0, rtol=1e-15)</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ff6b2c7a3a0e2581f51bbce1b8540b9" name="a6ff6b2c7a3a0e2581f51bbce1b8540b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ff6b2c7a3a0e2581f51bbce1b8540b9">&#9670;&#160;</a></span>test_max_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_max_step </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  514</span><span class="keyword">def </span>test_max_step():</div>
<div class="line"><span class="lineno">  515</span>    rtol = 1e-3</div>
<div class="line"><span class="lineno">  516</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  517</span>    y0 = [1/3, 2/9]</div>
<div class="line"><span class="lineno">  518</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [RK23, RK45, DOP853, Radau, BDF, LSODA]:</div>
<div class="line"><span class="lineno">  519</span>        <span class="keywordflow">for</span> t_span <span class="keywordflow">in</span> ([5, 9], [5, 1]):</div>
<div class="line"><span class="lineno">  520</span>            res = solve_ivp(fun_rational, t_span, y0, rtol=rtol,</div>
<div class="line"><span class="lineno">  521</span>                            max_step=0.5, atol=atol, method=method,</div>
<div class="line"><span class="lineno">  522</span>                            dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  523</span>            assert_equal(res.t[0], t_span[0])</div>
<div class="line"><span class="lineno">  524</span>            assert_equal(res.t[-1], t_span[-1])</div>
<div class="line"><span class="lineno">  525</span>            assert_(np.all(np.abs(np.diff(res.t)) &lt;= 0.5 + 1e-15))</div>
<div class="line"><span class="lineno">  526</span>            assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  527</span>            assert_(res.success)</div>
<div class="line"><span class="lineno">  528</span>            assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>            y_true = sol_rational(res.t)</div>
<div class="line"><span class="lineno">  531</span>            e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  532</span>            assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>            tc = np.linspace(*t_span)</div>
<div class="line"><span class="lineno">  535</span>            yc_true = sol_rational(tc)</div>
<div class="line"><span class="lineno">  536</span>            yc = res.sol(tc)</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>            e = compute_error(yc, yc_true, rtol, atol)</div>
<div class="line"><span class="lineno">  539</span>            assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>            <span class="comment"># See comment in test_integration.</span></div>
<div class="line"><span class="lineno">  542</span>            <span class="keywordflow">if</span> method <span class="keywordflow">is</span> <span class="keywordflow">not</span> LSODA:</div>
<div class="line"><span class="lineno">  543</span>                assert_allclose(res.sol(res.t), res.y, rtol=1e-15, atol=1e-15)</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>            assert_raises(ValueError, method, fun_rational, t_span[0], y0,</div>
<div class="line"><span class="lineno">  546</span>                          t_span[1], max_step=-1)</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>            <span class="keywordflow">if</span> method <span class="keywordflow">is</span> <span class="keywordflow">not</span> LSODA:</div>
<div class="line"><span class="lineno">  549</span>                solver = method(fun_rational, t_span[0], y0, t_span[1],</div>
<div class="line"><span class="lineno">  550</span>                                rtol=rtol, atol=atol, max_step=1e-20)</div>
<div class="line"><span class="lineno">  551</span>                message = solver.step()</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>                assert_equal(solver.status, <span class="stringliteral">&#39;failed&#39;</span>)</div>
<div class="line"><span class="lineno">  554</span>                assert_(<span class="stringliteral">&quot;step size is less&quot;</span> <span class="keywordflow">in</span> message)</div>
<div class="line"><span class="lineno">  555</span>                assert_raises(RuntimeError, solver.step)</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac209b4163ab35aef2a1dc92daed44822" name="ac209b4163ab35aef2a1dc92daed44822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac209b4163ab35aef2a1dc92daed44822">&#9670;&#160;</a></span>test_no_integration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_no_integration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  714</span><span class="keyword">def </span>test_no_integration():</div>
<div class="line"><span class="lineno">  715</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;Radau&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>, <span class="stringliteral">&#39;LSODA&#39;</span>]:</div>
<div class="line"><span class="lineno">  716</span>        sol = solve_ivp(<span class="keyword">lambda</span> t, y: -y, [4, 4], [2, 3],</div>
<div class="line"><span class="lineno">  717</span>                        method=method, dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  718</span>        assert_equal(sol.sol(4), [2, 3])</div>
<div class="line"><span class="lineno">  719</span>        assert_equal(sol.sol([4, 5, 6]), [[2, 2, 2], [3, 3, 3]])</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0b5766ea0266d3782d25e38c0b0006b" name="ac0b5766ea0266d3782d25e38c0b0006b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0b5766ea0266d3782d25e38c0b0006b">&#9670;&#160;</a></span>test_no_integration_class()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_no_integration_class </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  722</span><span class="keyword">def </span>test_no_integration_class():</div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [RK23, RK45, DOP853, Radau, BDF, LSODA]:</div>
<div class="line"><span class="lineno">  724</span>        solver = method(<span class="keyword">lambda</span> t, y: -y, 0.0, [10.0, 0.0], 0.0)</div>
<div class="line"><span class="lineno">  725</span>        solver.step()</div>
<div class="line"><span class="lineno">  726</span>        assert_equal(solver.status, <span class="stringliteral">&#39;finished&#39;</span>)</div>
<div class="line"><span class="lineno">  727</span>        sol = solver.dense_output()</div>
<div class="line"><span class="lineno">  728</span>        assert_equal(sol(0.0), [10.0, 0.0])</div>
<div class="line"><span class="lineno">  729</span>        assert_equal(sol([0, 1, 2]), [[10, 10, 10], [0, 0, 0]])</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>        solver = method(<span class="keyword">lambda</span> t, y: -y, 0.0, [], np.inf)</div>
<div class="line"><span class="lineno">  732</span>        solver.step()</div>
<div class="line"><span class="lineno">  733</span>        assert_equal(solver.status, <span class="stringliteral">&#39;finished&#39;</span>)</div>
<div class="line"><span class="lineno">  734</span>        sol = solver.dense_output()</div>
<div class="line"><span class="lineno">  735</span>        assert_equal(sol(100.0), [])</div>
<div class="line"><span class="lineno">  736</span>        assert_equal(sol([0, 1, 2]), np.empty((0, 3)))</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a119de8491bb749c3c733cd9827785699" name="a119de8491bb749c3c733cd9827785699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a119de8491bb749c3c733cd9827785699">&#9670;&#160;</a></span>test_num_jac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_num_jac </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  849</span><span class="keyword">def </span>test_num_jac():</div>
<div class="line"><span class="lineno">  850</span>    <span class="keyword">def </span>fun(t, y):</div>
<div class="line"><span class="lineno">  851</span>        <span class="keywordflow">return</span> np.vstack([</div>
<div class="line"><span class="lineno">  852</span>            -0.04 * y[0] + 1e4 * y[1] * y[2],</div>
<div class="line"><span class="lineno">  853</span>            0.04 * y[0] - 1e4 * y[1] * y[2] - 3e7 * y[1] ** 2,</div>
<div class="line"><span class="lineno">  854</span>            3e7 * y[1] ** 2</div>
<div class="line"><span class="lineno">  855</span>        ])</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>    <span class="keyword">def </span>jac(t, y):</div>
<div class="line"><span class="lineno">  858</span>        <span class="keywordflow">return</span> np.array([</div>
<div class="line"><span class="lineno">  859</span>            [-0.04, 1e4 * y[2], 1e4 * y[1]],</div>
<div class="line"><span class="lineno">  860</span>            [0.04, -1e4 * y[2] - 6e7 * y[1], -1e4 * y[1]],</div>
<div class="line"><span class="lineno">  861</span>            [0, 6e7 * y[1], 0]</div>
<div class="line"><span class="lineno">  862</span>        ])</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>    t = 1</div>
<div class="line"><span class="lineno">  865</span>    y = np.array([1, 0, 0])</div>
<div class="line"><span class="lineno">  866</span>    J_true = jac(t, y)</div>
<div class="line"><span class="lineno">  867</span>    threshold = 1e-5</div>
<div class="line"><span class="lineno">  868</span>    f = fun(t, y).ravel()</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>    J_num, factor = num_jac(fun, t, y, f, threshold, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  871</span>    assert_allclose(J_num, J_true, rtol=1e-5, atol=1e-5)</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>    J_num, factor = num_jac(fun, t, y, f, threshold, factor)</div>
<div class="line"><span class="lineno">  874</span>    assert_allclose(J_num, J_true, rtol=1e-5, atol=1e-5)</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6d693508f3462270cf0d8c5d75af942" name="ac6d693508f3462270cf0d8c5d75af942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6d693508f3462270cf0d8c5d75af942">&#9670;&#160;</a></span>test_num_jac_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_num_jac_sparse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  877</span><span class="keyword">def </span>test_num_jac_sparse():</div>
<div class="line"><span class="lineno">  878</span>    <span class="keyword">def </span>fun(t, y):</div>
<div class="line"><span class="lineno">  879</span>        e = y[1:]**3 - y[:-1]**2</div>
<div class="line"><span class="lineno">  880</span>        z = np.zeros(y.shape[1])</div>
<div class="line"><span class="lineno">  881</span>        <span class="keywordflow">return</span> np.vstack((z, 3 * e)) + np.vstack((2 * e, z))</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>    <span class="keyword">def </span>structure(n):</div>
<div class="line"><span class="lineno">  884</span>        A = np.zeros((n, n), dtype=int)</div>
<div class="line"><span class="lineno">  885</span>        A[0, 0] = 1</div>
<div class="line"><span class="lineno">  886</span>        A[0, 1] = 1</div>
<div class="line"><span class="lineno">  887</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(1, n - 1):</div>
<div class="line"><span class="lineno">  888</span>            A[i, i - 1: i + 2] = 1</div>
<div class="line"><span class="lineno">  889</span>        A[-1, -1] = 1</div>
<div class="line"><span class="lineno">  890</span>        A[-1, -2] = 1</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>        <span class="keywordflow">return</span> A</div>
<div class="line"><span class="lineno">  893</span> </div>
<div class="line"><span class="lineno">  894</span>    np.random.seed(0)</div>
<div class="line"><span class="lineno">  895</span>    n = 20</div>
<div class="line"><span class="lineno">  896</span>    y = np.random.randn(n)</div>
<div class="line"><span class="lineno">  897</span>    A = structure(n)</div>
<div class="line"><span class="lineno">  898</span>    groups = group_columns(A)</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>    f = fun(0, y[:, <span class="keywordtype">None</span>]).ravel()</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>    <span class="comment"># Compare dense and sparse results, assuming that dense implementation</span></div>
<div class="line"><span class="lineno">  903</span>    <span class="comment"># is correct (as it is straightforward).</span></div>
<div class="line"><span class="lineno">  904</span>    J_num_sparse, factor_sparse = num_jac(fun, 0, y.ravel(), f, 1e-8, <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  905</span>                                          sparsity=(A, groups))</div>
<div class="line"><span class="lineno">  906</span>    J_num_dense, factor_dense = num_jac(fun, 0, y.ravel(), f, 1e-8, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  907</span>    assert_allclose(J_num_dense, J_num_sparse.toarray(),</div>
<div class="line"><span class="lineno">  908</span>                    rtol=1e-12, atol=1e-14)</div>
<div class="line"><span class="lineno">  909</span>    assert_allclose(factor_dense, factor_sparse, rtol=1e-12, atol=1e-14)</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>    <span class="comment"># Take small factors to trigger their recomputing inside.</span></div>
<div class="line"><span class="lineno">  912</span>    factor = np.random.uniform(0, 1e-12, size=n)</div>
<div class="line"><span class="lineno">  913</span>    J_num_sparse, factor_sparse = num_jac(fun, 0, y.ravel(), f, 1e-8, factor,</div>
<div class="line"><span class="lineno">  914</span>                                          sparsity=(A, groups))</div>
<div class="line"><span class="lineno">  915</span>    J_num_dense, factor_dense = num_jac(fun, 0, y.ravel(), f, 1e-8, factor)</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>    assert_allclose(J_num_dense, J_num_sparse.toarray(),</div>
<div class="line"><span class="lineno">  918</span>                    rtol=1e-12, atol=1e-14)</div>
<div class="line"><span class="lineno">  919</span>    assert_allclose(factor_dense, factor_sparse, rtol=1e-12, atol=1e-14)</div>
<div class="line"><span class="lineno">  920</span> </div>
<div class="line"><span class="lineno">  921</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7184ccb2b245ba7630788cea2705c2ca" name="a7184ccb2b245ba7630788cea2705c2ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7184ccb2b245ba7630788cea2705c2ca">&#9670;&#160;</a></span>test_OdeSolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_OdeSolution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  806</span><span class="keyword">def </span>test_OdeSolution():</div>
<div class="line"><span class="lineno">  807</span>    ts = np.array([0, 2, 5], dtype=float)</div>
<div class="line"><span class="lineno">  808</span>    s1 = ConstantDenseOutput(ts[0], ts[1], np.array([-1]))</div>
<div class="line"><span class="lineno">  809</span>    s2 = ConstantDenseOutput(ts[1], ts[2], np.array([1]))</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>    sol = OdeSolution(ts, [s1, s2])</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>    assert_equal(sol(-1), [-1])</div>
<div class="line"><span class="lineno">  814</span>    assert_equal(sol(1), [-1])</div>
<div class="line"><span class="lineno">  815</span>    assert_equal(sol(2), [-1])</div>
<div class="line"><span class="lineno">  816</span>    assert_equal(sol(3), [1])</div>
<div class="line"><span class="lineno">  817</span>    assert_equal(sol(5), [1])</div>
<div class="line"><span class="lineno">  818</span>    assert_equal(sol(6), [1])</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>    assert_equal(sol([0, 6, -2, 1.5, 4.5, 2.5, 5, 5.5, 2]),</div>
<div class="line"><span class="lineno">  821</span>                 np.array([[-1, 1, -1, -1, 1, 1, 1, 1, -1]]))</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>    ts = np.array([10, 4, -3])</div>
<div class="line"><span class="lineno">  824</span>    s1 = ConstantDenseOutput(ts[0], ts[1], np.array([-1]))</div>
<div class="line"><span class="lineno">  825</span>    s2 = ConstantDenseOutput(ts[1], ts[2], np.array([1]))</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>    sol = OdeSolution(ts, [s1, s2])</div>
<div class="line"><span class="lineno">  828</span>    assert_equal(sol(11), [-1])</div>
<div class="line"><span class="lineno">  829</span>    assert_equal(sol(10), [-1])</div>
<div class="line"><span class="lineno">  830</span>    assert_equal(sol(5), [-1])</div>
<div class="line"><span class="lineno">  831</span>    assert_equal(sol(4), [-1])</div>
<div class="line"><span class="lineno">  832</span>    assert_equal(sol(0), [1])</div>
<div class="line"><span class="lineno">  833</span>    assert_equal(sol(-3), [1])</div>
<div class="line"><span class="lineno">  834</span>    assert_equal(sol(-4), [1])</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>    assert_equal(sol([12, -5, 10, -3, 6, 1, 4]),</div>
<div class="line"><span class="lineno">  837</span>                 np.array([[-1, 1, -1, 1, -1, 1, -1]]))</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    ts = np.array([1, 1])</div>
<div class="line"><span class="lineno">  840</span>    s = ConstantDenseOutput(1, 1, np.array([10]))</div>
<div class="line"><span class="lineno">  841</span>    sol = OdeSolution(ts, [s])</div>
<div class="line"><span class="lineno">  842</span>    assert_equal(sol(0), [10])</div>
<div class="line"><span class="lineno">  843</span>    assert_equal(sol(1), [10])</div>
<div class="line"><span class="lineno">  844</span>    assert_equal(sol(2), [10])</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>    assert_equal(sol([2, 1, 0]), np.array([[10, 10, 10]]))</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a41daaccaed0d3c8e0f49dc088f446f" name="a6a41daaccaed0d3c8e0f49dc088f446f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a41daaccaed0d3c8e0f49dc088f446f">&#9670;&#160;</a></span>test_t_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_t_eval </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  597</span><span class="keyword">def </span>test_t_eval():</div>
<div class="line"><span class="lineno">  598</span>    rtol = 1e-3</div>
<div class="line"><span class="lineno">  599</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  600</span>    y0 = [1/3, 2/9]</div>
<div class="line"><span class="lineno">  601</span>    <span class="keywordflow">for</span> t_span <span class="keywordflow">in</span> ([5, 9], [5, 1]):</div>
<div class="line"><span class="lineno">  602</span>        t_eval = np.linspace(t_span[0], t_span[1], 10)</div>
<div class="line"><span class="lineno">  603</span>        res = solve_ivp(fun_rational, t_span, y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  604</span>                        t_eval=t_eval)</div>
<div class="line"><span class="lineno">  605</span>        assert_equal(res.t, t_eval)</div>
<div class="line"><span class="lineno">  606</span>        assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  607</span>        assert_(res.success)</div>
<div class="line"><span class="lineno">  608</span>        assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>        y_true = sol_rational(res.t)</div>
<div class="line"><span class="lineno">  611</span>        e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  612</span>        assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>    t_eval = [5, 5.01, 7, 8, 8.01, 9]</div>
<div class="line"><span class="lineno">  615</span>    res = solve_ivp(fun_rational, [5, 9], y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  616</span>                    t_eval=t_eval)</div>
<div class="line"><span class="lineno">  617</span>    assert_equal(res.t, t_eval)</div>
<div class="line"><span class="lineno">  618</span>    assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  619</span>    assert_(res.success)</div>
<div class="line"><span class="lineno">  620</span>    assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    y_true = sol_rational(res.t)</div>
<div class="line"><span class="lineno">  623</span>    e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  624</span>    assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>    t_eval = [5, 4.99, 3, 1.5, 1.1, 1.01, 1]</div>
<div class="line"><span class="lineno">  627</span>    res = solve_ivp(fun_rational, [5, 1], y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  628</span>                    t_eval=t_eval)</div>
<div class="line"><span class="lineno">  629</span>    assert_equal(res.t, t_eval)</div>
<div class="line"><span class="lineno">  630</span>    assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  631</span>    assert_(res.success)</div>
<div class="line"><span class="lineno">  632</span>    assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>    t_eval = [5.01, 7, 8, 8.01]</div>
<div class="line"><span class="lineno">  635</span>    res = solve_ivp(fun_rational, [5, 9], y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  636</span>                    t_eval=t_eval)</div>
<div class="line"><span class="lineno">  637</span>    assert_equal(res.t, t_eval)</div>
<div class="line"><span class="lineno">  638</span>    assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  639</span>    assert_(res.success)</div>
<div class="line"><span class="lineno">  640</span>    assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>    y_true = sol_rational(res.t)</div>
<div class="line"><span class="lineno">  643</span>    e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  644</span>    assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    t_eval = [4.99, 3, 1.5, 1.1, 1.01]</div>
<div class="line"><span class="lineno">  647</span>    res = solve_ivp(fun_rational, [5, 1], y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  648</span>                    t_eval=t_eval)</div>
<div class="line"><span class="lineno">  649</span>    assert_equal(res.t, t_eval)</div>
<div class="line"><span class="lineno">  650</span>    assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  651</span>    assert_(res.success)</div>
<div class="line"><span class="lineno">  652</span>    assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>    t_eval = [4, 6]</div>
<div class="line"><span class="lineno">  655</span>    assert_raises(ValueError, solve_ivp, fun_rational, [5, 9], y0,</div>
<div class="line"><span class="lineno">  656</span>                  rtol=rtol, atol=atol, t_eval=t_eval)</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae545504c253537c14ce74f7affbb9ade" name="ae545504c253537c14ce74f7affbb9ade"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae545504c253537c14ce74f7affbb9ade">&#9670;&#160;</a></span>test_t_eval_dense_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_t_eval_dense_output </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  659</span><span class="keyword">def </span>test_t_eval_dense_output():</div>
<div class="line"><span class="lineno">  660</span>    rtol = 1e-3</div>
<div class="line"><span class="lineno">  661</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  662</span>    y0 = [1/3, 2/9]</div>
<div class="line"><span class="lineno">  663</span>    t_span = [5, 9]</div>
<div class="line"><span class="lineno">  664</span>    t_eval = np.linspace(t_span[0], t_span[1], 10)</div>
<div class="line"><span class="lineno">  665</span>    res = solve_ivp(fun_rational, t_span, y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  666</span>                    t_eval=t_eval)</div>
<div class="line"><span class="lineno">  667</span>    res_d = solve_ivp(fun_rational, t_span, y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  668</span>                      t_eval=t_eval, dense_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  669</span>    assert_equal(res.t, t_eval)</div>
<div class="line"><span class="lineno">  670</span>    assert_(res.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  671</span>    assert_(res.success)</div>
<div class="line"><span class="lineno">  672</span>    assert_equal(res.status, 0)</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>    assert_equal(res.t, res_d.t)</div>
<div class="line"><span class="lineno">  675</span>    assert_equal(res.y, res_d.y)</div>
<div class="line"><span class="lineno">  676</span>    assert_(res_d.t_events <span class="keywordflow">is</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  677</span>    assert_(res_d.success)</div>
<div class="line"><span class="lineno">  678</span>    assert_equal(res_d.status, 0)</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>    <span class="comment"># if t and y are equal only test values for one case</span></div>
<div class="line"><span class="lineno">  681</span>    y_true = sol_rational(res.t)</div>
<div class="line"><span class="lineno">  682</span>    e = compute_error(res.y, y_true, rtol, atol)</div>
<div class="line"><span class="lineno">  683</span>    assert_(np.all(e &lt; 5))</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a374c33d3edceda765894d0f407d5c722" name="a374c33d3edceda765894d0f407d5c722"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a374c33d3edceda765894d0f407d5c722">&#9670;&#160;</a></span>test_t_eval_early_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test_ivp.test_t_eval_early_event </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  686</span><span class="keyword">def </span>test_t_eval_early_event():</div>
<div class="line"><span class="lineno">  687</span>    <span class="keyword">def </span>early_event(t, y):</div>
<div class="line"><span class="lineno">  688</span>        <span class="keywordflow">return</span> t - 7</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>    early_event.terminal = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>    rtol = 1e-3</div>
<div class="line"><span class="lineno">  693</span>    atol = 1e-6</div>
<div class="line"><span class="lineno">  694</span>    y0 = [1/3, 2/9]</div>
<div class="line"><span class="lineno">  695</span>    t_span = [5, 9]</div>
<div class="line"><span class="lineno">  696</span>    t_eval = np.linspace(7.5, 9, 16)</div>
<div class="line"><span class="lineno">  697</span>    <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;RK23&#39;</span>, <span class="stringliteral">&#39;RK45&#39;</span>, <span class="stringliteral">&#39;DOP853&#39;</span>, <span class="stringliteral">&#39;Radau&#39;</span>, <span class="stringliteral">&#39;BDF&#39;</span>, <span class="stringliteral">&#39;LSODA&#39;</span>]:</div>
<div class="line"><span class="lineno">  698</span>        <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno">  699</span>            sup.filter(UserWarning,</div>
<div class="line"><span class="lineno">  700</span>                       <span class="stringliteral">&quot;The following arguments have no effect for a chosen &quot;</span></div>
<div class="line"><span class="lineno">  701</span>                       <span class="stringliteral">&quot;solver: `jac`&quot;</span>)</div>
<div class="line"><span class="lineno">  702</span>            res = solve_ivp(fun_rational, t_span, y0, rtol=rtol, atol=atol,</div>
<div class="line"><span class="lineno">  703</span>                            method=method, t_eval=t_eval, events=early_event,</div>
<div class="line"><span class="lineno">  704</span>                            jac=jac_rational)</div>
<div class="line"><span class="lineno">  705</span>        <span class="keyword">assert</span> res.success</div>
<div class="line"><span class="lineno">  706</span>        <span class="keyword">assert</span> res.message == <span class="stringliteral">&#39;A termination event occurred.&#39;</span></div>
<div class="line"><span class="lineno">  707</span>        <span class="keyword">assert</span> res.status == 1</div>
<div class="line"><span class="lineno">  708</span>        <span class="keyword">assert</span> <span class="keywordflow">not</span> res.t <span class="keywordflow">and</span> <span class="keywordflow">not</span> res.y</div>
<div class="line"><span class="lineno">  709</span>        <span class="keyword">assert</span> len(res.t_events) == 1</div>
<div class="line"><span class="lineno">  710</span>        <span class="keyword">assert</span> res.t_events[0].size == 1</div>
<div class="line"><span class="lineno">  711</span>        <span class="keyword">assert</span> res.t_events[0][0] == 7</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
