<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.integrate._quad_vec Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1integrate.html">integrate</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html">_quad_vec</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.integrate._quad_vec Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__quad__vec_1_1___bunch.html">_Bunch</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__quad__vec_1_1_double_infinite_func.html">DoubleInfiniteFunc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__quad__vec_1_1_l_r_u_dict.html">LRUDict</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__quad__vec_1_1_semi_infinite_func.html">SemiInfiniteFunc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4fe078314fc6a3277d656e4f3a4001af" id="r_a4fe078314fc6a3277d656e4f3a4001af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#a4fe078314fc6a3277d656e4f3a4001af">_max_norm</a> (x)</td></tr>
<tr class="separator:a4fe078314fc6a3277d656e4f3a4001af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f24cef83b35ad007137f2104cd293e2" id="r_a6f24cef83b35ad007137f2104cd293e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#a6f24cef83b35ad007137f2104cd293e2">_get_sizeof</a> (obj)</td></tr>
<tr class="separator:a6f24cef83b35ad007137f2104cd293e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad871f190f59e50ada8d47299b7655bc3" id="r_ad871f190f59e50ada8d47299b7655bc3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#ad871f190f59e50ada8d47299b7655bc3">quad_vec</a> (<a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, epsabs=1e-200, epsrel=1e-8, norm='2', <a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#aab5b86c918e3b2d1492159167406ef7a">cache_size</a>=100e6, limit=10000, workers=1, points=None, <a class="el" href="namespacescipy_1_1integrate_1_1__quadrature.html#a6b91c6e4b838b29de5ef0272cf814dca">quadrature</a>=None, full_output=False, *args=())</td></tr>
<tr class="separator:ad871f190f59e50ada8d47299b7655bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a109bfbe6052a23e967b0edd4207b7dd5" id="r_a109bfbe6052a23e967b0edd4207b7dd5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#a109bfbe6052a23e967b0edd4207b7dd5">_subdivide_interval</a> (args)</td></tr>
<tr class="separator:a109bfbe6052a23e967b0edd4207b7dd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559a48e2c63d7272aeb0584be2626506" id="r_a559a48e2c63d7272aeb0584be2626506"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#a559a48e2c63d7272aeb0584be2626506">_quadrature_trapezoid</a> (x1, x2, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, norm_func)</td></tr>
<tr class="separator:a559a48e2c63d7272aeb0584be2626506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe32874eb87109a4e5200555ce136f76" id="r_abe32874eb87109a4e5200555ce136f76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#abe32874eb87109a4e5200555ce136f76">_quadrature_gk</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, norm_func, x, <a class="el" href="__lapack__subroutines_8h.html#a817b85d82af73ef273fafbec623bb90b">w</a>, v)</td></tr>
<tr class="separator:abe32874eb87109a4e5200555ce136f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1641221e3503be1177aa1ebc81ee1486" id="r_a1641221e3503be1177aa1ebc81ee1486"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#a1641221e3503be1177aa1ebc81ee1486">_quadrature_gk21</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, norm_func)</td></tr>
<tr class="separator:a1641221e3503be1177aa1ebc81ee1486"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e76737425c4436ac38c7abf68b97435" id="r_a8e76737425c4436ac38c7abf68b97435"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#a8e76737425c4436ac38c7abf68b97435">_quadrature_gk15</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, b, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, norm_func)</td></tr>
<tr class="separator:a8e76737425c4436ac38c7abf68b97435"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aab5b86c918e3b2d1492159167406ef7a" id="r_aab5b86c918e3b2d1492159167406ef7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#aab5b86c918e3b2d1492159167406ef7a">cache_size</a></td></tr>
<tr class="separator:aab5b86c918e3b2d1492159167406ef7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add42c719d7fec20e4fbfe20f831a2c75" id="r_add42c719d7fec20e4fbfe20f831a2c75"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__quad__vec.html#add42c719d7fec20e4fbfe20f831a2c75">num_eval</a></td></tr>
<tr class="separator:add42c719d7fec20e4fbfe20f831a2c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6f24cef83b35ad007137f2104cd293e2" name="a6f24cef83b35ad007137f2104cd293e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f24cef83b35ad007137f2104cd293e2">&#9670;&#160;</a></span>_get_sizeof()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec._get_sizeof </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   84</span><span class="keyword">def </span>_get_sizeof(obj):</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   86</span>        <span class="keywordflow">return</span> sys.getsizeof(obj)</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">except</span> TypeError:</div>
<div class="line"><span class="lineno">   88</span>        <span class="comment"># occurs on pypy</span></div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">if</span> hasattr(obj, <span class="stringliteral">&#39;__sizeof__&#39;</span>):</div>
<div class="line"><span class="lineno">   90</span>            <span class="keywordflow">return</span> int(obj.__sizeof__())</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">return</span> 64</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fe078314fc6a3277d656e4f3a4001af" name="a4fe078314fc6a3277d656e4f3a4001af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fe078314fc6a3277d656e4f3a4001af">&#9670;&#160;</a></span>_max_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec._max_norm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   80</span><span class="keyword">def </span>_max_norm(x):</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">return</span> np.amax(abs(x))</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abe32874eb87109a4e5200555ce136f76" name="abe32874eb87109a4e5200555ce136f76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe32874eb87109a4e5200555ce136f76">&#9670;&#160;</a></span>_quadrature_gk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec._quadrature_gk </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Generic Gauss-Kronrod quadrature
</pre> <div class="fragment"><div class="line"><span class="lineno">  483</span><span class="keyword">def </span>_quadrature_gk(a, b, f, norm_func, x, w, v):</div>
<div class="line"><span class="lineno">  484</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">    Generic Gauss-Kronrod quadrature</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    fv = [0.0]*len(x)</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>    c = 0.5 * (a + b)</div>
<div class="line"><span class="lineno">  491</span>    h = 0.5 * (b - a)</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>    <span class="comment"># Gauss-Kronrod</span></div>
<div class="line"><span class="lineno">  494</span>    s_k = 0.0</div>
<div class="line"><span class="lineno">  495</span>    s_k_abs = 0.0</div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(x)):</div>
<div class="line"><span class="lineno">  497</span>        ff = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(c + h*x[i])</div>
<div class="line"><span class="lineno">  498</span>        fv[i] = ff</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>        vv = v[i]</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>        <span class="comment"># \int f(x)</span></div>
<div class="line"><span class="lineno">  503</span>        s_k += vv * ff</div>
<div class="line"><span class="lineno">  504</span>        <span class="comment"># \int |f(x)|</span></div>
<div class="line"><span class="lineno">  505</span>        s_k_abs += vv * abs(ff)</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>    <span class="comment"># Gauss</span></div>
<div class="line"><span class="lineno">  508</span>    s_g = 0.0</div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(w)):</div>
<div class="line"><span class="lineno">  510</span>        s_g += w[i] * fv[2*i + 1]</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    <span class="comment"># Quadrature of abs-deviation from average</span></div>
<div class="line"><span class="lineno">  513</span>    s_k_dabs = 0.0</div>
<div class="line"><span class="lineno">  514</span>    y0 = s_k / 2.0</div>
<div class="line"><span class="lineno">  515</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(x)):</div>
<div class="line"><span class="lineno">  516</span>        <span class="comment"># \int |f(x) - y0|</span></div>
<div class="line"><span class="lineno">  517</span>        s_k_dabs += v[i] * abs(fv[i] - y0)</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    <span class="comment"># Use similar error estimation as quadpack</span></div>
<div class="line"><span class="lineno">  520</span>    err = float(norm_func((s_k - s_g) * h))</div>
<div class="line"><span class="lineno">  521</span>    dabs = float(norm_func(s_k_dabs * h))</div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">if</span> dabs != 0 <span class="keywordflow">and</span> err != 0:</div>
<div class="line"><span class="lineno">  523</span>        err = dabs * min(1.0, (200 * err / dabs)**1.5)</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    eps = sys.float_info.epsilon</div>
<div class="line"><span class="lineno">  526</span>    round_err = float(norm_func(50 * eps * h * s_k_abs))</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>    <span class="keywordflow">if</span> round_err &gt; sys.float_info.min:</div>
<div class="line"><span class="lineno">  529</span>        err = max(err, round_err)</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">return</span> h * s_k, err, round_err</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e76737425c4436ac38c7abf68b97435" name="a8e76737425c4436ac38c7abf68b97435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e76737425c4436ac38c7abf68b97435">&#9670;&#160;</a></span>_quadrature_gk15()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec._quadrature_gk15 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm_func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Gauss-Kronrod 15 quadrature with error estimate
</pre> <div class="fragment"><div class="line"><span class="lineno">  602</span><span class="keyword">def </span>_quadrature_gk15(a, b, f, norm_func):</div>
<div class="line"><span class="lineno">  603</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">    Gauss-Kronrod 15 quadrature with error estimate</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  606</span>    <span class="comment"># Gauss-Kronrod points</span></div>
<div class="line"><span class="lineno">  607</span>    x = (0.991455371120812639206854697526329,</div>
<div class="line"><span class="lineno">  608</span>         0.949107912342758524526189684047851,</div>
<div class="line"><span class="lineno">  609</span>         0.864864423359769072789712788640926,</div>
<div class="line"><span class="lineno">  610</span>         0.741531185599394439863864773280788,</div>
<div class="line"><span class="lineno">  611</span>         0.586087235467691130294144838258730,</div>
<div class="line"><span class="lineno">  612</span>         0.405845151377397166906606412076961,</div>
<div class="line"><span class="lineno">  613</span>         0.207784955007898467600689403773245,</div>
<div class="line"><span class="lineno">  614</span>         0.000000000000000000000000000000000,</div>
<div class="line"><span class="lineno">  615</span>         -0.207784955007898467600689403773245,</div>
<div class="line"><span class="lineno">  616</span>         -0.405845151377397166906606412076961,</div>
<div class="line"><span class="lineno">  617</span>         -0.586087235467691130294144838258730,</div>
<div class="line"><span class="lineno">  618</span>         -0.741531185599394439863864773280788,</div>
<div class="line"><span class="lineno">  619</span>         -0.864864423359769072789712788640926,</div>
<div class="line"><span class="lineno">  620</span>         -0.949107912342758524526189684047851,</div>
<div class="line"><span class="lineno">  621</span>         -0.991455371120812639206854697526329)</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="comment"># 7-point weights</span></div>
<div class="line"><span class="lineno">  624</span>    w = (0.129484966168869693270611432679082,</div>
<div class="line"><span class="lineno">  625</span>         0.279705391489276667901467771423780,</div>
<div class="line"><span class="lineno">  626</span>         0.381830050505118944950369775488975,</div>
<div class="line"><span class="lineno">  627</span>         0.417959183673469387755102040816327,</div>
<div class="line"><span class="lineno">  628</span>         0.381830050505118944950369775488975,</div>
<div class="line"><span class="lineno">  629</span>         0.279705391489276667901467771423780,</div>
<div class="line"><span class="lineno">  630</span>         0.129484966168869693270611432679082)</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>    <span class="comment"># 15-point weights</span></div>
<div class="line"><span class="lineno">  633</span>    v = (0.022935322010529224963732008058970,</div>
<div class="line"><span class="lineno">  634</span>         0.063092092629978553290700663189204,</div>
<div class="line"><span class="lineno">  635</span>         0.104790010322250183839876322541518,</div>
<div class="line"><span class="lineno">  636</span>         0.140653259715525918745189590510238,</div>
<div class="line"><span class="lineno">  637</span>         0.169004726639267902826583426598550,</div>
<div class="line"><span class="lineno">  638</span>         0.190350578064785409913256402421014,</div>
<div class="line"><span class="lineno">  639</span>         0.204432940075298892414161999234649,</div>
<div class="line"><span class="lineno">  640</span>         0.209482141084727828012999174891714,</div>
<div class="line"><span class="lineno">  641</span>         0.204432940075298892414161999234649,</div>
<div class="line"><span class="lineno">  642</span>         0.190350578064785409913256402421014,</div>
<div class="line"><span class="lineno">  643</span>         0.169004726639267902826583426598550,</div>
<div class="line"><span class="lineno">  644</span>         0.140653259715525918745189590510238,</div>
<div class="line"><span class="lineno">  645</span>         0.104790010322250183839876322541518,</div>
<div class="line"><span class="lineno">  646</span>         0.063092092629978553290700663189204,</div>
<div class="line"><span class="lineno">  647</span>         0.022935322010529224963732008058970)</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>    <span class="keywordflow">return</span> _quadrature_gk(a, b, f, norm_func, x, w, v)</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1641221e3503be1177aa1ebc81ee1486" name="a1641221e3503be1177aa1ebc81ee1486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1641221e3503be1177aa1ebc81ee1486">&#9670;&#160;</a></span>_quadrature_gk21()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec._quadrature_gk21 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm_func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Gauss-Kronrod 21 quadrature with error estimate
</pre> <div class="fragment"><div class="line"><span class="lineno">  534</span><span class="keyword">def </span>_quadrature_gk21(a, b, f, norm_func):</div>
<div class="line"><span class="lineno">  535</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">    Gauss-Kronrod 21 quadrature with error estimate</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  538</span>    <span class="comment"># Gauss-Kronrod points</span></div>
<div class="line"><span class="lineno">  539</span>    x = (0.995657163025808080735527280689003,</div>
<div class="line"><span class="lineno">  540</span>         0.973906528517171720077964012084452,</div>
<div class="line"><span class="lineno">  541</span>         0.930157491355708226001207180059508,</div>
<div class="line"><span class="lineno">  542</span>         0.865063366688984510732096688423493,</div>
<div class="line"><span class="lineno">  543</span>         0.780817726586416897063717578345042,</div>
<div class="line"><span class="lineno">  544</span>         0.679409568299024406234327365114874,</div>
<div class="line"><span class="lineno">  545</span>         0.562757134668604683339000099272694,</div>
<div class="line"><span class="lineno">  546</span>         0.433395394129247190799265943165784,</div>
<div class="line"><span class="lineno">  547</span>         0.294392862701460198131126603103866,</div>
<div class="line"><span class="lineno">  548</span>         0.148874338981631210884826001129720,</div>
<div class="line"><span class="lineno">  549</span>         0,</div>
<div class="line"><span class="lineno">  550</span>         -0.148874338981631210884826001129720,</div>
<div class="line"><span class="lineno">  551</span>         -0.294392862701460198131126603103866,</div>
<div class="line"><span class="lineno">  552</span>         -0.433395394129247190799265943165784,</div>
<div class="line"><span class="lineno">  553</span>         -0.562757134668604683339000099272694,</div>
<div class="line"><span class="lineno">  554</span>         -0.679409568299024406234327365114874,</div>
<div class="line"><span class="lineno">  555</span>         -0.780817726586416897063717578345042,</div>
<div class="line"><span class="lineno">  556</span>         -0.865063366688984510732096688423493,</div>
<div class="line"><span class="lineno">  557</span>         -0.930157491355708226001207180059508,</div>
<div class="line"><span class="lineno">  558</span>         -0.973906528517171720077964012084452,</div>
<div class="line"><span class="lineno">  559</span>         -0.995657163025808080735527280689003)</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>    <span class="comment"># 10-point weights</span></div>
<div class="line"><span class="lineno">  562</span>    w = (0.066671344308688137593568809893332,</div>
<div class="line"><span class="lineno">  563</span>         0.149451349150580593145776339657697,</div>
<div class="line"><span class="lineno">  564</span>         0.219086362515982043995534934228163,</div>
<div class="line"><span class="lineno">  565</span>         0.269266719309996355091226921569469,</div>
<div class="line"><span class="lineno">  566</span>         0.295524224714752870173892994651338,</div>
<div class="line"><span class="lineno">  567</span>         0.295524224714752870173892994651338,</div>
<div class="line"><span class="lineno">  568</span>         0.269266719309996355091226921569469,</div>
<div class="line"><span class="lineno">  569</span>         0.219086362515982043995534934228163,</div>
<div class="line"><span class="lineno">  570</span>         0.149451349150580593145776339657697,</div>
<div class="line"><span class="lineno">  571</span>         0.066671344308688137593568809893332)</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>    <span class="comment"># 21-point weights</span></div>
<div class="line"><span class="lineno">  574</span>    v = (0.011694638867371874278064396062192,</div>
<div class="line"><span class="lineno">  575</span>         0.032558162307964727478818972459390,</div>
<div class="line"><span class="lineno">  576</span>         0.054755896574351996031381300244580,</div>
<div class="line"><span class="lineno">  577</span>         0.075039674810919952767043140916190,</div>
<div class="line"><span class="lineno">  578</span>         0.093125454583697605535065465083366,</div>
<div class="line"><span class="lineno">  579</span>         0.109387158802297641899210590325805,</div>
<div class="line"><span class="lineno">  580</span>         0.123491976262065851077958109831074,</div>
<div class="line"><span class="lineno">  581</span>         0.134709217311473325928054001771707,</div>
<div class="line"><span class="lineno">  582</span>         0.142775938577060080797094273138717,</div>
<div class="line"><span class="lineno">  583</span>         0.147739104901338491374841515972068,</div>
<div class="line"><span class="lineno">  584</span>         0.149445554002916905664936468389821,</div>
<div class="line"><span class="lineno">  585</span>         0.147739104901338491374841515972068,</div>
<div class="line"><span class="lineno">  586</span>         0.142775938577060080797094273138717,</div>
<div class="line"><span class="lineno">  587</span>         0.134709217311473325928054001771707,</div>
<div class="line"><span class="lineno">  588</span>         0.123491976262065851077958109831074,</div>
<div class="line"><span class="lineno">  589</span>         0.109387158802297641899210590325805,</div>
<div class="line"><span class="lineno">  590</span>         0.093125454583697605535065465083366,</div>
<div class="line"><span class="lineno">  591</span>         0.075039674810919952767043140916190,</div>
<div class="line"><span class="lineno">  592</span>         0.054755896574351996031381300244580,</div>
<div class="line"><span class="lineno">  593</span>         0.032558162307964727478818972459390,</div>
<div class="line"><span class="lineno">  594</span>         0.011694638867371874278064396062192)</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>    <span class="keywordflow">return</span> _quadrature_gk(a, b, f, norm_func, x, w, v)</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a559a48e2c63d7272aeb0584be2626506" name="a559a48e2c63d7272aeb0584be2626506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a559a48e2c63d7272aeb0584be2626506">&#9670;&#160;</a></span>_quadrature_trapezoid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec._quadrature_trapezoid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm_func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Composite trapezoid quadrature
</pre> <div class="fragment"><div class="line"><span class="lineno">  459</span><span class="keyword">def </span>_quadrature_trapezoid(x1, x2, f, norm_func):</div>
<div class="line"><span class="lineno">  460</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral">    Composite trapezoid quadrature</span></div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  463</span>    x3 = 0.5*(x1 + x2)</div>
<div class="line"><span class="lineno">  464</span>    f1 = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x1)</div>
<div class="line"><span class="lineno">  465</span>    f2 = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x2)</div>
<div class="line"><span class="lineno">  466</span>    f3 = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x3)</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>    s2 = 0.25 * (x2 - x1) * (f1 + 2*f3 + f2)</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    round_err = 0.25 * abs(x2 - x1) * (float(norm_func(f1))</div>
<div class="line"><span class="lineno">  471</span>                                       + 2*float(norm_func(f3))</div>
<div class="line"><span class="lineno">  472</span>                                       + float(norm_func(f2))) * 2e-16</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>    s1 = 0.5 * (x2 - x1) * (f1 + f2)</div>
<div class="line"><span class="lineno">  475</span>    err = 1/3 * float(norm_func(s1 - s2))</div>
<div class="line"><span class="lineno">  476</span>    <span class="keywordflow">return</span> s2, err, round_err</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a109bfbe6052a23e967b0edd4207b7dd5" name="a109bfbe6052a23e967b0edd4207b7dd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a109bfbe6052a23e967b0edd4207b7dd5">&#9670;&#160;</a></span>_subdivide_interval()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec._subdivide_interval </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  430</span><span class="keyword">def </span>_subdivide_interval(args):</div>
<div class="line"><span class="lineno">  431</span>    interval, f, norm_func, _quadrature = args</div>
<div class="line"><span class="lineno">  432</span>    old_err, a, b, old_int = interval</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    c = 0.5 * (a + b)</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    <span class="comment"># Left-hand side</span></div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordflow">if</span> getattr(_quadrature, <span class="stringliteral">&#39;cache_size&#39;</span>, 0) &gt; 0:</div>
<div class="line"><span class="lineno">  438</span>        f = functools.lru_cache(_quadrature.cache_size)(f)</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>    s1, err1, round1 = _quadrature(a, c, f, norm_func)</div>
<div class="line"><span class="lineno">  441</span>    dneval = _quadrature.num_eval</div>
<div class="line"><span class="lineno">  442</span>    s2, err2, round2 = _quadrature(c, b, f, norm_func)</div>
<div class="line"><span class="lineno">  443</span>    dneval += _quadrature.num_eval</div>
<div class="line"><span class="lineno">  444</span>    <span class="keywordflow">if</span> old_int <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  445</span>        old_int, _, _ = _quadrature(a, b, f, norm_func)</div>
<div class="line"><span class="lineno">  446</span>        dneval += _quadrature.num_eval</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">if</span> getattr(_quadrature, <span class="stringliteral">&#39;cache_size&#39;</span>, 0) &gt; 0:</div>
<div class="line"><span class="lineno">  449</span>        dneval = f.cache_info().misses</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    dint = s1 + s2 - old_int</div>
<div class="line"><span class="lineno">  452</span>    derr = err1 + err2 - old_err</div>
<div class="line"><span class="lineno">  453</span>    dround_err = round1 + round2</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    subintervals = ((a, c, s1, err1), (c, b, s2, err2))</div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">return</span> dint, derr, dround_err, subintervals, dneval</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad871f190f59e50ada8d47299b7655bc3" name="ad871f190f59e50ada8d47299b7655bc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad871f190f59e50ada8d47299b7655bc3">&#9670;&#160;</a></span>quad_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec.quad_vec </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsabs</em> = <code>1e-200</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>epsrel</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>'2'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cache_size</em> = <code>100e6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>limit</em> = <code>10000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>workers</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>points</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>quadrature</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Adaptive integration of a vector-valued function.

Parameters
----------
f : callable
Vector-valued function f(x) to integrate.
a : float
Initial point.
b : float
Final point.
epsabs : float, optional
Absolute tolerance.
epsrel : float, optional
Relative tolerance.
norm : {'max', '2'}, optional
Vector norm to use for error estimation.
cache_size : int, optional
Number of bytes to use for memoization.
limit : float or int, optional
An upper bound on the number of subintervals used in the adaptive
algorithm.
workers : int or map-like callable, optional
If `workers` is an integer, part of the computation is done in
parallel subdivided to this many tasks (using
:class:`python:multiprocessing.pool.Pool`).
Supply `-1` to use all cores available to the Process.
Alternatively, supply a map-like callable, such as
:meth:`python:multiprocessing.pool.Pool.map` for evaluating the
population in parallel.
This evaluation is carried out as ``workers(func, iterable)``.
points : list, optional
List of additional breakpoints.
quadrature : {'gk21', 'gk15', 'trapezoid'}, optional
Quadrature rule to use on subintervals.
Options: 'gk21' (Gauss-Kronrod 21-point rule),
'gk15' (Gauss-Kronrod 15-point rule),
'trapezoid' (composite trapezoid rule).
Default: 'gk21' for finite intervals and 'gk15' for (semi-)infinite
full_output : bool, optional
Return an additional ``info`` dictionary.
args : tuple, optional
Extra arguments to pass to function, if any.

.. versionadded:: 1.8.0

Returns
-------
res : {float, array-like}
Estimate for the result
err : float
Error estimate for the result in the given norm
info : dict
Returned only when ``full_output=True``.
Info dictionary. Is an object with the attributes:

success : bool
Whether integration reached target precision.
status : int
Indicator for convergence, success (0),
failure (1), and failure due to rounding error (2).
neval : int
Number of function evaluations.
intervals : ndarray, shape (num_intervals, 2)
Start and end points of subdivision intervals.
integrals : ndarray, shape (num_intervals, ...)
Integral for each interval.
Note that at most ``cache_size`` values are recorded,
and the array may contains *nan* for missing items.
errors : ndarray, shape (num_intervals,)
Estimated integration error for each interval.

Notes
-----
The algorithm mainly follows the implementation of QUADPACK's
DQAG* algorithms, implementing global error control and adaptive
subdivision.

The algorithm here has some differences to the QUADPACK approach:

Instead of subdividing one interval at a time, the algorithm
subdivides N intervals with largest errors at once. This enables
(partial) parallelization of the integration.

The logic of subdividing "next largest" intervals first is then
not implemented, and we rely on the above extension to avoid
concentrating on "small" intervals only.

The Wynn epsilon table extrapolation is not used (QUADPACK uses it
for infinite intervals). This is because the algorithm here is
supposed to work on vector-valued functions, in an user-specified
norm, and the extension of the epsilon algorithm to this case does
not appear to be widely agreed. For max-norm, using elementwise
Wynn epsilon could be possible, but we do not do this here with
the hope that the epsilon extrapolation is mainly useful in
special cases.

References
----------
[1] R. Piessens, E. de Doncker, QUADPACK (1983).

Examples
--------
We can compute integrations of a vector-valued function:

&gt;&gt;&gt; from scipy.integrate import quad_vec
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; alpha = np.linspace(0.0, 2.0, num=30)
&gt;&gt;&gt; f = lambda x: x**alpha
&gt;&gt;&gt; x0, x1 = 0, 2
&gt;&gt;&gt; y, err = quad_vec(f, x0, x1)
&gt;&gt;&gt; plt.plot(alpha, y)
&gt;&gt;&gt; plt.xlabel(r"$\alpha$")
&gt;&gt;&gt; plt.ylabel(r"$\int_{0}^{2} x^\alpha dx$")
&gt;&gt;&gt; plt.show()</pre> <div class="fragment"><div class="line"><span class="lineno">  106</span>             *, args=()):</div>
<div class="line"><span class="lineno">  107</span>    <span class="stringliteral">r&quot;&quot;&quot;Adaptive integration of a vector-valued function.</span></div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">    f : callable</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">        Vector-valued function f(x) to integrate.</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">    a : float</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">        Initial point.</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">    b : float</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">        Final point.</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">    epsabs : float, optional</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">        Absolute tolerance.</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    epsrel : float, optional</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">        Relative tolerance.</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">    norm : {&#39;max&#39;, &#39;2&#39;}, optional</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">        Vector norm to use for error estimation.</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    cache_size : int, optional</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">        Number of bytes to use for memoization.</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    limit : float or int, optional</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">        An upper bound on the number of subintervals used in the adaptive</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">        algorithm.</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    workers : int or map-like callable, optional</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">        If `workers` is an integer, part of the computation is done in</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">        parallel subdivided to this many tasks (using</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">        :class:`python:multiprocessing.pool.Pool`).</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">        Supply `-1` to use all cores available to the Process.</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">        Alternatively, supply a map-like callable, such as</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">        :meth:`python:multiprocessing.pool.Pool.map` for evaluating the</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">        population in parallel.</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">        This evaluation is carried out as ``workers(func, iterable)``.</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    points : list, optional</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        List of additional breakpoints.</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    quadrature : {&#39;gk21&#39;, &#39;gk15&#39;, &#39;trapezoid&#39;}, optional</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">        Quadrature rule to use on subintervals.</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">        Options: &#39;gk21&#39; (Gauss-Kronrod 21-point rule),</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">        &#39;gk15&#39; (Gauss-Kronrod 15-point rule),</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">        &#39;trapezoid&#39; (composite trapezoid rule).</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">        Default: &#39;gk21&#39; for finite intervals and &#39;gk15&#39; for (semi-)infinite</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    full_output : bool, optional</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">        Return an additional ``info`` dictionary.</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    args : tuple, optional</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">        Extra arguments to pass to function, if any.</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">        .. versionadded:: 1.8.0</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    res : {float, array-like}</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">        Estimate for the result</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    err : float</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">        Error estimate for the result in the given norm</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    info : dict</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">        Returned only when ``full_output=True``.</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">        Info dictionary. Is an object with the attributes:</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">            success : bool</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">                Whether integration reached target precision.</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">            status : int</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">                Indicator for convergence, success (0),</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">                failure (1), and failure due to rounding error (2).</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">            neval : int</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">                Number of function evaluations.</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">            intervals : ndarray, shape (num_intervals, 2)</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">                Start and end points of subdivision intervals.</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">            integrals : ndarray, shape (num_intervals, ...)</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">                Integral for each interval.</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">                Note that at most ``cache_size`` values are recorded,</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">                and the array may contains *nan* for missing items.</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">            errors : ndarray, shape (num_intervals,)</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">                Estimated integration error for each interval.</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    The algorithm mainly follows the implementation of QUADPACK&#39;s</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">    DQAG* algorithms, implementing global error control and adaptive</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">    subdivision.</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    The algorithm here has some differences to the QUADPACK approach:</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    Instead of subdividing one interval at a time, the algorithm</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    subdivides N intervals with largest errors at once. This enables</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    (partial) parallelization of the integration.</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    The logic of subdividing &quot;next largest&quot; intervals first is then</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    not implemented, and we rely on the above extension to avoid</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">    concentrating on &quot;small&quot; intervals only.</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    The Wynn epsilon table extrapolation is not used (QUADPACK uses it</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    for infinite intervals). This is because the algorithm here is</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">    supposed to work on vector-valued functions, in an user-specified</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    norm, and the extension of the epsilon algorithm to this case does</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    not appear to be widely agreed. For max-norm, using elementwise</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    Wynn epsilon could be possible, but we do not do this here with</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    the hope that the epsilon extrapolation is mainly useful in</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">    special cases.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    [1] R. Piessens, E. de Doncker, QUADPACK (1983).</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    We can compute integrations of a vector-valued function:</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.integrate import quad_vec</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    &gt;&gt;&gt; alpha = np.linspace(0.0, 2.0, num=30)</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">    &gt;&gt;&gt; f = lambda x: x**alpha</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    &gt;&gt;&gt; x0, x1 = 0, 2</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">    &gt;&gt;&gt; y, err = quad_vec(f, x0, x1)</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">    &gt;&gt;&gt; plt.plot(alpha, y)</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">    &gt;&gt;&gt; plt.xlabel(r&quot;$\alpha$&quot;)</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    &gt;&gt;&gt; plt.ylabel(r&quot;$\int_{0}^{2} x^\alpha dx$&quot;)</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    &gt;&gt;&gt; plt.show()</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  223</span>    a = float(a)</div>
<div class="line"><span class="lineno">  224</span>    b = float(b)</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="keywordflow">if</span> args:</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(args, tuple):</div>
<div class="line"><span class="lineno">  228</span>            args = (args,)</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>        <span class="comment"># create a wrapped function to allow the use of map and Pool.map</span></div>
<div class="line"><span class="lineno">  231</span>        f = _FunctionWrapper(f, args)</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>    <span class="comment"># Use simple transformations to deal with integrals over infinite</span></div>
<div class="line"><span class="lineno">  234</span>    <span class="comment"># intervals.</span></div>
<div class="line"><span class="lineno">  235</span>    kwargs = dict(epsabs=epsabs,</div>
<div class="line"><span class="lineno">  236</span>                  epsrel=epsrel,</div>
<div class="line"><span class="lineno">  237</span>                  norm=norm,</div>
<div class="line"><span class="lineno">  238</span>                  cache_size=cache_size,</div>
<div class="line"><span class="lineno">  239</span>                  limit=limit,</div>
<div class="line"><span class="lineno">  240</span>                  workers=workers,</div>
<div class="line"><span class="lineno">  241</span>                  points=points,</div>
<div class="line"><span class="lineno">  242</span>                  quadrature=<span class="stringliteral">&#39;gk15&#39;</span> <span class="keywordflow">if</span> quadrature <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> quadrature,</div>
<div class="line"><span class="lineno">  243</span>                  full_output=full_output)</div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordflow">if</span> np.isfinite(a) <span class="keywordflow">and</span> np.isinf(b):</div>
<div class="line"><span class="lineno">  245</span>        f2 = SemiInfiniteFunc(f, start=a, infty=b)</div>
<div class="line"><span class="lineno">  246</span>        <span class="keywordflow">if</span> points <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  247</span>            kwargs[<span class="stringliteral">&#39;points&#39;</span>] = tuple(f2.get_t(xp) <span class="keywordflow">for</span> xp <span class="keywordflow">in</span> points)</div>
<div class="line"><span class="lineno">  248</span>        <span class="keywordflow">return</span> quad_vec(f2, 0, 1, **kwargs)</div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">elif</span> np.isfinite(b) <span class="keywordflow">and</span> np.isinf(a):</div>
<div class="line"><span class="lineno">  250</span>        f2 = SemiInfiniteFunc(f, start=b, infty=a)</div>
<div class="line"><span class="lineno">  251</span>        <span class="keywordflow">if</span> points <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  252</span>            kwargs[<span class="stringliteral">&#39;points&#39;</span>] = tuple(f2.get_t(xp) <span class="keywordflow">for</span> xp <span class="keywordflow">in</span> points)</div>
<div class="line"><span class="lineno">  253</span>        res = quad_vec(f2, 0, 1, **kwargs)</div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">return</span> (-res[0],) + res[1:]</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">elif</span> np.isinf(a) <span class="keywordflow">and</span> np.isinf(b):</div>
<div class="line"><span class="lineno">  256</span>        sgn = -1 <span class="keywordflow">if</span> b &lt; a <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>        <span class="comment"># NB. explicitly split integral at t=0, which separates</span></div>
<div class="line"><span class="lineno">  259</span>        <span class="comment"># the positive and negative sides</span></div>
<div class="line"><span class="lineno">  260</span>        f2 = DoubleInfiniteFunc(f)</div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordflow">if</span> points <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  262</span>            kwargs[<span class="stringliteral">&#39;points&#39;</span>] = (0,) + tuple(f2.get_t(xp) <span class="keywordflow">for</span> xp <span class="keywordflow">in</span> points)</div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  264</span>            kwargs[<span class="stringliteral">&#39;points&#39;</span>] = (0,)</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>        <span class="keywordflow">if</span> a != b:</div>
<div class="line"><span class="lineno">  267</span>            res = quad_vec(f2, -1, 1, **kwargs)</div>
<div class="line"><span class="lineno">  268</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  269</span>            res = quad_vec(f2, 1, 1, **kwargs)</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">return</span> (res[0]*sgn,) + res[1:]</div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">elif</span> <span class="keywordflow">not</span> (np.isfinite(a) <span class="keywordflow">and</span> np.isfinite(b)):</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;invalid integration bounds a={}, b={}&quot;</span>.format(a, b))</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>    norm_funcs = {</div>
<div class="line"><span class="lineno">  276</span>        <span class="keywordtype">None</span>: _max_norm,</div>
<div class="line"><span class="lineno">  277</span>        <span class="stringliteral">&#39;max&#39;</span>: _max_norm,</div>
<div class="line"><span class="lineno">  278</span>        <span class="stringliteral">&#39;2&#39;</span>: np.linalg.norm</div>
<div class="line"><span class="lineno">  279</span>    }</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">if</span> callable(norm):</div>
<div class="line"><span class="lineno">  281</span>        norm_func = norm</div>
<div class="line"><span class="lineno">  282</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  283</span>        norm_func = norm_funcs[norm]</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    parallel_count = 128</div>
<div class="line"><span class="lineno">  286</span>    min_intervals = 2</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  289</span>        _quadrature = {<span class="keywordtype">None</span>: _quadrature_gk21,</div>
<div class="line"><span class="lineno">  290</span>                       <span class="stringliteral">&#39;gk21&#39;</span>: _quadrature_gk21,</div>
<div class="line"><span class="lineno">  291</span>                       <span class="stringliteral">&#39;gk15&#39;</span>: _quadrature_gk15,</div>
<div class="line"><span class="lineno">  292</span>                       <span class="stringliteral">&#39;trapz&#39;</span>: _quadrature_trapezoid,  <span class="comment"># alias for backcompat</span></div>
<div class="line"><span class="lineno">  293</span>                       <span class="stringliteral">&#39;trapezoid&#39;</span>: _quadrature_trapezoid}[quadrature]</div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;unknown quadrature {!r}&quot;</span>.format(quadrature)) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="comment"># Initial interval set</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span> points <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  299</span>        initial_intervals = [(a, b)]</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  301</span>        prev = a</div>
<div class="line"><span class="lineno">  302</span>        initial_intervals = []</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">for</span> p <span class="keywordflow">in</span> sorted(points):</div>
<div class="line"><span class="lineno">  304</span>            p = float(p)</div>
<div class="line"><span class="lineno">  305</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> (a &lt; p &lt; b) <span class="keywordflow">or</span> p == prev:</div>
<div class="line"><span class="lineno">  306</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  307</span>            initial_intervals.append((prev, p))</div>
<div class="line"><span class="lineno">  308</span>            prev = p</div>
<div class="line"><span class="lineno">  309</span>        initial_intervals.append((prev, b))</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>    global_integral = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  312</span>    global_error = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  313</span>    rounding_error = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  314</span>    interval_cache = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  315</span>    intervals = []</div>
<div class="line"><span class="lineno">  316</span>    neval = 0</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">for</span> x1, x2 <span class="keywordflow">in</span> initial_intervals:</div>
<div class="line"><span class="lineno">  319</span>        ig, err, rnd = _quadrature(x1, x2, f, norm_func)</div>
<div class="line"><span class="lineno">  320</span>        neval += _quadrature.num_eval</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">if</span> global_integral <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  323</span>            <span class="keywordflow">if</span> isinstance(ig, (float, complex)):</div>
<div class="line"><span class="lineno">  324</span>                <span class="comment"># Specialize for scalars</span></div>
<div class="line"><span class="lineno">  325</span>                <span class="keywordflow">if</span> norm_func <span class="keywordflow">in</span> (_max_norm, np.linalg.norm):</div>
<div class="line"><span class="lineno">  326</span>                    norm_func = abs</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>            global_integral = ig</div>
<div class="line"><span class="lineno">  329</span>            global_error = float(err)</div>
<div class="line"><span class="lineno">  330</span>            rounding_error = float(rnd)</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>            cache_count = cache_size // _get_sizeof(ig)</div>
<div class="line"><span class="lineno">  333</span>            interval_cache = LRUDict(cache_count)</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  335</span>            global_integral += ig</div>
<div class="line"><span class="lineno">  336</span>            global_error += err</div>
<div class="line"><span class="lineno">  337</span>            rounding_error += rnd</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>        interval_cache[(x1, x2)] = copy.copy(ig)</div>
<div class="line"><span class="lineno">  340</span>        intervals.append((-err, x1, x2))</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>    heapq.heapify(intervals)</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>    CONVERGED = 0</div>
<div class="line"><span class="lineno">  345</span>    NOT_CONVERGED = 1</div>
<div class="line"><span class="lineno">  346</span>    ROUNDING_ERROR = 2</div>
<div class="line"><span class="lineno">  347</span>    NOT_A_NUMBER = 3</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>    status_msg = {</div>
<div class="line"><span class="lineno">  350</span>        CONVERGED: <span class="stringliteral">&quot;Target precision reached.&quot;</span>,</div>
<div class="line"><span class="lineno">  351</span>        NOT_CONVERGED: <span class="stringliteral">&quot;Target precision not reached.&quot;</span>,</div>
<div class="line"><span class="lineno">  352</span>        ROUNDING_ERROR: <span class="stringliteral">&quot;Target precision could not be reached due to rounding error.&quot;</span>,</div>
<div class="line"><span class="lineno">  353</span>        NOT_A_NUMBER: <span class="stringliteral">&quot;Non-finite values encountered.&quot;</span></div>
<div class="line"><span class="lineno">  354</span>    }</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <span class="comment"># Process intervals</span></div>
<div class="line"><span class="lineno">  357</span>    <span class="keyword">with</span> MapWrapper(workers) <span class="keyword">as</span> mapwrapper:</div>
<div class="line"><span class="lineno">  358</span>        ier = NOT_CONVERGED</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">while</span> intervals <span class="keywordflow">and</span> len(intervals) &lt; limit:</div>
<div class="line"><span class="lineno">  361</span>            <span class="comment"># Select intervals with largest errors for subdivision</span></div>
<div class="line"><span class="lineno">  362</span>            tol = max(epsabs, epsrel*norm_func(global_integral))</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>            to_process = []</div>
<div class="line"><span class="lineno">  365</span>            err_sum = 0</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(parallel_count):</div>
<div class="line"><span class="lineno">  368</span>                <span class="keywordflow">if</span> <span class="keywordflow">not</span> intervals:</div>
<div class="line"><span class="lineno">  369</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>                <span class="keywordflow">if</span> j &gt; 0 <span class="keywordflow">and</span> err_sum &gt; global_error - tol/8:</div>
<div class="line"><span class="lineno">  372</span>                    <span class="comment"># avoid unnecessary parallel splitting</span></div>
<div class="line"><span class="lineno">  373</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>                interval = heapq.heappop(intervals)</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>                neg_old_err, a, b = interval</div>
<div class="line"><span class="lineno">  378</span>                old_int = interval_cache.pop((a, b), <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  379</span>                to_process.append(((-neg_old_err, a, b, old_int), f, norm_func, _quadrature))</div>
<div class="line"><span class="lineno">  380</span>                err_sum += -neg_old_err</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>            <span class="comment"># Subdivide intervals</span></div>
<div class="line"><span class="lineno">  383</span>            <span class="keywordflow">for</span> dint, derr, dround_err, subint, dneval <span class="keywordflow">in</span> mapwrapper(_subdivide_interval, to_process):</div>
<div class="line"><span class="lineno">  384</span>                neval += dneval</div>
<div class="line"><span class="lineno">  385</span>                global_integral += dint</div>
<div class="line"><span class="lineno">  386</span>                global_error += derr</div>
<div class="line"><span class="lineno">  387</span>                rounding_error += dround_err</div>
<div class="line"><span class="lineno">  388</span>                <span class="keywordflow">for</span> x <span class="keywordflow">in</span> subint:</div>
<div class="line"><span class="lineno">  389</span>                    x1, x2, ig, err = x</div>
<div class="line"><span class="lineno">  390</span>                    interval_cache[(x1, x2)] = ig</div>
<div class="line"><span class="lineno">  391</span>                    heapq.heappush(intervals, (-err, x1, x2))</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>            <span class="comment"># Termination check</span></div>
<div class="line"><span class="lineno">  394</span>            <span class="keywordflow">if</span> len(intervals) &gt;= min_intervals:</div>
<div class="line"><span class="lineno">  395</span>                tol = max(epsabs, epsrel*norm_func(global_integral))</div>
<div class="line"><span class="lineno">  396</span>                <span class="keywordflow">if</span> global_error &lt; tol/8:</div>
<div class="line"><span class="lineno">  397</span>                    ier = CONVERGED</div>
<div class="line"><span class="lineno">  398</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  399</span>                <span class="keywordflow">if</span> global_error &lt; rounding_error:</div>
<div class="line"><span class="lineno">  400</span>                    ier = ROUNDING_ERROR</div>
<div class="line"><span class="lineno">  401</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> (np.isfinite(global_error) <span class="keywordflow">and</span> np.isfinite(rounding_error)):</div>
<div class="line"><span class="lineno">  404</span>                ier = NOT_A_NUMBER</div>
<div class="line"><span class="lineno">  405</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    res = global_integral</div>
<div class="line"><span class="lineno">  408</span>    err = global_error + rounding_error</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno">  411</span>        res_arr = np.asarray(res)</div>
<div class="line"><span class="lineno">  412</span>        dummy = np.full(res_arr.shape, np.nan, dtype=res_arr.dtype)</div>
<div class="line"><span class="lineno">  413</span>        integrals = np.array([interval_cache.get((z[1], z[2]), dummy)</div>
<div class="line"><span class="lineno">  414</span>                                      <span class="keywordflow">for</span> z <span class="keywordflow">in</span> intervals], dtype=res_arr.dtype)</div>
<div class="line"><span class="lineno">  415</span>        errors = np.array([-z[0] <span class="keywordflow">for</span> z <span class="keywordflow">in</span> intervals])</div>
<div class="line"><span class="lineno">  416</span>        intervals = np.array([[z[1], z[2]] <span class="keywordflow">for</span> z <span class="keywordflow">in</span> intervals])</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>        info = _Bunch(neval=neval,</div>
<div class="line"><span class="lineno">  419</span>                      success=(ier == CONVERGED),</div>
<div class="line"><span class="lineno">  420</span>                      status=ier,</div>
<div class="line"><span class="lineno">  421</span>                      message=status_msg[ier],</div>
<div class="line"><span class="lineno">  422</span>                      intervals=intervals,</div>
<div class="line"><span class="lineno">  423</span>                      integrals=integrals,</div>
<div class="line"><span class="lineno">  424</span>                      errors=errors)</div>
<div class="line"><span class="lineno">  425</span>        <span class="keywordflow">return</span> (res, err, info)</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  427</span>        <span class="keywordflow">return</span> (res, err)</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aab5b86c918e3b2d1492159167406ef7a" name="aab5b86c918e3b2d1492159167406ef7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab5b86c918e3b2d1492159167406ef7a">&#9670;&#160;</a></span>cache_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec.cache_size</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="add42c719d7fec20e4fbfe20f831a2c75" name="add42c719d7fec20e4fbfe20f831a2c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add42c719d7fec20e4fbfe20f831a2c75">&#9670;&#160;</a></span>num_eval</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._quad_vec.num_eval</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
