<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.linear_model.tests.test_coordinate_descent Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1linear__model.html">linear_model</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html">test_coordinate_descent</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sklearn.linear_model.tests.test_coordinate_descent Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a168dbf62d412fb47d561eefa066b1da0" id="r_a168dbf62d412fb47d561eefa066b1da0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a168dbf62d412fb47d561eefa066b1da0">test_set_order_dense</a> (<a class="el" href="__lapack__subroutines_8h.html#a9993259f1ab17738593f079acd0507d9">order</a>, input_order)</td></tr>
<tr class="separator:a168dbf62d412fb47d561eefa066b1da0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb959afc86670835b6ea5fb86578b55" id="r_a2cb959afc86670835b6ea5fb86578b55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a2cb959afc86670835b6ea5fb86578b55">test_set_order_sparse</a> (<a class="el" href="__lapack__subroutines_8h.html#a9993259f1ab17738593f079acd0507d9">order</a>, input_order)</td></tr>
<tr class="separator:a2cb959afc86670835b6ea5fb86578b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57507179de32b89081c435bbc7d211e3" id="r_a57507179de32b89081c435bbc7d211e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a57507179de32b89081c435bbc7d211e3">test_lasso_zero</a> ()</td></tr>
<tr class="separator:a57507179de32b89081c435bbc7d211e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d0c542c37aec06d61889e2856e9d71" id="r_a98d0c542c37aec06d61889e2856e9d71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a98d0c542c37aec06d61889e2856e9d71">test_enet_nonfinite_params</a> ()</td></tr>
<tr class="separator:a98d0c542c37aec06d61889e2856e9d71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6b8b7980f7f42481d92be9900e72cd" id="r_a9f6b8b7980f7f42481d92be9900e72cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a9f6b8b7980f7f42481d92be9900e72cd">test_lasso_toy</a> ()</td></tr>
<tr class="separator:a9f6b8b7980f7f42481d92be9900e72cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dda18d3213411a2cce30f6888e6fb92" id="r_a1dda18d3213411a2cce30f6888e6fb92"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a1dda18d3213411a2cce30f6888e6fb92">test_enet_toy</a> ()</td></tr>
<tr class="separator:a1dda18d3213411a2cce30f6888e6fb92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ac7d05f2eea9c8ae8a31d85cdb9bc8" id="r_a94ac7d05f2eea9c8ae8a31d85cdb9bc8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a94ac7d05f2eea9c8ae8a31d85cdb9bc8">test_lasso_dual_gap</a> ()</td></tr>
<tr class="separator:a94ac7d05f2eea9c8ae8a31d85cdb9bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b41741d910042d74ca5983448cb989" id="r_aa1b41741d910042d74ca5983448cb989"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#aa1b41741d910042d74ca5983448cb989">build_dataset</a> (n_samples=50, n_features=200, n_informative_features=10, n_targets=1)</td></tr>
<tr class="separator:aa1b41741d910042d74ca5983448cb989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c88f8cc498559ce849b7b3f285543d" id="r_a06c88f8cc498559ce849b7b3f285543d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a06c88f8cc498559ce849b7b3f285543d">test_lasso_cv</a> ()</td></tr>
<tr class="separator:a06c88f8cc498559ce849b7b3f285543d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa09b54d63e0d32ddd227647563b631a" id="r_aaa09b54d63e0d32ddd227647563b631a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#aaa09b54d63e0d32ddd227647563b631a">test_lasso_cv_with_some_model_selection</a> ()</td></tr>
<tr class="separator:aaa09b54d63e0d32ddd227647563b631a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0079cf4c5296aae50e9117c150880ab" id="r_ab0079cf4c5296aae50e9117c150880ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#ab0079cf4c5296aae50e9117c150880ab">test_lasso_cv_positive_constraint</a> ()</td></tr>
<tr class="separator:ab0079cf4c5296aae50e9117c150880ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefea7089f94e1f5c43e29a5deaaf97eb" id="r_aefea7089f94e1f5c43e29a5deaaf97eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#aefea7089f94e1f5c43e29a5deaaf97eb">test_lassocv_alphas_validation</a> (alphas, err_type, err_msg)</td></tr>
<tr class="separator:aefea7089f94e1f5c43e29a5deaaf97eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bea5ed349739390ec2d18e94f122354" id="r_a6bea5ed349739390ec2d18e94f122354"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a6bea5ed349739390ec2d18e94f122354">_scale_alpha_inplace</a> (estimator, n_samples)</td></tr>
<tr class="separator:a6bea5ed349739390ec2d18e94f122354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ab2b5f76c72b10288a59e0b7dfccd57" id="r_a3ab2b5f76c72b10288a59e0b7dfccd57"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a3ab2b5f76c72b10288a59e0b7dfccd57">test_model_pipeline_same_as_normalize_true</a> (LinearModel, params)</td></tr>
<tr class="separator:a3ab2b5f76c72b10288a59e0b7dfccd57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a03f515a9f2ff6195b462750a6ffe61" id="r_a6a03f515a9f2ff6195b462750a6ffe61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a6a03f515a9f2ff6195b462750a6ffe61">test_model_pipeline_same_dense_and_sparse</a> (LinearModel, params)</td></tr>
<tr class="separator:a6a03f515a9f2ff6195b462750a6ffe61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e5647f9b756cbba013725b7bef0e903" id="r_a8e5647f9b756cbba013725b7bef0e903"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a8e5647f9b756cbba013725b7bef0e903">test_lasso_path_return_models_vs_new_return_gives_same_coefficients</a> ()</td></tr>
<tr class="separator:a8e5647f9b756cbba013725b7bef0e903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82bd6d181ee563ca81d17f51141984d0" id="r_a82bd6d181ee563ca81d17f51141984d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a82bd6d181ee563ca81d17f51141984d0">test_enet_path</a> ()</td></tr>
<tr class="separator:a82bd6d181ee563ca81d17f51141984d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779af8d9dbb2efa8cf7c7e640bc09a44" id="r_a779af8d9dbb2efa8cf7c7e640bc09a44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a779af8d9dbb2efa8cf7c7e640bc09a44">test_path_parameters</a> ()</td></tr>
<tr class="separator:a779af8d9dbb2efa8cf7c7e640bc09a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafa451bbb56bc685d8a1e46642d325b8" id="r_aafa451bbb56bc685d8a1e46642d325b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#aafa451bbb56bc685d8a1e46642d325b8">test_warm_start</a> ()</td></tr>
<tr class="separator:aafa451bbb56bc685d8a1e46642d325b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb45b671515434fa8e126db0c576e7d" id="r_accb45b671515434fa8e126db0c576e7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#accb45b671515434fa8e126db0c576e7d">test_lasso_alpha_warning</a> ()</td></tr>
<tr class="separator:accb45b671515434fa8e126db0c576e7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b817aa3200179f7e41bd0664e7296ff" id="r_a3b817aa3200179f7e41bd0664e7296ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a3b817aa3200179f7e41bd0664e7296ff">test_lasso_positive_constraint</a> ()</td></tr>
<tr class="separator:a3b817aa3200179f7e41bd0664e7296ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f379542b6c85fe4b9b38c40450741d" id="r_ad5f379542b6c85fe4b9b38c40450741d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#ad5f379542b6c85fe4b9b38c40450741d">test_enet_positive_constraint</a> ()</td></tr>
<tr class="separator:ad5f379542b6c85fe4b9b38c40450741d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf271cfb2258ef8cd3880c5659827c83" id="r_abf271cfb2258ef8cd3880c5659827c83"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#abf271cfb2258ef8cd3880c5659827c83">test_enet_cv_positive_constraint</a> ()</td></tr>
<tr class="separator:abf271cfb2258ef8cd3880c5659827c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ebea470bd7eae4175dc98d26f05f49" id="r_a94ebea470bd7eae4175dc98d26f05f49"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a94ebea470bd7eae4175dc98d26f05f49">test_uniform_targets</a> ()</td></tr>
<tr class="separator:a94ebea470bd7eae4175dc98d26f05f49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d8b34006129431e02f729f0d41e584" id="r_a57d8b34006129431e02f729f0d41e584"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a57d8b34006129431e02f729f0d41e584">test_multi_task_lasso_and_enet</a> ()</td></tr>
<tr class="separator:a57d8b34006129431e02f729f0d41e584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0ceb478714224455b9a2167dcd1744" id="r_a8c0ceb478714224455b9a2167dcd1744"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a8c0ceb478714224455b9a2167dcd1744">test_lasso_readonly_data</a> ()</td></tr>
<tr class="separator:a8c0ceb478714224455b9a2167dcd1744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e697b0d2a32abe7f5e61f1ad0c9c417" id="r_a1e697b0d2a32abe7f5e61f1ad0c9c417"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a1e697b0d2a32abe7f5e61f1ad0c9c417">test_multi_task_lasso_readonly_data</a> ()</td></tr>
<tr class="separator:a1e697b0d2a32abe7f5e61f1ad0c9c417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a798636c50e689e5bf00454e3d697aa4a" id="r_a798636c50e689e5bf00454e3d697aa4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a798636c50e689e5bf00454e3d697aa4a">test_enet_multitarget</a> ()</td></tr>
<tr class="separator:a798636c50e689e5bf00454e3d697aa4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe928ab2fd85bc0c94ba0d88b4a20c70" id="r_abe928ab2fd85bc0c94ba0d88b4a20c70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#abe928ab2fd85bc0c94ba0d88b4a20c70">test_multioutput_enetcv_error</a> ()</td></tr>
<tr class="separator:abe928ab2fd85bc0c94ba0d88b4a20c70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af170126f80c8be427fdb62bf95cfb9f7" id="r_af170126f80c8be427fdb62bf95cfb9f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#af170126f80c8be427fdb62bf95cfb9f7">test_multitask_enet_and_lasso_cv</a> ()</td></tr>
<tr class="separator:af170126f80c8be427fdb62bf95cfb9f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29447978e37ce9e669cf8ff6444e8045" id="r_a29447978e37ce9e669cf8ff6444e8045"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a29447978e37ce9e669cf8ff6444e8045">test_1d_multioutput_enet_and_multitask_enet_cv</a> ()</td></tr>
<tr class="separator:a29447978e37ce9e669cf8ff6444e8045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59f7306e8e81b03a9411ad84127ff953" id="r_a59f7306e8e81b03a9411ad84127ff953"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a59f7306e8e81b03a9411ad84127ff953">test_1d_multioutput_lasso_and_multitask_lasso_cv</a> ()</td></tr>
<tr class="separator:a59f7306e8e81b03a9411ad84127ff953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25280f9072770510a1e32e164c2aadb4" id="r_a25280f9072770510a1e32e164c2aadb4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a25280f9072770510a1e32e164c2aadb4">test_sparse_input_dtype_enet_and_lassocv</a> ()</td></tr>
<tr class="separator:a25280f9072770510a1e32e164c2aadb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f745b0f4b07c30c7fdf70e9d12f15b7" id="r_a4f745b0f4b07c30c7fdf70e9d12f15b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a4f745b0f4b07c30c7fdf70e9d12f15b7">test_elasticnet_precompute_incorrect_gram</a> ()</td></tr>
<tr class="separator:a4f745b0f4b07c30c7fdf70e9d12f15b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3be40e29e116078d4e625be40a87b4cc" id="r_a3be40e29e116078d4e625be40a87b4cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a3be40e29e116078d4e625be40a87b4cc">test_elasticnet_precompute_gram_weighted_samples</a> ()</td></tr>
<tr class="separator:a3be40e29e116078d4e625be40a87b4cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45cf9ff96a1060d78f2da3e5b3001bc" id="r_ae45cf9ff96a1060d78f2da3e5b3001bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#ae45cf9ff96a1060d78f2da3e5b3001bc">test_elasticnet_precompute_gram</a> ()</td></tr>
<tr class="separator:ae45cf9ff96a1060d78f2da3e5b3001bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad71ebfc2eab6d14f253a0cc9aa7e44ee" id="r_ad71ebfc2eab6d14f253a0cc9aa7e44ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#ad71ebfc2eab6d14f253a0cc9aa7e44ee">test_warm_start_convergence</a> ()</td></tr>
<tr class="separator:ad71ebfc2eab6d14f253a0cc9aa7e44ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86950ab2cebacd9ae4df59cde0d293b6" id="r_a86950ab2cebacd9ae4df59cde0d293b6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a86950ab2cebacd9ae4df59cde0d293b6">test_warm_start_convergence_with_regularizer_decrement</a> ()</td></tr>
<tr class="separator:a86950ab2cebacd9ae4df59cde0d293b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb8846fc1ec102cf77de54b2be09613" id="r_a4fb8846fc1ec102cf77de54b2be09613"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a4fb8846fc1ec102cf77de54b2be09613">test_random_descent</a> ()</td></tr>
<tr class="separator:a4fb8846fc1ec102cf77de54b2be09613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58d899bdc2dc6d3458b1d274e6b26e22" id="r_a58d899bdc2dc6d3458b1d274e6b26e22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a58d899bdc2dc6d3458b1d274e6b26e22">test_enet_path_positive</a> ()</td></tr>
<tr class="separator:a58d899bdc2dc6d3458b1d274e6b26e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6f930f9c577832a3bda20b2c79267c9" id="r_ac6f930f9c577832a3bda20b2c79267c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#ac6f930f9c577832a3bda20b2c79267c9">test_sparse_dense_descent_paths</a> ()</td></tr>
<tr class="separator:ac6f930f9c577832a3bda20b2c79267c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33d0110317995f4db21dd55b9448a943" id="r_a33d0110317995f4db21dd55b9448a943"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a33d0110317995f4db21dd55b9448a943">test_path_unknown_parameter</a> (path_func)</td></tr>
<tr class="separator:a33d0110317995f4db21dd55b9448a943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c00068663a02b9eb73022851874f69" id="r_a11c00068663a02b9eb73022851874f69"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a11c00068663a02b9eb73022851874f69">test_check_input_false</a> ()</td></tr>
<tr class="separator:a11c00068663a02b9eb73022851874f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90ba90c89399f5b636606050c06efefd" id="r_a90ba90c89399f5b636606050c06efefd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a90ba90c89399f5b636606050c06efefd">test_enet_copy_X_True</a> (check_input)</td></tr>
<tr class="separator:a90ba90c89399f5b636606050c06efefd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02439d5d5d7f8b8faa1e1728c0692a93" id="r_a02439d5d5d7f8b8faa1e1728c0692a93"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a02439d5d5d7f8b8faa1e1728c0692a93">test_enet_copy_X_False_check_input_False</a> ()</td></tr>
<tr class="separator:a02439d5d5d7f8b8faa1e1728c0692a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691d5a4dd8d1b518bfa3a023ef990513" id="r_a691d5a4dd8d1b518bfa3a023ef990513"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a691d5a4dd8d1b518bfa3a023ef990513">test_overrided_gram_matrix</a> ()</td></tr>
<tr class="separator:a691d5a4dd8d1b518bfa3a023ef990513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab0545b9bf6ee912c2dc90d39249782e" id="r_aab0545b9bf6ee912c2dc90d39249782e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#aab0545b9bf6ee912c2dc90d39249782e">test_lasso_non_float_y</a> (model)</td></tr>
<tr class="separator:aab0545b9bf6ee912c2dc90d39249782e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3bffb3b5fc51910796d03920f9777e" id="r_a9c3bffb3b5fc51910796d03920f9777e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a9c3bffb3b5fc51910796d03920f9777e">test_enet_float_precision</a> ()</td></tr>
<tr class="separator:a9c3bffb3b5fc51910796d03920f9777e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c31c346e8ae2ad595c312c129fb108e" id="r_a7c31c346e8ae2ad595c312c129fb108e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a7c31c346e8ae2ad595c312c129fb108e">test_enet_l1_ratio</a> ()</td></tr>
<tr class="separator:a7c31c346e8ae2ad595c312c129fb108e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79752e4931a15497862373774d1f4a1b" id="r_a79752e4931a15497862373774d1f4a1b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a79752e4931a15497862373774d1f4a1b">test_coef_shape_not_zero</a> ()</td></tr>
<tr class="separator:a79752e4931a15497862373774d1f4a1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4261daba38586d5d6f5044bcd389a858" id="r_a4261daba38586d5d6f5044bcd389a858"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a4261daba38586d5d6f5044bcd389a858">test_warm_start_multitask_lasso</a> ()</td></tr>
<tr class="separator:a4261daba38586d5d6f5044bcd389a858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33cf8dec6302ba2fe54e26e3169f1f46" id="r_a33cf8dec6302ba2fe54e26e3169f1f46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a33cf8dec6302ba2fe54e26e3169f1f46">test_enet_coordinate_descent</a> (klass, n_classes, kwargs)</td></tr>
<tr class="separator:a33cf8dec6302ba2fe54e26e3169f1f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a6781303cfba7f234e5723041e50a61" id="r_a7a6781303cfba7f234e5723041e50a61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a7a6781303cfba7f234e5723041e50a61">test_convergence_warnings</a> ()</td></tr>
<tr class="separator:a7a6781303cfba7f234e5723041e50a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a727ce71b0c2ae504837d19ad60214b33" id="r_a727ce71b0c2ae504837d19ad60214b33"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a727ce71b0c2ae504837d19ad60214b33">test_sparse_input_convergence_warning</a> ()</td></tr>
<tr class="separator:a727ce71b0c2ae504837d19ad60214b33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3d43dd459f04af2343c70959cc79ca" id="r_a8a3d43dd459f04af2343c70959cc79ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a8a3d43dd459f04af2343c70959cc79ca">test_lassoCV_does_not_set_precompute</a> (monkeypatch, <a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a7c1159063a7f09b94a11b392b8b082c6">precompute</a>, inner_precompute)</td></tr>
<tr class="separator:a8a3d43dd459f04af2343c70959cc79ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d8d914b4337c8e9065c17947c7ac6bc" id="r_a8d8d914b4337c8e9065c17947c7ac6bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a8d8d914b4337c8e9065c17947c7ac6bc">test_multi_task_lasso_cv_dtype</a> ()</td></tr>
<tr class="separator:a8d8d914b4337c8e9065c17947c7ac6bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a474e463527101866a0158670893aca4d" id="r_a474e463527101866a0158670893aca4d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a474e463527101866a0158670893aca4d">test_enet_sample_weight_consistency</a> (fit_intercept, <a class="el" href="__blas__subroutines_8h.html#a29dda7d0819a860e921db821deb590c9">alpha</a>, <a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a7c1159063a7f09b94a11b392b8b082c6">precompute</a>, sparseX)</td></tr>
<tr class="separator:a474e463527101866a0158670893aca4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac739a978d534c68e89e755cfb0008efd" id="r_ac739a978d534c68e89e755cfb0008efd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#ac739a978d534c68e89e755cfb0008efd">test_enet_cv_sample_weight_correctness</a> (fit_intercept, sparseX)</td></tr>
<tr class="separator:ac739a978d534c68e89e755cfb0008efd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2efbb8181f43a686326a1eedb478b6b" id="r_ae2efbb8181f43a686326a1eedb478b6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#ae2efbb8181f43a686326a1eedb478b6b">test_enet_cv_grid_search</a> (sample_weight)</td></tr>
<tr class="separator:ae2efbb8181f43a686326a1eedb478b6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add7d54ef317b419b3a95060cfb871d8b" id="r_add7d54ef317b419b3a95060cfb871d8b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#add7d54ef317b419b3a95060cfb871d8b">test_enet_cv_sample_weight_consistency</a> (fit_intercept, l1_ratio, <a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a7c1159063a7f09b94a11b392b8b082c6">precompute</a>, sparseX)</td></tr>
<tr class="separator:add7d54ef317b419b3a95060cfb871d8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04a557152a0c56acc3553c492cc0989d" id="r_a04a557152a0c56acc3553c492cc0989d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a04a557152a0c56acc3553c492cc0989d">test_linear_models_cv_fit_with_loky</a> (estimator)</td></tr>
<tr class="separator:a04a557152a0c56acc3553c492cc0989d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6174e97b0a1e2631320c0922823ee29a" id="r_a6174e97b0a1e2631320c0922823ee29a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a6174e97b0a1e2631320c0922823ee29a">test_enet_sample_weight_does_not_overwrite_sample_weight</a> (check_input)</td></tr>
<tr class="separator:a6174e97b0a1e2631320c0922823ee29a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfead455166cddd92c9e0f4edccc27ef" id="r_adfead455166cddd92c9e0f4edccc27ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#adfead455166cddd92c9e0f4edccc27ef">test_enet_ridge_consistency</a> (ridge_alpha)</td></tr>
<tr class="separator:adfead455166cddd92c9e0f4edccc27ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42c0e155def8378305f2e68f7f8254a2" id="r_a42c0e155def8378305f2e68f7f8254a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a42c0e155def8378305f2e68f7f8254a2">test_sample_weight_invariance</a> (estimator)</td></tr>
<tr class="separator:a42c0e155def8378305f2e68f7f8254a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af76b2ad9151d036330a10df09945d256" id="r_af76b2ad9151d036330a10df09945d256"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#af76b2ad9151d036330a10df09945d256">test_read_only_buffer</a> ()</td></tr>
<tr class="separator:af76b2ad9151d036330a10df09945d256"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7c1159063a7f09b94a11b392b8b082c6" id="r_a7c1159063a7f09b94a11b392b8b082c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1linear__model_1_1tests_1_1test__coordinate__descent.html#a7c1159063a7f09b94a11b392b8b082c6">precompute</a></td></tr>
<tr class="separator:a7c1159063a7f09b94a11b392b8b082c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6bea5ed349739390ec2d18e94f122354" name="a6bea5ed349739390ec2d18e94f122354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bea5ed349739390ec2d18e94f122354">&#9670;&#160;</a></span>_scale_alpha_inplace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent._scale_alpha_inplace </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>estimator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_samples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Rescale the parameter alpha from when the estimator is evoked with
normalize set to True as if it were evoked in a Pipeline with normalize set
to False and with a StandardScaler.
</pre> <div class="fragment"><div class="line"><span class="lineno">  333</span><span class="keyword">def </span>_scale_alpha_inplace(estimator, n_samples):</div>
<div class="line"><span class="lineno">  334</span>    <span class="stringliteral">&quot;&quot;&quot;Rescale the parameter alpha from when the estimator is evoked with</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    normalize set to True as if it were evoked in a Pipeline with normalize set</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    to False and with a StandardScaler.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordflow">if</span> (<span class="stringliteral">&quot;alpha&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> estimator.get_params()) <span class="keywordflow">and</span> (</div>
<div class="line"><span class="lineno">  339</span>        <span class="stringliteral">&quot;alphas&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> estimator.get_params()</div>
<div class="line"><span class="lineno">  340</span>    ):</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">if</span> isinstance(estimator, (RidgeCV, RidgeClassifierCV)):</div>
<div class="line"><span class="lineno">  344</span>        <span class="comment"># alphas is not validated at this point and can be a list.</span></div>
<div class="line"><span class="lineno">  345</span>        <span class="comment"># We convert it to a np.ndarray to make sure broadcasting</span></div>
<div class="line"><span class="lineno">  346</span>        <span class="comment"># is used.</span></div>
<div class="line"><span class="lineno">  347</span>        alphas = np.asarray(estimator.alphas) * n_samples</div>
<div class="line"><span class="lineno">  348</span>        <span class="keywordflow">return</span> estimator.set_params(alphas=alphas)</div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">if</span> isinstance(estimator, (Lasso, LassoLars, MultiTaskLasso)):</div>
<div class="line"><span class="lineno">  350</span>        alpha = estimator.alpha * np.sqrt(n_samples)</div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">if</span> isinstance(estimator, (Ridge, RidgeClassifier)):</div>
<div class="line"><span class="lineno">  352</span>        alpha = estimator.alpha * n_samples</div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordflow">if</span> isinstance(estimator, (ElasticNet, MultiTaskElasticNet)):</div>
<div class="line"><span class="lineno">  354</span>        <span class="keywordflow">if</span> estimator.l1_ratio == 1:</div>
<div class="line"><span class="lineno">  355</span>            alpha = estimator.alpha * np.sqrt(n_samples)</div>
<div class="line"><span class="lineno">  356</span>        <span class="keywordflow">elif</span> estimator.l1_ratio == 0:</div>
<div class="line"><span class="lineno">  357</span>            alpha = estimator.alpha * n_samples</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  359</span>            <span class="comment"># To avoid silent errors in case of refactoring</span></div>
<div class="line"><span class="lineno">  360</span>            <span class="keywordflow">raise</span> NotImplementedError</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>    estimator.set_params(alpha=alpha)</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span><span class="comment"># TODO(1.4): remove &#39;normalize&#39;</span></div>
<div class="line"><span class="lineno">  366</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore:&#39;normalize&#39; was deprecated&quot;)</span></div>
<div class="line"><span class="lineno">  367</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  368</span>    <span class="stringliteral">&quot;LinearModel, params&quot;</span>,</div>
<div class="line"><span class="lineno">  369</span>    [</div>
<div class="line"><span class="lineno">  370</span>        (LassoLars, {<span class="stringliteral">&quot;alpha&quot;</span>: 0.1}),</div>
<div class="line"><span class="lineno">  371</span>        (OrthogonalMatchingPursuit, {}),</div>
<div class="line"><span class="lineno">  372</span>        (Lars, {}),</div>
<div class="line"><span class="lineno">  373</span>        (LassoLarsIC, {}),</div>
<div class="line"><span class="lineno">  374</span>    ],</div>
<div class="line"><span class="lineno">  375</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1b41741d910042d74ca5983448cb989" name="aa1b41741d910042d74ca5983448cb989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1b41741d910042d74ca5983448cb989">&#9670;&#160;</a></span>build_dataset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.build_dataset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_samples</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_features</em> = <code>200</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_informative_features</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_targets</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">build an ill-posed linear regression problem with many noisy features and
comparatively few samples
</pre> <div class="fragment"><div class="line"><span class="lineno">  226</span><span class="keyword">def </span>build_dataset(n_samples=50, n_features=200, n_informative_features=10, n_targets=1):</div>
<div class="line"><span class="lineno">  227</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">    build an ill-posed linear regression problem with many noisy features and</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">    comparatively few samples</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  231</span>    random_state = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> n_targets &gt; 1:</div>
<div class="line"><span class="lineno">  233</span>        w = random_state.randn(n_features, n_targets)</div>
<div class="line"><span class="lineno">  234</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  235</span>        w = random_state.randn(n_features)</div>
<div class="line"><span class="lineno">  236</span>    w[n_informative_features:] = 0.0</div>
<div class="line"><span class="lineno">  237</span>    X = random_state.randn(n_samples, n_features)</div>
<div class="line"><span class="lineno">  238</span>    y = np.dot(X, w)</div>
<div class="line"><span class="lineno">  239</span>    X_test = random_state.randn(n_samples, n_features)</div>
<div class="line"><span class="lineno">  240</span>    y_test = np.dot(X_test, w)</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">return</span> X, y, X_test, y_test</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a29447978e37ce9e669cf8ff6444e8045" name="a29447978e37ce9e669cf8ff6444e8045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29447978e37ce9e669cf8ff6444e8045">&#9670;&#160;</a></span>test_1d_multioutput_enet_and_multitask_enet_cv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_1d_multioutput_enet_and_multitask_enet_cv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  768</span><span class="keyword">def </span>test_1d_multioutput_enet_and_multitask_enet_cv():</div>
<div class="line"><span class="lineno">  769</span>    X, y, _, _ = build_dataset(n_features=10)</div>
<div class="line"><span class="lineno">  770</span>    y = y[:, np.newaxis]</div>
<div class="line"><span class="lineno">  771</span>    clf = ElasticNetCV(n_alphas=5, eps=2e-3, l1_ratio=[0.5, 0.7])</div>
<div class="line"><span class="lineno">  772</span>    clf.fit(X, y[:, 0])</div>
<div class="line"><span class="lineno">  773</span>    clf1 = MultiTaskElasticNetCV(n_alphas=5, eps=2e-3, l1_ratio=[0.5, 0.7])</div>
<div class="line"><span class="lineno">  774</span>    clf1.fit(X, y)</div>
<div class="line"><span class="lineno">  775</span>    assert_almost_equal(clf.l1_ratio_, clf1.l1_ratio_)</div>
<div class="line"><span class="lineno">  776</span>    assert_almost_equal(clf.alpha_, clf1.alpha_)</div>
<div class="line"><span class="lineno">  777</span>    assert_almost_equal(clf.coef_, clf1.coef_[0])</div>
<div class="line"><span class="lineno">  778</span>    assert_almost_equal(clf.intercept_, clf1.intercept_[0])</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a59f7306e8e81b03a9411ad84127ff953" name="a59f7306e8e81b03a9411ad84127ff953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59f7306e8e81b03a9411ad84127ff953">&#9670;&#160;</a></span>test_1d_multioutput_lasso_and_multitask_lasso_cv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_1d_multioutput_lasso_and_multitask_lasso_cv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  781</span><span class="keyword">def </span>test_1d_multioutput_lasso_and_multitask_lasso_cv():</div>
<div class="line"><span class="lineno">  782</span>    X, y, _, _ = build_dataset(n_features=10)</div>
<div class="line"><span class="lineno">  783</span>    y = y[:, np.newaxis]</div>
<div class="line"><span class="lineno">  784</span>    clf = LassoCV(n_alphas=5, eps=2e-3)</div>
<div class="line"><span class="lineno">  785</span>    clf.fit(X, y[:, 0])</div>
<div class="line"><span class="lineno">  786</span>    clf1 = MultiTaskLassoCV(n_alphas=5, eps=2e-3)</div>
<div class="line"><span class="lineno">  787</span>    clf1.fit(X, y)</div>
<div class="line"><span class="lineno">  788</span>    assert_almost_equal(clf.alpha_, clf1.alpha_)</div>
<div class="line"><span class="lineno">  789</span>    assert_almost_equal(clf.coef_, clf1.coef_[0])</div>
<div class="line"><span class="lineno">  790</span>    assert_almost_equal(clf.intercept_, clf1.intercept_[0])</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a11c00068663a02b9eb73022851874f69" name="a11c00068663a02b9eb73022851874f69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c00068663a02b9eb73022851874f69">&#9670;&#160;</a></span>test_check_input_false()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_check_input_false </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  995</span><span class="keyword">def </span>test_check_input_false():</div>
<div class="line"><span class="lineno">  996</span>    X, y, _, _ = build_dataset(n_samples=20, n_features=10)</div>
<div class="line"><span class="lineno">  997</span>    X = check_array(X, order=<span class="stringliteral">&quot;F&quot;</span>, dtype=<span class="stringliteral">&quot;float64&quot;</span>)</div>
<div class="line"><span class="lineno">  998</span>    y = check_array(X, order=<span class="stringliteral">&quot;F&quot;</span>, dtype=<span class="stringliteral">&quot;float64&quot;</span>)</div>
<div class="line"><span class="lineno">  999</span>    clf = ElasticNet(selection=<span class="stringliteral">&quot;cyclic&quot;</span>, tol=1e-8)</div>
<div class="line"><span class="lineno"> 1000</span>    <span class="comment"># Check that no error is raised if data is provided in the right format</span></div>
<div class="line"><span class="lineno"> 1001</span>    clf.fit(X, y, check_input=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1002</span>    <span class="comment"># With check_input=False, an exhaustive check is not made on y but its</span></div>
<div class="line"><span class="lineno"> 1003</span>    <span class="comment"># dtype is still cast in _preprocess_data to X&#39;s dtype. So the test should</span></div>
<div class="line"><span class="lineno"> 1004</span>    <span class="comment"># pass anyway</span></div>
<div class="line"><span class="lineno"> 1005</span>    X = check_array(X, order=<span class="stringliteral">&quot;F&quot;</span>, dtype=<span class="stringliteral">&quot;float32&quot;</span>)</div>
<div class="line"><span class="lineno"> 1006</span>    clf.fit(X, y, check_input=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1007</span>    <span class="comment"># With no input checking, providing X in C order should result in false</span></div>
<div class="line"><span class="lineno"> 1008</span>    <span class="comment"># computation</span></div>
<div class="line"><span class="lineno"> 1009</span>    X = check_array(X, order=<span class="stringliteral">&quot;C&quot;</span>, dtype=<span class="stringliteral">&quot;float64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 1011</span>        clf.fit(X, y, check_input=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1012</span> </div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span><span class="preprocessor">@pytest.mark.parametrize(&quot;check_input&quot;, [True, False])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a79752e4931a15497862373774d1f4a1b" name="a79752e4931a15497862373774d1f4a1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79752e4931a15497862373774d1f4a1b">&#9670;&#160;</a></span>test_coef_shape_not_zero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_coef_shape_not_zero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1168</span><span class="keyword">def </span>test_coef_shape_not_zero():</div>
<div class="line"><span class="lineno"> 1169</span>    est_no_intercept = Lasso(fit_intercept=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1170</span>    est_no_intercept.fit(np.c_[np.ones(3)], np.ones(3))</div>
<div class="line"><span class="lineno"> 1171</span>    <span class="keyword">assert</span> est_no_intercept.coef_.shape == (1,)</div>
<div class="line"><span class="lineno"> 1172</span> </div>
<div class="line"><span class="lineno"> 1173</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a6781303cfba7f234e5723041e50a61" name="a7a6781303cfba7f234e5723041e50a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a6781303cfba7f234e5723041e50a61">&#9670;&#160;</a></span>test_convergence_warnings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_convergence_warnings </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1212</span><span class="keyword">def </span>test_convergence_warnings():</div>
<div class="line"><span class="lineno"> 1213</span>    random_state = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1214</span>    X = random_state.standard_normal((1000, 500))</div>
<div class="line"><span class="lineno"> 1215</span>    y = random_state.standard_normal((1000, 3))</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>    <span class="comment"># check that the model converges w/o convergence warnings</span></div>
<div class="line"><span class="lineno"> 1218</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno"> 1219</span>        warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, ConvergenceWarning)</div>
<div class="line"><span class="lineno"> 1220</span>        MultiTaskElasticNet().fit(X, y)</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae45cf9ff96a1060d78f2da3e5b3001bc" name="ae45cf9ff96a1060d78f2da3e5b3001bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae45cf9ff96a1060d78f2da3e5b3001bc">&#9670;&#160;</a></span>test_elasticnet_precompute_gram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_elasticnet_precompute_gram </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  849</span><span class="keyword">def </span>test_elasticnet_precompute_gram():</div>
<div class="line"><span class="lineno">  850</span>    <span class="comment"># Check the dtype-aware check for a precomputed Gram matrix</span></div>
<div class="line"><span class="lineno">  851</span>    <span class="comment"># (see https://github.com/scikit-learn/scikit-learn/pull/22059</span></div>
<div class="line"><span class="lineno">  852</span>    <span class="comment"># and https://github.com/scikit-learn/scikit-learn/issues/21997).</span></div>
<div class="line"><span class="lineno">  853</span>    <span class="comment"># Here: (X_c.T, X_c)[2, 3] is not equal to np.dot(X_c[:, 2], X_c[:, 3])</span></div>
<div class="line"><span class="lineno">  854</span>    <span class="comment"># but within tolerance for np.float32</span></div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>    rng = np.random.RandomState(58)</div>
<div class="line"><span class="lineno">  857</span>    X = rng.binomial(1, 0.25, (1000, 4)).astype(np.float32)</div>
<div class="line"><span class="lineno">  858</span>    y = rng.rand(1000).astype(np.float32)</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>    X_c = X - np.average(X, axis=0)</div>
<div class="line"><span class="lineno">  861</span>    gram = np.dot(X_c.T, X_c)</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>    clf1 = ElasticNet(alpha=0.01, precompute=gram)</div>
<div class="line"><span class="lineno">  864</span>    clf1.fit(X_c, y)</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>    clf2 = ElasticNet(alpha=0.01, precompute=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  867</span>    clf2.fit(X, y)</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>    assert_allclose(clf1.coef_, clf2.coef_)</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3be40e29e116078d4e625be40a87b4cc" name="a3be40e29e116078d4e625be40a87b4cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3be40e29e116078d4e625be40a87b4cc">&#9670;&#160;</a></span>test_elasticnet_precompute_gram_weighted_samples()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_elasticnet_precompute_gram_weighted_samples </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  827</span><span class="keyword">def </span>test_elasticnet_precompute_gram_weighted_samples():</div>
<div class="line"><span class="lineno">  828</span>    <span class="comment"># check the equivalence between passing a precomputed Gram matrix and</span></div>
<div class="line"><span class="lineno">  829</span>    <span class="comment"># internal computation using sample weights.</span></div>
<div class="line"><span class="lineno">  830</span>    X, y, _, _ = build_dataset()</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  833</span>    sample_weight = rng.lognormal(size=y.shape)</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>    w_norm = sample_weight * (y.shape / np.sum(sample_weight))</div>
<div class="line"><span class="lineno">  836</span>    X_c = X - np.average(X, axis=0, weights=w_norm)</div>
<div class="line"><span class="lineno">  837</span>    X_r = X_c * np.sqrt(w_norm)[:, np.newaxis]</div>
<div class="line"><span class="lineno">  838</span>    gram = np.dot(X_r.T, X_r)</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>    clf1 = ElasticNet(alpha=0.01, precompute=gram)</div>
<div class="line"><span class="lineno">  841</span>    clf1.fit(X_c, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>    clf2 = ElasticNet(alpha=0.01, precompute=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  844</span>    clf2.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>    assert_allclose(clf1.coef_, clf2.coef_)</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f745b0f4b07c30c7fdf70e9d12f15b7" name="a4f745b0f4b07c30c7fdf70e9d12f15b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f745b0f4b07c30c7fdf70e9d12f15b7">&#9670;&#160;</a></span>test_elasticnet_precompute_incorrect_gram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_elasticnet_precompute_incorrect_gram </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  810</span><span class="keyword">def </span>test_elasticnet_precompute_incorrect_gram():</div>
<div class="line"><span class="lineno">  811</span>    <span class="comment"># check that passing an invalid precomputed Gram matrix will raise an</span></div>
<div class="line"><span class="lineno">  812</span>    <span class="comment"># error.</span></div>
<div class="line"><span class="lineno">  813</span>    X, y, _, _ = build_dataset()</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    X_centered = X - np.average(X, axis=0)</div>
<div class="line"><span class="lineno">  818</span>    garbage = rng.standard_normal(X.shape)</div>
<div class="line"><span class="lineno">  819</span>    precompute = np.dot(garbage.T, garbage)</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>    clf = ElasticNet(alpha=0.01, precompute=precompute)</div>
<div class="line"><span class="lineno">  822</span>    msg = <span class="stringliteral">&quot;Gram matrix.*did not pass validation.*&quot;</span></div>
<div class="line"><span class="lineno">  823</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  824</span>        clf.fit(X_centered, y)</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a33cf8dec6302ba2fe54e26e3169f1f46" name="a33cf8dec6302ba2fe54e26e3169f1f46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33cf8dec6302ba2fe54e26e3169f1f46">&#9670;&#160;</a></span>test_enet_coordinate_descent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_coordinate_descent </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>klass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that a warning is issued if model does not converge</pre> <div class="fragment"><div class="line"><span class="lineno"> 1195</span><span class="keyword">def </span>test_enet_coordinate_descent(klass, n_classes, kwargs):</div>
<div class="line"><span class="lineno"> 1196</span>    <span class="stringliteral">&quot;&quot;&quot;Test that a warning is issued if model does not converge&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1197</span>    clf = klass(max_iter=2, **kwargs)</div>
<div class="line"><span class="lineno"> 1198</span>    n_samples = 5</div>
<div class="line"><span class="lineno"> 1199</span>    n_features = 2</div>
<div class="line"><span class="lineno"> 1200</span>    X = np.ones((n_samples, n_features)) * 1e50</div>
<div class="line"><span class="lineno"> 1201</span>    y = np.ones((n_samples, n_classes))</div>
<div class="line"><span class="lineno"> 1202</span>    <span class="keywordflow">if</span> klass == Lasso:</div>
<div class="line"><span class="lineno"> 1203</span>        y = y.ravel()</div>
<div class="line"><span class="lineno"> 1204</span>    warning_message = (</div>
<div class="line"><span class="lineno"> 1205</span>        <span class="stringliteral">&quot;Objective did not converge. You might want to&quot;</span></div>
<div class="line"><span class="lineno"> 1206</span>        <span class="stringliteral">&quot; increase the number of iterations.&quot;</span></div>
<div class="line"><span class="lineno"> 1207</span>    )</div>
<div class="line"><span class="lineno"> 1208</span>    <span class="keyword">with</span> pytest.warns(ConvergenceWarning, match=warning_message):</div>
<div class="line"><span class="lineno"> 1209</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a02439d5d5d7f8b8faa1e1728c0692a93" name="a02439d5d5d7f8b8faa1e1728c0692a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02439d5d5d7f8b8faa1e1728c0692a93">&#9670;&#160;</a></span>test_enet_copy_X_False_check_input_False()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_copy_X_False_check_input_False </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1026</span><span class="keyword">def </span>test_enet_copy_X_False_check_input_False():</div>
<div class="line"><span class="lineno"> 1027</span>    X, y, _, _ = build_dataset()</div>
<div class="line"><span class="lineno"> 1028</span>    X = X.copy(order=<span class="stringliteral">&quot;F&quot;</span>)</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>    original_X = X.copy()</div>
<div class="line"><span class="lineno"> 1031</span>    enet = ElasticNet(copy_X=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1032</span>    enet.fit(X, y, check_input=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>    <span class="comment"># No copying, X is overwritten</span></div>
<div class="line"><span class="lineno"> 1035</span>    <span class="keyword">assert</span> np.any(np.not_equal(original_X, X))</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a90ba90c89399f5b636606050c06efefd" name="a90ba90c89399f5b636606050c06efefd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90ba90c89399f5b636606050c06efefd">&#9670;&#160;</a></span>test_enet_copy_X_True()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_copy_X_True </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1015</span><span class="keyword">def </span>test_enet_copy_X_True(check_input):</div>
<div class="line"><span class="lineno"> 1016</span>    X, y, _, _ = build_dataset()</div>
<div class="line"><span class="lineno"> 1017</span>    X = X.copy(order=<span class="stringliteral">&quot;F&quot;</span>)</div>
<div class="line"><span class="lineno"> 1018</span> </div>
<div class="line"><span class="lineno"> 1019</span>    original_X = X.copy()</div>
<div class="line"><span class="lineno"> 1020</span>    enet = ElasticNet(copy_X=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1021</span>    enet.fit(X, y, check_input=check_input)</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>    assert_array_equal(original_X, X)</div>
<div class="line"><span class="lineno"> 1024</span> </div>
<div class="line"><span class="lineno"> 1025</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2efbb8181f43a686326a1eedb478b6b" name="ae2efbb8181f43a686326a1eedb478b6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2efbb8181f43a686326a1eedb478b6b">&#9670;&#160;</a></span>test_enet_cv_grid_search()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_cv_grid_search </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sample_weight</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that ElasticNetCV gives same result as GridSearchCV.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1400</span><span class="keyword">def </span>test_enet_cv_grid_search(sample_weight):</div>
<div class="line"><span class="lineno"> 1401</span>    <span class="stringliteral">&quot;&quot;&quot;Test that ElasticNetCV gives same result as GridSearchCV.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1402</span>    n_samples, n_features = 200, 10</div>
<div class="line"><span class="lineno"> 1403</span>    cv = 5</div>
<div class="line"><span class="lineno"> 1404</span>    X, y = make_regression(</div>
<div class="line"><span class="lineno"> 1405</span>        n_samples=n_samples,</div>
<div class="line"><span class="lineno"> 1406</span>        n_features=n_features,</div>
<div class="line"><span class="lineno"> 1407</span>        effective_rank=10,</div>
<div class="line"><span class="lineno"> 1408</span>        n_informative=n_features - 4,</div>
<div class="line"><span class="lineno"> 1409</span>        noise=10,</div>
<div class="line"><span class="lineno"> 1410</span>        random_state=0,</div>
<div class="line"><span class="lineno"> 1411</span>    )</div>
<div class="line"><span class="lineno"> 1412</span>    <span class="keywordflow">if</span> sample_weight:</div>
<div class="line"><span class="lineno"> 1413</span>        sample_weight = np.linspace(1, 5, num=n_samples)</div>
<div class="line"><span class="lineno"> 1414</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1415</span>        sample_weight = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>    alphas = np.logspace(np.log10(1e-5), np.log10(1), num=10)</div>
<div class="line"><span class="lineno"> 1418</span>    l1_ratios = [0.1, 0.5, 0.9]</div>
<div class="line"><span class="lineno"> 1419</span>    reg = ElasticNetCV(cv=cv, alphas=alphas, l1_ratio=l1_ratios)</div>
<div class="line"><span class="lineno"> 1420</span>    reg.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>    param = {<span class="stringliteral">&quot;alpha&quot;</span>: alphas, <span class="stringliteral">&quot;l1_ratio&quot;</span>: l1_ratios}</div>
<div class="line"><span class="lineno"> 1423</span>    gs = GridSearchCV(</div>
<div class="line"><span class="lineno"> 1424</span>        estimator=ElasticNet(),</div>
<div class="line"><span class="lineno"> 1425</span>        param_grid=param,</div>
<div class="line"><span class="lineno"> 1426</span>        cv=cv,</div>
<div class="line"><span class="lineno"> 1427</span>        scoring=<span class="stringliteral">&quot;neg_mean_squared_error&quot;</span>,</div>
<div class="line"><span class="lineno"> 1428</span>    ).fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>    <span class="keyword">assert</span> reg.l1_ratio_ == pytest.approx(gs.best_params_[<span class="stringliteral">&quot;l1_ratio&quot;</span>])</div>
<div class="line"><span class="lineno"> 1431</span>    <span class="keyword">assert</span> reg.alpha_ == pytest.approx(gs.best_params_[<span class="stringliteral">&quot;alpha&quot;</span>])</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span><span class="preprocessor">@pytest.mark.parametrize(&quot;fit_intercept&quot;, [True, False])</span></div>
<div class="line"><span class="lineno"> 1435</span><span class="preprocessor">@pytest.mark.parametrize(&quot;l1_ratio&quot;, [0, 0.5, 1])</span></div>
<div class="line"><span class="lineno"> 1436</span><span class="preprocessor">@pytest.mark.parametrize(&quot;precompute&quot;, [False, True])</span></div>
<div class="line"><span class="lineno"> 1437</span><span class="preprocessor">@pytest.mark.parametrize(&quot;sparseX&quot;, [False, True])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="abf271cfb2258ef8cd3880c5659827c83" name="abf271cfb2258ef8cd3880c5659827c83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf271cfb2258ef8cd3880c5659827c83">&#9670;&#160;</a></span>test_enet_cv_positive_constraint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_cv_positive_constraint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  618</span><span class="keyword">def </span>test_enet_cv_positive_constraint():</div>
<div class="line"><span class="lineno">  619</span>    X, y, X_test, y_test = build_dataset()</div>
<div class="line"><span class="lineno">  620</span>    max_iter = 500</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    <span class="comment"># Ensure the unconstrained fit has a negative coefficient</span></div>
<div class="line"><span class="lineno">  623</span>    enetcv_unconstrained = ElasticNetCV(</div>
<div class="line"><span class="lineno">  624</span>        n_alphas=3, eps=1e-1, max_iter=max_iter, cv=2, n_jobs=1</div>
<div class="line"><span class="lineno">  625</span>    )</div>
<div class="line"><span class="lineno">  626</span>    enetcv_unconstrained.fit(X, y)</div>
<div class="line"><span class="lineno">  627</span>    <span class="keyword">assert</span> min(enetcv_unconstrained.coef_) &lt; 0</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    <span class="comment"># On same data, constrained fit has non-negative coefficients</span></div>
<div class="line"><span class="lineno">  630</span>    enetcv_constrained = ElasticNetCV(</div>
<div class="line"><span class="lineno">  631</span>        n_alphas=3, eps=1e-1, max_iter=max_iter, cv=2, positive=<span class="keyword">True</span>, n_jobs=1</div>
<div class="line"><span class="lineno">  632</span>    )</div>
<div class="line"><span class="lineno">  633</span>    enetcv_constrained.fit(X, y)</div>
<div class="line"><span class="lineno">  634</span>    <span class="keyword">assert</span> min(enetcv_constrained.coef_) &gt;= 0</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="add7d54ef317b419b3a95060cfb871d8b" name="add7d54ef317b419b3a95060cfb871d8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add7d54ef317b419b3a95060cfb871d8b">&#9670;&#160;</a></span>test_enet_cv_sample_weight_consistency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_cv_sample_weight_consistency </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fit_intercept</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>l1_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precompute</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparseX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that the impact of sample_weight is consistent.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1440</span>):</div>
<div class="line"><span class="lineno"> 1441</span>    <span class="stringliteral">&quot;&quot;&quot;Test that the impact of sample_weight is consistent.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1442</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1443</span>    n_samples, n_features = 10, 5</div>
<div class="line"><span class="lineno"> 1444</span> </div>
<div class="line"><span class="lineno"> 1445</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno"> 1446</span>    y = X.sum(axis=1) + rng.rand(n_samples)</div>
<div class="line"><span class="lineno"> 1447</span>    params = dict(</div>
<div class="line"><span class="lineno"> 1448</span>        l1_ratio=l1_ratio,</div>
<div class="line"><span class="lineno"> 1449</span>        fit_intercept=fit_intercept,</div>
<div class="line"><span class="lineno"> 1450</span>        precompute=precompute,</div>
<div class="line"><span class="lineno"> 1451</span>        tol=1e-6,</div>
<div class="line"><span class="lineno"> 1452</span>        cv=3,</div>
<div class="line"><span class="lineno"> 1453</span>    )</div>
<div class="line"><span class="lineno"> 1454</span>    <span class="keywordflow">if</span> sparseX:</div>
<div class="line"><span class="lineno"> 1455</span>        X = sparse.csc_matrix(X)</div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>    <span class="keywordflow">if</span> l1_ratio == 0:</div>
<div class="line"><span class="lineno"> 1458</span>        params.pop(<span class="stringliteral">&quot;l1_ratio&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1459</span>        reg = LassoCV(**params).fit(X, y)</div>
<div class="line"><span class="lineno"> 1460</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1461</span>        reg = ElasticNetCV(**params).fit(X, y)</div>
<div class="line"><span class="lineno"> 1462</span>    coef = reg.coef_.copy()</div>
<div class="line"><span class="lineno"> 1463</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1464</span>        intercept = reg.intercept_</div>
<div class="line"><span class="lineno"> 1465</span> </div>
<div class="line"><span class="lineno"> 1466</span>    <span class="comment"># sample_weight=np.ones(..) should be equivalent to sample_weight=None</span></div>
<div class="line"><span class="lineno"> 1467</span>    sample_weight = np.ones_like(y)</div>
<div class="line"><span class="lineno"> 1468</span>    reg.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1469</span>    assert_allclose(reg.coef_, coef, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1470</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1471</span>        assert_allclose(reg.intercept_, intercept)</div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>    <span class="comment"># sample_weight=None should be equivalent to sample_weight = number</span></div>
<div class="line"><span class="lineno"> 1474</span>    sample_weight = 123.0</div>
<div class="line"><span class="lineno"> 1475</span>    reg.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1476</span>    assert_allclose(reg.coef_, coef, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1477</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1478</span>        assert_allclose(reg.intercept_, intercept)</div>
<div class="line"><span class="lineno"> 1479</span> </div>
<div class="line"><span class="lineno"> 1480</span>    <span class="comment"># scaling of sample_weight should have no effect, cf. np.average()</span></div>
<div class="line"><span class="lineno"> 1481</span>    sample_weight = 2 * np.ones_like(y)</div>
<div class="line"><span class="lineno"> 1482</span>    reg.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1483</span>    assert_allclose(reg.coef_, coef, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1484</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1485</span>        assert_allclose(reg.intercept_, intercept)</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span><span class="preprocessor">@pytest.mark.parametrize(&quot;estimator&quot;, [ElasticNetCV, LassoCV])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac739a978d534c68e89e755cfb0008efd" name="ac739a978d534c68e89e755cfb0008efd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac739a978d534c68e89e755cfb0008efd">&#9670;&#160;</a></span>test_enet_cv_sample_weight_correctness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_cv_sample_weight_correctness </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fit_intercept</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparseX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that ElasticNetCV with sample weights gives correct results.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1348</span><span class="keyword">def </span>test_enet_cv_sample_weight_correctness(fit_intercept, sparseX):</div>
<div class="line"><span class="lineno"> 1349</span>    <span class="stringliteral">&quot;&quot;&quot;Test that ElasticNetCV with sample weights gives correct results.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1350</span>    rng = np.random.RandomState(42)</div>
<div class="line"><span class="lineno"> 1351</span>    n_splits, n_samples, n_features = 3, 10, 5</div>
<div class="line"><span class="lineno"> 1352</span>    X = rng.rand(n_splits * n_samples, n_features)</div>
<div class="line"><span class="lineno"> 1353</span>    beta = rng.rand(n_features)</div>
<div class="line"><span class="lineno"> 1354</span>    beta[0:2] = 0</div>
<div class="line"><span class="lineno"> 1355</span>    y = X @ beta + rng.rand(n_splits * n_samples)</div>
<div class="line"><span class="lineno"> 1356</span>    sw = np.ones_like(y)</div>
<div class="line"><span class="lineno"> 1357</span>    <span class="keywordflow">if</span> sparseX:</div>
<div class="line"><span class="lineno"> 1358</span>        X = sparse.csc_matrix(X)</div>
<div class="line"><span class="lineno"> 1359</span>    params = dict(tol=1e-6)</div>
<div class="line"><span class="lineno"> 1360</span> </div>
<div class="line"><span class="lineno"> 1361</span>    <span class="comment"># Set alphas, otherwise the two cv models might use different ones.</span></div>
<div class="line"><span class="lineno"> 1362</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1363</span>        alphas = np.linspace(0.001, 0.01, num=91)</div>
<div class="line"><span class="lineno"> 1364</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1365</span>        alphas = np.linspace(0.01, 0.1, num=91)</div>
<div class="line"><span class="lineno"> 1366</span> </div>
<div class="line"><span class="lineno"> 1367</span>    <span class="comment"># We weight the first fold 2 times more.</span></div>
<div class="line"><span class="lineno"> 1368</span>    sw[:n_samples] = 2</div>
<div class="line"><span class="lineno"> 1369</span>    groups_sw = np.r_[</div>
<div class="line"><span class="lineno"> 1370</span>        np.full(n_samples, 0), np.full(n_samples, 1), np.full(n_samples, 2)</div>
<div class="line"><span class="lineno"> 1371</span>    ]</div>
<div class="line"><span class="lineno"> 1372</span>    splits_sw = list(LeaveOneGroupOut().split(X, groups=groups_sw))</div>
<div class="line"><span class="lineno"> 1373</span>    reg_sw = ElasticNetCV(</div>
<div class="line"><span class="lineno"> 1374</span>        alphas=alphas, cv=splits_sw, fit_intercept=fit_intercept, **params</div>
<div class="line"><span class="lineno"> 1375</span>    )</div>
<div class="line"><span class="lineno"> 1376</span>    reg_sw.fit(X, y, sample_weight=sw)</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>    <span class="comment"># We repeat the first fold 2 times and provide splits ourselves</span></div>
<div class="line"><span class="lineno"> 1379</span>    <span class="keywordflow">if</span> sparseX:</div>
<div class="line"><span class="lineno"> 1380</span>        X = X.toarray()</div>
<div class="line"><span class="lineno"> 1381</span>    X = np.r_[X[:n_samples], X]</div>
<div class="line"><span class="lineno"> 1382</span>    <span class="keywordflow">if</span> sparseX:</div>
<div class="line"><span class="lineno"> 1383</span>        X = sparse.csc_matrix(X)</div>
<div class="line"><span class="lineno"> 1384</span>    y = np.r_[y[:n_samples], y]</div>
<div class="line"><span class="lineno"> 1385</span>    groups = np.r_[</div>
<div class="line"><span class="lineno"> 1386</span>        np.full(2 * n_samples, 0), np.full(n_samples, 1), np.full(n_samples, 2)</div>
<div class="line"><span class="lineno"> 1387</span>    ]</div>
<div class="line"><span class="lineno"> 1388</span>    splits = list(LeaveOneGroupOut().split(X, groups=groups))</div>
<div class="line"><span class="lineno"> 1389</span>    reg = ElasticNetCV(alphas=alphas, cv=splits, fit_intercept=fit_intercept, **params)</div>
<div class="line"><span class="lineno"> 1390</span>    reg.fit(X, y)</div>
<div class="line"><span class="lineno"> 1391</span> </div>
<div class="line"><span class="lineno"> 1392</span>    <span class="comment"># ensure that we chose meaningful alphas, i.e. not boundaries</span></div>
<div class="line"><span class="lineno"> 1393</span>    <span class="keyword">assert</span> alphas[0] &lt; reg.alpha_ &lt; alphas[-1]</div>
<div class="line"><span class="lineno"> 1394</span>    <span class="keyword">assert</span> reg_sw.alpha_ == reg.alpha_</div>
<div class="line"><span class="lineno"> 1395</span>    assert_allclose(reg_sw.coef_, reg.coef_)</div>
<div class="line"><span class="lineno"> 1396</span>    <span class="keyword">assert</span> reg_sw.intercept_ == pytest.approx(reg.intercept_)</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span><span class="preprocessor">@pytest.mark.parametrize(&quot;sample_weight&quot;, [False, True])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c3bffb3b5fc51910796d03920f9777e" name="a9c3bffb3b5fc51910796d03920f9777e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c3bffb3b5fc51910796d03920f9777e">&#9670;&#160;</a></span>test_enet_float_precision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_float_precision </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1064</span><span class="keyword">def </span>test_enet_float_precision():</div>
<div class="line"><span class="lineno"> 1065</span>    <span class="comment"># Generate dataset</span></div>
<div class="line"><span class="lineno"> 1066</span>    X, y, X_test, y_test = build_dataset(n_samples=20, n_features=10)</div>
<div class="line"><span class="lineno"> 1067</span>    <span class="comment"># Here we have a small number of iterations, and thus the</span></div>
<div class="line"><span class="lineno"> 1068</span>    <span class="comment"># ElasticNet might not converge. This is to speed up tests</span></div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>    <span class="keywordflow">for</span> fit_intercept <span class="keywordflow">in</span> [<span class="keyword">True</span>, <span class="keyword">False</span>]:</div>
<div class="line"><span class="lineno"> 1071</span>        coef = {}</div>
<div class="line"><span class="lineno"> 1072</span>        intercept = {}</div>
<div class="line"><span class="lineno"> 1073</span>        <span class="keywordflow">for</span> dtype <span class="keywordflow">in</span> [np.float64, np.float32]:</div>
<div class="line"><span class="lineno"> 1074</span>            clf = ElasticNet(</div>
<div class="line"><span class="lineno"> 1075</span>                alpha=0.5,</div>
<div class="line"><span class="lineno"> 1076</span>                max_iter=100,</div>
<div class="line"><span class="lineno"> 1077</span>                precompute=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno"> 1078</span>                fit_intercept=fit_intercept,</div>
<div class="line"><span class="lineno"> 1079</span>            )</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>            X = <a class="code hl_namespace" href="namespacedtype.html">dtype</a>(X)</div>
<div class="line"><span class="lineno"> 1082</span>            y = <a class="code hl_namespace" href="namespacedtype.html">dtype</a>(y)</div>
<div class="line"><span class="lineno"> 1083</span>            ignore_warnings(clf.fit)(X, y)</div>
<div class="line"><span class="lineno"> 1084</span> </div>
<div class="line"><span class="lineno"> 1085</span>            coef[(<span class="stringliteral">&quot;simple&quot;</span>, dtype)] = clf.coef_</div>
<div class="line"><span class="lineno"> 1086</span>            intercept[(<span class="stringliteral">&quot;simple&quot;</span>, dtype)] = clf.intercept_</div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span>            <span class="keyword">assert</span> clf.coef_.dtype == dtype</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>            <span class="comment"># test precompute Gram array</span></div>
<div class="line"><span class="lineno"> 1091</span>            Gram = X.T.dot(X)</div>
<div class="line"><span class="lineno"> 1092</span>            clf_precompute = ElasticNet(</div>
<div class="line"><span class="lineno"> 1093</span>                alpha=0.5,</div>
<div class="line"><span class="lineno"> 1094</span>                max_iter=100,</div>
<div class="line"><span class="lineno"> 1095</span>                precompute=Gram,</div>
<div class="line"><span class="lineno"> 1096</span>                fit_intercept=fit_intercept,</div>
<div class="line"><span class="lineno"> 1097</span>            )</div>
<div class="line"><span class="lineno"> 1098</span>            ignore_warnings(clf_precompute.fit)(X, y)</div>
<div class="line"><span class="lineno"> 1099</span>            assert_array_almost_equal(clf.coef_, clf_precompute.coef_)</div>
<div class="line"><span class="lineno"> 1100</span>            assert_array_almost_equal(clf.intercept_, clf_precompute.intercept_)</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>            <span class="comment"># test multi task enet</span></div>
<div class="line"><span class="lineno"> 1103</span>            multi_y = np.hstack((y[:, np.newaxis], y[:, np.newaxis]))</div>
<div class="line"><span class="lineno"> 1104</span>            clf_multioutput = MultiTaskElasticNet(</div>
<div class="line"><span class="lineno"> 1105</span>                alpha=0.5,</div>
<div class="line"><span class="lineno"> 1106</span>                max_iter=100,</div>
<div class="line"><span class="lineno"> 1107</span>                fit_intercept=fit_intercept,</div>
<div class="line"><span class="lineno"> 1108</span>            )</div>
<div class="line"><span class="lineno"> 1109</span>            clf_multioutput.fit(X, multi_y)</div>
<div class="line"><span class="lineno"> 1110</span>            coef[(<span class="stringliteral">&quot;multi&quot;</span>, dtype)] = clf_multioutput.coef_</div>
<div class="line"><span class="lineno"> 1111</span>            intercept[(<span class="stringliteral">&quot;multi&quot;</span>, dtype)] = clf_multioutput.intercept_</div>
<div class="line"><span class="lineno"> 1112</span>            <span class="keyword">assert</span> clf.coef_.dtype == dtype</div>
<div class="line"><span class="lineno"> 1113</span> </div>
<div class="line"><span class="lineno"> 1114</span>        <span class="keywordflow">for</span> v <span class="keywordflow">in</span> [<span class="stringliteral">&quot;simple&quot;</span>, <span class="stringliteral">&quot;multi&quot;</span>]:</div>
<div class="line"><span class="lineno"> 1115</span>            assert_array_almost_equal(</div>
<div class="line"><span class="lineno"> 1116</span>                coef[(v, np.float32)], coef[(v, np.float64)], decimal=4</div>
<div class="line"><span class="lineno"> 1117</span>            )</div>
<div class="line"><span class="lineno"> 1118</span>            assert_array_almost_equal(</div>
<div class="line"><span class="lineno"> 1119</span>                intercept[(v, np.float32)], intercept[(v, np.float64)], decimal=4</div>
<div class="line"><span class="lineno"> 1120</span>            )</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="ttc" id="anamespacedtype_html"><div class="ttname"><a href="namespacedtype.html">dtype</a></div><div class="ttdef"><b>Definition</b> dtype.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c31c346e8ae2ad595c312c129fb108e" name="a7c31c346e8ae2ad595c312c129fb108e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c31c346e8ae2ad595c312c129fb108e">&#9670;&#160;</a></span>test_enet_l1_ratio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_l1_ratio </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1123</span><span class="keyword">def </span>test_enet_l1_ratio():</div>
<div class="line"><span class="lineno"> 1124</span>    <span class="comment"># Test that an error message is raised if an estimator that</span></div>
<div class="line"><span class="lineno"> 1125</span>    <span class="comment"># uses _alpha_grid is called with l1_ratio=0</span></div>
<div class="line"><span class="lineno"> 1126</span>    msg = (</div>
<div class="line"><span class="lineno"> 1127</span>        <span class="stringliteral">&quot;Automatic alpha grid generation is not supported for l1_ratio=0. &quot;</span></div>
<div class="line"><span class="lineno"> 1128</span>        <span class="stringliteral">&quot;Please supply a grid by providing your estimator with the &quot;</span></div>
<div class="line"><span class="lineno"> 1129</span>        <span class="stringliteral">&quot;appropriate `alphas=` argument.&quot;</span></div>
<div class="line"><span class="lineno"> 1130</span>    )</div>
<div class="line"><span class="lineno"> 1131</span>    X = np.array([[1, 2, 4, 5, 8], [3, 5, 7, 7, 8]]).T</div>
<div class="line"><span class="lineno"> 1132</span>    y = np.array([12, 10, 11, 21, 5])</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno"> 1135</span>        ElasticNetCV(l1_ratio=0, random_state=42).fit(X, y)</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno"> 1138</span>        MultiTaskElasticNetCV(l1_ratio=0, random_state=42).fit(X, y[:, <span class="keywordtype">None</span>])</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>    <span class="comment"># Test that l1_ratio=0 with alpha&gt;0 produces user warning</span></div>
<div class="line"><span class="lineno"> 1141</span>    warning_message = (</div>
<div class="line"><span class="lineno"> 1142</span>        <span class="stringliteral">&quot;Coordinate descent without L1 regularization may &quot;</span></div>
<div class="line"><span class="lineno"> 1143</span>        <span class="stringliteral">&quot;lead to unexpected results and is discouraged. &quot;</span></div>
<div class="line"><span class="lineno"> 1144</span>        <span class="stringliteral">&quot;Set l1_ratio &gt; 0 to add L1 regularization.&quot;</span></div>
<div class="line"><span class="lineno"> 1145</span>    )</div>
<div class="line"><span class="lineno"> 1146</span>    est = ElasticNetCV(l1_ratio=[0], alphas=[1])</div>
<div class="line"><span class="lineno"> 1147</span>    <span class="keyword">with</span> pytest.warns(UserWarning, match=warning_message):</div>
<div class="line"><span class="lineno"> 1148</span>        est.fit(X, y)</div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span>    <span class="comment"># Test that l1_ratio=0 is allowed if we supply a grid manually</span></div>
<div class="line"><span class="lineno"> 1151</span>    alphas = [0.1, 10]</div>
<div class="line"><span class="lineno"> 1152</span>    estkwds = {<span class="stringliteral">&quot;alphas&quot;</span>: alphas, <span class="stringliteral">&quot;random_state&quot;</span>: 42}</div>
<div class="line"><span class="lineno"> 1153</span>    est_desired = ElasticNetCV(l1_ratio=0.00001, **estkwds)</div>
<div class="line"><span class="lineno"> 1154</span>    est = ElasticNetCV(l1_ratio=0, **estkwds)</div>
<div class="line"><span class="lineno"> 1155</span>    <span class="keyword">with</span> ignore_warnings():</div>
<div class="line"><span class="lineno"> 1156</span>        est_desired.fit(X, y)</div>
<div class="line"><span class="lineno"> 1157</span>        est.fit(X, y)</div>
<div class="line"><span class="lineno"> 1158</span>    assert_array_almost_equal(est.coef_, est_desired.coef_, decimal=5)</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>    est_desired = MultiTaskElasticNetCV(l1_ratio=0.00001, **estkwds)</div>
<div class="line"><span class="lineno"> 1161</span>    est = MultiTaskElasticNetCV(l1_ratio=0, **estkwds)</div>
<div class="line"><span class="lineno"> 1162</span>    <span class="keyword">with</span> ignore_warnings():</div>
<div class="line"><span class="lineno"> 1163</span>        est.fit(X, y[:, <span class="keywordtype">None</span>])</div>
<div class="line"><span class="lineno"> 1164</span>        est_desired.fit(X, y[:, <span class="keywordtype">None</span>])</div>
<div class="line"><span class="lineno"> 1165</span>    assert_array_almost_equal(est.coef_, est_desired.coef_, decimal=5)</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a798636c50e689e5bf00454e3d697aa4a" name="a798636c50e689e5bf00454e3d697aa4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a798636c50e689e5bf00454e3d697aa4a">&#9670;&#160;</a></span>test_enet_multitarget()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_multitarget </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  712</span><span class="keyword">def </span>test_enet_multitarget():</div>
<div class="line"><span class="lineno">  713</span>    n_targets = 3</div>
<div class="line"><span class="lineno">  714</span>    X, y, _, _ = build_dataset(</div>
<div class="line"><span class="lineno">  715</span>        n_samples=10, n_features=8, n_informative_features=10, n_targets=n_targets</div>
<div class="line"><span class="lineno">  716</span>    )</div>
<div class="line"><span class="lineno">  717</span>    estimator = ElasticNet(alpha=0.01)</div>
<div class="line"><span class="lineno">  718</span>    estimator.fit(X, y)</div>
<div class="line"><span class="lineno">  719</span>    coef, intercept, dual_gap = (</div>
<div class="line"><span class="lineno">  720</span>        estimator.coef_,</div>
<div class="line"><span class="lineno">  721</span>        estimator.intercept_,</div>
<div class="line"><span class="lineno">  722</span>        estimator.dual_gap_,</div>
<div class="line"><span class="lineno">  723</span>    )</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(n_targets):</div>
<div class="line"><span class="lineno">  726</span>        estimator.fit(X, y[:, k])</div>
<div class="line"><span class="lineno">  727</span>        assert_array_almost_equal(coef[k, :], estimator.coef_)</div>
<div class="line"><span class="lineno">  728</span>        assert_array_almost_equal(intercept[k], estimator.intercept_)</div>
<div class="line"><span class="lineno">  729</span>        assert_array_almost_equal(dual_gap[k], estimator.dual_gap_)</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a98d0c542c37aec06d61889e2856e9d71" name="a98d0c542c37aec06d61889e2856e9d71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d0c542c37aec06d61889e2856e9d71">&#9670;&#160;</a></span>test_enet_nonfinite_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_nonfinite_params </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  108</span><span class="keyword">def </span>test_enet_nonfinite_params():</div>
<div class="line"><span class="lineno">  109</span>    <span class="comment"># Check ElasticNet throws ValueError when dealing with non-finite parameter</span></div>
<div class="line"><span class="lineno">  110</span>    <span class="comment"># values</span></div>
<div class="line"><span class="lineno">  111</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  112</span>    n_samples = 10</div>
<div class="line"><span class="lineno">  113</span>    fmax = np.finfo(np.float64).max</div>
<div class="line"><span class="lineno">  114</span>    X = fmax * rng.uniform(size=(n_samples, 2))</div>
<div class="line"><span class="lineno">  115</span>    y = rng.randint(0, 2, size=n_samples)</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>    clf = ElasticNet(alpha=0.1)</div>
<div class="line"><span class="lineno">  118</span>    msg = <span class="stringliteral">&quot;Coordinate descent iterations resulted in non-finite parameter values&quot;</span></div>
<div class="line"><span class="lineno">  119</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno">  120</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a82bd6d181ee563ca81d17f51141984d0" name="a82bd6d181ee563ca81d17f51141984d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82bd6d181ee563ca81d17f51141984d0">&#9670;&#160;</a></span>test_enet_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_path </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  496</span><span class="keyword">def </span>test_enet_path():</div>
<div class="line"><span class="lineno">  497</span>    <span class="comment"># We use a large number of samples and of informative features so that</span></div>
<div class="line"><span class="lineno">  498</span>    <span class="comment"># the l1_ratio selected is more toward ridge than lasso</span></div>
<div class="line"><span class="lineno">  499</span>    X, y, X_test, y_test = build_dataset(</div>
<div class="line"><span class="lineno">  500</span>        n_samples=200, n_features=100, n_informative_features=100</div>
<div class="line"><span class="lineno">  501</span>    )</div>
<div class="line"><span class="lineno">  502</span>    max_iter = 150</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="comment"># Here we have a small number of iterations, and thus the</span></div>
<div class="line"><span class="lineno">  505</span>    <span class="comment"># ElasticNet might not converge. This is to speed up tests</span></div>
<div class="line"><span class="lineno">  506</span>    clf = ElasticNetCV(</div>
<div class="line"><span class="lineno">  507</span>        alphas=[0.01, 0.05, 0.1], eps=2e-3, l1_ratio=[0.5, 0.7], cv=3, max_iter=max_iter</div>
<div class="line"><span class="lineno">  508</span>    )</div>
<div class="line"><span class="lineno">  509</span>    ignore_warnings(clf.fit)(X, y)</div>
<div class="line"><span class="lineno">  510</span>    <span class="comment"># Well-conditioned settings, we should have selected our</span></div>
<div class="line"><span class="lineno">  511</span>    <span class="comment"># smallest penalty</span></div>
<div class="line"><span class="lineno">  512</span>    assert_almost_equal(clf.alpha_, min(clf.alphas_))</div>
<div class="line"><span class="lineno">  513</span>    <span class="comment"># Non-sparse ground truth: we should have selected an elastic-net</span></div>
<div class="line"><span class="lineno">  514</span>    <span class="comment"># that is closer to ridge than to lasso</span></div>
<div class="line"><span class="lineno">  515</span>    <span class="keyword">assert</span> clf.l1_ratio_ == min(clf.l1_ratio)</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    clf = ElasticNetCV(</div>
<div class="line"><span class="lineno">  518</span>        alphas=[0.01, 0.05, 0.1],</div>
<div class="line"><span class="lineno">  519</span>        eps=2e-3,</div>
<div class="line"><span class="lineno">  520</span>        l1_ratio=[0.5, 0.7],</div>
<div class="line"><span class="lineno">  521</span>        cv=3,</div>
<div class="line"><span class="lineno">  522</span>        max_iter=max_iter,</div>
<div class="line"><span class="lineno">  523</span>        precompute=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  524</span>    )</div>
<div class="line"><span class="lineno">  525</span>    ignore_warnings(clf.fit)(X, y)</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>    <span class="comment"># Well-conditioned settings, we should have selected our</span></div>
<div class="line"><span class="lineno">  528</span>    <span class="comment"># smallest penalty</span></div>
<div class="line"><span class="lineno">  529</span>    assert_almost_equal(clf.alpha_, min(clf.alphas_))</div>
<div class="line"><span class="lineno">  530</span>    <span class="comment"># Non-sparse ground truth: we should have selected an elastic-net</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="comment"># that is closer to ridge than to lasso</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="keyword">assert</span> clf.l1_ratio_ == min(clf.l1_ratio)</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>    <span class="comment"># We are in well-conditioned settings with low noise: we should</span></div>
<div class="line"><span class="lineno">  535</span>    <span class="comment"># have a good test-set performance</span></div>
<div class="line"><span class="lineno">  536</span>    <span class="keyword">assert</span> clf.score(X_test, y_test) &gt; 0.99</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    <span class="comment"># Multi-output/target case</span></div>
<div class="line"><span class="lineno">  539</span>    X, y, X_test, y_test = build_dataset(n_features=10, n_targets=3)</div>
<div class="line"><span class="lineno">  540</span>    clf = MultiTaskElasticNetCV(</div>
<div class="line"><span class="lineno">  541</span>        n_alphas=5, eps=2e-3, l1_ratio=[0.5, 0.7], cv=3, max_iter=max_iter</div>
<div class="line"><span class="lineno">  542</span>    )</div>
<div class="line"><span class="lineno">  543</span>    ignore_warnings(clf.fit)(X, y)</div>
<div class="line"><span class="lineno">  544</span>    <span class="comment"># We are in well-conditioned settings with low noise: we should</span></div>
<div class="line"><span class="lineno">  545</span>    <span class="comment"># have a good test-set performance</span></div>
<div class="line"><span class="lineno">  546</span>    <span class="keyword">assert</span> clf.score(X_test, y_test) &gt; 0.99</div>
<div class="line"><span class="lineno">  547</span>    <span class="keyword">assert</span> clf.coef_.shape == (3, 10)</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>    <span class="comment"># Mono-output should have same cross-validated alpha_ and l1_ratio_</span></div>
<div class="line"><span class="lineno">  550</span>    <span class="comment"># in both cases.</span></div>
<div class="line"><span class="lineno">  551</span>    X, y, _, _ = build_dataset(n_features=10)</div>
<div class="line"><span class="lineno">  552</span>    clf1 = ElasticNetCV(n_alphas=5, eps=2e-3, l1_ratio=[0.5, 0.7])</div>
<div class="line"><span class="lineno">  553</span>    clf1.fit(X, y)</div>
<div class="line"><span class="lineno">  554</span>    clf2 = MultiTaskElasticNetCV(n_alphas=5, eps=2e-3, l1_ratio=[0.5, 0.7])</div>
<div class="line"><span class="lineno">  555</span>    clf2.fit(X, y[:, np.newaxis])</div>
<div class="line"><span class="lineno">  556</span>    assert_almost_equal(clf1.l1_ratio_, clf2.l1_ratio_)</div>
<div class="line"><span class="lineno">  557</span>    assert_almost_equal(clf1.alpha_, clf2.alpha_)</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a58d899bdc2dc6d3458b1d274e6b26e22" name="a58d899bdc2dc6d3458b1d274e6b26e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58d899bdc2dc6d3458b1d274e6b26e22">&#9670;&#160;</a></span>test_enet_path_positive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_path_positive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  957</span><span class="keyword">def </span>test_enet_path_positive():</div>
<div class="line"><span class="lineno">  958</span>    <span class="comment"># Test positive parameter</span></div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>    X, Y, _, _ = build_dataset(n_samples=50, n_features=50, n_targets=2)</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>    <span class="comment"># For mono output</span></div>
<div class="line"><span class="lineno">  963</span>    <span class="comment"># Test that the coefs returned by positive=True in enet_path are positive</span></div>
<div class="line"><span class="lineno">  964</span>    <span class="keywordflow">for</span> path <span class="keywordflow">in</span> [enet_path, lasso_path]:</div>
<div class="line"><span class="lineno">  965</span>        pos_path_coef = path(X, Y[:, 0], positive=<span class="keyword">True</span>)[1]</div>
<div class="line"><span class="lineno">  966</span>        <span class="keyword">assert</span> np.all(pos_path_coef &gt;= 0)</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>    <span class="comment"># For multi output, positive parameter is not allowed</span></div>
<div class="line"><span class="lineno">  969</span>    <span class="comment"># Test that an error is raised</span></div>
<div class="line"><span class="lineno">  970</span>    <span class="keywordflow">for</span> path <span class="keywordflow">in</span> [enet_path, lasso_path]:</div>
<div class="line"><span class="lineno">  971</span>        <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  972</span>            path(X, Y, positive=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5f379542b6c85fe4b9b38c40450741d" name="ad5f379542b6c85fe4b9b38c40450741d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5f379542b6c85fe4b9b38c40450741d">&#9670;&#160;</a></span>test_enet_positive_constraint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_positive_constraint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  609</span><span class="keyword">def </span>test_enet_positive_constraint():</div>
<div class="line"><span class="lineno">  610</span>    X = [[-1], [0], [1]]</div>
<div class="line"><span class="lineno">  611</span>    y = [1, 0, -1]  <span class="comment"># just a straight line with negative slope</span></div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    enet = ElasticNet(alpha=0.1, positive=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  614</span>    enet.fit(X, y)</div>
<div class="line"><span class="lineno">  615</span>    <span class="keyword">assert</span> min(enet.coef_) &gt;= 0</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adfead455166cddd92c9e0f4edccc27ef" name="adfead455166cddd92c9e0f4edccc27ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfead455166cddd92c9e0f4edccc27ef">&#9670;&#160;</a></span>test_enet_ridge_consistency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_ridge_consistency </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ridge_alpha</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1523</span><span class="keyword">def </span>test_enet_ridge_consistency(ridge_alpha):</div>
<div class="line"><span class="lineno"> 1524</span>    <span class="comment"># Check that ElasticNet(l1_ratio=0) converges to the same solution as Ridge</span></div>
<div class="line"><span class="lineno"> 1525</span>    <span class="comment"># provided that the value of alpha is adapted.</span></div>
<div class="line"><span class="lineno"> 1526</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno"> 1527</span>    <span class="comment"># XXX: this test does not pass for weaker regularization (lower values of</span></div>
<div class="line"><span class="lineno"> 1528</span>    <span class="comment"># ridge_alpha): it could be either a problem of ElasticNet or Ridge (less</span></div>
<div class="line"><span class="lineno"> 1529</span>    <span class="comment"># likely) and depends on the dataset statistics: lower values for</span></div>
<div class="line"><span class="lineno"> 1530</span>    <span class="comment"># effective_rank are more problematic in particular.</span></div>
<div class="line"><span class="lineno"> 1531</span> </div>
<div class="line"><span class="lineno"> 1532</span>    rng = np.random.RandomState(42)</div>
<div class="line"><span class="lineno"> 1533</span>    n_samples = 300</div>
<div class="line"><span class="lineno"> 1534</span>    X, y = make_regression(</div>
<div class="line"><span class="lineno"> 1535</span>        n_samples=n_samples,</div>
<div class="line"><span class="lineno"> 1536</span>        n_features=100,</div>
<div class="line"><span class="lineno"> 1537</span>        effective_rank=10,</div>
<div class="line"><span class="lineno"> 1538</span>        n_informative=50,</div>
<div class="line"><span class="lineno"> 1539</span>        random_state=rng,</div>
<div class="line"><span class="lineno"> 1540</span>    )</div>
<div class="line"><span class="lineno"> 1541</span>    sw = rng.uniform(low=0.01, high=10, size=X.shape[0])</div>
<div class="line"><span class="lineno"> 1542</span>    alpha = 1.0</div>
<div class="line"><span class="lineno"> 1543</span>    common_params = dict(</div>
<div class="line"><span class="lineno"> 1544</span>        tol=1e-12,</div>
<div class="line"><span class="lineno"> 1545</span>    )</div>
<div class="line"><span class="lineno"> 1546</span>    ridge = Ridge(alpha=alpha, **common_params).fit(X, y, sample_weight=sw)</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>    alpha_enet = alpha / sw.sum()</div>
<div class="line"><span class="lineno"> 1549</span>    enet = ElasticNet(alpha=alpha_enet, l1_ratio=0, **common_params).fit(</div>
<div class="line"><span class="lineno"> 1550</span>        X, y, sample_weight=sw</div>
<div class="line"><span class="lineno"> 1551</span>    )</div>
<div class="line"><span class="lineno"> 1552</span>    assert_allclose(ridge.coef_, enet.coef_)</div>
<div class="line"><span class="lineno"> 1553</span>    assert_allclose(ridge.intercept_, enet.intercept_)</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span> </div>
<div class="line"><span class="lineno"> 1556</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1557</span>    <span class="stringliteral">&quot;estimator&quot;</span>,</div>
<div class="line"><span class="lineno"> 1558</span>    [</div>
<div class="line"><span class="lineno"> 1559</span>        Lasso(alpha=1.0),</div>
<div class="line"><span class="lineno"> 1560</span>        ElasticNet(alpha=1.0, l1_ratio=0.1),</div>
<div class="line"><span class="lineno"> 1561</span>    ],</div>
<div class="line"><span class="lineno"> 1562</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a474e463527101866a0158670893aca4d" name="a474e463527101866a0158670893aca4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a474e463527101866a0158670893aca4d">&#9670;&#160;</a></span>test_enet_sample_weight_consistency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_sample_weight_consistency </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fit_intercept</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precompute</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparseX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that the impact of sample_weight is consistent.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1274</span><span class="keyword">def </span>test_enet_sample_weight_consistency(fit_intercept, alpha, precompute, sparseX):</div>
<div class="line"><span class="lineno"> 1275</span>    <span class="stringliteral">&quot;&quot;&quot;Test that the impact of sample_weight is consistent.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1276</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1277</span>    n_samples, n_features = 10, 5</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno"> 1280</span>    y = rng.rand(n_samples)</div>
<div class="line"><span class="lineno"> 1281</span>    <span class="keywordflow">if</span> sparseX:</div>
<div class="line"><span class="lineno"> 1282</span>        X = sparse.csc_matrix(X)</div>
<div class="line"><span class="lineno"> 1283</span>    params = dict(</div>
<div class="line"><span class="lineno"> 1284</span>        alpha=alpha,</div>
<div class="line"><span class="lineno"> 1285</span>        fit_intercept=fit_intercept,</div>
<div class="line"><span class="lineno"> 1286</span>        precompute=precompute,</div>
<div class="line"><span class="lineno"> 1287</span>        tol=1e-6,</div>
<div class="line"><span class="lineno"> 1288</span>        l1_ratio=0.5,</div>
<div class="line"><span class="lineno"> 1289</span>    )</div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span>    reg = ElasticNet(**params).fit(X, y)</div>
<div class="line"><span class="lineno"> 1292</span>    coef = reg.coef_.copy()</div>
<div class="line"><span class="lineno"> 1293</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1294</span>        intercept = reg.intercept_</div>
<div class="line"><span class="lineno"> 1295</span> </div>
<div class="line"><span class="lineno"> 1296</span>    <span class="comment"># sample_weight=np.ones(..) should be equivalent to sample_weight=None</span></div>
<div class="line"><span class="lineno"> 1297</span>    sample_weight = np.ones_like(y)</div>
<div class="line"><span class="lineno"> 1298</span>    reg.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1299</span>    assert_allclose(reg.coef_, coef, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1300</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1301</span>        assert_allclose(reg.intercept_, intercept)</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span>    <span class="comment"># sample_weight=None should be equivalent to sample_weight = number</span></div>
<div class="line"><span class="lineno"> 1304</span>    sample_weight = 123.0</div>
<div class="line"><span class="lineno"> 1305</span>    reg.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1306</span>    assert_allclose(reg.coef_, coef, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1307</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1308</span>        assert_allclose(reg.intercept_, intercept)</div>
<div class="line"><span class="lineno"> 1309</span> </div>
<div class="line"><span class="lineno"> 1310</span>    <span class="comment"># scaling of sample_weight should have no effect, cf. np.average()</span></div>
<div class="line"><span class="lineno"> 1311</span>    sample_weight = 2 * np.ones_like(y)</div>
<div class="line"><span class="lineno"> 1312</span>    reg.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1313</span>    assert_allclose(reg.coef_, coef, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1314</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1315</span>        assert_allclose(reg.intercept_, intercept)</div>
<div class="line"><span class="lineno"> 1316</span> </div>
<div class="line"><span class="lineno"> 1317</span>    <span class="comment"># setting one element of sample_weight to 0 is equivalent to removing</span></div>
<div class="line"><span class="lineno"> 1318</span>    <span class="comment"># the corresponding sample</span></div>
<div class="line"><span class="lineno"> 1319</span>    sample_weight = np.ones_like(y)</div>
<div class="line"><span class="lineno"> 1320</span>    sample_weight[-1] = 0</div>
<div class="line"><span class="lineno"> 1321</span>    reg.fit(X, y, sample_weight=sample_weight)</div>
<div class="line"><span class="lineno"> 1322</span>    coef1 = reg.coef_.copy()</div>
<div class="line"><span class="lineno"> 1323</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1324</span>        intercept1 = reg.intercept_</div>
<div class="line"><span class="lineno"> 1325</span>    reg.fit(X[:-1], y[:-1])</div>
<div class="line"><span class="lineno"> 1326</span>    assert_allclose(reg.coef_, coef1, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1327</span>    <span class="keywordflow">if</span> fit_intercept:</div>
<div class="line"><span class="lineno"> 1328</span>        assert_allclose(reg.intercept_, intercept1)</div>
<div class="line"><span class="lineno"> 1329</span> </div>
<div class="line"><span class="lineno"> 1330</span>    <span class="comment"># check that multiplying sample_weight by 2 is equivalent</span></div>
<div class="line"><span class="lineno"> 1331</span>    <span class="comment"># to repeating corresponding samples twice</span></div>
<div class="line"><span class="lineno"> 1332</span>    <span class="keywordflow">if</span> sparseX:</div>
<div class="line"><span class="lineno"> 1333</span>        X2 = sparse.vstack([X, X[: n_samples // 2]], format=<span class="stringliteral">&quot;csc&quot;</span>)</div>
<div class="line"><span class="lineno"> 1334</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1335</span>        X2 = np.concatenate([X, X[: n_samples // 2]], axis=0)</div>
<div class="line"><span class="lineno"> 1336</span>    y2 = np.concatenate([y, y[: n_samples // 2]])</div>
<div class="line"><span class="lineno"> 1337</span>    sample_weight_1 = np.ones(len(y))</div>
<div class="line"><span class="lineno"> 1338</span>    sample_weight_1[: n_samples // 2] = 2</div>
<div class="line"><span class="lineno"> 1339</span> </div>
<div class="line"><span class="lineno"> 1340</span>    reg1 = ElasticNet(**params).fit(X, y, sample_weight=sample_weight_1)</div>
<div class="line"><span class="lineno"> 1341</span> </div>
<div class="line"><span class="lineno"> 1342</span>    reg2 = ElasticNet(**params).fit(X2, y2, sample_weight=<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1343</span>    assert_allclose(reg1.coef_, reg2.coef_, rtol=1e-6)</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span><span class="preprocessor">@pytest.mark.parametrize(&quot;fit_intercept&quot;, [True, False])</span></div>
<div class="line"><span class="lineno"> 1347</span><span class="preprocessor">@pytest.mark.parametrize(&quot;sparseX&quot;, [False, True])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6174e97b0a1e2631320c0922823ee29a" name="a6174e97b0a1e2631320c0922823ee29a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6174e97b0a1e2631320c0922823ee29a">&#9670;&#160;</a></span>test_enet_sample_weight_does_not_overwrite_sample_weight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_sample_weight_does_not_overwrite_sample_weight </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check_input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that ElasticNet does not overwrite sample_weights.</pre> <div class="fragment"><div class="line"><span class="lineno"> 1504</span><span class="keyword">def </span>test_enet_sample_weight_does_not_overwrite_sample_weight(check_input):</div>
<div class="line"><span class="lineno"> 1505</span>    <span class="stringliteral">&quot;&quot;&quot;Check that ElasticNet does not overwrite sample_weights.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1506</span> </div>
<div class="line"><span class="lineno"> 1507</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1508</span>    n_samples, n_features = 10, 5</div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span>    X = rng.rand(n_samples, n_features)</div>
<div class="line"><span class="lineno"> 1511</span>    y = rng.rand(n_samples)</div>
<div class="line"><span class="lineno"> 1512</span> </div>
<div class="line"><span class="lineno"> 1513</span>    sample_weight_1_25 = 1.25 * np.ones_like(y)</div>
<div class="line"><span class="lineno"> 1514</span>    sample_weight = sample_weight_1_25.copy()</div>
<div class="line"><span class="lineno"> 1515</span> </div>
<div class="line"><span class="lineno"> 1516</span>    reg = ElasticNet()</div>
<div class="line"><span class="lineno"> 1517</span>    reg.fit(X, y, sample_weight=sample_weight, check_input=check_input)</div>
<div class="line"><span class="lineno"> 1518</span> </div>
<div class="line"><span class="lineno"> 1519</span>    assert_array_equal(sample_weight, sample_weight_1_25)</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span> </div>
<div class="line"><span class="lineno"> 1522</span><span class="preprocessor">@pytest.mark.parametrize(&quot;ridge_alpha&quot;, [1e-1, 1.0, 1e6])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dda18d3213411a2cce30f6888e6fb92" name="a1dda18d3213411a2cce30f6888e6fb92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dda18d3213411a2cce30f6888e6fb92">&#9670;&#160;</a></span>test_enet_toy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_enet_toy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  161</span><span class="keyword">def </span>test_enet_toy():</div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># Test ElasticNet for various parameters of alpha and l1_ratio.</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="comment"># Actually, the parameters alpha = 0 should not be allowed. However,</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="comment"># we test it as a border case.</span></div>
<div class="line"><span class="lineno">  165</span>    <span class="comment"># ElasticNet is tested with and without precomputed Gram matrix</span></div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    X = np.array([[-1.0], [0.0], [1.0]])</div>
<div class="line"><span class="lineno">  168</span>    Y = [-1, 0, 1]  <span class="comment"># just a straight line</span></div>
<div class="line"><span class="lineno">  169</span>    T = [[2.0], [3.0], [4.0]]  <span class="comment"># test sample</span></div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <span class="comment"># this should be the same as lasso</span></div>
<div class="line"><span class="lineno">  172</span>    clf = ElasticNet(alpha=1e-8, l1_ratio=1.0)</div>
<div class="line"><span class="lineno">  173</span>    clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  174</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  175</span>    assert_array_almost_equal(clf.coef_, [1])</div>
<div class="line"><span class="lineno">  176</span>    assert_array_almost_equal(pred, [2, 3, 4])</div>
<div class="line"><span class="lineno">  177</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    clf = ElasticNet(alpha=0.5, l1_ratio=0.3, max_iter=100, precompute=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  180</span>    clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  181</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  182</span>    assert_array_almost_equal(clf.coef_, [0.50819], decimal=3)</div>
<div class="line"><span class="lineno">  183</span>    assert_array_almost_equal(pred, [1.0163, 1.5245, 2.0327], decimal=3)</div>
<div class="line"><span class="lineno">  184</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    clf.set_params(max_iter=100, precompute=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  187</span>    clf.fit(X, Y)  <span class="comment"># with Gram</span></div>
<div class="line"><span class="lineno">  188</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  189</span>    assert_array_almost_equal(clf.coef_, [0.50819], decimal=3)</div>
<div class="line"><span class="lineno">  190</span>    assert_array_almost_equal(pred, [1.0163, 1.5245, 2.0327], decimal=3)</div>
<div class="line"><span class="lineno">  191</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    clf.set_params(max_iter=100, precompute=np.dot(X.T, X))</div>
<div class="line"><span class="lineno">  194</span>    clf.fit(X, Y)  <span class="comment"># with Gram</span></div>
<div class="line"><span class="lineno">  195</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  196</span>    assert_array_almost_equal(clf.coef_, [0.50819], decimal=3)</div>
<div class="line"><span class="lineno">  197</span>    assert_array_almost_equal(pred, [1.0163, 1.5245, 2.0327], decimal=3)</div>
<div class="line"><span class="lineno">  198</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    clf = ElasticNet(alpha=0.5, l1_ratio=0.5)</div>
<div class="line"><span class="lineno">  201</span>    clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  202</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  203</span>    assert_array_almost_equal(clf.coef_, [0.45454], 3)</div>
<div class="line"><span class="lineno">  204</span>    assert_array_almost_equal(pred, [0.9090, 1.3636, 1.8181], 3)</div>
<div class="line"><span class="lineno">  205</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="accb45b671515434fa8e126db0c576e7d" name="accb45b671515434fa8e126db0c576e7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accb45b671515434fa8e126db0c576e7d">&#9670;&#160;</a></span>test_lasso_alpha_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_alpha_warning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  582</span><span class="keyword">def </span>test_lasso_alpha_warning():</div>
<div class="line"><span class="lineno">  583</span>    X = [[-1], [0], [1]]</div>
<div class="line"><span class="lineno">  584</span>    Y = [-1, 0, 1]  <span class="comment"># just a straight line</span></div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    clf = Lasso(alpha=0)</div>
<div class="line"><span class="lineno">  587</span>    warning_message = (</div>
<div class="line"><span class="lineno">  588</span>        <span class="stringliteral">&quot;With alpha=0, this algorithm does not &quot;</span></div>
<div class="line"><span class="lineno">  589</span>        <span class="stringliteral">&quot;converge well. You are advised to use the &quot;</span></div>
<div class="line"><span class="lineno">  590</span>        <span class="stringliteral">&quot;LinearRegression estimator&quot;</span></div>
<div class="line"><span class="lineno">  591</span>    )</div>
<div class="line"><span class="lineno">  592</span>    <span class="keyword">with</span> pytest.warns(UserWarning, match=warning_message):</div>
<div class="line"><span class="lineno">  593</span>        clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a06c88f8cc498559ce849b7b3f285543d" name="a06c88f8cc498559ce849b7b3f285543d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c88f8cc498559ce849b7b3f285543d">&#9670;&#160;</a></span>test_lasso_cv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_cv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  244</span><span class="keyword">def </span>test_lasso_cv():</div>
<div class="line"><span class="lineno">  245</span>    X, y, X_test, y_test = build_dataset()</div>
<div class="line"><span class="lineno">  246</span>    max_iter = 150</div>
<div class="line"><span class="lineno">  247</span>    clf = LassoCV(n_alphas=10, eps=1e-3, max_iter=max_iter, cv=3).fit(X, y)</div>
<div class="line"><span class="lineno">  248</span>    assert_almost_equal(clf.alpha_, 0.056, 2)</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    clf = LassoCV(n_alphas=10, eps=1e-3, max_iter=max_iter, precompute=<span class="keyword">True</span>, cv=3)</div>
<div class="line"><span class="lineno">  251</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  252</span>    assert_almost_equal(clf.alpha_, 0.056, 2)</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    <span class="comment"># Check that the lars and the coordinate descent implementation</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="comment"># select a similar alpha</span></div>
<div class="line"><span class="lineno">  256</span>    lars = LassoLarsCV(max_iter=30, cv=3).fit(X, y)</div>
<div class="line"><span class="lineno">  257</span>    <span class="comment"># for this we check that they don&#39;t fall in the grid of</span></div>
<div class="line"><span class="lineno">  258</span>    <span class="comment"># clf.alphas further than 1</span></div>
<div class="line"><span class="lineno">  259</span>    <span class="keyword">assert</span> (</div>
<div class="line"><span class="lineno">  260</span>        np.abs(</div>
<div class="line"><span class="lineno">  261</span>            np.searchsorted(clf.alphas_[::-1], lars.alpha_)</div>
<div class="line"><span class="lineno">  262</span>            - np.searchsorted(clf.alphas_[::-1], clf.alpha_)</div>
<div class="line"><span class="lineno">  263</span>        )</div>
<div class="line"><span class="lineno">  264</span>        &lt;= 1</div>
<div class="line"><span class="lineno">  265</span>    )</div>
<div class="line"><span class="lineno">  266</span>    <span class="comment"># check that they also give a similar MSE</span></div>
<div class="line"><span class="lineno">  267</span>    mse_lars = interpolate.interp1d(lars.cv_alphas_, lars.mse_path_.T)</div>
<div class="line"><span class="lineno">  268</span>    np.testing.assert_approx_equal(</div>
<div class="line"><span class="lineno">  269</span>        mse_lars(clf.alphas_[5]).mean(), clf.mse_path_[5].mean(), significant=2</div>
<div class="line"><span class="lineno">  270</span>    )</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>    <span class="comment"># test set</span></div>
<div class="line"><span class="lineno">  273</span>    <span class="keyword">assert</span> clf.score(X_test, y_test) &gt; 0.99</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0079cf4c5296aae50e9117c150880ab" name="ab0079cf4c5296aae50e9117c150880ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0079cf4c5296aae50e9117c150880ab">&#9670;&#160;</a></span>test_lasso_cv_positive_constraint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_cv_positive_constraint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  288</span><span class="keyword">def </span>test_lasso_cv_positive_constraint():</div>
<div class="line"><span class="lineno">  289</span>    X, y, X_test, y_test = build_dataset()</div>
<div class="line"><span class="lineno">  290</span>    max_iter = 500</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>    <span class="comment"># Ensure the unconstrained fit has a negative coefficient</span></div>
<div class="line"><span class="lineno">  293</span>    clf_unconstrained = LassoCV(n_alphas=3, eps=1e-1, max_iter=max_iter, cv=2, n_jobs=1)</div>
<div class="line"><span class="lineno">  294</span>    clf_unconstrained.fit(X, y)</div>
<div class="line"><span class="lineno">  295</span>    <span class="keyword">assert</span> min(clf_unconstrained.coef_) &lt; 0</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="comment"># On same data, constrained fit has non-negative coefficients</span></div>
<div class="line"><span class="lineno">  298</span>    clf_constrained = LassoCV(</div>
<div class="line"><span class="lineno">  299</span>        n_alphas=3, eps=1e-1, max_iter=max_iter, positive=<span class="keyword">True</span>, cv=2, n_jobs=1</div>
<div class="line"><span class="lineno">  300</span>    )</div>
<div class="line"><span class="lineno">  301</span>    clf_constrained.fit(X, y)</div>
<div class="line"><span class="lineno">  302</span>    <span class="keyword">assert</span> min(clf_constrained.coef_) &gt;= 0</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  306</span>    <span class="stringliteral">&quot;alphas, err_type, err_msg&quot;</span>,</div>
<div class="line"><span class="lineno">  307</span>    [</div>
<div class="line"><span class="lineno">  308</span>        ((1, -1, -100), ValueError, <span class="stringliteral">r&quot;alphas\[1\] == -1, must be &gt;= 0.0.&quot;</span>),</div>
<div class="line"><span class="lineno">  309</span>        (</div>
<div class="line"><span class="lineno">  310</span>            (-0.1, -1.0, -10.0),</div>
<div class="line"><span class="lineno">  311</span>            ValueError,</div>
<div class="line"><span class="lineno">  312</span>            <span class="stringliteral">r&quot;alphas\[0\] == -0.1, must be &gt;= 0.0.&quot;</span>,</div>
<div class="line"><span class="lineno">  313</span>        ),</div>
<div class="line"><span class="lineno">  314</span>        (</div>
<div class="line"><span class="lineno">  315</span>            (1, 1.0, <span class="stringliteral">&quot;1&quot;</span>),</div>
<div class="line"><span class="lineno">  316</span>            TypeError,</div>
<div class="line"><span class="lineno">  317</span>            <span class="stringliteral">r&quot;alphas\[2\] must be an instance of float, not str&quot;</span>,</div>
<div class="line"><span class="lineno">  318</span>        ),</div>
<div class="line"><span class="lineno">  319</span>    ],</div>
<div class="line"><span class="lineno">  320</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa09b54d63e0d32ddd227647563b631a" name="aaa09b54d63e0d32ddd227647563b631a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa09b54d63e0d32ddd227647563b631a">&#9670;&#160;</a></span>test_lasso_cv_with_some_model_selection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_cv_with_some_model_selection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  276</span><span class="keyword">def </span>test_lasso_cv_with_some_model_selection():</div>
<div class="line"><span class="lineno">  277</span>    <span class="keyword">from</span> <a class="code hl_namespace" href="namespacesklearn_1_1model__selection.html">sklearn.model_selection</a> <span class="keyword">import</span> ShuffleSplit</div>
<div class="line"><span class="lineno">  278</span>    <span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>    diabetes = datasets.load_diabetes()</div>
<div class="line"><span class="lineno">  281</span>    X = diabetes.data</div>
<div class="line"><span class="lineno">  282</span>    y = diabetes.target</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    pipe = make_pipeline(StandardScaler(), LassoCV(cv=ShuffleSplit(random_state=0)))</div>
<div class="line"><span class="lineno">  285</span>    pipe.fit(X, y)</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="ttc" id="anamespacesklearn_1_1model__selection_html"><div class="ttname"><a href="namespacesklearn_1_1model__selection.html">sklearn.model_selection</a></div><div class="ttdef"><b>Definition</b> __init__.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94ac7d05f2eea9c8ae8a31d85cdb9bc8" name="a94ac7d05f2eea9c8ae8a31d85cdb9bc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ac7d05f2eea9c8ae8a31d85cdb9bc8">&#9670;&#160;</a></span>test_lasso_dual_gap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_dual_gap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that Lasso.dual_gap_ matches its objective formulation, with the
datafit normalized by n_samples
</pre> <div class="fragment"><div class="line"><span class="lineno">  208</span><span class="keyword">def </span>test_lasso_dual_gap():</div>
<div class="line"><span class="lineno">  209</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    Check that Lasso.dual_gap_ matches its objective formulation, with the</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    datafit normalized by n_samples</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  213</span>    X, y, _, _ = build_dataset(n_samples=10, n_features=30)</div>
<div class="line"><span class="lineno">  214</span>    n_samples = len(y)</div>
<div class="line"><span class="lineno">  215</span>    alpha = 0.01 * np.max(np.abs(X.T @ y)) / n_samples</div>
<div class="line"><span class="lineno">  216</span>    clf = Lasso(alpha=alpha, fit_intercept=<span class="keyword">False</span>).fit(X, y)</div>
<div class="line"><span class="lineno">  217</span>    w = clf.coef_</div>
<div class="line"><span class="lineno">  218</span>    R = y - X @ w</div>
<div class="line"><span class="lineno">  219</span>    primal = 0.5 * np.mean(R**2) + clf.alpha * np.sum(np.abs(w))</div>
<div class="line"><span class="lineno">  220</span>    <span class="comment"># dual pt: R / n_samples, dual constraint: norm(X.T @ theta, inf) &lt;= alpha</span></div>
<div class="line"><span class="lineno">  221</span>    R /= np.max(np.abs(X.T @ R) / (n_samples * alpha))</div>
<div class="line"><span class="lineno">  222</span>    dual = 0.5 * (np.mean(y**2) - np.mean((y - R) ** 2))</div>
<div class="line"><span class="lineno">  223</span>    assert_allclose(clf.dual_gap_, primal - dual)</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aab0545b9bf6ee912c2dc90d39249782e" name="aab0545b9bf6ee912c2dc90d39249782e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab0545b9bf6ee912c2dc90d39249782e">&#9670;&#160;</a></span>test_lasso_non_float_y()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_non_float_y </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1052</span><span class="keyword">def </span>test_lasso_non_float_y(model):</div>
<div class="line"><span class="lineno"> 1053</span>    X = [[0, 0], [1, 1], [-1, -1]]</div>
<div class="line"><span class="lineno"> 1054</span>    y = [0, 1, 2]</div>
<div class="line"><span class="lineno"> 1055</span>    y_float = [0.0, 1.0, 2.0]</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>    clf = model(fit_intercept=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1058</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno"> 1059</span>    clf_float = model(fit_intercept=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1060</span>    clf_float.fit(X, y_float)</div>
<div class="line"><span class="lineno"> 1061</span>    assert_array_equal(clf.coef_, clf_float.coef_)</div>
<div class="line"><span class="lineno"> 1062</span> </div>
<div class="line"><span class="lineno"> 1063</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e5647f9b756cbba013725b7bef0e903" name="a8e5647f9b756cbba013725b7bef0e903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e5647f9b756cbba013725b7bef0e903">&#9670;&#160;</a></span>test_lasso_path_return_models_vs_new_return_gives_same_coefficients()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_path_return_models_vs_new_return_gives_same_coefficients </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  471</span><span class="keyword">def </span>test_lasso_path_return_models_vs_new_return_gives_same_coefficients():</div>
<div class="line"><span class="lineno">  472</span>    <span class="comment"># Test that lasso_path with lars_path style output gives the</span></div>
<div class="line"><span class="lineno">  473</span>    <span class="comment"># same result</span></div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="comment"># Some toy data</span></div>
<div class="line"><span class="lineno">  476</span>    X = np.array([[1, 2, 3.1], [2.3, 5.4, 4.3]]).T</div>
<div class="line"><span class="lineno">  477</span>    y = np.array([1, 2, 3.1])</div>
<div class="line"><span class="lineno">  478</span>    alphas = [5.0, 1.0, 0.5]</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="comment"># Use lars_path and lasso_path(new output) with 1D linear interpolation</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="comment"># to compute the same path</span></div>
<div class="line"><span class="lineno">  482</span>    alphas_lars, _, coef_path_lars = lars_path(X, y, method=<span class="stringliteral">&quot;lasso&quot;</span>)</div>
<div class="line"><span class="lineno">  483</span>    coef_path_cont_lars = interpolate.interp1d(</div>
<div class="line"><span class="lineno">  484</span>        alphas_lars[::-1], coef_path_lars[:, ::-1]</div>
<div class="line"><span class="lineno">  485</span>    )</div>
<div class="line"><span class="lineno">  486</span>    alphas_lasso2, coef_path_lasso2, _ = lasso_path(X, y, alphas=alphas)</div>
<div class="line"><span class="lineno">  487</span>    coef_path_cont_lasso = interpolate.interp1d(</div>
<div class="line"><span class="lineno">  488</span>        alphas_lasso2[::-1], coef_path_lasso2[:, ::-1]</div>
<div class="line"><span class="lineno">  489</span>    )</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    assert_array_almost_equal(</div>
<div class="line"><span class="lineno">  492</span>        coef_path_cont_lasso(alphas), coef_path_cont_lars(alphas), decimal=1</div>
<div class="line"><span class="lineno">  493</span>    )</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b817aa3200179f7e41bd0664e7296ff" name="a3b817aa3200179f7e41bd0664e7296ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b817aa3200179f7e41bd0664e7296ff">&#9670;&#160;</a></span>test_lasso_positive_constraint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_positive_constraint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  596</span><span class="keyword">def </span>test_lasso_positive_constraint():</div>
<div class="line"><span class="lineno">  597</span>    X = [[-1], [0], [1]]</div>
<div class="line"><span class="lineno">  598</span>    y = [1, 0, -1]  <span class="comment"># just a straight line with negative slope</span></div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>    lasso = Lasso(alpha=0.1, positive=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  601</span>    lasso.fit(X, y)</div>
<div class="line"><span class="lineno">  602</span>    <span class="keyword">assert</span> min(lasso.coef_) &gt;= 0</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>    lasso = Lasso(alpha=0.1, precompute=<span class="keyword">True</span>, positive=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  605</span>    lasso.fit(X, y)</div>
<div class="line"><span class="lineno">  606</span>    <span class="keyword">assert</span> min(lasso.coef_) &gt;= 0</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c0ceb478714224455b9a2167dcd1744" name="a8c0ceb478714224455b9a2167dcd1744"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c0ceb478714224455b9a2167dcd1744">&#9670;&#160;</a></span>test_lasso_readonly_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_readonly_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  689</span><span class="keyword">def </span>test_lasso_readonly_data():</div>
<div class="line"><span class="lineno">  690</span>    X = np.array([[-1], [0], [1]])</div>
<div class="line"><span class="lineno">  691</span>    Y = np.array([-1, 0, 1])  <span class="comment"># just a straight line</span></div>
<div class="line"><span class="lineno">  692</span>    T = np.array([[2], [3], [4]])  <span class="comment"># test sample</span></div>
<div class="line"><span class="lineno">  693</span>    <span class="keyword">with</span> TempMemmap((X, Y)) <span class="keyword">as</span> (X, Y):</div>
<div class="line"><span class="lineno">  694</span>        clf = Lasso(alpha=0.5)</div>
<div class="line"><span class="lineno">  695</span>        clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  696</span>        pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  697</span>        assert_array_almost_equal(clf.coef_, [0.25])</div>
<div class="line"><span class="lineno">  698</span>        assert_array_almost_equal(pred, [0.5, 0.75, 1.0])</div>
<div class="line"><span class="lineno">  699</span>        assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f6b8b7980f7f42481d92be9900e72cd" name="a9f6b8b7980f7f42481d92be9900e72cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f6b8b7980f7f42481d92be9900e72cd">&#9670;&#160;</a></span>test_lasso_toy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_toy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  123</span><span class="keyword">def </span>test_lasso_toy():</div>
<div class="line"><span class="lineno">  124</span>    <span class="comment"># Test Lasso on a toy example for various values of alpha.</span></div>
<div class="line"><span class="lineno">  125</span>    <span class="comment"># When validating this against glmnet notice that glmnet divides it</span></div>
<div class="line"><span class="lineno">  126</span>    <span class="comment"># against nobs.</span></div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    X = [[-1], [0], [1]]</div>
<div class="line"><span class="lineno">  129</span>    Y = [-1, 0, 1]  <span class="comment"># just a straight line</span></div>
<div class="line"><span class="lineno">  130</span>    T = [[2], [3], [4]]  <span class="comment"># test sample</span></div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    clf = Lasso(alpha=1e-8)</div>
<div class="line"><span class="lineno">  133</span>    clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  134</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  135</span>    assert_array_almost_equal(clf.coef_, [1])</div>
<div class="line"><span class="lineno">  136</span>    assert_array_almost_equal(pred, [2, 3, 4])</div>
<div class="line"><span class="lineno">  137</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    clf = Lasso(alpha=0.1)</div>
<div class="line"><span class="lineno">  140</span>    clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  141</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  142</span>    assert_array_almost_equal(clf.coef_, [0.85])</div>
<div class="line"><span class="lineno">  143</span>    assert_array_almost_equal(pred, [1.7, 2.55, 3.4])</div>
<div class="line"><span class="lineno">  144</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    clf = Lasso(alpha=0.5)</div>
<div class="line"><span class="lineno">  147</span>    clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  148</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  149</span>    assert_array_almost_equal(clf.coef_, [0.25])</div>
<div class="line"><span class="lineno">  150</span>    assert_array_almost_equal(pred, [0.5, 0.75, 1.0])</div>
<div class="line"><span class="lineno">  151</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    clf = Lasso(alpha=1)</div>
<div class="line"><span class="lineno">  154</span>    clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  155</span>    pred = clf.predict(T)</div>
<div class="line"><span class="lineno">  156</span>    assert_array_almost_equal(clf.coef_, [0.0])</div>
<div class="line"><span class="lineno">  157</span>    assert_array_almost_equal(pred, [0, 0, 0])</div>
<div class="line"><span class="lineno">  158</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a57507179de32b89081c435bbc7d211e3" name="a57507179de32b89081c435bbc7d211e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57507179de32b89081c435bbc7d211e3">&#9670;&#160;</a></span>test_lasso_zero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lasso_zero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   97</span><span class="keyword">def </span>test_lasso_zero():</div>
<div class="line"><span class="lineno">   98</span>    <span class="comment"># Check that the lasso can handle zero data without crashing</span></div>
<div class="line"><span class="lineno">   99</span>    X = [[0], [0], [0]]</div>
<div class="line"><span class="lineno">  100</span>    y = [0, 0, 0]</div>
<div class="line"><span class="lineno">  101</span>    clf = Lasso(alpha=0.1).fit(X, y)</div>
<div class="line"><span class="lineno">  102</span>    pred = clf.predict([[1], [2], [3]])</div>
<div class="line"><span class="lineno">  103</span>    assert_array_almost_equal(clf.coef_, [0])</div>
<div class="line"><span class="lineno">  104</span>    assert_array_almost_equal(pred, [0, 0, 0])</div>
<div class="line"><span class="lineno">  105</span>    assert_almost_equal(clf.dual_gap_, 0)</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aefea7089f94e1f5c43e29a5deaaf97eb" name="aefea7089f94e1f5c43e29a5deaaf97eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefea7089f94e1f5c43e29a5deaaf97eb">&#9670;&#160;</a></span>test_lassocv_alphas_validation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lassocv_alphas_validation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alphas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>err_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>err_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the `alphas` validation in LassoCV.</pre> <div class="fragment"><div class="line"><span class="lineno">  321</span><span class="keyword">def </span>test_lassocv_alphas_validation(alphas, err_type, err_msg):</div>
<div class="line"><span class="lineno">  322</span>    <span class="stringliteral">&quot;&quot;&quot;Check the `alphas` validation in LassoCV.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    n_samples, n_features = 5, 5</div>
<div class="line"><span class="lineno">  325</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  326</span>    X = rng.randn(n_samples, n_features)</div>
<div class="line"><span class="lineno">  327</span>    y = rng.randint(0, 2, n_samples)</div>
<div class="line"><span class="lineno">  328</span>    lassocv = LassoCV(alphas=alphas)</div>
<div class="line"><span class="lineno">  329</span>    <span class="keyword">with</span> pytest.raises(err_type, match=err_msg):</div>
<div class="line"><span class="lineno">  330</span>        lassocv.fit(X, y)</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a3d43dd459f04af2343c70959cc79ca" name="a8a3d43dd459f04af2343c70959cc79ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3d43dd459f04af2343c70959cc79ca">&#9670;&#160;</a></span>test_lassoCV_does_not_set_precompute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_lassoCV_does_not_set_precompute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>monkeypatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precompute</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>inner_precompute</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1243</span><span class="keyword">def </span>test_lassoCV_does_not_set_precompute(monkeypatch, precompute, inner_precompute):</div>
<div class="line"><span class="lineno"> 1244</span>    X, y, _, _ = build_dataset()</div>
<div class="line"><span class="lineno"> 1245</span>    calls = 0</div>
<div class="line"><span class="lineno"> 1246</span> </div>
<div class="line"><span class="lineno"> 1247</span>    <span class="keyword">class </span>LassoMock(Lasso):</div>
<div class="line"><span class="lineno"> 1248</span>        <span class="keyword">def </span>fit(self, X, y):</div>
<div class="line"><span class="lineno"> 1249</span>            super().fit(X, y)</div>
<div class="line"><span class="lineno"> 1250</span>            nonlocal calls</div>
<div class="line"><span class="lineno"> 1251</span>            calls += 1</div>
<div class="line"><span class="lineno"> 1252</span>            <span class="keyword">assert</span> self.precompute == inner_precompute</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>    monkeypatch.setattr(<span class="stringliteral">&quot;sklearn.linear_model._coordinate_descent.Lasso&quot;</span>, LassoMock)</div>
<div class="line"><span class="lineno"> 1255</span>    clf = LassoCV(precompute=precompute)</div>
<div class="line"><span class="lineno"> 1256</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno"> 1257</span>    <span class="keyword">assert</span> calls &gt; 0</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a04a557152a0c56acc3553c492cc0989d" name="a04a557152a0c56acc3553c492cc0989d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04a557152a0c56acc3553c492cc0989d">&#9670;&#160;</a></span>test_linear_models_cv_fit_with_loky()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_linear_models_cv_fit_with_loky </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>estimator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1489</span><span class="keyword">def </span>test_linear_models_cv_fit_with_loky(estimator):</div>
<div class="line"><span class="lineno"> 1490</span>    <span class="comment"># LinearModelsCV.fit performs inplace operations on fancy-indexed memmapped</span></div>
<div class="line"><span class="lineno"> 1491</span>    <span class="comment"># data when using the loky backend, causing an error due to unexpected</span></div>
<div class="line"><span class="lineno"> 1492</span>    <span class="comment"># behavior of fancy indexing of read-only memmaps (cf. numpy#14132).</span></div>
<div class="line"><span class="lineno"> 1493</span> </div>
<div class="line"><span class="lineno"> 1494</span>    <span class="comment"># Create a problem sufficiently large to cause memmapping (1MB).</span></div>
<div class="line"><span class="lineno"> 1495</span>    <span class="comment"># Unfortunately the scikit-learn and joblib APIs do not make it possible to</span></div>
<div class="line"><span class="lineno"> 1496</span>    <span class="comment"># change the max_nbyte of the inner Parallel call.</span></div>
<div class="line"><span class="lineno"> 1497</span>    X, y = make_regression(int(1e6) // 8 + 1, 1)</div>
<div class="line"><span class="lineno"> 1498</span>    <span class="keyword">assert</span> X.nbytes &gt; 1e6  <span class="comment"># 1 MB</span></div>
<div class="line"><span class="lineno"> 1499</span>    <span class="keyword">with</span> <a class="code hl_class" href="classjoblib_1_1parallel_1_1parallel__backend.html">joblib.parallel_backend</a>(<span class="stringliteral">&quot;loky&quot;</span>):</div>
<div class="line"><span class="lineno"> 1500</span>        estimator(n_jobs=2, cv=3).fit(X, y)</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span> </div>
<div class="line"><span class="lineno"> 1503</span><span class="preprocessor">@pytest.mark.parametrize(&quot;check_input&quot;, [True, False])</span></div>
<div class="ttc" id="aclassjoblib_1_1parallel_1_1parallel__backend_html"><div class="ttname"><a href="classjoblib_1_1parallel_1_1parallel__backend.html">joblib.parallel.parallel_backend</a></div><div class="ttdef"><b>Definition</b> parallel.py:135</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ab2b5f76c72b10288a59e0b7dfccd57" name="a3ab2b5f76c72b10288a59e0b7dfccd57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ab2b5f76c72b10288a59e0b7dfccd57">&#9670;&#160;</a></span>test_model_pipeline_same_as_normalize_true()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_model_pipeline_same_as_normalize_true </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>LinearModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  376</span><span class="keyword">def </span>test_model_pipeline_same_as_normalize_true(LinearModel, params):</div>
<div class="line"><span class="lineno">  377</span>    <span class="comment"># Test that linear models (LinearModel) set with normalize set to True are</span></div>
<div class="line"><span class="lineno">  378</span>    <span class="comment"># doing the same as the same linear model preceded by StandardScaler</span></div>
<div class="line"><span class="lineno">  379</span>    <span class="comment"># in the pipeline and with normalize set to False</span></div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    <span class="comment"># normalize is True</span></div>
<div class="line"><span class="lineno">  382</span>    model_normalize = LinearModel(normalize=<span class="keyword">True</span>, fit_intercept=<span class="keyword">True</span>, **params)</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    pipeline = make_pipeline(</div>
<div class="line"><span class="lineno">  385</span>        StandardScaler(), LinearModel(normalize=<span class="keyword">False</span>, fit_intercept=<span class="keyword">True</span>, **params)</div>
<div class="line"><span class="lineno">  386</span>    )</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    is_multitask = model_normalize._get_tags()[<span class="stringliteral">&quot;multioutput_only&quot;</span>]</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="comment"># prepare the data</span></div>
<div class="line"><span class="lineno">  391</span>    n_samples, n_features = 100, 2</div>
<div class="line"><span class="lineno">  392</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  393</span>    w = rng.randn(n_features)</div>
<div class="line"><span class="lineno">  394</span>    X = rng.randn(n_samples, n_features)</div>
<div class="line"><span class="lineno">  395</span>    X += 20  <span class="comment"># make features non-zero mean</span></div>
<div class="line"><span class="lineno">  396</span>    y = X.dot(w)</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    <span class="comment"># make classes out of regression</span></div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordflow">if</span> is_classifier(model_normalize):</div>
<div class="line"><span class="lineno">  400</span>        y[y &gt; np.mean(y)] = -1</div>
<div class="line"><span class="lineno">  401</span>        y[y &gt; 0] = 1</div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordflow">if</span> is_multitask:</div>
<div class="line"><span class="lineno">  403</span>        y = np.stack((y, y), axis=1)</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>    X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    _scale_alpha_inplace(pipeline[1], X_train.shape[0])</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    model_normalize.fit(X_train, y_train)</div>
<div class="line"><span class="lineno">  410</span>    y_pred_normalize = model_normalize.predict(X_test)</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>    pipeline.fit(X_train, y_train)</div>
<div class="line"><span class="lineno">  413</span>    y_pred_standardize = pipeline.predict(X_test)</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>    assert_allclose(model_normalize.coef_ * pipeline[0].scale_, pipeline[1].coef_)</div>
<div class="line"><span class="lineno">  416</span>    <span class="keyword">assert</span> pipeline[1].intercept_ == pytest.approx(y_train.mean())</div>
<div class="line"><span class="lineno">  417</span>    <span class="keyword">assert</span> model_normalize.intercept_ == pytest.approx(</div>
<div class="line"><span class="lineno">  418</span>        y_train.mean() - model_normalize.coef_.dot(X_train.mean(0))</div>
<div class="line"><span class="lineno">  419</span>    )</div>
<div class="line"><span class="lineno">  420</span>    assert_allclose(y_pred_normalize, y_pred_standardize)</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno">  424</span>    <span class="stringliteral">&quot;LinearModel, params&quot;</span>,</div>
<div class="line"><span class="lineno">  425</span>    [</div>
<div class="line"><span class="lineno">  426</span>        (Lasso, {<span class="stringliteral">&quot;tol&quot;</span>: 1e-16, <span class="stringliteral">&quot;alpha&quot;</span>: 0.1}),</div>
<div class="line"><span class="lineno">  427</span>        (LassoCV, {<span class="stringliteral">&quot;tol&quot;</span>: 1e-16}),</div>
<div class="line"><span class="lineno">  428</span>        (ElasticNetCV, {}),</div>
<div class="line"><span class="lineno">  429</span>        (RidgeClassifier, {<span class="stringliteral">&quot;solver&quot;</span>: <span class="stringliteral">&quot;sparse_cg&quot;</span>, <span class="stringliteral">&quot;alpha&quot;</span>: 0.1}),</div>
<div class="line"><span class="lineno">  430</span>        (ElasticNet, {<span class="stringliteral">&quot;tol&quot;</span>: 1e-16, <span class="stringliteral">&quot;l1_ratio&quot;</span>: 1, <span class="stringliteral">&quot;alpha&quot;</span>: 0.01}),</div>
<div class="line"><span class="lineno">  431</span>        (ElasticNet, {<span class="stringliteral">&quot;tol&quot;</span>: 1e-16, <span class="stringliteral">&quot;l1_ratio&quot;</span>: 0, <span class="stringliteral">&quot;alpha&quot;</span>: 0.01}),</div>
<div class="line"><span class="lineno">  432</span>        (Ridge, {<span class="stringliteral">&quot;solver&quot;</span>: <span class="stringliteral">&quot;sparse_cg&quot;</span>, <span class="stringliteral">&quot;tol&quot;</span>: 1e-12, <span class="stringliteral">&quot;alpha&quot;</span>: 0.1}),</div>
<div class="line"><span class="lineno">  433</span>        (LinearRegression, {}),</div>
<div class="line"><span class="lineno">  434</span>        (RidgeCV, {}),</div>
<div class="line"><span class="lineno">  435</span>        (RidgeClassifierCV, {}),</div>
<div class="line"><span class="lineno">  436</span>    ],</div>
<div class="line"><span class="lineno">  437</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a03f515a9f2ff6195b462750a6ffe61" name="a6a03f515a9f2ff6195b462750a6ffe61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a03f515a9f2ff6195b462750a6ffe61">&#9670;&#160;</a></span>test_model_pipeline_same_dense_and_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_model_pipeline_same_dense_and_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>LinearModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  438</span><span class="keyword">def </span>test_model_pipeline_same_dense_and_sparse(LinearModel, params):</div>
<div class="line"><span class="lineno">  439</span>    <span class="comment"># Test that linear model preceded by StandardScaler in the pipeline and</span></div>
<div class="line"><span class="lineno">  440</span>    <span class="comment"># with normalize set to False gives the same y_pred and the same .coef_</span></div>
<div class="line"><span class="lineno">  441</span>    <span class="comment"># given X sparse or dense</span></div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    model_dense = make_pipeline(StandardScaler(with_mean=<span class="keyword">False</span>), LinearModel(**params))</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    model_sparse = make_pipeline(StandardScaler(with_mean=<span class="keyword">False</span>), LinearModel(**params))</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    <span class="comment"># prepare the data</span></div>
<div class="line"><span class="lineno">  448</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  449</span>    n_samples = 200</div>
<div class="line"><span class="lineno">  450</span>    n_features = 2</div>
<div class="line"><span class="lineno">  451</span>    X = rng.randn(n_samples, n_features)</div>
<div class="line"><span class="lineno">  452</span>    X[X &lt; 0.1] = 0.0</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    X_sparse = sparse.csr_matrix(X)</div>
<div class="line"><span class="lineno">  455</span>    y = rng.rand(n_samples)</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">if</span> is_classifier(model_dense):</div>
<div class="line"><span class="lineno">  458</span>        y = np.sign(y)</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    model_dense.fit(X, y)</div>
<div class="line"><span class="lineno">  461</span>    model_sparse.fit(X_sparse, y)</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    assert_allclose(model_sparse[1].coef_, model_dense[1].coef_)</div>
<div class="line"><span class="lineno">  464</span>    y_pred_dense = model_dense.predict(X)</div>
<div class="line"><span class="lineno">  465</span>    y_pred_sparse = model_sparse.predict(X_sparse)</div>
<div class="line"><span class="lineno">  466</span>    assert_allclose(y_pred_dense, y_pred_sparse)</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>    assert_allclose(model_dense[1].intercept_, model_sparse[1].intercept_)</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a57d8b34006129431e02f729f0d41e584" name="a57d8b34006129431e02f729f0d41e584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d8b34006129431e02f729f0d41e584">&#9670;&#160;</a></span>test_multi_task_lasso_and_enet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_multi_task_lasso_and_enet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  668</span><span class="keyword">def </span>test_multi_task_lasso_and_enet():</div>
<div class="line"><span class="lineno">  669</span>    X, y, X_test, y_test = build_dataset()</div>
<div class="line"><span class="lineno">  670</span>    Y = np.c_[y, y]</div>
<div class="line"><span class="lineno">  671</span>    <span class="comment"># Y_test = np.c_[y_test, y_test]</span></div>
<div class="line"><span class="lineno">  672</span>    clf = MultiTaskLasso(alpha=1, tol=1e-8).fit(X, Y)</div>
<div class="line"><span class="lineno">  673</span>    <span class="keyword">assert</span> 0 &lt; clf.dual_gap_ &lt; 1e-5</div>
<div class="line"><span class="lineno">  674</span>    assert_array_almost_equal(clf.coef_[0], clf.coef_[1])</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>    clf = MultiTaskElasticNet(alpha=1, tol=1e-8).fit(X, Y)</div>
<div class="line"><span class="lineno">  677</span>    <span class="keyword">assert</span> 0 &lt; clf.dual_gap_ &lt; 1e-5</div>
<div class="line"><span class="lineno">  678</span>    assert_array_almost_equal(clf.coef_[0], clf.coef_[1])</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>    clf = MultiTaskElasticNet(alpha=1.0, tol=1e-8, max_iter=1)</div>
<div class="line"><span class="lineno">  681</span>    warning_message = (</div>
<div class="line"><span class="lineno">  682</span>        <span class="stringliteral">&quot;Objective did not converge. You might want to &quot;</span></div>
<div class="line"><span class="lineno">  683</span>        <span class="stringliteral">&quot;increase the number of iterations.&quot;</span></div>
<div class="line"><span class="lineno">  684</span>    )</div>
<div class="line"><span class="lineno">  685</span>    <span class="keyword">with</span> pytest.warns(ConvergenceWarning, match=warning_message):</div>
<div class="line"><span class="lineno">  686</span>        clf.fit(X, Y)</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d8d914b4337c8e9065c17947c7ac6bc" name="a8d8d914b4337c8e9065c17947c7ac6bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d8d914b4337c8e9065c17947c7ac6bc">&#9670;&#160;</a></span>test_multi_task_lasso_cv_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_multi_task_lasso_cv_dtype </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1260</span><span class="keyword">def </span>test_multi_task_lasso_cv_dtype():</div>
<div class="line"><span class="lineno"> 1261</span>    n_samples, n_features = 10, 3</div>
<div class="line"><span class="lineno"> 1262</span>    rng = np.random.RandomState(42)</div>
<div class="line"><span class="lineno"> 1263</span>    X = rng.binomial(1, 0.5, size=(n_samples, n_features))</div>
<div class="line"><span class="lineno"> 1264</span>    X = X.astype(int)  <span class="comment"># make it explicit that X is int</span></div>
<div class="line"><span class="lineno"> 1265</span>    y = X[:, [0, 0]].copy()</div>
<div class="line"><span class="lineno"> 1266</span>    est = MultiTaskLassoCV(n_alphas=5, fit_intercept=<span class="keyword">True</span>).fit(X, y)</div>
<div class="line"><span class="lineno"> 1267</span>    assert_array_almost_equal(est.coef_, [[1, 0, 0]] * 2, decimal=3)</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span><span class="preprocessor">@pytest.mark.parametrize(&quot;fit_intercept&quot;, [True, False])</span></div>
<div class="line"><span class="lineno"> 1271</span><span class="preprocessor">@pytest.mark.parametrize(&quot;alpha&quot;, [0.01])</span></div>
<div class="line"><span class="lineno"> 1272</span><span class="preprocessor">@pytest.mark.parametrize(&quot;precompute&quot;, [False, True])</span></div>
<div class="line"><span class="lineno"> 1273</span><span class="preprocessor">@pytest.mark.parametrize(&quot;sparseX&quot;, [False, True])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e697b0d2a32abe7f5e61f1ad0c9c417" name="a1e697b0d2a32abe7f5e61f1ad0c9c417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e697b0d2a32abe7f5e61f1ad0c9c417">&#9670;&#160;</a></span>test_multi_task_lasso_readonly_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_multi_task_lasso_readonly_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  702</span><span class="keyword">def </span>test_multi_task_lasso_readonly_data():</div>
<div class="line"><span class="lineno">  703</span>    X, y, X_test, y_test = build_dataset()</div>
<div class="line"><span class="lineno">  704</span>    Y = np.c_[y, y]</div>
<div class="line"><span class="lineno">  705</span>    <span class="keyword">with</span> TempMemmap((X, Y)) <span class="keyword">as</span> (X, Y):</div>
<div class="line"><span class="lineno">  706</span>        Y = np.c_[y, y]</div>
<div class="line"><span class="lineno">  707</span>        clf = MultiTaskLasso(alpha=1, tol=1e-8).fit(X, Y)</div>
<div class="line"><span class="lineno">  708</span>        <span class="keyword">assert</span> 0 &lt; clf.dual_gap_ &lt; 1e-5</div>
<div class="line"><span class="lineno">  709</span>        assert_array_almost_equal(clf.coef_[0], clf.coef_[1])</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abe928ab2fd85bc0c94ba0d88b4a20c70" name="abe928ab2fd85bc0c94ba0d88b4a20c70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe928ab2fd85bc0c94ba0d88b4a20c70">&#9670;&#160;</a></span>test_multioutput_enetcv_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_multioutput_enetcv_error </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  732</span><span class="keyword">def </span>test_multioutput_enetcv_error():</div>
<div class="line"><span class="lineno">  733</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  734</span>    X = rng.randn(10, 2)</div>
<div class="line"><span class="lineno">  735</span>    y = rng.randn(10, 2)</div>
<div class="line"><span class="lineno">  736</span>    clf = ElasticNetCV()</div>
<div class="line"><span class="lineno">  737</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno">  738</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af170126f80c8be427fdb62bf95cfb9f7" name="af170126f80c8be427fdb62bf95cfb9f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af170126f80c8be427fdb62bf95cfb9f7">&#9670;&#160;</a></span>test_multitask_enet_and_lasso_cv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_multitask_enet_and_lasso_cv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  741</span><span class="keyword">def </span>test_multitask_enet_and_lasso_cv():</div>
<div class="line"><span class="lineno">  742</span>    X, y, _, _ = build_dataset(n_features=50, n_targets=3)</div>
<div class="line"><span class="lineno">  743</span>    clf = MultiTaskElasticNetCV(cv=3).fit(X, y)</div>
<div class="line"><span class="lineno">  744</span>    assert_almost_equal(clf.alpha_, 0.00556, 3)</div>
<div class="line"><span class="lineno">  745</span>    clf = MultiTaskLassoCV(cv=3).fit(X, y)</div>
<div class="line"><span class="lineno">  746</span>    assert_almost_equal(clf.alpha_, 0.00278, 3)</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>    X, y, _, _ = build_dataset(n_targets=3)</div>
<div class="line"><span class="lineno">  749</span>    clf = MultiTaskElasticNetCV(</div>
<div class="line"><span class="lineno">  750</span>        n_alphas=10, eps=1e-3, max_iter=100, l1_ratio=[0.3, 0.5], tol=1e-3, cv=3</div>
<div class="line"><span class="lineno">  751</span>    )</div>
<div class="line"><span class="lineno">  752</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  753</span>    <span class="keyword">assert</span> 0.5 == clf.l1_ratio_</div>
<div class="line"><span class="lineno">  754</span>    <span class="keyword">assert</span> (3, X.shape[1]) == clf.coef_.shape</div>
<div class="line"><span class="lineno">  755</span>    <span class="keyword">assert</span> (3,) == clf.intercept_.shape</div>
<div class="line"><span class="lineno">  756</span>    <span class="keyword">assert</span> (2, 10, 3) == clf.mse_path_.shape</div>
<div class="line"><span class="lineno">  757</span>    <span class="keyword">assert</span> (2, 10) == clf.alphas_.shape</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>    X, y, _, _ = build_dataset(n_targets=3)</div>
<div class="line"><span class="lineno">  760</span>    clf = MultiTaskLassoCV(n_alphas=10, eps=1e-3, max_iter=100, tol=1e-3, cv=3)</div>
<div class="line"><span class="lineno">  761</span>    clf.fit(X, y)</div>
<div class="line"><span class="lineno">  762</span>    <span class="keyword">assert</span> (3, X.shape[1]) == clf.coef_.shape</div>
<div class="line"><span class="lineno">  763</span>    <span class="keyword">assert</span> (3,) == clf.intercept_.shape</div>
<div class="line"><span class="lineno">  764</span>    <span class="keyword">assert</span> (10, 3) == clf.mse_path_.shape</div>
<div class="line"><span class="lineno">  765</span>    <span class="keyword">assert</span> 10 == len(clf.alphas_)</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a691d5a4dd8d1b518bfa3a023ef990513" name="a691d5a4dd8d1b518bfa3a023ef990513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691d5a4dd8d1b518bfa3a023ef990513">&#9670;&#160;</a></span>test_overrided_gram_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_overrided_gram_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1038</span><span class="keyword">def </span>test_overrided_gram_matrix():</div>
<div class="line"><span class="lineno"> 1039</span>    X, y, _, _ = build_dataset(n_samples=20, n_features=10)</div>
<div class="line"><span class="lineno"> 1040</span>    Gram = X.T.dot(X)</div>
<div class="line"><span class="lineno"> 1041</span>    clf = ElasticNet(selection=<span class="stringliteral">&quot;cyclic&quot;</span>, tol=1e-8, precompute=Gram)</div>
<div class="line"><span class="lineno"> 1042</span>    warning_message = (</div>
<div class="line"><span class="lineno"> 1043</span>        <span class="stringliteral">&quot;Gram matrix was provided but X was centered&quot;</span></div>
<div class="line"><span class="lineno"> 1044</span>        <span class="stringliteral">&quot; to fit intercept, &quot;</span></div>
<div class="line"><span class="lineno"> 1045</span>        <span class="stringliteral">&quot;or X was normalized : recomputing Gram matrix.&quot;</span></div>
<div class="line"><span class="lineno"> 1046</span>    )</div>
<div class="line"><span class="lineno"> 1047</span>    <span class="keyword">with</span> pytest.warns(UserWarning, match=warning_message):</div>
<div class="line"><span class="lineno"> 1048</span>        clf.fit(X, y)</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span> </div>
<div class="line"><span class="lineno"> 1051</span><span class="preprocessor">@pytest.mark.parametrize(&quot;model&quot;, [ElasticNet, Lasso])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a779af8d9dbb2efa8cf7c7e640bc09a44" name="a779af8d9dbb2efa8cf7c7e640bc09a44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779af8d9dbb2efa8cf7c7e640bc09a44">&#9670;&#160;</a></span>test_path_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_path_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  560</span><span class="keyword">def </span>test_path_parameters():</div>
<div class="line"><span class="lineno">  561</span>    X, y, _, _ = build_dataset()</div>
<div class="line"><span class="lineno">  562</span>    max_iter = 100</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    clf = ElasticNetCV(n_alphas=50, eps=1e-3, max_iter=max_iter, l1_ratio=0.5, tol=1e-3)</div>
<div class="line"><span class="lineno">  565</span>    clf.fit(X, y)  <span class="comment"># new params</span></div>
<div class="line"><span class="lineno">  566</span>    assert_almost_equal(0.5, clf.l1_ratio)</div>
<div class="line"><span class="lineno">  567</span>    <span class="keyword">assert</span> 50 == clf.n_alphas</div>
<div class="line"><span class="lineno">  568</span>    <span class="keyword">assert</span> 50 == len(clf.alphas_)</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a33d0110317995f4db21dd55b9448a943" name="a33d0110317995f4db21dd55b9448a943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33d0110317995f4db21dd55b9448a943">&#9670;&#160;</a></span>test_path_unknown_parameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_path_unknown_parameter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>path_func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that passing parameter not used by the coordinate descent solver
will raise an error.</pre> <div class="fragment"><div class="line"><span class="lineno">  986</span><span class="keyword">def </span>test_path_unknown_parameter(path_func):</div>
<div class="line"><span class="lineno">  987</span>    <span class="stringliteral">&quot;&quot;&quot;Check that passing parameter not used by the coordinate descent solver</span></div>
<div class="line"><span class="lineno">  988</span><span class="stringliteral">    will raise an error.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  989</span>    X, y, _, _ = build_dataset(n_samples=50, n_features=20)</div>
<div class="line"><span class="lineno">  990</span>    err_msg = <span class="stringliteral">&quot;Unexpected parameters in params&quot;</span></div>
<div class="line"><span class="lineno">  991</span>    <span class="keyword">with</span> pytest.raises(ValueError, match=err_msg):</div>
<div class="line"><span class="lineno">  992</span>        path_func(X, y, normalize=<span class="keyword">True</span>, fit_intercept=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fb8846fc1ec102cf77de54b2be09613" name="a4fb8846fc1ec102cf77de54b2be09613"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb8846fc1ec102cf77de54b2be09613">&#9670;&#160;</a></span>test_random_descent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_random_descent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  917</span><span class="keyword">def </span>test_random_descent():</div>
<div class="line"><span class="lineno">  918</span>    <span class="comment"># Test that both random and cyclic selection give the same results.</span></div>
<div class="line"><span class="lineno">  919</span>    <span class="comment"># Ensure that the test models fully converge and check a wide</span></div>
<div class="line"><span class="lineno">  920</span>    <span class="comment"># range of conditions.</span></div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>    <span class="comment"># This uses the coordinate descent algo using the gram trick.</span></div>
<div class="line"><span class="lineno">  923</span>    X, y, _, _ = build_dataset(n_samples=50, n_features=20)</div>
<div class="line"><span class="lineno">  924</span>    clf_cyclic = ElasticNet(selection=<span class="stringliteral">&quot;cyclic&quot;</span>, tol=1e-8)</div>
<div class="line"><span class="lineno">  925</span>    clf_cyclic.fit(X, y)</div>
<div class="line"><span class="lineno">  926</span>    clf_random = ElasticNet(selection=<span class="stringliteral">&quot;random&quot;</span>, tol=1e-8, random_state=42)</div>
<div class="line"><span class="lineno">  927</span>    clf_random.fit(X, y)</div>
<div class="line"><span class="lineno">  928</span>    assert_array_almost_equal(clf_cyclic.coef_, clf_random.coef_)</div>
<div class="line"><span class="lineno">  929</span>    assert_almost_equal(clf_cyclic.intercept_, clf_random.intercept_)</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>    <span class="comment"># This uses the descent algo without the gram trick</span></div>
<div class="line"><span class="lineno">  932</span>    clf_cyclic = ElasticNet(selection=<span class="stringliteral">&quot;cyclic&quot;</span>, tol=1e-8)</div>
<div class="line"><span class="lineno">  933</span>    clf_cyclic.fit(X.T, y[:20])</div>
<div class="line"><span class="lineno">  934</span>    clf_random = ElasticNet(selection=<span class="stringliteral">&quot;random&quot;</span>, tol=1e-8, random_state=42)</div>
<div class="line"><span class="lineno">  935</span>    clf_random.fit(X.T, y[:20])</div>
<div class="line"><span class="lineno">  936</span>    assert_array_almost_equal(clf_cyclic.coef_, clf_random.coef_)</div>
<div class="line"><span class="lineno">  937</span>    assert_almost_equal(clf_cyclic.intercept_, clf_random.intercept_)</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>    <span class="comment"># Sparse Case</span></div>
<div class="line"><span class="lineno">  940</span>    clf_cyclic = ElasticNet(selection=<span class="stringliteral">&quot;cyclic&quot;</span>, tol=1e-8)</div>
<div class="line"><span class="lineno">  941</span>    clf_cyclic.fit(sparse.csr_matrix(X), y)</div>
<div class="line"><span class="lineno">  942</span>    clf_random = ElasticNet(selection=<span class="stringliteral">&quot;random&quot;</span>, tol=1e-8, random_state=42)</div>
<div class="line"><span class="lineno">  943</span>    clf_random.fit(sparse.csr_matrix(X), y)</div>
<div class="line"><span class="lineno">  944</span>    assert_array_almost_equal(clf_cyclic.coef_, clf_random.coef_)</div>
<div class="line"><span class="lineno">  945</span>    assert_almost_equal(clf_cyclic.intercept_, clf_random.intercept_)</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>    <span class="comment"># Multioutput case.</span></div>
<div class="line"><span class="lineno">  948</span>    new_y = np.hstack((y[:, np.newaxis], y[:, np.newaxis]))</div>
<div class="line"><span class="lineno">  949</span>    clf_cyclic = MultiTaskElasticNet(selection=<span class="stringliteral">&quot;cyclic&quot;</span>, tol=1e-8)</div>
<div class="line"><span class="lineno">  950</span>    clf_cyclic.fit(X, new_y)</div>
<div class="line"><span class="lineno">  951</span>    clf_random = MultiTaskElasticNet(selection=<span class="stringliteral">&quot;random&quot;</span>, tol=1e-8, random_state=42)</div>
<div class="line"><span class="lineno">  952</span>    clf_random.fit(X, new_y)</div>
<div class="line"><span class="lineno">  953</span>    assert_array_almost_equal(clf_cyclic.coef_, clf_random.coef_)</div>
<div class="line"><span class="lineno">  954</span>    assert_almost_equal(clf_cyclic.intercept_, clf_random.intercept_)</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af76b2ad9151d036330a10df09945d256" name="af76b2ad9151d036330a10df09945d256"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af76b2ad9151d036330a10df09945d256">&#9670;&#160;</a></span>test_read_only_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_read_only_buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Test that sparse coordinate descent works for read-only buffers</pre> <div class="fragment"><div class="line"><span class="lineno"> 1609</span><span class="keyword">def </span>test_read_only_buffer():</div>
<div class="line"><span class="lineno"> 1610</span>    <span class="stringliteral">&quot;&quot;&quot;Test that sparse coordinate descent works for read-only buffers&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1611</span> </div>
<div class="line"><span class="lineno"> 1612</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno"> 1613</span>    clf = ElasticNet(alpha=0.1, copy_X=<span class="keyword">True</span>, random_state=rng)</div>
<div class="line"><span class="lineno"> 1614</span>    X = np.asfortranarray(rng.uniform(size=(100, 10)))</div>
<div class="line"><span class="lineno"> 1615</span>    X.setflags(write=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 1616</span> </div>
<div class="line"><span class="lineno"> 1617</span>    y = rng.rand(100)</div>
<div class="line"><span class="lineno"> 1618</span>    clf.fit(X, y)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42c0e155def8378305f2e68f7f8254a2" name="a42c0e155def8378305f2e68f7f8254a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42c0e155def8378305f2e68f7f8254a2">&#9670;&#160;</a></span>test_sample_weight_invariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_sample_weight_invariance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>estimator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1563</span><span class="keyword">def </span>test_sample_weight_invariance(estimator):</div>
<div class="line"><span class="lineno"> 1564</span>    rng = np.random.RandomState(42)</div>
<div class="line"><span class="lineno"> 1565</span>    X, y = make_regression(</div>
<div class="line"><span class="lineno"> 1566</span>        n_samples=100,</div>
<div class="line"><span class="lineno"> 1567</span>        n_features=300,</div>
<div class="line"><span class="lineno"> 1568</span>        effective_rank=10,</div>
<div class="line"><span class="lineno"> 1569</span>        n_informative=50,</div>
<div class="line"><span class="lineno"> 1570</span>        random_state=rng,</div>
<div class="line"><span class="lineno"> 1571</span>    )</div>
<div class="line"><span class="lineno"> 1572</span>    sw = rng.uniform(low=0.01, high=2, size=X.shape[0])</div>
<div class="line"><span class="lineno"> 1573</span>    params = dict(tol=1e-12)</div>
<div class="line"><span class="lineno"> 1574</span> </div>
<div class="line"><span class="lineno"> 1575</span>    <span class="comment"># Check that setting some weights to 0 is equivalent to trimming the</span></div>
<div class="line"><span class="lineno"> 1576</span>    <span class="comment"># samples:</span></div>
<div class="line"><span class="lineno"> 1577</span>    cutoff = X.shape[0] // 3</div>
<div class="line"><span class="lineno"> 1578</span>    sw_with_null = sw.copy()</div>
<div class="line"><span class="lineno"> 1579</span>    sw_with_null[:cutoff] = 0.0</div>
<div class="line"><span class="lineno"> 1580</span>    X_trimmed, y_trimmed = X[cutoff:, :], y[cutoff:]</div>
<div class="line"><span class="lineno"> 1581</span>    sw_trimmed = sw[cutoff:]</div>
<div class="line"><span class="lineno"> 1582</span> </div>
<div class="line"><span class="lineno"> 1583</span>    reg_trimmed = (</div>
<div class="line"><span class="lineno"> 1584</span>        clone(estimator)</div>
<div class="line"><span class="lineno"> 1585</span>        .set_params(**params)</div>
<div class="line"><span class="lineno"> 1586</span>        .fit(X_trimmed, y_trimmed, sample_weight=sw_trimmed)</div>
<div class="line"><span class="lineno"> 1587</span>    )</div>
<div class="line"><span class="lineno"> 1588</span>    reg_null_weighted = (</div>
<div class="line"><span class="lineno"> 1589</span>        clone(estimator).set_params(**params).fit(X, y, sample_weight=sw_with_null)</div>
<div class="line"><span class="lineno"> 1590</span>    )</div>
<div class="line"><span class="lineno"> 1591</span>    assert_allclose(reg_null_weighted.coef_, reg_trimmed.coef_)</div>
<div class="line"><span class="lineno"> 1592</span>    assert_allclose(reg_null_weighted.intercept_, reg_trimmed.intercept_)</div>
<div class="line"><span class="lineno"> 1593</span> </div>
<div class="line"><span class="lineno"> 1594</span>    <span class="comment"># Check that duplicating the training dataset is equivalent to multiplying</span></div>
<div class="line"><span class="lineno"> 1595</span>    <span class="comment"># the weights by 2:</span></div>
<div class="line"><span class="lineno"> 1596</span>    X_dup = np.concatenate([X, X], axis=0)</div>
<div class="line"><span class="lineno"> 1597</span>    y_dup = np.concatenate([y, y], axis=0)</div>
<div class="line"><span class="lineno"> 1598</span>    sw_dup = np.concatenate([sw, sw], axis=0)</div>
<div class="line"><span class="lineno"> 1599</span> </div>
<div class="line"><span class="lineno"> 1600</span>    reg_2sw = clone(estimator).set_params(**params).fit(X, y, sample_weight=2 * sw)</div>
<div class="line"><span class="lineno"> 1601</span>    reg_dup = (</div>
<div class="line"><span class="lineno"> 1602</span>        clone(estimator).set_params(**params).fit(X_dup, y_dup, sample_weight=sw_dup)</div>
<div class="line"><span class="lineno"> 1603</span>    )</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>    assert_allclose(reg_2sw.coef_, reg_dup.coef_)</div>
<div class="line"><span class="lineno"> 1606</span>    assert_allclose(reg_2sw.intercept_, reg_dup.intercept_)</div>
<div class="line"><span class="lineno"> 1607</span> </div>
<div class="line"><span class="lineno"> 1608</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a168dbf62d412fb47d561eefa066b1da0" name="a168dbf62d412fb47d561eefa066b1da0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a168dbf62d412fb47d561eefa066b1da0">&#9670;&#160;</a></span>test_set_order_dense()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_set_order_dense </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input_order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that _set_order returns arrays with promised order.</pre> <div class="fragment"><div class="line"><span class="lineno">   62</span><span class="keyword">def </span>test_set_order_dense(order, input_order):</div>
<div class="line"><span class="lineno">   63</span>    <span class="stringliteral">&quot;&quot;&quot;Check that _set_order returns arrays with promised order.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   64</span>    X = np.array([[0], [0], [0]], order=input_order)</div>
<div class="line"><span class="lineno">   65</span>    y = np.array([0, 0, 0], order=input_order)</div>
<div class="line"><span class="lineno">   66</span>    X2, y2 = _set_order(X, y, order=order)</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">if</span> order == <span class="stringliteral">&quot;C&quot;</span>:</div>
<div class="line"><span class="lineno">   68</span>        <span class="keyword">assert</span> X2.flags[<span class="stringliteral">&quot;C_CONTIGUOUS&quot;</span>]</div>
<div class="line"><span class="lineno">   69</span>        <span class="keyword">assert</span> y2.flags[<span class="stringliteral">&quot;C_CONTIGUOUS&quot;</span>]</div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">elif</span> order == <span class="stringliteral">&quot;F&quot;</span>:</div>
<div class="line"><span class="lineno">   71</span>        <span class="keyword">assert</span> X2.flags[<span class="stringliteral">&quot;F_CONTIGUOUS&quot;</span>]</div>
<div class="line"><span class="lineno">   72</span>        <span class="keyword">assert</span> y2.flags[<span class="stringliteral">&quot;F_CONTIGUOUS&quot;</span>]</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">if</span> order == input_order:</div>
<div class="line"><span class="lineno">   75</span>        <span class="keyword">assert</span> X <span class="keywordflow">is</span> X2</div>
<div class="line"><span class="lineno">   76</span>        <span class="keyword">assert</span> y <span class="keywordflow">is</span> y2</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span><span class="preprocessor">@pytest.mark.parametrize(&quot;order&quot;, [&quot;C&quot;, &quot;F&quot;])</span></div>
<div class="line"><span class="lineno">   80</span><span class="preprocessor">@pytest.mark.parametrize(&quot;input_order&quot;, [&quot;C&quot;, &quot;F&quot;])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cb959afc86670835b6ea5fb86578b55" name="a2cb959afc86670835b6ea5fb86578b55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb959afc86670835b6ea5fb86578b55">&#9670;&#160;</a></span>test_set_order_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_set_order_sparse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input_order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that _set_order returns sparse matrices in promised format.</pre> <div class="fragment"><div class="line"><span class="lineno">   81</span><span class="keyword">def </span>test_set_order_sparse(order, input_order):</div>
<div class="line"><span class="lineno">   82</span>    <span class="stringliteral">&quot;&quot;&quot;Check that _set_order returns sparse matrices in promised format.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   83</span>    X = sparse.coo_matrix(np.array([[0], [0], [0]]))</div>
<div class="line"><span class="lineno">   84</span>    y = sparse.coo_matrix(np.array([0, 0, 0]))</div>
<div class="line"><span class="lineno">   85</span>    sparse_format = <span class="stringliteral">&quot;csc&quot;</span> <span class="keywordflow">if</span> input_order == <span class="stringliteral">&quot;F&quot;</span> <span class="keywordflow">else</span> <span class="stringliteral">&quot;csr&quot;</span></div>
<div class="line"><span class="lineno">   86</span>    X = X.asformat(sparse_format)</div>
<div class="line"><span class="lineno">   87</span>    y = X.asformat(sparse_format)</div>
<div class="line"><span class="lineno">   88</span>    X2, y2 = _set_order(X, y, order=order)</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">if</span> order == <span class="stringliteral">&quot;C&quot;</span>:</div>
<div class="line"><span class="lineno">   90</span>        <span class="keyword">assert</span> sparse.isspmatrix_csr(X2)</div>
<div class="line"><span class="lineno">   91</span>        <span class="keyword">assert</span> sparse.isspmatrix_csr(y2)</div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">elif</span> order == <span class="stringliteral">&quot;F&quot;</span>:</div>
<div class="line"><span class="lineno">   93</span>        <span class="keyword">assert</span> sparse.isspmatrix_csc(X2)</div>
<div class="line"><span class="lineno">   94</span>        <span class="keyword">assert</span> sparse.isspmatrix_csc(y2)</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6f930f9c577832a3bda20b2c79267c9" name="ac6f930f9c577832a3bda20b2c79267c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6f930f9c577832a3bda20b2c79267c9">&#9670;&#160;</a></span>test_sparse_dense_descent_paths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_sparse_dense_descent_paths </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  975</span><span class="keyword">def </span>test_sparse_dense_descent_paths():</div>
<div class="line"><span class="lineno">  976</span>    <span class="comment"># Test that dense and sparse input give the same input for descent paths.</span></div>
<div class="line"><span class="lineno">  977</span>    X, y, _, _ = build_dataset(n_samples=50, n_features=20)</div>
<div class="line"><span class="lineno">  978</span>    csr = sparse.csr_matrix(X)</div>
<div class="line"><span class="lineno">  979</span>    <span class="keywordflow">for</span> path <span class="keywordflow">in</span> [enet_path, lasso_path]:</div>
<div class="line"><span class="lineno">  980</span>        _, coefs, _ = path(X, y)</div>
<div class="line"><span class="lineno">  981</span>        _, sparse_coefs, _ = path(csr, y)</div>
<div class="line"><span class="lineno">  982</span>        assert_array_almost_equal(coefs, sparse_coefs)</div>
<div class="line"><span class="lineno">  983</span> </div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span><span class="preprocessor">@pytest.mark.parametrize(&quot;path_func&quot;, [enet_path, lasso_path])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a727ce71b0c2ae504837d19ad60214b33" name="a727ce71b0c2ae504837d19ad60214b33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a727ce71b0c2ae504837d19ad60214b33">&#9670;&#160;</a></span>test_sparse_input_convergence_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_sparse_input_convergence_warning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1223</span><span class="keyword">def </span>test_sparse_input_convergence_warning():</div>
<div class="line"><span class="lineno"> 1224</span>    X, y, _, _ = build_dataset(n_samples=1000, n_features=500)</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>    <span class="keyword">with</span> pytest.warns(ConvergenceWarning):</div>
<div class="line"><span class="lineno"> 1227</span>        ElasticNet(max_iter=1, tol=0).fit(sparse.csr_matrix(X, dtype=np.float32), y)</div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>    <span class="comment"># check that the model converges w/o convergence warnings</span></div>
<div class="line"><span class="lineno"> 1230</span>    <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno"> 1231</span>        warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, ConvergenceWarning)</div>
<div class="line"><span class="lineno"> 1232</span>        Lasso().fit(sparse.csr_matrix(X, dtype=np.float32), y)</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1236</span>    <span class="stringliteral">&quot;precompute, inner_precompute&quot;</span>,</div>
<div class="line"><span class="lineno"> 1237</span>    [</div>
<div class="line"><span class="lineno"> 1238</span>        (<span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno"> 1239</span>        (<span class="stringliteral">&quot;auto&quot;</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1240</span>        (<span class="keyword">False</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno"> 1241</span>    ],</div>
<div class="line"><span class="lineno"> 1242</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a25280f9072770510a1e32e164c2aadb4" name="a25280f9072770510a1e32e164c2aadb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25280f9072770510a1e32e164c2aadb4">&#9670;&#160;</a></span>test_sparse_input_dtype_enet_and_lassocv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_sparse_input_dtype_enet_and_lassocv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  793</span><span class="keyword">def </span>test_sparse_input_dtype_enet_and_lassocv():</div>
<div class="line"><span class="lineno">  794</span>    X, y, _, _ = build_dataset(n_features=10)</div>
<div class="line"><span class="lineno">  795</span>    clf = ElasticNetCV(n_alphas=5)</div>
<div class="line"><span class="lineno">  796</span>    clf.fit(sparse.csr_matrix(X), y)</div>
<div class="line"><span class="lineno">  797</span>    clf1 = ElasticNetCV(n_alphas=5)</div>
<div class="line"><span class="lineno">  798</span>    clf1.fit(sparse.csr_matrix(X, dtype=np.float32), y)</div>
<div class="line"><span class="lineno">  799</span>    assert_almost_equal(clf.alpha_, clf1.alpha_, decimal=6)</div>
<div class="line"><span class="lineno">  800</span>    assert_almost_equal(clf.coef_, clf1.coef_, decimal=6)</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>    clf = LassoCV(n_alphas=5)</div>
<div class="line"><span class="lineno">  803</span>    clf.fit(sparse.csr_matrix(X), y)</div>
<div class="line"><span class="lineno">  804</span>    clf1 = LassoCV(n_alphas=5)</div>
<div class="line"><span class="lineno">  805</span>    clf1.fit(sparse.csr_matrix(X, dtype=np.float32), y)</div>
<div class="line"><span class="lineno">  806</span>    assert_almost_equal(clf.alpha_, clf1.alpha_, decimal=6)</div>
<div class="line"><span class="lineno">  807</span>    assert_almost_equal(clf.coef_, clf1.coef_, decimal=6)</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a94ebea470bd7eae4175dc98d26f05f49" name="a94ebea470bd7eae4175dc98d26f05f49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ebea470bd7eae4175dc98d26f05f49">&#9670;&#160;</a></span>test_uniform_targets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_uniform_targets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  637</span><span class="keyword">def </span>test_uniform_targets():</div>
<div class="line"><span class="lineno">  638</span>    enet = ElasticNetCV(n_alphas=3)</div>
<div class="line"><span class="lineno">  639</span>    m_enet = MultiTaskElasticNetCV(n_alphas=3)</div>
<div class="line"><span class="lineno">  640</span>    lasso = LassoCV(n_alphas=3)</div>
<div class="line"><span class="lineno">  641</span>    m_lasso = MultiTaskLassoCV(n_alphas=3)</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>    models_single_task = (enet, lasso)</div>
<div class="line"><span class="lineno">  644</span>    models_multi_task = (m_enet, m_lasso)</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    rng = np.random.RandomState(0)</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>    X_train = rng.random_sample(size=(10, 3))</div>
<div class="line"><span class="lineno">  649</span>    X_test = rng.random_sample(size=(10, 3))</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    y1 = np.empty(10)</div>
<div class="line"><span class="lineno">  652</span>    y2 = np.empty((10, 2))</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">for</span> model <span class="keywordflow">in</span> models_single_task:</div>
<div class="line"><span class="lineno">  655</span>        <span class="keywordflow">for</span> y_values <span class="keywordflow">in</span> (0, 5):</div>
<div class="line"><span class="lineno">  656</span>            y1.fill(y_values)</div>
<div class="line"><span class="lineno">  657</span>            assert_array_equal(model.fit(X_train, y1).predict(X_test), y1)</div>
<div class="line"><span class="lineno">  658</span>            assert_array_equal(model.alphas_, [np.finfo(float).resolution] * 3)</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">for</span> model <span class="keywordflow">in</span> models_multi_task:</div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">for</span> y_values <span class="keywordflow">in</span> (0, 5):</div>
<div class="line"><span class="lineno">  662</span>            y2[:, 0].fill(y_values)</div>
<div class="line"><span class="lineno">  663</span>            y2[:, 1].fill(2 * y_values)</div>
<div class="line"><span class="lineno">  664</span>            assert_array_equal(model.fit(X_train, y2).predict(X_test), y2)</div>
<div class="line"><span class="lineno">  665</span>            assert_array_equal(model.alphas_, [np.finfo(float).resolution] * 3)</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aafa451bbb56bc685d8a1e46642d325b8" name="aafa451bbb56bc685d8a1e46642d325b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafa451bbb56bc685d8a1e46642d325b8">&#9670;&#160;</a></span>test_warm_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_warm_start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  571</span><span class="keyword">def </span>test_warm_start():</div>
<div class="line"><span class="lineno">  572</span>    X, y, _, _ = build_dataset()</div>
<div class="line"><span class="lineno">  573</span>    clf = ElasticNet(alpha=0.1, max_iter=5, warm_start=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  574</span>    ignore_warnings(clf.fit)(X, y)</div>
<div class="line"><span class="lineno">  575</span>    ignore_warnings(clf.fit)(X, y)  <span class="comment"># do a second round with 5 iterations</span></div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    clf2 = ElasticNet(alpha=0.1, max_iter=10)</div>
<div class="line"><span class="lineno">  578</span>    ignore_warnings(clf2.fit)(X, y)</div>
<div class="line"><span class="lineno">  579</span>    assert_array_almost_equal(clf2.coef_, clf.coef_)</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad71ebfc2eab6d14f253a0cc9aa7e44ee" name="ad71ebfc2eab6d14f253a0cc9aa7e44ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad71ebfc2eab6d14f253a0cc9aa7e44ee">&#9670;&#160;</a></span>test_warm_start_convergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_warm_start_convergence </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  872</span><span class="keyword">def </span>test_warm_start_convergence():</div>
<div class="line"><span class="lineno">  873</span>    X, y, _, _ = build_dataset()</div>
<div class="line"><span class="lineno">  874</span>    model = ElasticNet(alpha=1e-3, tol=1e-3).fit(X, y)</div>
<div class="line"><span class="lineno">  875</span>    n_iter_reference = model.n_iter_</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>    <span class="comment"># This dataset is not trivial enough for the model to converge in one pass.</span></div>
<div class="line"><span class="lineno">  878</span>    <span class="keyword">assert</span> n_iter_reference &gt; 2</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>    <span class="comment"># Check that n_iter_ is invariant to multiple calls to fit</span></div>
<div class="line"><span class="lineno">  881</span>    <span class="comment"># when warm_start=False, all else being equal.</span></div>
<div class="line"><span class="lineno">  882</span>    model.fit(X, y)</div>
<div class="line"><span class="lineno">  883</span>    n_iter_cold_start = model.n_iter_</div>
<div class="line"><span class="lineno">  884</span>    <span class="keyword">assert</span> n_iter_cold_start == n_iter_reference</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>    <span class="comment"># Fit the same model again, using a warm start: the optimizer just performs</span></div>
<div class="line"><span class="lineno">  887</span>    <span class="comment"># a single pass before checking that it has already converged</span></div>
<div class="line"><span class="lineno">  888</span>    model.set_params(warm_start=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  889</span>    model.fit(X, y)</div>
<div class="line"><span class="lineno">  890</span>    n_iter_warm_start = model.n_iter_</div>
<div class="line"><span class="lineno">  891</span>    <span class="keyword">assert</span> n_iter_warm_start == 1</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a86950ab2cebacd9ae4df59cde0d293b6" name="a86950ab2cebacd9ae4df59cde0d293b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86950ab2cebacd9ae4df59cde0d293b6">&#9670;&#160;</a></span>test_warm_start_convergence_with_regularizer_decrement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_warm_start_convergence_with_regularizer_decrement </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  894</span><span class="keyword">def </span>test_warm_start_convergence_with_regularizer_decrement():</div>
<div class="line"><span class="lineno">  895</span>    X, y = load_diabetes(return_X_y=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  896</span> </div>
<div class="line"><span class="lineno">  897</span>    <span class="comment"># Train a model to converge on a lightly regularized problem</span></div>
<div class="line"><span class="lineno">  898</span>    final_alpha = 1e-5</div>
<div class="line"><span class="lineno">  899</span>    low_reg_model = ElasticNet(alpha=final_alpha).fit(X, y)</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>    <span class="comment"># Fitting a new model on a more regularized version of the same problem.</span></div>
<div class="line"><span class="lineno">  902</span>    <span class="comment"># Fitting with high regularization is easier it should converge faster</span></div>
<div class="line"><span class="lineno">  903</span>    <span class="comment"># in general.</span></div>
<div class="line"><span class="lineno">  904</span>    high_reg_model = ElasticNet(alpha=final_alpha * 10).fit(X, y)</div>
<div class="line"><span class="lineno">  905</span>    <span class="keyword">assert</span> low_reg_model.n_iter_ &gt; high_reg_model.n_iter_</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>    <span class="comment"># Fit the solution to the original, less regularized version of the</span></div>
<div class="line"><span class="lineno">  908</span>    <span class="comment"># problem but from the solution of the highly regularized variant of</span></div>
<div class="line"><span class="lineno">  909</span>    <span class="comment"># the problem as a better starting point. This should also converge</span></div>
<div class="line"><span class="lineno">  910</span>    <span class="comment"># faster than the original model that starts from zero.</span></div>
<div class="line"><span class="lineno">  911</span>    warm_low_reg_model = deepcopy(high_reg_model)</div>
<div class="line"><span class="lineno">  912</span>    warm_low_reg_model.set_params(warm_start=<span class="keyword">True</span>, alpha=final_alpha)</div>
<div class="line"><span class="lineno">  913</span>    warm_low_reg_model.fit(X, y)</div>
<div class="line"><span class="lineno">  914</span>    <span class="keyword">assert</span> low_reg_model.n_iter_ &gt; warm_low_reg_model.n_iter_</div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4261daba38586d5d6f5044bcd389a858" name="a4261daba38586d5d6f5044bcd389a858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4261daba38586d5d6f5044bcd389a858">&#9670;&#160;</a></span>test_warm_start_multitask_lasso()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.test_warm_start_multitask_lasso </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1174</span><span class="keyword">def </span>test_warm_start_multitask_lasso():</div>
<div class="line"><span class="lineno"> 1175</span>    X, y, X_test, y_test = build_dataset()</div>
<div class="line"><span class="lineno"> 1176</span>    Y = np.c_[y, y]</div>
<div class="line"><span class="lineno"> 1177</span>    clf = MultiTaskLasso(alpha=0.1, max_iter=5, warm_start=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1178</span>    ignore_warnings(clf.fit)(X, Y)</div>
<div class="line"><span class="lineno"> 1179</span>    ignore_warnings(clf.fit)(X, Y)  <span class="comment"># do a second round with 5 iterations</span></div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>    clf2 = MultiTaskLasso(alpha=0.1, max_iter=10)</div>
<div class="line"><span class="lineno"> 1182</span>    ignore_warnings(clf2.fit)(X, Y)</div>
<div class="line"><span class="lineno"> 1183</span>    assert_array_almost_equal(clf2.coef_, clf.coef_)</div>
<div class="line"><span class="lineno"> 1184</span> </div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span><span class="preprocessor">@pytest.mark.parametrize</span>(</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="stringliteral">&quot;klass, n_classes, kwargs&quot;</span>,</div>
<div class="line"><span class="lineno"> 1188</span>    [</div>
<div class="line"><span class="lineno"> 1189</span>        (Lasso, 1, dict(precompute=<span class="keyword">True</span>)),</div>
<div class="line"><span class="lineno"> 1190</span>        (Lasso, 1, dict(precompute=<span class="keyword">False</span>)),</div>
<div class="line"><span class="lineno"> 1191</span>        (MultiTaskLasso, 2, dict()),</div>
<div class="line"><span class="lineno"> 1192</span>        (MultiTaskLasso, 2, dict()),</div>
<div class="line"><span class="lineno"> 1193</span>    ],</div>
<div class="line"><span class="lineno"> 1194</span>)</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7c1159063a7f09b94a11b392b8b082c6" name="a7c1159063a7f09b94a11b392b8b082c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c1159063a7f09b94a11b392b8b082c6">&#9670;&#160;</a></span>precompute</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.linear_model.tests.test_coordinate_descent.precompute</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
