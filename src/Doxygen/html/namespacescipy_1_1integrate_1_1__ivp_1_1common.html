<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.integrate._ivp.common Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1integrate.html">integrate</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp.html">_ivp</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.integrate._ivp.common Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1integrate_1_1__ivp_1_1common_1_1_ode_solution.html">OdeSolution</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa028a0075b67bd9c7c10dc030e804528" id="r_aa028a0075b67bd9c7c10dc030e804528"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#aa028a0075b67bd9c7c10dc030e804528">validate_first_step</a> (first_step, <a class="el" href="gh15035_8f.html#a2f7a838816552ccfc99803b1dac6c151">t0</a>, t_bound)</td></tr>
<tr class="separator:aa028a0075b67bd9c7c10dc030e804528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a469f4e852e90b35ef087ded6677de228" id="r_a469f4e852e90b35ef087ded6677de228"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a469f4e852e90b35ef087ded6677de228">validate_max_step</a> (max_step)</td></tr>
<tr class="separator:a469f4e852e90b35ef087ded6677de228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323627182fd010a78735697f4d87dfd2" id="r_a323627182fd010a78735697f4d87dfd2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a323627182fd010a78735697f4d87dfd2">warn_extraneous</a> (extraneous)</td></tr>
<tr class="separator:a323627182fd010a78735697f4d87dfd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6828351fc511f9fe00e722bae893cc7a" id="r_a6828351fc511f9fe00e722bae893cc7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a6828351fc511f9fe00e722bae893cc7a">validate_tol</a> (<a class="el" href="__lapack__subroutines_8h.html#aa4a017e91ee751f9803a1bdb6caf1c06">rtol</a>, atol, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a6828351fc511f9fe00e722bae893cc7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13f810a27eaca51b874e1283aca96d73" id="r_a13f810a27eaca51b874e1283aca96d73"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a13f810a27eaca51b874e1283aca96d73">norm</a> (x)</td></tr>
<tr class="separator:a13f810a27eaca51b874e1283aca96d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1f51383a7204f566360554a837f42bd" id="r_ae1f51383a7204f566360554a837f42bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#ae1f51383a7204f566360554a837f42bd">select_initial_step</a> (fun, <a class="el" href="gh15035_8f.html#a2f7a838816552ccfc99803b1dac6c151">t0</a>, <a class="el" href="__ufuncs__defs_8h.html#a5bbf55bb92a1d8c0de447a483a82f1e2">y0</a>, f0, direction, <a class="el" href="__lapack__subroutines_8h.html#a9993259f1ab17738593f079acd0507d9">order</a>, <a class="el" href="__lapack__subroutines_8h.html#aa4a017e91ee751f9803a1bdb6caf1c06">rtol</a>, atol)</td></tr>
<tr class="separator:ae1f51383a7204f566360554a837f42bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7afdad633d3b5f2d89915373dea34c2" id="r_ad7afdad633d3b5f2d89915373dea34c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#ad7afdad633d3b5f2d89915373dea34c2">num_jac</a> (fun, t, y, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, threshold, factor, sparsity=None)</td></tr>
<tr class="separator:ad7afdad633d3b5f2d89915373dea34c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad21f85e18b2f1227d72986b3f2157b5e" id="r_ad21f85e18b2f1227d72986b3f2157b5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#ad21f85e18b2f1227d72986b3f2157b5e">_dense_num_jac</a> (fun, t, y, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, <a class="el" href="__lapack__subroutines_8h.html#a866dc72abfeae882204974bec3220f3a">h</a>, factor, y_scale)</td></tr>
<tr class="separator:ad21f85e18b2f1227d72986b3f2157b5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf19d2e3a667f4e7bf26a6be07af271c" id="r_abf19d2e3a667f4e7bf26a6be07af271c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#abf19d2e3a667f4e7bf26a6be07af271c">_sparse_num_jac</a> (fun, t, y, <a class="el" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>, <a class="el" href="__lapack__subroutines_8h.html#a866dc72abfeae882204974bec3220f3a">h</a>, factor, y_scale, structure, groups)</td></tr>
<tr class="separator:abf19d2e3a667f4e7bf26a6be07af271c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a75356e524626e94596f23fa8336ae8b3" id="r_a75356e524626e94596f23fa8336ae8b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a> = np.finfo(float).<a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a></td></tr>
<tr class="separator:a75356e524626e94596f23fa8336ae8b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e7331b4d57feabecda6eb41e6a895a" id="r_ae2e7331b4d57feabecda6eb41e6a895a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#ae2e7331b4d57feabecda6eb41e6a895a">NUM_JAC_DIFF_REJECT</a> = <a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a> ** 0.875</td></tr>
<tr class="separator:ae2e7331b4d57feabecda6eb41e6a895a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123a65e3fd86bf7f218534cc8e6e3c8c" id="r_a123a65e3fd86bf7f218534cc8e6e3c8c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a123a65e3fd86bf7f218534cc8e6e3c8c">NUM_JAC_DIFF_SMALL</a> = <a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a> ** 0.75</td></tr>
<tr class="separator:a123a65e3fd86bf7f218534cc8e6e3c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6117895424bec662d1cefd204f62a2c5" id="r_a6117895424bec662d1cefd204f62a2c5"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a6117895424bec662d1cefd204f62a2c5">NUM_JAC_DIFF_BIG</a> = <a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a> ** 0.25</td></tr>
<tr class="separator:a6117895424bec662d1cefd204f62a2c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1907d1498d8202c2944d39dc570812ed" id="r_a1907d1498d8202c2944d39dc570812ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a1907d1498d8202c2944d39dc570812ed">NUM_JAC_MIN_FACTOR</a> = 1e3 * <a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a></td></tr>
<tr class="separator:a1907d1498d8202c2944d39dc570812ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3017f23453ce7e7f13ad3c2f8e27da0e" id="r_a3017f23453ce7e7f13ad3c2f8e27da0e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a3017f23453ce7e7f13ad3c2f8e27da0e">NUM_JAC_FACTOR_INCREASE</a> = 10</td></tr>
<tr class="separator:a3017f23453ce7e7f13ad3c2f8e27da0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b77a57b5e518546320ae51c54e3cb8" id="r_ac7b77a57b5e518546320ae51c54e3cb8"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#ac7b77a57b5e518546320ae51c54e3cb8">NUM_JAC_FACTOR_DECREASE</a> = 0.1</td></tr>
<tr class="separator:ac7b77a57b5e518546320ae51c54e3cb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad21f85e18b2f1227d72986b3f2157b5e" name="ad21f85e18b2f1227d72986b3f2157b5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad21f85e18b2f1227d72986b3f2157b5e">&#9670;&#160;</a></span>_dense_num_jac()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common._dense_num_jac </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  325</span><span class="keyword">def </span>_dense_num_jac(fun, t, y, f, h, factor, y_scale):</div>
<div class="line"><span class="lineno">  326</span>    n = y.shape[0]</div>
<div class="line"><span class="lineno">  327</span>    h_vecs = np.diag(h)</div>
<div class="line"><span class="lineno">  328</span>    f_new = fun(t, y[:, <span class="keywordtype">None</span>] + h_vecs)</div>
<div class="line"><span class="lineno">  329</span>    diff = f_new - f[:, <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  330</span>    max_ind = np.argmax(np.abs(diff), axis=0)</div>
<div class="line"><span class="lineno">  331</span>    r = np.arange(n)</div>
<div class="line"><span class="lineno">  332</span>    max_diff = np.abs(diff[max_ind, r])</div>
<div class="line"><span class="lineno">  333</span>    scale = np.maximum(np.abs(f[max_ind]), np.abs(f_new[max_ind, r]))</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    diff_too_small = max_diff &lt; NUM_JAC_DIFF_REJECT * scale</div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">if</span> np.any(diff_too_small):</div>
<div class="line"><span class="lineno">  337</span>        ind, = np.nonzero(diff_too_small)</div>
<div class="line"><span class="lineno">  338</span>        new_factor = NUM_JAC_FACTOR_INCREASE * factor[ind]</div>
<div class="line"><span class="lineno">  339</span>        h_new = (y[ind] + new_factor * y_scale[ind]) - y[ind]</div>
<div class="line"><span class="lineno">  340</span>        h_vecs[ind, ind] = h_new</div>
<div class="line"><span class="lineno">  341</span>        f_new = fun(t, y[:, <span class="keywordtype">None</span>] + h_vecs[:, ind])</div>
<div class="line"><span class="lineno">  342</span>        diff_new = f_new - f[:, <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  343</span>        max_ind = np.argmax(np.abs(diff_new), axis=0)</div>
<div class="line"><span class="lineno">  344</span>        r = np.arange(ind.shape[0])</div>
<div class="line"><span class="lineno">  345</span>        max_diff_new = np.abs(diff_new[max_ind, r])</div>
<div class="line"><span class="lineno">  346</span>        scale_new = np.maximum(np.abs(f[max_ind]), np.abs(f_new[max_ind, r]))</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>        update = max_diff[ind] * scale_new &lt; max_diff_new * scale[ind]</div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordflow">if</span> np.any(update):</div>
<div class="line"><span class="lineno">  350</span>            update, = np.nonzero(update)</div>
<div class="line"><span class="lineno">  351</span>            update_ind = ind[update]</div>
<div class="line"><span class="lineno">  352</span>            factor[update_ind] = new_factor[update]</div>
<div class="line"><span class="lineno">  353</span>            h[update_ind] = h_new[update]</div>
<div class="line"><span class="lineno">  354</span>            diff[:, update_ind] = diff_new[:, update]</div>
<div class="line"><span class="lineno">  355</span>            scale[update_ind] = scale_new[update]</div>
<div class="line"><span class="lineno">  356</span>            max_diff[update_ind] = max_diff_new[update]</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    diff /= h</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    factor[max_diff &lt; NUM_JAC_DIFF_SMALL * scale] *= NUM_JAC_FACTOR_INCREASE</div>
<div class="line"><span class="lineno">  361</span>    factor[max_diff &gt; NUM_JAC_DIFF_BIG * scale] *= NUM_JAC_FACTOR_DECREASE</div>
<div class="line"><span class="lineno">  362</span>    factor = np.maximum(factor, NUM_JAC_MIN_FACTOR)</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">return</span> diff, factor</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abf19d2e3a667f4e7bf26a6be07af271c" name="abf19d2e3a667f4e7bf26a6be07af271c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf19d2e3a667f4e7bf26a6be07af271c">&#9670;&#160;</a></span>_sparse_num_jac()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common._sparse_num_jac </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groups</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  367</span><span class="keyword">def </span>_sparse_num_jac(fun, t, y, f, h, factor, y_scale, structure, groups):</div>
<div class="line"><span class="lineno">  368</span>    n = y.shape[0]</div>
<div class="line"><span class="lineno">  369</span>    n_groups = np.max(groups) + 1</div>
<div class="line"><span class="lineno">  370</span>    h_vecs = np.empty((n_groups, n))</div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">for</span> group <span class="keywordflow">in</span> range(n_groups):</div>
<div class="line"><span class="lineno">  372</span>        e = np.equal(group, groups)</div>
<div class="line"><span class="lineno">  373</span>        h_vecs[group] = h * e</div>
<div class="line"><span class="lineno">  374</span>    h_vecs = h_vecs.T</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    f_new = fun(t, y[:, <span class="keywordtype">None</span>] + h_vecs)</div>
<div class="line"><span class="lineno">  377</span>    df = f_new - f[:, <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    i, j, _ = find(structure)</div>
<div class="line"><span class="lineno">  380</span>    diff = coo_matrix((df[i, groups[j]], (i, j)), shape=(n, n)).tocsc()</div>
<div class="line"><span class="lineno">  381</span>    max_ind = np.array(abs(diff).argmax(axis=0)).ravel()</div>
<div class="line"><span class="lineno">  382</span>    r = np.arange(n)</div>
<div class="line"><span class="lineno">  383</span>    max_diff = np.asarray(np.abs(diff[max_ind, r])).ravel()</div>
<div class="line"><span class="lineno">  384</span>    scale = np.maximum(np.abs(f[max_ind]),</div>
<div class="line"><span class="lineno">  385</span>                       np.abs(f_new[max_ind, groups[r]]))</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    diff_too_small = max_diff &lt; NUM_JAC_DIFF_REJECT * scale</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">if</span> np.any(diff_too_small):</div>
<div class="line"><span class="lineno">  389</span>        ind, = np.nonzero(diff_too_small)</div>
<div class="line"><span class="lineno">  390</span>        new_factor = NUM_JAC_FACTOR_INCREASE * factor[ind]</div>
<div class="line"><span class="lineno">  391</span>        h_new = (y[ind] + new_factor * y_scale[ind]) - y[ind]</div>
<div class="line"><span class="lineno">  392</span>        h_new_all = np.zeros(n)</div>
<div class="line"><span class="lineno">  393</span>        h_new_all[ind] = h_new</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>        groups_unique = np.unique(groups[ind])</div>
<div class="line"><span class="lineno">  396</span>        groups_map = np.empty(n_groups, dtype=int)</div>
<div class="line"><span class="lineno">  397</span>        h_vecs = np.empty((groups_unique.shape[0], n))</div>
<div class="line"><span class="lineno">  398</span>        <span class="keywordflow">for</span> k, group <span class="keywordflow">in</span> enumerate(groups_unique):</div>
<div class="line"><span class="lineno">  399</span>            e = np.equal(group, groups)</div>
<div class="line"><span class="lineno">  400</span>            h_vecs[k] = h_new_all * e</div>
<div class="line"><span class="lineno">  401</span>            groups_map[group] = k</div>
<div class="line"><span class="lineno">  402</span>        h_vecs = h_vecs.T</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>        f_new = fun(t, y[:, <span class="keywordtype">None</span>] + h_vecs)</div>
<div class="line"><span class="lineno">  405</span>        df = f_new - f[:, <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  406</span>        i, j, _ = find(structure[:, ind])</div>
<div class="line"><span class="lineno">  407</span>        diff_new = coo_matrix((df[i, groups_map[groups[ind[j]]]],</div>
<div class="line"><span class="lineno">  408</span>                               (i, j)), shape=(n, ind.shape[0])).tocsc()</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>        max_ind_new = np.array(abs(diff_new).argmax(axis=0)).ravel()</div>
<div class="line"><span class="lineno">  411</span>        r = np.arange(ind.shape[0])</div>
<div class="line"><span class="lineno">  412</span>        max_diff_new = np.asarray(np.abs(diff_new[max_ind_new, r])).ravel()</div>
<div class="line"><span class="lineno">  413</span>        scale_new = np.maximum(</div>
<div class="line"><span class="lineno">  414</span>            np.abs(f[max_ind_new]),</div>
<div class="line"><span class="lineno">  415</span>            np.abs(f_new[max_ind_new, groups_map[groups[ind]]]))</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>        update = max_diff[ind] * scale_new &lt; max_diff_new * scale[ind]</div>
<div class="line"><span class="lineno">  418</span>        <span class="keywordflow">if</span> np.any(update):</div>
<div class="line"><span class="lineno">  419</span>            update, = np.nonzero(update)</div>
<div class="line"><span class="lineno">  420</span>            update_ind = ind[update]</div>
<div class="line"><span class="lineno">  421</span>            factor[update_ind] = new_factor[update]</div>
<div class="line"><span class="lineno">  422</span>            h[update_ind] = h_new[update]</div>
<div class="line"><span class="lineno">  423</span>            diff[:, update_ind] = diff_new[:, update]</div>
<div class="line"><span class="lineno">  424</span>            scale[update_ind] = scale_new[update]</div>
<div class="line"><span class="lineno">  425</span>            max_diff[update_ind] = max_diff_new[update]</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>    diff.data /= np.repeat(h, np.diff(diff.indptr))</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    factor[max_diff &lt; NUM_JAC_DIFF_SMALL * scale] *= NUM_JAC_FACTOR_INCREASE</div>
<div class="line"><span class="lineno">  430</span>    factor[max_diff &gt; NUM_JAC_DIFF_BIG * scale] *= NUM_JAC_FACTOR_DECREASE</div>
<div class="line"><span class="lineno">  431</span>    factor = np.maximum(factor, NUM_JAC_MIN_FACTOR)</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordflow">return</span> diff, factor</div>
</div><!-- fragment -->
</div>
</div>
<a id="a13f810a27eaca51b874e1283aca96d73" name="a13f810a27eaca51b874e1283aca96d73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13f810a27eaca51b874e1283aca96d73">&#9670;&#160;</a></span>norm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common.norm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute RMS norm.</pre> <div class="fragment"><div class="line"><span class="lineno">   61</span><span class="keyword">def </span>norm(x):</div>
<div class="line"><span class="lineno">   62</span>    <span class="stringliteral">&quot;&quot;&quot;Compute RMS norm.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">return</span> np.linalg.norm(x) / x.size ** 0.5</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7afdad633d3b5f2d89915373dea34c2" name="ad7afdad633d3b5f2d89915373dea34c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7afdad633d3b5f2d89915373dea34c2">&#9670;&#160;</a></span>num_jac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common.num_jac </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sparsity</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Finite differences Jacobian approximation tailored for ODE solvers.

This function computes finite difference approximation to the Jacobian
matrix of `fun` with respect to `y` using forward differences.
The Jacobian matrix has shape (n, n) and its element (i, j) is equal to
``d f_i / d y_j``.

A special feature of this function is the ability to correct the step
size from iteration to iteration. The main idea is to keep the finite
difference significantly separated from its round-off error which
approximately equals ``EPS * np.abs(f)``. It reduces a possibility of a
huge error and assures that the estimated derivative are reasonably close
to the true values (i.e., the finite difference approximation is at least
qualitatively reflects the structure of the true Jacobian).

Parameters
----------
fun : callable
    Right-hand side of the system implemented in a vectorized fashion.
t : float
    Current time.
y : ndarray, shape (n,)
    Current state.
f : ndarray, shape (n,)
    Value of the right hand side at (t, y).
threshold : float
    Threshold for `y` value used for computing the step size as
    ``factor * np.maximum(np.abs(y), threshold)``. Typically, the value of
    absolute tolerance (atol) for a solver should be passed as `threshold`.
factor : ndarray with shape (n,) or None
    Factor to use for computing the step size. Pass None for the very
    evaluation, then use the value returned from this function.
sparsity : tuple (structure, groups) or None
    Sparsity structure of the Jacobian, `structure` must be csc_matrix.

Returns
-------
J : ndarray or csc_matrix, shape (n, n)
    Jacobian matrix.
factor : ndarray, shape (n,)
    Suggested `factor` for the next evaluation.
</pre> <div class="fragment"><div class="line"><span class="lineno">  250</span><span class="keyword">def </span>num_jac(fun, t, y, f, threshold, factor, sparsity=None):</div>
<div class="line"><span class="lineno">  251</span>    <span class="stringliteral">&quot;&quot;&quot;Finite differences Jacobian approximation tailored for ODE solvers.</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    This function computes finite difference approximation to the Jacobian</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">    matrix of `fun` with respect to `y` using forward differences.</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">    The Jacobian matrix has shape (n, n) and its element (i, j) is equal to</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    ``d f_i / d y_j``.</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">    A special feature of this function is the ability to correct the step</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">    size from iteration to iteration. The main idea is to keep the finite</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    difference significantly separated from its round-off error which</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    approximately equals ``EPS * np.abs(f)``. It reduces a possibility of a</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">    huge error and assures that the estimated derivative are reasonably close</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">    to the true values (i.e., the finite difference approximation is at least</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    qualitatively reflects the structure of the true Jacobian).</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    fun : callable</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">        Right-hand side of the system implemented in a vectorized fashion.</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    t : float</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">        Current time.</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">    y : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">        Current state.</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    f : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">        Value of the right hand side at (t, y).</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    threshold : float</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">        Threshold for `y` value used for computing the step size as</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">        ``factor * np.maximum(np.abs(y), threshold)``. Typically, the value of</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">        absolute tolerance (atol) for a solver should be passed as `threshold`.</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">    factor : ndarray with shape (n,) or None</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">        Factor to use for computing the step size. Pass None for the very</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">        evaluation, then use the value returned from this function.</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">    sparsity : tuple (structure, groups) or None</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">        Sparsity structure of the Jacobian, `structure` must be csc_matrix.</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">    J : ndarray or csc_matrix, shape (n, n)</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral">        Jacobian matrix.</span></div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">    factor : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">        Suggested `factor` for the next evaluation.</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  293</span>    y = np.asarray(y)</div>
<div class="line"><span class="lineno">  294</span>    n = y.shape[0]</div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordflow">if</span> n == 0:</div>
<div class="line"><span class="lineno">  296</span>        <span class="keywordflow">return</span> np.empty((0, 0)), factor</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span> factor <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  299</span>        factor = np.full(n, EPS ** 0.5)</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  301</span>        factor = factor.copy()</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    <span class="comment"># Direct the step as ODE dictates, hoping that such a step won&#39;t lead to</span></div>
<div class="line"><span class="lineno">  304</span>    <span class="comment"># a problematic region. For complex ODEs it makes sense to use the real</span></div>
<div class="line"><span class="lineno">  305</span>    <span class="comment"># part of f as we use steps along real axis.</span></div>
<div class="line"><span class="lineno">  306</span>    f_sign = 2 * (np.real(f) &gt;= 0).astype(float) - 1</div>
<div class="line"><span class="lineno">  307</span>    y_scale = f_sign * np.maximum(threshold, np.abs(y))</div>
<div class="line"><span class="lineno">  308</span>    h = (y + factor * y_scale) - y</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    <span class="comment"># Make sure that the step is not 0 to start with. Not likely it will be</span></div>
<div class="line"><span class="lineno">  311</span>    <span class="comment"># executed often.</span></div>
<div class="line"><span class="lineno">  312</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> np.nonzero(h == 0)[0]:</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">while</span> h[i] == 0:</div>
<div class="line"><span class="lineno">  314</span>            factor[i] *= 10</div>
<div class="line"><span class="lineno">  315</span>            h[i] = (y[i] + factor[i] * y_scale[i]) - y[i]</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">if</span> sparsity <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  318</span>        <span class="keywordflow">return</span> _dense_num_jac(fun, t, y, f, h, factor, y_scale)</div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  320</span>        structure, groups = sparsity</div>
<div class="line"><span class="lineno">  321</span>        <span class="keywordflow">return</span> _sparse_num_jac(fun, t, y, f, h, factor, y_scale,</div>
<div class="line"><span class="lineno">  322</span>                               structure, groups)</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1f51383a7204f566360554a837f42bd" name="ae1f51383a7204f566360554a837f42bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1f51383a7204f566360554a837f42bd">&#9670;&#160;</a></span>select_initial_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common.select_initial_step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>atol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Empirically select a good initial step.

The algorithm is described in [1]_.

Parameters
----------
fun : callable
    Right-hand side of the system.
t0 : float
    Initial value of the independent variable.
y0 : ndarray, shape (n,)
    Initial value of the dependent variable.
f0 : ndarray, shape (n,)
    Initial value of the derivative, i.e., ``fun(t0, y0)``.
direction : float
    Integration direction.
order : float
    Error estimator order. It means that the error controlled by the
    algorithm is proportional to ``step_size ** (order + 1)`.
rtol : float
    Desired relative tolerance.
atol : float
    Desired absolute tolerance.

Returns
-------
h_abs : float
    Absolute value of the suggested initial step.

References
----------
.. [1] E. Hairer, S. P. Norsett G. Wanner, "Solving Ordinary Differential
       Equations I: Nonstiff Problems", Sec. II.4.
</pre> <div class="fragment"><div class="line"><span class="lineno">   66</span><span class="keyword">def </span>select_initial_step(fun, t0, y0, f0, direction, order, rtol, atol):</div>
<div class="line"><span class="lineno">   67</span>    <span class="stringliteral">&quot;&quot;&quot;Empirically select a good initial step.</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    The algorithm is described in [1]_.</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">    fun : callable</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        Right-hand side of the system.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    t0 : float</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        Initial value of the independent variable.</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    y0 : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        Initial value of the dependent variable.</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    f0 : ndarray, shape (n,)</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">        Initial value of the derivative, i.e., ``fun(t0, y0)``.</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    direction : float</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">        Integration direction.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    order : float</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">        Error estimator order. It means that the error controlled by the</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        algorithm is proportional to ``step_size ** (order + 1)`.</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">    rtol : float</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        Desired relative tolerance.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    atol : float</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">        Desired absolute tolerance.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    h_abs : float</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">        Absolute value of the suggested initial step.</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    .. [1] E. Hairer, S. P. Norsett G. Wanner, &quot;Solving Ordinary Differential</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">           Equations I: Nonstiff Problems&quot;, Sec. II.4.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">if</span> y0.size == 0:</div>
<div class="line"><span class="lineno">  102</span>        <span class="keywordflow">return</span> np.inf</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    scale = atol + np.abs(y0) * rtol</div>
<div class="line"><span class="lineno">  105</span>    d0 = norm(y0 / scale)</div>
<div class="line"><span class="lineno">  106</span>    d1 = norm(f0 / scale)</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span> d0 &lt; 1e-5 <span class="keywordflow">or</span> d1 &lt; 1e-5:</div>
<div class="line"><span class="lineno">  108</span>        h0 = 1e-6</div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  110</span>        h0 = 0.01 * d0 / d1</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    y1 = y0 + h0 * direction * f0</div>
<div class="line"><span class="lineno">  113</span>    f1 = fun(t0 + h0 * direction, y1)</div>
<div class="line"><span class="lineno">  114</span>    d2 = norm((f1 - f0) / scale) / h0</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">if</span> d1 &lt;= 1e-15 <span class="keywordflow">and</span> d2 &lt;= 1e-15:</div>
<div class="line"><span class="lineno">  117</span>        h1 = max(1e-6, h0 * 1e-3)</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  119</span>        h1 = (0.01 / max(d1, d2)) ** (1 / (order + 1))</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">return</span> min(100 * h0, h1)</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa028a0075b67bd9c7c10dc030e804528" name="aa028a0075b67bd9c7c10dc030e804528"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa028a0075b67bd9c7c10dc030e804528">&#9670;&#160;</a></span>validate_first_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common.validate_first_step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>first_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t_bound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Assert that first_step is valid and return it.</pre> <div class="fragment"><div class="line"><span class="lineno">   10</span><span class="keyword">def </span>validate_first_step(first_step, t0, t_bound):</div>
<div class="line"><span class="lineno">   11</span>    <span class="stringliteral">&quot;&quot;&quot;Assert that first_step is valid and return it.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   12</span>    <span class="keywordflow">if</span> first_step &lt;= 0:</div>
<div class="line"><span class="lineno">   13</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`first_step` must be positive.&quot;</span>)</div>
<div class="line"><span class="lineno">   14</span>    <span class="keywordflow">if</span> first_step &gt; np.abs(t_bound - t0):</div>
<div class="line"><span class="lineno">   15</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`first_step` exceeds bounds.&quot;</span>)</div>
<div class="line"><span class="lineno">   16</span>    <span class="keywordflow">return</span> first_step</div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a469f4e852e90b35ef087ded6677de228" name="a469f4e852e90b35ef087ded6677de228"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a469f4e852e90b35ef087ded6677de228">&#9670;&#160;</a></span>validate_max_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common.validate_max_step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_step</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Assert that max_Step is valid and return it.</pre> <div class="fragment"><div class="line"><span class="lineno">   19</span><span class="keyword">def </span>validate_max_step(max_step):</div>
<div class="line"><span class="lineno">   20</span>    <span class="stringliteral">&quot;&quot;&quot;Assert that max_Step is valid and return it.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   21</span>    <span class="keywordflow">if</span> max_step &lt;= 0:</div>
<div class="line"><span class="lineno">   22</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`max_step` must be positive.&quot;</span>)</div>
<div class="line"><span class="lineno">   23</span>    <span class="keywordflow">return</span> max_step</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6828351fc511f9fe00e722bae893cc7a" name="a6828351fc511f9fe00e722bae893cc7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6828351fc511f9fe00e722bae893cc7a">&#9670;&#160;</a></span>validate_tol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common.validate_tol </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>atol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Validate tolerance values.</pre> <div class="fragment"><div class="line"><span class="lineno">   43</span><span class="keyword">def </span>validate_tol(rtol, atol, n):</div>
<div class="line"><span class="lineno">   44</span>    <span class="stringliteral">&quot;&quot;&quot;Validate tolerance values.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">if</span> np.any(rtol &lt; 100 * EPS):</div>
<div class="line"><span class="lineno">   47</span>        warn(<span class="stringliteral">&quot;At least one element of `rtol` is too small. &quot;</span></div>
<div class="line"><span class="lineno">   48</span>             f<span class="stringliteral">&quot;Setting `rtol = np.maximum(rtol, {100 * EPS})`.&quot;</span>)</div>
<div class="line"><span class="lineno">   49</span>        rtol = np.maximum(rtol, 100 * EPS)</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    atol = np.asarray(atol)</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">if</span> atol.ndim &gt; 0 <span class="keywordflow">and</span> atol.shape != (n,):</div>
<div class="line"><span class="lineno">   53</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`atol` has wrong shape.&quot;</span>)</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">if</span> np.any(atol &lt; 0):</div>
<div class="line"><span class="lineno">   56</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;`atol` must be positive.&quot;</span>)</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">return</span> rtol, atol</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a323627182fd010a78735697f4d87dfd2" name="a323627182fd010a78735697f4d87dfd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a323627182fd010a78735697f4d87dfd2">&#9670;&#160;</a></span>warn_extraneous()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common.warn_extraneous </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>extraneous</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Display a warning for extraneous keyword arguments.

The initializer of each solver class is expected to collect keyword
arguments that it doesn't understand and warn about them. This function
prints a warning for each key in the supplied dictionary.

Parameters
----------
extraneous : dict
    Extraneous keyword arguments
</pre> <div class="fragment"><div class="line"><span class="lineno">   26</span><span class="keyword">def </span>warn_extraneous(extraneous):</div>
<div class="line"><span class="lineno">   27</span>    <span class="stringliteral">&quot;&quot;&quot;Display a warning for extraneous keyword arguments.</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">    The initializer of each solver class is expected to collect keyword</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    arguments that it doesn&#39;t understand and warn about them. This function</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">    prints a warning for each key in the supplied dictionary.</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">    extraneous : dict</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">        Extraneous keyword arguments</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">if</span> extraneous:</div>
<div class="line"><span class="lineno">   39</span>        warn(<span class="stringliteral">&quot;The following arguments have no effect for a chosen solver: {}.&quot;</span></div>
<div class="line"><span class="lineno">   40</span>             .format(<span class="stringliteral">&quot;, &quot;</span>.join(<span class="stringliteral">&quot;`{}`&quot;</span>.format(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> extraneous)))</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a75356e524626e94596f23fa8336ae8b3" name="a75356e524626e94596f23fa8336ae8b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75356e524626e94596f23fa8336ae8b3">&#9670;&#160;</a></span>EPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.integrate._ivp.common.EPS = np.finfo(float).<a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6117895424bec662d1cefd204f62a2c5" name="a6117895424bec662d1cefd204f62a2c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6117895424bec662d1cefd204f62a2c5">&#9670;&#160;</a></span>NUM_JAC_DIFF_BIG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float scipy.integrate._ivp.common.NUM_JAC_DIFF_BIG = <a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a> ** 0.25</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae2e7331b4d57feabecda6eb41e6a895a" name="ae2e7331b4d57feabecda6eb41e6a895a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e7331b4d57feabecda6eb41e6a895a">&#9670;&#160;</a></span>NUM_JAC_DIFF_REJECT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float scipy.integrate._ivp.common.NUM_JAC_DIFF_REJECT = <a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a> ** 0.875</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a123a65e3fd86bf7f218534cc8e6e3c8c" name="a123a65e3fd86bf7f218534cc8e6e3c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a123a65e3fd86bf7f218534cc8e6e3c8c">&#9670;&#160;</a></span>NUM_JAC_DIFF_SMALL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float scipy.integrate._ivp.common.NUM_JAC_DIFF_SMALL = <a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a> ** 0.75</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac7b77a57b5e518546320ae51c54e3cb8" name="ac7b77a57b5e518546320ae51c54e3cb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7b77a57b5e518546320ae51c54e3cb8">&#9670;&#160;</a></span>NUM_JAC_FACTOR_DECREASE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float scipy.integrate._ivp.common.NUM_JAC_FACTOR_DECREASE = 0.1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3017f23453ce7e7f13ad3c2f8e27da0e" name="a3017f23453ce7e7f13ad3c2f8e27da0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3017f23453ce7e7f13ad3c2f8e27da0e">&#9670;&#160;</a></span>NUM_JAC_FACTOR_INCREASE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scipy.integrate._ivp.common.NUM_JAC_FACTOR_INCREASE = 10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1907d1498d8202c2944d39dc570812ed" name="a1907d1498d8202c2944d39dc570812ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1907d1498d8202c2944d39dc570812ed">&#9670;&#160;</a></span>NUM_JAC_MIN_FACTOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scipy.integrate._ivp.common.NUM_JAC_MIN_FACTOR = 1e3 * <a class="el" href="namespacescipy_1_1integrate_1_1__ivp_1_1common.html#a75356e524626e94596f23fa8336ae8b3">EPS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
