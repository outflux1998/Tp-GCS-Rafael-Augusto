<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize.tests.test_minpack.TestCurveFit Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1tests_1_1test__minpack.html">test_minpack</a></li><li class="navelem"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html">TestCurveFit</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize.tests.test_minpack.TestCurveFit Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aeeaa13c990638bd89b8a58d323940876" id="r_aeeaa13c990638bd89b8a58d323940876"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#aeeaa13c990638bd89b8a58d323940876">setup_method</a> (self)</td></tr>
<tr class="separator:aeeaa13c990638bd89b8a58d323940876"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be19b23b40e97abc44a0b1c1235db28" id="r_a2be19b23b40e97abc44a0b1c1235db28"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a2be19b23b40e97abc44a0b1c1235db28">test_one_argument</a> (self)</td></tr>
<tr class="separator:a2be19b23b40e97abc44a0b1c1235db28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63a811a4114b57f94ad05d5d0b4ab0f7" id="r_a63a811a4114b57f94ad05d5d0b4ab0f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a63a811a4114b57f94ad05d5d0b4ab0f7">test_two_argument</a> (self)</td></tr>
<tr class="separator:a63a811a4114b57f94ad05d5d0b4ab0f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed79afdbb55e3f93bc051854c2b7b984" id="r_aed79afdbb55e3f93bc051854c2b7b984"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#aed79afdbb55e3f93bc051854c2b7b984">test_func_is_classmethod</a> (self)</td></tr>
<tr class="separator:aed79afdbb55e3f93bc051854c2b7b984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5517e3dad1d52ccc22b5d1b260c8ac4" id="r_ac5517e3dad1d52ccc22b5d1b260c8ac4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#ac5517e3dad1d52ccc22b5d1b260c8ac4">test_regression_2639</a> (self)</td></tr>
<tr class="separator:ac5517e3dad1d52ccc22b5d1b260c8ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c48dbcdf701679579a8540c8a607f9" id="r_ae8c48dbcdf701679579a8540c8a607f9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#ae8c48dbcdf701679579a8540c8a607f9">test_pcov</a> (self)</td></tr>
<tr class="separator:ae8c48dbcdf701679579a8540c8a607f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4ef007c66182cf11e63d681bc39f735" id="r_ae4ef007c66182cf11e63d681bc39f735"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#ae4ef007c66182cf11e63d681bc39f735">test_array_like</a> (self)</td></tr>
<tr class="separator:ae4ef007c66182cf11e63d681bc39f735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06e9d918875acbe300e369ed647f111" id="r_ae06e9d918875acbe300e369ed647f111"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#ae06e9d918875acbe300e369ed647f111">test_indeterminate_covariance</a> (self)</td></tr>
<tr class="separator:ae06e9d918875acbe300e369ed647f111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c74dbeb5a25a5346437397ccb9bbe82" id="r_a9c74dbeb5a25a5346437397ccb9bbe82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a9c74dbeb5a25a5346437397ccb9bbe82">test_NaN_handling</a> (self)</td></tr>
<tr class="separator:a9c74dbeb5a25a5346437397ccb9bbe82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedfe4f26753ba1437ad6fd42aa358a9c" id="r_aedfe4f26753ba1437ad6fd42aa358a9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#aedfe4f26753ba1437ad6fd42aa358a9c">test_empty_inputs</a> (self)</td></tr>
<tr class="separator:aedfe4f26753ba1437ad6fd42aa358a9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4845ade9f2107265d913e05722af48e3" id="r_a4845ade9f2107265d913e05722af48e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a4845ade9f2107265d913e05722af48e3">test_function_zero_params</a> (self)</td></tr>
<tr class="separator:a4845ade9f2107265d913e05722af48e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01417cef5e575611dd74154ae90d3eb8" id="r_a01417cef5e575611dd74154ae90d3eb8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a01417cef5e575611dd74154ae90d3eb8">test_None_x</a> (self)</td></tr>
<tr class="separator:a01417cef5e575611dd74154ae90d3eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47305ddd22e88343b094c617cc6e465d" id="r_a47305ddd22e88343b094c617cc6e465d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a47305ddd22e88343b094c617cc6e465d">test_method_argument</a> (self)</td></tr>
<tr class="separator:a47305ddd22e88343b094c617cc6e465d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3126b480ac55ecd79fbbc986d15349e3" id="r_a3126b480ac55ecd79fbbc986d15349e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a3126b480ac55ecd79fbbc986d15349e3">test_full_output</a> (self)</td></tr>
<tr class="separator:a3126b480ac55ecd79fbbc986d15349e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a082b21578a6d260adc54cdf9ed16d661" id="r_a082b21578a6d260adc54cdf9ed16d661"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a082b21578a6d260adc54cdf9ed16d661">test_bounds</a> (self)</td></tr>
<tr class="separator:a082b21578a6d260adc54cdf9ed16d661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7a5803fed0b4958862e2c84eff136e6" id="r_ae7a5803fed0b4958862e2c84eff136e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#ae7a5803fed0b4958862e2c84eff136e6">test_bounds_p0</a> (self)</td></tr>
<tr class="separator:ae7a5803fed0b4958862e2c84eff136e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05741c34b7101947d572614a3b797462" id="r_a05741c34b7101947d572614a3b797462"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a05741c34b7101947d572614a3b797462">test_jac</a> (self)</td></tr>
<tr class="separator:a05741c34b7101947d572614a3b797462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc64354085f6eb927d74e264dc85150b" id="r_acc64354085f6eb927d74e264dc85150b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#acc64354085f6eb927d74e264dc85150b">test_maxfev_and_bounds</a> (self)</td></tr>
<tr class="separator:acc64354085f6eb927d74e264dc85150b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17e240b3d224a871906e58329a373804" id="r_a17e240b3d224a871906e58329a373804"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a17e240b3d224a871906e58329a373804">test_curvefit_simplecovariance</a> (self)</td></tr>
<tr class="separator:a17e240b3d224a871906e58329a373804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bf73afe22fca02c9c805f816f730b8c" id="r_a9bf73afe22fca02c9c805f816f730b8c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a9bf73afe22fca02c9c805f816f730b8c">test_curvefit_covariance</a> (self)</td></tr>
<tr class="separator:a9bf73afe22fca02c9c805f816f730b8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f3f2b0be0b0f88ec582ab7039880b29" id="r_a5f3f2b0be0b0f88ec582ab7039880b29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a5f3f2b0be0b0f88ec582ab7039880b29">test_dtypes</a> (self)</td></tr>
<tr class="separator:a5f3f2b0be0b0f88ec582ab7039880b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1048ff010cfae595b326d86c2f04a56e" id="r_a1048ff010cfae595b326d86c2f04a56e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a1048ff010cfae595b326d86c2f04a56e">test_dtypes2</a> (self)</td></tr>
<tr class="separator:a1048ff010cfae595b326d86c2f04a56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411d9befa288c06cb70c553331264060" id="r_a411d9befa288c06cb70c553331264060"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a411d9befa288c06cb70c553331264060">test_broadcast_y</a> (self)</td></tr>
<tr class="separator:a411d9befa288c06cb70c553331264060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bc536ee17677616bae469c0673ca64e" id="r_a0bc536ee17677616bae469c0673ca64e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a0bc536ee17677616bae469c0673ca64e">test_args_in_kwargs</a> (self)</td></tr>
<tr class="separator:a0bc536ee17677616bae469c0673ca64e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab827870df333d8ebdb971a996894d538" id="r_ab827870df333d8ebdb971a996894d538"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#ab827870df333d8ebdb971a996894d538">test_data_point_number_validation</a> (self)</td></tr>
<tr class="separator:ab827870df333d8ebdb971a996894d538"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:adc82bfce284abde91c7c24a9b6a4f122" id="r_adc82bfce284abde91c7c24a9b6a4f122"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#adc82bfce284abde91c7c24a9b6a4f122">y</a></td></tr>
<tr class="separator:adc82bfce284abde91c7c24a9b6a4f122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c8c53c5ee6473638ff154ad04d0468" id="r_a32c8c53c5ee6473638ff154ad04d0468"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1tests_1_1test__minpack_1_1_test_curve_fit.html#a32c8c53c5ee6473638ff154ad04d0468">x</a></td></tr>
<tr class="separator:a32c8c53c5ee6473638ff154ad04d0468"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aeeaa13c990638bd89b8a58d323940876" name="aeeaa13c990638bd89b8a58d323940876"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeeaa13c990638bd89b8a58d323940876">&#9670;&#160;</a></span>setup_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.setup_method </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  404</span>    <span class="keyword">def </span>setup_method(self):</div>
<div class="line"><span class="lineno">  405</span>        self.y = array([1.0, 3.2, 9.5, 13.7])</div>
<div class="line"><span class="lineno">  406</span>        self.x = array([1.0, 2.0, 3.0, 4.0])</div>
<div class="line"><span class="lineno">  407</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bc536ee17677616bae469c0673ca64e" name="a0bc536ee17677616bae469c0673ca64e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bc536ee17677616bae469c0673ca64e">&#9670;&#160;</a></span>test_args_in_kwargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_args_in_kwargs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  822</span>    <span class="keyword">def </span>test_args_in_kwargs(self):</div>
<div class="line"><span class="lineno">  823</span>        <span class="comment"># Ensure that `args` cannot be passed as keyword argument to `curve_fit`</span></div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>        <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x, a, b):</div>
<div class="line"><span class="lineno">  826</span>            <span class="keywordflow">return</span> a * x + b</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>        <span class="keyword">with</span> assert_raises(ValueError):</div>
<div class="line"><span class="lineno">  829</span>            curve_fit(func,</div>
<div class="line"><span class="lineno">  830</span>                      xdata=[1, 2, 3, 4],</div>
<div class="line"><span class="lineno">  831</span>                      ydata=[5, 9, 13, 17],</div>
<div class="line"><span class="lineno">  832</span>                      p0=[1],</div>
<div class="line"><span class="lineno">  833</span>                      args=(1,))</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4ef007c66182cf11e63d681bc39f735" name="ae4ef007c66182cf11e63d681bc39f735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4ef007c66182cf11e63d681bc39f735">&#9670;&#160;</a></span>test_array_like()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_array_like </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  517</span>    <span class="keyword">def </span>test_array_like(self):</div>
<div class="line"><span class="lineno">  518</span>        <span class="comment"># Test sequence input. Regression test for gh-3037.</span></div>
<div class="line"><span class="lineno">  519</span>        <span class="keyword">def </span>f_linear(x, a, b):</div>
<div class="line"><span class="lineno">  520</span>            <span class="keywordflow">return</span> a*x + b</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>        x = [1, 2, 3, 4]</div>
<div class="line"><span class="lineno">  523</span>        y = [3, 5, 7, 9]</div>
<div class="line"><span class="lineno">  524</span>        assert_allclose(curve_fit(f_linear, x, y)[0], [2, 1], atol=1e-10)</div>
<div class="line"><span class="lineno">  525</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a082b21578a6d260adc54cdf9ed16d661" name="a082b21578a6d260adc54cdf9ed16d661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a082b21578a6d260adc54cdf9ed16d661">&#9670;&#160;</a></span>test_bounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_bounds </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  599</span>    <span class="keyword">def </span>test_bounds(self):</div>
<div class="line"><span class="lineno">  600</span>        <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x, a, b):</div>
<div class="line"><span class="lineno">  601</span>            <span class="keywordflow">return</span> a * np.exp(-b*x)</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>        xdata = np.linspace(0, 1, 11)</div>
<div class="line"><span class="lineno">  604</span>        ydata = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(xdata, 2., 2.)</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>        <span class="comment"># The minimum w/out bounds is at [2., 2.],</span></div>
<div class="line"><span class="lineno">  607</span>        <span class="comment"># and with bounds it&#39;s at [1.5, smth].</span></div>
<div class="line"><span class="lineno">  608</span>        bounds = ([1., 0], [1.5, 3.])</div>
<div class="line"><span class="lineno">  609</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="keywordtype">None</span>, <span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>]:</div>
<div class="line"><span class="lineno">  610</span>            popt, pcov = curve_fit(f, xdata, ydata, bounds=bounds,</div>
<div class="line"><span class="lineno">  611</span>                                   method=method)</div>
<div class="line"><span class="lineno">  612</span>            assert_allclose(popt[0], 1.5)</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>        <span class="comment"># With bounds, the starting estimate is feasible.</span></div>
<div class="line"><span class="lineno">  615</span>        popt, pcov = curve_fit(f, xdata, ydata, method=<span class="stringliteral">&#39;trf&#39;</span>,</div>
<div class="line"><span class="lineno">  616</span>                               bounds=([0., 0], [0.6, np.inf]))</div>
<div class="line"><span class="lineno">  617</span>        assert_allclose(popt[0], 0.6)</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>        <span class="comment"># method=&#39;lm&#39; doesn&#39;t support bounds.</span></div>
<div class="line"><span class="lineno">  620</span>        assert_raises(ValueError, curve_fit, f, xdata, ydata, bounds=bounds,</div>
<div class="line"><span class="lineno">  621</span>                      method=<span class="stringliteral">&#39;lm&#39;</span>)</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_af01a903df7bdb7a494f5827e45bf3a2a"><div class="ttname"><a href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a></div><div class="ttdeci">void int int int int npy_complex64 int int npy_complex64 float float npy_complex64 npy_complex64 * f</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:262</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7a5803fed0b4958862e2c84eff136e6" name="ae7a5803fed0b4958862e2c84eff136e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7a5803fed0b4958862e2c84eff136e6">&#9670;&#160;</a></span>test_bounds_p0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_bounds_p0 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  623</span>    <span class="keyword">def </span>test_bounds_p0(self):</div>
<div class="line"><span class="lineno">  624</span>        <span class="comment"># This test is for issue #5719. The problem was that an initial guess</span></div>
<div class="line"><span class="lineno">  625</span>        <span class="comment"># was ignored when &#39;trf&#39; or &#39;dogbox&#39; methods were invoked.</span></div>
<div class="line"><span class="lineno">  626</span>        <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x, a):</div>
<div class="line"><span class="lineno">  627</span>            <span class="keywordflow">return</span> np.sin(x + a)</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>        xdata = np.linspace(-2*np.pi, 2*np.pi, 40)</div>
<div class="line"><span class="lineno">  630</span>        ydata = np.sin(xdata)</div>
<div class="line"><span class="lineno">  631</span>        bounds = (-3 * np.pi, 3 * np.pi)</div>
<div class="line"><span class="lineno">  632</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>]:</div>
<div class="line"><span class="lineno">  633</span>            popt_1, _ = curve_fit(f, xdata, ydata, p0=2.1*np.pi)</div>
<div class="line"><span class="lineno">  634</span>            popt_2, _ = curve_fit(f, xdata, ydata, p0=2.1*np.pi,</div>
<div class="line"><span class="lineno">  635</span>                                  bounds=bounds, method=method)</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>            <span class="comment"># If the initial guess is ignored, then popt_2 would be close 0.</span></div>
<div class="line"><span class="lineno">  638</span>            assert_allclose(popt_1, popt_2)</div>
<div class="line"><span class="lineno">  639</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a411d9befa288c06cb70c553331264060" name="a411d9befa288c06cb70c553331264060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a411d9befa288c06cb70c553331264060">&#9670;&#160;</a></span>test_broadcast_y()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_broadcast_y </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  807</span>    <span class="keyword">def </span>test_broadcast_y(self):</div>
<div class="line"><span class="lineno">  808</span>        xdata = np.arange(10)</div>
<div class="line"><span class="lineno">  809</span>        target = 4.7 * xdata ** 2 + 3.5 * xdata + np.random.rand(len(xdata))</div>
<div class="line"><span class="lineno">  810</span>        fit_func = <span class="keyword">lambda</span> x, a, b: a*x**2 + b*x - target</div>
<div class="line"><span class="lineno">  811</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;lm&#39;</span>, <span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>]:</div>
<div class="line"><span class="lineno">  812</span>            popt0, pcov0 = curve_fit(fit_func,</div>
<div class="line"><span class="lineno">  813</span>                                     xdata=xdata,</div>
<div class="line"><span class="lineno">  814</span>                                     ydata=np.zeros_like(xdata),</div>
<div class="line"><span class="lineno">  815</span>                                     method=method)</div>
<div class="line"><span class="lineno">  816</span>            popt1, pcov1 = curve_fit(fit_func,</div>
<div class="line"><span class="lineno">  817</span>                                     xdata=xdata,</div>
<div class="line"><span class="lineno">  818</span>                                     ydata=0,</div>
<div class="line"><span class="lineno">  819</span>                                     method=method)</div>
<div class="line"><span class="lineno">  820</span>            assert_allclose(pcov0, pcov1)</div>
<div class="line"><span class="lineno">  821</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bf73afe22fca02c9c805f816f730b8c" name="a9bf73afe22fca02c9c805f816f730b8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bf73afe22fca02c9c805f816f730b8c">&#9670;&#160;</a></span>test_curvefit_covariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_curvefit_covariance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  714</span>    <span class="keyword">def </span>test_curvefit_covariance(self):</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>        <span class="keyword">def </span>funcp(x, a, b):</div>
<div class="line"><span class="lineno">  717</span>            rotn = np.array([[1./np.sqrt(2), -1./np.sqrt(2), 0], [1./np.sqrt(2), 1./np.sqrt(2), 0], [0, 0, 1.0]])</div>
<div class="line"><span class="lineno">  718</span>            <span class="keywordflow">return</span> rotn.dot(a * np.exp(-b*x))</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>        <span class="keyword">def </span>jacp(x, a, b):</div>
<div class="line"><span class="lineno">  721</span>            rotn = np.array([[1./np.sqrt(2), -1./np.sqrt(2), 0], [1./np.sqrt(2), 1./np.sqrt(2), 0], [0, 0, 1.0]])</div>
<div class="line"><span class="lineno">  722</span>            e = np.exp(-b*x)</div>
<div class="line"><span class="lineno">  723</span>            <span class="keywordflow">return</span> rotn.dot(np.vstack((e, -a * x * e)).T)</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>        <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x, a, b):</div>
<div class="line"><span class="lineno">  726</span>            <span class="keywordflow">return</span> a * np.exp(-b*x)</div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span>        <span class="keyword">def </span>jac(x, a, b):</div>
<div class="line"><span class="lineno">  729</span>            e = np.exp(-b*x)</div>
<div class="line"><span class="lineno">  730</span>            <span class="keywordflow">return</span> np.vstack((e, -a * x * e)).T</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno">  733</span>        xdata = np.arange(1, 4)</div>
<div class="line"><span class="lineno">  734</span>        y = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xdata, 2.5, 1.0)</div>
<div class="line"><span class="lineno">  735</span>        ydata = y + 0.2 * np.random.normal(size=len(xdata))</div>
<div class="line"><span class="lineno">  736</span>        sigma = np.zeros(len(xdata)) + 0.2</div>
<div class="line"><span class="lineno">  737</span>        covar = np.diag(sigma**2)</div>
<div class="line"><span class="lineno">  738</span>        <span class="comment"># Get a rotation matrix, and obtain ydatap = R ydata</span></div>
<div class="line"><span class="lineno">  739</span>        <span class="comment"># Chisq = ydata^T C^{-1} ydata</span></div>
<div class="line"><span class="lineno">  740</span>        <span class="comment">#       = ydata^T R^T R C^{-1} R^T R ydata</span></div>
<div class="line"><span class="lineno">  741</span>        <span class="comment">#       = ydatap^T Cp^{-1} ydatap</span></div>
<div class="line"><span class="lineno">  742</span>        <span class="comment"># Cp^{-1} = R C^{-1} R^T</span></div>
<div class="line"><span class="lineno">  743</span>        <span class="comment"># Cp      = R C R^T, since R^-1 = R^T</span></div>
<div class="line"><span class="lineno">  744</span>        rotn = np.array([[1./np.sqrt(2), -1./np.sqrt(2), 0], [1./np.sqrt(2), 1./np.sqrt(2), 0], [0, 0, 1.0]])</div>
<div class="line"><span class="lineno">  745</span>        ydatap = rotn.dot(ydata)</div>
<div class="line"><span class="lineno">  746</span>        covarp = rotn.dot(covar).dot(rotn.T)</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">for</span> jac1, jac2 <span class="keywordflow">in</span> [(jac, jacp), (<span class="keywordtype">None</span>, <span class="keywordtype">None</span>)]:</div>
<div class="line"><span class="lineno">  749</span>            <span class="keywordflow">for</span> absolute_sigma <span class="keywordflow">in</span> [<span class="keyword">False</span>, <span class="keyword">True</span>]:</div>
<div class="line"><span class="lineno">  750</span>                popt1, pcov1 = curve_fit(func, xdata, ydata, sigma=sigma,</div>
<div class="line"><span class="lineno">  751</span>                        jac=jac1, absolute_sigma=absolute_sigma)</div>
<div class="line"><span class="lineno">  752</span>                popt2, pcov2 = curve_fit(funcp, xdata, ydatap, sigma=covarp,</div>
<div class="line"><span class="lineno">  753</span>                        jac=jac2, absolute_sigma=absolute_sigma)</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>                assert_allclose(popt1, popt2, rtol=1.2e-7, atol=1e-14)</div>
<div class="line"><span class="lineno">  756</span>                assert_allclose(pcov1, pcov2, rtol=1.2e-7, atol=1e-14)</div>
<div class="line"><span class="lineno">  757</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a17e240b3d224a871906e58329a373804" name="a17e240b3d224a871906e58329a373804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e240b3d224a871906e58329a373804">&#9670;&#160;</a></span>test_curvefit_simplecovariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_curvefit_simplecovariance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  687</span>    <span class="keyword">def </span>test_curvefit_simplecovariance(self):</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>        <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x, a, b):</div>
<div class="line"><span class="lineno">  690</span>            <span class="keywordflow">return</span> a * np.exp(-b*x)</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>        <span class="keyword">def </span>jac(x, a, b):</div>
<div class="line"><span class="lineno">  693</span>            e = np.exp(-b*x)</div>
<div class="line"><span class="lineno">  694</span>            <span class="keywordflow">return</span> np.vstack((e, -a * x * e)).T</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>        np.random.seed(0)</div>
<div class="line"><span class="lineno">  697</span>        xdata = np.linspace(0, 4, 50)</div>
<div class="line"><span class="lineno">  698</span>        y = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xdata, 2.5, 1.3)</div>
<div class="line"><span class="lineno">  699</span>        ydata = y + 0.2 * np.random.normal(size=len(xdata))</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>        sigma = np.zeros(len(xdata)) + 0.2</div>
<div class="line"><span class="lineno">  702</span>        covar = np.diag(sigma**2)</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>        <span class="keywordflow">for</span> jac1, jac2 <span class="keywordflow">in</span> [(jac, jac), (<span class="keywordtype">None</span>, <span class="keywordtype">None</span>)]:</div>
<div class="line"><span class="lineno">  705</span>            <span class="keywordflow">for</span> absolute_sigma <span class="keywordflow">in</span> [<span class="keyword">False</span>, <span class="keyword">True</span>]:</div>
<div class="line"><span class="lineno">  706</span>                popt1, pcov1 = curve_fit(func, xdata, ydata, sigma=sigma,</div>
<div class="line"><span class="lineno">  707</span>                        jac=jac1, absolute_sigma=absolute_sigma)</div>
<div class="line"><span class="lineno">  708</span>                popt2, pcov2 = curve_fit(func, xdata, ydata, sigma=covar,</div>
<div class="line"><span class="lineno">  709</span>                        jac=jac2, absolute_sigma=absolute_sigma)</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>                assert_allclose(popt1, popt2, atol=1e-14)</div>
<div class="line"><span class="lineno">  712</span>                assert_allclose(pcov1, pcov2, atol=1e-14)</div>
<div class="line"><span class="lineno">  713</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab827870df333d8ebdb971a996894d538" name="ab827870df333d8ebdb971a996894d538"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab827870df333d8ebdb971a996894d538">&#9670;&#160;</a></span>test_data_point_number_validation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_data_point_number_validation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  835</span>    <span class="keyword">def </span>test_data_point_number_validation(self):</div>
<div class="line"><span class="lineno">  836</span>        <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x, a, b, c, d, e):</div>
<div class="line"><span class="lineno">  837</span>            <span class="keywordflow">return</span> a * np.exp(-b * x) + c + d + e</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>        <span class="keyword">with</span> assert_raises(TypeError, match=<span class="stringliteral">&quot;The number of func parameters=&quot;</span>):</div>
<div class="line"><span class="lineno">  840</span>            curve_fit(func,</div>
<div class="line"><span class="lineno">  841</span>                      xdata=[1, 2, 3, 4],</div>
<div class="line"><span class="lineno">  842</span>                      ydata=[5, 9, 13, 17])</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f3f2b0be0b0f88ec582ab7039880b29" name="a5f3f2b0be0b0f88ec582ab7039880b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f3f2b0be0b0f88ec582ab7039880b29">&#9670;&#160;</a></span>test_dtypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_dtypes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  758</span>    <span class="keyword">def </span>test_dtypes(self):</div>
<div class="line"><span class="lineno">  759</span>        <span class="comment"># regression test for gh-9581: curve_fit fails if x and y dtypes differ</span></div>
<div class="line"><span class="lineno">  760</span>        x = np.arange(-3, 5)</div>
<div class="line"><span class="lineno">  761</span>        y = 1.5*x + 3.0 + 0.5*np.sin(x)</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>        <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x, a, b):</div>
<div class="line"><span class="lineno">  764</span>            <span class="keywordflow">return</span> a*x + b</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;lm&#39;</span>, <span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>]:</div>
<div class="line"><span class="lineno">  767</span>            <span class="keywordflow">for</span> dtx <span class="keywordflow">in</span> [np.float32, np.float64]:</div>
<div class="line"><span class="lineno">  768</span>                <span class="keywordflow">for</span> dty <span class="keywordflow">in</span> [np.float32, np.float64]:</div>
<div class="line"><span class="lineno">  769</span>                    x = x.astype(dtx)</div>
<div class="line"><span class="lineno">  770</span>                    y = y.astype(dty)</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>                <span class="keyword">with</span> warnings.catch_warnings():</div>
<div class="line"><span class="lineno">  773</span>                    warnings.simplefilter(<span class="stringliteral">&quot;error&quot;</span>, OptimizeWarning)</div>
<div class="line"><span class="lineno">  774</span>                    p, cov = curve_fit(func, x, y, method=method)</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>                    <span class="keyword">assert</span> np.isfinite(cov).all()</div>
<div class="line"><span class="lineno">  777</span>                    <span class="keyword">assert</span> <span class="keywordflow">not</span> np.allclose(p, 1)   <span class="comment"># curve_fit&#39;s initial value</span></div>
<div class="line"><span class="lineno">  778</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1048ff010cfae595b326d86c2f04a56e" name="a1048ff010cfae595b326d86c2f04a56e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1048ff010cfae595b326d86c2f04a56e">&#9670;&#160;</a></span>test_dtypes2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_dtypes2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  779</span>    <span class="keyword">def </span>test_dtypes2(self):</div>
<div class="line"><span class="lineno">  780</span>        <span class="comment"># regression test for gh-7117: curve_fit fails if</span></div>
<div class="line"><span class="lineno">  781</span>        <span class="comment"># both inputs are float32</span></div>
<div class="line"><span class="lineno">  782</span>        <span class="keyword">def </span>hyperbola(x, s_1, s_2, o_x, o_y, c):</div>
<div class="line"><span class="lineno">  783</span>            b_2 = (s_1 + s_2) / 2</div>
<div class="line"><span class="lineno">  784</span>            b_1 = (s_2 - s_1) / 2</div>
<div class="line"><span class="lineno">  785</span>            <span class="keywordflow">return</span> o_y + b_1*(x-o_x) + b_2*np.sqrt((x-o_x)**2 + c**2/4)</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>        min_fit = np.array([-3.0, 0.0, -2.0, -10.0, 0.0])</div>
<div class="line"><span class="lineno">  788</span>        max_fit = np.array([0.0, 3.0, 3.0, 0.0, 10.0])</div>
<div class="line"><span class="lineno">  789</span>        guess = np.array([-2.5/3.0, 4/3.0, 1.0, -4.0, 0.5])</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>        params = [-2, .4, -1, -5, 9.5]</div>
<div class="line"><span class="lineno">  792</span>        xdata = np.array([-32, -16, -8, 4, 4, 8, 16, 32])</div>
<div class="line"><span class="lineno">  793</span>        ydata = hyperbola(xdata, *params)</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>        <span class="comment"># run optimization twice, with xdata being float32 and float64</span></div>
<div class="line"><span class="lineno">  796</span>        popt_64, _ = curve_fit(f=hyperbola, xdata=xdata, ydata=ydata, p0=guess,</div>
<div class="line"><span class="lineno">  797</span>                               bounds=(min_fit, max_fit))</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>        xdata = xdata.astype(np.float32)</div>
<div class="line"><span class="lineno">  800</span>        ydata = hyperbola(xdata, *params)</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>        popt_32, _ = curve_fit(f=hyperbola, xdata=xdata, ydata=ydata, p0=guess,</div>
<div class="line"><span class="lineno">  803</span>                               bounds=(min_fit, max_fit))</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>        assert_allclose(popt_32, popt_64, atol=2e-5)</div>
<div class="line"><span class="lineno">  806</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aedfe4f26753ba1437ad6fd42aa358a9c" name="aedfe4f26753ba1437ad6fd42aa358a9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedfe4f26753ba1437ad6fd42aa358a9c">&#9670;&#160;</a></span>test_empty_inputs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_empty_inputs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  548</span>    <span class="keyword">def </span>test_empty_inputs(self):</div>
<div class="line"><span class="lineno">  549</span>        <span class="comment"># Test both with and without bounds (regression test for gh-9864)</span></div>
<div class="line"><span class="lineno">  550</span>        assert_raises(ValueError, curve_fit, <span class="keyword">lambda</span> x, a: a*x, [], [])</div>
<div class="line"><span class="lineno">  551</span>        assert_raises(ValueError, curve_fit, <span class="keyword">lambda</span> x, a: a*x, [], [],</div>
<div class="line"><span class="lineno">  552</span>                      bounds=(1, 2))</div>
<div class="line"><span class="lineno">  553</span>        assert_raises(ValueError, curve_fit, <span class="keyword">lambda</span> x, a: a*x, [1], [])</div>
<div class="line"><span class="lineno">  554</span>        assert_raises(ValueError, curve_fit, <span class="keyword">lambda</span> x, a: a*x, [2], [],</div>
<div class="line"><span class="lineno">  555</span>                      bounds=(1, 2))</div>
<div class="line"><span class="lineno">  556</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3126b480ac55ecd79fbbc986d15349e3" name="a3126b480ac55ecd79fbbc986d15349e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3126b480ac55ecd79fbbc986d15349e3">&#9670;&#160;</a></span>test_full_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_full_output </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  579</span>    <span class="keyword">def </span>test_full_output(self):</div>
<div class="line"><span class="lineno">  580</span>        <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x, a, b):</div>
<div class="line"><span class="lineno">  581</span>            <span class="keywordflow">return</span> a * np.exp(-b * x)</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>        xdata = np.linspace(0, 1, 11)</div>
<div class="line"><span class="lineno">  584</span>        ydata = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(xdata, 2., 2.)</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>, <span class="stringliteral">&#39;lm&#39;</span>, <span class="keywordtype">None</span>]:</div>
<div class="line"><span class="lineno">  587</span>            popt, pcov, infodict, errmsg, ier = curve_fit(</div>
<div class="line"><span class="lineno">  588</span>                f, xdata, ydata, method=method, full_output=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  589</span>            assert_allclose(popt, [2., 2.])</div>
<div class="line"><span class="lineno">  590</span>            <span class="keyword">assert</span> <span class="stringliteral">&quot;nfev&quot;</span> <span class="keywordflow">in</span> infodict</div>
<div class="line"><span class="lineno">  591</span>            <span class="keyword">assert</span> <span class="stringliteral">&quot;fvec&quot;</span> <span class="keywordflow">in</span> infodict</div>
<div class="line"><span class="lineno">  592</span>            <span class="keywordflow">if</span> method == <span class="stringliteral">&#39;lm&#39;</span> <span class="keywordflow">or</span> method <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  593</span>                <span class="keyword">assert</span> <span class="stringliteral">&quot;fjac&quot;</span> <span class="keywordflow">in</span> infodict</div>
<div class="line"><span class="lineno">  594</span>                <span class="keyword">assert</span> <span class="stringliteral">&quot;ipvt&quot;</span> <span class="keywordflow">in</span> infodict</div>
<div class="line"><span class="lineno">  595</span>                <span class="keyword">assert</span> <span class="stringliteral">&quot;qtf&quot;</span> <span class="keywordflow">in</span> infodict</div>
<div class="line"><span class="lineno">  596</span>            <span class="keyword">assert</span> isinstance(errmsg, str)</div>
<div class="line"><span class="lineno">  597</span>            <span class="keyword">assert</span> ier <span class="keywordflow">in</span> (1, 2, 3, 4)</div>
<div class="line"><span class="lineno">  598</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aed79afdbb55e3f93bc051854c2b7b984" name="aed79afdbb55e3f93bc051854c2b7b984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed79afdbb55e3f93bc051854c2b7b984">&#9670;&#160;</a></span>test_func_is_classmethod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_func_is_classmethod </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  434</span>    <span class="keyword">def </span>test_func_is_classmethod(self):</div>
<div class="line"><span class="lineno">  435</span>        <span class="keyword">class </span>test_self:</div>
<div class="line"><span class="lineno">  436</span>            <span class="stringliteral">&quot;&quot;&quot;This class tests if curve_fit passes the correct number of</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">               arguments when the model function is a class instance method.</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">            &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>            <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(self, x, a, b):</div>
<div class="line"><span class="lineno">  441</span>                <span class="keywordflow">return</span> b * x**a</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>        test_self_inst = test_self()</div>
<div class="line"><span class="lineno">  444</span>        popt, pcov = curve_fit(test_self_inst.func, self.x, self.y)</div>
<div class="line"><span class="lineno">  445</span>        assert_(pcov.shape == (2,2))</div>
<div class="line"><span class="lineno">  446</span>        assert_array_almost_equal(popt, [1.7989, 1.1642], decimal=4)</div>
<div class="line"><span class="lineno">  447</span>        assert_array_almost_equal(pcov, [[0.0852, -0.1260], [-0.1260, 0.1912]],</div>
<div class="line"><span class="lineno">  448</span>                                  decimal=4)</div>
<div class="line"><span class="lineno">  449</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4845ade9f2107265d913e05722af48e3" name="a4845ade9f2107265d913e05722af48e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4845ade9f2107265d913e05722af48e3">&#9670;&#160;</a></span>test_function_zero_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_function_zero_params </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  557</span>    <span class="keyword">def </span>test_function_zero_params(self):</div>
<div class="line"><span class="lineno">  558</span>        <span class="comment"># Fit args is zero, so &quot;Unable to determine number of fit parameters.&quot;</span></div>
<div class="line"><span class="lineno">  559</span>        assert_raises(ValueError, curve_fit, <span class="keyword">lambda</span> x: x, [1, 2], [3, 4])</div>
<div class="line"><span class="lineno">  560</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae06e9d918875acbe300e369ed647f111" name="ae06e9d918875acbe300e369ed647f111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06e9d918875acbe300e369ed647f111">&#9670;&#160;</a></span>test_indeterminate_covariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_indeterminate_covariance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  526</span>    <span class="keyword">def </span>test_indeterminate_covariance(self):</div>
<div class="line"><span class="lineno">  527</span>        <span class="comment"># Test that a warning is returned when pcov is indeterminate</span></div>
<div class="line"><span class="lineno">  528</span>        xdata = np.array([1, 2, 3, 4, 5, 6])</div>
<div class="line"><span class="lineno">  529</span>        ydata = np.array([1, 2, 3, 4, 5.5, 6])</div>
<div class="line"><span class="lineno">  530</span>        assert_warns(OptimizeWarning, curve_fit,</div>
<div class="line"><span class="lineno">  531</span>                     <span class="keyword">lambda</span> x, a, b: a*x, xdata, ydata)</div>
<div class="line"><span class="lineno">  532</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a05741c34b7101947d572614a3b797462" name="a05741c34b7101947d572614a3b797462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05741c34b7101947d572614a3b797462">&#9670;&#160;</a></span>test_jac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_jac </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  640</span>    <span class="keyword">def </span>test_jac(self):</div>
<div class="line"><span class="lineno">  641</span>        <span class="comment"># Test that Jacobian callable is handled correctly and</span></div>
<div class="line"><span class="lineno">  642</span>        <span class="comment"># weighted if sigma is provided.</span></div>
<div class="line"><span class="lineno">  643</span>        <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x, a, b):</div>
<div class="line"><span class="lineno">  644</span>            <span class="keywordflow">return</span> a * np.exp(-b*x)</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>        <span class="keyword">def </span>jac(x, a, b):</div>
<div class="line"><span class="lineno">  647</span>            e = np.exp(-b*x)</div>
<div class="line"><span class="lineno">  648</span>            <span class="keywordflow">return</span> np.vstack((e, -a * x * e)).T</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>        xdata = np.linspace(0, 1, 11)</div>
<div class="line"><span class="lineno">  651</span>        ydata = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(xdata, 2., 2.)</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>        <span class="comment"># Test numerical options for least_squares backend.</span></div>
<div class="line"><span class="lineno">  654</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>]:</div>
<div class="line"><span class="lineno">  655</span>            <span class="keywordflow">for</span> scheme <span class="keywordflow">in</span> [<span class="stringliteral">&#39;2-point&#39;</span>, <span class="stringliteral">&#39;3-point&#39;</span>, <span class="stringliteral">&#39;cs&#39;</span>]:</div>
<div class="line"><span class="lineno">  656</span>                popt, pcov = curve_fit(f, xdata, ydata, jac=scheme,</div>
<div class="line"><span class="lineno">  657</span>                                       method=method)</div>
<div class="line"><span class="lineno">  658</span>                assert_allclose(popt, [2, 2])</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>        <span class="comment"># Test the analytic option.</span></div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;lm&#39;</span>, <span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>]:</div>
<div class="line"><span class="lineno">  662</span>            popt, pcov = curve_fit(f, xdata, ydata, method=method, jac=jac)</div>
<div class="line"><span class="lineno">  663</span>            assert_allclose(popt, [2, 2])</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>        <span class="comment"># Now add an outlier and provide sigma.</span></div>
<div class="line"><span class="lineno">  666</span>        ydata[5] = 100</div>
<div class="line"><span class="lineno">  667</span>        sigma = np.ones(xdata.shape[0])</div>
<div class="line"><span class="lineno">  668</span>        sigma[5] = 200</div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;lm&#39;</span>, <span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>]:</div>
<div class="line"><span class="lineno">  670</span>            popt, pcov = curve_fit(f, xdata, ydata, sigma=sigma, method=method,</div>
<div class="line"><span class="lineno">  671</span>                                   jac=jac)</div>
<div class="line"><span class="lineno">  672</span>            <span class="comment"># Still the optimization process is influenced somehow,</span></div>
<div class="line"><span class="lineno">  673</span>            <span class="comment"># have to set rtol=1e-3.</span></div>
<div class="line"><span class="lineno">  674</span>            assert_allclose(popt, [2, 2], rtol=1e-3)</div>
<div class="line"><span class="lineno">  675</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acc64354085f6eb927d74e264dc85150b" name="acc64354085f6eb927d74e264dc85150b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc64354085f6eb927d74e264dc85150b">&#9670;&#160;</a></span>test_maxfev_and_bounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_maxfev_and_bounds </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  676</span>    <span class="keyword">def </span>test_maxfev_and_bounds(self):</div>
<div class="line"><span class="lineno">  677</span>        <span class="comment"># gh-6340: with no bounds, curve_fit accepts parameter maxfev (via leastsq)</span></div>
<div class="line"><span class="lineno">  678</span>        <span class="comment"># but with bounds, the parameter is `max_nfev` (via least_squares)</span></div>
<div class="line"><span class="lineno">  679</span>        x = np.arange(0, 10)</div>
<div class="line"><span class="lineno">  680</span>        y = 2*x</div>
<div class="line"><span class="lineno">  681</span>        popt1, _ = curve_fit(<span class="keyword">lambda</span> x,p: p*x, x, y, bounds=(0, 3), maxfev=100)</div>
<div class="line"><span class="lineno">  682</span>        popt2, _ = curve_fit(<span class="keyword">lambda</span> x,p: p*x, x, y, bounds=(0, 3), max_nfev=100)</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>        assert_allclose(popt1, 2, atol=1e-14)</div>
<div class="line"><span class="lineno">  685</span>        assert_allclose(popt2, 2, atol=1e-14)</div>
<div class="line"><span class="lineno">  686</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a47305ddd22e88343b094c617cc6e465d" name="a47305ddd22e88343b094c617cc6e465d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47305ddd22e88343b094c617cc6e465d">&#9670;&#160;</a></span>test_method_argument()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_method_argument </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  566</span>    <span class="keyword">def </span>test_method_argument(self):</div>
<div class="line"><span class="lineno">  567</span>        <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x, a, b):</div>
<div class="line"><span class="lineno">  568</span>            <span class="keywordflow">return</span> a * np.exp(-b*x)</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>        xdata = np.linspace(0, 1, 11)</div>
<div class="line"><span class="lineno">  571</span>        ydata = <a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(xdata, 2., 2.)</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>, <span class="stringliteral">&#39;lm&#39;</span>, <span class="keywordtype">None</span>]:</div>
<div class="line"><span class="lineno">  574</span>            popt, pcov = curve_fit(f, xdata, ydata, method=method)</div>
<div class="line"><span class="lineno">  575</span>            assert_allclose(popt, [2., 2.])</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>        assert_raises(ValueError, curve_fit, f, xdata, ydata, method=<span class="stringliteral">&#39;unknown&#39;</span>)</div>
<div class="line"><span class="lineno">  578</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c74dbeb5a25a5346437397ccb9bbe82" name="a9c74dbeb5a25a5346437397ccb9bbe82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c74dbeb5a25a5346437397ccb9bbe82">&#9670;&#160;</a></span>test_NaN_handling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_NaN_handling </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  533</span>    <span class="keyword">def </span>test_NaN_handling(self):</div>
<div class="line"><span class="lineno">  534</span>        <span class="comment"># Test for correct handling of NaNs in input data: gh-3422</span></div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>        <span class="comment"># create input with NaNs</span></div>
<div class="line"><span class="lineno">  537</span>        xdata = np.array([1, np.nan, 3])</div>
<div class="line"><span class="lineno">  538</span>        ydata = np.array([1, 2, 3])</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>        assert_raises(ValueError, curve_fit,</div>
<div class="line"><span class="lineno">  541</span>                      <span class="keyword">lambda</span> x, a, b: a*x + b, xdata, ydata)</div>
<div class="line"><span class="lineno">  542</span>        assert_raises(ValueError, curve_fit,</div>
<div class="line"><span class="lineno">  543</span>                      <span class="keyword">lambda</span> x, a, b: a*x + b, ydata, xdata)</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>        assert_raises(ValueError, curve_fit, <span class="keyword">lambda</span> x, a, b: a*x + b,</div>
<div class="line"><span class="lineno">  546</span>                      xdata, ydata, **{<span class="stringliteral">&quot;check_finite&quot;</span>: <span class="keyword">True</span>})</div>
<div class="line"><span class="lineno">  547</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a01417cef5e575611dd74154ae90d3eb8" name="a01417cef5e575611dd74154ae90d3eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01417cef5e575611dd74154ae90d3eb8">&#9670;&#160;</a></span>test_None_x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_None_x </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  561</span>    <span class="keyword">def </span>test_None_x(self):  <span class="comment"># Added in GH10196</span></div>
<div class="line"><span class="lineno">  562</span>        popt, pcov = curve_fit(<span class="keyword">lambda</span> _, a: a * np.arange(10),</div>
<div class="line"><span class="lineno">  563</span>                               <span class="keywordtype">None</span>, 2 * np.arange(10))</div>
<div class="line"><span class="lineno">  564</span>        assert_allclose(popt, [2.])</div>
<div class="line"><span class="lineno">  565</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2be19b23b40e97abc44a0b1c1235db28" name="a2be19b23b40e97abc44a0b1c1235db28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be19b23b40e97abc44a0b1c1235db28">&#9670;&#160;</a></span>test_one_argument()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_one_argument </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  408</span>    <span class="keyword">def </span>test_one_argument(self):</div>
<div class="line"><span class="lineno">  409</span>        <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x,a):</div>
<div class="line"><span class="lineno">  410</span>            <span class="keywordflow">return</span> x**a</div>
<div class="line"><span class="lineno">  411</span>        popt, pcov = curve_fit(func, self.x, self.y)</div>
<div class="line"><span class="lineno">  412</span>        assert_(len(popt) == 1)</div>
<div class="line"><span class="lineno">  413</span>        assert_(pcov.shape == (1,1))</div>
<div class="line"><span class="lineno">  414</span>        assert_almost_equal(popt[0], 1.9149, decimal=4)</div>
<div class="line"><span class="lineno">  415</span>        assert_almost_equal(pcov[0,0], 0.0016, decimal=4)</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>        <span class="comment"># Test if we get the same with full_output. Regression test for #1415.</span></div>
<div class="line"><span class="lineno">  418</span>        <span class="comment"># Also test if check_finite can be turned off.</span></div>
<div class="line"><span class="lineno">  419</span>        res = curve_fit(func, self.x, self.y,</div>
<div class="line"><span class="lineno">  420</span>                        full_output=1, check_finite=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  421</span>        (popt2, pcov2, infodict, errmsg, ier) = res</div>
<div class="line"><span class="lineno">  422</span>        assert_array_almost_equal(popt, popt2)</div>
<div class="line"><span class="lineno">  423</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8c48dbcdf701679579a8540c8a607f9" name="ae8c48dbcdf701679579a8540c8a607f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c48dbcdf701679579a8540c8a607f9">&#9670;&#160;</a></span>test_pcov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_pcov </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  469</span>    <span class="keyword">def </span>test_pcov(self):</div>
<div class="line"><span class="lineno">  470</span>        xdata = np.array([0, 1, 2, 3, 4, 5])</div>
<div class="line"><span class="lineno">  471</span>        ydata = np.array([1, 1, 5, 7, 8, 12])</div>
<div class="line"><span class="lineno">  472</span>        sigma = np.array([1, 2, 1, 2, 1, 2])</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>        <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#af01a903df7bdb7a494f5827e45bf3a2a">f</a>(x, a, b):</div>
<div class="line"><span class="lineno">  475</span>            <span class="keywordflow">return</span> a*x + b</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>        <span class="keywordflow">for</span> method <span class="keywordflow">in</span> [<span class="stringliteral">&#39;lm&#39;</span>, <span class="stringliteral">&#39;trf&#39;</span>, <span class="stringliteral">&#39;dogbox&#39;</span>]:</div>
<div class="line"><span class="lineno">  478</span>            popt, pcov = curve_fit(f, xdata, ydata, p0=[2, 0], sigma=sigma,</div>
<div class="line"><span class="lineno">  479</span>                                   method=method)</div>
<div class="line"><span class="lineno">  480</span>            perr_scaled = np.sqrt(np.diag(pcov))</div>
<div class="line"><span class="lineno">  481</span>            assert_allclose(perr_scaled, [0.20659803, 0.57204404], rtol=1e-3)</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>            popt, pcov = curve_fit(f, xdata, ydata, p0=[2, 0], sigma=3*sigma,</div>
<div class="line"><span class="lineno">  484</span>                                   method=method)</div>
<div class="line"><span class="lineno">  485</span>            perr_scaled = np.sqrt(np.diag(pcov))</div>
<div class="line"><span class="lineno">  486</span>            assert_allclose(perr_scaled, [0.20659803, 0.57204404], rtol=1e-3)</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>            popt, pcov = curve_fit(f, xdata, ydata, p0=[2, 0], sigma=sigma,</div>
<div class="line"><span class="lineno">  489</span>                                   absolute_sigma=<span class="keyword">True</span>, method=method)</div>
<div class="line"><span class="lineno">  490</span>            perr = np.sqrt(np.diag(pcov))</div>
<div class="line"><span class="lineno">  491</span>            assert_allclose(perr, [0.30714756, 0.85045308], rtol=1e-3)</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>            popt, pcov = curve_fit(f, xdata, ydata, p0=[2, 0], sigma=3*sigma,</div>
<div class="line"><span class="lineno">  494</span>                                   absolute_sigma=<span class="keyword">True</span>, method=method)</div>
<div class="line"><span class="lineno">  495</span>            perr = np.sqrt(np.diag(pcov))</div>
<div class="line"><span class="lineno">  496</span>            assert_allclose(perr, [3*0.30714756, 3*0.85045308], rtol=1e-3)</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>        <span class="comment"># infinite variances</span></div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>        <span class="keyword">def </span>f_flat(x, a, b):</div>
<div class="line"><span class="lineno">  501</span>            <span class="keywordflow">return</span> a*x</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>        pcov_expected = np.array([np.inf]*4).reshape(2, 2)</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>        <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno">  506</span>            sup.filter(OptimizeWarning,</div>
<div class="line"><span class="lineno">  507</span>                       <span class="stringliteral">&quot;Covariance of the parameters could not be estimated&quot;</span>)</div>
<div class="line"><span class="lineno">  508</span>            popt, pcov = curve_fit(f_flat, xdata, ydata, p0=[2, 0], sigma=sigma)</div>
<div class="line"><span class="lineno">  509</span>            popt1, pcov1 = curve_fit(f, xdata[:2], ydata[:2], p0=[2, 0])</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>        assert_(pcov.shape == (2, 2))</div>
<div class="line"><span class="lineno">  512</span>        assert_array_equal(pcov, pcov_expected)</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>        assert_(pcov1.shape == (2, 2))</div>
<div class="line"><span class="lineno">  515</span>        assert_array_equal(pcov1, pcov_expected)</div>
<div class="line"><span class="lineno">  516</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5517e3dad1d52ccc22b5d1b260c8ac4" name="ac5517e3dad1d52ccc22b5d1b260c8ac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5517e3dad1d52ccc22b5d1b260c8ac4">&#9670;&#160;</a></span>test_regression_2639()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_regression_2639 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  450</span>    <span class="keyword">def </span>test_regression_2639(self):</div>
<div class="line"><span class="lineno">  451</span>        <span class="comment"># This test fails if epsfcn in leastsq is too large.</span></div>
<div class="line"><span class="lineno">  452</span>        x = [574.14200000000005, 574.154, 574.16499999999996,</div>
<div class="line"><span class="lineno">  453</span>             574.17700000000002, 574.18799999999999, 574.19899999999996,</div>
<div class="line"><span class="lineno">  454</span>             574.21100000000001, 574.22199999999998, 574.23400000000004,</div>
<div class="line"><span class="lineno">  455</span>             574.245]</div>
<div class="line"><span class="lineno">  456</span>        y = [859.0, 997.0, 1699.0, 2604.0, 2013.0, 1964.0, 2435.0,</div>
<div class="line"><span class="lineno">  457</span>             1550.0, 949.0, 841.0]</div>
<div class="line"><span class="lineno">  458</span>        guess = [574.1861428571428, 574.2155714285715, 1302.0, 1302.0,</div>
<div class="line"><span class="lineno">  459</span>                 0.0035019999999983615, 859.0]</div>
<div class="line"><span class="lineno">  460</span>        good = [5.74177150e+02, 5.74209188e+02, 1.74187044e+03, 1.58646166e+03,</div>
<div class="line"><span class="lineno">  461</span>                1.0068462e-02, 8.57450661e+02]</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>        <span class="keyword">def </span>f_double_gauss(x, x0, x1, A0, A1, sigma, c):</div>
<div class="line"><span class="lineno">  464</span>            <span class="keywordflow">return</span> (A0*np.exp(-(x-x0)**2/(2.*sigma**2))</div>
<div class="line"><span class="lineno">  465</span>                    + A1*np.exp(-(x-x1)**2/(2.*sigma**2)) + c)</div>
<div class="line"><span class="lineno">  466</span>        popt, pcov = curve_fit(f_double_gauss, x, y, guess, maxfev=10000)</div>
<div class="line"><span class="lineno">  467</span>        assert_allclose(popt, good, rtol=1e-5)</div>
<div class="line"><span class="lineno">  468</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a63a811a4114b57f94ad05d5d0b4ab0f7" name="a63a811a4114b57f94ad05d5d0b4ab0f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63a811a4114b57f94ad05d5d0b4ab0f7">&#9670;&#160;</a></span>test_two_argument()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.test_two_argument </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  424</span>    <span class="keyword">def </span>test_two_argument(self):</div>
<div class="line"><span class="lineno">  425</span>        <span class="keyword">def </span><a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x, a, b):</div>
<div class="line"><span class="lineno">  426</span>            <span class="keywordflow">return</span> b*x**a</div>
<div class="line"><span class="lineno">  427</span>        popt, pcov = curve_fit(func, self.x, self.y)</div>
<div class="line"><span class="lineno">  428</span>        assert_(len(popt) == 2)</div>
<div class="line"><span class="lineno">  429</span>        assert_(pcov.shape == (2,2))</div>
<div class="line"><span class="lineno">  430</span>        assert_array_almost_equal(popt, [1.7989, 1.1642], decimal=4)</div>
<div class="line"><span class="lineno">  431</span>        assert_array_almost_equal(pcov, [[0.0852, -0.1260], [-0.1260, 0.1912]],</div>
<div class="line"><span class="lineno">  432</span>                                  decimal=4)</div>
<div class="line"><span class="lineno">  433</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a32c8c53c5ee6473638ff154ad04d0468" name="a32c8c53c5ee6473638ff154ad04d0468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32c8c53c5ee6473638ff154ad04d0468">&#9670;&#160;</a></span>x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.x</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adc82bfce284abde91c7c24a9b6a4f122" name="adc82bfce284abde91c7c24a9b6a4f122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc82bfce284abde91c7c24a9b6a4f122">&#9670;&#160;</a></span>y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize.tests.test_minpack.TestCurveFit.y</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/scipy/optimize/tests/<a class="el" href="test__minpack_8py.html">test_minpack.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
