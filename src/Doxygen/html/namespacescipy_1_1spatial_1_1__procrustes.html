<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.spatial._procrustes Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1spatial.html">spatial</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1spatial_1_1__procrustes.html">_procrustes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.spatial._procrustes Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1cfacb6c1921cdfaf2bbefb639585e28" id="r_a1cfacb6c1921cdfaf2bbefb639585e28"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1spatial_1_1__procrustes.html#a1cfacb6c1921cdfaf2bbefb639585e28">procrustes</a> (data1, data2)</td></tr>
<tr class="separator:a1cfacb6c1921cdfaf2bbefb639585e28"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This module provides functions to perform full Procrustes analysis.

This code was originally written by Justin Kucynski and ported over from
scikit-bio by Yoshiki Vazquez-Baeza.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a1cfacb6c1921cdfaf2bbefb639585e28" name="a1cfacb6c1921cdfaf2bbefb639585e28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cfacb6c1921cdfaf2bbefb639585e28">&#9670;&#160;</a></span>procrustes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.spatial._procrustes.procrustes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Procrustes analysis, a similarity test for two data sets.

    Each input matrix is a set of points or vectors (the rows of the matrix).
    The dimension of the space is the number of columns of each matrix. Given
    two identically sized matrices, procrustes standardizes both such that:

    - :math:`tr(AA^{T}) = 1`.

    - Both sets of points are centered around the origin.

    Procrustes ([1]_, [2]_) then applies the optimal transform to the second
    matrix (including scaling/dilation, rotations, and reflections) to minimize
    :math:`M^{2}=\sum(data1-data2)^{2}`, or the sum of the squares of the
    pointwise differences between the two input datasets.

    This function was not designed to handle datasets with different numbers of
    datapoints (rows).  If two data sets have different dimensionality
    (different number of columns), simply add columns of zeros to the smaller
    of the two.

    Parameters
    ----------
    data1 : array_like
        Matrix, n rows represent points in k (columns) space `data1` is the
        reference data, after it is standardised, the data from `data2` will be
        transformed to fit the pattern in `data1` (must have &gt;1 unique points).
    data2 : array_like
        n rows of data in k space to be fit to `data1`.  Must be the  same
        shape ``(numrows, numcols)`` as data1 (must have &gt;1 unique points).

    Returns
    -------
    mtx1 : array_like
        A standardized version of `data1`.
    mtx2 : array_like
        The orientation of `data2` that best fits `data1`. Centered, but not
        necessarily :math:`tr(AA^{T}) = 1`.
    disparity : float
        :math:`M^{2}` as defined above.

    Raises
    ------
    ValueError
        If the input arrays are not two-dimensional.
        If the shape of the input arrays is different.
        If the input arrays have zero columns or zero rows.

    See Also
    --------
    scipy.linalg.orthogonal_procrustes
    scipy.spatial.distance.directed_hausdorff : Another similarity test
      for two data sets

    Notes
    -----
    - The disparity should not depend on the order of the input matrices, but
      the output matrices will, as only the first output matrix is guaranteed
      to be scaled such that :math:`tr(AA^{T}) = 1`.

    - Duplicate data points are generally ok, duplicating a data point will
      increase its effect on the procrustes fit.

    - The disparity scales as the number of points per input matrix.

    References
    ----------
    .. [1] Krzanowski, W. J. (2000). "Principles of Multivariate analysis".
    .. [2] Gower, J. C. (1975). "Generalized procrustes analysis".

    Examples
    --------
    &gt;&gt;&gt; from scipy.spatial import procrustes

    The matrix ``b`` is a rotated, shifted, scaled and mirrored version of
    ``a`` here:

    &gt;&gt;&gt; a = np.array([[1, 3], [1, 2], [1, 1], [2, 1]], 'd')
    &gt;&gt;&gt; b = np.array([[4, -2], [4, -4], [4, -6], [2, -6]], 'd')
    &gt;&gt;&gt; mtx1, mtx2, disparity = procrustes(a, b)
    &gt;&gt;&gt; round(disparity)
    0.0</pre> <div class="fragment"><div class="line"><span class="lineno">   15</span><span class="keyword">def </span>procrustes(data1, data2):</div>
<div class="line"><span class="lineno">   16</span>    <span class="stringliteral">r&quot;&quot;&quot;Procrustes analysis, a similarity test for two data sets.</span></div>
<div class="line"><span class="lineno">   17</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   18</span><span class="stringliteral">    Each input matrix is a set of points or vectors (the rows of the matrix).</span></div>
<div class="line"><span class="lineno">   19</span><span class="stringliteral">    The dimension of the space is the number of columns of each matrix. Given</span></div>
<div class="line"><span class="lineno">   20</span><span class="stringliteral">    two identically sized matrices, procrustes standardizes both such that:</span></div>
<div class="line"><span class="lineno">   21</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral">    - :math:`tr(AA^{T}) = 1`.</span></div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   24</span><span class="stringliteral">    - Both sets of points are centered around the origin.</span></div>
<div class="line"><span class="lineno">   25</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral">    Procrustes ([1]_, [2]_) then applies the optimal transform to the second</span></div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">    matrix (including scaling/dilation, rotations, and reflections) to minimize</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">    :math:`M^{2}=\sum(data1-data2)^{2}`, or the sum of the squares of the</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">    pointwise differences between the two input datasets.</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">    This function was not designed to handle datasets with different numbers of</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">    datapoints (rows).  If two data sets have different dimensionality</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral">    (different number of columns), simply add columns of zeros to the smaller</span></div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">    of the two.</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    data1 : array_like</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">        Matrix, n rows represent points in k (columns) space `data1` is the</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">        reference data, after it is standardised, the data from `data2` will be</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">        transformed to fit the pattern in `data1` (must have &gt;1 unique points).</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">    data2 : array_like</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">        n rows of data in k space to be fit to `data1`.  Must be the  same</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">        shape ``(numrows, numcols)`` as data1 (must have &gt;1 unique points).</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    mtx1 : array_like</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">        A standardized version of `data1`.</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">    mtx2 : array_like</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">        The orientation of `data2` that best fits `data1`. Centered, but not</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">        necessarily :math:`tr(AA^{T}) = 1`.</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">    disparity : float</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">        :math:`M^{2}` as defined above.</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    Raises</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">    ------</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    ValueError</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">        If the input arrays are not two-dimensional.</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">        If the shape of the input arrays is different.</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">        If the input arrays have zero columns or zero rows.</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">    scipy.linalg.orthogonal_procrustes</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    scipy.spatial.distance.directed_hausdorff : Another similarity test</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">      for two data sets</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    - The disparity should not depend on the order of the input matrices, but</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">      the output matrices will, as only the first output matrix is guaranteed</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">      to be scaled such that :math:`tr(AA^{T}) = 1`.</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    - Duplicate data points are generally ok, duplicating a data point will</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">      increase its effect on the procrustes fit.</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">    - The disparity scales as the number of points per input matrix.</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">    .. [1] Krzanowski, W. J. (2000). &quot;Principles of Multivariate analysis&quot;.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    .. [2] Gower, J. C. (1975). &quot;Generalized procrustes analysis&quot;.</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.spatial import procrustes</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    The matrix ``b`` is a rotated, shifted, scaled and mirrored version of</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">    ``a`` here:</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    &gt;&gt;&gt; a = np.array([[1, 3], [1, 2], [1, 1], [2, 1]], &#39;d&#39;)</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    &gt;&gt;&gt; b = np.array([[4, -2], [4, -4], [4, -6], [2, -6]], &#39;d&#39;)</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    &gt;&gt;&gt; mtx1, mtx2, disparity = procrustes(a, b)</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    &gt;&gt;&gt; round(disparity)</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    0.0</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   99</span>    mtx1 = np.array(data1, dtype=np.double, copy=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  100</span>    mtx2 = np.array(data2, dtype=np.double, copy=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">if</span> mtx1.ndim != 2 <span class="keywordflow">or</span> mtx2.ndim != 2:</div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Input matrices must be two-dimensional&quot;</span>)</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">if</span> mtx1.shape != mtx2.shape:</div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Input matrices must be of same shape&quot;</span>)</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">if</span> mtx1.size == 0:</div>
<div class="line"><span class="lineno">  107</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Input matrices must be &gt;0 rows and &gt;0 cols&quot;</span>)</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="comment"># translate all the data to the origin</span></div>
<div class="line"><span class="lineno">  110</span>    mtx1 -= np.mean(mtx1, 0)</div>
<div class="line"><span class="lineno">  111</span>    mtx2 -= np.mean(mtx2, 0)</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    norm1 = np.linalg.norm(mtx1)</div>
<div class="line"><span class="lineno">  114</span>    norm2 = np.linalg.norm(mtx2)</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">if</span> norm1 == 0 <span class="keywordflow">or</span> norm2 == 0:</div>
<div class="line"><span class="lineno">  117</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Input matrices must contain &gt;1 unique points&quot;</span>)</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    <span class="comment"># change scaling of data (in rows) such that trace(mtx*mtx&#39;) = 1</span></div>
<div class="line"><span class="lineno">  120</span>    mtx1 /= norm1</div>
<div class="line"><span class="lineno">  121</span>    mtx2 /= norm2</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    <span class="comment"># transform mtx2 to minimize disparity</span></div>
<div class="line"><span class="lineno">  124</span>    R, s = orthogonal_procrustes(mtx1, mtx2)</div>
<div class="line"><span class="lineno">  125</span>    mtx2 = np.dot(mtx2, R.T) * s</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="comment"># measure the dissimilarity between the two datasets</span></div>
<div class="line"><span class="lineno">  128</span>    disparity = np.sum(np.square(mtx1 - mtx2))</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">return</span> mtx1, mtx2, disparity</div>
<div class="line"><span class="lineno">  131</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
