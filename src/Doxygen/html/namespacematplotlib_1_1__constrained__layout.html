<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: matplotlib._constrained_layout Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacematplotlib.html">matplotlib</a></li><li class="navelem"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html">_constrained_layout</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">matplotlib._constrained_layout Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a534c44bfc223b3219ba71dde4a5ae5a3" id="r_a534c44bfc223b3219ba71dde4a5ae5a3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a534c44bfc223b3219ba71dde4a5ae5a3">do_constrained_layout</a> (fig, h_pad, w_pad, hspace=None, wspace=None, rect=(0, 0, 1, 1), compress=False)</td></tr>
<tr class="separator:a534c44bfc223b3219ba71dde4a5ae5a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aca53d5dbf15ad34af4944f890bc870" id="r_a9aca53d5dbf15ad34af4944f890bc870"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a9aca53d5dbf15ad34af4944f890bc870">make_layoutgrids</a> (fig, layoutgrids, rect=(0, 0, 1, 1))</td></tr>
<tr class="separator:a9aca53d5dbf15ad34af4944f890bc870"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab55e09253628d56d2b69efbb199f419b" id="r_ab55e09253628d56d2b69efbb199f419b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#ab55e09253628d56d2b69efbb199f419b">make_layoutgrids_gs</a> (layoutgrids, gs)</td></tr>
<tr class="separator:ab55e09253628d56d2b69efbb199f419b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1edb4aff20d0b33a1aa4bdd4caaed955" id="r_a1edb4aff20d0b33a1aa4bdd4caaed955"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a1edb4aff20d0b33a1aa4bdd4caaed955">check_no_collapsed_axes</a> (layoutgrids, fig)</td></tr>
<tr class="separator:a1edb4aff20d0b33a1aa4bdd4caaed955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaec9713034b6e88a55b728069ca43e2" id="r_aaaec9713034b6e88a55b728069ca43e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#aaaec9713034b6e88a55b728069ca43e2">compress_fixed_aspect</a> (layoutgrids, fig)</td></tr>
<tr class="separator:aaaec9713034b6e88a55b728069ca43e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbb16991be0385f97a1fc178372f7313" id="r_adbb16991be0385f97a1fc178372f7313"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#adbb16991be0385f97a1fc178372f7313">get_margin_from_padding</a> (obj, *w_pad=0, h_pad=0, hspace=0, wspace=0)</td></tr>
<tr class="separator:adbb16991be0385f97a1fc178372f7313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f26aa01d9760dfa899881c0aeed66c2" id="r_a1f26aa01d9760dfa899881c0aeed66c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a1f26aa01d9760dfa899881c0aeed66c2">make_layout_margins</a> (layoutgrids, fig, renderer, *w_pad=0, h_pad=0, hspace=0, wspace=0)</td></tr>
<tr class="separator:a1f26aa01d9760dfa899881c0aeed66c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17f6bc8dcefa13c2603178082e8eb7a5" id="r_a17f6bc8dcefa13c2603178082e8eb7a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a17f6bc8dcefa13c2603178082e8eb7a5">make_margin_suptitles</a> (layoutgrids, fig, renderer, *w_pad=0, h_pad=0)</td></tr>
<tr class="separator:a17f6bc8dcefa13c2603178082e8eb7a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0533bcb9521480446ce2401482e3ec30" id="r_a0533bcb9521480446ce2401482e3ec30"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a0533bcb9521480446ce2401482e3ec30">match_submerged_margins</a> (layoutgrids, fig)</td></tr>
<tr class="separator:a0533bcb9521480446ce2401482e3ec30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a5fd5820e98e11b67213125bc810eea" id="r_a7a5fd5820e98e11b67213125bc810eea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a7a5fd5820e98e11b67213125bc810eea">get_cb_parent_spans</a> (cbax)</td></tr>
<tr class="separator:a7a5fd5820e98e11b67213125bc810eea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed74fa26a4ce28de320a1fdb8f026932" id="r_aed74fa26a4ce28de320a1fdb8f026932"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#aed74fa26a4ce28de320a1fdb8f026932">get_pos_and_bbox</a> (ax, renderer)</td></tr>
<tr class="separator:aed74fa26a4ce28de320a1fdb8f026932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1e155905763a3eb41dff5b5c1f52b9e" id="r_af1e155905763a3eb41dff5b5c1f52b9e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#af1e155905763a3eb41dff5b5c1f52b9e">reposition_axes</a> (layoutgrids, fig, renderer, *w_pad=0, h_pad=0, hspace=0, wspace=0)</td></tr>
<tr class="separator:af1e155905763a3eb41dff5b5c1f52b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1675ad90c0bed85753f350849f6d39a9" id="r_a1675ad90c0bed85753f350849f6d39a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a1675ad90c0bed85753f350849f6d39a9">reposition_colorbar</a> (layoutgrids, cbax, renderer, *<a class="el" href="__lapack__subroutines_8h.html#ac5c1dfc0f77d6570b83bf10cfe850d4e">offset</a>=None)</td></tr>
<tr class="separator:a1675ad90c0bed85753f350849f6d39a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c8919d4e026828b8f166479337780b0" id="r_a2c8919d4e026828b8f166479337780b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a2c8919d4e026828b8f166479337780b0">reset_margins</a> (layoutgrids, fig)</td></tr>
<tr class="separator:a2c8919d4e026828b8f166479337780b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afecd6f44621025a3c222c0034b53f827" id="r_afecd6f44621025a3c222c0034b53f827"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#afecd6f44621025a3c222c0034b53f827">colorbar_get_pad</a> (layoutgrids, cax)</td></tr>
<tr class="separator:afecd6f44621025a3c222c0034b53f827"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a368c0b5672a172c4d5293eb6fef3d0f6" id="r_a368c0b5672a172c4d5293eb6fef3d0f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacematplotlib_1_1__constrained__layout.html#a368c0b5672a172c4d5293eb6fef3d0f6">_log</a> = logging.getLogger(__name__)</td></tr>
<tr class="separator:a368c0b5672a172c4d5293eb6fef3d0f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Adjust subplot layouts so that there are no overlapping axes or axes
decorations.  All axes decorations are dealt with (labels, ticks, titles,
ticklabels) and some dependent artists are also dealt with (colorbar,
suptitle).

Layout is done via `~matplotlib.gridspec`, with one constraint per gridspec,
so it is possible to have overlapping axes if the gridspecs overlap (i.e.
using `~matplotlib.gridspec.GridSpecFromSubplotSpec`).  Axes placed using
``figure.subplots()`` or ``figure.add_subplots()`` will participate in the
layout.  Axes manually placed via ``figure.add_axes()`` will not.

See Tutorial: :doc:`/tutorials/intermediate/constrainedlayout_guide`

General idea:
-------------

First, a figure has a gridspec that divides the figure into nrows and ncols,
with heights and widths set by ``height_ratios`` and ``width_ratios``,
often just set to 1 for an equal grid.

Subplotspecs that are derived from this gridspec can contain either a
``SubPanel``, a ``GridSpecFromSubplotSpec``, or an ``Axes``.  The ``SubPanel``
and ``GridSpecFromSubplotSpec`` are dealt with recursively and each contain an
analogous layout.

Each ``GridSpec`` has a ``_layoutgrid`` attached to it.  The ``_layoutgrid``
has the same logical layout as the ``GridSpec``.   Each row of the grid spec
has a top and bottom "margin" and each column has a left and right "margin".
The "inner" height of each row is constrained to be the same (or as modified
by ``height_ratio``), and the "inner" width of each column is
constrained to be the same (as modified by ``width_ratio``), where "inner"
is the width or height of each column/row minus the size of the margins.

Then the size of the margins for each row and column are determined as the
max width of the decorators on each axes that has decorators in that margin.
For instance, a normal axes would have a left margin that includes the
left ticklabels, and the ylabel if it exists.  The right margin may include a
colorbar, the bottom margin the xaxis decorations, and the top margin the
title.

With these constraints, the solver then finds appropriate bounds for the
columns and rows.  It's possible that the margins take up the whole figure,
in which case the algorithm is not applied and a warning is raised.

See the tutorial doc:`/tutorials/intermediate/constrainedlayout_guide`
for more discussion of the algorithm with examples.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a1edb4aff20d0b33a1aa4bdd4caaed955" name="a1edb4aff20d0b33a1aa4bdd4caaed955"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1edb4aff20d0b33a1aa4bdd4caaed955">&#9670;&#160;</a></span>check_no_collapsed_axes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.check_no_collapsed_axes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check that no axes have collapsed to zero size.
</pre> <div class="fragment"><div class="line"><span class="lineno">  243</span><span class="keyword">def </span>check_no_collapsed_axes(layoutgrids, fig):</div>
<div class="line"><span class="lineno">  244</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    Check that no axes have collapsed to zero size.</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordflow">for</span> sfig <span class="keywordflow">in</span> fig.subfigs:</div>
<div class="line"><span class="lineno">  248</span>        ok = check_no_collapsed_axes(layoutgrids, sfig)</div>
<div class="line"><span class="lineno">  249</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> ok:</div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">for</span> ax <span class="keywordflow">in</span> fig.axes:</div>
<div class="line"><span class="lineno">  253</span>        <span class="keywordflow">if</span> hasattr(ax, <span class="stringliteral">&#39;get_subplotspec&#39;</span>):</div>
<div class="line"><span class="lineno">  254</span>            gs = ax.get_subplotspec().get_gridspec()</div>
<div class="line"><span class="lineno">  255</span>            <span class="keywordflow">if</span> gs <span class="keywordflow">in</span> layoutgrids:</div>
<div class="line"><span class="lineno">  256</span>                lg = layoutgrids[gs]</div>
<div class="line"><span class="lineno">  257</span>                <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(gs.nrows):</div>
<div class="line"><span class="lineno">  258</span>                    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(gs.ncols):</div>
<div class="line"><span class="lineno">  259</span>                        bb = lg.get_inner_bbox(i, j)</div>
<div class="line"><span class="lineno">  260</span>                        <span class="keywordflow">if</span> bb.width &lt;= 0 <span class="keywordflow">or</span> bb.height &lt;= 0:</div>
<div class="line"><span class="lineno">  261</span>                            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afecd6f44621025a3c222c0034b53f827" name="afecd6f44621025a3c222c0034b53f827"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afecd6f44621025a3c222c0034b53f827">&#9670;&#160;</a></span>colorbar_get_pad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.colorbar_get_pad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  753</span><span class="keyword">def </span>colorbar_get_pad(layoutgrids, cax):</div>
<div class="line"><span class="lineno">  754</span>    parents = cax._colorbar_info[<span class="stringliteral">&#39;parents&#39;</span>]</div>
<div class="line"><span class="lineno">  755</span>    gs = parents[0].get_gridspec()</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>    cb_rspans, cb_cspans = get_cb_parent_spans(cax)</div>
<div class="line"><span class="lineno">  758</span>    bboxouter = layoutgrids[gs].get_inner_bbox(rows=cb_rspans, cols=cb_cspans)</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordflow">if</span> cax._colorbar_info[<span class="stringliteral">&#39;location&#39;</span>] <span class="keywordflow">in</span> [<span class="stringliteral">&#39;right&#39;</span>, <span class="stringliteral">&#39;left&#39;</span>]:</div>
<div class="line"><span class="lineno">  761</span>        size = bboxouter.width</div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  763</span>        size = bboxouter.height</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordflow">return</span> cax._colorbar_info[<span class="stringliteral">&#39;pad&#39;</span>] * size</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaaec9713034b6e88a55b728069ca43e2" name="aaaec9713034b6e88a55b728069ca43e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaec9713034b6e88a55b728069ca43e2">&#9670;&#160;</a></span>compress_fixed_aspect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.compress_fixed_aspect </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  265</span><span class="keyword">def </span>compress_fixed_aspect(layoutgrids, fig):</div>
<div class="line"><span class="lineno">  266</span>    gs = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">for</span> ax <span class="keywordflow">in</span> fig.axes:</div>
<div class="line"><span class="lineno">  268</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(ax, <span class="stringliteral">&#39;get_subplotspec&#39;</span>):</div>
<div class="line"><span class="lineno">  269</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  270</span>        ax.apply_aspect()</div>
<div class="line"><span class="lineno">  271</span>        sub = ax.get_subplotspec()</div>
<div class="line"><span class="lineno">  272</span>        _gs = sub.get_gridspec()</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">if</span> gs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  274</span>            gs = _gs</div>
<div class="line"><span class="lineno">  275</span>            extraw = np.zeros(gs.ncols)</div>
<div class="line"><span class="lineno">  276</span>            extrah = np.zeros(gs.nrows)</div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordflow">elif</span> _gs != gs:</div>
<div class="line"><span class="lineno">  278</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Cannot do compressed layout if axes are not&#39;</span></div>
<div class="line"><span class="lineno">  279</span>                                <span class="stringliteral">&#39;all from the same gridspec&#39;</span>)</div>
<div class="line"><span class="lineno">  280</span>        orig = ax.get_position(original=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  281</span>        actual = ax.get_position(original=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  282</span>        dw = orig.width - actual.width</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">if</span> dw &gt; 0:</div>
<div class="line"><span class="lineno">  284</span>            extraw[sub.colspan] = np.maximum(extraw[sub.colspan], dw)</div>
<div class="line"><span class="lineno">  285</span>        dh = orig.height - actual.height</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">if</span> dh &gt; 0:</div>
<div class="line"><span class="lineno">  287</span>            extrah[sub.rowspan] = np.maximum(extrah[sub.rowspan], dh)</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">if</span> gs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  290</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Cannot do compressed layout if no axes &#39;</span></div>
<div class="line"><span class="lineno">  291</span>                         <span class="stringliteral">&#39;are part of a gridspec.&#39;</span>)</div>
<div class="line"><span class="lineno">  292</span>    w = np.sum(extraw) / 2</div>
<div class="line"><span class="lineno">  293</span>    layoutgrids[fig].edit_margin_min(<span class="stringliteral">&#39;left&#39;</span>, w)</div>
<div class="line"><span class="lineno">  294</span>    layoutgrids[fig].edit_margin_min(<span class="stringliteral">&#39;right&#39;</span>, w)</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    h = np.sum(extrah) / 2</div>
<div class="line"><span class="lineno">  297</span>    layoutgrids[fig].edit_margin_min(<span class="stringliteral">&#39;top&#39;</span>, h)</div>
<div class="line"><span class="lineno">  298</span>    layoutgrids[fig].edit_margin_min(<span class="stringliteral">&#39;bottom&#39;</span>, h)</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">return</span> layoutgrids</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a534c44bfc223b3219ba71dde4a5ae5a3" name="a534c44bfc223b3219ba71dde4a5ae5a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a534c44bfc223b3219ba71dde4a5ae5a3">&#9670;&#160;</a></span>do_constrained_layout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.do_constrained_layout </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h_pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w_pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hspace</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wspace</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rect</em> = <code>(0,&#160;0,&#160;1,&#160;1)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compress</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Do the constrained_layout.  Called at draw time in
 ``figure.constrained_layout()``

Parameters
----------
fig : Figure
    ``Figure`` instance to do the layout in.

renderer : Renderer
    Renderer to use.

h_pad, w_pad : float
  Padding around the axes elements in figure-normalized units.

hspace, wspace : float
   Fraction of the figure to dedicate to space between the
   axes.  These are evenly spread between the gaps between the axes.
   A value of 0.2 for a three-column layout would have a space
   of 0.1 of the figure width between each column.
   If h/wspace &lt; h/w_pad, then the pads are used instead.

rect : tuple of 4 floats
    Rectangle in figure coordinates to perform constrained layout in
    [left, bottom, width, height], each from 0-1.

compress : bool
    Whether to shift Axes so that white space in between them is
    removed. This is useful for simple grids of fixed-aspect Axes (e.g.
    a grid of images).

Returns
-------
layoutgrid : private debugging structure
</pre> <div class="fragment"><div class="line"><span class="lineno">   65</span>                          compress=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">   66</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    Do the constrained_layout.  Called at draw time in</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">     ``figure.constrained_layout()``</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    fig : Figure</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        ``Figure`` instance to do the layout in.</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">    renderer : Renderer</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        Renderer to use.</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">    h_pad, w_pad : float</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">      Padding around the axes elements in figure-normalized units.</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    hspace, wspace : float</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">       Fraction of the figure to dedicate to space between the</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">       axes.  These are evenly spread between the gaps between the axes.</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">       A value of 0.2 for a three-column layout would have a space</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">       of 0.1 of the figure width between each column.</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">       If h/wspace &lt; h/w_pad, then the pads are used instead.</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">    rect : tuple of 4 floats</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">        Rectangle in figure coordinates to perform constrained layout in</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">        [left, bottom, width, height], each from 0-1.</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">    compress : bool</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">        Whether to shift Axes so that white space in between them is</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">        removed. This is useful for simple grids of fixed-aspect Axes (e.g.</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">        a grid of images).</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    layoutgrid : private debugging structure</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    renderer = fig._get_renderer()</div>
<div class="line"><span class="lineno">  103</span>    <span class="comment"># make layoutgrid tree...</span></div>
<div class="line"><span class="lineno">  104</span>    layoutgrids = make_layoutgrids(fig, <span class="keywordtype">None</span>, rect=rect)</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> layoutgrids[<span class="stringliteral">&#39;hasgrids&#39;</span>]:</div>
<div class="line"><span class="lineno">  106</span>        _api.warn_external(<span class="stringliteral">&#39;There are no gridspecs with layoutgrids. &#39;</span></div>
<div class="line"><span class="lineno">  107</span>                           <span class="stringliteral">&#39;Possibly did not call parent GridSpec with the&#39;</span></div>
<div class="line"><span class="lineno">  108</span>                           <span class="stringliteral">&#39; &quot;figure&quot; keyword&#39;</span>)</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(2):</div>
<div class="line"><span class="lineno">  112</span>        <span class="comment"># do the algorithm twice.  This has to be done because decorations</span></div>
<div class="line"><span class="lineno">  113</span>        <span class="comment"># change size after the first re-position (i.e. x/yticklabels get</span></div>
<div class="line"><span class="lineno">  114</span>        <span class="comment"># larger/smaller).  This second reposition tends to be much milder,</span></div>
<div class="line"><span class="lineno">  115</span>        <span class="comment"># so doing twice makes things work OK.</span></div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>        <span class="comment"># make margins for all the axes and subfigures in the</span></div>
<div class="line"><span class="lineno">  118</span>        <span class="comment"># figure.  Add margins for colorbars...</span></div>
<div class="line"><span class="lineno">  119</span>        make_layout_margins(layoutgrids, fig, renderer, h_pad=h_pad,</div>
<div class="line"><span class="lineno">  120</span>                            w_pad=w_pad, hspace=hspace, wspace=wspace)</div>
<div class="line"><span class="lineno">  121</span>        make_margin_suptitles(layoutgrids, fig, renderer, h_pad=h_pad,</div>
<div class="line"><span class="lineno">  122</span>                              w_pad=w_pad)</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>        <span class="comment"># if a layout is such that a columns (or rows) margin has no</span></div>
<div class="line"><span class="lineno">  125</span>        <span class="comment"># constraints, we need to make all such instances in the grid</span></div>
<div class="line"><span class="lineno">  126</span>        <span class="comment"># match in margin size.</span></div>
<div class="line"><span class="lineno">  127</span>        match_submerged_margins(layoutgrids, fig)</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>        <span class="comment"># update all the variables in the layout.</span></div>
<div class="line"><span class="lineno">  130</span>        layoutgrids[fig].update_variables()</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>        warn_collapsed = (<span class="stringliteral">&#39;constrained_layout not applied because &#39;</span></div>
<div class="line"><span class="lineno">  133</span>                          <span class="stringliteral">&#39;axes sizes collapsed to zero.  Try making &#39;</span></div>
<div class="line"><span class="lineno">  134</span>                          <span class="stringliteral">&#39;figure larger or axes decorations smaller.&#39;</span>)</div>
<div class="line"><span class="lineno">  135</span>        <span class="keywordflow">if</span> check_no_collapsed_axes(layoutgrids, fig):</div>
<div class="line"><span class="lineno">  136</span>            reposition_axes(layoutgrids, fig, renderer, h_pad=h_pad,</div>
<div class="line"><span class="lineno">  137</span>                            w_pad=w_pad, hspace=hspace, wspace=wspace)</div>
<div class="line"><span class="lineno">  138</span>            <span class="keywordflow">if</span> compress:</div>
<div class="line"><span class="lineno">  139</span>                layoutgrids = compress_fixed_aspect(layoutgrids, fig)</div>
<div class="line"><span class="lineno">  140</span>                layoutgrids[fig].update_variables()</div>
<div class="line"><span class="lineno">  141</span>                <span class="keywordflow">if</span> check_no_collapsed_axes(layoutgrids, fig):</div>
<div class="line"><span class="lineno">  142</span>                    reposition_axes(layoutgrids, fig, renderer, h_pad=h_pad,</div>
<div class="line"><span class="lineno">  143</span>                                    w_pad=w_pad, hspace=hspace, wspace=wspace)</div>
<div class="line"><span class="lineno">  144</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  145</span>                    _api.warn_external(warn_collapsed)</div>
<div class="line"><span class="lineno">  146</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  147</span>            _api.warn_external(warn_collapsed)</div>
<div class="line"><span class="lineno">  148</span>        reset_margins(layoutgrids, fig)</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">return</span> layoutgrids</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a5fd5820e98e11b67213125bc810eea" name="a7a5fd5820e98e11b67213125bc810eea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a5fd5820e98e11b67213125bc810eea">&#9670;&#160;</a></span>get_cb_parent_spans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.get_cb_parent_spans </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cbax</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Figure out which subplotspecs this colorbar belongs to:
</pre> <div class="fragment"><div class="line"><span class="lineno">  560</span><span class="keyword">def </span>get_cb_parent_spans(cbax):</div>
<div class="line"><span class="lineno">  561</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">    Figure out which subplotspecs this colorbar belongs to:</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  564</span>    rowstart = np.inf</div>
<div class="line"><span class="lineno">  565</span>    rowstop = -np.inf</div>
<div class="line"><span class="lineno">  566</span>    colstart = np.inf</div>
<div class="line"><span class="lineno">  567</span>    colstop = -np.inf</div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordflow">for</span> parent <span class="keywordflow">in</span> cbax._colorbar_info[<span class="stringliteral">&#39;parents&#39;</span>]:</div>
<div class="line"><span class="lineno">  569</span>        ss = parent.get_subplotspec()</div>
<div class="line"><span class="lineno">  570</span>        rowstart = min(ss.rowspan.start, rowstart)</div>
<div class="line"><span class="lineno">  571</span>        rowstop = max(ss.rowspan.stop, rowstop)</div>
<div class="line"><span class="lineno">  572</span>        colstart = min(ss.colspan.start, colstart)</div>
<div class="line"><span class="lineno">  573</span>        colstop = max(ss.colspan.stop, colstop)</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>    rowspan = range(rowstart, rowstop)</div>
<div class="line"><span class="lineno">  576</span>    colspan = range(colstart, colstop)</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">return</span> rowspan, colspan</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adbb16991be0385f97a1fc178372f7313" name="adbb16991be0385f97a1fc178372f7313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbb16991be0385f97a1fc178372f7313">&#9670;&#160;</a></span>get_margin_from_padding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.get_margin_from_padding </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>w_pad</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h_pad</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hspace</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wspace</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  303</span>                            hspace=0, wspace=0):</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>    ss = obj._subplotspec</div>
<div class="line"><span class="lineno">  306</span>    gs = ss.get_gridspec()</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">if</span> hasattr(gs, <span class="stringliteral">&#39;hspace&#39;</span>):</div>
<div class="line"><span class="lineno">  309</span>        _hspace = (gs.hspace <span class="keywordflow">if</span> gs.hspace <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> hspace)</div>
<div class="line"><span class="lineno">  310</span>        _wspace = (gs.wspace <span class="keywordflow">if</span> gs.wspace <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> wspace)</div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  312</span>        _hspace = (gs._hspace <span class="keywordflow">if</span> gs._hspace <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> hspace)</div>
<div class="line"><span class="lineno">  313</span>        _wspace = (gs._wspace <span class="keywordflow">if</span> gs._wspace <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> wspace)</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    _wspace = _wspace / 2</div>
<div class="line"><span class="lineno">  316</span>    _hspace = _hspace / 2</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    nrows, ncols = gs.get_geometry()</div>
<div class="line"><span class="lineno">  319</span>    <span class="comment"># there are two margins for each direction.  The &quot;cb&quot;</span></div>
<div class="line"><span class="lineno">  320</span>    <span class="comment"># margins are for pads and colorbars, the non-&quot;cb&quot; are</span></div>
<div class="line"><span class="lineno">  321</span>    <span class="comment"># for the axes decorations (labels etc).</span></div>
<div class="line"><span class="lineno">  322</span>    margin = {<span class="stringliteral">&#39;leftcb&#39;</span>: w_pad, <span class="stringliteral">&#39;rightcb&#39;</span>: w_pad,</div>
<div class="line"><span class="lineno">  323</span>              <span class="stringliteral">&#39;bottomcb&#39;</span>: h_pad, <span class="stringliteral">&#39;topcb&#39;</span>: h_pad,</div>
<div class="line"><span class="lineno">  324</span>              <span class="stringliteral">&#39;left&#39;</span>: 0, <span class="stringliteral">&#39;right&#39;</span>: 0,</div>
<div class="line"><span class="lineno">  325</span>              <span class="stringliteral">&#39;top&#39;</span>: 0, <span class="stringliteral">&#39;bottom&#39;</span>: 0}</div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordflow">if</span> _wspace / ncols &gt; w_pad:</div>
<div class="line"><span class="lineno">  327</span>        <span class="keywordflow">if</span> ss.colspan.start &gt; 0:</div>
<div class="line"><span class="lineno">  328</span>            margin[<span class="stringliteral">&#39;leftcb&#39;</span>] = _wspace / ncols</div>
<div class="line"><span class="lineno">  329</span>        <span class="keywordflow">if</span> ss.colspan.stop &lt; ncols:</div>
<div class="line"><span class="lineno">  330</span>            margin[<span class="stringliteral">&#39;rightcb&#39;</span>] = _wspace / ncols</div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordflow">if</span> _hspace / nrows &gt; h_pad:</div>
<div class="line"><span class="lineno">  332</span>        <span class="keywordflow">if</span> ss.rowspan.stop &lt; nrows:</div>
<div class="line"><span class="lineno">  333</span>            margin[<span class="stringliteral">&#39;bottomcb&#39;</span>] = _hspace / nrows</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">if</span> ss.rowspan.start &gt; 0:</div>
<div class="line"><span class="lineno">  335</span>            margin[<span class="stringliteral">&#39;topcb&#39;</span>] = _hspace / nrows</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>    <span class="keywordflow">return</span> margin</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aed74fa26a4ce28de320a1fdb8f026932" name="aed74fa26a4ce28de320a1fdb8f026932"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed74fa26a4ce28de320a1fdb8f026932">&#9670;&#160;</a></span>get_pos_and_bbox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.get_pos_and_bbox </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>renderer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get the position and the bbox for the axes.

Parameters
----------
ax
renderer

Returns
-------
pos : Bbox
    Position in figure coordinates.
bbox : Bbox
    Tight bounding box in figure coordinates.
</pre> <div class="fragment"><div class="line"><span class="lineno">  580</span><span class="keyword">def </span>get_pos_and_bbox(ax, renderer):</div>
<div class="line"><span class="lineno">  581</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  582</span><span class="stringliteral">    Get the position and the bbox for the axes.</span></div>
<div class="line"><span class="lineno">  583</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  584</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  585</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral">    ax</span></div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">    renderer</span></div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral">    pos : Bbox</span></div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">        Position in figure coordinates.</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral">    bbox : Bbox</span></div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">        Tight bounding box in figure coordinates.</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  596</span>    fig = ax.figure</div>
<div class="line"><span class="lineno">  597</span>    pos = ax.get_position(original=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  598</span>    <span class="comment"># pos is in panel co-ords, but we need in figure for the layout</span></div>
<div class="line"><span class="lineno">  599</span>    pos = pos.transformed(fig.transSubfigure - fig.transFigure)</div>
<div class="line"><span class="lineno">  600</span>    tightbbox = martist._get_tightbbox_for_layout_only(ax, renderer)</div>
<div class="line"><span class="lineno">  601</span>    <span class="keywordflow">if</span> tightbbox <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  602</span>        bbox = pos</div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  604</span>        bbox = tightbbox.transformed(fig.transFigure.inverted())</div>
<div class="line"><span class="lineno">  605</span>    <span class="keywordflow">return</span> pos, bbox</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f26aa01d9760dfa899881c0aeed66c2" name="a1f26aa01d9760dfa899881c0aeed66c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f26aa01d9760dfa899881c0aeed66c2">&#9670;&#160;</a></span>make_layout_margins()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.make_layout_margins </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>renderer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>w_pad</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h_pad</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hspace</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wspace</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">For each axes, make a margin between the *pos* layoutbox and the
*axes* layoutbox be a minimum size that can accommodate the
decorations on the axis.

Then make room for colorbars.
</pre> <div class="fragment"><div class="line"><span class="lineno">  341</span>                        hspace=0, wspace=0):</div>
<div class="line"><span class="lineno">  342</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    For each axes, make a margin between the *pos* layoutbox and the</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    *axes* layoutbox be a minimum size that can accommodate the</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    decorations on the axis.</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">    Then make room for colorbars.</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">for</span> sfig <span class="keywordflow">in</span> fig.subfigs:  <span class="comment"># recursively make child panel margins</span></div>
<div class="line"><span class="lineno">  350</span>        ss = sfig._subplotspec</div>
<div class="line"><span class="lineno">  351</span>        make_layout_margins(layoutgrids, sfig, renderer,</div>
<div class="line"><span class="lineno">  352</span>                            w_pad=w_pad, h_pad=h_pad,</div>
<div class="line"><span class="lineno">  353</span>                            hspace=hspace, wspace=wspace)</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>        margins = get_margin_from_padding(sfig, w_pad=0, h_pad=0,</div>
<div class="line"><span class="lineno">  356</span>                                          hspace=hspace, wspace=wspace)</div>
<div class="line"><span class="lineno">  357</span>        layoutgrids[sfig].parent.edit_outer_margin_mins(margins, ss)</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">for</span> ax <span class="keywordflow">in</span> fig._localaxes:</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(ax, <span class="stringliteral">&#39;get_subplotspec&#39;</span>) <span class="keywordflow">or</span> <span class="keywordflow">not</span> ax.get_in_layout():</div>
<div class="line"><span class="lineno">  361</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>        ss = ax.get_subplotspec()</div>
<div class="line"><span class="lineno">  364</span>        gs = ss.get_gridspec()</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>        <span class="keywordflow">if</span> gs <span class="keywordflow">not</span> <span class="keywordflow">in</span> layoutgrids:</div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>        margin = get_margin_from_padding(ax, w_pad=w_pad, h_pad=h_pad,</div>
<div class="line"><span class="lineno">  370</span>                                         hspace=hspace, wspace=wspace)</div>
<div class="line"><span class="lineno">  371</span>        pos, bbox = get_pos_and_bbox(ax, renderer)</div>
<div class="line"><span class="lineno">  372</span>        <span class="comment"># the margin is the distance between the bounding box of the axes</span></div>
<div class="line"><span class="lineno">  373</span>        <span class="comment"># and its position (plus the padding from above)</span></div>
<div class="line"><span class="lineno">  374</span>        margin[<span class="stringliteral">&#39;left&#39;</span>] += pos.x0 - bbox.x0</div>
<div class="line"><span class="lineno">  375</span>        margin[<span class="stringliteral">&#39;right&#39;</span>] += bbox.x1 - pos.x1</div>
<div class="line"><span class="lineno">  376</span>        <span class="comment"># remember that rows are ordered from top:</span></div>
<div class="line"><span class="lineno">  377</span>        margin[<span class="stringliteral">&#39;bottom&#39;</span>] += pos.y0 - bbox.y0</div>
<div class="line"><span class="lineno">  378</span>        margin[<span class="stringliteral">&#39;top&#39;</span>] += bbox.y1 - pos.y1</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>        <span class="comment"># make margin for colorbars.  These margins go in the</span></div>
<div class="line"><span class="lineno">  381</span>        <span class="comment"># padding margin, versus the margin for axes decorators.</span></div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">for</span> cbax <span class="keywordflow">in</span> ax._colorbars:</div>
<div class="line"><span class="lineno">  383</span>            <span class="comment"># note pad is a fraction of the parent width...</span></div>
<div class="line"><span class="lineno">  384</span>            pad = colorbar_get_pad(layoutgrids, cbax)</div>
<div class="line"><span class="lineno">  385</span>            <span class="comment"># colorbars can be child of more than one subplot spec:</span></div>
<div class="line"><span class="lineno">  386</span>            cbp_rspan, cbp_cspan = get_cb_parent_spans(cbax)</div>
<div class="line"><span class="lineno">  387</span>            loc = cbax._colorbar_info[<span class="stringliteral">&#39;location&#39;</span>]</div>
<div class="line"><span class="lineno">  388</span>            cbpos, cbbbox = get_pos_and_bbox(cbax, renderer)</div>
<div class="line"><span class="lineno">  389</span>            <span class="keywordflow">if</span> loc == <span class="stringliteral">&#39;right&#39;</span>:</div>
<div class="line"><span class="lineno">  390</span>                <span class="keywordflow">if</span> cbp_cspan.stop == ss.colspan.stop:</div>
<div class="line"><span class="lineno">  391</span>                    <span class="comment"># only increase if the colorbar is on the right edge</span></div>
<div class="line"><span class="lineno">  392</span>                    margin[<span class="stringliteral">&#39;rightcb&#39;</span>] += cbbbox.width + pad</div>
<div class="line"><span class="lineno">  393</span>            <span class="keywordflow">elif</span> loc == <span class="stringliteral">&#39;left&#39;</span>:</div>
<div class="line"><span class="lineno">  394</span>                <span class="keywordflow">if</span> cbp_cspan.start == ss.colspan.start:</div>
<div class="line"><span class="lineno">  395</span>                    <span class="comment"># only increase if the colorbar is on the left edge</span></div>
<div class="line"><span class="lineno">  396</span>                    margin[<span class="stringliteral">&#39;leftcb&#39;</span>] += cbbbox.width + pad</div>
<div class="line"><span class="lineno">  397</span>            <span class="keywordflow">elif</span> loc == <span class="stringliteral">&#39;top&#39;</span>:</div>
<div class="line"><span class="lineno">  398</span>                <span class="keywordflow">if</span> cbp_rspan.start == ss.rowspan.start:</div>
<div class="line"><span class="lineno">  399</span>                    margin[<span class="stringliteral">&#39;topcb&#39;</span>] += cbbbox.height + pad</div>
<div class="line"><span class="lineno">  400</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  401</span>                <span class="keywordflow">if</span> cbp_rspan.stop == ss.rowspan.stop:</div>
<div class="line"><span class="lineno">  402</span>                    margin[<span class="stringliteral">&#39;bottomcb&#39;</span>] += cbbbox.height + pad</div>
<div class="line"><span class="lineno">  403</span>            <span class="comment"># If the colorbars are wider than the parent box in the</span></div>
<div class="line"><span class="lineno">  404</span>            <span class="comment"># cross direction</span></div>
<div class="line"><span class="lineno">  405</span>            <span class="keywordflow">if</span> loc <span class="keywordflow">in</span> [<span class="stringliteral">&#39;top&#39;</span>, <span class="stringliteral">&#39;bottom&#39;</span>]:</div>
<div class="line"><span class="lineno">  406</span>                <span class="keywordflow">if</span> (cbp_cspan.start == ss.colspan.start <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  407</span>                        cbbbox.x0 &lt; bbox.x0):</div>
<div class="line"><span class="lineno">  408</span>                    margin[<span class="stringliteral">&#39;left&#39;</span>] += bbox.x0 - cbbbox.x0</div>
<div class="line"><span class="lineno">  409</span>                <span class="keywordflow">if</span> (cbp_cspan.stop == ss.colspan.stop <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  410</span>                        cbbbox.x1 &gt; bbox.x1):</div>
<div class="line"><span class="lineno">  411</span>                    margin[<span class="stringliteral">&#39;right&#39;</span>] += cbbbox.x1 - bbox.x1</div>
<div class="line"><span class="lineno">  412</span>            <span class="comment"># or taller:</span></div>
<div class="line"><span class="lineno">  413</span>            <span class="keywordflow">if</span> loc <span class="keywordflow">in</span> [<span class="stringliteral">&#39;left&#39;</span>, <span class="stringliteral">&#39;right&#39;</span>]:</div>
<div class="line"><span class="lineno">  414</span>                <span class="keywordflow">if</span> (cbp_rspan.stop == ss.rowspan.stop <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  415</span>                        cbbbox.y0 &lt; bbox.y0):</div>
<div class="line"><span class="lineno">  416</span>                    margin[<span class="stringliteral">&#39;bottom&#39;</span>] += bbox.y0 - cbbbox.y0</div>
<div class="line"><span class="lineno">  417</span>                <span class="keywordflow">if</span> (cbp_rspan.start == ss.rowspan.start <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  418</span>                        cbbbox.y1 &gt; bbox.y1):</div>
<div class="line"><span class="lineno">  419</span>                    margin[<span class="stringliteral">&#39;top&#39;</span>] += cbbbox.y1 - bbox.y1</div>
<div class="line"><span class="lineno">  420</span>        <span class="comment"># pass the new margins down to the layout grid for the solution...</span></div>
<div class="line"><span class="lineno">  421</span>        layoutgrids[gs].edit_outer_margin_mins(margin, ss)</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9aca53d5dbf15ad34af4944f890bc870" name="a9aca53d5dbf15ad34af4944f890bc870"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aca53d5dbf15ad34af4944f890bc870">&#9670;&#160;</a></span>make_layoutgrids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.make_layoutgrids </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rect</em> = <code>(0,&#160;0,&#160;1,&#160;1)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make the layoutgrid tree.

(Sub)Figures get a layoutgrid so we can have figure margins.

Gridspecs that are attached to axes get a layoutgrid so axes
can have margins.
</pre> <div class="fragment"><div class="line"><span class="lineno">  152</span><span class="keyword">def </span>make_layoutgrids(fig, layoutgrids, rect=(0, 0, 1, 1)):</div>
<div class="line"><span class="lineno">  153</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    Make the layoutgrid tree.</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    (Sub)Figures get a layoutgrid so we can have figure margins.</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    Gridspecs that are attached to axes get a layoutgrid so axes</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    can have margins.</span></div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">if</span> layoutgrids <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  163</span>        layoutgrids = dict()</div>
<div class="line"><span class="lineno">  164</span>        layoutgrids[<span class="stringliteral">&#39;hasgrids&#39;</span>] = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(fig, <span class="stringliteral">&#39;_parent&#39;</span>):</div>
<div class="line"><span class="lineno">  166</span>        <span class="comment"># top figure;  pass rect as parent to allow user-specified</span></div>
<div class="line"><span class="lineno">  167</span>        <span class="comment"># margins</span></div>
<div class="line"><span class="lineno">  168</span>        layoutgrids[fig] = mlayoutgrid.LayoutGrid(parent=rect, name=<span class="stringliteral">&#39;figlb&#39;</span>)</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  170</span>        <span class="comment"># subfigure</span></div>
<div class="line"><span class="lineno">  171</span>        gs = fig._subplotspec.get_gridspec()</div>
<div class="line"><span class="lineno">  172</span>        <span class="comment"># it is possible the gridspec containing this subfigure hasn&#39;t</span></div>
<div class="line"><span class="lineno">  173</span>        <span class="comment"># been added to the tree yet:</span></div>
<div class="line"><span class="lineno">  174</span>        layoutgrids = make_layoutgrids_gs(layoutgrids, gs)</div>
<div class="line"><span class="lineno">  175</span>        <span class="comment"># add the layoutgrid for the subfigure:</span></div>
<div class="line"><span class="lineno">  176</span>        parentlb = layoutgrids[gs]</div>
<div class="line"><span class="lineno">  177</span>        layoutgrids[fig] = mlayoutgrid.LayoutGrid(</div>
<div class="line"><span class="lineno">  178</span>            parent=parentlb,</div>
<div class="line"><span class="lineno">  179</span>            name=<span class="stringliteral">&#39;panellb&#39;</span>,</div>
<div class="line"><span class="lineno">  180</span>            parent_inner=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  181</span>            nrows=1, ncols=1,</div>
<div class="line"><span class="lineno">  182</span>            parent_pos=(fig._subplotspec.rowspan,</div>
<div class="line"><span class="lineno">  183</span>                        fig._subplotspec.colspan))</div>
<div class="line"><span class="lineno">  184</span>    <span class="comment"># recursively do all subfigures in this figure...</span></div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">for</span> sfig <span class="keywordflow">in</span> fig.subfigs:</div>
<div class="line"><span class="lineno">  186</span>        layoutgrids = make_layoutgrids(sfig, layoutgrids)</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="comment"># for each axes at the local level add its gridspec:</span></div>
<div class="line"><span class="lineno">  189</span>    <span class="keywordflow">for</span> ax <span class="keywordflow">in</span> fig._localaxes:</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">if</span> hasattr(ax, <span class="stringliteral">&#39;get_subplotspec&#39;</span>):</div>
<div class="line"><span class="lineno">  191</span>            gs = ax.get_subplotspec().get_gridspec()</div>
<div class="line"><span class="lineno">  192</span>            layoutgrids = make_layoutgrids_gs(layoutgrids, gs)</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordflow">return</span> layoutgrids</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab55e09253628d56d2b69efbb199f419b" name="ab55e09253628d56d2b69efbb199f419b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab55e09253628d56d2b69efbb199f419b">&#9670;&#160;</a></span>make_layoutgrids_gs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.make_layoutgrids_gs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make the layoutgrid for a gridspec (and anything nested in the gridspec)
</pre> <div class="fragment"><div class="line"><span class="lineno">  197</span><span class="keyword">def </span>make_layoutgrids_gs(layoutgrids, gs):</div>
<div class="line"><span class="lineno">  198</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    Make the layoutgrid for a gridspec (and anything nested in the gridspec)</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">if</span> gs <span class="keywordflow">in</span> layoutgrids <span class="keywordflow">or</span> gs.figure <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordflow">return</span> layoutgrids</div>
<div class="line"><span class="lineno">  204</span>    <span class="comment"># in order to do constrained_layout there has to be at least *one*</span></div>
<div class="line"><span class="lineno">  205</span>    <span class="comment"># gridspec in the tree:</span></div>
<div class="line"><span class="lineno">  206</span>    layoutgrids[<span class="stringliteral">&#39;hasgrids&#39;</span>] = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(gs, <span class="stringliteral">&#39;_subplot_spec&#39;</span>):</div>
<div class="line"><span class="lineno">  208</span>        <span class="comment"># normal gridspec</span></div>
<div class="line"><span class="lineno">  209</span>        parent = layoutgrids[gs.figure]</div>
<div class="line"><span class="lineno">  210</span>        layoutgrids[gs] = mlayoutgrid.LayoutGrid(</div>
<div class="line"><span class="lineno">  211</span>                parent=parent,</div>
<div class="line"><span class="lineno">  212</span>                parent_inner=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  213</span>                name=<span class="stringliteral">&#39;gridspec&#39;</span>,</div>
<div class="line"><span class="lineno">  214</span>                ncols=gs._ncols, nrows=gs._nrows,</div>
<div class="line"><span class="lineno">  215</span>                width_ratios=gs.get_width_ratios(),</div>
<div class="line"><span class="lineno">  216</span>                height_ratios=gs.get_height_ratios())</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  218</span>        <span class="comment"># this is a gridspecfromsubplotspec:</span></div>
<div class="line"><span class="lineno">  219</span>        subplot_spec = gs._subplot_spec</div>
<div class="line"><span class="lineno">  220</span>        parentgs = subplot_spec.get_gridspec()</div>
<div class="line"><span class="lineno">  221</span>        <span class="comment"># if a nested gridspec it is possible the parent is not in there yet:</span></div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">if</span> parentgs <span class="keywordflow">not</span> <span class="keywordflow">in</span> layoutgrids:</div>
<div class="line"><span class="lineno">  223</span>            layoutgrids = make_layoutgrids_gs(layoutgrids, parentgs)</div>
<div class="line"><span class="lineno">  224</span>        subspeclb = layoutgrids[parentgs]</div>
<div class="line"><span class="lineno">  225</span>        <span class="comment"># gridspecfromsubplotspec need an outer container:</span></div>
<div class="line"><span class="lineno">  226</span>        <span class="comment"># get a unique representation:</span></div>
<div class="line"><span class="lineno">  227</span>        rep = (gs, <span class="stringliteral">&#39;top&#39;</span>)</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">if</span> rep <span class="keywordflow">not</span> <span class="keywordflow">in</span> layoutgrids:</div>
<div class="line"><span class="lineno">  229</span>            layoutgrids[rep] = mlayoutgrid.LayoutGrid(</div>
<div class="line"><span class="lineno">  230</span>                parent=subspeclb,</div>
<div class="line"><span class="lineno">  231</span>                name=<span class="stringliteral">&#39;top&#39;</span>,</div>
<div class="line"><span class="lineno">  232</span>                nrows=1, ncols=1,</div>
<div class="line"><span class="lineno">  233</span>                parent_pos=(subplot_spec.rowspan, subplot_spec.colspan))</div>
<div class="line"><span class="lineno">  234</span>        layoutgrids[gs] = mlayoutgrid.LayoutGrid(</div>
<div class="line"><span class="lineno">  235</span>                parent=layoutgrids[rep],</div>
<div class="line"><span class="lineno">  236</span>                name=<span class="stringliteral">&#39;gridspec&#39;</span>,</div>
<div class="line"><span class="lineno">  237</span>                nrows=gs._nrows, ncols=gs._ncols,</div>
<div class="line"><span class="lineno">  238</span>                width_ratios=gs.get_width_ratios(),</div>
<div class="line"><span class="lineno">  239</span>                height_ratios=gs.get_height_ratios())</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">return</span> layoutgrids</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a17f6bc8dcefa13c2603178082e8eb7a5" name="a17f6bc8dcefa13c2603178082e8eb7a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17f6bc8dcefa13c2603178082e8eb7a5">&#9670;&#160;</a></span>make_margin_suptitles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.make_margin_suptitles </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>renderer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>w_pad</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h_pad</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  424</span><span class="keyword">def </span>make_margin_suptitles(layoutgrids, fig, renderer, *, w_pad=0, h_pad=0):</div>
<div class="line"><span class="lineno">  425</span>    <span class="comment"># Figure out how large the suptitle is and make the</span></div>
<div class="line"><span class="lineno">  426</span>    <span class="comment"># top level figure margin larger.</span></div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    inv_trans_fig = fig.transFigure.inverted().transform_bbox</div>
<div class="line"><span class="lineno">  429</span>    <span class="comment"># get the h_pad and w_pad as distances in the local subfigure coordinates:</span></div>
<div class="line"><span class="lineno">  430</span>    padbox = mtransforms.Bbox([[0, 0], [w_pad, h_pad]])</div>
<div class="line"><span class="lineno">  431</span>    padbox = (fig.transFigure -</div>
<div class="line"><span class="lineno">  432</span>                   fig.transSubfigure).transform_bbox(padbox)</div>
<div class="line"><span class="lineno">  433</span>    h_pad_local = padbox.height</div>
<div class="line"><span class="lineno">  434</span>    w_pad_local = padbox.width</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    <span class="keywordflow">for</span> sfig <span class="keywordflow">in</span> fig.subfigs:</div>
<div class="line"><span class="lineno">  437</span>        make_margin_suptitles(layoutgrids, sfig, renderer,</div>
<div class="line"><span class="lineno">  438</span>                              w_pad=w_pad, h_pad=h_pad)</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>    <span class="keywordflow">if</span> fig._suptitle <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> fig._suptitle.get_in_layout():</div>
<div class="line"><span class="lineno">  441</span>        p = fig._suptitle.get_position()</div>
<div class="line"><span class="lineno">  442</span>        <span class="keywordflow">if</span> getattr(fig._suptitle, <span class="stringliteral">&#39;_autopos&#39;</span>, <span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  443</span>            fig._suptitle.set_position((p[0], 1 - h_pad_local))</div>
<div class="line"><span class="lineno">  444</span>            bbox = inv_trans_fig(fig._suptitle.get_tightbbox(renderer))</div>
<div class="line"><span class="lineno">  445</span>            layoutgrids[fig].edit_margin_min(<span class="stringliteral">&#39;top&#39;</span>, bbox.height + 2 * h_pad)</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">if</span> fig._supxlabel <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> fig._supxlabel.get_in_layout():</div>
<div class="line"><span class="lineno">  448</span>        p = fig._supxlabel.get_position()</div>
<div class="line"><span class="lineno">  449</span>        <span class="keywordflow">if</span> getattr(fig._supxlabel, <span class="stringliteral">&#39;_autopos&#39;</span>, <span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  450</span>            fig._supxlabel.set_position((p[0], h_pad_local))</div>
<div class="line"><span class="lineno">  451</span>            bbox = inv_trans_fig(fig._supxlabel.get_tightbbox(renderer))</div>
<div class="line"><span class="lineno">  452</span>            layoutgrids[fig].edit_margin_min(<span class="stringliteral">&#39;bottom&#39;</span>,</div>
<div class="line"><span class="lineno">  453</span>                                             bbox.height + 2 * h_pad)</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">if</span> fig._supylabel <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> fig._supylabel.get_in_layout():</div>
<div class="line"><span class="lineno">  456</span>        p = fig._supylabel.get_position()</div>
<div class="line"><span class="lineno">  457</span>        <span class="keywordflow">if</span> getattr(fig._supylabel, <span class="stringliteral">&#39;_autopos&#39;</span>, <span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  458</span>            fig._supylabel.set_position((w_pad_local, p[1]))</div>
<div class="line"><span class="lineno">  459</span>            bbox = inv_trans_fig(fig._supylabel.get_tightbbox(renderer))</div>
<div class="line"><span class="lineno">  460</span>            layoutgrids[fig].edit_margin_min(<span class="stringliteral">&#39;left&#39;</span>, bbox.width + 2 * w_pad)</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0533bcb9521480446ce2401482e3ec30" name="a0533bcb9521480446ce2401482e3ec30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0533bcb9521480446ce2401482e3ec30">&#9670;&#160;</a></span>match_submerged_margins()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.match_submerged_margins </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make the margins that are submerged inside an Axes the same size.

This allows axes that span two columns (or rows) that are offset
from one another to have the same size.

This gives the proper layout for something like::
    fig = plt.figure(constrained_layout=True)
    axs = fig.subplot_mosaic("AAAB\nCCDD")

Without this routine, the axes D will be wider than C, because the
margin width between the two columns in C has no width by default,
whereas the margins between the two columns of D are set by the
width of the margin between A and B. However, obviously the user would
like C and D to be the same size, so we need to add constraints to these
"submerged" margins.

This routine makes all the interior margins the same, and the spacing
between the three columns in A and the two column in C are all set to the
margins between the two columns of D.

See test_constrained_layout::test_constrained_layout12 for an example.
</pre> <div class="fragment"><div class="line"><span class="lineno">  463</span><span class="keyword">def </span>match_submerged_margins(layoutgrids, fig):</div>
<div class="line"><span class="lineno">  464</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral">    Make the margins that are submerged inside an Axes the same size.</span></div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  467</span><span class="stringliteral">    This allows axes that span two columns (or rows) that are offset</span></div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral">    from one another to have the same size.</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral">    This gives the proper layout for something like::</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">        fig = plt.figure(constrained_layout=True)</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral">        axs = fig.subplot_mosaic(&quot;AAAB\nCCDD&quot;)</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">    Without this routine, the axes D will be wider than C, because the</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">    margin width between the two columns in C has no width by default,</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">    whereas the margins between the two columns of D are set by the</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">    width of the margin between A and B. However, obviously the user would</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    like C and D to be the same size, so we need to add constraints to these</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">    &quot;submerged&quot; margins.</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">    This routine makes all the interior margins the same, and the spacing</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">    between the three columns in A and the two column in C are all set to the</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">    margins between the two columns of D.</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">    See test_constrained_layout::test_constrained_layout12 for an example.</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordflow">for</span> sfig <span class="keywordflow">in</span> fig.subfigs:</div>
<div class="line"><span class="lineno">  489</span>        match_submerged_margins(layoutgrids, sfig)</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    axs = [a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> fig.get_axes() <span class="keywordflow">if</span> (hasattr(a, <span class="stringliteral">&#39;get_subplotspec&#39;</span>)</div>
<div class="line"><span class="lineno">  492</span>                                         <span class="keywordflow">and</span> a.get_in_layout())]</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>    <span class="keywordflow">for</span> ax1 <span class="keywordflow">in</span> axs:</div>
<div class="line"><span class="lineno">  495</span>        ss1 = ax1.get_subplotspec()</div>
<div class="line"><span class="lineno">  496</span>        <span class="keywordflow">if</span> ss1.get_gridspec() <span class="keywordflow">not</span> <span class="keywordflow">in</span> layoutgrids:</div>
<div class="line"><span class="lineno">  497</span>            axs.remove(ax1)</div>
<div class="line"><span class="lineno">  498</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  499</span>        lg1 = layoutgrids[ss1.get_gridspec()]</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>        <span class="comment"># interior columns:</span></div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">if</span> len(ss1.colspan) &gt; 1:</div>
<div class="line"><span class="lineno">  503</span>            maxsubl = np.max(</div>
<div class="line"><span class="lineno">  504</span>                lg1.margin_vals[<span class="stringliteral">&#39;left&#39;</span>][ss1.colspan[1:]] +</div>
<div class="line"><span class="lineno">  505</span>                lg1.margin_vals[<span class="stringliteral">&#39;leftcb&#39;</span>][ss1.colspan[1:]]</div>
<div class="line"><span class="lineno">  506</span>            )</div>
<div class="line"><span class="lineno">  507</span>            maxsubr = np.max(</div>
<div class="line"><span class="lineno">  508</span>                lg1.margin_vals[<span class="stringliteral">&#39;right&#39;</span>][ss1.colspan[:-1]] +</div>
<div class="line"><span class="lineno">  509</span>                lg1.margin_vals[<span class="stringliteral">&#39;rightcb&#39;</span>][ss1.colspan[:-1]]</div>
<div class="line"><span class="lineno">  510</span>            )</div>
<div class="line"><span class="lineno">  511</span>            <span class="keywordflow">for</span> ax2 <span class="keywordflow">in</span> axs:</div>
<div class="line"><span class="lineno">  512</span>                ss2 = ax2.get_subplotspec()</div>
<div class="line"><span class="lineno">  513</span>                lg2 = layoutgrids[ss2.get_gridspec()]</div>
<div class="line"><span class="lineno">  514</span>                <span class="keywordflow">if</span> lg2 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> len(ss2.colspan) &gt; 1:</div>
<div class="line"><span class="lineno">  515</span>                    maxsubl2 = np.max(</div>
<div class="line"><span class="lineno">  516</span>                        lg2.margin_vals[<span class="stringliteral">&#39;left&#39;</span>][ss2.colspan[1:]] +</div>
<div class="line"><span class="lineno">  517</span>                        lg2.margin_vals[<span class="stringliteral">&#39;leftcb&#39;</span>][ss2.colspan[1:]])</div>
<div class="line"><span class="lineno">  518</span>                    <span class="keywordflow">if</span> maxsubl2 &gt; maxsubl:</div>
<div class="line"><span class="lineno">  519</span>                        maxsubl = maxsubl2</div>
<div class="line"><span class="lineno">  520</span>                    maxsubr2 = np.max(</div>
<div class="line"><span class="lineno">  521</span>                        lg2.margin_vals[<span class="stringliteral">&#39;right&#39;</span>][ss2.colspan[:-1]] +</div>
<div class="line"><span class="lineno">  522</span>                        lg2.margin_vals[<span class="stringliteral">&#39;rightcb&#39;</span>][ss2.colspan[:-1]])</div>
<div class="line"><span class="lineno">  523</span>                    <span class="keywordflow">if</span> maxsubr2 &gt; maxsubr:</div>
<div class="line"><span class="lineno">  524</span>                        maxsubr = maxsubr2</div>
<div class="line"><span class="lineno">  525</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> ss1.colspan[1:]:</div>
<div class="line"><span class="lineno">  526</span>                lg1.edit_margin_min(<span class="stringliteral">&#39;left&#39;</span>, maxsubl, cell=i)</div>
<div class="line"><span class="lineno">  527</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> ss1.colspan[:-1]:</div>
<div class="line"><span class="lineno">  528</span>                lg1.edit_margin_min(<span class="stringliteral">&#39;right&#39;</span>, maxsubr, cell=i)</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>        <span class="comment"># interior rows:</span></div>
<div class="line"><span class="lineno">  531</span>        <span class="keywordflow">if</span> len(ss1.rowspan) &gt; 1:</div>
<div class="line"><span class="lineno">  532</span>            maxsubt = np.max(</div>
<div class="line"><span class="lineno">  533</span>                lg1.margin_vals[<span class="stringliteral">&#39;top&#39;</span>][ss1.rowspan[1:]] +</div>
<div class="line"><span class="lineno">  534</span>                lg1.margin_vals[<span class="stringliteral">&#39;topcb&#39;</span>][ss1.rowspan[1:]]</div>
<div class="line"><span class="lineno">  535</span>            )</div>
<div class="line"><span class="lineno">  536</span>            maxsubb = np.max(</div>
<div class="line"><span class="lineno">  537</span>                lg1.margin_vals[<span class="stringliteral">&#39;bottom&#39;</span>][ss1.rowspan[:-1]] +</div>
<div class="line"><span class="lineno">  538</span>                lg1.margin_vals[<span class="stringliteral">&#39;bottomcb&#39;</span>][ss1.rowspan[:-1]]</div>
<div class="line"><span class="lineno">  539</span>            )</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>            <span class="keywordflow">for</span> ax2 <span class="keywordflow">in</span> axs:</div>
<div class="line"><span class="lineno">  542</span>                ss2 = ax2.get_subplotspec()</div>
<div class="line"><span class="lineno">  543</span>                lg2 = layoutgrids[ss2.get_gridspec()]</div>
<div class="line"><span class="lineno">  544</span>                <span class="keywordflow">if</span> lg2 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  545</span>                    <span class="keywordflow">if</span> len(ss2.rowspan) &gt; 1:</div>
<div class="line"><span class="lineno">  546</span>                        maxsubt = np.max([np.max(</div>
<div class="line"><span class="lineno">  547</span>                            lg2.margin_vals[<span class="stringliteral">&#39;top&#39;</span>][ss2.rowspan[1:]] +</div>
<div class="line"><span class="lineno">  548</span>                            lg2.margin_vals[<span class="stringliteral">&#39;topcb&#39;</span>][ss2.rowspan[1:]]</div>
<div class="line"><span class="lineno">  549</span>                        ), maxsubt])</div>
<div class="line"><span class="lineno">  550</span>                        maxsubb = np.max([np.max(</div>
<div class="line"><span class="lineno">  551</span>                            lg2.margin_vals[<span class="stringliteral">&#39;bottom&#39;</span>][ss2.rowspan[:-1]] +</div>
<div class="line"><span class="lineno">  552</span>                            lg2.margin_vals[<span class="stringliteral">&#39;bottomcb&#39;</span>][ss2.rowspan[:-1]]</div>
<div class="line"><span class="lineno">  553</span>                        ), maxsubb])</div>
<div class="line"><span class="lineno">  554</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> ss1.rowspan[1:]:</div>
<div class="line"><span class="lineno">  555</span>                lg1.edit_margin_min(<span class="stringliteral">&#39;top&#39;</span>, maxsubt, cell=i)</div>
<div class="line"><span class="lineno">  556</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> ss1.rowspan[:-1]:</div>
<div class="line"><span class="lineno">  557</span>                lg1.edit_margin_min(<span class="stringliteral">&#39;bottom&#39;</span>, maxsubb, cell=i)</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af1e155905763a3eb41dff5b5c1f52b9e" name="af1e155905763a3eb41dff5b5c1f52b9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1e155905763a3eb41dff5b5c1f52b9e">&#9670;&#160;</a></span>reposition_axes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.reposition_axes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>renderer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>w_pad</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h_pad</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hspace</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wspace</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reposition all the axes based on the new inner bounding box.
</pre> <div class="fragment"><div class="line"><span class="lineno">  609</span>                    w_pad=0, h_pad=0, hspace=0, wspace=0):</div>
<div class="line"><span class="lineno">  610</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral">    Reposition all the axes based on the new inner bounding box.</span></div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  613</span>    trans_fig_to_subfig = fig.transFigure - fig.transSubfigure</div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordflow">for</span> sfig <span class="keywordflow">in</span> fig.subfigs:</div>
<div class="line"><span class="lineno">  615</span>        bbox = layoutgrids[sfig].get_outer_bbox()</div>
<div class="line"><span class="lineno">  616</span>        sfig._redo_transform_rel_fig(</div>
<div class="line"><span class="lineno">  617</span>            bbox=bbox.transformed(trans_fig_to_subfig))</div>
<div class="line"><span class="lineno">  618</span>        reposition_axes(layoutgrids, sfig, renderer,</div>
<div class="line"><span class="lineno">  619</span>                        w_pad=w_pad, h_pad=h_pad,</div>
<div class="line"><span class="lineno">  620</span>                        wspace=wspace, hspace=hspace)</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordflow">for</span> ax <span class="keywordflow">in</span> fig._localaxes:</div>
<div class="line"><span class="lineno">  623</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(ax, <span class="stringliteral">&#39;get_subplotspec&#39;</span>) <span class="keywordflow">or</span> <span class="keywordflow">not</span> ax.get_in_layout():</div>
<div class="line"><span class="lineno">  624</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>        <span class="comment"># grid bbox is in Figure coordinates, but we specify in panel</span></div>
<div class="line"><span class="lineno">  627</span>        <span class="comment"># coordinates...</span></div>
<div class="line"><span class="lineno">  628</span>        ss = ax.get_subplotspec()</div>
<div class="line"><span class="lineno">  629</span>        gs = ss.get_gridspec()</div>
<div class="line"><span class="lineno">  630</span>        <span class="keywordflow">if</span> gs <span class="keywordflow">not</span> <span class="keywordflow">in</span> layoutgrids:</div>
<div class="line"><span class="lineno">  631</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>        bbox = layoutgrids[gs].get_inner_bbox(rows=ss.rowspan,</div>
<div class="line"><span class="lineno">  634</span>                                              cols=ss.colspan)</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>        <span class="comment"># transform from figure to panel for set_position:</span></div>
<div class="line"><span class="lineno">  637</span>        newbbox = trans_fig_to_subfig.transform_bbox(bbox)</div>
<div class="line"><span class="lineno">  638</span>        ax._set_position(newbbox)</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>        <span class="comment"># move the colorbars:</span></div>
<div class="line"><span class="lineno">  641</span>        <span class="comment"># we need to keep track of oldw and oldh if there is more than</span></div>
<div class="line"><span class="lineno">  642</span>        <span class="comment"># one colorbar:</span></div>
<div class="line"><span class="lineno">  643</span>        offset = {<span class="stringliteral">&#39;left&#39;</span>: 0, <span class="stringliteral">&#39;right&#39;</span>: 0, <span class="stringliteral">&#39;bottom&#39;</span>: 0, <span class="stringliteral">&#39;top&#39;</span>: 0}</div>
<div class="line"><span class="lineno">  644</span>        <span class="keywordflow">for</span> nn, cbax <span class="keywordflow">in</span> enumerate(ax._colorbars[::-1]):</div>
<div class="line"><span class="lineno">  645</span>            <span class="keywordflow">if</span> ax == cbax._colorbar_info[<span class="stringliteral">&#39;parents&#39;</span>][0]:</div>
<div class="line"><span class="lineno">  646</span>                reposition_colorbar(layoutgrids, cbax, renderer,</div>
<div class="line"><span class="lineno">  647</span>                                    offset=offset)</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1675ad90c0bed85753f350849f6d39a9" name="a1675ad90c0bed85753f350849f6d39a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1675ad90c0bed85753f350849f6d39a9">&#9670;&#160;</a></span>reposition_colorbar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.reposition_colorbar </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cbax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>renderer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>offset</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Place the colorbar in its new place.

Parameters
----------
cbax : Axes
    Axes for the colorbar

renderer :
w_pad, h_pad : float
    width and height padding (in fraction of figure)
hspace, wspace : float
    width and height padding as fraction of figure size divided by
    number of  columns or rows
margin : array-like
    offset the colorbar needs to be pushed to in order to
    account for multiple colorbars
</pre> <div class="fragment"><div class="line"><span class="lineno">  650</span><span class="keyword">def </span>reposition_colorbar(layoutgrids, cbax, renderer, *, offset=None):</div>
<div class="line"><span class="lineno">  651</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  652</span><span class="stringliteral">    Place the colorbar in its new place.</span></div>
<div class="line"><span class="lineno">  653</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  654</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  655</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">    cbax : Axes</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral">        Axes for the colorbar</span></div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">    renderer :</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">    w_pad, h_pad : float</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">        width and height padding (in fraction of figure)</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral">    hspace, wspace : float</span></div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">        width and height padding as fraction of figure size divided by</span></div>
<div class="line"><span class="lineno">  664</span><span class="stringliteral">        number of  columns or rows</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">    margin : array-like</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">        offset the colorbar needs to be pushed to in order to</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">        account for multiple colorbars</span></div>
<div class="line"><span class="lineno">  668</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  669</span> </div>
<div class="line"><span class="lineno">  670</span>    parents = cbax._colorbar_info[<span class="stringliteral">&#39;parents&#39;</span>]</div>
<div class="line"><span class="lineno">  671</span>    gs = parents[0].get_gridspec()</div>
<div class="line"><span class="lineno">  672</span>    fig = cbax.figure</div>
<div class="line"><span class="lineno">  673</span>    trans_fig_to_subfig = fig.transFigure - fig.transSubfigure</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>    cb_rspans, cb_cspans = get_cb_parent_spans(cbax)</div>
<div class="line"><span class="lineno">  676</span>    bboxparent = layoutgrids[gs].get_bbox_for_cb(rows=cb_rspans,</div>
<div class="line"><span class="lineno">  677</span>                                                 cols=cb_cspans)</div>
<div class="line"><span class="lineno">  678</span>    pb = layoutgrids[gs].get_inner_bbox(rows=cb_rspans, cols=cb_cspans)</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>    location = cbax._colorbar_info[<span class="stringliteral">&#39;location&#39;</span>]</div>
<div class="line"><span class="lineno">  681</span>    anchor = cbax._colorbar_info[<span class="stringliteral">&#39;anchor&#39;</span>]</div>
<div class="line"><span class="lineno">  682</span>    fraction = cbax._colorbar_info[<span class="stringliteral">&#39;fraction&#39;</span>]</div>
<div class="line"><span class="lineno">  683</span>    aspect = cbax._colorbar_info[<span class="stringliteral">&#39;aspect&#39;</span>]</div>
<div class="line"><span class="lineno">  684</span>    shrink = cbax._colorbar_info[<span class="stringliteral">&#39;shrink&#39;</span>]</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    cbpos, cbbbox = get_pos_and_bbox(cbax, renderer)</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span>    <span class="comment"># Colorbar gets put at extreme edge of outer bbox of the subplotspec</span></div>
<div class="line"><span class="lineno">  689</span>    <span class="comment"># It needs to be moved in by: 1) a pad 2) its &quot;margin&quot; 3) by</span></div>
<div class="line"><span class="lineno">  690</span>    <span class="comment"># any colorbars already added at this location:</span></div>
<div class="line"><span class="lineno">  691</span>    cbpad = colorbar_get_pad(layoutgrids, cbax)</div>
<div class="line"><span class="lineno">  692</span>    <span class="keywordflow">if</span> location <span class="keywordflow">in</span> (<span class="stringliteral">&#39;left&#39;</span>, <span class="stringliteral">&#39;right&#39;</span>):</div>
<div class="line"><span class="lineno">  693</span>        <span class="comment"># fraction and shrink are fractions of parent</span></div>
<div class="line"><span class="lineno">  694</span>        pbcb = pb.shrunk(fraction, shrink).anchored(anchor, pb)</div>
<div class="line"><span class="lineno">  695</span>        <span class="comment"># The colorbar is at the left side of the parent.  Need</span></div>
<div class="line"><span class="lineno">  696</span>        <span class="comment"># to translate to right (or left)</span></div>
<div class="line"><span class="lineno">  697</span>        <span class="keywordflow">if</span> location == <span class="stringliteral">&#39;right&#39;</span>:</div>
<div class="line"><span class="lineno">  698</span>            lmargin = cbpos.x0 - cbbbox.x0</div>
<div class="line"><span class="lineno">  699</span>            dx = bboxparent.x1 - pbcb.x0 + offset[<span class="stringliteral">&#39;right&#39;</span>]</div>
<div class="line"><span class="lineno">  700</span>            dx += cbpad + lmargin</div>
<div class="line"><span class="lineno">  701</span>            offset[<span class="stringliteral">&#39;right&#39;</span>] += cbbbox.width + cbpad</div>
<div class="line"><span class="lineno">  702</span>            pbcb = pbcb.translated(dx, 0)</div>
<div class="line"><span class="lineno">  703</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  704</span>            lmargin = cbpos.x0 - cbbbox.x0</div>
<div class="line"><span class="lineno">  705</span>            dx = bboxparent.x0 - pbcb.x0  <span class="comment"># edge of parent</span></div>
<div class="line"><span class="lineno">  706</span>            dx += -cbbbox.width - cbpad + lmargin - offset[<span class="stringliteral">&#39;left&#39;</span>]</div>
<div class="line"><span class="lineno">  707</span>            offset[<span class="stringliteral">&#39;left&#39;</span>] += cbbbox.width + cbpad</div>
<div class="line"><span class="lineno">  708</span>            pbcb = pbcb.translated(dx, 0)</div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">else</span>:  <span class="comment"># horizontal axes:</span></div>
<div class="line"><span class="lineno">  710</span>        pbcb = pb.shrunk(shrink, fraction).anchored(anchor, pb)</div>
<div class="line"><span class="lineno">  711</span>        <span class="keywordflow">if</span> location == <span class="stringliteral">&#39;top&#39;</span>:</div>
<div class="line"><span class="lineno">  712</span>            bmargin = cbpos.y0 - cbbbox.y0</div>
<div class="line"><span class="lineno">  713</span>            dy = bboxparent.y1 - pbcb.y0 + offset[<span class="stringliteral">&#39;top&#39;</span>]</div>
<div class="line"><span class="lineno">  714</span>            dy += cbpad + bmargin</div>
<div class="line"><span class="lineno">  715</span>            offset[<span class="stringliteral">&#39;top&#39;</span>] += cbbbox.height + cbpad</div>
<div class="line"><span class="lineno">  716</span>            pbcb = pbcb.translated(0, dy)</div>
<div class="line"><span class="lineno">  717</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  718</span>            bmargin = cbpos.y0 - cbbbox.y0</div>
<div class="line"><span class="lineno">  719</span>            dy = bboxparent.y0 - pbcb.y0</div>
<div class="line"><span class="lineno">  720</span>            dy += -cbbbox.height - cbpad + bmargin - offset[<span class="stringliteral">&#39;bottom&#39;</span>]</div>
<div class="line"><span class="lineno">  721</span>            offset[<span class="stringliteral">&#39;bottom&#39;</span>] += cbbbox.height + cbpad</div>
<div class="line"><span class="lineno">  722</span>            pbcb = pbcb.translated(0, dy)</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>    pbcb = trans_fig_to_subfig.transform_bbox(pbcb)</div>
<div class="line"><span class="lineno">  725</span>    cbax.set_transform(fig.transSubfigure)</div>
<div class="line"><span class="lineno">  726</span>    cbax._set_position(pbcb)</div>
<div class="line"><span class="lineno">  727</span>    cbax.set_anchor(anchor)</div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordflow">if</span> location <span class="keywordflow">in</span> [<span class="stringliteral">&#39;bottom&#39;</span>, <span class="stringliteral">&#39;top&#39;</span>]:</div>
<div class="line"><span class="lineno">  729</span>        aspect = 1 / aspect</div>
<div class="line"><span class="lineno">  730</span>    cbax.set_box_aspect(aspect)</div>
<div class="line"><span class="lineno">  731</span>    cbax.set_aspect(<span class="stringliteral">&#39;auto&#39;</span>)</div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordflow">return</span> offset</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c8919d4e026828b8f166479337780b0" name="a2c8919d4e026828b8f166479337780b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c8919d4e026828b8f166479337780b0">&#9670;&#160;</a></span>reset_margins()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout.reset_margins </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layoutgrids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reset the margins in the layoutboxes of fig.

Margins are usually set as a minimum, so if the figure gets smaller
the minimum needs to be zero in order for it to grow again.
</pre> <div class="fragment"><div class="line"><span class="lineno">  735</span><span class="keyword">def </span>reset_margins(layoutgrids, fig):</div>
<div class="line"><span class="lineno">  736</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">    Reset the margins in the layoutboxes of fig.</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">    Margins are usually set as a minimum, so if the figure gets smaller</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">    the minimum needs to be zero in order for it to grow again.</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">for</span> sfig <span class="keywordflow">in</span> fig.subfigs:</div>
<div class="line"><span class="lineno">  743</span>        reset_margins(layoutgrids, sfig)</div>
<div class="line"><span class="lineno">  744</span>    <span class="keywordflow">for</span> ax <span class="keywordflow">in</span> fig.axes:</div>
<div class="line"><span class="lineno">  745</span>        <span class="keywordflow">if</span> hasattr(ax, <span class="stringliteral">&#39;get_subplotspec&#39;</span>) <span class="keywordflow">and</span> ax.get_in_layout():</div>
<div class="line"><span class="lineno">  746</span>            ss = ax.get_subplotspec()</div>
<div class="line"><span class="lineno">  747</span>            gs = ss.get_gridspec()</div>
<div class="line"><span class="lineno">  748</span>            <span class="keywordflow">if</span> gs <span class="keywordflow">in</span> layoutgrids:</div>
<div class="line"><span class="lineno">  749</span>                layoutgrids[gs].reset_margins()</div>
<div class="line"><span class="lineno">  750</span>    layoutgrids[fig].reset_margins()</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a368c0b5672a172c4d5293eb6fef3d0f6" name="a368c0b5672a172c4d5293eb6fef3d0f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a368c0b5672a172c4d5293eb6fef3d0f6">&#9670;&#160;</a></span>_log</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">matplotlib._constrained_layout._log = logging.getLogger(__name__)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
